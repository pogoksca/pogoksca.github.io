(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();function pw(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function gw(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var Zm={exports:{}},pu={},ev={exports:{}},Je={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ul=Symbol.for("react.element"),mw=Symbol.for("react.portal"),vw=Symbol.for("react.fragment"),xw=Symbol.for("react.strict_mode"),yw=Symbol.for("react.profiler"),_w=Symbol.for("react.provider"),ww=Symbol.for("react.context"),Sw=Symbol.for("react.forward_ref"),kw=Symbol.for("react.suspense"),bw=Symbol.for("react.memo"),Tw=Symbol.for("react.lazy"),np=Symbol.iterator;function Cw(e){return e===null||typeof e!="object"?null:(e=np&&e[np]||e["@@iterator"],typeof e=="function"?e:null)}var tv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rv=Object.assign,nv={};function Os(e,t,r){this.props=e,this.context=t,this.refs=nv,this.updater=r||tv}Os.prototype.isReactComponent={};Os.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Os.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function iv(){}iv.prototype=Os.prototype;function l0(e,t,r){this.props=e,this.context=t,this.refs=nv,this.updater=r||tv}var c0=l0.prototype=new iv;c0.constructor=l0;rv(c0,Os.prototype);c0.isPureReactComponent=!0;var ip=Array.isArray,av=Object.prototype.hasOwnProperty,u0={current:null},sv={key:!0,ref:!0,__self:!0,__source:!0};function ov(e,t,r){var n,i={},a=null,l=null;if(t!=null)for(n in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(a=""+t.key),t)av.call(t,n)&&!sv.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var s=Array(o),c=0;c<o;c++)s[c]=arguments[c+2];i.children=s}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:ul,type:e,key:a,ref:l,props:i,_owner:u0.current}}function Ew(e,t){return{$$typeof:ul,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function f0(e){return typeof e=="object"&&e!==null&&e.$$typeof===ul}function Aw(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var ap=/\/+/g;function $u(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Aw(""+e.key):t.toString(36)}function lc(e,t,r,n,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case ul:case mw:l=!0}}if(l)return l=e,i=i(l),e=n===""?"."+$u(l,0):n,ip(i)?(r="",e!=null&&(r=e.replace(ap,"$&/")+"/"),lc(i,t,r,"",function(c){return c})):i!=null&&(f0(i)&&(i=Ew(i,r+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(ap,"$&/")+"/")+e)),t.push(i)),1;if(l=0,n=n===""?".":n+":",ip(e))for(var o=0;o<e.length;o++){a=e[o];var s=n+$u(a,o);l+=lc(a,t,r,s,i)}else if(s=Cw(e),typeof s=="function")for(e=s.call(e),o=0;!(a=e.next()).done;)a=a.value,s=n+$u(a,o++),l+=lc(a,t,r,s,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function El(e,t,r){if(e==null)return e;var n=[],i=0;return lc(e,n,"","",function(a){return t.call(r,a,i++)}),n}function Ow(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Er={current:null},cc={transition:null},Fw={ReactCurrentDispatcher:Er,ReactCurrentBatchConfig:cc,ReactCurrentOwner:u0};function lv(){throw Error("act(...) is not supported in production builds of React.")}Je.Children={map:El,forEach:function(e,t,r){El(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return El(e,function(){t++}),t},toArray:function(e){return El(e,function(t){return t})||[]},only:function(e){if(!f0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Je.Component=Os;Je.Fragment=vw;Je.Profiler=yw;Je.PureComponent=l0;Je.StrictMode=xw;Je.Suspense=kw;Je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Fw;Je.act=lv;Je.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=rv({},e.props),i=e.key,a=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,l=u0.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(s in t)av.call(t,s)&&!sv.hasOwnProperty(s)&&(n[s]=t[s]===void 0&&o!==void 0?o[s]:t[s])}var s=arguments.length-2;if(s===1)n.children=r;else if(1<s){o=Array(s);for(var c=0;c<s;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:ul,type:e.type,key:i,ref:a,props:n,_owner:l}};Je.createContext=function(e){return e={$$typeof:ww,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:_w,_context:e},e.Consumer=e};Je.createElement=ov;Je.createFactory=function(e){var t=ov.bind(null,e);return t.type=e,t};Je.createRef=function(){return{current:null}};Je.forwardRef=function(e){return{$$typeof:Sw,render:e}};Je.isValidElement=f0;Je.lazy=function(e){return{$$typeof:Tw,_payload:{_status:-1,_result:e},_init:Ow}};Je.memo=function(e,t){return{$$typeof:bw,type:e,compare:t===void 0?null:t}};Je.startTransition=function(e){var t=cc.transition;cc.transition={};try{e()}finally{cc.transition=t}};Je.unstable_act=lv;Je.useCallback=function(e,t){return Er.current.useCallback(e,t)};Je.useContext=function(e){return Er.current.useContext(e)};Je.useDebugValue=function(){};Je.useDeferredValue=function(e){return Er.current.useDeferredValue(e)};Je.useEffect=function(e,t){return Er.current.useEffect(e,t)};Je.useId=function(){return Er.current.useId()};Je.useImperativeHandle=function(e,t,r){return Er.current.useImperativeHandle(e,t,r)};Je.useInsertionEffect=function(e,t){return Er.current.useInsertionEffect(e,t)};Je.useLayoutEffect=function(e,t){return Er.current.useLayoutEffect(e,t)};Je.useMemo=function(e,t){return Er.current.useMemo(e,t)};Je.useReducer=function(e,t,r){return Er.current.useReducer(e,t,r)};Je.useRef=function(e){return Er.current.useRef(e)};Je.useState=function(e){return Er.current.useState(e)};Je.useSyncExternalStore=function(e,t,r){return Er.current.useSyncExternalStore(e,t,r)};Je.useTransition=function(){return Er.current.useTransition()};Je.version="18.3.1";ev.exports=Je;var ve=ev.exports;const cv=pw(ve);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pw=ve,Nw=Symbol.for("react.element"),Dw=Symbol.for("react.fragment"),Rw=Object.prototype.hasOwnProperty,Iw=Pw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Mw={key:!0,ref:!0,__self:!0,__source:!0};function uv(e,t,r){var n,i={},a=null,l=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)Rw.call(t,n)&&!Mw.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:Nw,type:e,key:a,ref:l,props:i,_owner:Iw.current}}pu.Fragment=Dw;pu.jsx=uv;pu.jsxs=uv;Zm.exports=pu;var S=Zm.exports,zf={},fv={exports:{}},Yr={},hv={exports:{}},dv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(se,C){var j=se.length;se.push(C);e:for(;0<j;){var L=j-1>>>1,E=se[L];if(0<i(E,C))se[L]=C,se[j]=E,j=L;else break e}}function r(se){return se.length===0?null:se[0]}function n(se){if(se.length===0)return null;var C=se[0],j=se.pop();if(j!==C){se[0]=j;e:for(var L=0,E=se.length,I=E>>>1;L<I;){var A=2*(L+1)-1,b=se[A],P=A+1,R=se[P];if(0>i(b,j))P<E&&0>i(R,b)?(se[L]=R,se[P]=j,L=P):(se[L]=b,se[A]=j,L=A);else if(P<E&&0>i(R,j))se[L]=R,se[P]=j,L=P;else break e}}return C}function i(se,C){var j=se.sortIndex-C.sortIndex;return j!==0?j:se.id-C.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var s=[],c=[],d=1,f=null,h=3,u=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(se){for(var C=r(c);C!==null;){if(C.callback===null)n(c);else if(C.startTime<=se)n(c),C.sortIndex=C.expirationTime,t(s,C);else break;C=r(c)}}function _(se){if(m=!1,y(se),!p)if(r(s)!==null)p=!0,re(w);else{var C=r(c);C!==null&&le(_,C.startTime-se)}}function w(se,C){p=!1,m&&(m=!1,v(O),O=-1),u=!0;var j=h;try{for(y(C),f=r(s);f!==null&&(!(f.expirationTime>C)||se&&!V());){var L=f.callback;if(typeof L=="function"){f.callback=null,h=f.priorityLevel;var E=L(f.expirationTime<=C);C=e.unstable_now(),typeof E=="function"?f.callback=E:f===r(s)&&n(s),y(C)}else n(s);f=r(s)}if(f!==null)var I=!0;else{var A=r(c);A!==null&&le(_,A.startTime-C),I=!1}return I}finally{f=null,h=j,u=!1}}var T=!1,k=null,O=-1,F=5,M=-1;function V(){return!(e.unstable_now()-M<F)}function X(){if(k!==null){var se=e.unstable_now();M=se;var C=!0;try{C=k(!0,se)}finally{C?q():(T=!1,k=null)}}else T=!1}var q;if(typeof x=="function")q=function(){x(X)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,ne=ae.port2;ae.port1.onmessage=X,q=function(){ne.postMessage(null)}}else q=function(){g(X,0)};function re(se){k=se,T||(T=!0,q())}function le(se,C){O=g(function(){se(e.unstable_now())},C)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(se){se.callback=null},e.unstable_continueExecution=function(){p||u||(p=!0,re(w))},e.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<se?Math.floor(1e3/se):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(s)},e.unstable_next=function(se){switch(h){case 1:case 2:case 3:var C=3;break;default:C=h}var j=h;h=C;try{return se()}finally{h=j}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(se,C){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var j=h;h=se;try{return C()}finally{h=j}},e.unstable_scheduleCallback=function(se,C,j){var L=e.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?L+j:L):j=L,se){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=j+E,se={id:d++,callback:C,priorityLevel:se,startTime:j,expirationTime:E,sortIndex:-1},j>L?(se.sortIndex=j,t(c,se),r(s)===null&&se===r(c)&&(m?(v(O),O=-1):m=!0,le(_,j-L))):(se.sortIndex=E,t(s,se),p||u||(p=!0,re(w))),se},e.unstable_shouldYield=V,e.unstable_wrapCallback=function(se){var C=h;return function(){var j=h;h=C;try{return se.apply(this,arguments)}finally{h=j}}}})(dv);hv.exports=dv;var jw=hv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lw=ve,$r=jw;function Se(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var pv=new Set,Co={};function wa(e,t){xs(e,t),xs(e+"Capture",t)}function xs(e,t){for(Co[e]=t,e=0;e<t.length;e++)pv.add(t[e])}var Qn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vf=Object.prototype.hasOwnProperty,Bw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,sp={},op={};function Uw(e){return Vf.call(op,e)?!0:Vf.call(sp,e)?!1:Bw.test(e)?op[e]=!0:(sp[e]=!0,!1)}function Ww(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Hw(e,t,r,n){if(t===null||typeof t>"u"||Ww(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ar(e,t,r,n,i,a,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=l}var lr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){lr[e]=new Ar(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];lr[t]=new Ar(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){lr[e]=new Ar(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){lr[e]=new Ar(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){lr[e]=new Ar(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){lr[e]=new Ar(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){lr[e]=new Ar(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){lr[e]=new Ar(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){lr[e]=new Ar(e,5,!1,e.toLowerCase(),null,!1,!1)});var h0=/[\-:]([a-z])/g;function d0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(h0,d0);lr[t]=new Ar(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(h0,d0);lr[t]=new Ar(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(h0,d0);lr[t]=new Ar(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){lr[e]=new Ar(e,1,!1,e.toLowerCase(),null,!1,!1)});lr.xlinkHref=new Ar("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){lr[e]=new Ar(e,1,!1,e.toLowerCase(),null,!0,!0)});function p0(e,t,r,n){var i=lr.hasOwnProperty(t)?lr[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Hw(t,r,i,n)&&(r=null),n||i===null?Uw(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ii=Lw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Al=Symbol.for("react.element"),Xa=Symbol.for("react.portal"),$a=Symbol.for("react.fragment"),g0=Symbol.for("react.strict_mode"),Xf=Symbol.for("react.profiler"),gv=Symbol.for("react.provider"),mv=Symbol.for("react.context"),m0=Symbol.for("react.forward_ref"),$f=Symbol.for("react.suspense"),Gf=Symbol.for("react.suspense_list"),v0=Symbol.for("react.memo"),hi=Symbol.for("react.lazy"),vv=Symbol.for("react.offscreen"),lp=Symbol.iterator;function Us(e){return e===null||typeof e!="object"?null:(e=lp&&e[lp]||e["@@iterator"],typeof e=="function"?e:null)}var Ot=Object.assign,Gu;function Js(e){if(Gu===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Gu=t&&t[1]||""}return`
`+Gu+e}var Yu=!1;function Ku(e,t){if(!e||Yu)return"";Yu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),a=n.stack.split(`
`),l=i.length-1,o=a.length-1;1<=l&&0<=o&&i[l]!==a[o];)o--;for(;1<=l&&0<=o;l--,o--)if(i[l]!==a[o]){if(l!==1||o!==1)do if(l--,o--,0>o||i[l]!==a[o]){var s=`
`+i[l].replace(" at new "," at ");return e.displayName&&s.includes("<anonymous>")&&(s=s.replace("<anonymous>",e.displayName)),s}while(1<=l&&0<=o);break}}}finally{Yu=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Js(e):""}function zw(e){switch(e.tag){case 5:return Js(e.type);case 16:return Js("Lazy");case 13:return Js("Suspense");case 19:return Js("SuspenseList");case 0:case 2:case 15:return e=Ku(e.type,!1),e;case 11:return e=Ku(e.type.render,!1),e;case 1:return e=Ku(e.type,!0),e;default:return""}}function Yf(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case $a:return"Fragment";case Xa:return"Portal";case Xf:return"Profiler";case g0:return"StrictMode";case $f:return"Suspense";case Gf:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case mv:return(e.displayName||"Context")+".Consumer";case gv:return(e._context.displayName||"Context")+".Provider";case m0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case v0:return t=e.displayName||null,t!==null?t:Yf(e.type)||"Memo";case hi:t=e._payload,e=e._init;try{return Yf(e(t))}catch{}}return null}function Vw(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Yf(t);case 8:return t===g0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Fi(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function xv(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Xw(e){var t=xv(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(l){n=""+l,a.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ol(e){e._valueTracker||(e._valueTracker=Xw(e))}function yv(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=xv(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Sc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Kf(e,t){var r=t.checked;return Ot({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function cp(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Fi(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function _v(e,t){t=t.checked,t!=null&&p0(e,"checked",t,!1)}function qf(e,t){_v(e,t);var r=Fi(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Jf(e,t.type,r):t.hasOwnProperty("defaultValue")&&Jf(e,t.type,Fi(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function up(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Jf(e,t,r){(t!=="number"||Sc(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Qs=Array.isArray;function as(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Fi(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Qf(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Se(91));return Ot({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function fp(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Se(92));if(Qs(r)){if(1<r.length)throw Error(Se(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Fi(r)}}function wv(e,t){var r=Fi(t.value),n=Fi(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function hp(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Sv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zf(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Sv(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Fl,kv=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Fl=Fl||document.createElement("div"),Fl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Fl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Eo(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var ao={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$w=["Webkit","ms","Moz","O"];Object.keys(ao).forEach(function(e){$w.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ao[t]=ao[e]})});function bv(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||ao.hasOwnProperty(e)&&ao[e]?(""+t).trim():t+"px"}function Tv(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=bv(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var Gw=Ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function eh(e,t){if(t){if(Gw[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Se(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Se(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Se(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Se(62))}}function th(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rh=null;function x0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var nh=null,ss=null,os=null;function dp(e){if(e=dl(e)){if(typeof nh!="function")throw Error(Se(280));var t=e.stateNode;t&&(t=yu(t),nh(e.stateNode,e.type,t))}}function Cv(e){ss?os?os.push(e):os=[e]:ss=e}function Ev(){if(ss){var e=ss,t=os;if(os=ss=null,dp(e),t)for(e=0;e<t.length;e++)dp(t[e])}}function Av(e,t){return e(t)}function Ov(){}var qu=!1;function Fv(e,t,r){if(qu)return e(t,r);qu=!0;try{return Av(e,t,r)}finally{qu=!1,(ss!==null||os!==null)&&(Ov(),Ev())}}function Ao(e,t){var r=e.stateNode;if(r===null)return null;var n=yu(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Se(231,t,typeof r));return r}var ih=!1;if(Qn)try{var Ws={};Object.defineProperty(Ws,"passive",{get:function(){ih=!0}}),window.addEventListener("test",Ws,Ws),window.removeEventListener("test",Ws,Ws)}catch{ih=!1}function Yw(e,t,r,n,i,a,l,o,s){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var so=!1,kc=null,bc=!1,ah=null,Kw={onError:function(e){so=!0,kc=e}};function qw(e,t,r,n,i,a,l,o,s){so=!1,kc=null,Yw.apply(Kw,arguments)}function Jw(e,t,r,n,i,a,l,o,s){if(qw.apply(this,arguments),so){if(so){var c=kc;so=!1,kc=null}else throw Error(Se(198));bc||(bc=!0,ah=c)}}function Sa(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Pv(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function pp(e){if(Sa(e)!==e)throw Error(Se(188))}function Qw(e){var t=e.alternate;if(!t){if(t=Sa(e),t===null)throw Error(Se(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return pp(i),e;if(a===n)return pp(i),t;a=a.sibling}throw Error(Se(188))}if(r.return!==n.return)r=i,n=a;else{for(var l=!1,o=i.child;o;){if(o===r){l=!0,r=i,n=a;break}if(o===n){l=!0,n=i,r=a;break}o=o.sibling}if(!l){for(o=a.child;o;){if(o===r){l=!0,r=a,n=i;break}if(o===n){l=!0,n=a,r=i;break}o=o.sibling}if(!l)throw Error(Se(189))}}if(r.alternate!==n)throw Error(Se(190))}if(r.tag!==3)throw Error(Se(188));return r.stateNode.current===r?e:t}function Nv(e){return e=Qw(e),e!==null?Dv(e):null}function Dv(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Dv(e);if(t!==null)return t;e=e.sibling}return null}var Rv=$r.unstable_scheduleCallback,gp=$r.unstable_cancelCallback,Zw=$r.unstable_shouldYield,e2=$r.unstable_requestPaint,jt=$r.unstable_now,t2=$r.unstable_getCurrentPriorityLevel,y0=$r.unstable_ImmediatePriority,Iv=$r.unstable_UserBlockingPriority,Tc=$r.unstable_NormalPriority,r2=$r.unstable_LowPriority,Mv=$r.unstable_IdlePriority,gu=null,jn=null;function n2(e){if(jn&&typeof jn.onCommitFiberRoot=="function")try{jn.onCommitFiberRoot(gu,e,void 0,(e.current.flags&128)===128)}catch{}}var wn=Math.clz32?Math.clz32:s2,i2=Math.log,a2=Math.LN2;function s2(e){return e>>>=0,e===0?32:31-(i2(e)/a2|0)|0}var Pl=64,Nl=4194304;function Zs(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Cc(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~i;o!==0?n=Zs(o):(a&=l,a!==0&&(n=Zs(a)))}else l=r&~i,l!==0?n=Zs(l):a!==0&&(n=Zs(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-wn(t),i=1<<r,n|=e[r],t&=~i;return n}function o2(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function l2(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var l=31-wn(a),o=1<<l,s=i[l];s===-1?(!(o&r)||o&n)&&(i[l]=o2(o,t)):s<=t&&(e.expiredLanes|=o),a&=~o}}function sh(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function jv(){var e=Pl;return Pl<<=1,!(Pl&4194240)&&(Pl=64),e}function Ju(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function fl(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-wn(t),e[t]=r}function c2(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-wn(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}function _0(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-wn(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var ct=0;function Lv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Bv,w0,Uv,Wv,Hv,oh=!1,Dl=[],Si=null,ki=null,bi=null,Oo=new Map,Fo=new Map,gi=[],u2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function mp(e,t){switch(e){case"focusin":case"focusout":Si=null;break;case"dragenter":case"dragleave":ki=null;break;case"mouseover":case"mouseout":bi=null;break;case"pointerover":case"pointerout":Oo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fo.delete(t.pointerId)}}function Hs(e,t,r,n,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},t!==null&&(t=dl(t),t!==null&&w0(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function f2(e,t,r,n,i){switch(t){case"focusin":return Si=Hs(Si,e,t,r,n,i),!0;case"dragenter":return ki=Hs(ki,e,t,r,n,i),!0;case"mouseover":return bi=Hs(bi,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return Oo.set(a,Hs(Oo.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,Fo.set(a,Hs(Fo.get(a)||null,e,t,r,n,i)),!0}return!1}function zv(e){var t=Qi(e.target);if(t!==null){var r=Sa(t);if(r!==null){if(t=r.tag,t===13){if(t=Pv(r),t!==null){e.blockedOn=t,Hv(e.priority,function(){Uv(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function uc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=lh(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);rh=n,r.target.dispatchEvent(n),rh=null}else return t=dl(r),t!==null&&w0(t),e.blockedOn=r,!1;t.shift()}return!0}function vp(e,t,r){uc(e)&&r.delete(t)}function h2(){oh=!1,Si!==null&&uc(Si)&&(Si=null),ki!==null&&uc(ki)&&(ki=null),bi!==null&&uc(bi)&&(bi=null),Oo.forEach(vp),Fo.forEach(vp)}function zs(e,t){e.blockedOn===t&&(e.blockedOn=null,oh||(oh=!0,$r.unstable_scheduleCallback($r.unstable_NormalPriority,h2)))}function Po(e){function t(i){return zs(i,e)}if(0<Dl.length){zs(Dl[0],e);for(var r=1;r<Dl.length;r++){var n=Dl[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Si!==null&&zs(Si,e),ki!==null&&zs(ki,e),bi!==null&&zs(bi,e),Oo.forEach(t),Fo.forEach(t),r=0;r<gi.length;r++)n=gi[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<gi.length&&(r=gi[0],r.blockedOn===null);)zv(r),r.blockedOn===null&&gi.shift()}var ls=ii.ReactCurrentBatchConfig,Ec=!0;function d2(e,t,r,n){var i=ct,a=ls.transition;ls.transition=null;try{ct=1,S0(e,t,r,n)}finally{ct=i,ls.transition=a}}function p2(e,t,r,n){var i=ct,a=ls.transition;ls.transition=null;try{ct=4,S0(e,t,r,n)}finally{ct=i,ls.transition=a}}function S0(e,t,r,n){if(Ec){var i=lh(e,t,r,n);if(i===null)lf(e,t,n,Ac,r),mp(e,n);else if(f2(i,e,t,r,n))n.stopPropagation();else if(mp(e,n),t&4&&-1<u2.indexOf(e)){for(;i!==null;){var a=dl(i);if(a!==null&&Bv(a),a=lh(e,t,r,n),a===null&&lf(e,t,n,Ac,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else lf(e,t,n,null,r)}}var Ac=null;function lh(e,t,r,n){if(Ac=null,e=x0(n),e=Qi(e),e!==null)if(t=Sa(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Pv(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ac=e,null}function Vv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(t2()){case y0:return 1;case Iv:return 4;case Tc:case r2:return 16;case Mv:return 536870912;default:return 16}default:return 16}}var xi=null,k0=null,fc=null;function Xv(){if(fc)return fc;var e,t=k0,r=t.length,n,i="value"in xi?xi.value:xi.textContent,a=i.length;for(e=0;e<r&&t[e]===i[e];e++);var l=r-e;for(n=1;n<=l&&t[r-n]===i[a-n];n++);return fc=i.slice(e,1<n?1-n:void 0)}function hc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Rl(){return!0}function xp(){return!1}function Kr(e){function t(r,n,i,a,l){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Rl:xp,this.isPropagationStopped=xp,this}return Ot(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Rl)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Rl)},persist:function(){},isPersistent:Rl}),t}var Fs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},b0=Kr(Fs),hl=Ot({},Fs,{view:0,detail:0}),g2=Kr(hl),Qu,Zu,Vs,mu=Ot({},hl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:T0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Vs&&(Vs&&e.type==="mousemove"?(Qu=e.screenX-Vs.screenX,Zu=e.screenY-Vs.screenY):Zu=Qu=0,Vs=e),Qu)},movementY:function(e){return"movementY"in e?e.movementY:Zu}}),yp=Kr(mu),m2=Ot({},mu,{dataTransfer:0}),v2=Kr(m2),x2=Ot({},hl,{relatedTarget:0}),ef=Kr(x2),y2=Ot({},Fs,{animationName:0,elapsedTime:0,pseudoElement:0}),_2=Kr(y2),w2=Ot({},Fs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),S2=Kr(w2),k2=Ot({},Fs,{data:0}),_p=Kr(k2),b2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},T2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},C2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function E2(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=C2[e])?!!t[e]:!1}function T0(){return E2}var A2=Ot({},hl,{key:function(e){if(e.key){var t=b2[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=hc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?T2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:T0,charCode:function(e){return e.type==="keypress"?hc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?hc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),O2=Kr(A2),F2=Ot({},mu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wp=Kr(F2),P2=Ot({},hl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:T0}),N2=Kr(P2),D2=Ot({},Fs,{propertyName:0,elapsedTime:0,pseudoElement:0}),R2=Kr(D2),I2=Ot({},mu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),M2=Kr(I2),j2=[9,13,27,32],C0=Qn&&"CompositionEvent"in window,oo=null;Qn&&"documentMode"in document&&(oo=document.documentMode);var L2=Qn&&"TextEvent"in window&&!oo,$v=Qn&&(!C0||oo&&8<oo&&11>=oo),Sp=" ",kp=!1;function Gv(e,t){switch(e){case"keyup":return j2.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yv(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ga=!1;function B2(e,t){switch(e){case"compositionend":return Yv(t);case"keypress":return t.which!==32?null:(kp=!0,Sp);case"textInput":return e=t.data,e===Sp&&kp?null:e;default:return null}}function U2(e,t){if(Ga)return e==="compositionend"||!C0&&Gv(e,t)?(e=Xv(),fc=k0=xi=null,Ga=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return $v&&t.locale!=="ko"?null:t.data;default:return null}}var W2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!W2[e.type]:t==="textarea"}function Kv(e,t,r,n){Cv(n),t=Oc(t,"onChange"),0<t.length&&(r=new b0("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var lo=null,No=null;function H2(e){sx(e,0)}function vu(e){var t=qa(e);if(yv(t))return e}function z2(e,t){if(e==="change")return t}var qv=!1;if(Qn){var tf;if(Qn){var rf="oninput"in document;if(!rf){var Tp=document.createElement("div");Tp.setAttribute("oninput","return;"),rf=typeof Tp.oninput=="function"}tf=rf}else tf=!1;qv=tf&&(!document.documentMode||9<document.documentMode)}function Cp(){lo&&(lo.detachEvent("onpropertychange",Jv),No=lo=null)}function Jv(e){if(e.propertyName==="value"&&vu(No)){var t=[];Kv(t,No,e,x0(e)),Fv(H2,t)}}function V2(e,t,r){e==="focusin"?(Cp(),lo=t,No=r,lo.attachEvent("onpropertychange",Jv)):e==="focusout"&&Cp()}function X2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return vu(No)}function $2(e,t){if(e==="click")return vu(t)}function G2(e,t){if(e==="input"||e==="change")return vu(t)}function Y2(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Tn=typeof Object.is=="function"?Object.is:Y2;function Do(e,t){if(Tn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Vf.call(t,i)||!Tn(e[i],t[i]))return!1}return!0}function Ep(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ap(e,t){var r=Ep(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Ep(r)}}function Qv(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Qv(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Zv(){for(var e=window,t=Sc();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Sc(e.document)}return t}function E0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function K2(e){var t=Zv(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Qv(r.ownerDocument.documentElement,r)){if(n!==null&&E0(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=Ap(r,a);var l=Ap(r,n);i&&l&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var q2=Qn&&"documentMode"in document&&11>=document.documentMode,Ya=null,ch=null,co=null,uh=!1;function Op(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;uh||Ya==null||Ya!==Sc(n)||(n=Ya,"selectionStart"in n&&E0(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),co&&Do(co,n)||(co=n,n=Oc(ch,"onSelect"),0<n.length&&(t=new b0("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ya)))}function Il(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ka={animationend:Il("Animation","AnimationEnd"),animationiteration:Il("Animation","AnimationIteration"),animationstart:Il("Animation","AnimationStart"),transitionend:Il("Transition","TransitionEnd")},nf={},ex={};Qn&&(ex=document.createElement("div").style,"AnimationEvent"in window||(delete Ka.animationend.animation,delete Ka.animationiteration.animation,delete Ka.animationstart.animation),"TransitionEvent"in window||delete Ka.transitionend.transition);function xu(e){if(nf[e])return nf[e];if(!Ka[e])return e;var t=Ka[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in ex)return nf[e]=t[r];return e}var tx=xu("animationend"),rx=xu("animationiteration"),nx=xu("animationstart"),ix=xu("transitionend"),ax=new Map,Fp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mi(e,t){ax.set(e,t),wa(t,[e])}for(var af=0;af<Fp.length;af++){var sf=Fp[af],J2=sf.toLowerCase(),Q2=sf[0].toUpperCase()+sf.slice(1);Mi(J2,"on"+Q2)}Mi(tx,"onAnimationEnd");Mi(rx,"onAnimationIteration");Mi(nx,"onAnimationStart");Mi("dblclick","onDoubleClick");Mi("focusin","onFocus");Mi("focusout","onBlur");Mi(ix,"onTransitionEnd");xs("onMouseEnter",["mouseout","mouseover"]);xs("onMouseLeave",["mouseout","mouseover"]);xs("onPointerEnter",["pointerout","pointerover"]);xs("onPointerLeave",["pointerout","pointerover"]);wa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));wa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));wa("onBeforeInput",["compositionend","keypress","textInput","paste"]);wa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));wa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));wa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var eo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Z2=new Set("cancel close invalid load scroll toggle".split(" ").concat(eo));function Pp(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Jw(n,t,void 0,e),e.currentTarget=null}function sx(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var l=n.length-1;0<=l;l--){var o=n[l],s=o.instance,c=o.currentTarget;if(o=o.listener,s!==a&&i.isPropagationStopped())break e;Pp(i,o,c),a=s}else for(l=0;l<n.length;l++){if(o=n[l],s=o.instance,c=o.currentTarget,o=o.listener,s!==a&&i.isPropagationStopped())break e;Pp(i,o,c),a=s}}}if(bc)throw e=ah,bc=!1,ah=null,e}function pt(e,t){var r=t[gh];r===void 0&&(r=t[gh]=new Set);var n=e+"__bubble";r.has(n)||(ox(t,e,2,!1),r.add(n))}function of(e,t,r){var n=0;t&&(n|=4),ox(r,e,n,t)}var Ml="_reactListening"+Math.random().toString(36).slice(2);function Ro(e){if(!e[Ml]){e[Ml]=!0,pv.forEach(function(r){r!=="selectionchange"&&(Z2.has(r)||of(r,!1,e),of(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ml]||(t[Ml]=!0,of("selectionchange",!1,t))}}function ox(e,t,r,n){switch(Vv(t)){case 1:var i=d2;break;case 4:i=p2;break;default:i=S0}r=i.bind(null,t,r,e),i=void 0,!ih||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function lf(e,t,r,n,i){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(l===4)for(l=n.return;l!==null;){var s=l.tag;if((s===3||s===4)&&(s=l.stateNode.containerInfo,s===i||s.nodeType===8&&s.parentNode===i))return;l=l.return}for(;o!==null;){if(l=Qi(o),l===null)return;if(s=l.tag,s===5||s===6){n=a=l;continue e}o=o.parentNode}}n=n.return}Fv(function(){var c=a,d=x0(r),f=[];e:{var h=ax.get(e);if(h!==void 0){var u=b0,p=e;switch(e){case"keypress":if(hc(r)===0)break e;case"keydown":case"keyup":u=O2;break;case"focusin":p="focus",u=ef;break;case"focusout":p="blur",u=ef;break;case"beforeblur":case"afterblur":u=ef;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=yp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=v2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=N2;break;case tx:case rx:case nx:u=_2;break;case ix:u=R2;break;case"scroll":u=g2;break;case"wheel":u=M2;break;case"copy":case"cut":case"paste":u=S2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=wp}var m=(t&4)!==0,g=!m&&e==="scroll",v=m?h!==null?h+"Capture":null:h;m=[];for(var x=c,y;x!==null;){y=x;var _=y.stateNode;if(y.tag===5&&_!==null&&(y=_,v!==null&&(_=Ao(x,v),_!=null&&m.push(Io(x,_,y)))),g)break;x=x.return}0<m.length&&(h=new u(h,p,null,r,d),f.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",u=e==="mouseout"||e==="pointerout",h&&r!==rh&&(p=r.relatedTarget||r.fromElement)&&(Qi(p)||p[Zn]))break e;if((u||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,u?(p=r.relatedTarget||r.toElement,u=c,p=p?Qi(p):null,p!==null&&(g=Sa(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(u=null,p=c),u!==p)){if(m=yp,_="onMouseLeave",v="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(m=wp,_="onPointerLeave",v="onPointerEnter",x="pointer"),g=u==null?h:qa(u),y=p==null?h:qa(p),h=new m(_,x+"leave",u,r,d),h.target=g,h.relatedTarget=y,_=null,Qi(d)===c&&(m=new m(v,x+"enter",p,r,d),m.target=y,m.relatedTarget=g,_=m),g=_,u&&p)t:{for(m=u,v=p,x=0,y=m;y;y=Oa(y))x++;for(y=0,_=v;_;_=Oa(_))y++;for(;0<x-y;)m=Oa(m),x--;for(;0<y-x;)v=Oa(v),y--;for(;x--;){if(m===v||v!==null&&m===v.alternate)break t;m=Oa(m),v=Oa(v)}m=null}else m=null;u!==null&&Np(f,h,u,m,!1),p!==null&&g!==null&&Np(f,g,p,m,!0)}}e:{if(h=c?qa(c):window,u=h.nodeName&&h.nodeName.toLowerCase(),u==="select"||u==="input"&&h.type==="file")var w=z2;else if(bp(h))if(qv)w=G2;else{w=X2;var T=V2}else(u=h.nodeName)&&u.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(w=$2);if(w&&(w=w(e,c))){Kv(f,w,r,d);break e}T&&T(e,h,c),e==="focusout"&&(T=h._wrapperState)&&T.controlled&&h.type==="number"&&Jf(h,"number",h.value)}switch(T=c?qa(c):window,e){case"focusin":(bp(T)||T.contentEditable==="true")&&(Ya=T,ch=c,co=null);break;case"focusout":co=ch=Ya=null;break;case"mousedown":uh=!0;break;case"contextmenu":case"mouseup":case"dragend":uh=!1,Op(f,r,d);break;case"selectionchange":if(q2)break;case"keydown":case"keyup":Op(f,r,d)}var k;if(C0)e:{switch(e){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else Ga?Gv(e,r)&&(O="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(O="onCompositionStart");O&&($v&&r.locale!=="ko"&&(Ga||O!=="onCompositionStart"?O==="onCompositionEnd"&&Ga&&(k=Xv()):(xi=d,k0="value"in xi?xi.value:xi.textContent,Ga=!0)),T=Oc(c,O),0<T.length&&(O=new _p(O,e,null,r,d),f.push({event:O,listeners:T}),k?O.data=k:(k=Yv(r),k!==null&&(O.data=k)))),(k=L2?B2(e,r):U2(e,r))&&(c=Oc(c,"onBeforeInput"),0<c.length&&(d=new _p("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:c}),d.data=k))}sx(f,t)})}function Io(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Oc(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Ao(e,r),a!=null&&n.unshift(Io(e,a,i)),a=Ao(e,t),a!=null&&n.push(Io(e,a,i))),e=e.return}return n}function Oa(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Np(e,t,r,n,i){for(var a=t._reactName,l=[];r!==null&&r!==n;){var o=r,s=o.alternate,c=o.stateNode;if(s!==null&&s===n)break;o.tag===5&&c!==null&&(o=c,i?(s=Ao(r,a),s!=null&&l.unshift(Io(r,s,o))):i||(s=Ao(r,a),s!=null&&l.push(Io(r,s,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var eS=/\r\n?/g,tS=/\u0000|\uFFFD/g;function Dp(e){return(typeof e=="string"?e:""+e).replace(eS,`
`).replace(tS,"")}function jl(e,t,r){if(t=Dp(t),Dp(e)!==t&&r)throw Error(Se(425))}function Fc(){}var fh=null,hh=null;function dh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ph=typeof setTimeout=="function"?setTimeout:void 0,rS=typeof clearTimeout=="function"?clearTimeout:void 0,Rp=typeof Promise=="function"?Promise:void 0,nS=typeof queueMicrotask=="function"?queueMicrotask:typeof Rp<"u"?function(e){return Rp.resolve(null).then(e).catch(iS)}:ph;function iS(e){setTimeout(function(){throw e})}function cf(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Po(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Po(t)}function Ti(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Ip(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ps=Math.random().toString(36).slice(2),Dn="__reactFiber$"+Ps,Mo="__reactProps$"+Ps,Zn="__reactContainer$"+Ps,gh="__reactEvents$"+Ps,aS="__reactListeners$"+Ps,sS="__reactHandles$"+Ps;function Qi(e){var t=e[Dn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Zn]||r[Dn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Ip(e);e!==null;){if(r=e[Dn])return r;e=Ip(e)}return t}e=r,r=e.parentNode}return null}function dl(e){return e=e[Dn]||e[Zn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function qa(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Se(33))}function yu(e){return e[Mo]||null}var mh=[],Ja=-1;function ji(e){return{current:e}}function mt(e){0>Ja||(e.current=mh[Ja],mh[Ja]=null,Ja--)}function dt(e,t){Ja++,mh[Ja]=e.current,e.current=t}var Pi={},yr=ji(Pi),Dr=ji(!1),ca=Pi;function ys(e,t){var r=e.type.contextTypes;if(!r)return Pi;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Rr(e){return e=e.childContextTypes,e!=null}function Pc(){mt(Dr),mt(yr)}function Mp(e,t,r){if(yr.current!==Pi)throw Error(Se(168));dt(yr,t),dt(Dr,r)}function lx(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Se(108,Vw(e)||"Unknown",i));return Ot({},r,n)}function Nc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Pi,ca=yr.current,dt(yr,e),dt(Dr,Dr.current),!0}function jp(e,t,r){var n=e.stateNode;if(!n)throw Error(Se(169));r?(e=lx(e,t,ca),n.__reactInternalMemoizedMergedChildContext=e,mt(Dr),mt(yr),dt(yr,e)):mt(Dr),dt(Dr,r)}var Vn=null,_u=!1,uf=!1;function cx(e){Vn===null?Vn=[e]:Vn.push(e)}function oS(e){_u=!0,cx(e)}function Li(){if(!uf&&Vn!==null){uf=!0;var e=0,t=ct;try{var r=Vn;for(ct=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Vn=null,_u=!1}catch(i){throw Vn!==null&&(Vn=Vn.slice(e+1)),Rv(y0,Li),i}finally{ct=t,uf=!1}}return null}var Qa=[],Za=0,Dc=null,Rc=0,rn=[],nn=0,ua=null,Xn=1,$n="";function Xi(e,t){Qa[Za++]=Rc,Qa[Za++]=Dc,Dc=e,Rc=t}function ux(e,t,r){rn[nn++]=Xn,rn[nn++]=$n,rn[nn++]=ua,ua=e;var n=Xn;e=$n;var i=32-wn(n)-1;n&=~(1<<i),r+=1;var a=32-wn(t)+i;if(30<a){var l=i-i%5;a=(n&(1<<l)-1).toString(32),n>>=l,i-=l,Xn=1<<32-wn(t)+i|r<<i|n,$n=a+e}else Xn=1<<a|r<<i|n,$n=e}function A0(e){e.return!==null&&(Xi(e,1),ux(e,1,0))}function O0(e){for(;e===Dc;)Dc=Qa[--Za],Qa[Za]=null,Rc=Qa[--Za],Qa[Za]=null;for(;e===ua;)ua=rn[--nn],rn[nn]=null,$n=rn[--nn],rn[nn]=null,Xn=rn[--nn],rn[nn]=null}var Xr=null,Vr=null,_t=!1,xn=null;function fx(e,t){var r=an(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Lp(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Xr=e,Vr=Ti(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Xr=e,Vr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ua!==null?{id:Xn,overflow:$n}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=an(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Xr=e,Vr=null,!0):!1;default:return!1}}function vh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function xh(e){if(_t){var t=Vr;if(t){var r=t;if(!Lp(e,t)){if(vh(e))throw Error(Se(418));t=Ti(r.nextSibling);var n=Xr;t&&Lp(e,t)?fx(n,r):(e.flags=e.flags&-4097|2,_t=!1,Xr=e)}}else{if(vh(e))throw Error(Se(418));e.flags=e.flags&-4097|2,_t=!1,Xr=e}}}function Bp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Xr=e}function Ll(e){if(e!==Xr)return!1;if(!_t)return Bp(e),_t=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!dh(e.type,e.memoizedProps)),t&&(t=Vr)){if(vh(e))throw hx(),Error(Se(418));for(;t;)fx(e,t),t=Ti(t.nextSibling)}if(Bp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Se(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Vr=Ti(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Vr=null}}else Vr=Xr?Ti(e.stateNode.nextSibling):null;return!0}function hx(){for(var e=Vr;e;)e=Ti(e.nextSibling)}function _s(){Vr=Xr=null,_t=!1}function F0(e){xn===null?xn=[e]:xn.push(e)}var lS=ii.ReactCurrentBatchConfig;function Xs(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Se(309));var n=r.stateNode}if(!n)throw Error(Se(147,e));var i=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(l){var o=i.refs;l===null?delete o[a]:o[a]=l},t._stringRef=a,t)}if(typeof e!="string")throw Error(Se(284));if(!r._owner)throw Error(Se(290,e))}return e}function Bl(e,t){throw e=Object.prototype.toString.call(t),Error(Se(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Up(e){var t=e._init;return t(e._payload)}function dx(e){function t(v,x){if(e){var y=v.deletions;y===null?(v.deletions=[x],v.flags|=16):y.push(x)}}function r(v,x){if(!e)return null;for(;x!==null;)t(v,x),x=x.sibling;return null}function n(v,x){for(v=new Map;x!==null;)x.key!==null?v.set(x.key,x):v.set(x.index,x),x=x.sibling;return v}function i(v,x){return v=Oi(v,x),v.index=0,v.sibling=null,v}function a(v,x,y){return v.index=y,e?(y=v.alternate,y!==null?(y=y.index,y<x?(v.flags|=2,x):y):(v.flags|=2,x)):(v.flags|=1048576,x)}function l(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,x,y,_){return x===null||x.tag!==6?(x=vf(y,v.mode,_),x.return=v,x):(x=i(x,y),x.return=v,x)}function s(v,x,y,_){var w=y.type;return w===$a?d(v,x,y.props.children,_,y.key):x!==null&&(x.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===hi&&Up(w)===x.type)?(_=i(x,y.props),_.ref=Xs(v,x,y),_.return=v,_):(_=yc(y.type,y.key,y.props,null,v.mode,_),_.ref=Xs(v,x,y),_.return=v,_)}function c(v,x,y,_){return x===null||x.tag!==4||x.stateNode.containerInfo!==y.containerInfo||x.stateNode.implementation!==y.implementation?(x=xf(y,v.mode,_),x.return=v,x):(x=i(x,y.children||[]),x.return=v,x)}function d(v,x,y,_,w){return x===null||x.tag!==7?(x=ia(y,v.mode,_,w),x.return=v,x):(x=i(x,y),x.return=v,x)}function f(v,x,y){if(typeof x=="string"&&x!==""||typeof x=="number")return x=vf(""+x,v.mode,y),x.return=v,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Al:return y=yc(x.type,x.key,x.props,null,v.mode,y),y.ref=Xs(v,null,x),y.return=v,y;case Xa:return x=xf(x,v.mode,y),x.return=v,x;case hi:var _=x._init;return f(v,_(x._payload),y)}if(Qs(x)||Us(x))return x=ia(x,v.mode,y,null),x.return=v,x;Bl(v,x)}return null}function h(v,x,y,_){var w=x!==null?x.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return w!==null?null:o(v,x,""+y,_);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Al:return y.key===w?s(v,x,y,_):null;case Xa:return y.key===w?c(v,x,y,_):null;case hi:return w=y._init,h(v,x,w(y._payload),_)}if(Qs(y)||Us(y))return w!==null?null:d(v,x,y,_,null);Bl(v,y)}return null}function u(v,x,y,_,w){if(typeof _=="string"&&_!==""||typeof _=="number")return v=v.get(y)||null,o(x,v,""+_,w);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Al:return v=v.get(_.key===null?y:_.key)||null,s(x,v,_,w);case Xa:return v=v.get(_.key===null?y:_.key)||null,c(x,v,_,w);case hi:var T=_._init;return u(v,x,y,T(_._payload),w)}if(Qs(_)||Us(_))return v=v.get(y)||null,d(x,v,_,w,null);Bl(x,_)}return null}function p(v,x,y,_){for(var w=null,T=null,k=x,O=x=0,F=null;k!==null&&O<y.length;O++){k.index>O?(F=k,k=null):F=k.sibling;var M=h(v,k,y[O],_);if(M===null){k===null&&(k=F);break}e&&k&&M.alternate===null&&t(v,k),x=a(M,x,O),T===null?w=M:T.sibling=M,T=M,k=F}if(O===y.length)return r(v,k),_t&&Xi(v,O),w;if(k===null){for(;O<y.length;O++)k=f(v,y[O],_),k!==null&&(x=a(k,x,O),T===null?w=k:T.sibling=k,T=k);return _t&&Xi(v,O),w}for(k=n(v,k);O<y.length;O++)F=u(k,v,O,y[O],_),F!==null&&(e&&F.alternate!==null&&k.delete(F.key===null?O:F.key),x=a(F,x,O),T===null?w=F:T.sibling=F,T=F);return e&&k.forEach(function(V){return t(v,V)}),_t&&Xi(v,O),w}function m(v,x,y,_){var w=Us(y);if(typeof w!="function")throw Error(Se(150));if(y=w.call(y),y==null)throw Error(Se(151));for(var T=w=null,k=x,O=x=0,F=null,M=y.next();k!==null&&!M.done;O++,M=y.next()){k.index>O?(F=k,k=null):F=k.sibling;var V=h(v,k,M.value,_);if(V===null){k===null&&(k=F);break}e&&k&&V.alternate===null&&t(v,k),x=a(V,x,O),T===null?w=V:T.sibling=V,T=V,k=F}if(M.done)return r(v,k),_t&&Xi(v,O),w;if(k===null){for(;!M.done;O++,M=y.next())M=f(v,M.value,_),M!==null&&(x=a(M,x,O),T===null?w=M:T.sibling=M,T=M);return _t&&Xi(v,O),w}for(k=n(v,k);!M.done;O++,M=y.next())M=u(k,v,O,M.value,_),M!==null&&(e&&M.alternate!==null&&k.delete(M.key===null?O:M.key),x=a(M,x,O),T===null?w=M:T.sibling=M,T=M);return e&&k.forEach(function(X){return t(v,X)}),_t&&Xi(v,O),w}function g(v,x,y,_){if(typeof y=="object"&&y!==null&&y.type===$a&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Al:e:{for(var w=y.key,T=x;T!==null;){if(T.key===w){if(w=y.type,w===$a){if(T.tag===7){r(v,T.sibling),x=i(T,y.props.children),x.return=v,v=x;break e}}else if(T.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===hi&&Up(w)===T.type){r(v,T.sibling),x=i(T,y.props),x.ref=Xs(v,T,y),x.return=v,v=x;break e}r(v,T);break}else t(v,T);T=T.sibling}y.type===$a?(x=ia(y.props.children,v.mode,_,y.key),x.return=v,v=x):(_=yc(y.type,y.key,y.props,null,v.mode,_),_.ref=Xs(v,x,y),_.return=v,v=_)}return l(v);case Xa:e:{for(T=y.key;x!==null;){if(x.key===T)if(x.tag===4&&x.stateNode.containerInfo===y.containerInfo&&x.stateNode.implementation===y.implementation){r(v,x.sibling),x=i(x,y.children||[]),x.return=v,v=x;break e}else{r(v,x);break}else t(v,x);x=x.sibling}x=xf(y,v.mode,_),x.return=v,v=x}return l(v);case hi:return T=y._init,g(v,x,T(y._payload),_)}if(Qs(y))return p(v,x,y,_);if(Us(y))return m(v,x,y,_);Bl(v,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,x!==null&&x.tag===6?(r(v,x.sibling),x=i(x,y),x.return=v,v=x):(r(v,x),x=vf(y,v.mode,_),x.return=v,v=x),l(v)):r(v,x)}return g}var ws=dx(!0),px=dx(!1),Ic=ji(null),Mc=null,es=null,P0=null;function N0(){P0=es=Mc=null}function D0(e){var t=Ic.current;mt(Ic),e._currentValue=t}function yh(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function cs(e,t){Mc=e,P0=es=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Nr=!0),e.firstContext=null)}function ln(e){var t=e._currentValue;if(P0!==e)if(e={context:e,memoizedValue:t,next:null},es===null){if(Mc===null)throw Error(Se(308));es=e,Mc.dependencies={lanes:0,firstContext:e}}else es=es.next=e;return t}var Zi=null;function R0(e){Zi===null?Zi=[e]:Zi.push(e)}function gx(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,R0(t)):(r.next=i.next,i.next=r),t.interleaved=r,ei(e,n)}function ei(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var di=!1;function I0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function mx(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Yn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ci(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,et&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,ei(e,r)}return i=n.interleaved,i===null?(t.next=t,R0(n)):(t.next=i.next,i.next=t),n.interleaved=t,ei(e,r)}function dc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,_0(e,r)}}function Wp(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=l:a=a.next=l,r=r.next}while(r!==null);a===null?i=a=t:a=a.next=t}else i=a=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function jc(e,t,r,n){var i=e.updateQueue;di=!1;var a=i.firstBaseUpdate,l=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var s=o,c=s.next;s.next=null,l===null?a=c:l.next=c,l=s;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==l&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=s))}if(a!==null){var f=i.baseState;l=0,d=c=s=null,o=a;do{var h=o.lane,u=o.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:u,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,m=o;switch(h=t,u=r,m.tag){case 1:if(p=m.payload,typeof p=="function"){f=p.call(u,f,h);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(u,f,h):p,h==null)break e;f=Ot({},f,h);break e;case 2:di=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else u={eventTime:u,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=u,s=f):d=d.next=u,l|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(d===null&&(s=f),i.baseState=s,i.firstBaseUpdate=c,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do l|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);ha|=l,e.lanes=l,e.memoizedState=f}}function Hp(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Se(191,i));i.call(n)}}}var pl={},Ln=ji(pl),jo=ji(pl),Lo=ji(pl);function ea(e){if(e===pl)throw Error(Se(174));return e}function M0(e,t){switch(dt(Lo,t),dt(jo,e),dt(Ln,pl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Zf(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Zf(t,e)}mt(Ln),dt(Ln,t)}function Ss(){mt(Ln),mt(jo),mt(Lo)}function vx(e){ea(Lo.current);var t=ea(Ln.current),r=Zf(t,e.type);t!==r&&(dt(jo,e),dt(Ln,r))}function j0(e){jo.current===e&&(mt(Ln),mt(jo))}var Tt=ji(0);function Lc(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ff=[];function L0(){for(var e=0;e<ff.length;e++)ff[e]._workInProgressVersionPrimary=null;ff.length=0}var pc=ii.ReactCurrentDispatcher,hf=ii.ReactCurrentBatchConfig,fa=0,At=null,$t=null,Jt=null,Bc=!1,uo=!1,Bo=0,cS=0;function ur(){throw Error(Se(321))}function B0(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Tn(e[r],t[r]))return!1;return!0}function U0(e,t,r,n,i,a){if(fa=a,At=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,pc.current=e===null||e.memoizedState===null?dS:pS,e=r(n,i),uo){a=0;do{if(uo=!1,Bo=0,25<=a)throw Error(Se(301));a+=1,Jt=$t=null,t.updateQueue=null,pc.current=gS,e=r(n,i)}while(uo)}if(pc.current=Uc,t=$t!==null&&$t.next!==null,fa=0,Jt=$t=At=null,Bc=!1,t)throw Error(Se(300));return e}function W0(){var e=Bo!==0;return Bo=0,e}function Nn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jt===null?At.memoizedState=Jt=e:Jt=Jt.next=e,Jt}function cn(){if($t===null){var e=At.alternate;e=e!==null?e.memoizedState:null}else e=$t.next;var t=Jt===null?At.memoizedState:Jt.next;if(t!==null)Jt=t,$t=e;else{if(e===null)throw Error(Se(310));$t=e,e={memoizedState:$t.memoizedState,baseState:$t.baseState,baseQueue:$t.baseQueue,queue:$t.queue,next:null},Jt===null?At.memoizedState=Jt=e:Jt=Jt.next=e}return Jt}function Uo(e,t){return typeof t=="function"?t(e):t}function df(e){var t=cn(),r=t.queue;if(r===null)throw Error(Se(311));r.lastRenderedReducer=e;var n=$t,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var l=i.next;i.next=a.next,a.next=l}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var o=l=null,s=null,c=a;do{var d=c.lane;if((fa&d)===d)s!==null&&(s=s.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var f={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};s===null?(o=s=f,l=n):s=s.next=f,At.lanes|=d,ha|=d}c=c.next}while(c!==null&&c!==a);s===null?l=n:s.next=o,Tn(n,t.memoizedState)||(Nr=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=s,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do a=i.lane,At.lanes|=a,ha|=a,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function pf(e){var t=cn(),r=t.queue;if(r===null)throw Error(Se(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(i!==null){r.pending=null;var l=i=i.next;do a=e(a,l.action),l=l.next;while(l!==i);Tn(a,t.memoizedState)||(Nr=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function xx(){}function yx(e,t){var r=At,n=cn(),i=t(),a=!Tn(n.memoizedState,i);if(a&&(n.memoizedState=i,Nr=!0),n=n.queue,H0(Sx.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||Jt!==null&&Jt.memoizedState.tag&1){if(r.flags|=2048,Wo(9,wx.bind(null,r,n,i,t),void 0,null),er===null)throw Error(Se(349));fa&30||_x(r,t,i)}return i}function _x(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=At.updateQueue,t===null?(t={lastEffect:null,stores:null},At.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function wx(e,t,r,n){t.value=r,t.getSnapshot=n,kx(t)&&bx(e)}function Sx(e,t,r){return r(function(){kx(t)&&bx(e)})}function kx(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Tn(e,r)}catch{return!0}}function bx(e){var t=ei(e,1);t!==null&&Sn(t,e,1,-1)}function zp(e){var t=Nn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Uo,lastRenderedState:e},t.queue=e,e=e.dispatch=hS.bind(null,At,e),[t.memoizedState,e]}function Wo(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=At.updateQueue,t===null?(t={lastEffect:null,stores:null},At.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Tx(){return cn().memoizedState}function gc(e,t,r,n){var i=Nn();At.flags|=e,i.memoizedState=Wo(1|t,r,void 0,n===void 0?null:n)}function wu(e,t,r,n){var i=cn();n=n===void 0?null:n;var a=void 0;if($t!==null){var l=$t.memoizedState;if(a=l.destroy,n!==null&&B0(n,l.deps)){i.memoizedState=Wo(t,r,a,n);return}}At.flags|=e,i.memoizedState=Wo(1|t,r,a,n)}function Vp(e,t){return gc(8390656,8,e,t)}function H0(e,t){return wu(2048,8,e,t)}function Cx(e,t){return wu(4,2,e,t)}function Ex(e,t){return wu(4,4,e,t)}function Ax(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Ox(e,t,r){return r=r!=null?r.concat([e]):null,wu(4,4,Ax.bind(null,t,e),r)}function z0(){}function Fx(e,t){var r=cn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&B0(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Px(e,t){var r=cn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&B0(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Nx(e,t,r){return fa&21?(Tn(r,t)||(r=jv(),At.lanes|=r,ha|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Nr=!0),e.memoizedState=r)}function uS(e,t){var r=ct;ct=r!==0&&4>r?r:4,e(!0);var n=hf.transition;hf.transition={};try{e(!1),t()}finally{ct=r,hf.transition=n}}function Dx(){return cn().memoizedState}function fS(e,t,r){var n=Ai(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Rx(e))Ix(t,r);else if(r=gx(e,t,r,n),r!==null){var i=Tr();Sn(r,e,n,i),Mx(r,t,n)}}function hS(e,t,r){var n=Ai(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Rx(e))Ix(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var l=t.lastRenderedState,o=a(l,r);if(i.hasEagerState=!0,i.eagerState=o,Tn(o,l)){var s=t.interleaved;s===null?(i.next=i,R0(t)):(i.next=s.next,s.next=i),t.interleaved=i;return}}catch{}finally{}r=gx(e,t,i,n),r!==null&&(i=Tr(),Sn(r,e,n,i),Mx(r,t,n))}}function Rx(e){var t=e.alternate;return e===At||t!==null&&t===At}function Ix(e,t){uo=Bc=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Mx(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,_0(e,r)}}var Uc={readContext:ln,useCallback:ur,useContext:ur,useEffect:ur,useImperativeHandle:ur,useInsertionEffect:ur,useLayoutEffect:ur,useMemo:ur,useReducer:ur,useRef:ur,useState:ur,useDebugValue:ur,useDeferredValue:ur,useTransition:ur,useMutableSource:ur,useSyncExternalStore:ur,useId:ur,unstable_isNewReconciler:!1},dS={readContext:ln,useCallback:function(e,t){return Nn().memoizedState=[e,t===void 0?null:t],e},useContext:ln,useEffect:Vp,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,gc(4194308,4,Ax.bind(null,t,e),r)},useLayoutEffect:function(e,t){return gc(4194308,4,e,t)},useInsertionEffect:function(e,t){return gc(4,2,e,t)},useMemo:function(e,t){var r=Nn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Nn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=fS.bind(null,At,e),[n.memoizedState,e]},useRef:function(e){var t=Nn();return e={current:e},t.memoizedState=e},useState:zp,useDebugValue:z0,useDeferredValue:function(e){return Nn().memoizedState=e},useTransition:function(){var e=zp(!1),t=e[0];return e=uS.bind(null,e[1]),Nn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=At,i=Nn();if(_t){if(r===void 0)throw Error(Se(407));r=r()}else{if(r=t(),er===null)throw Error(Se(349));fa&30||_x(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,Vp(Sx.bind(null,n,a,e),[e]),n.flags|=2048,Wo(9,wx.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=Nn(),t=er.identifierPrefix;if(_t){var r=$n,n=Xn;r=(n&~(1<<32-wn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Bo++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=cS++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},pS={readContext:ln,useCallback:Fx,useContext:ln,useEffect:H0,useImperativeHandle:Ox,useInsertionEffect:Cx,useLayoutEffect:Ex,useMemo:Px,useReducer:df,useRef:Tx,useState:function(){return df(Uo)},useDebugValue:z0,useDeferredValue:function(e){var t=cn();return Nx(t,$t.memoizedState,e)},useTransition:function(){var e=df(Uo)[0],t=cn().memoizedState;return[e,t]},useMutableSource:xx,useSyncExternalStore:yx,useId:Dx,unstable_isNewReconciler:!1},gS={readContext:ln,useCallback:Fx,useContext:ln,useEffect:H0,useImperativeHandle:Ox,useInsertionEffect:Cx,useLayoutEffect:Ex,useMemo:Px,useReducer:pf,useRef:Tx,useState:function(){return pf(Uo)},useDebugValue:z0,useDeferredValue:function(e){var t=cn();return $t===null?t.memoizedState=e:Nx(t,$t.memoizedState,e)},useTransition:function(){var e=pf(Uo)[0],t=cn().memoizedState;return[e,t]},useMutableSource:xx,useSyncExternalStore:yx,useId:Dx,unstable_isNewReconciler:!1};function gn(e,t){if(e&&e.defaultProps){t=Ot({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function _h(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ot({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Su={isMounted:function(e){return(e=e._reactInternals)?Sa(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Tr(),i=Ai(e),a=Yn(n,i);a.payload=t,r!=null&&(a.callback=r),t=Ci(e,a,i),t!==null&&(Sn(t,e,i,n),dc(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Tr(),i=Ai(e),a=Yn(n,i);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Ci(e,a,i),t!==null&&(Sn(t,e,i,n),dc(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Tr(),n=Ai(e),i=Yn(r,n);i.tag=2,t!=null&&(i.callback=t),t=Ci(e,i,n),t!==null&&(Sn(t,e,n,r),dc(t,e,n))}};function Xp(e,t,r,n,i,a,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,l):t.prototype&&t.prototype.isPureReactComponent?!Do(r,n)||!Do(i,a):!0}function jx(e,t,r){var n=!1,i=Pi,a=t.contextType;return typeof a=="object"&&a!==null?a=ln(a):(i=Rr(t)?ca:yr.current,n=t.contextTypes,a=(n=n!=null)?ys(e,i):Pi),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Su,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function $p(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Su.enqueueReplaceState(t,t.state,null)}function wh(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},I0(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=ln(a):(a=Rr(t)?ca:yr.current,i.context=ys(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(_h(e,t,a,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Su.enqueueReplaceState(i,i.state,null),jc(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function ks(e,t){try{var r="",n=t;do r+=zw(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function gf(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Sh(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var mS=typeof WeakMap=="function"?WeakMap:Map;function Lx(e,t,r){r=Yn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Hc||(Hc=!0,Nh=n),Sh(e,t)},r}function Bx(e,t,r){r=Yn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Sh(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Sh(e,t),typeof n!="function"&&(Ei===null?Ei=new Set([this]):Ei.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function Gp(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new mS;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=FS.bind(null,e,t,r),t.then(e,e))}function Yp(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Kp(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Yn(-1,1),t.tag=2,Ci(r,t,1))),r.lanes|=1),e)}var vS=ii.ReactCurrentOwner,Nr=!1;function Sr(e,t,r,n){t.child=e===null?px(t,null,r,n):ws(t,e.child,r,n)}function qp(e,t,r,n,i){r=r.render;var a=t.ref;return cs(t,i),n=U0(e,t,r,n,a,i),r=W0(),e!==null&&!Nr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ti(e,t,i)):(_t&&r&&A0(t),t.flags|=1,Sr(e,t,n,i),t.child)}function Jp(e,t,r,n,i){if(e===null){var a=r.type;return typeof a=="function"&&!J0(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,Ux(e,t,a,n,i)):(e=yc(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var l=a.memoizedProps;if(r=r.compare,r=r!==null?r:Do,r(l,n)&&e.ref===t.ref)return ti(e,t,i)}return t.flags|=1,e=Oi(a,n),e.ref=t.ref,e.return=t,t.child=e}function Ux(e,t,r,n,i){if(e!==null){var a=e.memoizedProps;if(Do(a,n)&&e.ref===t.ref)if(Nr=!1,t.pendingProps=n=a,(e.lanes&i)!==0)e.flags&131072&&(Nr=!0);else return t.lanes=e.lanes,ti(e,t,i)}return kh(e,t,r,n,i)}function Wx(e,t,r){var n=t.pendingProps,i=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},dt(rs,Br),Br|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,dt(rs,Br),Br|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,dt(rs,Br),Br|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,dt(rs,Br),Br|=n;return Sr(e,t,i,r),t.child}function Hx(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function kh(e,t,r,n,i){var a=Rr(r)?ca:yr.current;return a=ys(t,a),cs(t,i),r=U0(e,t,r,n,a,i),n=W0(),e!==null&&!Nr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ti(e,t,i)):(_t&&n&&A0(t),t.flags|=1,Sr(e,t,r,i),t.child)}function Qp(e,t,r,n,i){if(Rr(r)){var a=!0;Nc(t)}else a=!1;if(cs(t,i),t.stateNode===null)mc(e,t),jx(t,r,n),wh(t,r,n,i),n=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var s=l.context,c=r.contextType;typeof c=="object"&&c!==null?c=ln(c):(c=Rr(r)?ca:yr.current,c=ys(t,c));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof l.getSnapshotBeforeUpdate=="function";f||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||s!==c)&&$p(t,l,n,c),di=!1;var h=t.memoizedState;l.state=h,jc(t,n,l,i),s=t.memoizedState,o!==n||h!==s||Dr.current||di?(typeof d=="function"&&(_h(t,r,d,n),s=t.memoizedState),(o=di||Xp(t,r,o,n,h,s,c))?(f||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=s),l.props=n,l.state=s,l.context=c,n=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,mx(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:gn(t.type,o),l.props=c,f=t.pendingProps,h=l.context,s=r.contextType,typeof s=="object"&&s!==null?s=ln(s):(s=Rr(r)?ca:yr.current,s=ys(t,s));var u=r.getDerivedStateFromProps;(d=typeof u=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==f||h!==s)&&$p(t,l,n,s),di=!1,h=t.memoizedState,l.state=h,jc(t,n,l,i);var p=t.memoizedState;o!==f||h!==p||Dr.current||di?(typeof u=="function"&&(_h(t,r,u,n),p=t.memoizedState),(c=di||Xp(t,r,c,n,h,p,s)||!1)?(d||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,p,s),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,p,s)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),l.props=n,l.state=p,l.context=s,n=c):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return bh(e,t,r,n,a,i)}function bh(e,t,r,n,i,a){Hx(e,t);var l=(t.flags&128)!==0;if(!n&&!l)return i&&jp(t,r,!1),ti(e,t,a);n=t.stateNode,vS.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&l?(t.child=ws(t,e.child,null,a),t.child=ws(t,null,o,a)):Sr(e,t,o,a),t.memoizedState=n.state,i&&jp(t,r,!0),t.child}function zx(e){var t=e.stateNode;t.pendingContext?Mp(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Mp(e,t.context,!1),M0(e,t.containerInfo)}function Zp(e,t,r,n,i){return _s(),F0(i),t.flags|=256,Sr(e,t,r,n),t.child}var Th={dehydrated:null,treeContext:null,retryLane:0};function Ch(e){return{baseLanes:e,cachePool:null,transitions:null}}function Vx(e,t,r){var n=t.pendingProps,i=Tt.current,a=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),dt(Tt,i&1),e===null)return xh(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=n.children,e=n.fallback,a?(n=t.mode,a=t.child,l={mode:"hidden",children:l},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=l):a=Tu(l,n,0,null),e=ia(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Ch(r),t.memoizedState=Th,e):V0(t,l));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return xS(e,t,l,n,o,i,r);if(a){a=n.fallback,l=t.mode,i=e.child,o=i.sibling;var s={mode:"hidden",children:n.children};return!(l&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=s,t.deletions=null):(n=Oi(i,s),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?a=Oi(o,a):(a=ia(a,l,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,l=e.child.memoizedState,l=l===null?Ch(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~r,t.memoizedState=Th,n}return a=e.child,e=a.sibling,n=Oi(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function V0(e,t){return t=Tu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ul(e,t,r,n){return n!==null&&F0(n),ws(t,e.child,null,r),e=V0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function xS(e,t,r,n,i,a,l){if(r)return t.flags&256?(t.flags&=-257,n=gf(Error(Se(422))),Ul(e,t,l,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,i=t.mode,n=Tu({mode:"visible",children:n.children},i,0,null),a=ia(a,i,l,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&ws(t,e.child,null,l),t.child.memoizedState=Ch(l),t.memoizedState=Th,a);if(!(t.mode&1))return Ul(e,t,l,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(Se(419)),n=gf(a,n,void 0),Ul(e,t,l,n)}if(o=(l&e.childLanes)!==0,Nr||o){if(n=er,n!==null){switch(l&-l){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|l)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,ei(e,i),Sn(n,e,i,-1))}return q0(),n=gf(Error(Se(421))),Ul(e,t,l,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=PS.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,Vr=Ti(i.nextSibling),Xr=t,_t=!0,xn=null,e!==null&&(rn[nn++]=Xn,rn[nn++]=$n,rn[nn++]=ua,Xn=e.id,$n=e.overflow,ua=t),t=V0(t,n.children),t.flags|=4096,t)}function eg(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),yh(e.return,t,r)}function mf(e,t,r,n,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function Xx(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(Sr(e,t,n.children,r),n=Tt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&eg(e,r,t);else if(e.tag===19)eg(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(dt(Tt,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Lc(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),mf(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Lc(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}mf(t,!0,r,null,a);break;case"together":mf(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function mc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ti(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ha|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Se(153));if(t.child!==null){for(e=t.child,r=Oi(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Oi(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function yS(e,t,r){switch(t.tag){case 3:zx(t),_s();break;case 5:vx(t);break;case 1:Rr(t.type)&&Nc(t);break;case 4:M0(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;dt(Ic,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(dt(Tt,Tt.current&1),t.flags|=128,null):r&t.child.childLanes?Vx(e,t,r):(dt(Tt,Tt.current&1),e=ti(e,t,r),e!==null?e.sibling:null);dt(Tt,Tt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Xx(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),dt(Tt,Tt.current),n)break;return null;case 22:case 23:return t.lanes=0,Wx(e,t,r)}return ti(e,t,r)}var $x,Eh,Gx,Yx;$x=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Eh=function(){};Gx=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,ea(Ln.current);var a=null;switch(r){case"input":i=Kf(e,i),n=Kf(e,n),a=[];break;case"select":i=Ot({},i,{value:void 0}),n=Ot({},n,{value:void 0}),a=[];break;case"textarea":i=Qf(e,i),n=Qf(e,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Fc)}eh(r,n);var l;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Co.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in n){var s=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&s!==o&&(s!=null||o!=null))if(c==="style")if(o){for(l in o)!o.hasOwnProperty(l)||s&&s.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in s)s.hasOwnProperty(l)&&o[l]!==s[l]&&(r||(r={}),r[l]=s[l])}else r||(a||(a=[]),a.push(c,r)),r=s;else c==="dangerouslySetInnerHTML"?(s=s?s.__html:void 0,o=o?o.__html:void 0,s!=null&&o!==s&&(a=a||[]).push(c,s)):c==="children"?typeof s!="string"&&typeof s!="number"||(a=a||[]).push(c,""+s):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Co.hasOwnProperty(c)?(s!=null&&c==="onScroll"&&pt("scroll",e),a||o===s||(a=[])):(a=a||[]).push(c,s))}r&&(a=a||[]).push("style",r);var c=a;(t.updateQueue=c)&&(t.flags|=4)}};Yx=function(e,t,r,n){r!==n&&(t.flags|=4)};function $s(e,t){if(!_t)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function fr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function _S(e,t,r){var n=t.pendingProps;switch(O0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fr(t),null;case 1:return Rr(t.type)&&Pc(),fr(t),null;case 3:return n=t.stateNode,Ss(),mt(Dr),mt(yr),L0(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ll(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,xn!==null&&(Ih(xn),xn=null))),Eh(e,t),fr(t),null;case 5:j0(t);var i=ea(Lo.current);if(r=t.type,e!==null&&t.stateNode!=null)Gx(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Se(166));return fr(t),null}if(e=ea(Ln.current),Ll(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[Dn]=t,n[Mo]=a,e=(t.mode&1)!==0,r){case"dialog":pt("cancel",n),pt("close",n);break;case"iframe":case"object":case"embed":pt("load",n);break;case"video":case"audio":for(i=0;i<eo.length;i++)pt(eo[i],n);break;case"source":pt("error",n);break;case"img":case"image":case"link":pt("error",n),pt("load",n);break;case"details":pt("toggle",n);break;case"input":cp(n,a),pt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},pt("invalid",n);break;case"textarea":fp(n,a),pt("invalid",n)}eh(r,a),i=null;for(var l in a)if(a.hasOwnProperty(l)){var o=a[l];l==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&jl(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&jl(n.textContent,o,e),i=["children",""+o]):Co.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&pt("scroll",n)}switch(r){case"input":Ol(n),up(n,a,!0);break;case"textarea":Ol(n),hp(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Fc)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{l=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Sv(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),r==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[Dn]=t,e[Mo]=n,$x(e,t,!1,!1),t.stateNode=e;e:{switch(l=th(r,n),r){case"dialog":pt("cancel",e),pt("close",e),i=n;break;case"iframe":case"object":case"embed":pt("load",e),i=n;break;case"video":case"audio":for(i=0;i<eo.length;i++)pt(eo[i],e);i=n;break;case"source":pt("error",e),i=n;break;case"img":case"image":case"link":pt("error",e),pt("load",e),i=n;break;case"details":pt("toggle",e),i=n;break;case"input":cp(e,n),i=Kf(e,n),pt("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Ot({},n,{value:void 0}),pt("invalid",e);break;case"textarea":fp(e,n),i=Qf(e,n),pt("invalid",e);break;default:i=n}eh(r,i),o=i;for(a in o)if(o.hasOwnProperty(a)){var s=o[a];a==="style"?Tv(e,s):a==="dangerouslySetInnerHTML"?(s=s?s.__html:void 0,s!=null&&kv(e,s)):a==="children"?typeof s=="string"?(r!=="textarea"||s!=="")&&Eo(e,s):typeof s=="number"&&Eo(e,""+s):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Co.hasOwnProperty(a)?s!=null&&a==="onScroll"&&pt("scroll",e):s!=null&&p0(e,a,s,l))}switch(r){case"input":Ol(e),up(e,n,!1);break;case"textarea":Ol(e),hp(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Fi(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?as(e,!!n.multiple,a,!1):n.defaultValue!=null&&as(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Fc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return fr(t),null;case 6:if(e&&t.stateNode!=null)Yx(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Se(166));if(r=ea(Lo.current),ea(Ln.current),Ll(t)){if(n=t.stateNode,r=t.memoizedProps,n[Dn]=t,(a=n.nodeValue!==r)&&(e=Xr,e!==null))switch(e.tag){case 3:jl(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&jl(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Dn]=t,t.stateNode=n}return fr(t),null;case 13:if(mt(Tt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(_t&&Vr!==null&&t.mode&1&&!(t.flags&128))hx(),_s(),t.flags|=98560,a=!1;else if(a=Ll(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(Se(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Se(317));a[Dn]=t}else _s(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;fr(t),a=!1}else xn!==null&&(Ih(xn),xn=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Tt.current&1?Yt===0&&(Yt=3):q0())),t.updateQueue!==null&&(t.flags|=4),fr(t),null);case 4:return Ss(),Eh(e,t),e===null&&Ro(t.stateNode.containerInfo),fr(t),null;case 10:return D0(t.type._context),fr(t),null;case 17:return Rr(t.type)&&Pc(),fr(t),null;case 19:if(mt(Tt),a=t.memoizedState,a===null)return fr(t),null;if(n=(t.flags&128)!==0,l=a.rendering,l===null)if(n)$s(a,!1);else{if(Yt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=Lc(e),l!==null){for(t.flags|=128,$s(a,!1),n=l.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,l=a.alternate,l===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return dt(Tt,Tt.current&1|2),t.child}e=e.sibling}a.tail!==null&&jt()>bs&&(t.flags|=128,n=!0,$s(a,!1),t.lanes=4194304)}else{if(!n)if(e=Lc(l),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),$s(a,!0),a.tail===null&&a.tailMode==="hidden"&&!l.alternate&&!_t)return fr(t),null}else 2*jt()-a.renderingStartTime>bs&&r!==1073741824&&(t.flags|=128,n=!0,$s(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(r=a.last,r!==null?r.sibling=l:t.child=l,a.last=l)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=jt(),t.sibling=null,r=Tt.current,dt(Tt,n?r&1|2:r&1),t):(fr(t),null);case 22:case 23:return K0(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Br&1073741824&&(fr(t),t.subtreeFlags&6&&(t.flags|=8192)):fr(t),null;case 24:return null;case 25:return null}throw Error(Se(156,t.tag))}function wS(e,t){switch(O0(t),t.tag){case 1:return Rr(t.type)&&Pc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ss(),mt(Dr),mt(yr),L0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return j0(t),null;case 13:if(mt(Tt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Se(340));_s()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return mt(Tt),null;case 4:return Ss(),null;case 10:return D0(t.type._context),null;case 22:case 23:return K0(),null;case 24:return null;default:return null}}var Wl=!1,gr=!1,SS=typeof WeakSet=="function"?WeakSet:Set,Pe=null;function ts(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Pt(e,t,n)}else r.current=null}function Ah(e,t,r){try{r()}catch(n){Pt(e,t,n)}}var tg=!1;function kS(e,t){if(fh=Ec,e=Zv(),E0(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var l=0,o=-1,s=-1,c=0,d=0,f=e,h=null;t:for(;;){for(var u;f!==r||i!==0&&f.nodeType!==3||(o=l+i),f!==a||n!==0&&f.nodeType!==3||(s=l+n),f.nodeType===3&&(l+=f.nodeValue.length),(u=f.firstChild)!==null;)h=f,f=u;for(;;){if(f===e)break t;if(h===r&&++c===i&&(o=l),h===a&&++d===n&&(s=l),(u=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=u}r=o===-1||s===-1?null:{start:o,end:s}}else r=null}r=r||{start:0,end:0}}else r=null;for(hh={focusedElem:e,selectionRange:r},Ec=!1,Pe=t;Pe!==null;)if(t=Pe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Pe=e;else for(;Pe!==null;){t=Pe;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,v=t.stateNode,x=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:gn(t.type,m),g);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Se(163))}}catch(_){Pt(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,Pe=e;break}Pe=t.return}return p=tg,tg=!1,p}function fo(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&Ah(t,r,a)}i=i.next}while(i!==n)}}function ku(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Oh(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Kx(e){var t=e.alternate;t!==null&&(e.alternate=null,Kx(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Dn],delete t[Mo],delete t[gh],delete t[aS],delete t[sS])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function qx(e){return e.tag===5||e.tag===3||e.tag===4}function rg(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||qx(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Fh(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Fc));else if(n!==4&&(e=e.child,e!==null))for(Fh(e,t,r),e=e.sibling;e!==null;)Fh(e,t,r),e=e.sibling}function Ph(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Ph(e,t,r),e=e.sibling;e!==null;)Ph(e,t,r),e=e.sibling}var ir=null,mn=!1;function ci(e,t,r){for(r=r.child;r!==null;)Jx(e,t,r),r=r.sibling}function Jx(e,t,r){if(jn&&typeof jn.onCommitFiberUnmount=="function")try{jn.onCommitFiberUnmount(gu,r)}catch{}switch(r.tag){case 5:gr||ts(r,t);case 6:var n=ir,i=mn;ir=null,ci(e,t,r),ir=n,mn=i,ir!==null&&(mn?(e=ir,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ir.removeChild(r.stateNode));break;case 18:ir!==null&&(mn?(e=ir,r=r.stateNode,e.nodeType===8?cf(e.parentNode,r):e.nodeType===1&&cf(e,r),Po(e)):cf(ir,r.stateNode));break;case 4:n=ir,i=mn,ir=r.stateNode.containerInfo,mn=!0,ci(e,t,r),ir=n,mn=i;break;case 0:case 11:case 14:case 15:if(!gr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,l=a.destroy;a=a.tag,l!==void 0&&(a&2||a&4)&&Ah(r,t,l),i=i.next}while(i!==n)}ci(e,t,r);break;case 1:if(!gr&&(ts(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Pt(r,t,o)}ci(e,t,r);break;case 21:ci(e,t,r);break;case 22:r.mode&1?(gr=(n=gr)||r.memoizedState!==null,ci(e,t,r),gr=n):ci(e,t,r);break;default:ci(e,t,r)}}function ng(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new SS),t.forEach(function(n){var i=NS.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function hn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:ir=o.stateNode,mn=!1;break e;case 3:ir=o.stateNode.containerInfo,mn=!0;break e;case 4:ir=o.stateNode.containerInfo,mn=!0;break e}o=o.return}if(ir===null)throw Error(Se(160));Jx(a,l,i),ir=null,mn=!1;var s=i.alternate;s!==null&&(s.return=null),i.return=null}catch(c){Pt(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Qx(t,e),t=t.sibling}function Qx(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(hn(t,e),An(e),n&4){try{fo(3,e,e.return),ku(3,e)}catch(m){Pt(e,e.return,m)}try{fo(5,e,e.return)}catch(m){Pt(e,e.return,m)}}break;case 1:hn(t,e),An(e),n&512&&r!==null&&ts(r,r.return);break;case 5:if(hn(t,e),An(e),n&512&&r!==null&&ts(r,r.return),e.flags&32){var i=e.stateNode;try{Eo(i,"")}catch(m){Pt(e,e.return,m)}}if(n&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,l=r!==null?r.memoizedProps:a,o=e.type,s=e.updateQueue;if(e.updateQueue=null,s!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&_v(i,a),th(o,l);var c=th(o,a);for(l=0;l<s.length;l+=2){var d=s[l],f=s[l+1];d==="style"?Tv(i,f):d==="dangerouslySetInnerHTML"?kv(i,f):d==="children"?Eo(i,f):p0(i,d,f,c)}switch(o){case"input":qf(i,a);break;case"textarea":wv(i,a);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var u=a.value;u!=null?as(i,!!a.multiple,u,!1):h!==!!a.multiple&&(a.defaultValue!=null?as(i,!!a.multiple,a.defaultValue,!0):as(i,!!a.multiple,a.multiple?[]:"",!1))}i[Mo]=a}catch(m){Pt(e,e.return,m)}}break;case 6:if(hn(t,e),An(e),n&4){if(e.stateNode===null)throw Error(Se(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(m){Pt(e,e.return,m)}}break;case 3:if(hn(t,e),An(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Po(t.containerInfo)}catch(m){Pt(e,e.return,m)}break;case 4:hn(t,e),An(e);break;case 13:hn(t,e),An(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(G0=jt())),n&4&&ng(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(gr=(c=gr)||d,hn(t,e),gr=c):hn(t,e),An(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!d&&e.mode&1)for(Pe=e,d=e.child;d!==null;){for(f=Pe=d;Pe!==null;){switch(h=Pe,u=h.child,h.tag){case 0:case 11:case 14:case 15:fo(4,h,h.return);break;case 1:ts(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){Pt(n,r,m)}}break;case 5:ts(h,h.return);break;case 22:if(h.memoizedState!==null){ag(f);continue}}u!==null?(u.return=h,Pe=u):ag(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,c?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=f.stateNode,s=f.memoizedProps.style,l=s!=null&&s.hasOwnProperty("display")?s.display:null,o.style.display=bv("display",l))}catch(m){Pt(e,e.return,m)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(m){Pt(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:hn(t,e),An(e),n&4&&ng(e);break;case 21:break;default:hn(t,e),An(e)}}function An(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(qx(r)){var n=r;break e}r=r.return}throw Error(Se(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Eo(i,""),n.flags&=-33);var a=rg(e);Ph(e,a,i);break;case 3:case 4:var l=n.stateNode.containerInfo,o=rg(e);Fh(e,o,l);break;default:throw Error(Se(161))}}catch(s){Pt(e,e.return,s)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function bS(e,t,r){Pe=e,Zx(e)}function Zx(e,t,r){for(var n=(e.mode&1)!==0;Pe!==null;){var i=Pe,a=i.child;if(i.tag===22&&n){var l=i.memoizedState!==null||Wl;if(!l){var o=i.alternate,s=o!==null&&o.memoizedState!==null||gr;o=Wl;var c=gr;if(Wl=l,(gr=s)&&!c)for(Pe=i;Pe!==null;)l=Pe,s=l.child,l.tag===22&&l.memoizedState!==null?sg(i):s!==null?(s.return=l,Pe=s):sg(i);for(;a!==null;)Pe=a,Zx(a),a=a.sibling;Pe=i,Wl=o,gr=c}ig(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,Pe=a):ig(e)}}function ig(e){for(;Pe!==null;){var t=Pe;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:gr||ku(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!gr)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:gn(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Hp(t,a,n);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Hp(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var s=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":s.autoFocus&&r.focus();break;case"img":s.src&&(r.src=s.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Po(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Se(163))}gr||t.flags&512&&Oh(t)}catch(h){Pt(t,t.return,h)}}if(t===e){Pe=null;break}if(r=t.sibling,r!==null){r.return=t.return,Pe=r;break}Pe=t.return}}function ag(e){for(;Pe!==null;){var t=Pe;if(t===e){Pe=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Pe=r;break}Pe=t.return}}function sg(e){for(;Pe!==null;){var t=Pe;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{ku(4,t)}catch(s){Pt(t,r,s)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(s){Pt(t,i,s)}}var a=t.return;try{Oh(t)}catch(s){Pt(t,a,s)}break;case 5:var l=t.return;try{Oh(t)}catch(s){Pt(t,l,s)}}}catch(s){Pt(t,t.return,s)}if(t===e){Pe=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Pe=o;break}Pe=t.return}}var TS=Math.ceil,Wc=ii.ReactCurrentDispatcher,X0=ii.ReactCurrentOwner,sn=ii.ReactCurrentBatchConfig,et=0,er=null,Vt=null,or=0,Br=0,rs=ji(0),Yt=0,Ho=null,ha=0,bu=0,$0=0,ho=null,Pr=null,G0=0,bs=1/0,Hn=null,Hc=!1,Nh=null,Ei=null,Hl=!1,yi=null,zc=0,po=0,Dh=null,vc=-1,xc=0;function Tr(){return et&6?jt():vc!==-1?vc:vc=jt()}function Ai(e){return e.mode&1?et&2&&or!==0?or&-or:lS.transition!==null?(xc===0&&(xc=jv()),xc):(e=ct,e!==0||(e=window.event,e=e===void 0?16:Vv(e.type)),e):1}function Sn(e,t,r,n){if(50<po)throw po=0,Dh=null,Error(Se(185));fl(e,r,n),(!(et&2)||e!==er)&&(e===er&&(!(et&2)&&(bu|=r),Yt===4&&mi(e,or)),Ir(e,n),r===1&&et===0&&!(t.mode&1)&&(bs=jt()+500,_u&&Li()))}function Ir(e,t){var r=e.callbackNode;l2(e,t);var n=Cc(e,e===er?or:0);if(n===0)r!==null&&gp(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&gp(r),t===1)e.tag===0?oS(og.bind(null,e)):cx(og.bind(null,e)),nS(function(){!(et&6)&&Li()}),r=null;else{switch(Lv(n)){case 1:r=y0;break;case 4:r=Iv;break;case 16:r=Tc;break;case 536870912:r=Mv;break;default:r=Tc}r=o1(r,e1.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function e1(e,t){if(vc=-1,xc=0,et&6)throw Error(Se(327));var r=e.callbackNode;if(us()&&e.callbackNode!==r)return null;var n=Cc(e,e===er?or:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Vc(e,n);else{t=n;var i=et;et|=2;var a=r1();(er!==e||or!==t)&&(Hn=null,bs=jt()+500,na(e,t));do try{AS();break}catch(o){t1(e,o)}while(!0);N0(),Wc.current=a,et=i,Vt!==null?t=0:(er=null,or=0,t=Yt)}if(t!==0){if(t===2&&(i=sh(e),i!==0&&(n=i,t=Rh(e,i))),t===1)throw r=Ho,na(e,0),mi(e,n),Ir(e,jt()),r;if(t===6)mi(e,n);else{if(i=e.current.alternate,!(n&30)&&!CS(i)&&(t=Vc(e,n),t===2&&(a=sh(e),a!==0&&(n=a,t=Rh(e,a))),t===1))throw r=Ho,na(e,0),mi(e,n),Ir(e,jt()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Se(345));case 2:$i(e,Pr,Hn);break;case 3:if(mi(e,n),(n&130023424)===n&&(t=G0+500-jt(),10<t)){if(Cc(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Tr(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ph($i.bind(null,e,Pr,Hn),t);break}$i(e,Pr,Hn);break;case 4:if(mi(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var l=31-wn(n);a=1<<l,l=t[l],l>i&&(i=l),n&=~a}if(n=i,n=jt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*TS(n/1960))-n,10<n){e.timeoutHandle=ph($i.bind(null,e,Pr,Hn),n);break}$i(e,Pr,Hn);break;case 5:$i(e,Pr,Hn);break;default:throw Error(Se(329))}}}return Ir(e,jt()),e.callbackNode===r?e1.bind(null,e):null}function Rh(e,t){var r=ho;return e.current.memoizedState.isDehydrated&&(na(e,t).flags|=256),e=Vc(e,t),e!==2&&(t=Pr,Pr=r,t!==null&&Ih(t)),e}function Ih(e){Pr===null?Pr=e:Pr.push.apply(Pr,e)}function CS(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!Tn(a(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function mi(e,t){for(t&=~$0,t&=~bu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-wn(t),n=1<<r;e[r]=-1,t&=~n}}function og(e){if(et&6)throw Error(Se(327));us();var t=Cc(e,0);if(!(t&1))return Ir(e,jt()),null;var r=Vc(e,t);if(e.tag!==0&&r===2){var n=sh(e);n!==0&&(t=n,r=Rh(e,n))}if(r===1)throw r=Ho,na(e,0),mi(e,t),Ir(e,jt()),r;if(r===6)throw Error(Se(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,$i(e,Pr,Hn),Ir(e,jt()),null}function Y0(e,t){var r=et;et|=1;try{return e(t)}finally{et=r,et===0&&(bs=jt()+500,_u&&Li())}}function da(e){yi!==null&&yi.tag===0&&!(et&6)&&us();var t=et;et|=1;var r=sn.transition,n=ct;try{if(sn.transition=null,ct=1,e)return e()}finally{ct=n,sn.transition=r,et=t,!(et&6)&&Li()}}function K0(){Br=rs.current,mt(rs)}function na(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,rS(r)),Vt!==null)for(r=Vt.return;r!==null;){var n=r;switch(O0(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Pc();break;case 3:Ss(),mt(Dr),mt(yr),L0();break;case 5:j0(n);break;case 4:Ss();break;case 13:mt(Tt);break;case 19:mt(Tt);break;case 10:D0(n.type._context);break;case 22:case 23:K0()}r=r.return}if(er=e,Vt=e=Oi(e.current,null),or=Br=t,Yt=0,Ho=null,$0=bu=ha=0,Pr=ho=null,Zi!==null){for(t=0;t<Zi.length;t++)if(r=Zi[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var l=a.next;a.next=i,n.next=l}r.pending=n}Zi=null}return e}function t1(e,t){do{var r=Vt;try{if(N0(),pc.current=Uc,Bc){for(var n=At.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Bc=!1}if(fa=0,Jt=$t=At=null,uo=!1,Bo=0,X0.current=null,r===null||r.return===null){Yt=1,Ho=t,Vt=null;break}e:{var a=e,l=r.return,o=r,s=t;if(t=or,o.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){var c=s,d=o,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var u=Yp(l);if(u!==null){u.flags&=-257,Kp(u,l,o,a,t),u.mode&1&&Gp(a,c,t),t=u,s=c;var p=t.updateQueue;if(p===null){var m=new Set;m.add(s),t.updateQueue=m}else p.add(s);break e}else{if(!(t&1)){Gp(a,c,t),q0();break e}s=Error(Se(426))}}else if(_t&&o.mode&1){var g=Yp(l);if(g!==null){!(g.flags&65536)&&(g.flags|=256),Kp(g,l,o,a,t),F0(ks(s,o));break e}}a=s=ks(s,o),Yt!==4&&(Yt=2),ho===null?ho=[a]:ho.push(a),a=l;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var v=Lx(a,s,t);Wp(a,v);break e;case 1:o=s;var x=a.type,y=a.stateNode;if(!(a.flags&128)&&(typeof x.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Ei===null||!Ei.has(y)))){a.flags|=65536,t&=-t,a.lanes|=t;var _=Bx(a,o,t);Wp(a,_);break e}}a=a.return}while(a!==null)}i1(r)}catch(w){t=w,Vt===r&&r!==null&&(Vt=r=r.return);continue}break}while(!0)}function r1(){var e=Wc.current;return Wc.current=Uc,e===null?Uc:e}function q0(){(Yt===0||Yt===3||Yt===2)&&(Yt=4),er===null||!(ha&268435455)&&!(bu&268435455)||mi(er,or)}function Vc(e,t){var r=et;et|=2;var n=r1();(er!==e||or!==t)&&(Hn=null,na(e,t));do try{ES();break}catch(i){t1(e,i)}while(!0);if(N0(),et=r,Wc.current=n,Vt!==null)throw Error(Se(261));return er=null,or=0,Yt}function ES(){for(;Vt!==null;)n1(Vt)}function AS(){for(;Vt!==null&&!Zw();)n1(Vt)}function n1(e){var t=s1(e.alternate,e,Br);e.memoizedProps=e.pendingProps,t===null?i1(e):Vt=t,X0.current=null}function i1(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=wS(r,t),r!==null){r.flags&=32767,Vt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Yt=6,Vt=null;return}}else if(r=_S(r,t,Br),r!==null){Vt=r;return}if(t=t.sibling,t!==null){Vt=t;return}Vt=t=e}while(t!==null);Yt===0&&(Yt=5)}function $i(e,t,r){var n=ct,i=sn.transition;try{sn.transition=null,ct=1,OS(e,t,r,n)}finally{sn.transition=i,ct=n}return null}function OS(e,t,r,n){do us();while(yi!==null);if(et&6)throw Error(Se(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Se(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(c2(e,a),e===er&&(Vt=er=null,or=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Hl||(Hl=!0,o1(Tc,function(){return us(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=sn.transition,sn.transition=null;var l=ct;ct=1;var o=et;et|=4,X0.current=null,kS(e,r),Qx(r,e),K2(hh),Ec=!!fh,hh=fh=null,e.current=r,bS(r),e2(),et=o,ct=l,sn.transition=a}else e.current=r;if(Hl&&(Hl=!1,yi=e,zc=i),a=e.pendingLanes,a===0&&(Ei=null),n2(r.stateNode),Ir(e,jt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Hc)throw Hc=!1,e=Nh,Nh=null,e;return zc&1&&e.tag!==0&&us(),a=e.pendingLanes,a&1?e===Dh?po++:(po=0,Dh=e):po=0,Li(),null}function us(){if(yi!==null){var e=Lv(zc),t=sn.transition,r=ct;try{if(sn.transition=null,ct=16>e?16:e,yi===null)var n=!1;else{if(e=yi,yi=null,zc=0,et&6)throw Error(Se(331));var i=et;for(et|=4,Pe=e.current;Pe!==null;){var a=Pe,l=a.child;if(Pe.flags&16){var o=a.deletions;if(o!==null){for(var s=0;s<o.length;s++){var c=o[s];for(Pe=c;Pe!==null;){var d=Pe;switch(d.tag){case 0:case 11:case 15:fo(8,d,a)}var f=d.child;if(f!==null)f.return=d,Pe=f;else for(;Pe!==null;){d=Pe;var h=d.sibling,u=d.return;if(Kx(d),d===c){Pe=null;break}if(h!==null){h.return=u,Pe=h;break}Pe=u}}}var p=a.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}Pe=a}}if(a.subtreeFlags&2064&&l!==null)l.return=a,Pe=l;else e:for(;Pe!==null;){if(a=Pe,a.flags&2048)switch(a.tag){case 0:case 11:case 15:fo(9,a,a.return)}var v=a.sibling;if(v!==null){v.return=a.return,Pe=v;break e}Pe=a.return}}var x=e.current;for(Pe=x;Pe!==null;){l=Pe;var y=l.child;if(l.subtreeFlags&2064&&y!==null)y.return=l,Pe=y;else e:for(l=x;Pe!==null;){if(o=Pe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:ku(9,o)}}catch(w){Pt(o,o.return,w)}if(o===l){Pe=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,Pe=_;break e}Pe=o.return}}if(et=i,Li(),jn&&typeof jn.onPostCommitFiberRoot=="function")try{jn.onPostCommitFiberRoot(gu,e)}catch{}n=!0}return n}finally{ct=r,sn.transition=t}}return!1}function lg(e,t,r){t=ks(r,t),t=Lx(e,t,1),e=Ci(e,t,1),t=Tr(),e!==null&&(fl(e,1,t),Ir(e,t))}function Pt(e,t,r){if(e.tag===3)lg(e,e,r);else for(;t!==null;){if(t.tag===3){lg(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ei===null||!Ei.has(n))){e=ks(r,e),e=Bx(t,e,1),t=Ci(t,e,1),e=Tr(),t!==null&&(fl(t,1,e),Ir(t,e));break}}t=t.return}}function FS(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Tr(),e.pingedLanes|=e.suspendedLanes&r,er===e&&(or&r)===r&&(Yt===4||Yt===3&&(or&130023424)===or&&500>jt()-G0?na(e,0):$0|=r),Ir(e,t)}function a1(e,t){t===0&&(e.mode&1?(t=Nl,Nl<<=1,!(Nl&130023424)&&(Nl=4194304)):t=1);var r=Tr();e=ei(e,t),e!==null&&(fl(e,t,r),Ir(e,r))}function PS(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),a1(e,r)}function NS(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Se(314))}n!==null&&n.delete(t),a1(e,r)}var s1;s1=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Dr.current)Nr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Nr=!1,yS(e,t,r);Nr=!!(e.flags&131072)}else Nr=!1,_t&&t.flags&1048576&&ux(t,Rc,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;mc(e,t),e=t.pendingProps;var i=ys(t,yr.current);cs(t,r),i=U0(null,t,n,e,i,r);var a=W0();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Rr(n)?(a=!0,Nc(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,I0(t),i.updater=Su,t.stateNode=i,i._reactInternals=t,wh(t,n,e,r),t=bh(null,t,n,!0,a,r)):(t.tag=0,_t&&a&&A0(t),Sr(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(mc(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=RS(n),e=gn(n,e),i){case 0:t=kh(null,t,n,e,r);break e;case 1:t=Qp(null,t,n,e,r);break e;case 11:t=qp(null,t,n,e,r);break e;case 14:t=Jp(null,t,n,gn(n.type,e),r);break e}throw Error(Se(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:gn(n,i),kh(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:gn(n,i),Qp(e,t,n,i,r);case 3:e:{if(zx(t),e===null)throw Error(Se(387));n=t.pendingProps,a=t.memoizedState,i=a.element,mx(e,t),jc(t,n,null,r);var l=t.memoizedState;if(n=l.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=ks(Error(Se(423)),t),t=Zp(e,t,n,r,i);break e}else if(n!==i){i=ks(Error(Se(424)),t),t=Zp(e,t,n,r,i);break e}else for(Vr=Ti(t.stateNode.containerInfo.firstChild),Xr=t,_t=!0,xn=null,r=px(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(_s(),n===i){t=ti(e,t,r);break e}Sr(e,t,n,r)}t=t.child}return t;case 5:return vx(t),e===null&&xh(t),n=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,l=i.children,dh(n,i)?l=null:a!==null&&dh(n,a)&&(t.flags|=32),Hx(e,t),Sr(e,t,l,r),t.child;case 6:return e===null&&xh(t),null;case 13:return Vx(e,t,r);case 4:return M0(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ws(t,null,n,r):Sr(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:gn(n,i),qp(e,t,n,i,r);case 7:return Sr(e,t,t.pendingProps,r),t.child;case 8:return Sr(e,t,t.pendingProps.children,r),t.child;case 12:return Sr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,l=i.value,dt(Ic,n._currentValue),n._currentValue=l,a!==null)if(Tn(a.value,l)){if(a.children===i.children&&!Dr.current){t=ti(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){l=a.child;for(var s=o.firstContext;s!==null;){if(s.context===n){if(a.tag===1){s=Yn(-1,r&-r),s.tag=2;var c=a.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?s.next=s:(s.next=d.next,d.next=s),c.pending=s}}a.lanes|=r,s=a.alternate,s!==null&&(s.lanes|=r),yh(a.return,r,t),o.lanes|=r;break}s=s.next}}else if(a.tag===10)l=a.type===t.type?null:a.child;else if(a.tag===18){if(l=a.return,l===null)throw Error(Se(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),yh(l,r,t),l=a.sibling}else l=a.child;if(l!==null)l.return=a;else for(l=a;l!==null;){if(l===t){l=null;break}if(a=l.sibling,a!==null){a.return=l.return,l=a;break}l=l.return}a=l}Sr(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,cs(t,r),i=ln(i),n=n(i),t.flags|=1,Sr(e,t,n,r),t.child;case 14:return n=t.type,i=gn(n,t.pendingProps),i=gn(n.type,i),Jp(e,t,n,i,r);case 15:return Ux(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:gn(n,i),mc(e,t),t.tag=1,Rr(n)?(e=!0,Nc(t)):e=!1,cs(t,r),jx(t,n,i),wh(t,n,i,r),bh(null,t,n,!0,e,r);case 19:return Xx(e,t,r);case 22:return Wx(e,t,r)}throw Error(Se(156,t.tag))};function o1(e,t){return Rv(e,t)}function DS(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function an(e,t,r,n){return new DS(e,t,r,n)}function J0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function RS(e){if(typeof e=="function")return J0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===m0)return 11;if(e===v0)return 14}return 2}function Oi(e,t){var r=e.alternate;return r===null?(r=an(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function yc(e,t,r,n,i,a){var l=2;if(n=e,typeof e=="function")J0(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case $a:return ia(r.children,i,a,t);case g0:l=8,i|=8;break;case Xf:return e=an(12,r,t,i|2),e.elementType=Xf,e.lanes=a,e;case $f:return e=an(13,r,t,i),e.elementType=$f,e.lanes=a,e;case Gf:return e=an(19,r,t,i),e.elementType=Gf,e.lanes=a,e;case vv:return Tu(r,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case gv:l=10;break e;case mv:l=9;break e;case m0:l=11;break e;case v0:l=14;break e;case hi:l=16,n=null;break e}throw Error(Se(130,e==null?e:typeof e,""))}return t=an(l,r,t,i),t.elementType=e,t.type=n,t.lanes=a,t}function ia(e,t,r,n){return e=an(7,e,n,t),e.lanes=r,e}function Tu(e,t,r,n){return e=an(22,e,n,t),e.elementType=vv,e.lanes=r,e.stateNode={isHidden:!1},e}function vf(e,t,r){return e=an(6,e,null,t),e.lanes=r,e}function xf(e,t,r){return t=an(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function IS(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ju(0),this.expirationTimes=Ju(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ju(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Q0(e,t,r,n,i,a,l,o,s){return e=new IS(e,t,r,o,s),t===1?(t=1,a===!0&&(t|=8)):t=0,a=an(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},I0(a),e}function MS(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Xa,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function l1(e){if(!e)return Pi;e=e._reactInternals;e:{if(Sa(e)!==e||e.tag!==1)throw Error(Se(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Rr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Se(171))}if(e.tag===1){var r=e.type;if(Rr(r))return lx(e,r,t)}return t}function c1(e,t,r,n,i,a,l,o,s){return e=Q0(r,n,!0,e,i,a,l,o,s),e.context=l1(null),r=e.current,n=Tr(),i=Ai(r),a=Yn(n,i),a.callback=t??null,Ci(r,a,i),e.current.lanes=i,fl(e,i,n),Ir(e,n),e}function Cu(e,t,r,n){var i=t.current,a=Tr(),l=Ai(i);return r=l1(r),t.context===null?t.context=r:t.pendingContext=r,t=Yn(a,l),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ci(i,t,l),e!==null&&(Sn(e,i,l,a),dc(e,i,l)),l}function Xc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function cg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Z0(e,t){cg(e,t),(e=e.alternate)&&cg(e,t)}function jS(){return null}var u1=typeof reportError=="function"?reportError:function(e){console.error(e)};function ed(e){this._internalRoot=e}Eu.prototype.render=ed.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Se(409));Cu(e,t,null,null)};Eu.prototype.unmount=ed.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;da(function(){Cu(null,e,null,null)}),t[Zn]=null}};function Eu(e){this._internalRoot=e}Eu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Wv();e={blockedOn:null,target:e,priority:t};for(var r=0;r<gi.length&&t!==0&&t<gi[r].priority;r++);gi.splice(r,0,e),r===0&&zv(e)}};function td(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Au(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ug(){}function LS(e,t,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var c=Xc(l);a.call(c)}}var l=c1(t,n,e,0,null,!1,!1,"",ug);return e._reactRootContainer=l,e[Zn]=l.current,Ro(e.nodeType===8?e.parentNode:e),da(),l}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=Xc(s);o.call(c)}}var s=Q0(e,0,!1,null,null,!1,!1,"",ug);return e._reactRootContainer=s,e[Zn]=s.current,Ro(e.nodeType===8?e.parentNode:e),da(function(){Cu(t,s,r,n)}),s}function Ou(e,t,r,n,i){var a=r._reactRootContainer;if(a){var l=a;if(typeof i=="function"){var o=i;i=function(){var s=Xc(l);o.call(s)}}Cu(t,l,e,i)}else l=LS(r,t,e,i,n);return Xc(l)}Bv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Zs(t.pendingLanes);r!==0&&(_0(t,r|1),Ir(t,jt()),!(et&6)&&(bs=jt()+500,Li()))}break;case 13:da(function(){var n=ei(e,1);if(n!==null){var i=Tr();Sn(n,e,1,i)}}),Z0(e,1)}};w0=function(e){if(e.tag===13){var t=ei(e,134217728);if(t!==null){var r=Tr();Sn(t,e,134217728,r)}Z0(e,134217728)}};Uv=function(e){if(e.tag===13){var t=Ai(e),r=ei(e,t);if(r!==null){var n=Tr();Sn(r,e,t,n)}Z0(e,t)}};Wv=function(){return ct};Hv=function(e,t){var r=ct;try{return ct=e,t()}finally{ct=r}};nh=function(e,t,r){switch(t){case"input":if(qf(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=yu(n);if(!i)throw Error(Se(90));yv(n),qf(n,i)}}}break;case"textarea":wv(e,r);break;case"select":t=r.value,t!=null&&as(e,!!r.multiple,t,!1)}};Av=Y0;Ov=da;var BS={usingClientEntryPoint:!1,Events:[dl,qa,yu,Cv,Ev,Y0]},Gs={findFiberByHostInstance:Qi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},US={bundleType:Gs.bundleType,version:Gs.version,rendererPackageName:Gs.rendererPackageName,rendererConfig:Gs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ii.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Nv(e),e===null?null:e.stateNode},findFiberByHostInstance:Gs.findFiberByHostInstance||jS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zl.isDisabled&&zl.supportsFiber)try{gu=zl.inject(US),jn=zl}catch{}}Yr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BS;Yr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!td(t))throw Error(Se(200));return MS(e,t,null,r)};Yr.createRoot=function(e,t){if(!td(e))throw Error(Se(299));var r=!1,n="",i=u1;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Q0(e,1,!1,null,null,r,!1,n,i),e[Zn]=t.current,Ro(e.nodeType===8?e.parentNode:e),new ed(t)};Yr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Se(188)):(e=Object.keys(e).join(","),Error(Se(268,e)));return e=Nv(t),e=e===null?null:e.stateNode,e};Yr.flushSync=function(e){return da(e)};Yr.hydrate=function(e,t,r){if(!Au(t))throw Error(Se(200));return Ou(null,e,t,!0,r)};Yr.hydrateRoot=function(e,t,r){if(!td(e))throw Error(Se(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",l=u1;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=c1(t,null,e,1,r??null,i,!1,a,l),e[Zn]=t.current,Ro(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Eu(t)};Yr.render=function(e,t,r){if(!Au(t))throw Error(Se(200));return Ou(null,e,t,!1,r)};Yr.unmountComponentAtNode=function(e){if(!Au(e))throw Error(Se(40));return e._reactRootContainer?(da(function(){Ou(null,null,e,!1,function(){e._reactRootContainer=null,e[Zn]=null})}),!0):!1};Yr.unstable_batchedUpdates=Y0;Yr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Au(r))throw Error(Se(200));if(e==null||e._reactInternals===void 0)throw Error(Se(38));return Ou(e,t,r,!1,n)};Yr.version="18.3.1-next-f1338f8080-20240426";function f1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(f1)}catch(e){console.error(e)}}f1(),fv.exports=Yr;var h1=fv.exports,fg=h1;zf.createRoot=fg.createRoot,zf.hydrateRoot=fg.hydrateRoot;/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d1=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WS=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HS=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hg=e=>{const t=HS(e);return t.charAt(0).toUpperCase()+t.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var zS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VS=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XS=ve.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:l,...o},s)=>ve.createElement("svg",{ref:s,...zS,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:d1("lucide",i),...!a&&!VS(o)&&{"aria-hidden":"true"},...o},[...l.map(([c,d])=>ve.createElement(c,d)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=(e,t)=>{const r=ve.forwardRef(({className:n,...i},a)=>ve.createElement(XS,{ref:a,iconNode:t,className:d1(`lucide-${WS(hg(e))}`,`lucide-${e}`,n),...i}));return r.displayName=hg(e),r};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $S=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],GS=Xe("arrow-right",$S);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YS=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],dg=Xe("award",YS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KS=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],qS=Xe("book-open",KS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JS=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],QS=Xe("briefcase",JS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZS=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],rd=Xe("calendar",ZS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ek=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],fs=Xe("check",ek);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tk=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],p1=Xe("chevron-left",tk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rk=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],nd=Xe("chevron-right",rk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nk=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ri=Xe("circle-alert",nk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ik=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],id=Xe("circle-check",ik);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ak=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],sk=Xe("clipboard-check",ak);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ok=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],zo=Xe("clock",ok);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lk=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],ck=Xe("download",lk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uk=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],fk=Xe("ellipsis",uk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hk=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],dk=Xe("graduation-cap",hk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pk=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],gk=Xe("grid-3x3",pk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mk=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],vk=Xe("hash",mk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xk=[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]],yk=Xe("layout-template",xk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _k=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],yf=Xe("loader-circle",_k);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wk=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Sk=Xe("lock",wk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kk=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],bk=Xe("log-out",kk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tk=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],ad=Xe("map-pin",Tk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ck=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],pg=Xe("navigation",Ck);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ek=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Ak=Xe("palette",Ek);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ok=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],Mh=Xe("panels-top-left",Ok);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fk=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],g1=Xe("pen-tool",Fk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pk=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Nk=Xe("pen",Pk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dk=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],jh=Xe("phone",Dk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rk=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],$c=Xe("plus",Rk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ik=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],gg=Xe("printer",Ik);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mk=[["path",{d:"M20.34 17.52a10 10 0 1 0-2.82 2.82",key:"fydyku"}],["circle",{cx:"19",cy:"19",r:"2",key:"17f5cg"}],["path",{d:"m13.41 13.41 4.18 4.18",key:"1gqbwc"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],jk=Xe("radius",Mk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lk=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Bk=Xe("rotate-cw",Lk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uk=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Gc=Xe("save",Uk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wk=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],m1=Xe("search",Wk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hk=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],zk=Xe("settings",Hk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vk=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],v1=Xe("shield-check",Vk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xk=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],sd=Xe("trash-2",Xk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $k=[["path",{d:"M10 10v.2A3 3 0 0 1 8.9 16H5a3 3 0 0 1-1-5.8V10a3 3 0 0 1 6 0Z",key:"1l6gj6"}],["path",{d:"M7 16v6",key:"1a82de"}],["path",{d:"M13 19v3",key:"13sx9i"}],["path",{d:"M12 19h8.3a1 1 0 0 0 .7-1.7L18 14h.3a1 1 0 0 0 .7-1.7L16 9h.2a1 1 0 0 0 .8-1.7L13 3l-1.4 1.5",key:"1sj9kv"}]],Gk=Xe("trees",$k);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yk=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Kk=Xe("triangle-alert",Yk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qk=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Jk=Xe("upload",qk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qk=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Lh=Xe("user",Qk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zk=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],od=Xe("users",Zk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eb=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],go=Xe("x",eb);var Qe={};const tb={},rb=Object.freeze(Object.defineProperty({__proto__:null,default:tb},Symbol.toStringTag,{value:"Module"})),_f=gw(rb);(function(e){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var t=t||{version:"5.5.2"};if(e.fabric=t,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?t.document=document:t.document=document.implementation.createHTMLDocument(""),t.window=window;else{var r=_f,n=new r.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;t.document=n.document,t.jsdomImplForWrapper=_f.implForWrapper,t.nodeCanvas=_f.Canvas,t.window=n,DOMParser=t.window.DOMParser}t.isTouchSupported="ontouchstart"in t.window||"ontouchstart"in t.document||t.window&&t.window.navigator&&t.window.navigator.maxTouchPoints>0,t.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",t.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],t.DPI=96,t.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",t.commaWsp="(?:\\s+,?\\s*|,\\s*)",t.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,t.reNonWord=/[ \n\.,;!\?\-]/,t.fontPaths={},t.iMatrix=[1,0,0,1,0,0],t.svgNS="http://www.w3.org/2000/svg",t.perfLimitSizeTotal=2097152,t.maxCacheSideLimit=4096,t.minCacheSideLimit=256,t.charWidthsCache={},t.textureSize=2048,t.disableStyleCopyPaste=!1,t.enableGLFiltering=!0,t.devicePixelRatio=t.window.devicePixelRatio||t.window.webkitDevicePixelRatio||t.window.mozDevicePixelRatio||1,t.browserShadowBlurConstant=1,t.arcToSegmentsCache={},t.boundsOfCurveCache={},t.cachesBoundsOfCurve=!0,t.forceGLPutImageData=!1,t.initFilterBackend=function(){if(t.enableGLFiltering&&t.isWebglSupported&&t.isWebglSupported(t.textureSize))return console.log("max texture size: "+t.maxTextureSize),new t.WebglFilterBackend({tileSize:t.textureSize});if(t.Canvas2dFilterBackend)return new t.Canvas2dFilterBackend},typeof document<"u"&&typeof window<"u"&&(window.fabric=t),function(){function o(u,p){if(this.__eventListeners[u]){var m=this.__eventListeners[u];p?m[m.indexOf(p)]=!1:t.util.array.fill(m,!1)}}function s(u,p){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var m in u)this.on(m,u[m]);else this.__eventListeners[u]||(this.__eventListeners[u]=[]),this.__eventListeners[u].push(p);return this}function c(u,p){var m=(function(){p.apply(this,arguments),this.off(u,m)}).bind(this);this.on(u,m)}function d(u,p){if(arguments.length===1)for(var m in u)c.call(this,m,u[m]);else c.call(this,u,p);return this}function f(u,p){if(!this.__eventListeners)return this;if(arguments.length===0)for(u in this.__eventListeners)o.call(this,u);else if(arguments.length===1&&typeof arguments[0]=="object")for(var m in u)o.call(this,m,u[m]);else o.call(this,u,p);return this}function h(u,p){if(!this.__eventListeners)return this;var m=this.__eventListeners[u];if(!m)return this;for(var g=0,v=m.length;g<v;g++)m[g]&&m[g].call(this,p||{});return this.__eventListeners[u]=m.filter(function(x){return x!==!1}),this}t.Observable={fire:h,on:s,once:d,off:f}}(),t.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var o=0,s=arguments.length;o<s;o++)this._onObjectAdded(arguments[o]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(o,s,c){var d=this._objects;return c?d[s]=o:d.splice(s,0,o),this._onObjectAdded&&this._onObjectAdded(o),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var o=this._objects,s,c=!1,d=0,f=arguments.length;d<f;d++)s=o.indexOf(arguments[d]),s!==-1&&(c=!0,o.splice(s,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[d]));return this.renderOnAddRemove&&c&&this.requestRenderAll(),this},forEachObject:function(o,s){for(var c=this.getObjects(),d=0,f=c.length;d<f;d++)o.call(s,c[d],d,c);return this},getObjects:function(o){return typeof o>"u"?this._objects.concat():this._objects.filter(function(s){return s.type===o})},item:function(o){return this._objects[o]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(o,s){return this._objects.indexOf(o)>-1?!0:s?this._objects.some(function(c){return typeof c.contains=="function"&&c.contains(o,!0)}):!1},complexity:function(){return this._objects.reduce(function(o,s){return o+=s.complexity?s.complexity():0,o},0)}},t.CommonMethods={_setOptions:function(o){for(var s in o)this.set(s,o[s])},_initGradient:function(o,s){o&&o.colorStops&&!(o instanceof t.Gradient)&&this.set(s,new t.Gradient(o))},_initPattern:function(o,s,c){o&&o.source&&!(o instanceof t.Pattern)?this.set(s,new t.Pattern(o,c)):c&&c()},_setObject:function(o){for(var s in o)this._set(s,o[s])},set:function(o,s){return typeof o=="object"?this._setObject(o):this._set(o,s),this},_set:function(o,s){this[o]=s},toggle:function(o){var s=this.get(o);return typeof s=="boolean"&&this.set(o,!s),this},get:function(o){return this[o]}},function(o){var s=Math.sqrt,c=Math.atan2,d=Math.pow,f=Math.PI/180,h=Math.PI/2;t.util={cos:function(u){if(u===0)return 1;u<0&&(u=-u);var p=u/h;switch(p){case 1:case 3:return 0;case 2:return-1}return Math.cos(u)},sin:function(u){if(u===0)return 0;var p=u/h,m=1;switch(u<0&&(m=-1),p){case 1:return m;case 2:return 0;case 3:return-m}return Math.sin(u)},removeFromArray:function(u,p){var m=u.indexOf(p);return m!==-1&&u.splice(m,1),u},getRandomInt:function(u,p){return Math.floor(Math.random()*(p-u+1))+u},degreesToRadians:function(u){return u*f},radiansToDegrees:function(u){return u/f},rotatePoint:function(u,p,m){var g=new t.Point(u.x-p.x,u.y-p.y),v=t.util.rotateVector(g,m);return new t.Point(v.x,v.y).addEquals(p)},rotateVector:function(u,p){var m=t.util.sin(p),g=t.util.cos(p),v=u.x*g-u.y*m,x=u.x*m+u.y*g;return{x:v,y:x}},createVector:function(u,p){return new t.Point(p.x-u.x,p.y-u.y)},calcAngleBetweenVectors:function(u,p){return Math.acos((u.x*p.x+u.y*p.y)/(Math.hypot(u.x,u.y)*Math.hypot(p.x,p.y)))},getHatVector:function(u){return new t.Point(u.x,u.y).multiply(1/Math.hypot(u.x,u.y))},getBisector:function(u,p,m){var g=t.util.createVector(u,p),v=t.util.createVector(u,m),x=t.util.calcAngleBetweenVectors(g,v),y=t.util.calcAngleBetweenVectors(t.util.rotateVector(g,x),v),_=x*(y===0?1:-1)/2;return{vector:t.util.getHatVector(t.util.rotateVector(g,_)),angle:x}},projectStrokeOnPoints:function(u,p,m){var g=[],v=p.strokeWidth/2,x=p.strokeUniform?new t.Point(1/p.scaleX,1/p.scaleY):new t.Point(1,1),y=function(_){var w=v/Math.hypot(_.x,_.y);return new t.Point(_.x*w*x.x,_.y*w*x.y)};return u.length<=1||u.forEach(function(_,w){var T=new t.Point(_.x,_.y),k,O;w===0?(O=u[w+1],k=m?y(t.util.createVector(O,T)).addEquals(T):u[u.length-1]):w===u.length-1?(k=u[w-1],O=m?y(t.util.createVector(k,T)).addEquals(T):u[0]):(k=u[w-1],O=u[w+1]);var F=t.util.getBisector(T,k,O),M=F.vector,V=F.angle,X,q;if(p.strokeLineJoin==="miter"&&(X=-v/Math.sin(V/2),q=new t.Point(M.x*X*x.x,M.y*X*x.y),Math.hypot(q.x,q.y)/v<=p.strokeMiterLimit)){g.push(T.add(q)),g.push(T.subtract(q));return}X=-v*Math.SQRT2,q=new t.Point(M.x*X*x.x,M.y*X*x.y),g.push(T.add(q)),g.push(T.subtract(q))}),g},transformPoint:function(u,p,m){return m?new t.Point(p[0]*u.x+p[2]*u.y,p[1]*u.x+p[3]*u.y):new t.Point(p[0]*u.x+p[2]*u.y+p[4],p[1]*u.x+p[3]*u.y+p[5])},makeBoundingBoxFromPoints:function(u,p){if(p)for(var m=0;m<u.length;m++)u[m]=t.util.transformPoint(u[m],p);var g=[u[0].x,u[1].x,u[2].x,u[3].x],v=t.util.array.min(g),x=t.util.array.max(g),y=x-v,_=[u[0].y,u[1].y,u[2].y,u[3].y],w=t.util.array.min(_),T=t.util.array.max(_),k=T-w;return{left:v,top:w,width:y,height:k}},invertTransform:function(u){var p=1/(u[0]*u[3]-u[1]*u[2]),m=[p*u[3],-p*u[1],-p*u[2],p*u[0]],g=t.util.transformPoint({x:u[4],y:u[5]},m,!0);return m[4]=-g.x,m[5]=-g.y,m},toFixed:function(u,p){return parseFloat(Number(u).toFixed(p))},parseUnit:function(u,p){var m=/\D{0,2}$/.exec(u),g=parseFloat(u);switch(p||(p=t.Text.DEFAULT_SVG_FONT_SIZE),m[0]){case"mm":return g*t.DPI/25.4;case"cm":return g*t.DPI/2.54;case"in":return g*t.DPI;case"pt":return g*t.DPI/72;case"pc":return g*t.DPI/72*12;case"em":return g*p;default:return g}},falseFunction:function(){return!1},getKlass:function(u,p){return u=t.util.string.camelize(u.charAt(0).toUpperCase()+u.slice(1)),t.util.resolveNamespace(p)[u]},getSvgAttributes:function(u){var p=["instantiated_by_use","style","id","class"];switch(u){case"linearGradient":p=p.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":p=p.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":p=p.concat(["offset","stop-color","stop-opacity"]);break}return p},resolveNamespace:function(u){if(!u)return t;var p=u.split("."),m=p.length,g,v=o||t.window;for(g=0;g<m;++g)v=v[p[g]];return v},loadImage:function(u,p,m,g){if(!u){p&&p.call(m,u);return}var v=t.util.createImage(),x=function(){p&&p.call(m,v,!1),v=v.onload=v.onerror=null};v.onload=x,v.onerror=function(){t.log("Error loading "+v.src),p&&p.call(m,null,!0),v=v.onload=v.onerror=null},u.indexOf("data")!==0&&g!==void 0&&g!==null&&(v.crossOrigin=g),u.substring(0,14)==="data:image/svg"&&(v.onload=null,t.util.loadImageInDom(v,x)),v.src=u},loadImageInDom:function(u,p){var m=t.document.createElement("div");m.style.width=m.style.height="1px",m.style.left=m.style.top="-100%",m.style.position="absolute",m.appendChild(u),t.document.querySelector("body").appendChild(m),u.onload=function(){p(),m.parentNode.removeChild(m),m=null}},enlivenObjects:function(u,p,m,g){u=u||[];var v=[],x=0,y=u.length;function _(){++x===y&&p&&p(v.filter(function(w){return w}))}if(!y){p&&p(v);return}u.forEach(function(w,T){if(!w||!w.type){_();return}var k=t.util.getKlass(w.type,m);k.fromObject(w,function(O,F){F||(v[T]=O),g&&g(w,O,F),_()})})},enlivenObjectEnlivables:function(u,p,m){var g=t.Object.ENLIVEN_PROPS.filter(function(v){return!!u[v]});t.util.enlivenObjects(g.map(function(v){return u[v]}),function(v){var x={};g.forEach(function(y,_){x[y]=v[_],p&&(p[y]=v[_])}),m&&m(x)})},enlivenPatterns:function(u,p){u=u||[];function m(){++v===x&&p&&p(g)}var g=[],v=0,x=u.length;if(!x){p&&p(g);return}u.forEach(function(y,_){y&&y.source?new t.Pattern(y,function(w){g[_]=w,m()}):(g[_]=y,m())})},groupSVGElements:function(u,p,m){var g;return u&&u.length===1?(typeof m<"u"&&(u[0].sourcePath=m),u[0]):(p&&(p.width&&p.height?p.centerPoint={x:p.width/2,y:p.height/2}:(delete p.width,delete p.height)),g=new t.Group(u,p),typeof m<"u"&&(g.sourcePath=m),g)},populateWithProperties:function(u,p,m){if(m&&Array.isArray(m))for(var g=0,v=m.length;g<v;g++)m[g]in u&&(p[m[g]]=u[m[g]])},createCanvasElement:function(){return t.document.createElement("canvas")},copyCanvasElement:function(u){var p=t.util.createCanvasElement();return p.width=u.width,p.height=u.height,p.getContext("2d").drawImage(u,0,0),p},toDataURL:function(u,p,m){return u.toDataURL("image/"+p,m)},createImage:function(){return t.document.createElement("img")},multiplyTransformMatrices:function(u,p,m){return[u[0]*p[0]+u[2]*p[1],u[1]*p[0]+u[3]*p[1],u[0]*p[2]+u[2]*p[3],u[1]*p[2]+u[3]*p[3],m?0:u[0]*p[4]+u[2]*p[5]+u[4],m?0:u[1]*p[4]+u[3]*p[5]+u[5]]},qrDecompose:function(u){var p=c(u[1],u[0]),m=d(u[0],2)+d(u[1],2),g=s(m),v=(u[0]*u[3]-u[2]*u[1])/g,x=c(u[0]*u[2]+u[1]*u[3],m);return{angle:p/f,scaleX:g,scaleY:v,skewX:x/f,skewY:0,translateX:u[4],translateY:u[5]}},calcRotateMatrix:function(u){if(!u.angle)return t.iMatrix.concat();var p=t.util.degreesToRadians(u.angle),m=t.util.cos(p),g=t.util.sin(p);return[m,g,-g,m,0,0]},calcDimensionsMatrix:function(u){var p=typeof u.scaleX>"u"?1:u.scaleX,m=typeof u.scaleY>"u"?1:u.scaleY,g=[u.flipX?-p:p,0,0,u.flipY?-m:m,0,0],v=t.util.multiplyTransformMatrices,x=t.util.degreesToRadians;return u.skewX&&(g=v(g,[1,0,Math.tan(x(u.skewX)),1],!0)),u.skewY&&(g=v(g,[1,Math.tan(x(u.skewY)),0,1],!0)),g},composeMatrix:function(u){var p=[1,0,0,1,u.translateX||0,u.translateY||0],m=t.util.multiplyTransformMatrices;return u.angle&&(p=m(p,t.util.calcRotateMatrix(u))),(u.scaleX!==1||u.scaleY!==1||u.skewX||u.skewY||u.flipX||u.flipY)&&(p=m(p,t.util.calcDimensionsMatrix(u))),p},resetObjectTransform:function(u){u.scaleX=1,u.scaleY=1,u.skewX=0,u.skewY=0,u.flipX=!1,u.flipY=!1,u.rotate(0)},saveObjectTransform:function(u){return{scaleX:u.scaleX,scaleY:u.scaleY,skewX:u.skewX,skewY:u.skewY,angle:u.angle,left:u.left,flipX:u.flipX,flipY:u.flipY,top:u.top}},isTransparent:function(u,p,m,g){g>0&&(p>g?p-=g:p=0,m>g?m-=g:m=0);var v=!0,x,y,_=u.getImageData(p,m,g*2||1,g*2||1),w=_.data.length;for(x=3;x<w&&(y=_.data[x],v=y<=0,v!==!1);x+=4);return _=null,v},parsePreserveAspectRatioAttribute:function(u){var p="meet",m="Mid",g="Mid",v=u.split(" "),x;return v&&v.length&&(p=v.pop(),p!=="meet"&&p!=="slice"?(x=p,p="meet"):v.length&&(x=v.pop())),m=x!=="none"?x.slice(1,4):"none",g=x!=="none"?x.slice(5,8):"none",{meetOrSlice:p,alignX:m,alignY:g}},clearFabricFontCache:function(u){u=(u||"").toLowerCase(),u?t.charWidthsCache[u]&&delete t.charWidthsCache[u]:t.charWidthsCache={}},limitDimsByArea:function(u,p){var m=Math.sqrt(p*u),g=Math.floor(p/m);return{x:Math.floor(m),y:g}},capValue:function(u,p,m){return Math.max(u,Math.min(p,m))},findScaleToFit:function(u,p){return Math.min(p.width/u.width,p.height/u.height)},findScaleToCover:function(u,p){return Math.max(p.width/u.width,p.height/u.height)},matrixToSVG:function(u){return"matrix("+u.map(function(p){return t.util.toFixed(p,t.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(u,p){var m=t.util.invertTransform(p),g=t.util.multiplyTransformMatrices(m,u.calcOwnMatrix());t.util.applyTransformToObject(u,g)},addTransformToObject:function(u,p){t.util.applyTransformToObject(u,t.util.multiplyTransformMatrices(p,u.calcOwnMatrix()))},applyTransformToObject:function(u,p){var m=t.util.qrDecompose(p),g=new t.Point(m.translateX,m.translateY);u.flipX=!1,u.flipY=!1,u.set("scaleX",m.scaleX),u.set("scaleY",m.scaleY),u.skewX=m.skewX,u.skewY=m.skewY,u.angle=m.angle,u.setPositionByOrigin(g,"center","center")},sizeAfterTransform:function(u,p,m){var g=u/2,v=p/2,x=[{x:-g,y:-v},{x:g,y:-v},{x:-g,y:v},{x:g,y:v}],y=t.util.calcDimensionsMatrix(m),_=t.util.makeBoundingBoxFromPoints(x,y);return{x:_.width,y:_.height}},mergeClipPaths:function(u,p){var m=u,g=p;m.inverted&&!g.inverted&&(m=p,g=u),t.util.applyTransformToObject(g,t.util.multiplyTransformMatrices(t.util.invertTransform(m.calcTransformMatrix()),g.calcTransformMatrix()));var v=m.inverted&&g.inverted;return v&&(m.inverted=g.inverted=!1),new t.Group([m],{clipPath:g,inverted:v})},hasStyleChanged:function(u,p,m){return m=m||!1,u.fill!==p.fill||u.stroke!==p.stroke||u.strokeWidth!==p.strokeWidth||u.fontSize!==p.fontSize||u.fontFamily!==p.fontFamily||u.fontWeight!==p.fontWeight||u.fontStyle!==p.fontStyle||u.textBackgroundColor!==p.textBackgroundColor||u.deltaY!==p.deltaY||m&&(u.overline!==p.overline||u.underline!==p.underline||u.linethrough!==p.linethrough)},stylesToArray:function(m,p){for(var m=t.util.object.clone(m,!0),g=p.split(`
`),v=-1,x={},y=[],_=0;_<g.length;_++){if(!m[_]){v+=g[_].length;continue}for(var w=0;w<g[_].length;w++){v++;var T=m[_][w];if(T&&Object.keys(T).length>0){var k=t.util.hasStyleChanged(x,T,!0);k?y.push({start:v,end:v+1,style:T}):y[y.length-1].end++}x=T||{}}}return y},stylesFromArray:function(u,p){if(!Array.isArray(u))return u;for(var m=p.split(`
`),g=-1,v=0,x={},y=0;y<m.length;y++)for(var _=0;_<m[y].length;_++)g++,u[v]&&u[v].start<=g&&g<u[v].end&&(x[y]=x[y]||{},x[y][_]=Object.assign({},u[v].style),g===u[v].end-1&&v++);return x}}}(e),function(){var o=Array.prototype.join,s={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},c={m:"l",M:"L"};function d(C,j,L,E,I,A,b,P,R,W,z){var Y=t.util.cos(C),ie=t.util.sin(C),N=t.util.cos(j),Q=t.util.sin(j),H=L*I*N-E*A*Q+b,te=E*I*N+L*A*Q+P,ee=W+R*(-L*I*ie-E*A*Y),Z=z+R*(-E*I*ie+L*A*Y),oe=H+R*(L*I*Q+E*A*N),ce=te+R*(E*I*Q-L*A*N);return["C",ee,Z,oe,ce,H,te]}function f(C,j,L,E,I,A,b){var P=Math.PI,R=b*P/180,W=t.util.sin(R),z=t.util.cos(R),Y=0,ie=0;L=Math.abs(L),E=Math.abs(E);var N=-z*C*.5-W*j*.5,Q=-z*j*.5+W*C*.5,H=L*L,te=E*E,ee=Q*Q,Z=N*N,oe=H*te-H*ee-te*Z,ce=0;if(oe<0){var ye=Math.sqrt(1-oe/(H*te));L*=ye,E*=ye}else ce=(I===A?-1:1)*Math.sqrt(oe/(H*ee+te*Z));var _e=ce*L*Q/E,de=-ce*E*N/L,be=z*_e-W*de+C*.5,Ae=W*_e+z*de+j*.5,Re=h(1,0,(N-_e)/L,(Q-de)/E),De=h((N-_e)/L,(Q-de)/E,(-N-_e)/L,(-Q-de)/E);A===0&&De>0?De-=2*P:A===1&&De<0&&(De+=2*P);for(var Me=Math.ceil(Math.abs(De/P*2)),Ke=[],Ze=De/Me,ze=8/3*Math.sin(Ze/4)*Math.sin(Ze/4)/Math.sin(Ze/2),ft=Re+Ze,wt=0;wt<Me;wt++)Ke[wt]=d(Re,ft,z,W,L,E,be,Ae,ze,Y,ie),Y=Ke[wt][5],ie=Ke[wt][6],Re=ft,ft+=Ze;return Ke}function h(C,j,L,E){var I=Math.atan2(j,C),A=Math.atan2(E,L);return A>=I?A-I:2*Math.PI-(I-A)}function u(C,j,L,E,I,A,b,P){var R;if(t.cachesBoundsOfCurve&&(R=o.call(arguments),t.boundsOfCurveCache[R]))return t.boundsOfCurveCache[R];var W=Math.sqrt,z=Math.min,Y=Math.max,ie=Math.abs,N=[],Q=[[],[]],H,te,ee,Z,oe,ce,ye,_e;te=6*C-12*L+6*I,H=-3*C+9*L-9*I+3*b,ee=3*L-3*C;for(var de=0;de<2;++de){if(de>0&&(te=6*j-12*E+6*A,H=-3*j+9*E-9*A+3*P,ee=3*E-3*j),ie(H)<1e-12){if(ie(te)<1e-12)continue;Z=-ee/te,0<Z&&Z<1&&N.push(Z);continue}ye=te*te-4*ee*H,!(ye<0)&&(_e=W(ye),oe=(-te+_e)/(2*H),0<oe&&oe<1&&N.push(oe),ce=(-te-_e)/(2*H),0<ce&&ce<1&&N.push(ce))}for(var be,Ae,Re=N.length,De=Re,Me;Re--;)Z=N[Re],Me=1-Z,be=Me*Me*Me*C+3*Me*Me*Z*L+3*Me*Z*Z*I+Z*Z*Z*b,Q[0][Re]=be,Ae=Me*Me*Me*j+3*Me*Me*Z*E+3*Me*Z*Z*A+Z*Z*Z*P,Q[1][Re]=Ae;Q[0][De]=C,Q[1][De]=j,Q[0][De+1]=b,Q[1][De+1]=P;var Ke=[{x:z.apply(null,Q[0]),y:z.apply(null,Q[1])},{x:Y.apply(null,Q[0]),y:Y.apply(null,Q[1])}];return t.cachesBoundsOfCurve&&(t.boundsOfCurveCache[R]=Ke),Ke}function p(C,j,L){for(var E=L[1],I=L[2],A=L[3],b=L[4],P=L[5],R=L[6],W=L[7],z=f(R-C,W-j,E,I,b,P,A),Y=0,ie=z.length;Y<ie;Y++)z[Y][1]+=C,z[Y][2]+=j,z[Y][3]+=C,z[Y][4]+=j,z[Y][5]+=C,z[Y][6]+=j;return z}function m(C){var j=0,L=0,E=C.length,I=0,A=0,b,P,R,W=[],z,Y,ie;for(P=0;P<E;++P){switch(R=!1,b=C[P].slice(0),b[0]){case"l":b[0]="L",b[1]+=j,b[2]+=L;case"L":j=b[1],L=b[2];break;case"h":b[1]+=j;case"H":b[0]="L",b[2]=L,j=b[1];break;case"v":b[1]+=L;case"V":b[0]="L",L=b[1],b[1]=j,b[2]=L;break;case"m":b[0]="M",b[1]+=j,b[2]+=L;case"M":j=b[1],L=b[2],I=b[1],A=b[2];break;case"c":b[0]="C",b[1]+=j,b[2]+=L,b[3]+=j,b[4]+=L,b[5]+=j,b[6]+=L;case"C":Y=b[3],ie=b[4],j=b[5],L=b[6];break;case"s":b[0]="S",b[1]+=j,b[2]+=L,b[3]+=j,b[4]+=L;case"S":z==="C"?(Y=2*j-Y,ie=2*L-ie):(Y=j,ie=L),j=b[3],L=b[4],b[0]="C",b[5]=b[3],b[6]=b[4],b[3]=b[1],b[4]=b[2],b[1]=Y,b[2]=ie,Y=b[3],ie=b[4];break;case"q":b[0]="Q",b[1]+=j,b[2]+=L,b[3]+=j,b[4]+=L;case"Q":Y=b[1],ie=b[2],j=b[3],L=b[4];break;case"t":b[0]="T",b[1]+=j,b[2]+=L;case"T":z==="Q"?(Y=2*j-Y,ie=2*L-ie):(Y=j,ie=L),b[0]="Q",j=b[1],L=b[2],b[1]=Y,b[2]=ie,b[3]=j,b[4]=L;break;case"a":b[0]="A",b[6]+=j,b[7]+=L;case"A":R=!0,W=W.concat(p(j,L,b)),j=b[6],L=b[7];break;case"z":case"Z":j=I,L=A;break}R||W.push(b),z=b[0]}return W}function g(C,j,L,E){return Math.sqrt((L-C)*(L-C)+(E-j)*(E-j))}function v(C){return C*C*C}function x(C){return 3*C*C*(1-C)}function y(C){return 3*C*(1-C)*(1-C)}function _(C){return(1-C)*(1-C)*(1-C)}function w(C,j,L,E,I,A,b,P){return function(R){var W=v(R),z=x(R),Y=y(R),ie=_(R);return{x:b*W+I*z+L*Y+C*ie,y:P*W+A*z+E*Y+j*ie}}}function T(C,j,L,E,I,A,b,P){return function(R){var W=1-R,z=3*W*W*(L-C)+6*W*R*(I-L)+3*R*R*(b-I),Y=3*W*W*(E-j)+6*W*R*(A-E)+3*R*R*(P-A);return Math.atan2(Y,z)}}function k(C){return C*C}function O(C){return 2*C*(1-C)}function F(C){return(1-C)*(1-C)}function M(C,j,L,E,I,A){return function(b){var P=k(b),R=O(b),W=F(b);return{x:I*P+L*R+C*W,y:A*P+E*R+j*W}}}function V(C,j,L,E,I,A){return function(b){var P=1-b,R=2*P*(L-C)+2*b*(I-L),W=2*P*(E-j)+2*b*(A-E);return Math.atan2(W,R)}}function X(C,j,L){var E={x:j,y:L},I,A=0,b;for(b=1;b<=100;b+=1)I=C(b/100),A+=g(E.x,E.y,I.x,I.y),E=I;return A}function q(C,j){for(var L=0,E=0,I=C.iterator,A={x:C.x,y:C.y},b,P,R=.01,W=C.angleFinder,z;E<j&&R>1e-4;)b=I(L),z=L,P=g(A.x,A.y,b.x,b.y),P+E>j?(L-=R,R/=2):(A=b,L+=R,E+=P);return b.angle=W(z),b}function ae(C){for(var j=0,L=C.length,E,I=0,A=0,b=0,P=0,R=[],W,z,Y,ie=0;ie<L;ie++){switch(E=C[ie],z={x:I,y:A,command:E[0]},E[0]){case"M":z.length=0,b=I=E[1],P=A=E[2];break;case"L":z.length=g(I,A,E[1],E[2]),I=E[1],A=E[2];break;case"C":W=w(I,A,E[1],E[2],E[3],E[4],E[5],E[6]),Y=T(I,A,E[1],E[2],E[3],E[4],E[5],E[6]),z.iterator=W,z.angleFinder=Y,z.length=X(W,I,A),I=E[5],A=E[6];break;case"Q":W=M(I,A,E[1],E[2],E[3],E[4]),Y=V(I,A,E[1],E[2],E[3],E[4]),z.iterator=W,z.angleFinder=Y,z.length=X(W,I,A),I=E[3],A=E[4];break;case"Z":case"z":z.destX=b,z.destY=P,z.length=g(I,A,b,P),I=b,A=P;break}j+=z.length,R.push(z)}return R.push({length:j,x:I,y:A}),R}function ne(C,j,L){L||(L=ae(C));for(var E=0;j-L[E].length>0&&E<L.length-2;)j-=L[E].length,E++;var I=L[E],A=j/I.length,b=I.command,P=C[E],R;switch(b){case"M":return{x:I.x,y:I.y,angle:0};case"Z":case"z":return R=new t.Point(I.x,I.y).lerp(new t.Point(I.destX,I.destY),A),R.angle=Math.atan2(I.destY-I.y,I.destX-I.x),R;case"L":return R=new t.Point(I.x,I.y).lerp(new t.Point(P[1],P[2]),A),R.angle=Math.atan2(P[2]-I.y,P[1]-I.x),R;case"C":return q(I,j);case"Q":return q(I,j)}}function re(C){var j=[],L=[],E,I,A=t.rePathCommand,b="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",P="("+b+")"+t.commaWsp,R="([01])"+t.commaWsp+"?",W=P+"?"+P+"?"+P+R+R+P+"?("+b+")",z=new RegExp(W,"g"),Y,ie,N;if(!C||!C.match)return j;N=C.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var Q=0,H,te=N.length;Q<te;Q++){E=N[Q],ie=E.slice(1).trim(),L.length=0;var ee=E.charAt(0);if(H=[ee],ee.toLowerCase()==="a")for(var Z;Z=z.exec(ie);)for(var oe=1;oe<Z.length;oe++)L.push(Z[oe]);else for(;Y=A.exec(ie);)L.push(Y[0]);for(var oe=0,ce=L.length;oe<ce;oe++)I=parseFloat(L[oe]),isNaN(I)||H.push(I);var ye=s[ee.toLowerCase()],_e=c[ee]||ee;if(H.length-1>ye)for(var de=1,be=H.length;de<be;de+=ye)j.push([ee].concat(H.slice(de,de+ye))),ee=_e;else j.push(H)}return j}function le(C,j){var L=[],E,I=new t.Point(C[0].x,C[0].y),A=new t.Point(C[1].x,C[1].y),b=C.length,P=1,R=0,W=b>2;for(j=j||0,W&&(P=C[2].x<A.x?-1:C[2].x===A.x?0:1,R=C[2].y<A.y?-1:C[2].y===A.y?0:1),L.push(["M",I.x-P*j,I.y-R*j]),E=1;E<b;E++){if(!I.eq(A)){var z=I.midPointFrom(A);L.push(["Q",I.x,I.y,z.x,z.y])}I=C[E],E+1<C.length&&(A=C[E+1])}return W&&(P=I.x>C[E-2].x?1:I.x===C[E-2].x?0:-1,R=I.y>C[E-2].y?1:I.y===C[E-2].y?0:-1),L.push(["L",I.x+P*j,I.y+R*j]),L}function se(C,j,L){return L&&(j=t.util.multiplyTransformMatrices(j,[1,0,0,1,-L.x,-L.y])),C.map(function(E){for(var I=E.slice(0),A={},b=1;b<E.length-1;b+=2)A.x=E[b],A.y=E[b+1],A=t.util.transformPoint(A,j),I[b]=A.x,I[b+1]=A.y;return I})}t.util.joinPath=function(C){return C.map(function(j){return j.join(" ")}).join(" ")},t.util.parsePath=re,t.util.makePathSimpler=m,t.util.getSmoothPathFromPoints=le,t.util.getPathSegmentsInfo=ae,t.util.getBoundsOfCurve=u,t.util.getPointOnPath=ne,t.util.transformPath=se}(),function(){var o=Array.prototype.slice;function s(u,p){for(var m=o.call(arguments,2),g=[],v=0,x=u.length;v<x;v++)g[v]=m.length?u[v][p].apply(u[v],m):u[v][p].call(u[v]);return g}function c(u,p){return h(u,p,function(m,g){return m>=g})}function d(u,p){return h(u,p,function(m,g){return m<g})}function f(u,p){for(var m=u.length;m--;)u[m]=p;return u}function h(u,p,m){if(!(!u||u.length===0)){var g=u.length-1,v=p?u[g][p]:u[g];if(p)for(;g--;)m(u[g][p],v)&&(v=u[g][p]);else for(;g--;)m(u[g],v)&&(v=u[g]);return v}}t.util.array={fill:f,invoke:s,min:d,max:c}}(),function(){function o(c,d,f){if(f)if(!t.isLikelyNode&&d instanceof Element)c=d;else if(d instanceof Array){c=[];for(var h=0,u=d.length;h<u;h++)c[h]=o({},d[h],f)}else if(d&&typeof d=="object")for(var p in d)p==="canvas"||p==="group"?c[p]=null:d.hasOwnProperty(p)&&(c[p]=o({},d[p],f));else c=d;else for(var p in d)c[p]=d[p];return c}function s(c,d){return o({},c,d)}t.util.object={extend:o,clone:s},t.util.object.extend(t.util,t.Observable)}(),function(){function o(h){return h.replace(/-+(.)?/g,function(u,p){return p?p.toUpperCase():""})}function s(h,u){return h.charAt(0).toUpperCase()+(u?h.slice(1):h.slice(1).toLowerCase())}function c(h){return h.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function d(h){var u=0,p,m=[];for(u=0,p;u<h.length;u++)(p=f(h,u))!==!1&&m.push(p);return m}function f(h,u){var p=h.charCodeAt(u);if(isNaN(p))return"";if(p<55296||p>57343)return h.charAt(u);if(55296<=p&&p<=56319){if(h.length<=u+1)throw"High surrogate without following low surrogate";var m=h.charCodeAt(u+1);if(56320>m||m>57343)throw"High surrogate without following low surrogate";return h.charAt(u)+h.charAt(u+1)}if(u===0)throw"Low surrogate without preceding high surrogate";var g=h.charCodeAt(u-1);if(55296>g||g>56319)throw"Low surrogate without preceding high surrogate";return!1}t.util.string={camelize:o,capitalize:s,escapeXml:c,graphemeSplit:d}}(),function(){var o=Array.prototype.slice,s=function(){},c=function(){for(var p in{toString:1})if(p==="toString")return!1;return!0}(),d=function(p,m,g){for(var v in m)v in p.prototype&&typeof p.prototype[v]=="function"&&(m[v]+"").indexOf("callSuper")>-1?p.prototype[v]=function(x){return function(){var y=this.constructor.superclass;this.constructor.superclass=g;var _=m[x].apply(this,arguments);if(this.constructor.superclass=y,x!=="initialize")return _}}(v):p.prototype[v]=m[v],c&&(m.toString!==Object.prototype.toString&&(p.prototype.toString=m.toString),m.valueOf!==Object.prototype.valueOf&&(p.prototype.valueOf=m.valueOf))};function f(){}function h(p){for(var m=null,g=this;g.constructor.superclass;){var v=g.constructor.superclass.prototype[p];if(g[p]!==v){m=v;break}g=g.constructor.superclass.prototype}return m?arguments.length>1?m.apply(this,o.call(arguments,1)):m.call(this):console.log("tried to callSuper "+p+", method not found in prototype chain",this)}function u(){var p=null,m=o.call(arguments,0);typeof m[0]=="function"&&(p=m.shift());function g(){this.initialize.apply(this,arguments)}g.superclass=p,g.subclasses=[],p&&(f.prototype=p.prototype,g.prototype=new f,p.subclasses.push(g));for(var v=0,x=m.length;v<x;v++)d(g,m[v],p);return g.prototype.initialize||(g.prototype.initialize=s),g.prototype.constructor=g,g.prototype.callSuper=h,g}t.util.createClass=u}(),function(){var o=!!t.document.createElement("div").attachEvent,s=["touchstart","touchmove","touchend"];t.util.addListener=function(d,f,h,u){d&&d.addEventListener(f,h,o?!1:u)},t.util.removeListener=function(d,f,h,u){d&&d.removeEventListener(f,h,o?!1:u)};function c(d){var f=d.changedTouches;return f&&f[0]?f[0]:d}t.util.getPointer=function(d){var f=d.target,h=t.util.getScrollLeftTop(f),u=c(d);return{x:u.clientX+h.left,y:u.clientY+h.top}},t.util.isTouchEvent=function(d){return s.indexOf(d.type)>-1||d.pointerType==="touch"}}(),function(){function o(u,p){var m=u.style;if(!m)return u;if(typeof p=="string")return u.style.cssText+=";"+p,p.indexOf("opacity")>-1?h(u,p.match(/opacity:\s*(\d?\.?\d*)/)[1]):u;for(var g in p)if(g==="opacity")h(u,p[g]);else{var v=g==="float"||g==="cssFloat"?typeof m.styleFloat>"u"?"cssFloat":"styleFloat":g;m.setProperty(v,p[g])}return u}var s=t.document.createElement("div"),c=typeof s.style.opacity=="string",d=typeof s.style.filter=="string",f=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,h=function(u){return u};c?h=function(u,p){return u.style.opacity=p,u}:d&&(h=function(u,p){var m=u.style;return u.currentStyle&&!u.currentStyle.hasLayout&&(m.zoom=1),f.test(m.filter)?(p=p>=.9999?"":"alpha(opacity="+p*100+")",m.filter=m.filter.replace(f,p)):m.filter+=" alpha(opacity="+p*100+")",u}),t.util.setStyle=o}(),function(){var o=Array.prototype.slice;function s(_){return typeof _=="string"?t.document.getElementById(_):_}var c,d=function(_){return o.call(_,0)};try{c=d(t.document.childNodes)instanceof Array}catch{}c||(d=function(_){for(var w=new Array(_.length),T=_.length;T--;)w[T]=_[T];return w});function f(_,w){var T=t.document.createElement(_);for(var k in w)k==="class"?T.className=w[k]:k==="for"?T.htmlFor=w[k]:T.setAttribute(k,w[k]);return T}function h(_,w){_&&(" "+_.className+" ").indexOf(" "+w+" ")===-1&&(_.className+=(_.className?" ":"")+w)}function u(_,w,T){return typeof w=="string"&&(w=f(w,T)),_.parentNode&&_.parentNode.replaceChild(w,_),w.appendChild(_),w}function p(_){for(var w=0,T=0,k=t.document.documentElement,O=t.document.body||{scrollLeft:0,scrollTop:0};_&&(_.parentNode||_.host)&&(_=_.parentNode||_.host,_===t.document?(w=O.scrollLeft||k.scrollLeft||0,T=O.scrollTop||k.scrollTop||0):(w+=_.scrollLeft||0,T+=_.scrollTop||0),!(_.nodeType===1&&_.style.position==="fixed")););return{left:w,top:T}}function m(_){var w,T=_&&_.ownerDocument,k={left:0,top:0},O={left:0,top:0},F,M={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!T)return O;for(var V in M)O[M[V]]+=parseInt(g(_,V),10)||0;return w=T.documentElement,typeof _.getBoundingClientRect<"u"&&(k=_.getBoundingClientRect()),F=p(_),{left:k.left+F.left-(w.clientLeft||0)+O.left,top:k.top+F.top-(w.clientTop||0)+O.top}}var g;t.document.defaultView&&t.document.defaultView.getComputedStyle?g=function(_,w){var T=t.document.defaultView.getComputedStyle(_,null);return T?T[w]:void 0}:g=function(_,w){var T=_.style[w];return!T&&_.currentStyle&&(T=_.currentStyle[w]),T},function(){var _=t.document.documentElement.style,w="userSelect"in _?"userSelect":"MozUserSelect"in _?"MozUserSelect":"WebkitUserSelect"in _?"WebkitUserSelect":"KhtmlUserSelect"in _?"KhtmlUserSelect":"";function T(O){return typeof O.onselectstart<"u"&&(O.onselectstart=t.util.falseFunction),w?O.style[w]="none":typeof O.unselectable=="string"&&(O.unselectable="on"),O}function k(O){return typeof O.onselectstart<"u"&&(O.onselectstart=null),w?O.style[w]="":typeof O.unselectable=="string"&&(O.unselectable=""),O}t.util.makeElementUnselectable=T,t.util.makeElementSelectable=k}();function v(_){var w=t.jsdomImplForWrapper(_);return w._canvas||w._image}function x(_){if(t.isLikelyNode){var w=t.jsdomImplForWrapper(_);w&&(w._image=null,w._canvas=null,w._currentSrc=null,w._attributes=null,w._classList=null)}}function y(_,w){_.imageSmoothingEnabled=_.imageSmoothingEnabled||_.webkitImageSmoothingEnabled||_.mozImageSmoothingEnabled||_.msImageSmoothingEnabled||_.oImageSmoothingEnabled,_.imageSmoothingEnabled=w}t.util.setImageSmoothing=y,t.util.getById=s,t.util.toArray=d,t.util.addClass=h,t.util.makeElement=f,t.util.wrapElement=u,t.util.getScrollLeftTop=p,t.util.getElementOffset=m,t.util.getNodeCanvas=v,t.util.cleanUpJsdomNode=x}(),function(){function o(d,f){return d+(/\?/.test(d)?"&":"?")+f}function s(){}function c(d,f){f||(f={});var h=f.method?f.method.toUpperCase():"GET",u=f.onComplete||function(){},p=new t.window.XMLHttpRequest,m=f.body||f.parameters;return p.onreadystatechange=function(){p.readyState===4&&(u(p),p.onreadystatechange=s)},h==="GET"&&(m=null,typeof f.parameters=="string"&&(d=o(d,f.parameters))),p.open(h,d,!0),(h==="POST"||h==="PUT")&&p.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),p.send(m),p}t.util.request=c}(),t.log=console.log,t.warn=console.warn,function(){var o=t.util.object.extend,s=t.util.object.clone,c=[];t.util.object.extend(c,{cancelAll:function(){var v=this.splice(0);return v.forEach(function(x){x.cancel()}),v},cancelByCanvas:function(v){if(!v)return[];var x=this.filter(function(y){return typeof y.target=="object"&&y.target.canvas===v});return x.forEach(function(y){y.cancel()}),x},cancelByTarget:function(v){var x=this.findAnimationsByTarget(v);return x.forEach(function(y){y.cancel()}),x},findAnimationIndex:function(v){return this.indexOf(this.findAnimation(v))},findAnimation:function(v){return this.find(function(x){return x.cancel===v})},findAnimationsByTarget:function(v){return v?this.filter(function(x){return x.target===v}):[]}});function d(){return!1}function f(v,x,y,_){return-y*Math.cos(v/_*(Math.PI/2))+y+x}function h(v){v||(v={});var x=!1,y,_=function(){var w=t.runningAnimations.indexOf(y);return w>-1&&t.runningAnimations.splice(w,1)[0]};return y=o(s(v),{cancel:function(){return x=!0,_()},currentValue:"startValue"in v?v.startValue:0,completionRate:0,durationRate:0}),t.runningAnimations.push(y),m(function(w){var T=w||+new Date,k=v.duration||500,O=T+k,F,M=v.onChange||d,V=v.abort||d,X=v.onComplete||d,q=v.easing||f,ae="startValue"in v?v.startValue.length>0:!1,ne="startValue"in v?v.startValue:0,re="endValue"in v?v.endValue:100,le=v.byValue||(ae?ne.map(function(se,C){return re[C]-ne[C]}):re-ne);v.onStart&&v.onStart(),function se(C){F=C||+new Date;var j=F>O?k:F-T,L=j/k,E=ae?ne.map(function(A,b){return q(j,ne[b],le[b],k)}):q(j,ne,le,k),I=Math.abs(ae?(E[0]-ne[0])/le[0]:(E-ne)/le);if(y.currentValue=ae?E.slice():E,y.completionRate=I,y.durationRate=L,!x){if(V(E,I,L)){_();return}if(F>O){y.currentValue=ae?re.slice():re,y.completionRate=1,y.durationRate=1,M(ae?re.slice():re,1,1),X(re,1,1),_();return}else M(E,I,L),m(se)}}(T)}),y.cancel}var u=t.window.requestAnimationFrame||t.window.webkitRequestAnimationFrame||t.window.mozRequestAnimationFrame||t.window.oRequestAnimationFrame||t.window.msRequestAnimationFrame||function(v){return t.window.setTimeout(v,1e3/60)},p=t.window.cancelAnimationFrame||t.window.clearTimeout;function m(){return u.apply(t.window,arguments)}function g(){return p.apply(t.window,arguments)}t.util.animate=h,t.util.requestAnimFrame=m,t.util.cancelAnimFrame=g,t.runningAnimations=c}(),function(){function o(c,d,f){var h="rgba("+parseInt(c[0]+f*(d[0]-c[0]),10)+","+parseInt(c[1]+f*(d[1]-c[1]),10)+","+parseInt(c[2]+f*(d[2]-c[2]),10);return h+=","+(c&&d?parseFloat(c[3]+f*(d[3]-c[3])):1),h+=")",h}function s(c,d,f,h){var u=new t.Color(c).getSource(),p=new t.Color(d).getSource(),m=h.onComplete,g=h.onChange;return h=h||{},t.util.animate(t.util.object.extend(h,{duration:f||500,startValue:u,endValue:p,byValue:p,easing:function(v,x,y,_){var w=h.colorEasing?h.colorEasing(v,_):1-Math.cos(v/_*(Math.PI/2));return o(x,y,w)},onComplete:function(v,x,y){if(m)return m(o(p,p,0),x,y)},onChange:function(v,x,y){if(g){if(Array.isArray(v))return g(o(v,v,0),x,y);g(v,x,y)}}}))}t.util.animateColor=s}(),function(){function o(C,j,L,E){return C<Math.abs(j)?(C=j,E=L/4):j===0&&C===0?E=L/(2*Math.PI)*Math.asin(1):E=L/(2*Math.PI)*Math.asin(j/C),{a:C,c:j,p:L,s:E}}function s(C,j,L){return C.a*Math.pow(2,10*(j-=1))*Math.sin((j*L-C.s)*(2*Math.PI)/C.p)}function c(C,j,L,E){return L*((C=C/E-1)*C*C+1)+j}function d(C,j,L,E){return C/=E/2,C<1?L/2*C*C*C+j:L/2*((C-=2)*C*C+2)+j}function f(C,j,L,E){return L*(C/=E)*C*C*C+j}function h(C,j,L,E){return-L*((C=C/E-1)*C*C*C-1)+j}function u(C,j,L,E){return C/=E/2,C<1?L/2*C*C*C*C+j:-L/2*((C-=2)*C*C*C-2)+j}function p(C,j,L,E){return L*(C/=E)*C*C*C*C+j}function m(C,j,L,E){return L*((C=C/E-1)*C*C*C*C+1)+j}function g(C,j,L,E){return C/=E/2,C<1?L/2*C*C*C*C*C+j:L/2*((C-=2)*C*C*C*C+2)+j}function v(C,j,L,E){return-L*Math.cos(C/E*(Math.PI/2))+L+j}function x(C,j,L,E){return L*Math.sin(C/E*(Math.PI/2))+j}function y(C,j,L,E){return-L/2*(Math.cos(Math.PI*C/E)-1)+j}function _(C,j,L,E){return C===0?j:L*Math.pow(2,10*(C/E-1))+j}function w(C,j,L,E){return C===E?j+L:L*(-Math.pow(2,-10*C/E)+1)+j}function T(C,j,L,E){return C===0?j:C===E?j+L:(C/=E/2,C<1?L/2*Math.pow(2,10*(C-1))+j:L/2*(-Math.pow(2,-10*--C)+2)+j)}function k(C,j,L,E){return-L*(Math.sqrt(1-(C/=E)*C)-1)+j}function O(C,j,L,E){return L*Math.sqrt(1-(C=C/E-1)*C)+j}function F(C,j,L,E){return C/=E/2,C<1?-L/2*(Math.sqrt(1-C*C)-1)+j:L/2*(Math.sqrt(1-(C-=2)*C)+1)+j}function M(C,j,L,E){var I=1.70158,A=0,b=L;if(C===0)return j;if(C/=E,C===1)return j+L;A||(A=E*.3);var P=o(b,L,A,I);return-s(P,C,E)+j}function V(C,j,L,E){var I=1.70158,A=0,b=L;if(C===0)return j;if(C/=E,C===1)return j+L;A||(A=E*.3);var P=o(b,L,A,I);return P.a*Math.pow(2,-10*C)*Math.sin((C*E-P.s)*(2*Math.PI)/P.p)+P.c+j}function X(C,j,L,E){var I=1.70158,A=0,b=L;if(C===0)return j;if(C/=E/2,C===2)return j+L;A||(A=E*(.3*1.5));var P=o(b,L,A,I);return C<1?-.5*s(P,C,E)+j:P.a*Math.pow(2,-10*(C-=1))*Math.sin((C*E-P.s)*(2*Math.PI)/P.p)*.5+P.c+j}function q(C,j,L,E,I){return I===void 0&&(I=1.70158),L*(C/=E)*C*((I+1)*C-I)+j}function ae(C,j,L,E,I){return I===void 0&&(I=1.70158),L*((C=C/E-1)*C*((I+1)*C+I)+1)+j}function ne(C,j,L,E,I){return I===void 0&&(I=1.70158),C/=E/2,C<1?L/2*(C*C*(((I*=1.525)+1)*C-I))+j:L/2*((C-=2)*C*(((I*=1.525)+1)*C+I)+2)+j}function re(C,j,L,E){return L-le(E-C,0,L,E)+j}function le(C,j,L,E){return(C/=E)<1/2.75?L*(7.5625*C*C)+j:C<2/2.75?L*(7.5625*(C-=1.5/2.75)*C+.75)+j:C<2.5/2.75?L*(7.5625*(C-=2.25/2.75)*C+.9375)+j:L*(7.5625*(C-=2.625/2.75)*C+.984375)+j}function se(C,j,L,E){return C<E/2?re(C*2,0,L,E)*.5+j:le(C*2-E,0,L,E)*.5+L*.5+j}t.util.ease={easeInQuad:function(C,j,L,E){return L*(C/=E)*C+j},easeOutQuad:function(C,j,L,E){return-L*(C/=E)*(C-2)+j},easeInOutQuad:function(C,j,L,E){return C/=E/2,C<1?L/2*C*C+j:-L/2*(--C*(C-2)-1)+j},easeInCubic:function(C,j,L,E){return L*(C/=E)*C*C+j},easeOutCubic:c,easeInOutCubic:d,easeInQuart:f,easeOutQuart:h,easeInOutQuart:u,easeInQuint:p,easeOutQuint:m,easeInOutQuint:g,easeInSine:v,easeOutSine:x,easeInOutSine:y,easeInExpo:_,easeOutExpo:w,easeInOutExpo:T,easeInCirc:k,easeOutCirc:O,easeInOutCirc:F,easeInElastic:M,easeOutElastic:V,easeInOutElastic:X,easeInBack:q,easeOutBack:ae,easeInOutBack:ne,easeInBounce:re,easeOutBounce:le,easeInOutBounce:se}}(),function(o){var s=o.fabric||(o.fabric={}),c=s.util.object.extend,d=s.util.object.clone,f=s.util.toFixed,h=s.util.parseUnit,u=s.util.multiplyTransformMatrices,p=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],m=["symbol","image","marker","pattern","view","svg"],g=["pattern","defs","symbol","metadata","clipPath","mask","desc"],v=["symbol","g","a","svg","clipPath","defs"],x={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},y={stroke:"strokeOpacity",fill:"fillOpacity"},_="font-size",w="clip-path";s.svgValidTagNamesRegEx=O(p),s.svgViewBoxElementsRegEx=O(m),s.svgInvalidAncestorsRegEx=O(g),s.svgValidParentsRegEx=O(v),s.cssRules={},s.gradientDefs={},s.clipPaths={};function T(A){return A in x?x[A]:A}function k(A,b,P,R){var W=Array.isArray(b),z;if((A==="fill"||A==="stroke")&&b==="none")b="";else{if(A==="strokeUniform")return b==="non-scaling-stroke";if(A==="strokeDashArray")b==="none"?b=null:b=b.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(A==="transformMatrix")P&&P.transformMatrix?b=u(P.transformMatrix,s.parseTransformAttribute(b)):b=s.parseTransformAttribute(b);else if(A==="visible")b=b!=="none"&&b!=="hidden",P&&P.visible===!1&&(b=!1);else if(A==="opacity")b=parseFloat(b),P&&typeof P.opacity<"u"&&(b*=P.opacity);else if(A==="textAnchor")b=b==="start"?"left":b==="end"?"right":"center";else if(A==="charSpacing")z=h(b,R)/R*1e3;else if(A==="paintFirst"){var Y=b.indexOf("fill"),ie=b.indexOf("stroke"),b="fill";(Y>-1&&ie>-1&&ie<Y||Y===-1&&ie>-1)&&(b="stroke")}else{if(A==="href"||A==="xlink:href"||A==="font")return b;if(A==="imageSmoothing")return b==="optimizeQuality";z=W?b.map(h):h(b,R)}}return!W&&isNaN(z)?b:z}function O(A){return new RegExp("^("+A.join("|")+")\\b","i")}function F(A){for(var b in y)if(!(typeof A[y[b]]>"u"||A[b]==="")){if(typeof A[b]>"u"){if(!s.Object.prototype[b])continue;A[b]=s.Object.prototype[b]}if(A[b].indexOf("url(")!==0){var P=new s.Color(A[b]);A[b]=P.setAlpha(f(P.getAlpha()*A[y[b]],2)).toRgba()}}return A}function M(A,b){var P,R=[],W,z,Y;for(z=0,Y=b.length;z<Y;z++)P=b[z],W=A.getElementsByTagName(P),R=R.concat(Array.prototype.slice.call(W));return R}s.parseTransformAttribute=function(){function A(de,be){var Ae=s.util.cos(be[0]),Re=s.util.sin(be[0]),De=0,Me=0;be.length===3&&(De=be[1],Me=be[2]),de[0]=Ae,de[1]=Re,de[2]=-Re,de[3]=Ae,de[4]=De-(Ae*De-Re*Me),de[5]=Me-(Re*De+Ae*Me)}function b(de,be){var Ae=be[0],Re=be.length===2?be[1]:be[0];de[0]=Ae,de[3]=Re}function P(de,be,Ae){de[Ae]=Math.tan(s.util.degreesToRadians(be[0]))}function R(de,be){de[4]=be[0],be.length===2&&(de[5]=be[1])}var W=s.iMatrix,z=s.reNum,Y=s.commaWsp,ie="(?:(skewX)\\s*\\(\\s*("+z+")\\s*\\))",N="(?:(skewY)\\s*\\(\\s*("+z+")\\s*\\))",Q="(?:(rotate)\\s*\\(\\s*("+z+")(?:"+Y+"("+z+")"+Y+"("+z+"))?\\s*\\))",H="(?:(scale)\\s*\\(\\s*("+z+")(?:"+Y+"("+z+"))?\\s*\\))",te="(?:(translate)\\s*\\(\\s*("+z+")(?:"+Y+"("+z+"))?\\s*\\))",ee="(?:(matrix)\\s*\\(\\s*("+z+")"+Y+"("+z+")"+Y+"("+z+")"+Y+"("+z+")"+Y+"("+z+")"+Y+"("+z+")\\s*\\))",Z="(?:"+ee+"|"+te+"|"+H+"|"+Q+"|"+ie+"|"+N+")",oe="(?:"+Z+"(?:"+Y+"*"+Z+")*)",ce="^\\s*(?:"+oe+"?)\\s*$",ye=new RegExp(ce),_e=new RegExp(Z,"g");return function(de){var be=W.concat(),Ae=[];if(!de||de&&!ye.test(de))return be;de.replace(_e,function(De){var Me=new RegExp(Z).exec(De).filter(function(ze){return!!ze}),Ke=Me[1],Ze=Me.slice(2).map(parseFloat);switch(Ke){case"translate":R(be,Ze);break;case"rotate":Ze[0]=s.util.degreesToRadians(Ze[0]),A(be,Ze);break;case"scale":b(be,Ze);break;case"skewX":P(be,Ze,2);break;case"skewY":P(be,Ze,1);break;case"matrix":be=Ze;break}Ae.push(be.concat()),be=W.concat()});for(var Re=Ae[0];Ae.length>1;)Ae.shift(),Re=s.util.multiplyTransformMatrices(Re,Ae[0]);return Re}}();function V(A,b){var P,R;A.replace(/;\s*$/,"").split(";").forEach(function(W){var z=W.split(":");P=z[0].trim().toLowerCase(),R=z[1].trim(),b[P]=R})}function X(A,b){var P,R;for(var W in A)typeof A[W]>"u"||(P=W.toLowerCase(),R=A[W],b[P]=R)}function q(A,b){var P={};for(var R in s.cssRules[b])if(ae(A,R.split(" ")))for(var W in s.cssRules[b][R])P[W]=s.cssRules[b][R][W];return P}function ae(A,b){var P,R=!0;return P=re(A,b.pop()),P&&b.length&&(R=ne(A,b)),P&&R&&b.length===0}function ne(A,b){for(var P,R=!0;A.parentNode&&A.parentNode.nodeType===1&&b.length;)R&&(P=b.pop()),A=A.parentNode,R=re(A,P);return b.length===0}function re(A,b){var P=A.nodeName,R=A.getAttribute("class"),W=A.getAttribute("id"),z,Y;if(z=new RegExp("^"+P,"i"),b=b.replace(z,""),W&&b.length&&(z=new RegExp("#"+W+"(?![a-zA-Z\\-]+)","i"),b=b.replace(z,"")),R&&b.length)for(R=R.split(" "),Y=R.length;Y--;)z=new RegExp("\\."+R[Y]+"(?![a-zA-Z\\-]+)","i"),b=b.replace(z,"");return b.length===0}function le(A,b){var P;if(A.getElementById&&(P=A.getElementById(b)),P)return P;var R,W,z,Y=A.getElementsByTagName("*");for(W=0,z=Y.length;W<z;W++)if(R=Y[W],b===R.getAttribute("id"))return R}function se(A){for(var b=M(A,["use","svg:use"]),P=0;b.length&&P<b.length;){var R=b[P],W=R.getAttribute("xlink:href")||R.getAttribute("href");if(W===null)return;var z=W.slice(1),Y=R.getAttribute("x")||0,ie=R.getAttribute("y")||0,N=le(A,z).cloneNode(!0),Q=(N.getAttribute("transform")||"")+" translate("+Y+", "+ie+")",H,te=b.length,ee,Z,oe,ce,ye=s.svgNS;if(j(N),/^svg$/i.test(N.nodeName)){var _e=N.ownerDocument.createElementNS(ye,"g");for(Z=0,oe=N.attributes,ce=oe.length;Z<ce;Z++)ee=oe.item(Z),_e.setAttributeNS(ye,ee.nodeName,ee.nodeValue);for(;N.firstChild;)_e.appendChild(N.firstChild);N=_e}for(Z=0,oe=R.attributes,ce=oe.length;Z<ce;Z++)ee=oe.item(Z),!(ee.nodeName==="x"||ee.nodeName==="y"||ee.nodeName==="xlink:href"||ee.nodeName==="href")&&(ee.nodeName==="transform"?Q=ee.nodeValue+" "+Q:N.setAttribute(ee.nodeName,ee.nodeValue));N.setAttribute("transform",Q),N.setAttribute("instantiated_by_use","1"),N.removeAttribute("id"),H=R.parentNode,H.replaceChild(N,R),b.length===te&&P++}}var C=new RegExp("^\\s*("+s.reNum+"+)\\s*,?\\s*("+s.reNum+"+)\\s*,?\\s*("+s.reNum+"+)\\s*,?\\s*("+s.reNum+"+)\\s*$");function j(A){if(!s.svgViewBoxElementsRegEx.test(A.nodeName))return{};var b=A.getAttribute("viewBox"),P=1,R=1,W=0,z=0,Y,ie,N,Q,H=A.getAttribute("width"),te=A.getAttribute("height"),ee=A.getAttribute("x")||0,Z=A.getAttribute("y")||0,oe=A.getAttribute("preserveAspectRatio")||"",ce=!b||!(b=b.match(C)),ye=!H||!te||H==="100%"||te==="100%",_e=ce&&ye,de={},be="",Ae=0,Re=0;if(de.width=0,de.height=0,de.toBeParsed=_e,ce&&(ee||Z)&&A.parentNode&&A.parentNode.nodeName!=="#document"&&(be=" translate("+h(ee)+" "+h(Z)+") ",N=(A.getAttribute("transform")||"")+be,A.setAttribute("transform",N),A.removeAttribute("x"),A.removeAttribute("y")),_e)return de;if(ce)return de.width=h(H),de.height=h(te),de;if(W=-parseFloat(b[1]),z=-parseFloat(b[2]),Y=parseFloat(b[3]),ie=parseFloat(b[4]),de.minX=W,de.minY=z,de.viewBoxWidth=Y,de.viewBoxHeight=ie,ye?(de.width=Y,de.height=ie):(de.width=h(H),de.height=h(te),P=de.width/Y,R=de.height/ie),oe=s.util.parsePreserveAspectRatioAttribute(oe),oe.alignX!=="none"&&(oe.meetOrSlice==="meet"&&(R=P=P>R?R:P),oe.meetOrSlice==="slice"&&(R=P=P>R?P:R),Ae=de.width-Y*P,Re=de.height-ie*P,oe.alignX==="Mid"&&(Ae/=2),oe.alignY==="Mid"&&(Re/=2),oe.alignX==="Min"&&(Ae=0),oe.alignY==="Min"&&(Re=0)),P===1&&R===1&&W===0&&z===0&&ee===0&&Z===0)return de;if((ee||Z)&&A.parentNode.nodeName!=="#document"&&(be=" translate("+h(ee)+" "+h(Z)+") "),N=be+" matrix("+P+" 0 0 "+R+" "+(W*P+Ae)+" "+(z*R+Re)+") ",A.nodeName==="svg"){for(Q=A.ownerDocument.createElementNS(s.svgNS,"g");A.firstChild;)Q.appendChild(A.firstChild);A.appendChild(Q)}else Q=A,Q.removeAttribute("x"),Q.removeAttribute("y"),N=Q.getAttribute("transform")+N;return Q.setAttribute("transform",N),de}function L(A,b){for(;A&&(A=A.parentNode);)if(A.nodeName&&b.test(A.nodeName.replace("svg:",""))&&!A.getAttribute("instantiated_by_use"))return!0;return!1}s.parseSVGDocument=function(A,b,P,R){if(A){se(A);var W=s.Object.__uid++,z,Y,ie=j(A),N=s.util.toArray(A.getElementsByTagName("*"));if(ie.crossOrigin=R&&R.crossOrigin,ie.svgUid=W,N.length===0&&s.isLikelyNode){N=A.selectNodes('//*[name(.)!="svg"]');var Q=[];for(z=0,Y=N.length;z<Y;z++)Q[z]=N[z];N=Q}var H=N.filter(function(ee){return j(ee),s.svgValidTagNamesRegEx.test(ee.nodeName.replace("svg:",""))&&!L(ee,s.svgInvalidAncestorsRegEx)});if(!H||H&&!H.length){b&&b([],{});return}var te={};N.filter(function(ee){return ee.nodeName.replace("svg:","")==="clipPath"}).forEach(function(ee){var Z=ee.getAttribute("id");te[Z]=s.util.toArray(ee.getElementsByTagName("*")).filter(function(oe){return s.svgValidTagNamesRegEx.test(oe.nodeName.replace("svg:",""))})}),s.gradientDefs[W]=s.getGradientDefs(A),s.cssRules[W]=s.getCSSRules(A),s.clipPaths[W]=te,s.parseElements(H,function(ee,Z){b&&(b(ee,ie,Z,N),delete s.gradientDefs[W],delete s.cssRules[W],delete s.clipPaths[W])},d(ie),P,R)}};function E(A,b){var P=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],R="xlink:href",W=b.getAttribute(R).slice(1),z=le(A,W);if(z&&z.getAttribute(R)&&E(A,z),P.forEach(function(ie){z&&!b.hasAttribute(ie)&&z.hasAttribute(ie)&&b.setAttribute(ie,z.getAttribute(ie))}),!b.children.length)for(var Y=z.cloneNode(!0);Y.firstChild;)b.appendChild(Y.firstChild);b.removeAttribute(R)}var I=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+s.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+s.reNum+"))?\\s+(.*)");c(s,{parseFontDeclaration:function(A,b){var P=A.match(I);if(P){var R=P[1],W=P[3],z=P[4],Y=P[5],ie=P[6];R&&(b.fontStyle=R),W&&(b.fontWeight=isNaN(parseFloat(W))?W:parseFloat(W)),z&&(b.fontSize=h(z)),ie&&(b.fontFamily=ie),Y&&(b.lineHeight=Y==="normal"?1:Y)}},getGradientDefs:function(A){var b=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],P=M(A,b),R,W=0,z={};for(W=P.length;W--;)R=P[W],R.getAttribute("xlink:href")&&E(A,R),z[R.getAttribute("id")]=R;return z},parseAttributes:function(A,b,P){if(A){var R,W={},z,Y;typeof P>"u"&&(P=A.getAttribute("svgUid")),A.parentNode&&s.svgValidParentsRegEx.test(A.parentNode.nodeName)&&(W=s.parseAttributes(A.parentNode,b,P));var ie=b.reduce(function(oe,ce){return R=A.getAttribute(ce),R&&(oe[ce]=R),oe},{}),N=c(q(A,P),s.parseStyleAttribute(A));ie=c(ie,N),N[w]&&A.setAttribute(w,N[w]),z=Y=W.fontSize||s.Text.DEFAULT_SVG_FONT_SIZE,ie[_]&&(ie[_]=z=h(ie[_],Y));var Q,H,te={};for(var ee in ie)Q=T(ee),H=k(Q,ie[ee],W,z),te[Q]=H;te&&te.font&&s.parseFontDeclaration(te.font,te);var Z=c(W,te);return s.svgValidParentsRegEx.test(A.nodeName)?Z:F(Z)}},parseElements:function(A,b,P,R,W){new s.ElementsParser(A,b,P,R,W).parse()},parseStyleAttribute:function(A){var b={},P=A.getAttribute("style");return P&&(typeof P=="string"?V(P,b):X(P,b)),b},parsePointsAttribute:function(A){if(!A)return null;A=A.replace(/,/g," ").trim(),A=A.split(/\s+/);var b=[],P,R;for(P=0,R=A.length;P<R;P+=2)b.push({x:parseFloat(A[P]),y:parseFloat(A[P+1])});return b},getCSSRules:function(A){var b=A.getElementsByTagName("style"),P,R,W={},z;for(P=0,R=b.length;P<R;P++){var Y=b[P].textContent;Y=Y.replace(/\/\*[\s\S]*?\*\//g,""),Y.trim()!==""&&(z=Y.split("}"),z=z.filter(function(ie){return ie.trim()}),z.forEach(function(ie){var N=ie.split("{"),Q={},H=N[1].trim(),te=H.split(";").filter(function(ce){return ce.trim()});for(P=0,R=te.length;P<R;P++){var ee=te[P].split(":"),Z=ee[0].trim(),oe=ee[1].trim();Q[Z]=oe}ie=N[0].trim(),ie.split(",").forEach(function(ce){ce=ce.replace(/^svg/i,"").trim(),ce!==""&&(W[ce]?s.util.object.extend(W[ce],Q):W[ce]=s.util.object.clone(Q))})}))}return W},loadSVGFromURL:function(A,b,P,R){A=A.replace(/^\n\s*/,"").trim(),new s.util.request(A,{method:"get",onComplete:W});function W(z){var Y=z.responseXML;if(!Y||!Y.documentElement)return b&&b(null),!1;s.parseSVGDocument(Y.documentElement,function(ie,N,Q,H){b&&b(ie,N,Q,H)},P,R)}},loadSVGFromString:function(A,b,P,R){var W=new s.window.DOMParser,z=W.parseFromString(A.trim(),"text/xml");s.parseSVGDocument(z.documentElement,function(Y,ie,N,Q){b(Y,ie,N,Q)},P,R)}})}(e),t.ElementsParser=function(o,s,c,d,f,h){this.elements=o,this.callback=s,this.options=c,this.reviver=d,this.svgUid=c&&c.svgUid||0,this.parsingOptions=f,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=h},function(o){o.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},o.createObjects=function(){var s=this;this.elements.forEach(function(c,d){c.setAttribute("svgUid",s.svgUid),s.createObject(c,d)})},o.findTag=function(s){return t[t.util.string.capitalize(s.tagName.replace("svg:",""))]},o.createObject=function(s,c){var d=this.findTag(s);if(d&&d.fromElement)try{d.fromElement(s,this.createCallback(c,s),this.options)}catch(f){t.log(f)}else this.checkIfDone()},o.createCallback=function(s,c){var d=this;return function(f){var h;d.resolveGradient(f,c,"fill"),d.resolveGradient(f,c,"stroke"),f instanceof t.Image&&f._originalElement&&(h=f.parsePreserveAspectRatioAttribute(c)),f._removeTransformMatrix(h),d.resolveClipPath(f,c),d.reviver&&d.reviver(c,f),d.instances[s]=f,d.checkIfDone()}},o.extractPropertyDefinition=function(s,c,d){var f=s[c],h=this.regexUrl;if(h.test(f)){h.lastIndex=0;var u=h.exec(f)[1];return h.lastIndex=0,t[d][this.svgUid][u]}},o.resolveGradient=function(s,c,d){var f=this.extractPropertyDefinition(s,d,"gradientDefs");if(f){var h=c.getAttribute(d+"-opacity"),u=t.Gradient.fromElement(f,s,h,this.options);s.set(d,u)}},o.createClipPathCallback=function(s,c){return function(d){d._removeTransformMatrix(),d.fillRule=d.clipRule,c.push(d)}},o.resolveClipPath=function(s,c){var d=this.extractPropertyDefinition(s,"clipPath","clipPaths"),f,h,u,p,m,g;if(d){p=[],u=t.util.invertTransform(s.calcTransformMatrix());for(var v=d[0].parentNode,x=c;x.parentNode&&x.getAttribute("clip-path")!==s.clipPath;)x=x.parentNode;x.parentNode.appendChild(v);for(var y=0;y<d.length;y++)f=d[y],h=this.findTag(f),h.fromElement(f,this.createClipPathCallback(s,p),this.options);p.length===1?d=p[0]:d=new t.Group(p),m=t.util.multiplyTransformMatrices(u,d.calcTransformMatrix()),d.clipPath&&this.resolveClipPath(d,x);var g=t.util.qrDecompose(m);d.flipX=!1,d.flipY=!1,d.set("scaleX",g.scaleX),d.set("scaleY",g.scaleY),d.angle=g.angle,d.skewX=g.skewX,d.skewY=0,d.setPositionByOrigin({x:g.translateX,y:g.translateY},"center","center"),s.clipPath=d}else delete s.clipPath},o.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(s){return s!=null}),this.callback(this.instances,this.elements))}}(t.ElementsParser.prototype),function(o){var s=o.fabric||(o.fabric={});if(s.Point){s.warn("fabric.Point is already defined");return}s.Point=c;function c(d,f){this.x=d,this.y=f}c.prototype={type:"point",constructor:c,add:function(d){return new c(this.x+d.x,this.y+d.y)},addEquals:function(d){return this.x+=d.x,this.y+=d.y,this},scalarAdd:function(d){return new c(this.x+d,this.y+d)},scalarAddEquals:function(d){return this.x+=d,this.y+=d,this},subtract:function(d){return new c(this.x-d.x,this.y-d.y)},subtractEquals:function(d){return this.x-=d.x,this.y-=d.y,this},scalarSubtract:function(d){return new c(this.x-d,this.y-d)},scalarSubtractEquals:function(d){return this.x-=d,this.y-=d,this},multiply:function(d){return new c(this.x*d,this.y*d)},multiplyEquals:function(d){return this.x*=d,this.y*=d,this},divide:function(d){return new c(this.x/d,this.y/d)},divideEquals:function(d){return this.x/=d,this.y/=d,this},eq:function(d){return this.x===d.x&&this.y===d.y},lt:function(d){return this.x<d.x&&this.y<d.y},lte:function(d){return this.x<=d.x&&this.y<=d.y},gt:function(d){return this.x>d.x&&this.y>d.y},gte:function(d){return this.x>=d.x&&this.y>=d.y},lerp:function(d,f){return typeof f>"u"&&(f=.5),f=Math.max(Math.min(1,f),0),new c(this.x+(d.x-this.x)*f,this.y+(d.y-this.y)*f)},distanceFrom:function(d){var f=this.x-d.x,h=this.y-d.y;return Math.sqrt(f*f+h*h)},midPointFrom:function(d){return this.lerp(d)},min:function(d){return new c(Math.min(this.x,d.x),Math.min(this.y,d.y))},max:function(d){return new c(Math.max(this.x,d.x),Math.max(this.y,d.y))},toString:function(){return this.x+","+this.y},setXY:function(d,f){return this.x=d,this.y=f,this},setX:function(d){return this.x=d,this},setY:function(d){return this.y=d,this},setFromPoint:function(d){return this.x=d.x,this.y=d.y,this},swap:function(d){var f=this.x,h=this.y;this.x=d.x,this.y=d.y,d.x=f,d.y=h},clone:function(){return new c(this.x,this.y)}}}(e),function(o){var s=o.fabric||(o.fabric={});if(s.Intersection){s.warn("fabric.Intersection is already defined");return}function c(d){this.status=d,this.points=[]}s.Intersection=c,s.Intersection.prototype={constructor:c,appendPoint:function(d){return this.points.push(d),this},appendPoints:function(d){return this.points=this.points.concat(d),this}},s.Intersection.intersectLineLine=function(d,f,h,u){var p,m=(u.x-h.x)*(d.y-h.y)-(u.y-h.y)*(d.x-h.x),g=(f.x-d.x)*(d.y-h.y)-(f.y-d.y)*(d.x-h.x),v=(u.y-h.y)*(f.x-d.x)-(u.x-h.x)*(f.y-d.y);if(v!==0){var x=m/v,y=g/v;0<=x&&x<=1&&0<=y&&y<=1?(p=new c("Intersection"),p.appendPoint(new s.Point(d.x+x*(f.x-d.x),d.y+x*(f.y-d.y)))):p=new c}else m===0||g===0?p=new c("Coincident"):p=new c("Parallel");return p},s.Intersection.intersectLinePolygon=function(d,f,h){var u=new c,p=h.length,m,g,v,x;for(x=0;x<p;x++)m=h[x],g=h[(x+1)%p],v=c.intersectLineLine(d,f,m,g),u.appendPoints(v.points);return u.points.length>0&&(u.status="Intersection"),u},s.Intersection.intersectPolygonPolygon=function(d,f){var h=new c,u=d.length,p;for(p=0;p<u;p++){var m=d[p],g=d[(p+1)%u],v=c.intersectLinePolygon(m,g,f);h.appendPoints(v.points)}return h.points.length>0&&(h.status="Intersection"),h},s.Intersection.intersectPolygonRectangle=function(d,f,h){var u=f.min(h),p=f.max(h),m=new s.Point(p.x,u.y),g=new s.Point(u.x,p.y),v=c.intersectLinePolygon(u,m,d),x=c.intersectLinePolygon(m,p,d),y=c.intersectLinePolygon(p,g,d),_=c.intersectLinePolygon(g,u,d),w=new c;return w.appendPoints(v.points),w.appendPoints(x.points),w.appendPoints(y.points),w.appendPoints(_.points),w.points.length>0&&(w.status="Intersection"),w}}(e),function(o){var s=o.fabric||(o.fabric={});if(s.Color){s.warn("fabric.Color is already defined.");return}function c(f){f?this._tryParsingColor(f):this.setSource([0,0,0,1])}s.Color=c,s.Color.prototype={_tryParsingColor:function(f){var h;f in c.colorNameMap&&(f=c.colorNameMap[f]),f==="transparent"&&(h=[255,255,255,0]),h||(h=c.sourceFromHex(f)),h||(h=c.sourceFromRgb(f)),h||(h=c.sourceFromHsl(f)),h||(h=[0,0,0,1]),h&&this.setSource(h)},_rgbToHsl:function(f,h,u){f/=255,h/=255,u/=255;var p,m,g,v=s.util.array.max([f,h,u]),x=s.util.array.min([f,h,u]);if(g=(v+x)/2,v===x)p=m=0;else{var y=v-x;switch(m=g>.5?y/(2-v-x):y/(v+x),v){case f:p=(h-u)/y+(h<u?6:0);break;case h:p=(u-f)/y+2;break;case u:p=(f-h)/y+4;break}p/=6}return[Math.round(p*360),Math.round(m*100),Math.round(g*100)]},getSource:function(){return this._source},setSource:function(f){this._source=f},toRgb:function(){var f=this.getSource();return"rgb("+f[0]+","+f[1]+","+f[2]+")"},toRgba:function(){var f=this.getSource();return"rgba("+f[0]+","+f[1]+","+f[2]+","+f[3]+")"},toHsl:function(){var f=this.getSource(),h=this._rgbToHsl(f[0],f[1],f[2]);return"hsl("+h[0]+","+h[1]+"%,"+h[2]+"%)"},toHsla:function(){var f=this.getSource(),h=this._rgbToHsl(f[0],f[1],f[2]);return"hsla("+h[0]+","+h[1]+"%,"+h[2]+"%,"+f[3]+")"},toHex:function(){var f=this.getSource(),h,u,p;return h=f[0].toString(16),h=h.length===1?"0"+h:h,u=f[1].toString(16),u=u.length===1?"0"+u:u,p=f[2].toString(16),p=p.length===1?"0"+p:p,h.toUpperCase()+u.toUpperCase()+p.toUpperCase()},toHexa:function(){var f=this.getSource(),h;return h=Math.round(f[3]*255),h=h.toString(16),h=h.length===1?"0"+h:h,this.toHex()+h.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(f){var h=this.getSource();return h[3]=f,this.setSource(h),this},toGrayscale:function(){var f=this.getSource(),h=parseInt((f[0]*.3+f[1]*.59+f[2]*.11).toFixed(0),10),u=f[3];return this.setSource([h,h,h,u]),this},toBlackWhite:function(f){var h=this.getSource(),u=(h[0]*.3+h[1]*.59+h[2]*.11).toFixed(0),p=h[3];return f=f||127,u=Number(u)<Number(f)?0:255,this.setSource([u,u,u,p]),this},overlayWith:function(f){f instanceof c||(f=new c(f));var h=[],u=this.getAlpha(),p=.5,m=this.getSource(),g=f.getSource(),v;for(v=0;v<3;v++)h.push(Math.round(m[v]*(1-p)+g[v]*p));return h[3]=u,this.setSource(h),this}},s.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,s.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,s.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,s.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function d(f,h,u){return u<0&&(u+=1),u>1&&(u-=1),u<1/6?f+(h-f)*6*u:u<1/2?h:u<2/3?f+(h-f)*(2/3-u)*6:f}s.Color.fromRgb=function(f){return c.fromSource(c.sourceFromRgb(f))},s.Color.sourceFromRgb=function(f){var h=f.match(c.reRGBa);if(h){var u=parseInt(h[1],10)/(/%$/.test(h[1])?100:1)*(/%$/.test(h[1])?255:1),p=parseInt(h[2],10)/(/%$/.test(h[2])?100:1)*(/%$/.test(h[2])?255:1),m=parseInt(h[3],10)/(/%$/.test(h[3])?100:1)*(/%$/.test(h[3])?255:1);return[parseInt(u,10),parseInt(p,10),parseInt(m,10),h[4]?parseFloat(h[4]):1]}},s.Color.fromRgba=c.fromRgb,s.Color.fromHsl=function(f){return c.fromSource(c.sourceFromHsl(f))},s.Color.sourceFromHsl=function(f){var h=f.match(c.reHSLa);if(h){var u=(parseFloat(h[1])%360+360)%360/360,p=parseFloat(h[2])/(/%$/.test(h[2])?100:1),m=parseFloat(h[3])/(/%$/.test(h[3])?100:1),g,v,x;if(p===0)g=v=x=m;else{var y=m<=.5?m*(p+1):m+p-m*p,_=m*2-y;g=d(_,y,u+1/3),v=d(_,y,u),x=d(_,y,u-1/3)}return[Math.round(g*255),Math.round(v*255),Math.round(x*255),h[4]?parseFloat(h[4]):1]}},s.Color.fromHsla=c.fromHsl,s.Color.fromHex=function(f){return c.fromSource(c.sourceFromHex(f))},s.Color.sourceFromHex=function(f){if(f.match(c.reHex)){var h=f.slice(f.indexOf("#")+1),u=h.length===3||h.length===4,p=h.length===8||h.length===4,m=u?h.charAt(0)+h.charAt(0):h.substring(0,2),g=u?h.charAt(1)+h.charAt(1):h.substring(2,4),v=u?h.charAt(2)+h.charAt(2):h.substring(4,6),x=p?u?h.charAt(3)+h.charAt(3):h.substring(6,8):"FF";return[parseInt(m,16),parseInt(g,16),parseInt(v,16),parseFloat((parseInt(x,16)/255).toFixed(2))]}},s.Color.fromSource=function(f){var h=new c;return h.setSource(f),h}}(e),function(o){var s=o.fabric||(o.fabric={}),c=["e","se","s","sw","w","nw","n","ne","e"],d=["ns","nesw","ew","nwse"],f={},h="left",u="top",p="right",m="bottom",g="center",v={top:m,bottom:u,left:p,right:h,center:g},x=s.util.radiansToDegrees,y=Math.sign||function(Q){return(Q>0)-(Q<0)||+Q};function _(Q,H){var te=Q.angle+x(Math.atan2(H.y,H.x))+360;return Math.round(te%360/45)}function w(Q,H){var te=H.transform.target,ee=te.canvas,Z=s.util.object.clone(H);Z.target=te,ee&&ee.fire("object:"+Q,Z),te.fire(Q,H)}function T(Q,H){var te=H.canvas,ee=te.uniScaleKey,Z=Q[ee];return te.uniformScaling&&!Z||!te.uniformScaling&&Z}function k(Q){return Q.originX===g&&Q.originY===g}function O(Q,H,te){var ee=Q.lockScalingX,Z=Q.lockScalingY;return!!(ee&&Z||!H&&(ee||Z)&&te||ee&&H==="x"||Z&&H==="y")}function F(Q,H,te){var ee="not-allowed",Z=T(Q,te),oe="";if(H.x!==0&&H.y===0?oe="x":H.x===0&&H.y!==0&&(oe="y"),O(te,oe,Z))return ee;var ce=_(te,H);return c[ce]+"-resize"}function M(Q,H,te){var ee="not-allowed";if(H.x!==0&&te.lockSkewingY||H.y!==0&&te.lockSkewingX)return ee;var Z=_(te,H)%4;return d[Z]+"-resize"}function V(Q,H,te){return Q[te.canvas.altActionKey]?f.skewCursorStyleHandler(Q,H,te):f.scaleCursorStyleHandler(Q,H,te)}function X(Q,H,te){var ee=Q[te.canvas.altActionKey];if(H.x===0)return ee?"skewX":"scaleY";if(H.y===0)return ee?"skewY":"scaleX"}function q(Q,H,te){return te.lockRotation?"not-allowed":H.cursorStyle}function ae(Q,H,te,ee){return{e:Q,transform:H,pointer:{x:te,y:ee}}}function ne(Q){return function(H,te,ee,Z){var oe=te.target,ce=oe.getCenterPoint(),ye=oe.translateToOriginPoint(ce,te.originX,te.originY),_e=Q(H,te,ee,Z);return oe.setPositionByOrigin(ye,te.originX,te.originY),_e}}function re(Q,H){return function(te,ee,Z,oe){var ce=H(te,ee,Z,oe);return ce&&w(Q,ae(te,ee,Z,oe)),ce}}function le(Q,H,te,ee,Z){var oe=Q.target,ce=oe.controls[Q.corner],ye=oe.canvas.getZoom(),_e=oe.padding/ye,de=oe.toLocalPoint(new s.Point(ee,Z),H,te);return de.x>=_e&&(de.x-=_e),de.x<=-_e&&(de.x+=_e),de.y>=_e&&(de.y-=_e),de.y<=_e&&(de.y+=_e),de.x-=ce.offsetX,de.y-=ce.offsetY,de}function se(Q){return Q.flipX!==Q.flipY}function C(Q,H,te,ee,Z){if(Q[H]!==0){var oe=Q._getTransformedDimensions()[ee],ce=Z/oe*Q[te];Q.set(te,ce)}}function j(Q,H,te,ee){var Z=H.target,oe=Z._getTransformedDimensions(0,Z.skewY),ce=le(H,H.originX,H.originY,te,ee),ye=Math.abs(ce.x*2)-oe.x,_e=Z.skewX,de;ye<2?de=0:(de=x(Math.atan2(ye/Z.scaleX,oe.y/Z.scaleY)),H.originX===h&&H.originY===m&&(de=-de),H.originX===p&&H.originY===u&&(de=-de),se(Z)&&(de=-de));var be=_e!==de;if(be){var Ae=Z._getTransformedDimensions().y;Z.set("skewX",de),C(Z,"skewY","scaleY","y",Ae)}return be}function L(Q,H,te,ee){var Z=H.target,oe=Z._getTransformedDimensions(Z.skewX,0),ce=le(H,H.originX,H.originY,te,ee),ye=Math.abs(ce.y*2)-oe.y,_e=Z.skewY,de;ye<2?de=0:(de=x(Math.atan2(ye/Z.scaleY,oe.x/Z.scaleX)),H.originX===h&&H.originY===m&&(de=-de),H.originX===p&&H.originY===u&&(de=-de),se(Z)&&(de=-de));var be=_e!==de;if(be){var Ae=Z._getTransformedDimensions().x;Z.set("skewY",de),C(Z,"skewX","scaleX","x",Ae)}return be}function E(Q,H,te,ee){var Z=H.target,oe=Z.skewX,ce,ye=H.originY;if(Z.lockSkewingX)return!1;if(oe===0){var _e=le(H,g,g,te,ee);_e.x>0?ce=h:ce=p}else oe>0&&(ce=ye===u?h:p),oe<0&&(ce=ye===u?p:h),se(Z)&&(ce=ce===h?p:h);H.originX=ce;var de=re("skewing",ne(j));return de(Q,H,te,ee)}function I(Q,H,te,ee){var Z=H.target,oe=Z.skewY,ce,ye=H.originX;if(Z.lockSkewingY)return!1;if(oe===0){var _e=le(H,g,g,te,ee);_e.y>0?ce=u:ce=m}else oe>0&&(ce=ye===h?u:m),oe<0&&(ce=ye===h?m:u),se(Z)&&(ce=ce===u?m:u);H.originY=ce;var de=re("skewing",ne(L));return de(Q,H,te,ee)}function A(Q,H,te,ee){var Z=H,oe=Z.target,ce=oe.translateToOriginPoint(oe.getCenterPoint(),Z.originX,Z.originY);if(oe.lockRotation)return!1;var ye=Math.atan2(Z.ey-ce.y,Z.ex-ce.x),_e=Math.atan2(ee-ce.y,te-ce.x),de=x(_e-ye+Z.theta),be=!0;if(oe.snapAngle>0){var Ae=oe.snapAngle,Re=oe.snapThreshold||Ae,De=Math.ceil(de/Ae)*Ae,Me=Math.floor(de/Ae)*Ae;Math.abs(de-Me)<Re?de=Me:Math.abs(de-De)<Re&&(de=De)}return de<0&&(de=360+de),de%=360,be=oe.angle!==de,oe.angle=de,be}function b(Q,H,te,ee,Z){Z=Z||{};var oe=H.target,ce=oe.lockScalingX,ye=oe.lockScalingY,_e=Z.by,de,be,Ae,Re,De=T(Q,oe),Me=O(oe,_e,De),Ke,Ze,ze=H.gestureScale;if(Me)return!1;if(ze)be=H.scaleX*ze,Ae=H.scaleY*ze;else{if(de=le(H,H.originX,H.originY,te,ee),Ke=_e!=="y"?y(de.x):1,Ze=_e!=="x"?y(de.y):1,H.signX||(H.signX=Ke),H.signY||(H.signY=Ze),oe.lockScalingFlip&&(H.signX!==Ke||H.signY!==Ze))return!1;if(Re=oe._getTransformedDimensions(),De&&!_e){var ft=Math.abs(de.x)+Math.abs(de.y),wt=H.original,It=Math.abs(Re.x*wt.scaleX/oe.scaleX)+Math.abs(Re.y*wt.scaleY/oe.scaleY),En=ft/It;be=wt.scaleX*En,Ae=wt.scaleY*En}else be=Math.abs(de.x*oe.scaleX/Re.x),Ae=Math.abs(de.y*oe.scaleY/Re.y);k(H)&&(be*=2,Ae*=2),H.signX!==Ke&&_e!=="y"&&(H.originX=v[H.originX],be*=-1,H.signX=Ke),H.signY!==Ze&&_e!=="x"&&(H.originY=v[H.originY],Ae*=-1,H.signY=Ze)}var Tl=oe.scaleX,zu=oe.scaleY;return _e?(_e==="x"&&oe.set("scaleX",be),_e==="y"&&oe.set("scaleY",Ae)):(!ce&&oe.set("scaleX",be),!ye&&oe.set("scaleY",Ae)),Tl!==oe.scaleX||zu!==oe.scaleY}function P(Q,H,te,ee){return b(Q,H,te,ee)}function R(Q,H,te,ee){return b(Q,H,te,ee,{by:"x"})}function W(Q,H,te,ee){return b(Q,H,te,ee,{by:"y"})}function z(Q,H,te,ee){return Q[H.target.canvas.altActionKey]?f.skewHandlerX(Q,H,te,ee):f.scalingY(Q,H,te,ee)}function Y(Q,H,te,ee){return Q[H.target.canvas.altActionKey]?f.skewHandlerY(Q,H,te,ee):f.scalingX(Q,H,te,ee)}function ie(Q,H,te,ee){var Z=H.target,oe=le(H,H.originX,H.originY,te,ee),ce=Z.strokeWidth/(Z.strokeUniform?Z.scaleX:1),ye=k(H)?2:1,_e=Z.width,de=Math.abs(oe.x*ye/Z.scaleX)-ce;return Z.set("width",Math.max(de,0)),_e!==de}function N(Q,H,te,ee){var Z=H.target,oe=te-H.offsetX,ce=ee-H.offsetY,ye=!Z.get("lockMovementX")&&Z.left!==oe,_e=!Z.get("lockMovementY")&&Z.top!==ce;return ye&&Z.set("left",oe),_e&&Z.set("top",ce),(ye||_e)&&w("moving",ae(Q,H,te,ee)),ye||_e}f.scaleCursorStyleHandler=F,f.skewCursorStyleHandler=M,f.scaleSkewCursorStyleHandler=V,f.rotationWithSnapping=re("rotating",ne(A)),f.scalingEqually=re("scaling",ne(P)),f.scalingX=re("scaling",ne(R)),f.scalingY=re("scaling",ne(W)),f.scalingYOrSkewingX=z,f.scalingXOrSkewingY=Y,f.changeWidth=re("resizing",ne(ie)),f.skewHandlerX=E,f.skewHandlerY=I,f.dragHandler=N,f.scaleOrSkewActionName=X,f.rotationStyleHandler=q,f.fireEvent=w,f.wrapWithFixedAnchor=ne,f.wrapWithFireEvent=re,f.getLocalPoint=le,s.controlsUtils=f}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.util.degreesToRadians,d=s.controlsUtils;function f(u,p,m,g,v){g=g||{};var x=this.sizeX||g.cornerSize||v.cornerSize,y=this.sizeY||g.cornerSize||v.cornerSize,_=typeof g.transparentCorners<"u"?g.transparentCorners:v.transparentCorners,w=_?"stroke":"fill",T=!_&&(g.cornerStrokeColor||v.cornerStrokeColor),k=p,O=m,F;u.save(),u.fillStyle=g.cornerColor||v.cornerColor,u.strokeStyle=g.cornerStrokeColor||v.cornerStrokeColor,x>y?(F=x,u.scale(1,y/x),O=m*x/y):y>x?(F=y,u.scale(x/y,1),k=p*y/x):F=x,u.lineWidth=1,u.beginPath(),u.arc(k,O,F/2,0,2*Math.PI,!1),u[w](),T&&u.stroke(),u.restore()}function h(u,p,m,g,v){g=g||{};var x=this.sizeX||g.cornerSize||v.cornerSize,y=this.sizeY||g.cornerSize||v.cornerSize,_=typeof g.transparentCorners<"u"?g.transparentCorners:v.transparentCorners,w=_?"stroke":"fill",T=!_&&(g.cornerStrokeColor||v.cornerStrokeColor),k=x/2,O=y/2;u.save(),u.fillStyle=g.cornerColor||v.cornerColor,u.strokeStyle=g.cornerStrokeColor||v.cornerStrokeColor,u.lineWidth=1,u.translate(p,m),u.rotate(c(v.angle)),u[w+"Rect"](-k,-O,x,y),T&&u.strokeRect(-k,-O,x,y),u.restore()}d.renderCircleControl=f,d.renderSquareControl=h}(e),function(o){var s=o.fabric||(o.fabric={});function c(d){for(var f in d)this[f]=d[f]}s.Control=c,s.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(d,f){return f.cursorStyle},getActionName:function(d,f){return f.actionName},getVisibility:function(d,f){var h=d._controlsVisibility;return h&&typeof h[f]<"u"?h[f]:this.visible},setVisibility:function(d){this.visible=d},positionHandler:function(d,f){var h=s.util.transformPoint({x:this.x*d.x+this.offsetX,y:this.y*d.y+this.offsetY},f);return h},calcCornerCoords:function(d,f,h,u,p){var m,g,v,x,y=p?this.touchSizeX:this.sizeX,_=p?this.touchSizeY:this.sizeY;if(y&&_&&y!==_){var w=Math.atan2(_,y),T=Math.sqrt(y*y+_*_)/2,k=w-s.util.degreesToRadians(d),O=Math.PI/2-w-s.util.degreesToRadians(d);m=T*s.util.cos(k),g=T*s.util.sin(k),v=T*s.util.cos(O),x=T*s.util.sin(O)}else{var F=y&&_?y:f;T=F*.7071067812;var k=s.util.degreesToRadians(45-d);m=v=T*s.util.cos(k),g=x=T*s.util.sin(k)}return{tl:{x:h-x,y:u-v},tr:{x:h+m,y:u-g},bl:{x:h-m,y:u+g},br:{x:h+x,y:u+v}}},render:function(d,f,h,u,p){switch(u=u||{},u.cornerStyle||p.cornerStyle){case"circle":s.controlsUtils.renderCircleControl.call(this,d,f,h,u,p);break;default:s.controlsUtils.renderSquareControl.call(this,d,f,h,u,p)}}}}(e),function(){function o(h,u){var p=h.getAttribute("style"),m=h.getAttribute("offset")||0,g,v,x,y;if(m=parseFloat(m)/(/%$/.test(m)?100:1),m=m<0?0:m>1?1:m,p){var _=p.split(/\s*;\s*/);for(_[_.length-1]===""&&_.pop(),y=_.length;y--;){var w=_[y].split(/\s*:\s*/),T=w[0].trim(),k=w[1].trim();T==="stop-color"?g=k:T==="stop-opacity"&&(x=k)}}return g||(g=h.getAttribute("stop-color")||"rgb(0,0,0)"),x||(x=h.getAttribute("stop-opacity")),g=new t.Color(g),v=g.getAlpha(),x=isNaN(parseFloat(x))?1:parseFloat(x),x*=v*u,{offset:m,color:g.toRgb(),opacity:x}}function s(h){return{x1:h.getAttribute("x1")||0,y1:h.getAttribute("y1")||0,x2:h.getAttribute("x2")||"100%",y2:h.getAttribute("y2")||0}}function c(h){return{x1:h.getAttribute("fx")||h.getAttribute("cx")||"50%",y1:h.getAttribute("fy")||h.getAttribute("cy")||"50%",r1:0,x2:h.getAttribute("cx")||"50%",y2:h.getAttribute("cy")||"50%",r2:h.getAttribute("r")||"50%"}}var d=t.util.object.clone;t.Gradient=t.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(h){h||(h={}),h.coords||(h.coords={});var u,p=this;Object.keys(h).forEach(function(m){p[m]=h[m]}),this.id?this.id+="_"+t.Object.__uid++:this.id=t.Object.__uid++,u={x1:h.coords.x1||0,y1:h.coords.y1||0,x2:h.coords.x2||0,y2:h.coords.y2||0},this.type==="radial"&&(u.r1=h.coords.r1||0,u.r2=h.coords.r2||0),this.coords=u,this.colorStops=h.colorStops.slice()},addColorStop:function(h){for(var u in h){var p=new t.Color(h[u]);this.colorStops.push({offset:parseFloat(u),color:p.toRgb(),opacity:p.getAlpha()})}return this},toObject:function(h){var u={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return t.util.populateWithProperties(this,u,h),u},toSVG:function(h,v){var p=d(this.coords,!0),m,g,v=v||{},x,y,_=d(this.colorStops,!0),w=p.r1>p.r2,T=this.gradientTransform?this.gradientTransform.concat():t.iMatrix.concat(),k=-this.offsetX,O=-this.offsetY,F=!!v.additionalTransform,M=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(_.sort(function(ne,re){return ne.offset-re.offset}),M==="objectBoundingBox"?(k/=h.width,O/=h.height):(k+=h.width/2,O+=h.height/2),h.type==="path"&&this.gradientUnits!=="percentage"&&(k-=h.pathOffset.x,O-=h.pathOffset.y),T[4]-=k,T[5]-=O,y='id="SVGID_'+this.id+'" gradientUnits="'+M+'"',y+=' gradientTransform="'+(F?v.additionalTransform+" ":"")+t.util.matrixToSVG(T)+'" ',this.type==="linear"?x=["<linearGradient ",y,' x1="',p.x1,'" y1="',p.y1,'" x2="',p.x2,'" y2="',p.y2,`">
`]:this.type==="radial"&&(x=["<radialGradient ",y,' cx="',w?p.x1:p.x2,'" cy="',w?p.y1:p.y2,'" r="',w?p.r1:p.r2,'" fx="',w?p.x2:p.x1,'" fy="',w?p.y2:p.y1,`">
`]),this.type==="radial"){if(w)for(_=_.concat(),_.reverse(),m=0,g=_.length;m<g;m++)_[m].offset=1-_[m].offset;var V=Math.min(p.r1,p.r2);if(V>0){var X=Math.max(p.r1,p.r2),q=V/X;for(m=0,g=_.length;m<g;m++)_[m].offset+=q*(1-_[m].offset)}}for(m=0,g=_.length;m<g;m++){var ae=_[m];x.push("<stop ",'offset="',ae.offset*100+"%",'" style="stop-color:',ae.color,typeof ae.opacity<"u"?";stop-opacity: "+ae.opacity:";",`"/>
`)}return x.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),x.join("")},toLive:function(h){var u,p=t.util.object.clone(this.coords),m,g;if(this.type){for(this.type==="linear"?u=h.createLinearGradient(p.x1,p.y1,p.x2,p.y2):this.type==="radial"&&(u=h.createRadialGradient(p.x1,p.y1,p.r1,p.x2,p.y2,p.r2)),m=0,g=this.colorStops.length;m<g;m++){var v=this.colorStops[m].color,x=this.colorStops[m].opacity,y=this.colorStops[m].offset;typeof x<"u"&&(v=new t.Color(v).setAlpha(x).toRgba()),u.addColorStop(y,v)}return u}}}),t.util.object.extend(t.Gradient,{fromElement:function(h,u,p,m){var g=parseFloat(p)/(/%$/.test(p)?100:1);g=g<0?0:g>1?1:g,isNaN(g)&&(g=1);var v=h.getElementsByTagName("stop"),x,y=h.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",_=h.getAttribute("gradientTransform")||"",w=[],T,k,O=0,F=0,M;for(h.nodeName==="linearGradient"||h.nodeName==="LINEARGRADIENT"?(x="linear",T=s(h)):(x="radial",T=c(h)),k=v.length;k--;)w.push(o(v[k],g));M=t.parseTransformAttribute(_),f(u,T,m,y),y==="pixels"&&(O=-u.left,F=-u.top);var V=new t.Gradient({id:h.getAttribute("id"),type:x,coords:T,colorStops:w,gradientUnits:y,gradientTransform:M,offsetX:O,offsetY:F});return V}});function f(h,u,p,m){var g,v;Object.keys(u).forEach(function(x){g=u[x],g==="Infinity"?v=1:g==="-Infinity"?v=0:(v=parseFloat(u[x],10),typeof g=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(g)&&(v*=.01,m==="pixels"&&((x==="x1"||x==="x2"||x==="r2")&&(v*=p.viewBoxWidth||p.width),(x==="y1"||x==="y2")&&(v*=p.viewBoxHeight||p.height)))),u[x]=v})}}(),function(){var o=t.util.toFixed;t.Pattern=t.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(s,c){if(s||(s={}),this.id=t.Object.__uid++,this.setOptions(s),!s.source||s.source&&typeof s.source!="string"){c&&c(this);return}else{var d=this;this.source=t.util.createImage(),t.util.loadImage(s.source,function(f,h){d.source=f,c&&c(d,h)},null,this.crossOrigin)}},toObject:function(s){var c=t.Object.NUM_FRACTION_DIGITS,d,f;return typeof this.source.src=="string"?d=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(d=this.source.toDataURL()),f={type:"pattern",source:d,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:o(this.offsetX,c),offsetY:o(this.offsetY,c),patternTransform:this.patternTransform?this.patternTransform.concat():null},t.util.populateWithProperties(this,f,s),f},toSVG:function(s){var c=typeof this.source=="function"?this.source():this.source,d=c.width/s.width,f=c.height/s.height,h=this.offsetX/s.width,u=this.offsetY/s.height,p="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(f=1,u&&(f+=Math.abs(u))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(d=1,h&&(d+=Math.abs(h))),c.src?p=c.src:c.toDataURL&&(p=c.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+h+'" y="'+u+'" width="'+d+'" height="'+f+`">
<image x="0" y="0" width="`+c.width+'" height="'+c.height+'" xlink:href="'+p+`"></image>
</pattern>
`},setOptions:function(s){for(var c in s)this[c]=s[c]},toLive:function(s){var c=this.source;return!c||typeof c.src<"u"&&(!c.complete||c.naturalWidth===0||c.naturalHeight===0)?"":s.createPattern(c,this.repeat)}})}(),function(o){var s=o.fabric||(o.fabric={}),c=s.util.toFixed;if(s.Shadow){s.warn("fabric.Shadow is already defined.");return}s.Shadow=s.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(d){typeof d=="string"&&(d=this._parseShadow(d));for(var f in d)this[f]=d[f];this.id=s.Object.__uid++},_parseShadow:function(d){var f=d.trim(),h=s.Shadow.reOffsetsAndBlur.exec(f)||[],u=f.replace(s.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:u.trim(),offsetX:parseFloat(h[1],10)||0,offsetY:parseFloat(h[2],10)||0,blur:parseFloat(h[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(d){var f=40,h=40,u=s.Object.NUM_FRACTION_DIGITS,p=s.util.rotateVector({x:this.offsetX,y:this.offsetY},s.util.degreesToRadians(-d.angle)),m=20,g=new s.Color(this.color);return d.width&&d.height&&(f=c((Math.abs(p.x)+this.blur)/d.width,u)*100+m,h=c((Math.abs(p.y)+this.blur)/d.height,u)*100+m),d.flipX&&(p.x*=-1),d.flipY&&(p.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+h+'%" height="'+(100+2*h)+'%" x="-'+f+'%" width="'+(100+2*f)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+c(this.blur?this.blur/2:0,u)+`"></feGaussianBlur>
	<feOffset dx="`+c(p.x,u)+'" dy="'+c(p.y,u)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+g.toRgb()+'" flood-opacity="'+g.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var d={},f=s.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(h){this[h]!==f[h]&&(d[h]=this[h])},this),d}}),s.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(e),function(){if(t.StaticCanvas){t.warn("fabric.StaticCanvas is already defined.");return}var o=t.util.object.extend,s=t.util.getElementOffset,c=t.util.removeFromArray,d=t.util.toFixed,f=t.util.transformPoint,h=t.util.invertTransform,u=t.util.getNodeCanvas,p=t.util.createCanvasElement,m=new Error("Could not initialize `canvas` element");t.StaticCanvas=t.util.createClass(t.CommonMethods,{initialize:function(g,v){v||(v={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(g,v)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:t.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(g,v){var x=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(g),this._initOptions(v),this.interactive||this._initRetinaScaling(),v.overlayImage&&this.setOverlayImage(v.overlayImage,x),v.backgroundImage&&this.setBackgroundImage(v.backgroundImage,x),v.backgroundColor&&this.setBackgroundColor(v.backgroundColor,x),v.overlayColor&&this.setOverlayColor(v.overlayColor,x),this.calcOffset()},_isRetinaScaling:function(){return t.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,t.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var g=t.devicePixelRatio;this.__initRetinaScaling(g,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(g,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(g,v,x){v.setAttribute("width",this.width*g),v.setAttribute("height",this.height*g),x.scale(g,g)},calcOffset:function(){return this._offset=s(this.lowerCanvasEl),this},setOverlayImage:function(g,v,x){return this.__setBgOverlayImage("overlayImage",g,v,x)},setBackgroundImage:function(g,v,x){return this.__setBgOverlayImage("backgroundImage",g,v,x)},setOverlayColor:function(g,v){return this.__setBgOverlayColor("overlayColor",g,v)},setBackgroundColor:function(g,v){return this.__setBgOverlayColor("backgroundColor",g,v)},__setBgOverlayImage:function(g,v,x,y){return typeof v=="string"?t.util.loadImage(v,function(_,w){if(_){var T=new t.Image(_,y);this[g]=T,T.canvas=this}x&&x(_,w)},this,y&&y.crossOrigin):(y&&v.setOptions(y),this[g]=v,v&&(v.canvas=this),x&&x(v,!1)),this},__setBgOverlayColor:function(g,v,x){return this[g]=v,this._initGradient(v,g),this._initPattern(v,g,x),this},_createCanvasElement:function(){var g=p();if(!g||(g.style||(g.style={}),typeof g.getContext>"u"))throw m;return g},_initOptions:function(g){var v=this.lowerCanvasEl;this._setOptions(g),this.width=this.width||parseInt(v.width,10)||0,this.height=this.height||parseInt(v.height,10)||0,this.lowerCanvasEl.style&&(v.width=this.width,v.height=this.height,v.style.width=this.width+"px",v.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(g){g&&g.getContext?this.lowerCanvasEl=g:this.lowerCanvasEl=t.util.getById(g)||this._createCanvasElement(),t.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(g,v){return this.setDimensions({width:g},v)},setHeight:function(g,v){return this.setDimensions({height:g},v)},setDimensions:function(g,v){var x;v=v||{};for(var y in g)x=g[y],v.cssOnly||(this._setBackstoreDimension(y,g[y]),x+="px",this.hasLostContext=!0),v.backstoreOnly||this._setCssDimension(y,x);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),v.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(g,v){return this.lowerCanvasEl[g]=v,this.upperCanvasEl&&(this.upperCanvasEl[g]=v),this.cacheCanvasEl&&(this.cacheCanvasEl[g]=v),this[g]=v,this},_setCssDimension:function(g,v){return this.lowerCanvasEl.style[g]=v,this.upperCanvasEl&&(this.upperCanvasEl.style[g]=v),this.wrapperEl&&(this.wrapperEl.style[g]=v),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(g){var v=this._activeObject,x=this.backgroundImage,y=this.overlayImage,_,w,T;for(this.viewportTransform=g,w=0,T=this._objects.length;w<T;w++)_=this._objects[w],_.group||_.setCoords(!0);return v&&v.setCoords(),x&&x.setCoords(!0),y&&y.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(g,v){var x=g,y=this.viewportTransform.slice(0);g=f(g,h(this.viewportTransform)),y[0]=v,y[3]=v;var _=f(g,y);return y[4]+=x.x-_.x,y[5]+=x.y-_.y,this.setViewportTransform(y)},setZoom:function(g){return this.zoomToPoint(new t.Point(0,0),g),this},absolutePan:function(g){var v=this.viewportTransform.slice(0);return v[4]=-g.x,v[5]=-g.y,this.setViewportTransform(v)},relativePan:function(g){return this.absolutePan(new t.Point(-g.x-this.viewportTransform[4],-g.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(g){this.stateful&&g.setupState(),g._set("canvas",this),g.setCoords(),this.fire("object:added",{target:g}),g.fire("added")},_onObjectRemoved:function(g){this.fire("object:removed",{target:g}),g.fire("removed"),delete g.canvas},clearContext:function(g){return g.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var g=this.contextContainer;return this.renderCanvas(g,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=t.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var g={},v=this.width,x=this.height,y=h(this.viewportTransform);return g.tl=f({x:0,y:0},y),g.br=f({x:v,y:x},y),g.tr=new t.Point(g.br.x,g.tl.y),g.bl=new t.Point(g.tl.x,g.br.y),this.vptCoords=g,g},cancelRequestedRender:function(){this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(g,v){var x=this.viewportTransform,y=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(g),t.util.setImageSmoothing(g,this.imageSmoothingEnabled),this.fire("before:render",{ctx:g}),this._renderBackground(g),g.save(),g.transform(x[0],x[1],x[2],x[3],x[4],x[5]),this._renderObjects(g,v),g.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(g),y&&(y.canvas=this,y.shouldCache(),y._transformDone=!0,y.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(g)),this._renderOverlay(g),this.controlsAboveOverlay&&this.interactive&&this.drawControls(g),this.fire("after:render",{ctx:g})},drawClipPathOnCanvas:function(g){var v=this.viewportTransform,x=this.clipPath;g.save(),g.transform(v[0],v[1],v[2],v[3],v[4],v[5]),g.globalCompositeOperation="destination-in",x.transform(g),g.scale(1/x.zoomX,1/x.zoomY),g.drawImage(x._cacheCanvas,-x.cacheTranslationX,-x.cacheTranslationY),g.restore()},_renderObjects:function(g,v){var x,y;for(x=0,y=v.length;x<y;++x)v[x]&&v[x].render(g)},_renderBackgroundOrOverlay:function(g,v){var x=this[v+"Color"],y=this[v+"Image"],_=this.viewportTransform,w=this[v+"Vpt"];if(!(!x&&!y)){if(x){g.save(),g.beginPath(),g.moveTo(0,0),g.lineTo(this.width,0),g.lineTo(this.width,this.height),g.lineTo(0,this.height),g.closePath(),g.fillStyle=x.toLive?x.toLive(g,this):x,w&&g.transform(_[0],_[1],_[2],_[3],_[4],_[5]),g.transform(1,0,0,1,x.offsetX||0,x.offsetY||0);var T=x.gradientTransform||x.patternTransform;T&&g.transform(T[0],T[1],T[2],T[3],T[4],T[5]),g.fill(),g.restore()}if(y){g.save();var k=this.skipOffscreen;this.skipOffscreen=w,w&&g.transform(_[0],_[1],_[2],_[3],_[4],_[5]),y.render(g),this.skipOffscreen=k,g.restore()}}},_renderBackground:function(g){this._renderBackgroundOrOverlay(g,"background")},_renderOverlay:function(g){this._renderBackgroundOrOverlay(g,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new t.Point(this.width/2,this.height/2)},centerObjectH:function(g){return this._centerObject(g,new t.Point(this.getCenterPoint().x,g.getCenterPoint().y))},centerObjectV:function(g){return this._centerObject(g,new t.Point(g.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(g){var v=this.getCenterPoint();return this._centerObject(g,v)},viewportCenterObject:function(g){var v=this.getVpCenter();return this._centerObject(g,v)},viewportCenterObjectH:function(g){var v=this.getVpCenter();return this._centerObject(g,new t.Point(v.x,g.getCenterPoint().y)),this},viewportCenterObjectV:function(g){var v=this.getVpCenter();return this._centerObject(g,new t.Point(g.getCenterPoint().x,v.y))},getVpCenter:function(){var g=this.getCenterPoint(),v=h(this.viewportTransform);return f(g,v)},_centerObject:function(g,v){return g.setPositionByOrigin(v,"center","center"),g.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(g){return this.toDatalessObject(g)},toObject:function(g){return this._toObjectMethod("toObject",g)},toDatalessObject:function(g){return this._toObjectMethod("toDatalessObject",g)},_toObjectMethod:function(g,v){var x=this.clipPath,y={version:t.version,objects:this._toObjects(g,v)};return x&&!x.excludeFromExport&&(y.clipPath=this._toObject(this.clipPath,g,v)),o(y,this.__serializeBgOverlay(g,v)),t.util.populateWithProperties(this,y,v),y},_toObjects:function(g,v){return this._objects.filter(function(x){return!x.excludeFromExport}).map(function(x){return this._toObject(x,g,v)},this)},_toObject:function(g,v,x){var y;this.includeDefaultValues||(y=g.includeDefaultValues,g.includeDefaultValues=!1);var _=g[v](x);return this.includeDefaultValues||(g.includeDefaultValues=y),_},__serializeBgOverlay:function(g,v){var x={},y=this.backgroundImage,_=this.overlayImage,w=this.backgroundColor,T=this.overlayColor;return w&&w.toObject?w.excludeFromExport||(x.background=w.toObject(v)):w&&(x.background=w),T&&T.toObject?T.excludeFromExport||(x.overlay=T.toObject(v)):T&&(x.overlay=T),y&&!y.excludeFromExport&&(x.backgroundImage=this._toObject(y,g,v)),_&&!_.excludeFromExport&&(x.overlayImage=this._toObject(_,g,v)),x},svgViewportTransformation:!0,toSVG:function(g,v){g||(g={}),g.reviver=v;var x=[];return this._setSVGPreamble(x,g),this._setSVGHeader(x,g),this.clipPath&&x.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(x,"background"),this._setSVGBgOverlayImage(x,"backgroundImage",v),this._setSVGObjects(x,v),this.clipPath&&x.push(`</g>
`),this._setSVGBgOverlayColor(x,"overlay"),this._setSVGBgOverlayImage(x,"overlayImage",v),x.push("</svg>"),x.join("")},_setSVGPreamble:function(g,v){v.suppressPreamble||g.push('<?xml version="1.0" encoding="',v.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(g,v){var x=v.width||this.width,y=v.height||this.height,_,w='viewBox="0 0 '+this.width+" "+this.height+'" ',T=t.Object.NUM_FRACTION_DIGITS;v.viewBox?w='viewBox="'+v.viewBox.x+" "+v.viewBox.y+" "+v.viewBox.width+" "+v.viewBox.height+'" ':this.svgViewportTransformation&&(_=this.viewportTransform,w='viewBox="'+d(-_[4]/_[0],T)+" "+d(-_[5]/_[3],T)+" "+d(this.width/_[0],T)+" "+d(this.height/_[3],T)+'" '),g.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',x,'" ','height="',y,'" ',w,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",t.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(v),`</defs>
`)},createSVGClipPathMarkup:function(g){var v=this.clipPath;return v?(v.clipPathId="CLIPPATH_"+t.Object.__uid++,'<clipPath id="'+v.clipPathId+`" >
`+this.clipPath.toClipPathSVG(g.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var g=this,v=["background","overlay"].map(function(x){var y=g[x+"Color"];if(y&&y.toLive){var _=g[x+"Vpt"],w=g.viewportTransform,T={width:g.width/(_?w[0]:1),height:g.height/(_?w[3]:1)};return y.toSVG(T,{additionalTransform:_?t.util.matrixToSVG(w):""})}});return v.join("")},createSVGFontFacesMarkup:function(){var g="",v={},x,y,_,w,T,k,O,F,M,V=t.fontPaths,X=[];for(this._objects.forEach(function ae(ne){X.push(ne),ne._objects&&ne._objects.forEach(ae)}),F=0,M=X.length;F<M;F++)if(x=X[F],y=x.fontFamily,!(x.type.indexOf("text")===-1||v[y]||!V[y])&&(v[y]=!0,!!x.styles)){_=x.styles;for(T in _){w=_[T];for(O in w)k=w[O],y=k.fontFamily,!v[y]&&V[y]&&(v[y]=!0)}}for(var q in v)g+=[`		@font-face {
`,"			font-family: '",q,`';
`,"			src: url('",V[q],`');
`,`		}
`].join("");return g&&(g=['	<style type="text/css">',`<![CDATA[
`,g,"]]>",`</style>
`].join("")),g},_setSVGObjects:function(g,v){var x,y,_,w=this._objects;for(y=0,_=w.length;y<_;y++)x=w[y],!x.excludeFromExport&&this._setSVGObject(g,x,v)},_setSVGObject:function(g,v,x){g.push(v.toSVG(x))},_setSVGBgOverlayImage:function(g,v,x){this[v]&&!this[v].excludeFromExport&&this[v].toSVG&&g.push(this[v].toSVG(x))},_setSVGBgOverlayColor:function(g,v){var x=this[v+"Color"],y=this.viewportTransform,_=this.width,w=this.height;if(x)if(x.toLive){var T=x.repeat,k=t.util.invertTransform(y),O=this[v+"Vpt"],F=O?t.util.matrixToSVG(k):"";g.push('<rect transform="'+F+" translate(",_/2,",",w/2,')"',' x="',x.offsetX-_/2,'" y="',x.offsetY-w/2,'" ','width="',T==="repeat-y"||T==="no-repeat"?x.source.width:_,'" height="',T==="repeat-x"||T==="no-repeat"?x.source.height:w,'" fill="url(#SVGID_'+x.id+')"',`></rect>
`)}else g.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',x,'"',`></rect>
`)},sendToBack:function(g){if(!g)return this;var v=this._activeObject,x,y,_;if(g===v&&g.type==="activeSelection")for(_=v._objects,x=_.length;x--;)y=_[x],c(this._objects,y),this._objects.unshift(y);else c(this._objects,g),this._objects.unshift(g);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(g){if(!g)return this;var v=this._activeObject,x,y,_;if(g===v&&g.type==="activeSelection")for(_=v._objects,x=0;x<_.length;x++)y=_[x],c(this._objects,y),this._objects.push(y);else c(this._objects,g),this._objects.push(g);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(g,v){if(!g)return this;var x=this._activeObject,y,_,w,T,k,O=0;if(g===x&&g.type==="activeSelection")for(k=x._objects,y=0;y<k.length;y++)_=k[y],w=this._objects.indexOf(_),w>0+O&&(T=w-1,c(this._objects,_),this._objects.splice(T,0,_)),O++;else w=this._objects.indexOf(g),w!==0&&(T=this._findNewLowerIndex(g,w,v),c(this._objects,g),this._objects.splice(T,0,g));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(g,v,x){var y,_;if(x)for(y=v,_=v-1;_>=0;--_){var w=g.intersectsWithObject(this._objects[_])||g.isContainedWithinObject(this._objects[_])||this._objects[_].isContainedWithinObject(g);if(w){y=_;break}}else y=v-1;return y},bringForward:function(g,v){if(!g)return this;var x=this._activeObject,y,_,w,T,k,O=0;if(g===x&&g.type==="activeSelection")for(k=x._objects,y=k.length;y--;)_=k[y],w=this._objects.indexOf(_),w<this._objects.length-1-O&&(T=w+1,c(this._objects,_),this._objects.splice(T,0,_)),O++;else w=this._objects.indexOf(g),w!==this._objects.length-1&&(T=this._findNewUpperIndex(g,w,v),c(this._objects,g),this._objects.splice(T,0,g));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(g,v,x){var y,_,w;if(x)for(y=v,_=v+1,w=this._objects.length;_<w;++_){var T=g.intersectsWithObject(this._objects[_])||g.isContainedWithinObject(this._objects[_])||this._objects[_].isContainedWithinObject(g);if(T){y=_;break}}else y=v+1;return y},moveTo:function(g,v){return c(this._objects,g),this._objects.splice(v,0,g),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(g){g.dispose&&g.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),t.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),t.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),o(t.StaticCanvas.prototype,t.Observable),o(t.StaticCanvas.prototype,t.Collection),o(t.StaticCanvas.prototype,t.DataURLExporter),o(t.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(g){var v=p();if(!v||!v.getContext)return null;var x=v.getContext("2d");if(!x)return null;switch(g){case"setLineDash":return typeof x.setLineDash<"u";default:return null}}}),t.StaticCanvas.prototype.toJSON=t.StaticCanvas.prototype.toObject,t.isLikelyNode&&(t.StaticCanvas.prototype.createPNGStream=function(){var g=u(this.lowerCanvasEl);return g&&g.createPNGStream()},t.StaticCanvas.prototype.createJPEGStream=function(g){var v=u(this.lowerCanvasEl);return v&&v.createJPEGStream(g)})}(),t.BaseBrush=t.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(o){o.strokeStyle=this.color,o.lineWidth=this.width,o.lineCap=this.strokeLineCap,o.miterLimit=this.strokeMiterLimit,o.lineJoin=this.strokeLineJoin,o.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(o){var s=this.canvas.viewportTransform;o.save(),o.transform(s[0],s[1],s[2],s[3],s[4],s[5])},_setShadow:function(){if(this.shadow){var o=this.canvas,s=this.shadow,c=o.contextTop,d=o.getZoom();o&&o._isRetinaScaling()&&(d*=t.devicePixelRatio),c.shadowColor=s.color,c.shadowBlur=s.blur*d,c.shadowOffsetX=s.offsetX*d,c.shadowOffsetY=s.offsetY*d}},needsFullRender:function(){var o=new t.Color(this.color);return o.getAlpha()<1||!!this.shadow},_resetShadow:function(){var o=this.canvas.contextTop;o.shadowColor="",o.shadowBlur=o.shadowOffsetX=o.shadowOffsetY=0},_isOutSideCanvas:function(o){return o.x<0||o.x>this.canvas.getWidth()||o.y<0||o.y>this.canvas.getHeight()}}),function(){t.PencilBrush=t.util.createClass(t.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(o){this.canvas=o,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(o,s,c){var d=s.midPointFrom(c);return o.quadraticCurveTo(s.x,s.y,d.x,d.y),d},onMouseDown:function(o,s){this.canvas._isMainEvent(s.e)&&(this.drawStraightLine=s.e[this.straightLineKey],this._prepareForDrawing(o),this._captureDrawingPath(o),this._render())},onMouseMove:function(o,s){if(this.canvas._isMainEvent(s.e)&&(this.drawStraightLine=s.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o))&&this._captureDrawingPath(o)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var c=this._points,d=c.length,f=this.canvas.contextTop;this._saveAndTransform(f),this.oldEnd&&(f.beginPath(),f.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(f,c[d-2],c[d-1],!0),f.stroke(),f.restore()}},onMouseUp:function(o){return this.canvas._isMainEvent(o.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(o){var s=new t.Point(o.x,o.y);this._reset(),this._addPoint(s),this.canvas.contextTop.moveTo(s.x,s.y)},_addPoint:function(o){return this._points.length>1&&o.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(o),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(o){var s=new t.Point(o.x,o.y);return this._addPoint(s)},_render:function(o){var s,c,d=this._points[0],f=this._points[1];if(o=o||this.canvas.contextTop,this._saveAndTransform(o),o.beginPath(),this._points.length===2&&d.x===f.x&&d.y===f.y){var h=this.width/1e3;d=new t.Point(d.x,d.y),f=new t.Point(f.x,f.y),d.x-=h,f.x+=h}for(o.moveTo(d.x,d.y),s=1,c=this._points.length;s<c;s++)this._drawSegment(o,d,f),d=this._points[s],f=this._points[s+1];o.lineTo(d.x,d.y),o.stroke(),o.restore()},convertPointsToSVGPath:function(o){var s=this.width/1e3;return t.util.getSmoothPathFromPoints(o,s)},_isEmptySVGPath:function(o){var s=t.util.joinPath(o);return s==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(o){var s=new t.Path(o,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,s.shadow=new t.Shadow(this.shadow)),s},decimatePoints:function(o,s){if(o.length<=2)return o;var c=this.canvas.getZoom(),d=Math.pow(s/c,2),f,h=o.length-1,u=o[0],p=[u],m;for(f=1;f<h-1;f++)m=Math.pow(u.x-o[f].x,2)+Math.pow(u.y-o[f].y,2),m>=d&&(u=o[f],p.push(u));return p.push(o[h]),p},_finalizeAndAddPath:function(){var o=this.canvas.contextTop;o.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var s=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(s)){this.canvas.requestRenderAll();return}var c=this.createPath(s);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:c}),this.canvas.add(c),this.canvas.requestRenderAll(),c.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:c})}})}(),t.CircleBrush=t.util.createClass(t.BaseBrush,{width:10,initialize:function(o){this.canvas=o,this.points=[]},drawDot:function(o){var s=this.addPoint(o),c=this.canvas.contextTop;this._saveAndTransform(c),this.dot(c,s),c.restore()},dot:function(o,s){o.fillStyle=s.fill,o.beginPath(),o.arc(s.x,s.y,s.radius,0,Math.PI*2,!1),o.closePath(),o.fill()},onMouseDown:function(o){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(o)},_render:function(){var o=this.canvas.contextTop,s,c,d=this.points;for(this._saveAndTransform(o),s=0,c=d.length;s<c;s++)this.dot(o,d[s]);o.restore()},onMouseMove:function(o){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(o),this._render()):this.drawDot(o))},onMouseUp:function(){var o=this.canvas.renderOnAddRemove,s,c;this.canvas.renderOnAddRemove=!1;var d=[];for(s=0,c=this.points.length;s<c;s++){var f=this.points[s],h=new t.Circle({radius:f.radius,left:f.x,top:f.y,originX:"center",originY:"center",fill:f.fill});this.shadow&&(h.shadow=new t.Shadow(this.shadow)),d.push(h)}var u=new t.Group(d);u.canvas=this.canvas,this.canvas.fire("before:path:created",{path:u}),this.canvas.add(u),this.canvas.fire("path:created",{path:u}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=o,this.canvas.requestRenderAll()},addPoint:function(o){var s=new t.Point(o.x,o.y),c=t.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,d=new t.Color(this.color).setAlpha(t.util.getRandomInt(0,100)/100).toRgba();return s.radius=c,s.fill=d,this.points.push(s),s}}),t.SprayBrush=t.util.createClass(t.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(o){this.canvas=o,this.sprayChunks=[]},onMouseDown:function(o){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(o),this.render(this.sprayChunkPoints)},onMouseMove:function(o){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o)||(this.addSprayChunk(o),this.render(this.sprayChunkPoints))},onMouseUp:function(){var o=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var s=[],c=0,d=this.sprayChunks.length;c<d;c++)for(var f=this.sprayChunks[c],h=0,u=f.length;h<u;h++){var p=new t.Rect({width:f[h].width,height:f[h].width,left:f[h].x+1,top:f[h].y+1,originX:"center",originY:"center",fill:this.color});s.push(p)}this.optimizeOverlapping&&(s=this._getOptimizedRects(s));var m=new t.Group(s);this.shadow&&m.set("shadow",new t.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:m}),this.canvas.add(m),this.canvas.fire("path:created",{path:m}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=o,this.canvas.requestRenderAll()},_getOptimizedRects:function(o){var s={},c,d,f;for(d=0,f=o.length;d<f;d++)c=o[d].left+""+o[d].top,s[c]||(s[c]=o[d]);var h=[];for(c in s)h.push(s[c]);return h},render:function(o){var s=this.canvas.contextTop,c,d;for(s.fillStyle=this.color,this._saveAndTransform(s),c=0,d=o.length;c<d;c++){var f=o[c];typeof f.opacity<"u"&&(s.globalAlpha=f.opacity),s.fillRect(f.x,f.y,f.width,f.width)}s.restore()},_render:function(){var o=this.canvas.contextTop,s,c;for(o.fillStyle=this.color,this._saveAndTransform(o),s=0,c=this.sprayChunks.length;s<c;s++)this.render(this.sprayChunks[s]);o.restore()},addSprayChunk:function(o){this.sprayChunkPoints=[];var s,c,d,f=this.width/2,h;for(h=0;h<this.density;h++){s=t.util.getRandomInt(o.x-f,o.x+f),c=t.util.getRandomInt(o.y-f,o.y+f),this.dotWidthVariance?d=t.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):d=this.dotWidth;var u=new t.Point(s,c);u.width=d,this.randomOpacity&&(u.opacity=t.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(u)}this.sprayChunks.push(this.sprayChunkPoints)}}),t.PatternBrush=t.util.createClass(t.PencilBrush,{getPatternSrc:function(){var o=20,s=5,c=t.util.createCanvasElement(),d=c.getContext("2d");return c.width=c.height=o+s,d.fillStyle=this.color,d.beginPath(),d.arc(o/2,o/2,o/2,0,Math.PI*2,!1),d.closePath(),d.fill(),c},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(o){return o.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(o){this.callSuper("_setBrushStyles",o),o.strokeStyle=this.getPattern(o)},createPath:function(o){var s=this.callSuper("createPath",o),c=s._getLeftTopCoords().scalarAdd(s.strokeWidth/2);return s.stroke=new t.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-c.x,offsetY:-c.y}),s}}),function(){var o=t.util.getPointer,s=t.util.degreesToRadians,c=t.util.isTouchEvent;t.Canvas=t.util.createClass(t.StaticCanvas,{initialize:function(f,h){h||(h={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(f,h),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=t.PencilBrush&&new t.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var f=this.getActiveObjects(),h,u,p;if(f.length>0&&!this.preserveObjectStacking){u=[],p=[];for(var m=0,g=this._objects.length;m<g;m++)h=this._objects[m],f.indexOf(h)===-1?u.push(h):p.push(h);f.length>1&&(this._activeObject._objects=p),u.push.apply(u,p)}else u=this._objects;return u},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var f=this.contextContainer;return this.renderCanvas(f,this._chooseObjectsToRender()),this},renderTopLayer:function(f){f.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(f),this.contextTopDirty=!0),f.restore()},renderTop:function(){var f=this.contextTop;return this.clearContext(f),this.renderTopLayer(f),this.fire("after:render"),this},_normalizePointer:function(f,h){var u=f.calcTransformMatrix(),p=t.util.invertTransform(u),m=this.restorePointerVpt(h);return t.util.transformPoint(m,p)},isTargetTransparent:function(f,h,u){if(f.shouldCache()&&f._cacheCanvas&&f!==this._activeObject){var p=this._normalizePointer(f,{x:h,y:u}),m=Math.max(f.cacheTranslationX+p.x*f.zoomX,0),g=Math.max(f.cacheTranslationY+p.y*f.zoomY,0),_=t.util.isTransparent(f._cacheContext,Math.round(m),Math.round(g),this.targetFindTolerance);return _}var v=this.contextCache,x=f.selectionBackgroundColor,y=this.viewportTransform;f.selectionBackgroundColor="",this.clearContext(v),v.save(),v.transform(y[0],y[1],y[2],y[3],y[4],y[5]),f.render(v),v.restore(),f.selectionBackgroundColor=x;var _=t.util.isTransparent(v,h,u,this.targetFindTolerance);return _},_isSelectionKeyPressed:function(f){var h=!1;return Array.isArray(this.selectionKey)?h=!!this.selectionKey.find(function(u){return f[u]===!0}):h=f[this.selectionKey],h},_shouldClearSelection:function(f,h){var u=this.getActiveObjects(),p=this._activeObject;return!h||h&&p&&u.length>1&&u.indexOf(h)===-1&&p!==h&&!this._isSelectionKeyPressed(f)||h&&!h.evented||h&&!h.selectable&&p&&p!==h},_shouldCenterTransform:function(f,h,u){if(f){var p;return h==="scale"||h==="scaleX"||h==="scaleY"||h==="resizing"?p=this.centeredScaling||f.centeredScaling:h==="rotate"&&(p=this.centeredRotation||f.centeredRotation),p?!u:u}},_getOriginFromCorner:function(f,h){var u={x:f.originX,y:f.originY};return h==="ml"||h==="tl"||h==="bl"?u.x="right":(h==="mr"||h==="tr"||h==="br")&&(u.x="left"),h==="tl"||h==="mt"||h==="tr"?u.y="bottom":(h==="bl"||h==="mb"||h==="br")&&(u.y="top"),u},_getActionFromCorner:function(f,h,u,p){if(!h||!f)return"drag";var m=p.controls[h];return m.getActionName(u,m,p)},_setupCurrentTransform:function(f,h,u){if(h){var p=this.getPointer(f),m=h.__corner,g=h.controls[m],v=u&&m?g.getActionHandler(f,h,g):t.controlsUtils.dragHandler,x=this._getActionFromCorner(u,m,f,h),y=this._getOriginFromCorner(h,m),_=f[this.centeredKey],w={target:h,action:x,actionHandler:v,corner:m,scaleX:h.scaleX,scaleY:h.scaleY,skewX:h.skewX,skewY:h.skewY,offsetX:p.x-h.left,offsetY:p.y-h.top,originX:y.x,originY:y.y,ex:p.x,ey:p.y,lastX:p.x,lastY:p.y,theta:s(h.angle),width:h.width*h.scaleX,shiftKey:f.shiftKey,altKey:_,original:t.util.saveObjectTransform(h)};this._shouldCenterTransform(h,x,_)&&(w.originX="center",w.originY="center"),w.original.originX=y.x,w.original.originY=y.y,this._currentTransform=w,this._beforeTransform(f)}},setCursor:function(f){this.upperCanvasEl.style.cursor=f},_drawSelection:function(f){var h=this._groupSelector,u=new t.Point(h.ex,h.ey),p=t.util.transformPoint(u,this.viewportTransform),m=new t.Point(h.ex+h.left,h.ey+h.top),g=t.util.transformPoint(m,this.viewportTransform),v=Math.min(p.x,g.x),x=Math.min(p.y,g.y),y=Math.max(p.x,g.x),_=Math.max(p.y,g.y),w=this.selectionLineWidth/2;this.selectionColor&&(f.fillStyle=this.selectionColor,f.fillRect(v,x,y-v,_-x)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(f.lineWidth=this.selectionLineWidth,f.strokeStyle=this.selectionBorderColor,v+=w,x+=w,y-=w,_-=w,t.Object.prototype._setLineDash.call(this,f,this.selectionDashArray),f.strokeRect(v,x,y-v,_-x))},findTarget:function(f,h){if(!this.skipTargetFind){var u=!0,p=this.getPointer(f,u),m=this._activeObject,g=this.getActiveObjects(),v,x,y=c(f),_=g.length>1&&!h||g.length===1;if(this.targets=[],_&&m._findTargetCorner(p,y)||g.length>1&&!h&&m===this._searchPossibleTargets([m],p))return m;if(g.length===1&&m===this._searchPossibleTargets([m],p))if(this.preserveObjectStacking)v=m,x=this.targets,this.targets=[];else return m;var w=this._searchPossibleTargets(this._objects,p);return f[this.altSelectionKey]&&w&&v&&w!==v&&(w=v,this.targets=x),w}},_checkTarget:function(f,h,u){if(h&&h.visible&&h.evented&&h.containsPoint(f))if((this.perPixelTargetFind||h.perPixelTargetFind)&&!h.isEditing){var p=this.isTargetTransparent(h,u.x,u.y);if(!p)return!0}else return!0},_searchPossibleTargets:function(f,h){for(var u,p=f.length,m;p--;){var g=f[p],v=g.group?this._normalizePointer(g.group,h):h;if(this._checkTarget(v,g,h)){u=f[p],u.subTargetCheck&&u instanceof t.Group&&(m=this._searchPossibleTargets(u._objects,h),m&&this.targets.push(m));break}}return u},restorePointerVpt:function(f){return t.util.transformPoint(f,t.util.invertTransform(this.viewportTransform))},getPointer:function(f,h){if(this._absolutePointer&&!h)return this._absolutePointer;if(this._pointer&&h)return this._pointer;var u=o(f),p=this.upperCanvasEl,m=p.getBoundingClientRect(),g=m.width||0,v=m.height||0,x;(!g||!v)&&("top"in m&&"bottom"in m&&(v=Math.abs(m.top-m.bottom)),"right"in m&&"left"in m&&(g=Math.abs(m.right-m.left))),this.calcOffset(),u.x=u.x-this._offset.left,u.y=u.y-this._offset.top,h||(u=this.restorePointerVpt(u));var y=this.getRetinaScaling();return y!==1&&(u.x/=y,u.y/=y),g===0||v===0?x={width:1,height:1}:x={width:p.width/g,height:p.height/v},{x:u.x*x.width,y:u.y*x.height}},_createUpperCanvas:function(){var f=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),h=this.lowerCanvasEl,u=this.upperCanvasEl;u?u.className="":(u=this._createCanvasElement(),this.upperCanvasEl=u),t.util.addClass(u,"upper-canvas "+f),this.wrapperEl.appendChild(u),this._copyCanvasStyle(h,u),this._applyCanvasStyle(u),this.contextTop=u.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=t.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),t.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),t.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(f){var h=this.width||f.width,u=this.height||f.height;t.util.setStyle(f,{position:"absolute",width:h+"px",height:u+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),f.width=h,f.height=u,t.util.makeElementUnselectable(f)},_copyCanvasStyle:function(f,h){h.style.cssText=f.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var f=this._activeObject;return f?f.type==="activeSelection"&&f._objects?f._objects.slice(0):[f]:[]},_onObjectRemoved:function(f){f===this._activeObject&&(this.fire("before:selection:cleared",{target:f}),this._discardActiveObject(),this.fire("selection:cleared",{target:f}),f.fire("deselected")),f===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",f)},_fireSelectionEvents:function(f,h){var u=!1,p=this.getActiveObjects(),m=[],g=[];f.forEach(function(v){p.indexOf(v)===-1&&(u=!0,v.fire("deselected",{e:h,target:v}),g.push(v))}),p.forEach(function(v){f.indexOf(v)===-1&&(u=!0,v.fire("selected",{e:h,target:v}),m.push(v))}),f.length>0&&p.length>0?u&&this.fire("selection:updated",{e:h,selected:m,deselected:g}):p.length>0?this.fire("selection:created",{e:h,selected:m}):f.length>0&&this.fire("selection:cleared",{e:h,deselected:g})},setActiveObject:function(f,h){var u=this.getActiveObjects();return this._setActiveObject(f,h),this._fireSelectionEvents(u,h),this},_setActiveObject:function(f,h){return this._activeObject===f||!this._discardActiveObject(h,f)||f.onSelect({e:h})?!1:(this._activeObject=f,!0)},_discardActiveObject:function(f,h){var u=this._activeObject;if(u){if(u.onDeselect({e:f,object:h}))return!1;this._activeObject=null}return!0},discardActiveObject:function(f){var h=this.getActiveObjects(),u=this.getActiveObject();return h.length&&this.fire("before:selection:cleared",{target:u,e:f}),this._discardActiveObject(f),this._fireSelectionEvents(h,f),this},dispose:function(){var f=this.wrapperEl;return this.removeListeners(),f.removeChild(this.upperCanvasEl),f.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach((function(h){t.util.cleanUpJsdomNode(this[h]),this[h]=void 0}).bind(this)),f.parentNode&&f.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,t.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(f){var h=this._activeObject;h&&h._renderControls(f)},_toObject:function(f,h,u){var p=this._realizeGroupTransformOnObject(f),m=this.callSuper("_toObject",f,h,u);return this._unwindGroupTransformOnObject(f,p),m},_realizeGroupTransformOnObject:function(f){if(f.group&&f.group.type==="activeSelection"&&this._activeObject===f.group){var h=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],u={};return h.forEach(function(p){u[p]=f[p]}),t.util.addTransformToObject(f,this._activeObject.calcOwnMatrix()),u}else return null},_unwindGroupTransformOnObject:function(f,h){h&&f.set(h)},_setSVGObject:function(f,h,u){var p=this._realizeGroupTransformOnObject(h);this.callSuper("_setSVGObject",f,h,u),this._unwindGroupTransformOnObject(h,p)},setViewportTransform:function(f){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),t.StaticCanvas.prototype.setViewportTransform.call(this,f)}});for(var d in t.StaticCanvas)d!=="prototype"&&(t.Canvas[d]=t.StaticCanvas[d])}(),function(){var o=t.util.addListener,s=t.util.removeListener,c=3,d=2,f=1,h={passive:!1};function u(p,m){return p.button&&p.button===m-1}t.util.object.extend(t.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(o,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(p,m){var g=this.upperCanvasEl,v=this._getEventPrefix();p(t.window,"resize",this._onResize),p(g,v+"down",this._onMouseDown),p(g,v+"move",this._onMouseMove,h),p(g,v+"out",this._onMouseOut),p(g,v+"enter",this._onMouseEnter),p(g,"wheel",this._onMouseWheel),p(g,"contextmenu",this._onContextMenu),p(g,"dblclick",this._onDoubleClick),p(g,"dragover",this._onDragOver),p(g,"dragenter",this._onDragEnter),p(g,"dragleave",this._onDragLeave),p(g,"drop",this._onDrop),this.enablePointerEvents||p(g,"touchstart",this._onTouchStart,h),typeof eventjs<"u"&&m in eventjs&&(eventjs[m](g,"gesture",this._onGesture),eventjs[m](g,"drag",this._onDrag),eventjs[m](g,"orientation",this._onOrientationChange),eventjs[m](g,"shake",this._onShake),eventjs[m](g,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(s,"remove");var p=this._getEventPrefix();s(t.document,p+"up",this._onMouseUp),s(t.document,"touchend",this._onTouchEnd,h),s(t.document,p+"move",this._onMouseMove,h),s(t.document,"touchmove",this._onMouseMove,h)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(p,m){this.__onTransformGesture&&this.__onTransformGesture(p,m)},_onDrag:function(p,m){this.__onDrag&&this.__onDrag(p,m)},_onMouseWheel:function(p){this.__onMouseWheel(p)},_onMouseOut:function(p){var m=this._hoveredTarget;this.fire("mouse:out",{target:m,e:p}),this._hoveredTarget=null,m&&m.fire("mouseout",{e:p});var g=this;this._hoveredTargets.forEach(function(v){g.fire("mouse:out",{target:v,e:p}),v&&v.fire("mouseout",{e:p})}),this._hoveredTargets=[]},_onMouseEnter:function(p){!this._currentTransform&&!this.findTarget(p)&&(this.fire("mouse:over",{target:null,e:p}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(p,m){this.__onOrientationChange&&this.__onOrientationChange(p,m)},_onShake:function(p,m){this.__onShake&&this.__onShake(p,m)},_onLongPress:function(p,m){this.__onLongPress&&this.__onLongPress(p,m)},_onDragOver:function(p){p.preventDefault();var m=this._simpleEventHandler("dragover",p);this._fireEnterLeaveEvents(m,p)},_onDrop:function(p){return this._simpleEventHandler("drop:before",p),this._simpleEventHandler("drop",p)},_onContextMenu:function(p){return this.stopContextMenu&&(p.stopPropagation(),p.preventDefault()),!1},_onDoubleClick:function(p){this._cacheTransformEventData(p),this._handleEvent(p,"dblclick"),this._resetTransformEventData(p)},getPointerId:function(p){var m=p.changedTouches;return m?m[0]&&m[0].identifier:this.enablePointerEvents?p.pointerId:-1},_isMainEvent:function(p){return p.isPrimary===!0?!0:p.isPrimary===!1?!1:p.type==="touchend"&&p.touches.length===0?!0:p.changedTouches?p.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(p){p.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(p)),this.__onMouseDown(p),this._resetTransformEventData();var m=this.upperCanvasEl,g=this._getEventPrefix();o(t.document,"touchend",this._onTouchEnd,h),o(t.document,"touchmove",this._onMouseMove,h),s(m,g+"down",this._onMouseDown)},_onMouseDown:function(p){this.__onMouseDown(p),this._resetTransformEventData();var m=this.upperCanvasEl,g=this._getEventPrefix();s(m,g+"move",this._onMouseMove,h),o(t.document,g+"up",this._onMouseUp),o(t.document,g+"move",this._onMouseMove,h)},_onTouchEnd:function(p){if(!(p.touches.length>0)){this.__onMouseUp(p),this._resetTransformEventData(),this.mainTouchId=null;var m=this._getEventPrefix();s(t.document,"touchend",this._onTouchEnd,h),s(t.document,"touchmove",this._onMouseMove,h);var g=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){o(g.upperCanvasEl,m+"down",g._onMouseDown),g._willAddMouseDown=0},400)}},_onMouseUp:function(p){this.__onMouseUp(p),this._resetTransformEventData();var m=this.upperCanvasEl,g=this._getEventPrefix();this._isMainEvent(p)&&(s(t.document,g+"up",this._onMouseUp),s(t.document,g+"move",this._onMouseMove,h),o(m,g+"move",this._onMouseMove,h))},_onMouseMove:function(p){!this.allowTouchScrolling&&p.preventDefault&&p.preventDefault(),this.__onMouseMove(p)},_onResize:function(){this.calcOffset()},_shouldRender:function(p){var m=this._activeObject;return!!m!=!!p||m&&p&&m!==p?!0:(m&&m.isEditing,!1)},__onMouseUp:function(p){var m,g=this._currentTransform,v=this._groupSelector,x=!1,y=!v||v.left===0&&v.top===0;if(this._cacheTransformEventData(p),m=this._target,this._handleEvent(p,"up:before"),u(p,c)){this.fireRightClick&&this._handleEvent(p,"up",c,y);return}if(u(p,d)){this.fireMiddleClick&&this._handleEvent(p,"up",d,y),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(p);return}if(this._isMainEvent(p)){if(g&&(this._finalizeCurrentTransform(p),x=g.actionPerformed),!y){var _=m===this._activeObject;this._maybeGroupObjects(p),x||(x=this._shouldRender(m)||!_&&m===this._activeObject)}var w,T;if(m){if(w=m._findTargetCorner(this.getPointer(p,!0),t.util.isTouchEvent(p)),m.selectable&&m!==this._activeObject&&m.activeOn==="up")this.setActiveObject(m,p),x=!0;else{var k=m.controls[w],O=k&&k.getMouseUpHandler(p,m,k);O&&(T=this.getPointer(p),O(p,g,T.x,T.y))}m.isMoving=!1}if(g&&(g.target!==m||g.corner!==w)){var F=g.target&&g.target.controls[g.corner],M=F&&F.getMouseUpHandler(p,m,k);T=T||this.getPointer(p),M&&M(p,g,T.x,T.y)}this._setCursorFromEvent(p,m),this._handleEvent(p,"up",f,y),this._groupSelector=null,this._currentTransform=null,m&&(m.__corner=0),x?this.requestRenderAll():y||this.renderTop()}},_simpleEventHandler:function(p,m){var g=this.findTarget(m),v=this.targets,x={e:m,target:g,subTargets:v};if(this.fire(p,x),g&&g.fire(p,x),!v)return g;for(var y=0;y<v.length;y++)v[y].fire(p,x);return g},_handleEvent:function(p,m,g,v){var x=this._target,y=this.targets||[],_={e:p,target:x,subTargets:y,button:g||f,isClick:v||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};m==="up"&&(_.currentTarget=this.findTarget(p),_.currentSubTargets=this.targets),this.fire("mouse:"+m,_),x&&x.fire("mouse"+m,_);for(var w=0;w<y.length;w++)y[w].fire("mouse"+m,_)},_finalizeCurrentTransform:function(p){var m=this._currentTransform,g=m.target,v={e:p,target:g,transform:m,action:m.action};g._scaling&&(g._scaling=!1),g.setCoords(),(m.actionPerformed||this.stateful&&g.hasStateChanged())&&this._fire("modified",v)},_onMouseDownInDrawingMode:function(p){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(p).requestRenderAll();var m=this.getPointer(p);this.freeDrawingBrush.onMouseDown(m,{e:p,pointer:m}),this._handleEvent(p,"down")},_onMouseMoveInDrawingMode:function(p){if(this._isCurrentlyDrawing){var m=this.getPointer(p);this.freeDrawingBrush.onMouseMove(m,{e:p,pointer:m})}this.setCursor(this.freeDrawingCursor),this._handleEvent(p,"move")},_onMouseUpInDrawingMode:function(p){var m=this.getPointer(p);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:p,pointer:m}),this._handleEvent(p,"up")},__onMouseDown:function(p){this._cacheTransformEventData(p),this._handleEvent(p,"down:before");var m=this._target;if(u(p,c)){this.fireRightClick&&this._handleEvent(p,"down",c);return}if(u(p,d)){this.fireMiddleClick&&this._handleEvent(p,"down",d);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(p);return}if(this._isMainEvent(p)&&!this._currentTransform){var g=this._pointer;this._previousPointer=g;var v=this._shouldRender(m),x=this._shouldGroup(p,m);if(this._shouldClearSelection(p,m)?this.discardActiveObject(p):x&&(this._handleGrouping(p,m),m=this._activeObject),this.selection&&(!m||!m.selectable&&!m.isEditing&&m!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),m){var y=m===this._activeObject;m.selectable&&m.activeOn==="down"&&this.setActiveObject(m,p);var _=m._findTargetCorner(this.getPointer(p,!0),t.util.isTouchEvent(p));if(m.__corner=_,m===this._activeObject&&(_||!x)){this._setupCurrentTransform(p,m,y);var w=m.controls[_],g=this.getPointer(p),T=w&&w.getMouseDownHandler(p,m,w);T&&T(p,this._currentTransform,g.x,g.y)}}this._handleEvent(p,"down"),(v||x)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(p){this._resetTransformEventData(),this._pointer=this.getPointer(p,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(p)||null},_beforeTransform:function(p){var m=this._currentTransform;this.stateful&&m.target.saveState(),this.fire("before:transform",{e:p,transform:m})},__onMouseMove:function(p){this._handleEvent(p,"move:before"),this._cacheTransformEventData(p);var m,g;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(p);return}if(this._isMainEvent(p)){var v=this._groupSelector;v?(g=this._absolutePointer,v.left=g.x-v.ex,v.top=g.y-v.ey,this.renderTop()):this._currentTransform?this._transformObject(p):(m=this.findTarget(p)||null,this._setCursorFromEvent(p,m),this._fireOverOutEvents(m,p)),this._handleEvent(p,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(p,m){var g=this._hoveredTarget,v=this._hoveredTargets,x=this.targets,y=Math.max(v.length,x.length);this.fireSyntheticInOutEvents(p,m,{oldTarget:g,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var _=0;_<y;_++)this.fireSyntheticInOutEvents(x[_],m,{oldTarget:v[_],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=p,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(p,m){var g=this._draggedoverTarget,v=this._hoveredTargets,x=this.targets,y=Math.max(v.length,x.length);this.fireSyntheticInOutEvents(p,m,{oldTarget:g,evtOut:"dragleave",evtIn:"dragenter"});for(var _=0;_<y;_++)this.fireSyntheticInOutEvents(x[_],m,{oldTarget:v[_],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=p},fireSyntheticInOutEvents:function(p,m,g){var v,x,y=g.oldTarget,_,w,T=y!==p,k=g.canvasEvtIn,O=g.canvasEvtOut;T&&(v={e:m,target:p,previousTarget:y},x={e:m,target:y,nextTarget:p}),w=p&&T,_=y&&T,_&&(O&&this.fire(O,x),y.fire(g.evtOut,x)),w&&(k&&this.fire(k,v),p.fire(g.evtIn,v))},__onMouseWheel:function(p){this._cacheTransformEventData(p),this._handleEvent(p,"wheel"),this._resetTransformEventData()},_transformObject:function(p){var m=this.getPointer(p),g=this._currentTransform;g.reset=!1,g.shiftKey=p.shiftKey,g.altKey=p[this.centeredKey],this._performTransformAction(p,g,m),g.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(p,m,g){var v=g.x,x=g.y,y=m.action,_=!1,w=m.actionHandler;w&&(_=w(p,m,v,x)),y==="drag"&&_&&(m.target.isMoving=!0,this.setCursor(m.target.moveCursor||this.moveCursor)),m.actionPerformed=m.actionPerformed||_},_fire:t.controlsUtils.fireEvent,_setCursorFromEvent:function(p,m){if(!m)return this.setCursor(this.defaultCursor),!1;var g=m.hoverCursor||this.hoverCursor,v=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,x=(!v||!v.contains(m))&&m._findTargetCorner(this.getPointer(p,!0));x?this.setCursor(this.getCornerCursor(x,m,p)):(m.subTargetCheck&&this.targets.concat().reverse().map(function(y){g=y.hoverCursor||g}),this.setCursor(g))},getCornerCursor:function(p,m,g){var v=m.controls[p];return v.cursorStyleHandler(g,v,m)}})}(),function(){var o=Math.min,s=Math.max;t.util.object.extend(t.Canvas.prototype,{_shouldGroup:function(c,d){var f=this._activeObject;return f&&this._isSelectionKeyPressed(c)&&d&&d.selectable&&this.selection&&(f!==d||f.type==="activeSelection")&&!d.onSelect({e:c})},_handleGrouping:function(c,d){var f=this._activeObject;f.__corner||d===f&&(d=this.findTarget(c,!0),!d||!d.selectable)||(f&&f.type==="activeSelection"?this._updateActiveSelection(d,c):this._createActiveSelection(d,c))},_updateActiveSelection:function(c,d){var f=this._activeObject,h=f._objects.slice(0);f.contains(c)?(f.removeWithUpdate(c),this._hoveredTarget=c,this._hoveredTargets=this.targets.concat(),f.size()===1&&this._setActiveObject(f.item(0),d)):(f.addWithUpdate(c),this._hoveredTarget=f,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(h,d)},_createActiveSelection:function(c,d){var f=this.getActiveObjects(),h=this._createGroup(c);this._hoveredTarget=h,this._setActiveObject(h,d),this._fireSelectionEvents(f,d)},_createGroup:function(c){var d=this._objects,f=d.indexOf(this._activeObject)<d.indexOf(c),h=f?[this._activeObject,c]:[c,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new t.ActiveSelection(h,{canvas:this})},_groupSelectedObjects:function(c){var d=this._collectObjects(c),f;d.length===1?this.setActiveObject(d[0],c):d.length>1&&(f=new t.ActiveSelection(d.reverse(),{canvas:this}),this.setActiveObject(f,c))},_collectObjects:function(c){for(var d=[],f,h=this._groupSelector.ex,u=this._groupSelector.ey,p=h+this._groupSelector.left,m=u+this._groupSelector.top,g=new t.Point(o(h,p),o(u,m)),v=new t.Point(s(h,p),s(u,m)),x=!this.selectionFullyContained,y=h===p&&u===m,_=this._objects.length;_--&&(f=this._objects[_],!(!(!f||!f.selectable||!f.visible)&&(x&&f.intersectsWithRect(g,v,!0)||f.isContainedWithinRect(g,v,!0)||x&&f.containsPoint(g,null,!0)||x&&f.containsPoint(v,null,!0))&&(d.push(f),y))););return d.length>1&&(d=d.filter(function(w){return!w.onSelect({e:c})})),d},_maybeGroupObjects:function(c){this.selection&&this._groupSelector&&this._groupSelectedObjects(c),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){t.util.object.extend(t.StaticCanvas.prototype,{toDataURL:function(o){o||(o={});var s=o.format||"png",c=o.quality||1,d=(o.multiplier||1)*(o.enableRetinaScaling?this.getRetinaScaling():1),f=this.toCanvasElement(d,o);return t.util.toDataURL(f,s,c)},toCanvasElement:function(o,s){o=o||1,s=s||{};var c=(s.width||this.width)*o,d=(s.height||this.height)*o,f=this.getZoom(),h=this.width,u=this.height,p=f*o,m=this.viewportTransform,g=(m[4]-(s.left||0))*o,v=(m[5]-(s.top||0))*o,x=this.interactive,y=[p,0,0,p,g,v],_=this.enableRetinaScaling,w=t.util.createCanvasElement(),T=this.contextTop;return w.width=c,w.height=d,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=y,this.width=c,this.height=d,this.calcViewportBoundaries(),this.renderCanvas(w.getContext("2d"),this._objects),this.viewportTransform=m,this.width=h,this.height=u,this.calcViewportBoundaries(),this.interactive=x,this.enableRetinaScaling=_,this.contextTop=T,w}})}(),t.util.object.extend(t.StaticCanvas.prototype,{loadFromJSON:function(o,s,c){if(o){var d=typeof o=="string"?JSON.parse(o):t.util.object.clone(o),f=this,h=d.clipPath,u=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete d.clipPath,this._enlivenObjects(d.objects,function(p){f.clear(),f._setBgOverlay(d,function(){h?f._enlivenObjects([h],function(m){f.clipPath=m[0],f.__setupCanvas.call(f,d,p,u,s)}):f.__setupCanvas.call(f,d,p,u,s)})},c),this}},__setupCanvas:function(o,s,c,d){var f=this;s.forEach(function(h,u){f.insertAt(h,u)}),this.renderOnAddRemove=c,delete o.objects,delete o.backgroundImage,delete o.overlayImage,delete o.background,delete o.overlay,this._setOptions(o),this.renderAll(),d&&d()},_setBgOverlay:function(o,s){var c={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!o.backgroundImage&&!o.overlayImage&&!o.background&&!o.overlay){s&&s();return}var d=function(){c.backgroundImage&&c.overlayImage&&c.backgroundColor&&c.overlayColor&&s&&s()};this.__setBgOverlay("backgroundImage",o.backgroundImage,c,d),this.__setBgOverlay("overlayImage",o.overlayImage,c,d),this.__setBgOverlay("backgroundColor",o.background,c,d),this.__setBgOverlay("overlayColor",o.overlay,c,d)},__setBgOverlay:function(o,s,c,d){var f=this;if(!s){c[o]=!0,d&&d();return}o==="backgroundImage"||o==="overlayImage"?t.util.enlivenObjects([s],function(h){f[o]=h[0],c[o]=!0,d&&d()}):this["set"+t.util.string.capitalize(o,!0)](s,function(){c[o]=!0,d&&d()})},_enlivenObjects:function(o,s,c){if(!o||o.length===0){s&&s([]);return}t.util.enlivenObjects(o,function(d){s&&s(d)},null,c)},_toDataURL:function(o,s){this.clone(function(c){s(c.toDataURL(o))})},_toDataURLWithMultiplier:function(o,s,c){this.clone(function(d){c(d.toDataURLWithMultiplier(o,s))})},clone:function(o,s){var c=JSON.stringify(this.toJSON(s));this.cloneWithoutData(function(d){d.loadFromJSON(c,function(){o&&o(d)})})},cloneWithoutData:function(o){var s=t.util.createCanvasElement();s.width=this.width,s.height=this.height;var c=new t.Canvas(s);this.backgroundImage?(c.setBackgroundImage(this.backgroundImage.src,function(){c.renderAll(),o&&o(c)}),c.backgroundImageOpacity=this.backgroundImageOpacity,c.backgroundImageStretch=this.backgroundImageStretch):o&&o(c)}}),function(o){var s=o.fabric||(o.fabric={}),c=s.util.object.extend,d=s.util.object.clone,f=s.util.toFixed,h=s.util.string.capitalize,u=s.util.degreesToRadians,p=!s.isLikelyNode,m=2;s.Object||(s.Object=s.util.createClass(s.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:p,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(g){g&&this.setOptions(g)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=s.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(g){var v=s.perfLimitSizeTotal,x=g.width,y=g.height,_=s.maxCacheSideLimit,w=s.minCacheSideLimit;if(x<=_&&y<=_&&x*y<=v)return x<w&&(g.width=w),y<w&&(g.height=w),g;var T=x/y,k=s.util.limitDimsByArea(T,v),O=s.util.capValue,F=O(w,k.x,_),M=O(w,k.y,_);return x>F&&(g.zoomX/=x/F,g.width=F,g.capped=!0),y>M&&(g.zoomY/=y/M,g.height=M,g.capped=!0),g},_getCacheCanvasDimensions:function(){var g=this.getTotalObjectScaling(),v=this._getTransformedDimensions(0,0),x=v.x*g.scaleX/this.scaleX,y=v.y*g.scaleY/this.scaleY;return{width:Math.ceil(x+m),height:Math.ceil(y+m),zoomX:g.scaleX,zoomY:g.scaleY,x,y}},_updateCacheCanvas:function(){var g=this.canvas;if(this.noScaleCache&&g&&g._currentTransform){var v=g._currentTransform.target,x=g._currentTransform.action;if(this===v&&x.slice&&x.slice(0,5)==="scale")return!1}var y=this._cacheCanvas,_=this._limitCacheSize(this._getCacheCanvasDimensions()),w=_.width,T=_.height,k,O,F=_.zoomX,M=_.zoomY,V=w!==this.cacheWidth||T!==this.cacheHeight,X=this.zoomX!==F||this.zoomY!==M,q=V||X;return q?(V?(y.width=w,y.height=T):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,y.width,y.height)),k=_.x/2,O=_.y/2,this.cacheTranslationX=Math.round(y.width/2-k)+k,this.cacheTranslationY=Math.round(y.height/2-O)+O,this.cacheWidth=w,this.cacheHeight=T,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(F,M),this.zoomX=F,this.zoomY=M,!0):!1},setOptions:function(g){this._setOptions(g),this._initGradient(g.fill,"fill"),this._initGradient(g.stroke,"stroke"),this._initPattern(g.fill,"fill"),this._initPattern(g.stroke,"stroke")},transform:function(g){var v=this.group&&!this.group._transformDone||this.group&&this.canvas&&g===this.canvas.contextTop,x=this.calcTransformMatrix(!v);g.transform(x[0],x[1],x[2],x[3],x[4],x[5])},toObject:function(g){var v=s.Object.NUM_FRACTION_DIGITS,x={type:this.type,version:s.version,originX:this.originX,originY:this.originY,left:f(this.left,v),top:f(this.top,v),width:f(this.width,v),height:f(this.height,v),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:f(this.strokeWidth,v),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:f(this.strokeMiterLimit,v),scaleX:f(this.scaleX,v),scaleY:f(this.scaleY,v),angle:f(this.angle,v),flipX:this.flipX,flipY:this.flipY,opacity:f(this.opacity,v),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:f(this.skewX,v),skewY:f(this.skewY,v)};return this.clipPath&&!this.clipPath.excludeFromExport&&(x.clipPath=this.clipPath.toObject(g),x.clipPath.inverted=this.clipPath.inverted,x.clipPath.absolutePositioned=this.clipPath.absolutePositioned),s.util.populateWithProperties(this,x,g),this.includeDefaultValues||(x=this._removeDefaultValues(x)),x},toDatalessObject:function(g){return this.toObject(g)},_removeDefaultValues:function(g){var v=s.util.getKlass(g.type).prototype,x=v.stateProperties;return x.forEach(function(y){y==="left"||y==="top"||(g[y]===v[y]&&delete g[y],Array.isArray(g[y])&&Array.isArray(v[y])&&g[y].length===0&&v[y].length===0&&delete g[y])}),g},toString:function(){return"#<fabric."+h(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var g=s.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(g.scaleX),scaleY:Math.abs(g.scaleY)}},getTotalObjectScaling:function(){var g=this.getObjectScaling(),v=g.scaleX,x=g.scaleY;if(this.canvas){var y=this.canvas.getZoom(),_=this.canvas.getRetinaScaling();v*=y*_,x*=y*_}return{scaleX:v,scaleY:x}},getObjectOpacity:function(){var g=this.opacity;return this.group&&(g*=this.group.getObjectOpacity()),g},_set:function(g,v){var x=g==="scaleX"||g==="scaleY",y=this[g]!==v,_=!1;return x&&(v=this._constrainScale(v)),g==="scaleX"&&v<0?(this.flipX=!this.flipX,v*=-1):g==="scaleY"&&v<0?(this.flipY=!this.flipY,v*=-1):g==="shadow"&&v&&!(v instanceof s.Shadow)?v=new s.Shadow(v):g==="dirty"&&this.group&&this.group.set("dirty",v),this[g]=v,y&&(_=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(g)>-1?(this.dirty=!0,_&&this.group.set("dirty",!0)):_&&this.stateProperties.indexOf(g)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:s.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(g){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(g.save(),this._setupCompositeOperation(g),this.drawSelectionBackground(g),this.transform(g),this._setOpacity(g),this._setShadow(g,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(g)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(g),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),g.restore())},renderCache:function(g){g=g||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,g.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(g,v){if(g.save(),v.inverted?g.globalCompositeOperation="destination-out":g.globalCompositeOperation="destination-in",v.absolutePositioned){var x=s.util.invertTransform(this.calcTransformMatrix());g.transform(x[0],x[1],x[2],x[3],x[4],x[5])}v.transform(g),g.scale(1/v.zoomX,1/v.zoomY),g.drawImage(v._cacheCanvas,-v.cacheTranslationX,-v.cacheTranslationY),g.restore()},drawObject:function(g,v){var x=this.fill,y=this.stroke;v?(this.fill="black",this.stroke="",this._setClippingProperties(g)):this._renderBackground(g),this._render(g),this._drawClipPath(g,this.clipPath),this.fill=x,this.stroke=y},_drawClipPath:function(g,v){v&&(v.canvas=this.canvas,v.shouldCache(),v._transformDone=!0,v.renderCache({forClipping:!0}),this.drawClipPathOnCache(g,v))},drawCacheOnCanvas:function(g){g.scale(1/this.zoomX,1/this.zoomY),g.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(g){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!g&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!g){var v=this.cacheWidth/this.zoomX,x=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-v/2,-x/2,v,x)}return!0}return!1},_renderBackground:function(g){if(this.backgroundColor){var v=this._getNonTransformedDimensions();g.fillStyle=this.backgroundColor,g.fillRect(-v.x/2,-v.y/2,v.x,v.y),this._removeShadow(g)}},_setOpacity:function(g){this.group&&!this.group._transformDone?g.globalAlpha=this.getObjectOpacity():g.globalAlpha*=this.opacity},_setStrokeStyles:function(g,v){var x=v.stroke;x&&(g.lineWidth=v.strokeWidth,g.lineCap=v.strokeLineCap,g.lineDashOffset=v.strokeDashOffset,g.lineJoin=v.strokeLineJoin,g.miterLimit=v.strokeMiterLimit,x.toLive?x.gradientUnits==="percentage"||x.gradientTransform||x.patternTransform?this._applyPatternForTransformedGradient(g,x):(g.strokeStyle=x.toLive(g,this),this._applyPatternGradientTransform(g,x)):g.strokeStyle=v.stroke)},_setFillStyles:function(g,v){var x=v.fill;x&&(x.toLive?(g.fillStyle=x.toLive(g,this),this._applyPatternGradientTransform(g,v.fill)):g.fillStyle=x)},_setClippingProperties:function(g){g.globalAlpha=1,g.strokeStyle="transparent",g.fillStyle="#000000"},_setLineDash:function(g,v){!v||v.length===0||(1&v.length&&v.push.apply(v,v),g.setLineDash(v))},_renderControls:function(g,v){var x=this.getViewportTransform(),y=this.calcTransformMatrix(),_,w,T;v=v||{},w=typeof v.hasBorders<"u"?v.hasBorders:this.hasBorders,T=typeof v.hasControls<"u"?v.hasControls:this.hasControls,y=s.util.multiplyTransformMatrices(x,y),_=s.util.qrDecompose(y),g.save(),g.translate(_.translateX,_.translateY),g.lineWidth=1*this.borderScaleFactor,this.group||(g.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(_.angle-=180),g.rotate(u(this.group?_.angle:this.angle)),v.forActiveSelection||this.group?w&&this.drawBordersInGroup(g,_,v):w&&this.drawBorders(g,v),T&&this.drawControls(g,v),g.restore()},_setShadow:function(g){if(this.shadow){var v=this.shadow,x=this.canvas,y,_=x&&x.viewportTransform[0]||1,w=x&&x.viewportTransform[3]||1;v.nonScaling?y={scaleX:1,scaleY:1}:y=this.getObjectScaling(),x&&x._isRetinaScaling()&&(_*=s.devicePixelRatio,w*=s.devicePixelRatio),g.shadowColor=v.color,g.shadowBlur=v.blur*s.browserShadowBlurConstant*(_+w)*(y.scaleX+y.scaleY)/4,g.shadowOffsetX=v.offsetX*_*y.scaleX,g.shadowOffsetY=v.offsetY*w*y.scaleY}},_removeShadow:function(g){this.shadow&&(g.shadowColor="",g.shadowBlur=g.shadowOffsetX=g.shadowOffsetY=0)},_applyPatternGradientTransform:function(g,v){if(!v||!v.toLive)return{offsetX:0,offsetY:0};var x=v.gradientTransform||v.patternTransform,y=-this.width/2+v.offsetX||0,_=-this.height/2+v.offsetY||0;return v.gradientUnits==="percentage"?g.transform(this.width,0,0,this.height,y,_):g.transform(1,0,0,1,y,_),x&&g.transform(x[0],x[1],x[2],x[3],x[4],x[5]),{offsetX:y,offsetY:_}},_renderPaintInOrder:function(g){this.paintFirst==="stroke"?(this._renderStroke(g),this._renderFill(g)):(this._renderFill(g),this._renderStroke(g))},_render:function(){},_renderFill:function(g){this.fill&&(g.save(),this._setFillStyles(g,this),this.fillRule==="evenodd"?g.fill("evenodd"):g.fill(),g.restore())},_renderStroke:function(g){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(g),g.save(),this.strokeUniform&&this.group){var v=this.getObjectScaling();g.scale(1/v.scaleX,1/v.scaleY)}else this.strokeUniform&&g.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(g,this.strokeDashArray),this._setStrokeStyles(g,this),g.stroke(),g.restore()}},_applyPatternForTransformedGradient:function(g,v){var x=this._limitCacheSize(this._getCacheCanvasDimensions()),y=s.util.createCanvasElement(),_,w=this.canvas.getRetinaScaling(),T=x.x/this.scaleX/w,k=x.y/this.scaleY/w;y.width=Math.ceil(T),y.height=Math.ceil(k),_=y.getContext("2d"),_.beginPath(),_.moveTo(0,0),_.lineTo(T,0),_.lineTo(T,k),_.lineTo(0,k),_.closePath(),_.translate(T/2,k/2),_.scale(x.zoomX/this.scaleX/w,x.zoomY/this.scaleY/w),this._applyPatternGradientTransform(_,v),_.fillStyle=v.toLive(g),_.fill(),g.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),g.scale(w*this.scaleX/x.zoomX,w*this.scaleY/x.zoomY),g.strokeStyle=_.createPattern(y,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var g=s.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",g.scaleX),this.set("scaleY",g.scaleY),this.angle=g.angle,this.skewX=g.skewX,this.skewY=0}},_removeTransformMatrix:function(g){var v=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),v=s.util.transformPoint(v,this.transformMatrix)),this.transformMatrix=null,g&&(this.scaleX*=g.scaleX,this.scaleY*=g.scaleY,this.cropX=g.cropX,this.cropY=g.cropY,v.x+=g.offsetLeft,v.y+=g.offsetTop,this.width=g.width,this.height=g.height),this.setPositionByOrigin(v,"center","center")},clone:function(g,v){var x=this.toObject(v);this.constructor.fromObject?this.constructor.fromObject(x,g):s.Object._fromObject("Object",x,g)},cloneAsImage:function(g,v){var x=this.toCanvasElement(v);return g&&g(new s.Image(x)),this},toCanvasElement:function(g){g||(g={});var v=s.util,x=v.saveObjectTransform(this),y=this.group,_=this.shadow,w=Math.abs,T=(g.multiplier||1)*(g.enableRetinaScaling?s.devicePixelRatio:1);delete this.group,g.withoutTransform&&v.resetObjectTransform(this),g.withoutShadow&&(this.shadow=null);var k=s.util.createCanvasElement(),O=this.getBoundingRect(!0,!0),F=this.shadow,M,V={x:0,y:0},X,q,ae;F&&(X=F.blur,F.nonScaling?M={scaleX:1,scaleY:1}:M=this.getObjectScaling(),V.x=2*Math.round(w(F.offsetX)+X)*w(M.scaleX),V.y=2*Math.round(w(F.offsetY)+X)*w(M.scaleY)),q=O.width+V.x,ae=O.height+V.y,k.width=Math.ceil(q),k.height=Math.ceil(ae);var ne=new s.StaticCanvas(k,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});g.format==="jpeg"&&(ne.backgroundColor="#fff"),this.setPositionByOrigin(new s.Point(ne.width/2,ne.height/2),"center","center");var re=this.canvas;ne.add(this);var le=ne.toCanvasElement(T||1,g);return this.shadow=_,this.set("canvas",re),y&&(this.group=y),this.set(x).setCoords(),ne._objects=[],ne.dispose(),ne=null,le},toDataURL:function(g){return g||(g={}),s.util.toDataURL(this.toCanvasElement(g),g.format||"png",g.quality||1)},isType:function(g){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===g},complexity:function(){return 1},toJSON:function(g){return this.toObject(g)},rotate:function(g){var v=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return v&&this._setOriginToCenter(),this.set("angle",g),v&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(g,v){v=v||this.canvas.getPointer(g);var x=new s.Point(v.x,v.y),y=this._getLeftTopCoords();return this.angle&&(x=s.util.rotatePoint(x,y,u(-this.angle))),{x:x.x-y.x,y:x.y-y.y}},_setupCompositeOperation:function(g){this.globalCompositeOperation&&(g.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){s.runningAnimations&&s.runningAnimations.cancelByTarget(this)}}),s.util.createAccessors&&s.util.createAccessors(s.Object),c(s.Object.prototype,s.Observable),s.Object.NUM_FRACTION_DIGITS=2,s.Object.ENLIVEN_PROPS=["clipPath"],s.Object._fromObject=function(g,v,x,y){var _=s[g];v=d(v,!0),s.util.enlivenPatterns([v.fill,v.stroke],function(w){typeof w[0]<"u"&&(v.fill=w[0]),typeof w[1]<"u"&&(v.stroke=w[1]),s.util.enlivenObjectEnlivables(v,v,function(){var T=y?new _(v[y],v):new _(v);x&&x(T)})})},s.Object.__uid=0)}(e),function(){var o=t.util.degreesToRadians,s={left:-.5,center:0,right:.5},c={top:-.5,center:0,bottom:.5};t.util.object.extend(t.Object.prototype,{translateToGivenOrigin:function(d,f,h,u,p){var m=d.x,g=d.y,v,x,y;return typeof f=="string"?f=s[f]:f-=.5,typeof u=="string"?u=s[u]:u-=.5,v=u-f,typeof h=="string"?h=c[h]:h-=.5,typeof p=="string"?p=c[p]:p-=.5,x=p-h,(v||x)&&(y=this._getTransformedDimensions(),m=d.x+v*y.x,g=d.y+x*y.y),new t.Point(m,g)},translateToCenterPoint:function(d,f,h){var u=this.translateToGivenOrigin(d,f,h,"center","center");return this.angle?t.util.rotatePoint(u,d,o(this.angle)):u},translateToOriginPoint:function(d,f,h){var u=this.translateToGivenOrigin(d,"center","center",f,h);return this.angle?t.util.rotatePoint(u,d,o(this.angle)):u},getCenterPoint:function(){var d=new t.Point(this.left,this.top);return this.translateToCenterPoint(d,this.originX,this.originY)},getPointByOrigin:function(d,f){var h=this.getCenterPoint();return this.translateToOriginPoint(h,d,f)},toLocalPoint:function(d,f,h){var u=this.getCenterPoint(),p,m;return typeof f<"u"&&typeof h<"u"?p=this.translateToGivenOrigin(u,"center","center",f,h):p=new t.Point(this.left,this.top),m=new t.Point(d.x,d.y),this.angle&&(m=t.util.rotatePoint(m,u,-o(this.angle))),m.subtractEquals(p)},setPositionByOrigin:function(d,f,h){var u=this.translateToCenterPoint(d,f,h),p=this.translateToOriginPoint(u,this.originX,this.originY);this.set("left",p.x),this.set("top",p.y)},adjustPosition:function(d){var f=o(this.angle),h=this.getScaledWidth(),u=t.util.cos(f)*h,p=t.util.sin(f)*h,m,g;typeof this.originX=="string"?m=s[this.originX]:m=this.originX-.5,typeof d=="string"?g=s[d]:g=d-.5,this.left+=u*(g-m),this.top+=p*(g-m),this.setCoords(),this.originX=d},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var d=this.getCenterPoint();this.originX="center",this.originY="center",this.left=d.x,this.top=d.y},_resetOrigin:function(){var d=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=d.x,this.top=d.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function o(h){return[new t.Point(h.tl.x,h.tl.y),new t.Point(h.tr.x,h.tr.y),new t.Point(h.br.x,h.br.y),new t.Point(h.bl.x,h.bl.y)]}var s=t.util,c=s.degreesToRadians,d=s.multiplyTransformMatrices,f=s.transformPoint;s.object.extend(t.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(h,u){return u?h?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),h?this.aCoords:this.lineCoords)},getCoords:function(h,u){return o(this._getCoords(h,u))},intersectsWithRect:function(h,u,p,m){var g=this.getCoords(p,m),v=t.Intersection.intersectPolygonRectangle(g,h,u);return v.status==="Intersection"},intersectsWithObject:function(h,u,p){var m=t.Intersection.intersectPolygonPolygon(this.getCoords(u,p),h.getCoords(u,p));return m.status==="Intersection"||h.isContainedWithinObject(this,u,p)||this.isContainedWithinObject(h,u,p)},isContainedWithinObject:function(h,u,p){for(var m=this.getCoords(u,p),g=u?h.aCoords:h.lineCoords,v=0,x=h._getImageLines(g);v<4;v++)if(!h.containsPoint(m[v],x))return!1;return!0},isContainedWithinRect:function(h,u,p,m){var g=this.getBoundingRect(p,m);return g.left>=h.x&&g.left+g.width<=u.x&&g.top>=h.y&&g.top+g.height<=u.y},containsPoint:function(h,v,p,m){var g=this._getCoords(p,m),v=v||this._getImageLines(g),x=this._findCrossPoints(h,v);return x!==0&&x%2===1},isOnScreen:function(h){if(!this.canvas)return!1;var u=this.canvas.vptCoords.tl,p=this.canvas.vptCoords.br,m=this.getCoords(!0,h);return m.some(function(g){return g.x<=p.x&&g.x>=u.x&&g.y<=p.y&&g.y>=u.y})||this.intersectsWithRect(u,p,!0,h)?!0:this._containsCenterOfCanvas(u,p,h)},_containsCenterOfCanvas:function(h,u,p){var m={x:(h.x+u.x)/2,y:(h.y+u.y)/2};return!!this.containsPoint(m,null,!0,p)},isPartiallyOnScreen:function(h){if(!this.canvas)return!1;var u=this.canvas.vptCoords.tl,p=this.canvas.vptCoords.br;if(this.intersectsWithRect(u,p,!0,h))return!0;var m=this.getCoords(!0,h).every(function(g){return(g.x>=p.x||g.x<=u.x)&&(g.y>=p.y||g.y<=u.y)});return m&&this._containsCenterOfCanvas(u,p,h)},_getImageLines:function(h){var u={topline:{o:h.tl,d:h.tr},rightline:{o:h.tr,d:h.br},bottomline:{o:h.br,d:h.bl},leftline:{o:h.bl,d:h.tl}};return u},_findCrossPoints:function(h,u){var p,m,g,v,x,y=0,_;for(var w in u)if(_=u[w],!(_.o.y<h.y&&_.d.y<h.y)&&!(_.o.y>=h.y&&_.d.y>=h.y)&&(_.o.x===_.d.x&&_.o.x>=h.x?x=_.o.x:(p=0,m=(_.d.y-_.o.y)/(_.d.x-_.o.x),g=h.y-p*h.x,v=_.o.y-m*_.o.x,x=-(g-v)/(p-m)),x>=h.x&&(y+=1),y===2))break;return y},getBoundingRect:function(h,u){var p=this.getCoords(h,u);return s.makeBoundingBoxFromPoints(p)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(h){return Math.abs(h)<this.minScaleLimit?h<0?-this.minScaleLimit:this.minScaleLimit:h===0?1e-4:h},scale:function(h){return this._set("scaleX",h),this._set("scaleY",h),this.setCoords()},scaleToWidth:function(h,u){var p=this.getBoundingRect(u).width/this.getScaledWidth();return this.scale(h/this.width/p)},scaleToHeight:function(h,u){var p=this.getBoundingRect(u).height/this.getScaledHeight();return this.scale(h/this.height/p)},calcLineCoords:function(){var h=this.getViewportTransform(),u=this.padding,p=c(this.angle),m=s.cos(p),g=s.sin(p),v=m*u,x=g*u,y=v+x,_=v-x,w=this.calcACoords(),T={tl:f(w.tl,h),tr:f(w.tr,h),bl:f(w.bl,h),br:f(w.br,h)};return u&&(T.tl.x-=_,T.tl.y-=y,T.tr.x+=y,T.tr.y-=_,T.bl.x-=y,T.bl.y+=_,T.br.x+=_,T.br.y+=y),T},calcOCoords:function(){var h=this._calcRotateMatrix(),u=this._calcTranslateMatrix(),p=this.getViewportTransform(),m=d(p,u),g=d(m,h),g=d(g,[1/p[0],0,0,1/p[3],0,0]),v=this._calculateCurrentDimensions(),x={};return this.forEachControl(function(y,_,w){x[_]=y.positionHandler(v,g,w)}),x},calcACoords:function(){var h=this._calcRotateMatrix(),u=this._calcTranslateMatrix(),p=d(u,h),m=this._getTransformedDimensions(),g=m.x/2,v=m.y/2;return{tl:f({x:-g,y:-v},p),tr:f({x:g,y:-v},p),bl:f({x:-g,y:v},p),br:f({x:g,y:v},p)}},setCoords:function(h){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),h?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return s.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var h=this.getCenterPoint();return[1,0,0,1,h.x,h.y]},transformMatrixKey:function(h){var u="_",p="";return!h&&this.group&&(p=this.group.transformMatrixKey(h)+u),p+this.top+u+this.left+u+this.scaleX+u+this.scaleY+u+this.skewX+u+this.skewY+u+this.angle+u+this.originX+u+this.originY+u+this.width+u+this.height+u+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(h){var u=this.calcOwnMatrix();if(h||!this.group)return u;var p=this.transformMatrixKey(h),m=this.matrixCache||(this.matrixCache={});return m.key===p?m.value:(this.group&&(u=d(this.group.calcTransformMatrix(!1),u)),m.key=p,m.value=u,u)},calcOwnMatrix:function(){var h=this.transformMatrixKey(!0),u=this.ownMatrixCache||(this.ownMatrixCache={});if(u.key===h)return u.value;var p=this._calcTranslateMatrix(),m={angle:this.angle,translateX:p[4],translateY:p[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return u.key=h,u.value=s.composeMatrix(m),u.value},_getNonTransformedDimensions:function(){var h=this.strokeWidth,u=this.width+h,p=this.height+h;return{x:u,y:p}},_getTransformedDimensions:function(h,u){typeof h>"u"&&(h=this.skewX),typeof u>"u"&&(u=this.skewY);var p,m,g,v=h===0&&u===0;if(this.strokeUniform?(m=this.width,g=this.height):(p=this._getNonTransformedDimensions(),m=p.x,g=p.y),v)return this._finalizeDimensions(m*this.scaleX,g*this.scaleY);var x=s.sizeAfterTransform(m,g,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:h,skewY:u});return this._finalizeDimensions(x.x,x.y)},_finalizeDimensions:function(h,u){return this.strokeUniform?{x:h+this.strokeWidth,y:u+this.strokeWidth}:{x:h,y:u}},_calculateCurrentDimensions:function(){var h=this.getViewportTransform(),u=this._getTransformedDimensions(),p=f(u,h,!0);return p.scalarAdd(2*this.padding)}})}(),t.util.object.extend(t.Object.prototype,{sendToBack:function(){return this.group?t.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?t.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(o){return this.group?t.StaticCanvas.prototype.sendBackwards.call(this.group,this,o):this.canvas&&this.canvas.sendBackwards(this,o),this},bringForward:function(o){return this.group?t.StaticCanvas.prototype.bringForward.call(this.group,this,o):this.canvas&&this.canvas.bringForward(this,o),this},moveTo:function(o){return this.group&&this.group.type!=="activeSelection"?t.StaticCanvas.prototype.moveTo.call(this.group,this,o):this.canvas&&this.canvas.moveTo(this,o),this}}),function(){function o(c,d){if(d){if(d.toLive)return c+": url(#SVGID_"+d.id+"); ";var f=new t.Color(d),h=c+": "+f.toRgb()+"; ",u=f.getAlpha();return u!==1&&(h+=c+"-opacity: "+u.toString()+"; "),h}else return c+": none; "}var s=t.util.toFixed;t.util.object.extend(t.Object.prototype,{getSvgStyles:function(c){var d=this.fillRule?this.fillRule:"nonzero",f=this.strokeWidth?this.strokeWidth:"0",h=this.strokeDashArray?this.strokeDashArray.join(" "):"none",u=this.strokeDashOffset?this.strokeDashOffset:"0",p=this.strokeLineCap?this.strokeLineCap:"butt",m=this.strokeLineJoin?this.strokeLineJoin:"miter",g=this.strokeMiterLimit?this.strokeMiterLimit:"4",v=typeof this.opacity<"u"?this.opacity:"1",x=this.visible?"":" visibility: hidden;",y=c?"":this.getSvgFilter(),_=o("fill",this.fill),w=o("stroke",this.stroke);return[w,"stroke-width: ",f,"; ","stroke-dasharray: ",h,"; ","stroke-linecap: ",p,"; ","stroke-dashoffset: ",u,"; ","stroke-linejoin: ",m,"; ","stroke-miterlimit: ",g,"; ",_,"fill-rule: ",d,"; ","opacity: ",v,";",y,x].join("")},getSvgSpanStyles:function(c,d){var f="; ",u=c.fontFamily?"font-family: "+(c.fontFamily.indexOf("'")===-1&&c.fontFamily.indexOf('"')===-1?"'"+c.fontFamily+"'":c.fontFamily)+f:"",h=c.strokeWidth?"stroke-width: "+c.strokeWidth+f:"",u=u,p=c.fontSize?"font-size: "+c.fontSize+"px"+f:"",m=c.fontStyle?"font-style: "+c.fontStyle+f:"",g=c.fontWeight?"font-weight: "+c.fontWeight+f:"",v=c.fill?o("fill",c.fill):"",x=c.stroke?o("stroke",c.stroke):"",y=this.getSvgTextDecoration(c),_=c.deltaY?"baseline-shift: "+-c.deltaY+"; ":"";return y&&(y="text-decoration: "+y+f),[x,h,u,p,m,g,y,v,_,d?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(c){return["overline","underline","line-through"].filter(function(d){return c[d.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(c,d){var f=c?this.calcTransformMatrix():this.calcOwnMatrix(),h='transform="'+t.util.matrixToSVG(f);return h+(d||"")+'" '},_setSVGBg:function(c){if(this.backgroundColor){var d=t.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',s(-this.width/2,d),'" y="',s(-this.height/2,d),'" width="',s(this.width,d),'" height="',s(this.height,d),`"></rect>
`)}},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(c),{reviver:c})},toClipPathSVG:function(c){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(c),{reviver:c})},_createBaseClipPathSVGMarkup:function(c,d){d=d||{};var f=d.reviver,h=d.additionalTransform||"",u=[this.getSvgTransform(!0,h),this.getSvgCommons()].join(""),p=c.indexOf("COMMON_PARTS");return c[p]=u,f?f(c.join("")):c.join("")},_createBaseSVGMarkup:function(c,d){d=d||{};var f=d.noStyle,h=d.reviver,u=f?"":'style="'+this.getSvgStyles()+'" ',p=d.withShadow?'style="'+this.getSvgFilter()+'" ':"",m=this.clipPath,g=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",v=m&&m.absolutePositioned,x=this.stroke,y=this.fill,_=this.shadow,w,T=[],k,O=c.indexOf("COMMON_PARTS"),F=d.additionalTransform;return m&&(m.clipPathId="CLIPPATH_"+t.Object.__uid++,k='<clipPath id="'+m.clipPathId+`" >
`+m.toClipPathSVG(h)+`</clipPath>
`),v&&T.push("<g ",p,this.getSvgCommons(),` >
`),T.push("<g ",this.getSvgTransform(!1),v?"":p+this.getSvgCommons(),` >
`),w=[u,g,f?"":this.addPaintOrder()," ",F?'transform="'+F+'" ':""].join(""),c[O]=w,y&&y.toLive&&T.push(y.toSVG(this)),x&&x.toLive&&T.push(x.toSVG(this)),_&&T.push(_.toSVG(this)),m&&T.push(k),T.push(c.join("")),T.push(`</g>
`),v&&T.push(`</g>
`),h?h(T.join("")):T.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var o=t.util.object.extend,s="stateProperties";function c(f,h,u){var p={},m=!0;u.forEach(function(g){p[g]=f[g]}),o(f[h],p,m)}function d(f,h,u){if(f===h)return!0;if(Array.isArray(f)){if(!Array.isArray(h)||f.length!==h.length)return!1;for(var p=0,m=f.length;p<m;p++)if(!d(f[p],h[p]))return!1;return!0}else if(f&&typeof f=="object"){var g=Object.keys(f),v;if(!h||typeof h!="object"||!u&&g.length!==Object.keys(h).length)return!1;for(var p=0,m=g.length;p<m;p++)if(v=g[p],!(v==="canvas"||v==="group")&&!d(f[v],h[v]))return!1;return!0}}t.util.object.extend(t.Object.prototype,{hasStateChanged:function(f){f=f||s;var h="_"+f;return Object.keys(this[h]).length<this[f].length?!0:!d(this[h],this,!0)},saveState:function(f){var h=f&&f.propertySet||s,u="_"+h;return this[u]?(c(this,u,this[h]),f&&f.stateProperties&&c(this,u,f.stateProperties),this):this.setupState(f)},setupState:function(f){f=f||{};var h=f.propertySet||s;return f.propertySet=h,this["_"+h]={},this.saveState(f),this}})}(),function(){var o=t.util.degreesToRadians;t.util.object.extend(t.Object.prototype,{_findTargetCorner:function(s,c){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var d=s.x,f=s.y,h,u,p=Object.keys(this.oCoords),m=p.length-1,g;for(this.__corner=0;m>=0;m--)if(g=p[m],!!this.isControlVisible(g)&&(u=this._getImageLines(c?this.oCoords[g].touchCorner:this.oCoords[g].corner),h=this._findCrossPoints({x:d,y:f},u),h!==0&&h%2===1))return this.__corner=g,g;return!1},forEachControl:function(s){for(var c in this.controls)s(this.controls[c],c,this)},_setCornerCoords:function(){var s=this.oCoords;for(var c in s){var d=this.controls[c];s[c].corner=d.calcCornerCoords(this.angle,this.cornerSize,s[c].x,s[c].y,!1),s[c].touchCorner=d.calcCornerCoords(this.angle,this.touchCornerSize,s[c].x,s[c].y,!0)}},drawSelectionBackground:function(s){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;s.save();var c=this.getCenterPoint(),d=this._calculateCurrentDimensions(),f=this.canvas.viewportTransform;return s.translate(c.x,c.y),s.scale(1/f[0],1/f[3]),s.rotate(o(this.angle)),s.fillStyle=this.selectionBackgroundColor,s.fillRect(-d.x/2,-d.y/2,d.x,d.y),s.restore(),this},drawBorders:function(s,c){c=c||{};var d=this._calculateCurrentDimensions(),f=this.borderScaleFactor,h=d.x+f,u=d.y+f,p=typeof c.hasControls<"u"?c.hasControls:this.hasControls,m=!1;return s.save(),s.strokeStyle=c.borderColor||this.borderColor,this._setLineDash(s,c.borderDashArray||this.borderDashArray),s.strokeRect(-h/2,-u/2,h,u),p&&(s.beginPath(),this.forEachControl(function(g,v,x){g.withConnection&&g.getVisibility(x,v)&&(m=!0,s.moveTo(g.x*h,g.y*u),s.lineTo(g.x*h+g.offsetX,g.y*u+g.offsetY))}),m&&s.stroke()),s.restore(),this},drawBordersInGroup:function(s,c,d){d=d||{};var f=t.util.sizeAfterTransform(this.width,this.height,c),h=this.strokeWidth,u=this.strokeUniform,p=this.borderScaleFactor,m=f.x+h*(u?this.canvas.getZoom():c.scaleX)+p,g=f.y+h*(u?this.canvas.getZoom():c.scaleY)+p;return s.save(),this._setLineDash(s,d.borderDashArray||this.borderDashArray),s.strokeStyle=d.borderColor||this.borderColor,s.strokeRect(-m/2,-g/2,m,g),s.restore(),this},drawControls:function(s,c){c=c||{},s.save();var d=1,f,h;return this.canvas&&(d=this.canvas.getRetinaScaling()),s.setTransform(d,0,0,d,0,0),s.strokeStyle=s.fillStyle=c.cornerColor||this.cornerColor,this.transparentCorners||(s.strokeStyle=c.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(s,c.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(f=this.group.calcTransformMatrix()),this.forEachControl(function(u,p,m){h=m.oCoords[p],u.getVisibility(m,p)&&(f&&(h=t.util.transformPoint(h,f)),u.render(s,h.x,h.y,c,m))}),s.restore(),this},isControlVisible:function(s){return this.controls[s]&&this.controls[s].getVisibility(this,s)},setControlVisible:function(s,c){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[s]=c,this},setControlsVisibility:function(s){s||(s={});for(var c in s)this.setControlVisible(c,s[c]);return this},onDeselect:function(){},onSelect:function(){}})}(),t.util.object.extend(t.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(o,s){s=s||{};var c=function(){},d=s.onComplete||c,f=s.onChange||c,h=this;return t.util.animate({target:this,startValue:o.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(u){o.set("left",u),h.requestRenderAll(),f()},onComplete:function(){o.setCoords(),d()}})},fxCenterObjectV:function(o,s){s=s||{};var c=function(){},d=s.onComplete||c,f=s.onChange||c,h=this;return t.util.animate({target:this,startValue:o.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(u){o.set("top",u),h.requestRenderAll(),f()},onComplete:function(){o.setCoords(),d()}})},fxRemove:function(o,s){s=s||{};var c=function(){},d=s.onComplete||c,f=s.onChange||c,h=this;return t.util.animate({target:this,startValue:o.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(u){o.set("opacity",u),h.requestRenderAll(),f()},onComplete:function(){h.remove(o),d()}})}}),t.util.object.extend(t.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var o=[],s,c,d=[];for(s in arguments[0])o.push(s);for(var f=0,h=o.length;f<h;f++)s=o[f],c=f!==h-1,d.push(this._animate(s,arguments[0][s],arguments[1],c));return d}else return this._animate.apply(this,arguments)},_animate:function(o,s,c,d){var f=this,h;s=s.toString(),c?c=t.util.object.clone(c):c={},~o.indexOf(".")&&(h=o.split("."));var u=f.colorProperties.indexOf(o)>-1||h&&f.colorProperties.indexOf(h[1])>-1,p=h?this.get(h[0])[h[1]]:this.get(o);"from"in c||(c.from=p),u||(~s.indexOf("=")?s=p+parseFloat(s.replace("=","")):s=parseFloat(s));var m={target:this,startValue:c.from,endValue:s,byValue:c.by,easing:c.easing,duration:c.duration,abort:c.abort&&function(g,v,x){return c.abort.call(f,g,v,x)},onChange:function(g,v,x){h?f[h[0]][h[1]]=g:f.set(o,g),!d&&c.onChange&&c.onChange(g,v,x)},onComplete:function(g,v,x){d||(f.setCoords(),c.onComplete&&c.onComplete(g,v,x))}};return u?t.util.animateColor(m.startValue,m.endValue,m.duration,m):t.util.animate(m)}}),function(o){var s=o.fabric||(o.fabric={}),c=s.util.object.extend,d=s.util.object.clone,f={x1:1,x2:1,y1:1,y2:1};if(s.Line){s.warn("fabric.Line is already defined");return}s.Line=s.util.createClass(s.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:s.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(u,p){u||(u=[0,0,0,0]),this.callSuper("initialize",p),this.set("x1",u[0]),this.set("y1",u[1]),this.set("x2",u[2]),this.set("y2",u[3]),this._setWidthHeight(p)},_setWidthHeight:function(u){u||(u={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in u?u.left:this._getLeftToOriginX(),this.top="top"in u?u.top:this._getTopToOriginY()},_set:function(u,p){return this.callSuper("_set",u,p),typeof f[u]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:h({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:h({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(u){u.beginPath();var p=this.calcLinePoints();u.moveTo(p.x1,p.y1),u.lineTo(p.x2,p.y2),u.lineWidth=this.strokeWidth;var m=u.strokeStyle;u.strokeStyle=this.stroke||u.fillStyle,this.stroke&&this._renderStroke(u),u.strokeStyle=m},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(u){return c(this.callSuper("toObject",u),this.calcLinePoints())},_getNonTransformedDimensions:function(){var u=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(u.y-=this.strokeWidth),this.height===0&&(u.x-=this.strokeWidth)),u},calcLinePoints:function(){var u=this.x1<=this.x2?-1:1,p=this.y1<=this.y2?-1:1,m=u*this.width*.5,g=p*this.height*.5,v=u*this.width*-.5,x=p*this.height*-.5;return{x1:m,x2:v,y1:g,y2:x}},_toSVG:function(){var u=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',u.x1,'" y1="',u.y1,'" x2="',u.x2,'" y2="',u.y2,`" />
`]}}),s.Line.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),s.Line.fromElement=function(u,p,m){m=m||{};var g=s.parseAttributes(u,s.Line.ATTRIBUTE_NAMES),v=[g.x1||0,g.y1||0,g.x2||0,g.y2||0];p(new s.Line(v,c(g,m)))},s.Line.fromObject=function(u,p){function m(v){delete v.points,p&&p(v)}var g=d(u,!0);g.points=[u.x1,u.y1,u.x2,u.y2],s.Object._fromObject("Line",g,m,"points")};function h(u,p){var m=u.origin,g=u.axis1,v=u.axis2,x=u.dimension,y=p.nearest,_=p.center,w=p.farthest;return function(){switch(this.get(m)){case y:return Math.min(this.get(g),this.get(v));case _:return Math.min(this.get(g),this.get(v))+.5*this.get(x);case w:return Math.max(this.get(g),this.get(v))}}}}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.util.degreesToRadians;if(s.Circle){s.warn("fabric.Circle is already defined.");return}s.Circle=s.util.createClass(s.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:s.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(f,h){return this.callSuper("_set",f,h),f==="radius"&&this.setRadius(h),this},toObject:function(f){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(f))},_toSVG:function(){var f,h=0,u=0,p=(this.endAngle-this.startAngle)%360;if(p===0)f=["<circle ","COMMON_PARTS",'cx="'+h+'" cy="'+u+'" ','r="',this.radius,`" />
`];else{var m=c(this.startAngle),g=c(this.endAngle),v=this.radius,x=s.util.cos(m)*v,y=s.util.sin(m)*v,_=s.util.cos(g)*v,w=s.util.sin(g)*v,T=p>180?"1":"0";f=['<path d="M '+x+" "+y," A "+v+" "+v," 0 ",+T+" 1"," "+_+" "+w,'" ',"COMMON_PARTS",` />
`]}return f},_render:function(f){f.beginPath(),f.arc(0,0,this.radius,c(this.startAngle),c(this.endAngle),!1),this._renderPaintInOrder(f)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(f){return this.radius=f,this.set("width",f*2).set("height",f*2)}}),s.Circle.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),s.Circle.fromElement=function(f,h){var u=s.parseAttributes(f,s.Circle.ATTRIBUTE_NAMES);if(!d(u))throw new Error("value of `r` attribute is required and can not be negative");u.left=(u.left||0)-u.radius,u.top=(u.top||0)-u.radius,h(new s.Circle(u))};function d(f){return"radius"in f&&f.radius>=0}s.Circle.fromObject=function(f,h){s.Object._fromObject("Circle",f,h)}}(e),function(o){var s=o.fabric||(o.fabric={});if(s.Triangle){s.warn("fabric.Triangle is already defined");return}s.Triangle=s.util.createClass(s.Object,{type:"triangle",width:100,height:100,_render:function(c){var d=this.width/2,f=this.height/2;c.beginPath(),c.moveTo(-d,f),c.lineTo(0,-f),c.lineTo(d,f),c.closePath(),this._renderPaintInOrder(c)},_toSVG:function(){var c=this.width/2,d=this.height/2,f=[-c+" "+d,"0 "+-d,c+" "+d].join(",");return["<polygon ","COMMON_PARTS",'points="',f,'" />']}}),s.Triangle.fromObject=function(c,d){return s.Object._fromObject("Triangle",c,d)}}(e),function(o){var s=o.fabric||(o.fabric={}),c=Math.PI*2;if(s.Ellipse){s.warn("fabric.Ellipse is already defined.");return}s.Ellipse=s.util.createClass(s.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:s.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(d){this.callSuper("initialize",d),this.set("rx",d&&d.rx||0),this.set("ry",d&&d.ry||0)},_set:function(d,f){switch(this.callSuper("_set",d,f),d){case"rx":this.rx=f,this.set("width",f*2);break;case"ry":this.ry=f,this.set("height",f*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(d){return this.callSuper("toObject",["rx","ry"].concat(d))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(d){d.beginPath(),d.save(),d.transform(1,0,0,this.ry/this.rx,0,0),d.arc(0,0,this.rx,0,c,!1),d.restore(),this._renderPaintInOrder(d)}}),s.Ellipse.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),s.Ellipse.fromElement=function(d,f){var h=s.parseAttributes(d,s.Ellipse.ATTRIBUTE_NAMES);h.left=(h.left||0)-h.rx,h.top=(h.top||0)-h.ry,f(new s.Ellipse(h))},s.Ellipse.fromObject=function(d,f){s.Object._fromObject("Ellipse",d,f)}}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.util.object.extend;if(s.Rect){s.warn("fabric.Rect is already defined");return}s.Rect=s.util.createClass(s.Object,{stateProperties:s.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:s.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(d){this.callSuper("initialize",d),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(d){var f=this.rx?Math.min(this.rx,this.width/2):0,h=this.ry?Math.min(this.ry,this.height/2):0,u=this.width,p=this.height,m=-this.width/2,g=-this.height/2,v=f!==0||h!==0,x=1-.5522847498;d.beginPath(),d.moveTo(m+f,g),d.lineTo(m+u-f,g),v&&d.bezierCurveTo(m+u-x*f,g,m+u,g+x*h,m+u,g+h),d.lineTo(m+u,g+p-h),v&&d.bezierCurveTo(m+u,g+p-x*h,m+u-x*f,g+p,m+u-f,g+p),d.lineTo(m+f,g+p),v&&d.bezierCurveTo(m+x*f,g+p,m,g+p-x*h,m,g+p-h),d.lineTo(m,g+h),v&&d.bezierCurveTo(m,g+x*h,m+x*f,g,m+f,g),d.closePath(),this._renderPaintInOrder(d)},toObject:function(d){return this.callSuper("toObject",["rx","ry"].concat(d))},_toSVG:function(){var d=-this.width/2,f=-this.height/2;return["<rect ","COMMON_PARTS",'x="',d,'" y="',f,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),s.Rect.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),s.Rect.fromElement=function(d,f,h){if(!d)return f(null);h=h||{};var u=s.parseAttributes(d,s.Rect.ATTRIBUTE_NAMES);u.left=u.left||0,u.top=u.top||0,u.height=u.height||0,u.width=u.width||0;var p=new s.Rect(c(h?s.util.object.clone(h):{},u));p.visible=p.visible&&p.width>0&&p.height>0,f(p)},s.Rect.fromObject=function(d,f){return s.Object._fromObject("Rect",d,f)}}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.util.object.extend,d=s.util.array.min,f=s.util.array.max,h=s.util.toFixed,u=s.util.projectStrokeOnPoints;if(s.Polyline){s.warn("fabric.Polyline is already defined");return}s.Polyline=s.util.createClass(s.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:s.Object.prototype.cacheProperties.concat("points"),initialize:function(p,m){m=m||{},this.points=p||[],this.callSuper("initialize",m),this._setPositionDimensions(m)},_projectStrokeOnPoints:function(){return u(this.points,this,!0)},_setPositionDimensions:function(p){var m=this._calcDimensions(p),g,v=this.exactBoundingBox?this.strokeWidth:0;this.width=m.width-v,this.height=m.height-v,p.fromSVG||(g=this.translateToGivenOrigin({x:m.left-this.strokeWidth/2+v/2,y:m.top-this.strokeWidth/2+v/2},"left","top",this.originX,this.originY)),typeof p.left>"u"&&(this.left=p.fromSVG?m.left:g.x),typeof p.top>"u"&&(this.top=p.fromSVG?m.top:g.y),this.pathOffset={x:m.left+this.width/2+v/2,y:m.top+this.height/2+v/2}},_calcDimensions:function(){var p=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,m=d(p,"x")||0,g=d(p,"y")||0,v=f(p,"x")||0,x=f(p,"y")||0,y=v-m,_=x-g;return{left:m,top:g,width:y,height:_}},toObject:function(p){return c(this.callSuper("toObject",p),{points:this.points.concat()})},_toSVG:function(){for(var p=[],m=this.pathOffset.x,g=this.pathOffset.y,v=s.Object.NUM_FRACTION_DIGITS,x=0,y=this.points.length;x<y;x++)p.push(h(this.points[x].x-m,v),",",h(this.points[x].y-g,v)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',p.join(""),`" />
`]},commonRender:function(p){var m,g=this.points.length,v=this.pathOffset.x,x=this.pathOffset.y;if(!g||isNaN(this.points[g-1].y))return!1;p.beginPath(),p.moveTo(this.points[0].x-v,this.points[0].y-x);for(var y=0;y<g;y++)m=this.points[y],p.lineTo(m.x-v,m.y-x);return!0},_render:function(p){this.commonRender(p)&&this._renderPaintInOrder(p)},complexity:function(){return this.get("points").length}}),s.Polyline.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat(),s.Polyline.fromElementGenerator=function(p){return function(m,g,v){if(!m)return g(null);v||(v={});var x=s.parsePointsAttribute(m.getAttribute("points")),y=s.parseAttributes(m,s[p].ATTRIBUTE_NAMES);y.fromSVG=!0,g(new s[p](x,c(y,v)))}},s.Polyline.fromElement=s.Polyline.fromElementGenerator("Polyline"),s.Polyline.fromObject=function(p,m){return s.Object._fromObject("Polyline",p,m,"points")}}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.util.projectStrokeOnPoints;if(s.Polygon){s.warn("fabric.Polygon is already defined");return}s.Polygon=s.util.createClass(s.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return c(this.points,this)},_render:function(d){this.commonRender(d)&&(d.closePath(),this._renderPaintInOrder(d))}}),s.Polygon.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat(),s.Polygon.fromElement=s.Polyline.fromElementGenerator("Polygon"),s.Polygon.fromObject=function(d,f){s.Object._fromObject("Polygon",d,f,"points")}}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.util.array.min,d=s.util.array.max,f=s.util.object.extend,h=s.util.object.clone,u=s.util.toFixed;if(s.Path){s.warn("fabric.Path is already defined");return}s.Path=s.util.createClass(s.Object,{type:"path",path:null,cacheProperties:s.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:s.Object.prototype.stateProperties.concat("path"),initialize:function(p,m){m=h(m||{}),delete m.path,this.callSuper("initialize",m),this._setPath(p||[],m)},_setPath:function(p,m){this.path=s.util.makePathSimpler(Array.isArray(p)?p:s.util.parsePath(p)),s.Polyline.prototype._setPositionDimensions.call(this,m||{})},_renderPathCommands:function(p){var m,g=0,v=0,x=0,y=0,_=0,w=0,T=-this.pathOffset.x,k=-this.pathOffset.y;p.beginPath();for(var O=0,F=this.path.length;O<F;++O)switch(m=this.path[O],m[0]){case"L":x=m[1],y=m[2],p.lineTo(x+T,y+k);break;case"M":x=m[1],y=m[2],g=x,v=y,p.moveTo(x+T,y+k);break;case"C":x=m[5],y=m[6],_=m[3],w=m[4],p.bezierCurveTo(m[1]+T,m[2]+k,_+T,w+k,x+T,y+k);break;case"Q":p.quadraticCurveTo(m[1]+T,m[2]+k,m[3]+T,m[4]+k),x=m[3],y=m[4],_=m[1],w=m[2];break;case"z":case"Z":x=g,y=v,p.closePath();break}},_render:function(p){this._renderPathCommands(p),this._renderPaintInOrder(p)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(p){return f(this.callSuper("toObject",p),{path:this.path.map(function(m){return m.slice()})})},toDatalessObject:function(p){var m=this.toObject(["sourcePath"].concat(p));return m.sourcePath&&delete m.path,m},_toSVG:function(){var p=s.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',p,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var p=s.Object.NUM_FRACTION_DIGITS;return" translate("+u(-this.pathOffset.x,p)+", "+u(-this.pathOffset.y,p)+")"},toClipPathSVG:function(p){var m=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:p,additionalTransform:m})},toSVG:function(p){var m=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:p,additionalTransform:m})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var p=[],m=[],g,v=0,x=0,y=0,_=0,w,T=0,k=this.path.length;T<k;++T){switch(g=this.path[T],g[0]){case"L":y=g[1],_=g[2],w=[];break;case"M":y=g[1],_=g[2],v=y,x=_,w=[];break;case"C":w=s.util.getBoundsOfCurve(y,_,g[1],g[2],g[3],g[4],g[5],g[6]),y=g[5],_=g[6];break;case"Q":w=s.util.getBoundsOfCurve(y,_,g[1],g[2],g[1],g[2],g[3],g[4]),y=g[3],_=g[4];break;case"z":case"Z":y=v,_=x;break}w.forEach(function(ae){p.push(ae.x),m.push(ae.y)}),p.push(y),m.push(_)}var O=c(p)||0,F=c(m)||0,M=d(p)||0,V=d(m)||0,X=M-O,q=V-F;return{left:O,top:F,width:X,height:q}}}),s.Path.fromObject=function(p,m){if(typeof p.sourcePath=="string"){var g=p.sourcePath;s.loadSVGFromURL(g,function(v){var x=v[0];x.setOptions(p),p.clipPath?s.util.enlivenObjects([p.clipPath],function(y){x.clipPath=y[0],m&&m(x)}):m&&m(x)})}else s.Object._fromObject("Path",p,m,"path")},s.Path.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat(["d"]),s.Path.fromElement=function(p,m,g){var v=s.parseAttributes(p,s.Path.ATTRIBUTE_NAMES);v.fromSVG=!0,m(new s.Path(v.d,f(v,g)))}}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.util.array.min,d=s.util.array.max;s.Group||(s.Group=s.util.createClass(s.Object,s.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(f,h,u){h=h||{},this._objects=[],u&&this.callSuper("initialize",h),this._objects=f||[];for(var p=this._objects.length;p--;)this._objects[p].group=this;if(u)this._updateObjectsACoords();else{var m=h&&h.centerPoint;h.originX!==void 0&&(this.originX=h.originX),h.originY!==void 0&&(this.originY=h.originY),m||this._calcBounds(),this._updateObjectsCoords(m),delete h.centerPoint,this.callSuper("initialize",h)}this.setCoords()},_updateObjectsACoords:function(){for(var f=!0,h=this._objects.length;h--;)this._objects[h].setCoords(f)},_updateObjectsCoords:function(h){for(var h=h||this.getCenterPoint(),u=this._objects.length;u--;)this._updateObjectCoords(this._objects[u],h)},_updateObjectCoords:function(f,h){var u=f.left,p=f.top,m=!0;f.set({left:u-h.x,top:p-h.y}),f.group=this,f.setCoords(m)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(f){var h=!!this.group;return this._restoreObjectsState(),s.util.resetObjectTransform(this),f&&(h&&s.util.removeTransformFromObject(f,this.group.calcTransformMatrix()),this._objects.push(f),f.group=this,f._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,h?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(f){return this._restoreObjectsState(),s.util.resetObjectTransform(this),this.remove(f),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(f){this.dirty=!0,f.group=this,f._set("canvas",this.canvas)},_onObjectRemoved:function(f){this.dirty=!0,delete f.group},_set:function(f,h){var u=this._objects.length;if(this.useSetOnGroup)for(;u--;)this._objects[u].setOnGroup(f,h);if(f==="canvas")for(;u--;)this._objects[u]._set(f,h);s.Object.prototype._set.call(this,f,h)},toObject:function(f){var h=this.includeDefaultValues,u=this._objects.filter(function(m){return!m.excludeFromExport}).map(function(m){var g=m.includeDefaultValues;m.includeDefaultValues=h;var v=m.toObject(f);return m.includeDefaultValues=g,v}),p=s.Object.prototype.toObject.call(this,f);return p.objects=u,p},toDatalessObject:function(f){var h,u=this.sourcePath;if(u)h=u;else{var p=this.includeDefaultValues;h=this._objects.map(function(g){var v=g.includeDefaultValues;g.includeDefaultValues=p;var x=g.toDatalessObject(f);return g.includeDefaultValues=v,x})}var m=s.Object.prototype.toDatalessObject.call(this,f);return m.objects=h,m},render:function(f){this._transformDone=!0,this.callSuper("render",f),this._transformDone=!1},shouldCache:function(){var f=s.Object.prototype.shouldCache.call(this);if(f){for(var h=0,u=this._objects.length;h<u;h++)if(this._objects[h].willDrawShadow())return this.ownCaching=!1,!1}return f},willDrawShadow:function(){if(s.Object.prototype.willDrawShadow.call(this))return!0;for(var f=0,h=this._objects.length;f<h;f++)if(this._objects[f].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(f){for(var h=0,u=this._objects.length;h<u;h++)this._objects[h].render(f);this._drawClipPath(f,this.clipPath)},isCacheDirty:function(f){if(this.callSuper("isCacheDirty",f))return!0;if(!this.statefullCache)return!1;for(var h=0,u=this._objects.length;h<u;h++)if(this._objects[h].isCacheDirty(!0)){if(this._cacheCanvas){var p=this.cacheWidth/this.zoomX,m=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-p/2,-m/2,p,m)}return!0}return!1},_restoreObjectsState:function(){var f=this.calcOwnMatrix();return this._objects.forEach(function(h){s.util.addTransformToObject(h,f),delete h.group,h.setCoords()}),this},destroy:function(){return this._objects.forEach(function(f){f.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(f){f.dispose&&f.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var f=this._objects,h=this.canvas;this._objects=[];var u=this.toObject();delete u.objects;var p=new s.ActiveSelection([]);return p.set(u),p.type="activeSelection",h.remove(this),f.forEach(function(m){m.group=p,m.dirty=!0,h.add(m)}),p.canvas=h,p._objects=f,h._activeObject=p,p.setCoords(),p}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var f=!0;return this.forEachObject(function(h){h.setCoords(f)}),this},_calcBounds:function(f){for(var h=[],u=[],p,m,g,v=["tr","br","bl","tl"],x=0,y=this._objects.length,_,w=v.length;x<y;++x){for(p=this._objects[x],g=p.calcACoords(),_=0;_<w;_++)m=v[_],h.push(g[m].x),u.push(g[m].y);p.aCoords=g}this._getBounds(h,u,f)},_getBounds:function(f,h,u){var p=new s.Point(c(f),c(h)),m=new s.Point(d(f),d(h)),g=p.y||0,v=p.x||0,x=m.x-p.x||0,y=m.y-p.y||0;this.width=x,this.height=y,u||this.setPositionByOrigin({x:v,y:g},"left","top")},_toSVG:function(f){for(var h=["<g ","COMMON_PARTS",` >
`],u=0,p=this._objects.length;u<p;u++)h.push("		",this._objects[u].toSVG(f));return h.push(`</g>
`),h},getSvgStyles:function(){var f=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",h=this.visible?"":" visibility: hidden;";return[f,this.getSvgFilter(),h].join("")},toClipPathSVG:function(f){for(var h=[],u=0,p=this._objects.length;u<p;u++)h.push("	",this._objects[u].toClipPathSVG(f));return this._createBaseClipPathSVGMarkup(h,{reviver:f})}}),s.Group.fromObject=function(f,h){var u=f.objects,p=s.util.object.clone(f,!0);if(delete p.objects,typeof u=="string"){s.loadSVGFromURL(u,function(m){var g=s.util.groupSVGElements(m,f,u),v=p.clipPath;delete p.clipPath,g.set(p),v?s.util.enlivenObjects([v],function(x){g.clipPath=x[0],h&&h(g)}):h&&h(g)});return}s.util.enlivenObjects(u,function(m){s.util.enlivenObjectEnlivables(f,p,function(){h&&h(new s.Group(m,p,!0))})})})}(e),function(o){var s=o.fabric||(o.fabric={});s.ActiveSelection||(s.ActiveSelection=s.util.createClass(s.Group,{type:"activeSelection",initialize:function(c,d){d=d||{},this._objects=c||[];for(var f=this._objects.length;f--;)this._objects[f].group=this;d.originX&&(this.originX=d.originX),d.originY&&(this.originY=d.originY),this._calcBounds(),this._updateObjectsCoords(),s.Object.prototype.initialize.call(this,d),this.setCoords()},toGroup:function(){var c=this._objects.concat();this._objects=[];var d=s.Object.prototype.toObject.call(this),f=new s.Group([]);if(delete d.type,f.set(d),c.forEach(function(u){u.canvas.remove(u),u.group=f}),f._objects=c,!this.canvas)return f;var h=this.canvas;return h.add(f),h._activeObject=f,f.setCoords(),f},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(c,d,f){c.save(),c.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,f=f||{},typeof f.hasControls>"u"&&(f.hasControls=!1),f.forActiveSelection=!0;for(var h=0,u=this._objects.length;h<u;h++)this._objects[h]._renderControls(c,f);this.callSuper("_renderControls",c,d),c.restore()}}),s.ActiveSelection.fromObject=function(c,d){s.util.enlivenObjects(c.objects,function(f){delete c.objects,d&&d(new s.ActiveSelection(f,c,!0))})})}(e),function(o){var s=t.util.object.extend;if(o.fabric||(o.fabric={}),o.fabric.Image){t.warn("fabric.Image is already defined.");return}t.Image=t.util.createClass(t.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:t.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:t.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(c,d){d||(d={}),this.filters=[],this.cacheKey="texture"+t.Object.__uid++,this.callSuper("initialize",d),this._initElement(c,d)},getElement:function(){return this._element||{}},setElement:function(c,d){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=c,this._originalElement=c,this._initConfig(d),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(c){var d=t.filterBackend;d&&d.evictCachesForKey&&d.evictCachesForKey(c)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((function(c){t.util.cleanUpJsdomNode(this[c]),this[c]=void 0}).bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var c=this.getElement();return{width:c.naturalWidth||c.width,height:c.naturalHeight||c.height}},_stroke:function(c){if(!(!this.stroke||this.strokeWidth===0)){var d=this.width/2,f=this.height/2;c.beginPath(),c.moveTo(-d,-f),c.lineTo(d,-f),c.lineTo(d,f),c.lineTo(-d,f),c.lineTo(-d,-f),c.closePath()}},toObject:function(c){var d=[];this.filters.forEach(function(h){h&&d.push(h.toObject())});var f=s(this.callSuper("toObject",["cropX","cropY"].concat(c)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:d});return this.resizeFilter&&(f.resizeFilter=this.resizeFilter.toObject()),f},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var c=[],d=[],f,h=this._element,u=-this.width/2,p=-this.height/2,m="",g="";if(!h)return[];if(this.hasCrop()){var v=t.Object.__uid++;c.push('<clipPath id="imageCrop_'+v+`">
`,'	<rect x="'+u+'" y="'+p+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),m=' clip-path="url(#imageCrop_'+v+')" '}if(this.imageSmoothing||(g='" image-rendering="optimizeSpeed'),d.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',u-this.cropX,'" y="',p-this.cropY,'" width="',h.width||h.naturalWidth,'" height="',h.height||h.height,g,'"',m,`></image>
`),this.stroke||this.strokeDashArray){var x=this.fill;this.fill=null,f=["	<rect ",'x="',u,'" y="',p,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=x}return this.paintFirst!=="fill"?c=c.concat(f,d):c=c.concat(d,f),c},getSrc:function(c){var d=c?this._element:this._originalElement;return d?d.toDataURL?d.toDataURL():this.srcFromAttribute?d.getAttribute("src"):d.src:this.src||""},setSrc:function(c,d,f){return t.util.loadImage(c,function(h,u){this.setElement(h,f),this._setWidthHeight(),d&&d(this,u)},this,f&&f.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var c=this.resizeFilter,d=this.minimumScaleTrigger,f=this.getTotalObjectScaling(),h=f.scaleX,u=f.scaleY,p=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!c||h>d&&u>d){this._element=p,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=h,this._lastScaleY=u;return}t.filterBackend||(t.filterBackend=t.initFilterBackend());var m=t.util.createCanvasElement(),g=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,v=p.width,x=p.height;m.width=v,m.height=x,this._element=m,this._lastScaleX=c.scaleX=h,this._lastScaleY=c.scaleY=u,t.filterBackend.applyFilters([c],p,v,x,this._element,g),this._filterScalingX=m.width/this._originalElement.width,this._filterScalingY=m.height/this._originalElement.height},applyFilters:function(c){if(c=c||this.filters||[],c=c.filter(function(p){return p&&!p.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),c.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var d=this._originalElement,f=d.naturalWidth||d.width,h=d.naturalHeight||d.height;if(this._element===this._originalElement){var u=t.util.createCanvasElement();u.width=f,u.height=h,this._element=u,this._filteredEl=u}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,f,h),this._lastScaleX=1,this._lastScaleY=1;return t.filterBackend||(t.filterBackend=t.initFilterBackend()),t.filterBackend.applyFilters(c,this._originalElement,f,h,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(c){t.util.setImageSmoothing(c,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(c),this._renderPaintInOrder(c)},drawCacheOnCanvas:function(c){t.util.setImageSmoothing(c,this.imageSmoothing),t.Object.prototype.drawCacheOnCanvas.call(this,c)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(c){var d=this._element;if(d){var f=this._filterScalingX,h=this._filterScalingY,u=this.width,p=this.height,m=Math.min,g=Math.max,v=g(this.cropX,0),x=g(this.cropY,0),y=d.naturalWidth||d.width,_=d.naturalHeight||d.height,w=v*f,T=x*h,k=m(u*f,y-w),O=m(p*h,_-T),F=-u/2,M=-p/2,V=m(u,y/f-v),X=m(p,_/h-x);d&&c.drawImage(d,w,T,k,O,F,M,V,X)}},_needsResize:function(){var c=this.getTotalObjectScaling();return c.scaleX!==this._lastScaleX||c.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(c,d){this.setElement(t.util.getById(c),d),t.util.addClass(this.getElement(),t.Image.CSS_CANVAS)},_initConfig:function(c){c||(c={}),this.setOptions(c),this._setWidthHeight(c)},_initFilters:function(c,d){c&&c.length?t.util.enlivenObjects(c,function(f){d&&d(f)},"fabric.Image.filters"):d&&d()},_setWidthHeight:function(c){c||(c={});var d=this.getElement();this.width=c.width||d.naturalWidth||d.width||0,this.height=c.height||d.naturalHeight||d.height||0},parsePreserveAspectRatioAttribute:function(){var c=t.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),d=this._element.width,f=this._element.height,h=1,u=1,p=0,m=0,g=0,v=0,x,y=this.width,_=this.height,w={width:y,height:_};return c&&(c.alignX!=="none"||c.alignY!=="none")?(c.meetOrSlice==="meet"&&(h=u=t.util.findScaleToFit(this._element,w),x=(y-d*h)/2,c.alignX==="Min"&&(p=-x),c.alignX==="Max"&&(p=x),x=(_-f*u)/2,c.alignY==="Min"&&(m=-x),c.alignY==="Max"&&(m=x)),c.meetOrSlice==="slice"&&(h=u=t.util.findScaleToCover(this._element,w),x=d-y/h,c.alignX==="Mid"&&(g=x/2),c.alignX==="Max"&&(g=x),x=f-_/u,c.alignY==="Mid"&&(v=x/2),c.alignY==="Max"&&(v=x),d=y/h,f=_/u)):(h=y/d,u=_/f),{width:d,height:f,scaleX:h,scaleY:u,offsetLeft:p,offsetTop:m,cropX:g,cropY:v}}}),t.Image.CSS_CANVAS="canvas-img",t.Image.prototype.getSvgSrc=t.Image.prototype.getSrc,t.Image.fromObject=function(c,d){var f=t.util.object.clone(c);t.util.loadImage(f.src,function(h,u){if(u){d&&d(null,!0);return}t.Image.prototype._initFilters.call(f,f.filters,function(p){f.filters=p||[],t.Image.prototype._initFilters.call(f,[f.resizeFilter],function(m){f.resizeFilter=m[0],t.util.enlivenObjectEnlivables(f,f,function(){var g=new t.Image(h,f);d(g,!1)})})})},null,f.crossOrigin)},t.Image.fromURL=function(c,d,f){t.util.loadImage(c,function(h,u){d&&d(new t.Image(h,f),u)},null,f&&f.crossOrigin)},t.Image.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),t.Image.fromElement=function(c,d,f){var h=t.parseAttributes(c,t.Image.ATTRIBUTE_NAMES);t.Image.fromURL(h["xlink:href"],d,s(f?t.util.object.clone(f):{},h))}}(e),t.util.object.extend(t.Object.prototype,{_getAngleValueForStraighten:function(){var o=this.angle%360;return o>0?Math.round((o-1)/90)*90:Math.round(o/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(o){o=o||{};var s=function(){},c=o.onComplete||s,d=o.onChange||s,f=this;return t.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(h){f.rotate(h),d()},onComplete:function(){f.setCoords(),c()}})}}),t.util.object.extend(t.StaticCanvas.prototype,{straightenObject:function(o){return o.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(o){return o.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function o(c,d){var f="precision "+d+` float;
void main(){}`,h=c.createShader(c.FRAGMENT_SHADER);return c.shaderSource(h,f),c.compileShader(h),!!c.getShaderParameter(h,c.COMPILE_STATUS)}t.isWebglSupported=function(c){if(t.isLikelyNode)return!1;c=c||t.WebglFilterBackend.prototype.tileSize;var d=document.createElement("canvas"),f=d.getContext("webgl")||d.getContext("experimental-webgl"),h=!1;if(f){t.maxTextureSize=f.getParameter(f.MAX_TEXTURE_SIZE),h=t.maxTextureSize>=c;for(var u=["highp","mediump","lowp"],p=0;p<3;p++)if(o(f,u[p])){t.webGlPrecision=u[p];break}}return this.isSupported=h,h},t.WebglFilterBackend=s;function s(c){c&&c.tileSize&&(this.tileSize=c.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}s.prototype={tileSize:2048,resources:{},setupGLContext:function(c,d){this.dispose(),this.createWebGLCanvas(c,d),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(c,d)},chooseFastestCopyGLTo2DMethod:function(c,d){var f=typeof window.performance<"u",h;try{new ImageData(1,1),h=!0}catch{h=!1}var u=typeof ArrayBuffer<"u",p=typeof Uint8ClampedArray<"u";if(f&&h&&u&&p){var m=t.util.createCanvasElement(),g=new ArrayBuffer(c*d*4);if(t.forceGLPutImageData){this.imageBuffer=g,this.copyGLTo2D=l;return}var v={imageBuffer:g,destinationWidth:c,destinationHeight:d,targetCanvas:m},x,y,_;m.width=c,m.height=d,x=window.performance.now(),a.call(v,this.gl,v),y=window.performance.now()-x,x=window.performance.now(),l.call(v,this.gl,v),_=window.performance.now()-x,y>_?(this.imageBuffer=g,this.copyGLTo2D=l):this.copyGLTo2D=a}},createWebGLCanvas:function(c,d){var f=t.util.createCanvasElement();f.width=c,f.height=d;var h={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},u=f.getContext("webgl",h);u||(u=f.getContext("experimental-webgl",h)),u&&(u.clearColor(0,0,0,0),this.canvas=f,this.gl=u)},applyFilters:function(c,d,f,h,u,p){var m=this.gl,g;p&&(g=this.getCachedTexture(p,d));var v={originalWidth:d.width||d.originalWidth,originalHeight:d.height||d.originalHeight,sourceWidth:f,sourceHeight:h,destinationWidth:f,destinationHeight:h,context:m,sourceTexture:this.createTexture(m,f,h,!g&&d),targetTexture:this.createTexture(m,f,h),originalTexture:g||this.createTexture(m,f,h,!g&&d),passes:c.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:u},x=m.createFramebuffer();return m.bindFramebuffer(m.FRAMEBUFFER,x),c.forEach(function(y){y&&y.applyTo(v)}),i(v),this.copyGLTo2D(m,v),m.bindTexture(m.TEXTURE_2D,null),m.deleteTexture(v.sourceTexture),m.deleteTexture(v.targetTexture),m.deleteFramebuffer(x),u.getContext("2d").setTransform(1,0,0,1,0,0),v},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(c,d,f,h,u){var p=c.createTexture();return c.bindTexture(c.TEXTURE_2D,p),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,u||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,u||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),h?c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,h):c.texImage2D(c.TEXTURE_2D,0,c.RGBA,d,f,0,c.RGBA,c.UNSIGNED_BYTE,null),p},getCachedTexture:function(c,d){if(this.textureCache[c])return this.textureCache[c];var f=this.createTexture(this.gl,d.width,d.height,d);return this.textureCache[c]=f,f},evictCachesForKey:function(c){this.textureCache[c]&&(this.gl.deleteTexture(this.textureCache[c]),delete this.textureCache[c])},copyGLTo2D:a,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var c=this.gl,d={renderer:"",vendor:""};if(!c)return d;var f=c.getExtension("WEBGL_debug_renderer_info");if(f){var h=c.getParameter(f.UNMASKED_RENDERER_WEBGL),u=c.getParameter(f.UNMASKED_VENDOR_WEBGL);h&&(d.renderer=h.toLowerCase()),u&&(d.vendor=u.toLowerCase())}return this.gpuInfo=d,d}}}();function i(o){var s=o.targetCanvas,c=s.width,d=s.height,f=o.destinationWidth,h=o.destinationHeight;(c!==f||d!==h)&&(s.width=f,s.height=h)}function a(o,s){var c=o.canvas,d=s.targetCanvas,f=d.getContext("2d");f.translate(0,d.height),f.scale(1,-1);var h=c.height-d.height;f.drawImage(c,0,h,d.width,d.height,0,0,d.width,d.height)}function l(o,s){var c=s.targetCanvas,d=c.getContext("2d"),f=s.destinationWidth,h=s.destinationHeight,u=f*h*4,p=new Uint8Array(this.imageBuffer,0,u),m=new Uint8ClampedArray(this.imageBuffer,0,u);o.readPixels(0,0,f,h,o.RGBA,o.UNSIGNED_BYTE,p);var g=new ImageData(m,f,h);d.putImageData(g,0,0)}(function(){var o=function(){};t.Canvas2dFilterBackend=s;function s(){}s.prototype={evictCachesForKey:o,dispose:o,clearWebGLCaches:o,resources:{},applyFilters:function(c,d,f,h,u){var p=u.getContext("2d");p.drawImage(d,0,0,f,h);var m=p.getImageData(0,0,f,h),g=p.getImageData(0,0,f,h),v={sourceWidth:f,sourceHeight:h,imageData:m,originalEl:d,originalImageData:g,canvasEl:u,ctx:p,filterBackend:this};return c.forEach(function(x){x.applyTo(v)}),(v.imageData.width!==f||v.imageData.height!==h)&&(u.width=v.imageData.width,u.height=v.imageData.height),p.putImageData(v.imageData,0,0),v}}})(),t.Image=t.Image||{},t.Image.filters=t.Image.filters||{},t.Image.filters.BaseFilter=t.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(o){o&&this.setOptions(o)},setOptions:function(o){for(var s in o)this[s]=o[s]},createProgram:function(o,s,c){s=s||this.fragmentSource,c=c||this.vertexSource,t.webGlPrecision!=="highp"&&(s=s.replace(/precision highp float/g,"precision "+t.webGlPrecision+" float"));var d=o.createShader(o.VERTEX_SHADER);if(o.shaderSource(d,c),o.compileShader(d),!o.getShaderParameter(d,o.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+o.getShaderInfoLog(d));var f=o.createShader(o.FRAGMENT_SHADER);if(o.shaderSource(f,s),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+o.getShaderInfoLog(f));var h=o.createProgram();if(o.attachShader(h,d),o.attachShader(h,f),o.linkProgram(h),!o.getProgramParameter(h,o.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+o.getProgramInfoLog(h));var u=this.getAttributeLocations(o,h),p=this.getUniformLocations(o,h)||{};return p.uStepW=o.getUniformLocation(h,"uStepW"),p.uStepH=o.getUniformLocation(h,"uStepH"),{program:h,attributeLocations:u,uniformLocations:p}},getAttributeLocations:function(o,s){return{aPosition:o.getAttribLocation(s,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(o,s,c){var d=s.aPosition,f=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,f),o.enableVertexAttribArray(d),o.vertexAttribPointer(d,2,o.FLOAT,!1,0,0),o.bufferData(o.ARRAY_BUFFER,c,o.STATIC_DRAW)},_setupFrameBuffer:function(o){var s=o.context,c,d;o.passes>1?(c=o.destinationWidth,d=o.destinationHeight,(o.sourceWidth!==c||o.sourceHeight!==d)&&(s.deleteTexture(o.targetTexture),o.targetTexture=o.filterBackend.createTexture(s,c,d)),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,o.targetTexture,0)):(s.bindFramebuffer(s.FRAMEBUFFER,null),s.finish())},_swapTextures:function(o){o.passes--,o.pass++;var s=o.targetTexture;o.targetTexture=o.sourceTexture,o.sourceTexture=s},isNeutralState:function(){var o=this.mainParameter,s=t.Image.filters[this.type].prototype;if(o)if(Array.isArray(s[o])){for(var c=s[o].length;c--;)if(this[o][c]!==s[o][c])return!1;return!0}else return s[o]===this[o];else return!1},applyTo:function(o){o.webgl?(this._setupFrameBuffer(o),this.applyToWebGL(o),this._swapTextures(o)):this.applyTo2d(o)},retrieveShader:function(o){return o.programCache.hasOwnProperty(this.type)||(o.programCache[this.type]=this.createProgram(o.context)),o.programCache[this.type]},applyToWebGL:function(o){var s=o.context,c=this.retrieveShader(o);o.pass===0&&o.originalTexture?s.bindTexture(s.TEXTURE_2D,o.originalTexture):s.bindTexture(s.TEXTURE_2D,o.sourceTexture),s.useProgram(c.program),this.sendAttributeData(s,c.attributeLocations,o.aPosition),s.uniform1f(c.uniformLocations.uStepW,1/o.sourceWidth),s.uniform1f(c.uniformLocations.uStepH,1/o.sourceHeight),this.sendUniformData(s,c.uniformLocations),s.viewport(0,0,o.destinationWidth,o.destinationHeight),s.drawArrays(s.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(o,s,c){o.activeTexture(c),o.bindTexture(o.TEXTURE_2D,s),o.activeTexture(o.TEXTURE0)},unbindAdditionalTexture:function(o,s){o.activeTexture(s),o.bindTexture(o.TEXTURE_2D,null),o.activeTexture(o.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(o){this[this.mainParameter]=o},sendUniformData:function(){},createHelpLayer:function(o){if(!o.helpLayer){var s=document.createElement("canvas");s.width=o.sourceWidth,s.height=o.sourceHeight,o.helpLayer=s}},toObject:function(){var o={type:this.type},s=this.mainParameter;return s&&(o[s]=this[s]),o},toJSON:function(){return this.toObject()}}),t.Image.filters.BaseFilter.fromObject=function(o,s){var c=new t.Image.filters[o.type](o);return s&&s(c),c},function(o){var s=o.fabric||(o.fabric={}),c=s.Image.filters,d=s.util.createClass;c.ColorMatrix=d(c.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(f){this.callSuper("initialize",f),this.matrix=this.matrix.slice(0)},applyTo2d:function(f){var h=f.imageData,u=h.data,p=u.length,m=this.matrix,g,v,x,y,_,w=this.colorsOnly;for(_=0;_<p;_+=4)g=u[_],v=u[_+1],x=u[_+2],w?(u[_]=g*m[0]+v*m[1]+x*m[2]+m[4]*255,u[_+1]=g*m[5]+v*m[6]+x*m[7]+m[9]*255,u[_+2]=g*m[10]+v*m[11]+x*m[12]+m[14]*255):(y=u[_+3],u[_]=g*m[0]+v*m[1]+x*m[2]+y*m[3]+m[4]*255,u[_+1]=g*m[5]+v*m[6]+x*m[7]+y*m[8]+m[9]*255,u[_+2]=g*m[10]+v*m[11]+x*m[12]+y*m[13]+m[14]*255,u[_+3]=g*m[15]+v*m[16]+x*m[17]+y*m[18]+m[19]*255)},getUniformLocations:function(f,h){return{uColorMatrix:f.getUniformLocation(h,"uColorMatrix"),uConstants:f.getUniformLocation(h,"uConstants")}},sendUniformData:function(f,h){var u=this.matrix,p=[u[0],u[1],u[2],u[3],u[5],u[6],u[7],u[8],u[10],u[11],u[12],u[13],u[15],u[16],u[17],u[18]],m=[u[4],u[9],u[14],u[19]];f.uniformMatrix4fv(h.uColorMatrix,!1,p),f.uniform4fv(h.uConstants,m)}}),s.Image.filters.ColorMatrix.fromObject=s.Image.filters.BaseFilter.fromObject}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.Image.filters,d=s.util.createClass;c.Brightness=d(c.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(f){if(this.brightness!==0){var h=f.imageData,u=h.data,p,m=u.length,g=Math.round(this.brightness*255);for(p=0;p<m;p+=4)u[p]=u[p]+g,u[p+1]=u[p+1]+g,u[p+2]=u[p+2]+g}},getUniformLocations:function(f,h){return{uBrightness:f.getUniformLocation(h,"uBrightness")}},sendUniformData:function(f,h){f.uniform1f(h.uBrightness,this.brightness)}}),s.Image.filters.Brightness.fromObject=s.Image.filters.BaseFilter.fromObject}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.util.object.extend,d=s.Image.filters,f=s.util.createClass;d.Convolute=f(d.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(h){var u=Math.sqrt(this.matrix.length),p=this.type+"_"+u+"_"+(this.opaque?1:0),m=this.fragmentSource[p];return h.programCache.hasOwnProperty(p)||(h.programCache[p]=this.createProgram(h.context,m)),h.programCache[p]},applyTo2d:function(h){var u=h.imageData,p=u.data,m=this.matrix,g=Math.round(Math.sqrt(m.length)),v=Math.floor(g/2),x=u.width,y=u.height,_=h.ctx.createImageData(x,y),w=_.data,T=this.opaque?1:0,k,O,F,M,V,X,q,ae,ne,re,le,se,C;for(le=0;le<y;le++)for(re=0;re<x;re++){for(V=(le*x+re)*4,k=0,O=0,F=0,M=0,C=0;C<g;C++)for(se=0;se<g;se++)q=le+C-v,X=re+se-v,!(q<0||q>=y||X<0||X>=x)&&(ae=(q*x+X)*4,ne=m[C*g+se],k+=p[ae]*ne,O+=p[ae+1]*ne,F+=p[ae+2]*ne,T||(M+=p[ae+3]*ne));w[V]=k,w[V+1]=O,w[V+2]=F,T?w[V+3]=p[V+3]:w[V+3]=M}h.imageData=_},getUniformLocations:function(h,u){return{uMatrix:h.getUniformLocation(u,"uMatrix"),uOpaque:h.getUniformLocation(u,"uOpaque"),uHalfSize:h.getUniformLocation(u,"uHalfSize"),uSize:h.getUniformLocation(u,"uSize")}},sendUniformData:function(h,u){h.uniform1fv(u.uMatrix,this.matrix)},toObject:function(){return c(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),s.Image.filters.Convolute.fromObject=s.Image.filters.BaseFilter.fromObject}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.Image.filters,d=s.util.createClass;c.Grayscale=d(c.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(f){var h=f.imageData,u=h.data,p,m=u.length,g,v=this.mode;for(p=0;p<m;p+=4)v==="average"?g=(u[p]+u[p+1]+u[p+2])/3:v==="lightness"?g=(Math.min(u[p],u[p+1],u[p+2])+Math.max(u[p],u[p+1],u[p+2]))/2:v==="luminosity"&&(g=.21*u[p]+.72*u[p+1]+.07*u[p+2]),u[p]=g,u[p+1]=g,u[p+2]=g},retrieveShader:function(f){var h=this.type+"_"+this.mode;if(!f.programCache.hasOwnProperty(h)){var u=this.fragmentSource[this.mode];f.programCache[h]=this.createProgram(f.context,u)}return f.programCache[h]},getUniformLocations:function(f,h){return{uMode:f.getUniformLocation(h,"uMode")}},sendUniformData:function(f,h){var u=1;f.uniform1i(h.uMode,u)},isNeutralState:function(){return!1}}),s.Image.filters.Grayscale.fromObject=s.Image.filters.BaseFilter.fromObject}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.Image.filters,d=s.util.createClass;c.Invert=d(c.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(f){var h=f.imageData,u=h.data,p,m=u.length;for(p=0;p<m;p+=4)u[p]=255-u[p],u[p+1]=255-u[p+1],u[p+2]=255-u[p+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(f,h){return{uInvert:f.getUniformLocation(h,"uInvert")}},sendUniformData:function(f,h){f.uniform1i(h.uInvert,this.invert)}}),s.Image.filters.Invert.fromObject=s.Image.filters.BaseFilter.fromObject}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.util.object.extend,d=s.Image.filters,f=s.util.createClass;d.Noise=f(d.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(h){if(this.noise!==0){var u=h.imageData,p=u.data,m,g=p.length,v=this.noise,x;for(m=0,g=p.length;m<g;m+=4)x=(.5-Math.random())*v,p[m]+=x,p[m+1]+=x,p[m+2]+=x}},getUniformLocations:function(h,u){return{uNoise:h.getUniformLocation(u,"uNoise"),uSeed:h.getUniformLocation(u,"uSeed")}},sendUniformData:function(h,u){h.uniform1f(u.uNoise,this.noise/255),h.uniform1f(u.uSeed,Math.random())},toObject:function(){return c(this.callSuper("toObject"),{noise:this.noise})}}),s.Image.filters.Noise.fromObject=s.Image.filters.BaseFilter.fromObject}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.Image.filters,d=s.util.createClass;c.Pixelate=d(c.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(f){var h=f.imageData,u=h.data,p=h.height,m=h.width,g,v,x,y,_,w,T,k,O,F,M;for(v=0;v<p;v+=this.blocksize)for(x=0;x<m;x+=this.blocksize)for(g=v*4*m+x*4,y=u[g],_=u[g+1],w=u[g+2],T=u[g+3],F=Math.min(v+this.blocksize,p),M=Math.min(x+this.blocksize,m),k=v;k<F;k++)for(O=x;O<M;O++)g=k*4*m+O*4,u[g]=y,u[g+1]=_,u[g+2]=w,u[g+3]=T},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(f,h){return{uBlocksize:f.getUniformLocation(h,"uBlocksize"),uStepW:f.getUniformLocation(h,"uStepW"),uStepH:f.getUniformLocation(h,"uStepH")}},sendUniformData:function(f,h){f.uniform1f(h.uBlocksize,this.blocksize)}}),s.Image.filters.Pixelate.fromObject=s.Image.filters.BaseFilter.fromObject}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.util.object.extend,d=s.Image.filters,f=s.util.createClass;d.RemoveColor=f(d.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(h){var u=h.imageData,p=u.data,m,g=this.distance*255,v,x,y,_=new s.Color(this.color).getSource(),w=[_[0]-g,_[1]-g,_[2]-g],T=[_[0]+g,_[1]+g,_[2]+g];for(m=0;m<p.length;m+=4)v=p[m],x=p[m+1],y=p[m+2],v>w[0]&&x>w[1]&&y>w[2]&&v<T[0]&&x<T[1]&&y<T[2]&&(p[m+3]=0)},getUniformLocations:function(h,u){return{uLow:h.getUniformLocation(u,"uLow"),uHigh:h.getUniformLocation(u,"uHigh")}},sendUniformData:function(h,u){var p=new s.Color(this.color).getSource(),m=parseFloat(this.distance),g=[0+p[0]/255-m,0+p[1]/255-m,0+p[2]/255-m,1],v=[p[0]/255+m,p[1]/255+m,p[2]/255+m,1];h.uniform4fv(u.uLow,g),h.uniform4fv(u.uHigh,v)},toObject:function(){return c(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),s.Image.filters.RemoveColor.fromObject=s.Image.filters.BaseFilter.fromObject}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.Image.filters,d=s.util.createClass,f={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var h in f)c[h]=d(c.ColorMatrix,{type:h,matrix:f[h],mainParameter:!1,colorsOnly:!0}),s.Image.filters[h].fromObject=s.Image.filters.BaseFilter.fromObject}(e),function(o){var s=o.fabric,c=s.Image.filters,d=s.util.createClass;c.BlendColor=d(c.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(f){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[f]+`}
}`},retrieveShader:function(f){var h=this.type+"_"+this.mode,u;return f.programCache.hasOwnProperty(h)||(u=this.buildSource(this.mode),f.programCache[h]=this.createProgram(f.context,u)),f.programCache[h]},applyTo2d:function(f){var h=f.imageData,u=h.data,p=u.length,m,g,v,x,y,_,w,T=1-this.alpha;w=new s.Color(this.color).getSource(),m=w[0]*this.alpha,g=w[1]*this.alpha,v=w[2]*this.alpha;for(var k=0;k<p;k+=4)switch(x=u[k],y=u[k+1],_=u[k+2],this.mode){case"multiply":u[k]=x*m/255,u[k+1]=y*g/255,u[k+2]=_*v/255;break;case"screen":u[k]=255-(255-x)*(255-m)/255,u[k+1]=255-(255-y)*(255-g)/255,u[k+2]=255-(255-_)*(255-v)/255;break;case"add":u[k]=x+m,u[k+1]=y+g,u[k+2]=_+v;break;case"diff":case"difference":u[k]=Math.abs(x-m),u[k+1]=Math.abs(y-g),u[k+2]=Math.abs(_-v);break;case"subtract":u[k]=x-m,u[k+1]=y-g,u[k+2]=_-v;break;case"darken":u[k]=Math.min(x,m),u[k+1]=Math.min(y,g),u[k+2]=Math.min(_,v);break;case"lighten":u[k]=Math.max(x,m),u[k+1]=Math.max(y,g),u[k+2]=Math.max(_,v);break;case"overlay":u[k]=m<128?2*x*m/255:255-2*(255-x)*(255-m)/255,u[k+1]=g<128?2*y*g/255:255-2*(255-y)*(255-g)/255,u[k+2]=v<128?2*_*v/255:255-2*(255-_)*(255-v)/255;break;case"exclusion":u[k]=m+x-2*m*x/255,u[k+1]=g+y-2*g*y/255,u[k+2]=v+_-2*v*_/255;break;case"tint":u[k]=m+x*T,u[k+1]=g+y*T,u[k+2]=v+_*T}},getUniformLocations:function(f,h){return{uColor:f.getUniformLocation(h,"uColor")}},sendUniformData:function(f,h){var u=new s.Color(this.color).getSource();u[0]=this.alpha*u[0]/255,u[1]=this.alpha*u[1]/255,u[2]=this.alpha*u[2]/255,u[3]=this.alpha,f.uniform4fv(h.uColor,u)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),s.Image.filters.BlendColor.fromObject=s.Image.filters.BaseFilter.fromObject}(e),function(o){var s=o.fabric,c=s.Image.filters,d=s.util.createClass;c.BlendImage=d(c.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(f){var h=this.type+"_"+this.mode,u=this.fragmentSource[this.mode];return f.programCache.hasOwnProperty(h)||(f.programCache[h]=this.createProgram(f.context,u)),f.programCache[h]},applyToWebGL:function(f){var h=f.context,u=this.createTexture(f.filterBackend,this.image);this.bindAdditionalTexture(h,u,h.TEXTURE1),this.callSuper("applyToWebGL",f),this.unbindAdditionalTexture(h,h.TEXTURE1)},createTexture:function(f,h){return f.getCachedTexture(h.cacheKey,h._element)},calculateMatrix:function(){var f=this.image,h=f._element.width,u=f._element.height;return[1/f.scaleX,0,0,0,1/f.scaleY,0,-f.left/h,-f.top/u,1]},applyTo2d:function(f){var h=f.imageData,u=f.filterBackend.resources,p=h.data,m=p.length,g=h.width,v=h.height,x,y,_,w,T,k,O,F,M,V,X=this.image,q;u.blendImage||(u.blendImage=s.util.createCanvasElement()),M=u.blendImage,V=M.getContext("2d"),M.width!==g||M.height!==v?(M.width=g,M.height=v):V.clearRect(0,0,g,v),V.setTransform(X.scaleX,0,0,X.scaleY,X.left,X.top),V.drawImage(X._element,0,0,g,v),q=V.getImageData(0,0,g,v).data;for(var ae=0;ae<m;ae+=4)switch(T=p[ae],k=p[ae+1],O=p[ae+2],F=p[ae+3],x=q[ae],y=q[ae+1],_=q[ae+2],w=q[ae+3],this.mode){case"multiply":p[ae]=T*x/255,p[ae+1]=k*y/255,p[ae+2]=O*_/255,p[ae+3]=F*w/255;break;case"mask":p[ae+3]=w;break}},getUniformLocations:function(f,h){return{uTransformMatrix:f.getUniformLocation(h,"uTransformMatrix"),uImage:f.getUniformLocation(h,"uImage")}},sendUniformData:function(f,h){var u=this.calculateMatrix();f.uniform1i(h.uImage,1),f.uniformMatrix3fv(h.uTransformMatrix,!1,u)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),s.Image.filters.BlendImage.fromObject=function(f,h){s.Image.fromObject(f.image,function(u){var p=s.util.object.clone(f);p.image=u,h(new s.Image.filters.BlendImage(p))})}}(e),function(o){var s=o.fabric||(o.fabric={}),c=Math.pow,d=Math.floor,f=Math.sqrt,h=Math.abs,u=Math.round,p=Math.sin,m=Math.ceil,g=s.Image.filters,v=s.util.createClass;g.Resize=v(g.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(x,y){return{uDelta:x.getUniformLocation(y,"uDelta"),uTaps:x.getUniformLocation(y,"uTaps")}},sendUniformData:function(x,y){x.uniform2fv(y.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),x.uniform1fv(y.uTaps,this.taps)},retrieveShader:function(x){var y=this.getFilterWindow(),_=this.type+"_"+y;if(!x.programCache.hasOwnProperty(_)){var w=this.generateShader(y);x.programCache[_]=this.createProgram(x.context,w)}return x.programCache[_]},getFilterWindow:function(){var x=this.tempScale;return Math.ceil(this.lanczosLobes/x)},getTaps:function(){for(var x=this.lanczosCreate(this.lanczosLobes),y=this.tempScale,_=this.getFilterWindow(),w=new Array(_),T=1;T<=_;T++)w[T-1]=x(T*y);return w},generateShader:function(w){for(var y=new Array(w),_=this.fragmentSourceTOP,w,T=1;T<=w;T++)y[T-1]=T+".0 * uDelta";return _+="uniform float uTaps["+w+`];
`,_+=`void main() {
`,_+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,_+=`  float sum = 1.0;
`,y.forEach(function(k,O){_+="  color += texture2D(uTexture, vTexCoord + "+k+") * uTaps["+O+`];
`,_+="  color += texture2D(uTexture, vTexCoord - "+k+") * uTaps["+O+`];
`,_+="  sum += 2.0 * uTaps["+O+`];
`}),_+=`  gl_FragColor = color / sum;
`,_+="}",_},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(x){x.webgl?(x.passes++,this.width=x.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=x.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),x.destinationWidth=this.dW,this._setupFrameBuffer(x),this.applyToWebGL(x),this._swapTextures(x),x.sourceWidth=x.destinationWidth,this.height=x.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),x.destinationHeight=this.dH,this._setupFrameBuffer(x),this.applyToWebGL(x),this._swapTextures(x),x.sourceHeight=x.destinationHeight):this.applyTo2d(x)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(x){return function(y){if(y>=x||y<=-x)return 0;if(y<11920929e-14&&y>-11920929e-14)return 1;y*=Math.PI;var _=y/x;return p(y)/y*p(_)/_}},applyTo2d:function(x){var y=x.imageData,_=this.scaleX,w=this.scaleY;this.rcpScaleX=1/_,this.rcpScaleY=1/w;var T=y.width,k=y.height,O=u(T*_),F=u(k*w),M;this.resizeType==="sliceHack"?M=this.sliceByTwo(x,T,k,O,F):this.resizeType==="hermite"?M=this.hermiteFastResize(x,T,k,O,F):this.resizeType==="bilinear"?M=this.bilinearFiltering(x,T,k,O,F):this.resizeType==="lanczos"&&(M=this.lanczosResize(x,T,k,O,F)),x.imageData=M},sliceByTwo:function(x,y,_,w,T){var k=x.imageData,O=.5,F=!1,M=!1,V=y*O,X=_*O,q=s.filterBackend.resources,ae,ne,re=0,le=0,se=y,C=0;for(q.sliceByTwo||(q.sliceByTwo=document.createElement("canvas")),ae=q.sliceByTwo,(ae.width<y*1.5||ae.height<_)&&(ae.width=y*1.5,ae.height=_),ne=ae.getContext("2d"),ne.clearRect(0,0,y*1.5,_),ne.putImageData(k,0,0),w=d(w),T=d(T);!F||!M;)y=V,_=X,w<d(V*O)?V=d(V*O):(V=w,F=!0),T<d(X*O)?X=d(X*O):(X=T,M=!0),ne.drawImage(ae,re,le,y,_,se,C,V,X),re=se,le=C,C+=X;return ne.getImageData(re,le,w,T)},lanczosResize:function(x,y,_,w,T){function k(L){var E,I,A,b,P,R,W,z,Y,ie,N;for(C.x=(L+.5)*X,j.x=d(C.x),E=0;E<T;E++){for(C.y=(E+.5)*q,j.y=d(C.y),P=0,R=0,W=0,z=0,Y=0,I=j.x-re;I<=j.x+re;I++)if(!(I<0||I>=y)){ie=d(1e3*h(I-C.x)),se[ie]||(se[ie]={});for(var Q=j.y-le;Q<=j.y+le;Q++)Q<0||Q>=_||(N=d(1e3*h(Q-C.y)),se[ie][N]||(se[ie][N]=V(f(c(ie*ae,2)+c(N*ne,2))/1e3)),A=se[ie][N],A>0&&(b=(Q*y+I)*4,P+=A,R+=A*O[b],W+=A*O[b+1],z+=A*O[b+2],Y+=A*O[b+3]))}b=(E*w+L)*4,M[b]=R/P,M[b+1]=W/P,M[b+2]=z/P,M[b+3]=Y/P}return++L<w?k(L):F}var O=x.imageData.data,F=x.ctx.createImageData(w,T),M=F.data,V=this.lanczosCreate(this.lanczosLobes),X=this.rcpScaleX,q=this.rcpScaleY,ae=2/this.rcpScaleX,ne=2/this.rcpScaleY,re=m(X*this.lanczosLobes/2),le=m(q*this.lanczosLobes/2),se={},C={},j={};return k(0)},bilinearFiltering:function(x,y,_,w,T){var k,O,F,M,V,X,q,ae,ne,re,le,se,C=0,j,L=this.rcpScaleX,E=this.rcpScaleY,I=4*(y-1),A=x.imageData,b=A.data,P=x.ctx.createImageData(w,T),R=P.data;for(q=0;q<T;q++)for(ae=0;ae<w;ae++)for(V=d(L*ae),X=d(E*q),ne=L*ae-V,re=E*q-X,j=4*(X*y+V),le=0;le<4;le++)k=b[j+le],O=b[j+4+le],F=b[j+I+le],M=b[j+I+4+le],se=k*(1-ne)*(1-re)+O*ne*(1-re)+F*re*(1-ne)+M*ne*re,R[C++]=se;return P},hermiteFastResize:function(x,y,_,w,T){for(var k=this.rcpScaleX,O=this.rcpScaleY,F=m(k/2),M=m(O/2),V=x.imageData,X=V.data,q=x.ctx.createImageData(w,T),ae=q.data,ne=0;ne<T;ne++)for(var re=0;re<w;re++){for(var le=(re+ne*w)*4,se=0,C=0,j=0,L=0,E=0,I=0,A=0,b=(ne+.5)*O,P=d(ne*O);P<(ne+1)*O;P++)for(var R=h(b-(P+.5))/M,W=(re+.5)*k,z=R*R,Y=d(re*k);Y<(re+1)*k;Y++){var ie=h(W-(Y+.5))/F,N=f(z+ie*ie);N>1&&N<-1||(se=2*N*N*N-3*N*N+1,se>0&&(ie=4*(Y+P*y),A+=se*X[ie+3],j+=se,X[ie+3]<255&&(se=se*X[ie+3]/250),L+=se*X[ie],E+=se*X[ie+1],I+=se*X[ie+2],C+=se))}ae[le]=L/C,ae[le+1]=E/C,ae[le+2]=I/C,ae[le+3]=A/j}return q},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),s.Image.filters.Resize.fromObject=s.Image.filters.BaseFilter.fromObject}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.Image.filters,d=s.util.createClass;c.Contrast=d(c.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(f){if(this.contrast!==0){var h=f.imageData,u,m,p=h.data,m=p.length,g=Math.floor(this.contrast*255),v=259*(g+255)/(255*(259-g));for(u=0;u<m;u+=4)p[u]=v*(p[u]-128)+128,p[u+1]=v*(p[u+1]-128)+128,p[u+2]=v*(p[u+2]-128)+128}},getUniformLocations:function(f,h){return{uContrast:f.getUniformLocation(h,"uContrast")}},sendUniformData:function(f,h){f.uniform1f(h.uContrast,this.contrast)}}),s.Image.filters.Contrast.fromObject=s.Image.filters.BaseFilter.fromObject}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.Image.filters,d=s.util.createClass;c.Saturation=d(c.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(f){if(this.saturation!==0){var h=f.imageData,u=h.data,p=u.length,m=-this.saturation,g,v;for(g=0;g<p;g+=4)v=Math.max(u[g],u[g+1],u[g+2]),u[g]+=v!==u[g]?(v-u[g])*m:0,u[g+1]+=v!==u[g+1]?(v-u[g+1])*m:0,u[g+2]+=v!==u[g+2]?(v-u[g+2])*m:0}},getUniformLocations:function(f,h){return{uSaturation:f.getUniformLocation(h,"uSaturation")}},sendUniformData:function(f,h){f.uniform1f(h.uSaturation,-this.saturation)}}),s.Image.filters.Saturation.fromObject=s.Image.filters.BaseFilter.fromObject}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.Image.filters,d=s.util.createClass;c.Vibrance=d(c.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(f){if(this.vibrance!==0){var h=f.imageData,u=h.data,p=u.length,m=-this.vibrance,g,v,x,y;for(g=0;g<p;g+=4)v=Math.max(u[g],u[g+1],u[g+2]),x=(u[g]+u[g+1]+u[g+2])/3,y=Math.abs(v-x)*2/255*m,u[g]+=v!==u[g]?(v-u[g])*y:0,u[g+1]+=v!==u[g+1]?(v-u[g+1])*y:0,u[g+2]+=v!==u[g+2]?(v-u[g+2])*y:0}},getUniformLocations:function(f,h){return{uVibrance:f.getUniformLocation(h,"uVibrance")}},sendUniformData:function(f,h){f.uniform1f(h.uVibrance,-this.vibrance)}}),s.Image.filters.Vibrance.fromObject=s.Image.filters.BaseFilter.fromObject}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.Image.filters,d=s.util.createClass;c.Blur=d(c.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(f){f.webgl?(this.aspectRatio=f.sourceWidth/f.sourceHeight,f.passes++,this._setupFrameBuffer(f),this.horizontal=!0,this.applyToWebGL(f),this._swapTextures(f),this._setupFrameBuffer(f),this.horizontal=!1,this.applyToWebGL(f),this._swapTextures(f)):this.applyTo2d(f)},applyTo2d:function(f){f.imageData=this.simpleBlur(f)},simpleBlur:function(f){var h=f.filterBackend.resources,u,p,m=f.imageData.width,g=f.imageData.height;h.blurLayer1||(h.blurLayer1=s.util.createCanvasElement(),h.blurLayer2=s.util.createCanvasElement()),u=h.blurLayer1,p=h.blurLayer2,(u.width!==m||u.height!==g)&&(p.width=u.width=m,p.height=u.height=g);var v=u.getContext("2d"),x=p.getContext("2d"),y=15,_,w,T,k,O=this.blur*.06*.5;for(v.putImageData(f.imageData,0,0),x.clearRect(0,0,m,g),k=-y;k<=y;k++)_=(Math.random()-.5)/4,w=k/y,T=O*w*m+_,x.globalAlpha=1-Math.abs(w),x.drawImage(u,T,_),v.drawImage(p,0,0),x.globalAlpha=1,x.clearRect(0,0,p.width,p.height);for(k=-y;k<=y;k++)_=(Math.random()-.5)/4,w=k/y,T=O*w*g+_,x.globalAlpha=1-Math.abs(w),x.drawImage(u,_,T),v.drawImage(p,0,0),x.globalAlpha=1,x.clearRect(0,0,p.width,p.height);f.ctx.drawImage(u,0,0);var F=f.ctx.getImageData(0,0,u.width,u.height);return v.globalAlpha=1,v.clearRect(0,0,u.width,u.height),F},getUniformLocations:function(f,h){return{delta:f.getUniformLocation(h,"uDelta")}},sendUniformData:function(f,h){var u=this.chooseRightDelta();f.uniform2fv(h.delta,u)},chooseRightDelta:function(){var f=1,h=[0,0],u;return this.horizontal?this.aspectRatio>1&&(f=1/this.aspectRatio):this.aspectRatio<1&&(f=this.aspectRatio),u=f*this.blur*.12,this.horizontal?h[0]=u:h[1]=u,h}}),c.Blur.fromObject=s.Image.filters.BaseFilter.fromObject}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.Image.filters,d=s.util.createClass;c.Gamma=d(c.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(f){this.gamma=[1,1,1],c.BaseFilter.prototype.initialize.call(this,f)},applyTo2d:function(f){var h=f.imageData,u=h.data,p=this.gamma,m=u.length,g=1/p[0],v=1/p[1],x=1/p[2],y;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),y=0,m=256;y<m;y++)this.rVals[y]=Math.pow(y/255,g)*255,this.gVals[y]=Math.pow(y/255,v)*255,this.bVals[y]=Math.pow(y/255,x)*255;for(y=0,m=u.length;y<m;y+=4)u[y]=this.rVals[u[y]],u[y+1]=this.gVals[u[y+1]],u[y+2]=this.bVals[u[y+2]]},getUniformLocations:function(f,h){return{uGamma:f.getUniformLocation(h,"uGamma")}},sendUniformData:function(f,h){f.uniform3fv(h.uGamma,this.gamma)}}),s.Image.filters.Gamma.fromObject=s.Image.filters.BaseFilter.fromObject}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.Image.filters,d=s.util.createClass;c.Composed=d(c.BaseFilter,{type:"Composed",subFilters:[],initialize:function(f){this.callSuper("initialize",f),this.subFilters=this.subFilters.slice(0)},applyTo:function(f){f.passes+=this.subFilters.length-1,this.subFilters.forEach(function(h){h.applyTo(f)})},toObject:function(){return s.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(f){return f.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(f){return!f.isNeutralState()})}}),s.Image.filters.Composed.fromObject=function(f,h){var u=f.subFilters||[],p=u.map(function(g){return new s.Image.filters[g.type](g)}),m=new s.Image.filters.Composed({subFilters:p});return h&&h(m),m}}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.Image.filters,d=s.util.createClass;c.HueRotation=d(c.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var f=this.rotation*Math.PI,h=s.util.cos(f),u=s.util.sin(f),p=1/3,m=Math.sqrt(p)*u,g=1-h;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=h+g/3,this.matrix[1]=p*g-m,this.matrix[2]=p*g+m,this.matrix[5]=p*g+m,this.matrix[6]=h+p*g,this.matrix[7]=p*g-m,this.matrix[10]=p*g-m,this.matrix[11]=p*g+m,this.matrix[12]=h+p*g},isNeutralState:function(f){return this.calculateMatrix(),c.BaseFilter.prototype.isNeutralState.call(this,f)},applyTo:function(f){this.calculateMatrix(),c.BaseFilter.prototype.applyTo.call(this,f)}}),s.Image.filters.HueRotation.fromObject=s.Image.filters.BaseFilter.fromObject}(e),function(o){var s=o.fabric||(o.fabric={}),c=s.util.object.clone;if(s.Text){s.warn("fabric.Text is already defined");return}var d="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");s.Text=s.util.createClass(s.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:s.Object.prototype.stateProperties.concat(d),cacheProperties:s.Object.prototype.cacheProperties.concat(d),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(f,h){this.styles=h?h.styles||{}:{},this.text=f,this.__skipDimension=!0,this.callSuper("initialize",h),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var f=this.path;f&&(f.segmentsInfo=s.util.getPathSegmentsInfo(f.path))},getMeasuringContext:function(){return s._measuringContext||(s._measuringContext=this.canvas&&this.canvas.contextCache||s.util.createCanvasElement().getContext("2d")),s._measuringContext},_splitText:function(){var f=this._splitTextIntoLines(this.text);return this.textLines=f.lines,this._textLines=f.graphemeLines,this._unwrappedTextLines=f._unwrappedLines,this._text=f.graphemeText,f},initDimensions:function(){if(!this.__skipDimension){if(this._splitText(),this._clearCache(),this.path){var f=this.getHeightOfLine(0)*1.1;this.width=this.path.width+f,this.height=this.path.height+f}else this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight();this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"})}},enlargeSpaces:function(){for(var f,h,u,p,m,g,v,x=0,y=this._textLines.length;x<y;x++)if(!(this.textAlign!=="justify"&&(x===y-1||this.isEndOfWrapping(x)))&&(p=0,m=this._textLines[x],h=this.getLineWidth(x),h<this.width&&(v=this.textLines[x].match(this._reSpacesAndTabs)))){u=v.length,f=(this.width-h)/u;for(var _=0,w=m.length;_<=w;_++)g=this.__charBounds[x][_],this._reSpaceAndTab.test(m[_])?(g.width+=f,g.kernedWidth+=f,g.left+=p,p+=f):g.left+=p}},isEndOfWrapping:function(f){return f===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var f=this.callSuper("_getCacheCanvasDimensions"),h=this.fontSize;return f.width+=h*f.zoomX,f.height+=h*f.zoomY,f},_render:function(f){var h=this.path;h&&!h.isNotVisible()&&h._render(f),this._setTextStyles(f),this._renderTextLinesBackground(f),this._renderTextDecoration(f,"underline"),this._renderText(f),this._renderTextDecoration(f,"overline"),this._renderTextDecoration(f,"linethrough")},_renderText:function(f){this.paintFirst==="stroke"?(this._renderTextStroke(f),this._renderTextFill(f)):(this._renderTextFill(f),this._renderTextStroke(f))},_setTextStyles:function(f,h,u){if(f.textBaseline="alphabetic",this.path)switch(this.pathAlign){case"center":f.textBaseline="middle";break;case"ascender":f.textBaseline="top";break;case"descender":f.textBaseline="bottom";break}f.font=this._getFontDeclaration(h,u)},calcTextWidth:function(){for(var f=this.getLineWidth(0),h=1,u=this._textLines.length;h<u;h++){var p=this.getLineWidth(h);p>f&&(f=p)}return f},_renderTextLine:function(f,h,u,p,m,g){this._renderChars(f,h,u,p,m,g)},_renderTextLinesBackground:function(f){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var h,u,p=f.fillStyle,m,g,v=this._getLeftOffset(),x=this._getTopOffset(),y=0,_=0,w,T,k=this.path,O,F=0,M=this._textLines.length;F<M;F++){if(h=this.getHeightOfLine(F),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",F)){x+=h;continue}m=this._textLines[F],u=this._getLineLeftOffset(F),_=0,y=0,g=this.getValueOfPropertyAt(F,0,"textBackgroundColor");for(var V=0,X=m.length;V<X;V++)w=this.__charBounds[F][V],T=this.getValueOfPropertyAt(F,V,"textBackgroundColor"),k?(f.save(),f.translate(w.renderLeft,w.renderTop),f.rotate(w.angle),f.fillStyle=T,T&&f.fillRect(-w.width/2,-h/this.lineHeight*(1-this._fontSizeFraction),w.width,h/this.lineHeight),f.restore()):T!==g?(O=v+u+y,this.direction==="rtl"&&(O=this.width-O-_),f.fillStyle=g,g&&f.fillRect(O,x,_,h/this.lineHeight),y=w.left,_=w.width,g=T):_+=w.kernedWidth;T&&!k&&(O=v+u+y,this.direction==="rtl"&&(O=this.width-O-_),f.fillStyle=T,f.fillRect(O,x,_,h/this.lineHeight)),x+=h}f.fillStyle=p,this._removeShadow(f)}},getFontCache:function(f){var h=f.fontFamily.toLowerCase();s.charWidthsCache[h]||(s.charWidthsCache[h]={});var u=s.charWidthsCache[h],p=f.fontStyle.toLowerCase()+"_"+(f.fontWeight+"").toLowerCase();return u[p]||(u[p]={}),u[p]},_measureChar:function(f,h,u,p){var m=this.getFontCache(h),g=this._getFontDeclaration(h),v=this._getFontDeclaration(p),x=u+f,y=g===v,_,w,T,k=h.fontSize/this.CACHE_FONT_SIZE,O;if(u&&m[u]!==void 0&&(T=m[u]),m[f]!==void 0&&(O=_=m[f]),y&&m[x]!==void 0&&(w=m[x],O=w-T),_===void 0||T===void 0||w===void 0){var F=this.getMeasuringContext();this._setTextStyles(F,h,!0)}return _===void 0&&(O=_=F.measureText(f).width,m[f]=_),T===void 0&&y&&u&&(T=F.measureText(u).width,m[u]=T),y&&w===void 0&&(w=F.measureText(x).width,m[x]=w,O=w-T),{width:_*k,kernedWidth:O*k}},getHeightOfChar:function(f,h){return this.getValueOfPropertyAt(f,h,"fontSize")},measureLine:function(f){var h=this._measureLine(f);return this.charSpacing!==0&&(h.width-=this._getWidthOfCharSpacing()),h.width<0&&(h.width=0),h},_measureLine:function(f){var h=0,u,p,m=this._textLines[f],g,v,x=0,y=new Array(m.length),_=0,w,T,k=this.path,O=this.pathSide==="right";for(this.__charBounds[f]=y,u=0;u<m.length;u++)p=m[u],v=this._getGraphemeBox(p,f,u,g),y[u]=v,h+=v.kernedWidth,g=p;if(y[u]={left:v?v.left+v.width:0,width:0,kernedWidth:0,height:this.fontSize},k){switch(T=k.segmentsInfo[k.segmentsInfo.length-1].length,w=s.util.getPointOnPath(k.path,0,k.segmentsInfo),w.x+=k.pathOffset.x,w.y+=k.pathOffset.y,this.textAlign){case"left":_=O?T-h:0;break;case"center":_=(T-h)/2;break;case"right":_=O?0:T-h;break}for(_+=this.pathStartOffset*(O?-1:1),u=O?m.length-1:0;O?u>=0:u<m.length;O?u--:u++)v=y[u],_>T?_%=T:_<0&&(_+=T),this._setGraphemeOnPath(_,v,w),_+=v.kernedWidth}return{width:h,numOfSpaces:x}},_setGraphemeOnPath:function(f,h,u){var p=f+h.kernedWidth/2,m=this.path,g=s.util.getPointOnPath(m.path,p,m.segmentsInfo);h.renderLeft=g.x-u.x,h.renderTop=g.y-u.y,h.angle=g.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(f,h,u,p,m){var g=this.getCompleteStyleDeclaration(h,u),v=p?this.getCompleteStyleDeclaration(h,u-1):{},x=this._measureChar(f,g,p,v),y=x.kernedWidth,_=x.width,w;this.charSpacing!==0&&(w=this._getWidthOfCharSpacing(),_+=w,y+=w);var T={width:_,left:0,height:g.fontSize,kernedWidth:y,deltaY:g.deltaY};if(u>0&&!m){var k=this.__charBounds[h][u-1];T.left=k.left+k.width+x.kernedWidth-x.width}return T},getHeightOfLine:function(f){if(this.__lineHeights[f])return this.__lineHeights[f];for(var h=this._textLines[f],u=this.getHeightOfChar(f,0),p=1,m=h.length;p<m;p++)u=Math.max(this.getHeightOfChar(f,p),u);return this.__lineHeights[f]=u*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var f,h=0,u=0,p=this._textLines.length;u<p;u++)f=this.getHeightOfLine(u),h+=u===p-1?f/this.lineHeight:f;return h},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(f,h){f.save();for(var u=0,p=this._getLeftOffset(),m=this._getTopOffset(),g=0,v=this._textLines.length;g<v;g++){var x=this.getHeightOfLine(g),y=x/this.lineHeight,_=this._getLineLeftOffset(g);this._renderTextLine(h,f,this._textLines[g],p+_,m+u+y,g),u+=x}f.restore()},_renderTextFill:function(f){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(f,"fillText")},_renderTextStroke:function(f){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(f),f.save(),this._setLineDash(f,this.strokeDashArray),f.beginPath(),this._renderTextCommon(f,"strokeText"),f.closePath(),f.restore())},_renderChars:function(f,h,u,p,m,g){var v=this.getHeightOfLine(g),x=this.textAlign.indexOf("justify")!==-1,y,_,w="",T,k=0,O,F=this.path,M=!x&&this.charSpacing===0&&this.isEmptyStyles(g)&&!F,V=this.direction==="ltr",X=this.direction==="ltr"?1:-1,q,ae=h.canvas.getAttribute("dir");if(h.save(),ae!==this.direction&&(h.canvas.setAttribute("dir",V?"ltr":"rtl"),h.direction=V?"ltr":"rtl",h.textAlign=V?"left":"right"),m-=v*this._fontSizeFraction/this.lineHeight,M){this._renderChar(f,h,g,0,u.join(""),p,m,v),h.restore();return}for(var ne=0,re=u.length-1;ne<=re;ne++)O=ne===re||this.charSpacing||F,w+=u[ne],T=this.__charBounds[g][ne],k===0?(p+=X*(T.kernedWidth-T.width),k+=T.width):k+=T.kernedWidth,x&&!O&&this._reSpaceAndTab.test(u[ne])&&(O=!0),O||(y=y||this.getCompleteStyleDeclaration(g,ne),_=this.getCompleteStyleDeclaration(g,ne+1),O=s.util.hasStyleChanged(y,_,!1)),O&&(F?(h.save(),h.translate(T.renderLeft,T.renderTop),h.rotate(T.angle),this._renderChar(f,h,g,ne,w,-k/2,0,v),h.restore()):(q=p,this._renderChar(f,h,g,ne,w,q,m,v)),w="",y=_,p+=X*k,k=0);h.restore()},_applyPatternGradientTransformText:function(f){var h=s.util.createCanvasElement(),u,p=this.width+this.strokeWidth,m=this.height+this.strokeWidth;return h.width=p,h.height=m,u=h.getContext("2d"),u.beginPath(),u.moveTo(0,0),u.lineTo(p,0),u.lineTo(p,m),u.lineTo(0,m),u.closePath(),u.translate(p/2,m/2),u.fillStyle=f.toLive(u),this._applyPatternGradientTransform(u,f),u.fill(),u.createPattern(h,"no-repeat")},handleFiller:function(f,h,u){var p,m;return u.toLive?u.gradientUnits==="percentage"||u.gradientTransform||u.patternTransform?(p=-this.width/2,m=-this.height/2,f.translate(p,m),f[h]=this._applyPatternGradientTransformText(u),{offsetX:p,offsetY:m}):(f[h]=u.toLive(f,this),this._applyPatternGradientTransform(f,u)):(f[h]=u,{offsetX:0,offsetY:0})},_setStrokeStyles:function(f,h){return f.lineWidth=h.strokeWidth,f.lineCap=this.strokeLineCap,f.lineDashOffset=this.strokeDashOffset,f.lineJoin=this.strokeLineJoin,f.miterLimit=this.strokeMiterLimit,this.handleFiller(f,"strokeStyle",h.stroke)},_setFillStyles:function(f,h){return this.handleFiller(f,"fillStyle",h.fill)},_renderChar:function(f,h,u,p,m,g,v){var x=this._getStyleDeclaration(u,p),y=this.getCompleteStyleDeclaration(u,p),_=f==="fillText"&&y.fill,w=f==="strokeText"&&y.stroke&&y.strokeWidth,T,k;!w&&!_||(h.save(),_&&(T=this._setFillStyles(h,y)),w&&(k=this._setStrokeStyles(h,y)),h.font=this._getFontDeclaration(y),x&&x.textBackgroundColor&&this._removeShadow(h),x&&x.deltaY&&(v+=x.deltaY),_&&h.fillText(m,g-T.offsetX,v-T.offsetY),w&&h.strokeText(m,g-k.offsetX,v-k.offsetY),h.restore())},setSuperscript:function(f,h){return this._setScript(f,h,this.superscript)},setSubscript:function(f,h){return this._setScript(f,h,this.subscript)},_setScript:function(f,h,u){var p=this.get2DCursorLocation(f,!0),m=this.getValueOfPropertyAt(p.lineIndex,p.charIndex,"fontSize"),g=this.getValueOfPropertyAt(p.lineIndex,p.charIndex,"deltaY"),v={fontSize:m*u.size,deltaY:g+m*u.baseline};return this.setSelectionStyles(v,f,h),this},_getLineLeftOffset:function(f){var h=this.getLineWidth(f),u=this.width-h,p=this.textAlign,m=this.direction,v,g=0,v=this.isEndOfWrapping(f);return p==="justify"||p==="justify-center"&&!v||p==="justify-right"&&!v||p==="justify-left"&&!v?0:(p==="center"&&(g=u/2),p==="right"&&(g=u),p==="justify-center"&&(g=u/2),p==="justify-right"&&(g=u),m==="rtl"&&(g-=u),g)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var f=this._forceClearCache;return f||(f=this.hasStateChanged("_dimensionAffectingProps")),f&&(this.dirty=!0,this._forceClearCache=!1),f},getLineWidth:function(f){if(this.__lineWidths[f]!==void 0)return this.__lineWidths[f];var h=this.measureLine(f),u=h.width;return this.__lineWidths[f]=u,u},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(f,h,u){var p=this._getStyleDeclaration(f,h);return p&&typeof p[u]<"u"?p[u]:this[u]},_renderTextDecoration:function(f,h){if(!(!this[h]&&!this.styleHas(h))){f.save(),(h==="overline"||h==="linethrough")&&this._removeShadow(f);for(var u,p,m,g,v,x,y,_,w=this._getLeftOffset(),T=this._getTopOffset(),k,O,F,M,V,X,q,ae,ne=this.path,re=this._getWidthOfCharSpacing(),le=this.offsets[h],se=0,C=this._textLines.length;se<C;se++){if(u=this.getHeightOfLine(se),!this[h]&&!this.styleHas(h,se)){T+=u;continue}y=this._textLines[se],X=u/this.lineHeight,g=this._getLineLeftOffset(se),O=0,F=0,_=this.getValueOfPropertyAt(se,0,h),ae=this.getValueOfPropertyAt(se,0,"fill"),k=T+X*(1-this._fontSizeFraction),p=this.getHeightOfChar(se,0),v=this.getValueOfPropertyAt(se,0,"deltaY");for(var j=0,L=y.length;j<L;j++)if(M=this.__charBounds[se][j],V=this.getValueOfPropertyAt(se,j,h),q=this.getValueOfPropertyAt(se,j,"fill"),m=this.getHeightOfChar(se,j),x=this.getValueOfPropertyAt(se,j,"deltaY"),ne&&V&&q)f.save(),f.fillStyle=ae,f.translate(M.renderLeft,M.renderTop),f.rotate(M.angle),f.fillRect(-M.kernedWidth/2,le*m+x,M.kernedWidth,this.fontSize/15),f.restore();else if((V!==_||q!==ae||m!==p||x!==v)&&F>0){var E=w+g+O;this.direction==="rtl"&&(E=this.width-E-F),_&&ae&&(f.fillStyle=ae,f.fillRect(E,k+le*p+v,F,this.fontSize/15)),O=M.left,F=M.width,_=V,ae=q,p=m,v=x}else F+=M.kernedWidth;var E=w+g+O;this.direction==="rtl"&&(E=this.width-E-F),f.fillStyle=q,V&&q&&f.fillRect(E,k+le*p+v,F-re,this.fontSize/15),T+=u}f.restore()}},_getFontDeclaration:function(f,h){var u=f||this,p=this.fontFamily,m=s.Text.genericFonts.indexOf(p.toLowerCase())>-1,g=p===void 0||p.indexOf("'")>-1||p.indexOf(",")>-1||p.indexOf('"')>-1||m?u.fontFamily:'"'+u.fontFamily+'"';return[s.isLikelyNode?u.fontWeight:u.fontStyle,s.isLikelyNode?u.fontStyle:u.fontWeight,h?this.CACHE_FONT_SIZE+"px":u.fontSize+"px",g].join(" ")},render:function(f){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",f)))},_splitTextIntoLines:function(f){for(var h=f.split(this._reNewline),u=new Array(h.length),p=[`
`],m=[],g=0;g<h.length;g++)u[g]=s.util.string.graphemeSplit(h[g]),m=m.concat(u[g],p);return m.pop(),{_unwrappedLines:u,lines:h,graphemeText:m,graphemeLines:u}},toObject:function(f){var h=d.concat(f),u=this.callSuper("toObject",h);return u.styles=s.util.stylesToArray(this.styles,this.text),u.path&&(u.path=this.path.toObject()),u},set:function(f,h){this.callSuper("set",f,h);var u=!1,p=!1;if(typeof f=="object")for(var m in f)m==="path"&&this.setPathInfo(),u=u||this._dimensionAffectingProps.indexOf(m)!==-1,p=p||m==="path";else u=this._dimensionAffectingProps.indexOf(f)!==-1,p=f==="path";return p&&this.setPathInfo(),u&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),s.Text.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),s.Text.DEFAULT_SVG_FONT_SIZE=16,s.Text.fromElement=function(f,h,u){if(!f)return h(null);var p=s.parseAttributes(f,s.Text.ATTRIBUTE_NAMES),m=p.textAnchor||"left";if(u=s.util.object.extend(u?c(u):{},p),u.top=u.top||0,u.left=u.left||0,p.textDecoration){var g=p.textDecoration;g.indexOf("underline")!==-1&&(u.underline=!0),g.indexOf("overline")!==-1&&(u.overline=!0),g.indexOf("line-through")!==-1&&(u.linethrough=!0),delete u.textDecoration}"dx"in p&&(u.left+=p.dx),"dy"in p&&(u.top+=p.dy),"fontSize"in u||(u.fontSize=s.Text.DEFAULT_SVG_FONT_SIZE);var v="";"textContent"in f?v=f.textContent:"firstChild"in f&&f.firstChild!==null&&"data"in f.firstChild&&f.firstChild.data!==null&&(v=f.firstChild.data),v=v.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var x=u.strokeWidth;u.strokeWidth=0;var y=new s.Text(v,u),_=y.getScaledHeight()/y.height,w=(y.height+y.strokeWidth)*y.lineHeight-y.height,T=w*_,k=y.getScaledHeight()+T,O=0;m==="center"&&(O=y.getScaledWidth()/2),m==="right"&&(O=y.getScaledWidth()),y.set({left:y.left-O,top:y.top-(k-y.fontSize*(.07+y._fontSizeFraction))/y.lineHeight,strokeWidth:typeof x<"u"?x:1}),h(y)},s.Text.fromObject=function(f,h){var u=c(f),p=f.path;return delete u.path,s.Object._fromObject("Text",u,function(m){m.styles=s.util.stylesFromArray(f.styles,f.text),p?s.Object._fromObject("Path",p,function(g){m.set("path",g),h(m)},"path"):h(m)},"text")},s.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],s.util.createAccessors&&s.util.createAccessors(s.Text)}(e),function(){t.util.object.extend(t.Text.prototype,{isEmptyStyles:function(o){if(!this.styles||typeof o<"u"&&!this.styles[o])return!0;var s=typeof o>"u"?this.styles:{line:this.styles[o]};for(var c in s)for(var d in s[c])for(var f in s[c][d])return!1;return!0},styleHas:function(o,s){if(!this.styles||!o||o===""||typeof s<"u"&&!this.styles[s])return!1;var c=typeof s>"u"?this.styles:{0:this.styles[s]};for(var d in c)for(var f in c[d])if(typeof c[d][f][o]<"u")return!0;return!1},cleanStyle:function(o){if(!this.styles||!o||o==="")return!1;var s=this.styles,c=0,d,f,h=!0,u=0,p;for(var m in s){d=0;for(var g in s[m]){var p=s[m][g],v=p.hasOwnProperty(o);c++,v?(f?p[o]!==f&&(h=!1):f=p[o],p[o]===this[o]&&delete p[o]):h=!1,Object.keys(p).length!==0?d++:delete s[m][g]}d===0&&delete s[m]}for(var x=0;x<this._textLines.length;x++)u+=this._textLines[x].length;h&&c===u&&(this[o]=f,this.removeStyle(o))},removeStyle:function(o){if(!(!this.styles||!o||o==="")){var s=this.styles,c,d,f;for(d in s){c=s[d];for(f in c)delete c[f][o],Object.keys(c[f]).length===0&&delete c[f];Object.keys(c).length===0&&delete s[d]}}},_extendStyles:function(o,s){var c=this.get2DCursorLocation(o);this._getLineStyle(c.lineIndex)||this._setLineStyle(c.lineIndex),this._getStyleDeclaration(c.lineIndex,c.charIndex)||this._setStyleDeclaration(c.lineIndex,c.charIndex,{}),t.util.object.extend(this._getStyleDeclaration(c.lineIndex,c.charIndex),s)},get2DCursorLocation:function(o,s){typeof o>"u"&&(o=this.selectionStart);for(var c=s?this._unwrappedTextLines:this._textLines,d=c.length,f=0;f<d;f++){if(o<=c[f].length)return{lineIndex:f,charIndex:o};o-=c[f].length+this.missingNewlineOffset(f,s)}return{lineIndex:f-1,charIndex:c[f-1].length<o?c[f-1].length:o}},getSelectionStyles:function(o,s,c){typeof o>"u"&&(o=this.selectionStart||0),typeof s>"u"&&(s=this.selectionEnd||o);for(var d=[],f=o;f<s;f++)d.push(this.getStyleAtPosition(f,c));return d},getStyleAtPosition:function(o,s){var c=this.get2DCursorLocation(o),d=s?this.getCompleteStyleDeclaration(c.lineIndex,c.charIndex):this._getStyleDeclaration(c.lineIndex,c.charIndex);return d||{}},setSelectionStyles:function(o,s,c){typeof s>"u"&&(s=this.selectionStart||0),typeof c>"u"&&(c=this.selectionEnd||s);for(var d=s;d<c;d++)this._extendStyles(d,o);return this._forceClearCache=!0,this},_getStyleDeclaration:function(o,s){var c=this.styles&&this.styles[o];return c?c[s]:null},getCompleteStyleDeclaration:function(o,s){for(var c=this._getStyleDeclaration(o,s)||{},d={},f,h=0;h<this._styleProperties.length;h++)f=this._styleProperties[h],d[f]=typeof c[f]>"u"?this[f]:c[f];return d},_setStyleDeclaration:function(o,s,c){this.styles[o][s]=c},_deleteStyleDeclaration:function(o,s){delete this.styles[o][s]},_getLineStyle:function(o){return!!this.styles[o]},_setLineStyle:function(o){this.styles[o]={}},_deleteLineStyle:function(o){delete this.styles[o]}})}(),function(){function o(s){s.textDecoration&&(s.textDecoration.indexOf("underline")>-1&&(s.underline=!0),s.textDecoration.indexOf("line-through")>-1&&(s.linethrough=!0),s.textDecoration.indexOf("overline")>-1&&(s.overline=!0),delete s.textDecoration)}t.IText=t.util.createClass(t.Text,t.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(s,c){this.callSuper("initialize",s,c),this.initBehavior()},setSelectionStart:function(s){s=Math.max(s,0),this._updateAndFire("selectionStart",s)},setSelectionEnd:function(s){s=Math.min(s,this.text.length),this._updateAndFire("selectionEnd",s)},_updateAndFire:function(s,c){this[s]!==c&&(this._fireSelectionChanged(),this[s]=c),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(s){this.clearContextTop(),this.callSuper("render",s),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(s){this.callSuper("_render",s)},clearContextTop:function(s){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var c=this.canvas.contextTop,d=this.canvas.viewportTransform;c.save(),c.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this.transform(c),this._clearTextArea(c),s||c.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var s=this._getCursorBoundaries(),c=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(s,c):this.renderSelection(s,c),c.restore()}},_clearTextArea:function(s){var c=this.width+4,d=this.height+4;s.clearRect(-c/2,-d/2,c,d)},_getCursorBoundaries:function(s){typeof s>"u"&&(s=this.selectionStart);var c=this._getLeftOffset(),d=this._getTopOffset(),f=this._getCursorBoundariesOffsets(s);return{left:c,top:d,leftOffset:f.left,topOffset:f.top}},_getCursorBoundariesOffsets:function(s){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var c,d,f,h=0,u=0,p,m=this.get2DCursorLocation(s);f=m.charIndex,d=m.lineIndex;for(var g=0;g<d;g++)h+=this.getHeightOfLine(g);c=this._getLineLeftOffset(d);var v=this.__charBounds[d][f];return v&&(u=v.left),this.charSpacing!==0&&f===this._textLines[d].length&&(u-=this._getWidthOfCharSpacing()),p={top:h,left:c+(u>0?u:0)},this.direction==="rtl"&&(p.left*=-1),this.cursorOffsetCache=p,this.cursorOffsetCache},renderCursor:function(s,c){var d=this.get2DCursorLocation(),f=d.lineIndex,h=d.charIndex>0?d.charIndex-1:0,u=this.getValueOfPropertyAt(f,h,"fontSize"),p=this.scaleX*this.canvas.getZoom(),m=this.cursorWidth/p,g=s.topOffset,v=this.getValueOfPropertyAt(f,h,"deltaY");g+=(1-this._fontSizeFraction)*this.getHeightOfLine(f)/this.lineHeight-u*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(s,c),c.fillStyle=this.cursorColor||this.getValueOfPropertyAt(f,h,"fill"),c.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,c.fillRect(s.left+s.leftOffset-m/2,g+s.top+v,m,u)},renderSelection:function(s,c){for(var d=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,f=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,h=this.textAlign.indexOf("justify")!==-1,u=this.get2DCursorLocation(d),p=this.get2DCursorLocation(f),m=u.lineIndex,g=p.lineIndex,v=u.charIndex<0?0:u.charIndex,x=p.charIndex<0?0:p.charIndex,y=m;y<=g;y++){var _=this._getLineLeftOffset(y)||0,w=this.getHeightOfLine(y),T=0,k=0,O=0;if(y===m&&(k=this.__charBounds[m][v].left),y>=m&&y<g)O=h&&!this.isEndOfWrapping(y)?this.width:this.getLineWidth(y)||5;else if(y===g)if(x===0)O=this.__charBounds[g][x].left;else{var F=this._getWidthOfCharSpacing();O=this.__charBounds[g][x-1].left+this.__charBounds[g][x-1].width-F}T=w,(this.lineHeight<1||y===g&&this.lineHeight>1)&&(w/=this.lineHeight);var M=s.left+_+k,V=O-k,X=w,q=0;this.inCompositionMode?(c.fillStyle=this.compositionColor||"black",X=1,q=w):c.fillStyle=this.selectionColor,this.direction==="rtl"&&(M=this.width-M-V),c.fillRect(M,s.top+s.topOffset+q,V,X),s.topOffset+=T}},getCurrentCharFontSize:function(){var s=this._getCurrentCharIndex();return this.getValueOfPropertyAt(s.l,s.c,"fontSize")},getCurrentCharColor:function(){var s=this._getCurrentCharIndex();return this.getValueOfPropertyAt(s.l,s.c,"fill")},_getCurrentCharIndex:function(){var s=this.get2DCursorLocation(this.selectionStart,!0),c=s.charIndex>0?s.charIndex-1:0;return{l:s.lineIndex,c}}}),t.IText.fromObject=function(s,c){var d=t.util.stylesFromArray(s.styles,s.text),f=Object.assign({},s,{styles:d});if(delete f.path,o(f),f.styles)for(var h in f.styles)for(var u in f.styles[h])o(f.styles[h][u]);t.Object._fromObject("IText",f,function(p){s.path?t.Object._fromObject("Path",s.path,function(m){p.set("path",m),c(p)},"path"):c(p)},"text")}}(),function(){var o=t.util.object.clone;t.util.object.extend(t.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var s=this;this.on("added",function(){var c=s.canvas;c&&(c._hasITextHandlers||(c._hasITextHandlers=!0,s._initCanvasHandlers(c)),c._iTextInstances=c._iTextInstances||[],c._iTextInstances.push(s))})},initRemovedHandler:function(){var s=this;this.on("removed",function(){var c=s.canvas;c&&(c._iTextInstances=c._iTextInstances||[],t.util.removeFromArray(c._iTextInstances,s),c._iTextInstances.length===0&&(c._hasITextHandlers=!1,s._removeCanvasHandlers(c)))})},_initCanvasHandlers:function(s){s._mouseUpITextHandler=function(){s._iTextInstances&&s._iTextInstances.forEach(function(c){c.__isMousedown=!1})},s.on("mouse:up",s._mouseUpITextHandler)},_removeCanvasHandlers:function(s){s.off("mouse:up",s._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(s,c,d,f){var h;return h={isAborted:!1,abort:function(){this.isAborted=!0}},s.animate("_currentCursorOpacity",c,{duration:d,onComplete:function(){h.isAborted||s[f]()},onChange:function(){s.canvas&&s.selectionStart===s.selectionEnd&&s.renderCursorOrSelection()},abort:function(){return h.isAborted}}),h},_onTickComplete:function(){var s=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){s._currentTickCompleteState=s._animateCursor(s,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(s){var c=this,d=s?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){c._tick()},d)},abortCursorAnimation:function(){var s=this._currentTickState||this._currentTickCompleteState,c=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,s&&c&&c.clearContext(c.contextTop||c.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(s){var c=0,d=s-1;if(this._reSpace.test(this._text[d]))for(;this._reSpace.test(this._text[d]);)c++,d--;for(;/\S/.test(this._text[d])&&d>-1;)c++,d--;return s-c},findWordBoundaryRight:function(s){var c=0,d=s;if(this._reSpace.test(this._text[d]))for(;this._reSpace.test(this._text[d]);)c++,d++;for(;/\S/.test(this._text[d])&&d<this._text.length;)c++,d++;return s+c},findLineBoundaryLeft:function(s){for(var c=0,d=s-1;!/\n/.test(this._text[d])&&d>-1;)c++,d--;return s-c},findLineBoundaryRight:function(s){for(var c=0,d=s;!/\n/.test(this._text[d])&&d<this._text.length;)c++,d++;return s+c},searchWordBoundary:function(s,c){for(var d=this._text,f=this._reSpace.test(d[s])?s-1:s,h=d[f],u=t.reNonWord;!u.test(h)&&f>0&&f<d.length;)f+=c,h=d[f];return u.test(h)&&(f+=c===1?0:1),f},selectWord:function(s){s=s||this.selectionStart;var c=this.searchWordBoundary(s,-1),d=this.searchWordBoundary(s,1);this.selectionStart=c,this.selectionEnd=d,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(s){s=s||this.selectionStart;var c=this.findLineBoundaryLeft(s),d=this.findLineBoundaryRight(s);return this.selectionStart=c,this.selectionEnd=d,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(s){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(s),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(s){s._iTextInstances&&s._iTextInstances.forEach(function(c){c.selected=!1,c.isEditing&&c.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(s){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var c=this.getSelectionStartFromPointer(s.e),d=this.selectionStart,f=this.selectionEnd;(c!==this.__selectionStartOnMouseDown||d===f)&&(d===c||f===c)||(c>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=c):(this.selectionStart=c,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==d||this.selectionEnd!==f)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(s,c,d){var f=d.slice(0,s),h=t.util.string.graphemeSplit(f).length;if(s===c)return{selectionStart:h,selectionEnd:h};var u=d.slice(s,c),p=t.util.string.graphemeSplit(u).length;return{selectionStart:h,selectionEnd:h+p}},fromGraphemeToStringSelection:function(s,c,d){var f=d.slice(0,s),h=f.join("").length;if(s===c)return{selectionStart:h,selectionEnd:h};var u=d.slice(s,c),p=u.join("").length;return{selectionStart:h,selectionEnd:h+p}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var s=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=s.selectionStart,this.hiddenTextarea.selectionEnd=s.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var s=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=s.selectionEnd,this.inCompositionMode||(this.selectionStart=s.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var s=this._calcTextareaPosition();this.hiddenTextarea.style.left=s.left,this.hiddenTextarea.style.top=s.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var s=this.inCompositionMode?this.compositionStart:this.selectionStart,c=this._getCursorBoundaries(s),d=this.get2DCursorLocation(s),f=d.lineIndex,h=d.charIndex,u=this.getValueOfPropertyAt(f,h,"fontSize")*this.lineHeight,p=c.leftOffset,m=this.calcTransformMatrix(),g={x:c.left+p,y:c.top+c.topOffset+u},v=this.canvas.getRetinaScaling(),x=this.canvas.upperCanvasEl,y=x.width/v,_=x.height/v,w=y-u,T=_-u,k=x.clientWidth/y,O=x.clientHeight/_;return g=t.util.transformPoint(g,m),g=t.util.transformPoint(g,this.canvas.viewportTransform),g.x*=k,g.y*=O,g.x<0&&(g.x=0),g.x>w&&(g.x=w),g.y<0&&(g.y=0),g.y>T&&(g.y=T),g.x+=this.canvas._offset.left,g.y+=this.canvas._offset.top,{left:g.x+"px",top:g.y+"px",fontSize:u+"px",charHeight:u}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var s=this._textBeforeEdit!==this.text,c=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,c&&(c.blur&&c.blur(),c.parentNode&&c.parentNode.removeChild(c)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),s&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),s&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var s in this.styles)this._textLines[s]||delete this.styles[s]},removeStyleFromTo:function(s,c){var d=this.get2DCursorLocation(s,!0),f=this.get2DCursorLocation(c,!0),h=d.lineIndex,u=d.charIndex,p=f.lineIndex,m=f.charIndex,g,v;if(h!==p){if(this.styles[h])for(g=u;g<this._unwrappedTextLines[h].length;g++)delete this.styles[h][g];if(this.styles[p])for(g=m;g<this._unwrappedTextLines[p].length;g++)v=this.styles[p][g],v&&(this.styles[h]||(this.styles[h]={}),this.styles[h][u+g-m]=v);for(g=h+1;g<=p;g++)delete this.styles[g];this.shiftLineStyles(p,h-p)}else if(this.styles[h]){v=this.styles[h];var x=m-u,y,_;for(g=u;g<m;g++)delete v[g];for(_ in this.styles[h])y=parseInt(_,10),y>=m&&(v[y-x]=v[_],delete v[_])}},shiftLineStyles:function(s,c){var d=o(this.styles);for(var f in this.styles){var h=parseInt(f,10);h>s&&(this.styles[h+c]=d[h],d[h-c]||delete this.styles[h])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(s,c,d,f){var h,u={},p=!1,m=this._unwrappedTextLines[s].length,g=m===c;d||(d=1),this.shiftLineStyles(s,d),this.styles[s]&&(h=this.styles[s][c===0?c:c-1]);for(var v in this.styles[s]){var x=parseInt(v,10);x>=c&&(p=!0,u[x-c]=this.styles[s][v],g&&c===0||delete this.styles[s][v])}var y=!1;for(p&&!g&&(this.styles[s+d]=u,y=!0),(y||m>c)&&d--;d>0;)f&&f[d-1]?this.styles[s+d]={0:o(f[d-1])}:h?this.styles[s+d]={0:o(h)}:delete this.styles[s+d],d--;this._forceClearCache=!0},insertCharStyleObject:function(s,c,d,f){this.styles||(this.styles={});var h=this.styles[s],u=h?o(h):{};d||(d=1);for(var p in u){var m=parseInt(p,10);m>=c&&(h[m+d]=u[m],u[m-d]||delete h[m])}if(this._forceClearCache=!0,f){for(;d--;)Object.keys(f[d]).length&&(this.styles[s]||(this.styles[s]={}),this.styles[s][c+d]=o(f[d]));return}if(h)for(var g=h[c?c-1:1];g&&d--;)this.styles[s][c+d]=o(g)},insertNewStyleBlock:function(s,c,d){for(var f=this.get2DCursorLocation(c,!0),h=[0],u=0,p=0;p<s.length;p++)s[p]===`
`?(u++,h[u]=0):h[u]++;h[0]>0&&(this.insertCharStyleObject(f.lineIndex,f.charIndex,h[0],d),d=d&&d.slice(h[0]+1)),u&&this.insertNewlineStyleObject(f.lineIndex,f.charIndex+h[0],u);for(var p=1;p<u;p++)h[p]>0?this.insertCharStyleObject(f.lineIndex+p,0,h[p],d):d&&this.styles[f.lineIndex+p]&&d[0]&&(this.styles[f.lineIndex+p][0]=d[0]),d=d&&d.slice(h[p]+1);h[p]>0&&this.insertCharStyleObject(f.lineIndex+p,0,h[p],d)},setSelectionStartEndWithShift:function(s,c,d){d<=s?(c===s?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=s),this.selectionStart=d):d>s&&d<c?this._selectionDirection==="right"?this.selectionEnd=d:this.selectionStart=d:(c===s?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=c),this.selectionEnd=d)},setSelectionInBoundaries:function(){var s=this.text.length;this.selectionStart>s?this.selectionStart=s:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>s?this.selectionEnd=s:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),t.util.object.extend(t.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(o){if(this.canvas){this.__newClickTime=+new Date;var s=o.pointer;this.isTripleClick(s)&&(this.fire("tripleclick",o),this._stopEvent(o.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=s,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(o){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===o.x&&this.__lastPointer.y===o.y},_stopEvent:function(o){o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(o){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(o.e))},tripleClickHandler:function(o){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(o.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(o){!this.canvas||!this.editable||o.e.button&&o.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(o.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(o){!this.canvas||!this.editable||o.e.button&&o.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(o){if(this.__isMousedown=!1,!(!this.editable||this.group||o.transform&&o.transform.actionPerformed||o.e.button&&o.e.button!==1)){if(this.canvas){var s=this.canvas._activeObject;if(s&&s!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(o.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(o){var s=this.getSelectionStartFromPointer(o),c=this.selectionStart,d=this.selectionEnd;o.shiftKey?this.setSelectionStartEndWithShift(c,d,s):(this.selectionStart=s,this.selectionEnd=s),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(o){for(var s=this.getLocalPointer(o),c=0,d=0,f=0,h=0,u=0,p,m,g=0,v=this._textLines.length;g<v&&f<=s.y;g++)f+=this.getHeightOfLine(g)*this.scaleY,u=g,g>0&&(h+=this._textLines[g-1].length+this.missingNewlineOffset(g-1));p=this._getLineLeftOffset(u),d=p*this.scaleX,m=this._textLines[u],this.direction==="rtl"&&(s.x=this.width*this.scaleX-s.x+d);for(var x=0,y=m.length;x<y&&(c=d,d+=this.__charBounds[u][x].kernedWidth*this.scaleX,d<=s.x);x++)h++;return this._getNewSelectionStartFromOffset(s,c,d,h,y)},_getNewSelectionStartFromOffset:function(o,s,c,d,f){var h=o.x-s,u=c-o.x,p=u>h||u<0?0:1,m=d+p;return this.flipX&&(m=f-m),m>this._text.length&&(m=this._text.length),m}}),t.util.object.extend(t.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=t.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var o=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+o.top+"; left: "+o.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+o.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):t.document.body.appendChild(this.hiddenTextarea),t.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),t.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),t.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),t.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(t.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(o){if(this.isEditing){var s=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(o.keyCode in s)this[s[o.keyCode]](o);else if(o.keyCode in this.ctrlKeysMapDown&&(o.ctrlKey||o.metaKey))this[this.ctrlKeysMapDown[o.keyCode]](o);else return;o.stopImmediatePropagation(),o.preventDefault(),o.keyCode>=33&&o.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(o){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(o.keyCode in this.ctrlKeysMapUp&&(o.ctrlKey||o.metaKey))this[this.ctrlKeysMapUp[o.keyCode]](o);else return;o.stopImmediatePropagation(),o.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(o){var s=this.fromPaste;if(this.fromPaste=!1,o&&o.stopPropagation(),!!this.isEditing){var c=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,d=this._text.length,f=c.length,h,u,p=f-d,m=this.selectionStart,g=this.selectionEnd,v=m!==g,x,y,_;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var w=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),T=m>w.selectionStart;v?(h=this._text.slice(m,g),p+=g-m):f<d&&(T?h=this._text.slice(g+p,g):h=this._text.slice(m,m-p)),u=c.slice(w.selectionEnd-p,w.selectionEnd),h&&h.length&&(u.length&&(x=this.getSelectionStyles(m,m+1,!1),x=u.map(function(){return x[0]})),v?(y=m,_=g):T?(y=g-h.length,_=g):(y=g,_=g+h.length),this.removeStyleFromTo(y,_)),u.length&&(s&&u.join("")===t.copiedText&&!t.disableStyleCopyPaste&&(x=t.copiedTextStyle),this.insertNewStyleBlock(u,m,x)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(o){this.compositionStart=o.target.selectionStart,this.compositionEnd=o.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(t.copiedText=this.getSelectedText(),t.disableStyleCopyPaste?t.copiedTextStyle=null:t.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(o){return o&&o.clipboardData||t.window.clipboardData},_getWidthBeforeCursor:function(o,s){var c=this._getLineLeftOffset(o),d;return s>0&&(d=this.__charBounds[o][s-1],c+=d.left+d.width),c},getDownCursorOffset:function(o,s){var c=this._getSelectionForOffset(o,s),d=this.get2DCursorLocation(c),f=d.lineIndex;if(f===this._textLines.length-1||o.metaKey||o.keyCode===34)return this._text.length-c;var h=d.charIndex,u=this._getWidthBeforeCursor(f,h),p=this._getIndexOnLine(f+1,u),m=this._textLines[f].slice(h);return m.length+p+1+this.missingNewlineOffset(f)},_getSelectionForOffset:function(o,s){return o.shiftKey&&this.selectionStart!==this.selectionEnd&&s?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(o,s){var c=this._getSelectionForOffset(o,s),d=this.get2DCursorLocation(c),f=d.lineIndex;if(f===0||o.metaKey||o.keyCode===33)return-c;var h=d.charIndex,u=this._getWidthBeforeCursor(f,h),p=this._getIndexOnLine(f-1,u),m=this._textLines[f].slice(0,h),g=this.missingNewlineOffset(f-1);return-this._textLines[f-1].length+p-m.length+(1-g)},_getIndexOnLine:function(o,s){for(var c=this._textLines[o],d=this._getLineLeftOffset(o),f=d,h=0,u,p,m=0,g=c.length;m<g;m++)if(u=this.__charBounds[o][m].width,f+=u,f>s){p=!0;var v=f-u,x=f,y=Math.abs(v-s),_=Math.abs(x-s);h=_<y?m:m-1;break}return p||(h=c.length-1),h},moveCursorDown:function(o){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",o)},moveCursorUp:function(o){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",o)},_moveCursorUpOrDown:function(o,s){var c="get"+o+"CursorOffset",d=this[c](s,this._selectionDirection==="right");s.shiftKey?this.moveCursorWithShift(d):this.moveCursorWithoutShift(d),d!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(o){var s=this._selectionDirection==="left"?this.selectionStart+o:this.selectionEnd+o;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,s),o!==0},moveCursorWithoutShift:function(o){return o<0?(this.selectionStart+=o,this.selectionEnd=this.selectionStart):(this.selectionEnd+=o,this.selectionStart=this.selectionEnd),o!==0},moveCursorLeft:function(o){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",o)},_move:function(o,s,c){var d;if(o.altKey)d=this["findWordBoundary"+c](this[s]);else if(o.metaKey||o.keyCode===35||o.keyCode===36)d=this["findLineBoundary"+c](this[s]);else return this[s]+=c==="Left"?-1:1,!0;if(typeof d<"u"&&this[s]!==d)return this[s]=d,!0},_moveLeft:function(o,s){return this._move(o,s,"Left")},_moveRight:function(o,s){return this._move(o,s,"Right")},moveCursorLeftWithoutShift:function(o){var s=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(s=this._moveLeft(o,"selectionStart")),this.selectionEnd=this.selectionStart,s},moveCursorLeftWithShift:function(o){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(o,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(o,"selectionStart")},moveCursorRight:function(o){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",o)},_moveCursorLeftOrRight:function(o,s){var c="moveCursor"+o+"With";this._currentCursorOpacity=1,s.shiftKey?c+="Shift":c+="outShift",this[c](s)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(o){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(o,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(o,"selectionEnd")},moveCursorRightWithoutShift:function(o){var s=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(s=this._moveRight(o,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,s},removeChars:function(o,s){typeof s>"u"&&(s=o+1),this.removeStyleFromTo(o,s),this._text.splice(o,s-o),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(o,s,c,d){typeof d>"u"&&(d=c),d>c&&this.removeStyleFromTo(c,d);var f=t.util.string.graphemeSplit(o);this.insertNewStyleBlock(f,c,s),this._text=[].concat(this._text.slice(0,c),f,this._text.slice(d)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var o=t.util.toFixed,s=t.util.radiansToDegrees,c=t.util.calcRotateMatrix,d=t.util.transformPoint,f=/  +/g;t.util.object.extend(t.Text.prototype,{_toSVG:function(){var h=this._getSVGLeftTopOffsets(),u=this._getSVGTextAndBg(h.textTop,h.textLeft);return this._wrapSVGTextAndBg(u)},toSVG:function(h){var u=this._createBaseSVGMarkup(this._toSVG(),{reviver:h,noStyle:!0,withShadow:!0}),p=this.path;return p?u+p._createBaseSVGMarkup(p._toSVG(),{reviver:h,withShadow:!0}):u},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(h){var u=!0,p=this.getSvgTextDecoration(this);return[h.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",p?'text-decoration="'+p+'" ':"",'style="',this.getSvgStyles(u),'"',this.addPaintOrder()," >",h.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(h,u){var p=[],m=[],g=h,v;this._setSVGBg(m);for(var x=0,y=this._textLines.length;x<y;x++)v=this._getLineLeftOffset(x),(this.textBackgroundColor||this.styleHas("textBackgroundColor",x))&&this._setSVGTextLineBg(m,x,u+v,g),this._setSVGTextLineText(p,x,u+v,g),g+=this.getHeightOfLine(x);return{textSpans:p,textBgRects:m}},_createTextCharSpan:function(h,u,p,m,g){var v=h!==h.trim()||h.match(f),x=this.getSvgSpanStyles(u,v),y=x?'style="'+x+'"':"",_=u.deltaY,w="",T=t.Object.NUM_FRACTION_DIGITS,k="";if(_&&(w=' dy="'+o(_,T)+'" '),g.renderLeft!==void 0){var O=g.angle;k=' rotate="'+o(s(O),t.Object.NUM_FRACTION_DIGITS)+'" ';var F=g.width/2,M=c({angle:s(O)});M[4]=g.renderLeft,M[5]=g.renderTop;var V=d({x:-F,y:0},M);p=V.x,m=V.y}return['<tspan x="',o(p,T),'" y="',o(m,T),'" ',w,y,k,">",t.util.string.escapeXml(h),"</tspan>"].join("")},_setSVGTextLineText:function(h,u,p,m){var g=this.getHeightOfLine(u),v=this.textAlign.indexOf("justify")!==-1,x,y,_="",w,T,k=0,O=this._textLines[u],F;m+=g*(1-this._fontSizeFraction)/this.lineHeight;for(var M=0,V=O.length-1;M<=V;M++)F=M===V||this.charSpacing||this.path,_+=O[M],w=this.__charBounds[u][M],k===0?(p+=w.kernedWidth-w.width,k+=w.width):k+=w.kernedWidth,v&&!F&&this._reSpaceAndTab.test(O[M])&&(F=!0),F||(x=x||this.getCompleteStyleDeclaration(u,M),y=this.getCompleteStyleDeclaration(u,M+1),F=t.util.hasStyleChanged(x,y,!0)),F&&(T=this._getStyleDeclaration(u,M)||{},h.push(this._createTextCharSpan(_,T,p,m,w)),_="",x=y,p+=k,k=0)},_pushTextBgRect:function(h,u,p,m,g,v){var x=t.Object.NUM_FRACTION_DIGITS;h.push("		<rect ",this._getFillAttributes(u),' x="',o(p,x),'" y="',o(m,x),'" width="',o(g,x),'" height="',o(v,x),`"></rect>
`)},_setSVGTextLineBg:function(h,u,p,m){for(var g=this._textLines[u],v=this.getHeightOfLine(u)/this.lineHeight,x=0,y=0,_,w,T=this.getValueOfPropertyAt(u,0,"textBackgroundColor"),k=0,O=g.length;k<O;k++)_=this.__charBounds[u][k],w=this.getValueOfPropertyAt(u,k,"textBackgroundColor"),w!==T?(T&&this._pushTextBgRect(h,T,p+y,m,x,v),y=_.left,x=_.width,T=w):x+=_.kernedWidth;w&&this._pushTextBgRect(h,w,p+y,m,x,v)},_getFillAttributes:function(h){var u=h&&typeof h=="string"?new t.Color(h):"";return!u||!u.getSource()||u.getAlpha()===1?'fill="'+h+'"':'opacity="'+u.getAlpha()+'" fill="'+u.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(h){for(var u=0,p=0,m=0;m<h;m++)u+=this.getHeightOfLine(m);return p=this.getHeightOfLine(m),{lineTop:u,offset:(this._fontSizeMult-this._fontSizeFraction)*p/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(h){var u=t.Object.prototype.getSvgStyles.call(this,h);return u+" white-space: pre;"}})}(),function(o){var s=o.fabric||(o.fabric={});s.Textbox=s.util.createClass(s.IText,s.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:s.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(c){for(var d=0,f=0,h=0,u={},p=0;p<c.graphemeLines.length;p++)c.graphemeText[h]===`
`&&p>0?(f=0,h++,d++):!this.splitByGrapheme&&this._reSpaceAndTab.test(c.graphemeText[h])&&p>0&&(f++,h++),u[p]={line:d,offset:f},h+=c.graphemeLines[p].length,f+=c.graphemeLines[p].length;return u},styleHas:function(c,d){if(this._styleMap&&!this.isWrapping){var f=this._styleMap[d];f&&(d=f.line)}return s.Text.prototype.styleHas.call(this,c,d)},isEmptyStyles:function(c){if(!this.styles)return!0;var d=0,f=c+1,h,u,p=!1,m=this._styleMap[c],g=this._styleMap[c+1];m&&(c=m.line,d=m.offset),g&&(f=g.line,p=f===c,h=g.offset),u=typeof c>"u"?this.styles:{line:this.styles[c]};for(var v in u)for(var x in u[v])if(x>=d&&(!p||x<h))for(var y in u[v][x])return!1;return!0},_getStyleDeclaration:function(c,d){if(this._styleMap&&!this.isWrapping){var f=this._styleMap[c];if(!f)return null;c=f.line,d=f.offset+d}return this.callSuper("_getStyleDeclaration",c,d)},_setStyleDeclaration:function(c,d,f){var h=this._styleMap[c];c=h.line,d=h.offset+d,this.styles[c][d]=f},_deleteStyleDeclaration:function(c,d){var f=this._styleMap[c];c=f.line,d=f.offset+d,delete this.styles[c][d]},_getLineStyle:function(c){var d=this._styleMap[c];return!!this.styles[d.line]},_setLineStyle:function(c){var d=this._styleMap[c];this.styles[d.line]={}},_wrapText:function(c,d){var f=[],h;for(this.isWrapping=!0,h=0;h<c.length;h++)f=f.concat(this._wrapLine(c[h],h,d));return this.isWrapping=!1,f},_measureWord:function(c,d,f){var h=0,u,p=!0;f=f||0;for(var m=0,g=c.length;m<g;m++){var v=this._getGraphemeBox(c[m],d,m+f,u,p);h+=v.kernedWidth,u=c[m]}return h},_wrapLine:function(c,d,f,M){var u=0,p=this.splitByGrapheme,m=[],g=[],v=p?s.util.string.graphemeSplit(c):c.split(this._wordJoiners),x="",y=0,_=p?"":" ",w=0,T=0,k=0,O=!0,F=this._getWidthOfCharSpacing(),M=M||0;v.length===0&&v.push([]),f-=M;for(var V=0;V<v.length;V++)x=p?v[V]:s.util.string.graphemeSplit(v[V]),w=this._measureWord(x,d,y),y+=x.length,u+=T+w-F,u>f&&!O?(m.push(g),g=[],u=w,O=!0):u+=F,!O&&!p&&g.push(_),g=g.concat(x),T=p?0:this._measureWord([_],d,y),y++,O=!1,w>k&&(k=w);return V&&m.push(g),k+M>this.dynamicMinWidth&&(this.dynamicMinWidth=k-F+M),m},isEndOfWrapping:function(c){return!this._styleMap[c+1]||this._styleMap[c+1].line!==this._styleMap[c].line},missingNewlineOffset:function(c,d){return this.splitByGrapheme&&!d?this.isEndOfWrapping(c)?1:0:1},_splitTextIntoLines:function(c){for(var d=s.Text.prototype._splitTextIntoLines.call(this,c),f=this._wrapText(d.lines,this.width),h=new Array(f.length),u=0;u<f.length;u++)h[u]=f[u].join("");return d.lines=h,d.graphemeLines=f,d},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var c={};for(var d in this._styleMap)this._textLines[d]&&(c[this._styleMap[d].line]=1);for(var d in this.styles)c[d]||delete this.styles[d]},toObject:function(c){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(c))}}),s.Textbox.fromObject=function(c,d){var f=s.util.stylesFromArray(c.styles,c.text),h=Object.assign({},c,{styles:f});return delete h.path,s.Object._fromObject("Textbox",h,function(u){c.path?s.Object._fromObject("Path",c.path,function(p){u.set("path",p),d(u)},"path"):d(u)},"text")}}(e),function(){var o=t.controlsUtils,s=o.scaleSkewCursorStyleHandler,c=o.scaleCursorStyleHandler,d=o.scalingEqually,f=o.scalingYOrSkewingX,h=o.scalingXOrSkewingY,u=o.scaleOrSkewActionName,p=t.Object.prototype.controls;if(p.ml=new t.Control({x:-.5,y:0,cursorStyleHandler:s,actionHandler:h,getActionName:u}),p.mr=new t.Control({x:.5,y:0,cursorStyleHandler:s,actionHandler:h,getActionName:u}),p.mb=new t.Control({x:0,y:.5,cursorStyleHandler:s,actionHandler:f,getActionName:u}),p.mt=new t.Control({x:0,y:-.5,cursorStyleHandler:s,actionHandler:f,getActionName:u}),p.tl=new t.Control({x:-.5,y:-.5,cursorStyleHandler:c,actionHandler:d}),p.tr=new t.Control({x:.5,y:-.5,cursorStyleHandler:c,actionHandler:d}),p.bl=new t.Control({x:-.5,y:.5,cursorStyleHandler:c,actionHandler:d}),p.br=new t.Control({x:.5,y:.5,cursorStyleHandler:c,actionHandler:d}),p.mtr=new t.Control({x:0,y:-.5,actionHandler:o.rotationWithSnapping,cursorStyleHandler:o.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),t.Textbox){var m=t.Textbox.prototype.controls={};m.mtr=p.mtr,m.tr=p.tr,m.br=p.br,m.tl=p.tl,m.bl=p.bl,m.mt=p.mt,m.mb=p.mb,m.mr=new t.Control({x:.5,y:0,actionHandler:o.changeWidth,cursorStyleHandler:s,actionName:"resizing"}),m.ml=new t.Control({x:-.5,y:0,actionHandler:o.changeWidth,cursorStyleHandler:s,actionName:"resizing"})}}()})(Qe);function Fu(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function nb(e,t,r,n){function i(a){return a instanceof r?a:new r(function(l){l(a)})}return new(r||(r=Promise))(function(a,l){function o(d){try{c(n.next(d))}catch(f){l(f)}}function s(d){try{c(n.throw(d))}catch(f){l(f)}}function c(d){d.done?a(d.value):i(d.value).then(o,s)}c((n=n.apply(e,t||[])).next())})}const ib=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class ld extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class ab extends ld{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class mg extends ld{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class vg extends ld{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Bh;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Bh||(Bh={}));class sb{constructor(t,{headers:r={},customFetch:n,region:i=Bh.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=ib(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return nb(this,arguments,void 0,function*(r,n={}){var i;let a,l;try{const{headers:o,method:s,body:c,signal:d,timeout:f}=n;let h={},{region:u}=n;u||(u=this.region);const p=new URL(`${this.url}/${r}`);u&&u!=="any"&&(h["x-region"]=u,p.searchParams.set("forceFunctionRegion",u));let m;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",m=c):typeof c=="string"?(h["Content-Type"]="text/plain",m=c):typeof FormData<"u"&&c instanceof FormData?m=c:(h["Content-Type"]="application/json",m=JSON.stringify(c)):c&&typeof c!="string"&&!(typeof Blob<"u"&&c instanceof Blob)&&!(c instanceof ArrayBuffer)&&!(typeof FormData<"u"&&c instanceof FormData)?m=JSON.stringify(c):m=c;let g=d;f&&(l=new AbortController,a=setTimeout(()=>l.abort(),f),d?(g=l.signal,d.addEventListener("abort",()=>l.abort())):g=l.signal);const v=yield this.fetch(p.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),o),body:m,signal:g}).catch(w=>{throw new ab(w)}),x=v.headers.get("x-relay-error");if(x&&x==="true")throw new mg(v);if(!v.ok)throw new vg(v);let y=((i=v.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),_;return y==="application/json"?_=yield v.json():y==="application/octet-stream"||y==="application/pdf"?_=yield v.blob():y==="text/event-stream"?_=v:y==="multipart/form-data"?_=yield v.formData():_=yield v.text(),{data:_,error:null,response:v}}catch(o){return{data:null,error:o,response:o instanceof vg||o instanceof mg?o.context:void 0}}finally{a&&clearTimeout(a)}})}}var ob=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},lb=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{let l=null,o=null,s=null,c=a.status,d=a.statusText;if(a.ok){var f,h;if(r.method!=="HEAD"){var u;const v=await a.text();v===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((u=r.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?o=v:o=JSON.parse(v))}const m=(f=r.headers.get("Prefer"))===null||f===void 0?void 0:f.match(/count=(exact|planned|estimated)/),g=(h=a.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");m&&g&&g.length>1&&(s=parseInt(g[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(o)&&(o.length>1?(l={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,s=null,c=406,d="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var p;const m=await a.text();try{l=JSON.parse(m),Array.isArray(l)&&a.status===404&&(o=[],l=null,c=200,d="OK")}catch{a.status===404&&m===""?(c=204,d="No Content"):l={message:m}}if(l&&r.isMaybeSingle&&(!(l==null||(p=l.details)===null||p===void 0)&&p.includes("0 rows"))&&(l=null,c=200,d="OK"),l&&r.shouldThrowOnError)throw new ob(l)}return{error:l,data:o,count:s,status:c,statusText:d}});return this.shouldThrowOnError||(i=i.catch(a=>{var l;let o="";const s=a==null?void 0:a.cause;if(s){var c,d,f,h;const p=(c=s==null?void 0:s.message)!==null&&c!==void 0?c:"",m=(d=s==null?void 0:s.code)!==null&&d!==void 0?d:"";o=`${(f=a==null?void 0:a.name)!==null&&f!==void 0?f:"FetchError"}: ${a==null?void 0:a.message}`,o+=`

Caused by: ${(h=s==null?void 0:s.name)!==null&&h!==void 0?h:"Error"}: ${p}`,m&&(o+=` (${m})`),s!=null&&s.stack&&(o+=`
${s.stack}`)}else{var u;o=(u=a==null?void 0:a.stack)!==null&&u!==void 0?u:""}return{error:{message:`${(l=a==null?void 0:a.name)!==null&&l!==void 0?l:"FetchError"}: ${a==null?void 0:a.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}},cb=class extends lb{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const a=i?`${i}.order`:"order",l=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"offset":`${n}.offset`,a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:a="text"}={}){var l;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),s=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${s}"; options=${o};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const xg=new RegExp("[,()]");var Wa=class extends cb{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&xg.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&xg.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},ub=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:n}=t??{},i=r?"HEAD":"GET";let a=!1;const l=(e??"*").split("").map(c=>/\s/.test(c)&&!a?"":(c==='"'&&(a=!a),c)).join(""),{url:o,headers:s}=this.cloneRequestState();return o.searchParams.set("select",l),n&&s.append("Prefer",`count=${n}`),new Wa({method:i,url:o,headers:s,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const i="POST",{url:a,headers:l}=this.cloneRequestState();if(t&&l.append("Prefer",`count=${t}`),r||l.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((s,c)=>s.concat(Object.keys(c)),[]);if(o.length>0){const s=[...new Set(o)].map(c=>`"${c}"`);a.searchParams.set("columns",s.join(","))}}return new Wa({method:i,url:a,headers:l,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){var a;const l="POST",{url:o,headers:s}=this.cloneRequestState();if(s.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&o.searchParams.set("on_conflict",t),n&&s.append("Prefer",`count=${n}`),i||s.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(c.length>0){const d=[...new Set(c)].map(f=>`"${f}"`);o.searchParams.set("columns",d.join(","))}}return new Wa({method:l,url:o,headers:s,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(e,{count:t}={}){var r;const n="PATCH",{url:i,headers:a}=this.cloneRequestState();return t&&a.append("Prefer",`count=${t}`),new Wa({method:n,url:i,headers:a,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:n,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new Wa({method:r,url:n,headers:i,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},fb=class x1{constructor(t,{headers:r={},schema:n,fetch:i}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=i}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new ub(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new x1(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:i=!1,count:a}={}){var l;let o;const s=new URL(`${this.url}/rpc/${t}`);let c;const d=u=>u!==null&&typeof u=="object"&&(!Array.isArray(u)||u.some(d)),f=n&&Object.values(r).some(d);f?(o="POST",c=r):n||i?(o=n?"HEAD":"GET",Object.entries(r).filter(([u,p])=>p!==void 0).map(([u,p])=>[u,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([u,p])=>{s.searchParams.append(u,p)})):(o="POST",c=r);const h=new Headers(this.headers);return f?h.set("Prefer",a?`count=${a},return=minimal`:"return=minimal"):a&&h.set("Prefer",`count=${a}`),new Wa({method:o,url:s,headers:h,schema:this.schemaName,body:c,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}};class hb{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const n=r.versions;if(n&&n.node){const i=n.node,a=parseInt(i.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const db="2.93.1",pb=`realtime-js/${db}`,gb="1.0.0",y1="2.0.0",yg=y1,Uh=1e4,mb=1e3,vb=100;var pi;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(pi||(pi={}));var Xt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Xt||(Xt={}));var vn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(vn||(vn={}));var Wh;(function(e){e.websocket="websocket"})(Wh||(Wh={}));var Ki;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ki||(Ki={}));class xb{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},l=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(t,r,n){var i,a;const l=t.topic,o=(i=t.ref)!==null&&i!==void 0?i:"",s=(a=t.join_ref)!==null&&a!==void 0?a:"",c=t.payload.event,d=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},f=Object.keys(d).length===0?"":JSON.stringify(d);if(s.length>255)throw new Error(`joinRef length ${s.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`metadata length ${f.length} exceeds maximum of 255`);const h=this.USER_BROADCAST_PUSH_META_LENGTH+s.length+o.length+l.length+c.length+f.length,u=new ArrayBuffer(this.HEADER_LENGTH+h);let p=new DataView(u),m=0;p.setUint8(m++,this.KINDS.userBroadcastPush),p.setUint8(m++,s.length),p.setUint8(m++,o.length),p.setUint8(m++,l.length),p.setUint8(m++,c.length),p.setUint8(m++,f.length),p.setUint8(m++,r),Array.from(s,v=>p.setUint8(m++,v.charCodeAt(0))),Array.from(o,v=>p.setUint8(m++,v.charCodeAt(0))),Array.from(l,v=>p.setUint8(m++,v.charCodeAt(0))),Array.from(c,v=>p.setUint8(m++,v.charCodeAt(0))),Array.from(f,v=>p.setUint8(m++,v.charCodeAt(0)));var g=new Uint8Array(u.byteLength+n.byteLength);return g.set(new Uint8Array(u),0),g.set(new Uint8Array(n),u.byteLength),g.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[i,a,l,o,s]=n;return r({join_ref:i,ref:a,topic:l,event:o,payload:s})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,i)}}_decodeUserBroadcast(t,r,n){const i=r.getUint8(1),a=r.getUint8(2),l=r.getUint8(3),o=r.getUint8(4);let s=this.HEADER_LENGTH+4;const c=n.decode(t.slice(s,s+i));s=s+i;const d=n.decode(t.slice(s,s+a));s=s+a;const f=n.decode(t.slice(s,s+l));s=s+l;const h=t.slice(s,t.byteLength),u=o===this.JSON_ENCODING?JSON.parse(n.decode(h)):h,p={type:this.BROADCAST_EVENT,event:d,payload:u};return l>0&&(p.meta=JSON.parse(f)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class _1{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ht;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ht||(ht={}));const _g=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((a,l)=>(a[l]=yb(l,e,t,i),a),{}):{}},yb=(e,t,r,n)=>{const i=t.find(o=>o.name===e),a=i==null?void 0:i.type,l=r[e];return a&&!n.includes(a)?w1(a,l):Hh(l)},w1=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return kb(t,r)}switch(e){case ht.bool:return _b(t);case ht.float4:case ht.float8:case ht.int2:case ht.int4:case ht.int8:case ht.numeric:case ht.oid:return wb(t);case ht.json:case ht.jsonb:return Sb(t);case ht.timestamp:return bb(t);case ht.abstime:case ht.date:case ht.daterange:case ht.int4range:case ht.int8range:case ht.money:case ht.reltime:case ht.text:case ht.time:case ht.timestamptz:case ht.timetz:case ht.tsrange:case ht.tstzrange:return Hh(t);default:return Hh(t)}},Hh=e=>e,_b=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},wb=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Sb=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},kb=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let a;const l=e.slice(1,r);try{a=JSON.parse("["+l+"]")}catch{a=l?l.split(","):[]}return a.map(o=>w1(t,o))}return e},bb=e=>typeof e=="string"?e.replace(" ","T"):e,S1=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class wf{constructor(t,r,n={},i=Uh){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var wg;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(wg||(wg={}));class mo{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:a,onLeave:l,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=mo.syncState(this.state,i,a,l),this.pendingDiffs.forEach(s=>{this.state=mo.syncDiff(this.state,s,a,l)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:a,onLeave:l,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=mo.syncDiff(this.state,i,a,l),o())}),this.onJoin((i,a,l)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:a,newPresences:l})}),this.onLeave((i,a,l)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:a,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const a=this.cloneDeep(t),l=this.transformState(r),o={},s={};return this.map(a,(c,d)=>{l[c]||(s[c]=d)}),this.map(l,(c,d)=>{const f=a[c];if(f){const h=d.map(g=>g.presence_ref),u=f.map(g=>g.presence_ref),p=d.filter(g=>u.indexOf(g.presence_ref)<0),m=f.filter(g=>h.indexOf(g.presence_ref)<0);p.length>0&&(o[c]=p),m.length>0&&(s[c]=m)}else o[c]=d}),this.syncDiff(a,{joins:o,leaves:s},n,i)}static syncDiff(t,r,n,i){const{joins:a,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(a,(o,s)=>{var c;const d=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(s),d.length>0){const f=t[o].map(u=>u.presence_ref),h=d.filter(u=>f.indexOf(u.presence_ref)<0);t[o].unshift(...h)}n(o,d,s)}),this.map(l,(o,s)=>{let c=t[o];if(!c)return;const d=s.map(f=>f.presence_ref);c=c.filter(f=>d.indexOf(f.presence_ref)<0),t[o]=c,i(o,c,s),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Sg;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Sg||(Sg={}));var vo;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(vo||(vo={}));var zn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(zn||(zn={}));class ns{constructor(t,r={config:{}},n){var i,a;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Xt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new wf(this,vn.join,this.params,this.timeout),this.rejoinTimer=new _1(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Xt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Xt.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Xt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Xt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Xt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(vn.reply,{},(l,o)=>{this._trigger(this._replyEventName(o),l)}),this.presence=new mo(this),this.broadcastEndpointURL=S1(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,i,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Xt.closed){const{config:{broadcast:l,presence:o,private:s}}=this.params,c=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&i!==void 0?i:[],d=!!this.bindings[vo.PRESENCE]&&this.bindings[vo.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,f={},h={broadcast:l,presence:Object.assign(Object.assign({},o),{enabled:d}),postgres_changes:c,private:s};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(u=>t==null?void 0:t(zn.CHANNEL_ERROR,u)),this._onClose(()=>t==null?void 0:t(zn.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var p;if(this.socket._isManualToken()||this.socket.setAuth(),u===void 0){t==null||t(zn.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,g=(p=m==null?void 0:m.length)!==null&&p!==void 0?p:0,v=[];for(let x=0;x<g;x++){const y=m[x],{filter:{event:_,schema:w,table:T,filter:k}}=y,O=u&&u[x];if(O&&O.event===_&&ns.isFilterValueEqual(O.schema,w)&&ns.isFilterValueEqual(O.table,T)&&ns.isFilterValueEqual(O.filter,k))v.push(Object.assign(Object.assign({},y),{id:O.id}));else{this.unsubscribe(),this.state=Xt.errored,t==null||t(zn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(zn.SUBSCRIBED);return}}).receive("error",u=>{this.state=Xt.errored,t==null||t(zn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(zn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Xt.joined&&t===vo.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var i;if(r==null)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(o.status===202)return{success:!0};let s=o.statusText;try{const c=await o.json();s=c.error||c.message||s}catch{}return Promise.reject(new Error(s))}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:l}=t,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const s={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:l,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,s,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var l,o,s;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((s=(o=(l=this.params)===null||l===void 0?void 0:l.config)===null||o===void 0?void 0:o.broadcast)===null||s===void 0)&&s.ack)&&a("ok"),c.receive("ok",()=>a("ok")),c.receive("error",()=>a("error")),c.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Xt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(vn.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new wf(this,vn.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Xt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const i=new AbortController,a=setTimeout(()=>i.abort(),n),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(a),l}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new wf(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>vb){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,a;const l=t.toLocaleLowerCase(),{close:o,error:s,leave:c,join:d}=vn;if(n&&[o,s,c,d].indexOf(l)>=0&&n!==this._joinRef())return;let h=this._onMessage(l,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(u=>{var p,m,g;return((p=u.filter)===null||p===void 0?void 0:p.event)==="*"||((g=(m=u.filter)===null||m===void 0?void 0:m.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===l}).map(u=>u.callback(h,n)):(a=this.bindings[l])===null||a===void 0||a.filter(u=>{var p,m,g,v,x,y;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in u){const _=u.id,w=(p=u.filter)===null||p===void 0?void 0:p.event;return _&&((m=r.ids)===null||m===void 0?void 0:m.includes(_))&&(w==="*"||(w==null?void 0:w.toLocaleLowerCase())===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const _=(x=(v=u==null?void 0:u.filter)===null||v===void 0?void 0:v.event)===null||x===void 0?void 0:x.toLocaleLowerCase();return _==="*"||_===((y=r==null?void 0:r.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return u.type.toLocaleLowerCase()===l}).map(u=>{if(typeof h=="object"&&"ids"in h){const p=h.data,{schema:m,table:g,commit_timestamp:v,type:x,errors:y}=p;h=Object.assign(Object.assign({},{schema:m,table:g,commit_timestamp:v,eventType:x,new:{},old:{},errors:y}),this._getPayloadRecords(p))}u.callback(h,n)})}_isClosed(){return this.state===Xt.closed}_isJoined(){return this.state===Xt.joined}_isJoining(){return this.state===Xt.joining}_isLeaving(){return this.state===Xt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),a={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(a):this.bindings[i]=[a],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var a;return!(((a=i.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&ns.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(vn.close,{},t)}_onError(t){this._on(vn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Xt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=_g(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=_g(t.columns,t.old_record)),r}}const Sf=()=>{},Vl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Tb=[1e3,2e3,5e3,1e4],Cb=1e4,Eb=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Ab{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Uh,this.transport=null,this.heartbeatIntervalMs=Vl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Sf,this.ref=0,this.reconnectTimer=null,this.vsn=yg,this.logger=Sf,this.conn=null,this.sendBuffer=[],this.serializer=new xb,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=i=>i?(...a)=>i(...a):(...a)=>fetch(...a),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Wh.websocket}`,this.httpEndpoint=S1(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=hb.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case pi.connecting:return Ki.Connecting;case pi.open:return Ki.Open;case pi.closing:return Ki.Closing;default:return Ki.Closed}}isConnected(){return this.connectionState()===Ki.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(a=>a.topic===n);if(i)return i;{const a=new ns(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:n,payload:i,ref:a}=t,l=()=>{this.encode(t,o=>{var s;(s=this.conn)===null||s===void 0||s.send(o)})};this.log("push",`${r} ${n} (${a})`,i),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(mb,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Vl.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const c=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",c)}catch(d){this.log("error","error in heartbeat callback",d)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:i,payload:a,ref:l}=r,o=l?`(${l})`:"",s=a.status||"";this.log("receive",`${s} ${n} ${i} ${o}`.trim(),a),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(i,a,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===pi.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===pi.open||this.conn.readyState===pi.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t);try{this.heartbeatCallback("error")}catch(r){this.log("error","error in heartbeat callback",r)}}_triggerChanError(){this.channels.forEach(t=>t._trigger(vn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Eb],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(i=>{const a={access_token:r,version:pb};r&&i.updateJoinPayload(a),i.joinedOnce&&i._isJoined()&&i._push(vn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new _1(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Vl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,a,l,o,s,c,d,f,h,u;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Uh,this.heartbeatIntervalMs=(i=t==null?void 0:t.heartbeatIntervalMs)!==null&&i!==void 0?i:Vl.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(l=t==null?void 0:t.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:Sf,this.vsn=(s=t==null?void 0:t.vsn)!==null&&s!==void 0?s:yg,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:p=>Tb[p-1]||Cb,this.vsn){case gb:this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(p,m)=>m(JSON.stringify(p)),this.decode=(f=t==null?void 0:t.decode)!==null&&f!==void 0?f:(p,m)=>m(JSON.parse(p));break;case y1:this.encode=(h=t==null?void 0:t.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var Vo=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Ob(e,t,r){const n=new URL(t,e);if(r)for(const[i,a]of Object.entries(r))a!==void 0&&n.searchParams.set(i,a);return n.toString()}async function Fb(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function Pb(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:i,body:a,headers:l}){const o=Ob(e.baseUrl,n,i),s=await Fb(e.auth),c=await t(o,{method:r,headers:{...a?{"Content-Type":"application/json"}:{},...s,...l},body:a?JSON.stringify(a):void 0}),d=await c.text(),f=(c.headers.get("content-type")||"").includes("application/json"),h=f&&d?JSON.parse(d):d;if(!c.ok){const u=f?h:void 0,p=u==null?void 0:u.error;throw new Vo((p==null?void 0:p.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:p==null?void 0:p.type,icebergCode:p==null?void 0:p.code,details:u})}return{status:c.status,headers:c.headers,data:h}}}}function Xl(e){return e.join("")}var Nb=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:Xl(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Xl(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Xl(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Xl(e.namespace)}`}),!0}catch(t){if(t instanceof Vo&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof Vo&&r.status===409)return;throw r}}};function Fa(e){return e.join("")}var Db=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Fa(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Fa(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Fa(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Fa(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Fa(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Fa(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof Vo&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof Vo&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},Rb=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=Pb({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new Nb(this.client,t),this.tableOps=new Db(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},Pu=class extends Error{constructor(e,t="storage",r,n){super(e),this.__isStorageError=!0,this.namespace=t,this.name=t==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=n}};function Nu(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var $l=class extends Pu{constructor(e,t,r,n="storage"){super(e,n,t,r),this.name=n==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},k1=class extends Pu{constructor(e,t,r="storage"){super(e,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const Ib=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Mb=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},zh=e=>{if(Array.isArray(e))return e.map(r=>zh(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[i]=zh(n)}),t},jb=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function Xo(e){"@babel/helpers - typeof";return Xo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xo(e)}function Lb(e,t){if(Xo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Xo(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bb(e){var t=Lb(e,"string");return Xo(t)=="symbol"?t:t+""}function Ub(e,t,r){return(t=Bb(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ue(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kg(Object(r),!0).forEach(function(n){Ub(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kg(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const bg=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},Wb=async(e,t,r,n)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const i=e,a=i.status||500;if(typeof i.json=="function")i.json().then(l=>{const o=(l==null?void 0:l.statusCode)||(l==null?void 0:l.code)||a+"";t(new $l(bg(l),a,o,n))}).catch(()=>{if(n==="vectors"){const l=a+"";t(new $l(i.statusText||`HTTP ${a} error`,a,l,n))}else{const l=a+"";t(new $l(i.statusText||`HTTP ${a} error`,a,l,n))}});else{const l=a+"";t(new $l(i.statusText||`HTTP ${a} error`,a,l,n))}}else t(new k1(bg(e),e,n))},Hb=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||e==="HEAD"||!n?Ue(Ue({},i),r):(Mb(n)?(i.headers=Ue({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,t!=null&&t.duplex&&(i.duplex=t.duplex),Ue(Ue({},i),r))};async function Ys(e,t,r,n,i,a,l){return new Promise((o,s)=>{e(r,Hb(t,n,i,a)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;if(l==="vectors"){const d=c.headers.get("content-type");if(!d||!d.includes("application/json"))return{}}return c.json()}).then(c=>o(c)).catch(c=>Wb(c,s,n,l))})}function zb(e="storage"){return{get:async(t,r,n,i)=>Ys(t,"GET",r,n,i,void 0,e),post:async(t,r,n,i,a)=>Ys(t,"POST",r,i,a,n,e),put:async(t,r,n,i,a)=>Ys(t,"PUT",r,i,a,n,e),head:async(t,r,n,i)=>Ys(t,"HEAD",r,Ue(Ue({},n),{},{noResolveJson:!0}),i,void 0,e),remove:async(t,r,n,i,a)=>Ys(t,"DELETE",r,i,a,n,e)}}const Vb=zb("storage"),{get:$o,post:yt,put:Vh,head:Xb,remove:cd}=Vb;var Ns=class{constructor(e,t={},r,n="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=Ib(r),this.namespace=n}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){var t=this;try{return{data:await e(),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Nu(r))return{data:null,error:r};throw r}}},$b=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Nu(t))return{data:null,error:t};throw t}}};let b1;b1=Symbol.toStringTag;var Gb=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[b1]="BlobDownloadBuilder",this.promise=null}asStream(){return new $b(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Nu(t))return{data:null,error:t};throw t}}};const Yb={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Tg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Kb=class extends Ns{constructor(e,t={},r,n){super(e,t,n,"storage"),this.bucketId=r}async uploadOrUpdate(e,t,r,n){var i=this;return i.handleOperation(async()=>{let a;const l=Ue(Ue({},Tg),n);let o=Ue(Ue({},i.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const s=l.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",l.cacheControl),s&&a.append("metadata",i.encodeMetadata(s)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.has("cacheControl")||a.append("cacheControl",l.cacheControl),s&&!a.has("metadata")&&a.append("metadata",i.encodeMetadata(s))):(a=r,o["cache-control"]=`max-age=${l.cacheControl}`,o["content-type"]=l.contentType,s&&(o["x-metadata"]=i.toBase64(i.encodeMetadata(s))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!l.duplex&&(l.duplex="half")),n!=null&&n.headers&&(o=Ue(Ue({},o),n.headers));const c=i._removeEmptyFolders(t),d=i._getFinalPath(c),f=await(e=="PUT"?Vh:yt)(i.fetch,`${i.url}/object/${d}`,a,Ue({headers:o},l!=null&&l.duplex?{duplex:l.duplex}:{}));return{path:c,id:f.Id,fullPath:f.Key}})}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var i=this;const a=i._removeEmptyFolders(e),l=i._getFinalPath(a),o=new URL(i.url+`/object/upload/sign/${l}`);return o.searchParams.set("token",t),i.handleOperation(async()=>{let s;const c=Ue({upsert:Tg.upsert},n),d=Ue(Ue({},i.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",c.cacheControl),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",c.cacheControl)):(s=r,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType),{path:a,fullPath:(await Vh(i.fetch,o.toString(),s,{headers:d})).Key}})}async createSignedUploadUrl(e,t){var r=this;return r.handleOperation(async()=>{let n=r._getFinalPath(e);const i=Ue({},r.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const a=await yt(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:i}),l=new URL(r.url+a.url),o=l.searchParams.get("token");if(!o)throw new Pu("No token returned by API");return{signedUrl:l.toString(),path:e,token:o}})}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;return n.handleOperation(async()=>await yt(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}))}async copy(e,t,r){var n=this;return n.handleOperation(async()=>({path:(await yt(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key}))}async createSignedUrl(e,t,r){var n=this;return n.handleOperation(async()=>{let i=n._getFinalPath(e),a=await yt(n.fetch,`${n.url}/object/sign/${i}`,Ue({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${n.url}${a.signedURL}${l}`)}})}async createSignedUrls(e,t,r){var n=this;return n.handleOperation(async()=>{const i=await yt(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i.map(l=>Ue(Ue({},l),{},{signedUrl:l.signedURL?encodeURI(`${n.url}${l.signedURL}${a}`):null}))})}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=n?`?${n}`:"",a=this._getFinalPath(e),l=()=>$o(this.fetch,`${this.url}/${r}/${a}${i}`,{headers:this.headers,noResolveJson:!0});return new Gb(l,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);return t.handleOperation(async()=>zh(await $o(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})))}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await Xb(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Nu(n)&&n instanceof k1){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&n.push(l);let o=n.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${o}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await cd(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,r){var n=this;return n.handleOperation(async()=>{const i=Ue(Ue(Ue({},Yb),t),{},{prefix:e||""});return await yt(n.fetch,`${n.url}/object/list/${n.bucketId}`,i,{headers:n.headers},r)})}async listV2(e,t){var r=this;return r.handleOperation(async()=>{const n=Ue({},e);return await yt(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const qb="2.93.1",gl={"X-Client-Info":`storage-js/${qb}`};var Jb=class extends Ns{constructor(e,t={},r,n){const i=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase."));const a=i.href.replace(/\/$/,""),l=Ue(Ue({},gl),t);super(a,l,r,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=t.listBucketOptionsToQueryString(e);return await $o(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await $o(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var r=this;return r.handleOperation(async()=>await yt(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async updateBucket(e,t){var r=this;return r.handleOperation(async()=>await Vh(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await yt(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await cd(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},Qb=class extends Ns{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=Ue(Ue({},gl),t);super(n,i,r,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await yt(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),i=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return await $o(t.fetch,i,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await cd(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!jb(e))throw new Pu("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new Rb({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(i,a){const l=i[a];return typeof l!="function"?l:async(...o)=>{try{return{data:await l.apply(i,o),error:null}}catch(s){if(n)throw s;return{data:null,error:s}}}}})}},Zb=class extends Ns{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=Ue(Ue({},gl),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await yt(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var r=this;return r.handleOperation(async()=>await yt(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await yt(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var r=this;return r.handleOperation(async()=>await yt(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{})}},eT=class extends Ns{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=Ue(Ue({},gl),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await yt(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await yt(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return t.handleOperation(async()=>await yt(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await yt(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await yt(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},tT=class extends Ns{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=Ue(Ue({},gl),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await yt(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await yt(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await yt(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await yt(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},rT=class extends tT{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new nT(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},nT=class extends Zb{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Ue(Ue({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Ue(Ue({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new iT(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},iT=class extends eT{constructor(e,t,r,n,i){super(e,t,i),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Ue(Ue({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Ue(Ue({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Ue(Ue({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Ue(Ue({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Ue(Ue({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},aT=class extends Jb{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new Kb(this.url,this.headers,e,this.fetch)}get vectors(){return new rT(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Qb(this.url+"/iceberg",this.headers,this.fetch)}};const T1="2.93.1",Ha=30*1e3,Xh=3,kf=Xh*Ha,sT="http://localhost:9999",oT="supabase.auth.token",lT={"X-Client-Info":`gotrue-js/${T1}`},$h="X-Supabase-Api-Version",C1={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},cT=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,uT=10*60*1e3;class Go extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Ne(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class fT extends Go{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function hT(e){return Ne(e)&&e.name==="AuthApiError"}class qi extends Go{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class ai extends Go{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class Lr extends ai{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function bf(e){return Ne(e)&&e.name==="AuthSessionMissingError"}class Pa extends ai{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Gl extends ai{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Yl extends ai{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function dT(e){return Ne(e)&&e.name==="AuthImplicitGrantRedirectError"}class Cg extends ai{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class pT extends ai{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Gh extends ai{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Tf(e){return Ne(e)&&e.name==="AuthRetryableFetchError"}class Eg extends ai{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Yh extends ai{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Yc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ag=` 	
\r=`.split(""),gT=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Ag.length;t+=1)e[Ag[t].charCodeAt(0)]=-2;for(let t=0;t<Yc.length;t+=1)e[Yc[t].charCodeAt(0)]=t;return e})();function Og(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Yc[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Yc[n]),t.queuedBits-=6}}function E1(e,t,r){const n=gT[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Fg(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},a=l=>{xT(l,n,r)};for(let l=0;l<e.length;l+=1)E1(e.charCodeAt(l),i,a);return t.join("")}function mT(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function vT(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}mT(n,t)}}function xT(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function hs(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)E1(e.charCodeAt(i),r,n);return new Uint8Array(t)}function yT(e){const t=[];return vT(e,r=>t.push(r)),new Uint8Array(t)}function ta(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>Og(i,r,n)),Og(null,r,n),t.join("")}function _T(e){return Math.round(Date.now()/1e3)+e}function wT(){return Symbol("auth-callback")}const rr=()=>typeof window<"u"&&typeof document<"u",zi={tested:!1,writable:!1},A1=()=>{if(!rr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(zi.tested)return zi.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),zi.tested=!0,zi.writable=!0}catch{zi.tested=!0,zi.writable=!1}return zi.writable};function ST(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,a)=>{t[a]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const O1=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),kT=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",za=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Vi=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},tr=async(e,t)=>{await e.removeItem(t)};class Du{constructor(){this.promise=new Du.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Du.promiseConstructor=Promise;function Kl(e){const t=e.split(".");if(t.length!==3)throw new Yh("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!cT.test(t[n]))throw new Yh("JWT not in base64url format");return{header:JSON.parse(Fg(t[0])),payload:JSON.parse(Fg(t[1])),signature:hs(t[2]),raw:{header:t[0],payload:t[1]}}}async function bT(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function TT(e,t){return new Promise((n,i)=>{(async()=>{for(let a=0;a<1/0;a++)try{const l=await e(a);if(!t(a,null,l)){n(l);return}}catch(l){if(!t(a,l)){i(l);return}}})()})}function CT(e){return("0"+e.toString(16)).substr(-2)}function ET(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let a=0;a<56;a++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,CT).join("")}async function AT(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(a=>String.fromCharCode(a)).join("")}async function OT(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await AT(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Na(e,t,r=!1){const n=ET();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await za(e,`${t}-code-verifier`,i);const a=await OT(n);return[a,n===a?"plain":"s256"]}const FT=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function PT(e){const t=e.headers.get($h);if(!t||!t.match(FT))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function NT(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function DT(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const RT=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Da(e){if(!RT.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Cf(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function IT(e,t){return new Proxy(e,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const a=n.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,i)}})}function Pg(e){return JSON.parse(JSON.stringify(e))}const Gi=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),MT=[502,503,504];async function Ng(e){var t;if(!kT(e))throw new Gh(Gi(e),0);if(MT.includes(e.status))throw new Gh(Gi(e),e.status);let r;try{r=await e.json()}catch(a){throw new qi(Gi(a),a)}let n;const i=PT(e);if(i&&i.getTime()>=C1["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Eg(Gi(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Lr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,l)=>a&&typeof l=="string",!0))throw new Eg(Gi(r),e.status,r.weak_password.reasons);throw new fT(Gi(r),e.status||500,n)}const jT=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function Le(e,t,r,n){var i;const a=Object.assign({},n==null?void 0:n.headers);a[$h]||(a[$h]=C1["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const l=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(l.redirect_to=n.redirectTo);const o=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",s=await LT(e,t,r+o,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(s):{data:Object.assign({},s),error:null}}async function LT(e,t,r,n,i,a){const l=jT(t,n,i,a);let o;try{o=await e(r,Object.assign({},l))}catch(s){throw console.error(s),new Gh(Gi(s),0)}if(o.ok||await Ng(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(s){await Ng(s)}}function pn(e){var t;let r=null;WT(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=_T(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Dg(e){const t=pn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function vi(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function BT(e){return{data:e,error:null}}function UT(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:a}=e,l=Fu(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:a},s=Object.assign({},l);return{data:{properties:o,user:s},error:null}}function Rg(e){return e}function WT(e){return e.access_token&&e.refresh_token&&e.expires_in}const Ef=["global","local","others"];class HT{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=O1(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Ef[0]){if(Ef.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Ef.join(", ")}`);try{return await Le(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ne(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Le(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:vi})}catch(n){if(Ne(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Fu(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await Le(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:UT,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Ne(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Le(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:vi})}catch(r){if(Ne(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,a,l,o,s;try{const c={nextPage:null,lastPage:0,total:0},d=await Le(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:Rg});if(d.error)throw d.error;const f=await d.json(),h=(l=d.headers.get("x-total-count"))!==null&&l!==void 0?l:0,u=(s=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&s!==void 0?s:[];return u.length>0&&(u.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(p.split(";")[1].split("=")[1]);c[`${g}Page`]=m}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(Ne(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){Da(t);try{return await Le(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:vi})}catch(r){if(Ne(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Da(t);try{return await Le(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:vi})}catch(n){if(Ne(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Da(t);try{return await Le(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:vi})}catch(n){if(Ne(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Da(t.userId);try{const{data:r,error:n}=await Le(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Da(t.userId),Da(t.id);try{return{data:await Le(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,i,a,l,o,s;try{const c={nextPage:null,lastPage:0,total:0},d=await Le(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:Rg});if(d.error)throw d.error;const f=await d.json(),h=(l=d.headers.get("x-total-count"))!==null&&l!==void 0?l:0,u=(s=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&s!==void 0?s:[];return u.length>0&&(u.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(p.split(";")[1].split("=")[1]);c[`${g}Page`]=m}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(Ne(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(t){try{return await Le(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Le(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Le(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ne(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Le(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Le(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}}}function Ig(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Ra={debug:!!(globalThis&&A1()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class F1 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class zT extends F1{}async function VT(e,t,r){Ra.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Ra.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){Ra.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{Ra.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw Ra.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new zT(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Ra.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function XT(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function P1(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function $T(e){return parseInt(e,16)}function GT(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function YT(e){var t;const{chainId:r,domain:n,expirationTime:i,issuedAt:a=new Date,nonce:l,notBefore:o,requestId:s,resources:c,scheme:d,uri:f,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const u=P1(e.address),p=d?`${d}://${n}`:n,m=e.statement?`${e.statement}
`:"",g=`${p} wants you to sign in with your Ethereum account:
${u}

${m}`;let v=`URI: ${f}
Version: ${h}
Chain ID: ${r}${l?`
Nonce: ${l}`:""}
Issued At: ${a.toISOString()}`;if(i&&(v+=`
Expiration Time: ${i.toISOString()}`),o&&(v+=`
Not Before: ${o.toISOString()}`),s&&(v+=`
Request ID: ${s}`),c){let x=`
Resources:`;for(const y of c){if(!y||typeof y!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${y}`);x+=`
- ${y}`}v+=x}return`${g}
${v}`}class zt extends Error{constructor({message:t,code:r,cause:n,name:i}){var a;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(a=i??(n instanceof Error?n.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=r}}class Kc extends zt{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function KT({error:e,options:t}){var r,n,i;const{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new zt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new zt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new zt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=a.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new zt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new zt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new zt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return a.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new zt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new zt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const l=window.location.hostname;if(N1(l)){if(a.rp.id!==l)return new zt({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new zt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new zt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new zt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new zt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function qT({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new zt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new zt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(N1(n)){if(r.rpId!==n)return new zt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new zt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new zt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new zt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class JT{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const QT=new JT;function ZT(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,i=Fu(e,["challenge","user","excludeCredentials"]),a=hs(t).buffer,l=Object.assign(Object.assign({},r),{id:hs(r.id).buffer}),o=Object.assign(Object.assign({},i),{challenge:a,user:l});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let s=0;s<n.length;s++){const c=n[s];o.excludeCredentials[s]=Object.assign(Object.assign({},c),{id:hs(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function eC(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Fu(e,["challenge","allowCredentials"]),i=hs(t).buffer,a=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){a.allowCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const o=r[l];a.allowCredentials[l]=Object.assign(Object.assign({},o),{id:hs(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return a}function tC(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:ta(new Uint8Array(e.response.attestationObject)),clientDataJSON:ta(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function rC(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:ta(new Uint8Array(i.authenticatorData)),clientDataJSON:ta(new Uint8Array(i.clientDataJSON)),signature:ta(new Uint8Array(i.signature)),userHandle:i.userHandle?ta(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function N1(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function Mg(){var e,t;return!!(rr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function nC(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Kc("Browser returned unexpected credential type",t)}:{data:null,error:new Kc("Empty credential response",t)}}catch(t){return{data:null,error:KT({error:t,options:e})}}}async function iC(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Kc("Browser returned unexpected credential type",t)}:{data:null,error:new Kc("Empty credential response",t)}}catch(t){return{data:null,error:qT({error:t,options:e})}}}const aC={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},sC={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function qc(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of e)if(i)for(const a in i){const l=i[a];if(l!==void 0)if(Array.isArray(l))n[a]=l;else if(r(l))n[a]=l;else if(t(l)){const o=n[a];t(o)?n[a]=qc(o,l):n[a]=qc(l)}else n[a]=l}return n}function oC(e,t){return qc(aC,e,t||{})}function lC(e,t){return qc(sC,e,t||{})}class cC{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:i},a){try{const{data:l,error:o}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!l)return{data:null,error:o};const s=i??QT.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:c}=l.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${n}`),c.displayName||(c.displayName=c.name)}switch(l.webauthn.type){case"create":{const c=oC(l.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:d,error:f}=await nC({publicKey:c,signal:s});return d?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}case"request":{const c=lC(l.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:d,error:f}=await iC(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:c,signal:s}));return d?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}}}catch(l){return Ne(l)?{data:null,error:l}:{data:null,error:new qi("Unexpected error in challenge",l)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},a){if(!r)return{data:null,error:new Go("rpId is required for WebAuthn authentication")};try{if(!Mg())return{data:null,error:new qi("Browser does not support WebAuthn",null)};const{data:l,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:a});if(!l)return{data:null,error:o};const{webauthn:s}=l;return this._verify({factorId:t,challengeId:l.challengeId,webauthn:{type:s.type,rpId:r,rpOrigins:n,credential_response:s.credential_response}})}catch(l){return Ne(l)?{data:null,error:l}:{data:null,error:new qi("Unexpected error in authenticate",l)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},a){if(!r)return{data:null,error:new Go("rpId is required for WebAuthn registration")};try{if(!Mg())return{data:null,error:new qi("Browser does not support WebAuthn",null)};const{data:l,error:o}=await this._enroll({friendlyName:t});if(!l)return await this.client.mfa.listFactors().then(d=>{var f;return(f=d.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:o};const{data:s,error:c}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:a});return s?this._verify({factorId:l.id,challengeId:s.challengeId,webauthn:{rpId:r,rpOrigins:n,type:s.webauthn.type,credential_response:s.webauthn.credential_response}}):{data:null,error:c}}catch(l){return Ne(l)?{data:null,error:l}:{data:null,error:new qi("Unexpected error in register",l)}}}}XT();const uC={url:sT,storageKey:oT,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:lT,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function jg(e,t,r){return await r()}const Ia={};class Yo{get jwks(){var t,r;return(r=(t=Ia[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Ia[this.storageKey]=Object.assign(Object.assign({},Ia[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Ia[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Ia[this.storageKey]=Object.assign(Object.assign({},Ia[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},uC),t);if(this.storageKey=a.storageKey,this.instanceID=(r=Yo.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Yo.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&rr()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new HT({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=O1(a.fetch),this.lock=a.lock||jg,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,this.lockAcquireTimeout=a.lockAcquireTimeout,a.lock?this.lock=a.lock:this.persistSession&&rr()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=VT:this.lock=jg,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new cC(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:A1()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ig(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Ig(this.memoryStorage)),rr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l);try{await this._notifyAllSubscribers(l.data.event,l.data.session,!1)}catch(o){this._debug("#broadcastChannel","error",o)}})}this.initialize().catch(l=>{this._debug("#initialize()","error",l)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${T1}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(rr()&&(r=ST(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),rr()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:a}=await this._getSessionFromURL(r,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),dT(a)){const s=(t=a.details)===null||t===void 0?void 0:t.code;if(s==="identity_already_exists"||s==="identity_not_found"||s==="single_identity_not_deletable")return{error:a}}return{error:a}}const{session:l,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",l,"redirect type",o),await this._saveSession(l),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ne(r)?this._returnResult({error:r}):this._returnResult({error:new qi("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const a=await Le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:pn}),{data:l,error:o}=a;if(o||!l)return this._returnResult({data:{user:null,session:null},error:o});const s=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",s)),this._returnResult({data:{user:c,session:s},error:null})}catch(a){if(Ne(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(t){var r,n,i;try{let a;if("email"in t){const{email:d,password:f,options:h}=t;let u=null,p=null;this.flowType==="pkce"&&([u,p]=await Na(this.storage,this.storageKey)),a=await Le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:d,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:u,code_challenge_method:p},xform:pn})}else if("phone"in t){const{phone:d,password:f,options:h}=t;a=await Le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(i=h==null?void 0:h.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:pn})}else throw new Gl("You must provide either an email or phone number and a password");const{data:l,error:o}=a;if(o||!l)return await tr(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const s=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",s)),this._returnResult({data:{user:c,session:s},error:null})}catch(a){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Ne(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:l,options:o}=t;r=await Le(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Dg})}else if("phone"in t){const{phone:a,password:l,options:o}=t;r=await Le(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Dg})}else throw new Gl("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const a=new Pa;return this._returnResult({data:{user:null,session:null},error:a})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(Ne(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,i,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,i,a,l,o,s,c,d,f,h;let u,p;if("message"in t)u=t.message,p=t.signature;else{const{chain:m,wallet:g,statement:v,options:x}=t;let y;if(rr())if(typeof g=="object")y=g;else{const F=window;if("ethereum"in F&&typeof F.ethereum=="object"&&"request"in F.ethereum&&typeof F.ethereum.request=="function")y=F.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(x!=null&&x.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=g}const _=new URL((r=x==null?void 0:x.url)!==null&&r!==void 0?r:window.location.href),w=await y.request({method:"eth_requestAccounts"}).then(F=>F).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!w||w.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const T=P1(w[0]);let k=(n=x==null?void 0:x.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!k){const F=await y.request({method:"eth_chainId"});k=$T(F)}const O={domain:_.host,address:T,statement:v,uri:_.href,version:"1",chainId:k,nonce:(i=x==null?void 0:x.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(l=(a=x==null?void 0:x.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(o=x==null?void 0:x.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(s=x==null?void 0:x.signInWithEthereum)===null||s===void 0?void 0:s.notBefore,requestId:(c=x==null?void 0:x.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(d=x==null?void 0:x.signInWithEthereum)===null||d===void 0?void 0:d.resources};u=YT(O),p=await y.request({method:"personal_sign",params:[GT(u),T]})}try{const{data:m,error:g}=await Le(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:u,signature:p},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:pn});if(g)throw g;if(!m||!m.session||!m.user){const v=new Pa;return this._returnResult({data:{user:null,session:null},error:v})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:g})}catch(m){if(Ne(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(t){var r,n,i,a,l,o,s,c,d,f,h,u;let p,m;if("message"in t)p=t.message,m=t.signature;else{const{chain:g,wallet:v,statement:x,options:y}=t;let _;if(rr())if(typeof v=="object")_=v;else{const T=window;if("solana"in T&&typeof T.solana=="object"&&("signIn"in T.solana&&typeof T.solana.signIn=="function"||"signMessage"in T.solana&&typeof T.solana.signMessage=="function"))_=T.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=v}const w=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in _&&_.signIn){const T=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:w.host,uri:w.href}),x?{statement:x}:null));let k;if(Array.isArray(T)&&T[0]&&typeof T[0]=="object")k=T[0];else if(T&&typeof T=="object"&&"signedMessage"in T&&"signature"in T)k=T;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)p=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),m=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${w.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...x?["",x,""]:[""],"Version: 1",`URI: ${w.href}`,`Issued At: ${(i=(n=y==null?void 0:y.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((a=y==null?void 0:y.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((l=y==null?void 0:y.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((o=y==null?void 0:y.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((s=y==null?void 0:y.signInWithSolana)===null||s===void 0)&&s.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((c=y==null?void 0:y.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((f=(d=y==null?void 0:y.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",...y.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const T=await _.signMessage(new TextEncoder().encode(p),"utf8");if(!T||!(T instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=T}}try{const{data:g,error:v}=await Le(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:ta(m)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(u=t.options)===null||u===void 0?void 0:u.captchaToken}}:null),xform:pn});if(v)throw v;if(!g||!g.session||!g.user){const x=new Pa;return this._returnResult({data:{user:null,session:null},error:x})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:v})}catch(g){if(Ne(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(t){const r=await Vi(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new pT;const{data:a,error:l}=await Le(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:pn});if(await tr(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!a||!a.session||!a.user){const o=new Pa;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:i??null}),error:l})}catch(a){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Ne(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:a,nonce:l}=t,o=await Le(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:a,nonce:l,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:pn}),{data:s,error:c}=o;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!s||!s.session||!s.user){const d=new Pa;return this._returnResult({data:{user:null,session:null},error:d})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:s,error:c})}catch(r){if(Ne(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,i,a,l;try{if("email"in t){const{email:o,options:s}=t;let c=null,d=null;this.flowType==="pkce"&&([c,d]=await Na(this.storage,this.storageKey));const{error:f}=await Le(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=s==null?void 0:s.data)!==null&&r!==void 0?r:{},create_user:(n=s==null?void 0:s.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in t){const{phone:o,options:s}=t,{data:c,error:d}=await Le(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=s==null?void 0:s.data)!==null&&i!==void 0?i:{},create_user:(a=s==null?void 0:s.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken},channel:(l=s==null?void 0:s.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d})}throw new Gl("You must provide either an email or phone number.")}catch(o){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Ne(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var r,n;try{let i,a;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:o}=await Le(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:i,xform:pn});if(o)throw o;if(!l)throw new Error("An error occurred on token verification.");const s=l.session,c=l.user;return s!=null&&s.access_token&&(await this._saveSession(s),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",s)),this._returnResult({data:{user:c,session:s},error:null})}catch(i){if(Ne(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,n,i,a,l;try{let o=null,s=null;this.flowType==="pkce"&&([o,s]=await Na(this.storage,this.storageKey));const c=await Le(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:s}),headers:this.headers,xform:BT});return!((a=c.data)===null||a===void 0)&&a.url&&rr()&&!(!((l=t.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(o){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Ne(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Lr;const{error:i}=await Le(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(Ne(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:a}=t,{error:l}=await Le(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in t){const{phone:n,type:i,options:a}=t,{data:l,error:o}=await Le(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:o})}throw new Gl("You must provide either an email or phone number and a type")}catch(r){if(Ne(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Vi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<kf:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const l=await Vi(this.userStorage,this.storageKey+"-user");l!=null&&l.user?t.user=l.user:t.user=Cf()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};t.user=IT(t.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Le(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:vi}):await this._useSession(async r=>{var n,i,a;const{data:l,error:o}=r;if(o)throw o;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Lr}:await Le(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0,xform:vi})})}catch(r){if(Ne(r))return bf(r)&&(await this._removeSession(),await tr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:a}=n;if(a)throw a;if(!i.session)throw new Lr;const l=i.session;let o=null,s=null;this.flowType==="pkce"&&t.email!=null&&([o,s]=await Na(this.storage,this.storageKey));const{data:c,error:d}=await Le(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:s}),jwt:l.access_token,xform:vi});if(d)throw d;return l.user=c.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(n){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Ne(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Lr;const r=Date.now()/1e3;let n=r,i=!0,a=null;const{payload:l}=Kl(t.access_token);if(l.exp&&(n=l.exp,i=n<=r),i){const{data:o,error:s}=await this._callRefreshToken(t.refresh_token);if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!o)return{data:{user:null,session:null},error:null};a=o}else{const{data:o,error:s}=await this._getUser(t.access_token);if(s)return this._returnResult({data:{user:null,session:null},error:s});a={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(r){if(Ne(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:l,error:o}=r;if(o)throw o;t=(n=l.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Lr;const{data:i,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Ne(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!rr())throw new Yl("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Yl(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Cg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Yl("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Cg("No code detected.");const{data:x,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:x.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:a,refresh_token:l,expires_in:o,expires_at:s,token_type:c}=t;if(!a||!o||!l||!c)throw new Yl("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(o);let h=d+f;s&&(h=parseInt(s));const u=h-d;u*1e3<=Ha&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${u}s, should have been closer to ${f}s`);const p=h-f;d-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,d):d-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,h,d);const{data:m,error:g}=await this._getUser(a);if(g)throw g;const v={provider_token:n,provider_refresh_token:i,access_token:a,expires_in:f,expires_at:h,refresh_token:l,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:v,redirectType:t.type},error:null})}catch(n){if(Ne(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Vi(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:a}=r;if(a&&!bf(a))return this._returnResult({error:a});const l=(n=i.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:o}=await this.admin.signOut(l,t);if(o&&!(hT(o)&&(o.status===404||o.status===401||o.status===403)||bf(o)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await tr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=wT(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:a},error:l}=r;if(l)throw l;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await Na(this.storage,this.storageKey,!0));try{return await Le(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Ne(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Ne(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:i}=await this._useSession(async a=>{var l,o,s,c,d;const{data:f,error:h}=a;if(h)throw h;const u=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:!0});return await Le(this.fetch,"GET",u,{headers:this.headers,jwt:(d=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(i)throw i;return rr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(Ne(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:a}}=r;if(i)throw i;const{options:l,provider:o,token:s,access_token:c,nonce:d}=t,f=await Le(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=a==null?void 0:a.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:s,access_token:c,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:pn}),{data:h,error:u}=f;return u?this._returnResult({data:{user:null,session:null},error:u}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new Pa}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:u}))}catch(i){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Ne(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:a,error:l}=r;if(l)throw l;return await Le(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(Ne(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await TT(async i=>(i>0&&await bT(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await Le(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:pn})),(i,a)=>{const l=200*Math.pow(2,i);return a&&Tf(a)&&Date.now()+l-n<Ha})}catch(n){if(this._debug(r,"error",n),Ne(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),rr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await Vi(this.storage,this.storageKey);if(i&&this.userStorage){let l=await Vi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:i.user},await za(this.userStorage,this.storageKey+"-user",l)),i.user=(t=l==null?void 0:l.user)!==null&&t!==void 0?t:Cf()}else if(i&&!i.user&&!i.user){const l=await Vi(this.storage,this.storageKey+"-user");l&&(l!=null&&l.user)?(i.user=l.user,await tr(this.storage,this.storageKey+"-user"),await za(this.storage,this.storageKey,i)):i.user=Cf()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const a=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<kf;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${kf}s`),a){if(this.autoRefreshToken&&i.refresh_token){const{error:l}=await this._callRefreshToken(i.refresh_token);l&&(console.error(l),Tf(l)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:o}=await this._getUser(i.access_token);!o&&(l!=null&&l.user)?(i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(n,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Lr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Du;const{data:a,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!a.session)throw new Lr;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const o={data:a.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(a){if(this._debug(i,"error",a),Ne(a)){const l={data:null,error:a};return Tf(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],l=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(s){a.push(s)}});if(await Promise.all(l),a.length>0){for(let o=0;o<a.length;o+=1)console.error(a[o]);throw a[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await tr(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await za(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const a=Pg(i);await za(this.storage,this.storageKey,a)}else{const i=Pg(r);await za(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await tr(this.storage,this.storageKey),await tr(this.storage,this.storageKey+"-code-verifier"),await tr(this.storage,this.storageKey+"-user"),this.userStorage&&await tr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&rr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Ha);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/Ha);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Ha}ms, refresh threshold is ${Xh} ticks`),i<=Xh&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof F1)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!rr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(t){this._debug("#visibilityChangedCallback","error",t)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,l]=await Na(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(l)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);i.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;return a?this._returnResult({data:null,error:a}):await Le(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ne(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:a,error:l}=r;if(l)return this._returnResult({data:null,error:l});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:s,error:c}=await Le(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(t.factorType==="totp"&&s.type==="totp"&&(!((i=s==null?void 0:s.totp)===null||i===void 0)&&i.qr_code)&&(s.totp.qr_code=`data:image/svg+xml;utf-8,${s.totp.qr_code}`),this._returnResult({data:s,error:null}))})}catch(r){if(Ne(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;if(a)return this._returnResult({data:null,error:a});const l=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?tC(t.webauthn.credential_response):rC(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:s}=await Le(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return s?this._returnResult({data:null,error:s}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:s}))})}catch(r){if(Ne(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;if(a)return this._returnResult({data:null,error:a});const l=await Le(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(l.error)return l;const{data:o}=l;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:ZT(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:eC(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Ne(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const a of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])i.all.push(a),a.status==="verified"&&i[a.factor_type].push(a);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(t){var r,n,i,a;if(t)try{const{payload:u}=Kl(t);let p=null;u.aal&&(p=u.aal);let m=p;const{data:{user:g},error:v}=await this.getUser(t);if(v)return this._returnResult({data:null,error:v});((n=(r=g==null?void 0:g.factors)===null||r===void 0?void 0:r.filter(_=>_.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(m="aal2");const y=u.amr||[];return{data:{currentLevel:p,nextLevel:m,currentAuthenticationMethods:y},error:null}}catch(u){if(Ne(u))return this._returnResult({data:null,error:u});throw u}const{data:{session:l},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=Kl(l.access_token);let c=null;s.aal&&(c=s.aal);let d=c;((a=(i=l.user.factors)===null||i===void 0?void 0:i.filter(u=>u.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(d="aal2");const h=s.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:h},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await Le(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Lr})})}catch(r){if(Ne(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!i)return this._returnResult({data:null,error:new Lr});const l=await Le(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return l.data&&l.data.redirect_url&&rr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(Ne(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!i)return this._returnResult({data:null,error:new Lr});const l=await Le(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return l.data&&l.data.redirect_url&&rr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(Ne(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await Le(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Lr})})}catch(t){if(Ne(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?(await Le(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Lr})})}catch(r){if(Ne(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+uT>i)return n;const{data:a,error:l}=await Le(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=i,n=a.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:u,error:p}=await this.getSession();if(p||!u.session)return this._returnResult({data:null,error:p});n=u.session.access_token}const{header:i,payload:a,signature:l,raw:{header:o,payload:s}}=Kl(n);r!=null&&r.allowExpired||NT(a.exp);const c=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:u}=await this.getUser(n);if(u)throw u;return{data:{claims:a,header:i,signature:l},error:null}}const d=DT(i.alg),f=await crypto.subtle.importKey("jwk",c,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,l,yT(`${o}.${s}`)))throw new Yh("Invalid JWT signature");return{data:{claims:a,header:i,signature:l},error:null}}catch(n){if(Ne(n))return this._returnResult({data:null,error:n});throw n}}}Yo.nextInstanceID={};const fC=Yo,hC="2.93.1";let to="";typeof Deno<"u"?to="deno":typeof document<"u"?to="web":typeof navigator<"u"&&navigator.product==="ReactNative"?to="react-native":to="node";function dC(){const e=globalThis.process;if(e&&e.platform){const t=e.platform;if(t==="darwin")return"macOS";if(t==="win32")return"Windows";if(t==="linux")return"Linux";if(t==="android")return"Android"}if(typeof navigator<"u"&&navigator.userAgentData&&navigator.userAgentData.platform){const t=navigator.userAgentData.platform;if(t==="macOS")return"macOS";if(t==="Windows")return"Windows";if(t==="Linux")return"Linux";if(t==="Android")return"Android";if(t==="iOS")return"iOS"}return null}function pC(){const e=globalThis.process;if(e){const t=e.versions;if(t&&t.node&&typeof window>"u")try{const r=globalThis.require;if(r)return r("os").release()}catch{return null}}if(typeof Deno<"u"&&Deno.osRelease)try{return Deno.osRelease()}catch{return null}return typeof navigator<"u"&&navigator.userAgentData&&navigator.userAgentData.platformVersion?navigator.userAgentData.platformVersion:null}function gC(){if(typeof Deno<"u")return"deno";if(typeof Bun<"u")return"bun";const e=globalThis.process;if(e){const t=e.versions;if(t&&t.node)return"node"}return null}function mC(){if(typeof Deno<"u"&&Deno.version)return Deno.version.deno;if(typeof Bun<"u"&&Bun.version)return Bun.version;const e=globalThis.process;if(e){const t=e.versions;if(t&&t.node)return t.node}return null}function vC(){const e={"X-Client-Info":`supabase-js-${to}/${hC}`},t=dC();t&&(e["X-Supabase-Client-Platform"]=t);const r=pC();r&&(e["X-Supabase-Client-Platform-Version"]=r);const n=gC();n&&(e["X-Supabase-Client-Runtime"]=n);const i=mC();return i&&(e["X-Supabase-Client-Runtime-Version"]=i),e}const xC=vC(),yC={headers:xC},_C={schema:"public"},wC={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},SC={};function Ko(e){"@babel/helpers - typeof";return Ko=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ko(e)}function kC(e,t){if(Ko(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ko(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bC(e){var t=kC(e,"string");return Ko(t)=="symbol"?t:t+""}function TC(e,t,r){return(t=bC(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ft(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Lg(Object(r),!0).forEach(function(n){TC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lg(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const CC=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),EC=()=>Headers,AC=(e,t,r)=>{const n=CC(r),i=EC();return async(a,l)=>{var o;const s=(o=await t())!==null&&o!==void 0?o:e;let c=new i(l==null?void 0:l.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${s}`),n(a,Ft(Ft({},l),{},{headers:c}))}};function OC(e){return e.endsWith("/")?e:e+"/"}function FC(e,t){var r,n;const{db:i,auth:a,realtime:l,global:o}=e,{db:s,auth:c,realtime:d,global:f}=t,h={db:Ft(Ft({},s),i),auth:Ft(Ft({},c),a),realtime:Ft(Ft({},d),l),storage:{},global:Ft(Ft(Ft({},f),o),{},{headers:Ft(Ft({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function PC(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(OC(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var NC=class extends fC{constructor(e){super(e)}},DC=class{constructor(e,t,r){var n,i;this.supabaseUrl=e,this.supabaseKey=t;const a=PC(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const l=`sb-${a.hostname.split(".")[0]}-auth-token`,o={db:_C,realtime:SC,auth:Ft(Ft({},wC),{},{storageKey:l}),global:yC},s=FC(r??{},o);if(this.storageKey=(n=s.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=s.global.headers)!==null&&i!==void 0?i:{},s.accessToken)this.accessToken=s.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=s.auth)!==null&&c!==void 0?c:{},this.headers,s.global.fetch)}this.fetch=AC(t,this._getAccessToken.bind(this),s.global.fetch),this.realtime=this._initRealtimeClient(Ft({headers:this.headers,accessToken:this._getAccessToken.bind(this)},s.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new fb(new URL("rest/v1",a).href,{headers:this.headers,schema:s.db.schema,fetch:this.fetch}),this.storage=new aT(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),s.accessToken||this._listenForAuthEvents()}get functions(){return new sb(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,storageKey:a,flowType:l,lock:o,debug:s,throwOnError:c},d,f){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new NC({url:this.authUrl.href,headers:Ft(Ft({},h),d),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,flowType:l,lock:o,debug:s,throwOnError:c,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(u=>u.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Ab(this.realtimeUrl.href,Ft(Ft({},e),{},{params:Ft(Ft({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const RC=(e,t,r)=>new DC(e,t,r);function IC(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}IC()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const MC="https://kglshjhuofkouiodmkgs.supabase.co",jC="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtnbHNoamh1b2Zrb3Vpb2Rta2dzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk0NDE3ODgsImV4cCI6MjA4NTAxNzc4OH0.kqoUY-stIdwOw3vtpowcbzV_AvjgGtzXN6i9bjQCW-Y",je=RC(MC,jC),LC=()=>{var I,A;const e=ve.useRef(null),t=ve.useRef(null),[r,n]=ve.useState(null),[i,a]=ve.useState(""),[l,o]=ve.useState(""),[s,c]=ve.useState("A"),[d,f]=ve.useState("#5E5CE6"),[h,u]=ve.useState(!1),[p,m]=ve.useState([]),[g,v]=ve.useState([]),[x,y]=ve.useState(null),_=ve.useRef(null),[w,T]=ve.useState(null),k=ve.useRef(null),[O,F]=ve.useState(null),M=ve.useRef(null),V=ve.useRef(null);ve.useEffect(()=>{_.current=x},[x]),ve.useEffect(()=>{k.current=w},[w]),ve.useEffect(()=>{M.current=O},[O]);const X=()=>t.current?t.current.getObjects().map(b=>({...b.data,pos_x:Math.round(b.left),pos_y:Math.round(b.top),rotation:Math.round(b.angle||0),width:Math.round(b.width*b.scaleX),height:Math.round(b.height*b.scaleY)})):[],q=()=>{const b=X();m(P=>[...P.slice(-19),b])};ve.useEffect(()=>{if(!e.current)return;let b=!0;t.current&&t.current.dispose(),e.current.innerHTML="";const P=document.createElement("canvas");e.current.appendChild(P);const R=new Qe.fabric.Canvas(P,{width:1e3,height:600,backgroundColor:"transparent",selection:!0});t.current=R,(async()=>{var te;u(!0);const{data:Q,error:H}=await je.from("seats").select("*").order("global_number",{ascending:!0});if(b){if(H)console.error("Error loading seats:",H);else if(Q&&Q.length>0){t.current&&t.current.clear();const ee=Math.min(...Q.map(Me=>Me.pos_x)),oe=Math.max(...Q.map(Me=>Me.pos_x+(Me.width||72)))-ee,ce=((te=e.current)==null?void 0:te.clientWidth)||oe,ye=Math.max(oe,ce),_e=(ye-oe)/2-ee,de=Math.min(...Q.map(Me=>Me.pos_y)),Ae=Math.max(...Q.map(Me=>Me.pos_y+(Me.height||72)))-de,Re=-de,De=Ae;t.current.setDimensions({width:ye,height:De}),Q.forEach(Me=>{ne({...Me,pos_x:Me.pos_x+_e,pos_y:Me.pos_y+Re});const Ke=t.current.getObjects().find(Ze=>Ze.data.id===Me.id);Ke&&delete Ke.data.isDirty}),t.current.renderAll()}u(!1)}})(),R.on("mouse:down",Q=>{var H,te,ee,Z;if(_.current==="structure"){R.selection=!1;const oe=R.getPointer(Q.e);T({x:oe.x,y:oe.y});const ce=new Qe.fabric.Rect({left:oe.x,top:oe.y,width:0,height:0,fill:"#E5E5EA",rx:6,ry:6,stroke:"#C7C7CC",strokeWidth:1,opacity:.7});R.add(ce),F(ce);return}Q.target?q():(R.isDragging=!0,R.selection=!0,R.lastPosX=Q.e.clientX||((te=(H=Q.e.touches)==null?void 0:H[0])==null?void 0:te.clientX),R.lastPosY=Q.e.clientY||((Z=(ee=Q.e.touches)==null?void 0:ee[0])==null?void 0:Z.clientY))});const z=async()=>{if(p.length===0)return;const Q=p[p.length-1],H=p.slice(0,-1);m(H),t.current.clear(),Q.forEach(te=>{ne({id:te.id,seat_number:te.seatNumber,display_number:te.displayNumber,zone_name:te.zoneName,zone_color:te.zoneColor,pos_x:te.pos_x,pos_y:te.pos_y,width:te.width,height:te.height,label:te.label,type:te.type,rotation:te.rotation,global_number:te.globalNumber})})},Y=()=>{const Q=R.getActiveObject();Q&&Q.clone(H=>{V.current=H},["data"])},ie=()=>{if(!V.current||!t.current)return;const Q=t.current;q();try{V.current.clone(H=>{var te,ee,Z;if(!(!Q.getElement()||!Q.contextContainer)){if(Q.discardActiveObject(),H.set({left:H.left+20,top:H.top+20,evented:!0}),H.type==="activeSelection"){const oe=[];H.forEachObject(ye=>{var Ae,Re;const _e=crypto.randomUUID();let de=((Ae=ye.data)==null?void 0:Ae.type)==="structure";!de&&((Re=ye.data)!=null&&Re.label)&&(de=!0);const be=ye.data||{};de&&(delete be.zoneName,delete be.zoneColor,delete be.displayNumber),ye.set("data",{...be,id:_e,isDirty:!0,type:de?"structure":"seat",seatNumber:be.seatNumber||(de?`STR_${_e.slice(-8)}`:"0")}),Q.add(ye),oe.push(ye)});const ce=new Qe.fabric.ActiveSelection(oe,{canvas:Q});Q.setActiveObject(ce),ce.setCoords()}else{const oe=crypto.randomUUID();let ce=((te=H.data)==null?void 0:te.type)==="structure";if(!ce&&((ee=H.data)!=null&&ee.label)&&(ce=!0),ce){const _e=((Z=H.data)==null?void 0:Z.label)||"",de=prompt("  ",_e);if(de){H.data={...H.data,label:de,type:"structure"};const be=H.getObjects().find(Ae=>Ae.type==="i-text");be&&be.set("text",de)}}const ye=H.data||{};ce&&(delete ye.zoneName,delete ye.zoneColor,delete ye.displayNumber),H.set("data",{...ye,id:oe,isDirty:!0,type:ce?"structure":"seat",seatNumber:ce?`STR_${oe.slice(-8)}`:ye.seatNumber||"0"}),Q.add(H),Q.setActiveObject(H)}Q.requestRenderAll()}},["data"])}catch(H){console.error("Error pasting objects:",H)}},N=Q=>{(Q.ctrlKey||Q.metaKey)&&Q.key==="z"&&(Q.preventDefault(),z()),(Q.ctrlKey||Q.metaKey)&&Q.key==="c"&&document.activeElement.tagName!=="INPUT"&&document.activeElement.tagName!=="TEXTAREA"&&(Q.preventDefault(),Y()),(Q.ctrlKey||Q.metaKey)&&Q.key==="v"&&document.activeElement.tagName!=="INPUT"&&document.activeElement.tagName!=="TEXTAREA"&&(Q.preventDefault(),ie())};return window.addEventListener("keydown",N),R.on("mouse:move",Q=>{var H,te,ee,Z;if(_.current==="structure"&&k.current&&M.current){const oe=R.getPointer(Q.e),ce=k.current,ye=M.current,_e=Math.abs(oe.x-ce.x),de=Math.abs(oe.y-ce.y),be=Math.min(oe.x,ce.x),Ae=Math.min(oe.y,ce.y);ye.set({width:_e,height:de,left:be,top:Ae}),R.requestRenderAll();return}if(R.isDragging){const oe=Q.e,ce=oe.clientX||((te=(H=oe.touches)==null?void 0:H[0])==null?void 0:te.clientX),ye=oe.clientY||((Z=(ee=oe.touches)==null?void 0:ee[0])==null?void 0:Z.clientY),_e=R.viewportTransform;_e[4]+=ce-R.lastPosX,_e[5]+=ye-R.lastPosY,R.requestRenderAll(),R.lastPosX=ce,R.lastPosY=ye}}),R.on("mouse:wheel",Q=>{var oe;const H=Q.e.deltaY,te=R.viewportTransform;te[5]-=H;const ee=((oe=e.current)==null?void 0:oe.clientHeight)||0,Z=R.getHeight();ee>0&&te[5]<-(Z-ee)&&(te[5]=-(Z-ee)),R.requestRenderAll(),Q.e.preventDefault(),Q.e.stopPropagation()}),R.on("object:scaling",Q=>{const H=Q.target;if(H&&H.data){const te=H.getObjects().find(ee=>ee.type==="i-text");te&&te.set({scaleX:1/H.scaleX,scaleY:1/H.scaleY})}}),R.on("mouse:dblclick",Q=>{const H=Q.target;if(!H||!H.data)return;const te=H.data.type;if(te!=="seat"&&te!=="structure")return;const ee=H.getObjects().find(_e=>_e.type==="i-text");if(!ee)return;q();const Z={...H.data},oe=H.left,ce=H.top,ye=H.angle;H._restoreObjectsState(),R.remove(H),H.getObjects().forEach(_e=>{R.add(_e),_e===ee&&(R.setActiveObject(_e),_e.enterEditing(),_e.selectAll())}),R.requestRenderAll(),ee.on("editing:exited",()=>{const _e=ee.text;te==="structure"&&(Z.label=_e),te==="seat"&&(Z.displayNumber=_e);const be=[H.getObjects().find(Re=>Re.type==="rect"),ee];be.forEach(Re=>R.remove(Re));const Ae=new Qe.fabric.Group(be,{left:oe,top:ce,angle:ye,hasControls:!0,lockRotation:!1,subTargetCheck:!0});Ae.data=Z,Ae.data.isDirty=!0,te==="seat"?Ae.set({borderColor:Z.zoneColor||"#5E5CE6",cornerColor:"white",cornerStrokeColor:"#5E5CE6",transparentCorners:!1}):Ae.set({borderColor:"#007AFF",cornerColor:"white",cornerStrokeColor:"#007AFF",transparentCorners:!1}),R.add(Ae),R.setActiveObject(Ae),R.requestRenderAll(),ee.off("editing:exited")})}),R.on("mouse:up",()=>{if(_.current==="structure"&&M.current){const Q=M.current,H=Q.width,te=Q.height,ee=Q.left,Z=Q.top;R.remove(Q),F(null),T(null),y(null),H>20&&te>20&&setTimeout(()=>{const oe=prompt("  (: , , )","");oe&&(q(),ae(ee,Z,H,te,oe))},50);return}R.isDragging&&(R.setViewportTransform(R.viewportTransform),R.isDragging=!1)}),R.on("selection:created",Q=>{var te,ee,Z,oe,ce;const H=Q.selected;if(H.length===1){const ye=H[0];n(ye),((te=ye.data)==null?void 0:te.type)!=="structure"&&(a(((ee=ye.data)==null?void 0:ee.seatNumber)||""),o(((Z=ye.data)==null?void 0:Z.displayNumber)||""),c(((oe=ye.data)==null?void 0:oe.zoneName)||"A"),f(((ce=ye.data)==null?void 0:ce.zoneColor)||"#5E5CE6"))}else n(null)}),R.on("selection:updated",Q=>{var te,ee,Z,oe,ce;const H=Q.selected;if(H.length===1){const ye=H[0];n(ye),((te=ye.data)==null?void 0:te.type)!=="structure"&&(a(((ee=ye.data)==null?void 0:ee.seatNumber)||""),o(((Z=ye.data)==null?void 0:Z.displayNumber)||""),c(((oe=ye.data)==null?void 0:oe.zoneName)||"A"),f(((ce=ye.data)==null?void 0:ce.zoneColor)||"#5E5CE6"))}else n(null)}),R.on("selection:cleared",()=>{n(null),a(""),o("")}),R.on("object:modified",async Q=>{const H=Q.target;if(!H)return;(H.type==="activeSelection"?H.getObjects():[H]).forEach(ee=>{var Z;if(ee.data){const oe=ee.width*ee.scaleX,ce=ee.height*ee.scaleY;ee.set({width:oe,height:ce,scaleX:1,scaleY:1});const ye=ee.getObjects().find(_e=>_e.type==="i-text");if(ye){ye.set({scaleX:1,scaleY:1}),((Z=ee.data)==null?void 0:Z.type)==="structure"?ye.set({left:0,top:0,originX:"center",originY:"center"}):ye.set({left:-oe/2+6,top:-ce/2+6,originX:"left",originY:"top"});const _e=ee.getObjects().find(de=>de.type==="rect");_e&&(_e.set({width:oe,height:ce}),_e.set({left:-oe/2,top:-ce/2})),ee.addWithUpdate()}}ee.data&&(ee.data.isDirty=!0)})}),()=>{b=!1,window.removeEventListener("keydown",N),R.dispose(),t.current=null}},[]);const ae=(b,P,R,W,z)=>{const Y=new Qe.fabric.Rect({fill:"#E5E5EA",width:R,height:W,rx:6,ry:6,stroke:"#D1D1D6",strokeWidth:1}),ie=new Qe.fabric.IText(z,{fontSize:12,originX:"center",originY:"center",left:R/2,top:W/2,fill:"#8E8E93",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),N=crypto.randomUUID(),Q=new Qe.fabric.Group([Y,ie],{left:b,top:P,data:{id:N,type:"structure",label:z,width:R,height:W,isDirty:!0,seatNumber:`STR_${N.slice(-8)}`}});t.current.add(Q),t.current.setActiveObject(Q)},ne=b=>{if(b.type==="structure"){const z=new Qe.fabric.Rect({fill:"#E5E5EA",width:b.width||72,height:b.height||72,rx:6,ry:6,stroke:"#D1D1D6",strokeWidth:1}),Y=new Qe.fabric.IText(b.label||"",{fontSize:12,originX:"center",originY:"center",left:(b.width||72)/2,top:(b.height||72)/2,fill:"#8E8E93",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),ie=new Qe.fabric.Group([z,Y],{id:b.id,left:b.pos_x,top:b.pos_y,angle:b.rotation,data:{id:b.id,type:"structure",label:b.label,width:b.width,height:b.height}});t.current.add(ie);return}const P=new Qe.fabric.Rect({fill:b.zone_color||"#5E5CE6",width:72,height:72,rx:6,ry:6,stroke:"rgba(255,255,255,0.1)",strokeWidth:2}),R=new Qe.fabric.IText(b.display_number||b.seat_number,{fontSize:12,left:6,top:6,fill:"#ffffff",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"900",selectable:!1}),W=new Qe.fabric.Group([P,R],{left:b.pos_x,top:b.pos_y,angle:b.rotation,data:{id:b.id,type:"seat",seatNumber:b.seat_number,displayNumber:b.display_number,zoneName:b.zone_name,zoneColor:b.zone_color,globalNumber:b.global_number}});t.current.add(W)},re=()=>{var b;if(r&&((b=r.data)==null?void 0:b.type)!=="structure"){q(),r.set("data",{...r.data,seatNumber:i,displayNumber:l,zoneName:s,zoneColor:d});const P=r.getObjects().find(W=>W.type==="i-text");P&&P.set("text",l);const R=r.getObjects().find(W=>W.type==="rect");R&&R.set("fill",d),t.current.renderAll()}},le=()=>{q();const P=`${t.current.getObjects().filter(Y=>{var ie;return((ie=Y.data)==null?void 0:ie.type)!=="structure"}).length+1}`,R=new Qe.fabric.Rect({fill:d,width:72,height:72,rx:6,ry:6,stroke:"rgba(255,255,255,0.1)",strokeWidth:2}),W=new Qe.fabric.IText(P,{fontSize:18,originX:"center",originY:"center",left:36,top:36,fill:"#ffffff",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"900",selectable:!1}),z=new Qe.fabric.Group([R,W],{left:150,top:150,data:{id:crypto.randomUUID(),type:"seat",seatNumber:P,zoneName:s,zoneColor:d,isDirty:!0}});t.current.add(z),t.current.setActiveObject(z)},se=async()=>{const b=t.current;if(!b)return;const P=b.getActiveObject();if(P){q();const R=P.type==="activeSelection"?P.getObjects():[P],W=[];R.forEach(z=>{var ie;const Y=(ie=z.data)==null?void 0:ie.id;Y&&Y.length>20&&W.push(Y)}),v(z=>[...z,...W]),b.discardActiveObject(),R.forEach(z=>b.remove(z)),b.requestRenderAll(),n(null)}},C=()=>{q();const b=t.current.getObjects(),P=["A","B","C"];let R=1;P.forEach(W=>{b.filter(Y=>{var ie,N;return((ie=Y.data)==null?void 0:ie.zoneName)===W&&((N=Y.data)==null?void 0:N.type)!=="structure"}).sort((Y,ie)=>Math.abs(Y.top-ie.top)<20?Y.left-ie.left:Y.top-ie.top).forEach((Y,ie)=>{const N=ie+1,Q=`${W}-${N.toString().padStart(2,"0")}`;Y.set("data",{...Y.data,seatNumber:N.toString(),displayNumber:Q,globalNumber:R++});const H=Y.getObjects().find(te=>te.type==="i-text");H&&H.set("text",Q)})}),t.current.renderAll()},j=()=>{const b=t.current.getActiveObject();b&&(q(),b.rotate(((b.angle||0)+90)%360),t.current.renderAll())},L=async()=>{u(!0);try{if(g.length>0){const{error:W}=await je.from("seats").delete().in("id",g);if(W)throw console.error("Error deleting items:",W),W}const b=t.current.getObjects(),P=[],R=[];if(b.forEach(W=>{var H,te,ee,Z,oe,ce,ye,_e,de;const z=Math.round(W.getScaledWidth()),Y=Math.round(W.getScaledHeight()),ie=((H=W.data)==null?void 0:H.type)==="structure",N=((te=W.data)==null?void 0:te.seatNumber)||(ie?`STR_${W.data.id.slice(-8)}`:"0"),Q={pos_x:Math.round(W.left),pos_y:Math.round(W.top),rotation:Math.round(W.angle||0),type:((ee=W.data)==null?void 0:ee.type)||"seat",width:z,height:Y,label:((Z=W.data)==null?void 0:Z.label)||null,seat_number:N,display_number:((oe=W.data)==null?void 0:oe.displayNumber)||null,zone_name:((ce=W.data)==null?void 0:ce.zoneName)||null,zone_color:((ye=W.data)==null?void 0:ye.zoneColor)||null,global_number:((_e=W.data)==null?void 0:_e.globalNumber)||null};(de=W.data)!=null&&de.id&&W.data.id.length>20?(Q.id=W.data.id,P.push(Q)):R.push(Q)}),P.length>0){const{error:W}=await je.from("seats").upsert(P);if(W)throw W}if(R.length>0){const{error:W}=await je.from("seats").insert(R);if(W)throw W}alert("."),v([]),t.current.getObjects().forEach(W=>{W.data&&delete W.data.isDirty}),window.location.reload()}catch(b){console.error("Error saving layout:",b),alert(" : "+(b.message||b.details||JSON.stringify(b)))}finally{u(!1)}},E=()=>{q();const b=t.current.getObjects(),P=30,R=b.filter(ie=>{var N;return(N=ie.data)==null?void 0:N.isDirty}),W=b.filter(ie=>{var N;return!((N=ie.data)!=null&&N.isDirty)}),z=W.map(ie=>Math.round(ie.left)),Y=W.map(ie=>Math.round(ie.top));R.forEach(ie=>{let N=ie.left,Q=ie.top,H=N,te=1/0;z.forEach(oe=>{const ce=Math.abs(N-oe);ce<P&&ce<te&&(te=ce,H=oe)}),te<P&&ie.set("left",H);let ee=Q,Z=1/0;Y.forEach(oe=>{const ce=Math.abs(Q-oe);ce<P&&ce<Z&&(Z=ce,ee=oe)}),Z<P&&ie.set("top",ee),ie.setCoords()}),t.current.renderAll()};return S.jsxs("div",{className:"flex flex-col xl:flex-row gap-6 items-stretch w-full h-full mx-auto leading-normal overflow-hidden relative",children:[h&&S.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-30 flex items-center justify-center pointer-events-none",children:S.jsx("div",{className:"w-8 h-8 border-3 border-ios-indigo border-t-transparent rounded-full animate-spin"})}),S.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:S.jsx("div",{className:"flex-1 w-full bg-white rounded-t-[6px] rounded-b-none border-0 overflow-hidden p-2.5 pb-0",children:S.jsx("div",{ref:e,className:"flex-1 h-full relative overflow-hidden cursor-grab active:cursor-grabbing touch-none select-none scrollbar-hide"})})}),S.jsx("div",{className:"w-full xl:w-80 h-full overflow-y-auto scrollbar-hide space-y-6 animate-spring-up",children:S.jsxs("div",{className:"bg-white border border-gray-100 rounded-[6px] p-6 space-y-8 shadow-sm",children:[S.jsxs("div",{className:"space-y-3",children:[S.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-ios-gray",children:" "}),x==="structure"&&S.jsx("div",{className:"bg-ios-indigo/10 text-ios-indigo text-xs font-bold p-3 rounded-[6px] text-center animate-pulse mb-2",children:"    "}),S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("button",{onClick:le,className:"flex flex-col items-center justify-center gap-2 bg-gray-50 hover:bg-gray-100 p-4 rounded-[6px] transition-all border border-gray-100 ios-tap group",children:[S.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center group-hover:scale-110 transition-transform",children:S.jsx($c,{className:"w-5 h-5 text-ios-indigo"})}),S.jsx("span",{className:"font-black text-[10px] text-[#1C1C1E]",children:" "})]}),S.jsxs("button",{onClick:()=>y(b=>b==="structure"?null:"structure"),className:`flex flex-col items-center justify-center gap-2 p-4 rounded-[6px] transition-all border ios-tap group ${x==="structure"?"bg-gray-100 border-ios-indigo ring-1 ring-ios-indigo":"bg-gray-50 hover:bg-gray-100 border-gray-100"}`,children:[S.jsx("div",{className:"w-10 h-10 rounded-[6px] flex items-center justify-center group-hover:scale-110 transition-transform bg-ios-indigo/10",children:S.jsx(yk,{className:"w-5 h-5 text-ios-indigo"})}),S.jsx("span",{className:"font-black text-[10px] text-[#1C1C1E]",children:" "})]})]}),S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("button",{onClick:C,className:"w-full flex items-center justify-center gap-2 bg-gray-50 hover:bg-gray-100 p-4 rounded-[6px] transition-all border border-gray-100 ios-tap",children:[S.jsx(vk,{className:"w-4 h-4 text-ios-amber"}),S.jsx("span",{className:"font-black text-[10px] text-[#1C1C1E]",children:" "})]}),S.jsxs("button",{onClick:E,className:"w-full flex items-center justify-center gap-2 bg-gray-50 hover:bg-gray-100 p-4 rounded-[6px] transition-all border border-gray-100 ios-tap",children:[S.jsx(gk,{className:"w-4 h-4 text-ios-emerald"}),S.jsx("span",{className:"font-black text-[10px] text-[#1C1C1E]",children:" "})]})]}),S.jsxs("button",{onClick:L,disabled:h,className:"w-full flex items-center justify-center gap-2 bg-gray-50 hover:bg-gray-100 p-4 rounded-[6px] transition-all border border-gray-100 ios-tap disabled:opacity-50 group mt-2",children:[S.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center group-hover:scale-110 transition-transform",children:S.jsx(Gc,{className:`w-5 h-5 text-ios-indigo ${h?"animate-spin":""}`})}),S.jsx("span",{className:"font-black text-[10px] text-[#1C1C1E]",children:" "})]})]}),S.jsxs("div",{className:`space-y-6 transition-all duration-300 ${r?"opacity-100 translate-y-0":"opacity-20 translate-y-2 pointer-events-none filter blur-[2px]"}`,children:[S.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-ios-gray",children:" "}),((I=r==null?void 0:r.data)==null?void 0:I.type)!=="structure"&&S.jsx(S.Fragment,{children:S.jsxs("div",{className:"space-y-4",children:[S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:"Display No"}),S.jsx("input",{type:"text",value:l,onChange:b=>o(b.target.value),className:"w-full bg-white border border-gray-200 rounded-[6px] p-3 text-sm font-black text-[#1C1C1E] focus:ring-1 focus:ring-ios-indigo transition-all",placeholder:": A-01"})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:"Zone"}),S.jsxs("select",{value:s,onChange:b=>c(b.target.value),className:"w-full bg-white border border-gray-200 rounded-[6px] p-3 text-sm font-black text-[#1C1C1E] focus:ring-1 focus:ring-ios-indigo appearance-none",children:[S.jsx("option",{value:"A",children:"Zone A"}),S.jsx("option",{value:"B",children:"Zone B"}),S.jsx("option",{value:"C",children:"Zone C"})]})]})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsxs("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1 flex items-center gap-1.5",children:[S.jsx(Ak,{className:"w-2.5 h-2.5"})," Zone Color"]}),S.jsxs("div",{className:"flex gap-2",children:[S.jsx("input",{type:"color",value:d,onChange:b=>f(b.target.value),className:"w-12 h-12 bg-transparent border-0 rounded-[6px] cursor-pointer overflow-hidden p-0 shadow-sm"}),S.jsx("input",{type:"text",value:d.toUpperCase(),onChange:b=>f(b.target.value),className:"flex-1 bg-white border border-gray-200 rounded-[6px] p-3 text-sm font-black text-[#1C1C1E] focus:ring-1 focus:ring-ios-indigo"})]})]}),S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsx("button",{onClick:()=>n(null),className:"w-full bg-gray-100 text-gray-500 py-4 rounded-[6px] font-black text-xs hover:bg-gray-200 ios-tap",children:"/"}),S.jsx("button",{onClick:re,className:"w-full bg-[#1C1C1E] text-white py-4 rounded-[6px] font-black text-xs shadow-sm shadow-black/10 ios-tap",children:" "})]})]})}),((A=r==null?void 0:r.data)==null?void 0:A.type)==="structure"&&S.jsx("div",{className:"py-4 text-center",children:S.jsx("p",{className:"text-xs text-ios-gray",children:" //  ."})}),S.jsxs("div",{className:"grid grid-cols-2 gap-3 pb-2",children:[S.jsxs("button",{onClick:j,className:"flex items-center justify-center gap-2 bg-gray-50 hover:bg-gray-100 p-4 rounded-[6px] transition-all border border-gray-100 ios-tap",children:[S.jsx(Bk,{className:"w-4 h-4 text-ios-blue"}),S.jsx("span",{className:"font-black text-[10px] text-[#1C1C1E]",children:""})]}),S.jsxs("button",{onClick:se,className:"flex items-center justify-center gap-2 bg-ios-rose/5 hover:bg-ios-rose/10 text-ios-rose p-4 rounded-[6px] transition-all border border-ios-rose/10 ios-tap",children:[S.jsx(sd,{className:"w-4 h-4"}),S.jsx("span",{className:"font-black text-[10px]",children:""})]})]})]})]})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Jc={};Jc.version="0.18.5";var D1=1252,BC=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ud={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},fd=function(e){BC.indexOf(e)!=-1&&(D1=ud[0]=e)};function UC(){fd(1252)}var yn=function(e){fd(e)};function hd(){yn(1200),UC()}function Bg(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function WC(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function R1(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var ro=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?WC(e.slice(2)):t==254&&r==255?R1(e.slice(2)):t==65279?e.slice(1):e},ql=function(t){return String.fromCharCode(t)},Ug=function(t){return String.fromCharCode(t)},qo,_i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Jo(e){for(var t="",r=0,n=0,i=0,a=0,l=0,o=0,s=0,c=0;c<e.length;)r=e.charCodeAt(c++),a=r>>2,n=e.charCodeAt(c++),l=(r&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,s=i&63,isNaN(n)?o=s=64:isNaN(i)&&(s=64),t+=_i.charAt(a)+_i.charAt(l)+_i.charAt(o)+_i.charAt(s);return t}function Gr(e){var t="",r=0,n=0,i=0,a=0,l=0,o=0,s=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)a=_i.indexOf(e.charAt(c++)),l=_i.indexOf(e.charAt(c++)),r=a<<2|l>>4,t+=String.fromCharCode(r),o=_i.indexOf(e.charAt(c++)),n=(l&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),s=_i.indexOf(e.charAt(c++)),i=(o&3)<<6|s,s!==64&&(t+=String.fromCharCode(i));return t}var Ye=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),si=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ni(e){return Ye?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Wg(e){return Ye?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Hr=function(t){return Ye?si(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ru(e){if(typeof ArrayBuffer>"u")return Hr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Bi(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function HC(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function dd(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return dd(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Qt=Ye?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:si(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function zC(e){for(var t=[],r=0,n=e.length+250,i=Ni(e.length+255),a=0;a<e.length;++a){var l=e.charCodeAt(a);if(l<128)i[r++]=l;else if(l<2048)i[r++]=192|l>>6&31,i[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++a)&1023;i[r++]=240|l>>8&7,i[r++]=128|l>>2&63,i[r++]=128|o>>6&15|(l&3)<<4,i[r++]=128|o&63}else i[r++]=224|l>>12&15,i[r++]=128|l>>6&63,i[r++]=128|l&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Ni(65535),n=65530)}return t.push(i.slice(0,r)),Qt(t)}var Cr=/\u0000/g,no=/[\u0001-\u0006]/g;function ds(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function _n(e,t){var r=""+e;return r.length>=t?r:Nt("0",t-r.length)+r}function pd(e,t){var r=""+e;return r.length>=t?r:Nt(" ",t-r.length)+r}function Qc(e,t){var r=""+e;return r.length>=t?r:r+Nt(" ",t-r.length)}function VC(e,t){var r=""+Math.round(e);return r.length>=t?r:Nt("0",t-r.length)+r}function XC(e,t){var r=""+e;return r.length>=t?r:Nt("0",t-r.length)+r}var Hg=Math.pow(2,32);function Ma(e,t){if(e>Hg||e<-Hg)return VC(e,t);var r=Math.round(e);return XC(r,t)}function Zc(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var zg=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Af=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function $C(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Be={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Vg={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},GC={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function eu(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,l=1,o=0,s=1,c=0,d=0,f=Math.floor(i);c<t&&(f=Math.floor(i),o=f*l+a,d=f*c+s,!(i-f<5e-8));)i=1/(i-f),a=l,l=o,s=c,c=d;if(d>t&&(c>t?(d=s,o=a):(d=c,o=l)),!r)return[0,n*o,d];var h=Math.floor(n*o/d);return[h,n*o-h*d,d]}function ra(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),a=0,l=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)l=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var s=new Date(1900,0,1);s.setDate(s.getDate()+n-1),l=[s.getFullYear(),s.getMonth()+1,s.getDate()],a=s.getDay(),n<60&&(a=(a+6)%7),r&&(a=ZC(s,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=a,o}var I1=new Date(1899,11,31,0,0,0),YC=I1.getTime(),KC=new Date(1900,2,1,0,0,0);function M1(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=KC&&(r+=24*60*60*1e3),(r-(YC+(e.getTimezoneOffset()-I1.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function gd(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function qC(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function JC(e){var t=e<0?12:11,r=gd(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function QC(e){var t=gd(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Qo(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=JC(e):t===10?r=e.toFixed(10).substr(0,12):r=QC(e),gd(qC(r.toUpperCase()))}function pa(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Qo(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return un(14,M1(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function ZC(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function eE(e,t,r,n){var i="",a=0,l=0,o=r.y,s,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:s=o%100,c=2;break;default:s=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:s=r.m,c=t.length;break;case 3:return Af[r.m-1][1];case 5:return Af[r.m-1][0];default:return Af[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:s=r.d,c=t.length;break;case 3:return zg[r.q][0];default:return zg[r.q][1]}break;case 104:switch(t.length){case 1:case 2:s=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:s=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:s=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?_n(r.S,t.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,a=Math.round(l*(r.S+r.u)),a>=60*l&&(a=0),t==="s"?a===0?"0":""+a/l:(i=_n(a,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":s=r.D*24+r.H;break;case"[m]":case"[mm]":s=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":s=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:s=o,c=1;break}var d=c>0?_n(s,c):"";return d}function wi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var j1=/%/g;function tE(e,t,r){var n=t.replace(j1,""),i=t.length-n.length;return Kn(e,n,r*Math.pow(10,2*i))+Nt("%",i)}function rE(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Kn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function L1(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+L1(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+a):r+="E+"+(l-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,s,c,d){return s+c+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var B1=/# (\?+)( ?)\/( ?)(\d+)/;function nE(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n),l=i-a*n,o=n;return r+(a===0?"":""+a)+" "+(l===0?Nt(" ",e[1].length+1+e[4].length):pd(l,e[1].length)+e[2]+"/"+e[3]+_n(o,e[4].length))}function iE(e,t,r){return r+(t===0?"":""+t)+Nt(" ",e[1].length+2+e[4].length)}var U1=/^#*0*\.([0#]+)/,W1=/\).*[0#]/,H1=/\(###\) ###\\?-####/;function kr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Xg(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function $g(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function aE(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function sE(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Jr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(W1)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Jr("n",n,r):"("+Jr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return rE(e,t,r);if(t.indexOf("%")!==-1)return tE(e,t,r);if(t.indexOf("E")!==-1)return L1(t,r);if(t.charCodeAt(0)===36)return"$"+Jr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,l,o,s=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Ma(s,t.length);if(t.match(/^[#?]+$/))return i=Ma(r,0),i==="0"&&(i=""),i.length>t.length?i:kr(t.substr(0,t.length-i.length))+i;if(a=t.match(B1))return nE(a,s,c);if(t.match(/^#+0+$/))return c+Ma(s,t.length-t.indexOf("0"));if(a=t.match(U1))return i=Xg(r,a[1].length).replace(/^([^\.]+)$/,"$1."+kr(a[1])).replace(/\.$/,"."+kr(a[1])).replace(/\.(\d*)$/,function(p,m){return"."+m+Nt("0",kr(a[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+Xg(s,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+wi(Ma(s,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Jr(e,t,-r):wi(""+(Math.floor(r)+aE(r,a[1].length)))+"."+_n($g(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Jr(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ds(Jr(e,t.replace(/[\\-]/g,""),r)),l=0,ds(ds(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<i.length?i.charAt(l++):p==="0"?"0":""}));if(t.match(H1))return i=Jr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(a[4].length,7),o=eu(s,Math.pow(10,l)-1,!1),i=""+c,d=Kn("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Qc(o[2],l),d.length<a[4].length&&(d=kr(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(a[1].length,a[4].length),7),o=eu(s,Math.pow(10,l)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?pd(o[1],l)+a[2]+"/"+a[3]+Qc(o[2],l):Nt(" ",2*l+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=Ma(r,0),t.length<=i.length?i:kr(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),l=i.indexOf(".");var f=t.indexOf(".")-l,h=t.length-i.length-f;return kr(t.substr(0,f)+i+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return l=$g(r,a[1].length),r<0?"-"+Jr(e,t,-r):wi(sE(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?_n(0,3-p.length):"")+p})+"."+_n(l,a[1].length);switch(t){case"###,##0.00":return Jr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var u=wi(Ma(s,0));return u!=="0"?c+u:"";case"###,###.00":return Jr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Jr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function oE(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Kn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function lE(e,t,r){var n=t.replace(j1,""),i=t.length-n.length;return Kn(e,n,r*Math.pow(10,2*i))+Nt("%",i)}function z1(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+z1(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+a):r+="E+"+(l-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,s,c,d){return s+c+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Fn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(W1)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Fn("n",n,r):"("+Fn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return oE(e,t,r);if(t.indexOf("%")!==-1)return lE(e,t,r);if(t.indexOf("E")!==-1)return z1(t,r);if(t.charCodeAt(0)===36)return"$"+Fn(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,l,o,s=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+_n(s,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:kr(t.substr(0,t.length-i.length))+i;if(a=t.match(B1))return iE(a,s,c);if(t.match(/^#+0+$/))return c+_n(s,t.length-t.indexOf("0"));if(a=t.match(U1))return i=(""+r).replace(/^([^\.]+)$/,"$1."+kr(a[1])).replace(/\.$/,"."+kr(a[1])),i=i.replace(/\.(\d*)$/,function(p,m){return"."+m+Nt("0",kr(a[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+(""+s).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+wi(""+s);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Fn(e,t,-r):wi(""+r)+"."+Nt("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Fn(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ds(Fn(e,t.replace(/[\\-]/g,""),r)),l=0,ds(ds(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<i.length?i.charAt(l++):p==="0"?"0":""}));if(t.match(H1))return i=Fn(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(a[4].length,7),o=eu(s,Math.pow(10,l)-1,!1),i=""+c,d=Kn("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Qc(o[2],l),d.length<a[4].length&&(d=kr(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(a[1].length,a[4].length),7),o=eu(s,Math.pow(10,l)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?pd(o[1],l)+a[2]+"/"+a[3]+Qc(o[2],l):Nt(" ",2*l+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:kr(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),l=i.indexOf(".");var f=t.indexOf(".")-l,h=t.length-i.length-f;return kr(t.substr(0,f)+i+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Fn(e,t,-r):wi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?_n(0,3-p.length):"")+p})+"."+_n(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var u=wi(""+s);return u!=="0"?c+u:"";default:if(t.match(/\.[0#?]*$/))return Fn(e,t.slice(0,t.lastIndexOf(".")),r)+kr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Kn(e,t,r){return(r|0)===r?Fn(e,t,r):Jr(e,t,r)}function cE(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var V1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ds(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Zc(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(V1))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function uE(e,t,r,n){for(var i=[],a="",l=0,o="",s="t",c,d,f,h="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!Zc(e,l))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},l+=7;break;case'"':for(a="";(f=e.charCodeAt(++l))!==34&&l<e.length;)a+=String.fromCharCode(f);i[i.length]={t:"t",v:a},++l;break;case"\\":var u=e.charAt(++l),p=u==="("||u===")"?u:"t";i[i.length]={t:p,v:u},++l;break;case"_":i[i.length]={t:"t",v:" "},l+=2;break;case"@":i[i.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(c==null&&(c=ra(t,r,e.charAt(l+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(l,2)},s=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=ra(t,r),c==null))return"";for(a=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)a+=o;o==="m"&&s.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),i[i.length]={t:o,v:a},s=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=ra(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",h="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",l+=5,h="h"):e.substr(l,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",l+=5,h="h"):(m.t="t",++l),c==null&&m.t==="T")return"";i[i.length]=m,s=o;break;case"[":for(a=o;e.charAt(l++)!=="]"&&l<e.length;)a+=e.charAt(l);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(V1)){if(c==null&&(c=ra(t,r),c==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},s=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ds(e)||(i[i.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=o;++l<e.length&&(o=e.charAt(l))==="0";)a+=o;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)a+=o;i[i.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++l)===o;)a+=o;i[i.length]={t:o,v:a},s=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)a+=e.charAt(l);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:o,v:o},++l;break;case"$":i[i.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++l;break}var g=0,v=0,x;for(l=i.length-1,s="t";l>=0;--l)switch(i[l].t){case"h":case"H":i[l].t=h,s="h",g<1&&(g=1);break;case"s":(x=i[l].v.match(/\.0+$/))&&(v=Math.max(v,x[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":s=i[l].t;break;case"m":s==="s"&&(i[l].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&i[l].v.match(/[Hh]/)&&(g=1),g<2&&i[l].v.match(/[Mm]/)&&(g=2),g<3&&i[l].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",_;for(l=0;l<i.length;++l)switch(i[l].t){case"t":case"T":case" ":case"D":break;case"X":i[l].v="",i[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[l].v=eE(i[l].t.charCodeAt(0),i[l].v,c,v),i[l].t="t";break;case"n":case"?":for(_=l+1;i[_]!=null&&((o=i[_].t)==="?"||o==="D"||(o===" "||o==="t")&&i[_+1]!=null&&(i[_+1].t==="?"||i[_+1].t==="t"&&i[_+1].v==="/")||i[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[_].v==="/"||i[_].v===" "&&i[_+1]!=null&&i[_+1].t=="?"));)i[l].v+=i[_].v,i[_]={v:"",t:";"},++_;y+=i[l].v,l=_-1;break;case"G":i[l].t="t",i[l].v=pa(t,r);break}var w="",T,k;if(y.length>0){y.charCodeAt(0)==40?(T=t<0&&y.charCodeAt(0)===45?-t:t,k=Kn("n",y,T)):(T=t<0&&n>1?-t:t,k=Kn("n",y,T),T<0&&i[0]&&i[0].t=="t"&&(k=k.substr(1),i[0].v="-"+i[0].v)),_=k.length-1;var O=i.length;for(l=0;l<i.length;++l)if(i[l]!=null&&i[l].t!="t"&&i[l].v.indexOf(".")>-1){O=l;break}var F=i.length;if(O===i.length&&k.indexOf("E")===-1){for(l=i.length-1;l>=0;--l)i[l]==null||"n?".indexOf(i[l].t)===-1||(_>=i[l].v.length-1?(_-=i[l].v.length,i[l].v=k.substr(_+1,i[l].v.length)):_<0?i[l].v="":(i[l].v=k.substr(0,_+1),_=-1),i[l].t="t",F=l);_>=0&&F<i.length&&(i[F].v=k.substr(0,_+1)+i[F].v)}else if(O!==i.length&&k.indexOf("E")===-1){for(_=k.indexOf(".")-1,l=O;l>=0;--l)if(!(i[l]==null||"n?".indexOf(i[l].t)===-1)){for(d=i[l].v.indexOf(".")>-1&&l===O?i[l].v.indexOf(".")-1:i[l].v.length-1,w=i[l].v.substr(d+1);d>=0;--d)_>=0&&(i[l].v.charAt(d)==="0"||i[l].v.charAt(d)==="#")&&(w=k.charAt(_--)+w);i[l].v=w,i[l].t="t",F=l}for(_>=0&&F<i.length&&(i[F].v=k.substr(0,_+1)+i[F].v),_=k.indexOf(".")+1,l=O;l<i.length;++l)if(!(i[l]==null||"n?(".indexOf(i[l].t)===-1&&l!==O)){for(d=i[l].v.indexOf(".")>-1&&l===O?i[l].v.indexOf(".")+1:0,w=i[l].v.substr(0,d);d<i[l].v.length;++d)_<k.length&&(w+=k.charAt(_++));i[l].v=w,i[l].t="t",F=l}}}for(l=0;l<i.length;++l)i[l]!=null&&"n?".indexOf(i[l].t)>-1&&(T=n>1&&t<0&&l>0&&i[l-1].v==="-"?-t:t,i[l].v=Kn(i[l].t,i[l].v,T),i[l].t="t");var M="";for(l=0;l!==i.length;++l)i[l]!=null&&(M+=i[l].v);return M}var Gg=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Yg(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function fE(e,t){var r=cE(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(Gg),o=r[1].match(Gg);return Yg(t,l)?[n,r[0]]:Yg(t,o)?[n,r[1]]:[n,r[l!=null&&o!=null?2:1]]}return[n,a]}function un(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Be)[e],n==null&&(n=r.table&&r.table[Vg[e]]||Be[Vg[e]]),n==null&&(n=GC[e]||"General");break}if(Zc(n,0))return pa(t,r);t instanceof Date&&(t=M1(t,r.date1904));var i=fE(n,t);if(Zc(i[1]))return pa(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return uE(i[1],t,r,i[0])}function qn(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Be[r]==null){t<0&&(t=r);continue}if(Be[r]==e){t=r;break}}t<0&&(t=391)}return Be[t]=e,t}function Iu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&qn(e[t],t)}function Rs(){Be=$C()}var hE={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},X1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dE(e){var t=typeof e=="number"?Be[e]:e;return t=t.replace(X1,"(\\d+)"),new RegExp("^"+t+"$")}function pE(e,t,r){var n=-1,i=-1,a=-1,l=-1,o=-1,s=-1;(t.match(X1)||[]).forEach(function(f,h){var u=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=u;break;case"d":a=u;break;case"h":l=u;break;case"s":s=u;break;case"m":l>=0?o=u:i=u;break}}),s>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var d=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2);return l==-1&&o==-1&&s==-1?c:n==-1&&i==-1&&a==-1?d:c+"T"+d}var gE=function(){var e={};e.version="1.2.0";function t(){for(var k=0,O=new Array(256),F=0;F!=256;++F)k=F,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,O[F]=k;return typeof Int32Array<"u"?new Int32Array(O):O}var r=t();function n(k){var O=0,F=0,M=0,V=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)V[M]=k[M];for(M=0;M!=256;++M)for(F=k[M],O=256+M;O<4096;O+=256)F=V[O]=F>>>8^k[F&255];var X=[];for(M=1;M!=16;++M)X[M-1]=typeof Int32Array<"u"?V.subarray(M*256,M*256+256):V.slice(M*256,M*256+256);return X}var i=n(r),a=i[0],l=i[1],o=i[2],s=i[3],c=i[4],d=i[5],f=i[6],h=i[7],u=i[8],p=i[9],m=i[10],g=i[11],v=i[12],x=i[13],y=i[14];function _(k,O){for(var F=O^-1,M=0,V=k.length;M<V;)F=F>>>8^r[(F^k.charCodeAt(M++))&255];return~F}function w(k,O){for(var F=O^-1,M=k.length-15,V=0;V<M;)F=y[k[V++]^F&255]^x[k[V++]^F>>8&255]^v[k[V++]^F>>16&255]^g[k[V++]^F>>>24]^m[k[V++]]^p[k[V++]]^u[k[V++]]^h[k[V++]]^f[k[V++]]^d[k[V++]]^c[k[V++]]^s[k[V++]]^o[k[V++]]^l[k[V++]]^a[k[V++]]^r[k[V++]];for(M+=15;V<M;)F=F>>>8^r[(F^k[V++])&255];return~F}function T(k,O){for(var F=O^-1,M=0,V=k.length,X=0,q=0;M<V;)X=k.charCodeAt(M++),X<128?F=F>>>8^r[(F^X)&255]:X<2048?(F=F>>>8^r[(F^(192|X>>6&31))&255],F=F>>>8^r[(F^(128|X&63))&255]):X>=55296&&X<57344?(X=(X&1023)+64,q=k.charCodeAt(M++)&1023,F=F>>>8^r[(F^(240|X>>8&7))&255],F=F>>>8^r[(F^(128|X>>2&63))&255],F=F>>>8^r[(F^(128|q>>6&15|(X&3)<<4))&255],F=F>>>8^r[(F^(128|q&63))&255]):(F=F>>>8^r[(F^(224|X>>12&15))&255],F=F>>>8^r[(F^(128|X>>6&63))&255],F=F>>>8^r[(F^(128|X&63))&255]);return~F}return e.table=r,e.bstr=_,e.buf=w,e.str=T,e}(),Ie=function(){var t={};t.version="1.2.1";function r(D,G){for(var B=D.split("/"),U=G.split("/"),K=0,J=0,fe=Math.min(B.length,U.length);K<fe;++K){if(J=B[K].length-U[K].length)return J;if(B[K]!=U[K])return B[K]<U[K]?-1:1}return B.length-U.length}function n(D){if(D.charAt(D.length-1)=="/")return D.slice(0,-1).indexOf("/")===-1?D:n(D.slice(0,-1));var G=D.lastIndexOf("/");return G===-1?D:D.slice(0,G+1)}function i(D){if(D.charAt(D.length-1)=="/")return i(D.slice(0,-1));var G=D.lastIndexOf("/");return G===-1?D:D.slice(G+1)}function a(D,G){typeof G=="string"&&(G=new Date(G));var B=G.getHours();B=B<<6|G.getMinutes(),B=B<<5|G.getSeconds()>>>1,D.write_shift(2,B);var U=G.getFullYear()-1980;U=U<<4|G.getMonth()+1,U=U<<5|G.getDate(),D.write_shift(2,U)}function l(D){var G=D.read_shift(2)&65535,B=D.read_shift(2)&65535,U=new Date,K=B&31;B>>>=5;var J=B&15;B>>>=4,U.setMilliseconds(0),U.setFullYear(B+1980),U.setMonth(J-1),U.setDate(K);var fe=G&31;G>>>=5;var me=G&63;return G>>>=6,U.setHours(G),U.setMinutes(me),U.setSeconds(fe<<1),U}function o(D){ar(D,0);for(var G={},B=0;D.l<=D.length-4;){var U=D.read_shift(2),K=D.read_shift(2),J=D.l+K,fe={};switch(U){case 21589:B=D.read_shift(1),B&1&&(fe.mtime=D.read_shift(4)),K>5&&(B&2&&(fe.atime=D.read_shift(4)),B&4&&(fe.ctime=D.read_shift(4))),fe.mtime&&(fe.mt=new Date(fe.mtime*1e3));break}D.l=J,G[U]=fe}return G}var s;function c(){return s||(s={})}function d(D,G){if(D[0]==80&&D[1]==75)return rp(D,G);if((D[0]|32)==109&&(D[1]|32)==105)return lw(D,G);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var B=3,U=512,K=0,J=0,fe=0,me=0,ue=0,he=[],pe=D.slice(0,512);ar(pe,0);var we=f(pe);switch(B=we[0],B){case 3:U=512;break;case 4:U=4096;break;case 0:if(we[1]==0)return rp(D,G);default:throw new Error("Major Version: Expected 3 or 4 saw "+B)}U!==512&&(pe=D.slice(0,U),ar(pe,28));var Ee=D.slice(0,U);h(pe,B);var Fe=pe.read_shift(4,"i");if(B===3&&Fe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Fe);pe.l+=4,fe=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),me=pe.read_shift(4,"i"),K=pe.read_shift(4,"i"),ue=pe.read_shift(4,"i"),J=pe.read_shift(4,"i");for(var ke=-1,Oe=0;Oe<109&&(ke=pe.read_shift(4,"i"),!(ke<0));++Oe)he[Oe]=ke;var Ve=u(D,U);g(ue,J,Ve,U,he);var St=x(Ve,fe,he,U);St[fe].name="!Directory",K>0&&me!==q&&(St[me].name="!MiniFAT"),St[he[0]].name="!FAT",St.fat_addrs=he,St.ssz=U;var kt={},cr=[],js=[],Ls=[];y(fe,St,Ve,cr,K,kt,js,me),p(js,Ls,cr),cr.shift();var Bs={FileIndex:js,FullPaths:Ls};return G&&G.raw&&(Bs.raw={header:Ee,sectors:Ve}),Bs}function f(D){if(D[D.l]==80&&D[D.l+1]==75)return[0,0];D.chk(ae,"Header Signature: "),D.l+=16;var G=D.read_shift(2,"u");return[D.read_shift(2,"u"),G]}function h(D,G){var B=9;switch(D.l+=2,B=D.read_shift(2)){case 9:if(G!=3)throw new Error("Sector Shift: Expected 9 saw "+B);break;case 12:if(G!=4)throw new Error("Sector Shift: Expected 12 saw "+B);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+B)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}function u(D,G){for(var B=Math.ceil(D.length/G)-1,U=[],K=1;K<B;++K)U[K-1]=D.slice(K*G,(K+1)*G);return U[B-1]=D.slice(B*G),U}function p(D,G,B){for(var U=0,K=0,J=0,fe=0,me=0,ue=B.length,he=[],pe=[];U<ue;++U)he[U]=pe[U]=U,G[U]=B[U];for(;me<pe.length;++me)U=pe[me],K=D[U].L,J=D[U].R,fe=D[U].C,he[U]===U&&(K!==-1&&he[K]!==K&&(he[U]=he[K]),J!==-1&&he[J]!==J&&(he[U]=he[J])),fe!==-1&&(he[fe]=U),K!==-1&&U!=he[U]&&(he[K]=he[U],pe.lastIndexOf(K)<me&&pe.push(K)),J!==-1&&U!=he[U]&&(he[J]=he[U],pe.lastIndexOf(J)<me&&pe.push(J));for(U=1;U<ue;++U)he[U]===U&&(J!==-1&&he[J]!==J?he[U]=he[J]:K!==-1&&he[K]!==K&&(he[U]=he[K]));for(U=1;U<ue;++U)if(D[U].type!==0){if(me=U,me!=he[me])do me=he[me],G[U]=G[me]+"/"+G[U];while(me!==0&&he[me]!==-1&&me!=he[me]);he[U]=-1}for(G[0]+="/",U=1;U<ue;++U)D[U].type!==2&&(G[U]+="/")}function m(D,G,B){for(var U=D.start,K=D.size,J=[],fe=U;B&&K>0&&fe>=0;)J.push(G.slice(fe*X,fe*X+X)),K-=X,fe=Ji(B,fe*4);return J.length===0?ge(0):Qt(J).slice(0,D.size)}function g(D,G,B,U,K){var J=q;if(D===q){if(G!==0)throw new Error("DIFAT chain shorter than expected")}else if(D!==-1){var fe=B[D],me=(U>>>2)-1;if(!fe)return;for(var ue=0;ue<me&&(J=Ji(fe,ue*4))!==q;++ue)K.push(J);g(Ji(fe,U-4),G-1,B,U,K)}}function v(D,G,B,U,K){var J=[],fe=[];K||(K=[]);var me=U-1,ue=0,he=0;for(ue=G;ue>=0;){K[ue]=!0,J[J.length]=ue,fe.push(D[ue]);var pe=B[Math.floor(ue*4/U)];if(he=ue*4&me,U<4+he)throw new Error("FAT boundary crossed: "+ue+" 4 "+U);if(!D[pe])break;ue=Ji(D[pe],he)}return{nodes:J,data:sm([fe])}}function x(D,G,B,U){var K=D.length,J=[],fe=[],me=[],ue=[],he=U-1,pe=0,we=0,Ee=0,Fe=0;for(pe=0;pe<K;++pe)if(me=[],Ee=pe+G,Ee>=K&&(Ee-=K),!fe[Ee]){ue=[];var ke=[];for(we=Ee;we>=0;){ke[we]=!0,fe[we]=!0,me[me.length]=we,ue.push(D[we]);var Oe=B[Math.floor(we*4/U)];if(Fe=we*4&he,U<4+Fe)throw new Error("FAT boundary crossed: "+we+" 4 "+U);if(!D[Oe]||(we=Ji(D[Oe],Fe),ke[we]))break}J[Ee]={nodes:me,data:sm([ue])}}return J}function y(D,G,B,U,K,J,fe,me){for(var ue=0,he=U.length?2:0,pe=G[D].data,we=0,Ee=0,Fe;we<pe.length;we+=128){var ke=pe.slice(we,we+128);ar(ke,64),Ee=ke.read_shift(2),Fe=Sd(ke,0,Ee-he),U.push(Fe);var Oe={name:Fe,type:ke.read_shift(1),color:ke.read_shift(1),L:ke.read_shift(4,"i"),R:ke.read_shift(4,"i"),C:ke.read_shift(4,"i"),clsid:ke.read_shift(16),state:ke.read_shift(4,"i"),start:0,size:0},Ve=ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2);Ve!==0&&(Oe.ct=_(ke,ke.l-8));var St=ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2);St!==0&&(Oe.mt=_(ke,ke.l-8)),Oe.start=ke.read_shift(4,"i"),Oe.size=ke.read_shift(4,"i"),Oe.size<0&&Oe.start<0&&(Oe.size=Oe.type=0,Oe.start=q,Oe.name=""),Oe.type===5?(ue=Oe.start,K>0&&ue!==q&&(G[ue].name="!StreamData")):Oe.size>=4096?(Oe.storage="fat",G[Oe.start]===void 0&&(G[Oe.start]=v(B,Oe.start,G.fat_addrs,G.ssz)),G[Oe.start].name=Oe.name,Oe.content=G[Oe.start].data.slice(0,Oe.size)):(Oe.storage="minifat",Oe.size<0?Oe.size=0:ue!==q&&Oe.start!==q&&G[ue]&&(Oe.content=m(Oe,G[ue].data,(G[me]||{}).data))),Oe.content&&ar(Oe.content,0),J[Fe]=Oe,fe.push(Oe)}}function _(D,G){return new Date((Wr(D,G+4)/1e7*Math.pow(2,32)+Wr(D,G)/1e7-11644473600)*1e3)}function w(D,G){return c(),d(s.readFileSync(D),G)}function T(D,G){var B=G&&G.type;switch(B||Ye&&Buffer.isBuffer(D)&&(B="buffer"),B||"base64"){case"file":return w(D,G);case"base64":return d(Hr(Gr(D)),G);case"binary":return d(Hr(D),G)}return d(D,G)}function k(D,G){var B=G||{},U=B.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");D.FullPaths.length===0&&(D.FullPaths[0]=U+"/",D.FileIndex[0]={name:U,type:5}),B.CLSID&&(D.FileIndex[0].clsid=B.CLSID),O(D)}function O(D){var G="Sh33tJ5";if(!Ie.find(D,"/"+G)){var B=ge(4);B[0]=55,B[1]=B[3]=50,B[2]=54,D.FileIndex.push({name:G,type:2,content:B,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+G),F(D)}}function F(D,G){k(D);for(var B=!1,U=!1,K=D.FullPaths.length-1;K>=0;--K){var J=D.FileIndex[K];switch(J.type){case 0:U?B=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:U=!0,isNaN(J.R*J.L*J.C)&&(B=!0),J.R>-1&&J.L>-1&&J.R==J.L&&(B=!0);break;default:B=!0;break}}if(!(!B&&!G)){var fe=new Date(1987,1,19),me=0,ue=Object.create?Object.create(null):{},he=[];for(K=0;K<D.FullPaths.length;++K)ue[D.FullPaths[K]]=!0,D.FileIndex[K].type!==0&&he.push([D.FullPaths[K],D.FileIndex[K]]);for(K=0;K<he.length;++K){var pe=n(he[K][0]);U=ue[pe],U||(he.push([pe,{name:i(pe).replace("/",""),type:1,clsid:re,ct:fe,mt:fe,content:null}]),ue[pe]=!0)}for(he.sort(function(Fe,ke){return r(Fe[0],ke[0])}),D.FullPaths=[],D.FileIndex=[],K=0;K<he.length;++K)D.FullPaths[K]=he[K][0],D.FileIndex[K]=he[K][1];for(K=0;K<he.length;++K){var we=D.FileIndex[K],Ee=D.FullPaths[K];if(we.name=i(Ee).replace("/",""),we.L=we.R=we.C=-(we.color=1),we.size=we.content?we.content.length:0,we.start=0,we.clsid=we.clsid||re,K===0)we.C=he.length>1?1:-1,we.size=0,we.type=5;else if(Ee.slice(-1)=="/"){for(me=K+1;me<he.length&&n(D.FullPaths[me])!=Ee;++me);for(we.C=me>=he.length?-1:me,me=K+1;me<he.length&&n(D.FullPaths[me])!=n(Ee);++me);we.R=me>=he.length?-1:me,we.type=1}else n(D.FullPaths[K+1]||"")==n(Ee)&&(we.R=K+1),we.type=2}}}function M(D,G){var B=G||{};if(B.fileType=="mad")return cw(D,B);switch(F(D),B.fileType){case"zip":return rw(D,B)}var U=function(Fe){for(var ke=0,Oe=0,Ve=0;Ve<Fe.FileIndex.length;++Ve){var St=Fe.FileIndex[Ve];if(St.content){var kt=St.content.length;kt>0&&(kt<4096?ke+=kt+63>>6:Oe+=kt+511>>9)}}for(var cr=Fe.FullPaths.length+3>>2,js=ke+7>>3,Ls=ke+127>>7,Bs=js+Oe+cr+Ls,Hi=Bs+127>>7,Xu=Hi<=109?0:Math.ceil((Hi-109)/127);Bs+Hi+Xu+127>>7>Hi;)Xu=++Hi<=109?0:Math.ceil((Hi-109)/127);var Wn=[1,Xu,Hi,Ls,cr,Oe,ke,0];return Fe.FileIndex[0].size=ke<<6,Wn[7]=(Fe.FileIndex[0].start=Wn[0]+Wn[1]+Wn[2]+Wn[3]+Wn[4]+Wn[5])+(Wn[6]+7>>3),Wn}(D),K=ge(U[7]<<9),J=0,fe=0;{for(J=0;J<8;++J)K.write_shift(1,ne[J]);for(J=0;J<8;++J)K.write_shift(2,0);for(K.write_shift(2,62),K.write_shift(2,3),K.write_shift(2,65534),K.write_shift(2,9),K.write_shift(2,6),J=0;J<3;++J)K.write_shift(2,0);for(K.write_shift(4,0),K.write_shift(4,U[2]),K.write_shift(4,U[0]+U[1]+U[2]+U[3]-1),K.write_shift(4,0),K.write_shift(4,4096),K.write_shift(4,U[3]?U[0]+U[1]+U[2]-1:q),K.write_shift(4,U[3]),K.write_shift(-4,U[1]?U[0]-1:q),K.write_shift(4,U[1]),J=0;J<109;++J)K.write_shift(-4,J<U[2]?U[1]+J:-1)}if(U[1])for(fe=0;fe<U[1];++fe){for(;J<236+fe*127;++J)K.write_shift(-4,J<U[2]?U[1]+J:-1);K.write_shift(-4,fe===U[1]-1?q:fe+1)}var me=function(Fe){for(fe+=Fe;J<fe-1;++J)K.write_shift(-4,J+1);Fe&&(++J,K.write_shift(-4,q))};for(fe=J=0,fe+=U[1];J<fe;++J)K.write_shift(-4,le.DIFSECT);for(fe+=U[2];J<fe;++J)K.write_shift(-4,le.FATSECT);me(U[3]),me(U[4]);for(var ue=0,he=0,pe=D.FileIndex[0];ue<D.FileIndex.length;++ue)pe=D.FileIndex[ue],pe.content&&(he=pe.content.length,!(he<4096)&&(pe.start=fe,me(he+511>>9)));for(me(U[6]+7>>3);K.l&511;)K.write_shift(-4,le.ENDOFCHAIN);for(fe=J=0,ue=0;ue<D.FileIndex.length;++ue)pe=D.FileIndex[ue],pe.content&&(he=pe.content.length,!(!he||he>=4096)&&(pe.start=fe,me(he+63>>6)));for(;K.l&511;)K.write_shift(-4,le.ENDOFCHAIN);for(J=0;J<U[4]<<2;++J){var we=D.FullPaths[J];if(!we||we.length===0){for(ue=0;ue<17;++ue)K.write_shift(4,0);for(ue=0;ue<3;++ue)K.write_shift(4,-1);for(ue=0;ue<12;++ue)K.write_shift(4,0);continue}pe=D.FileIndex[J],J===0&&(pe.start=pe.size?pe.start-1:q);var Ee=J===0&&B.root||pe.name;if(he=2*(Ee.length+1),K.write_shift(64,Ee,"utf16le"),K.write_shift(2,he),K.write_shift(1,pe.type),K.write_shift(1,pe.color),K.write_shift(-4,pe.L),K.write_shift(-4,pe.R),K.write_shift(-4,pe.C),pe.clsid)K.write_shift(16,pe.clsid,"hex");else for(ue=0;ue<4;++ue)K.write_shift(4,0);K.write_shift(4,pe.state||0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,pe.start),K.write_shift(4,pe.size),K.write_shift(4,0)}for(J=1;J<D.FileIndex.length;++J)if(pe=D.FileIndex[J],pe.size>=4096)if(K.l=pe.start+1<<9,Ye&&Buffer.isBuffer(pe.content))pe.content.copy(K,K.l,0,pe.size),K.l+=pe.size+511&-512;else{for(ue=0;ue<pe.size;++ue)K.write_shift(1,pe.content[ue]);for(;ue&511;++ue)K.write_shift(1,0)}for(J=1;J<D.FileIndex.length;++J)if(pe=D.FileIndex[J],pe.size>0&&pe.size<4096)if(Ye&&Buffer.isBuffer(pe.content))pe.content.copy(K,K.l,0,pe.size),K.l+=pe.size+63&-64;else{for(ue=0;ue<pe.size;++ue)K.write_shift(1,pe.content[ue]);for(;ue&63;++ue)K.write_shift(1,0)}if(Ye)K.l=K.length;else for(;K.l<K.length;)K.write_shift(1,0);return K}function V(D,G){var B=D.FullPaths.map(function(ue){return ue.toUpperCase()}),U=B.map(function(ue){var he=ue.split("/");return he[he.length-(ue.slice(-1)=="/"?2:1)]}),K=!1;G.charCodeAt(0)===47?(K=!0,G=B[0].slice(0,-1)+G):K=G.indexOf("/")!==-1;var J=G.toUpperCase(),fe=K===!0?B.indexOf(J):U.indexOf(J);if(fe!==-1)return D.FileIndex[fe];var me=!J.match(no);for(J=J.replace(Cr,""),me&&(J=J.replace(no,"!")),fe=0;fe<B.length;++fe)if((me?B[fe].replace(no,"!"):B[fe]).replace(Cr,"")==J||(me?U[fe].replace(no,"!"):U[fe]).replace(Cr,"")==J)return D.FileIndex[fe];return null}var X=64,q=-2,ae="d0cf11e0a1b11ae1",ne=[208,207,17,224,161,177,26,225],re="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:ae,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:re,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function se(D,G,B){c();var U=M(D,B);s.writeFileSync(G,U)}function C(D){for(var G=new Array(D.length),B=0;B<D.length;++B)G[B]=String.fromCharCode(D[B]);return G.join("")}function j(D,G){var B=M(D,G);switch(G&&G.type||"buffer"){case"file":return c(),s.writeFileSync(G.filename,B),B;case"binary":return typeof B=="string"?B:C(B);case"base64":return Jo(typeof B=="string"?B:C(B));case"buffer":if(Ye)return Buffer.isBuffer(B)?B:si(B);case"array":return typeof B=="string"?Hr(B):B}return B}var L;function E(D){try{var G=D.InflateRaw,B=new G;if(B._processChunk(new Uint8Array([3,0]),B._finishFlushFlag),B.bytesRead)L=D;else throw new Error("zlib does not expose bytesRead")}catch(U){console.error("cannot use native zlib: "+(U.message||U))}}function I(D,G){if(!L)return ep(D,G);var B=L.InflateRaw,U=new B,K=U._processChunk(D.slice(D.l),U._finishFlushFlag);return D.l+=U.bytesRead,K}function A(D){return L?L.deflateRawSync(D):ze(D)}var b=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],R=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function W(D){var G=(D<<1|D<<11)&139536|(D<<5|D<<15)&558144;return(G>>16|G>>8|G)&255}for(var z=typeof Uint8Array<"u",Y=z?new Uint8Array(256):[],ie=0;ie<256;++ie)Y[ie]=W(ie);function N(D,G){var B=Y[D&255];return G<=8?B>>>8-G:(B=B<<8|Y[D>>8&255],G<=16?B>>>16-G:(B=B<<8|Y[D>>16&255],B>>>24-G))}function Q(D,G){var B=G&7,U=G>>>3;return(D[U]|(B<=6?0:D[U+1]<<8))>>>B&3}function H(D,G){var B=G&7,U=G>>>3;return(D[U]|(B<=5?0:D[U+1]<<8))>>>B&7}function te(D,G){var B=G&7,U=G>>>3;return(D[U]|(B<=4?0:D[U+1]<<8))>>>B&15}function ee(D,G){var B=G&7,U=G>>>3;return(D[U]|(B<=3?0:D[U+1]<<8))>>>B&31}function Z(D,G){var B=G&7,U=G>>>3;return(D[U]|(B<=1?0:D[U+1]<<8))>>>B&127}function oe(D,G,B){var U=G&7,K=G>>>3,J=(1<<B)-1,fe=D[K]>>>U;return B<8-U||(fe|=D[K+1]<<8-U,B<16-U)||(fe|=D[K+2]<<16-U,B<24-U)||(fe|=D[K+3]<<24-U),fe&J}function ce(D,G,B){var U=G&7,K=G>>>3;return U<=5?D[K]|=(B&7)<<U:(D[K]|=B<<U&255,D[K+1]=(B&7)>>8-U),G+3}function ye(D,G,B){var U=G&7,K=G>>>3;return B=(B&1)<<U,D[K]|=B,G+1}function _e(D,G,B){var U=G&7,K=G>>>3;return B<<=U,D[K]|=B&255,B>>>=8,D[K+1]=B,G+8}function de(D,G,B){var U=G&7,K=G>>>3;return B<<=U,D[K]|=B&255,B>>>=8,D[K+1]=B&255,D[K+2]=B>>>8,G+16}function be(D,G){var B=D.length,U=2*B>G?2*B:G+5,K=0;if(B>=G)return D;if(Ye){var J=Wg(U);if(D.copy)D.copy(J);else for(;K<D.length;++K)J[K]=D[K];return J}else if(z){var fe=new Uint8Array(U);if(fe.set)fe.set(D);else for(;K<B;++K)fe[K]=D[K];return fe}return D.length=U,D}function Ae(D){for(var G=new Array(D),B=0;B<D;++B)G[B]=0;return G}function Re(D,G,B){var U=1,K=0,J=0,fe=0,me=0,ue=D.length,he=z?new Uint16Array(32):Ae(32);for(J=0;J<32;++J)he[J]=0;for(J=ue;J<B;++J)D[J]=0;ue=D.length;var pe=z?new Uint16Array(ue):Ae(ue);for(J=0;J<ue;++J)he[K=D[J]]++,U<K&&(U=K),pe[J]=0;for(he[0]=0,J=1;J<=U;++J)he[J+16]=me=me+he[J-1]<<1;for(J=0;J<ue;++J)me=D[J],me!=0&&(pe[J]=he[me+16]++);var we=0;for(J=0;J<ue;++J)if(we=D[J],we!=0)for(me=N(pe[J],U)>>U-we,fe=(1<<U+4-we)-1;fe>=0;--fe)G[me|fe<<we]=we&15|J<<4;return U}var De=z?new Uint16Array(512):Ae(512),Me=z?new Uint16Array(32):Ae(32);if(!z){for(var Ke=0;Ke<512;++Ke)De[Ke]=0;for(Ke=0;Ke<32;++Ke)Me[Ke]=0}(function(){for(var D=[],G=0;G<32;G++)D.push(5);Re(D,Me,32);var B=[];for(G=0;G<=143;G++)B.push(8);for(;G<=255;G++)B.push(9);for(;G<=279;G++)B.push(7);for(;G<=287;G++)B.push(8);Re(B,De,288)})();var Ze=function(){for(var G=z?new Uint8Array(32768):[],B=0,U=0;B<R.length-1;++B)for(;U<R[B+1];++U)G[U]=B;for(;U<32768;++U)G[U]=29;var K=z?new Uint8Array(259):[];for(B=0,U=0;B<P.length-1;++B)for(;U<P[B+1];++U)K[U]=B;function J(me,ue){for(var he=0;he<me.length;){var pe=Math.min(65535,me.length-he),we=he+pe==me.length;for(ue.write_shift(1,+we),ue.write_shift(2,pe),ue.write_shift(2,~pe&65535);pe-- >0;)ue[ue.l++]=me[he++]}return ue.l}function fe(me,ue){for(var he=0,pe=0,we=z?new Uint16Array(32768):[];pe<me.length;){var Ee=Math.min(65535,me.length-pe);if(Ee<10){for(he=ce(ue,he,+(pe+Ee==me.length)),he&7&&(he+=8-(he&7)),ue.l=he/8|0,ue.write_shift(2,Ee),ue.write_shift(2,~Ee&65535);Ee-- >0;)ue[ue.l++]=me[pe++];he=ue.l*8;continue}he=ce(ue,he,+(pe+Ee==me.length)+2);for(var Fe=0;Ee-- >0;){var ke=me[pe];Fe=(Fe<<5^ke)&32767;var Oe=-1,Ve=0;if((Oe=we[Fe])&&(Oe|=pe&-32768,Oe>pe&&(Oe-=32768),Oe<pe))for(;me[Oe+Ve]==me[pe+Ve]&&Ve<250;)++Ve;if(Ve>2){ke=K[Ve],ke<=22?he=_e(ue,he,Y[ke+1]>>1)-1:(_e(ue,he,3),he+=5,_e(ue,he,Y[ke-23]>>5),he+=3);var St=ke<8?0:ke-4>>2;St>0&&(de(ue,he,Ve-P[ke]),he+=St),ke=G[pe-Oe],he=_e(ue,he,Y[ke]>>3),he-=3;var kt=ke<4?0:ke-2>>1;kt>0&&(de(ue,he,pe-Oe-R[ke]),he+=kt);for(var cr=0;cr<Ve;++cr)we[Fe]=pe&32767,Fe=(Fe<<5^me[pe])&32767,++pe;Ee-=Ve-1}else ke<=143?ke=ke+48:he=ye(ue,he,1),he=_e(ue,he,Y[ke]),we[Fe]=pe&32767,++pe}he=_e(ue,he,0)-1}return ue.l=(he+7)/8|0,ue.l}return function(ue,he){return ue.length<8?J(ue,he):fe(ue,he)}}();function ze(D){var G=ge(50+Math.floor(D.length*1.1)),B=Ze(D,G);return G.slice(0,B)}var ft=z?new Uint16Array(32768):Ae(32768),wt=z?new Uint16Array(32768):Ae(32768),It=z?new Uint16Array(128):Ae(128),En=1,Tl=1;function zu(D,G){var B=ee(D,G)+257;G+=5;var U=ee(D,G)+1;G+=5;var K=te(D,G)+4;G+=4;for(var J=0,fe=z?new Uint8Array(19):Ae(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ue=1,he=z?new Uint8Array(8):Ae(8),pe=z?new Uint8Array(8):Ae(8),we=fe.length,Ee=0;Ee<K;++Ee)fe[b[Ee]]=J=H(D,G),ue<J&&(ue=J),he[J]++,G+=3;var Fe=0;for(he[0]=0,Ee=1;Ee<=ue;++Ee)pe[Ee]=Fe=Fe+he[Ee-1]<<1;for(Ee=0;Ee<we;++Ee)(Fe=fe[Ee])!=0&&(me[Ee]=pe[Fe]++);var ke=0;for(Ee=0;Ee<we;++Ee)if(ke=fe[Ee],ke!=0){Fe=Y[me[Ee]]>>8-ke;for(var Oe=(1<<7-ke)-1;Oe>=0;--Oe)It[Fe|Oe<<ke]=ke&7|Ee<<3}var Ve=[];for(ue=1;Ve.length<B+U;)switch(Fe=It[Z(D,G)],G+=Fe&7,Fe>>>=3){case 16:for(J=3+Q(D,G),G+=2,Fe=Ve[Ve.length-1];J-- >0;)Ve.push(Fe);break;case 17:for(J=3+H(D,G),G+=3;J-- >0;)Ve.push(0);break;case 18:for(J=11+Z(D,G),G+=7;J-- >0;)Ve.push(0);break;default:Ve.push(Fe),ue<Fe&&(ue=Fe);break}var St=Ve.slice(0,B),kt=Ve.slice(B);for(Ee=B;Ee<286;++Ee)St[Ee]=0;for(Ee=U;Ee<30;++Ee)kt[Ee]=0;return En=Re(St,ft,286),Tl=Re(kt,wt,30),G}function ew(D,G){if(D[0]==3&&!(D[1]&3))return[Ni(G),2];for(var B=0,U=0,K=Wg(G||1<<18),J=0,fe=K.length>>>0,me=0,ue=0;!(U&1);){if(U=H(D,B),B+=3,U>>>1)U>>1==1?(me=9,ue=5):(B=zu(D,B),me=En,ue=Tl);else{B&7&&(B+=8-(B&7));var he=D[B>>>3]|D[(B>>>3)+1]<<8;if(B+=32,he>0)for(!G&&fe<J+he&&(K=be(K,J+he),fe=K.length);he-- >0;)K[J++]=D[B>>>3],B+=8;continue}for(;;){!G&&fe<J+32767&&(K=be(K,J+32767),fe=K.length);var pe=oe(D,B,me),we=U>>>1==1?De[pe]:ft[pe];if(B+=we&15,we>>>=4,!(we>>>8&255))K[J++]=we;else{if(we==256)break;we-=257;var Ee=we<8?0:we-4>>2;Ee>5&&(Ee=0);var Fe=J+P[we];Ee>0&&(Fe+=oe(D,B,Ee),B+=Ee),pe=oe(D,B,ue),we=U>>>1==1?Me[pe]:wt[pe],B+=we&15,we>>>=4;var ke=we<4?0:we-2>>1,Oe=R[we];for(ke>0&&(Oe+=oe(D,B,ke),B+=ke),!G&&fe<Fe&&(K=be(K,Fe+100),fe=K.length);J<Fe;)K[J]=K[J-Oe],++J}}}return G?[K,B+7>>>3]:[K.slice(0,J),B+7>>>3]}function ep(D,G){var B=D.slice(D.l||0),U=ew(B,G);return D.l+=U[1],U[0]}function tp(D,G){if(D)typeof console<"u"&&console.error(G);else throw new Error(G)}function rp(D,G){var B=D;ar(B,0);var U=[],K=[],J={FileIndex:U,FullPaths:K};k(J,{root:G.root});for(var fe=B.length-4;(B[fe]!=80||B[fe+1]!=75||B[fe+2]!=5||B[fe+3]!=6)&&fe>=0;)--fe;B.l=fe+4,B.l+=4;var me=B.read_shift(2);B.l+=6;var ue=B.read_shift(4);for(B.l=ue,fe=0;fe<me;++fe){B.l+=20;var he=B.read_shift(4),pe=B.read_shift(4),we=B.read_shift(2),Ee=B.read_shift(2),Fe=B.read_shift(2);B.l+=8;var ke=B.read_shift(4),Oe=o(B.slice(B.l+we,B.l+we+Ee));B.l+=we+Ee+Fe;var Ve=B.l;B.l=ke+4,tw(B,he,pe,J,Oe),B.l=Ve}return J}function tw(D,G,B,U,K){D.l+=2;var J=D.read_shift(2),fe=D.read_shift(2),me=l(D);if(J&8257)throw new Error("Unsupported ZIP encryption");for(var ue=D.read_shift(4),he=D.read_shift(4),pe=D.read_shift(4),we=D.read_shift(2),Ee=D.read_shift(2),Fe="",ke=0;ke<we;++ke)Fe+=String.fromCharCode(D[D.l++]);if(Ee){var Oe=o(D.slice(D.l,D.l+Ee));(Oe[21589]||{}).mt&&(me=Oe[21589].mt),((K||{})[21589]||{}).mt&&(me=K[21589].mt)}D.l+=Ee;var Ve=D.slice(D.l,D.l+he);switch(fe){case 8:Ve=I(D,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+fe)}var St=!1;J&8&&(ue=D.read_shift(4),ue==134695760&&(ue=D.read_shift(4),St=!0),he=D.read_shift(4),pe=D.read_shift(4)),he!=G&&tp(St,"Bad compressed size: "+G+" != "+he),pe!=B&&tp(St,"Bad uncompressed size: "+B+" != "+pe),Vu(U,Fe,Ve,{unsafe:!0,mt:me})}function rw(D,G){var B=G||{},U=[],K=[],J=ge(1),fe=B.compression?8:0,me=0,ue=0,he=0,pe=0,we=0,Ee=D.FullPaths[0],Fe=Ee,ke=D.FileIndex[0],Oe=[],Ve=0;for(ue=1;ue<D.FullPaths.length;++ue)if(Fe=D.FullPaths[ue].slice(Ee.length),ke=D.FileIndex[ue],!(!ke.size||!ke.content||Fe=="Sh33tJ5")){var St=pe,kt=ge(Fe.length);for(he=0;he<Fe.length;++he)kt.write_shift(1,Fe.charCodeAt(he)&127);kt=kt.slice(0,kt.l),Oe[we]=gE.buf(ke.content,0);var cr=ke.content;fe==8&&(cr=A(cr)),J=ge(30),J.write_shift(4,67324752),J.write_shift(2,20),J.write_shift(2,me),J.write_shift(2,fe),ke.mt?a(J,ke.mt):J.write_shift(4,0),J.write_shift(-4,Oe[we]),J.write_shift(4,cr.length),J.write_shift(4,ke.content.length),J.write_shift(2,kt.length),J.write_shift(2,0),pe+=J.length,U.push(J),pe+=kt.length,U.push(kt),pe+=cr.length,U.push(cr),J=ge(46),J.write_shift(4,33639248),J.write_shift(2,0),J.write_shift(2,20),J.write_shift(2,me),J.write_shift(2,fe),J.write_shift(4,0),J.write_shift(-4,Oe[we]),J.write_shift(4,cr.length),J.write_shift(4,ke.content.length),J.write_shift(2,kt.length),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(4,0),J.write_shift(4,St),Ve+=J.l,K.push(J),Ve+=kt.length,K.push(kt),++we}return J=ge(22),J.write_shift(4,101010256),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,we),J.write_shift(2,we),J.write_shift(4,Ve),J.write_shift(4,pe),J.write_shift(2,0),Qt([Qt(U),Qt(K),J])}var Cl={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function nw(D,G){if(D.ctype)return D.ctype;var B=D.name||"",U=B.match(/\.([^\.]+)$/);return U&&Cl[U[1]]||G&&(U=(B=G).match(/[\.\\]([^\.\\])+$/),U&&Cl[U[1]])?Cl[U[1]]:"application/octet-stream"}function iw(D){for(var G=Jo(D),B=[],U=0;U<G.length;U+=76)B.push(G.slice(U,U+76));return B.join(`\r
`)+`\r
`}function aw(D){var G=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(he){var pe=he.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});G=G.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),G.charAt(0)==`
`&&(G="=0D"+G.slice(1)),G=G.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var B=[],U=G.split(`\r
`),K=0;K<U.length;++K){var J=U[K];if(J.length==0){B.push("");continue}for(var fe=0;fe<J.length;){var me=76,ue=J.slice(fe,fe+me);ue.charAt(me-1)=="="?me--:ue.charAt(me-2)=="="?me-=2:ue.charAt(me-3)=="="&&(me-=3),ue=J.slice(fe,fe+me),fe+=me,fe<J.length&&(ue+="="),B.push(ue)}}return B.join(`\r
`)}function sw(D){for(var G=[],B=0;B<D.length;++B){for(var U=D[B];B<=D.length&&U.charAt(U.length-1)=="=";)U=U.slice(0,U.length-1)+D[++B];G.push(U)}for(var K=0;K<G.length;++K)G[K]=G[K].replace(/[=][0-9A-Fa-f]{2}/g,function(J){return String.fromCharCode(parseInt(J.slice(1),16))});return Hr(G.join(`\r
`))}function ow(D,G,B){for(var U="",K="",J="",fe,me=0;me<10;++me){var ue=G[me];if(!ue||ue.match(/^\s*$/))break;var he=ue.match(/^(.*?):\s*([^\s].*)$/);if(he)switch(he[1].toLowerCase()){case"content-location":U=he[2].trim();break;case"content-type":J=he[2].trim();break;case"content-transfer-encoding":K=he[2].trim();break}}switch(++me,K.toLowerCase()){case"base64":fe=Hr(Gr(G.slice(me).join("")));break;case"quoted-printable":fe=sw(G.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+K)}var pe=Vu(D,U.slice(B.length),fe,{unsafe:!0});J&&(pe.ctype=J)}function lw(D,G){if(C(D.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var B=G&&G.root||"",U=(Ye&&Buffer.isBuffer(D)?D.toString("binary"):C(D)).split(`\r
`),K=0,J="";for(K=0;K<U.length;++K)if(J=U[K],!!/^Content-Location:/i.test(J)&&(J=J.slice(J.indexOf("file")),B||(B=J.slice(0,J.lastIndexOf("/")+1)),J.slice(0,B.length)!=B))for(;B.length>0&&(B=B.slice(0,B.length-1),B=B.slice(0,B.lastIndexOf("/")+1),J.slice(0,B.length)!=B););var fe=(U[1]||"").match(/boundary="(.*?)"/);if(!fe)throw new Error("MAD cannot find boundary");var me="--"+(fe[1]||""),ue=[],he=[],pe={FileIndex:ue,FullPaths:he};k(pe);var we,Ee=0;for(K=0;K<U.length;++K){var Fe=U[K];Fe!==me&&Fe!==me+"--"||(Ee++&&ow(pe,U.slice(we,K),B),we=K)}return pe}function cw(D,G){var B=G||{},U=B.boundary||"SheetJS";U="------="+U;for(var K=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+U.slice(2)+'"',"","",""],J=D.FullPaths[0],fe=J,me=D.FileIndex[0],ue=1;ue<D.FullPaths.length;++ue)if(fe=D.FullPaths[ue].slice(J.length),me=D.FileIndex[ue],!(!me.size||!me.content||fe=="Sh33tJ5")){fe=fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ve){return"_x"+Ve.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ve){return"_u"+Ve.charCodeAt(0).toString(16)+"_"});for(var he=me.content,pe=Ye&&Buffer.isBuffer(he)?he.toString("binary"):C(he),we=0,Ee=Math.min(1024,pe.length),Fe=0,ke=0;ke<=Ee;++ke)(Fe=pe.charCodeAt(ke))>=32&&Fe<128&&++we;var Oe=we>=Ee*4/5;K.push(U),K.push("Content-Location: "+(B.root||"file:///C:/SheetJS/")+fe),K.push("Content-Transfer-Encoding: "+(Oe?"quoted-printable":"base64")),K.push("Content-Type: "+nw(me,fe)),K.push(""),K.push(Oe?aw(pe):iw(pe))}return K.push(U+`--\r
`),K.join(`\r
`)}function uw(D){var G={};return k(G,D),G}function Vu(D,G,B,U){var K=U&&U.unsafe;K||k(D);var J=!K&&Ie.find(D,G);if(!J){var fe=D.FullPaths[0];G.slice(0,fe.length)==fe?fe=G:(fe.slice(-1)!="/"&&(fe+="/"),fe=(fe+G).replace("//","/")),J={name:i(G),type:2},D.FileIndex.push(J),D.FullPaths.push(fe),K||Ie.utils.cfb_gc(D)}return J.content=B,J.size=B?B.length:0,U&&(U.CLSID&&(J.clsid=U.CLSID),U.mt&&(J.mt=U.mt),U.ct&&(J.ct=U.ct)),J}function fw(D,G){k(D);var B=Ie.find(D,G);if(B){for(var U=0;U<D.FileIndex.length;++U)if(D.FileIndex[U]==B)return D.FileIndex.splice(U,1),D.FullPaths.splice(U,1),!0}return!1}function hw(D,G,B){k(D);var U=Ie.find(D,G);if(U){for(var K=0;K<D.FileIndex.length;++K)if(D.FileIndex[K]==U)return D.FileIndex[K].name=i(B),D.FullPaths[K]=B,!0}return!1}function dw(D){F(D,!0)}return t.find=V,t.read=T,t.parse=d,t.write=j,t.writeFile=se,t.utils={cfb_new:uw,cfb_add:Vu,cfb_del:fw,cfb_mov:hw,cfb_gc:dw,ReadShift:xo,CheckField:dy,prep_blob:ar,bconcat:Qt,use_zlib:E,_deflateRaw:ze,_inflateRaw:ep,consts:le},t}();function mE(e){return typeof e=="string"?Ru(e):Array.isArray(e)?HC(e):e}function ml(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Ru(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Mn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([mE(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=a,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Bi(t)),o.write(t),o.close(),t}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("cannot save file "+e)}function vE(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Rt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Kg(e,t){for(var r=[],n=Rt(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function Mu(e){for(var t=[],r=Rt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function ju(e){for(var t=[],r=Rt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function xE(e){for(var t=[],r=Rt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var tu=new Date(1899,11,30,0,0,0);function Kt(e,t){var r=e.getTime(),n=tu.getTime()+(e.getTimezoneOffset()-tu.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var $1=new Date,yE=tu.getTime()+($1.getTimezoneOffset()-tu.getTimezoneOffset())*6e4,qg=$1.getTimezoneOffset();function Lu(e){var t=new Date;return t.setTime(e*24*60*60*1e3+yE),t.getTimezoneOffset()!==qg&&t.setTime(t.getTime()+(t.getTimezoneOffset()-qg)*6e4),t}function _E(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[a],10)}return t}var Jg=new Date("2017-02-19T19:06:09.000Z"),G1=isNaN(Jg.getFullYear())?new Date("2/19/17"):Jg,wE=G1.getFullYear()==2017;function vt(e,t){var r=new Date(e);if(wE)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(G1.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function ga(e,t){if(Ye&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Mn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Mn(R1(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Mn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Mn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function xt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=xt(e[r]));return t}function Nt(e,t){for(var r="";r.length<t;)r+=e;return r}function kn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var SE=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ts(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&SE.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var kE=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),l=[a[0]],o=1;o<a.length;++o)l.push(i),l.push(a[o]);return l}}();function Y1(e){return e?e.content&&e.type?ga(e.content,!0):e.data?ro(e.data):e.asNodeBuffer&&Ye?ro(e.asNodeBuffer().toString("binary")):e.asBinary?ro(e.asBinary()):e._data&&e._data.getContent?ro(ga(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function K1(e){if(!e)return null;if(e.data)return Bg(e.data);if(e.asNodeBuffer&&Ye)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Bg(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function bE(e){return e&&e.name.slice(-4)===".bin"?K1(e):Y1(e)}function en(e,t){for(var r=e.FullPaths||Rt(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var l=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||i==l)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function md(e,t){var r=en(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Wt(e,t,r){if(!r)return bE(md(e,t));if(!t)return null;try{return Wt(e,t)}catch{return null}}function zr(e,t,r){if(!r)return Y1(md(e,t));if(!t)return null;try{return zr(e,t)}catch{return null}}function TE(e,t,r){return K1(md(e,t))}function Qg(e){for(var t=e.FullPaths||Rt(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Ge(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ye?n=si(r):n=zC(r),Ie.utils.cfb_add(e,t,n)}Ie.utils.cfb_add(e,t,r)}else e.file(t,r)}function vd(){return Ie.utils.cfb_new()}function q1(e,t){switch(t.type){case"base64":return Ie.read(e,{type:"base64"});case"binary":return Ie.read(e,{type:"binary"});case"buffer":case"array":return Ie.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function io(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Bt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,CE=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Zg=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,EE=/<[^>]*>/g,wr=Bt.match(Zg)?Zg:EE,AE=/<\w*:/,OE=/<(\/?)\w+:/;function He(e,t,r){for(var n={},i=0,a=0;i!==e.length&&!((a=e.charCodeAt(i))===32||a===10||a===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var l=e.match(CE),o=0,s="",c=0,d="",f="",h=1;if(l)for(c=0;c!=l.length;++c){for(f=l[c],a=0;a!=f.length&&f.charCodeAt(a)!==61;++a);for(d=f.slice(0,a).trim();f.charCodeAt(a+1)==32;)++a;for(h=(i=f.charCodeAt(a+1))==34||i==39?1:0,s=f.slice(a+1+h,f.length-h),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=s,n[d.toLowerCase()]=s;else{var u=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[u]&&d.slice(o-3,o)=="ext")continue;n[u]=s,n[u.toLowerCase()]=s}}return n}function Bn(e){return e.replace(OE,"<$1")}var J1={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},xd=Mu(J1),tt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(e,function(o,s){return J1[o]||String.fromCharCode(parseInt(s,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,s){return String.fromCharCode(parseInt(s,16))});var l=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,l)+r(i.slice(l+3))}}(),yd=/[&<>'"]/g,FE=/[\u0000-\u0008\u000b-\u001f]/g;function lt(e){var t=e+"";return t.replace(yd,function(r){return xd[r]}).replace(FE,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function em(e){return lt(e).replace(/ /g,"_x0020_")}var Q1=/[\u0000-\u001f]/g;function _d(e){var t=e+"";return t.replace(yd,function(r){return xd[r]}).replace(/\n/g,"<br/>").replace(Q1,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function PE(e){var t=e+"";return t.replace(yd,function(r){return xd[r]}).replace(Q1,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var tm=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function NE(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function gt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Of(e){for(var t="",r=0,n=0,i=0,a=0,l=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=i&63,t+=String.fromCharCode(l);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}l=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function rm(e){var t=Ni(2*e.length),r,n,i=1,a=0,l=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[a++]=l&255,t[a++]=l>>>8,l=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function nm(e){return si(e,"binary").toString("utf8")}var Jl="foo bar baz",ut=Ye&&(nm(Jl)==Of(Jl)&&nm||rm(Jl)==Of(Jl)&&rm)||Of,Mn=Ye?function(e){return si(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Zo=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),Z1=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),DE=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),RE=/<\/?(?:vt:)?variant>/g,IE=/<(?:vt:)([^>]*)>([\s\S]*)</;function im(e,t){var r=He(e),n=e.match(DE(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(a){var l=a.replace(RE,"").match(IE);l&&i.push({v:ut(l[2]),t:l[1]})}),i}var ey=/(^\s|\s$|\n)/;function sr(e,t){return"<"+e+(t.match(ey)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function el(e){return Rt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Te(e,t,r){return"<"+e+(r!=null?el(r):"")+(t!=null?(t.match(ey)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Kh(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function ME(e,t){switch(typeof e){case"string":var r=Te("vt:lpwstr",lt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Te((e|0)==e?"vt:i4":"vt:r8",lt(String(e)));case"boolean":return Te("vt:bool",e?"true":"false")}if(e instanceof Date)return Te("vt:filetime",Kh(e));throw new Error("Unable to serialize "+e)}function wd(e){if(Ye&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ut(Bi(dd(e)));throw new Error("Bad input format: expected Buffer or string")}var tl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Gt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ka=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ur={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function jE(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function LE(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,l=n?-t:t;isFinite(l)?l==0?i=a=0:(i=Math.floor(Math.log(l)/Math.LN2),a=l*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|n}var am=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},sm=Ye?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:si(t)})):am(e)}:am,om=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Gn(e,i)));return n.join("").replace(Cr,"")},Sd=Ye?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Cr,""):om(e,t,r)}:om,lm=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},ty=Ye?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):lm(e,t,r)}:lm,cm=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Va(e,i)));return n.join("")},vl=Ye?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):cm(t,r,n)}:cm,ry=function(e,t){var r=Wr(e,t);return r>0?vl(e,t+4,t+4+r-1):""},ny=ry,iy=function(e,t){var r=Wr(e,t);return r>0?vl(e,t+4,t+4+r-1):""},ay=iy,sy=function(e,t){var r=2*Wr(e,t);return r>0?vl(e,t+4,t+4+r-1):""},oy=sy,ly=function(t,r){var n=Wr(t,r);return n>0?Sd(t,r+4,r+4+n):""},cy=ly,uy=function(e,t){var r=Wr(e,t);return r>0?vl(e,t+4,t+4+r):""},fy=uy,hy=function(e,t){return jE(e,t)},ru=hy,kd=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ye&&(ny=function(t,r){if(!Buffer.isBuffer(t))return ry(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},ay=function(t,r){if(!Buffer.isBuffer(t))return iy(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},oy=function(t,r){if(!Buffer.isBuffer(t))return sy(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},cy=function(t,r){if(!Buffer.isBuffer(t))return ly(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},fy=function(t,r){if(!Buffer.isBuffer(t))return uy(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},ru=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):hy(t,r)},kd=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Va=function(e,t){return e[t]},Gn=function(e,t){return e[t+1]*256+e[t]},BE=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Wr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ji=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},UE=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function xo(e,t){var r="",n,i,a=[],l,o,s,c;switch(t){case"dbcs":if(c=this.l,Ye&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(s=0;s<e;++s)r+=String.fromCharCode(Gn(this,c)),c+=2;e*=2;break;case"utf8":r=vl(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Sd(this,this.l,this.l+e);break;case"wstr":return xo.call(this,e,"dbcs");case"lpstr-ansi":r=ny(this,this.l),e=4+Wr(this,this.l);break;case"lpstr-cp":r=ay(this,this.l),e=4+Wr(this,this.l);break;case"lpwstr":r=oy(this,this.l),e=4+2*Wr(this,this.l);break;case"lpp4":e=4+Wr(this,this.l),r=cy(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Wr(this,this.l),r=fy(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=Va(this,this.l+e++))!==0;)a.push(ql(l));r=a.join("");break;case"_wstr":for(e=0,r="";(l=Gn(this,this.l+e))!==0;)a.push(ql(l)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",c=this.l,s=0;s<e;++s){if(this.lens&&this.lens.indexOf(c)!==-1)return l=Va(this,c),this.l=c+1,o=xo.call(this,e-s,l?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(ql(Gn(this,c))),c+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,s=0;s!=e;++s){if(this.lens&&this.lens.indexOf(c)!==-1)return l=Va(this,c),this.l=c+1,o=xo.call(this,e-s,l?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(ql(Va(this,c))),c+=1}r=a.join("");break;default:switch(e){case 1:return n=Va(this,this.l),this.l++,n;case 2:return n=(t==="i"?BE:Gn)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ji:UE)(this,this.l),this.l+=4,n):(i=Wr(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=ru(this,this.l):i=ru([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=ty(this,this.l,e);break}}return this.l+=e,r}var WE=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},HE=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},zE=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function VE(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)zE(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var l=t.charCodeAt(i);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,WE(this,t,this.l);break;case 8:if(n=8,r==="f"){LE(this,t,this.l);break}case 16:break;case-4:n=4,HE(this,t,this.l);break}return this.l+=n,this}function dy(e,t){var r=ty(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ar(e,t){e.l=t,e.read_shift=xo,e.chk=dy,e.write_shift=VE}function _r(e,t){e.l+=t}function ge(e){var t=Ni(e);return ar(t,0),t}function oi(e,t,r){if(e){var n,i,a;ar(e,e.l||0);for(var l=e.length,o=0,s=0;e.l<l;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=ol[o]||ol[65535];for(n=e.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=e.read_shift(1))&127)<<7*i;s=e.l+a;var d=c.f&&c.f(e,a,r);if(e.l=s,t(d,c,o))return}}}function Mr(){var e=[],t=Ye?256:2048,r=function(c){var d=ge(c);return ar(d,0),d},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},l=function(){return i(),Qt(e)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:l,_bufs:e}}function xe(e,t,r,n){var i=+t,a;if(!isNaN(i)){n||(n=ol[i].p||(r||[]).length||0),a=1+(i>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var l=e.next(a);i<=127?l.write_shift(1,i):(l.write_shift(1,(i&127)+128),l.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&kd(r)&&e.push(r)}}function yo(e,t,r){var n=xt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function um(e,t,r){var n=xt(e);return n.s=yo(n.s,t.s,r),n.e=yo(n.e,t.s,r),n}function _o(e,t){if(e.cRel&&e.c<0)for(e=xt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=xt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=We(e);return!e.cRel&&e.cRel!=null&&(r=GE(r)),!e.rRel&&e.rRel!=null&&(r=XE(r)),r}function Ff(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ct(e.s.c)+":"+(e.e.cRel?"":"$")+Ct(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Lt(e.s.r)+":"+(e.e.rRel?"":"$")+Lt(e.e.r):_o(e.s,t.biff)+":"+_o(e.e,t.biff)}function bd(e){return parseInt($E(e),10)-1}function Lt(e){return""+(e+1)}function XE(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function $E(e){return e.replace(/\$(\d+)$/,"$1")}function Td(e){for(var t=YE(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Ct(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function GE(e){return e.replace(/^([A-Z])/,"$$$1")}function YE(e){return e.replace(/^\$([A-Z])/,"$1")}function KE(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Et(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function We(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function jr(e){var t=e.indexOf(":");return t==-1?{s:Et(e),e:Et(e)}:{s:Et(e.slice(0,t)),e:Et(e.slice(t+1))}}function $e(e,t){return typeof t>"u"||typeof t=="number"?$e(e.s,e.e):(typeof e!="string"&&(e=We(e)),typeof t!="string"&&(t=We(t)),e==t?e:e+":"+t)}function rt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=e.length;for(r=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function fm(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=un(e.z,r?Kt(t):t)}catch{}try{return e.w=un((e.XF||{}).numFmtId||(r?14:0),r?Kt(t):t)}catch{return""+t}}function ni(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?li[e.v]||e.v:t==null?fm(e,e.v):fm(e,t))}function Ui(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function py(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,a=e||(i?[]:{}),l=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var s=typeof n.origin=="string"?Et(n.origin):n.origin;l=s.r,o=s.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=rt(a["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),l==-1&&(c.e.r=l=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var u={v:t[f][h]},p=l+f,m=o+h;if(c.s.r>p&&(c.s.r=p),c.s.c>m&&(c.s.c=m),c.e.r<p&&(c.e.r=p),c.e.c<m&&(c.e.c=m),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))u=t[f][h];else if(Array.isArray(u.v)&&(u.f=t[f][h][1],u.v=u.v[0]),u.v===null)if(u.f)u.t="n";else if(n.nullError)u.t="e",u.v=0;else if(n.sheetStubs)u.t="z";else continue;else typeof u.v=="number"?u.t="n":typeof u.v=="boolean"?u.t="b":u.v instanceof Date?(u.z=n.dateNF||Be[14],n.cellDates?(u.t="d",u.w=un(u.z,Kt(u.v))):(u.t="n",u.v=Kt(u.v),u.w=un(u.z,u.v))):u.t="s";if(i)a[p]||(a[p]=[]),a[p][m]&&a[p][m].z&&(u.z=a[p][m].z),a[p][m]=u;else{var g=We({c:m,r:p});a[g]&&a[g].z&&(u.z=a[g].z),a[g]=u}}}return c.s.c<1e7&&(a["!ref"]=$e(c)),a}function Is(e,t){return py(null,e,t)}function qE(e){return e.read_shift(4,"i")}function bn(e,t){return t||(t=ge(4)),t.write_shift(4,e),t}function xr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Zt(e,t){var r=!1;return t==null&&(r=!0,t=ge(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function JE(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function QE(e,t){return t||(t=ge(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Cd(e,t){var r=e.l,n=e.read_shift(1),i=xr(e),a=[],l={t:i,h:i};if(n&1){for(var o=e.read_shift(4),s=0;s!=o;++s)a.push(JE(e));l.r=a}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function ZE(e,t){var r=!1;return t==null&&(r=!0,t=ge(15+4*e.t.length)),t.write_shift(1,0),Zt(e.t,t),r?t.slice(0,t.l):t}var e4=Cd;function t4(e,t){var r=!1;return t==null&&(r=!0,t=ge(23+4*e.t.length)),t.write_shift(1,1),Zt(e.t,t),t.write_shift(4,1),QE({},t),r?t.slice(0,t.l):t}function fn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ba(e,t){return t==null&&(t=ge(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ta(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ca(e,t){return t==null&&(t=ge(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var r4=xr,gy=Zt;function Ed(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function nu(e,t){var r=!1;return t==null&&(r=!0,t=ge(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var n4=xr,qh=Ed,Ad=nu;function Od(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?ru([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ji(t,0)>>2;return r?i/100:i}function my(e,t){t==null&&(t=ge(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function vy(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function i4(e,t){return t||(t=ge(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ea=vy,Ms=i4;function vr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ma(e,t){return(t||ge(8)).write_shift(8,e,"f")}function a4(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),s=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=aa[i];c&&(t.rgb=nl(c));break;case 2:t.rgb=nl([l,o,s]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function iu(e,t){if(t||(t=ge(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function s4(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function o4(e,t){t||(t=ge(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function xy(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function l4(e){return xy(e,1)}function c4(e){return xy(e,2)}var Fd=2,Or=3,Ql=11,hm=12,au=19,Zl=64,u4=65,f4=71,h4=4108,d4=4126,qt=80,yy=81,p4=[qt,yy],Jh={1:{n:"CodePage",t:Fd},2:{n:"Category",t:qt},3:{n:"PresentationFormat",t:qt},4:{n:"ByteCount",t:Or},5:{n:"LineCount",t:Or},6:{n:"ParagraphCount",t:Or},7:{n:"SlideCount",t:Or},8:{n:"NoteCount",t:Or},9:{n:"HiddenCount",t:Or},10:{n:"MultimediaClipCount",t:Or},11:{n:"ScaleCrop",t:Ql},12:{n:"HeadingPairs",t:h4},13:{n:"TitlesOfParts",t:d4},14:{n:"Manager",t:qt},15:{n:"Company",t:qt},16:{n:"LinksUpToDate",t:Ql},17:{n:"CharacterCount",t:Or},19:{n:"SharedDoc",t:Ql},22:{n:"HyperlinksChanged",t:Ql},23:{n:"AppVersion",t:Or,p:"version"},24:{n:"DigSig",t:u4},26:{n:"ContentType",t:qt},27:{n:"ContentStatus",t:qt},28:{n:"Language",t:qt},29:{n:"Version",t:qt},255:{},2147483648:{n:"Locale",t:au},2147483651:{n:"Behavior",t:au},1919054434:{}},Qh={1:{n:"CodePage",t:Fd},2:{n:"Title",t:qt},3:{n:"Subject",t:qt},4:{n:"Author",t:qt},5:{n:"Keywords",t:qt},6:{n:"Comments",t:qt},7:{n:"Template",t:qt},8:{n:"LastAuthor",t:qt},9:{n:"RevNumber",t:qt},10:{n:"EditTime",t:Zl},11:{n:"LastPrinted",t:Zl},12:{n:"CreatedDate",t:Zl},13:{n:"ModifiedDate",t:Zl},14:{n:"PageCount",t:Or},15:{n:"WordCount",t:Or},16:{n:"CharCount",t:Or},17:{n:"Thumbnail",t:f4},18:{n:"Application",t:qt},19:{n:"DocSecurity",t:Or},255:{},2147483648:{n:"Locale",t:au},2147483651:{n:"Behavior",t:au},1919054434:{}},dm={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},g4=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function m4(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var v4=m4([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),aa=xt(v4),li={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},_y={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Zh={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ec={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Pd(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function x4(e){var t=Pd();if(!e||!e.match)return t;var r={};if((e.match(wr)||[]).forEach(function(n){var i=He(n);switch(i[0].replace(AE,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[Zh[i.ContentType]]!==void 0&&t[Zh[i.ContentType]].push(i.PartName);break}}),t.xmlns!==Gt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function wy(e,t){var r=xE(Zh),n=[],i;n[n.length]=Bt,n[n.length]=Te("Types",null,{xmlns:Gt.CT,"xmlns:xsd":Gt.xsd,"xmlns:xsi":Gt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(s){return Te("Default",null,{Extension:s[0],ContentType:s[1]})}));var a=function(s){e[s]&&e[s].length>0&&(i=e[s][0],n[n.length]=Te("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:ec[s][t.bookType]||ec[s].xlsx}))},l=function(s){(e[s]||[]).forEach(function(c){n[n.length]=Te("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:ec[s][t.bookType]||ec[s].xlsx})})},o=function(s){(e[s]||[]).forEach(function(c){n[n.length]=Te("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[s][0]})})};return a("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var qe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function rl(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function wo(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(wr)||[]).forEach(function(i){var a=He(i);if(a[0]==="<Relationship"){var l={};l.Type=a.Type,l.Target=a.Target,l.Id=a.Id,a.TargetMode&&(l.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:io(a.Target,t);r[o]=l,n[a.Id]=l}}),r["!id"]=n,r}function ps(e){var t=[Bt,Te("Relationships",null,{xmlns:Gt.RELS})];return Rt(e["!id"]).forEach(function(r){t[t.length]=Te("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ot(e,t,r,n,i,a){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[qe.HLINK,qe.XPATH,qe.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var y4="application/vnd.oasis.opendocument.spreadsheet";function _4(e,t){for(var r=wd(e),n,i;n=tl.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=He(n[0],!1),i.path=="/"&&i.type!==y4)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function w4(e){var t=[Bt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function pm(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function S4(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function k4(e){var t=[Bt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(pm(e[r][0],e[r][1])),t.push(S4("",e[r][0]));return t.push(pm("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Sy(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Jc.version+"</meta:generator></office:meta></office:document-meta>"}var on=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],b4=function(){for(var e=new Array(on.length),t=0;t<on.length;++t){var r=on[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function ky(e){var t={};e=ut(e);for(var r=0;r<on.length;++r){var n=on[r],i=e.match(b4[r]);i!=null&&i.length>0&&(t[n[1]]=tt(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=vt(t[n[1]]))}return t}function Pf(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=lt(t),n[n.length]=r?Te(e,t,r):sr(e,t))}function by(e,t){var r=t||{},n=[Bt,Te("cp:coreProperties",null,{"xmlns:cp":Gt.CORE_PROPS,"xmlns:dc":Gt.dc,"xmlns:dcterms":Gt.dcterms,"xmlns:dcmitype":Gt.dcmitype,"xmlns:xsi":Gt.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Pf("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Kh(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&Pf("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Kh(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var a=0;a!=on.length;++a){var l=on[a],o=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Pf(l[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var sa=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Ty=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Cy(e,t,r,n){var i=[];if(typeof e=="string")i=im(e,n);else for(var a=0;a<e.length;++a)i=i.concat(e[a].map(function(d){return{v:d}}));var l=typeof t=="string"?im(t,n).map(function(d){return d.v}):t,o=0,s=0;if(l.length>0)for(var c=0;c!==i.length;c+=2){switch(s=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=s,r.SheetNames=l.slice(o,o+s);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=s,r.DefinedNames=l.slice(o,o+s);break;case"Charts":case"Diagramme":r.Chartsheets=s,r.ChartNames=l.slice(o,o+s);break}o+=s}}function T4(e,t,r){var n={};return t||(t={}),e=ut(e),sa.forEach(function(i){var a=(e.match(Zo(i[0]))||[])[1];switch(i[2]){case"string":a&&(t[i[1]]=tt(a));break;case"bool":t[i[1]]=a==="true";break;case"raw":var l=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));l&&l.length>0&&(n[i[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Cy(n.HeadingPairs,n.TitlesOfParts,t,r),t}function Ey(e){var t=[],r=Te;return e||(e={}),e.Application="SheetJS",t[t.length]=Bt,t[t.length]=Te("Properties",null,{xmlns:Gt.EXT_PROPS,"xmlns:vt":Gt.vt}),sa.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=lt(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+lt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var C4=/<[^>]+>[^<]*/g;function E4(e,t){var r={},n="",i=e.match(C4);if(i)for(var a=0;a!=i.length;++a){var l=i[a],o=He(l);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=tt(o.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var s=l.split(">"),c=s[0].slice(4),d=s[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=tt(d);break;case"bool":r[n]=gt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=vt(d);break;case"cy":case"error":r[n]=tt(d);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,c,s)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function Ay(e){var t=[Bt,Te("Properties",null,{xmlns:Gt.CUST_PROPS,"xmlns:vt":Gt.vt})];if(!e)return t.join("");var r=1;return Rt(e).forEach(function(i){++r,t[t.length]=Te("property",ME(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:lt(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var e0={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Nf;function A4(e,t,r){Nf||(Nf=Mu(e0)),t=Nf[t]||t,e[t]=r}function O4(e,t){var r=[];return Rt(e0).map(function(n){for(var i=0;i<on.length;++i)if(on[i][1]==n)return on[i];for(i=0;i<sa.length;++i)if(sa[i][1]==n)return sa[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(sr(e0[n[1]]||n[1],i))}}),Te("DocumentProperties",r.join(""),{xmlns:Ur.o})}function F4(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&Rt(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var l=0;l<on.length;++l)if(a==on[l][1])return;for(l=0;l<sa.length;++l)if(a==sa[l][1])return;for(l=0;l<r.length;++l)if(a==r[l])return;var o=e[a],s="string";typeof o=="number"?(s="float",o=String(o)):o===!0||o===!1?(s="boolean",o=o?"1":"0"):o=String(o),i.push(Te(em(a),o,{"dt:dt":s}))}}),t&&Rt(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var l=t[a],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),i.push(Te(em(a),l,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Ur.o+'">'+i.join("")+"</"+n+">"}function Nd(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function P4(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),i+=a);var l=ge(8);return l.write_shift(4,n),l.write_shift(4,i),l}function Oy(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function Fy(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Py(e,t,r){return t===31?Fy(e):Oy(e,t,r)}function t0(e,t,r){return Py(e,t,r===!1?0:4)}function N4(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Py(e,t,0)}function D4(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Cr,""),e.l-i&2&&(e.l+=2)}return r}function R4(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Cr,"");return r}function I4(e){var t=e.l,r=su(e,yy);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=su(e,Or);return[r,n]}function M4(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(I4(e));return r}function gm(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var a=e.read_shift(4),l=e.read_shift(4);n[a]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(Cr,"").replace(no,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Ny(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function j4(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function su(e,t,r){var n=e.read_shift(2),i,a=r||{};if(e.l+=2,t!==hm&&n!==t&&p4.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===hm?n:t){case 2:return i=e.read_shift(2,"i"),a.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return Oy(e,n,4).replace(Cr,"");case 31:return Fy(e);case 64:return Nd(e);case 65:return Ny(e);case 71:return j4(e);case 80:return t0(e,n,!a.raw).replace(Cr,"");case 81:return N4(e,n).replace(Cr,"");case 4108:return M4(e);case 4126:case 4127:return n==4127?D4(e):R4(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function mm(e,t){var r=ge(4),n=ge(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=ge(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=P4(t);break;case 31:case 80:for(n=ge(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Qt([r,n])}function vm(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),a=[],l=0,o=0,s=-1,c={};for(l=0;l!=i;++l){var d=e.read_shift(4),f=e.read_shift(4);a[l]=[d,f+r]}a.sort(function(x,y){return x[1]-y[1]});var h={};for(l=0;l!=i;++l){if(e.l!==a[l][1]){var u=!0;if(l>0&&t)switch(t[a[l-1][0]].t){case 2:e.l+2===a[l][1]&&(e.l+=2,u=!1);break;case 80:e.l<=a[l][1]&&(e.l=a[l][1],u=!1);break;case 4108:e.l<=a[l][1]&&(e.l=a[l][1],u=!1);break}if((!t||l==0)&&e.l<=a[l][1]&&(u=!1,e.l=a[l][1]),u)throw new Error("Read Error: Expected address "+a[l][1]+" at "+e.l+" :"+l)}if(t){var p=t[a[l][0]];if(h[p.n]=su(e,p.t,{raw:!0}),p.p==="version"&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(h[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:yn(o=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(a[l][0]===1){if(o=h.CodePage=su(e,Fd),yn(o),s!==-1){var m=e.l;e.l=a[s][1],c=gm(e,o),e.l=m}}else if(a[l][0]===0){if(o===0){s=l,e.l=a[l+1][1];continue}c=gm(e,o)}else{var g=c[a[l][0]],v;switch(e[e.l]){case 65:e.l+=4,v=Ny(e);break;case 30:e.l+=4,v=t0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=t0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=Mt(e,4);break;case 64:e.l+=4,v=vt(Nd(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=v}}return e.l=r+n,h}var Dy=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function L4(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function xm(e,t,r){var n=ge(8),i=[],a=[],l=8,o=0,s=ge(8),c=ge(8);if(s.write_shift(4,2),s.write_shift(4,1200),c.write_shift(4,1),a.push(s),i.push(c),l+=8+s.length,!t){c=ge(8),c.write_shift(4,0),i.unshift(c);var d=[ge(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(s=ge(8+2*(f.length+1)+(f.length%2?0:2)),s.write_shift(4,o+2),s.write_shift(4,f.length+1),s.write_shift(0,f,"dbcs");s.l!=s.length;)s.write_shift(1,0);d.push(s)}s=Qt(d),a.unshift(s),l+=8+s.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(Dy.indexOf(e[o][0])>-1||Ty.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],u=0;if(t){u=+t[e[o][0]];var p=r[u];if(p.p=="version"&&typeof h=="string"){var m=h.split(".");h=(+m[0]<<16)+(+m[1]||0)}s=mm(p.t,h)}else{var g=L4(h);g==-1&&(g=31,h=String(h)),s=mm(g,h)}a.push(s),c=ge(8),c.write_shift(4,t?u:2+o),i.push(c),l+=8+s.length}var v=8*(a.length+1);for(o=0;o<a.length;++o)i[o].write_shift(4,v),v+=a[o].length;return n.write_shift(4,l),n.write_shift(4,a.length),Qt([n].concat(i).concat(a))}function ym(e,t,r){var n=e.content;if(!n)return{};ar(n,0);var i,a,l,o,s=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),d=n.read_shift(16);if(d!==Ie.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(l=n.read_shift(16),s=n.read_shift(4));var f=vm(n,t),h={SystemIdentifier:c};for(var u in f)h[u]=f[u];if(h.FMTID=a,i===1)return h;if(s-n.l==2&&(n.l+=2),n.l!==s)throw new Error("Length mismatch 2: "+n.l+" !== "+s);var p;try{p=vm(n,null)}catch{}for(u in p)h[u]=p[u];return h.FMTID=[a,l],h}function _m(e,t,r,n,i,a){var l=ge(i?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Ie.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,i?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,i?68:48);var s=xm(e,r,n);if(o.push(s),i){var c=xm(i,null,null);l.write_shift(16,a,"hex"),l.write_shift(4,68+s.length),o.push(c)}return Qt(o)}function ui(e,t){return e.read_shift(t),null}function B4(e,t){t||(t=ge(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function U4(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Mt(e,t){return e.read_shift(t)===1}function br(e,t){return t||(t=ge(2)),t.write_shift(2,+!!e),t}function Ht(e){return e.read_shift(2,"u")}function tn(e,t){return t||(t=ge(2)),t.write_shift(2,e),t}function Ry(e,t){return U4(e,t,Ht)}function W4(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Iy(e,t,r){return r||(r=ge(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function xl(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var l=n?e.read_shift(n,i):"";return l}function H4(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,a=1+(r&1),l=0,o,s={};i&&(l=e.read_shift(2)),n&&(o=e.read_shift(4));var c=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,c);return i&&(e.l+=4*l),n&&(e.l+=o),s.t=d,i||(s.raw="<t>"+s.t+"</t>",s.r=s.t),s}function z4(e){var t=e.t||"",r=ge(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=ge(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return Qt(i)}function va(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function yl(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):va(e,n,r)}function Aa(e,t,r){if(r.biff>5)return yl(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function My(e,t,r){return r||(r=ge(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function V4(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function X4(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Cr,"");return n&&(e.l+=24),i}function $4(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(a>>1,"utf16le").replace(Cr,"");return r+l}function G4(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return X4(e);case"0303000000000000c000000000000046":return $4(e);default:throw new Error("Unsupported Moniker "+r)}}function tc(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Cr,""):"";return r}function wm(e,t){t||(t=ge(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Y4(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var a,l,o,s,c="",d,f;i&16&&(a=tc(e,r-e.l)),i&128&&(l=tc(e,r-e.l)),(i&257)===257&&(o=tc(e,r-e.l)),(i&257)===1&&(s=G4(e,r-e.l)),i&8&&(c=tc(e,r-e.l)),i&32&&(d=e.read_shift(16)),i&64&&(f=Nd(e)),e.l=r;var h=l||o||s||"";h&&c&&(h+="#"+c),h||(h="#"+c),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var u={Target:h};return d&&(u.guid=d),f&&(u.time=f),a&&(u.Tooltip=a),u}function K4(e){var t=ge(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),a=i>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(a==28)n=n.slice(1),wm(n,t);else if(a&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&wm(i>-1?n.slice(i+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var s=0;n.slice(s*3,s*3+3)=="../"||n.slice(s*3,s*3+3)=="..\\";)++s;for(t.write_shift(2,s),t.write_shift(4,n.length-3*s+1),r=0;r<n.length-3*s;++r)t.write_shift(1,n.charCodeAt(r+3*s)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function jy(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function Ly(e,t){var r=jy(e);return r[3]=0,r}function Un(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function xa(e,t,r,n){return n||(n=ge(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function q4(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function J4(e,t,r){return t===0?"":Aa(e,t,r)}function Q4(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[i,a,l]}function By(e){var t=e.read_shift(2),r=Od(e);return[t,r]}function Z4(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=xl(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,i}function Bu(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function Uy(e,t){return t||(t=ge(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Wy(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var eA=Wy;function Hy(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function tA(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function rA(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function hr(e){e.l+=2,e.l+=e.read_shift(2)}var nA={0:hr,4:hr,5:hr,6:hr,7:rA,8:hr,9:hr,10:hr,11:hr,12:hr,13:tA,14:hr,15:hr,16:hr,17:hr,18:hr,19:hr,20:hr,21:Hy};function iA(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(nA[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function rc(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Dd(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=ge(i);return a.write_shift(2,n),a.write_shift(2,t),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function aA(e,t){return t===0||e.read_shift(2),1200}function sA(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=Aa(e,0,r);return e.read_shift(t+n-e.l),i}function oA(e,t){var r=!t||t.biff==8,n=ge(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function lA(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function cA(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var l=xl(e,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:i,dt:a,name:l}}function uA(e,t){var r=!t||t.biff>=8?2:1,n=ge(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function fA(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),a=[],l=0;l!=i&&e.l<r;++l)a.push(H4(e));return a.Count=n,a.Unique=i,a}function hA(e,t){var r=ge(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=z4(e[i]);var a=Qt([r].concat(n));return a.parts=[r.length].concat(n.map(function(l){return l.length})),a}function dA(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function pA(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function gA(e){var t=q4(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function mA(e){return e.read_shift(2),e.read_shift(4)}function Sm(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function vA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:a,CurTab:l,FirstTab:o,Selected:s,TabRatio:c}}function xA(){var e=ge(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function yA(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function _A(e){var t=ge(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function wA(){}function SA(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=xl(e,0,r),n}function kA(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,a=ge(i);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function bA(e){var t=Un(e);return t.isst=e.read_shift(4),t}function TA(e,t,r,n){var i=ge(10);return xa(e,t,n,i),i.write_shift(4,r),i}function CA(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=Un(e);r.biff==2&&e.l++;var a=yl(e,n-e.l,r);return i.val=a,i}function EA(e,t,r,n,i){var a=!i||i.biff==8,l=ge(8+ +a+(1+a)*r.length);return xa(e,t,n,l),l.write_shift(2,r.length),a&&l.write_shift(1,1),l.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),l}function AA(e,t,r){var n=e.read_shift(2),i=Aa(e,0,r);return[n,i]}function OA(e,t,r,n){var i=r&&r.biff==5;n||(n=ge(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var FA=Aa;function km(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,a=e.read_shift(i),l=e.read_shift(i),o=e.read_shift(2),s=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:l,c:s}}}function PA(e,t){var r=t.biff==8||!t.biff?4:2,n=ge(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function NA(e){var t=e.read_shift(2),r=e.read_shift(2),n=By(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function DA(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(By(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(a.length!=l-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:l,rkrec:a}}function RA(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(a.length!=l-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:l,ixfe:a}}function IA(e,t,r,n){var i={},a=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(4),s=e.read_shift(2);return i.patternType=g4[o>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=l&15,i.dgRight=l>>4&15,i.dgTop=l>>8&15,i.dgBottom=l>>12&15,i.icvLeft=l>>16&127,i.icvRight=l>>23&127,i.grbitDiag=l>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=s&127,i.icvBack=s>>7&127,i.fsxButton=s>>14&1),i}function MA(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=IA(e,t,n.fStyle,r),n}function bm(e,t,r,n){var i=r&&r.biff==5;n||(n=ge(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&i&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function jA(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function LA(e){var t=ge(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Tm(e,t,r){var n=Un(e);(r.biff==2||t==9)&&++e.l;var i=W4(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function BA(e,t,r,n,i,a){var l=ge(8);return xa(e,t,n,l),Iy(r,a,l),l}function UA(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Un(e),i=vr(e);return n.val=i,n}function WA(e,t,r,n){var i=ge(14);return xa(e,t,n,i),ma(r,i),i}var Cm=J4;function HA(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var l=va(e,a),o=[];n>e.l;)o.push(yl(e));return[a,i,l,o]}function Em(e,t,r){var n=e.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=Z4(e,t-2,r)),a.body=i||e.read_shift(t-2),typeof i=="string"&&(a.Name=i),a}var zA=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Am(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),s=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),s=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=va(e,l,r);i&32&&(c=zA[c.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||o===0||!(d>0)?[]:iN(e,d,r,o);return{chKey:a,Name:c,itab:s,rgce:f}}function zy(e,t,r){if(r.biff<8)return VA(e,t,r);for(var n=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(Q4(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function VA(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=xl(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function XA(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),a=va(e,n,r),l=va(e,i,r);return[a,l]}function $A(e,t,r){var n=Wy(e);e.l++;var i=e.read_shift(1);return t-=8,[aN(e,t,r),i,n]}function Om(e,t,r){var n=eA(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,rN(e,t,r)]}function GA(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function YA(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2),o=Aa(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},o,l,a]}}function KA(e,t,r){return YA(e,t,r)}function qA(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Bu(e));return r}function JA(e){var t=ge(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Uy(e[r],t);return t}function QA(e,t,r){if(r&&r.biff<8)return eO(e,t,r);var n=Hy(e),i=iA(e,t-22,n[1]);return{cmo:n,ft:i}}var ZA={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function eO(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((ZA[n]||_r)(e,t,r)),{cmo:[i,n,a],ft:l}}function tO(e,t,r){var n=e.l,i="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:l=V4(e,6,r);var o=e.read_shift(2);e.read_shift(2),Ht(e,2);var s=e.read_shift(2);e.l+=s;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var d=e[e.l],f=va(e,e.lens[c+1]-e.lens[c]-1);if(i+=f,i.length>=(d?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function rO(e,t){var r=Bu(e);e.l+=16;var n=Y4(e,t-24);return[r,n]}function nO(e){var t=ge(24),r=Et(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return Qt([t,K4(e[1])])}function iO(e,t){e.read_shift(2);var r=Bu(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Cr,""),[r,n]}function aO(e){var t=e[1].Tooltip,r=ge(10+2*(t.length+1));r.write_shift(2,2048);var n=Et(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function sO(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=dm[r]||r,r=e.read_shift(2),t[1]=dm[r]||r,t}function oO(e){return e||(e=ge(4)),e.write_shift(2,1),e.write_shift(2,1),e}function lO(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Ly(e));return r}function cO(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Ly(e));return r}function uO(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Vy(e,t,r){if(!r.cellStyles)return _r(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(n),s=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:a,w:l,ixfe:o,flags:s};return(r.biff>=5||!r.biff)&&(c.level=s>>8&7),c}function fO(e,t){var r=ge(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function hO(e,t){var r={};return t<32||(e.l+=16,r.header=vr(e),r.footer=vr(e),e.l+=2),r}function dO(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}function pO(e){for(var t=ge(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var gO=Un,mO=Ry,vO=yl;function xO(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function yO(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Un(e);++e.l;var i=Aa(e,t-7,r);return n.t="str",n.val=i,n}function _O(e){var t=Un(e);++e.l;var r=vr(e);return t.t="n",t.val=r,t}function wO(e,t,r){var n=ge(15);return kl(n,e,t),n.write_shift(8,r,"f"),n}function SO(e){var t=Un(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function kO(e,t,r){var n=ge(9);return kl(n,e,t),n.write_shift(2,r),n}function bO(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function TO(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function CO(e,t,r){var n=e.l+t,i=Un(e),a=e.read_shift(2),l=va(e,a,r);return e.l=n,i.t="str",i.val=l,i}var EO=[2,3,48,49,131,139,140,245],r0=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Mu({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,s){var c=[],d=Ni(1);switch(s.type){case"base64":d=Hr(Gr(o));break;case"binary":d=Hr(o);break;case"buffer":case"array":d=o;break}ar(d,0);var f=d.read_shift(1),h=!!(f&136),u=!1,p=!1;switch(f){case 2:break;case 3:break;case 48:u=!0,h=!0;break;case 49:u=!0,h=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,g=521;f==2&&(m=d.read_shift(2)),d.l+=3,f!=2&&(m=d.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(g=d.read_shift(2));var v=d.read_shift(2),x=s.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(x=e[d[d.l]]),d.l+=1,d.l+=2),p&&(d.l+=36);for(var y=[],_={},w=Math.min(d.length,f==2?521:g-10-(u?264:0)),T=p?32:11;d.l<w&&d[d.l]!=13;)switch(_={},_.name=qo.utils.decode(x,d.slice(d.l,d.l+T)).replace(/[\u0000\r\n].*$/g,""),d.l+=T,_.type=String.fromCharCode(d.read_shift(1)),f!=2&&!p&&(_.offset=d.read_shift(4)),_.len=d.read_shift(1),f==2&&(_.offset=d.read_shift(2)),_.dec=d.read_shift(1),_.name.length&&y.push(_),f!=2&&(d.l+=p?13:14),_.type){case"B":(!u||_.len!=8)&&s.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":s.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var k=0,O=0;for(c[0]=[],O=0;O!=y.length;++O)c[0][O]=y[O].name;for(;m-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,c[++k]=[],O=0,O=0;O!=y.length;++O){var F=d.slice(d.l,d.l+y[O].len);d.l+=y[O].len,ar(F,0);var M=qo.utils.decode(x,F);switch(y[O].type){case"C":M.trim().length&&(c[k][O]=M.replace(/\s+$/,""));break;case"D":M.length===8?c[k][O]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):c[k][O]=M;break;case"F":c[k][O]=parseFloat(M.trim());break;case"+":case"I":c[k][O]=p?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":c[k][O]=!0;break;case"N":case"F":c[k][O]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[k][O]="##MEMO##"+(p?parseInt(M.trim(),10):F.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(c[k][O]=+M||0);break;case"@":c[k][O]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":c[k][O]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":c[k][O]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[k][O]=-F.read_shift(-8,"f");break;case"B":if(u&&y[O].len==8){c[k][O]=F.read_shift(8,"f");break}case"G":case"P":F.l+=y[O].len;break;case"0":if(y[O].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[O].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return s&&s.sheetRows&&(c=c.slice(0,s.sheetRows)),s.DBF=y,c}function n(o,s){var c=s||{};c.dateNF||(c.dateNF="yyyymmdd");var d=Is(r(o,c),c);return d["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,d}function i(o,s){try{return Ui(n(o,s),s)}catch(c){if(s&&s.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,s){var c=s||{};if(+c.codepage>=0&&yn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var d=Mr(),f=cu(o,{header:1,raw:!0,cellDates:!0}),h=f[0],u=f.slice(1),p=o["!cols"]||[],m=0,g=0,v=0,x=1;for(m=0;m<h.length;++m){if(((p[m]||{}).DBF||{}).name){h[m]=p[m].DBF.name,++v;continue}if(h[m]!=null){if(++v,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(g=0;g<1024;++g)if(h.indexOf(h[m]+"_"+g)==-1){h[m]+="_"+g;break}}}}var y=rt(o["!ref"]),_=[],w=[],T=[];for(m=0;m<=y.e.c-y.s.c;++m){var k="",O="",F=0,M=[];for(g=0;g<u.length;++g)u[g][m]!=null&&M.push(u[g][m]);if(M.length==0||h[m]==null){_[m]="?";continue}for(g=0;g<M.length;++g){switch(typeof M[g]){case"number":O="B";break;case"string":O="C";break;case"boolean":O="L";break;case"object":O=M[g]instanceof Date?"D":"C";break;default:O="C"}F=Math.max(F,String(M[g]).length),k=k&&k!=O?"C":O}F>250&&(F=250),O=((p[m]||{}).DBF||{}).type,O=="C"&&p[m].DBF.len>F&&(F=p[m].DBF.len),k=="B"&&O=="N"&&(k="N",T[m]=p[m].DBF.dec,F=p[m].DBF.len),w[m]=k=="C"||O=="N"?F:a[k]||0,x+=w[m],_[m]=k}var V=d.next(32);for(V.write_shift(4,318902576),V.write_shift(4,u.length),V.write_shift(2,296+32*v),V.write_shift(2,x),m=0;m<4;++m)V.write_shift(4,0);for(V.write_shift(4,0|(+t[D1]||3)<<8),m=0,g=0;m<h.length;++m)if(h[m]!=null){var X=d.next(32),q=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);X.write_shift(1,q,"sbcs"),X.write_shift(1,_[m]=="?"?"C":_[m],"sbcs"),X.write_shift(4,g),X.write_shift(1,w[m]||a[_[m]]||0),X.write_shift(1,T[m]||0),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(1,0),X.write_shift(4,0),X.write_shift(4,0),g+=w[m]||a[_[m]]||0}var ae=d.next(264);for(ae.write_shift(4,13),m=0;m<65;++m)ae.write_shift(4,0);for(m=0;m<u.length;++m){var ne=d.next(x);for(ne.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(_[g]){case"L":ne.write_shift(1,u[m][g]==null?63:u[m][g]?84:70);break;case"B":ne.write_shift(8,u[m][g]||0,"f");break;case"N":var re="0";for(typeof u[m][g]=="number"&&(re=u[m][g].toFixed(T[g]||0)),v=0;v<w[g]-re.length;++v)ne.write_shift(1,32);ne.write_shift(1,re,"sbcs");break;case"D":u[m][g]?(ne.write_shift(4,("0000"+u[m][g].getFullYear()).slice(-4),"sbcs"),ne.write_shift(2,("00"+(u[m][g].getMonth()+1)).slice(-2),"sbcs"),ne.write_shift(2,("00"+u[m][g].getDate()).slice(-2),"sbcs")):ne.write_shift(8,"00000000","sbcs");break;case"C":var le=String(u[m][g]!=null?u[m][g]:"").slice(0,w[g]);for(ne.write_shift(1,le,"sbcs"),v=0;v<w[g]-le.length;++v)ne.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:l}}(),Xy=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Rt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,u){var p=e[u];return typeof p=="number"?Ug(p):p},n=function(h,u,p){var m=u.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return m==59?h:Ug(m)};e["|"]=254;function i(h,u){switch(u.type){case"base64":return a(Gr(h),u);case"binary":return a(h,u);case"buffer":return a(Ye&&Buffer.isBuffer(h)?h.toString("binary"):Bi(h),u);case"array":return a(ga(h),u)}throw new Error("Unrecognized type "+u.type)}function a(h,u){var p=h.split(/[\n\r]+/),m=-1,g=-1,v=0,x=0,y=[],_=[],w=null,T={},k=[],O=[],F=[],M=0,V;for(+u.codepage>=0&&yn(+u.codepage);v!==p.length;++v){M=0;var X=p[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),q=X.replace(/;;/g,"\0").split(";").map(function(b){return b.replace(/\u0000/g,";")}),ae=q[0],ne;if(X.length>0)switch(ae){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&_.push(X.slice(3).replace(/;;/g,";"));break;case"C":var re=!1,le=!1,se=!1,C=!1,j=-1,L=-1;for(x=1;x<q.length;++x)switch(q[x].charAt(0)){case"A":break;case"X":g=parseInt(q[x].slice(1))-1,le=!0;break;case"Y":for(m=parseInt(q[x].slice(1))-1,le||(g=0),V=y.length;V<=m;++V)y[V]=[];break;case"K":ne=q[x].slice(1),ne.charAt(0)==='"'?ne=ne.slice(1,ne.length-1):ne==="TRUE"?ne=!0:ne==="FALSE"?ne=!1:isNaN(kn(ne))?isNaN(Ts(ne).getDate())||(ne=vt(ne)):(ne=kn(ne),w!==null&&Ds(w)&&(ne=Lu(ne))),re=!0;break;case"E":C=!0;var E=gs(q[x].slice(1),{r:m,c:g});y[m][g]=[y[m][g],E];break;case"S":se=!0,y[m][g]=[y[m][g],"S5S"];break;case"G":break;case"R":j=parseInt(q[x].slice(1))-1;break;case"C":L=parseInt(q[x].slice(1))-1;break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+X)}if(re&&(y[m][g]&&y[m][g].length==2?y[m][g][0]=ne:y[m][g]=ne,w=null),se){if(C)throw new Error("SYLK shared formula cannot have own formula");var I=j>-1&&y[j][L];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");y[m][g][1]=c_(I[1],{r:m-j,c:g-L})}break;case"F":var A=0;for(x=1;x<q.length;++x)switch(q[x].charAt(0)){case"X":g=parseInt(q[x].slice(1))-1,++A;break;case"Y":for(m=parseInt(q[x].slice(1))-1,V=y.length;V<=m;++V)y[V]=[];break;case"M":M=parseInt(q[x].slice(1))/20;break;case"F":break;case"G":break;case"P":w=_[parseInt(q[x].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=q[x].slice(1).split(" "),V=parseInt(F[0],10);V<=parseInt(F[1],10);++V)M=parseInt(F[2],10),O[V-1]=M===0?{hidden:!0}:{wch:M},Di(O[V-1]);break;case"C":g=parseInt(q[x].slice(1))-1,O[g]||(O[g]={});break;case"R":m=parseInt(q[x].slice(1))-1,k[m]||(k[m]={}),M>0?(k[m].hpt=M,k[m].hpx=Es(M)):M===0&&(k[m].hidden=!0);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+X)}A<1&&(w=null);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+X)}}return k.length>0&&(T["!rows"]=k),O.length>0&&(T["!cols"]=O),u&&u.sheetRows&&(y=y.slice(0,u.sheetRows)),[y,T]}function l(h,u){var p=i(h,u),m=p[0],g=p[1],v=Is(m,u);return Rt(g).forEach(function(x){v[x]=g[x]}),v}function o(h,u){return Ui(l(h,u),u)}function s(h,u,p,m){var g="C;Y"+(p+1)+";X"+(m+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+Bd(h.f,{r:p,c:m}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(h,u){u.forEach(function(p,m){var g="F;W"+(m+1)+" "+(m+1)+" ";p.hidden?g+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=il(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=al(p.wpx)),typeof p.wch=="number"&&(g+=Math.round(p.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function d(h,u){u.forEach(function(p,m){var g="F;";p.hidden?g+="M0;":p.hpt?g+="M"+20*p.hpt+";":p.hpx&&(g+="M"+20*sl(p.hpx)+";"),g.length>2&&h.push(g+"R"+(m+1))})}function f(h,u){var p=["ID;PWXL;N;E"],m=[],g=rt(h["!ref"]),v,x=Array.isArray(h),y=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),h["!cols"]&&c(p,h["!cols"]),h["!rows"]&&d(p,h["!rows"]),p.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var _=g.s.r;_<=g.e.r;++_)for(var w=g.s.c;w<=g.e.c;++w){var T=We({r:_,c:w});v=x?(h[_]||[])[w]:h[T],!(!v||v.v==null&&(!v.f||v.F))&&m.push(s(v,h,_,w))}return p.join(y)+y+m.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:l,from_sheet:f}}(),$y=function(){function e(a,l){switch(l.type){case"base64":return t(Gr(a),l);case"binary":return t(a,l);case"buffer":return t(Ye&&Buffer.isBuffer(a)?a.toString("binary"):Bi(a),l);case"array":return t(ga(a),l)}throw new Error("Unrecognized type "+l.type)}function t(a,l){for(var o=a.split(`
`),s=-1,c=-1,d=0,f=[];d!==o.length;++d){if(o[d].trim()==="BOT"){f[++s]=[],c=0;continue}if(!(s<0)){var h=o[d].trim().split(","),u=h[0],p=h[1];++d;for(var m=o[d]||"";(m.match(/["]/g)||[]).length&1&&d<o.length-1;)m+=`
`+o[++d];switch(m=m.trim(),+u){case-1:if(m==="BOT"){f[++s]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[s][c]=!0:m==="FALSE"?f[s][c]=!1:isNaN(kn(p))?isNaN(Ts(p).getDate())?f[s][c]=p:f[s][c]=vt(p):f[s][c]=kn(p),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[s][c++]=m!==""?m:null;break}if(m==="EOD")break}}return l&&l.sheetRows&&(f=f.slice(0,l.sheetRows)),f}function r(a,l){return Is(e(a,l),l)}function n(a,l){return Ui(r(a,l),l)}var i=function(){var a=function(s,c,d,f,h){s.push(c),s.push(d+","+f),s.push('"'+h.replace(/"/g,'""')+'"')},l=function(s,c,d,f){s.push(c+","+d),s.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(s){var c=[],d=rt(s["!ref"]),f,h=Array.isArray(s);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,d.e.r-d.s.r+1,""),a(c,"TUPLES",0,d.e.c-d.s.c+1,""),a(c,"DATA",0,0,"");for(var u=d.s.r;u<=d.e.r;++u){l(c,-1,0,"BOT");for(var p=d.s.c;p<=d.e.c;++p){var m=We({r:u,c:p});if(f=h?(s[u]||[])[p]:s[m],!f){l(c,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?l(c,1,0,"="+f.f):l(c,1,0,""):l(c,0,g,"V");break;case"b":l(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":l(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=un(f.z||Be[14],Kt(vt(f.v)))),l(c,0,f.w,"V");break;default:l(c,1,0,"")}}}l(c,-1,0,"EOD");var v=`\r
`,x=c.join(v);return x}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),Gy=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var u=f.split(`
`),p=-1,m=-1,g=0,v=[];g!==u.length;++g){var x=u[g].trim().split(":");if(x[0]==="cell"){var y=Et(x[1]);if(v.length<=y.r)for(p=v.length;p<=y.r;++p)v[p]||(v[p]=[]);switch(p=y.r,m=y.c,x[2]){case"t":v[p][m]=e(x[3]);break;case"v":v[p][m]=+x[3];break;case"vtf":var _=x[x.length-1];case"vtc":switch(x[3]){case"nl":v[p][m]=!!+x[4];break;default:v[p][m]=+x[4];break}x[2]=="vtf"&&(v[p][m]=[v[p][m],_])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function n(f,h){return Is(r(f,h),h)}function i(f,h){return Ui(n(f,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),s="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var h=[],u=[],p,m="",g=jr(f["!ref"]),v=Array.isArray(f),x=g.s.r;x<=g.e.r;++x)for(var y=g.s.c;y<=g.e.c;++y)if(m=We({r:x,c:y}),p=v?(f[x]||[])[y]:f[m],!(!p||p.v==null||p.t==="z")){switch(u=["cell",m,"t"],p.t){case"s":case"str":u.push(t(p.v));break;case"n":p.f?(u[2]="vtf",u[3]="n",u[4]=p.v,u[5]=t(p.f)):(u[2]="v",u[3]=p.v);break;case"b":u[2]="vt"+(p.f?"f":"c"),u[3]="nl",u[4]=p.v?"1":"0",u[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var _=Kt(vt(p.v));u[2]="vtc",u[3]="nd",u[4]=""+_,u[5]=p.w||un(p.z||Be[14],_);break;case"e":continue}h.push(u.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[a,l,o,l,c(f),s].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),Cs=function(){function e(d,f,h,u,p){p.raw?f[h][u]=d:d===""||(d==="TRUE"?f[h][u]=!0:d==="FALSE"?f[h][u]=!1:isNaN(kn(d))?isNaN(Ts(d).getDate())?f[h][u]=d:f[h][u]=vt(d):f[h][u]=kn(d))}function t(d,f){var h=f||{},u=[];if(!d||d.length===0)return u;for(var p=d.split(/[\r\n]/),m=p.length-1;m>=0&&p[m].length===0;)--m;for(var g=10,v=0,x=0;x<=m;++x)v=p[x].indexOf(" "),v==-1?v=p[x].length:v++,g=Math.max(g,v);for(x=0;x<=m;++x){u[x]=[];var y=0;for(e(p[x].slice(0,g).trim(),u,x,y,h),y=1;y<=(p[x].length-g)/10+1;++y)e(p[x].slice(g+(y-1)*10,g+y*10).trim(),u,x,y,h)}return h.sheetRows&&(u=u.slice(0,h.sheetRows)),u}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var f={},h=!1,u=0,p=0;u<d.length;++u)(p=d.charCodeAt(u))==34?h=!h:!h&&p in r&&(f[p]=(f[p]||0)+1);p=[];for(u in f)Object.prototype.hasOwnProperty.call(f,u)&&p.push([f[u],u]);if(!p.length){f=n;for(u in f)Object.prototype.hasOwnProperty.call(f,u)&&p.push([f[u],u])}return p.sort(function(m,g){return m[0]-g[0]||n[m[1]]-n[g[1]]}),r[p.pop()[1]]||44}function a(d,f){var h=f||{},u="",p=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(u=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(u=d.charAt(4),d=d.slice(6)):u=i(d.slice(0,1024)):h&&h.FS?u=h.FS:u=i(d.slice(0,1024));var g=0,v=0,x=0,y=0,_=0,w=u.charCodeAt(0),T=!1,k=0,O=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var F=h.dateNF!=null?dE(h.dateNF):null;function M(){var V=d.slice(y,_),X={};if(V.charAt(0)=='"'&&V.charAt(V.length-1)=='"'&&(V=V.slice(1,-1).replace(/""/g,'"')),V.length===0)X.t="z";else if(h.raw)X.t="s",X.v=V;else if(V.trim().length===0)X.t="s",X.v=V;else if(V.charCodeAt(0)==61)V.charCodeAt(1)==34&&V.charCodeAt(V.length-1)==34?(X.t="s",X.v=V.slice(2,-1).replace(/""/g,'"')):HF(V)?(X.t="n",X.f=V.slice(1)):(X.t="s",X.v=V);else if(V=="TRUE")X.t="b",X.v=!0;else if(V=="FALSE")X.t="b",X.v=!1;else if(!isNaN(x=kn(V)))X.t="n",h.cellText!==!1&&(X.w=V),X.v=x;else if(!isNaN(Ts(V).getDate())||F&&V.match(F)){X.z=h.dateNF||Be[14];var q=0;F&&V.match(F)&&(V=pE(V,h.dateNF,V.match(F)||[]),q=1),h.cellDates?(X.t="d",X.v=vt(V,q)):(X.t="n",X.v=Kt(vt(V,q))),h.cellText!==!1&&(X.w=un(X.z,X.v instanceof Date?Kt(X.v):X.v)),h.cellNF||delete X.z}else X.t="s",X.v=V;if(X.t=="z"||(h.dense?(p[g]||(p[g]=[]),p[g][v]=X):p[We({c:v,r:g})]=X),y=_+1,O=d.charCodeAt(y),m.e.c<v&&(m.e.c=v),m.e.r<g&&(m.e.r=g),k==w)++v;else if(v=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;_<d.length;++_)switch(k=d.charCodeAt(_)){case 34:O===34&&(T=!T);break;case w:case 10:case 13:if(!T&&M())break e;break}return _-y>0&&M(),p["!ref"]=$e(m),p}function l(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,f):Is(t(d,f),f)}function o(d,f){var h="",u=f.type=="string"?[0,0,0,0]:Gd(d,f);switch(f.type){case"base64":h=Gr(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof qo<"u"||(h=Ye&&Buffer.isBuffer(d)?d.toString("binary"):Bi(d));break;case"array":h=ga(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return u[0]==239&&u[1]==187&&u[2]==191?h=ut(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=ut(h):f.type=="binary"&&typeof qo<"u",h.slice(0,19)=="socialcalc:version:"?Gy.to_sheet(f.type=="string"?h:ut(h),f):l(h,f)}function s(d,f){return Ui(o(d,f),f)}function c(d){for(var f=[],h=rt(d["!ref"]),u,p=Array.isArray(d),m=h.s.r;m<=h.e.r;++m){for(var g=[],v=h.s.c;v<=h.e.c;++v){var x=We({r:m,c:v});if(u=p?(d[m]||[])[v]:d[x],!u||u.v==null){g.push("          ");continue}for(var y=(u.w||(ni(u),u.w)||"").slice(0,10);y.length<10;)y+=" ";g.push(y+(v===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:s,to_sheet:o,from_sheet:c}}();function AO(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=Xy.to_workbook(e,r);return r.WTF=n,i}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return Cs.to_workbook(e,t)}}var oa=function(){function e(E,I,A){if(E){ar(E,E.l||0);for(var b=A.Enum||j;E.l<E.length;){var P=E.read_shift(2),R=b[P]||b[65535],W=E.read_shift(2),z=E.l+W,Y=R.f&&R.f(E,W,A);if(E.l=z,I(Y,R,P))return}}}function t(E,I){switch(I.type){case"base64":return r(Hr(Gr(E)),I);case"binary":return r(Hr(E),I);case"buffer":case"array":return r(E,I)}throw"Unsupported type "+I.type}function r(E,I){if(!E)return E;var A=I||{},b=A.dense?[]:{},P="Sheet1",R="",W=0,z={},Y=[],ie=[],N={s:{r:0,c:0},e:{r:0,c:0}},Q=A.sheetRows||0;if(E[2]==0&&(E[3]==8||E[3]==9)&&E.length>=16&&E[14]==5&&E[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(E[2]==2)A.Enum=j,e(E,function(Z,oe,ce){switch(ce){case 0:A.vers=Z,Z>=4096&&(A.qpro=!0);break;case 6:N=Z;break;case 204:Z&&(R=Z);break;case 222:R=Z;break;case 15:case 51:A.qpro||(Z[1].v=Z[1].v.slice(1));case 13:case 14:case 16:ce==14&&(Z[2]&112)==112&&(Z[2]&15)>1&&(Z[2]&15)<15&&(Z[1].z=A.dateNF||Be[14],A.cellDates&&(Z[1].t="d",Z[1].v=Lu(Z[1].v))),A.qpro&&Z[3]>W&&(b["!ref"]=$e(N),z[P]=b,Y.push(P),b=A.dense?[]:{},N={s:{r:0,c:0},e:{r:0,c:0}},W=Z[3],P=R||"Sheet"+(W+1),R="");var ye=A.dense?(b[Z[0].r]||[])[Z[0].c]:b[We(Z[0])];if(ye){ye.t=Z[1].t,ye.v=Z[1].v,Z[1].z!=null&&(ye.z=Z[1].z),Z[1].f!=null&&(ye.f=Z[1].f);break}A.dense?(b[Z[0].r]||(b[Z[0].r]=[]),b[Z[0].r][Z[0].c]=Z[1]):b[We(Z[0])]=Z[1];break}},A);else if(E[2]==26||E[2]==14)A.Enum=L,E[2]==14&&(A.qpro=!0,E.l=0),e(E,function(Z,oe,ce){switch(ce){case 204:P=Z;break;case 22:Z[1].v=Z[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Z[3]>W&&(b["!ref"]=$e(N),z[P]=b,Y.push(P),b=A.dense?[]:{},N={s:{r:0,c:0},e:{r:0,c:0}},W=Z[3],P="Sheet"+(W+1)),Q>0&&Z[0].r>=Q)break;A.dense?(b[Z[0].r]||(b[Z[0].r]=[]),b[Z[0].r][Z[0].c]=Z[1]):b[We(Z[0])]=Z[1],N.e.c<Z[0].c&&(N.e.c=Z[0].c),N.e.r<Z[0].r&&(N.e.r=Z[0].r);break;case 27:Z[14e3]&&(ie[Z[14e3][0]]=Z[14e3][1]);break;case 1537:ie[Z[0]]=Z[1],Z[0]==W&&(P=Z[1]);break}},A);else throw new Error("Unrecognized LOTUS BOF "+E[2]);if(b["!ref"]=$e(N),z[R||P]=b,Y.push(R||P),!ie.length)return{SheetNames:Y,Sheets:z};for(var H={},te=[],ee=0;ee<ie.length;++ee)z[Y[ee]]?(te.push(ie[ee]||Y[ee]),H[ie[ee]]=z[ie[ee]]||z[Y[ee]]):(te.push(ie[ee]),H[ie[ee]]={"!ref":"A1"});return{SheetNames:te,Sheets:H}}function n(E,I){var A=I||{};if(+A.codepage>=0&&yn(+A.codepage),A.type=="string")throw new Error("Cannot write WK1 to JS string");var b=Mr(),P=rt(E["!ref"]),R=Array.isArray(E),W=[];Ce(b,0,a(1030)),Ce(b,6,s(P));for(var z=Math.min(P.e.r,8191),Y=P.s.r;Y<=z;++Y)for(var ie=Lt(Y),N=P.s.c;N<=P.e.c;++N){Y===P.s.r&&(W[N]=Ct(N));var Q=W[N]+ie,H=R?(E[Y]||[])[N]:E[Q];if(!(!H||H.t=="z"))if(H.t=="n")(H.v|0)==H.v&&H.v>=-32768&&H.v<=32767?Ce(b,13,u(Y,N,H.v)):Ce(b,14,m(Y,N,H.v));else{var te=ni(H);Ce(b,15,f(Y,N,te.slice(0,239)))}}return Ce(b,1),b.end()}function i(E,I){var A=I||{};if(+A.codepage>=0&&yn(+A.codepage),A.type=="string")throw new Error("Cannot write WK3 to JS string");var b=Mr();Ce(b,0,l(E));for(var P=0,R=0;P<E.SheetNames.length;++P)(E.Sheets[E.SheetNames[P]]||{})["!ref"]&&Ce(b,27,C(E.SheetNames[P],R++));var W=0;for(P=0;P<E.SheetNames.length;++P){var z=E.Sheets[E.SheetNames[P]];if(!(!z||!z["!ref"])){for(var Y=rt(z["!ref"]),ie=Array.isArray(z),N=[],Q=Math.min(Y.e.r,8191),H=Y.s.r;H<=Q;++H)for(var te=Lt(H),ee=Y.s.c;ee<=Y.e.c;++ee){H===Y.s.r&&(N[ee]=Ct(ee));var Z=N[ee]+te,oe=ie?(z[H]||[])[ee]:z[Z];if(!(!oe||oe.t=="z"))if(oe.t=="n")Ce(b,23,M(H,ee,W,oe.v));else{var ce=ni(oe);Ce(b,22,k(H,ee,W,ce.slice(0,239)))}}++W}}return Ce(b,1),b.end()}function a(E){var I=ge(2);return I.write_shift(2,E),I}function l(E){var I=ge(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var A=0,b=0,P=0,R=0;R<E.SheetNames.length;++R){var W=E.SheetNames[R],z=E.Sheets[W];if(!(!z||!z["!ref"])){++P;var Y=jr(z["!ref"]);A<Y.e.r&&(A=Y.e.r),b<Y.e.c&&(b=Y.e.c)}}return A>8191&&(A=8191),I.write_shift(2,A),I.write_shift(1,P),I.write_shift(1,b),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function o(E,I,A){var b={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&A.qpro?(b.s.c=E.read_shift(1),E.l++,b.s.r=E.read_shift(2),b.e.c=E.read_shift(1),E.l++,b.e.r=E.read_shift(2),b):(b.s.c=E.read_shift(2),b.s.r=E.read_shift(2),I==12&&A.qpro&&(E.l+=2),b.e.c=E.read_shift(2),b.e.r=E.read_shift(2),I==12&&A.qpro&&(E.l+=2),b.s.c==65535&&(b.s.c=b.e.c=b.s.r=b.e.r=0),b)}function s(E){var I=ge(8);return I.write_shift(2,E.s.c),I.write_shift(2,E.s.r),I.write_shift(2,E.e.c),I.write_shift(2,E.e.r),I}function c(E,I,A){var b=[{c:0,r:0},{t:"n",v:0},0,0];return A.qpro&&A.vers!=20768?(b[0].c=E.read_shift(1),b[3]=E.read_shift(1),b[0].r=E.read_shift(2),E.l+=2):(b[2]=E.read_shift(1),b[0].c=E.read_shift(2),b[0].r=E.read_shift(2)),b}function d(E,I,A){var b=E.l+I,P=c(E,I,A);if(P[1].t="s",A.vers==20768){E.l++;var R=E.read_shift(1);return P[1].v=E.read_shift(R,"utf8"),P}return A.qpro&&E.l++,P[1].v=E.read_shift(b-E.l,"cstr"),P}function f(E,I,A){var b=ge(7+A.length);b.write_shift(1,255),b.write_shift(2,I),b.write_shift(2,E),b.write_shift(1,39);for(var P=0;P<b.length;++P){var R=A.charCodeAt(P);b.write_shift(1,R>=128?95:R)}return b.write_shift(1,0),b}function h(E,I,A){var b=c(E,I,A);return b[1].v=E.read_shift(2,"i"),b}function u(E,I,A){var b=ge(7);return b.write_shift(1,255),b.write_shift(2,I),b.write_shift(2,E),b.write_shift(2,A,"i"),b}function p(E,I,A){var b=c(E,I,A);return b[1].v=E.read_shift(8,"f"),b}function m(E,I,A){var b=ge(13);return b.write_shift(1,255),b.write_shift(2,I),b.write_shift(2,E),b.write_shift(8,A,"f"),b}function g(E,I,A){var b=E.l+I,P=c(E,I,A);if(P[1].v=E.read_shift(8,"f"),A.qpro)E.l=b;else{var R=E.read_shift(2);_(E.slice(E.l,E.l+R),P),E.l+=R}return P}function v(E,I,A){var b=I&32768;return I&=-32769,I=(b?E:0)+(I>=8192?I-16384:I),(b?"":"$")+(A?Ct(I):Lt(I))}var x={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(E,I){ar(E,0);for(var A=[],b=0,P="",R="",W="",z="";E.l<E.length;){var Y=E[E.l++];switch(Y){case 0:A.push(E.read_shift(8,"f"));break;case 1:R=v(I[0].c,E.read_shift(2),!0),P=v(I[0].r,E.read_shift(2),!1),A.push(R+P);break;case 2:{var ie=v(I[0].c,E.read_shift(2),!0),N=v(I[0].r,E.read_shift(2),!1);R=v(I[0].c,E.read_shift(2),!0),P=v(I[0].r,E.read_shift(2),!1),A.push(ie+N+":"+R+P)}break;case 3:if(E.l<E.length){console.error("WK1 premature formula end");return}break;case 4:A.push("("+A.pop()+")");break;case 5:A.push(E.read_shift(2));break;case 6:{for(var Q="";Y=E[E.l++];)Q+=String.fromCharCode(Y);A.push('"'+Q.replace(/"/g,'""')+'"')}break;case 8:A.push("-"+A.pop());break;case 23:A.push("+"+A.pop());break;case 22:A.push("NOT("+A.pop()+")");break;case 20:case 21:z=A.pop(),W=A.pop(),A.push(["AND","OR"][Y-20]+"("+W+","+z+")");break;default:if(Y<32&&y[Y])z=A.pop(),W=A.pop(),A.push(W+y[Y]+z);else if(x[Y]){if(b=x[Y][1],b==69&&(b=E[E.l++]),b>A.length){console.error("WK1 bad formula parse 0x"+Y.toString(16)+":|"+A.join("|")+"|");return}var H=A.slice(-b);A.length-=b,A.push(x[Y][0]+"("+H.join(",")+")")}else return Y<=7?console.error("WK1 invalid opcode "+Y.toString(16)):Y<=24?console.error("WK1 unsupported op "+Y.toString(16)):Y<=30?console.error("WK1 invalid opcode "+Y.toString(16)):Y<=115?console.error("WK1 unsupported function opcode "+Y.toString(16)):console.error("WK1 unrecognized opcode "+Y.toString(16))}}A.length==1?I[1].f=""+A[0]:console.error("WK1 bad formula parse |"+A.join("|")+"|")}function w(E){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=E.read_shift(2),I[3]=E[E.l++],I[0].c=E[E.l++],I}function T(E,I){var A=w(E);return A[1].t="s",A[1].v=E.read_shift(I-4,"cstr"),A}function k(E,I,A,b){var P=ge(6+b.length);P.write_shift(2,E),P.write_shift(1,A),P.write_shift(1,I),P.write_shift(1,39);for(var R=0;R<b.length;++R){var W=b.charCodeAt(R);P.write_shift(1,W>=128?95:W)}return P.write_shift(1,0),P}function O(E,I){var A=w(E);A[1].v=E.read_shift(2);var b=A[1].v>>1;if(A[1].v&1)switch(b&7){case 0:b=(b>>3)*5e3;break;case 1:b=(b>>3)*500;break;case 2:b=(b>>3)/20;break;case 3:b=(b>>3)/200;break;case 4:b=(b>>3)/2e3;break;case 5:b=(b>>3)/2e4;break;case 6:b=(b>>3)/16;break;case 7:b=(b>>3)/64;break}return A[1].v=b,A}function F(E,I){var A=w(E),b=E.read_shift(4),P=E.read_shift(4),R=E.read_shift(2);if(R==65535)return b===0&&P===3221225472?(A[1].t="e",A[1].v=15):b===0&&P===3489660928?(A[1].t="e",A[1].v=42):A[1].v=0,A;var W=R&32768;return R=(R&32767)-16446,A[1].v=(1-W*2)*(P*Math.pow(2,R+32)+b*Math.pow(2,R)),A}function M(E,I,A,b){var P=ge(14);if(P.write_shift(2,E),P.write_shift(1,A),P.write_shift(1,I),b==0)return P.write_shift(4,0),P.write_shift(4,0),P.write_shift(2,65535),P;var R=0,W=0,z=0,Y=0;return b<0&&(R=1,b=-b),W=Math.log2(b)|0,b/=Math.pow(2,W-31),Y=b>>>0,Y&2147483648||(b/=2,++W,Y=b>>>0),b-=Y,Y|=2147483648,Y>>>=0,b*=Math.pow(2,32),z=b>>>0,P.write_shift(4,z),P.write_shift(4,Y),W+=16383+(R?32768:0),P.write_shift(2,W),P}function V(E,I){var A=F(E);return E.l+=I-14,A}function X(E,I){var A=w(E),b=E.read_shift(4);return A[1].v=b>>6,A}function q(E,I){var A=w(E),b=E.read_shift(8,"f");return A[1].v=b,A}function ae(E,I){var A=q(E);return E.l+=I-10,A}function ne(E,I){return E[E.l+I-1]==0?E.read_shift(I,"cstr"):""}function re(E,I){var A=E[E.l++];A>I-1&&(A=I-1);for(var b="";b.length<A;)b+=String.fromCharCode(E[E.l++]);return b}function le(E,I,A){if(!(!A.qpro||I<21)){var b=E.read_shift(1);E.l+=17,E.l+=1,E.l+=2;var P=E.read_shift(I-21,"cstr");return[b,P]}}function se(E,I){for(var A={},b=E.l+I;E.l<b;){var P=E.read_shift(2);if(P==14e3){for(A[P]=[0,""],A[P][0]=E.read_shift(2);E[E.l];)A[P][1]+=String.fromCharCode(E[E.l]),E.l++;E.l++}}return A}function C(E,I){var A=ge(5+E.length);A.write_shift(2,14e3),A.write_shift(2,I);for(var b=0;b<E.length;++b){var P=E.charCodeAt(b);A[A.l++]=P>127?95:P}return A[A.l++]=0,A}var j={0:{n:"BOF",f:Ht},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ne},222:{n:"SHEETNAMELP",f:re},65535:{n:""}},L={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:T},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:O},25:{n:"FORMULA19",f:V},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:X},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:ae},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ne},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function OO(e){var t={},r=e.match(wr),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=He(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=ud[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return t}var FO=function(){var e=Zo("t"),t=Zo("rPr");function r(a){var l=a.match(e);if(!l)return{t:"s",v:""};var o={t:"s",v:tt(l[1])},s=a.match(t);return s&&(o.s=OO(s[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),PO=function(){var t=/(\r\n|\n)/g;function r(i,a,l){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),i.b&&(a.push("<b>"),l.push("</b>")),i.i&&(a.push("<i>"),l.push("</i>")),i.strike&&(a.push("<s>"),l.push("</s>"));var s=i.valign||"";return s=="superscript"||s=="super"?s="sup":s=="subscript"&&(s="sub"),s!=""&&(a.push("<"+s+">"),l.push("</"+s+">")),l.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&r(i.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),NO=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,DO=/<(?:\w+:)?r>/,RO=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Rd(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=tt(ut(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ut(e),r&&(n.h=_d(n.t))):e.match(DO)&&(n.r=ut(e),n.t=tt(ut((e.replace(RO,"").match(NO)||[]).join("").replace(wr,""))),r&&(n.h=PO(FO(n.r)))),n):{t:""}}var IO=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,MO=/<(?:\w+:)?(?:si|sstItem)>/g,jO=/<\/(?:\w+:)?(?:si|sstItem)>/;function LO(e,t){var r=[],n="";if(!e)return r;var i=e.match(IO);if(i){n=i[2].replace(MO,"").split(jO);for(var a=0;a!=n.length;++a){var l=Rd(n[a].trim(),t);l!=null&&(r[r.length]=l)}i=He(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var BO=/^\s|\s$|[\t\n\r]/;function Yy(e,t){if(!t.bookSST)return"";var r=[Bt];r[r.length]=Te("sst",null,{xmlns:ka[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),i.t.match(BO)&&(a+=' xml:space="preserve"'),a+=">"+lt(i.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function UO(e){return[e.read_shift(4),e.read_shift(4)]}function WO(e,t){var r=[],n=!1;return oi(e,function(a,l,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function HO(e,t){return t||(t=ge(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var zO=ZE;function VO(e){var t=Mr();xe(t,159,HO(e));for(var r=0;r<e.length;++r)xe(t,19,zO(e[r]));return xe(t,160),t.end()}function Ky(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Jn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function XO(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Jn(e,4),t.U=Jn(e,4),t.W=Jn(e,4),t}function $O(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),a=[];i-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function GO(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push($O(e));return t}function YO(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function KO(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Jn(e,4),t.U=Jn(e,4),t.W=Jn(e,4),t}function qO(e){var t=KO(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function qy(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Jy(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function JO(e){var t=Jn(e);switch(t.Minor){case 2:return[t.Minor,QO(e)];case 3:return[t.Minor,ZO()];case 4:return[t.Minor,e3(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function QO(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=qy(e,r),i=Jy(e,e.length-e.l);return{t:"Std",h:n,v:i}}function ZO(){throw new Error("File is password-protected: ECMA-376 Extensible")}function e3(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(wr,function(a){var l=He(a);switch(Bn(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=l[o]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function t3(e,t){var r={},n=r.EncryptionVersionInfo=Jn(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=qy(e,i),t-=i,r.EncryptionVerifier=Jy(e,t),r}function r3(e){var t={},r=t.EncryptionVersionInfo=Jn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Id(e){var t=0,r,n=Ky(e),i=n.length+1,a,l,o,s,c;for(r=Ni(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)l=r[a],o=t&16384?1:0,s=t<<1&32767,c=o|s,t=c^l;return t^52811}var Qy=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},i=function(l,o){return n(l^o)},a=function(l){for(var o=t[l.length-1],s=104,c=l.length-1;c>=0;--c)for(var d=l[c],f=0;f!=7;++f)d&64&&(o^=r[s]),d*=2,--s;return o};return function(l){for(var o=Ky(l),s=a(o),c=o.length,d=Ni(16),f=0;f!=16;++f)d[f]=0;var h,u,p;for((c&1)===1&&(h=s>>8,d[c]=i(e[0],h),--c,h=s&255,u=o[o.length-1],d[c]=i(u,h));c>0;)--c,h=s>>8,d[c]=i(o[c],h),--c,h=s&255,d[c]=i(o[c],h);for(c=15,p=15-o.length;p>0;)h=s>>8,d[c]=i(e[p],h),--c,--p,h=s&255,d[c]=i(o[c],h),--c,--p;return d}}(),n3=function(e,t,r,n,i){i||(i=t),n||(n=Qy(e));var a,l;for(a=0;a!=t.length;++a)l=t[a],l^=n[r],l=(l>>5|l<<3)&255,i[a]=l,++r;return[i,r,n]},i3=function(e){var t=0,r=Qy(e);return function(n){var i=n3("",n,t,r);return t=i[1],i[0]}};function a3(e,t,r,n){var i={key:Ht(e),verificationBytes:Ht(e)};return r.password&&(i.verifier=Id(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=i3(r.password)),i}function s3(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=r3(e):n.Data=t3(e,t),n}function o3(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?s3(e,t-2,n):a3(e,r.biff>=8?t:t-2,r,n),n}var Zy=function(){function e(i,a){switch(a.type){case"base64":return t(Gr(i),a);case"binary":return t(i,a);case"buffer":return t(Ye&&Buffer.isBuffer(i)?i.toString("binary"):Bi(i),a);case"array":return t(ga(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var l=a||{},o=l.dense?[]:{},s=i.match(/\\trowd.*?\\row\b/g);if(!s.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:s.length-1}};return s.forEach(function(d,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,u=0,p,m=-1;p=h.exec(d);){switch(p[0]){case"\\cell":var g=d.slice(u,h.lastIndex-p[0].length);if(g[0]==" "&&(g=g.slice(1)),++m,g.length){var v={v:g,t:"s"};Array.isArray(o)?o[f][m]=v:o[We({r:f,c:m})]=v}break}u=h.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=$e(c),o}function r(i,a){return Ui(e(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],l=rt(i["!ref"]),o,s=Array.isArray(i),c=l.s.r;c<=l.e.r;++c){a.push("\\trowd\\trautofit1");for(var d=l.s.c;d<=l.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=l.s.c;d<=l.e.c;++d){var f=We({r:c,c:d});o=s?(i[c]||[])[d]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(ni(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function l3(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function nl(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function c3(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),a=Math.min(t,r,n),l=i-a;if(l===0)return[0,0,t];var o=0,s=0,c=i+a;switch(s=l/(c>1?2-c:c),i){case t:o=((r-n)/l+6)%6;break;case r:o=(n-t)/l+2;break;case n:o=(t-r)/l+4;break}return[o/6,s,c/2]}function u3(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),a=n-i/2,l=[a,a,a],o=6*t,s;if(r!==0)switch(o|0){case 0:case 6:s=i*o,l[0]+=i,l[1]+=s;break;case 1:s=i*(2-o),l[0]+=s,l[1]+=i;break;case 2:s=i*(o-2),l[1]+=i,l[2]+=s;break;case 3:s=i*(4-o),l[1]+=s,l[2]+=i;break;case 4:s=i*(o-4),l[2]+=i,l[0]+=s;break;case 5:s=i*(6-o),l[2]+=s,l[0]+=i;break}for(var c=0;c!=3;++c)l[c]=Math.round(l[c]*255);return l}function ou(e,t){if(t===0)return e;var r=c3(l3(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),nl(u3(r))}var e_=6,f3=15,h3=1,mr=e_;function il(e){return Math.floor((e+Math.round(128/mr)/256)*mr)}function al(e){return Math.floor((e-5)/mr*100+.5)/100}function lu(e){return Math.round((e*mr+5)/mr*256)/256}function Df(e){return lu(al(il(e)))}function Md(e){var t=Math.abs(e-Df(e)),r=mr;if(t>.005)for(mr=h3;mr<f3;++mr)Math.abs(e-Df(e))<=t&&(t=Math.abs(e-Df(e)),r=mr);mr=r}function Di(e){e.width?(e.wpx=il(e.width),e.wch=al(e.wpx),e.MDW=mr):e.wpx?(e.wch=al(e.wpx),e.width=lu(e.wch),e.MDW=mr):typeof e.wch=="number"&&(e.width=lu(e.wch),e.wpx=il(e.width),e.MDW=mr),e.customWidth&&delete e.customWidth}var d3=96,t_=d3;function sl(e){return e*96/t_}function Es(e){return e*t_/96}var p3={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function g3(e,t,r,n){t.Borders=[];var i={},a=!1;(e[0].match(wr)||[]).forEach(function(l){var o=He(l);switch(Bn(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=gt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=gt(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function m3(e,t,r,n){t.Fills=[];var i={},a=!1;(e[0].match(wr)||[]).forEach(function(l){var o=He(l);switch(Bn(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function v3(e,t,r,n){t.Fonts=[];var i={},a=!1;(e[0].match(wr)||[]).forEach(function(l){var o=He(l);switch(Bn(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=ut(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?gt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?gt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?gt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?gt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?gt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?gt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?gt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=ud[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=gt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var s=aa[i.color.index];i.color.index==81&&(s=aa[1]),s||(s=aa[1]),i.color.rgb=s[0].toString(16)+s[1].toString(16)+s[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=ou(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function x3(e,t,r){t.NumberFmt=[];for(var n=Rt(Be),i=0;i<n.length;++i)t.NumberFmt[n[i]]=Be[n[i]];var a=e[0].match(wr);if(a)for(i=0;i<a.length;++i){var l=He(a[i]);switch(Bn(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=tt(ut(l.formatCode)),s=parseInt(l.numFmtId,10);if(t.NumberFmt[s]=o,s>0){if(s>392){for(s=392;s>60&&t.NumberFmt[s]!=null;--s);t.NumberFmt[s]=o}qn(o,s)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function y3(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Te("numFmt",null,{numFmtId:n,formatCode:lt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Te("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var nc=["numFmtId","fillId","fontId","borderId","xfId"],ic=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function _3(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(wr)||[]).forEach(function(a){var l=He(a),o=0;switch(Bn(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],o=0;o<nc.length;++o)n[nc[o]]&&(n[nc[o]]=parseInt(n[nc[o]],10));for(o=0;o<ic.length;++o)n[ic[o]]&&(n[ic[o]]=gt(n[ic[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var s={};l.vertical&&(s.vertical=l.vertical),l.horizontal&&(s.horizontal=l.horizontal),l.textRotation!=null&&(s.textRotation=l.textRotation),l.indent&&(s.indent=l.indent),l.wrapText&&(s.wrapText=gt(l.wrapText)),n.alignment=s;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function w3(e){var t=[];return t[t.length]=Te("cellXfs",null),e.forEach(function(r){t[t.length]=Te("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Te("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var S3=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,s,c){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&x3(f,d,c),(f=o.match(i))&&v3(f,d,s,c),(f=o.match(n))&&m3(f,d,s,c),(f=o.match(a))&&g3(f,d,s,c),(f=o.match(r))&&_3(f,d,c),d}}();function r_(e,t){var r=[Bt,Te("styleSheet",null,{xmlns:ka[0],"xmlns:vt":Gt.vt})],n;return e.SSF&&(n=y3(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=w3(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function k3(e,t){var r=e.read_shift(2),n=xr(e);return[r,n]}function b3(e,t,r){r||(r=ge(6+4*t.length)),r.write_shift(2,e),Zt(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function T3(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=s4(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var o=e.read_shift(1);o>0&&(n.family=o);var s=e.read_shift(1);switch(s>0&&(n.charset=s),e.l++,n.color=a4(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=xr(e),n}function C3(e,t){t||(t=ge(25+4*32)),t.write_shift(2,e.sz*20),o4(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),iu(e.color,t);var n=0;return n=2,t.write_shift(1,n),Zt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var E3=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Rf,A3=_r;function Fm(e,t){t||(t=ge(4*3+8*7+16*1)),Rf||(Rf=Mu(E3));var r=Rf[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(iu({auto:1},t),iu({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function O3(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function n_(e,t,r){r||(r=ge(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ks(e,t){return t||(t=ge(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var F3=_r;function P3(e,t){return t||(t=ge(51)),t.write_shift(1,0),Ks(null,t),Ks(null,t),Ks(null,t),Ks(null,t),Ks(null,t),t.length>t.l?t.slice(0,t.l):t}function N3(e,t){return t||(t=ge(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),nu(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function D3(e,t,r){var n=ge(2052);return n.write_shift(4,e),nu(t,n),nu(r,n),n.length>n.l?n.slice(0,n.l):n}function R3(e,t,r){var n={};n.NumberFmt=[];for(var i in Be)n.NumberFmt[i]=Be[i];n.CellXf=[],n.Fonts=[];var a=[],l=!1;return oi(e,function(s,c,d){switch(d){case 44:n.NumberFmt[s[0]]=s[1],qn(s[1],s[0]);break;case 43:n.Fonts.push(s),s.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(s.color.rgb=ou(t.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(s);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:a.push(d),l=!0;break;case 38:a.pop(),l=!1;break;default:if(c.T>0)a.push(d);else if(c.T<0)a.pop();else if(!l||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function I3(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(xe(e,615,bn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&xe(e,44,b3(i,t[i]))}),xe(e,616))}}function M3(e){var t=1;xe(e,611,bn(t)),xe(e,43,C3({sz:12,color:{theme:1},name:"Calibri",family:2})),xe(e,612)}function j3(e){var t=2;xe(e,603,bn(t)),xe(e,45,Fm({patternType:"none"})),xe(e,45,Fm({patternType:"gray125"})),xe(e,604)}function L3(e){var t=1;xe(e,613,bn(t)),xe(e,46,P3()),xe(e,614)}function B3(e){var t=1;xe(e,626,bn(t)),xe(e,47,n_({numFmtId:0},65535)),xe(e,627)}function U3(e,t){xe(e,617,bn(t.length)),t.forEach(function(r){xe(e,47,n_(r,0))}),xe(e,618)}function W3(e){var t=1;xe(e,619,bn(t)),xe(e,48,N3({xfId:0,name:"Normal"})),xe(e,620)}function H3(e){var t=0;xe(e,505,bn(t)),xe(e,506)}function z3(e){var t=0;xe(e,508,D3(t,"TableStyleMedium9","PivotStyleMedium4")),xe(e,509)}function V3(e,t){var r=Mr();return xe(r,278),I3(r,e.SSF),M3(r),j3(r),L3(r),B3(r),U3(r,t.cellXfs),W3(r),H3(r),z3(r),xe(r,279),r.end()}var X3=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function $3(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(wr)||[]).forEach(function(i){var a=He(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[X3.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function G3(){}function Y3(){}var K3=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,q3=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,J3=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Q3(e,t,r){t.themeElements={};var n;[["clrScheme",K3,$3],["fontScheme",q3,G3],["fmtScheme",J3,Y3]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var Z3=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function i_(e,t){(!e||e.length===0)&&(e=jd());var r,n={};if(!(r=e.match(Z3)))throw new Error("themeElements not found in theme");return Q3(r[0],n,t),n.raw=e,n}function jd(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Bt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function eF(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var l;try{l=q1(a,{type:"array"})}catch{return}var o=zr(l,"theme/theme/theme1.xml",!0);if(o)return i_(o,r)}}function tF(e){return e.read_shift(4)}function rF(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=nF(e,4);break;case 2:t.xclrValue=jy(e);break;case 3:t.xclrValue=tF(e);break;case 4:e.l+=4;break}return e.l+=8,t}function nF(e,t){return _r(e,t)}function iF(e,t){return _r(e,t)}function aF(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=rF(e);break;case 6:n[1]=iF(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function sF(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),a=[];i-- >0;)a.push(aF(e,r-e.l));return{ixfe:n,ext:a}}function oF(e,t){t.forEach(function(r){switch(r[0]){}})}function lF(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:xr(e)}}function cF(e){var t=ge(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Zt(e.name,t),t.slice(0,t.l)}function uF(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function fF(e){var t=ge(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function hF(e,t){var r=ge(8+2*t.length);return r.write_shift(4,e),Zt(t,r),r.slice(0,r.l)}function dF(e){return e.l+=4,e.read_shift(4)!=0}function pF(e,t){var r=ge(8);return r.write_shift(4,e),r.write_shift(4,1),r}function gF(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],l=!1,o=2;return oi(e,function(s,c,d){switch(d){case 335:n.Types.push({name:s.name});break;case 51:s.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=s?1:0;break;case 338:o=2;break;case 35:a.push(d),l=!0;break;case 36:a.pop(),l=!1;break;default:if(!c.T){if(!l||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function mF(){var e=Mr();return xe(e,332),xe(e,334,bn(1)),xe(e,335,cF({name:"XLDAPR",version:12e4,flags:3496657072})),xe(e,336),xe(e,339,hF(1,"XLDAPR")),xe(e,52),xe(e,35,bn(514)),xe(e,4096,bn(0)),xe(e,4097,tn(1)),xe(e,36),xe(e,53),xe(e,340),xe(e,337,pF(1)),xe(e,51,fF([[1,0]])),xe(e,338),xe(e,333),e.end()}function vF(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,a=2,l;return e.replace(wr,function(o){var s=He(o);switch(Bn(s[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:s.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==s.name&&(l=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[s.t-1].name,index:+s.v}):a==0&&n.Value.push({type:n.Types[s.t-1].name,index:+s.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+s.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+s[0]+" in metadata")}return o}),n}function a_(){var e=[Bt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function xF(e){var t=[];if(!e)return t;var r=1;return(e.match(wr)||[]).forEach(function(n){var i=He(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function yF(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=We(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function _F(e,t,r){var n=[];return oi(e,function(a,l,o){switch(o){case 63:n.push(a);break;default:if(!l.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function wF(e,t,r,n){if(!e)return e;var i=n||{},a=!1;oi(e,function(o,s,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!s.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function SF(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var is=1024;function s_(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Te("xml",null,{"xmlns:v":Ur.v,"xmlns:o":Ur.o,"xmlns:x":Ur.x,"xmlns:mv":Ur.mv}).replace(/\/>/,">"),Te("o:shapelayout",Te("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Te("v:shapetype",[Te("v:stroke",null,{joinstyle:"miter"}),Te("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];is<e*1e3;)is+=1e3;return t.forEach(function(a){var l=Et(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var s=o.type=="gradient"?Te("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Te("v:fill",s,o),d={on:"t",obscured:"t"};++is,i=i.concat(["<v:shape"+el({id:"_x0000_s"+is,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Te("v:shadow",null,d),Te("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",sr("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),sr("x:AutoFill","False"),sr("x:Row",String(l.r)),sr("x:Column",String(l.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Pm(e,t,r,n){var i=Array.isArray(e),a;t.forEach(function(l){var o=Et(l.ref);if(i?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[l.ref],!a){a={t:"z"},i?e[o.r][o.c]=a:e[l.ref]=a;var s=rt(e["!ref"]||"BDWGO1000001:A1");s.s.r>o.r&&(s.s.r=o.r),s.e.r<o.r&&(s.e.r=o.r),s.s.c>o.c&&(s.s.c=o.c),s.e.c<o.c&&(s.e.c=o.c);var c=$e(s);c!==e["!ref"]&&(e["!ref"]=c)}a.c||(a.c=[]);var d={a:l.author,t:l.t,r:l.r,T:r};l.h&&(d.h=l.h);for(var f=a.c.length-1;f>=0;--f){if(!r&&a.c[f].T)return;r&&!a.c[f].T&&a.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}a.c.push(d)})}function kF(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?comment[^>]*>/);if(o){var s=He(o[0]),c={author:s.authorId&&r[s.authorId]||"sheetjsghost",ref:s.ref,guid:s.guid},d=Et(s.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&Rd(f[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function o_(e){var t=[Bt,Te("comments",null,{xmlns:ka[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var a=lt(i.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(s){s.a&&(i=r.indexOf(lt(s.a))),a.push(s.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),a.length<=1)t.push(sr("t",lt(a[0]||"")));else{for(var l=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)l+=`Reply:
    `+a[o]+`
`;t.push(sr("t",lt(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function bF(e,t){var r=[],n=!1,i={},a=0;return e.replace(wr,function(o,s){var c=He(o);switch(Bn(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":a=s+o.length;break;case"</text>":i.t=e.slice(a,s).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function TF(e,t,r){var n=[Bt,Te("ThreadedComments",null,{xmlns:Gt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var a="";(i[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var s={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=s.id:s.parentId=a,l.ID=s.id,l.a&&(s.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),n.push(Te("threadedComment",sr("text",l.t||""),s))})}),n.push("</ThreadedComments>"),n.join("")}function CF(e,t){var r=[],n=!1;return e.replace(wr,function(a){var l=He(a);switch(Bn(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return a}),r}function EF(e){var t=[Bt,Te("personList",null,{xmlns:Gt.TCMNT,"xmlns:x":ka[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Te("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function AF(e){var t={};t.iauthor=e.read_shift(4);var r=Ea(e);return t.rfx=r.s,t.ref=We(r.s),e.l+=16,t}function OF(e,t){return t==null&&(t=ge(36)),t.write_shift(4,e[1].iauthor),Ms(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var FF=xr;function PF(e){return Zt(e.slice(0,54))}function NF(e,t){var r=[],n=[],i={},a=!1;return oi(e,function(o,s,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!s.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function DF(e){var t=Mr(),r=[];return xe(t,628),xe(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),xe(t,632,PF(i.a)))})}),xe(t,631),xe(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var a={s:Et(n[0]),e:Et(n[0])};xe(t,635,OF([a,i])),i.t&&i.t.length>0&&xe(t,637,t4(i)),xe(t,636),delete i.iauthor})}),xe(t,634),xe(t,629),t.end()}var RF="application/vnd.ms-office.vbaProject";function IF(e){var t=Ie.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ie.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Ie.write(t)}function MF(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Ie.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var l_=["xlsb","xlsm","xlam","biff8","xla"];function jF(){return{"!type":"dialog"}}function LF(){return{"!type":"dialog"}}function BF(){return{"!type":"macro"}}function UF(){return{"!type":"macro"}}var gs=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,a,l){var o=!1,s=!1;a.length==0?s=!0:a.charAt(0)=="["&&(s=!0,a=a.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,d=l.length>0?parseInt(l,10)|0:0;return o?d+=t.c:--d,s?c+=t.r:--c,i+(o?"":"$")+Ct(d)+(s?"":"$")+Lt(c)}return function(i,a){return t=a,i.replace(e,r)}}(),Ld=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Bd=function(){return function(t,r){return t.replace(Ld,function(n,i,a,l,o,s){var c=Td(l)-(a?0:r.c),d=bd(s)-(o?0:r.r),f=d==0?"":o?d+1:"["+d+"]",h=c==0?"":a?c+1:"["+c+"]";return i+"R"+f+"C"+h})}}();function c_(e,t){return e.replace(Ld,function(r,n,i,a,l,o){return n+(i=="$"?i+a:Ct(Td(a)+t.c))+(l=="$"?l+o:Lt(bd(o)+t.r))})}function WF(e,t,r){var n=jr(t),i=n.s,a=Et(r),l={r:a.r-i.r,c:a.c-i.c};return c_(e,l)}function HF(e){return e.length!=1}function Nm(e){return e.replace(/_xlfn\./g,"")}function Ut(e){e.l+=1}function Ri(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function u_(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return f_(e);r.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),l=Ri(e),o=Ri(e);return{s:{r:i,c:l[0],cRel:l[1],rRel:l[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function f_(e){var t=Ri(e),r=Ri(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function zF(e,t,r){if(r.biff<8)return f_(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=Ri(e),l=Ri(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function h_(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return VF(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Ri(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function VF(e){var t=Ri(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function XF(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function $F(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return GF(e);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),l=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;i>524287;)i-=1048576;if(l==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:l,rRel:o}}function GF(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function YF(e,t,r){var n=(e[e.l++]&96)>>5,i=u_(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function KF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var l=u_(e,a,r);return[n,i,l]}function qF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function JF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function QF(e,t,r){var n=(e[e.l++]&96)>>5,i=zF(e,t-1,r);return[n,i]}function ZF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Dm(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function eP(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function tP(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function rP(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function nP(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function iP(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function d_(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function aP(e){return e.read_shift(2),d_(e)}function sP(e){return e.read_shift(2),d_(e)}function oP(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=h_(e,0,r);return[n,i]}function lP(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=$F(e,0,r);return[n,i]}function cP(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=h_(e,0,r);return[n,i,a]}function uP(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[dN[i],m_[i],n]}function fP(e,t,r){var n=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:hP(e);return[i,(a[0]===0?m_:hN)[a[1]]]}function hP(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function dP(e,t,r){e.l+=r&&r.biff==2?3:4}function pP(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function gP(e){return e.l++,li[e.read_shift(1)]}function mP(e){return e.l++,e.read_shift(2)}function vP(e){return e.l++,e.read_shift(1)!==0}function xP(e){return e.l++,vr(e)}function yP(e,t,r){return e.l++,xl(e,t-1,r)}function _P(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Mt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=li[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=vr(e);break;case 2:r[1]=Aa(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function wP(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?Ea:Bu)(e));return i}function SP(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,l=[];a!=n&&(l[a]=[]);++a)for(var o=0;o!=i;++o)l[a][o]=_P(e,r.biff);return l}function kP(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function bP(e,t,r){if(r.biff==5)return TP(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function TP(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function CP(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function EP(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function AP(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function OP(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var FP=_r,PP=_r,NP=_r;function _l(e,t,r){return e.l+=2,[XF(e)]}function Ud(e){return e.l+=6,[]}var DP=_l,RP=Ud,IP=Ud,MP=_l;function p_(e){return e.l+=2,[Ht(e),e.read_shift(2)&1]}var jP=_l,LP=p_,BP=Ud,UP=_l,WP=_l,HP=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function zP(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),l=HP[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:n,c:i,C:a}}function VP(e){return e.l+=2,[e.read_shift(4)]}function XP(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function $P(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function GP(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function YP(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function KP(e){return e.l+=4,[0,0]}var Rm={1:{n:"PtgExp",f:pP},2:{n:"PtgTbl",f:NP},3:{n:"PtgAdd",f:Ut},4:{n:"PtgSub",f:Ut},5:{n:"PtgMul",f:Ut},6:{n:"PtgDiv",f:Ut},7:{n:"PtgPower",f:Ut},8:{n:"PtgConcat",f:Ut},9:{n:"PtgLt",f:Ut},10:{n:"PtgLe",f:Ut},11:{n:"PtgEq",f:Ut},12:{n:"PtgGe",f:Ut},13:{n:"PtgGt",f:Ut},14:{n:"PtgNe",f:Ut},15:{n:"PtgIsect",f:Ut},16:{n:"PtgUnion",f:Ut},17:{n:"PtgRange",f:Ut},18:{n:"PtgUplus",f:Ut},19:{n:"PtgUminus",f:Ut},20:{n:"PtgPercent",f:Ut},21:{n:"PtgParen",f:Ut},22:{n:"PtgMissArg",f:Ut},23:{n:"PtgStr",f:yP},26:{n:"PtgSheet",f:XP},27:{n:"PtgEndSheet",f:$P},28:{n:"PtgErr",f:gP},29:{n:"PtgBool",f:vP},30:{n:"PtgInt",f:mP},31:{n:"PtgNum",f:xP},32:{n:"PtgArray",f:ZF},33:{n:"PtgFunc",f:uP},34:{n:"PtgFuncVar",f:fP},35:{n:"PtgName",f:kP},36:{n:"PtgRef",f:oP},37:{n:"PtgArea",f:YF},38:{n:"PtgMemArea",f:CP},39:{n:"PtgMemErr",f:FP},40:{n:"PtgMemNoMem",f:PP},41:{n:"PtgMemFunc",f:EP},42:{n:"PtgRefErr",f:AP},43:{n:"PtgAreaErr",f:qF},44:{n:"PtgRefN",f:lP},45:{n:"PtgAreaN",f:QF},46:{n:"PtgMemAreaN",f:GP},47:{n:"PtgMemNoMemN",f:YP},57:{n:"PtgNameX",f:bP},58:{n:"PtgRef3d",f:cP},59:{n:"PtgArea3d",f:KF},60:{n:"PtgRefErr3d",f:OP},61:{n:"PtgAreaErr3d",f:JF},255:{}},qP={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},JP={1:{n:"PtgElfLel",f:p_},2:{n:"PtgElfRw",f:UP},3:{n:"PtgElfCol",f:DP},6:{n:"PtgElfRwV",f:WP},7:{n:"PtgElfColV",f:MP},10:{n:"PtgElfRadical",f:jP},11:{n:"PtgElfRadicalS",f:BP},13:{n:"PtgElfColS",f:RP},15:{n:"PtgElfColSV",f:IP},16:{n:"PtgElfRadicalLel",f:LP},25:{n:"PtgList",f:zP},29:{n:"PtgSxName",f:VP},255:{}},QP={0:{n:"PtgAttrNoop",f:KP},1:{n:"PtgAttrSemi",f:iP},2:{n:"PtgAttrIf",f:rP},4:{n:"PtgAttrChoose",f:eP},8:{n:"PtgAttrGoto",f:tP},16:{n:"PtgAttrSum",f:dP},32:{n:"PtgAttrBaxcel",f:Dm},33:{n:"PtgAttrBaxcel",f:Dm},64:{n:"PtgAttrSpace",f:aP},65:{n:"PtgAttrSpaceSemi",f:sP},128:{n:"PtgAttrIfError",f:nP},255:{}};function wl(e,t,r,n){if(n.biff<8)return _r(e,t);for(var i=e.l+t,a=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=SP(e,0,n),a.push(r[l][1]);break;case"PtgMemArea":r[l][2]=wP(e,r[l][1],n),a.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=e.read_shift(4),a.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=i-e.l,t!==0&&a.push(_r(e,t)),a}function Sl(e,t,r){for(var n=e.l+t,i,a,l=[];n!=e.l;)t=n-e.l,a=e[e.l],i=Rm[a]||Rm[qP[a]],(a===24||a===25)&&(i=(a===24?JP:QP)[e[e.l+1]]),!i||!i.f?_r(e,t):l.push([i.n,i.f(e,t,r)]);return l}function ZP(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],a=0;a<n.length;++a){var l=n[a];if(l)switch(l[0]){case 2:i.push('"'+l[1].replace(/"/g,'""')+'"');break;default:i.push(l[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var eN={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function tN(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function g_(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Im(e,t,r){var n=g_(e,t,r);return n=="#REF"?n:tN(n,r)}function pr(e,t,r,n,i){var a=i&&i.biff||8,l={s:{c:0,r:0}},o=[],s,c,d,f=0,h=0,u,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",v=0,x=e[0].length;v<x;++v){var y=e[0][v];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(s=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=Nt(" ",e[0][m][1][1]);break;case 1:g=Nt("\r",e[0][m][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+g,m=-1}o.push(c+eN[y[0]]+s);break;case"PtgIsect":s=o.pop(),c=o.pop(),o.push(c+" "+s);break;case"PtgUnion":s=o.pop(),c=o.pop(),o.push(c+","+s);break;case"PtgRange":s=o.pop(),c=o.pop(),o.push(c+":"+s);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=yo(y[1][1],l,i),o.push(_o(d,a));break;case"PtgRefN":d=r?yo(y[1][1],r,i):y[1][1],o.push(_o(d,a));break;case"PtgRef3d":f=y[1][1],d=yo(y[1][2],l,i),p=Im(n,f,i),o.push(p+"!"+_o(d,a));break;case"PtgFunc":case"PtgFuncVar":var _=y[1][0],w=y[1][1];_||(_=0),_&=127;var T=_==0?[]:o.slice(-_);o.length-=_,w==="User"&&(w=T.shift()),o.push(w+"("+T.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":u=um(y[1][1],r?{s:r}:l,i),o.push(Ff(u,i));break;case"PtgArea":u=um(y[1][1],l,i),o.push(Ff(u,i));break;case"PtgArea3d":f=y[1][1],u=y[1][2],p=Im(n,f,i),o.push(p+"!"+Ff(u,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=y[1][2];var k=(n.names||[])[h-1]||(n[0]||[])[h],O=k?k.Name:"SH33TJSNAME"+String(h);O&&O.slice(0,6)=="_xlfn."&&!i.xlfn&&(O=O.slice(6)),o.push(O);break;case"PtgNameX":var F=y[1][1];h=y[1][2];var M;if(i.biff<=5)F<0&&(F=-F),n[F]&&(M=n[F][h]);else{var V="";if(((n[F]||[])[0]||[])[0]==14849||(((n[F]||[])[0]||[])[0]==1025?n[F][h]&&n[F][h].itab>0&&(V=n.SheetNames[n[F][h].itab-1]+"!"):V=n.SheetNames[h-1]+"!"),n[F]&&n[F][h])V+=n[F][h].Name;else if(n[0]&&n[0][h])V+=n[0][h].Name;else{var X=(g_(n,F,i)||"").split(";;");X[h-1]?V=X[h-1]:V+="SH33TJSERRX"}o.push(V);break}M||(M={Name:"SH33TJSERRY"}),o.push(M.Name);break;case"PtgParen":var q="(",ae=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:q=Nt(" ",e[0][m][1][1])+q;break;case 3:q=Nt("\r",e[0][m][1][1])+q;break;case 4:ae=Nt(" ",e[0][m][1][1])+ae;break;case 5:ae=Nt("\r",e[0][m][1][1])+ae;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(q+o.pop()+ae);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var ne={c:r.c,r:r.r};if(n.sharedf[We(d)]){var re=n.sharedf[We(d)];o.push(pr(re,l,ne,n,i))}else{var le=!1;for(s=0;s!=n.arrayf.length;++s)if(c=n.arrayf[s],!(d.c<c[0].s.c||d.c>c[0].e.c)&&!(d.r<c[0].s.r||d.r>c[0].e.r)){o.push(pr(c[1],l,ne,n,i)),le=!0;break}le||o.push(y[1])}break;case"PtgArray":o.push("{"+ZP(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&se.indexOf(e[0][v][0])==-1){y=e[0][m];var C=!0;switch(y[1][0]){case 4:C=!1;case 0:g=Nt(" ",y[1][1]);break;case 5:C=!1;case 1:g=Nt("\r",y[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((C?g:"")+o.pop()+(C?"":g)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function rN(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,l=e.read_shift(i);if(l==65535)return[[],_r(e,t-2)];var o=Sl(e,l,r);return t!==l+i&&(a=wl(e,t-l-i,o,r)),e.l=n,[o,a]}function nN(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,l=e.read_shift(i);if(l==65535)return[[],_r(e,t-2)];var o=Sl(e,l,r);return t!==l+i&&(a=wl(e,t-l-i,o,r)),e.l=n,[o,a]}function iN(e,t,r,n){var i=e.l+t,a=Sl(e,n,r),l;return i!==e.l&&(l=wl(e,i-e.l,a,r)),[a,l]}function aN(e,t,r){var n=e.l+t,i,a=e.read_shift(2),l=Sl(e,a,r);return a==65535?[[],_r(e,t-2)]:(t!==a+2&&(i=wl(e,n-a-2,l,r)),[l,i])}function sN(e){var t;if(Gn(e,e.l+6)!==65535)return[vr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function oN(e){if(e==null){var t=ge(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ma(e);return ma(0)}function If(e,t,r){var n=e.l+t,i=Un(e);r.biff==2&&++e.l;var a=sN(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=nN(e,n-e.l,r);return{cell:i,val:a[0],formula:o,shared:l>>3&1,tt:a[1]}}function lN(e,t,r,n,i){var a=xa(t,r,i),l=oN(e.v),o=ge(6),s=33;o.write_shift(2,s),o.write_shift(4,0);for(var c=ge(e.bf.length),d=0;d<e.bf.length;++d)c[d]=e.bf[d];var f=Qt([a,l,o,c]);return f}function Uu(e,t,r){var n=e.read_shift(4),i=Sl(e,n,r),a=e.read_shift(4),l=a>0?wl(e,a,i,r):null;return[i,l]}var cN=Uu,Wu=Uu,uN=Uu,fN=Uu,hN={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},m_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},dN={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Mm(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function pN(e){var t="of:="+e.replace(Ld,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Mf(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function gN(e){return e.replace(/\./,"!")}var So={},ms={},ko=typeof Map<"u";function Wd(e,t,r){var n=0,i=e.length;if(r){if(ko?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=ko?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(ko?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function Hu(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(mr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=al(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=lu(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function la(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Wi(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,a=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){qn(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=a;++i)if(e[i].numFmtId===n)return i;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function v_(e,t,r,n,i,a){try{n.cellNF&&(e.z=Be[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=vt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Be[t]==null&&qn(hE[t]||"General",t),e.t==="e")e.w=e.w||li[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Qo(e.v);else if(e.t==="d"){var l=Kt(e.v);(l|0)===l?e.w=l.toString(10):e.w=Qo(l)}else{if(e.v===void 0)return"";e.w=pa(e.v,ms)}else e.t==="d"?e.w=un(t,Kt(e.v),ms):e.w=un(t,e.v,ms)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=ou(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=ou(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function mN(e,t,r){if(e&&e["!ref"]){var n=rt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function vN(e,t){var r=rt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=$e(r))}var xN=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,yN=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,_N=/<(?:\w:)?hyperlink [^>]*>/mg,wN=/"(\w*:\w*)"/,SN=/<(?:\w:)?col\b[^>]*[\/]?>/g,kN=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,bN=/<(?:\w:)?pageMargins[^>]*\/>/g,x_=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,TN=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,CN=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function EN(e,t,r,n,i,a,l){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},s={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",f=e.match(yN);f?(c=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):c=d=e;var h=c.match(x_);h?Hd(h[0],o,i,r):(h=c.match(TN))&&ON(h[0],h[1]||"",o,i,r);var u=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(u>0){var p=c.slice(u,u+50).match(wN);p&&vN(o,p[1])}var m=c.match(CN);m&&m[1]&&HN(m[1],i);var g=[];if(t.cellStyles){var v=c.match(SN);v&&jN(g,v)}f&&XN(f[1],o,t,s,a,l);var x=d.match(kN);x&&(o["!autofilter"]=BN(x[0]));var y=[],_=d.match(xN);if(_)for(u=0;u!=_.length;++u)y[u]=rt(_[u].slice(_[u].indexOf('"')+1));var w=d.match(_N);w&&RN(o,w,n);var T=d.match(bN);if(T&&(o["!margins"]=IN(He(T[0]))),!o["!ref"]&&s.e.c>=s.s.c&&s.e.r>=s.s.r&&(o["!ref"]=$e(s)),t.sheetRows>0&&o["!ref"]){var k=rt(o["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>s.e.r&&(k.e.r=s.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>s.e.c&&(k.e.c=s.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=$e(k))}return g.length>0&&(o["!cols"]=g),y.length>0&&(o["!merges"]=y),o}function AN(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+$e(e[r])+'"/>';return t+"</mergeCells>"}function Hd(e,t,r,n){var i=He(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=tt(ut(i.codeName)))}function ON(e,t,r,n,i){Hd(e.slice(0,e.indexOf(">")),r,n,i)}function FN(e,t,r,n,i){var a=!1,l={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var s=t.SheetNames[r];try{t.Workbook&&(s=t.Workbook.Sheets[r].CodeName||s)}catch{}a=!0,l.codeName=Mn(lt(s))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+Te("outlinePr",null,c)}!a&&!o||(i[i.length]=Te("sheetPr",o,l))}var PN=["objects","scenarios","selectLockedCells","selectUnlockedCells"],NN=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function DN(e){var t={sheet:1};return PN.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),NN.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Id(e.password).toString(16).toUpperCase()),Te("sheetProtection",null,t)}function RN(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var a=He(ut(t[i]),!0);if(!a.ref)return;var l=((r||{})["!id"]||[])[a.id];l?(a.Target=l.Target,a.location&&(a.Target+="#"+tt(a.location))):(a.Target="#"+tt(a.location),l={Target:a.Target,TargetMode:"Internal"}),a.Rel=l,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=rt(a.ref),s=o.s.r;s<=o.e.r;++s)for(var c=o.s.c;c<=o.e.c;++c){var d=We({c,r:s});n?(e[s]||(e[s]=[]),e[s][c]||(e[s][c]={t:"z",v:void 0}),e[s][c].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function IN(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function MN(e){return la(e),Te("pageMargins",null,e)}function jN(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=He(t[n],!0);i.hidden&&(i.hidden=gt(i.hidden));var a=parseInt(i.min,10)-1,l=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Md(i.width)),Di(i);a<=l;)e[a++]=xt(i)}}function LN(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=Te("col",null,Hu(i,n)));return r[r.length]="</cols>",r.join("")}function BN(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function UN(e,t,r,n){var i=typeof e.ref=="string"?e.ref:$e(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,l=jr(i);l.s.r==l.e.r&&(l.e.r=jr(t["!ref"]).e.r,i=$e(l));for(var o=0;o<a.length;++o){var s=a[o];if(s.Name=="_xlnm._FilterDatabase"&&s.Sheet==n){s.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Te("autoFilter",null,{ref:i})}var WN=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function HN(e,t){t.Views||(t.Views=[{}]),(e.match(WN)||[]).forEach(function(r,n){var i=He(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),gt(i.rightToLeft)&&(t.Views[n].RTL=!0)})}function zN(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Te("sheetViews",Te("sheetView",null,i),{})}function VN(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",a=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=li[e.v];break;case"d":n&&n.cellDates?i=vt(e.v,-1).toISOString():(e=xt(e),e.t="n",i=""+(e.v=Kt(vt(e.v)))),typeof e.z>"u"&&(e.z=Be[14]);break;default:i=e.v;break}var o=sr("v",lt(i)),s={r:t},c=Wi(n.cellXfs,e,n);switch(c!==0&&(s.s=c),e.t){case"n":break;case"d":s.t="d";break;case"b":s.t="b";break;case"e":s.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=sr("v",""+Wd(n.Strings,e.v,n.revStrings)),s.t="s";break}s.t="str";break}if(e.t!=a&&(e.t=a,e.v=l),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Te("f",lt(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(s.cm=1),Te("c",o,s)}var XN=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=Zo("v"),l=Zo("f");return function(s,c,d,f,h,u){for(var p=0,m="",g=[],v=[],x=0,y=0,_=0,w="",T,k,O=0,F=0,M,V,X=0,q=0,ae=Array.isArray(u.CellXf),ne,re=[],le=[],se=Array.isArray(c),C=[],j={},L=!1,E=!!d.sheetStubs,I=s.split(t),A=0,b=I.length;A!=b;++A){m=I[A].trim();var P=m.length;if(P!==0){var R=0;e:for(p=0;p<P;++p)switch(m[p]){case">":if(m[p-1]!="/"){++p;break e}if(d&&d.cellStyles){if(k=He(m.slice(R,p),!0),O=k.r!=null?parseInt(k.r,10):O+1,F=-1,d.sheetRows&&d.sheetRows<O)continue;j={},L=!1,k.ht&&(L=!0,j.hpt=parseFloat(k.ht),j.hpx=Es(j.hpt)),k.hidden=="1"&&(L=!0,j.hidden=!0),k.outlineLevel!=null&&(L=!0,j.level=+k.outlineLevel),L&&(C[O-1]=j)}break;case"<":R=p;break}if(R>=p)break;if(k=He(m.slice(R,p),!0),O=k.r!=null?parseInt(k.r,10):O+1,F=-1,!(d.sheetRows&&d.sheetRows<O)){f.s.r>O-1&&(f.s.r=O-1),f.e.r<O-1&&(f.e.r=O-1),d&&d.cellStyles&&(j={},L=!1,k.ht&&(L=!0,j.hpt=parseFloat(k.ht),j.hpx=Es(j.hpt)),k.hidden=="1"&&(L=!0,j.hidden=!0),k.outlineLevel!=null&&(L=!0,j.level=+k.outlineLevel),L&&(C[O-1]=j)),g=m.slice(p).split(e);for(var W=0;W!=g.length&&g[W].trim().charAt(0)=="<";++W);for(g=g.slice(W),p=0;p!=g.length;++p)if(m=g[p].trim(),m.length!==0){if(v=m.match(r),x=p,y=0,_=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,v!=null&&v.length===2){for(x=0,w=v[1],y=0;y!=w.length&&!((_=w.charCodeAt(y)-64)<1||_>26);++y)x=26*x+_;--x,F=x}else++F;for(y=0;y!=m.length&&m.charCodeAt(y)!==62;++y);if(++y,k=He(m.slice(0,y),!0),k.r||(k.r=We({r:O-1,c:F})),w=m.slice(y),T={t:""},(v=w.match(a))!=null&&v[1]!==""&&(T.v=tt(v[1])),d.cellFormula){if((v=w.match(l))!=null&&v[1]!==""){if(T.f=tt(ut(v[1])).replace(/\r\n/g,`
`),d.xlfn||(T.f=Nm(T.f)),v[0].indexOf('t="array"')>-1)T.F=(w.match(i)||[])[1],T.F.indexOf(":")>-1&&re.push([rt(T.F),T.F]);else if(v[0].indexOf('t="shared"')>-1){V=He(v[0]);var z=tt(ut(v[1]));d.xlfn||(z=Nm(z)),le[parseInt(V.si,10)]=[V,z,k.r]}}else(v=w.match(/<f[^>]*\/>/))&&(V=He(v[0]),le[V.si]&&(T.f=WF(le[V.si][1],le[V.si][2],k.r)));var Y=Et(k.r);for(y=0;y<re.length;++y)Y.r>=re[y][0].s.r&&Y.r<=re[y][0].e.r&&Y.c>=re[y][0].s.c&&Y.c<=re[y][0].e.c&&(T.F=re[y][1])}if(k.t==null&&T.v===void 0)if(T.f||T.F)T.v=0,T.t="n";else if(E)T.t="z";else continue;else T.t=k.t||"n";switch(f.s.c>F&&(f.s.c=F),f.e.c<F&&(f.e.c=F),T.t){case"n":if(T.v==""||T.v==null){if(!E)continue;T.t="z"}else T.v=parseFloat(T.v);break;case"s":if(typeof T.v>"u"){if(!E)continue;T.t="z"}else M=So[parseInt(T.v,10)],T.v=M.t,T.r=M.r,d.cellHTML&&(T.h=M.h);break;case"str":T.t="s",T.v=T.v!=null?ut(T.v):"",d.cellHTML&&(T.h=_d(T.v));break;case"inlineStr":v=w.match(n),T.t="s",v!=null&&(M=Rd(v[1]))?(T.v=M.t,d.cellHTML&&(T.h=M.h)):T.v="";break;case"b":T.v=gt(T.v);break;case"d":d.cellDates?T.v=vt(T.v,1):(T.v=Kt(vt(T.v,1)),T.t="n");break;case"e":(!d||d.cellText!==!1)&&(T.w=T.v),T.v=_y[T.v];break}if(X=q=0,ne=null,ae&&k.s!==void 0&&(ne=u.CellXf[k.s],ne!=null&&(ne.numFmtId!=null&&(X=ne.numFmtId),d.cellStyles&&ne.fillId!=null&&(q=ne.fillId))),v_(T,X,q,d,h,u),d.cellDates&&ae&&T.t=="n"&&Ds(Be[X])&&(T.t="d",T.v=Lu(T.v)),k.cm&&d.xlmeta){var ie=(d.xlmeta.Cell||[])[+k.cm-1];ie&&ie.type=="XLDAPR"&&(T.D=!0)}if(se){var N=Et(k.r);c[N.r]||(c[N.r]=[]),c[N.r][N.c]=T}else c[k.r]=T}}}}C.length>0&&(c["!rows"]=C)}}();function $N(e,t,r,n){var i=[],a=[],l=rt(e["!ref"]),o="",s,c="",d=[],f=0,h=0,u=e["!rows"],p=Array.isArray(e),m={r:c},g,v=-1;for(h=l.s.c;h<=l.e.c;++h)d[h]=Ct(h);for(f=l.s.r;f<=l.e.r;++f){for(a=[],c=Lt(f),h=l.s.c;h<=l.e.c;++h){s=d[h]+c;var x=p?(e[f]||[])[h]:e[s];x!==void 0&&(o=VN(x,s,e,t))!=null&&a.push(o)}(a.length>0||u&&u[f])&&(m={r:c},u&&u[f]&&(g=u[f],g.hidden&&(m.hidden=1),v=-1,g.hpx?v=sl(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(m.ht=v,m.customHeight=1),g.level&&(m.outlineLevel=g.level)),i[i.length]=Te("row",a.join(""),m))}if(u)for(;f<u.length;++f)u&&u[f]&&(m={r:f+1},g=u[f],g.hidden&&(m.hidden=1),v=-1,g.hpx?v=sl(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(m.ht=v,m.customHeight=1),g.level&&(m.outlineLevel=g.level),i[i.length]=Te("row","",m));return i.join("")}function y_(e,t,r,n){var i=[Bt,Te("worksheet",null,{xmlns:ka[0],"xmlns:r":Gt.r})],a=r.SheetNames[e],l=0,o="",s=r.Sheets[a];s==null&&(s={});var c=s["!ref"]||"A1",d=rt(c);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=$e(d)}n||(n={}),s["!comments"]=[];var f=[];FN(s,r,e,t,i),i[i.length]=Te("dimension",null,{ref:c}),i[i.length]=zN(s,t,e,r),t.sheetFormat&&(i[i.length]=Te("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),s["!cols"]!=null&&s["!cols"].length>0&&(i[i.length]=LN(s,s["!cols"])),i[l=i.length]="<sheetData/>",s["!links"]=[],s["!ref"]!=null&&(o=$N(s,t),o.length>0&&(i[i.length]=o)),i.length>l+1&&(i[i.length]="</sheetData>",i[l]=i[l].replace("/>",">")),s["!protect"]&&(i[i.length]=DN(s["!protect"])),s["!autofilter"]!=null&&(i[i.length]=UN(s["!autofilter"],s,r,e)),s["!merges"]!=null&&s["!merges"].length>0&&(i[i.length]=AN(s["!merges"]));var h=-1,u,p=-1;return s["!links"].length>0&&(i[i.length]="<hyperlinks>",s["!links"].forEach(function(m){m[1].Target&&(u={ref:m[0]},m[1].Target.charAt(0)!="#"&&(p=ot(n,-1,lt(m[1].Target).replace(/#.*$/,""),qe.HLINK),u["r:id"]="rId"+p),(h=m[1].Target.indexOf("#"))>-1&&(u.location=lt(m[1].Target.slice(h+1))),m[1].Tooltip&&(u.tooltip=lt(m[1].Tooltip)),i[i.length]=Te("hyperlink",null,u))}),i[i.length]="</hyperlinks>"),delete s["!links"],s["!margins"]!=null&&(i[i.length]=MN(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=sr("ignoredErrors",Te("ignoredError",null,{numberStoredAsText:1,sqref:c}))),f.length>0&&(p=ot(n,-1,"../drawings/drawing"+(e+1)+".xml",qe.DRAW),i[i.length]=Te("drawing",null,{"r:id":"rId"+p}),s["!drawing"]=f),s["!comments"].length>0&&(p=ot(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",qe.VML),i[i.length]=Te("legacyDrawing",null,{"r:id":"rId"+p}),s["!legacy"]=p),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function GN(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}function YN(e,t,r){var n=ge(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;i.hpx?a=sl(i.hpx)*20:i.hpt&&(a=i.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var l=0;i.level&&(l|=i.level),i.hidden&&(l|=16),(i.hpx||i.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var o=0,s=n.l;n.l+=4;for(var c={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,u=d<<10;u<d+1<<10;++u){c.c=u;var p=Array.isArray(r)?(r[c.r]||[])[c.c]:r[We(c)];p&&(f<0&&(f=u),h=u)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,h))}var m=n.l;return n.l=s,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function KN(e,t,r,n){var i=YN(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&xe(e,0,i)}var qN=Ea,JN=Ms;function QN(){}function ZN(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=r4(e),r}function eD(e,t,r){r==null&&(r=ge(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return iu({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),gy(e,r),r.slice(0,r.l)}function tD(e){var t=fn(e);return[t]}function rD(e,t,r){return r==null&&(r=ge(8)),ba(t,r)}function nD(e){var t=Ta(e);return[t]}function iD(e,t,r){return r==null&&(r=ge(4)),Ca(t,r)}function aD(e){var t=fn(e),r=e.read_shift(1);return[t,r,"b"]}function sD(e,t,r){return r==null&&(r=ge(9)),ba(t,r),r.write_shift(1,e.v?1:0),r}function oD(e){var t=Ta(e),r=e.read_shift(1);return[t,r,"b"]}function lD(e,t,r){return r==null&&(r=ge(5)),Ca(t,r),r.write_shift(1,e.v?1:0),r}function cD(e){var t=fn(e),r=e.read_shift(1);return[t,r,"e"]}function uD(e,t,r){return r==null&&(r=ge(9)),ba(t,r),r.write_shift(1,e.v),r}function fD(e){var t=Ta(e),r=e.read_shift(1);return[t,r,"e"]}function hD(e,t,r){return r==null&&(r=ge(8)),Ca(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function dD(e){var t=fn(e),r=e.read_shift(4);return[t,r,"s"]}function pD(e,t,r){return r==null&&(r=ge(12)),ba(t,r),r.write_shift(4,t.v),r}function gD(e){var t=Ta(e),r=e.read_shift(4);return[t,r,"s"]}function mD(e,t,r){return r==null&&(r=ge(8)),Ca(t,r),r.write_shift(4,t.v),r}function vD(e){var t=fn(e),r=vr(e);return[t,r,"n"]}function xD(e,t,r){return r==null&&(r=ge(16)),ba(t,r),ma(e.v,r),r}function __(e){var t=Ta(e),r=vr(e);return[t,r,"n"]}function yD(e,t,r){return r==null&&(r=ge(12)),Ca(t,r),ma(e.v,r),r}function _D(e){var t=fn(e),r=Od(e);return[t,r,"n"]}function wD(e,t,r){return r==null&&(r=ge(12)),ba(t,r),my(e.v,r),r}function SD(e){var t=Ta(e),r=Od(e);return[t,r,"n"]}function kD(e,t,r){return r==null&&(r=ge(8)),Ca(t,r),my(e.v,r),r}function bD(e){var t=fn(e),r=Cd(e);return[t,r,"is"]}function TD(e){var t=fn(e),r=xr(e);return[t,r,"str"]}function CD(e,t,r){return r==null&&(r=ge(12+4*e.v.length)),ba(t,r),Zt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function ED(e){var t=Ta(e),r=xr(e);return[t,r,"str"]}function AD(e,t,r){return r==null&&(r=ge(8+4*e.v.length)),Ca(t,r),Zt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function OD(e,t,r){var n=e.l+t,i=fn(e);i.r=r["!row"];var a=e.read_shift(1),l=[i,a,"b"];if(r.cellFormula){e.l+=2;var o=Wu(e,n-e.l,r);l[3]=pr(o,null,i,r.supbooks,r)}else e.l=n;return l}function FD(e,t,r){var n=e.l+t,i=fn(e);i.r=r["!row"];var a=e.read_shift(1),l=[i,a,"e"];if(r.cellFormula){e.l+=2;var o=Wu(e,n-e.l,r);l[3]=pr(o,null,i,r.supbooks,r)}else e.l=n;return l}function PD(e,t,r){var n=e.l+t,i=fn(e);i.r=r["!row"];var a=vr(e),l=[i,a,"n"];if(r.cellFormula){e.l+=2;var o=Wu(e,n-e.l,r);l[3]=pr(o,null,i,r.supbooks,r)}else e.l=n;return l}function ND(e,t,r){var n=e.l+t,i=fn(e);i.r=r["!row"];var a=xr(e),l=[i,a,"str"];if(r.cellFormula){e.l+=2;var o=Wu(e,n-e.l,r);l[3]=pr(o,null,i,r.supbooks,r)}else e.l=n;return l}var DD=Ea,RD=Ms;function ID(e,t){return t==null&&(t=ge(4)),t.write_shift(4,e),t}function MD(e,t){var r=e.l+t,n=Ea(e),i=Ed(e),a=xr(e),l=xr(e),o=xr(e);e.l=r;var s={rfx:n,relId:i,loc:a,display:o};return l&&(s.Tooltip=l),s}function jD(e,t){var r=ge(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ms({s:Et(e[0]),e:Et(e[0])},r),Ad("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return Zt(i||"",r),Zt(e[1].Tooltip||"",r),Zt("",r),r.slice(0,r.l)}function LD(){}function BD(e,t,r){var n=e.l+t,i=vy(e),a=e.read_shift(1),l=[i];if(l[2]=a,r.cellFormula){var o=cN(e,n-e.l,r);l[1]=o}else e.l=n;return l}function UD(e,t,r){var n=e.l+t,i=Ea(e),a=[i];if(r.cellFormula){var l=fN(e,n-e.l,r);a[1]=l,e.l=n}else e.l=n;return a}function WD(e,t,r){r==null&&(r=ge(18));var n=Hu(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var w_=["left","right","top","bottom","header","footer"];function HD(e){var t={};return w_.forEach(function(r){t[r]=vr(e)}),t}function zD(e,t){return t==null&&(t=ge(6*8)),la(e),w_.forEach(function(r){ma(e[r],t)}),t}function VD(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function XD(e,t,r){r==null&&(r=ge(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function $D(e){var t=ge(24);return t.write_shift(4,4),t.write_shift(4,1),Ms(e,t),t}function GD(e,t){return t==null&&(t=ge(16*4+2)),t.write_shift(2,e.password?Id(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function YD(){}function KD(){}function qD(e,t,r,n,i,a,l){if(!e)return e;var o=t||{};n||(n={"!id":{}});var s=o.dense?[]:{},c,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,u,p,m,g,v,x,y,_,w,T=[];o.biff=12,o["!row"]=0;var k=0,O=!1,F=[],M={},V=o.supbooks||i.supbooks||[[]];if(V.sharedf=M,V.arrayf=F,V.SheetNames=i.SheetNames||i.Sheets.map(function(se){return se.name}),!o.supbooks&&(o.supbooks=V,i.Names))for(var X=0;X<i.Names.length;++X)V[0][X+1]=i.Names[X];var q=[],ae=[],ne=!1;ol[16]={n:"BrtShortReal",f:__};var re;if(oi(e,function(C,j,L){if(!h)switch(L){case 148:c=C;break;case 0:u=C,o.sheetRows&&o.sheetRows<=u.r&&(h=!0),_=Lt(g=u.r),o["!row"]=u.r,(C.hidden||C.hpt||C.level!=null)&&(C.hpt&&(C.hpx=Es(C.hpt)),ae[C.r]=C);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:C[2]},C[2]){case"n":p.v=C[1];break;case"s":y=So[C[1]],p.v=y.t,p.r=y.r;break;case"b":p.v=!!C[1];break;case"e":p.v=C[1],o.cellText!==!1&&(p.w=li[p.v]);break;case"str":p.t="s",p.v=C[1];break;case"is":p.t="s",p.v=C[1].t;break}if((m=l.CellXf[C[0].iStyleRef])&&v_(p,m.numFmtId,null,o,a,l),v=C[0].c==-1?v+1:C[0].c,o.dense?(s[g]||(s[g]=[]),s[g][v]=p):s[Ct(v)+_]=p,o.cellFormula){for(O=!1,k=0;k<F.length;++k){var E=F[k];u.r>=E[0].s.r&&u.r<=E[0].e.r&&v>=E[0].s.c&&v<=E[0].e.c&&(p.F=$e(E[0]),O=!0)}!O&&C.length>3&&(p.f=C[3])}if(d.s.r>u.r&&(d.s.r=u.r),d.s.c>v&&(d.s.c=v),d.e.r<u.r&&(d.e.r=u.r),d.e.c<v&&(d.e.c=v),o.cellDates&&m&&p.t=="n"&&Ds(Be[m.numFmtId])){var I=ra(p.v);I&&(p.t="d",p.v=new Date(I.y,I.m-1,I.d,I.H,I.M,I.S,I.u))}re&&(re.type=="XLDAPR"&&(p.D=!0),re=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;p={t:"z",v:void 0},v=C[0].c==-1?v+1:C[0].c,o.dense?(s[g]||(s[g]=[]),s[g][v]=p):s[Ct(v)+_]=p,d.s.r>u.r&&(d.s.r=u.r),d.s.c>v&&(d.s.c=v),d.e.r<u.r&&(d.e.r=u.r),d.e.c<v&&(d.e.c=v),re&&(re.type=="XLDAPR"&&(p.D=!0),re=void 0);break;case 176:T.push(C);break;case 49:re=((o.xlmeta||{}).Cell||[])[C-1];break;case 494:var A=n["!id"][C.relId];for(A?(C.Target=A.Target,C.loc&&(C.Target+="#"+C.loc),C.Rel=A):C.relId==""&&(C.Target="#"+C.loc),g=C.rfx.s.r;g<=C.rfx.e.r;++g)for(v=C.rfx.s.c;v<=C.rfx.e.c;++v)o.dense?(s[g]||(s[g]=[]),s[g][v]||(s[g][v]={t:"z",v:void 0}),s[g][v].l=C):(x=We({c:v,r:g}),s[x]||(s[x]={t:"z",v:void 0}),s[x].l=C);break;case 426:if(!o.cellFormula)break;F.push(C),w=o.dense?s[g][v]:s[Ct(v)+_],w.f=pr(C[1],d,{r:u.r,c:v},V,o),w.F=$e(C[0]);break;case 427:if(!o.cellFormula)break;M[We(C[0].s)]=C[1],w=o.dense?s[g][v]:s[Ct(v)+_],w.f=pr(C[1],d,{r:u.r,c:v},V,o);break;case 60:if(!o.cellStyles)break;for(;C.e>=C.s;)q[C.e--]={width:C.w/256,hidden:!!(C.flags&1),level:C.level},ne||(ne=!0,Md(C.w/256)),Di(q[C.e+1]);break;case 161:s["!autofilter"]={ref:$e(C)};break;case 476:s["!margins"]=C;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),C.name&&(i.Sheets[r].CodeName=C.name),(C.above||C.left)&&(s["!outline"]={above:C.above,left:C.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),C.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!j.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+L.toString(16))}}},o),delete o.supbooks,delete o["!row"],!s["!ref"]&&(d.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(s["!ref"]=$e(c||d)),o.sheetRows&&s["!ref"]){var le=rt(s["!ref"]);o.sheetRows<=+le.e.r&&(le.e.r=o.sheetRows-1,le.e.r>d.e.r&&(le.e.r=d.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>d.e.c&&(le.e.c=d.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),s["!fullref"]=s["!ref"],s["!ref"]=$e(le))}return T.length>0&&(s["!merges"]=T),q.length>0&&(s["!cols"]=q),ae.length>0&&(s["!rows"]=ae),s}function JD(e,t,r,n,i,a,l){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=xt(t),t.z=t.z||Be[14],t.v=Kt(vt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var s={r,c:n};switch(s.s=Wi(i.cellXfs,t,i),t.l&&a["!links"].push([We(s),t.l]),t.c&&a["!comments"].push([We(s),t.c]),t.t){case"s":case"str":return i.bookSST?(o=Wd(i.Strings,t.v,i.revStrings),s.t="s",s.v=o,l?xe(e,18,mD(t,s)):xe(e,7,pD(t,s))):(s.t="str",l?xe(e,17,AD(t,s)):xe(e,6,CD(t,s))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?xe(e,13,kD(t,s)):xe(e,2,wD(t,s)):l?xe(e,16,yD(t,s)):xe(e,5,xD(t,s)),!0;case"b":return s.t="b",l?xe(e,15,lD(t,s)):xe(e,4,sD(t,s)),!0;case"e":return s.t="e",l?xe(e,14,hD(t,s)):xe(e,3,uD(t,s)),!0}return l?xe(e,12,iD(t,s)):xe(e,1,rD(t,s)),!0}function QD(e,t,r,n){var i=rt(t["!ref"]||"A1"),a,l="",o=[];xe(e,145);var s=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var d=i.s.r;d<=c;++d){l=Lt(d),KN(e,t,i,d);var f=!1;if(d<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){d===i.s.r&&(o[h]=Ct(h)),a=o[h]+l;var u=s?(t[d]||[])[h]:t[a];if(!u){f=!1;continue}f=JD(e,u,d,h,n,t,f)}}xe(e,146)}function ZD(e,t){!t||!t["!merges"]||(xe(e,177,ID(t["!merges"].length)),t["!merges"].forEach(function(r){xe(e,176,RD(r))}),xe(e,178))}function e5(e,t){!t||!t["!cols"]||(xe(e,390),t["!cols"].forEach(function(r,n){r&&xe(e,60,WD(n,r))}),xe(e,391))}function t5(e,t){!t||!t["!ref"]||(xe(e,648),xe(e,649,$D(rt(t["!ref"]))),xe(e,650))}function r5(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=ot(r,-1,n[1].Target.replace(/#.*$/,""),qe.HLINK);xe(e,494,jD(n,i))}}),delete t["!links"]}function n5(e,t,r,n){if(t["!comments"].length>0){var i=ot(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",qe.VML);xe(e,551,Ad("rId"+i)),t["!legacy"]=i}}function i5(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],a=typeof i.ref=="string"?i.ref:$e(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=jr(a);o.s.r==o.e.r&&(o.e.r=jr(t["!ref"]).e.r,a=$e(o));for(var s=0;s<l.length;++s){var c=l[s];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}s==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),xe(e,161,Ms(rt(a))),xe(e,162)}}function a5(e,t,r){xe(e,133),xe(e,137,XD(t,r)),xe(e,138),xe(e,134)}function s5(e,t){t["!protect"]&&xe(e,535,GD(t["!protect"]))}function o5(e,t,r,n){var i=Mr(),a=r.SheetNames[e],l=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var s=rt(l["!ref"]||"A1");if(s.e.c>16383||s.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");s.e.c=Math.min(s.e.c,16383),s.e.r=Math.min(s.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],xe(i,129),(r.vbaraw||l["!outline"])&&xe(i,147,eD(o,l["!outline"])),xe(i,148,JN(s)),a5(i,l,r.Workbook),e5(i,l),QD(i,l,e,t),s5(i,l),i5(i,l,r,e),ZD(i,l),r5(i,l,n),l["!margins"]&&xe(i,476,zD(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&t5(i,l),n5(i,l,e,n),xe(i,130),i.end()}function l5(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var l=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var i=tt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,i,n]}function c5(e,t,r,n,i,a){var l=a||{"!type":"chart"};if(!e)return a;var o=0,s=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=l5(f);d.s.r=d.s.c=0,d.e.c=o,c=Ct(o),h[0].forEach(function(u,p){l[c+Lt(p)]={t:"n",v:u,z:h[1]},s=p}),d.e.r<s&&(d.e.r=s),++o}),o>0&&(l["!ref"]=$e(d)),l}function u5(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},l,o=e.match(x_);return o&&Hd(o[0],a,i,r),(l=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=l[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function f5(e,t){e.l+=10;var r=xr(e);return{name:r}}function h5(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},l=!1;return oi(e,function(s,c,d){switch(d){case 550:a["!rel"]=s;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),s.name&&(i.Sheets[r].CodeName=s.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var zd=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],d5=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],p5=[],g5=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function jm(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var a=t[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=gt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function Lm(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=gt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function S_(e){Lm(e.WBProps,zd),Lm(e.CalcPr,g5),jm(e.WBView,d5),jm(e.Sheets,p5),ms.date1904=gt(e.WBProps.date1904)}function m5(e){return!e.Workbook||!e.Workbook.WBProps?"false":gt(e.Workbook.WBProps.date1904)?"true":"false"}var v5="][*?/\\".split("");function k_(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return v5.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function x5(e,t,r){e.forEach(function(n,i){k_(n);for(var a=0;a<i;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=t&&t[i]&&t[i].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function y5(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];x5(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)mN(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var _5=/<\w+:workbook/;function w5(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},l=0;if(e.replace(wr,function(s,c){var d=He(s);switch(Bn(d[0])){case"<?xml":break;case"<workbook":s.match(_5)&&(i="xmlns"+s.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":zd.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=gt(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=ut(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=tt(ut(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=ut(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),gt(d.hidden||"0")&&(a.Hidden=!0),l=c+s.length;break;case"</definedName>":a.Ref=tt(ut(e.slice(l,c))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return s}),ka.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return S_(r),r}function b_(e){var t=[Bt];t[t.length]=Te("workbook",null,{xmlns:ka[0],"xmlns:r":Gt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(zd.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Te("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!i[a]||!i[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var l={name:lt(e.SheetNames[a].slice(0,31))};if(l.sheetId=""+(a+1),l["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Te("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var s={name:o.Name};o.Comment&&(s.comment=o.Comment),o.Sheet!=null&&(s.localSheetId=""+o.Sheet),o.Hidden&&(s.hidden="1"),o.Ref&&(t[t.length]=Te("definedName",lt(o.Ref),s))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function S5(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=qh(e),r.name=xr(e),r}function k5(e,t){return t||(t=ge(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Ad(e.strRelID,t),Zt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function b5(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?xr(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function T5(e,t){t||(t=ge(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),gy(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function C5(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function E5(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=n4(e),l=uN(e,0,r),o=Ed(e);e.l=n;var s={Name:a,Ptg:l};return i<268435455&&(s.Sheet=i),o&&(s.Comment=o),s}function A5(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var a=[],l=[[]];return l.SheetNames=[],l.XTI=[],ol[16]={n:"BrtFRTArchID$",f:C5},oi(e,function(s,c,d){switch(d){case 156:l.SheetNames.push(s.name),r.Sheets.push(s);break;case 153:r.WBProps=s;break;case 39:s.Sheet!=null&&(t.SID=s.Sheet),s.Ref=pr(s.Ptg,null,null,l,t),delete t.SID,delete s.Ptg,a.push(s);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([d,s]):l[0]=[d,s],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(s),l.XTI=l.XTI.concat(s);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),S_(r),r.Names=a,r.supbooks=l,r}function O5(e,t){xe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};xe(e,156,k5(i))}xe(e,144)}function F5(e,t){t||(t=ge(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Zt("SheetJS",t),Zt(Jc.version,t),Zt(Jc.version,t),Zt("7262",t),t.length>t.l?t.slice(0,t.l):t}function P5(e,t){t||(t=ge(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function N5(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&a==-1&&(a=n);a>i||(xe(e,135),xe(e,158,P5(i)),xe(e,136))}}function D5(e,t){var r=Mr();return xe(r,131),xe(r,128,F5()),xe(r,153,T5(e.Workbook&&e.Workbook.WBProps||null)),N5(r,e),O5(r,e),xe(r,132),r.end()}function R5(e,t,r){return t.slice(-4)===".bin"?A5(e,r):w5(e,r)}function I5(e,t,r,n,i,a,l,o){return t.slice(-4)===".bin"?qD(e,n,r,i,a,l,o):EN(e,n,r,i,a,l,o)}function M5(e,t,r,n,i,a,l,o){return t.slice(-4)===".bin"?h5(e,n,r,i,a):u5(e,n,r,i,a)}function j5(e,t,r,n,i,a,l,o){return t.slice(-4)===".bin"?BF():UF()}function L5(e,t,r,n,i,a,l,o){return t.slice(-4)===".bin"?jF():LF()}function B5(e,t,r,n){return t.slice(-4)===".bin"?R3(e,r,n):S3(e,r,n)}function U5(e,t,r){return i_(e,r)}function W5(e,t,r){return t.slice(-4)===".bin"?WO(e,r):LO(e,r)}function H5(e,t,r){return t.slice(-4)===".bin"?NF(e,r):kF(e,r)}function z5(e,t,r){return t.slice(-4)===".bin"?_F(e):xF(e)}function V5(e,t,r,n){return r.slice(-4)===".bin"?wF(e,t,r,n):void 0}function X5(e,t,r){return t.slice(-4)===".bin"?gF(e,t,r):vF(e,t,r)}function $5(e,t,r){return(t.slice(-4)===".bin"?D5:b_)(e)}function G5(e,t,r,n,i){return(t.slice(-4)===".bin"?o5:y_)(e,r,n,i)}function Y5(e,t,r){return(t.slice(-4)===".bin"?V3:r_)(e,r)}function K5(e,t,r){return(t.slice(-4)===".bin"?VO:Yy)(e,r)}function q5(e,t,r){return(t.slice(-4)===".bin"?DF:o_)(e)}function J5(e){return(e.slice(-4)===".bin"?mF:a_)()}var T_=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,C_=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function dn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(T_),a,l,o,s;if(i)for(s=0;s!=i.length;++s)a=i[s].match(C_),(l=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(l+1),n[o]=a[2].slice(1,a[2].length-1));return n}function Q5(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(T_),i,a,l,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(C_),(a=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(a+1),r[l]=i[2].slice(1,i[2].length-1));return r}var bo;function Z5(e,t){var r=bo[e]||tt(e);return r==="General"?pa(t):un(r,t)}function eR(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=gt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=vt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[tt(t)]=i}function tR(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||li[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Qo(e.v):e.w=pa(e.v):e.w=Z5(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=bo[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Ds(n)){var i=ra(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(r.WTF)throw a}}}function rR(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=p3[n.Pattern]||n.Pattern)}e[t.ID]=t}function nR(e,t,r,n,i,a,l,o,s,c){var d="General",f=n.StyleID,h={};c=c||{};var u=[],p=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&l&&(f=l.StyleID);a[f]!==void 0&&(a[f].nf&&(d=a[f].nf),a[f].Interior&&u.push(a[f].Interior),!!a[f].Parent);)f=a[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=gt(e);break;case"String":n.t="s",n.r=tm(tt(e)),n.v=e.indexOf("<")>-1?tt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(vt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=tt(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=_y[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=tm(t||e));break}if(tR(n,d,c),c.cellFormula!==!1)if(n.Formula){var m=tt(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=gs(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=gs("RC:RC",i):n.ArrayRange&&(n.F=gs(n.ArrayRange,i),s.push([rt(n.F),n.F]))}else for(p=0;p<s.length;++p)i.r>=s[p][0].s.r&&i.r<=s[p][0].e.r&&i.c>=s[p][0].s.c&&i.c<=s[p][0].e.c&&(n.F=s[p][1]);c.cellStyles&&(u.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function iR(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function jf(e,t){var r=t||{};Rs();var n=ro(wd(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=ut(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var l=xt(r);return l.type="string",Cs.to_workbook(n,l)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(oe){i.indexOf("<"+oe)>=0&&(a=!0)}),a)return zR(n,r);bo={"General Number":"General","General Date":Be[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Be[15],"Short Date":Be[14],"Long Time":Be[19],"Medium Time":Be[18],"Short Time":Be[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Be[2],Standard:Be[4],Percent:Be[10],Scientific:Be[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,s=[],c,d={},f=[],h=r.dense?[]:{},u="",p={},m={},g=dn('<Data ss:Type="String">'),v=0,x=0,y=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}},w={},T={},k="",O=0,F=[],M={},V={},X=0,q=[],ae=[],ne={},re=[],le,se=!1,C=[],j=[],L={},E=0,I=0,A={Sheets:[],WBProps:{date1904:!1}},b={};tl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var P="";o=tl.exec(n);)switch(o[3]=(P=o[3]).toLowerCase()){case"data":if(P=="data"){if(o[1]==="/"){if((c=s.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&s.push([o[3],!0]);break}if(s[s.length-1][1])break;o[1]==="/"?nR(n.slice(v,o.index),k,g,s[s.length-1][0]=="comment"?ne:p,{c:x,r:y},w,re[x],m,C,r):(k="",g=dn(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ae.length>0&&(p.c=ae),(!r.sheetRows||r.sheetRows>y)&&p.v!==void 0&&(r.dense?(h[y]||(h[y]=[]),h[y][x]=p):h[Ct(x)+Lt(y)]=p),p.HRef&&(p.l={Target:tt(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(E=x+(parseInt(p.MergeAcross,10)|0),I=y+(parseInt(p.MergeDown,10)|0),F.push({s:{c:x,r:y},e:{c:E,r:I}})),!r.sheetStubs)p.MergeAcross?x=E+1:++x;else if(p.MergeAcross||p.MergeDown){for(var R=x;R<=E;++R)for(var W=y;W<=I;++W)(R>x||W>y)&&(r.dense?(h[W]||(h[W]=[]),h[W][R]={t:"z"}):h[Ct(R)+Lt(W)]={t:"z"});x=E+1}else++x;else p=Q5(o[0]),p.Index&&(x=+p.Index-1),x<_.s.c&&(_.s.c=x),x>_.e.c&&(_.e.c=x),o[0].slice(-2)==="/>"&&++x,ae=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<_.s.r&&(_.s.r=y),y>_.e.r&&(_.e.r=y),o[0].slice(-2)==="/>"&&(m=dn(o[0]),m.Index&&(y=+m.Index-1)),x=0,++y):(m=dn(o[0]),m.Index&&(y=+m.Index-1),L={},(m.AutoFitHeight=="0"||m.Height)&&(L.hpx=parseInt(m.Height,10),L.hpt=sl(L.hpx),j[y]=L),m.Hidden=="1"&&(L.hidden=!0,j[y]=L));break;case"worksheet":if(o[1]==="/"){if((c=s.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(u),_.s.r<=_.e.r&&_.s.c<=_.e.c&&(h["!ref"]=$e(_),r.sheetRows&&r.sheetRows<=_.e.r&&(h["!fullref"]=h["!ref"],_.e.r=r.sheetRows-1,h["!ref"]=$e(_))),F.length&&(h["!merges"]=F),re.length>0&&(h["!cols"]=re),j.length>0&&(h["!rows"]=j),d[u]=h}else _={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=x=0,s.push([o[3],!1]),c=dn(o[0]),u=tt(c.Name),h=r.dense?[]:{},F=[],C=[],j=[],b={name:u,Hidden:0},A.Sheets.push(b);break;case"table":if(o[1]==="/"){if((c=s.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;s.push([o[3],!1]),re=[],se=!1}break;case"style":o[1]==="/"?rR(w,T,r):T=dn(o[0]);break;case"numberformat":T.nf=tt(dn(o[0]).Format||"General"),bo[T.nf]&&(T.nf=bo[T.nf]);for(var z=0;z!=392&&Be[z]!=T.nf;++z);if(z==392){for(z=57;z!=392;++z)if(Be[z]==null){qn(T.nf,z);break}}break;case"column":if(s[s.length-1][0]!=="table")break;if(le=dn(o[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!se&&le.wpx>10){se=!0,mr=e_;for(var Y=0;Y<re.length;++Y)re[Y]&&Di(re[Y])}se&&Di(le),re[le.Index-1||re.length]=le;for(var ie=0;ie<+le.Span;++ie)re[re.length]=xt(le);break;case"namedrange":if(o[1]==="/")break;A.Names||(A.Names=[]);var N=He(o[0]),Q={Name:N.Name,Ref:gs(N.RefersTo.slice(1),{r:0,c:0})};A.Sheets.length>0&&(Q.Sheet=A.Sheets.length-1),A.Names.push(Q);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?k+=n.slice(O,o.index):O=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;T.Interior=dn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?A4(M,P,n.slice(X,o.index)):X=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=s.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else s.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=s.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));iR(ne),ae.push(ne)}else s.push([o[3],!1]),c=dn(o[0]),ne={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=s.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var H=dn(o[0]);h["!autofilter"]={ref:gs(H.Range).replace(/\$/g,"")},s.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=s.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&s.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=s.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&s.push([o[3],!0]);break;case"null":break;default:if(s.length==0&&o[3]=="document"||s.length==0&&o[3]=="uof")return zm(n,r);var te=!0;switch(s[s.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:te=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:te=!1}break;case"excelworkbook":switch(o[3]){case"date1904":A.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:te=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:te=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(X,o.index)){case"SheetHidden":b.Hidden=1;break;case"SheetVeryHidden":b.Hidden=2;break}else X=o.index+o[0].length;break;case"header":h["!margins"]||la(h["!margins"]={},"xlml"),isNaN(+He(o[0]).Margin)||(h["!margins"].header=+He(o[0]).Margin);break;case"footer":h["!margins"]||la(h["!margins"]={},"xlml"),isNaN(+He(o[0]).Margin)||(h["!margins"].footer=+He(o[0]).Margin);break;case"pagemargins":var ee=He(o[0]);h["!margins"]||la(h["!margins"]={},"xlml"),isNaN(+ee.Top)||(h["!margins"].top=+ee.Top),isNaN(+ee.Left)||(h["!margins"].left=+ee.Left),isNaN(+ee.Right)||(h["!margins"].right=+ee.Right),isNaN(+ee.Bottom)||(h["!margins"].bottom=+ee.Bottom);break;case"displayrighttoleft":A.Views||(A.Views=[]),A.Views[0]||(A.Views[0]={}),A.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:te=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:te=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:te=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:te=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:te=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:te=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:te=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:te=!1}break;case"smarttags":break;default:te=!1;break}if(te||o[3].match(/!\[CDATA/))break;if(!s[s.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+s.join("|");if(s[s.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?eR(V,P,q,n.slice(X,o.index)):(q=o,X=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+s.join("|")}var Z={};return!r.bookSheets&&!r.bookProps&&(Z.Sheets=d),Z.SheetNames=f,Z.Workbook=A,Z.SSF=xt(Be),Z.Props=M,Z.Custprops=V,Z}function n0(e,t){switch(Xd(t=t||{}),t.type||"base64"){case"base64":return jf(Gr(e),t);case"binary":case"buffer":case"file":return jf(e,t);case"array":return jf(Bi(e),t)}}function aR(e,t){var r=[];return e.Props&&r.push(O4(e.Props,t)),e.Custprops&&r.push(F4(e.Props,e.Custprops)),r.join("")}function sR(){return""}function oR(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var a=[];a.push(Te("NumberFormat",null,{"ss:Format":lt(Be[n.numFmtId])}));var l={"ss:ID":"s"+(21+i)};r.push(Te("Style",a.join(""),l))}),Te("Styles",r.join(""))}function E_(e){return Te("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Bd(e.Ref,{r:0,c:0})})}function lR(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(E_(i)))}return Te("Names",r.join(""))}function cR(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,a=[],l=0;l<i.length;++l){var o=i[l];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(E_(o)))}return a.join("")}function uR(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Te("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Te("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Te("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Te("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(sr("ProtectContents","True")),e["!protect"].objects&&i.push(sr("ProtectObjects","True")),e["!protect"].scenarios&&i.push(sr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(sr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(sr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&i.push("<"+l[1]+"/>")})),i.length==0?"":Te("WorksheetOptions",i.join(""),{xmlns:Ur.x})}function fR(e){return e.map(function(t){var r=NE(t.t||""),n=Te("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Te("Comment",n,{"ss:Author":t.a})}).join("")}function hR(e,t,r,n,i,a,l){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+lt(Bd(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var s=Et(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(s.r==l.r?"":"["+(s.r-l.r)+"]")+"C"+(s.c==l.c?"":"["+(s.c-l.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=lt(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=lt(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],d=0;d!=c.length;++d)c[d].s.c!=l.c||c[d].s.r!=l.r||(c[d].e.c>c[d].s.c&&(o["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(o["ss:MergeDown"]=c[d].e.r-c[d].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=li[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Be[14]);break;case"s":f="String",h=PE(e.v||"");break}var u=Wi(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+u),o["ss:Index"]=l.c+1;var p=e.v!=null?h:"",m=e.t=="z"?"":'<Data ss:Type="'+f+'">'+p+"</Data>";return(e.c||[]).length>0&&(m+=fR(e.c)),Te("Cell",m,o)}function dR(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Es(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function pR(e,t,r,n){if(!e["!ref"])return"";var i=rt(e["!ref"]),a=e["!merges"]||[],l=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,v){Di(g);var x=!!g.width,y=Hu(v,g),_={"ss:Index":v+1};x&&(_["ss:Width"]=il(y.width)),g.hidden&&(_["ss:Hidden"]="1"),o.push(Te("Column",null,_))});for(var s=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var d=[dR(c,(e["!rows"]||[])[c])],f=i.s.c;f<=i.e.c;++f){var h=!1;for(l=0;l!=a.length;++l)if(!(a[l].s.c>f)&&!(a[l].s.r>c)&&!(a[l].e.c<f)&&!(a[l].e.r<c)){(a[l].s.c!=f||a[l].s.r!=c)&&(h=!0);break}if(!h){var u={r:c,c:f},p=We(u),m=s?(e[c]||[])[f]:e[p];d.push(hR(m,p,e,t,r,n,u))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function gR(e,t,r){var n=[],i=r.SheetNames[e],a=r.Sheets[i],l=a?cR(a,t,e,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=a?pR(a,t,e,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(uR(a,t,e,r)),n.join("")}function mR(e,t){t||(t={}),e.SSF||(e.SSF=xt(Be)),e.SSF&&(Rs(),Iu(e.SSF),t.revssf=ju(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Wi(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(aR(e,t)),r.push(sR()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Te("Worksheet",gR(n,t,e),{"ss:Name":lt(e.SheetNames[n])}));return r[2]=oR(e,t),r[3]=lR(e),Bt+Te("Workbook",r.join(""),{xmlns:Ur.ss,"xmlns:o":Ur.o,"xmlns:x":Ur.x,"xmlns:ss":Ur.ss,"xmlns:dt":Ur.dt,"xmlns:html":Ur.html})}function vR(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=l4(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=c4(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var xR=[60,1084,2066,2165,2175];function yR(e,t,r,n,i){var a=n,l=[],o=r.slice(r.l,r.l+a);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}l.push(o),r.l+=a;for(var s=Gn(r,r.l),c=i0[s],d=0;c!=null&&xR.indexOf(s)>-1;)a=Gn(r,r.l+2),d=r.l+4,s==2066?d+=4:(s==2165||s==2175)&&(d+=12),o=r.slice(d,r.l+4+a),l.push(o),r.l+=4+a,c=i0[s=Gn(r,r.l)];var f=Qt(l);ar(f,0);var h=0;f.lens=[];for(var u=0;u<l.length;++u)f.lens.push(h),h+=l[u].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,i)}function On(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Be[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||li[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Qo(e.v):e.w=pa(e.v):e.w=un(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&Ds(Be[n]||String(n))){var i=ra(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function ac(e,t,r){return{v:e,ixfe:t,t:r}}function _R(e,t){var r={opts:{}},n={},i=t.dense?[]:{},a={},l={},o=null,s=[],c="",d={},f,h="",u,p,m,g,v={},x=[],y,_,w=[],T=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},O={},F=function(ze){return ze<8?aa[ze]:ze<64&&T[ze-8]||aa[ze]},M=function(ze,ft,wt){var It=ft.XF.data;if(!(!It||!It.patternType||!wt||!wt.cellStyles)){ft.s={},ft.s.patternType=It.patternType;var En;(En=nl(F(It.icvFore)))&&(ft.s.fgColor={rgb:En}),(En=nl(F(It.icvBack)))&&(ft.s.bgColor={rgb:En})}},V=function(ze,ft,wt){if(!(L>1)&&!(wt.sheetRows&&ze.r>=wt.sheetRows)){if(wt.cellStyles&&ft.XF&&ft.XF.data&&M(ze,ft,wt),delete ft.ixfe,delete ft.XF,f=ze,h=We(ze),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),ze.r<l.s.r&&(l.s.r=ze.r),ze.c<l.s.c&&(l.s.c=ze.c),ze.r+1>l.e.r&&(l.e.r=ze.r+1),ze.c+1>l.e.c&&(l.e.c=ze.c+1),wt.cellFormula&&ft.f){for(var It=0;It<x.length;++It)if(!(x[It][0].s.c>ze.c||x[It][0].s.r>ze.r)&&!(x[It][0].e.c<ze.c||x[It][0].e.r<ze.r)){ft.F=$e(x[It][0]),(x[It][0].s.c!=ze.c||x[It][0].s.r!=ze.r)&&delete ft.f,ft.f&&(ft.f=""+pr(x[It][1],l,ze,C,X));break}}wt.dense?(i[ze.r]||(i[ze.r]=[]),i[ze.r][ze.c]=ft):i[h]=ft}},X={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:x,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(X.password=t.password);var q,ae=[],ne=[],re=[],le=[],se=!1,C=[];C.SheetNames=X.snames,C.sharedf=X.sharedf,C.arrayf=X.arrayf,C.names=[],C.XTI=[];var j=0,L=0,E=0,I=[],A=[],b;X.codepage=1200,yn(1200);for(var P=!1;e.l<e.length-1;){var R=e.l,W=e.read_shift(2);if(W===0&&j===10)break;var z=e.l===e.length?0:e.read_shift(2),Y=i0[W];if(Y&&Y.f){if(t.bookSheets&&j===133&&W!==133)break;if(j=W,Y.r===2||Y.r==12){var ie=e.read_shift(2);if(z-=2,!X.enc&&ie!==W&&((ie&255)<<8|ie>>8)!==W)throw new Error("rt mismatch: "+ie+"!="+W);Y.r==12&&(e.l+=10,z-=10)}var N={};if(W===10?N=Y.f(e,z,X):N=yR(W,Y,e,z,X),L==0&&[9,521,1033,2057].indexOf(j)===-1)continue;switch(W){case 34:r.opts.Date1904=k.WBProps.date1904=N;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(X.enc||(e.l=0),X.enc=N,!t.password)throw new Error("File is password-protected");if(N.valid==null)throw new Error("Encryption scheme unsupported");if(!N.valid)throw new Error("Password is incorrect");break;case 92:X.lastuser=N;break;case 66:var Q=Number(N);switch(Q){case 21010:Q=1200;break;case 32768:Q=1e4;break;case 32769:Q=1252;break}yn(X.codepage=Q),P=!0;break;case 317:X.rrtabid=N;break;case 25:X.winlocked=N;break;case 439:r.opts.RefreshAll=N;break;case 12:r.opts.CalcCount=N;break;case 16:r.opts.CalcDelta=N;break;case 17:r.opts.CalcIter=N;break;case 13:r.opts.CalcMode=N;break;case 14:r.opts.CalcPrecision=N;break;case 95:r.opts.CalcSaveRecalc=N;break;case 15:X.CalcRefMode=N;break;case 2211:r.opts.FullCalc=N;break;case 129:N.fDialog&&(i["!type"]="dialog"),N.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),N.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:w.push(N);break;case 430:C.push([N]),C[C.length-1].XTI=[];break;case 35:case 547:C[C.length-1].push(N);break;case 24:case 536:b={Name:N.Name,Ref:pr(N.rgce,l,null,C,X)},N.itab>0&&(b.Sheet=N.itab-1),C.names.push(b),C[0]||(C[0]=[],C[0].XTI=[]),C[C.length-1].push(N),N.Name=="_xlnm._FilterDatabase"&&N.itab>0&&N.rgce&&N.rgce[0]&&N.rgce[0][0]&&N.rgce[0][0][0]=="PtgArea3d"&&(A[N.itab-1]={ref:$e(N.rgce[0][0][1][2])});break;case 22:X.ExternCount=N;break;case 23:C.length==0&&(C[0]=[],C[0].XTI=[]),C[C.length-1].XTI=C[C.length-1].XTI.concat(N),C.XTI=C.XTI.concat(N);break;case 2196:if(X.biff<8)break;b!=null&&(b.Comment=N[1]);break;case 18:i["!protect"]=N;break;case 19:N!==0&&X.WTF&&console.error("Password verifier: "+N);break;case 133:a[N.pos]=N,X.snames.push(N.name);break;case 10:{if(--L)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,i["!ref"]=$e(l),t.sheetRows&&t.sheetRows<=l.e.r){var H=l.e.r;l.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=$e(l),l.e.r=H}l.e.r++,l.e.c++}ae.length>0&&(i["!merges"]=ae),ne.length>0&&(i["!objects"]=ne),re.length>0&&(i["!cols"]=re),le.length>0&&(i["!rows"]=le),k.Sheets.push(O)}c===""?d=i:n[c]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(X.biff===8&&(X.biff={9:2,521:3,1033:4}[W]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[N.BIFFVer]||8),X.biffguess=N.BIFFVer==0,N.BIFFVer==0&&N.dt==4096&&(X.biff=5,P=!0,yn(X.codepage=28591)),X.biff==8&&N.BIFFVer==0&&N.dt==16&&(X.biff=2),L++)break;if(i=t.dense?[]:{},X.biff<8&&!P&&(P=!0,yn(X.codepage=t.codepage||1252)),X.biff<5||N.BIFFVer==0&&N.dt==4096){c===""&&(c="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var te={pos:e.l-z,name:c};a[te.pos]=te,X.snames.push(c)}else c=(a[R]||{name:""}).name;N.dt==32&&(i["!type"]="chart"),N.dt==64&&(i["!type"]="macro"),ae=[],ne=[],X.arrayf=x=[],re=[],le=[],se=!1,O={Hidden:(a[R]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[N.r]||[])[N.c]:i[We({c:N.c,r:N.r})])&&++N.c,y={ixfe:N.ixfe,XF:w[N.ixfe]||{},v:N.val,t:"n"},E>0&&(y.z=I[y.ixfe>>8&63]),On(y,t,r.opts.Date1904),V({c:N.c,r:N.r},y,t);break;case 5:case 517:y={ixfe:N.ixfe,XF:w[N.ixfe],v:N.val,t:N.t},E>0&&(y.z=I[y.ixfe>>8&63]),On(y,t,r.opts.Date1904),V({c:N.c,r:N.r},y,t);break;case 638:y={ixfe:N.ixfe,XF:w[N.ixfe],v:N.rknum,t:"n"},E>0&&(y.z=I[y.ixfe>>8&63]),On(y,t,r.opts.Date1904),V({c:N.c,r:N.r},y,t);break;case 189:for(var ee=N.c;ee<=N.C;++ee){var Z=N.rkrec[ee-N.c][0];y={ixfe:Z,XF:w[Z],v:N.rkrec[ee-N.c][1],t:"n"},E>0&&(y.z=I[y.ixfe>>8&63]),On(y,t,r.opts.Date1904),V({c:ee,r:N.r},y,t)}break;case 6:case 518:case 1030:{if(N.val=="String"){o=N;break}if(y=ac(N.val,N.cell.ixfe,N.tt),y.XF=w[y.ixfe],t.cellFormula){var oe=N.formula;if(oe&&oe[0]&&oe[0][0]&&oe[0][0][0]=="PtgExp"){var ce=oe[0][0][1][0],ye=oe[0][0][1][1],_e=We({r:ce,c:ye});v[_e]?y.f=""+pr(N.formula,l,N.cell,C,X):y.F=((t.dense?(i[ce]||[])[ye]:i[_e])||{}).F}else y.f=""+pr(N.formula,l,N.cell,C,X)}E>0&&(y.z=I[y.ixfe>>8&63]),On(y,t,r.opts.Date1904),V(N.cell,y,t),o=N}break;case 7:case 519:if(o)o.val=N,y=ac(N,o.cell.ixfe,"s"),y.XF=w[y.ixfe],t.cellFormula&&(y.f=""+pr(o.formula,l,o.cell,C,X)),E>0&&(y.z=I[y.ixfe>>8&63]),On(y,t,r.opts.Date1904),V(o.cell,y,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{x.push(N);var de=We(N[0].s);if(u=t.dense?(i[N[0].s.r]||[])[N[0].s.c]:i[de],t.cellFormula&&u){if(!o||!de||!u)break;u.f=""+pr(N[1],l,N[0],C,X),u.F=$e(N[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;v[We(o.cell)]=N[0],u=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[We(o.cell)],(u||{}).f=""+pr(N[0],l,f,C,X)}}break;case 253:y=ac(s[N.isst].t,N.ixfe,"s"),s[N.isst].h&&(y.h=s[N.isst].h),y.XF=w[y.ixfe],E>0&&(y.z=I[y.ixfe>>8&63]),On(y,t,r.opts.Date1904),V({c:N.c,r:N.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:N.ixfe,XF:w[N.ixfe],t:"z"},E>0&&(y.z=I[y.ixfe>>8&63]),On(y,t,r.opts.Date1904),V({c:N.c,r:N.r},y,t));break;case 190:if(t.sheetStubs)for(var be=N.c;be<=N.C;++be){var Ae=N.ixfe[be-N.c];y={ixfe:Ae,XF:w[Ae],t:"z"},E>0&&(y.z=I[y.ixfe>>8&63]),On(y,t,r.opts.Date1904),V({c:be,r:N.r},y,t)}break;case 214:case 516:case 4:y=ac(N.val,N.ixfe,"s"),y.XF=w[y.ixfe],E>0&&(y.z=I[y.ixfe>>8&63]),On(y,t,r.opts.Date1904),V({c:N.c,r:N.r},y,t);break;case 0:case 512:L===1&&(l=N);break;case 252:s=N;break;case 1054:if(X.biff==4){I[E++]=N[1];for(var Re=0;Re<E+163&&Be[Re]!=N[1];++Re);Re>=163&&qn(N[1],E+163)}else qn(N[1],N[0]);break;case 30:{I[E++]=N;for(var De=0;De<E+163&&Be[De]!=N;++De);De>=163&&qn(N,E+163)}break;case 229:ae=ae.concat(N);break;case 93:ne[N.cmo[0]]=X.lastobj=N;break;case 438:X.lastobj.TxO=N;break;case 127:X.lastobj.ImData=N;break;case 440:for(g=N[0].s.r;g<=N[0].e.r;++g)for(m=N[0].s.c;m<=N[0].e.c;++m)u=t.dense?(i[g]||[])[m]:i[We({c:m,r:g})],u&&(u.l=N[1]);break;case 2048:for(g=N[0].s.r;g<=N[0].e.r;++g)for(m=N[0].s.c;m<=N[0].e.c;++m)u=t.dense?(i[g]||[])[m]:i[We({c:m,r:g})],u&&u.l&&(u.l.Tooltip=N[1]);break;case 28:{if(X.biff<=5&&X.biff>=2)break;u=t.dense?(i[N[0].r]||[])[N[0].c]:i[We(N[0])];var Me=ne[N[2]];u||(t.dense?(i[N[0].r]||(i[N[0].r]=[]),u=i[N[0].r][N[0].c]={t:"z"}):u=i[We(N[0])]={t:"z"},l.e.r=Math.max(l.e.r,N[0].r),l.s.r=Math.min(l.s.r,N[0].r),l.e.c=Math.max(l.e.c,N[0].c),l.s.c=Math.min(l.s.c,N[0].c)),u.c||(u.c=[]),p={a:N[1],t:Me.TxO.t},u.c.push(p)}break;case 2173:oF(w[N.ixfe],N.ext);break;case 125:{if(!X.cellStyles)break;for(;N.e>=N.s;)re[N.e--]={width:N.w/256,level:N.level||0,hidden:!!(N.flags&1)},se||(se=!0,Md(N.w/256)),Di(re[N.e+1])}break;case 520:{var Ke={};N.level!=null&&(le[N.r]=Ke,Ke.level=N.level),N.hidden&&(le[N.r]=Ke,Ke.hidden=!0),N.hpt&&(le[N.r]=Ke,Ke.hpt=N.hpt,Ke.hpx=Es(N.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||la(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[W]]=N;break;case 161:i["!margins"]||la(i["!margins"]={}),i["!margins"].header=N.header,i["!margins"].footer=N.footer;break;case 574:N.RTL&&(k.Views[0].RTL=!0);break;case 146:T=N;break;case 2198:q=N;break;case 140:_=N;break;case 442:c?O.CodeName=N||O.name:k.WBProps.CodeName=N||"ThisWorkbook";break}}else Y||console.error("Missing Info for XLS Record 0x"+W.toString(16)),e.l+=z}return r.SheetNames=Rt(a).sort(function(Ze,ze){return Number(Ze)-Number(ze)}).map(function(Ze){return a[Ze].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&A.forEach(function(Ze,ze){r.Sheets[r.SheetNames[ze]]["!autofilter"]=Ze}),r.Strings=s,r.SSF=xt(Be),X.enc&&(r.Encryption=X.enc),q&&(r.Themes=q),r.Metadata={},_!==void 0&&(r.Metadata.Country=_),C.names.length>0&&(k.Names=C.names),r.Workbook=k,r}var To={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function wR(e,t,r){var n=Ie.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=ym(n,Jh,To.DSI);for(var a in i)t[a]=i[a]}catch(c){if(r.WTF)throw c}var l=Ie.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var o=ym(l,Qh,To.SI);for(var s in o)t[s]==null&&(t[s]=o[s])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(Cy(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function SR(e,t){var r=[],n=[],i=[],a=0,l,o=Kg(Jh,"n"),s=Kg(Qh,"n");if(e.Props)for(l=Rt(e.Props),a=0;a<l.length;++a)(Object.prototype.hasOwnProperty.call(o,l[a])?r:Object.prototype.hasOwnProperty.call(s,l[a])?n:i).push([l[a],e.Props[l[a]]]);if(e.Custprops)for(l=Rt(e.Custprops),a=0;a<l.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},l[a])||(Object.prototype.hasOwnProperty.call(o,l[a])?r:Object.prototype.hasOwnProperty.call(s,l[a])?n:i).push([l[a],e.Custprops[l[a]]]);var c=[];for(a=0;a<i.length;++a)Dy.indexOf(i[a][0])>-1||Ty.indexOf(i[a][0])>-1||i[a][1]!=null&&c.push(i[a]);n.length&&Ie.utils.cfb_add(t,"/SummaryInformation",_m(n,To.SI,s,Qh)),(r.length||c.length)&&Ie.utils.cfb_add(t,"/DocumentSummaryInformation",_m(r,To.DSI,o,Jh,c.length?c:null,To.UDI))}function A_(e,t){t||(t={}),Xd(t),hd(),t.codepage&&fd(t.codepage);var r,n;if(e.FullPaths){if(Ie.find(e,"/encryption"))throw new Error("File is password-protected");r=Ie.find(e,"!CompObj"),n=Ie.find(e,"/Workbook")||Ie.find(e,"/Book")}else{switch(t.type){case"base64":e=Hr(Gr(e));break;case"binary":e=Hr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ar(e,0),n={content:e}}var i,a;if(r&&vR(r),t.bookProps&&!t.bookSheets)i={};else{var l=Ye?"buffer":"array";if(n&&n.content)i=_R(n.content,t);else if((a=Ie.find(e,"PerfectOffice_MAIN"))&&a.content)i=oa.to_workbook(a.content,(t.type=l,t));else if((a=Ie.find(e,"NativeContent_MAIN"))&&a.content)i=oa.to_workbook(a.content,(t.type=l,t));else throw(a=Ie.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ie.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=IF(e))}var o={};return e.FullPaths&&wR(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}function kR(e,t){var r=t||{},n=Ie.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ie.utils.cfb_add(n,i,O_(e,r)),r.biff==8&&(e.Props||e.Custprops)&&SR(e,n),r.biff==8&&e.vbaraw&&MF(n,Ie.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var ol={0:{f:GN},1:{f:tD},2:{f:_D},3:{f:cD},4:{f:aD},5:{f:vD},6:{f:TD},7:{f:dD},8:{f:ND},9:{f:PD},10:{f:OD},11:{f:FD},12:{f:nD},13:{f:SD},14:{f:fD},15:{f:oD},16:{f:__},17:{f:ED},18:{f:gD},19:{f:Cd},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:E5},40:{},42:{},43:{f:T3},44:{f:k3},45:{f:A3},46:{f:F3},47:{f:O3},48:{},49:{f:qE},50:{},51:{f:uF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Vy},62:{f:bD},63:{f:yF},64:{f:YD},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:_r,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:VD},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:ZN},148:{f:qN,p:16},151:{f:LD},152:{},153:{f:b5},154:{},155:{},156:{f:S5},157:{},158:{},159:{T:1,f:UO},160:{T:-1},161:{T:1,f:Ea},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:DD},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:lF},336:{T:-1},337:{f:dF,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:qh},357:{},358:{},359:{},360:{T:1},361:{},362:{f:zy},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:BD},427:{f:UD},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:HD},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:QN},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:MD},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:qh},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:FF},633:{T:1},634:{T:-1},635:{T:1,f:AF},636:{T:-1},637:{f:e4},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:f5},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:KD},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},i0={6:{f:If},10:{f:ui},12:{f:Ht},13:{f:Ht},14:{f:Mt},15:{f:Mt},16:{f:vr},17:{f:Mt},18:{f:Mt},19:{f:Ht},20:{f:Cm},21:{f:Cm},23:{f:zy},24:{f:Am},25:{f:Mt},26:{},27:{},28:{f:KA},29:{},34:{f:Mt},35:{f:Em},38:{f:vr},39:{f:vr},40:{f:vr},41:{f:vr},42:{f:Mt},43:{f:Mt},47:{f:o3},49:{f:SA},51:{f:Ht},60:{},61:{f:vA},64:{f:Mt},65:{f:wA},66:{f:Ht},77:{},80:{},81:{},82:{},85:{f:Ht},89:{},90:{},91:{},92:{f:sA},93:{f:QA},94:{},95:{f:Mt},96:{},97:{},99:{f:Mt},125:{f:Vy},128:{f:jA},129:{f:lA},130:{f:Ht},131:{f:Mt},132:{f:Mt},133:{f:cA},134:{},140:{f:sO},141:{f:Ht},144:{},146:{f:cO},151:{},152:{},153:{},154:{},155:{},156:{f:Ht},157:{},158:{},160:{f:mO},161:{f:hO},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:DA},190:{f:RA},193:{f:ui},197:{},198:{},199:{},200:{},201:{},202:{f:Mt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ht},220:{},221:{f:Mt},222:{},224:{f:MA},225:{f:aA},226:{f:ui},227:{},229:{f:qA},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:fA},253:{f:bA},255:{f:dA},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Ry},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Mt},353:{f:ui},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:HA},431:{f:Mt},432:{},433:{},434:{},437:{},438:{f:tO},439:{f:Mt},440:{f:rO},441:{},442:{f:yl},443:{},444:{f:Ht},445:{},446:{},448:{f:ui},449:{f:mA,r:2},450:{f:ui},512:{f:km},513:{f:gO},515:{f:UA},516:{f:CA},517:{f:Tm},519:{f:vO},520:{f:pA},523:{},545:{f:Om},549:{f:Sm},566:{},574:{f:yA},638:{f:NA},659:{},1048:{},1054:{f:AA},1084:{},1212:{f:$A},2048:{f:iO},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:rc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ui},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:uO,r:12},2173:{f:sF,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Mt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:XA,r:12},2197:{},2198:{f:eF,r:12},2199:{},2200:{},2201:{},2202:{f:GA,r:12},2203:{f:ui},2204:{},2205:{},2206:{},2207:{},2211:{f:gA},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ht},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:dO},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:lO},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:km},1:{},2:{f:SO},3:{f:_O},4:{f:yO},5:{f:Tm},7:{f:bO},8:{},9:{f:rc},11:{},22:{f:Ht},30:{f:FA},31:{},32:{},33:{f:Om},36:{},37:{f:Sm},50:{f:TO},62:{},52:{},67:{},68:{f:Ht},69:{},86:{},126:{},127:{f:xO},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:CO},223:{},234:{},354:{},421:{},518:{f:If},521:{f:rc},536:{f:Am},547:{f:Em},561:{},579:{},1030:{f:If},1033:{f:rc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ce(e,t,r,n){var i=t;if(!isNaN(i)){var a=n||(r||[]).length||0,l=e.next(4);l.write_shift(2,i),l.write_shift(2,a),a>0&&kd(r)&&e.push(r)}}function bR(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return Ce(e,t,r,i);var a=t;if(!isNaN(a)){for(var l=r.parts||[],o=0,s=0,c=0;c+(l[o]||8224)<=8224;)c+=l[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,c),e.push(r.slice(s,s+c)),s+=c;s<i;){for(d=e.next(4),d.write_shift(2,60),c=0;c+(l[o]||8224)<=8224;)c+=l[o]||8224,o++;d.write_shift(2,c),e.push(r.slice(s,s+c)),s+=c}}}function kl(e,t,r){return e||(e=ge(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function TR(e,t,r,n){var i=ge(9);return kl(i,e,t),Iy(r,n||"b",i),i}function CR(e,t,r){var n=ge(8+2*r.length);return kl(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function ER(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Kt(vt(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Ce(e,2,kO(r,n,i)):Ce(e,3,wO(r,n,i));return;case"b":case"e":Ce(e,5,TR(r,n,t.v,t.t));return;case"s":case"str":Ce(e,4,CR(r,n,(t.v||"").slice(0,255)));return}Ce(e,1,kl(null,r,n))}function AR(e,t,r,n){var i=Array.isArray(t),a=rt(t["!ref"]||"A1"),l,o="",s=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),l=$e(a)}for(var c=a.s.r;c<=a.e.r;++c){o=Lt(c);for(var d=a.s.c;d<=a.e.c;++d){c===a.s.r&&(s[d]=Ct(d)),l=s[d]+o;var f=i?(t[c]||[])[d]:t[l];f&&ER(e,f,c,d)}}}function OR(e,t){for(var r=t||{},n=Mr(),i=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(i=a);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ce(n,r.biff==4?1033:r.biff==3?521:9,Dd(e,16,r)),AR(n,e.Sheets[e.SheetNames[i]],i,r),Ce(n,10),n.end()}function FR(e,t,r){Ce(e,49,kA({sz:12,name:"Arial"},r))}function PR(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Ce(e,1054,OA(i,t[i],r))})}function NR(e,t){var r=ge(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ce(e,2151,r),r=ge(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Uy(rt(t["!ref"]||"A1"),r),r.write_shift(4,4),Ce(e,2152,r)}function DR(e,t){for(var r=0;r<16;++r)Ce(e,224,bm({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ce(e,224,bm(n,0,t))})}function RR(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ce(e,440,nO(n)),n[1].Tooltip&&Ce(e,2048,aO(n))}delete t["!links"]}function IR(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&Ce(e,125,fO(Hu(i,n),i))})}}function MR(e,t,r,n,i){var a=16+Wi(i.cellXfs,t,i);if(t.v==null&&!t.bf){Ce(e,513,xa(r,n,a));return}if(t.bf)Ce(e,6,lN(t,r,n,i,a));else switch(t.t){case"d":case"n":var l=t.t=="d"?Kt(vt(t.v)):t.v;Ce(e,515,WA(r,n,l,a));break;case"b":case"e":Ce(e,517,BA(r,n,t.v,a,i,t.t));break;case"s":case"str":if(i.bookSST){var o=Wd(i.Strings,t.v,i.revStrings);Ce(e,253,TA(r,n,o,a))}else Ce(e,516,EA(r,n,(t.v||"").slice(0,255),a,i));break;default:Ce(e,513,xa(r,n,a))}}function jR(e,t,r){var n=Mr(),i=r.SheetNames[e],a=r.Sheets[i]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[e]||{},s=Array.isArray(a),c=t.biff==8,d,f="",h=[],u=rt(a["!ref"]||"A1"),p=c?65536:16384;if(u.e.c>255||u.e.r>=p){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");u.e.c=Math.min(u.e.c,255),u.e.r=Math.min(u.e.c,p-1)}Ce(n,2057,Dd(r,16,t)),Ce(n,13,tn(1)),Ce(n,12,tn(100)),Ce(n,15,br(!0)),Ce(n,17,br(!1)),Ce(n,16,ma(.001)),Ce(n,95,br(!0)),Ce(n,42,br(!1)),Ce(n,43,br(!1)),Ce(n,130,tn(1)),Ce(n,128,LA()),Ce(n,131,br(!1)),Ce(n,132,br(!1)),c&&IR(n,a["!cols"]),Ce(n,512,PA(u,t)),c&&(a["!links"]=[]);for(var m=u.s.r;m<=u.e.r;++m){f=Lt(m);for(var g=u.s.c;g<=u.e.c;++g){m===u.s.r&&(h[g]=Ct(g)),d=h[g]+f;var v=s?(a[m]||[])[g]:a[d];v&&(MR(n,v,m,g,t),c&&v.l&&a["!links"].push([d,v.l]))}}var x=o.CodeName||o.name||i;return c&&Ce(n,574,_A((l.Views||[])[0])),c&&(a["!merges"]||[]).length&&Ce(n,229,JA(a["!merges"])),c&&RR(n,a),Ce(n,442,My(x)),c&&NR(n,a),Ce(n,10),n.end()}function LR(e,t,r){var n=Mr(),i=(e||{}).Workbook||{},a=i.Sheets||[],l=i.WBProps||{},o=r.biff==8,s=r.biff==5;if(Ce(n,2057,Dd(e,5,r)),r.bookType=="xla"&&Ce(n,135),Ce(n,225,o?tn(1200):null),Ce(n,193,B4(2)),s&&Ce(n,191),s&&Ce(n,192),Ce(n,226),Ce(n,92,oA("SheetJS",r)),Ce(n,66,tn(o?1200:1252)),o&&Ce(n,353,tn(0)),o&&Ce(n,448),Ce(n,317,pO(e.SheetNames.length)),o&&e.vbaraw&&Ce(n,211),o&&e.vbaraw){var c=l.CodeName||"ThisWorkbook";Ce(n,442,My(c))}Ce(n,156,tn(17)),Ce(n,25,br(!1)),Ce(n,18,br(!1)),Ce(n,19,tn(0)),o&&Ce(n,431,br(!1)),o&&Ce(n,444,tn(0)),Ce(n,61,xA()),Ce(n,64,br(!1)),Ce(n,141,tn(0)),Ce(n,34,br(m5(e)=="true")),Ce(n,14,br(!0)),o&&Ce(n,439,br(!1)),Ce(n,218,tn(0)),FR(n,e,r),PR(n,e.SSF,r),DR(n,r),o&&Ce(n,352,br(!1));var d=n.end(),f=Mr();o&&Ce(f,140,oO()),o&&r.Strings&&bR(f,252,hA(r.Strings)),Ce(f,10);var h=f.end(),u=Mr(),p=0,m=0;for(m=0;m<e.SheetNames.length;++m)p+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var g=d.length+p+h.length;for(m=0;m<e.SheetNames.length;++m){var v=a[m]||{};Ce(u,133,uA({pos:g,hs:v.Hidden||0,dt:0,name:e.SheetNames[m]},r)),g+=t[m].length}var x=u.end();if(p!=x.length)throw new Error("BS8 "+p+" != "+x.length);var y=[];return d.length&&y.push(d),x.length&&y.push(x),h.length&&y.push(h),Qt(y)}function BR(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=xt(Be)),e&&e.SSF&&(Rs(),Iu(e.SSF),r.revssf=ju(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,$d(r),r.cellXfs=[],Wi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=jR(i,r,e);return n.unshift(LR(e,n,r)),Qt(n)}function O_(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=jr(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return BR(e,t);case 4:case 3:case 2:return OR(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function Bm(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),l=i.index,o=a&&a.index||e.length,s=kE(e.slice(l,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,f=0,h=0,u={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(l=0;l<s.length;++l){var m=s[l].trim(),g=m.slice(0,3).toLowerCase();if(g=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}d=0;continue}if(!(g!="<td"&&g!="<th")){var v=m.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var x=v[o].trim();if(x.match(/<t[dh]/i)){for(var y=x,_=0;y.charAt(0)=="<"&&(_=y.indexOf(">"))>-1;)y=y.slice(_+1);for(var w=0;w<p.length;++w){var T=p[w];T.s.c==d&&T.s.r<c&&c<=T.e.r&&(d=T.e.c+1,w=-1)}var k=He(x.slice(0,x.indexOf(">")));h=k.colspan?+k.colspan:1,((f=+k.rowspan)>1||h>1)&&p.push({s:{r:c,c:d},e:{r:c+(f||1)-1,c:d+h-1}});var O=k.t||k["data-t"]||"";if(!y.length){d+=h;continue}if(y=Z1(y),u.s.r>c&&(u.s.r=c),u.e.r<c&&(u.e.r=c),u.s.c>d&&(u.s.c=d),u.e.c<d&&(u.e.c=d),!y.length){d+=h;continue}var F={t:"s",v:y};r.raw||!y.trim().length||O=="s"||(y==="TRUE"?F={t:"b",v:!0}:y==="FALSE"?F={t:"b",v:!1}:isNaN(kn(y))?isNaN(Ts(y).getDate())||(F={t:"d",v:vt(y)},r.cellDates||(F={t:"n",v:Kt(F.v)}),F.z=r.dateNF||Be[14]):F={t:"n",v:kn(y)}),r.dense?(n[c]||(n[c]=[]),n[c][d]=F):n[We({r:c,c:d})]=F,d+=h}}}}return n["!ref"]=$e(u),p.length&&(n["!merges"]=p),n}function UR(e,t,r,n){for(var i=e["!merges"]||[],a=[],l=t.s.c;l<=t.e.c;++l){for(var o=0,s=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>l)&&!(i[c].e.r<r||i[c].e.c<l)){if(i[c].s.r<r||i[c].s.c<l){o=-1;break}o=i[c].e.r-i[c].s.r+1,s=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var d=We({r,c:l}),f=n.dense?(e[r]||[])[l]:e[d],h=f&&f.v!=null&&(f.h||_d(f.w||(ni(f),f.w)||""))||"",u={};o>1&&(u.rowspan=o),s>1&&(u.colspan=s),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(u["data-t"]=f&&f.t||"z",f.v!=null&&(u["data-v"]=f.v),f.z!=null&&(u["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),u.id=(n.id||"sjs")+"-"+d,a.push(Te("td",h,u))}}var p="<tr>";return p+a.join("")+"</tr>"}var WR='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HR="</body></html>";function zR(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ui(Bm(r[0],t),t);var n=Kd();return r.forEach(function(i,a){qd(n,Bm(i,t),"Sheet"+(a+1))}),n}function VR(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function F_(e,t){var r=t||{},n=r.header!=null?r.header:WR,i=r.footer!=null?r.footer:HR,a=[n],l=jr(e["!ref"]);r.dense=Array.isArray(e),a.push(VR(e,l,r));for(var o=l.s.r;o<=l.e.r;++o)a.push(UR(e,l,o,r));return a.push("</table>"+i),a.join("")}function P_(e,t,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Et(n.origin):n.origin;i=l.r,a=l.c}var o=t.getElementsByTagName("tr"),s=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var d=jr(e["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),i==-1&&(c.e.r=i=d.e.r+1)}var f=[],h=0,u=e["!rows"]||(e["!rows"]=[]),p=0,m=0,g=0,v=0,x=0,y=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&m<s;++p){var _=o[p];if(Um(_)){if(n.display)continue;u[m]={hidden:!0}}var w=_.children;for(g=v=0;g<w.length;++g){var T=w[g];if(!(n.display&&Um(T))){var k=T.hasAttribute("data-v")?T.getAttribute("data-v"):T.hasAttribute("v")?T.getAttribute("v"):Z1(T.innerHTML),O=T.getAttribute("data-z")||T.getAttribute("z");for(h=0;h<f.length;++h){var F=f[h];F.s.c==v+a&&F.s.r<m+i&&m+i<=F.e.r&&(v=F.e.c+1-a,h=-1)}y=+T.getAttribute("colspan")||1,((x=+T.getAttribute("rowspan")||1)>1||y>1)&&f.push({s:{r:m+i,c:v+a},e:{r:m+i+(x||1)-1,c:v+a+(y||1)-1}});var M={t:"s",v:k},V=T.getAttribute("data-t")||T.getAttribute("t")||"";k!=null&&(k.length==0?M.t=V||"z":n.raw||k.trim().length==0||V=="s"||(k==="TRUE"?M={t:"b",v:!0}:k==="FALSE"?M={t:"b",v:!1}:isNaN(kn(k))?isNaN(Ts(k).getDate())||(M={t:"d",v:vt(k)},n.cellDates||(M={t:"n",v:Kt(M.v)}),M.z=n.dateNF||Be[14]):M={t:"n",v:kn(k)})),M.z===void 0&&O!=null&&(M.z=O);var X="",q=T.getElementsByTagName("A");if(q&&q.length)for(var ae=0;ae<q.length&&!(q[ae].hasAttribute("href")&&(X=q[ae].getAttribute("href"),X.charAt(0)!="#"));++ae);X&&X.charAt(0)!="#"&&(M.l={Target:X}),n.dense?(e[m+i]||(e[m+i]=[]),e[m+i][v+a]=M):e[We({c:v+a,r:m+i})]=M,c.e.c<v+a&&(c.e.c=v+a),v+=y}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,m-1+i),e["!ref"]=$e(c),m>=s&&(e["!fullref"]=$e((c.e.r=o.length-p+m-1+i,c))),e}function N_(e,t){var r=t||{},n=r.dense?[]:{};return P_(n,e,t)}function XR(e,t){return Ui(N_(e,t),t)}function Um(e){var t="",r=$R(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function $R(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function GR(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=tt(t.replace(/<[^>]*>/g,""));return[r]}var Wm={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function D_(e,t){var r=t||{},n=wd(e),i=[],a,l,o={name:""},s="",c=0,d,f,h={},u=[],p=r.dense?[]:{},m,g,v={value:""},x="",y=0,_=[],w=-1,T=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},O=0,F={},M=[],V={},X=0,q=0,ae=[],ne=1,re=1,le=[],se={Names:[]},C={},j=["",""],L=[],E={},I="",A=0,b=!1,P=!1,R=0;for(tl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=tl.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?p["!ref"]=$e(k):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(p["!fullref"]=p["!ref"],k.e.r=r.sheetRows-1,p["!ref"]=$e(k)),M.length&&(p["!merges"]=M),ae.length&&(p["!rows"]=ae),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),u.push(d.name),h[d.name]=p,P=!1):m[0].charAt(m[0].length-2)!=="/"&&(d=He(m[0],!1),w=T=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,p=r.dense?[]:{},M=[],ae=[],P=!0);break;case"table-row-group":m[1]==="/"?--O:++O;break;case"table-row":case"":if(m[1]==="/"){w+=ne,ne=1;break}if(f=He(m[0],!1),f.?w=f.-1:w==-1&&(w=0),ne=+f["number-rows-repeated"]||1,ne<10)for(R=0;R<ne;++R)O>0&&(ae[w+R]={level:O});T=-1;break;case"covered-table-cell":m[1]!=="/"&&++T,r.sheetStubs&&(r.dense?(p[w]||(p[w]=[]),p[w][T]={t:"z"}):p[We({r:w,c:T})]={t:"z"}),x="",_=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++T,v=He(m[0],!1),re=parseInt(v["number-columns-repeated"]||"1",10),g={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(g.f=Mm(tt(v.formula))),(v.||v["value-type"])=="string"&&(g.t="s",g.v=tt(v["string-value"]||""),r.dense?(p[w]||(p[w]=[]),p[w][T]=g):p[We({r:w,c:T})]=g),T+=re-1;else if(m[1]!=="/"){++T,x="",y=0,_=[],re=1;var W=ne?w+ne-1:w;if(T>k.e.c&&(k.e.c=T),T<k.s.c&&(k.s.c=T),w<k.s.r&&(k.s.r=w),W>k.e.r&&(k.e.r=W),v=He(m[0],!1),L=[],E={},g={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=tt(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(X=parseInt(v["number-matrix-rows-spanned"],10)||0,q=parseInt(v["number-matrix-columns-spanned"],10)||0,V={s:{r:w,c:T},e:{r:w+X-1,c:T+q-1}},g.F=$e(V),le.push([V,g.F])),v.formula)g.f=Mm(v.formula);else for(R=0;R<le.length;++R)w>=le[R][0].s.r&&w<=le[R][0].e.r&&T>=le[R][0].s.c&&T<=le[R][0].e.c&&(g.F=le[R][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(X=parseInt(v["number-rows-spanned"],10)||0,q=parseInt(v["number-columns-spanned"],10)||0,V={s:{r:w,c:T},e:{r:w+X-1,c:T+q-1}},M.push(V)),v["number-columns-repeated"]&&(re=parseInt(v["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=gt(v["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(v.value);break;case"percentage":g.t="n",g.v=parseFloat(v.value);break;case"currency":g.t="n",g.v=parseFloat(v.value);break;case"date":g.t="d",g.v=vt(v["date-value"]),r.cellDates||(g.t="n",g.v=Kt(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=_E(v["time-value"])/86400,r.cellDates&&(g.t="d",g.v=Lu(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(v.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",v["string-value"]!=null&&(x=tt(v["string-value"]),_=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(b=!1,g.t==="s"&&(g.v=x||"",_.length&&(g.R=_),b=y==0),C.Target&&(g.l=C),L.length>0&&(g.c=L,L=[]),x&&r.cellText!==!1&&(g.w=x),b&&(g.t="z",delete g.v),(!b||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=w))for(var z=0;z<ne;++z){if(re=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(p[w+z]||(p[w+z]=[]),p[w+z][T]=z==0?g:xt(g);--re>0;)p[w+z][T+re]=xt(g);else for(p[We({r:w+z,c:T})]=g;--re>0;)p[We({r:w+z,c:T+re})]=xt(g);k.e.c<=T&&(k.e.c=T)}re=parseInt(v["number-columns-repeated"]||"1",10),T+=re-1,re=0,g={},x="",_=[]}C={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((a=i.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((a=i.pop())[0]!==m[3])throw"Bad state: "+a;E.t=x,_.length&&(E.R=_),E.a=I,L.push(E)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);I="",A=0,x="",y=0,_=[];break;case"creator":m[1]==="/"?I=n.slice(A,m.index):A=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((a=i.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);x="",y=0,_=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(F[o.name]=s,(a=i.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&(s="",o=He(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":l=He(m[0],!1),s+=Wm[m[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":l=He(m[0],!1),s+=Wm[m[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":s+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":l=He(m[0],!1),j=Mf(l["cell-range-address"]);var Y={Name:l.name,Ref:j[0]+"!"+j[1]};P&&(Y.Sheet=u.length),se.Names.push(Y);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!v||!v["string-value"])){var ie=GR(n.slice(y,m.index));x=(x.length>0?x+`
`:"")+ie[0]}else He(m[0],!1),y=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{j=Mf(He(m[0])["target-range-address"]),h[j[0]]["!autofilter"]={ref:j[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(C=He(m[0],!1),!C.href)break;C.Target=tt(C.href),delete C.href,C.Target.charAt(0)=="#"&&C.Target.indexOf(".")>-1?(j=Mf(C.Target.slice(1)),C.Target="#"+j[0]+"!"+j[1]):C.Target.match(/^\.\.[\\\/]/)&&(C.Target=C.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var N={Sheets:h,SheetNames:u,Workbook:se};return r.bookSheets&&delete N.Sheets,N}function Hm(e,t){t=t||{},en(e,"META-INF/manifest.xml")&&_4(Wt(e,"META-INF/manifest.xml"),t);var r=zr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=D_(ut(r),t);return en(e,"meta.xml")&&(n.Props=ky(Wt(e,"meta.xml"))),n}function zm(e,t){return D_(e,t)}var YR=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+el({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Bt+t}}(),Vm=function(){var e=function(a){return lt(a).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,l,o){var s=[];s.push('      <table:table table:name="'+lt(l.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,d=0,f=jr(a["!ref"]||"A1"),h=a["!merges"]||[],u=0,p=Array.isArray(a);if(a["!cols"])for(d=0;d<=f.e.c;++d)s.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var m="",g=a["!rows"]||[];for(c=0;c<f.s.r;++c)m=g[c]?' table:style-name="ro'+g[c].ods+'"':"",s.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=f.e.r;++c){for(m=g[c]?' table:style-name="ro'+g[c].ods+'"':"",s.push("        <table:table-row"+m+`>
`),d=0;d<f.s.c;++d)s.push(t);for(;d<=f.e.c;++d){var v=!1,x={},y="";for(u=0;u!=h.length;++u)if(!(h[u].s.c>d)&&!(h[u].s.r>c)&&!(h[u].e.c<d)&&!(h[u].e.r<c)){(h[u].s.c!=d||h[u].s.r!=c)&&(v=!0),x["table:number-columns-spanned"]=h[u].e.c-h[u].s.c+1,x["table:number-rows-spanned"]=h[u].e.r-h[u].s.r+1;break}if(v){s.push(r);continue}var _=We({r:c,c:d}),w=p?(a[c]||[])[d]:a[_];if(w&&w.f&&(x["table:formula"]=lt(pN(w.f)),w.F&&w.F.slice(0,_.length)==_)){var T=jr(w.F);x["table:number-matrix-columns-spanned"]=T.e.c-T.s.c+1,x["table:number-matrix-rows-spanned"]=T.e.r-T.s.r+1}if(!w){s.push(t);continue}switch(w.t){case"b":y=w.v?"TRUE":"FALSE",x["office:value-type"]="boolean",x["office:boolean-value"]=w.v?"true":"false";break;case"n":y=w.w||String(w.v||0),x["office:value-type"]="float",x["office:value"]=w.v||0;break;case"s":case"str":y=w.v==null?"":w.v,x["office:value-type"]="string";break;case"d":y=w.w||vt(w.v).toISOString(),x["office:value-type"]="date",x["office:date-value"]=vt(w.v).toISOString(),x["table:style-name"]="ce1";break;default:s.push(t);continue}var k=e(y);if(w.l&&w.l.Target){var O=w.l.Target;O=O.charAt(0)=="#"?"#"+gN(O.slice(1)):O,O.charAt(0)!="#"&&!O.match(/^\w+:/)&&(O="../"+O),k=Te("text:a",k,{"xlink:href":O.replace(/&/g,"&amp;")})}s.push("          "+Te("table:table-cell",Te("text:p",k,{}),x)+`
`)}s.push(`        </table:table-row>
`)}return s.push(`      </table:table>
`),s.join("")},i=function(a,l){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(c){return l.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var d=0;d<c["!cols"].length;++d)if(c["!cols"][d]){var f=c["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Di(f),f.ods=o;var h=c["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),a.push(`  </style:style>
`),++o}}});var s=0;l.SheetNames.map(function(c){return l.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var d=0;d<c["!rows"].length;++d)if(c["!rows"][d]){c["!rows"][d].ods=s;var f=c["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+s+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),a.push(`  </style:style>
`),++s}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(l,o){var s=[Bt],c=el({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=el({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(s.push("<office:document"+c+d+`>
`),s.push(Sy().replace(/office:document-meta/g,"office:meta"))):s.push("<office:document-content"+c+`>
`),i(s,l),s.push(`  <office:body>
`),s.push(`    <office:spreadsheet>
`);for(var f=0;f!=l.SheetNames.length;++f)s.push(n(l.Sheets[l.SheetNames[f]],l,f));return s.push(`    </office:spreadsheet>
`),s.push(`  </office:body>
`),o.bookType=="fods"?s.push("</office:document>"):s.push("</office:document-content>"),s.join("")}}();function R_(e,t){if(t.bookType=="fods")return Vm(e,t);var r=vd(),n="",i=[],a=[];return n="mimetype",Ge(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ge(r,n,Vm(e,t)),i.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Ge(r,n,YR(e,t)),i.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Ge(r,n,Bt+Sy()),i.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Ge(r,n,k4(a)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ge(r,n,w4(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ya(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function a0(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ut(Bi(e))}function KR(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Hr(Mn(e))}function qR(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Ii(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function Xm(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function JR(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function QR(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;i>=1;++a,i/=256)e[t+a]=i&255;e[t+15]|=r>=0?0:128}function ll(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function at(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Dt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function nt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=ll(e,r),a=i&7;i=Math.floor(i/8);var l=0,o;if(i==0)break;switch(a){case 0:{for(var s=r[0];e[r[0]++]>=128;);o=e.slice(s,r[0])}break;case 5:l=4,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=ll(e,r),o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:a};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function nr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(at(n*8+i.type)),i.type==2&&t.push(at(i.data.length)),t.push(i.data))})}),Ii(t)}function Vd(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Qr(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=ll(e,n),a=nt(e.slice(n[0],n[0]+i));n[0]+=i;var l={id:Dt(a[1][0].data),messages:[]};a[2].forEach(function(o){var s=nt(o.data),c=Dt(s[3][0].data);l.messages.push({meta:s,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=a[3])!=null&&t[0]&&(l.merge=Dt(a[3][0].data)>>>0>0),r.push(l)}return r}function ja(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:at(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:at(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(l){i.push(l.data),l.meta[3]=[{type:0,data:at(l.data.length)}],n[2].push({data:nr(l.meta),type:2})});var a=nr(n);t.push(at(a.length)),t.push(a),i.forEach(function(l){return t.push(l)})}),Ii(t)}function ZR(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=ll(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=t[r[0]],o>1&&(l|=t[r[0]+1]<<8),o>2&&(l|=t[r[0]+2]<<16),o>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}i.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var s=0,c=0;if(a==1?(c=(t[r[0]]>>2&7)+4,s=(t[r[0]++]&224)<<3,s|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,a==2?(s=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(s=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Ii(i)],s==0)throw new Error("Invalid offset 0");if(s>i[0].length)throw new Error("Invalid offset beyond length");if(c>=s)for(i.push(i[0].slice(-s)),c-=s;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-s,-s+c))}}var d=Ii(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Zr(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(ZR(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ii(t)}function La(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var a=at(n),l=a.length;t.push(a),n<=60?(l++,t.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),l+=n,i[0]=0,i[1]=l&255,i[2]=l>>8&255,i[3]=l>>16&255,r+=n}return Ii(t)}function eI(e,t,r,n){var i=ya(e),a=i.getUint32(4,!0),l=(n>1?12:8)+Xm(a&(n>1?3470:398))*4,o=-1,s=-1,c=NaN,d=new Date(2001,0,1);a&512&&(o=i.getUint32(l,!0),l+=4),l+=Xm(a&(n>1?12288:4096))*4,a&16&&(s=i.getUint32(l,!0),l+=4),a&32&&(c=i.getFloat64(l,!0),l+=8),a&64&&(d.setTime(d.getTime()+i.getFloat64(l,!0)*1e3),l+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[s]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(s>-1)f={t:"s",v:t[s]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function tI(e,t,r){var n=ya(e),i=n.getUint32(8,!0),a=12,l=-1,o=-1,s=NaN,c=NaN,d=new Date(2001,0,1);i&1&&(s=JR(e,a),a+=16),i&2&&(c=n.getFloat64(a,!0),a+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(o=n.getUint32(a,!0),a+=4),i&16&&(l=n.getUint32(a,!0),a+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:s};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:s};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return f}function Lf(e,t){var r=new Uint8Array(32),n=ya(r),i=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,QR(r,i,e.v),a|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),a|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),a|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,i)}function Bf(e,t){var r=new Uint8Array(32),n=ya(r),i=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),a|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),a|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),a|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,i)}function rI(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return eI(e,t,r,e[0]);case 5:return tI(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function dr(e){var t=nt(e);return ll(t[1][0].data)}function $m(e,t){var r=nt(t.data),n=Dt(r[1][0].data),i=r[3],a=[];return(i||[]).forEach(function(l){var o=nt(l.data),s=Dt(o[1][0].data)>>>0;switch(n){case 1:a[s]=a0(o[3][0].data);break;case 8:{var c=e[dr(o[9][0].data)][0],d=nt(c.data),f=e[dr(d[1][0].data)][0],h=Dt(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var u=nt(f.data);a[s]=u[3].map(function(p){return a0(p.data)}).join("")}break}}),a}function nI(e,t){var r,n,i,a,l,o,s,c,d,f,h,u,p,m,g=nt(e),v=Dt(g[1][0].data)>>>0,x=Dt(g[2][0].data)>>>0,y=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&Dt(g[8][0].data)>0||!1,_,w;if((a=(i=g[7])==null?void 0:i[0])!=null&&a.data&&t!=0)_=(o=(l=g[7])==null?void 0:l[0])==null?void 0:o.data,w=(c=(s=g[6])==null?void 0:s[0])==null?void 0:c.data;else if((f=(d=g[4])==null?void 0:d[0])!=null&&f.data&&t!=1)_=(u=(h=g[4])==null?void 0:h[0])==null?void 0:u.data,w=(m=(p=g[3])==null?void 0:p[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var T=y?4:1,k=ya(_),O=[],F=0;F<_.length/2;++F){var M=k.getUint16(F*2,!0);M<65535&&O.push([F,M])}if(O.length!=x)throw"Expected ".concat(x," cells, found ").concat(O.length);var V=[];for(F=0;F<O.length-1;++F)V[O[F][0]]=w.subarray(O[F][1]*T,O[F+1][1]*T);return O.length>=1&&(V[O[O.length-1][0]]=w.subarray(O[O.length-1][1]*T)),{R:v,cells:V}}function iI(e,t){var r,n=nt(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Dt(n[7][0].data)>>>0>0?1:0:-1,a=Vd(n[5],function(l){return nI(l,i)});return{nrows:Dt(n[4][0].data)>>>0,data:a.reduce(function(l,o){return l[o.R]||(l[o.R]=[]),o.cells.forEach(function(s,c){if(l[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));l[o.R][c]=s}),l},[])}}function aI(e,t,r){var n,i=nt(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Dt(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(Dt(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=$e(a);var l=nt(i[4][0].data),o=$m(e,e[dr(l[4][0].data)][0]),s=(n=l[17])!=null&&n[0]?$m(e,e[dr(l[17][0].data)][0]):[],c=nt(l[3][0].data),d=0;c[1].forEach(function(f){var h=nt(f.data),u=e[dr(h[2][0].data)][0],p=Dt(u.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var m=iI(e,u);m.data.forEach(function(g,v){g.forEach(function(x,y){var _=We({r:d+v,c:y}),w=rI(x,o,s);w&&(r[_]=w)})}),d+=m.nrows})}function sI(e,t){var r=nt(t.data),n={"!ref":"A1"},i=e[dr(r[2][0].data)],a=Dt(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return aI(e,i[0],n),n}function oI(e,t){var r,n=nt(t.data),i={name:(r=n[1])!=null&&r[0]?a0(n[1][0].data):"",sheets:[]},a=Vd(n[2],dr);return a.forEach(function(l){e[l].forEach(function(o){var s=Dt(o.meta[1][0].data);s==6e3&&i.sheets.push(sI(e,o))})}),i}function lI(e,t){var r=Kd(),n=nt(t.data),i=Vd(n[1],dr);if(i.forEach(function(a){e[a].forEach(function(l){var o=Dt(l.meta[1][0].data);if(o==2){var s=oI(e,l);s.sheets.forEach(function(c,d){qd(r,c,d==0?s.name:s.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Uf(e){var t,r,n,i,a={},l=[];if(e.FullPaths.forEach(function(s){if(s.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(s){if(s.name.match(/\.iwa$/)){var c;try{c=Zr(s.content)}catch(f){return console.log("?? "+s.content.length+" "+(f.message||f))}var d;try{d=Qr(c)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){a[f.id]=f.messages,l.push(f.id)})}}),!l.length)throw new Error("File has no messages");var o=((i=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Dt(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||l.forEach(function(s){a[s].forEach(function(c){var d=Dt(c.meta[1][0].data)>>>0;if(d==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return lI(a,o)}function cI(e,t,r){var n,i,a,l;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(a=e[8])==null?void 0:a[0])==null?void 0:l.data)&&Dt(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var s=0,c=ya(e[7][0].data),d=0,f=[],h=ya(e[4][0].data),u=0,p=[],m=0;m<t.length;++m){if(t[m]==null){c.setUint16(m*2,65535,!0),h.setUint16(m*2,65535);continue}c.setUint16(m*2,d,!0),h.setUint16(m*2,u,!0);var g,v;switch(typeof t[m]){case"string":g=Lf({t:"s",v:t[m]},r),v=Bf({t:"s",v:t[m]},r);break;case"number":g=Lf({t:"n",v:t[m]},r),v=Bf({t:"n",v:t[m]},r);break;case"boolean":g=Lf({t:"b",v:t[m]},r),v=Bf({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}f.push(g),d+=g.length,p.push(v),u+=v.length,++s}for(e[2][0].data=at(s);m<e[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),h.setUint16(m*2,65535,!0);return e[6][0].data=Ii(f),e[3][0].data=Ii(p),s}function uI(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=jr(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat($e(n)));var a=cu(r,{range:n,header:1}),l=["~Sh33tJ5~"];a.forEach(function(I){return I.forEach(function(A){typeof A=="string"&&l.push(A)})});var o={},s=[],c=Ie.read(t.numbers,{type:"base64"});c.FileIndex.map(function(I,A){return[I,c.FullPaths[A]]}).forEach(function(I){var A=I[0],b=I[1];if(A.type==2&&A.name.match(/\.iwa/)){var P=A.content,R=Zr(P),W=Qr(R);W.forEach(function(z){s.push(z.id),o[z.id]={deps:[],location:b,type:Dt(z.messages[0].meta[1][0].data)}})}}),s.sort(function(I,A){return I-A});var d=s.filter(function(I){return I>1}).map(function(I){return[I,at(I)]});c.FileIndex.map(function(I,A){return[I,c.FullPaths[A]]}).forEach(function(I){var A=I[0];if(I[1],!!A.name.match(/\.iwa/)){var b=Qr(Zr(A.content));b.forEach(function(P){P.messages.forEach(function(R){d.forEach(function(W){P.messages.some(function(z){return Dt(z.meta[1][0].data)!=11006&&qR(z.data,W[1])})&&o[W[0]].deps.push(P.id)})})})}});for(var f=Ie.find(c,o[1].location),h=Qr(Zr(f.content)),u,p=0;p<h.length;++p){var m=h[p];m.id==1&&(u=m)}var g=dr(nt(u.messages[0].data)[1][0].data);for(f=Ie.find(c,o[g].location),h=Qr(Zr(f.content)),p=0;p<h.length;++p)m=h[p],m.id==g&&(u=m);for(g=dr(nt(u.messages[0].data)[2][0].data),f=Ie.find(c,o[g].location),h=Qr(Zr(f.content)),p=0;p<h.length;++p)m=h[p],m.id==g&&(u=m);for(g=dr(nt(u.messages[0].data)[2][0].data),f=Ie.find(c,o[g].location),h=Qr(Zr(f.content)),p=0;p<h.length;++p)m=h[p],m.id==g&&(u=m);var v=nt(u.messages[0].data);{v[6][0].data=at(n.e.r+1),v[7][0].data=at(n.e.c+1);var x=dr(v[46][0].data),y=Ie.find(c,o[x].location),_=Qr(Zr(y.content));{for(var w=0;w<_.length&&_[w].id!=x;++w);if(_[w].id!=x)throw"Bad ColumnRowUIDMapArchive";var T=nt(_[w].messages[0].data);T[1]=[],T[2]=[],T[3]=[];for(var k=0;k<=n.e.c;++k){var O=[];O[1]=O[2]=[{type:0,data:at(k+420690)}],T[1].push({type:2,data:nr(O)}),T[2].push({type:0,data:at(k)}),T[3].push({type:0,data:at(k)})}T[4]=[],T[5]=[],T[6]=[];for(var F=0;F<=n.e.r;++F)O=[],O[1]=O[2]=[{type:0,data:at(F+726270)}],T[4].push({type:2,data:nr(O)}),T[5].push({type:0,data:at(F)}),T[6].push({type:0,data:at(F)});_[w].messages[0].data=nr(T)}y.content=La(ja(_)),y.size=y.content.length,delete v[46];var M=nt(v[4][0].data);{M[7][0].data=at(n.e.r+1);var V=nt(M[1][0].data),X=dr(V[2][0].data);y=Ie.find(c,o[X].location),_=Qr(Zr(y.content));{if(_[0].id!=X)throw"Bad HeaderStorageBucket";var q=nt(_[0].messages[0].data);for(F=0;F<a.length;++F){var ae=nt(q[2][0].data);ae[1][0].data=at(F),ae[4][0].data=at(a[F].length),q[2][F]={type:q[2][0].type,data:nr(ae)}}_[0].messages[0].data=nr(q)}y.content=La(ja(_)),y.size=y.content.length;var ne=dr(M[2][0].data);y=Ie.find(c,o[ne].location),_=Qr(Zr(y.content));{if(_[0].id!=ne)throw"Bad HeaderStorageBucket";for(q=nt(_[0].messages[0].data),k=0;k<=n.e.c;++k)ae=nt(q[2][0].data),ae[1][0].data=at(k),ae[4][0].data=at(n.e.r+1),q[2][k]={type:q[2][0].type,data:nr(ae)};_[0].messages[0].data=nr(q)}y.content=La(ja(_)),y.size=y.content.length;var re=dr(M[4][0].data);(function(){for(var I=Ie.find(c,o[re].location),A=Qr(Zr(I.content)),b,P=0;P<A.length;++P){var R=A[P];R.id==re&&(b=R)}var W=nt(b.messages[0].data);{W[3]=[];var z=[];l.forEach(function(N,Q){z[1]=[{type:0,data:at(Q)}],z[2]=[{type:0,data:at(1)}],z[3]=[{type:2,data:KR(N)}],W[3].push({type:2,data:nr(z)})})}b.messages[0].data=nr(W);var Y=ja(A),ie=La(Y);I.content=ie,I.size=I.content.length})();var le=nt(M[3][0].data);{var se=le[1][0];delete le[2];var C=nt(se.data);{var j=dr(C[2][0].data);(function(){for(var I=Ie.find(c,o[j].location),A=Qr(Zr(I.content)),b,P=0;P<A.length;++P){var R=A[P];R.id==j&&(b=R)}var W=nt(b.messages[0].data);{delete W[6],delete le[7];var z=new Uint8Array(W[5][0].data);W[5]=[];for(var Y=0,ie=0;ie<=n.e.r;++ie){var N=nt(z);Y+=cI(N,a[ie],l),N[1][0].data=at(ie),W[5].push({data:nr(N),type:2})}W[1]=[{type:0,data:at(n.e.c+1)}],W[2]=[{type:0,data:at(n.e.r+1)}],W[3]=[{type:0,data:at(Y)}],W[4]=[{type:0,data:at(n.e.r+1)}]}b.messages[0].data=nr(W);var Q=ja(A),H=La(Q);I.content=H,I.size=I.content.length})()}se.data=nr(C)}M[3][0].data=nr(le)}v[4][0].data=nr(M)}u.messages[0].data=nr(v);var L=ja(h),E=La(L);return f.content=E,f.size=f.content.length,c}function I_(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Xd(e){I_([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function $d(e){I_([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function fI(e){return qe.WS.indexOf(e)>-1?"sheet":e==qe.CS?"chart":e==qe.DS?"dialog":e==qe.MS?"macro":e&&e.length?e:"sheet"}function hI(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,fI(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function dI(e,t,r,n,i,a,l,o,s,c,d,f){try{a[n]=wo(zr(e,r,!0),t);var h=Wt(e,t),u;switch(o){case"sheet":u=I5(h,t,i,s,a[n],c,d,f);break;case"chart":if(u=M5(h,t,i,s,a[n],c,d,f),!u||!u["!drawel"])break;var p=io(u["!drawel"].Target,t),m=rl(p),g=SF(zr(e,p,!0),wo(zr(e,m,!0),p)),v=io(g,p),x=rl(v);u=c5(zr(e,v,!0),v,s,wo(zr(e,x,!0),v),c,u);break;case"macro":u=j5(h,t,i,s,a[n],c,d,f);break;case"dialog":u=L5(h,t,i,s,a[n],c,d,f);break;default:throw new Error("Unrecognized sheet type "+o)}l[n]=u;var y=[];a&&a[n]&&Rt(a[n]).forEach(function(_){var w="";if(a[n][_].Type==qe.CMNT){w=io(a[n][_].Target,t);var T=H5(Wt(e,w,!0),w,s);if(!T||!T.length)return;Pm(u,T,!1)}a[n][_].Type==qe.TCMNT&&(w=io(a[n][_].Target,t),y=y.concat(bF(Wt(e,w,!0),s)))}),y&&y.length&&Pm(u,y,!0,s.people||[])}catch(_){if(s.WTF)throw _}}function qr(e){return e.charAt(0)=="/"?e.slice(1):e}function pI(e,t){if(Rs(),t=t||{},Xd(t),en(e,"META-INF/manifest.xml")||en(e,"objectdata.xml"))return Hm(e,t);if(en(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Uf<"u"){if(e.FileIndex)return Uf(e);var r=Ie.utils.cfb_new();return Qg(e).forEach(function(ae){Ge(r,ae,TE(e,ae))}),Uf(r)}throw new Error("Unsupported NUMBERS file")}if(!en(e,"[Content_Types].xml"))throw en(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):en(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Qg(e),i=x4(zr(e,"[Content_Types].xml")),a=!1,l,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Wt(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Wt(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var s={},c={};if(!t.bookSheets&&!t.bookProps){if(So=[],i.sst)try{So=W5(Wt(e,qr(i.sst)),i.sst,t)}catch(ae){if(t.WTF)throw ae}t.cellStyles&&i.themes.length&&(s=U5(zr(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=B5(Wt(e,qr(i.style)),i.style,s,t))}i.links.map(function(ae){try{var ne=wo(zr(e,rl(qr(ae))),ae);return V5(Wt(e,qr(ae)),ne,ae,t)}catch{}});var d=R5(Wt(e,qr(i.workbooks[0])),i.workbooks[0],t),f={},h="";i.coreprops.length&&(h=Wt(e,qr(i.coreprops[0]),!0),h&&(f=ky(h)),i.extprops.length!==0&&(h=Wt(e,qr(i.extprops[0]),!0),h&&T4(h,f,t)));var u={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(h=zr(e,qr(i.custprops[0]),!0),h&&(u=E4(h,t)));var p={};if((t.bookSheets||t.bookProps)&&(d.Sheets?l=d.Sheets.map(function(ne){return ne.name}):f.Worksheets&&f.SheetNames.length>0&&(l=f.SheetNames),t.bookProps&&(p.Props=f,p.Custprops=u),t.bookSheets&&typeof l<"u"&&(p.SheetNames=l),t.bookSheets?p.SheetNames:t.bookProps))return p;l={};var m={};t.bookDeps&&i.calcchain&&(m=z5(Wt(e,qr(i.calcchain)),i.calcchain));var g=0,v={},x,y;{var _=d.Sheets;f.Worksheets=_.length,f.SheetNames=[];for(var w=0;w!=_.length;++w)f.SheetNames[w]=_[w].name}var T=a?"bin":"xml",k=i.workbooks[0].lastIndexOf("/"),O=(i.workbooks[0].slice(0,k+1)+"_rels/"+i.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");en(e,O)||(O="xl/_rels/workbook."+T+".rels");var F=wo(zr(e,O,!0),O.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=X5(Wt(e,qr(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=CF(Wt(e,qr(i.people[0])),t)),F&&(F=hI(F,d.Sheets));var M=Wt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var V="sheet";if(F&&F[g]?(x="xl/"+F[g][1].replace(/[\/]?xl\//,""),en(e,x)||(x=F[g][1]),en(e,x)||(x=O.replace(/_rels\/.*$/,"")+F[g][1]),V=F[g][2]):(x="xl/worksheets/sheet"+(g+1-M)+"."+T,x=x.replace(/sheet0\./,"sheet.")),y=x.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var X=!1,q=0;q!=t.sheets.length;++q)typeof t.sheets[q]=="number"&&t.sheets[q]==g&&(X=1),typeof t.sheets[q]=="string"&&t.sheets[q].toLowerCase()==f.SheetNames[g].toLowerCase()&&(X=1);if(!X)continue e}}dI(e,x,y,f.SheetNames[g],g,v,l,V,t,d,s,c)}return p={Directory:i,Workbook:d,Props:f,Custprops:u,Deps:m,Sheets:l,SheetNames:f.SheetNames,Strings:So,Styles:c,Themes:s,SSF:xt(Be)},t&&t.bookFiles&&(e.files?(p.keys=n,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(ae,ne){ae=ae.replace(/^Root Entry[\/]/,""),p.keys.push(ae),p.files[ae]=e.FileIndex[ne]}))),t&&t.bookVBA&&(i.vba.length>0?p.vbaraw=Wt(e,qr(i.vba[0]),!0):i.defaults&&i.defaults.bin===RF&&(p.vbaraw=Wt(e,"xl/vbaProject.bin",!0))),p}function gI(e,t){var r=t||{},n="Workbook",i=Ie.find(e,n);try{if(n="/!DataSpaces/Version",i=Ie.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(XO(i.content),n="/!DataSpaces/DataSpaceMap",i=Ie.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=GO(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Ie.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=YO(i.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Ie.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);qO(i.content)}catch{}if(n="/EncryptionInfo",i=Ie.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=JO(i.content);if(n="/EncryptedPackage",i=Ie.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function mI(e,t){return t.bookType=="ods"?R_(e,t):t.bookType=="numbers"?uI(e,t):t.bookType=="xlsb"?vI(e,t):xI(e,t)}function vI(e,t){is=1024,e&&!e.SSF&&(e.SSF=xt(Be)),e&&e.SSF&&(Rs(),Iu(e.SSF),t.revssf=ju(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ko?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=l_.indexOf(t.bookType)>-1,i=Pd();$d(t=t||{});var a=vd(),l="",o=0;if(t.cellXfs=[],Wi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Ge(a,l,by(e.Props,t)),i.coreprops.push(l),ot(t.rels,2,l,qe.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var s=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&s.push(e.SheetNames[c]);e.Props.SheetNames=s}for(e.Props.Worksheets=e.Props.SheetNames.length,Ge(a,l,Ey(e.Props)),i.extprops.push(l),ot(t.rels,3,l,qe.EXT_PROPS),e.Custprops!==e.Props&&Rt(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Ge(a,l,Ay(e.Custprops)),i.custprops.push(l),ot(t.rels,4,l,qe.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,Ge(a,l,G5(o-1,l,t,e,d)),i.sheets.push(l),ot(t.wbrels,-1,"worksheets/sheet"+o+"."+r,qe.WS[0])}if(f){var u=f["!comments"],p=!1,m="";u&&u.length>0&&(m="xl/comments"+o+"."+r,Ge(a,m,q5(u,m)),i.comments.push(m),ot(d,-1,"../comments"+o+"."+r,qe.CMNT),p=!0),f["!legacy"]&&p&&Ge(a,"xl/drawings/vmlDrawing"+o+".vml",s_(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Ge(a,rl(l),ps(d))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Ge(a,l,K5(t.Strings,l,t)),i.strs.push(l),ot(t.wbrels,-1,"sharedStrings."+r,qe.SST)),l="xl/workbook."+r,Ge(a,l,$5(e,l)),i.workbooks.push(l),ot(t.rels,1,l,qe.WB),l="xl/theme/theme1.xml",Ge(a,l,jd(e.Themes,t)),i.themes.push(l),ot(t.wbrels,-1,"theme/theme1.xml",qe.THEME),l="xl/styles."+r,Ge(a,l,Y5(e,l,t)),i.styles.push(l),ot(t.wbrels,-1,"styles."+r,qe.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Ge(a,l,e.vbaraw),i.vba.push(l),ot(t.wbrels,-1,"vbaProject.bin",qe.VBA)),l="xl/metadata."+r,Ge(a,l,J5(l)),i.metadata.push(l),ot(t.wbrels,-1,"metadata."+r,qe.XLMETA),Ge(a,"[Content_Types].xml",wy(i,t)),Ge(a,"_rels/.rels",ps(t.rels)),Ge(a,"xl/_rels/workbook."+r+".rels",ps(t.wbrels)),delete t.revssf,delete t.ssf,a}function xI(e,t){is=1024,e&&!e.SSF&&(e.SSF=xt(Be)),e&&e.SSF&&(Rs(),Iu(e.SSF),t.revssf=ju(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ko?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=l_.indexOf(t.bookType)>-1,i=Pd();$d(t=t||{});var a=vd(),l="",o=0;if(t.cellXfs=[],Wi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Ge(a,l,by(e.Props,t)),i.coreprops.push(l),ot(t.rels,2,l,qe.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var s=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&s.push(e.SheetNames[c]);e.Props.SheetNames=s}e.Props.Worksheets=e.Props.SheetNames.length,Ge(a,l,Ey(e.Props)),i.extprops.push(l),ot(t.rels,3,l,qe.EXT_PROPS),e.Custprops!==e.Props&&Rt(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Ge(a,l,Ay(e.Custprops)),i.custprops.push(l),ot(t.rels,4,l,qe.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],u=(h||{})["!type"]||"sheet";switch(u){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,Ge(a,l,y_(o-1,t,e,f)),i.sheets.push(l),ot(t.wbrels,-1,"worksheets/sheet"+o+"."+r,qe.WS[0])}if(h){var p=h["!comments"],m=!1,g="";if(p&&p.length>0){var v=!1;p.forEach(function(x){x[1].forEach(function(y){y.T==!0&&(v=!0)})}),v&&(g="xl/threadedComments/threadedComment"+o+"."+r,Ge(a,g,TF(p,d,t)),i.threadedcomments.push(g),ot(f,-1,"../threadedComments/threadedComment"+o+"."+r,qe.TCMNT)),g="xl/comments"+o+"."+r,Ge(a,g,o_(p)),i.comments.push(g),ot(f,-1,"../comments"+o+"."+r,qe.CMNT),m=!0}h["!legacy"]&&m&&Ge(a,"xl/drawings/vmlDrawing"+o+".vml",s_(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Ge(a,rl(l),ps(f))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Ge(a,l,Yy(t.Strings,t)),i.strs.push(l),ot(t.wbrels,-1,"sharedStrings."+r,qe.SST)),l="xl/workbook."+r,Ge(a,l,b_(e)),i.workbooks.push(l),ot(t.rels,1,l,qe.WB),l="xl/theme/theme1.xml",Ge(a,l,jd(e.Themes,t)),i.themes.push(l),ot(t.wbrels,-1,"theme/theme1.xml",qe.THEME),l="xl/styles."+r,Ge(a,l,r_(e,t)),i.styles.push(l),ot(t.wbrels,-1,"styles."+r,qe.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Ge(a,l,e.vbaraw),i.vba.push(l),ot(t.wbrels,-1,"vbaProject.bin",qe.VBA)),l="xl/metadata."+r,Ge(a,l,a_()),i.metadata.push(l),ot(t.wbrels,-1,"metadata."+r,qe.XLMETA),d.length>1&&(l="xl/persons/person.xml",Ge(a,l,EF(d)),i.people.push(l),ot(t.wbrels,-1,"persons/person.xml",qe.PEOPLE)),Ge(a,"[Content_Types].xml",wy(i,t)),Ge(a,"_rels/.rels",ps(t.rels)),Ge(a,"xl/_rels/workbook."+r+".rels",ps(t.wbrels)),delete t.revssf,delete t.ssf,a}function Gd(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Gr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function yI(e,t){return Ie.find(e,"EncryptedPackage")?gI(e,t):A_(e,t)}function _I(e,t){var r,n=e,i=t||{};return i.type||(i.type=Ye&&Buffer.isBuffer(e)?"buffer":"base64"),r=q1(n,i),pI(r,i)}function M_(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return n0(e.slice(r),t);default:break e}return Cs.to_workbook(e,t)}function wI(e,t){var r="",n=Gd(e,t);switch(t.type){case"base64":r=Gr(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ga(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=ut(r)),t.type="binary",M_(r,t)}function SI(e,t){var r=e;return t.type=="base64"&&(r=Gr(r)),r=qo.utils.decode(1200,r.slice(2),"str"),t.type="binary",M_(r,t)}function kI(e){return e.match(/[^\x00-\x7F]/)?Mn(e):e}function Wf(e,t,r,n){return n?(r.type="string",Cs.to_workbook(e,r)):Cs.to_workbook(t,r)}function s0(e,t){hd();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return s0(new Uint8Array(e),(r=xt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ms={},r.dateNF&&(ms.dateNF=r.dateNF),r.type||(r.type=Ye&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ye?"buffer":"binary",n=vE(e),typeof Uint8Array<"u"&&!Ye&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=kI(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),o=new Uint8Array(l);if(o.foo="bar",!o.foo)return r=xt(r),r.type="array",s0(dd(n),r)}switch((i=Gd(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return yI(Ie.read(n,r),r);break;case 9:if(i[1]<=8)return A_(n,r);break;case 60:return n0(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return AO(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return $y.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?_I(n,r):Wf(e,n,r,a);case 239:return i[3]===60?n0(n,r):Wf(e,n,r,a);case 255:if(i[1]===254)return SI(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return oa.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return oa.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return r0.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return Zy.to_workbook(n,r);break;case 10:case 13:case 32:return wI(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return EO.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?r0.to_workbook(n,r):Wf(e,n,r,a)}function j_(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return ml(t.file,Ie.write(e,{type:Ye?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ie.write(e,t)}function bI(e,t){var r=xt(t||{}),n=mI(e,r);return TI(n,r)}function TI(e,t){var r={},n=Ye?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Ie.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Ru(i))}return t.password&&typeof encrypt_agile<"u"?j_(encrypt_agile(i,t.password),t):t.type==="file"?ml(t.file,i):t.type=="string"?ut(i):i}function CI(e,t){var r=t||{},n=kR(e,r);return j_(n,r)}function Pn(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Jo(Mn(n));case"binary":return Mn(n);case"string":return e;case"file":return ml(t.file,n,"utf8");case"buffer":return Ye?si(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Pn(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function EI(e,t){switch(t.type){case"base64":return Jo(e);case"binary":return e;case"string":return e;case"file":return ml(t.file,e,"binary");case"buffer":return Ye?si(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function sc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Jo(r):t.type=="string"?ut(r):r;case"file":return ml(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function L_(e,t){hd(),y5(e);var r=xt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=L_(e,r);return r.type="array",Ru(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Pn(mR(e,r),r);case"slk":case"sylk":return Pn(Xy.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return Pn(F_(e.Sheets[e.SheetNames[i]],r),r);case"txt":return EI(B_(e.Sheets[e.SheetNames[i]],r),r);case"csv":return Pn(Yd(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return Pn($y.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return sc(r0.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return Pn(Cs.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return Pn(Zy.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return Pn(Gy.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return Pn(R_(e,r),r);case"wk1":return sc(oa.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return sc(oa.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),sc(O_(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),CI(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return bI(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function AI(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function OI(e,t,r){var n={};return n.type="file",n.file=t,AI(n),L_(e,n)}function FI(e,t,r,n,i,a,l,o){var s=Lt(r),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!l||e[r])for(var u=t.s.c;u<=t.e.c;++u){var p=l?e[r][u]:e[n[u]+s];if(p===void 0||p.t===void 0){if(c===void 0)continue;a[u]!=null&&(h[a[u]]=c);continue}var m=p.v;switch(p.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(a[u]!=null){if(m==null)if(p.t=="e"&&m===null)h[a[u]]=null;else if(c!==void 0)h[a[u]]=c;else if(d&&m===null)h[a[u]]=null;else continue;else h[a[u]]=d&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?m:ni(p,m,o);m!=null&&(f=!1)}}return{row:h,isempty:f}}function cu(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],l=0,o="",s={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},d=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof d){case"string":s=rt(d);break;case"number":s=rt(e["!ref"]),s.s.r=d;break;default:s=d}n>0&&(i=0);var f=Lt(s.s.r),h=[],u=[],p=0,m=0,g=Array.isArray(e),v=s.s.r,x=0,y={};g&&!e[v]&&(e[v]=[]);var _=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(x=s.s.c;x<=s.e.c;++x)if(!(_[x]||{}).hidden)switch(h[x]=Ct(x),r=g?e[v][x]:e[h[x]+f],n){case 1:a[x]=x-s.s.c;break;case 2:a[x]=h[x];break;case 3:a[x]=c.header[x-s.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=ni(r,null,c),m=y[l]||0,!m)y[l]=1;else{do o=l+"_"+m++;while(y[o]);y[l]=m,y[o]=1}a[x]=o}for(v=s.s.r+i;v<=s.e.r;++v)if(!(w[v]||{}).hidden){var T=FI(e,s,v,h,n,a,g,c);(T.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(u[p++]=T.row)}return u.length=p,u}var Gm=/"/g;function PI(e,t,r,n,i,a,l,o){for(var s=!0,c=[],d="",f=Lt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var u=o.dense?(e[r]||[])[h]:e[n[h]+f];if(u==null)d="";else if(u.v!=null){s=!1,d=""+(o.rawNumbers&&u.t=="n"?u.v:ni(u,null,o));for(var p=0,m=0;p!==d.length;++p)if((m=d.charCodeAt(p))===i||m===a||m===34||o.forceQuotes){d='"'+d.replace(Gm,'""')+'"';break}d=="ID"&&(d='"ID"')}else u.f!=null&&!u.F?(s=!1,d="="+u.f,d.indexOf(",")>=0&&(d='"'+d.replace(Gm,'""')+'"')):d="";c.push(d)}return o.blankrows===!1&&s?null:c.join(l)}function Yd(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=rt(e["!ref"]),a=n.FS!==void 0?n.FS:",",l=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,s=o.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],u=n.skipHidden&&e["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(h[p]||{}).hidden||(f[p]=Ct(p));for(var m=0,g=i.s.r;g<=i.e.r;++g)(u[g]||{}).hidden||(d=PI(e,i,g,f,l,s,a,n),d!=null&&(n.strip&&(d=d.replace(c,"")),(d||n.blankrows!==!1)&&r.push((m++?o:"")+d)));return delete n.dense,r.join("")}function B_(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Yd(e,t);return r}function NI(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=rt(e["!ref"]),a="",l=[],o,s=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)l[o]=Ct(o);for(var d=i.s.r;d<=i.e.r;++d)for(a=Lt(d),o=i.s.c;o<=i.e.c;++o)if(t=l[o]+a,r=c?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}s[s.length]=t+"="+n}return s}function U_(e,t,r){var n=r||{},i=+!n.skipHeader,a=e||{},l=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var s=typeof n.origin=="string"?Et(n.origin):n.origin;l=s.r,o=s.c}var c,d={s:{c:0,r:0},e:{c:o,r:l+t.length-1+i}};if(a["!ref"]){var f=rt(a["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),l==-1&&(l=f.e.r+1,d.e.r=l+t.length-1+i)}else l==-1&&(l=0,d.e.r=t.length-1+i);var h=n.header||[],u=0;t.forEach(function(m,g){Rt(m).forEach(function(v){(u=h.indexOf(v))==-1&&(h[u=h.length]=v);var x=m[v],y="z",_="",w=We({c:o+u,r:l+g+i});c=cl(a,w),x&&typeof x=="object"&&!(x instanceof Date)?a[w]=x:(typeof x=="number"?y="n":typeof x=="boolean"?y="b":typeof x=="string"?y="s":x instanceof Date?(y="d",n.cellDates||(y="n",x=Kt(x)),_=n.dateNF||Be[14]):x===null&&n.nullError&&(y="e",x=0),c?(c.t=y,c.v=x,delete c.w,delete c.R,_&&(c.z=_)):a[w]=c={t:y,v:x},_&&(c.z=_))})}),d.e.c=Math.max(d.e.c,o+h.length-1);var p=Lt(l);if(i)for(u=0;u<h.length;++u)a[Ct(u+o)+p]={t:"s",v:h[u]};return a["!ref"]=$e(d),a}function DI(e,t){return U_(null,e,t)}function cl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Et(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?cl(e,We(t)):cl(e,We({r:t,c:r||0}))}function RI(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Kd(){return{SheetNames:[],Sheets:{}}}function qd(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var l=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=l+i)!=-1;++i);}if(k_(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function II(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=RI(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function MI(e,t){return e.z=t,e}function W_(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function jI(e,t,r){return W_(e,"#"+t,r)}function LI(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function BI(e,t,r,n){for(var i=typeof t!="string"?t:rt(t),a=typeof t=="string"?t:$e(t),l=i.s.r;l<=i.e.r;++l)for(var o=i.s.c;o<=i.e.c;++o){var s=cl(e,l,o);s.t="n",s.F=a,delete s.v,l==i.s.r&&o==i.s.c&&(s.f=r,n&&(s.D=!0))}return e}var _c={encode_col:Ct,encode_row:Lt,encode_cell:We,encode_range:$e,decode_col:Td,decode_row:bd,split_cell:KE,decode_cell:Et,decode_range:jr,format_cell:ni,sheet_add_aoa:py,sheet_add_json:U_,sheet_add_dom:P_,aoa_to_sheet:Is,json_to_sheet:DI,table_to_sheet:N_,table_to_book:XR,sheet_to_csv:Yd,sheet_to_txt:B_,sheet_to_json:cu,sheet_to_html:F_,sheet_to_formulae:NI,sheet_to_row_object_array:cu,sheet_get_cell:cl,book_new:Kd,book_append_sheet:qd,book_set_sheet_visibility:II,cell_set_number_format:MI,cell_set_hyperlink:W_,cell_set_internal_link:jI,cell_add_comment:LI,sheet_set_array_formula:BI,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const UI=()=>{const e=ve.useRef(null),t=ve.useRef(null),[r,n]=ve.useState(1),[i,a]=ve.useState([]),[l,o]=ve.useState(!1),[s,c]=ve.useState({present:0,absent:0,total:0});ve.useEffect(()=>{if(!e.current)return;let m=!0;t.current&&t.current.dispose(),e.current.innerHTML="";const g=document.createElement("canvas");e.current.appendChild(g);const v=new Qe.fabric.Canvas(g,{width:1e3,height:1100,backgroundColor:"transparent",selection:!1});return t.current=v,(async()=>{const y=await d();m&&await f(y)})(),v.on("mouse:down",y=>{y.target&&y.target.data&&u(y.target)}),()=>{m=!1,v.dispose(),t.current=null}},[r]);const d=async()=>{const{data:m}=await je.from("sessions").select("*");return m?(a(m),m):[]},f=async m=>{var y;if(!t.current||!canvasRef.current)return;o(!0);const{data:g}=await je.from("seats").select("*").order("global_number",{ascending:!0}),v=new Date().toISOString().split("T")[0],{data:x}=await je.from("bookings").select("*, attendance(*), profiles(full_name)").eq("date",v).eq("session_id",r);if(g&&g.length>0&&t.current){t.current.clear();const _=Math.min(...g.map(C=>C.pos_x)),k=(1e3-(Math.max(...g.map(C=>C.pos_x+72))-_))/2-_,O=Math.min(...g.map(C=>C.pos_y)),M=Math.max(...g.map(C=>C.pos_y+72))-O,V=20-O,X=((y=e.current)==null?void 0:y.clientHeight)||0,q=Math.max(M+40,X);t.current&&t.current.setDimensions({width:1e3,height:q});const ae=new Date,ne=ae.getHours().toString().padStart(2,"0")+":"+ae.getMinutes().toString().padStart(2,"0")+":00",re=m==null?void 0:m.find(C=>ne>=C.start_time&&ne<=C.end_time),le=g.filter(C=>C.type!=="structure");let se=0;g.forEach(C=>{var I;if(C.type==="structure"){h(C,null,null,[],null,m);return}const j=(x==null?void 0:x.filter(A=>A.seat_id===C.id))||[],L=j.find(A=>A.session_id===r),E=((I=L==null?void 0:L.attendance[0])==null?void 0:I.status)||"absent";E==="present"&&se++,h({...C,pos_x:C.pos_x+k,pos_y:C.pos_y+V},L,E,j,re,m)}),c({present:se,absent:le.length-se,total:le.length})}t.current&&canvasRef.current&&t.current.on("mouse:wheel",_=>{var F;if(!t.current||!canvasRef.current)return;const w=_.e.deltaY,T=t.current.viewportTransform;T[5]-=w;const k=t.current.getHeight(),O=((F=e.current)==null?void 0:F.clientHeight)||0;T[5]>0&&(T[5]=0),O>0&&T[5]<-(k-O)&&(T[5]=-(k-O)),t.current.requestRenderAll(),_.e.preventDefault(),_.e.stopPropagation()}),o(!1)},h=(m,g,v,x,y,_)=>{var q;if(m.type==="structure"){const ae=new Qe.fabric.Rect({fill:"#E5E5EA",width:m.width||72,height:m.height||72,rx:6,ry:6,stroke:"#D1D1D6",strokeWidth:1}),ne=new Qe.fabric.IText(m.label||"",{fontSize:10,originX:"center",originY:"center",left:(m.width||72)/2,top:(m.height||72)/2,fill:"#AEAEB2",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),re=new Qe.fabric.Group([ae,ne],{left:m.pos_x,top:m.pos_y,angle:m.rotation,selectable:!1,evented:!1,data:{...m}});t.current.add(re);return}const w=!!g,T=m.zone_color||"#5E5CE6",k=v==="present"?"#30D158":w?"#FF9F0A":"#1C1C1E",O=new Qe.fabric.Rect({fill:w?k:T,opacity:w?1:.25,width:72,height:72,rx:6,ry:6,stroke:v==="present"?"rgba(255,255,255,0.4)":"rgba(255,255,255,0.1)",strokeWidth:2}),F=new Qe.fabric.IText(m.display_number||m.seat_number,{fontSize:12,left:6,top:6,fill:w?"#ffffff":"#48484A",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"900",selectable:!1}),M=new Qe.fabric.IText(((q=g==null?void 0:g.profiles)==null?void 0:q.full_name)||(w?"Reserved":""),{fontSize:10,textAlign:"center",originX:"center",originY:"center",left:36,top:36,fill:"#ffffff",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"600",selectable:!1}),V=_.map((ae,ne)=>{const re=x==null?void 0:x.some(se=>se.session_id===ae.id),le=ae.id===(y==null?void 0:y.id);return new Qe.fabric.Rect({left:6+ne*15,top:60,width:12,height:4,rx:1,ry:1,fill:re?le?"#30D158":"#ffffff":"rgba(255,255,255,0.1)",selectable:!1})}),X=new Qe.fabric.Group([O,F,M,...V],{left:m.pos_x,top:m.pos_y,angle:m.rotation,data:{...m,booking:g,status:v},selectable:!1,hoverCursor:w?"pointer":"default"});t.current.add(X)},u=async m=>{const{booking:g,status:v}=m.data;if(!g)return;const x=v==="present"?"absent":"present",{error:y}=await je.from("attendance").upsert({booking_id:g.id,status:x,timestamp_in:x==="present"?new Date().toISOString():null},{onConflict:"booking_id"});y||f()},p=()=>{const m=t.current.getObjects().map(x=>{var y,_;return{ID:x.data.global_number,:x.data.display_number,:((_=(y=x.data.booking)==null?void 0:y.profiles)==null?void 0:_.full_name)||"",:x.data.status==="present"?"":"",:x.data.zone_name}}),g=_c.json_to_sheet(m),v=_c.book_new();_c.book_append_sheet(v,g,""),OI(v,`_${new Date().toISOString().split("T")[0]}.xlsx`)};return S.jsxs("div",{className:"flex flex-col gap-6 w-full h-full p-0",children:[S.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between",children:[S.jsx("div",{className:"flex bg-gray-50 p-1 rounded-[6px] border border-gray-100",children:i.map(m=>S.jsx("button",{onClick:()=>n(m.id),className:`px-6 py-2 rounded-[6px] text-[10px] font-black transition-all duration-300 ios-tap ${r===m.id?"bg-white text-ios-indigo shadow-sm":"text-ios-gray hover:text-[#1C1C1E]"}`,children:m.name.toUpperCase()},m.id))}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsxs("button",{onClick:p,className:"flex items-center gap-2 bg-gray-50 hover:bg-gray-100 text-[#1C1C1E] px-4 py-2 rounded-[6px] text-xs font-black transition-all border border-gray-100 ios-tap",children:[S.jsx(ck,{className:"w-4 h-4 text-ios-blue"}),"  "]}),S.jsxs("div",{className:"bg-white px-4 py-2 rounded-[6px] text-xs font-black shadow-sm border border-gray-100 flex items-center gap-2",children:[S.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-ios-indigo animate-pulse"}),"LIVE"]})]})]}),S.jsxs("div",{className:"flex-1 flex flex-col xl:flex-row gap-6 w-full overflow-hidden",children:[S.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden relative",children:[l&&S.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-30 flex items-center justify-center pointer-events-none",children:S.jsx("div",{className:"w-8 h-8 border-3 border-ios-indigo border-t-transparent rounded-full animate-spin"})}),S.jsx("div",{className:"flex-1 w-full bg-white rounded-t-[6px] rounded-b-none border-0 overflow-hidden p-2.5 pb-0",children:S.jsx("div",{ref:e,className:"flex-1 h-full relative overflow-hidden cursor-grab active:cursor-grabbing touch-none select-none scrollbar-hide"})})]}),S.jsxs("div",{className:"w-full xl:w-80 h-full overflow-y-auto scrollbar-hide space-y-6",children:[S.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 p-6 space-y-6 shadow-sm",children:[S.jsxs("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-ios-gray flex items-center gap-2",children:[S.jsx(od,{className:"w-3.5 h-3.5 text-ios-blue"}),"   "]}),S.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[S.jsxs("div",{className:"bg-emerald-50 border border-emerald-100 p-5 rounded-[6px]",children:[S.jsx("p",{className:"text-[9px] uppercase font-black text-ios-emerald mb-1 tracking-widest",children:" "}),S.jsxs("p",{className:"text-4xl font-black text-[#1C1C1E]",children:[s.present,S.jsx("span",{className:"text-sm text-ios-emerald/70 ml-1",children:""})]})]}),S.jsxs("div",{className:"bg-rose-50 border border-rose-100 p-5 rounded-[6px]",children:[S.jsx("p",{className:"text-[9px] uppercase font-black text-ios-rose mb-1 tracking-widest",children:" / "}),S.jsxs("p",{className:"text-4xl font-black text-[#1C1C1E]",children:[s.absent,S.jsx("span",{className:"text-sm text-ios-rose/70 ml-1",children:""})]})]}),S.jsxs("div",{className:"bg-gray-50 border border-gray-100 p-5 rounded-[6px]",children:[S.jsx("p",{className:"text-[9px] uppercase font-black text-ios-gray mb-1 tracking-widest",children:" "}),S.jsxs("p",{className:"text-2xl font-black text-[#1C1C1E]",children:[s.total,S.jsx("span",{className:"text-[10px] text-ios-gray ml-1",children:"SEATS"})]})]})]})]}),S.jsxs("div",{className:"bg-ios-amber/10 border border-ios-amber/20 p-6 rounded-[6px] text-[#1C1C1E] ios-tap relative overflow-hidden",children:[S.jsxs("div",{className:"relative z-10",children:[S.jsx(zo,{className:"w-8 h-8 mb-4 text-ios-amber"}),S.jsx("h4",{className:"font-black text-lg mb-1 tracking-tight",children:" "}),S.jsx("p",{className:"text-[11px] font-medium leading-relaxed text-ios-gray",children:"     ."})]}),S.jsx("div",{className:"absolute -right-4 -bottom-4 w-16 h-16 bg-ios-amber/5 rounded-full blur-xl"})]})]})]})]})};function it(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Cn(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function Ba(e,t){const r=it(e);return isNaN(t)?Cn(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Jd(e,t){const r=it(e);if(isNaN(t))return Cn(e,NaN);if(!t)return r;const n=r.getDate(),i=Cn(e,r.getTime());i.setMonth(r.getMonth()+t+1,0);const a=i.getDate();return n>=a?i:(r.setFullYear(i.getFullYear(),i.getMonth(),n),r)}const H_=6048e5,WI=864e5,z_=6e4,V_=36e5;let HI={};function bl(){return HI}function _a(e,t){var o,s,c,d;const r=bl(),n=(t==null?void 0:t.weekStartsOn)??((s=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:s.weekStartsOn)??r.weekStartsOn??((d=(c=r.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??0,i=it(e),a=i.getDay(),l=(a<n?7:0)+a-n;return i.setDate(i.getDate()-l),i.setHours(0,0,0,0),i}function uu(e){return _a(e,{weekStartsOn:1})}function X_(e){const t=it(e),r=t.getFullYear(),n=Cn(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const i=uu(n),a=Cn(e,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const l=uu(a);return t.getTime()>=i.getTime()?r+1:t.getTime()>=l.getTime()?r:r-1}function As(e){const t=it(e);return t.setHours(0,0,0,0),t}function Ym(e){const t=it(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function zI(e,t){const r=As(e),n=As(t),i=+r-Ym(r),a=+n-Ym(n);return Math.round((i-a)/WI)}function VI(e){const t=X_(e),r=Cn(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),uu(r)}function XI(e){return Cn(e,Date.now())}function $_(e,t){const r=As(e),n=As(t);return+r==+n}function $I(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function wc(e){if(!$I(e)&&typeof e!="number")return!1;const t=it(e);return!isNaN(Number(t))}function fu(e){const t=it(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function Qd(e,t){const r=it(e.start),n=it(e.end);let i=+r>+n;const a=i?+r:+n,l=i?n:r;l.setHours(0,0,0,0);let o=1;const s=[];for(;+l<=a;)s.push(it(l)),l.setDate(l.getDate()+o),l.setHours(0,0,0,0);return i?s.reverse():s}function GI(e,t){const r=it(e.start),n=it(e.end);let i=+r>+n;const a=i?+r:+n,l=i?n:r;l.setHours(0,0,0,0),l.setDate(1);let o=1;const s=[];for(;+l<=a;)s.push(it(l)),l.setMonth(l.getMonth()+o);return i?s.reverse():s}function hu(e){const t=it(e);return t.setDate(1),t.setHours(0,0,0,0),t}function YI(e){const t=it(e),r=Cn(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function G_(e,t){var o,s;const r=bl(),n=r.weekStartsOn??((s=(o=r.locale)==null?void 0:o.options)==null?void 0:s.weekStartsOn)??0,i=it(e),a=i.getDay(),l=(a<n?-7:0)+6-(a-n);return i.setDate(i.getDate()+l),i.setHours(23,59,59,999),i}const KI={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},qI=(e,t,r)=>{let n;const i=KI[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function vs(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const JI={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},QI={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ZI={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},e6={date:vs({formats:JI,defaultWidth:"full"}),time:vs({formats:QI,defaultWidth:"full"}),dateTime:vs({formats:ZI,defaultWidth:"full"})},t6={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},r6=(e,t,r,n)=>t6[e];function Rn(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let i;if(n==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):l;i=e.formattingValues[o]||e.formattingValues[l]}else{const l=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;i=e.values[o]||e.values[l]}const a=e.argumentCallback?e.argumentCallback(t):t;return i[a]}}const n6={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},i6={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},a6={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},s6={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},o6={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},l6={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},c6=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},u6={ordinalNumber:c6,era:Rn({values:n6,defaultWidth:"wide"}),quarter:Rn({values:i6,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Rn({values:a6,defaultWidth:"wide"}),day:Rn({values:s6,defaultWidth:"wide"}),dayPeriod:Rn({values:o6,defaultWidth:"wide",formattingValues:l6,defaultFormattingWidth:"wide"})};function In(e){return(t,r={})=>{const n=r.width,i=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],a=t.match(i);if(!a)return null;const l=a[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],s=Array.isArray(o)?h6(o,f=>f.test(l)):f6(o,f=>f.test(l));let c;c=e.valueCallback?e.valueCallback(s):s,c=r.valueCallback?r.valueCallback(c):c;const d=t.slice(l.length);return{value:c,rest:d}}}function f6(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function h6(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function Y_(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const i=n[0],a=t.match(e.parsePattern);if(!a)return null;let l=e.valueCallback?e.valueCallback(a[0]):a[0];l=r.valueCallback?r.valueCallback(l):l;const o=t.slice(i.length);return{value:l,rest:o}}}const d6=/^(\d+)(th|st|nd|rd)?/i,p6=/\d+/i,g6={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},m6={any:[/^b/i,/^(a|c)/i]},v6={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},x6={any:[/1/i,/2/i,/3/i,/4/i]},y6={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},_6={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},w6={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},S6={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},k6={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},b6={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},T6={ordinalNumber:Y_({matchPattern:d6,parsePattern:p6,valueCallback:e=>parseInt(e,10)}),era:In({matchPatterns:g6,defaultMatchWidth:"wide",parsePatterns:m6,defaultParseWidth:"any"}),quarter:In({matchPatterns:v6,defaultMatchWidth:"wide",parsePatterns:x6,defaultParseWidth:"any",valueCallback:e=>e+1}),month:In({matchPatterns:y6,defaultMatchWidth:"wide",parsePatterns:_6,defaultParseWidth:"any"}),day:In({matchPatterns:w6,defaultMatchWidth:"wide",parsePatterns:S6,defaultParseWidth:"any"}),dayPeriod:In({matchPatterns:k6,defaultMatchWidth:"any",parsePatterns:b6,defaultParseWidth:"any"})},C6={code:"en-US",formatDistance:qI,formatLong:e6,formatRelative:r6,localize:u6,match:T6,options:{weekStartsOn:0,firstWeekContainsDate:1}};function E6(e){const t=it(e);return zI(t,YI(t))+1}function A6(e){const t=it(e),r=+uu(t)-+VI(t);return Math.round(r/H_)+1}function K_(e,t){var d,f,h,u;const r=it(e),n=r.getFullYear(),i=bl(),a=(t==null?void 0:t.firstWeekContainsDate)??((f=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??i.firstWeekContainsDate??((u=(h=i.locale)==null?void 0:h.options)==null?void 0:u.firstWeekContainsDate)??1,l=Cn(e,0);l.setFullYear(n+1,0,a),l.setHours(0,0,0,0);const o=_a(l,t),s=Cn(e,0);s.setFullYear(n,0,a),s.setHours(0,0,0,0);const c=_a(s,t);return r.getTime()>=o.getTime()?n+1:r.getTime()>=c.getTime()?n:n-1}function O6(e,t){var o,s,c,d;const r=bl(),n=(t==null?void 0:t.firstWeekContainsDate)??((s=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:s.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(c=r.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??1,i=K_(e,t),a=Cn(e,0);return a.setFullYear(i,0,n),a.setHours(0,0,0,0),_a(a,t)}function F6(e,t){const r=it(e),n=+_a(r,t)-+O6(r,t);return Math.round(n/H_)+1}function st(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const fi={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return st(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):st(r+1,2)},d(e,t){return st(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return st(e.getHours()%12||12,t.length)},H(e,t){return st(e.getHours(),t.length)},m(e,t){return st(e.getMinutes(),t.length)},s(e,t){return st(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),i=Math.trunc(n*Math.pow(10,r-3));return st(i,t.length)}},Ua={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Km={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),i=n>0?n:1-n;return r.ordinalNumber(i,{unit:"year"})}return fi.y(e,t)},Y:function(e,t,r,n){const i=K_(e,n),a=i>0?i:1-i;if(t==="YY"){const l=a%100;return st(l,2)}return t==="Yo"?r.ordinalNumber(a,{unit:"year"}):st(a,t.length)},R:function(e,t){const r=X_(e);return st(r,t.length)},u:function(e,t){const r=e.getFullYear();return st(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return st(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return st(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return fi.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return st(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const i=F6(e,n);return t==="wo"?r.ordinalNumber(i,{unit:"week"}):st(i,t.length)},I:function(e,t,r){const n=A6(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):st(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):fi.d(e,t)},D:function(e,t,r){const n=E6(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):st(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const i=e.getDay(),a=(i-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(a);case"ee":return st(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});case"eeee":default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const i=e.getDay(),a=(i-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(a);case"cc":return st(a,t.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});case"cccc":default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),i=n===0?7:n;switch(t){case"i":return String(i);case"ii":return st(i,t.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let i;switch(n===12?i=Ua.noon:n===0?i=Ua.midnight:i=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let i;switch(n>=17?i=Ua.evening:n>=12?i=Ua.afternoon:n>=4?i=Ua.morning:i=Ua.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return fi.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):fi.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):st(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):st(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):fi.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):fi.s(e,t)},S:function(e,t){return fi.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return Jm(n);case"XXXX":case"XX":return Yi(n);case"XXXXX":case"XXX":default:return Yi(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return Jm(n);case"xxxx":case"xx":return Yi(n);case"xxxxx":case"xxx":default:return Yi(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+qm(n,":");case"OOOO":default:return"GMT"+Yi(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+qm(n,":");case"zzzz":default:return"GMT"+Yi(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return st(n,t.length)},T:function(e,t,r){const n=e.getTime();return st(n,t.length)}};function qm(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=Math.trunc(n/60),a=n%60;return a===0?r+String(i):r+String(i)+t+st(a,2)}function Jm(e,t){return e%60===0?(e>0?"-":"+")+st(Math.abs(e)/60,2):Yi(e,t)}function Yi(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=st(Math.trunc(n/60),2),a=st(n%60,2);return r+i+t+a}const Qm=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},q_=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},P6=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return Qm(e,t);let a;switch(n){case"P":a=t.dateTime({width:"short"});break;case"PP":a=t.dateTime({width:"medium"});break;case"PPP":a=t.dateTime({width:"long"});break;case"PPPP":default:a=t.dateTime({width:"full"});break}return a.replace("{{date}}",Qm(n,t)).replace("{{time}}",q_(i,t))},N6={p:q_,P:P6},D6=/^D+$/,R6=/^Y+$/,I6=["D","DD","YY","YYYY"];function M6(e){return D6.test(e)}function j6(e){return R6.test(e)}function L6(e,t,r){const n=B6(e,t,r);if(console.warn(n),I6.includes(e))throw new RangeError(n)}function B6(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const U6=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,W6=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,H6=/^'([^]*?)'?$/,z6=/''/g,V6=/[a-zA-Z]/;function bt(e,t,r){var d,f,h,u,p,m,g,v;const n=bl(),i=(r==null?void 0:r.locale)??n.locale??C6,a=(r==null?void 0:r.firstWeekContainsDate)??((f=(d=r==null?void 0:r.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(h=n.locale)==null?void 0:h.options)==null?void 0:u.firstWeekContainsDate)??1,l=(r==null?void 0:r.weekStartsOn)??((m=(p=r==null?void 0:r.locale)==null?void 0:p.options)==null?void 0:m.weekStartsOn)??n.weekStartsOn??((v=(g=n.locale)==null?void 0:g.options)==null?void 0:v.weekStartsOn)??0,o=it(e);if(!wc(o))throw new RangeError("Invalid time value");let s=t.match(W6).map(x=>{const y=x[0];if(y==="p"||y==="P"){const _=N6[y];return _(x,i.formatLong)}return x}).join("").match(U6).map(x=>{if(x==="''")return{isToken:!1,value:"'"};const y=x[0];if(y==="'")return{isToken:!1,value:X6(x)};if(Km[y])return{isToken:!0,value:x};if(y.match(V6))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");return{isToken:!1,value:x}});i.localize.preprocessor&&(s=i.localize.preprocessor(o,s));const c={firstWeekContainsDate:a,weekStartsOn:l,locale:i};return s.map(x=>{if(!x.isToken)return x.value;const y=x.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&j6(y)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&M6(y))&&L6(y,t,String(e));const _=Km[y[0]];return _(o,y,i.localize,c)}).join("")}function X6(e){const t=e.match(H6);return t?t[1].replace(z6,"'"):e}function $6(e,t){const r=it(e),n=it(t);return+r<+n}function G6(e){return+it(e)<Date.now()}function o0(e,t){const r=it(e),n=it(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function J_(e){return $_(e,XI(e))}function du(e,t){const r=+it(e),[n,i]=[+it(t.start),+it(t.end)].sort((a,l)=>a-l);return r>=n&&r<=i}function Fr(e,t){const n=J6(e);let i;if(n.date){const s=Q6(n.date,2);i=Z6(s.restDateString,s.year)}if(!i||isNaN(i.getTime()))return new Date(NaN);const a=i.getTime();let l=0,o;if(n.time&&(l=e8(n.time),isNaN(l)))return new Date(NaN);if(n.timezone){if(o=t8(n.timezone),isNaN(o))return new Date(NaN)}else{const s=new Date(a+l),c=new Date(0);return c.setFullYear(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()),c.setHours(s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCMilliseconds()),c}return new Date(a+l+o)}const oc={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Y6=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,K6=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,q6=/^([+-])(\d{2})(?::?(\d{2}))?$/;function J6(e){const t={},r=e.split(oc.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],oc.timeZoneDelimiter.test(t.date)&&(t.date=e.split(oc.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const i=oc.timezone.exec(n);i?(t.time=n.replace(i[1],""),t.timezone=i[1]):t.time=n}return t}function Q6(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const i=n[1]?parseInt(n[1]):null,a=n[2]?parseInt(n[2]):null;return{year:a===null?i:a*100,restDateString:e.slice((n[1]||n[2]).length)}}function Z6(e,t){if(t===null)return new Date(NaN);const r=e.match(Y6);if(!r)return new Date(NaN);const n=!!r[4],i=qs(r[1]),a=qs(r[2])-1,l=qs(r[3]),o=qs(r[4]),s=qs(r[5])-1;if(n)return s8(t,o,s)?r8(t,o,s):new Date(NaN);{const c=new Date(0);return!i8(t,a,l)||!a8(t,i)?new Date(NaN):(c.setUTCFullYear(t,a,Math.max(i,l)),c)}}function qs(e){return e?parseInt(e):1}function e8(e){const t=e.match(K6);if(!t)return NaN;const r=Hf(t[1]),n=Hf(t[2]),i=Hf(t[3]);return o8(r,n,i)?r*V_+n*z_+i*1e3:NaN}function Hf(e){return e&&parseFloat(e.replace(",","."))||0}function t8(e){if(e==="Z")return 0;const t=e.match(q6);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;return l8(n,i)?r*(n*V_+i*z_):NaN}function r8(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const i=n.getUTCDay()||7,a=(t-1)*7+r+1-i;return n.setUTCDate(n.getUTCDate()+a),n}const n8=[31,null,31,30,31,30,31,31,30,31,30,31];function Q_(e){return e%400===0||e%4===0&&e%100!==0}function i8(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(n8[t]||(Q_(e)?29:28))}function a8(e,t){return t>=1&&t<=(Q_(e)?366:365)}function s8(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function o8(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function l8(e,t){return t>=0&&t<=59}function c8(e,t){const r=it(e);return r.setDate(t),r}function Z_(e,t){return Jd(e,-1)}const u8={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},f8=(e,t,r)=>{let n;const i=u8[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?n+" ":n+" ":n},h8={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},d8={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},p8={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},g8={date:vs({formats:h8,defaultWidth:"full"}),time:vs({formats:d8,defaultWidth:"full"}),dateTime:vs({formats:p8,defaultWidth:"full"})},m8={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},v8=(e,t,r,n)=>m8[e],x8={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},y8={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},_8={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},w8={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},S8={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},k8={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},b8=(e,t)=>{const r=Number(e);switch(String(t==null?void 0:t.unit)){case"minute":case"second":return String(r);case"date":return r+"";default:return r+""}},T8={ordinalNumber:b8,era:Rn({values:x8,defaultWidth:"wide"}),quarter:Rn({values:y8,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Rn({values:_8,defaultWidth:"wide"}),day:Rn({values:w8,defaultWidth:"wide"}),dayPeriod:Rn({values:S8,defaultWidth:"wide",formattingValues:k8,defaultFormattingWidth:"wide"})},C8=/^(\d+)(|)?/i,E8=/\d+/i,A8={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},O8={any:[/^(bc|)/i,/^(ad|)/i]},F8={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},P8={any:[/1/i,/2/i,/3/i,/4/i]},N8={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},D8={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},R8={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},I8={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},M8={any:/^(am|pm|||||||)/i},j8={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},L8={ordinalNumber:Y_({matchPattern:C8,parsePattern:E8,valueCallback:e=>parseInt(e,10)}),era:In({matchPatterns:A8,defaultMatchWidth:"wide",parsePatterns:O8,defaultParseWidth:"any"}),quarter:In({matchPatterns:F8,defaultMatchWidth:"wide",parsePatterns:P8,defaultParseWidth:"any",valueCallback:e=>e+1}),month:In({matchPatterns:N8,defaultMatchWidth:"wide",parsePatterns:D8,defaultParseWidth:"any"}),day:In({matchPatterns:R8,defaultMatchWidth:"wide",parsePatterns:I8,defaultParseWidth:"any"}),dayPeriod:In({matchPatterns:M8,defaultMatchWidth:"any",parsePatterns:j8,defaultParseWidth:"any"})},Zd={code:"ko",formatDistance:f8,formatLong:g8,formatRelative:v8,localize:T8,match:L8,options:{weekStartsOn:0,firstWeekContainsDate:1}},B8=({onSave:e,onCancel:t})=>{const r=ve.useRef(null),[n,i]=ve.useState(!1),[a,l]=ve.useState(!1);ve.useEffect(()=>{const u=r.current;if(!u)return;const p=u.getContext("2d"),m=window.devicePixelRatio||1,g=u.getBoundingClientRect();u.width=g.width*m,u.height=g.height*m,p.scale(m,m),p.strokeStyle="black",p.lineWidth=10,p.lineCap="round"},[]);const o=u=>{const m=r.current.getBoundingClientRect(),g=u.touches?u.touches[0].clientX:u.clientX,v=u.touches?u.touches[0].clientY:u.clientY;return{x:g-m.left,y:v-m.top}},s=u=>{i(!0);const{x:p,y:m}=o(u),g=r.current.getContext("2d");g.strokeStyle="black",g.lineWidth=10,g.lineCap="round",g.beginPath(),g.moveTo(p,m)},c=u=>{if(!n)return;const{x:p,y:m}=o(u),g=r.current.getContext("2d");g.lineTo(p,m),g.stroke(),l(!0)},d=()=>{i(!1)},f=()=>{const u=r.current;u.getContext("2d").clearRect(0,0,u.width,u.height),l(!1)},h=()=>{if(!a){alert("  .");return}r.current.toBlob(p=>{e(p)},"image/png")};return S.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-fade-in",onClick:t,children:S.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden animate-spring-up",onClick:u=>u.stopPropagation(),children:[S.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[S.jsxs("h4",{className:"text-sm font-black text-[#1C1C1E] flex items-center gap-2",children:[S.jsx(g1,{className:"w-4 h-4 text-ios-indigo"}),"  "]}),S.jsx("button",{onClick:t,className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:S.jsx(go,{className:"w-5 h-5"})})]}),S.jsxs("div",{className:"p-6 bg-white flex flex-col items-center gap-4",children:[S.jsx("p",{className:"text-xs text-ios-gray mb-2",children:"    ."}),S.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-xl bg-gray-50 touch-none overflow-hidden relative w-full h-[200px]",children:S.jsx("canvas",{ref:r,style:{width:"100%",height:"100%"},onMouseDown:s,onMouseMove:c,onMouseUp:d,onMouseLeave:d,onTouchStart:s,onTouchMove:c,onTouchEnd:d})})]}),S.jsxs("div",{className:"p-4 border-t border-gray-100 flex gap-3 bg-gray-50",children:[S.jsx("button",{onClick:f,className:"flex-1 py-3 bg-white border border-gray-200 text-[#1C1C1E] rounded-xl text-xs font-bold hover:bg-gray-50 transition-all",children:""}),S.jsxs("button",{onClick:h,className:"flex-[2] py-3 bg-[#1C1C1E] text-white rounded-xl text-xs font-bold hover:bg-ios-indigo shadow-lg transition-all flex items-center justify-center gap-2",children:[S.jsx(fs,{className:"w-4 h-4"}),"  "]})]})]})})},U8=()=>{const[e,t]=ve.useState(new Date),[r,n]=ve.useState([]),[i,a]=ve.useState([]),[l,o]=ve.useState([]),[s,c]=ve.useState([]),[d,f]=ve.useState(null),[h,u]=ve.useState(!1),[p,m]=ve.useState(null),[g,v]=ve.useState(null),[x,y]=ve.useState(null),[_,w]=ve.useState(!1),[T,k]=ve.useState(null),[O,F]=ve.useState(""),[M,V]=ve.useState(!1);ve.useEffect(()=>{X(),q()},[]),ve.useEffect(()=>{ae()},[e]);const X=async()=>{const{data:{user:b}}=await je.auth.getUser();if(b){const{data:P}=await je.from("profiles").select("*").eq("id",b.id).single();f({...b,profile:P})}},q=async()=>{const[b,P,R]=await Promise.all([je.from("operation_quarters").select("*"),je.from("operation_defaults").select("*"),je.from("operation_exceptions").select("*")]);b.data&&a(b.data),P.data&&o(P.data),R.data&&c(R.data)},ae=async()=>{u(!0);const b=hu(e).toISOString(),P=fu(e).toISOString(),{data:R,error:W}=await je.from("supervision_assignments").select("*").gte("date",b).lte("date",P).order("created_at",{ascending:!0});R&&n(R),u(!1)},ne=async()=>{if(!O.trim()||!p)return;const b=bt(p.date,"yyyy-MM-dd"),{error:P}=await je.from("supervision_assignments").insert([{date:b,supervisor_name:O.trim(),teacher_id:null}]);P?alert("  : "+P.message):(F(""),m(null),ae())},re=async()=>{if(!O.trim()||!g)return;const{error:b}=await je.from("supervision_assignments").update({supervisor_name:O.trim()}).eq("id",g.id);b?alert(" : "+b.message):(F(""),v(null),ae())},le=b=>{if(!b)return null;const P=b.split("/signatures/");return P.length>1?P[1]:null},se=async(b,P)=>{if(P.stopPropagation(),!confirm(" ?   ."))return;const R=r.find(z=>z.id===b);if(R!=null&&R.signature_url){const z=le(R.signature_url);z&&await je.storage.from("signatures").remove([z])}const{error:W}=await je.from("supervision_assignments").delete().eq("id",b);W||ae()},C=async b=>{if(!x)return;const P=r.find(N=>N.id===x.assignmentId);if(P!=null&&P.signature_url){const N=le(P.signature_url);N&&await je.storage.from("signatures").remove([N])}const R=`sig_${x.assignmentId}_${Date.now()}.png`,{data:W,error:z}=await je.storage.from("signatures").upload(R,b,{contentType:"image/png",upsert:!0});if(z){alert("  : "+z.message);return}const{data:{publicUrl:Y}}=je.storage.from("signatures").getPublicUrl(R),{error:ie}=await je.from("supervision_assignments").update({signature_url:Y}).eq("id",x.assignmentId);ie?alert("  : "+ie.message):(y(null),ae())},j=()=>{w(!0)},L=async b=>{u(!0);const{data:P,error:R}=await je.from("supervision_assignments").select("*").gte("date",b.start_date).lte("date",b.end_date).order("date",{ascending:!0});if(R){alert("  : "+R.message),u(!1);return}k({quarter:b,assignments:P||[]}),w(!1),u(!1),setTimeout(()=>{window.print()},500)},E=()=>S.jsxs("div",{className:"flex items-center justify-between mb-6",children:[S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsx("h3",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:bt(e,"yyyy M")}),S.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-xl border border-gray-200",children:[S.jsx("button",{onClick:()=>t(Z_(e)),className:"p-1.5 hover:bg-white rounded-lg text-ios-gray hover:text-[#1C1C1E] transition-all ios-tap shadow-sm hover:shadow",children:S.jsx(p1,{className:"w-4 h-4"})}),S.jsx("button",{onClick:()=>t(Jd(e,1)),className:"p-1.5 hover:bg-white rounded-lg text-ios-gray hover:text-[#1C1C1E] transition-all ios-tap shadow-sm hover:shadow",children:S.jsx(nd,{className:"w-4 h-4"})})]})]}),S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group select-none",children:[S.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${M?"bg-[#1C1C1E] border-[#1C1C1E]":"bg-white border-gray-300 group-hover:border-gray-400"}`,children:M&&S.jsx(fs,{className:"w-3 h-3 text-white"})}),S.jsx("input",{type:"checkbox",checked:M,onChange:b=>V(b.target.checked),className:"hidden"}),S.jsx("span",{className:"text-xs font-bold text-ios-gray group-hover:text-[#1C1C1E] transition-colors",children:" "})]}),S.jsxs("button",{onClick:j,className:"flex items-center gap-2 bg-[#1C1C1E] text-white px-4 py-2 rounded-lg font-bold text-xs transition-all shadow-lg hover:bg-ios-indigo hover:shadow-xl ios-tap",children:[S.jsx(gg,{className:"w-3.5 h-3.5"}),"  "]})]})]}),I=()=>{const b=["","","","","","",""],P=M?b:b.filter((R,W)=>W!==0&&W!==6);return S.jsx("div",{className:`grid ${M?"grid-cols-7":"grid-cols-5"} mb-2 border-b border-gray-100`,children:P.map((R,W)=>S.jsx("div",{className:`py-3 text-[10px] font-black uppercase text-center tracking-widest ${M&&W===0?"text-ios-rose":M&&W===6?"text-ios-indigo":"text-ios-gray"}`,children:R},W))})},A=()=>{const b=hu(e),P=fu(b),R=_a(b),W=G_(P),z=Qd({start:R,end:W});return S.jsx("div",{className:`grid ${M?"grid-cols-7":"grid-cols-5"} gap-px bg-gray-100 border border-gray-100 rounded-[12px] overflow-hidden shadow-sm`,children:z.filter(Y=>M||Y.getDay()!==0&&Y.getDay()!==6).map((Y,ie)=>{var Re;const N=J_(Y),Q=o0(Y,b),H=Y.getDay(),te=bt(Y,"yyyy-MM-dd"),ee=r.filter(De=>De.date===te),Z=s.find(De=>De.exception_date===te),oe=i.find(De=>De.start_date&&De.end_date&&du(Y,{start:Fr(De.start_date),end:Fr(De.end_date)})),ce=l.find(De=>De.day_of_week===H),ye=oe&&!Z&&((ce==null?void 0:ce.morning)||(ce==null?void 0:ce.dinner)||(ce==null?void 0:ce.period1)||(ce==null?void 0:ce.period2)),_e=ce&&!ce.period1&&!ce.period2,de=ye?_e?1:2:0,be=((Re=d==null?void 0:d.profile)==null?void 0:Re.role)==="admin",Ae=be||N;return S.jsxs("div",{className:`h-[200px] p-2 flex flex-col gap-2 transition-colors border-b border-r border-gray-100 ${Q?ye?"bg-white":"bg-gray-50":"bg-gray-50/50 opacity-40"}`,children:[S.jsxs("div",{className:"flex justify-between items-start",children:[S.jsx("span",{className:`text-[12px] font-black ${N?"w-6 h-6 text-ios-indigo border-2 border-ios-indigo rounded-full flex items-center justify-center -mt-1 -ml-1 bg-white":H===0?"text-ios-rose":H===6?"text-ios-indigo":"text-[#1C1C1E]"}`,children:bt(Y,"d")}),be&&ye&&ee.length<de&&S.jsx("button",{onClick:()=>m({date:Y}),className:"w-5 h-5 flex items-center justify-center rounded-full bg-[#1C1C1E] text-white hover:bg-ios-indigo transition-all ios-tap shadow-sm",title:" ",children:S.jsx($c,{className:"w-3 h-3"})})]}),S.jsx("div",{className:"flex-1 flex flex-col gap-1.5 overflow-y-auto scrollbar-hide",children:ee.map(De=>{var Me;return S.jsxs("div",{className:"relative group bg-gray-50 rounded-[8px] p-2 border border-dashed border-gray-200 hover:border-ios-indigo/30 transition-all",children:[S.jsxs("div",{className:"flex justify-between items-center mb-1",children:[S.jsx("span",{className:"text-[11px] font-bold text-[#1C1C1E]",children:De.supervisor_name}),be&&S.jsxs("div",{className:"opacity-0 group-hover:opacity-100 flex items-center transition-opacity",children:[S.jsx("button",{onClick:Ke=>{Ke.stopPropagation(),F(De.supervisor_name),v({id:De.id,name:De.supervisor_name,date:Y})},className:"p-1 text-gray-400 hover:text-ios-indigo transition-colors",title:" ",children:S.jsx(Nk,{className:"w-3 h-3"})}),S.jsx("button",{onClick:Ke=>se(De.id,Ke),className:"p-1 text-gray-400 hover:text-ios-rose transition-colors",title:"",children:S.jsx(sd,{className:"w-3 h-3"})})]})]}),De.signature_url?S.jsxs("div",{className:"relative h-8 flex items-center",children:[S.jsx("img",{src:De.signature_url,alt:"",className:"h-full object-contain opacity-80"}),be&&S.jsx("button",{onClick:()=>y({assignmentId:De.id}),className:"absolute inset-0 bg-black/5 opacity-0 hover:opacity-100 flex items-center justify-center text-[9px] text-[#1C1C1E] font-black rounded backdrop-blur-[1px]",children:""})]}):S.jsx("div",{className:"h-8 flex items-center justify-center",children:be||((Me=d==null?void 0:d.profile)==null?void 0:Me.full_name)===De.supervisor_name&&Ae?S.jsxs("button",{onClick:()=>y({assignmentId:De.id}),className:"w-full h-full border border-dashed border-ios-indigo/30 rounded flex items-center justify-center gap-1 text-[9px] text-ios-indigo font-bold hover:bg-ios-indigo/5 transition-colors",children:[S.jsx(g1,{className:"w-3 h-3"})," "]}):!N&&G6(Y)?S.jsx("span",{className:"text-[9px] text-red-500 font-bold",children:""}):S.jsx("span",{className:"text-[9px] text-gray-300 font-medium",children:" "})})]},De.id)})})]},ie)})})};return S.jsxs("div",{className:"h-full flex flex-col p-6 animate-spring-up overflow-hidden relative print:hidden",children:[S.jsxs("div",{className:"flex-none",children:[E(),I()]}),S.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide -mr-2 pr-2",children:A()}),p&&S.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm p-4 animate-fade-in",onClick:()=>m(null),children:S.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-xs overflow-hidden animate-spring-up",onClick:b=>b.stopPropagation(),children:[S.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[S.jsxs("h4",{className:"text-sm font-black text-[#1C1C1E]",children:[bt(p.date,"M d"),"  "]}),S.jsx("button",{onClick:()=>m(null),className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:S.jsx(go,{className:"w-4 h-4"})})]}),S.jsxs("div",{className:"p-4 space-y-4",children:[S.jsxs("div",{children:[S.jsx("label",{className:"block text-[10px] font-bold text-ios-gray uppercase tracking-wider mb-2",children:"  "}),S.jsx("input",{type:"text",value:O,onChange:b=>F(b.target.value),placeholder:" ",className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 text-sm font-bold text-[#1C1C1E] focus:outline-none focus:ring-2 focus:ring-ios-indigo/50 transition-all",onKeyDown:b=>b.key==="Enter"&&ne(),autoFocus:!0})]}),S.jsx("button",{onClick:ne,className:"w-full py-3 bg-[#1C1C1E] text-white rounded-xl text-xs font-bold hover:bg-ios-indigo shadow-lg transition-all",children:""})]})]})}),g&&S.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm p-4 animate-fade-in",onClick:()=>v(null),children:S.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-xs overflow-hidden animate-spring-up",onClick:b=>b.stopPropagation(),children:[S.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[S.jsx("h4",{className:"text-sm font-black text-[#1C1C1E]",children:"  "}),S.jsx("button",{onClick:()=>v(null),className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:S.jsx(go,{className:"w-4 h-4"})})]}),S.jsxs("div",{className:"p-4 space-y-4",children:[S.jsxs("div",{children:[S.jsx("label",{className:"block text-[10px] font-bold text-ios-gray uppercase tracking-wider mb-2",children:" "}),S.jsx("input",{type:"text",value:O,onChange:b=>F(b.target.value),placeholder:" ",className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 text-sm font-bold text-[#1C1C1E] focus:outline-none focus:ring-2 focus:ring-ios-indigo/50 transition-all",onKeyDown:b=>b.key==="Enter"&&re(),autoFocus:!0})]}),S.jsx("button",{onClick:re,className:"w-full py-3 bg-[#1C1C1E] text-white rounded-xl text-xs font-bold hover:bg-ios-indigo shadow-lg transition-all",children:" "})]})]})}),x&&S.jsx(B8,{onSave:C,onCancel:()=>y(null)}),_&&S.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm p-4 animate-fade-in",onClick:()=>w(!1),children:S.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm overflow-hidden animate-spring-up",onClick:b=>b.stopPropagation(),children:[S.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[S.jsxs("h4",{className:"text-sm font-black text-[#1C1C1E] flex items-center gap-2",children:[S.jsx(gg,{className:"w-4 h-4 text-ios-indigo"}),"  "]}),S.jsx("button",{onClick:()=>w(!1),className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:S.jsx(go,{className:"w-5 h-5"})})]}),S.jsxs("div",{className:"p-4 max-h-[60vh] overflow-y-auto",children:[S.jsx("p",{className:"text-xs text-ios-gray mb-4",children:" /  ."}),S.jsxs("div",{className:"grid gap-2",children:[i.map(b=>S.jsx("button",{onClick:()=>L(b),className:"w-full p-3 rounded-xl border border-gray-100 hover:border-ios-indigo/50 hover:bg-ios-indigo/5 transition-all text-left group",children:S.jsxs("span",{className:"text-sm font-bold text-[#1C1C1E] group-hover:text-ios-indigo",children:[b.quarter_name?`${b.quarter_name}: `:"",b.start_date," ~ ",b.end_date]})},b.id)),i.length===0&&S.jsx("div",{className:"text-center py-6 text-gray-300 text-xs",children:"   ."})]})]})]})}),T&&h1.createPortal(S.jsxs("div",{id:"print-root",className:"bg-white text-black hidden print:block",children:[S.jsx("style",{children:`
                            @media print {
                                @page { size: A4 portrait; margin: 0; }
                                body { 
                                    margin: 0 !important;
                                    padding: 0 !important;
                                    background-color: white !important;
                                    font-family: 'Malgun Gothic', 'Dotum', 'Apple SD Gothic Neo', sans-serif !important;
                                    -webkit-print-color-adjust: exact !important;
                                    print-color-adjust: exact !important;
                                    color: #000000 !important;
                                }
                                body > #root {
                                    display: none !important;
                                }
                                body > #print-root {
                                    display: block !important;
                                    width: 210mm !important;
                                    min-height: 297mm !important;
                                    padding: 10mm !important;
                                    box-sizing: border-box !important;
                                    background-color: white !important;
                                    font-family: 'Malgun Gothic', 'Dotum', 'Apple SD Gothic Neo', sans-serif !important;
                                }
                                /* Force solid borders */
                                * {
                                    border-color: #000000 !important;
                                    border-style: solid !important;
                                }
                                /* Ensure text is strictly black */
                                .print-text-black {
                                    color: #000000 !important;
                                }
                            }
                            #print-root {
                                display: none;
                            }
                        `}),S.jsxs("div",{className:"flex flex-col w-full h-full bg-white relative",children:[S.jsxs("div",{className:"flex-none mb-2 text-center",children:[S.jsx("h1",{className:"text-[20pt] font-black tracking-widest mb-1 underline decoration-2 underline-offset-4 text-black",children:"  "}),S.jsxs("div",{className:"flex justify-between items-end border-b-2 border-black pb-1 mb-1 relative",children:[S.jsxs("span",{className:"text-[9pt] font-bold text-black absolute left-0 bottom-1",children:[T.quarter.quarter_name," (",T.quarter.start_date," ~ ",T.quarter.end_date,")"]}),S.jsx("span",{className:"w-full text-center text-[8pt] text-transparent",children:"."}),S.jsxs("span",{className:"text-[8pt] text-black absolute right-0 bottom-1",children:[": ",bt(new Date,"yyyy. MM. dd.")]})]})]}),S.jsx("div",{className:"flex-1 flex gap-2 items-start justify-center w-full",children:(()=>{try{const b=Fr(T.quarter.start_date),P=Fr(T.quarter.end_date);return!wc(b)||!wc(P)?S.jsx("div",{className:"w-full text-center p-10 text-red-500 font-bold",children:"   ."}):GI({start:b,end:P}).map((R,W)=>{const z=Array.from({length:31},(Y,ie)=>{const N=ie+1;try{const Q=c8(R,N);return!wc(Q)||!o0(Q,R)?null:Q}catch{return null}});return S.jsx("div",{className:"flex-1 h-full flex flex-col min-w-0",children:S.jsxs("table",{className:"w-full border-collapse table-fixed border border-black",children:[S.jsxs("colgroup",{children:[S.jsx("col",{style:{width:"12%"}}),S.jsx("col",{style:{width:"22%"}}),S.jsx("col",{style:{width:"22%"}}),S.jsx("col",{style:{width:"22%"}}),S.jsx("col",{style:{width:"22%"}})]}),S.jsxs("thead",{children:[S.jsx("tr",{className:"bg-[#E5E7EB]",children:S.jsx("th",{colSpan:5,className:"border border-black text-center font-bold py-1 text-[10pt] text-black",children:bt(R,"M")})}),S.jsxs("tr",{className:"bg-[#F3F4F6] text-[7pt] text-black font-bold h-[8mm]",children:[S.jsx("th",{rowSpan:2,className:"border border-black text-center align-middle",children:""}),S.jsx("th",{colSpan:2,className:"border border-black text-center align-middle h-[4mm]",children:" 1"}),S.jsx("th",{colSpan:2,className:"border border-black text-center align-middle h-[4mm]",children:" 2"})]}),S.jsxs("tr",{className:"bg-[#F3F4F6] text-[7pt] text-black font-bold h-[4mm]",children:[S.jsx("th",{className:"border border-black text-center align-middle",children:""}),S.jsx("th",{className:"border border-black text-center align-middle",children:""}),S.jsx("th",{className:"border border-black text-center align-middle",children:""}),S.jsx("th",{className:"border border-black text-center align-middle",children:""})]})]}),S.jsx("tbody",{children:z.map((Y,ie)=>{if(!Y)return S.jsxs("tr",{className:"h-[7mm] bg-gray-100/30",children:[S.jsx("td",{className:"border border-black"}),S.jsx("td",{className:"border border-black"}),S.jsx("td",{className:"border border-black"}),S.jsx("td",{className:"border border-black"}),S.jsx("td",{className:"border border-black"})]},ie);const N=bt(Y,"yyyy-MM-dd"),Q=bt(Y,"E",{locale:Zd}),H=T.assignments.filter(Z=>Z.date===N),te=H[0],ee=H[1];return S.jsxs("tr",{className:"h-[7mm] text-[7pt] text-black",children:[S.jsxs("td",{className:`border border-black text-center font-bold tracking-tighter align-middle p-0 ${Q===""?"text-blue-700":Q===""?"text-red-600":"text-black"}`,children:[bt(Y,"d"),"(",Q,")"]}),S.jsx("td",{className:"border border-black text-center break-all align-middle p-0.5",children:te==null?void 0:te.supervisor_name}),S.jsx("td",{className:"border border-black text-center align-middle p-0.5",children:(te==null?void 0:te.signature_url)&&S.jsx("img",{src:te.signature_url,className:"max-h-[18px] w-auto mx-auto object-contain",alt:""})}),S.jsx("td",{className:"border border-black text-center break-all align-middle p-0.5",children:ee==null?void 0:ee.supervisor_name}),S.jsx("td",{className:"border border-black text-center align-middle p-0.5",children:(ee==null?void 0:ee.signature_url)&&S.jsx("img",{src:ee.signature_url,className:"max-h-[18px] w-auto mx-auto object-contain",alt:""})})]},ie)})})]})},W)})}catch{return S.jsx("div",{className:"w-full text-center text-red-500",children:"  "})}})()}),S.jsx("div",{className:"mt-2 text-center text-[9pt] font-bold flex-none text-black",children:"      .  "})]})]}),document.body)]})},W8=({onSelectSeat:e})=>{const t=ve.useRef(null),r=ve.useRef(null),[n,i]=ve.useState(null),[a,l]=ve.useState(!1),[o,s]=ve.useState(null),[c,d]=ve.useState([]),[f,h]=ve.useState([]);ve.useEffect(()=>{let m=!0;return(async()=>{const{data:{user:v}}=await je.auth.getUser();if(!m)return;if(v){const{data:w}=await je.from("profiles").select("*").eq("id",v.id).single();if(!m)return;s(w)}const{data:x}=await je.from("sessions").select("*").order("start_time",{ascending:!0});if(!m||(d(x||[]),!t.current))return;r.current&&r.current.dispose(),t.current.innerHTML="";const y=document.createElement("canvas");t.current.appendChild(y);const _=new Qe.fabric.Canvas(y,{backgroundColor:"transparent",selection:!1,hoverCursor:"pointer",moveCursor:"grab"});r.current=_,await u(_,x),m&&(_.on("mouse:down",w=>{var T,k,O,F;if(!w.target)_.isDragging=!0,_.selection=!1,_.lastPosX=w.e.clientX||((k=(T=w.e.touches)==null?void 0:T[0])==null?void 0:k.clientX),_.lastPosY=w.e.clientY||((F=(O=w.e.touches)==null?void 0:O[0])==null?void 0:F.clientY);else if(w.target.data){const M=w.target.data;i(M),e(M),_.getObjects().forEach(V=>{V.type==="group"&&V.item(0).set("stroke","rgba(255,255,255,0.1)")}),w.target.item(0).set("stroke","#ffffff"),w.target.item(0).set("strokeWidth",3),_.renderAll()}else i(null),e(null)}),_.on("mouse:move",w=>{var T,k,O,F;if(_.isDragging){const M=w.e,V=M.clientX||((k=(T=M.touches)==null?void 0:T[0])==null?void 0:k.clientX),X=M.clientY||((F=(O=M.touches)==null?void 0:O[0])==null?void 0:F.clientY),q=_.viewportTransform;q[4]+=V-_.lastPosX,q[5]+=X-_.lastPosY,_.requestRenderAll(),_.lastPosX=V,_.lastPosY=X}}),_.on("mouse:wheel",w=>{var M;const T=w.e.deltaY,k=_.viewportTransform;k[5]-=T;const O=_.getHeight(),F=((M=t.current)==null?void 0:M.clientHeight)||0;k[5]>0&&(k[5]=0),F>0&&k[5]<-(O-F)&&(k[5]=-(O-F)),_.requestRenderAll(),w.e.preventDefault(),w.e.stopPropagation()}),_.on("mouse:up",()=>{_.setViewportTransform(_.viewportTransform),_.isDragging=!1,_.selection=!1}))})(),()=>{m=!1,r.current&&(r.current.dispose(),r.current=null)}},[]);const u=async(m,g,v)=>{var w,T;l(!0);const x=new Date().toISOString().split("T")[0],{data:y}=await je.from("seats").select("*").order("global_number",{ascending:!0}),{data:_}=await je.from("bookings").select("*, profiles(username, full_name)").eq("date",x);if(y&&y.length>0){m.clear();const k=Math.min(...y.map(E=>E.pos_x)),F=Math.max(...y.map(E=>E.pos_x+(E.width||72)))-k,M=((w=t.current)==null?void 0:w.clientWidth)||F,V=Math.max(F,M),X=(V-F)/2-k,q=Math.min(...y.map(E=>E.pos_y)),ne=Math.max(...y.map(E=>E.pos_y+(E.height||72)))-q,re=-q,le=((T=t.current)==null?void 0:T.clientHeight)||0,se=Math.max(ne,le);m.setDimensions({width:V,height:se});const C=new Date,j=C.getHours().toString().padStart(2,"0")+":"+C.getMinutes().toString().padStart(2,"0")+":00",L=g==null?void 0:g.find(E=>j>=E.start_time&&j<=E.end_time);y.forEach(E=>{const I=(_==null?void 0:_.filter(A=>A.seat_id===E.id))||[];p(m,{...E,pos_x:E.pos_x+X,pos_y:E.pos_y+re},I,L,g)})}l(!1)},p=(m,g,v,x,y)=>{if(g.type==="structure"){const ae=new Qe.fabric.Rect({fill:"#E5E5EA",width:g.width||72,height:g.height||72,rx:6,ry:6,stroke:"#D1D1D6",strokeWidth:1}),ne=new Qe.fabric.IText(g.label||"",{fontSize:10,originX:"center",originY:"center",left:(g.width||72)/2,top:(g.height||72)/2,fill:"#AEAEB2",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),re=new Qe.fabric.Group([ae,ne],{left:g.pos_x,top:g.pos_y,angle:g.rotation,selectable:!1,evented:!1,data:{...g}});m.add(re);return}const _=v.find(ae=>ae.session_id===(x==null?void 0:x.id)),w=!!_,T=ae=>o?!!(["admin","teacher"].includes(o.role)||ae.user_id===o.id):!1,k=g.zone_color||"#5E5CE6",O=new Qe.fabric.Rect({fill:k,opacity:w?1:.25,width:72,height:72,rx:6,ry:6,stroke:"rgba(255,255,255,0.1)",strokeWidth:2}),F=new Qe.fabric.IText(g.display_number||g.seat_number,{fontSize:12,left:6,top:6,fill:w?"#ffffff":"#1C1C1E",fontFamily:"Inter, -apple-system",fontWeight:"900",selectable:!1});let M="";w?T(_)?M=`${_.profiles.username}
${_.profiles.full_name}`:M="":v.length>0&&(M="...");const V=new Qe.fabric.IText(M,{fontSize:10,textAlign:"center",originX:"center",originY:"center",left:36,top:36,fill:w?"#ffffff":"#1C1C1E",fontFamily:"Inter, -apple-system",fontWeight:"600",selectable:!1,opacity:w?1:.8}),X=y.map((ae,ne)=>{const re=v.some(se=>se.session_id===ae.id),le=ae.id===(x==null?void 0:x.id);return new Qe.fabric.Rect({left:6+ne*15,top:60,width:12,height:4,rx:1,ry:1,fill:re?le?"#30D158":w?"#ffffff":"#8E8E93":w?"rgba(255,255,255,0.2)":"rgba(0,0,0,0.05)",stroke:le?"rgba(48, 209, 88, 0.5)":null,strokeWidth:le?1:0})}),q=new Qe.fabric.Group([O,F,V,...X],{left:g.pos_x,top:g.pos_y,angle:g.rotation,data:{...g,seatBookings:v,activeSession:x},selectable:!1,hoverCursor:"pointer"});m.add(q)};return S.jsxs("div",{className:"flex flex-col gap-6 w-full h-full relative overflow-hidden",children:[a&&S.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-30 flex items-center justify-center",children:S.jsx("div",{className:"w-8 h-8 border-3 border-ios-indigo border-t-transparent rounded-full animate-spin"})}),S.jsx("div",{ref:t,className:"flex-1 h-full relative overflow-hidden cursor-grab active:cursor-grabbing touch-none select-none scrollbar-hide"})]})},H8=({user:e})=>{const[t,r]=ve.useState("idle"),[n,i]=ve.useState(""),a=async()=>{if(r("locating"),i("Verifying your location..."),!navigator.geolocation){r("error"),i("Geolocation is not supported by your browser.");return}navigator.geolocation.getCurrentPosition(async l=>{const{latitude:o,longitude:s,accuracy:c}=l.coords,{data:d}=await je.from("configs").select("value").eq("key","gps_settings").single();if(!d){r("error"),i("GPS   .  .");return}const{lat:f,lng:h,radius:u}=d.value,p=6371e3,m=o*Math.PI/180,g=f*Math.PI/180,v=(f-o)*Math.PI/180,x=(h-s)*Math.PI/180,y=Math.sin(v/2)*Math.sin(v/2)+Math.cos(m)*Math.cos(g)*Math.sin(x/2)*Math.sin(x/2),_=2*Math.atan2(Math.sqrt(y),Math.sqrt(1-y)),w=p*_;w<=u?(r("verified"),i(" !   ..."),setTimeout(()=>r("done"),1500)):(r("error"),c>1e3?i(`  . ( : ${Math.round(c)}m)
             PC  GPS   . 
                '' 'GPS'   .`):i(`   .
               ${Math.round(w)}m  .
            ( : ${u}m)
            
            Tip:   GPS    ,      .`),console.log("GPS Verification Debug:",{user:{lat:o,lng:s,accuracy:c},target:{lat:f,lng:h,radius:u},calculatedDistance:w}))},l=>{r("error"),i("    . GPS   .")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})};return S.jsxs("div",{className:"ios-glass rounded-ios p-12 max-w-lg w-full text-center space-y-10 relative overflow-hidden animate-spring-up shadow-3xl",children:[S.jsx("div",{className:"absolute top-0 left-0 w-32 h-32 bg-ios-indigo/5 blur-3xl -z-10"}),S.jsx("div",{className:`w-24 h-24 rounded-[2rem] mx-auto flex items-center justify-center transition-all duration-700 shadow-inner-white ${t==="verified"||t==="done"?"bg-ios-emerald/20 text-ios-emerald shadow-ios-emerald/20":t==="error"?"bg-ios-rose/20 text-ios-rose shadow-ios-rose/20":t==="locating"?"bg-ios-indigo/20 text-ios-indigo shadow-ios-indigo/20 animate-pulse":"bg-white/5 text-white/30"}`,children:t==="done"?S.jsx(id,{className:"w-12 h-12"}):t==="error"?S.jsx(ri,{className:"w-12 h-12"}):t==="locating"?S.jsx(ad,{className:"w-12 h-12"}):S.jsx(v1,{className:"w-12 h-12"})}),S.jsxs("div",{className:"space-y-4",children:[S.jsx("h3",{className:"text-3xl font-black tracking-tight text-white",children:t==="done"?"  ":t==="locating"?"  ":"  "}),S.jsx("p",{className:"text-ios-gray font-medium text-lg leading-relaxed px-4",children:n||"     GPS  ."})]}),t!=="done"&&S.jsx("button",{onClick:a,disabled:t==="locating",className:`w-full py-6 rounded-2xl font-black text-lg transition-all shadow-2xl ios-tap ${t==="locating"?"bg-white/5 text-white/20":t==="error"?"bg-ios-rose text-white shadow-ios-rose/30":"bg-white text-black"}`,children:t==="locating"?"  ...":"  "})]})},z8=({selectedSeat:e,onComplete:t})=>{const[r,n]=ve.useState(1),[i,a]=ve.useState(bt(Ba(new Date,2),"yyyy-MM-dd")),[l,o]=ve.useState(bt(Ba(new Date,2),"yyyy-MM-dd")),[s,c]=ve.useState([]),[d,f]=ve.useState([]),[h,u]=ve.useState(null),[p,m]=ve.useState({quarters:[],defaults:[],exceptions:[]}),[g,v]=ve.useState([]),[x,y]=ve.useState(!1),[_,w]=ve.useState(""),T={Morning:" ",Dinner:" ","1st Period":"1","2nd Period":"2"},k=q=>T[q]||q;ve.useEffect(()=>{(async()=>{y(!0);const{data:{user:ae}}=await je.auth.getUser();if(ae){const{data:P}=await je.from("profiles").select("*").eq("id",ae.id).single();u(P)}const[ne,re,le,se]=await Promise.all([je.from("sessions").select("*").order("id",{ascending:!0}),je.from("operation_quarters").select("*"),je.from("operation_defaults").select("*"),je.from("operation_exceptions").select("*")]);ne.data&&c(ne.data);const C=re.data||[],j=le.data||[],L=se.data||[];m({quarters:C,defaults:j,exceptions:L});let E=As(Ba(new Date,2)),I=!1,A=0;const b=90;for(;!I&&A<b;){const P=bt(E,"yyyy-MM-dd"),R=C.some(N=>N.start_date&&N.end_date&&du(E,{start:Fr(N.start_date),end:Fr(N.end_date)})),W=L.some(N=>N.exception_date===P),z=E.getDay(),Y=j.find(N=>N.day_of_week===z),ie=Y&&(Y.morning||Y.dinner||Y.period1||Y.period2);R&&!W&&ie?(a(P),o(P),I=!0):(E=Ba(E,1),A++)}y(!1)})()},[]),ve.useEffect(()=>{h&&i&&O(),f([])},[h,i]);const O=async()=>{const{data:q}=await je.from("bookings").select("*").eq("user_id",h.id).eq("date",i);v(q||[])},F=q=>{const ae=Fr(q),ne=As(Ba(new Date,2));if($6(ae,ne))return{ok:!1,msg:`   2  . ( : ${bt(ne,"M d")}~)`};if(!p.quarters.some(L=>L.start_date&&L.end_date&&du(ae,{start:Fr(L.start_date),end:Fr(L.end_date)})))return{ok:!1,msg:"    ."};const le=p.exceptions.find(L=>L.exception_date===q);if(le)return{ok:!1,msg:`: ${le.reason}`};const se=ae.getDay(),C=p.defaults.find(L=>L.day_of_week===se);return C&&(C.morning||C.dinner||C.period1||C.period2)?{ok:!0}:{ok:!1,msg:"   ."}},M=()=>{if(r===1){const q=F(i);if(!q.ok){w(q.msg);return}if(g.length>0&&g[0].seat_id!==e.id){w(`  ${g[0].seat_number}  .      .`);return}}w(""),n(q=>q+1)},V=q=>{f(ae=>ae.find(re=>re.id===q.id)?ae.filter(re=>re.id!==q.id):[...ae,q].sort((re,le)=>re.id-le.id))},X=async()=>{if(d.length===0)return;y(!0);const q=d.map(ne=>({user_id:h.id,seat_id:e.id,session_id:ne.id,date:i})),{error:ae}=await je.from("bookings").insert(q);ae?alert("    ."):(alert(` .
${i}
: ${d.map(ne=>ne.name).join(", ")}
: ${e.display_number||e.seat_number}`),t()),y(!1)};return S.jsxs("div",{className:"bg-white border border-gray-100 border-b-0 rounded-t-[6px] rounded-b-none pt-[10px] px-6 pb-6 lg:px-8 lg:pb-8 space-y-5 animate-spring-up overflow-hidden relative h-full",children:[S.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-ios-indigo/5 blur-2xl -z-10"}),S.jsxs("div",{className:"bg-gray-50/50 rounded-[6px] mt-[10px] pt-4 px-4 pb-4 flex items-center gap-4 border border-gray-100",children:[S.jsx("div",{className:"w-12 h-12 rounded-[6px] bg-white text-[#000000] flex items-center justify-center font-black text-sm border border-gray-200 shadow-sm",children:e.display_number||e.seat_number}),S.jsxs("div",{children:[S.jsx("p",{className:"text-[9px] font-black text-[#000000] uppercase tracking-[0.2em] mb-0.5 opacity-50",children:"  "}),S.jsxs("p",{className:"text-base font-black text-[#1C1C1E]",children:["Zone ",e.zone_name]})]})]}),S.jsx("div",{className:"flex items-center gap-2",children:[1,2,3].map(q=>S.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-all duration-700 ${r>=q?"bg-[#1C1C1E]":"bg-gray-100"}`},q))}),r===1&&S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center",children:S.jsx(rd,{className:"w-5 h-5 text-ios-indigo"})}),S.jsx("h3",{className:"text-xl font-black tracking-tight text-[#1C1C1E]",children:"  "})]}),S.jsxs("div",{className:"space-y-3",children:[S.jsx("input",{type:"date",value:i,min:bt(Ba(new Date,2),"yyyy-MM-dd"),onChange:q=>a(q.target.value),className:"w-full bg-gray-50 border border-gray-200 rounded-[6px] p-4 text-lg focus:ring-1 focus:ring-ios-indigo transition-all font-black text-[#1C1C1E]"}),S.jsxs("div",{className:"bg-amber-50 p-5 rounded-[6px] border border-amber-100",children:[S.jsxs("p",{className:"font-black text-ios-amber text-[9px] mb-1 uppercase tracking-widest flex items-center gap-1.5",children:[S.jsx(fs,{className:"w-2.5 h-2.5"})," T-2  "]}),S.jsxs("p",{className:"text-amber-900/70 text-xs leading-relaxed font-medium",children:["     2  .",S.jsx("br",{}),S.jsxs("span",{className:"text-amber-900 font-bold",children:["   : ",bt(Fr(l),"M d")," "]})]})]})]}),_&&S.jsxs("div",{className:"p-4 bg-ios-rose/5 border border-ios-rose/10 rounded-[6px] flex items-center gap-2 animate-shake",children:[S.jsx(ri,{className:"w-4 h-4 text-ios-rose"}),S.jsx("p",{className:"text-[11px] font-black text-ios-rose",children:_})]}),S.jsxs("div",{className:"flex gap-2",children:[S.jsx("button",{onClick:()=>t(),className:"flex-1 bg-gray-100 text-[#1C1C1E] py-4 rounded-[6px] font-black text-xs transition-all hover:bg-gray-200 ios-tap",children:""}),S.jsx("button",{onClick:M,className:"flex-[3] bg-[#1C1C1E] text-white py-4 rounded-[6px] font-black text-xs transition-all shadow-md ios-tap",children:"  "})]})]}),r===2&&S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center",children:S.jsx(zo,{className:"w-5 h-5 text-ios-indigo"})}),S.jsx("h3",{className:"text-xl font-black tracking-tight text-[#1C1C1E]",children:"  "})]}),S.jsx("p",{className:"text-[11px] font-black text-ios-gray px-1",children:"      . (  )"}),S.jsx("div",{className:"grid grid-cols-1 gap-3",children:s.map(q=>{const ae=Fr(i).getDay(),ne=p.defaults.find(C=>C.day_of_week===ae),re=q.id===1?ne==null?void 0:ne.morning:q.id===2?ne==null?void 0:ne.dinner:q.id===3?ne==null?void 0:ne.period1:q.id===4?ne==null?void 0:ne.period2:!1,le=g.some(C=>C.session_id===q.id),se=d.some(C=>C.id===q.id);return re?S.jsxs("button",{disabled:le,onClick:()=>V(q),className:`p-4 rounded-[6px] border transition-all duration-300 flex items-center justify-between group ios-tap text-left ${se?"border-[#1C1C1E] bg-[#1C1C1E]/5 shadow-sm":le?"opacity-40 bg-gray-100 cursor-not-allowed":"border-gray-200 bg-gray-50 hover:bg-gray-100"}`,children:[S.jsxs("div",{className:"flex-1 flex flex-col items-start",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("p",{className:"font-black text-base text-[#1C1C1E]",children:k(q.name)}),le&&S.jsx("span",{className:"text-[9px] font-black text-ios-gray bg-gray-200 px-1.5 py-0.5 rounded-full uppercase",children:" "})]}),S.jsxs("p",{className:"text-[10px] font-black text-ios-gray/70 uppercase tracking-tight mt-0.5",children:[q.start_time.slice(0,5)," ~ ",q.end_time.slice(0,5)]})]}),se?S.jsx("div",{className:"w-5 h-5 rounded-full bg-[#1C1C1E] flex items-center justify-center shadow-sm",children:S.jsx(fs,{className:"w-3 h-3 text-white stroke-[3px]"})}):S.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-gray-300 bg-white"})]},q.id):null})}),_&&S.jsxs("div",{className:"p-4 bg-ios-rose/5 border border-ios-rose/10 rounded-[6px] flex items-center gap-2 animate-shake",children:[S.jsx(ri,{className:"w-4 h-4 text-ios-rose"}),S.jsx("p",{className:"text-[11px] font-black text-ios-rose",children:_})]}),S.jsxs("div",{className:"flex gap-2",children:[S.jsx("button",{onClick:()=>t(),className:"px-6 bg-gray-100 text-[#1C1C1E] py-4 rounded-[6px] font-black text-xs transition-all hover:bg-gray-200 ios-tap",children:""}),S.jsx("button",{onClick:()=>n(1),className:"flex-1 py-4 bg-gray-100 text-ios-gray rounded-[6px] font-black text-xs ios-tap",children:""}),S.jsxs("button",{disabled:d.length===0,onClick:M,className:"flex-[2] bg-[#1C1C1E] text-white py-4 rounded-[6px] font-black text-xs transition-all shadow-md disabled:opacity-20 ios-tap",children:[d.length,"   "]})]})]}),r===3&&S.jsxs("div",{className:"space-y-8",children:[S.jsxs("div",{className:"text-center space-y-3",children:[S.jsx("div",{className:"w-12 h-12 rounded-[6px] bg-emerald-50 text-ios-emerald flex items-center justify-center mx-auto border border-emerald-100",children:S.jsx(fs,{className:"w-6 h-6"})}),S.jsxs("div",{className:"space-y-1.5",children:[S.jsx("h3",{className:"text-2xl font-black tracking-tight text-[#1C1C1E]",children:" "}),S.jsx("p",{className:"text-xs text-ios-gray font-medium",children:"    ."})]})]}),S.jsx("div",{className:"space-y-1.5",children:[{label:" ",value:bt(Fr(i),"yyyy M d (EEEE)",{locale:Zd}),color:"text-[#1C1C1E]"},{label:" ",value:d.map(q=>k(q.name)).join(", "),color:"text-[#1C1C1E]"},{label:" ",value:`${e.seat_number}`,color:"text-[#1C1C1E]"},{label:" ",value:e.zone_name,color:"text-[#1C1C1E]"}].map((q,ae)=>S.jsxs("div",{className:"flex justify-between items-center p-4 rounded-[6px] bg-gray-50 border border-gray-100",children:[S.jsx("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest leading-none",children:q.label}),S.jsx("span",{className:`text-sm font-black text-right max-w-[200px] ${q.color}`,children:q.value})]},ae))}),S.jsxs("div",{className:"flex gap-2",children:[S.jsx("button",{onClick:()=>t(),className:"flex-1 bg-gray-100 text-[#1C1C1E] py-5 rounded-[6px] font-black text-base transition-all hover:bg-gray-200 ios-tap",children:""}),S.jsxs("button",{disabled:x,onClick:X,className:"flex-[2] bg-[#1C1C1E] text-white py-5 rounded-[6px] font-black text-base transition-all shadow-lg shadow-black/20 flex items-center justify-center gap-3 ios-tap overflow-hidden relative group disabled:opacity-50",children:[x?" ...":" "," ",S.jsx(nd,{className:"w-5 h-5"})]})]})]})]})},V8=({user:e})=>{const[t,r]=ve.useState(""),[n,i]=ve.useState([]),[a,l]=ve.useState(!1),o=[{date:"2026-01-20",status:"present"},{date:"2026-01-21",status:"present"},{date:"2026-01-22",status:"late"},{date:"2026-01-23",status:"absent"}],s=async()=>{l(!0),setTimeout(()=>{alert("Your study plan has been synchronized."),l(!1)},1e3)},c=Qd({start:hu(new Date),end:fu(new Date)});return S.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-10 animate-spring-up overflow-visible",children:[S.jsxs("div",{className:"xl:col-span-2 space-y-10",children:[S.jsxs("div",{className:"ios-glass rounded-ios p-8 lg:p-12 space-y-8 relative overflow-hidden",children:[S.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-ios-indigo/5 blur-3xl -z-10"}),S.jsxs("div",{className:"flex items-center gap-5",children:[S.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gradient-to-br from-ios-indigo to-ios-blue text-white flex items-center justify-center shadow-xl shadow-ios-indigo/20",children:S.jsx(qS,{className:"w-7 h-7"})}),S.jsxs("div",{children:[S.jsx("h3",{className:"text-2xl font-black tracking-tight",children:"  "}),S.jsx("p",{className:"text-ios-gray font-medium",children:"    ."})]})]}),S.jsx("textarea",{value:t,onChange:d=>r(d.target.value),placeholder:"  ... (:    50 )",className:"w-full h-48 bg-white/5 border border-white/10 rounded-3xl p-8 text-[15px] focus:ring-2 focus:ring-ios-indigo focus:bg-white/10 transition-all resize-none font-bold placeholder:text-ios-gray/50 leading-relaxed"}),S.jsxs("button",{onClick:s,disabled:a,className:"w-full py-5 bg-white text-black rounded-2xl font-black text-sm hover:scale-[1.02] active:scale-[0.98] transition-all shadow-2xl flex items-center justify-center gap-3 ios-tap",children:[a?S.jsx(zo,{className:"w-5 h-5 animate-spin"}):S.jsx(Gk,{className:"w-5 h-5"}),a?" ...":"    "]})]}),S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[{label:" ",value:"12",icon:dg,color:"text-ios-amber",bg:"bg-ios-amber/10"},{label:"",value:"98%",icon:id,color:"text-ios-emerald",bg:"bg-ios-emerald/10"},{label:" ",value:"1",icon:Kk,color:"text-ios-rose",bg:"bg-ios-rose/10"}].map((d,f)=>S.jsxs("div",{className:"ios-glass rounded-[2rem] p-8 flex flex-col items-center text-center gap-5 group hover:bg-white/10 transition-all duration-500 ios-tap",children:[S.jsx("div",{className:`w-16 h-16 rounded-[1.5rem] ${d.bg} ${d.color} flex items-center justify-center shadow-inner-white group-hover:scale-110 transition-transform`,children:S.jsx(d.icon,{className:"w-8 h-8"})}),S.jsxs("div",{children:[S.jsx("p",{className:"text-[11px] uppercase font-black text-ios-gray tracking-widest mb-1",children:d.label}),S.jsx("p",{className:"text-3xl font-black text-white",children:d.value})]})]},f))})]}),S.jsxs("div",{className:"space-y-10",children:[S.jsxs("div",{className:"ios-glass rounded-ios p-10 border-white/5 shadow-inner-white",children:[S.jsx("div",{className:"flex items-center justify-between mb-10",children:S.jsxs("h3",{className:"text-xl font-black flex items-center gap-3",children:[S.jsx("div",{className:"w-10 h-10 rounded-xl bg-ios-indigo/20 flex items-center justify-center",children:S.jsx(rd,{className:"w-5 h-5 text-ios-indigo"})}),"  "]})}),S.jsx("div",{className:"grid grid-cols-7 gap-3 text-center mb-6",children:["","","","","","",""].map((d,f)=>S.jsx("span",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest",children:d},f))}),S.jsx("div",{className:"grid grid-cols-7 gap-3",children:c.map((d,f)=>{const h=bt(d,"yyyy-MM-dd"),u=o.find(m=>m.date===h),p=J_(d);return S.jsxs("div",{className:`aspect-square rounded-2xl flex items-center justify-center text-[12px] font-black transition-all duration-500 ios-tap relative group ${p?"bg-white text-black shadow-2xl scale-[1.15] z-10":(u==null?void 0:u.status)==="present"?"bg-ios-emerald/20 text-ios-emerald":(u==null?void 0:u.status)==="late"?"bg-ios-amber/20 text-ios-amber":(u==null?void 0:u.status)==="absent"?"bg-ios-rose/20 text-ios-rose":"bg-white/5 text-white/30 hover:bg-white/10 hover:text-white"}`,children:[bt(d,"d"),u&&!p&&S.jsx("div",{className:`absolute bottom-1 w-1 h-1 rounded-full ${u.status==="present"?"bg-ios-emerald":u.status==="late"?"bg-ios-amber":"bg-ios-rose"}`})]},f)})}),S.jsx("div",{className:"mt-10 pt-8 border-t border-white/10",children:S.jsxs("div",{className:"flex flex-col gap-4",children:[S.jsx("span",{className:"text-[11px] font-black text-ios-gray uppercase tracking-[0.2em]",children:" "}),S.jsx("div",{className:"flex flex-wrap gap-4",children:[{label:"",color:"bg-ios-emerald"},{label:"",color:"bg-ios-amber"},{label:"",color:"bg-ios-rose"}].map(d=>S.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/5 border border-white/5",children:[S.jsx("span",{className:`w-2 h-2 rounded-full ${d.color} shadow-lg`}),S.jsx("span",{className:"text-[11px] font-black text-white/70",children:d.label})]},d.label))})]})})]}),S.jsxs("div",{className:"bg-gradient-to-br from-ios-indigo via-[#7D7AFF] to-[#9B99FF] rounded-ios p-10 text-white shadow-2xl shadow-ios-indigo/30 relative overflow-hidden group ios-tap",children:[S.jsxs("div",{className:"relative z-10",children:[S.jsx("div",{className:"w-14 h-14 rounded-2xl bg-white/20 backdrop-blur-md flex items-center justify-center mb-6 shadow-inner-white",children:S.jsx(dg,{className:"w-8 h-8 text-white"})}),S.jsx("h4",{className:"text-2xl font-black tracking-tight mb-2",children:" "}),S.jsxs("p",{className:"text-[15px] text-white/80 font-medium mb-8 leading-relaxed",children:[" 5%  .",S.jsx("br",{}),"   ."]}),S.jsx("button",{className:"w-full py-4 bg-black/20 hover:bg-black/40 rounded-2xl text-xs font-black uppercase tracking-widest transition-all backdrop-blur-sm border border-white/10",children:" "})]}),S.jsx("div",{className:"absolute -right-16 -top-16 w-64 h-64 bg-white/10 rounded-full blur-3xl group-hover:scale-150 transition-transform duration-[2000ms]"}),S.jsx("div",{className:"absolute left-[-10%] bottom-[-10%] w-40 h-40 bg-white/5 rounded-full blur-2xl group-hover:translate-x-10 transition-transform duration-[2000ms]"})]})]})]})},X8=()=>{const[e,t]=ve.useState([]),[r,n]=ve.useState(!1),[i,a]=ve.useState(""),[l,o]=ve.useState("all"),[s,c]=ve.useState(""),[d,f]=ve.useState(null),[h,u]=ve.useState("id-asc");ve.useEffect(()=>{p()},[]);const p=async()=>{n(!0);const{data:x,error:y}=await je.from("applicant_pool").select("*").order("name",{ascending:!0});y?console.error("Error fetching applicants:",y):t(x||[]),n(!1)},m=async x=>{const y=x.target.files[0];if(!y)return;n(!0);const _=new FileReader;_.onload=async w=>{const T=w.target.result,k=s0(T,{type:"binary"}),O=k.SheetNames[0],F=k.Sheets[O],V=_c.sheet_to_json(F).map(q=>({name:q.,student_id:String(q.).padStart(5,"0"),role:q.===""?"parent":q.===""?"teacher":q.===""?"admin":"student",status:"applied"})).filter(q=>q.name&&q.student_id),{error:X}=await je.from("applicant_pool").upsert(V,{onConflict:"name,student_id"});X?alert("  : "+X.message):(alert(`${V.length}   .`),p()),n(!1)},_.readAsBinaryString(y)},g=async(x,y,_="",w=x.role)=>{n(!0);const{error:T}=await je.from("applicant_pool").update({status:y,rejection_reason:_,role:w}).eq("id",x.id);T?alert("  : "+T.message):(p(),f(null),c("")),n(!1)},v=e.filter(x=>{const y=x.name.includes(i)||x.student_id.includes(i),_=l==="all"||x.status===l,w=h==="grade-1"?x.student_id.startsWith("1"):h==="grade-2"?x.student_id.startsWith("2"):h==="grade-3"?x.student_id.startsWith("3"):!0;return y&&_&&w}).sort((x,y)=>h==="name-asc"?x.name.localeCompare(y.name):h==="name-desc"?y.name.localeCompare(x.name):h==="id-asc"||h.startsWith("grade")?x.student_id.localeCompare(y.student_id):h==="id-desc"?y.student_id.localeCompare(x.student_id):0);return S.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 flex flex-col h-full overflow-hidden shadow-sm animate-spring-up",children:[S.jsxs("div",{className:"p-6 border-b border-gray-50 flex flex-col md:flex-row md:items-center justify-between gap-4 shrink-0",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center",children:S.jsx(od,{className:"w-5 h-5 text-ios-indigo"})}),S.jsxs("div",{children:[S.jsx("h3",{className:"text-[14px] font-black text-[#1C1C1E]",children:"    "}),S.jsx("p",{className:"text-[10px] text-ios-gray font-black uppercase tracking-widest mt-0.5",children:"Applicant Pool Management"})]})]}),S.jsx("div",{className:"flex items-center gap-2",children:S.jsxs("label",{className:"flex items-center gap-2 bg-gray-50 hover:bg-gray-100 text-[#1C1C1E] px-4 py-2.5 rounded-[6px] text-xs font-black transition-all border border-gray-100 cursor-pointer ios-tap",children:[S.jsx(Jk,{className:"w-4 h-4 text-ios-indigo"})," ",S.jsx("input",{type:"file",className:"hidden",accept:".xlsx,.xls",onChange:m})]})})]}),S.jsxs("div",{className:"px-6 py-4 bg-gray-50/50 border-b border-gray-50 flex flex-col md:flex-row gap-4 shrink-0",children:[S.jsxs("div",{className:"flex-1 relative",children:[S.jsx(m1,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray"}),S.jsxs("div",{className:"flex gap-2",children:[S.jsx("input",{type:"text",placeholder:"   ...",value:i,onChange:x=>a(x.target.value),className:"flex-1 bg-white border border-gray-200 rounded-[6px] pl-10 pr-4 py-2 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all"}),S.jsxs("select",{value:h,onChange:x=>u(x.target.value),className:"bg-white border border-gray-200 rounded-[6px] px-3 py-2 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all outline-none cursor-pointer min-w-[140px]",children:[S.jsx("option",{value:"id-asc",children:" ()"}),S.jsx("option",{value:"id-desc",children:" ()"}),S.jsx("option",{value:"name-asc",children:" ()"}),S.jsx("option",{value:"name-desc",children:" ()"}),S.jsx("option",{value:"grade-1",children:"1 ()"}),S.jsx("option",{value:"grade-2",children:"2 ()"}),S.jsx("option",{value:"grade-3",children:"3 ()"})]})]})]}),S.jsx("div",{className:"flex gap-2",children:["all","applied","pending","approved","rejected"].map(x=>S.jsx("button",{onClick:()=>o(x),className:`px-4 py-2 rounded-[6px] text-[10px] font-black uppercase tracking-widest transition-all ${l===x?"bg-[#1C1C1E] text-white shadow-md":"bg-white text-ios-gray border border-gray-200 hover:border-ios-indigo"}`,children:x==="all"?"":x==="applied"?"":x==="pending"?"":x==="approved"?"":""},x))})]}),S.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-hide",children:[S.jsxs("table",{className:"w-full text-left border-collapse",children:[S.jsx("thead",{className:"sticky top-0 bg-gray-50/90 backdrop-blur-sm z-10",children:S.jsxs("tr",{children:[S.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),S.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),S.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),S.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),S.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),S.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),S.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100 text-right",children:""})]})}),S.jsx("tbody",{children:v.map(x=>S.jsxs("tr",{className:"hover:bg-gray-50 transition-colors group",children:[S.jsx("td",{className:"px-6 py-4 text-xs font-mono font-black text-ios-indigo",children:x.student_id}),S.jsx("td",{className:"px-6 py-4 text-xs font-bold text-[#1C1C1E]",children:x.name}),S.jsx("td",{className:"px-6 py-4",children:S.jsx("span",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest",children:"Student"})}),S.jsx("td",{className:"px-6 py-4 text-xs font-medium text-ios-gray flex items-center gap-1.5",children:x.phone_number?S.jsxs(S.Fragment,{children:[S.jsx(jh,{className:"w-3 h-3 text-ios-emerald"}),x.phone_number]}):"-"}),S.jsx("td",{className:"px-6 py-4",children:x.pledge_accepted?S.jsxs("div",{className:"flex flex-col gap-0.5",children:[S.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-black text-ios-indigo",children:[S.jsx(sk,{className:"w-3 h-3"})," "]}),S.jsx("span",{className:"text-[9px] text-ios-gray opacity-50 font-mono",children:new Date(x.pledged_at).toLocaleDateString()})]}):S.jsx("span",{className:"text-[10px] font-black text-ios-gray opacity-30",children:""})}),S.jsx("td",{className:"px-6 py-4",children:x.status==="applied"?S.jsx("span",{className:"px-2 py-1 rounded-full text-[9px] font-black uppercase tracking-wider bg-gray-100 text-ios-gray",children:" "}):S.jsxs("select",{value:x.status,onChange:y=>g(x,y.target.value),className:`px-2 py-1 rounded-full text-[9px] font-black uppercase tracking-wider border-none focus:ring-1 transition-all cursor-pointer ${x.status==="approved"?"bg-ios-emerald/10 text-ios-emerald focus:ring-ios-emerald":x.status==="pending"?"bg-ios-amber/10 text-ios-amber focus:ring-ios-amber":x.status==="rejected"?"bg-ios-rose/10 text-ios-rose focus:ring-ios-rose":"bg-gray-100 text-ios-gray focus:ring-gray-300"}`,children:[S.jsx("option",{value:"pending",children:" "}),S.jsx("option",{value:"approved",children:""}),S.jsx("option",{value:"rejected",children:""}),S.jsx("option",{value:"applied",children:"  ()"})]})}),S.jsx("td",{className:"px-6 py-4 text-right",children:S.jsxs("div",{className:"flex items-center justify-end gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[x.status==="pending"&&S.jsxs(S.Fragment,{children:[S.jsx("button",{onClick:()=>g(x,"approved"),className:"p-1.5 rounded-[4px] bg-ios-emerald/10 text-ios-emerald hover:bg-ios-emerald text-white transition-all ios-tap",title:"",children:S.jsx(fs,{className:"w-3.5 h-3.5"})}),S.jsx("button",{onClick:()=>f(x),className:"p-1.5 rounded-[4px] bg-ios-rose/10 text-ios-rose hover:bg-ios-rose text-white transition-all ios-tap",title:"",children:S.jsx(go,{className:"w-3.5 h-3.5"})})]}),S.jsx("button",{className:"p-1.5 rounded-[4px] bg-gray-100 text-ios-gray hover:bg-gray-200 transition-all ios-tap",children:S.jsx(fk,{className:"w-3.5 h-3.5"})})]})})]},x.id))})]}),v.length===0&&S.jsxs("div",{className:"py-20 flex flex-col items-center justify-center text-ios-gray space-y-3",children:[S.jsx(ri,{className:"w-10 h-10 opacity-20"}),S.jsx("p",{className:"text-xs font-black",children:"  ."})]})]}),d&&S.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-50 flex items-center justify-center p-6",children:S.jsx("div",{className:"bg-white rounded-ios w-full max-w-sm shadow-2xl animate-spring-up overflow-hidden",children:S.jsxs("div",{className:"p-6 space-y-4",children:[S.jsxs("h4",{className:"text-[14px] font-black text-[#1C1C1E]",children:[d.name,"   "]}),S.jsx("textarea",{value:s,onChange:x=>c(x.target.value),placeholder:"  ... (:   )",className:"w-full h-32 bg-gray-50 border border-gray-200 rounded-[6px] p-3 text-xs font-bold focus:ring-1 focus:ring-ios-rose transition-all resize-none"}),S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsx("button",{onClick:()=>f(null),className:"w-full py-3 bg-gray-100 text-ios-gray rounded-[6px] text-xs font-black ios-tap",children:""}),S.jsx("button",{onClick:()=>g(d,"rejected",s),className:"w-full py-3 bg-ios-rose text-white rounded-[6px] text-xs font-black shadow-lg shadow-ios-rose/20 ios-tap",children:" "})]})]})})}),S.jsx("div",{className:"px-6 py-3 bg-gray-50/50 border-t border-gray-50 flex items-center justify-between shrink-0",children:S.jsxs("div",{className:"flex gap-6",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-ios-indigo"}),S.jsxs("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:[": ",e.length,""]})]}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-ios-amber"}),S.jsxs("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:[": ",e.filter(x=>x.status==="pending").length,""]})]}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-ios-emerald"}),S.jsxs("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:[": ",e.filter(x=>x.status==="approved").length,""]})]})]})})]})},$8=({onLoginSuccess:e})=>{const[t,r]=ve.useState("student"),[n,i]=ve.useState("login"),[a,l]=ve.useState({name:"",studentId:"",phone:"",password:"",pledgeAccepted:!1,privacyAccepted:!1}),[o,s]=ve.useState(!1),[c,d]=ve.useState(""),[f,h]=ve.useState(""),[u,p]=ve.useState(null),m=()=>d(""),g=k=>k.replace(/[^0-9]/g,"").replace(/^(\d{0,3})(\d{0,4})(\d{0,4})$/g,"$1-$2-$3").replace(/(-{1,2})$/g,""),v=k=>{r(k),i("login"),l({...a,name:"",studentId:"",phone:"",password:""}),m()},x=async k=>{k.preventDefault(),s(!0),d(""),t==="teacher"?await y():await _(),s(!1)},y=async()=>{const k=`${a.name}@goe.edu`,{data:O,error:F}=await je.auth.signInWithPassword({email:k,password:a.password});if(F){d("    .");return}const{data:M}=await je.from("profiles").select("*").eq("id",O.user.id).single();M?e({...M,full_name:M.full_name||a.name}):d("    .")},_=async()=>{const{data:k,error:O}=await je.from("applicant_pool").select("*").eq("name",a.name).eq("student_id",a.studentId).maybeSingle();if(O||!k){d("   /  .");return}if(p(k),t==="parent"&&(!k.phone_number||!k.pledge_accepted)){d("     .");return}k.status==="applied"?(l(F=>({...F,phone:"",pledgeAccepted:!1,privacyAccepted:!1})),i("pledge")):k.status==="pending"?i("pending"):k.status==="rejected"?(h(k.rejection_reason||"  ,   ."),i("rejected")):k.status==="approved"&&i("challenge")},w=async k=>{if(k.preventDefault(),!a.pledgeAccepted||!a.privacyAccepted){d("    .");return}if(a.phone.length<10){d("   .");return}s(!0);const{error:O}=await je.from("applicant_pool").update({phone_number:a.phone,pledge_accepted:!0,privacy_accepted:!0,pledged_at:new Date().toISOString(),status:"pending"}).eq("id",u.id);O?d("    ."):i("pending"),s(!1)},T=async k=>{k.preventDefault(),a.phone===u.phone_number?e({...u,full_name:u.name}):d("     .")};return S.jsx("div",{className:"min-h-screen bg-[#F2F2F7] flex items-center justify-center p-6 font-sans",children:S.jsxs("div",{className:"w-full max-w-md bg-white rounded-[2rem] shadow-2xl shadow-ios-indigo/10 overflow-hidden animate-spring-up border border-gray-100",children:[S.jsxs("div",{className:"bg-white p-10 text-[#1C1C1E] relative overflow-hidden border-b border-gray-100",children:[S.jsxs("div",{className:"relative z-10 space-y-2",children:[S.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gray-50 flex items-center justify-center mb-6 border border-gray-100 shadow-sm overflow-hidden",children:S.jsx(Mh,{className:"w-7 h-7 text-ios-indigo"})}),S.jsx("h1",{className:"text-3xl font-black tracking-tighter italic leading-none",children:"POGOK"}),S.jsx("p",{className:"text-[10px] font-black tracking-[0.3em] uppercase text-ios-indigo",children:"Study Cafe System"})]}),S.jsx("div",{className:"absolute -right-10 -top-10 w-40 h-40 bg-ios-indigo/5 rounded-full blur-3xl"})]}),S.jsxs("div",{className:"p-8 space-y-8",children:[n==="login"&&S.jsx("div",{className:"flex bg-gray-50 p-1.5 rounded-2xl gap-1",children:[{id:"student",label:"",icon:dk},{id:"parent",label:"",icon:od},{id:"teacher",label:"",icon:QS}].map(k=>S.jsxs("button",{onClick:()=>v(k.id),className:`flex-1 flex items-center justify-center gap-2 py-3 rounded-xl text-xs font-black transition-all ${t===k.id?"bg-white text-ios-indigo shadow-md":"text-ios-gray hover:text-[#1C1C1E]"}`,children:[S.jsx(k.icon,{className:`w-3.5 h-3.5 ${t===k.id?"text-ios-indigo":"text-ios-gray"}`}),k.label]},k.id))}),n==="login"&&S.jsxs("form",{onSubmit:x,className:"space-y-6",children:[S.jsxs("div",{className:"space-y-4",children:[S.jsxs("div",{className:"relative group",children:[S.jsx(Lh,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),S.jsx("input",{required:!0,type:"text",placeholder:t==="teacher"?" (ID)":" (ID)",value:a.name,onChange:k=>l({...a,name:k.target.value}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none"})]}),S.jsxs("div",{className:"relative group",children:[S.jsx(Sk,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),S.jsx("input",{required:!0,type:t==="teacher"?"password":"text",placeholder:t==="teacher"?" (PW)":" 5 (PW)",maxLength:t==="teacher"?void 0:5,value:t==="teacher"?a.password:a.studentId,onChange:k=>l(t==="teacher"?{...a,password:k.target.value}:{...a,studentId:k.target.value}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none"})]})]}),c&&S.jsxs("div",{className:"flex items-center gap-2 text-ios-rose bg-ios-rose/5 p-4 rounded-xl animate-shake",children:[S.jsx(ri,{className:"w-4 h-4 shrink-0"}),S.jsx("p",{className:"text-[11px] font-black",children:c})]}),S.jsx("button",{type:"submit",disabled:o,className:"w-full py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-sm flex items-center justify-center gap-2 hover:scale-[1.02] active:scale-[0.98] transition-all shadow-xl shadow-gray-200/50 ios-tap disabled:opacity-50",children:o?S.jsx(yf,{className:"w-4 h-4 animate-spin"}):S.jsxs(S.Fragment,{children:[" ",S.jsx(GS,{className:"w-4 h-4"})]})})]}),n==="pledge"&&S.jsxs("form",{onSubmit:w,className:"space-y-6 animate-spring-up",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight text-center",children:"  "}),S.jsx("p",{className:"text-[11px] text-ios-gray text-center font-bold",children:"      ."})]}),S.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 max-h-48 overflow-y-auto space-y-4 text-[11px] font-bold text-ios-gray leading-relaxed border border-gray-100",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[    ]"}),S.jsx("p",{children:"1.          ."}),S.jsx("p",{children:"2.       ."}),S.jsx("p",{children:"3.       ."})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[  ]"}),S.jsx("p",{children:"     ,      ."}),S.jsx("p",{children:"         ."})]})]}),S.jsxs("div",{className:"space-y-3",children:[S.jsxs("div",{className:"relative group",children:[S.jsx(jh,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),S.jsx("input",{required:!0,type:"tel",autoComplete:"off",placeholder:"   ( )",value:a.phone,onChange:k=>l({...a,phone:g(k.target.value)}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none"})]}),S.jsxs("label",{className:"flex items-start gap-3 p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100 transition-all border border-transparent hover:border-gray-200",children:[S.jsx("input",{type:"checkbox",checked:a.pledgeAccepted,onChange:k=>l({...a,pledgeAccepted:k.target.checked}),className:"mt-0.5"}),S.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:"     . ()"})]}),S.jsxs("label",{className:"flex items-start gap-3 p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100 transition-all border border-transparent hover:border-gray-200",children:[S.jsx("input",{type:"checkbox",checked:a.privacyAccepted,onChange:k=>l({...a,privacyAccepted:k.target.checked}),className:"mt-0.5"}),S.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:"    . ()"})]})]}),c&&S.jsx("div",{className:"text-ios-rose text-[11px] font-black text-center",children:c}),S.jsxs("div",{className:"flex gap-2",children:[S.jsx("button",{type:"button",onClick:()=>i("login"),className:"flex-1 py-4 bg-gray-100 text-ios-gray rounded-2xl font-black text-sm ios-tap",children:""}),S.jsx("button",{type:"submit",disabled:o,className:"flex-[2] py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-sm shadow-xl shadow-gray-200/50 ios-tap",children:o?S.jsx(yf,{className:"w-4 h-4 animate-spin mx-auto"}):"   "})]})]}),n==="pending"&&S.jsxs("div",{className:"text-center space-y-6 py-4 animate-spring-up",children:[S.jsx("div",{className:"w-20 h-20 rounded-[2rem] bg-ios-amber/10 flex items-center justify-center mx-auto mb-2 border border-ios-amber/20 shadow-inner",children:S.jsx(yf,{className:"w-10 h-10 text-ios-amber animate-spin"})}),S.jsxs("div",{className:"space-y-2",children:[S.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:"  "}),S.jsx("p",{className:"text-xs text-ios-gray font-medium leading-relaxed px-4",children:"   .      ."})]}),S.jsx("button",{onClick:()=>i("login"),className:"text-xs font-black text-ios-indigo uppercase tracking-widest",children:""})]}),n==="rejected"&&S.jsxs("div",{className:"text-center space-y-6 py-4 animate-spring-up",children:[S.jsx("div",{className:"w-20 h-20 rounded-[2rem] bg-ios-rose/10 flex items-center justify-center mx-auto mb-2 border border-ios-rose/20 shadow-inner",children:S.jsx(ri,{className:"w-10 h-10 text-ios-rose"})}),S.jsxs("div",{className:"space-y-2",children:[S.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:" "}),S.jsxs("div",{className:"bg-ios-rose/5 p-4 rounded-xl mt-4 max-w-[280px] mx-auto text-left",children:[S.jsx("p",{className:"text-[9px] font-black text-ios-rose/70 uppercase mb-1 tracking-widest",children:""}),S.jsx("p",{className:"text-[11px] font-bold text-ios-rose leading-relaxed",children:f})]})]}),S.jsx("button",{onClick:()=>i("login"),className:"w-full py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-xs shadow-xl shadow-gray-200/50 ios-tap uppercase tracking-widest",children:" "})]}),n==="challenge"&&S.jsxs("form",{onSubmit:T,className:"space-y-6 animate-spring-up",children:[S.jsxs("div",{className:"text-center space-y-4",children:[S.jsx("div",{className:"w-20 h-20 rounded-[2rem] bg-ios-emerald/10 flex items-center justify-center mx-auto border border-ios-emerald/20 shadow-inner",children:S.jsx(v1,{className:"w-10 h-10 text-ios-emerald"})}),S.jsxs("div",{className:"space-y-2",children:[S.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:" "}),S.jsx("p",{className:"text-[11px] text-ios-gray font-bold",children:"   ."})]})]}),S.jsxs("div",{className:"relative group",children:[S.jsx(jh,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),S.jsx("input",{required:!0,type:"tel",placeholder:"  ",value:a.phone,onChange:k=>l({...a,phone:g(k.target.value)}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none"})]}),c&&S.jsx("div",{className:"text-ios-rose text-[11px] font-black text-center animate-shake",children:c}),S.jsx("button",{type:"submit",className:"w-full py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-sm shadow-xl shadow-gray-200/50 ios-tap",children:"  "})]})]})]})})},G8=()=>{const[e,t]=ve.useState(new Date),[r,n]=ve.useState([]),[i,a]=ve.useState([]),[l,o]=ve.useState([]),[s,c]=ve.useState(!0),[d,f]=ve.useState(!1),[h,u]=ve.useState(!1),[p,m]=ve.useState({date:bt(new Date,"yyyy-MM-dd"),reason:"",is_closed:!0}),[g,v]=ve.useState(new Date().getFullYear()),[x,y]=ve.useState(new Date().getFullYear());ve.useEffect(()=>{_(g)},[g]);const _=async re=>{c(!0);const[le,se,C]=await Promise.all([je.from("operation_quarters").select("*").eq("academic_year",re).order("quarter",{ascending:!0}),je.from("operation_defaults").select("*").order("day_of_week",{ascending:!0}),je.from("operation_exceptions").select("*").order("exception_date",{ascending:!0})]),j=le.data||[],E=[1,2,3,4].map(A=>j.find(P=>P.quarter===A)||{quarter:A,start_date:null,end_date:null,academic_year:re}),I=j.filter(A=>A.quarter>4);n([...E,...I].sort((A,b)=>A.quarter-b.quarter)),se.data&&se.data.length>0?a(se.data):a([0,1,2,3,4,5,6].map(A=>({day_of_week:A,morning:!1,dinner:!1,period1:!1,period2:!1}))),C.data&&o(C.data),c(!1)},w=()=>{v(x)},T=(re,le,se)=>{const C=r.map(j=>j.quarter===re?{...j,[le]:se}:j);n(C)},k=async()=>{f(!0);const re=r.filter(se=>se.start_date||se.end_date).map(({id:se,quarter:C,start_date:j,end_date:L,quarter_name:E})=>({quarter:C,start_date:j||null,end_date:L||null,quarter_name:E||`${C}`,academic_year:g})),{error:le}=await je.from("operation_quarters").upsert(re,{onConflict:"academic_year, quarter"});le?alert("     : "+le.message):(alert("   ."),_(g)),f(!1)},O=()=>{const re=r.length>0?Math.max(...r.map(le=>le.quarter)):0;n([...r,{quarter:re+1,start_date:null,end_date:null,academic_year:g}])},F=(re,le)=>{const se=i.map(C=>C.day_of_week===re?{...C,[le]:!C[le]}:C);a(se)},M=async()=>{u(!0);const{error:re}=await je.from("operation_defaults").upsert(i,{onConflict:"day_of_week"});re?alert("      ."):(alert("    ."),_(g)),u(!1)},V=async re=>{re.preventDefault();const{error:le}=await je.from("operation_exceptions").insert([{exception_date:p.date,reason:p.reason,is_closed:!0}]);le||(m({...p,reason:""}),_(g))},X=async re=>{await je.from("operation_exceptions").delete().eq("id",re),_(g)},q=()=>S.jsxs("div",{className:"flex items-center justify-between mb-6 px-2",children:[S.jsxs("div",{children:[S.jsx("h3",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:bt(e,"yyyy MMMM",{locale:Zd})}),S.jsx("p",{className:"text-[10px] font-black text-ios-indigo uppercase tracking-widest mt-1",children:"Operating Calendar"})]}),S.jsxs("div",{className:"flex gap-2",children:[S.jsx("button",{onClick:()=>t(Z_(e)),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",children:S.jsx(p1,{className:"w-5 h-5 text-ios-gray"})}),S.jsx("button",{onClick:()=>t(Jd(e,1)),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",children:S.jsx(nd,{className:"w-5 h-5 text-ios-gray"})})]})]}),ae=()=>{const re=["","","","","","",""];return S.jsx("div",{className:"grid grid-cols-7 mb-2 border-b border-gray-100",children:re.map((le,se)=>S.jsx("div",{className:`py-3 text-[10px] font-black uppercase text-center tracking-widest ${se===0?"text-ios-rose":se===6?"text-ios-indigo":"text-ios-gray"}`,children:le},se))})},ne=()=>{const re=hu(e),le=fu(re),se=_a(re),C=G_(le),j=Qd({start:se,end:C});return S.jsx("div",{className:"grid grid-cols-7 gap-px bg-gray-100 border border-gray-100 rounded-[12px] overflow-hidden shadow-sm",children:j.map((L,E)=>{const I=$_(L,new Date),A=o0(L,re),b=L.getDay(),P=bt(L,"yyyy-MM-dd"),R=l.find(ie=>ie.exception_date===P),W=r.find(ie=>ie.start_date&&ie.end_date&&du(L,{start:Fr(ie.start_date),end:Fr(ie.end_date)})),z=i.find(ie=>ie.day_of_week===b),Y=W&&!R&&((z==null?void 0:z.morning)||(z==null?void 0:z.dinner)||(z==null?void 0:z.period1)||(z==null?void 0:z.period2));return S.jsxs("div",{className:`min-h-[100px] p-2 flex flex-col gap-1 transition-colors border-b border-r border-gray-100 ${A?R?"bg-red-50/30":Y?"bg-[#f0f9ff]":"bg-white":"opacity-30 bg-gray-50"}`,children:[S.jsxs("div",{className:"flex justify-between items-start",children:[S.jsx("span",{className:`text-[11px] font-black ${I?"w-6 h-6 text-ios-indigo border-2 border-ios-indigo rounded-full flex items-center justify-center -mt-1 -ml-1 bg-white":b===0?"text-ios-rose":b===6?"text-ios-indigo":"text-[#1C1C1E]"}`,children:bt(L,"d")}),W&&S.jsxs("span",{className:"text-[8px] font-black bg-white/50 text-ios-indigo px-1.5 py-0.5 rounded-full uppercase tracking-tighter border border-ios-indigo/10",children:["Q",W.quarter]})]}),R?S.jsxs("div",{className:"mt-1 flex flex-col gap-1",children:[S.jsx("span",{className:"text-[10px] font-black text-red-600 uppercase tracking-widest",children:"CLOSED"}),S.jsx("span",{className:"text-[9px] font-bold text-ios-gray leading-tight",children:R.reason})]}):Y?S.jsx("div",{className:"mt-1 flex flex-col gap-0.5",children:[{label:"",key:"morning"},{label:"",key:"dinner"},{label:"1",key:"period1"},{label:"2",key:"period2"}].map(ie=>S.jsxs("div",{className:"flex justify-between items-center bg-white/40 rounded-[2px] px-1 py-0.5",children:[S.jsx("span",{className:"text-[8px] font-bold text-ios-gray",children:ie.label}),S.jsx("span",{className:`text-[8px] font-black uppercase tracking-wider ${z[ie.key]?"text-ios-indigo":"text-red-600"}`,children:z[ie.key]?"OPEN":"CLOSED"})]},ie.key))}):null]},E)})})};return s?S.jsx("div",{className:"h-full flex items-center justify-center",children:S.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-ios-indigo"})}):S.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 h-full overflow-hidden",children:[S.jsxs("div",{className:"flex-1 bg-white rounded-[6px] border border-gray-100 flex flex-col p-6 shadow-sm overflow-y-auto scrollbar-hide",children:[q(),ae(),ne()]}),S.jsxs("div",{className:"lg:w-96 flex flex-col gap-6 overflow-y-auto scrollbar-hide pb-6",children:[S.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 p-6 shadow-sm",children:[S.jsxs("div",{className:"flex items-center justify-between mb-6",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx(zo,{className:"w-4 h-4 text-ios-indigo"}),S.jsx("h4",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"  "})]}),S.jsx("div",{className:"flex gap-2",children:S.jsxs("button",{onClick:k,disabled:d,className:"bg-[#1C1C1E] text-white px-5 py-2.5 rounded-[8px] text-[11px] font-black uppercase tracking-widest flex items-center gap-2 hover:bg-[#5856D6] shadow-md transition-all active:scale-95",children:[S.jsx(Gc,{className:"w-3.5 h-3.5"})," "]})})]}),S.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-[8px] border border-gray-100",children:[S.jsx("label",{className:"block text-[10px] font-black text-ios-gray uppercase tracking-widest mb-2",children:" "}),S.jsxs("div",{className:"flex gap-2",children:[S.jsx("select",{value:x,onChange:re=>y(Number(re.target.value)),className:"flex-1 bg-white border border-gray-200 rounded-[6px] px-3 py-2 text-xs font-bold text-[#1C1C1E] focus:outline-none focus:ring-1 focus:ring-ios-indigo",children:[g-2,g-1,g,g+1,g+2].sort().map(re=>S.jsxs("option",{value:re,children:[re,""]},re))}),S.jsx("button",{onClick:w,className:"bg-[#1C1C1E] text-white px-3 py-2 rounded-[6px] text-[10px] font-black uppercase whitespace-nowrap hover:bg-[#5856D6] transition-colors",children:""})]})]}),S.jsxs("div",{className:"space-y-6",children:[r.map(re=>S.jsxs("div",{className:"space-y-2",children:[S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsxs("p",{className:"text-[11px] font-black text-ios-indigo",children:[re.quarter,""]}),S.jsxs("span",{className:"text-[8px] font-bold text-ios-gray bg-gray-50 px-2 py-0.5 rounded-full uppercase tracking-widest",children:["Year ",g," - Q",re.quarter]})]}),S.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[S.jsx("input",{type:"date",value:re.start_date||"",onChange:le=>T(re.quarter,"start_date",le.target.value),className:"bg-gray-50 border-none rounded-[6px] px-3 py-2 text-[11px] font-bold focus:ring-1 focus:ring-ios-indigo transition-all"}),S.jsx("input",{type:"date",value:re.end_date||"",onChange:le=>T(re.quarter,"end_date",le.target.value),className:"bg-gray-50 border-none rounded-[6px] px-3 py-2 text-[11px] font-bold focus:ring-1 focus:ring-ios-indigo transition-all"})]})]},re.quarter)),S.jsxs("button",{onClick:O,className:"w-full py-3 bg-gray-50 text-ios-gray border border-dashed border-gray-200 rounded-[6px] text-[10px] font-black uppercase tracking-wider flex items-center justify-center gap-1.5 hover:bg-gray-100 hover:text-[#1C1C1E] hover:border-gray-300 transition-all active:scale-95",children:[S.jsx($c,{className:"w-3.5 h-3.5"}),"  "]})]})]}),S.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 p-6 shadow-sm",children:[S.jsxs("div",{className:"flex items-center justify-between mb-6",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx(zo,{className:"w-4 h-4 text-ios-indigo"}),S.jsx("h4",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"   "})]}),S.jsxs("button",{onClick:M,disabled:h,className:"bg-[#1C1C1E] text-white px-5 py-2.5 rounded-[8px] text-[11px] font-black uppercase tracking-widest flex items-center gap-2 hover:bg-[#34C759] shadow-md transition-all active:scale-95",children:[S.jsx(Gc,{className:"w-3.5 h-3.5"})," "]})]}),S.jsxs("div",{className:"space-y-1 overflow-x-auto",children:[S.jsxs("div",{className:"grid grid-cols-5 gap-2 pb-2 border-b border-gray-100 mb-2",children:[S.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest",children:""}),S.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest text-center",children:""}),S.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest text-center",children:""}),S.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest text-center",children:"1"}),S.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest text-center",children:"2"})]}),[1,2,3,4,5,6,0].map(re=>{const le=i.find(se=>se.day_of_week===re)||{day_of_week:re,morning:!1,dinner:!1,period1:!1,period2:!1};return S.jsxs("div",{className:"grid grid-cols-5 gap-2 items-center py-2 hover:bg-gray-50 rounded-[4px] transition-colors",children:[S.jsx("span",{className:`text-[10px] font-black ${re===0?"text-ios-rose":re===6?"text-ios-indigo":"text-[#1C1C1E]"}`,children:["","","","","","",""][re]}),["morning","dinner","period1","period2"].map(se=>S.jsx("div",{className:"flex justify-center",children:S.jsx("input",{type:"checkbox",checked:le[se],onChange:()=>F(re,se),className:"w-4 h-4 rounded-full border-gray-200 text-ios-indigo focus:ring-ios-indigo/20 transition-all cursor-pointer"})},se))]},re)})]})]}),S.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 p-6 shadow-sm flex-1",children:[S.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[S.jsx(ri,{className:"w-4 h-4 text-ios-indigo"}),S.jsx("h4",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"()  "})]}),S.jsxs("form",{onSubmit:V,className:"space-y-4 mb-8",children:[S.jsxs("div",{className:"space-y-1",children:[S.jsx("p",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest px-1",children:" "}),S.jsx("input",{type:"date",value:p.date,onChange:re=>m({...p,date:re.target.value}),className:"w-full bg-gray-50 border-none rounded-[6px] px-3 py-3 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all outline-none"})]}),S.jsxs("div",{className:"space-y-1",children:[S.jsx("p",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest px-1",children:" "}),S.jsx("input",{type:"text",placeholder:": ,   ",value:p.reason,onChange:re=>m({...p,reason:re.target.value}),className:"w-full bg-gray-50 border-none rounded-[6px] px-3 py-3 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all outline-none"})]}),S.jsxs("button",{type:"submit",disabled:!p.reason,className:"w-full py-3 bg-[#1C1C1E] text-white rounded-[6px] font-black text-[11px] uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-ios-indigo transition-all disabled:opacity-30 disabled:hover:bg-[#1C1C1E]",children:[S.jsx($c,{className:"w-3 h-3"})," "]})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx("p",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest px-1 border-b border-gray-50 pb-2 mb-4",children:"  "}),S.jsxs("div",{className:"space-y-3 max-h-60 overflow-y-auto pr-2 scrollbar-hide",children:[l.length===0&&S.jsx("p",{className:"text-[10px] text-ios-gray italic text-center py-4",children:"  ."}),l.map(re=>S.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-[6px] hover:bg-ios-rose/5 transition-all group border border-transparent hover:border-ios-rose/10",children:[S.jsxs("div",{className:"flex-1",children:[S.jsx("p",{className:"text-[11px] font-black text-[#1C1C1E]",children:re.exception_date}),S.jsx("p",{className:"text-[9px] font-bold text-ios-gray truncate",children:re.reason})]}),S.jsx("button",{onClick:()=>X(re.id),className:"p-1.5 text-ios-gray hover:text-ios-rose transition-colors opacity-0 group-hover:opacity-100",children:S.jsx(sd,{className:"w-3.5 h-3.5"})})]},re.id))]})]})]})]})]})},Y8=()=>{const[e,t]=ve.useState(!0),[r,n]=ve.useState(!1),[i,a]=ve.useState(""),[l,o]=ve.useState(!1),[s,c]=ve.useState({lat:37.5665,lng:126.978,radius:100});ve.useEffect(()=>{d()},[]);const d=async()=>{t(!0);const{data:h,error:u}=await je.from("configs").select("value").eq("key","gps_settings").single();h?c(h.value):u&&u.code!=="PGRST116"&&a("    ."),t(!1)},f=async()=>{n(!0),a(""),o(!1);const{error:h}=await je.from("configs").upsert({key:"gps_settings",value:s,updated_at:new Date().toISOString()});h?a("    ."):(o(!0),setTimeout(()=>o(!1),3e3)),n(!1)};return e?S.jsx("div",{className:"h-full flex items-center justify-center",children:S.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#1C1C1E]"})}):S.jsx("div",{className:"bg-white rounded-t-[6px] rounded-b-none p-8 h-full space-y-8 animate-spring-up overflow-y-auto scrollbar-hide",children:S.jsxs("div",{className:"max-w-2xl mx-auto space-y-8",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center",children:S.jsx(ad,{className:"w-5 h-5 text-ios-indigo"})}),S.jsxs("div",{children:[S.jsx("h3",{className:"text-xl font-black tracking-tight text-[#1C1C1E]",children:"  GPS "}),S.jsx("p",{className:"text-xs text-ios-gray font-medium",children:"      ."})]})]}),S.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsxs("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest flex items-center gap-1.5",children:[S.jsx(pg,{className:"w-3 h-3"}),"  (Latitude)"]}),S.jsx("input",{type:"number",step:"0.000001",value:s.lat,onChange:h=>c({...s,lat:parseFloat(h.target.value)}),className:"w-full bg-gray-50 border border-gray-100 rounded-[6px] p-4 text-base font-black text-[#1C1C1E] focus:ring-1 focus:ring-ios-indigo transition-all",placeholder:": 37.5665"})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsxs("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest flex items-center gap-1.5",children:[S.jsx(pg,{className:"w-3 h-3"}),"  (Longitude)"]}),S.jsx("input",{type:"number",step:"0.000001",value:s.lng,onChange:h=>c({...s,lng:parseFloat(h.target.value)}),className:"w-full bg-gray-50 border border-gray-100 rounded-[6px] p-4 text-base font-black text-[#1C1C1E] focus:ring-1 focus:ring-ios-indigo transition-all",placeholder:": 126.9780"})]}),S.jsxs("div",{className:"space-y-2 md:col-span-2",children:[S.jsxs("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest flex items-center gap-1.5",children:[S.jsx(jk,{className:"w-3 h-3"}),"   (Radius,  )"]}),S.jsx("input",{type:"number",value:s.radius,onChange:h=>c({...s,radius:parseInt(h.target.value)}),className:"w-full bg-gray-50 border border-gray-100 rounded-[6px] p-4 text-base font-black text-[#1C1C1E] focus:ring-1 focus:ring-ios-indigo transition-all",placeholder:": 100"})]})]}),S.jsxs("div",{className:"bg-amber-50 p-6 rounded-[6px] border border-amber-100/50 space-y-2",children:[S.jsxs("p",{className:"font-black text-ios-amber text-[9px] uppercase tracking-widest flex items-center gap-1.5",children:[S.jsx(ri,{className:"w-3 h-3"}),"  "]}),S.jsxs("ul",{className:"text-amber-900/70 text-xs leading-relaxed font-medium list-disc list-inside space-y-1",children:[S.jsx("li",{children:"   6    10cm   ."}),S.jsx("li",{children:" (m) ,   GPS   50~100m  ."}),S.jsx("li",{children:":           ."})]})]}),i&&S.jsxs("div",{className:"p-4 bg-ios-rose/5 border border-ios-rose/10 rounded-[6px] flex items-center gap-2 animate-shake",children:[S.jsx(ri,{className:"w-4 h-4 text-ios-rose"}),S.jsx("p",{className:"text-[11px] font-black text-ios-rose",children:i})]}),S.jsx("button",{onClick:f,disabled:r,className:`w-full py-5 rounded-[6px] font-black text-base transition-all flex items-center justify-center gap-3 ios-tap ${l?"bg-ios-emerald text-white":"bg-[#1C1C1E] text-white shadow-lg shadow-black/20"}`,children:r?" ...":l?S.jsxs(S.Fragment,{children:[S.jsx(id,{className:"w-5 h-5"}),"  "]}):S.jsxs(S.Fragment,{children:[S.jsx(Gc,{className:"w-5 h-5"}),"  "]})})]})})};function K8(){const[e,t]=ve.useState(()=>localStorage.getItem("activeTab")||"map"),[r,n]=ve.useState(()=>localStorage.getItem("adminSubTab")||"layout"),[i,a]=ve.useState(null),[l,o]=ve.useState(()=>{const c=localStorage.getItem("currentUser");return c?JSON.parse(c):null});ve.useEffect(()=>{l?localStorage.setItem("currentUser",JSON.stringify(l)):localStorage.removeItem("currentUser")},[l]),ve.useEffect(()=>{localStorage.setItem("activeTab",e)},[e]),ve.useEffect(()=>{localStorage.setItem("adminSubTab",r)},[r]);const s=()=>{o(null),localStorage.removeItem("currentUser"),localStorage.removeItem("activeTab"),localStorage.removeItem("adminSubTab"),t("map")};return l?S.jsxs("div",{className:"flex flex-col h-screen bg-[#F2F2F7] text-[#1C1C1E] overflow-hidden font-sans selection:bg-ios-indigo/10",children:[S.jsxs("header",{className:"bg-white border-b border-gray-200/60 px-4 py-2 lg:px-8 flex items-center justify-between z-30 shrink-0 shadow-sm",children:[S.jsxs("div",{className:"flex items-center gap-6",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"w-9 h-9 rounded-[6px] bg-[#1C1C1E] flex items-center justify-center shadow-lg shadow-black/10",children:S.jsx(Mh,{className:"w-5 h-5 text-white"})}),S.jsxs("div",{children:[S.jsx("h1",{className:"text-lg font-black tracking-tighter leading-tight italic uppercase text-[#1C1C1E]",children:"Pogok"}),S.jsx("p",{className:"text-[8px] font-black tracking-[0.2em] text-ios-indigo uppercase opacity-80",children:"Study Cafe"})]})]}),S.jsx("nav",{className:"flex items-center gap-1 bg-gray-50 p-1 rounded-[8px] border border-gray-100 ml-4",children:[{id:"map",icon:Mh,label:"",roles:["admin","student","parent","teacher"]},{id:"attendance",icon:ad,label:" ",roles:["student"]},{id:"calendar",icon:rd,label:" ",roles:["admin","student","parent","teacher"]},{id:"profile",icon:Lh,label:"  ",roles:["student","parent"]},{id:"admin",icon:zk,label:" ",roles:["admin","teacher"]}].filter(c=>!c.roles||c.roles.includes(l.role)).map(c=>S.jsxs("button",{onClick:()=>t(c.id),className:`flex items-center gap-2 px-3 py-1.5 rounded-[6px] transition-all duration-200 group ${e===c.id?"bg-white shadow-sm border border-gray-100 text-[#1C1C1E]":"text-[#1C1C1E]/50 hover:text-[#1C1C1E] hover:bg-white/50"}`,children:[S.jsx(c.icon,{className:`w-3.5 h-3.5 ${e===c.id?"text-ios-indigo":"group-hover:text-ios-indigo"}`}),S.jsx("span",{className:"font-bold text-[13px]",children:c.label})]},c.id))})]}),S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsxs("div",{className:"flex items-center gap-3 bg-gray-50/50 p-1 px-3 rounded-[6px] border border-gray-200/30",children:[S.jsx("div",{className:"w-8 h-8 rounded-[6px] overflow-hidden bg-white border border-gray-100 flex items-center justify-center",children:S.jsx(Lh,{className:"w-4 h-4 text-[#1C1C1E]"})}),S.jsxs("div",{className:"text-left",children:[S.jsx("p",{className:"text-[13px] font-black leading-none text-[#1C1C1E]",children:l==null?void 0:l.full_name}),S.jsx("p",{className:"text-[9px] font-black text-ios-indigo tracking-widest mt-1 uppercase opacity-70",children:l==null?void 0:l.role})]})]}),S.jsxs("button",{onClick:s,className:"flex items-center gap-2 p-2 px-3 rounded-[6px] text-ios-rose hover:bg-ios-rose/5 transition-all ios-tap border border-transparent hover:border-ios-rose/20",children:[S.jsx(bk,{className:"w-4 h-4"}),S.jsx("span",{className:"font-bold text-[13px]",children:""})]})]})]}),S.jsx("main",{className:"flex-1 h-full flex flex-col overflow-hidden relative p-4 lg:p-6",children:S.jsx("div",{className:"flex-1 min-h-0 flex flex-col",children:e==="admin"?S.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[S.jsx("div",{className:"flex gap-4 mb-6 pt-2 shrink-0",children:[{id:"layout",label:" ",roles:["admin"]},{id:"attendance",label:" ",roles:["admin","teacher"]},{id:"safety",label:" ",roles:["admin","teacher"]},{id:"students",label:" ",roles:["admin"]},{id:"schedule",label:" ",roles:["admin"]},{id:"settings",label:" ",roles:["admin"]}].filter(c=>!c.roles||l&&c.roles.includes(l.role)).map(c=>S.jsx("button",{onClick:()=>n(c.id),className:`px-6 py-2 rounded-[6px] text-xs font-black transition-all duration-300 ios-tap ${r===c.id?"bg-[#1C1C1E] text-white shadow-md":"text-ios-gray hover:text-[#1C1C1E]"}`,children:c.label},c.id))}),S.jsx("div",{className:"flex-1 w-full overflow-hidden",children:r==="layout"?S.jsx(LC,{}):r==="attendance"?S.jsx(UI,{}):r==="students"?S.jsx(X8,{}):r==="schedule"?S.jsx(G8,{}):r==="settings"?S.jsx(Y8,{}):S.jsx("div",{className:"bg-white rounded-t-[6px] rounded-b-none p-2.5 pb-0 h-full",children:S.jsx(U8,{})})})]}):e==="attendance"?S.jsx("div",{className:"h-full flex flex-col items-center justify-center",children:S.jsx(H8,{})}):e==="profile"?S.jsx("div",{className:"h-full overflow-y-auto scrollbar-hide",children:S.jsx(V8,{})}):S.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:S.jsxs("section",{className:"flex-1 flex flex-col xl:flex-row gap-6 leading-normal overflow-hidden",children:[S.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:S.jsx("div",{className:"flex-1 w-full bg-white rounded-t-[6px] rounded-b-none border-0 overflow-hidden p-2.5 pb-0",children:S.jsx(W8,{onSelectSeat:c=>a(c)})})}),S.jsx("div",{className:"xl:w-80 h-full overflow-y-auto scrollbar-hide",children:i?S.jsx(z8,{selectedSeat:i,onComplete:()=>a(null)}):S.jsxs("div",{className:"h-full bg-white rounded-t-[6px] rounded-b-none p-10 text-center space-y-6 flex flex-col justify-center",children:[S.jsx("div",{className:"w-16 h-16 rounded-[6px] bg-gray-50 border border-gray-100 flex items-center justify-center mx-auto text-ios-indigo shadow-inner",children:S.jsx(m1,{className:"w-6 h-6"})}),S.jsxs("div",{className:"space-y-2",children:[S.jsx("h3",{className:"text-lg font-black tracking-tight text-[#1C1C1E]",children:" "}),S.jsx("p",{className:"text-ios-gray text-xs leading-relaxed px-4",children:"       ."})]})]})})]})})})})]}):S.jsx($8,{onLoginSuccess:c=>o(c)})}class q8 extends cv.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){this.setState({error:t,errorInfo:r}),console.error("Uncaught error:",t,r)}render(){return this.state.hasError?S.jsxs("div",{className:"p-8 bg-white h-screen w-full flex flex-col items-center justify-center text-[#1C1C1E]",children:[S.jsx("h1",{className:"text-2xl font-black mb-4 text-ios-rose",children:"Application Crash"}),S.jsxs("pre",{className:"bg-gray-100 p-4 rounded text-xs overflow-auto max-w-full",children:[this.state.error&&this.state.error.toString(),S.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]}),S.jsx("button",{onClick:()=>window.location.reload(),className:"mt-6 px-6 py-3 bg-ios-indigo text-white rounded-[6px] font-black",children:"Reload Application"})]}):this.props.children}}zf.createRoot(document.getElementById("root")).render(S.jsx(cv.StrictMode,{children:S.jsx(q8,{children:S.jsx(K8,{})})}));
