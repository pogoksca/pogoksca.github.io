var _N=Object.defineProperty;var kN=(e,t,r)=>t in e?_N(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var dt=(e,t,r)=>kN(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var dY=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function SN(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function CN(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var Hk={exports:{}},Mg={},$k={exports:{}},lr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bd=Symbol.for("react.element"),EN=Symbol.for("react.portal"),TN=Symbol.for("react.fragment"),NN=Symbol.for("react.strict_mode"),AN=Symbol.for("react.profiler"),ON=Symbol.for("react.provider"),jN=Symbol.for("react.context"),PN=Symbol.for("react.forward_ref"),FN=Symbol.for("react.suspense"),DN=Symbol.for("react.memo"),LN=Symbol.for("react.lazy"),Ow=Symbol.iterator;function IN(e){return e===null||typeof e!="object"?null:(e=Ow&&e[Ow]||e["@@iterator"],typeof e=="function"?e:null)}var qk={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Vk=Object.assign,Gk={};function Sf(e,t,r){this.props=e,this.context=t,this.refs=Gk,this.updater=r||qk}Sf.prototype.isReactComponent={};Sf.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Sf.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Xk(){}Xk.prototype=Sf.prototype;function Jv(e,t,r){this.props=e,this.context=t,this.refs=Gk,this.updater=r||qk}var Qv=Jv.prototype=new Xk;Qv.constructor=Jv;Vk(Qv,Sf.prototype);Qv.isPureReactComponent=!0;var jw=Array.isArray,Yk=Object.prototype.hasOwnProperty,Zv={current:null},Kk={key:!0,ref:!0,__self:!0,__source:!0};function Jk(e,t,r){var n,i={},s=null,l=null;if(t!=null)for(n in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(s=""+t.key),t)Yk.call(t,n)&&!Kk.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var a=Array(o),c=0;c<o;c++)a[c]=arguments[c+2];i.children=a}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Bd,type:e,key:s,ref:l,props:i,_owner:Zv.current}}function MN(e,t){return{$$typeof:Bd,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function e2(e){return typeof e=="object"&&e!==null&&e.$$typeof===Bd}function RN(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Pw=/\/+/g;function Xm(e,t){return typeof e=="object"&&e!==null&&e.key!=null?RN(""+e.key):t.toString(36)}function kp(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Bd:case EN:l=!0}}if(l)return l=e,i=i(l),e=n===""?"."+Xm(l,0):n,jw(i)?(r="",e!=null&&(r=e.replace(Pw,"$&/")+"/"),kp(i,t,r,"",function(c){return c})):i!=null&&(e2(i)&&(i=MN(i,r+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(Pw,"$&/")+"/")+e)),t.push(i)),1;if(l=0,n=n===""?".":n+":",jw(e))for(var o=0;o<e.length;o++){s=e[o];var a=n+Xm(s,o);l+=kp(s,t,r,a,i)}else if(a=IN(e),typeof a=="function")for(e=a.call(e),o=0;!(s=e.next()).done;)s=s.value,a=n+Xm(s,o++),l+=kp(s,t,r,a,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function P0(e,t,r){if(e==null)return e;var n=[],i=0;return kp(e,n,"","",function(s){return t.call(r,s,i++)}),n}function BN(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Vi={current:null},Sp={transition:null},UN={ReactCurrentDispatcher:Vi,ReactCurrentBatchConfig:Sp,ReactCurrentOwner:Zv};function Qk(){throw Error("act(...) is not supported in production builds of React.")}lr.Children={map:P0,forEach:function(e,t,r){P0(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return P0(e,function(){t++}),t},toArray:function(e){return P0(e,function(t){return t})||[]},only:function(e){if(!e2(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};lr.Component=Sf;lr.Fragment=TN;lr.Profiler=AN;lr.PureComponent=Jv;lr.StrictMode=NN;lr.Suspense=FN;lr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UN;lr.act=Qk;lr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Vk({},e.props),i=e.key,s=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,l=Zv.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(a in t)Yk.call(t,a)&&!Kk.hasOwnProperty(a)&&(n[a]=t[a]===void 0&&o!==void 0?o[a]:t[a])}var a=arguments.length-2;if(a===1)n.children=r;else if(1<a){o=Array(a);for(var c=0;c<a;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Bd,type:e.type,key:i,ref:s,props:n,_owner:l}};lr.createContext=function(e){return e={$$typeof:jN,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:ON,_context:e},e.Consumer=e};lr.createElement=Jk;lr.createFactory=function(e){var t=Jk.bind(null,e);return t.type=e,t};lr.createRef=function(){return{current:null}};lr.forwardRef=function(e){return{$$typeof:PN,render:e}};lr.isValidElement=e2;lr.lazy=function(e){return{$$typeof:LN,_payload:{_status:-1,_result:e},_init:BN}};lr.memo=function(e,t){return{$$typeof:DN,type:e,compare:t===void 0?null:t}};lr.startTransition=function(e){var t=Sp.transition;Sp.transition={};try{e()}finally{Sp.transition=t}};lr.unstable_act=Qk;lr.useCallback=function(e,t){return Vi.current.useCallback(e,t)};lr.useContext=function(e){return Vi.current.useContext(e)};lr.useDebugValue=function(){};lr.useDeferredValue=function(e){return Vi.current.useDeferredValue(e)};lr.useEffect=function(e,t){return Vi.current.useEffect(e,t)};lr.useId=function(){return Vi.current.useId()};lr.useImperativeHandle=function(e,t,r){return Vi.current.useImperativeHandle(e,t,r)};lr.useInsertionEffect=function(e,t){return Vi.current.useInsertionEffect(e,t)};lr.useLayoutEffect=function(e,t){return Vi.current.useLayoutEffect(e,t)};lr.useMemo=function(e,t){return Vi.current.useMemo(e,t)};lr.useReducer=function(e,t,r){return Vi.current.useReducer(e,t,r)};lr.useRef=function(e){return Vi.current.useRef(e)};lr.useState=function(e){return Vi.current.useState(e)};lr.useSyncExternalStore=function(e,t,r){return Vi.current.useSyncExternalStore(e,t,r)};lr.useTransition=function(){return Vi.current.useTransition()};lr.version="18.3.1";$k.exports=lr;var xe=$k.exports;const cf=SN(xe);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zN=xe,WN=Symbol.for("react.element"),HN=Symbol.for("react.fragment"),$N=Object.prototype.hasOwnProperty,qN=zN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,VN={key:!0,ref:!0,__self:!0,__source:!0};function Zk(e,t,r){var n,i={},s=null,l=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)$N.call(t,n)&&!VN.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:WN,type:e,key:s,ref:l,props:i,_owner:qN.current}}Mg.Fragment=HN;Mg.jsx=Zk;Mg.jsxs=Zk;Hk.exports=Mg;var v=Hk.exports,px={},eS={exports:{}},js={},tS={exports:{}},rS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(K,N){var U=K.length;K.push(N);e:for(;0<U;){var R=U-1>>>1,k=K[R];if(0<i(k,N))K[R]=N,K[U]=k,U=R;else break e}}function r(K){return K.length===0?null:K[0]}function n(K){if(K.length===0)return null;var N=K[0],U=K.pop();if(U!==N){K[0]=U;e:for(var R=0,k=K.length,P=k>>>1;R<P;){var A=2*(R+1)-1,E=K[A],I=A+1,H=K[I];if(0>i(E,U))I<k&&0>i(H,E)?(K[R]=H,K[I]=U,R=I):(K[R]=E,K[A]=U,R=A);else if(I<k&&0>i(H,U))K[R]=H,K[I]=U,R=I;else break e}}return N}function i(K,N){var U=K.sortIndex-N.sortIndex;return U!==0?U:K.id-N.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var a=[],c=[],f=1,h=null,d=3,u=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(K){for(var N=r(c);N!==null;){if(N.callback===null)n(c);else if(N.startTime<=K)n(c),N.sortIndex=N.expirationTime,t(a,N);else break;N=r(c)}}function b(K){if(m=!1,w(K),!p)if(r(a)!==null)p=!0,ee(S);else{var N=r(c);N!==null&&Q(b,N.startTime-K)}}function S(K,N){p=!1,m&&(m=!1,x(j),j=-1),u=!0;var U=d;try{for(w(N),h=r(a);h!==null&&(!(h.expirationTime>N)||K&&!F());){var R=h.callback;if(typeof R=="function"){h.callback=null,d=h.priorityLevel;var k=R(h.expirationTime<=N);N=e.unstable_now(),typeof k=="function"?h.callback=k:h===r(a)&&n(a),w(N)}else n(a);h=r(a)}if(h!==null)var P=!0;else{var A=r(c);A!==null&&Q(b,A.startTime-N),P=!1}return P}finally{h=null,d=U,u=!1}}var T=!1,O=null,j=-1,L=5,W=-1;function F(){return!(e.unstable_now()-W<L)}function M(){if(O!==null){var K=e.unstable_now();W=K;var N=!0;try{N=O(!0,K)}finally{N?V():(T=!1,O=null)}}else T=!1}var V;if(typeof y=="function")V=function(){y(M)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,te=G.port2;G.port1.onmessage=M,V=function(){te.postMessage(null)}}else V=function(){g(M,0)};function ee(K){O=K,T||(T=!0,V())}function Q(K,N){j=g(function(){K(e.unstable_now())},N)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(K){K.callback=null},e.unstable_continueExecution=function(){p||u||(p=!0,ee(S))},e.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<K?Math.floor(1e3/K):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return r(a)},e.unstable_next=function(K){switch(d){case 1:case 2:case 3:var N=3;break;default:N=d}var U=d;d=N;try{return K()}finally{d=U}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(K,N){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var U=d;d=K;try{return N()}finally{d=U}},e.unstable_scheduleCallback=function(K,N,U){var R=e.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?R+U:R):U=R,K){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=U+k,K={id:f++,callback:N,priorityLevel:K,startTime:U,expirationTime:k,sortIndex:-1},U>R?(K.sortIndex=U,t(c,K),r(a)===null&&K===r(c)&&(m?(x(j),j=-1):m=!0,Q(b,U-R))):(K.sortIndex=k,t(a,K),p||u||(p=!0,ee(S))),K},e.unstable_shouldYield=F,e.unstable_wrapCallback=function(K){var N=d;return function(){var U=d;d=N;try{return K.apply(this,arguments)}finally{d=U}}}})(rS);tS.exports=rS;var GN=tS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XN=xe,As=GN;function pt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var nS=new Set,Xh={};function Hc(e,t){uf(e,t),uf(e+"Capture",t)}function uf(e,t){for(Xh[e]=t,e=0;e<t.length;e++)nS.add(t[e])}var Po=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gx=Object.prototype.hasOwnProperty,YN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Fw={},Dw={};function KN(e){return gx.call(Dw,e)?!0:gx.call(Fw,e)?!1:YN.test(e)?Dw[e]=!0:(Fw[e]=!0,!1)}function JN(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function QN(e,t,r,n){if(t===null||typeof t>"u"||JN(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Gi(e,t,r,n,i,s,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=l}var xi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){xi[e]=new Gi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];xi[t]=new Gi(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){xi[e]=new Gi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){xi[e]=new Gi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){xi[e]=new Gi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){xi[e]=new Gi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){xi[e]=new Gi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){xi[e]=new Gi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){xi[e]=new Gi(e,5,!1,e.toLowerCase(),null,!1,!1)});var t2=/[\-:]([a-z])/g;function r2(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(t2,r2);xi[t]=new Gi(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(t2,r2);xi[t]=new Gi(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(t2,r2);xi[t]=new Gi(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){xi[e]=new Gi(e,1,!1,e.toLowerCase(),null,!1,!1)});xi.xlinkHref=new Gi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){xi[e]=new Gi(e,1,!1,e.toLowerCase(),null,!0,!0)});function n2(e,t,r,n){var i=xi.hasOwnProperty(t)?xi[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(QN(t,r,i,n)&&(r=null),n||i===null?KN(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Bo=XN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F0=Symbol.for("react.element"),ju=Symbol.for("react.portal"),Pu=Symbol.for("react.fragment"),i2=Symbol.for("react.strict_mode"),mx=Symbol.for("react.profiler"),iS=Symbol.for("react.provider"),sS=Symbol.for("react.context"),s2=Symbol.for("react.forward_ref"),xx=Symbol.for("react.suspense"),vx=Symbol.for("react.suspense_list"),a2=Symbol.for("react.memo"),fl=Symbol.for("react.lazy"),aS=Symbol.for("react.offscreen"),Lw=Symbol.iterator;function ih(e){return e===null||typeof e!="object"?null:(e=Lw&&e[Lw]||e["@@iterator"],typeof e=="function"?e:null)}var nn=Object.assign,Ym;function xh(e){if(Ym===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Ym=t&&t[1]||""}return`
`+Ym+e}var Km=!1;function Jm(e,t){if(!e||Km)return"";Km=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),l=i.length-1,o=s.length-1;1<=l&&0<=o&&i[l]!==s[o];)o--;for(;1<=l&&0<=o;l--,o--)if(i[l]!==s[o]){if(l!==1||o!==1)do if(l--,o--,0>o||i[l]!==s[o]){var a=`
`+i[l].replace(" at new "," at ");return e.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",e.displayName)),a}while(1<=l&&0<=o);break}}}finally{Km=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?xh(e):""}function ZN(e){switch(e.tag){case 5:return xh(e.type);case 16:return xh("Lazy");case 13:return xh("Suspense");case 19:return xh("SuspenseList");case 0:case 2:case 15:return e=Jm(e.type,!1),e;case 11:return e=Jm(e.type.render,!1),e;case 1:return e=Jm(e.type,!0),e;default:return""}}function yx(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Pu:return"Fragment";case ju:return"Portal";case mx:return"Profiler";case i2:return"StrictMode";case xx:return"Suspense";case vx:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case sS:return(e.displayName||"Context")+".Consumer";case iS:return(e._context.displayName||"Context")+".Provider";case s2:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case a2:return t=e.displayName||null,t!==null?t:yx(e.type)||"Memo";case fl:t=e._payload,e=e._init;try{return yx(e(t))}catch{}}return null}function eA(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return yx(t);case 8:return t===i2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function jl(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function oS(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function tA(e){var t=oS(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(l){n=""+l,s.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function D0(e){e._valueTracker||(e._valueTracker=tA(e))}function lS(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=oS(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Wp(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function wx(e,t){var r=t.checked;return nn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Iw(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=jl(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function cS(e,t){t=t.checked,t!=null&&n2(e,"checked",t,!1)}function bx(e,t){cS(e,t);var r=jl(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?_x(e,t.type,r):t.hasOwnProperty("defaultValue")&&_x(e,t.type,jl(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Mw(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function _x(e,t,r){(t!=="number"||Wp(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var vh=Array.isArray;function Vu(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+jl(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function kx(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(pt(91));return nn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Rw(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(pt(92));if(vh(r)){if(1<r.length)throw Error(pt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:jl(r)}}function uS(e,t){var r=jl(t.value),n=jl(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Bw(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function fS(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Sx(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?fS(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var L0,hS=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(L0=L0||document.createElement("div"),L0.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=L0.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Yh(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Ch={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},rA=["Webkit","ms","Moz","O"];Object.keys(Ch).forEach(function(e){rA.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ch[t]=Ch[e]})});function dS(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Ch.hasOwnProperty(e)&&Ch[e]?(""+t).trim():t+"px"}function pS(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=dS(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var nA=nn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Cx(e,t){if(t){if(nA[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(pt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(pt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(pt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(pt(62))}}function Ex(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tx=null;function o2(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Nx=null,Gu=null,Xu=null;function Uw(e){if(e=Wd(e)){if(typeof Nx!="function")throw Error(pt(280));var t=e.stateNode;t&&(t=Wg(t),Nx(e.stateNode,e.type,t))}}function gS(e){Gu?Xu?Xu.push(e):Xu=[e]:Gu=e}function mS(){if(Gu){var e=Gu,t=Xu;if(Xu=Gu=null,Uw(e),t)for(e=0;e<t.length;e++)Uw(t[e])}}function xS(e,t){return e(t)}function vS(){}var Qm=!1;function yS(e,t,r){if(Qm)return e(t,r);Qm=!0;try{return xS(e,t,r)}finally{Qm=!1,(Gu!==null||Xu!==null)&&(vS(),mS())}}function Kh(e,t){var r=e.stateNode;if(r===null)return null;var n=Wg(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(pt(231,t,typeof r));return r}var Ax=!1;if(Po)try{var sh={};Object.defineProperty(sh,"passive",{get:function(){Ax=!0}}),window.addEventListener("test",sh,sh),window.removeEventListener("test",sh,sh)}catch{Ax=!1}function iA(e,t,r,n,i,s,l,o,a){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(f){this.onError(f)}}var Eh=!1,Hp=null,$p=!1,Ox=null,sA={onError:function(e){Eh=!0,Hp=e}};function aA(e,t,r,n,i,s,l,o,a){Eh=!1,Hp=null,iA.apply(sA,arguments)}function oA(e,t,r,n,i,s,l,o,a){if(aA.apply(this,arguments),Eh){if(Eh){var c=Hp;Eh=!1,Hp=null}else throw Error(pt(198));$p||($p=!0,Ox=c)}}function $c(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function wS(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function zw(e){if($c(e)!==e)throw Error(pt(188))}function lA(e){var t=e.alternate;if(!t){if(t=$c(e),t===null)throw Error(pt(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return zw(i),e;if(s===n)return zw(i),t;s=s.sibling}throw Error(pt(188))}if(r.return!==n.return)r=i,n=s;else{for(var l=!1,o=i.child;o;){if(o===r){l=!0,r=i,n=s;break}if(o===n){l=!0,n=i,r=s;break}o=o.sibling}if(!l){for(o=s.child;o;){if(o===r){l=!0,r=s,n=i;break}if(o===n){l=!0,n=s,r=i;break}o=o.sibling}if(!l)throw Error(pt(189))}}if(r.alternate!==n)throw Error(pt(190))}if(r.tag!==3)throw Error(pt(188));return r.stateNode.current===r?e:t}function bS(e){return e=lA(e),e!==null?_S(e):null}function _S(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=_S(e);if(t!==null)return t;e=e.sibling}return null}var kS=As.unstable_scheduleCallback,Ww=As.unstable_cancelCallback,cA=As.unstable_shouldYield,uA=As.unstable_requestPaint,bn=As.unstable_now,fA=As.unstable_getCurrentPriorityLevel,l2=As.unstable_ImmediatePriority,SS=As.unstable_UserBlockingPriority,qp=As.unstable_NormalPriority,hA=As.unstable_LowPriority,CS=As.unstable_IdlePriority,Rg=null,Xa=null;function dA(e){if(Xa&&typeof Xa.onCommitFiberRoot=="function")try{Xa.onCommitFiberRoot(Rg,e,void 0,(e.current.flags&128)===128)}catch{}}var va=Math.clz32?Math.clz32:mA,pA=Math.log,gA=Math.LN2;function mA(e){return e>>>=0,e===0?32:31-(pA(e)/gA|0)|0}var I0=64,M0=4194304;function yh(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Vp(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~i;o!==0?n=yh(o):(s&=l,s!==0&&(n=yh(s)))}else l=r&~i,l!==0?n=yh(l):s!==0&&(n=yh(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-va(t),i=1<<r,n|=e[r],t&=~i;return n}function xA(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vA(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var l=31-va(s),o=1<<l,a=i[l];a===-1?(!(o&r)||o&n)&&(i[l]=xA(o,t)):a<=t&&(e.expiredLanes|=o),s&=~o}}function jx(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ES(){var e=I0;return I0<<=1,!(I0&4194240)&&(I0=64),e}function Zm(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Ud(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-va(t),e[t]=r}function yA(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-va(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function c2(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-va(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Nr=0;function TS(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var NS,u2,AS,OS,jS,Px=!1,R0=[],_l=null,kl=null,Sl=null,Jh=new Map,Qh=new Map,pl=[],wA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Hw(e,t){switch(e){case"focusin":case"focusout":_l=null;break;case"dragenter":case"dragleave":kl=null;break;case"mouseover":case"mouseout":Sl=null;break;case"pointerover":case"pointerout":Jh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qh.delete(t.pointerId)}}function ah(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=Wd(t),t!==null&&u2(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function bA(e,t,r,n,i){switch(t){case"focusin":return _l=ah(_l,e,t,r,n,i),!0;case"dragenter":return kl=ah(kl,e,t,r,n,i),!0;case"mouseover":return Sl=ah(Sl,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Jh.set(s,ah(Jh.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Qh.set(s,ah(Qh.get(s)||null,e,t,r,n,i)),!0}return!1}function PS(e){var t=xc(e.target);if(t!==null){var r=$c(t);if(r!==null){if(t=r.tag,t===13){if(t=wS(r),t!==null){e.blockedOn=t,jS(e.priority,function(){AS(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Cp(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Fx(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Tx=n,r.target.dispatchEvent(n),Tx=null}else return t=Wd(r),t!==null&&u2(t),e.blockedOn=r,!1;t.shift()}return!0}function $w(e,t,r){Cp(e)&&r.delete(t)}function _A(){Px=!1,_l!==null&&Cp(_l)&&(_l=null),kl!==null&&Cp(kl)&&(kl=null),Sl!==null&&Cp(Sl)&&(Sl=null),Jh.forEach($w),Qh.forEach($w)}function oh(e,t){e.blockedOn===t&&(e.blockedOn=null,Px||(Px=!0,As.unstable_scheduleCallback(As.unstable_NormalPriority,_A)))}function Zh(e){function t(i){return oh(i,e)}if(0<R0.length){oh(R0[0],e);for(var r=1;r<R0.length;r++){var n=R0[r];n.blockedOn===e&&(n.blockedOn=null)}}for(_l!==null&&oh(_l,e),kl!==null&&oh(kl,e),Sl!==null&&oh(Sl,e),Jh.forEach(t),Qh.forEach(t),r=0;r<pl.length;r++)n=pl[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<pl.length&&(r=pl[0],r.blockedOn===null);)PS(r),r.blockedOn===null&&pl.shift()}var Yu=Bo.ReactCurrentBatchConfig,Gp=!0;function kA(e,t,r,n){var i=Nr,s=Yu.transition;Yu.transition=null;try{Nr=1,f2(e,t,r,n)}finally{Nr=i,Yu.transition=s}}function SA(e,t,r,n){var i=Nr,s=Yu.transition;Yu.transition=null;try{Nr=4,f2(e,t,r,n)}finally{Nr=i,Yu.transition=s}}function f2(e,t,r,n){if(Gp){var i=Fx(e,t,r,n);if(i===null)c1(e,t,n,Xp,r),Hw(e,n);else if(bA(i,e,t,r,n))n.stopPropagation();else if(Hw(e,n),t&4&&-1<wA.indexOf(e)){for(;i!==null;){var s=Wd(i);if(s!==null&&NS(s),s=Fx(e,t,r,n),s===null&&c1(e,t,n,Xp,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else c1(e,t,n,null,r)}}var Xp=null;function Fx(e,t,r,n){if(Xp=null,e=o2(n),e=xc(e),e!==null)if(t=$c(e),t===null)e=null;else if(r=t.tag,r===13){if(e=wS(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xp=e,null}function FS(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fA()){case l2:return 1;case SS:return 4;case qp:case hA:return 16;case CS:return 536870912;default:return 16}default:return 16}}var xl=null,h2=null,Ep=null;function DS(){if(Ep)return Ep;var e,t=h2,r=t.length,n,i="value"in xl?xl.value:xl.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var l=r-e;for(n=1;n<=l&&t[r-n]===i[s-n];n++);return Ep=i.slice(e,1<n?1-n:void 0)}function Tp(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function B0(){return!0}function qw(){return!1}function Ps(e){function t(r,n,i,s,l){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?B0:qw,this.isPropagationStopped=qw,this}return nn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=B0)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=B0)},persist:function(){},isPersistent:B0}),t}var Cf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},d2=Ps(Cf),zd=nn({},Cf,{view:0,detail:0}),CA=Ps(zd),e1,t1,lh,Bg=nn({},zd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:p2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==lh&&(lh&&e.type==="mousemove"?(e1=e.screenX-lh.screenX,t1=e.screenY-lh.screenY):t1=e1=0,lh=e),e1)},movementY:function(e){return"movementY"in e?e.movementY:t1}}),Vw=Ps(Bg),EA=nn({},Bg,{dataTransfer:0}),TA=Ps(EA),NA=nn({},zd,{relatedTarget:0}),r1=Ps(NA),AA=nn({},Cf,{animationName:0,elapsedTime:0,pseudoElement:0}),OA=Ps(AA),jA=nn({},Cf,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),PA=Ps(jA),FA=nn({},Cf,{data:0}),Gw=Ps(FA),DA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},LA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},IA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function MA(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=IA[e])?!!t[e]:!1}function p2(){return MA}var RA=nn({},zd,{key:function(e){if(e.key){var t=DA[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Tp(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?LA[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:p2,charCode:function(e){return e.type==="keypress"?Tp(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Tp(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),BA=Ps(RA),UA=nn({},Bg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xw=Ps(UA),zA=nn({},zd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:p2}),WA=Ps(zA),HA=nn({},Cf,{propertyName:0,elapsedTime:0,pseudoElement:0}),$A=Ps(HA),qA=nn({},Bg,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),VA=Ps(qA),GA=[9,13,27,32],g2=Po&&"CompositionEvent"in window,Th=null;Po&&"documentMode"in document&&(Th=document.documentMode);var XA=Po&&"TextEvent"in window&&!Th,LS=Po&&(!g2||Th&&8<Th&&11>=Th),Yw=" ",Kw=!1;function IS(e,t){switch(e){case"keyup":return GA.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function MS(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Fu=!1;function YA(e,t){switch(e){case"compositionend":return MS(t);case"keypress":return t.which!==32?null:(Kw=!0,Yw);case"textInput":return e=t.data,e===Yw&&Kw?null:e;default:return null}}function KA(e,t){if(Fu)return e==="compositionend"||!g2&&IS(e,t)?(e=DS(),Ep=h2=xl=null,Fu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return LS&&t.locale!=="ko"?null:t.data;default:return null}}var JA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jw(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!JA[e.type]:t==="textarea"}function RS(e,t,r,n){gS(n),t=Yp(t,"onChange"),0<t.length&&(r=new d2("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Nh=null,ed=null;function QA(e){YS(e,0)}function Ug(e){var t=Iu(e);if(lS(t))return e}function ZA(e,t){if(e==="change")return t}var BS=!1;if(Po){var n1;if(Po){var i1="oninput"in document;if(!i1){var Qw=document.createElement("div");Qw.setAttribute("oninput","return;"),i1=typeof Qw.oninput=="function"}n1=i1}else n1=!1;BS=n1&&(!document.documentMode||9<document.documentMode)}function Zw(){Nh&&(Nh.detachEvent("onpropertychange",US),ed=Nh=null)}function US(e){if(e.propertyName==="value"&&Ug(ed)){var t=[];RS(t,ed,e,o2(e)),yS(QA,t)}}function e6(e,t,r){e==="focusin"?(Zw(),Nh=t,ed=r,Nh.attachEvent("onpropertychange",US)):e==="focusout"&&Zw()}function t6(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ug(ed)}function r6(e,t){if(e==="click")return Ug(t)}function n6(e,t){if(e==="input"||e==="change")return Ug(t)}function i6(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var _a=typeof Object.is=="function"?Object.is:i6;function td(e,t){if(_a(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!gx.call(t,i)||!_a(e[i],t[i]))return!1}return!0}function eb(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function tb(e,t){var r=eb(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=eb(r)}}function zS(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?zS(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function WS(){for(var e=window,t=Wp();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Wp(e.document)}return t}function m2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function s6(e){var t=WS(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&zS(r.ownerDocument.documentElement,r)){if(n!==null&&m2(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=tb(r,s);var l=tb(r,n);i&&l&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var a6=Po&&"documentMode"in document&&11>=document.documentMode,Du=null,Dx=null,Ah=null,Lx=!1;function rb(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Lx||Du==null||Du!==Wp(n)||(n=Du,"selectionStart"in n&&m2(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ah&&td(Ah,n)||(Ah=n,n=Yp(Dx,"onSelect"),0<n.length&&(t=new d2("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Du)))}function U0(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Lu={animationend:U0("Animation","AnimationEnd"),animationiteration:U0("Animation","AnimationIteration"),animationstart:U0("Animation","AnimationStart"),transitionend:U0("Transition","TransitionEnd")},s1={},HS={};Po&&(HS=document.createElement("div").style,"AnimationEvent"in window||(delete Lu.animationend.animation,delete Lu.animationiteration.animation,delete Lu.animationstart.animation),"TransitionEvent"in window||delete Lu.transitionend.transition);function zg(e){if(s1[e])return s1[e];if(!Lu[e])return e;var t=Lu[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in HS)return s1[e]=t[r];return e}var $S=zg("animationend"),qS=zg("animationiteration"),VS=zg("animationstart"),GS=zg("transitionend"),XS=new Map,nb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ul(e,t){XS.set(e,t),Hc(t,[e])}for(var a1=0;a1<nb.length;a1++){var o1=nb[a1],o6=o1.toLowerCase(),l6=o1[0].toUpperCase()+o1.slice(1);Ul(o6,"on"+l6)}Ul($S,"onAnimationEnd");Ul(qS,"onAnimationIteration");Ul(VS,"onAnimationStart");Ul("dblclick","onDoubleClick");Ul("focusin","onFocus");Ul("focusout","onBlur");Ul(GS,"onTransitionEnd");uf("onMouseEnter",["mouseout","mouseover"]);uf("onMouseLeave",["mouseout","mouseover"]);uf("onPointerEnter",["pointerout","pointerover"]);uf("onPointerLeave",["pointerout","pointerover"]);Hc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Hc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Hc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Hc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Hc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Hc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),c6=new Set("cancel close invalid load scroll toggle".split(" ").concat(wh));function ib(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,oA(n,t,void 0,e),e.currentTarget=null}function YS(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var l=n.length-1;0<=l;l--){var o=n[l],a=o.instance,c=o.currentTarget;if(o=o.listener,a!==s&&i.isPropagationStopped())break e;ib(i,o,c),s=a}else for(l=0;l<n.length;l++){if(o=n[l],a=o.instance,c=o.currentTarget,o=o.listener,a!==s&&i.isPropagationStopped())break e;ib(i,o,c),s=a}}}if($p)throw e=Ox,$p=!1,Ox=null,e}function Ur(e,t){var r=t[Ux];r===void 0&&(r=t[Ux]=new Set);var n=e+"__bubble";r.has(n)||(KS(t,e,2,!1),r.add(n))}function l1(e,t,r){var n=0;t&&(n|=4),KS(r,e,n,t)}var z0="_reactListening"+Math.random().toString(36).slice(2);function rd(e){if(!e[z0]){e[z0]=!0,nS.forEach(function(r){r!=="selectionchange"&&(c6.has(r)||l1(r,!1,e),l1(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[z0]||(t[z0]=!0,l1("selectionchange",!1,t))}}function KS(e,t,r,n){switch(FS(t)){case 1:var i=kA;break;case 4:i=SA;break;default:i=f2}r=i.bind(null,t,r,e),i=void 0,!Ax||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function c1(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(l===4)for(l=n.return;l!==null;){var a=l.tag;if((a===3||a===4)&&(a=l.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;l=l.return}for(;o!==null;){if(l=xc(o),l===null)return;if(a=l.tag,a===5||a===6){n=s=l;continue e}o=o.parentNode}}n=n.return}yS(function(){var c=s,f=o2(r),h=[];e:{var d=XS.get(e);if(d!==void 0){var u=d2,p=e;switch(e){case"keypress":if(Tp(r)===0)break e;case"keydown":case"keyup":u=BA;break;case"focusin":p="focus",u=r1;break;case"focusout":p="blur",u=r1;break;case"beforeblur":case"afterblur":u=r1;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=Vw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=TA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=WA;break;case $S:case qS:case VS:u=OA;break;case GS:u=$A;break;case"scroll":u=CA;break;case"wheel":u=VA;break;case"copy":case"cut":case"paste":u=PA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=Xw}var m=(t&4)!==0,g=!m&&e==="scroll",x=m?d!==null?d+"Capture":null:d;m=[];for(var y=c,w;y!==null;){w=y;var b=w.stateNode;if(w.tag===5&&b!==null&&(w=b,x!==null&&(b=Kh(y,x),b!=null&&m.push(nd(y,b,w)))),g)break;y=y.return}0<m.length&&(d=new u(d,p,null,r,f),h.push({event:d,listeners:m}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",u=e==="mouseout"||e==="pointerout",d&&r!==Tx&&(p=r.relatedTarget||r.fromElement)&&(xc(p)||p[Fo]))break e;if((u||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,u?(p=r.relatedTarget||r.toElement,u=c,p=p?xc(p):null,p!==null&&(g=$c(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(u=null,p=c),u!==p)){if(m=Vw,b="onMouseLeave",x="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=Xw,b="onPointerLeave",x="onPointerEnter",y="pointer"),g=u==null?d:Iu(u),w=p==null?d:Iu(p),d=new m(b,y+"leave",u,r,f),d.target=g,d.relatedTarget=w,b=null,xc(f)===c&&(m=new m(x,y+"enter",p,r,f),m.target=w,m.relatedTarget=g,b=m),g=b,u&&p)t:{for(m=u,x=p,y=0,w=m;w;w=fu(w))y++;for(w=0,b=x;b;b=fu(b))w++;for(;0<y-w;)m=fu(m),y--;for(;0<w-y;)x=fu(x),w--;for(;y--;){if(m===x||x!==null&&m===x.alternate)break t;m=fu(m),x=fu(x)}m=null}else m=null;u!==null&&sb(h,d,u,m,!1),p!==null&&g!==null&&sb(h,g,p,m,!0)}}e:{if(d=c?Iu(c):window,u=d.nodeName&&d.nodeName.toLowerCase(),u==="select"||u==="input"&&d.type==="file")var S=ZA;else if(Jw(d))if(BS)S=n6;else{S=t6;var T=e6}else(u=d.nodeName)&&u.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(S=r6);if(S&&(S=S(e,c))){RS(h,S,r,f);break e}T&&T(e,d,c),e==="focusout"&&(T=d._wrapperState)&&T.controlled&&d.type==="number"&&_x(d,"number",d.value)}switch(T=c?Iu(c):window,e){case"focusin":(Jw(T)||T.contentEditable==="true")&&(Du=T,Dx=c,Ah=null);break;case"focusout":Ah=Dx=Du=null;break;case"mousedown":Lx=!0;break;case"contextmenu":case"mouseup":case"dragend":Lx=!1,rb(h,r,f);break;case"selectionchange":if(a6)break;case"keydown":case"keyup":rb(h,r,f)}var O;if(g2)e:{switch(e){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else Fu?IS(e,r)&&(j="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(j="onCompositionStart");j&&(LS&&r.locale!=="ko"&&(Fu||j!=="onCompositionStart"?j==="onCompositionEnd"&&Fu&&(O=DS()):(xl=f,h2="value"in xl?xl.value:xl.textContent,Fu=!0)),T=Yp(c,j),0<T.length&&(j=new Gw(j,e,null,r,f),h.push({event:j,listeners:T}),O?j.data=O:(O=MS(r),O!==null&&(j.data=O)))),(O=XA?YA(e,r):KA(e,r))&&(c=Yp(c,"onBeforeInput"),0<c.length&&(f=new Gw("onBeforeInput","beforeinput",null,r,f),h.push({event:f,listeners:c}),f.data=O))}YS(h,t)})}function nd(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Yp(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Kh(e,r),s!=null&&n.unshift(nd(e,s,i)),s=Kh(e,t),s!=null&&n.push(nd(e,s,i))),e=e.return}return n}function fu(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function sb(e,t,r,n,i){for(var s=t._reactName,l=[];r!==null&&r!==n;){var o=r,a=o.alternate,c=o.stateNode;if(a!==null&&a===n)break;o.tag===5&&c!==null&&(o=c,i?(a=Kh(r,s),a!=null&&l.unshift(nd(r,a,o))):i||(a=Kh(r,s),a!=null&&l.push(nd(r,a,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var u6=/\r\n?/g,f6=/\u0000|\uFFFD/g;function ab(e){return(typeof e=="string"?e:""+e).replace(u6,`
`).replace(f6,"")}function W0(e,t,r){if(t=ab(t),ab(e)!==t&&r)throw Error(pt(425))}function Kp(){}var Ix=null,Mx=null;function Rx(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Bx=typeof setTimeout=="function"?setTimeout:void 0,h6=typeof clearTimeout=="function"?clearTimeout:void 0,ob=typeof Promise=="function"?Promise:void 0,d6=typeof queueMicrotask=="function"?queueMicrotask:typeof ob<"u"?function(e){return ob.resolve(null).then(e).catch(p6)}:Bx;function p6(e){setTimeout(function(){throw e})}function u1(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Zh(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Zh(t)}function Cl(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function lb(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ef=Math.random().toString(36).slice(2),Ua="__reactFiber$"+Ef,id="__reactProps$"+Ef,Fo="__reactContainer$"+Ef,Ux="__reactEvents$"+Ef,g6="__reactListeners$"+Ef,m6="__reactHandles$"+Ef;function xc(e){var t=e[Ua];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Fo]||r[Ua]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=lb(e);e!==null;){if(r=e[Ua])return r;e=lb(e)}return t}e=r,r=e.parentNode}return null}function Wd(e){return e=e[Ua]||e[Fo],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Iu(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(pt(33))}function Wg(e){return e[id]||null}var zx=[],Mu=-1;function zl(e){return{current:e}}function $r(e){0>Mu||(e.current=zx[Mu],zx[Mu]=null,Mu--)}function Rr(e,t){Mu++,zx[Mu]=e.current,e.current=t}var Pl={},Fi=zl(Pl),ts=zl(!1),Ac=Pl;function ff(e,t){var r=e.type.contextTypes;if(!r)return Pl;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function rs(e){return e=e.childContextTypes,e!=null}function Jp(){$r(ts),$r(Fi)}function cb(e,t,r){if(Fi.current!==Pl)throw Error(pt(168));Rr(Fi,t),Rr(ts,r)}function JS(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(pt(108,eA(e)||"Unknown",i));return nn({},r,n)}function Qp(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Pl,Ac=Fi.current,Rr(Fi,e),Rr(ts,ts.current),!0}function ub(e,t,r){var n=e.stateNode;if(!n)throw Error(pt(169));r?(e=JS(e,t,Ac),n.__reactInternalMemoizedMergedChildContext=e,$r(ts),$r(Fi),Rr(Fi,e)):$r(ts),Rr(ts,r)}var _o=null,Hg=!1,f1=!1;function QS(e){_o===null?_o=[e]:_o.push(e)}function x6(e){Hg=!0,QS(e)}function Wl(){if(!f1&&_o!==null){f1=!0;var e=0,t=Nr;try{var r=_o;for(Nr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}_o=null,Hg=!1}catch(i){throw _o!==null&&(_o=_o.slice(e+1)),kS(l2,Wl),i}finally{Nr=t,f1=!1}}return null}var Ru=[],Bu=0,Zp=null,eg=0,qs=[],Vs=0,Oc=null,So=1,Co="";function lc(e,t){Ru[Bu++]=eg,Ru[Bu++]=Zp,Zp=e,eg=t}function ZS(e,t,r){qs[Vs++]=So,qs[Vs++]=Co,qs[Vs++]=Oc,Oc=e;var n=So;e=Co;var i=32-va(n)-1;n&=~(1<<i),r+=1;var s=32-va(t)+i;if(30<s){var l=i-i%5;s=(n&(1<<l)-1).toString(32),n>>=l,i-=l,So=1<<32-va(t)+i|r<<i|n,Co=s+e}else So=1<<s|r<<i|n,Co=e}function x2(e){e.return!==null&&(lc(e,1),ZS(e,1,0))}function v2(e){for(;e===Zp;)Zp=Ru[--Bu],Ru[Bu]=null,eg=Ru[--Bu],Ru[Bu]=null;for(;e===Oc;)Oc=qs[--Vs],qs[Vs]=null,Co=qs[--Vs],qs[Vs]=null,So=qs[--Vs],qs[Vs]=null}var Cs=null,_s=null,Kr=!1,ga=null;function e4(e,t){var r=Gs(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function fb(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Cs=e,_s=Cl(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Cs=e,_s=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Oc!==null?{id:So,overflow:Co}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Gs(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Cs=e,_s=null,!0):!1;default:return!1}}function Wx(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Hx(e){if(Kr){var t=_s;if(t){var r=t;if(!fb(e,t)){if(Wx(e))throw Error(pt(418));t=Cl(r.nextSibling);var n=Cs;t&&fb(e,t)?e4(n,r):(e.flags=e.flags&-4097|2,Kr=!1,Cs=e)}}else{if(Wx(e))throw Error(pt(418));e.flags=e.flags&-4097|2,Kr=!1,Cs=e}}}function hb(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Cs=e}function H0(e){if(e!==Cs)return!1;if(!Kr)return hb(e),Kr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Rx(e.type,e.memoizedProps)),t&&(t=_s)){if(Wx(e))throw t4(),Error(pt(418));for(;t;)e4(e,t),t=Cl(t.nextSibling)}if(hb(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(pt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){_s=Cl(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}_s=null}}else _s=Cs?Cl(e.stateNode.nextSibling):null;return!0}function t4(){for(var e=_s;e;)e=Cl(e.nextSibling)}function hf(){_s=Cs=null,Kr=!1}function y2(e){ga===null?ga=[e]:ga.push(e)}var v6=Bo.ReactCurrentBatchConfig;function ch(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(pt(309));var n=r.stateNode}if(!n)throw Error(pt(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(l){var o=i.refs;l===null?delete o[s]:o[s]=l},t._stringRef=s,t)}if(typeof e!="string")throw Error(pt(284));if(!r._owner)throw Error(pt(290,e))}return e}function $0(e,t){throw e=Object.prototype.toString.call(t),Error(pt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function db(e){var t=e._init;return t(e._payload)}function r4(e){function t(x,y){if(e){var w=x.deletions;w===null?(x.deletions=[y],x.flags|=16):w.push(y)}}function r(x,y){if(!e)return null;for(;y!==null;)t(x,y),y=y.sibling;return null}function n(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function i(x,y){return x=Al(x,y),x.index=0,x.sibling=null,x}function s(x,y,w){return x.index=w,e?(w=x.alternate,w!==null?(w=w.index,w<y?(x.flags|=2,y):w):(x.flags|=2,y)):(x.flags|=1048576,y)}function l(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,y,w,b){return y===null||y.tag!==6?(y=v1(w,x.mode,b),y.return=x,y):(y=i(y,w),y.return=x,y)}function a(x,y,w,b){var S=w.type;return S===Pu?f(x,y,w.props.children,b,w.key):y!==null&&(y.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===fl&&db(S)===y.type)?(b=i(y,w.props),b.ref=ch(x,y,w),b.return=x,b):(b=Dp(w.type,w.key,w.props,null,x.mode,b),b.ref=ch(x,y,w),b.return=x,b)}function c(x,y,w,b){return y===null||y.tag!==4||y.stateNode.containerInfo!==w.containerInfo||y.stateNode.implementation!==w.implementation?(y=y1(w,x.mode,b),y.return=x,y):(y=i(y,w.children||[]),y.return=x,y)}function f(x,y,w,b,S){return y===null||y.tag!==7?(y=kc(w,x.mode,b,S),y.return=x,y):(y=i(y,w),y.return=x,y)}function h(x,y,w){if(typeof y=="string"&&y!==""||typeof y=="number")return y=v1(""+y,x.mode,w),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case F0:return w=Dp(y.type,y.key,y.props,null,x.mode,w),w.ref=ch(x,null,y),w.return=x,w;case ju:return y=y1(y,x.mode,w),y.return=x,y;case fl:var b=y._init;return h(x,b(y._payload),w)}if(vh(y)||ih(y))return y=kc(y,x.mode,w,null),y.return=x,y;$0(x,y)}return null}function d(x,y,w,b){var S=y!==null?y.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return S!==null?null:o(x,y,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case F0:return w.key===S?a(x,y,w,b):null;case ju:return w.key===S?c(x,y,w,b):null;case fl:return S=w._init,d(x,y,S(w._payload),b)}if(vh(w)||ih(w))return S!==null?null:f(x,y,w,b,null);$0(x,w)}return null}function u(x,y,w,b,S){if(typeof b=="string"&&b!==""||typeof b=="number")return x=x.get(w)||null,o(y,x,""+b,S);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case F0:return x=x.get(b.key===null?w:b.key)||null,a(y,x,b,S);case ju:return x=x.get(b.key===null?w:b.key)||null,c(y,x,b,S);case fl:var T=b._init;return u(x,y,w,T(b._payload),S)}if(vh(b)||ih(b))return x=x.get(w)||null,f(y,x,b,S,null);$0(y,b)}return null}function p(x,y,w,b){for(var S=null,T=null,O=y,j=y=0,L=null;O!==null&&j<w.length;j++){O.index>j?(L=O,O=null):L=O.sibling;var W=d(x,O,w[j],b);if(W===null){O===null&&(O=L);break}e&&O&&W.alternate===null&&t(x,O),y=s(W,y,j),T===null?S=W:T.sibling=W,T=W,O=L}if(j===w.length)return r(x,O),Kr&&lc(x,j),S;if(O===null){for(;j<w.length;j++)O=h(x,w[j],b),O!==null&&(y=s(O,y,j),T===null?S=O:T.sibling=O,T=O);return Kr&&lc(x,j),S}for(O=n(x,O);j<w.length;j++)L=u(O,x,j,w[j],b),L!==null&&(e&&L.alternate!==null&&O.delete(L.key===null?j:L.key),y=s(L,y,j),T===null?S=L:T.sibling=L,T=L);return e&&O.forEach(function(F){return t(x,F)}),Kr&&lc(x,j),S}function m(x,y,w,b){var S=ih(w);if(typeof S!="function")throw Error(pt(150));if(w=S.call(w),w==null)throw Error(pt(151));for(var T=S=null,O=y,j=y=0,L=null,W=w.next();O!==null&&!W.done;j++,W=w.next()){O.index>j?(L=O,O=null):L=O.sibling;var F=d(x,O,W.value,b);if(F===null){O===null&&(O=L);break}e&&O&&F.alternate===null&&t(x,O),y=s(F,y,j),T===null?S=F:T.sibling=F,T=F,O=L}if(W.done)return r(x,O),Kr&&lc(x,j),S;if(O===null){for(;!W.done;j++,W=w.next())W=h(x,W.value,b),W!==null&&(y=s(W,y,j),T===null?S=W:T.sibling=W,T=W);return Kr&&lc(x,j),S}for(O=n(x,O);!W.done;j++,W=w.next())W=u(O,x,j,W.value,b),W!==null&&(e&&W.alternate!==null&&O.delete(W.key===null?j:W.key),y=s(W,y,j),T===null?S=W:T.sibling=W,T=W);return e&&O.forEach(function(M){return t(x,M)}),Kr&&lc(x,j),S}function g(x,y,w,b){if(typeof w=="object"&&w!==null&&w.type===Pu&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case F0:e:{for(var S=w.key,T=y;T!==null;){if(T.key===S){if(S=w.type,S===Pu){if(T.tag===7){r(x,T.sibling),y=i(T,w.props.children),y.return=x,x=y;break e}}else if(T.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===fl&&db(S)===T.type){r(x,T.sibling),y=i(T,w.props),y.ref=ch(x,T,w),y.return=x,x=y;break e}r(x,T);break}else t(x,T);T=T.sibling}w.type===Pu?(y=kc(w.props.children,x.mode,b,w.key),y.return=x,x=y):(b=Dp(w.type,w.key,w.props,null,x.mode,b),b.ref=ch(x,y,w),b.return=x,x=b)}return l(x);case ju:e:{for(T=w.key;y!==null;){if(y.key===T)if(y.tag===4&&y.stateNode.containerInfo===w.containerInfo&&y.stateNode.implementation===w.implementation){r(x,y.sibling),y=i(y,w.children||[]),y.return=x,x=y;break e}else{r(x,y);break}else t(x,y);y=y.sibling}y=y1(w,x.mode,b),y.return=x,x=y}return l(x);case fl:return T=w._init,g(x,y,T(w._payload),b)}if(vh(w))return p(x,y,w,b);if(ih(w))return m(x,y,w,b);$0(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,y!==null&&y.tag===6?(r(x,y.sibling),y=i(y,w),y.return=x,x=y):(r(x,y),y=v1(w,x.mode,b),y.return=x,x=y),l(x)):r(x,y)}return g}var df=r4(!0),n4=r4(!1),tg=zl(null),rg=null,Uu=null,w2=null;function b2(){w2=Uu=rg=null}function _2(e){var t=tg.current;$r(tg),e._currentValue=t}function $x(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ku(e,t){rg=e,w2=Uu=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(es=!0),e.firstContext=null)}function Ks(e){var t=e._currentValue;if(w2!==e)if(e={context:e,memoizedValue:t,next:null},Uu===null){if(rg===null)throw Error(pt(308));Uu=e,rg.dependencies={lanes:0,firstContext:e}}else Uu=Uu.next=e;return t}var vc=null;function k2(e){vc===null?vc=[e]:vc.push(e)}function i4(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,k2(t)):(r.next=i.next,i.next=r),t.interleaved=r,Do(e,n)}function Do(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var hl=!1;function S2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function s4(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function To(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function El(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,pr&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Do(e,r)}return i=n.interleaved,i===null?(t.next=t,k2(n)):(t.next=i.next,i.next=t),n.interleaved=t,Do(e,r)}function Np(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,c2(e,r)}}function pb(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=l:s=s.next=l,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function ng(e,t,r,n){var i=e.updateQueue;hl=!1;var s=i.firstBaseUpdate,l=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var a=o,c=a.next;a.next=null,l===null?s=c:l.next=c,l=a;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==l&&(o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=a))}if(s!==null){var h=i.baseState;l=0,f=c=a=null,o=s;do{var d=o.lane,u=o.eventTime;if((n&d)===d){f!==null&&(f=f.next={eventTime:u,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,m=o;switch(d=t,u=r,m.tag){case 1:if(p=m.payload,typeof p=="function"){h=p.call(u,h,d);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,d=typeof p=="function"?p.call(u,h,d):p,d==null)break e;h=nn({},h,d);break e;case 2:hl=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=i.effects,d===null?i.effects=[o]:d.push(o))}else u={eventTime:u,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(c=f=u,a=h):f=f.next=u,l|=d;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;d=o,o=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(f===null&&(a=h),i.baseState=a,i.firstBaseUpdate=c,i.lastBaseUpdate=f,t=i.shared.interleaved,t!==null){i=t;do l|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Pc|=l,e.lanes=l,e.memoizedState=h}}function gb(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(pt(191,i));i.call(n)}}}var Hd={},Ya=zl(Hd),sd=zl(Hd),ad=zl(Hd);function yc(e){if(e===Hd)throw Error(pt(174));return e}function C2(e,t){switch(Rr(ad,t),Rr(sd,e),Rr(Ya,Hd),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Sx(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Sx(t,e)}$r(Ya),Rr(Ya,t)}function pf(){$r(Ya),$r(sd),$r(ad)}function a4(e){yc(ad.current);var t=yc(Ya.current),r=Sx(t,e.type);t!==r&&(Rr(sd,e),Rr(Ya,r))}function E2(e){sd.current===e&&($r(Ya),$r(sd))}var Qr=zl(0);function ig(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var h1=[];function T2(){for(var e=0;e<h1.length;e++)h1[e]._workInProgressVersionPrimary=null;h1.length=0}var Ap=Bo.ReactCurrentDispatcher,d1=Bo.ReactCurrentBatchConfig,jc=0,rn=null,Gn=null,Zn=null,sg=!1,Oh=!1,od=0,y6=0;function wi(){throw Error(pt(321))}function N2(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!_a(e[r],t[r]))return!1;return!0}function A2(e,t,r,n,i,s){if(jc=s,rn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ap.current=e===null||e.memoizedState===null?k6:S6,e=r(n,i),Oh){s=0;do{if(Oh=!1,od=0,25<=s)throw Error(pt(301));s+=1,Zn=Gn=null,t.updateQueue=null,Ap.current=C6,e=r(n,i)}while(Oh)}if(Ap.current=ag,t=Gn!==null&&Gn.next!==null,jc=0,Zn=Gn=rn=null,sg=!1,t)throw Error(pt(300));return e}function O2(){var e=od!==0;return od=0,e}function Ba(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zn===null?rn.memoizedState=Zn=e:Zn=Zn.next=e,Zn}function Js(){if(Gn===null){var e=rn.alternate;e=e!==null?e.memoizedState:null}else e=Gn.next;var t=Zn===null?rn.memoizedState:Zn.next;if(t!==null)Zn=t,Gn=e;else{if(e===null)throw Error(pt(310));Gn=e,e={memoizedState:Gn.memoizedState,baseState:Gn.baseState,baseQueue:Gn.baseQueue,queue:Gn.queue,next:null},Zn===null?rn.memoizedState=Zn=e:Zn=Zn.next=e}return Zn}function ld(e,t){return typeof t=="function"?t(e):t}function p1(e){var t=Js(),r=t.queue;if(r===null)throw Error(pt(311));r.lastRenderedReducer=e;var n=Gn,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var l=i.next;i.next=s.next,s.next=l}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=l=null,a=null,c=s;do{var f=c.lane;if((jc&f)===f)a!==null&&(a=a.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};a===null?(o=a=h,l=n):a=a.next=h,rn.lanes|=f,Pc|=f}c=c.next}while(c!==null&&c!==s);a===null?l=n:a.next=o,_a(n,t.memoizedState)||(es=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=a,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,rn.lanes|=s,Pc|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function g1(e){var t=Js(),r=t.queue;if(r===null)throw Error(pt(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var l=i=i.next;do s=e(s,l.action),l=l.next;while(l!==i);_a(s,t.memoizedState)||(es=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function o4(){}function l4(e,t){var r=rn,n=Js(),i=t(),s=!_a(n.memoizedState,i);if(s&&(n.memoizedState=i,es=!0),n=n.queue,j2(f4.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Zn!==null&&Zn.memoizedState.tag&1){if(r.flags|=2048,cd(9,u4.bind(null,r,n,i,t),void 0,null),ni===null)throw Error(pt(349));jc&30||c4(r,t,i)}return i}function c4(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=rn.updateQueue,t===null?(t={lastEffect:null,stores:null},rn.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function u4(e,t,r,n){t.value=r,t.getSnapshot=n,h4(t)&&d4(e)}function f4(e,t,r){return r(function(){h4(t)&&d4(e)})}function h4(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!_a(e,r)}catch{return!0}}function d4(e){var t=Do(e,1);t!==null&&ya(t,e,1,-1)}function mb(e){var t=Ba();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ld,lastRenderedState:e},t.queue=e,e=e.dispatch=_6.bind(null,rn,e),[t.memoizedState,e]}function cd(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=rn.updateQueue,t===null?(t={lastEffect:null,stores:null},rn.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function p4(){return Js().memoizedState}function Op(e,t,r,n){var i=Ba();rn.flags|=e,i.memoizedState=cd(1|t,r,void 0,n===void 0?null:n)}function $g(e,t,r,n){var i=Js();n=n===void 0?null:n;var s=void 0;if(Gn!==null){var l=Gn.memoizedState;if(s=l.destroy,n!==null&&N2(n,l.deps)){i.memoizedState=cd(t,r,s,n);return}}rn.flags|=e,i.memoizedState=cd(1|t,r,s,n)}function xb(e,t){return Op(8390656,8,e,t)}function j2(e,t){return $g(2048,8,e,t)}function g4(e,t){return $g(4,2,e,t)}function m4(e,t){return $g(4,4,e,t)}function x4(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function v4(e,t,r){return r=r!=null?r.concat([e]):null,$g(4,4,x4.bind(null,t,e),r)}function P2(){}function y4(e,t){var r=Js();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&N2(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function w4(e,t){var r=Js();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&N2(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function b4(e,t,r){return jc&21?(_a(r,t)||(r=ES(),rn.lanes|=r,Pc|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,es=!0),e.memoizedState=r)}function w6(e,t){var r=Nr;Nr=r!==0&&4>r?r:4,e(!0);var n=d1.transition;d1.transition={};try{e(!1),t()}finally{Nr=r,d1.transition=n}}function _4(){return Js().memoizedState}function b6(e,t,r){var n=Nl(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},k4(e))S4(t,r);else if(r=i4(e,t,r,n),r!==null){var i=$i();ya(r,e,n,i),C4(r,t,n)}}function _6(e,t,r){var n=Nl(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(k4(e))S4(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var l=t.lastRenderedState,o=s(l,r);if(i.hasEagerState=!0,i.eagerState=o,_a(o,l)){var a=t.interleaved;a===null?(i.next=i,k2(t)):(i.next=a.next,a.next=i),t.interleaved=i;return}}catch{}finally{}r=i4(e,t,i,n),r!==null&&(i=$i(),ya(r,e,n,i),C4(r,t,n))}}function k4(e){var t=e.alternate;return e===rn||t!==null&&t===rn}function S4(e,t){Oh=sg=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function C4(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,c2(e,r)}}var ag={readContext:Ks,useCallback:wi,useContext:wi,useEffect:wi,useImperativeHandle:wi,useInsertionEffect:wi,useLayoutEffect:wi,useMemo:wi,useReducer:wi,useRef:wi,useState:wi,useDebugValue:wi,useDeferredValue:wi,useTransition:wi,useMutableSource:wi,useSyncExternalStore:wi,useId:wi,unstable_isNewReconciler:!1},k6={readContext:Ks,useCallback:function(e,t){return Ba().memoizedState=[e,t===void 0?null:t],e},useContext:Ks,useEffect:xb,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Op(4194308,4,x4.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Op(4194308,4,e,t)},useInsertionEffect:function(e,t){return Op(4,2,e,t)},useMemo:function(e,t){var r=Ba();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Ba();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=b6.bind(null,rn,e),[n.memoizedState,e]},useRef:function(e){var t=Ba();return e={current:e},t.memoizedState=e},useState:mb,useDebugValue:P2,useDeferredValue:function(e){return Ba().memoizedState=e},useTransition:function(){var e=mb(!1),t=e[0];return e=w6.bind(null,e[1]),Ba().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=rn,i=Ba();if(Kr){if(r===void 0)throw Error(pt(407));r=r()}else{if(r=t(),ni===null)throw Error(pt(349));jc&30||c4(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,xb(f4.bind(null,n,s,e),[e]),n.flags|=2048,cd(9,u4.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Ba(),t=ni.identifierPrefix;if(Kr){var r=Co,n=So;r=(n&~(1<<32-va(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=od++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=y6++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},S6={readContext:Ks,useCallback:y4,useContext:Ks,useEffect:j2,useImperativeHandle:v4,useInsertionEffect:g4,useLayoutEffect:m4,useMemo:w4,useReducer:p1,useRef:p4,useState:function(){return p1(ld)},useDebugValue:P2,useDeferredValue:function(e){var t=Js();return b4(t,Gn.memoizedState,e)},useTransition:function(){var e=p1(ld)[0],t=Js().memoizedState;return[e,t]},useMutableSource:o4,useSyncExternalStore:l4,useId:_4,unstable_isNewReconciler:!1},C6={readContext:Ks,useCallback:y4,useContext:Ks,useEffect:j2,useImperativeHandle:v4,useInsertionEffect:g4,useLayoutEffect:m4,useMemo:w4,useReducer:g1,useRef:p4,useState:function(){return g1(ld)},useDebugValue:P2,useDeferredValue:function(e){var t=Js();return Gn===null?t.memoizedState=e:b4(t,Gn.memoizedState,e)},useTransition:function(){var e=g1(ld)[0],t=Js().memoizedState;return[e,t]},useMutableSource:o4,useSyncExternalStore:l4,useId:_4,unstable_isNewReconciler:!1};function ha(e,t){if(e&&e.defaultProps){t=nn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function qx(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:nn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var qg={isMounted:function(e){return(e=e._reactInternals)?$c(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=$i(),i=Nl(e),s=To(n,i);s.payload=t,r!=null&&(s.callback=r),t=El(e,s,i),t!==null&&(ya(t,e,i,n),Np(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=$i(),i=Nl(e),s=To(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=El(e,s,i),t!==null&&(ya(t,e,i,n),Np(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=$i(),n=Nl(e),i=To(r,n);i.tag=2,t!=null&&(i.callback=t),t=El(e,i,n),t!==null&&(ya(t,e,n,r),Np(t,e,n))}};function vb(e,t,r,n,i,s,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,l):t.prototype&&t.prototype.isPureReactComponent?!td(r,n)||!td(i,s):!0}function E4(e,t,r){var n=!1,i=Pl,s=t.contextType;return typeof s=="object"&&s!==null?s=Ks(s):(i=rs(t)?Ac:Fi.current,n=t.contextTypes,s=(n=n!=null)?ff(e,i):Pl),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=qg,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function yb(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&qg.enqueueReplaceState(t,t.state,null)}function Vx(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},S2(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Ks(s):(s=rs(t)?Ac:Fi.current,i.context=ff(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(qx(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&qg.enqueueReplaceState(i,i.state,null),ng(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function gf(e,t){try{var r="",n=t;do r+=ZN(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function m1(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Gx(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var E6=typeof WeakMap=="function"?WeakMap:Map;function T4(e,t,r){r=To(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){lg||(lg=!0,nv=n),Gx(e,t)},r}function N4(e,t,r){r=To(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Gx(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Gx(e,t),typeof n!="function"&&(Tl===null?Tl=new Set([this]):Tl.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function wb(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new E6;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=U6.bind(null,e,t,r),t.then(e,e))}function bb(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function _b(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=To(-1,1),t.tag=2,El(r,t,1))),r.lanes|=1),e)}var T6=Bo.ReactCurrentOwner,es=!1;function zi(e,t,r,n){t.child=e===null?n4(t,null,r,n):df(t,e.child,r,n)}function kb(e,t,r,n,i){r=r.render;var s=t.ref;return Ku(t,i),n=A2(e,t,r,n,s,i),r=O2(),e!==null&&!es?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Lo(e,t,i)):(Kr&&r&&x2(t),t.flags|=1,zi(e,t,n,i),t.child)}function Sb(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!U2(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,A4(e,t,s,n,i)):(e=Dp(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var l=s.memoizedProps;if(r=r.compare,r=r!==null?r:td,r(l,n)&&e.ref===t.ref)return Lo(e,t,i)}return t.flags|=1,e=Al(s,n),e.ref=t.ref,e.return=t,t.child=e}function A4(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(td(s,n)&&e.ref===t.ref)if(es=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(es=!0);else return t.lanes=e.lanes,Lo(e,t,i)}return Xx(e,t,r,n,i)}function O4(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Rr(Wu,xs),xs|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Rr(Wu,xs),xs|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Rr(Wu,xs),xs|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Rr(Wu,xs),xs|=n;return zi(e,t,i,r),t.child}function j4(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Xx(e,t,r,n,i){var s=rs(r)?Ac:Fi.current;return s=ff(t,s),Ku(t,i),r=A2(e,t,r,n,s,i),n=O2(),e!==null&&!es?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Lo(e,t,i)):(Kr&&n&&x2(t),t.flags|=1,zi(e,t,r,i),t.child)}function Cb(e,t,r,n,i){if(rs(r)){var s=!0;Qp(t)}else s=!1;if(Ku(t,i),t.stateNode===null)jp(e,t),E4(t,r,n),Vx(t,r,n,i),n=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var a=l.context,c=r.contextType;typeof c=="object"&&c!==null?c=Ks(c):(c=rs(r)?Ac:Fi.current,c=ff(t,c));var f=r.getDerivedStateFromProps,h=typeof f=="function"||typeof l.getSnapshotBeforeUpdate=="function";h||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||a!==c)&&yb(t,l,n,c),hl=!1;var d=t.memoizedState;l.state=d,ng(t,n,l,i),a=t.memoizedState,o!==n||d!==a||ts.current||hl?(typeof f=="function"&&(qx(t,r,f,n),a=t.memoizedState),(o=hl||vb(t,r,o,n,d,a,c))?(h||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=a),l.props=n,l.state=a,l.context=c,n=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,s4(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:ha(t.type,o),l.props=c,h=t.pendingProps,d=l.context,a=r.contextType,typeof a=="object"&&a!==null?a=Ks(a):(a=rs(r)?Ac:Fi.current,a=ff(t,a));var u=r.getDerivedStateFromProps;(f=typeof u=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==h||d!==a)&&yb(t,l,n,a),hl=!1,d=t.memoizedState,l.state=d,ng(t,n,l,i);var p=t.memoizedState;o!==h||d!==p||ts.current||hl?(typeof u=="function"&&(qx(t,r,u,n),p=t.memoizedState),(c=hl||vb(t,r,c,n,d,p,a)||!1)?(f||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,p,a),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,p,a)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),l.props=n,l.state=p,l.context=a,n=c):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return Yx(e,t,r,n,s,i)}function Yx(e,t,r,n,i,s){j4(e,t);var l=(t.flags&128)!==0;if(!n&&!l)return i&&ub(t,r,!1),Lo(e,t,s);n=t.stateNode,T6.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&l?(t.child=df(t,e.child,null,s),t.child=df(t,null,o,s)):zi(e,t,o,s),t.memoizedState=n.state,i&&ub(t,r,!0),t.child}function P4(e){var t=e.stateNode;t.pendingContext?cb(e,t.pendingContext,t.pendingContext!==t.context):t.context&&cb(e,t.context,!1),C2(e,t.containerInfo)}function Eb(e,t,r,n,i){return hf(),y2(i),t.flags|=256,zi(e,t,r,n),t.child}var Kx={dehydrated:null,treeContext:null,retryLane:0};function Jx(e){return{baseLanes:e,cachePool:null,transitions:null}}function F4(e,t,r){var n=t.pendingProps,i=Qr.current,s=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Rr(Qr,i&1),e===null)return Hx(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=n.children,e=n.fallback,s?(n=t.mode,s=t.child,l={mode:"hidden",children:l},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=l):s=Xg(l,n,0,null),e=kc(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Jx(r),t.memoizedState=Kx,e):F2(t,l));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return N6(e,t,l,n,o,i,r);if(s){s=n.fallback,l=t.mode,i=e.child,o=i.sibling;var a={mode:"hidden",children:n.children};return!(l&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=a,t.deletions=null):(n=Al(i,a),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Al(o,s):(s=kc(s,l,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,l=e.child.memoizedState,l=l===null?Jx(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~r,t.memoizedState=Kx,n}return s=e.child,e=s.sibling,n=Al(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function F2(e,t){return t=Xg({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function q0(e,t,r,n){return n!==null&&y2(n),df(t,e.child,null,r),e=F2(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function N6(e,t,r,n,i,s,l){if(r)return t.flags&256?(t.flags&=-257,n=m1(Error(pt(422))),q0(e,t,l,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=Xg({mode:"visible",children:n.children},i,0,null),s=kc(s,i,l,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&df(t,e.child,null,l),t.child.memoizedState=Jx(l),t.memoizedState=Kx,s);if(!(t.mode&1))return q0(e,t,l,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(pt(419)),n=m1(s,n,void 0),q0(e,t,l,n)}if(o=(l&e.childLanes)!==0,es||o){if(n=ni,n!==null){switch(l&-l){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|l)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Do(e,i),ya(n,e,i,-1))}return B2(),n=m1(Error(pt(421))),q0(e,t,l,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=z6.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,_s=Cl(i.nextSibling),Cs=t,Kr=!0,ga=null,e!==null&&(qs[Vs++]=So,qs[Vs++]=Co,qs[Vs++]=Oc,So=e.id,Co=e.overflow,Oc=t),t=F2(t,n.children),t.flags|=4096,t)}function Tb(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),$x(e.return,t,r)}function x1(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function D4(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(zi(e,t,n.children,r),n=Qr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Tb(e,r,t);else if(e.tag===19)Tb(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Rr(Qr,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&ig(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),x1(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&ig(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}x1(t,!0,r,null,s);break;case"together":x1(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function jp(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Lo(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Pc|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(pt(153));if(t.child!==null){for(e=t.child,r=Al(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Al(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function A6(e,t,r){switch(t.tag){case 3:P4(t),hf();break;case 5:a4(t);break;case 1:rs(t.type)&&Qp(t);break;case 4:C2(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Rr(tg,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Rr(Qr,Qr.current&1),t.flags|=128,null):r&t.child.childLanes?F4(e,t,r):(Rr(Qr,Qr.current&1),e=Lo(e,t,r),e!==null?e.sibling:null);Rr(Qr,Qr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return D4(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Rr(Qr,Qr.current),n)break;return null;case 22:case 23:return t.lanes=0,O4(e,t,r)}return Lo(e,t,r)}var L4,Qx,I4,M4;L4=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Qx=function(){};I4=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,yc(Ya.current);var s=null;switch(r){case"input":i=wx(e,i),n=wx(e,n),s=[];break;case"select":i=nn({},i,{value:void 0}),n=nn({},n,{value:void 0}),s=[];break;case"textarea":i=kx(e,i),n=kx(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Kp)}Cx(r,n);var l;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Xh.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var a=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&a!==o&&(a!=null||o!=null))if(c==="style")if(o){for(l in o)!o.hasOwnProperty(l)||a&&a.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in a)a.hasOwnProperty(l)&&o[l]!==a[l]&&(r||(r={}),r[l]=a[l])}else r||(s||(s=[]),s.push(c,r)),r=a;else c==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,o=o?o.__html:void 0,a!=null&&o!==a&&(s=s||[]).push(c,a)):c==="children"?typeof a!="string"&&typeof a!="number"||(s=s||[]).push(c,""+a):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Xh.hasOwnProperty(c)?(a!=null&&c==="onScroll"&&Ur("scroll",e),s||o===a||(s=[])):(s=s||[]).push(c,a))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};M4=function(e,t,r,n){r!==n&&(t.flags|=4)};function uh(e,t){if(!Kr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function bi(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function O6(e,t,r){var n=t.pendingProps;switch(v2(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bi(t),null;case 1:return rs(t.type)&&Jp(),bi(t),null;case 3:return n=t.stateNode,pf(),$r(ts),$r(Fi),T2(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(H0(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ga!==null&&(av(ga),ga=null))),Qx(e,t),bi(t),null;case 5:E2(t);var i=yc(ad.current);if(r=t.type,e!==null&&t.stateNode!=null)I4(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(pt(166));return bi(t),null}if(e=yc(Ya.current),H0(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Ua]=t,n[id]=s,e=(t.mode&1)!==0,r){case"dialog":Ur("cancel",n),Ur("close",n);break;case"iframe":case"object":case"embed":Ur("load",n);break;case"video":case"audio":for(i=0;i<wh.length;i++)Ur(wh[i],n);break;case"source":Ur("error",n);break;case"img":case"image":case"link":Ur("error",n),Ur("load",n);break;case"details":Ur("toggle",n);break;case"input":Iw(n,s),Ur("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Ur("invalid",n);break;case"textarea":Rw(n,s),Ur("invalid",n)}Cx(r,s),i=null;for(var l in s)if(s.hasOwnProperty(l)){var o=s[l];l==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&W0(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&W0(n.textContent,o,e),i=["children",""+o]):Xh.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&Ur("scroll",n)}switch(r){case"input":D0(n),Mw(n,s,!0);break;case"textarea":D0(n),Bw(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Kp)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{l=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=fS(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),r==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[Ua]=t,e[id]=n,L4(e,t,!1,!1),t.stateNode=e;e:{switch(l=Ex(r,n),r){case"dialog":Ur("cancel",e),Ur("close",e),i=n;break;case"iframe":case"object":case"embed":Ur("load",e),i=n;break;case"video":case"audio":for(i=0;i<wh.length;i++)Ur(wh[i],e);i=n;break;case"source":Ur("error",e),i=n;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),i=n;break;case"details":Ur("toggle",e),i=n;break;case"input":Iw(e,n),i=wx(e,n),Ur("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=nn({},n,{value:void 0}),Ur("invalid",e);break;case"textarea":Rw(e,n),i=kx(e,n),Ur("invalid",e);break;default:i=n}Cx(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="style"?pS(e,a):s==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&hS(e,a)):s==="children"?typeof a=="string"?(r!=="textarea"||a!=="")&&Yh(e,a):typeof a=="number"&&Yh(e,""+a):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Xh.hasOwnProperty(s)?a!=null&&s==="onScroll"&&Ur("scroll",e):a!=null&&n2(e,s,a,l))}switch(r){case"input":D0(e),Mw(e,n,!1);break;case"textarea":D0(e),Bw(e);break;case"option":n.value!=null&&e.setAttribute("value",""+jl(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Vu(e,!!n.multiple,s,!1):n.defaultValue!=null&&Vu(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Kp)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return bi(t),null;case 6:if(e&&t.stateNode!=null)M4(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(pt(166));if(r=yc(ad.current),yc(Ya.current),H0(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ua]=t,(s=n.nodeValue!==r)&&(e=Cs,e!==null))switch(e.tag){case 3:W0(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&W0(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ua]=t,t.stateNode=n}return bi(t),null;case 13:if($r(Qr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Kr&&_s!==null&&t.mode&1&&!(t.flags&128))t4(),hf(),t.flags|=98560,s=!1;else if(s=H0(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(pt(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(pt(317));s[Ua]=t}else hf(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;bi(t),s=!1}else ga!==null&&(av(ga),ga=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Qr.current&1?Yn===0&&(Yn=3):B2())),t.updateQueue!==null&&(t.flags|=4),bi(t),null);case 4:return pf(),Qx(e,t),e===null&&rd(t.stateNode.containerInfo),bi(t),null;case 10:return _2(t.type._context),bi(t),null;case 17:return rs(t.type)&&Jp(),bi(t),null;case 19:if($r(Qr),s=t.memoizedState,s===null)return bi(t),null;if(n=(t.flags&128)!==0,l=s.rendering,l===null)if(n)uh(s,!1);else{if(Yn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=ig(e),l!==null){for(t.flags|=128,uh(s,!1),n=l.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,l=s.alternate,l===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Rr(Qr,Qr.current&1|2),t.child}e=e.sibling}s.tail!==null&&bn()>mf&&(t.flags|=128,n=!0,uh(s,!1),t.lanes=4194304)}else{if(!n)if(e=ig(l),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),uh(s,!0),s.tail===null&&s.tailMode==="hidden"&&!l.alternate&&!Kr)return bi(t),null}else 2*bn()-s.renderingStartTime>mf&&r!==1073741824&&(t.flags|=128,n=!0,uh(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(r=s.last,r!==null?r.sibling=l:t.child=l,s.last=l)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=bn(),t.sibling=null,r=Qr.current,Rr(Qr,n?r&1|2:r&1),t):(bi(t),null);case 22:case 23:return R2(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?xs&1073741824&&(bi(t),t.subtreeFlags&6&&(t.flags|=8192)):bi(t),null;case 24:return null;case 25:return null}throw Error(pt(156,t.tag))}function j6(e,t){switch(v2(t),t.tag){case 1:return rs(t.type)&&Jp(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return pf(),$r(ts),$r(Fi),T2(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return E2(t),null;case 13:if($r(Qr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(pt(340));hf()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return $r(Qr),null;case 4:return pf(),null;case 10:return _2(t.type._context),null;case 22:case 23:return R2(),null;case 24:return null;default:return null}}var V0=!1,Ai=!1,P6=typeof WeakSet=="function"?WeakSet:Set,Tt=null;function zu(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){un(e,t,n)}else r.current=null}function Zx(e,t,r){try{r()}catch(n){un(e,t,n)}}var Nb=!1;function F6(e,t){if(Ix=Gp,e=WS(),m2(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var l=0,o=-1,a=-1,c=0,f=0,h=e,d=null;t:for(;;){for(var u;h!==r||i!==0&&h.nodeType!==3||(o=l+i),h!==s||n!==0&&h.nodeType!==3||(a=l+n),h.nodeType===3&&(l+=h.nodeValue.length),(u=h.firstChild)!==null;)d=h,h=u;for(;;){if(h===e)break t;if(d===r&&++c===i&&(o=l),d===s&&++f===n&&(a=l),(u=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=u}r=o===-1||a===-1?null:{start:o,end:a}}else r=null}r=r||{start:0,end:0}}else r=null;for(Mx={focusedElem:e,selectionRange:r},Gp=!1,Tt=t;Tt!==null;)if(t=Tt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Tt=e;else for(;Tt!==null;){t=Tt;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,x=t.stateNode,y=x.getSnapshotBeforeUpdate(t.elementType===t.type?m:ha(t.type,m),g);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pt(163))}}catch(b){un(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,Tt=e;break}Tt=t.return}return p=Nb,Nb=!1,p}function jh(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&Zx(t,r,s)}i=i.next}while(i!==n)}}function Vg(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function ev(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function R4(e){var t=e.alternate;t!==null&&(e.alternate=null,R4(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ua],delete t[id],delete t[Ux],delete t[g6],delete t[m6])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function B4(e){return e.tag===5||e.tag===3||e.tag===4}function Ab(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||B4(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function tv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Kp));else if(n!==4&&(e=e.child,e!==null))for(tv(e,t,r),e=e.sibling;e!==null;)tv(e,t,r),e=e.sibling}function rv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(rv(e,t,r),e=e.sibling;e!==null;)rv(e,t,r),e=e.sibling}var di=null,da=!1;function al(e,t,r){for(r=r.child;r!==null;)U4(e,t,r),r=r.sibling}function U4(e,t,r){if(Xa&&typeof Xa.onCommitFiberUnmount=="function")try{Xa.onCommitFiberUnmount(Rg,r)}catch{}switch(r.tag){case 5:Ai||zu(r,t);case 6:var n=di,i=da;di=null,al(e,t,r),di=n,da=i,di!==null&&(da?(e=di,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):di.removeChild(r.stateNode));break;case 18:di!==null&&(da?(e=di,r=r.stateNode,e.nodeType===8?u1(e.parentNode,r):e.nodeType===1&&u1(e,r),Zh(e)):u1(di,r.stateNode));break;case 4:n=di,i=da,di=r.stateNode.containerInfo,da=!0,al(e,t,r),di=n,da=i;break;case 0:case 11:case 14:case 15:if(!Ai&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,l=s.destroy;s=s.tag,l!==void 0&&(s&2||s&4)&&Zx(r,t,l),i=i.next}while(i!==n)}al(e,t,r);break;case 1:if(!Ai&&(zu(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){un(r,t,o)}al(e,t,r);break;case 21:al(e,t,r);break;case 22:r.mode&1?(Ai=(n=Ai)||r.memoizedState!==null,al(e,t,r),Ai=n):al(e,t,r);break;default:al(e,t,r)}}function Ob(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new P6),t.forEach(function(n){var i=W6.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function la(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:di=o.stateNode,da=!1;break e;case 3:di=o.stateNode.containerInfo,da=!0;break e;case 4:di=o.stateNode.containerInfo,da=!0;break e}o=o.return}if(di===null)throw Error(pt(160));U4(s,l,i),di=null,da=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(c){un(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)z4(t,e),t=t.sibling}function z4(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(la(t,e),Fa(e),n&4){try{jh(3,e,e.return),Vg(3,e)}catch(m){un(e,e.return,m)}try{jh(5,e,e.return)}catch(m){un(e,e.return,m)}}break;case 1:la(t,e),Fa(e),n&512&&r!==null&&zu(r,r.return);break;case 5:if(la(t,e),Fa(e),n&512&&r!==null&&zu(r,r.return),e.flags&32){var i=e.stateNode;try{Yh(i,"")}catch(m){un(e,e.return,m)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,l=r!==null?r.memoizedProps:s,o=e.type,a=e.updateQueue;if(e.updateQueue=null,a!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&cS(i,s),Ex(o,l);var c=Ex(o,s);for(l=0;l<a.length;l+=2){var f=a[l],h=a[l+1];f==="style"?pS(i,h):f==="dangerouslySetInnerHTML"?hS(i,h):f==="children"?Yh(i,h):n2(i,f,h,c)}switch(o){case"input":bx(i,s);break;case"textarea":uS(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var u=s.value;u!=null?Vu(i,!!s.multiple,u,!1):d!==!!s.multiple&&(s.defaultValue!=null?Vu(i,!!s.multiple,s.defaultValue,!0):Vu(i,!!s.multiple,s.multiple?[]:"",!1))}i[id]=s}catch(m){un(e,e.return,m)}}break;case 6:if(la(t,e),Fa(e),n&4){if(e.stateNode===null)throw Error(pt(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(m){un(e,e.return,m)}}break;case 3:if(la(t,e),Fa(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Zh(t.containerInfo)}catch(m){un(e,e.return,m)}break;case 4:la(t,e),Fa(e);break;case 13:la(t,e),Fa(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(I2=bn())),n&4&&Ob(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(Ai=(c=Ai)||f,la(t,e),Ai=c):la(t,e),Fa(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!f&&e.mode&1)for(Tt=e,f=e.child;f!==null;){for(h=Tt=f;Tt!==null;){switch(d=Tt,u=d.child,d.tag){case 0:case 11:case 14:case 15:jh(4,d,d.return);break;case 1:zu(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){n=d,r=d.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){un(n,r,m)}}break;case 5:zu(d,d.return);break;case 22:if(d.memoizedState!==null){Pb(h);continue}}u!==null?(u.return=d,Tt=u):Pb(h)}f=f.sibling}e:for(f=null,h=e;;){if(h.tag===5){if(f===null){f=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,a=h.memoizedProps.style,l=a!=null&&a.hasOwnProperty("display")?a.display:null,o.style.display=dS("display",l))}catch(m){un(e,e.return,m)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){un(e,e.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:la(t,e),Fa(e),n&4&&Ob(e);break;case 21:break;default:la(t,e),Fa(e)}}function Fa(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(B4(r)){var n=r;break e}r=r.return}throw Error(pt(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Yh(i,""),n.flags&=-33);var s=Ab(e);rv(e,s,i);break;case 3:case 4:var l=n.stateNode.containerInfo,o=Ab(e);tv(e,o,l);break;default:throw Error(pt(161))}}catch(a){un(e,e.return,a)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function D6(e,t,r){Tt=e,W4(e)}function W4(e,t,r){for(var n=(e.mode&1)!==0;Tt!==null;){var i=Tt,s=i.child;if(i.tag===22&&n){var l=i.memoizedState!==null||V0;if(!l){var o=i.alternate,a=o!==null&&o.memoizedState!==null||Ai;o=V0;var c=Ai;if(V0=l,(Ai=a)&&!c)for(Tt=i;Tt!==null;)l=Tt,a=l.child,l.tag===22&&l.memoizedState!==null?Fb(i):a!==null?(a.return=l,Tt=a):Fb(i);for(;s!==null;)Tt=s,W4(s),s=s.sibling;Tt=i,V0=o,Ai=c}jb(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Tt=s):jb(e)}}function jb(e){for(;Tt!==null;){var t=Tt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ai||Vg(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ai)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:ha(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&gb(t,s,n);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}gb(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var a=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&r.focus();break;case"img":a.src&&(r.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&Zh(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pt(163))}Ai||t.flags&512&&ev(t)}catch(d){un(t,t.return,d)}}if(t===e){Tt=null;break}if(r=t.sibling,r!==null){r.return=t.return,Tt=r;break}Tt=t.return}}function Pb(e){for(;Tt!==null;){var t=Tt;if(t===e){Tt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Tt=r;break}Tt=t.return}}function Fb(e){for(;Tt!==null;){var t=Tt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Vg(4,t)}catch(a){un(t,r,a)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(a){un(t,i,a)}}var s=t.return;try{ev(t)}catch(a){un(t,s,a)}break;case 5:var l=t.return;try{ev(t)}catch(a){un(t,l,a)}}}catch(a){un(t,t.return,a)}if(t===e){Tt=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Tt=o;break}Tt=t.return}}var L6=Math.ceil,og=Bo.ReactCurrentDispatcher,D2=Bo.ReactCurrentOwner,Xs=Bo.ReactCurrentBatchConfig,pr=0,ni=null,Rn=null,mi=0,xs=0,Wu=zl(0),Yn=0,ud=null,Pc=0,Gg=0,L2=0,Ph=null,Zi=null,I2=0,mf=1/0,wo=null,lg=!1,nv=null,Tl=null,G0=!1,vl=null,cg=0,Fh=0,iv=null,Pp=-1,Fp=0;function $i(){return pr&6?bn():Pp!==-1?Pp:Pp=bn()}function Nl(e){return e.mode&1?pr&2&&mi!==0?mi&-mi:v6.transition!==null?(Fp===0&&(Fp=ES()),Fp):(e=Nr,e!==0||(e=window.event,e=e===void 0?16:FS(e.type)),e):1}function ya(e,t,r,n){if(50<Fh)throw Fh=0,iv=null,Error(pt(185));Ud(e,r,n),(!(pr&2)||e!==ni)&&(e===ni&&(!(pr&2)&&(Gg|=r),Yn===4&&gl(e,mi)),ns(e,n),r===1&&pr===0&&!(t.mode&1)&&(mf=bn()+500,Hg&&Wl()))}function ns(e,t){var r=e.callbackNode;vA(e,t);var n=Vp(e,e===ni?mi:0);if(n===0)r!==null&&Ww(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Ww(r),t===1)e.tag===0?x6(Db.bind(null,e)):QS(Db.bind(null,e)),d6(function(){!(pr&6)&&Wl()}),r=null;else{switch(TS(n)){case 1:r=l2;break;case 4:r=SS;break;case 16:r=qp;break;case 536870912:r=CS;break;default:r=qp}r=K4(r,H4.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function H4(e,t){if(Pp=-1,Fp=0,pr&6)throw Error(pt(327));var r=e.callbackNode;if(Ju()&&e.callbackNode!==r)return null;var n=Vp(e,e===ni?mi:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=ug(e,n);else{t=n;var i=pr;pr|=2;var s=q4();(ni!==e||mi!==t)&&(wo=null,mf=bn()+500,_c(e,t));do try{R6();break}catch(o){$4(e,o)}while(!0);b2(),og.current=s,pr=i,Rn!==null?t=0:(ni=null,mi=0,t=Yn)}if(t!==0){if(t===2&&(i=jx(e),i!==0&&(n=i,t=sv(e,i))),t===1)throw r=ud,_c(e,0),gl(e,n),ns(e,bn()),r;if(t===6)gl(e,n);else{if(i=e.current.alternate,!(n&30)&&!I6(i)&&(t=ug(e,n),t===2&&(s=jx(e),s!==0&&(n=s,t=sv(e,s))),t===1))throw r=ud,_c(e,0),gl(e,n),ns(e,bn()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(pt(345));case 2:cc(e,Zi,wo);break;case 3:if(gl(e,n),(n&130023424)===n&&(t=I2+500-bn(),10<t)){if(Vp(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){$i(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Bx(cc.bind(null,e,Zi,wo),t);break}cc(e,Zi,wo);break;case 4:if(gl(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var l=31-va(n);s=1<<l,l=t[l],l>i&&(i=l),n&=~s}if(n=i,n=bn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*L6(n/1960))-n,10<n){e.timeoutHandle=Bx(cc.bind(null,e,Zi,wo),n);break}cc(e,Zi,wo);break;case 5:cc(e,Zi,wo);break;default:throw Error(pt(329))}}}return ns(e,bn()),e.callbackNode===r?H4.bind(null,e):null}function sv(e,t){var r=Ph;return e.current.memoizedState.isDehydrated&&(_c(e,t).flags|=256),e=ug(e,t),e!==2&&(t=Zi,Zi=r,t!==null&&av(t)),e}function av(e){Zi===null?Zi=e:Zi.push.apply(Zi,e)}function I6(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!_a(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function gl(e,t){for(t&=~L2,t&=~Gg,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-va(t),n=1<<r;e[r]=-1,t&=~n}}function Db(e){if(pr&6)throw Error(pt(327));Ju();var t=Vp(e,0);if(!(t&1))return ns(e,bn()),null;var r=ug(e,t);if(e.tag!==0&&r===2){var n=jx(e);n!==0&&(t=n,r=sv(e,n))}if(r===1)throw r=ud,_c(e,0),gl(e,t),ns(e,bn()),r;if(r===6)throw Error(pt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,cc(e,Zi,wo),ns(e,bn()),null}function M2(e,t){var r=pr;pr|=1;try{return e(t)}finally{pr=r,pr===0&&(mf=bn()+500,Hg&&Wl())}}function Fc(e){vl!==null&&vl.tag===0&&!(pr&6)&&Ju();var t=pr;pr|=1;var r=Xs.transition,n=Nr;try{if(Xs.transition=null,Nr=1,e)return e()}finally{Nr=n,Xs.transition=r,pr=t,!(pr&6)&&Wl()}}function R2(){xs=Wu.current,$r(Wu)}function _c(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,h6(r)),Rn!==null)for(r=Rn.return;r!==null;){var n=r;switch(v2(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Jp();break;case 3:pf(),$r(ts),$r(Fi),T2();break;case 5:E2(n);break;case 4:pf();break;case 13:$r(Qr);break;case 19:$r(Qr);break;case 10:_2(n.type._context);break;case 22:case 23:R2()}r=r.return}if(ni=e,Rn=e=Al(e.current,null),mi=xs=t,Yn=0,ud=null,L2=Gg=Pc=0,Zi=Ph=null,vc!==null){for(t=0;t<vc.length;t++)if(r=vc[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var l=s.next;s.next=i,n.next=l}r.pending=n}vc=null}return e}function $4(e,t){do{var r=Rn;try{if(b2(),Ap.current=ag,sg){for(var n=rn.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}sg=!1}if(jc=0,Zn=Gn=rn=null,Oh=!1,od=0,D2.current=null,r===null||r.return===null){Yn=1,ud=t,Rn=null;break}e:{var s=e,l=r.return,o=r,a=t;if(t=mi,o.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var c=a,f=o,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var u=bb(l);if(u!==null){u.flags&=-257,_b(u,l,o,s,t),u.mode&1&&wb(s,c,t),t=u,a=c;var p=t.updateQueue;if(p===null){var m=new Set;m.add(a),t.updateQueue=m}else p.add(a);break e}else{if(!(t&1)){wb(s,c,t),B2();break e}a=Error(pt(426))}}else if(Kr&&o.mode&1){var g=bb(l);if(g!==null){!(g.flags&65536)&&(g.flags|=256),_b(g,l,o,s,t),y2(gf(a,o));break e}}s=a=gf(a,o),Yn!==4&&(Yn=2),Ph===null?Ph=[s]:Ph.push(s),s=l;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var x=T4(s,a,t);pb(s,x);break e;case 1:o=a;var y=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Tl===null||!Tl.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var b=N4(s,o,t);pb(s,b);break e}}s=s.return}while(s!==null)}G4(r)}catch(S){t=S,Rn===r&&r!==null&&(Rn=r=r.return);continue}break}while(!0)}function q4(){var e=og.current;return og.current=ag,e===null?ag:e}function B2(){(Yn===0||Yn===3||Yn===2)&&(Yn=4),ni===null||!(Pc&268435455)&&!(Gg&268435455)||gl(ni,mi)}function ug(e,t){var r=pr;pr|=2;var n=q4();(ni!==e||mi!==t)&&(wo=null,_c(e,t));do try{M6();break}catch(i){$4(e,i)}while(!0);if(b2(),pr=r,og.current=n,Rn!==null)throw Error(pt(261));return ni=null,mi=0,Yn}function M6(){for(;Rn!==null;)V4(Rn)}function R6(){for(;Rn!==null&&!cA();)V4(Rn)}function V4(e){var t=Y4(e.alternate,e,xs);e.memoizedProps=e.pendingProps,t===null?G4(e):Rn=t,D2.current=null}function G4(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=j6(r,t),r!==null){r.flags&=32767,Rn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Yn=6,Rn=null;return}}else if(r=O6(r,t,xs),r!==null){Rn=r;return}if(t=t.sibling,t!==null){Rn=t;return}Rn=t=e}while(t!==null);Yn===0&&(Yn=5)}function cc(e,t,r){var n=Nr,i=Xs.transition;try{Xs.transition=null,Nr=1,B6(e,t,r,n)}finally{Xs.transition=i,Nr=n}return null}function B6(e,t,r,n){do Ju();while(vl!==null);if(pr&6)throw Error(pt(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(pt(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(yA(e,s),e===ni&&(Rn=ni=null,mi=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||G0||(G0=!0,K4(qp,function(){return Ju(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Xs.transition,Xs.transition=null;var l=Nr;Nr=1;var o=pr;pr|=4,D2.current=null,F6(e,r),z4(r,e),s6(Mx),Gp=!!Ix,Mx=Ix=null,e.current=r,D6(r),uA(),pr=o,Nr=l,Xs.transition=s}else e.current=r;if(G0&&(G0=!1,vl=e,cg=i),s=e.pendingLanes,s===0&&(Tl=null),dA(r.stateNode),ns(e,bn()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(lg)throw lg=!1,e=nv,nv=null,e;return cg&1&&e.tag!==0&&Ju(),s=e.pendingLanes,s&1?e===iv?Fh++:(Fh=0,iv=e):Fh=0,Wl(),null}function Ju(){if(vl!==null){var e=TS(cg),t=Xs.transition,r=Nr;try{if(Xs.transition=null,Nr=16>e?16:e,vl===null)var n=!1;else{if(e=vl,vl=null,cg=0,pr&6)throw Error(pt(331));var i=pr;for(pr|=4,Tt=e.current;Tt!==null;){var s=Tt,l=s.child;if(Tt.flags&16){var o=s.deletions;if(o!==null){for(var a=0;a<o.length;a++){var c=o[a];for(Tt=c;Tt!==null;){var f=Tt;switch(f.tag){case 0:case 11:case 15:jh(8,f,s)}var h=f.child;if(h!==null)h.return=f,Tt=h;else for(;Tt!==null;){f=Tt;var d=f.sibling,u=f.return;if(R4(f),f===c){Tt=null;break}if(d!==null){d.return=u,Tt=d;break}Tt=u}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}Tt=s}}if(s.subtreeFlags&2064&&l!==null)l.return=s,Tt=l;else e:for(;Tt!==null;){if(s=Tt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:jh(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,Tt=x;break e}Tt=s.return}}var y=e.current;for(Tt=y;Tt!==null;){l=Tt;var w=l.child;if(l.subtreeFlags&2064&&w!==null)w.return=l,Tt=w;else e:for(l=y;Tt!==null;){if(o=Tt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Vg(9,o)}}catch(S){un(o,o.return,S)}if(o===l){Tt=null;break e}var b=o.sibling;if(b!==null){b.return=o.return,Tt=b;break e}Tt=o.return}}if(pr=i,Wl(),Xa&&typeof Xa.onPostCommitFiberRoot=="function")try{Xa.onPostCommitFiberRoot(Rg,e)}catch{}n=!0}return n}finally{Nr=r,Xs.transition=t}}return!1}function Lb(e,t,r){t=gf(r,t),t=T4(e,t,1),e=El(e,t,1),t=$i(),e!==null&&(Ud(e,1,t),ns(e,t))}function un(e,t,r){if(e.tag===3)Lb(e,e,r);else for(;t!==null;){if(t.tag===3){Lb(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Tl===null||!Tl.has(n))){e=gf(r,e),e=N4(t,e,1),t=El(t,e,1),e=$i(),t!==null&&(Ud(t,1,e),ns(t,e));break}}t=t.return}}function U6(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=$i(),e.pingedLanes|=e.suspendedLanes&r,ni===e&&(mi&r)===r&&(Yn===4||Yn===3&&(mi&130023424)===mi&&500>bn()-I2?_c(e,0):L2|=r),ns(e,t)}function X4(e,t){t===0&&(e.mode&1?(t=M0,M0<<=1,!(M0&130023424)&&(M0=4194304)):t=1);var r=$i();e=Do(e,t),e!==null&&(Ud(e,t,r),ns(e,r))}function z6(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),X4(e,r)}function W6(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(pt(314))}n!==null&&n.delete(t),X4(e,r)}var Y4;Y4=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ts.current)es=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return es=!1,A6(e,t,r);es=!!(e.flags&131072)}else es=!1,Kr&&t.flags&1048576&&ZS(t,eg,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;jp(e,t),e=t.pendingProps;var i=ff(t,Fi.current);Ku(t,r),i=A2(null,t,n,e,i,r);var s=O2();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,rs(n)?(s=!0,Qp(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,S2(t),i.updater=qg,t.stateNode=i,i._reactInternals=t,Vx(t,n,e,r),t=Yx(null,t,n,!0,s,r)):(t.tag=0,Kr&&s&&x2(t),zi(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(jp(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=$6(n),e=ha(n,e),i){case 0:t=Xx(null,t,n,e,r);break e;case 1:t=Cb(null,t,n,e,r);break e;case 11:t=kb(null,t,n,e,r);break e;case 14:t=Sb(null,t,n,ha(n.type,e),r);break e}throw Error(pt(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ha(n,i),Xx(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ha(n,i),Cb(e,t,n,i,r);case 3:e:{if(P4(t),e===null)throw Error(pt(387));n=t.pendingProps,s=t.memoizedState,i=s.element,s4(e,t),ng(t,n,null,r);var l=t.memoizedState;if(n=l.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=gf(Error(pt(423)),t),t=Eb(e,t,n,r,i);break e}else if(n!==i){i=gf(Error(pt(424)),t),t=Eb(e,t,n,r,i);break e}else for(_s=Cl(t.stateNode.containerInfo.firstChild),Cs=t,Kr=!0,ga=null,r=n4(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(hf(),n===i){t=Lo(e,t,r);break e}zi(e,t,n,r)}t=t.child}return t;case 5:return a4(t),e===null&&Hx(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,l=i.children,Rx(n,i)?l=null:s!==null&&Rx(n,s)&&(t.flags|=32),j4(e,t),zi(e,t,l,r),t.child;case 6:return e===null&&Hx(t),null;case 13:return F4(e,t,r);case 4:return C2(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=df(t,null,n,r):zi(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ha(n,i),kb(e,t,n,i,r);case 7:return zi(e,t,t.pendingProps,r),t.child;case 8:return zi(e,t,t.pendingProps.children,r),t.child;case 12:return zi(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,l=i.value,Rr(tg,n._currentValue),n._currentValue=l,s!==null)if(_a(s.value,l)){if(s.children===i.children&&!ts.current){t=Lo(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){l=s.child;for(var a=o.firstContext;a!==null;){if(a.context===n){if(s.tag===1){a=To(-1,r&-r),a.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?a.next=a:(a.next=f.next,f.next=a),c.pending=a}}s.lanes|=r,a=s.alternate,a!==null&&(a.lanes|=r),$x(s.return,r,t),o.lanes|=r;break}a=a.next}}else if(s.tag===10)l=s.type===t.type?null:s.child;else if(s.tag===18){if(l=s.return,l===null)throw Error(pt(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),$x(l,r,t),l=s.sibling}else l=s.child;if(l!==null)l.return=s;else for(l=s;l!==null;){if(l===t){l=null;break}if(s=l.sibling,s!==null){s.return=l.return,l=s;break}l=l.return}s=l}zi(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Ku(t,r),i=Ks(i),n=n(i),t.flags|=1,zi(e,t,n,r),t.child;case 14:return n=t.type,i=ha(n,t.pendingProps),i=ha(n.type,i),Sb(e,t,n,i,r);case 15:return A4(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ha(n,i),jp(e,t),t.tag=1,rs(n)?(e=!0,Qp(t)):e=!1,Ku(t,r),E4(t,n,i),Vx(t,n,i,r),Yx(null,t,n,!0,e,r);case 19:return D4(e,t,r);case 22:return O4(e,t,r)}throw Error(pt(156,t.tag))};function K4(e,t){return kS(e,t)}function H6(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gs(e,t,r,n){return new H6(e,t,r,n)}function U2(e){return e=e.prototype,!(!e||!e.isReactComponent)}function $6(e){if(typeof e=="function")return U2(e)?1:0;if(e!=null){if(e=e.$$typeof,e===s2)return 11;if(e===a2)return 14}return 2}function Al(e,t){var r=e.alternate;return r===null?(r=Gs(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Dp(e,t,r,n,i,s){var l=2;if(n=e,typeof e=="function")U2(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case Pu:return kc(r.children,i,s,t);case i2:l=8,i|=8;break;case mx:return e=Gs(12,r,t,i|2),e.elementType=mx,e.lanes=s,e;case xx:return e=Gs(13,r,t,i),e.elementType=xx,e.lanes=s,e;case vx:return e=Gs(19,r,t,i),e.elementType=vx,e.lanes=s,e;case aS:return Xg(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case iS:l=10;break e;case sS:l=9;break e;case s2:l=11;break e;case a2:l=14;break e;case fl:l=16,n=null;break e}throw Error(pt(130,e==null?e:typeof e,""))}return t=Gs(l,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function kc(e,t,r,n){return e=Gs(7,e,n,t),e.lanes=r,e}function Xg(e,t,r,n){return e=Gs(22,e,n,t),e.elementType=aS,e.lanes=r,e.stateNode={isHidden:!1},e}function v1(e,t,r){return e=Gs(6,e,null,t),e.lanes=r,e}function y1(e,t,r){return t=Gs(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function q6(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zm(0),this.expirationTimes=Zm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zm(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function z2(e,t,r,n,i,s,l,o,a){return e=new q6(e,t,r,o,a),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Gs(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},S2(s),e}function V6(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ju,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function J4(e){if(!e)return Pl;e=e._reactInternals;e:{if($c(e)!==e||e.tag!==1)throw Error(pt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(rs(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(pt(171))}if(e.tag===1){var r=e.type;if(rs(r))return JS(e,r,t)}return t}function Q4(e,t,r,n,i,s,l,o,a){return e=z2(r,n,!0,e,i,s,l,o,a),e.context=J4(null),r=e.current,n=$i(),i=Nl(r),s=To(n,i),s.callback=t??null,El(r,s,i),e.current.lanes=i,Ud(e,i,n),ns(e,n),e}function Yg(e,t,r,n){var i=t.current,s=$i(),l=Nl(i);return r=J4(r),t.context===null?t.context=r:t.pendingContext=r,t=To(s,l),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=El(i,t,l),e!==null&&(ya(e,i,l,s),Np(e,i,l)),l}function fg(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Ib(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function W2(e,t){Ib(e,t),(e=e.alternate)&&Ib(e,t)}function G6(){return null}var Z4=typeof reportError=="function"?reportError:function(e){console.error(e)};function H2(e){this._internalRoot=e}Kg.prototype.render=H2.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(pt(409));Yg(e,t,null,null)};Kg.prototype.unmount=H2.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Fc(function(){Yg(null,e,null,null)}),t[Fo]=null}};function Kg(e){this._internalRoot=e}Kg.prototype.unstable_scheduleHydration=function(e){if(e){var t=OS();e={blockedOn:null,target:e,priority:t};for(var r=0;r<pl.length&&t!==0&&t<pl[r].priority;r++);pl.splice(r,0,e),r===0&&PS(e)}};function $2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Jg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Mb(){}function X6(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=fg(l);s.call(c)}}var l=Q4(t,n,e,0,null,!1,!1,"",Mb);return e._reactRootContainer=l,e[Fo]=l.current,rd(e.nodeType===8?e.parentNode:e),Fc(),l}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=fg(a);o.call(c)}}var a=z2(e,0,!1,null,null,!1,!1,"",Mb);return e._reactRootContainer=a,e[Fo]=a.current,rd(e.nodeType===8?e.parentNode:e),Fc(function(){Yg(t,a,r,n)}),a}function Qg(e,t,r,n,i){var s=r._reactRootContainer;if(s){var l=s;if(typeof i=="function"){var o=i;i=function(){var a=fg(l);o.call(a)}}Yg(t,l,e,i)}else l=X6(r,t,e,i,n);return fg(l)}NS=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=yh(t.pendingLanes);r!==0&&(c2(t,r|1),ns(t,bn()),!(pr&6)&&(mf=bn()+500,Wl()))}break;case 13:Fc(function(){var n=Do(e,1);if(n!==null){var i=$i();ya(n,e,1,i)}}),W2(e,1)}};u2=function(e){if(e.tag===13){var t=Do(e,134217728);if(t!==null){var r=$i();ya(t,e,134217728,r)}W2(e,134217728)}};AS=function(e){if(e.tag===13){var t=Nl(e),r=Do(e,t);if(r!==null){var n=$i();ya(r,e,t,n)}W2(e,t)}};OS=function(){return Nr};jS=function(e,t){var r=Nr;try{return Nr=e,t()}finally{Nr=r}};Nx=function(e,t,r){switch(t){case"input":if(bx(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Wg(n);if(!i)throw Error(pt(90));lS(n),bx(n,i)}}}break;case"textarea":uS(e,r);break;case"select":t=r.value,t!=null&&Vu(e,!!r.multiple,t,!1)}};xS=M2;vS=Fc;var Y6={usingClientEntryPoint:!1,Events:[Wd,Iu,Wg,gS,mS,M2]},fh={findFiberByHostInstance:xc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},K6={bundleType:fh.bundleType,version:fh.version,rendererPackageName:fh.rendererPackageName,rendererConfig:fh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Bo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=bS(e),e===null?null:e.stateNode},findFiberByHostInstance:fh.findFiberByHostInstance||G6,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var X0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!X0.isDisabled&&X0.supportsFiber)try{Rg=X0.inject(K6),Xa=X0}catch{}}js.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y6;js.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$2(t))throw Error(pt(200));return V6(e,t,null,r)};js.createRoot=function(e,t){if(!$2(e))throw Error(pt(299));var r=!1,n="",i=Z4;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=z2(e,1,!1,null,null,r,!1,n,i),e[Fo]=t.current,rd(e.nodeType===8?e.parentNode:e),new H2(t)};js.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(pt(188)):(e=Object.keys(e).join(","),Error(pt(268,e)));return e=bS(t),e=e===null?null:e.stateNode,e};js.flushSync=function(e){return Fc(e)};js.hydrate=function(e,t,r){if(!Jg(t))throw Error(pt(200));return Qg(null,e,t,!0,r)};js.hydrateRoot=function(e,t,r){if(!$2(e))throw Error(pt(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",l=Z4;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=Q4(t,null,e,1,r??null,i,!1,s,l),e[Fo]=t.current,rd(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Kg(t)};js.render=function(e,t,r){if(!Jg(t))throw Error(pt(200));return Qg(null,e,t,!1,r)};js.unmountComponentAtNode=function(e){if(!Jg(e))throw Error(pt(40));return e._reactRootContainer?(Fc(function(){Qg(null,null,e,!1,function(){e._reactRootContainer=null,e[Fo]=null})}),!0):!1};js.unstable_batchedUpdates=M2;js.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Jg(r))throw Error(pt(200));if(e==null||e._reactInternals===void 0)throw Error(pt(38));return Qg(e,t,r,!1,n)};js.version="18.3.1-next-f1338f8080-20240426";function e3(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e3)}catch(e){console.error(e)}}e3(),eS.exports=js;var hg=eS.exports,Rb=hg;px.createRoot=Rb.createRoot,px.hydrateRoot=Rb.hydrateRoot;/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J6=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q6=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bb=e=>{const t=Q6(e);return t.charAt(0).toUpperCase()+t.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Z6={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e8=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t8=xe.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:l,...o},a)=>xe.createElement("svg",{ref:a,...Z6,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:t3("lucide",i),...!s&&!e8(o)&&{"aria-hidden":"true"},...o},[...l.map(([c,f])=>xe.createElement(c,f)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=(e,t)=>{const r=xe.forwardRef(({className:n,...i},s)=>xe.createElement(t8,{ref:s,iconNode:t,className:t3(`lucide-${J6(Bb(e))}`,`lucide-${e}`,n),...i}));return r.displayName=Bb(e),r};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r8=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],n8=It("arrow-right",r8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i8=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],w1=It("award",i8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s8=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],q2=It("book-open",s8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a8=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],V2=It("box",a8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o8=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],l8=It("briefcase",o8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c8=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Io=It("calendar",c8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u8=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Ub=It("chart-column",u8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f8=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Es=It("check",f8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h8=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ov=It("chevron-down",h8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d8=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Mo=It("chevron-left",d8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p8=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Ts=It("chevron-right",p8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g8=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],lv=It("chevron-up",g8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ns=It("circle-alert",m8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Ka=It("circle-check",x8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],y8=It("circle-plus",v8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w8=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],b8=It("clipboard-check",w8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _8=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Qa=It("clock",_8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k8=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],r3=It("download",k8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S8=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],zb=It("eraser",S8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C8=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],E8=It("file-down",C8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T8=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],N8=It("file-text",T8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A8=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],O8=It("graduation-cap",A8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],P8=It("grid-3x3",j8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F8=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],D8=It("hash",F8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L8=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],n3=It("house",L8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],dg=It("info",I8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M8=[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]],R8=It("layout-template",M8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B8=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],b1=It("loader-circle",B8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U8=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],fd=It("log-out",U8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z8=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],xf=It("map-pin",z8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W8=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],cv=It("map",W8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H8=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],$8=It("navigation",H8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q8=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],V8=It("palette",q8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],hd=It("panels-top-left",G8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X8=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],G2=It("pen-tool",X8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y8=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],K8=It("pen",Y8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J8=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],uv=It("phone",J8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q8=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],dd=It("plus",Q8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z8=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Fl=It("printer",Z8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eO=[["path",{d:"M20.34 17.52a10 10 0 1 0-2.82 2.82",key:"fydyku"}],["circle",{cx:"19",cy:"19",r:"2",key:"17f5cg"}],["path",{d:"m13.41 13.41 4.18 4.18",key:"1gqbwc"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],tO=It("radius",eO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rO=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],nO=It("refresh-cw",rO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iO=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],sO=It("rotate-ccw",iO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aO=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],oO=It("rotate-cw",aO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lO=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],vf=It("save",lO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cO=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],uO=It("school",cO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fO=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],fv=It("search",fO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hO=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],dO=It("settings-2",hO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pO=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],pg=It("settings",pO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gO=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],pd=It("shield-check",gO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mO=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],xO=It("square-pen",mO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vO=[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],yO=It("toggle-left",vO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wO=[["circle",{cx:"15",cy:"12",r:"3",key:"1afu0r"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],bO=It("toggle-right",wO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _O=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Dl=It("trash-2",_O);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kO=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],SO=It("triangle-alert",kO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CO=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],EO=It("upload",CO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TO=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],gd=It("user",TO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NO=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],$d=It("users",NO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AO=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ja=It("x",AO);var Ht={};const OO={},jO=Object.freeze(Object.defineProperty({__proto__:null,default:OO},Symbol.toStringTag,{value:"Module"})),_1=CN(jO);(function(e){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var t=t||{version:"5.5.2"};if(e.fabric=t,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?t.document=document:t.document=document.implementation.createHTMLDocument(""),t.window=window;else{var r=_1,n=new r.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;t.document=n.document,t.jsdomImplForWrapper=_1.implForWrapper,t.nodeCanvas=_1.Canvas,t.window=n,DOMParser=t.window.DOMParser}t.isTouchSupported="ontouchstart"in t.window||"ontouchstart"in t.document||t.window&&t.window.navigator&&t.window.navigator.maxTouchPoints>0,t.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",t.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],t.DPI=96,t.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",t.commaWsp="(?:\\s+,?\\s*|,\\s*)",t.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,t.reNonWord=/[ \n\.,;!\?\-]/,t.fontPaths={},t.iMatrix=[1,0,0,1,0,0],t.svgNS="http://www.w3.org/2000/svg",t.perfLimitSizeTotal=2097152,t.maxCacheSideLimit=4096,t.minCacheSideLimit=256,t.charWidthsCache={},t.textureSize=2048,t.disableStyleCopyPaste=!1,t.enableGLFiltering=!0,t.devicePixelRatio=t.window.devicePixelRatio||t.window.webkitDevicePixelRatio||t.window.mozDevicePixelRatio||1,t.browserShadowBlurConstant=1,t.arcToSegmentsCache={},t.boundsOfCurveCache={},t.cachesBoundsOfCurve=!0,t.forceGLPutImageData=!1,t.initFilterBackend=function(){if(t.enableGLFiltering&&t.isWebglSupported&&t.isWebglSupported(t.textureSize))return console.log("max texture size: "+t.maxTextureSize),new t.WebglFilterBackend({tileSize:t.textureSize});if(t.Canvas2dFilterBackend)return new t.Canvas2dFilterBackend},typeof document<"u"&&typeof window<"u"&&(window.fabric=t),function(){function o(u,p){if(this.__eventListeners[u]){var m=this.__eventListeners[u];p?m[m.indexOf(p)]=!1:t.util.array.fill(m,!1)}}function a(u,p){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var m in u)this.on(m,u[m]);else this.__eventListeners[u]||(this.__eventListeners[u]=[]),this.__eventListeners[u].push(p);return this}function c(u,p){var m=(function(){p.apply(this,arguments),this.off(u,m)}).bind(this);this.on(u,m)}function f(u,p){if(arguments.length===1)for(var m in u)c.call(this,m,u[m]);else c.call(this,u,p);return this}function h(u,p){if(!this.__eventListeners)return this;if(arguments.length===0)for(u in this.__eventListeners)o.call(this,u);else if(arguments.length===1&&typeof arguments[0]=="object")for(var m in u)o.call(this,m,u[m]);else o.call(this,u,p);return this}function d(u,p){if(!this.__eventListeners)return this;var m=this.__eventListeners[u];if(!m)return this;for(var g=0,x=m.length;g<x;g++)m[g]&&m[g].call(this,p||{});return this.__eventListeners[u]=m.filter(function(y){return y!==!1}),this}t.Observable={fire:d,on:a,once:f,off:h}}(),t.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var o=0,a=arguments.length;o<a;o++)this._onObjectAdded(arguments[o]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(o,a,c){var f=this._objects;return c?f[a]=o:f.splice(a,0,o),this._onObjectAdded&&this._onObjectAdded(o),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var o=this._objects,a,c=!1,f=0,h=arguments.length;f<h;f++)a=o.indexOf(arguments[f]),a!==-1&&(c=!0,o.splice(a,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[f]));return this.renderOnAddRemove&&c&&this.requestRenderAll(),this},forEachObject:function(o,a){for(var c=this.getObjects(),f=0,h=c.length;f<h;f++)o.call(a,c[f],f,c);return this},getObjects:function(o){return typeof o>"u"?this._objects.concat():this._objects.filter(function(a){return a.type===o})},item:function(o){return this._objects[o]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(o,a){return this._objects.indexOf(o)>-1?!0:a?this._objects.some(function(c){return typeof c.contains=="function"&&c.contains(o,!0)}):!1},complexity:function(){return this._objects.reduce(function(o,a){return o+=a.complexity?a.complexity():0,o},0)}},t.CommonMethods={_setOptions:function(o){for(var a in o)this.set(a,o[a])},_initGradient:function(o,a){o&&o.colorStops&&!(o instanceof t.Gradient)&&this.set(a,new t.Gradient(o))},_initPattern:function(o,a,c){o&&o.source&&!(o instanceof t.Pattern)?this.set(a,new t.Pattern(o,c)):c&&c()},_setObject:function(o){for(var a in o)this._set(a,o[a])},set:function(o,a){return typeof o=="object"?this._setObject(o):this._set(o,a),this},_set:function(o,a){this[o]=a},toggle:function(o){var a=this.get(o);return typeof a=="boolean"&&this.set(o,!a),this},get:function(o){return this[o]}},function(o){var a=Math.sqrt,c=Math.atan2,f=Math.pow,h=Math.PI/180,d=Math.PI/2;t.util={cos:function(u){if(u===0)return 1;u<0&&(u=-u);var p=u/d;switch(p){case 1:case 3:return 0;case 2:return-1}return Math.cos(u)},sin:function(u){if(u===0)return 0;var p=u/d,m=1;switch(u<0&&(m=-1),p){case 1:return m;case 2:return 0;case 3:return-m}return Math.sin(u)},removeFromArray:function(u,p){var m=u.indexOf(p);return m!==-1&&u.splice(m,1),u},getRandomInt:function(u,p){return Math.floor(Math.random()*(p-u+1))+u},degreesToRadians:function(u){return u*h},radiansToDegrees:function(u){return u/h},rotatePoint:function(u,p,m){var g=new t.Point(u.x-p.x,u.y-p.y),x=t.util.rotateVector(g,m);return new t.Point(x.x,x.y).addEquals(p)},rotateVector:function(u,p){var m=t.util.sin(p),g=t.util.cos(p),x=u.x*g-u.y*m,y=u.x*m+u.y*g;return{x,y}},createVector:function(u,p){return new t.Point(p.x-u.x,p.y-u.y)},calcAngleBetweenVectors:function(u,p){return Math.acos((u.x*p.x+u.y*p.y)/(Math.hypot(u.x,u.y)*Math.hypot(p.x,p.y)))},getHatVector:function(u){return new t.Point(u.x,u.y).multiply(1/Math.hypot(u.x,u.y))},getBisector:function(u,p,m){var g=t.util.createVector(u,p),x=t.util.createVector(u,m),y=t.util.calcAngleBetweenVectors(g,x),w=t.util.calcAngleBetweenVectors(t.util.rotateVector(g,y),x),b=y*(w===0?1:-1)/2;return{vector:t.util.getHatVector(t.util.rotateVector(g,b)),angle:y}},projectStrokeOnPoints:function(u,p,m){var g=[],x=p.strokeWidth/2,y=p.strokeUniform?new t.Point(1/p.scaleX,1/p.scaleY):new t.Point(1,1),w=function(b){var S=x/Math.hypot(b.x,b.y);return new t.Point(b.x*S*y.x,b.y*S*y.y)};return u.length<=1||u.forEach(function(b,S){var T=new t.Point(b.x,b.y),O,j;S===0?(j=u[S+1],O=m?w(t.util.createVector(j,T)).addEquals(T):u[u.length-1]):S===u.length-1?(O=u[S-1],j=m?w(t.util.createVector(O,T)).addEquals(T):u[0]):(O=u[S-1],j=u[S+1]);var L=t.util.getBisector(T,O,j),W=L.vector,F=L.angle,M,V;if(p.strokeLineJoin==="miter"&&(M=-x/Math.sin(F/2),V=new t.Point(W.x*M*y.x,W.y*M*y.y),Math.hypot(V.x,V.y)/x<=p.strokeMiterLimit)){g.push(T.add(V)),g.push(T.subtract(V));return}M=-x*Math.SQRT2,V=new t.Point(W.x*M*y.x,W.y*M*y.y),g.push(T.add(V)),g.push(T.subtract(V))}),g},transformPoint:function(u,p,m){return m?new t.Point(p[0]*u.x+p[2]*u.y,p[1]*u.x+p[3]*u.y):new t.Point(p[0]*u.x+p[2]*u.y+p[4],p[1]*u.x+p[3]*u.y+p[5])},makeBoundingBoxFromPoints:function(u,p){if(p)for(var m=0;m<u.length;m++)u[m]=t.util.transformPoint(u[m],p);var g=[u[0].x,u[1].x,u[2].x,u[3].x],x=t.util.array.min(g),y=t.util.array.max(g),w=y-x,b=[u[0].y,u[1].y,u[2].y,u[3].y],S=t.util.array.min(b),T=t.util.array.max(b),O=T-S;return{left:x,top:S,width:w,height:O}},invertTransform:function(u){var p=1/(u[0]*u[3]-u[1]*u[2]),m=[p*u[3],-p*u[1],-p*u[2],p*u[0]],g=t.util.transformPoint({x:u[4],y:u[5]},m,!0);return m[4]=-g.x,m[5]=-g.y,m},toFixed:function(u,p){return parseFloat(Number(u).toFixed(p))},parseUnit:function(u,p){var m=/\D{0,2}$/.exec(u),g=parseFloat(u);switch(p||(p=t.Text.DEFAULT_SVG_FONT_SIZE),m[0]){case"mm":return g*t.DPI/25.4;case"cm":return g*t.DPI/2.54;case"in":return g*t.DPI;case"pt":return g*t.DPI/72;case"pc":return g*t.DPI/72*12;case"em":return g*p;default:return g}},falseFunction:function(){return!1},getKlass:function(u,p){return u=t.util.string.camelize(u.charAt(0).toUpperCase()+u.slice(1)),t.util.resolveNamespace(p)[u]},getSvgAttributes:function(u){var p=["instantiated_by_use","style","id","class"];switch(u){case"linearGradient":p=p.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":p=p.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":p=p.concat(["offset","stop-color","stop-opacity"]);break}return p},resolveNamespace:function(u){if(!u)return t;var p=u.split("."),m=p.length,g,x=o||t.window;for(g=0;g<m;++g)x=x[p[g]];return x},loadImage:function(u,p,m,g){if(!u){p&&p.call(m,u);return}var x=t.util.createImage(),y=function(){p&&p.call(m,x,!1),x=x.onload=x.onerror=null};x.onload=y,x.onerror=function(){t.log("Error loading "+x.src),p&&p.call(m,null,!0),x=x.onload=x.onerror=null},u.indexOf("data")!==0&&g!==void 0&&g!==null&&(x.crossOrigin=g),u.substring(0,14)==="data:image/svg"&&(x.onload=null,t.util.loadImageInDom(x,y)),x.src=u},loadImageInDom:function(u,p){var m=t.document.createElement("div");m.style.width=m.style.height="1px",m.style.left=m.style.top="-100%",m.style.position="absolute",m.appendChild(u),t.document.querySelector("body").appendChild(m),u.onload=function(){p(),m.parentNode.removeChild(m),m=null}},enlivenObjects:function(u,p,m,g){u=u||[];var x=[],y=0,w=u.length;function b(){++y===w&&p&&p(x.filter(function(S){return S}))}if(!w){p&&p(x);return}u.forEach(function(S,T){if(!S||!S.type){b();return}var O=t.util.getKlass(S.type,m);O.fromObject(S,function(j,L){L||(x[T]=j),g&&g(S,j,L),b()})})},enlivenObjectEnlivables:function(u,p,m){var g=t.Object.ENLIVEN_PROPS.filter(function(x){return!!u[x]});t.util.enlivenObjects(g.map(function(x){return u[x]}),function(x){var y={};g.forEach(function(w,b){y[w]=x[b],p&&(p[w]=x[b])}),m&&m(y)})},enlivenPatterns:function(u,p){u=u||[];function m(){++x===y&&p&&p(g)}var g=[],x=0,y=u.length;if(!y){p&&p(g);return}u.forEach(function(w,b){w&&w.source?new t.Pattern(w,function(S){g[b]=S,m()}):(g[b]=w,m())})},groupSVGElements:function(u,p,m){var g;return u&&u.length===1?(typeof m<"u"&&(u[0].sourcePath=m),u[0]):(p&&(p.width&&p.height?p.centerPoint={x:p.width/2,y:p.height/2}:(delete p.width,delete p.height)),g=new t.Group(u,p),typeof m<"u"&&(g.sourcePath=m),g)},populateWithProperties:function(u,p,m){if(m&&Array.isArray(m))for(var g=0,x=m.length;g<x;g++)m[g]in u&&(p[m[g]]=u[m[g]])},createCanvasElement:function(){return t.document.createElement("canvas")},copyCanvasElement:function(u){var p=t.util.createCanvasElement();return p.width=u.width,p.height=u.height,p.getContext("2d").drawImage(u,0,0),p},toDataURL:function(u,p,m){return u.toDataURL("image/"+p,m)},createImage:function(){return t.document.createElement("img")},multiplyTransformMatrices:function(u,p,m){return[u[0]*p[0]+u[2]*p[1],u[1]*p[0]+u[3]*p[1],u[0]*p[2]+u[2]*p[3],u[1]*p[2]+u[3]*p[3],m?0:u[0]*p[4]+u[2]*p[5]+u[4],m?0:u[1]*p[4]+u[3]*p[5]+u[5]]},qrDecompose:function(u){var p=c(u[1],u[0]),m=f(u[0],2)+f(u[1],2),g=a(m),x=(u[0]*u[3]-u[2]*u[1])/g,y=c(u[0]*u[2]+u[1]*u[3],m);return{angle:p/h,scaleX:g,scaleY:x,skewX:y/h,skewY:0,translateX:u[4],translateY:u[5]}},calcRotateMatrix:function(u){if(!u.angle)return t.iMatrix.concat();var p=t.util.degreesToRadians(u.angle),m=t.util.cos(p),g=t.util.sin(p);return[m,g,-g,m,0,0]},calcDimensionsMatrix:function(u){var p=typeof u.scaleX>"u"?1:u.scaleX,m=typeof u.scaleY>"u"?1:u.scaleY,g=[u.flipX?-p:p,0,0,u.flipY?-m:m,0,0],x=t.util.multiplyTransformMatrices,y=t.util.degreesToRadians;return u.skewX&&(g=x(g,[1,0,Math.tan(y(u.skewX)),1],!0)),u.skewY&&(g=x(g,[1,Math.tan(y(u.skewY)),0,1],!0)),g},composeMatrix:function(u){var p=[1,0,0,1,u.translateX||0,u.translateY||0],m=t.util.multiplyTransformMatrices;return u.angle&&(p=m(p,t.util.calcRotateMatrix(u))),(u.scaleX!==1||u.scaleY!==1||u.skewX||u.skewY||u.flipX||u.flipY)&&(p=m(p,t.util.calcDimensionsMatrix(u))),p},resetObjectTransform:function(u){u.scaleX=1,u.scaleY=1,u.skewX=0,u.skewY=0,u.flipX=!1,u.flipY=!1,u.rotate(0)},saveObjectTransform:function(u){return{scaleX:u.scaleX,scaleY:u.scaleY,skewX:u.skewX,skewY:u.skewY,angle:u.angle,left:u.left,flipX:u.flipX,flipY:u.flipY,top:u.top}},isTransparent:function(u,p,m,g){g>0&&(p>g?p-=g:p=0,m>g?m-=g:m=0);var x=!0,y,w,b=u.getImageData(p,m,g*2||1,g*2||1),S=b.data.length;for(y=3;y<S&&(w=b.data[y],x=w<=0,x!==!1);y+=4);return b=null,x},parsePreserveAspectRatioAttribute:function(u){var p="meet",m="Mid",g="Mid",x=u.split(" "),y;return x&&x.length&&(p=x.pop(),p!=="meet"&&p!=="slice"?(y=p,p="meet"):x.length&&(y=x.pop())),m=y!=="none"?y.slice(1,4):"none",g=y!=="none"?y.slice(5,8):"none",{meetOrSlice:p,alignX:m,alignY:g}},clearFabricFontCache:function(u){u=(u||"").toLowerCase(),u?t.charWidthsCache[u]&&delete t.charWidthsCache[u]:t.charWidthsCache={}},limitDimsByArea:function(u,p){var m=Math.sqrt(p*u),g=Math.floor(p/m);return{x:Math.floor(m),y:g}},capValue:function(u,p,m){return Math.max(u,Math.min(p,m))},findScaleToFit:function(u,p){return Math.min(p.width/u.width,p.height/u.height)},findScaleToCover:function(u,p){return Math.max(p.width/u.width,p.height/u.height)},matrixToSVG:function(u){return"matrix("+u.map(function(p){return t.util.toFixed(p,t.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(u,p){var m=t.util.invertTransform(p),g=t.util.multiplyTransformMatrices(m,u.calcOwnMatrix());t.util.applyTransformToObject(u,g)},addTransformToObject:function(u,p){t.util.applyTransformToObject(u,t.util.multiplyTransformMatrices(p,u.calcOwnMatrix()))},applyTransformToObject:function(u,p){var m=t.util.qrDecompose(p),g=new t.Point(m.translateX,m.translateY);u.flipX=!1,u.flipY=!1,u.set("scaleX",m.scaleX),u.set("scaleY",m.scaleY),u.skewX=m.skewX,u.skewY=m.skewY,u.angle=m.angle,u.setPositionByOrigin(g,"center","center")},sizeAfterTransform:function(u,p,m){var g=u/2,x=p/2,y=[{x:-g,y:-x},{x:g,y:-x},{x:-g,y:x},{x:g,y:x}],w=t.util.calcDimensionsMatrix(m),b=t.util.makeBoundingBoxFromPoints(y,w);return{x:b.width,y:b.height}},mergeClipPaths:function(u,p){var m=u,g=p;m.inverted&&!g.inverted&&(m=p,g=u),t.util.applyTransformToObject(g,t.util.multiplyTransformMatrices(t.util.invertTransform(m.calcTransformMatrix()),g.calcTransformMatrix()));var x=m.inverted&&g.inverted;return x&&(m.inverted=g.inverted=!1),new t.Group([m],{clipPath:g,inverted:x})},hasStyleChanged:function(u,p,m){return m=m||!1,u.fill!==p.fill||u.stroke!==p.stroke||u.strokeWidth!==p.strokeWidth||u.fontSize!==p.fontSize||u.fontFamily!==p.fontFamily||u.fontWeight!==p.fontWeight||u.fontStyle!==p.fontStyle||u.textBackgroundColor!==p.textBackgroundColor||u.deltaY!==p.deltaY||m&&(u.overline!==p.overline||u.underline!==p.underline||u.linethrough!==p.linethrough)},stylesToArray:function(m,p){for(var m=t.util.object.clone(m,!0),g=p.split(`
`),x=-1,y={},w=[],b=0;b<g.length;b++){if(!m[b]){x+=g[b].length;continue}for(var S=0;S<g[b].length;S++){x++;var T=m[b][S];if(T&&Object.keys(T).length>0){var O=t.util.hasStyleChanged(y,T,!0);O?w.push({start:x,end:x+1,style:T}):w[w.length-1].end++}y=T||{}}}return w},stylesFromArray:function(u,p){if(!Array.isArray(u))return u;for(var m=p.split(`
`),g=-1,x=0,y={},w=0;w<m.length;w++)for(var b=0;b<m[w].length;b++)g++,u[x]&&u[x].start<=g&&g<u[x].end&&(y[w]=y[w]||{},y[w][b]=Object.assign({},u[x].style),g===u[x].end-1&&x++);return y}}}(e),function(){var o=Array.prototype.join,a={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},c={m:"l",M:"L"};function f(N,U,R,k,P,A,E,I,H,J,Y){var Z=t.util.cos(N),fe=t.util.sin(N),X=t.util.cos(U),re=t.util.sin(U),se=R*P*X-k*A*re+E,z=k*P*X+R*A*re+I,oe=J+H*(-R*P*fe-k*A*Z),ce=Y+H*(-k*P*fe+R*A*Z),we=se+H*(R*P*re+k*A*X),ye=z+H*(k*P*re-R*A*X);return["C",oe,ce,we,ye,se,z]}function h(N,U,R,k,P,A,E){var I=Math.PI,H=E*I/180,J=t.util.sin(H),Y=t.util.cos(H),Z=0,fe=0;R=Math.abs(R),k=Math.abs(k);var X=-Y*N*.5-J*U*.5,re=-Y*U*.5+J*N*.5,se=R*R,z=k*k,oe=re*re,ce=X*X,we=se*z-se*oe-z*ce,ye=0;if(we<0){var de=Math.sqrt(1-we/(se*z));R*=de,k*=de}else ye=(P===A?-1:1)*Math.sqrt(we/(se*oe+z*ce));var Te=ye*R*re/k,pe=-ye*k*X/R,Ae=Y*Te-J*pe+N*.5,Ie=J*Te+Y*pe+U*.5,je=d(1,0,(X-Te)/R,(re-pe)/k),Le=d((X-Te)/R,(re-pe)/k,(-X-Te)/R,(-re-pe)/k);A===0&&Le>0?Le-=2*I:A===1&&Le<0&&(Le+=2*I);for(var Xe=Math.ceil(Math.abs(Le/I*2)),Je=[],Ne=Le/Xe,Oe=8/3*Math.sin(Ne/4)*Math.sin(Ne/4)/Math.sin(Ne/2),De=je+Ne,Ye=0;Ye<Xe;Ye++)Je[Ye]=f(je,De,Y,J,R,k,Ae,Ie,Oe,Z,fe),Z=Je[Ye][5],fe=Je[Ye][6],je=De,De+=Ne;return Je}function d(N,U,R,k){var P=Math.atan2(U,N),A=Math.atan2(k,R);return A>=P?A-P:2*Math.PI-(P-A)}function u(N,U,R,k,P,A,E,I){var H;if(t.cachesBoundsOfCurve&&(H=o.call(arguments),t.boundsOfCurveCache[H]))return t.boundsOfCurveCache[H];var J=Math.sqrt,Y=Math.min,Z=Math.max,fe=Math.abs,X=[],re=[[],[]],se,z,oe,ce,we,ye,de,Te;z=6*N-12*R+6*P,se=-3*N+9*R-9*P+3*E,oe=3*R-3*N;for(var pe=0;pe<2;++pe){if(pe>0&&(z=6*U-12*k+6*A,se=-3*U+9*k-9*A+3*I,oe=3*k-3*U),fe(se)<1e-12){if(fe(z)<1e-12)continue;ce=-oe/z,0<ce&&ce<1&&X.push(ce);continue}de=z*z-4*oe*se,!(de<0)&&(Te=J(de),we=(-z+Te)/(2*se),0<we&&we<1&&X.push(we),ye=(-z-Te)/(2*se),0<ye&&ye<1&&X.push(ye))}for(var Ae,Ie,je=X.length,Le=je,Xe;je--;)ce=X[je],Xe=1-ce,Ae=Xe*Xe*Xe*N+3*Xe*Xe*ce*R+3*Xe*ce*ce*P+ce*ce*ce*E,re[0][je]=Ae,Ie=Xe*Xe*Xe*U+3*Xe*Xe*ce*k+3*Xe*ce*ce*A+ce*ce*ce*I,re[1][je]=Ie;re[0][Le]=N,re[1][Le]=U,re[0][Le+1]=E,re[1][Le+1]=I;var Je=[{x:Y.apply(null,re[0]),y:Y.apply(null,re[1])},{x:Z.apply(null,re[0]),y:Z.apply(null,re[1])}];return t.cachesBoundsOfCurve&&(t.boundsOfCurveCache[H]=Je),Je}function p(N,U,R){for(var k=R[1],P=R[2],A=R[3],E=R[4],I=R[5],H=R[6],J=R[7],Y=h(H-N,J-U,k,P,E,I,A),Z=0,fe=Y.length;Z<fe;Z++)Y[Z][1]+=N,Y[Z][2]+=U,Y[Z][3]+=N,Y[Z][4]+=U,Y[Z][5]+=N,Y[Z][6]+=U;return Y}function m(N){var U=0,R=0,k=N.length,P=0,A=0,E,I,H,J=[],Y,Z,fe;for(I=0;I<k;++I){switch(H=!1,E=N[I].slice(0),E[0]){case"l":E[0]="L",E[1]+=U,E[2]+=R;case"L":U=E[1],R=E[2];break;case"h":E[1]+=U;case"H":E[0]="L",E[2]=R,U=E[1];break;case"v":E[1]+=R;case"V":E[0]="L",R=E[1],E[1]=U,E[2]=R;break;case"m":E[0]="M",E[1]+=U,E[2]+=R;case"M":U=E[1],R=E[2],P=E[1],A=E[2];break;case"c":E[0]="C",E[1]+=U,E[2]+=R,E[3]+=U,E[4]+=R,E[5]+=U,E[6]+=R;case"C":Z=E[3],fe=E[4],U=E[5],R=E[6];break;case"s":E[0]="S",E[1]+=U,E[2]+=R,E[3]+=U,E[4]+=R;case"S":Y==="C"?(Z=2*U-Z,fe=2*R-fe):(Z=U,fe=R),U=E[3],R=E[4],E[0]="C",E[5]=E[3],E[6]=E[4],E[3]=E[1],E[4]=E[2],E[1]=Z,E[2]=fe,Z=E[3],fe=E[4];break;case"q":E[0]="Q",E[1]+=U,E[2]+=R,E[3]+=U,E[4]+=R;case"Q":Z=E[1],fe=E[2],U=E[3],R=E[4];break;case"t":E[0]="T",E[1]+=U,E[2]+=R;case"T":Y==="Q"?(Z=2*U-Z,fe=2*R-fe):(Z=U,fe=R),E[0]="Q",U=E[1],R=E[2],E[1]=Z,E[2]=fe,E[3]=U,E[4]=R;break;case"a":E[0]="A",E[6]+=U,E[7]+=R;case"A":H=!0,J=J.concat(p(U,R,E)),U=E[6],R=E[7];break;case"z":case"Z":U=P,R=A;break}H||J.push(E),Y=E[0]}return J}function g(N,U,R,k){return Math.sqrt((R-N)*(R-N)+(k-U)*(k-U))}function x(N){return N*N*N}function y(N){return 3*N*N*(1-N)}function w(N){return 3*N*(1-N)*(1-N)}function b(N){return(1-N)*(1-N)*(1-N)}function S(N,U,R,k,P,A,E,I){return function(H){var J=x(H),Y=y(H),Z=w(H),fe=b(H);return{x:E*J+P*Y+R*Z+N*fe,y:I*J+A*Y+k*Z+U*fe}}}function T(N,U,R,k,P,A,E,I){return function(H){var J=1-H,Y=3*J*J*(R-N)+6*J*H*(P-R)+3*H*H*(E-P),Z=3*J*J*(k-U)+6*J*H*(A-k)+3*H*H*(I-A);return Math.atan2(Z,Y)}}function O(N){return N*N}function j(N){return 2*N*(1-N)}function L(N){return(1-N)*(1-N)}function W(N,U,R,k,P,A){return function(E){var I=O(E),H=j(E),J=L(E);return{x:P*I+R*H+N*J,y:A*I+k*H+U*J}}}function F(N,U,R,k,P,A){return function(E){var I=1-E,H=2*I*(R-N)+2*E*(P-R),J=2*I*(k-U)+2*E*(A-k);return Math.atan2(J,H)}}function M(N,U,R){var k={x:U,y:R},P,A=0,E;for(E=1;E<=100;E+=1)P=N(E/100),A+=g(k.x,k.y,P.x,P.y),k=P;return A}function V(N,U){for(var R=0,k=0,P=N.iterator,A={x:N.x,y:N.y},E,I,H=.01,J=N.angleFinder,Y;k<U&&H>1e-4;)E=P(R),Y=R,I=g(A.x,A.y,E.x,E.y),I+k>U?(R-=H,H/=2):(A=E,R+=H,k+=I);return E.angle=J(Y),E}function G(N){for(var U=0,R=N.length,k,P=0,A=0,E=0,I=0,H=[],J,Y,Z,fe=0;fe<R;fe++){switch(k=N[fe],Y={x:P,y:A,command:k[0]},k[0]){case"M":Y.length=0,E=P=k[1],I=A=k[2];break;case"L":Y.length=g(P,A,k[1],k[2]),P=k[1],A=k[2];break;case"C":J=S(P,A,k[1],k[2],k[3],k[4],k[5],k[6]),Z=T(P,A,k[1],k[2],k[3],k[4],k[5],k[6]),Y.iterator=J,Y.angleFinder=Z,Y.length=M(J,P,A),P=k[5],A=k[6];break;case"Q":J=W(P,A,k[1],k[2],k[3],k[4]),Z=F(P,A,k[1],k[2],k[3],k[4]),Y.iterator=J,Y.angleFinder=Z,Y.length=M(J,P,A),P=k[3],A=k[4];break;case"Z":case"z":Y.destX=E,Y.destY=I,Y.length=g(P,A,E,I),P=E,A=I;break}U+=Y.length,H.push(Y)}return H.push({length:U,x:P,y:A}),H}function te(N,U,R){R||(R=G(N));for(var k=0;U-R[k].length>0&&k<R.length-2;)U-=R[k].length,k++;var P=R[k],A=U/P.length,E=P.command,I=N[k],H;switch(E){case"M":return{x:P.x,y:P.y,angle:0};case"Z":case"z":return H=new t.Point(P.x,P.y).lerp(new t.Point(P.destX,P.destY),A),H.angle=Math.atan2(P.destY-P.y,P.destX-P.x),H;case"L":return H=new t.Point(P.x,P.y).lerp(new t.Point(I[1],I[2]),A),H.angle=Math.atan2(I[2]-P.y,I[1]-P.x),H;case"C":return V(P,U);case"Q":return V(P,U)}}function ee(N){var U=[],R=[],k,P,A=t.rePathCommand,E="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",I="("+E+")"+t.commaWsp,H="([01])"+t.commaWsp+"?",J=I+"?"+I+"?"+I+H+H+I+"?("+E+")",Y=new RegExp(J,"g"),Z,fe,X;if(!N||!N.match)return U;X=N.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var re=0,se,z=X.length;re<z;re++){k=X[re],fe=k.slice(1).trim(),R.length=0;var oe=k.charAt(0);if(se=[oe],oe.toLowerCase()==="a")for(var ce;ce=Y.exec(fe);)for(var we=1;we<ce.length;we++)R.push(ce[we]);else for(;Z=A.exec(fe);)R.push(Z[0]);for(var we=0,ye=R.length;we<ye;we++)P=parseFloat(R[we]),isNaN(P)||se.push(P);var de=a[oe.toLowerCase()],Te=c[oe]||oe;if(se.length-1>de)for(var pe=1,Ae=se.length;pe<Ae;pe+=de)U.push([oe].concat(se.slice(pe,pe+de))),oe=Te;else U.push(se)}return U}function Q(N,U){var R=[],k,P=new t.Point(N[0].x,N[0].y),A=new t.Point(N[1].x,N[1].y),E=N.length,I=1,H=0,J=E>2;for(U=U||0,J&&(I=N[2].x<A.x?-1:N[2].x===A.x?0:1,H=N[2].y<A.y?-1:N[2].y===A.y?0:1),R.push(["M",P.x-I*U,P.y-H*U]),k=1;k<E;k++){if(!P.eq(A)){var Y=P.midPointFrom(A);R.push(["Q",P.x,P.y,Y.x,Y.y])}P=N[k],k+1<N.length&&(A=N[k+1])}return J&&(I=P.x>N[k-2].x?1:P.x===N[k-2].x?0:-1,H=P.y>N[k-2].y?1:P.y===N[k-2].y?0:-1),R.push(["L",P.x+I*U,P.y+H*U]),R}function K(N,U,R){return R&&(U=t.util.multiplyTransformMatrices(U,[1,0,0,1,-R.x,-R.y])),N.map(function(k){for(var P=k.slice(0),A={},E=1;E<k.length-1;E+=2)A.x=k[E],A.y=k[E+1],A=t.util.transformPoint(A,U),P[E]=A.x,P[E+1]=A.y;return P})}t.util.joinPath=function(N){return N.map(function(U){return U.join(" ")}).join(" ")},t.util.parsePath=ee,t.util.makePathSimpler=m,t.util.getSmoothPathFromPoints=Q,t.util.getPathSegmentsInfo=G,t.util.getBoundsOfCurve=u,t.util.getPointOnPath=te,t.util.transformPath=K}(),function(){var o=Array.prototype.slice;function a(u,p){for(var m=o.call(arguments,2),g=[],x=0,y=u.length;x<y;x++)g[x]=m.length?u[x][p].apply(u[x],m):u[x][p].call(u[x]);return g}function c(u,p){return d(u,p,function(m,g){return m>=g})}function f(u,p){return d(u,p,function(m,g){return m<g})}function h(u,p){for(var m=u.length;m--;)u[m]=p;return u}function d(u,p,m){if(!(!u||u.length===0)){var g=u.length-1,x=p?u[g][p]:u[g];if(p)for(;g--;)m(u[g][p],x)&&(x=u[g][p]);else for(;g--;)m(u[g],x)&&(x=u[g]);return x}}t.util.array={fill:h,invoke:a,min:f,max:c}}(),function(){function o(c,f,h){if(h)if(!t.isLikelyNode&&f instanceof Element)c=f;else if(f instanceof Array){c=[];for(var d=0,u=f.length;d<u;d++)c[d]=o({},f[d],h)}else if(f&&typeof f=="object")for(var p in f)p==="canvas"||p==="group"?c[p]=null:f.hasOwnProperty(p)&&(c[p]=o({},f[p],h));else c=f;else for(var p in f)c[p]=f[p];return c}function a(c,f){return o({},c,f)}t.util.object={extend:o,clone:a},t.util.object.extend(t.util,t.Observable)}(),function(){function o(d){return d.replace(/-+(.)?/g,function(u,p){return p?p.toUpperCase():""})}function a(d,u){return d.charAt(0).toUpperCase()+(u?d.slice(1):d.slice(1).toLowerCase())}function c(d){return d.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function f(d){var u=0,p,m=[];for(u=0,p;u<d.length;u++)(p=h(d,u))!==!1&&m.push(p);return m}function h(d,u){var p=d.charCodeAt(u);if(isNaN(p))return"";if(p<55296||p>57343)return d.charAt(u);if(55296<=p&&p<=56319){if(d.length<=u+1)throw"High surrogate without following low surrogate";var m=d.charCodeAt(u+1);if(56320>m||m>57343)throw"High surrogate without following low surrogate";return d.charAt(u)+d.charAt(u+1)}if(u===0)throw"Low surrogate without preceding high surrogate";var g=d.charCodeAt(u-1);if(55296>g||g>56319)throw"Low surrogate without preceding high surrogate";return!1}t.util.string={camelize:o,capitalize:a,escapeXml:c,graphemeSplit:f}}(),function(){var o=Array.prototype.slice,a=function(){},c=function(){for(var p in{toString:1})if(p==="toString")return!1;return!0}(),f=function(p,m,g){for(var x in m)x in p.prototype&&typeof p.prototype[x]=="function"&&(m[x]+"").indexOf("callSuper")>-1?p.prototype[x]=function(y){return function(){var w=this.constructor.superclass;this.constructor.superclass=g;var b=m[y].apply(this,arguments);if(this.constructor.superclass=w,y!=="initialize")return b}}(x):p.prototype[x]=m[x],c&&(m.toString!==Object.prototype.toString&&(p.prototype.toString=m.toString),m.valueOf!==Object.prototype.valueOf&&(p.prototype.valueOf=m.valueOf))};function h(){}function d(p){for(var m=null,g=this;g.constructor.superclass;){var x=g.constructor.superclass.prototype[p];if(g[p]!==x){m=x;break}g=g.constructor.superclass.prototype}return m?arguments.length>1?m.apply(this,o.call(arguments,1)):m.call(this):console.log("tried to callSuper "+p+", method not found in prototype chain",this)}function u(){var p=null,m=o.call(arguments,0);typeof m[0]=="function"&&(p=m.shift());function g(){this.initialize.apply(this,arguments)}g.superclass=p,g.subclasses=[],p&&(h.prototype=p.prototype,g.prototype=new h,p.subclasses.push(g));for(var x=0,y=m.length;x<y;x++)f(g,m[x],p);return g.prototype.initialize||(g.prototype.initialize=a),g.prototype.constructor=g,g.prototype.callSuper=d,g}t.util.createClass=u}(),function(){var o=!!t.document.createElement("div").attachEvent,a=["touchstart","touchmove","touchend"];t.util.addListener=function(f,h,d,u){f&&f.addEventListener(h,d,o?!1:u)},t.util.removeListener=function(f,h,d,u){f&&f.removeEventListener(h,d,o?!1:u)};function c(f){var h=f.changedTouches;return h&&h[0]?h[0]:f}t.util.getPointer=function(f){var h=f.target,d=t.util.getScrollLeftTop(h),u=c(f);return{x:u.clientX+d.left,y:u.clientY+d.top}},t.util.isTouchEvent=function(f){return a.indexOf(f.type)>-1||f.pointerType==="touch"}}(),function(){function o(u,p){var m=u.style;if(!m)return u;if(typeof p=="string")return u.style.cssText+=";"+p,p.indexOf("opacity")>-1?d(u,p.match(/opacity:\s*(\d?\.?\d*)/)[1]):u;for(var g in p)if(g==="opacity")d(u,p[g]);else{var x=g==="float"||g==="cssFloat"?typeof m.styleFloat>"u"?"cssFloat":"styleFloat":g;m.setProperty(x,p[g])}return u}var a=t.document.createElement("div"),c=typeof a.style.opacity=="string",f=typeof a.style.filter=="string",h=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,d=function(u){return u};c?d=function(u,p){return u.style.opacity=p,u}:f&&(d=function(u,p){var m=u.style;return u.currentStyle&&!u.currentStyle.hasLayout&&(m.zoom=1),h.test(m.filter)?(p=p>=.9999?"":"alpha(opacity="+p*100+")",m.filter=m.filter.replace(h,p)):m.filter+=" alpha(opacity="+p*100+")",u}),t.util.setStyle=o}(),function(){var o=Array.prototype.slice;function a(b){return typeof b=="string"?t.document.getElementById(b):b}var c,f=function(b){return o.call(b,0)};try{c=f(t.document.childNodes)instanceof Array}catch{}c||(f=function(b){for(var S=new Array(b.length),T=b.length;T--;)S[T]=b[T];return S});function h(b,S){var T=t.document.createElement(b);for(var O in S)O==="class"?T.className=S[O]:O==="for"?T.htmlFor=S[O]:T.setAttribute(O,S[O]);return T}function d(b,S){b&&(" "+b.className+" ").indexOf(" "+S+" ")===-1&&(b.className+=(b.className?" ":"")+S)}function u(b,S,T){return typeof S=="string"&&(S=h(S,T)),b.parentNode&&b.parentNode.replaceChild(S,b),S.appendChild(b),S}function p(b){for(var S=0,T=0,O=t.document.documentElement,j=t.document.body||{scrollLeft:0,scrollTop:0};b&&(b.parentNode||b.host)&&(b=b.parentNode||b.host,b===t.document?(S=j.scrollLeft||O.scrollLeft||0,T=j.scrollTop||O.scrollTop||0):(S+=b.scrollLeft||0,T+=b.scrollTop||0),!(b.nodeType===1&&b.style.position==="fixed")););return{left:S,top:T}}function m(b){var S,T=b&&b.ownerDocument,O={left:0,top:0},j={left:0,top:0},L,W={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!T)return j;for(var F in W)j[W[F]]+=parseInt(g(b,F),10)||0;return S=T.documentElement,typeof b.getBoundingClientRect<"u"&&(O=b.getBoundingClientRect()),L=p(b),{left:O.left+L.left-(S.clientLeft||0)+j.left,top:O.top+L.top-(S.clientTop||0)+j.top}}var g;t.document.defaultView&&t.document.defaultView.getComputedStyle?g=function(b,S){var T=t.document.defaultView.getComputedStyle(b,null);return T?T[S]:void 0}:g=function(b,S){var T=b.style[S];return!T&&b.currentStyle&&(T=b.currentStyle[S]),T},function(){var b=t.document.documentElement.style,S="userSelect"in b?"userSelect":"MozUserSelect"in b?"MozUserSelect":"WebkitUserSelect"in b?"WebkitUserSelect":"KhtmlUserSelect"in b?"KhtmlUserSelect":"";function T(j){return typeof j.onselectstart<"u"&&(j.onselectstart=t.util.falseFunction),S?j.style[S]="none":typeof j.unselectable=="string"&&(j.unselectable="on"),j}function O(j){return typeof j.onselectstart<"u"&&(j.onselectstart=null),S?j.style[S]="":typeof j.unselectable=="string"&&(j.unselectable=""),j}t.util.makeElementUnselectable=T,t.util.makeElementSelectable=O}();function x(b){var S=t.jsdomImplForWrapper(b);return S._canvas||S._image}function y(b){if(t.isLikelyNode){var S=t.jsdomImplForWrapper(b);S&&(S._image=null,S._canvas=null,S._currentSrc=null,S._attributes=null,S._classList=null)}}function w(b,S){b.imageSmoothingEnabled=b.imageSmoothingEnabled||b.webkitImageSmoothingEnabled||b.mozImageSmoothingEnabled||b.msImageSmoothingEnabled||b.oImageSmoothingEnabled,b.imageSmoothingEnabled=S}t.util.setImageSmoothing=w,t.util.getById=a,t.util.toArray=f,t.util.addClass=d,t.util.makeElement=h,t.util.wrapElement=u,t.util.getScrollLeftTop=p,t.util.getElementOffset=m,t.util.getNodeCanvas=x,t.util.cleanUpJsdomNode=y}(),function(){function o(f,h){return f+(/\?/.test(f)?"&":"?")+h}function a(){}function c(f,h){h||(h={});var d=h.method?h.method.toUpperCase():"GET",u=h.onComplete||function(){},p=new t.window.XMLHttpRequest,m=h.body||h.parameters;return p.onreadystatechange=function(){p.readyState===4&&(u(p),p.onreadystatechange=a)},d==="GET"&&(m=null,typeof h.parameters=="string"&&(f=o(f,h.parameters))),p.open(d,f,!0),(d==="POST"||d==="PUT")&&p.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),p.send(m),p}t.util.request=c}(),t.log=console.log,t.warn=console.warn,function(){var o=t.util.object.extend,a=t.util.object.clone,c=[];t.util.object.extend(c,{cancelAll:function(){var x=this.splice(0);return x.forEach(function(y){y.cancel()}),x},cancelByCanvas:function(x){if(!x)return[];var y=this.filter(function(w){return typeof w.target=="object"&&w.target.canvas===x});return y.forEach(function(w){w.cancel()}),y},cancelByTarget:function(x){var y=this.findAnimationsByTarget(x);return y.forEach(function(w){w.cancel()}),y},findAnimationIndex:function(x){return this.indexOf(this.findAnimation(x))},findAnimation:function(x){return this.find(function(y){return y.cancel===x})},findAnimationsByTarget:function(x){return x?this.filter(function(y){return y.target===x}):[]}});function f(){return!1}function h(x,y,w,b){return-w*Math.cos(x/b*(Math.PI/2))+w+y}function d(x){x||(x={});var y=!1,w,b=function(){var S=t.runningAnimations.indexOf(w);return S>-1&&t.runningAnimations.splice(S,1)[0]};return w=o(a(x),{cancel:function(){return y=!0,b()},currentValue:"startValue"in x?x.startValue:0,completionRate:0,durationRate:0}),t.runningAnimations.push(w),m(function(S){var T=S||+new Date,O=x.duration||500,j=T+O,L,W=x.onChange||f,F=x.abort||f,M=x.onComplete||f,V=x.easing||h,G="startValue"in x?x.startValue.length>0:!1,te="startValue"in x?x.startValue:0,ee="endValue"in x?x.endValue:100,Q=x.byValue||(G?te.map(function(K,N){return ee[N]-te[N]}):ee-te);x.onStart&&x.onStart(),function K(N){L=N||+new Date;var U=L>j?O:L-T,R=U/O,k=G?te.map(function(A,E){return V(U,te[E],Q[E],O)}):V(U,te,Q,O),P=Math.abs(G?(k[0]-te[0])/Q[0]:(k-te)/Q);if(w.currentValue=G?k.slice():k,w.completionRate=P,w.durationRate=R,!y){if(F(k,P,R)){b();return}if(L>j){w.currentValue=G?ee.slice():ee,w.completionRate=1,w.durationRate=1,W(G?ee.slice():ee,1,1),M(ee,1,1),b();return}else W(k,P,R),m(K)}}(T)}),w.cancel}var u=t.window.requestAnimationFrame||t.window.webkitRequestAnimationFrame||t.window.mozRequestAnimationFrame||t.window.oRequestAnimationFrame||t.window.msRequestAnimationFrame||function(x){return t.window.setTimeout(x,1e3/60)},p=t.window.cancelAnimationFrame||t.window.clearTimeout;function m(){return u.apply(t.window,arguments)}function g(){return p.apply(t.window,arguments)}t.util.animate=d,t.util.requestAnimFrame=m,t.util.cancelAnimFrame=g,t.runningAnimations=c}(),function(){function o(c,f,h){var d="rgba("+parseInt(c[0]+h*(f[0]-c[0]),10)+","+parseInt(c[1]+h*(f[1]-c[1]),10)+","+parseInt(c[2]+h*(f[2]-c[2]),10);return d+=","+(c&&f?parseFloat(c[3]+h*(f[3]-c[3])):1),d+=")",d}function a(c,f,h,d){var u=new t.Color(c).getSource(),p=new t.Color(f).getSource(),m=d.onComplete,g=d.onChange;return d=d||{},t.util.animate(t.util.object.extend(d,{duration:h||500,startValue:u,endValue:p,byValue:p,easing:function(x,y,w,b){var S=d.colorEasing?d.colorEasing(x,b):1-Math.cos(x/b*(Math.PI/2));return o(y,w,S)},onComplete:function(x,y,w){if(m)return m(o(p,p,0),y,w)},onChange:function(x,y,w){if(g){if(Array.isArray(x))return g(o(x,x,0),y,w);g(x,y,w)}}}))}t.util.animateColor=a}(),function(){function o(N,U,R,k){return N<Math.abs(U)?(N=U,k=R/4):U===0&&N===0?k=R/(2*Math.PI)*Math.asin(1):k=R/(2*Math.PI)*Math.asin(U/N),{a:N,c:U,p:R,s:k}}function a(N,U,R){return N.a*Math.pow(2,10*(U-=1))*Math.sin((U*R-N.s)*(2*Math.PI)/N.p)}function c(N,U,R,k){return R*((N=N/k-1)*N*N+1)+U}function f(N,U,R,k){return N/=k/2,N<1?R/2*N*N*N+U:R/2*((N-=2)*N*N+2)+U}function h(N,U,R,k){return R*(N/=k)*N*N*N+U}function d(N,U,R,k){return-R*((N=N/k-1)*N*N*N-1)+U}function u(N,U,R,k){return N/=k/2,N<1?R/2*N*N*N*N+U:-R/2*((N-=2)*N*N*N-2)+U}function p(N,U,R,k){return R*(N/=k)*N*N*N*N+U}function m(N,U,R,k){return R*((N=N/k-1)*N*N*N*N+1)+U}function g(N,U,R,k){return N/=k/2,N<1?R/2*N*N*N*N*N+U:R/2*((N-=2)*N*N*N*N+2)+U}function x(N,U,R,k){return-R*Math.cos(N/k*(Math.PI/2))+R+U}function y(N,U,R,k){return R*Math.sin(N/k*(Math.PI/2))+U}function w(N,U,R,k){return-R/2*(Math.cos(Math.PI*N/k)-1)+U}function b(N,U,R,k){return N===0?U:R*Math.pow(2,10*(N/k-1))+U}function S(N,U,R,k){return N===k?U+R:R*(-Math.pow(2,-10*N/k)+1)+U}function T(N,U,R,k){return N===0?U:N===k?U+R:(N/=k/2,N<1?R/2*Math.pow(2,10*(N-1))+U:R/2*(-Math.pow(2,-10*--N)+2)+U)}function O(N,U,R,k){return-R*(Math.sqrt(1-(N/=k)*N)-1)+U}function j(N,U,R,k){return R*Math.sqrt(1-(N=N/k-1)*N)+U}function L(N,U,R,k){return N/=k/2,N<1?-R/2*(Math.sqrt(1-N*N)-1)+U:R/2*(Math.sqrt(1-(N-=2)*N)+1)+U}function W(N,U,R,k){var P=1.70158,A=0,E=R;if(N===0)return U;if(N/=k,N===1)return U+R;A||(A=k*.3);var I=o(E,R,A,P);return-a(I,N,k)+U}function F(N,U,R,k){var P=1.70158,A=0,E=R;if(N===0)return U;if(N/=k,N===1)return U+R;A||(A=k*.3);var I=o(E,R,A,P);return I.a*Math.pow(2,-10*N)*Math.sin((N*k-I.s)*(2*Math.PI)/I.p)+I.c+U}function M(N,U,R,k){var P=1.70158,A=0,E=R;if(N===0)return U;if(N/=k/2,N===2)return U+R;A||(A=k*(.3*1.5));var I=o(E,R,A,P);return N<1?-.5*a(I,N,k)+U:I.a*Math.pow(2,-10*(N-=1))*Math.sin((N*k-I.s)*(2*Math.PI)/I.p)*.5+I.c+U}function V(N,U,R,k,P){return P===void 0&&(P=1.70158),R*(N/=k)*N*((P+1)*N-P)+U}function G(N,U,R,k,P){return P===void 0&&(P=1.70158),R*((N=N/k-1)*N*((P+1)*N+P)+1)+U}function te(N,U,R,k,P){return P===void 0&&(P=1.70158),N/=k/2,N<1?R/2*(N*N*(((P*=1.525)+1)*N-P))+U:R/2*((N-=2)*N*(((P*=1.525)+1)*N+P)+2)+U}function ee(N,U,R,k){return R-Q(k-N,0,R,k)+U}function Q(N,U,R,k){return(N/=k)<1/2.75?R*(7.5625*N*N)+U:N<2/2.75?R*(7.5625*(N-=1.5/2.75)*N+.75)+U:N<2.5/2.75?R*(7.5625*(N-=2.25/2.75)*N+.9375)+U:R*(7.5625*(N-=2.625/2.75)*N+.984375)+U}function K(N,U,R,k){return N<k/2?ee(N*2,0,R,k)*.5+U:Q(N*2-k,0,R,k)*.5+R*.5+U}t.util.ease={easeInQuad:function(N,U,R,k){return R*(N/=k)*N+U},easeOutQuad:function(N,U,R,k){return-R*(N/=k)*(N-2)+U},easeInOutQuad:function(N,U,R,k){return N/=k/2,N<1?R/2*N*N+U:-R/2*(--N*(N-2)-1)+U},easeInCubic:function(N,U,R,k){return R*(N/=k)*N*N+U},easeOutCubic:c,easeInOutCubic:f,easeInQuart:h,easeOutQuart:d,easeInOutQuart:u,easeInQuint:p,easeOutQuint:m,easeInOutQuint:g,easeInSine:x,easeOutSine:y,easeInOutSine:w,easeInExpo:b,easeOutExpo:S,easeInOutExpo:T,easeInCirc:O,easeOutCirc:j,easeInOutCirc:L,easeInElastic:W,easeOutElastic:F,easeInOutElastic:M,easeInBack:V,easeOutBack:G,easeInOutBack:te,easeInBounce:ee,easeOutBounce:Q,easeInOutBounce:K}}(),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,f=a.util.object.clone,h=a.util.toFixed,d=a.util.parseUnit,u=a.util.multiplyTransformMatrices,p=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],m=["symbol","image","marker","pattern","view","svg"],g=["pattern","defs","symbol","metadata","clipPath","mask","desc"],x=["symbol","g","a","svg","clipPath","defs"],y={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},w={stroke:"strokeOpacity",fill:"fillOpacity"},b="font-size",S="clip-path";a.svgValidTagNamesRegEx=j(p),a.svgViewBoxElementsRegEx=j(m),a.svgInvalidAncestorsRegEx=j(g),a.svgValidParentsRegEx=j(x),a.cssRules={},a.gradientDefs={},a.clipPaths={};function T(A){return A in y?y[A]:A}function O(A,E,I,H){var J=Array.isArray(E),Y;if((A==="fill"||A==="stroke")&&E==="none")E="";else{if(A==="strokeUniform")return E==="non-scaling-stroke";if(A==="strokeDashArray")E==="none"?E=null:E=E.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(A==="transformMatrix")I&&I.transformMatrix?E=u(I.transformMatrix,a.parseTransformAttribute(E)):E=a.parseTransformAttribute(E);else if(A==="visible")E=E!=="none"&&E!=="hidden",I&&I.visible===!1&&(E=!1);else if(A==="opacity")E=parseFloat(E),I&&typeof I.opacity<"u"&&(E*=I.opacity);else if(A==="textAnchor")E=E==="start"?"left":E==="end"?"right":"center";else if(A==="charSpacing")Y=d(E,H)/H*1e3;else if(A==="paintFirst"){var Z=E.indexOf("fill"),fe=E.indexOf("stroke"),E="fill";(Z>-1&&fe>-1&&fe<Z||Z===-1&&fe>-1)&&(E="stroke")}else{if(A==="href"||A==="xlink:href"||A==="font")return E;if(A==="imageSmoothing")return E==="optimizeQuality";Y=J?E.map(d):d(E,H)}}return!J&&isNaN(Y)?E:Y}function j(A){return new RegExp("^("+A.join("|")+")\\b","i")}function L(A){for(var E in w)if(!(typeof A[w[E]]>"u"||A[E]==="")){if(typeof A[E]>"u"){if(!a.Object.prototype[E])continue;A[E]=a.Object.prototype[E]}if(A[E].indexOf("url(")!==0){var I=new a.Color(A[E]);A[E]=I.setAlpha(h(I.getAlpha()*A[w[E]],2)).toRgba()}}return A}function W(A,E){var I,H=[],J,Y,Z;for(Y=0,Z=E.length;Y<Z;Y++)I=E[Y],J=A.getElementsByTagName(I),H=H.concat(Array.prototype.slice.call(J));return H}a.parseTransformAttribute=function(){function A(pe,Ae){var Ie=a.util.cos(Ae[0]),je=a.util.sin(Ae[0]),Le=0,Xe=0;Ae.length===3&&(Le=Ae[1],Xe=Ae[2]),pe[0]=Ie,pe[1]=je,pe[2]=-je,pe[3]=Ie,pe[4]=Le-(Ie*Le-je*Xe),pe[5]=Xe-(je*Le+Ie*Xe)}function E(pe,Ae){var Ie=Ae[0],je=Ae.length===2?Ae[1]:Ae[0];pe[0]=Ie,pe[3]=je}function I(pe,Ae,Ie){pe[Ie]=Math.tan(a.util.degreesToRadians(Ae[0]))}function H(pe,Ae){pe[4]=Ae[0],Ae.length===2&&(pe[5]=Ae[1])}var J=a.iMatrix,Y=a.reNum,Z=a.commaWsp,fe="(?:(skewX)\\s*\\(\\s*("+Y+")\\s*\\))",X="(?:(skewY)\\s*\\(\\s*("+Y+")\\s*\\))",re="(?:(rotate)\\s*\\(\\s*("+Y+")(?:"+Z+"("+Y+")"+Z+"("+Y+"))?\\s*\\))",se="(?:(scale)\\s*\\(\\s*("+Y+")(?:"+Z+"("+Y+"))?\\s*\\))",z="(?:(translate)\\s*\\(\\s*("+Y+")(?:"+Z+"("+Y+"))?\\s*\\))",oe="(?:(matrix)\\s*\\(\\s*("+Y+")"+Z+"("+Y+")"+Z+"("+Y+")"+Z+"("+Y+")"+Z+"("+Y+")"+Z+"("+Y+")\\s*\\))",ce="(?:"+oe+"|"+z+"|"+se+"|"+re+"|"+fe+"|"+X+")",we="(?:"+ce+"(?:"+Z+"*"+ce+")*)",ye="^\\s*(?:"+we+"?)\\s*$",de=new RegExp(ye),Te=new RegExp(ce,"g");return function(pe){var Ae=J.concat(),Ie=[];if(!pe||pe&&!de.test(pe))return Ae;pe.replace(Te,function(Le){var Xe=new RegExp(ce).exec(Le).filter(function(Oe){return!!Oe}),Je=Xe[1],Ne=Xe.slice(2).map(parseFloat);switch(Je){case"translate":H(Ae,Ne);break;case"rotate":Ne[0]=a.util.degreesToRadians(Ne[0]),A(Ae,Ne);break;case"scale":E(Ae,Ne);break;case"skewX":I(Ae,Ne,2);break;case"skewY":I(Ae,Ne,1);break;case"matrix":Ae=Ne;break}Ie.push(Ae.concat()),Ae=J.concat()});for(var je=Ie[0];Ie.length>1;)Ie.shift(),je=a.util.multiplyTransformMatrices(je,Ie[0]);return je}}();function F(A,E){var I,H;A.replace(/;\s*$/,"").split(";").forEach(function(J){var Y=J.split(":");I=Y[0].trim().toLowerCase(),H=Y[1].trim(),E[I]=H})}function M(A,E){var I,H;for(var J in A)typeof A[J]>"u"||(I=J.toLowerCase(),H=A[J],E[I]=H)}function V(A,E){var I={};for(var H in a.cssRules[E])if(G(A,H.split(" ")))for(var J in a.cssRules[E][H])I[J]=a.cssRules[E][H][J];return I}function G(A,E){var I,H=!0;return I=ee(A,E.pop()),I&&E.length&&(H=te(A,E)),I&&H&&E.length===0}function te(A,E){for(var I,H=!0;A.parentNode&&A.parentNode.nodeType===1&&E.length;)H&&(I=E.pop()),A=A.parentNode,H=ee(A,I);return E.length===0}function ee(A,E){var I=A.nodeName,H=A.getAttribute("class"),J=A.getAttribute("id"),Y,Z;if(Y=new RegExp("^"+I,"i"),E=E.replace(Y,""),J&&E.length&&(Y=new RegExp("#"+J+"(?![a-zA-Z\\-]+)","i"),E=E.replace(Y,"")),H&&E.length)for(H=H.split(" "),Z=H.length;Z--;)Y=new RegExp("\\."+H[Z]+"(?![a-zA-Z\\-]+)","i"),E=E.replace(Y,"");return E.length===0}function Q(A,E){var I;if(A.getElementById&&(I=A.getElementById(E)),I)return I;var H,J,Y,Z=A.getElementsByTagName("*");for(J=0,Y=Z.length;J<Y;J++)if(H=Z[J],E===H.getAttribute("id"))return H}function K(A){for(var E=W(A,["use","svg:use"]),I=0;E.length&&I<E.length;){var H=E[I],J=H.getAttribute("xlink:href")||H.getAttribute("href");if(J===null)return;var Y=J.slice(1),Z=H.getAttribute("x")||0,fe=H.getAttribute("y")||0,X=Q(A,Y).cloneNode(!0),re=(X.getAttribute("transform")||"")+" translate("+Z+", "+fe+")",se,z=E.length,oe,ce,we,ye,de=a.svgNS;if(U(X),/^svg$/i.test(X.nodeName)){var Te=X.ownerDocument.createElementNS(de,"g");for(ce=0,we=X.attributes,ye=we.length;ce<ye;ce++)oe=we.item(ce),Te.setAttributeNS(de,oe.nodeName,oe.nodeValue);for(;X.firstChild;)Te.appendChild(X.firstChild);X=Te}for(ce=0,we=H.attributes,ye=we.length;ce<ye;ce++)oe=we.item(ce),!(oe.nodeName==="x"||oe.nodeName==="y"||oe.nodeName==="xlink:href"||oe.nodeName==="href")&&(oe.nodeName==="transform"?re=oe.nodeValue+" "+re:X.setAttribute(oe.nodeName,oe.nodeValue));X.setAttribute("transform",re),X.setAttribute("instantiated_by_use","1"),X.removeAttribute("id"),se=H.parentNode,se.replaceChild(X,H),E.length===z&&I++}}var N=new RegExp("^\\s*("+a.reNum+"+)\\s*,?\\s*("+a.reNum+"+)\\s*,?\\s*("+a.reNum+"+)\\s*,?\\s*("+a.reNum+"+)\\s*$");function U(A){if(!a.svgViewBoxElementsRegEx.test(A.nodeName))return{};var E=A.getAttribute("viewBox"),I=1,H=1,J=0,Y=0,Z,fe,X,re,se=A.getAttribute("width"),z=A.getAttribute("height"),oe=A.getAttribute("x")||0,ce=A.getAttribute("y")||0,we=A.getAttribute("preserveAspectRatio")||"",ye=!E||!(E=E.match(N)),de=!se||!z||se==="100%"||z==="100%",Te=ye&&de,pe={},Ae="",Ie=0,je=0;if(pe.width=0,pe.height=0,pe.toBeParsed=Te,ye&&(oe||ce)&&A.parentNode&&A.parentNode.nodeName!=="#document"&&(Ae=" translate("+d(oe)+" "+d(ce)+") ",X=(A.getAttribute("transform")||"")+Ae,A.setAttribute("transform",X),A.removeAttribute("x"),A.removeAttribute("y")),Te)return pe;if(ye)return pe.width=d(se),pe.height=d(z),pe;if(J=-parseFloat(E[1]),Y=-parseFloat(E[2]),Z=parseFloat(E[3]),fe=parseFloat(E[4]),pe.minX=J,pe.minY=Y,pe.viewBoxWidth=Z,pe.viewBoxHeight=fe,de?(pe.width=Z,pe.height=fe):(pe.width=d(se),pe.height=d(z),I=pe.width/Z,H=pe.height/fe),we=a.util.parsePreserveAspectRatioAttribute(we),we.alignX!=="none"&&(we.meetOrSlice==="meet"&&(H=I=I>H?H:I),we.meetOrSlice==="slice"&&(H=I=I>H?I:H),Ie=pe.width-Z*I,je=pe.height-fe*I,we.alignX==="Mid"&&(Ie/=2),we.alignY==="Mid"&&(je/=2),we.alignX==="Min"&&(Ie=0),we.alignY==="Min"&&(je=0)),I===1&&H===1&&J===0&&Y===0&&oe===0&&ce===0)return pe;if((oe||ce)&&A.parentNode.nodeName!=="#document"&&(Ae=" translate("+d(oe)+" "+d(ce)+") "),X=Ae+" matrix("+I+" 0 0 "+H+" "+(J*I+Ie)+" "+(Y*H+je)+") ",A.nodeName==="svg"){for(re=A.ownerDocument.createElementNS(a.svgNS,"g");A.firstChild;)re.appendChild(A.firstChild);A.appendChild(re)}else re=A,re.removeAttribute("x"),re.removeAttribute("y"),X=re.getAttribute("transform")+X;return re.setAttribute("transform",X),pe}function R(A,E){for(;A&&(A=A.parentNode);)if(A.nodeName&&E.test(A.nodeName.replace("svg:",""))&&!A.getAttribute("instantiated_by_use"))return!0;return!1}a.parseSVGDocument=function(A,E,I,H){if(A){K(A);var J=a.Object.__uid++,Y,Z,fe=U(A),X=a.util.toArray(A.getElementsByTagName("*"));if(fe.crossOrigin=H&&H.crossOrigin,fe.svgUid=J,X.length===0&&a.isLikelyNode){X=A.selectNodes('//*[name(.)!="svg"]');var re=[];for(Y=0,Z=X.length;Y<Z;Y++)re[Y]=X[Y];X=re}var se=X.filter(function(oe){return U(oe),a.svgValidTagNamesRegEx.test(oe.nodeName.replace("svg:",""))&&!R(oe,a.svgInvalidAncestorsRegEx)});if(!se||se&&!se.length){E&&E([],{});return}var z={};X.filter(function(oe){return oe.nodeName.replace("svg:","")==="clipPath"}).forEach(function(oe){var ce=oe.getAttribute("id");z[ce]=a.util.toArray(oe.getElementsByTagName("*")).filter(function(we){return a.svgValidTagNamesRegEx.test(we.nodeName.replace("svg:",""))})}),a.gradientDefs[J]=a.getGradientDefs(A),a.cssRules[J]=a.getCSSRules(A),a.clipPaths[J]=z,a.parseElements(se,function(oe,ce){E&&(E(oe,fe,ce,X),delete a.gradientDefs[J],delete a.cssRules[J],delete a.clipPaths[J])},f(fe),I,H)}};function k(A,E){var I=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],H="xlink:href",J=E.getAttribute(H).slice(1),Y=Q(A,J);if(Y&&Y.getAttribute(H)&&k(A,Y),I.forEach(function(fe){Y&&!E.hasAttribute(fe)&&Y.hasAttribute(fe)&&E.setAttribute(fe,Y.getAttribute(fe))}),!E.children.length)for(var Z=Y.cloneNode(!0);Z.firstChild;)E.appendChild(Z.firstChild);E.removeAttribute(H)}var P=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+a.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+a.reNum+"))?\\s+(.*)");c(a,{parseFontDeclaration:function(A,E){var I=A.match(P);if(I){var H=I[1],J=I[3],Y=I[4],Z=I[5],fe=I[6];H&&(E.fontStyle=H),J&&(E.fontWeight=isNaN(parseFloat(J))?J:parseFloat(J)),Y&&(E.fontSize=d(Y)),fe&&(E.fontFamily=fe),Z&&(E.lineHeight=Z==="normal"?1:Z)}},getGradientDefs:function(A){var E=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],I=W(A,E),H,J=0,Y={};for(J=I.length;J--;)H=I[J],H.getAttribute("xlink:href")&&k(A,H),Y[H.getAttribute("id")]=H;return Y},parseAttributes:function(A,E,I){if(A){var H,J={},Y,Z;typeof I>"u"&&(I=A.getAttribute("svgUid")),A.parentNode&&a.svgValidParentsRegEx.test(A.parentNode.nodeName)&&(J=a.parseAttributes(A.parentNode,E,I));var fe=E.reduce(function(we,ye){return H=A.getAttribute(ye),H&&(we[ye]=H),we},{}),X=c(V(A,I),a.parseStyleAttribute(A));fe=c(fe,X),X[S]&&A.setAttribute(S,X[S]),Y=Z=J.fontSize||a.Text.DEFAULT_SVG_FONT_SIZE,fe[b]&&(fe[b]=Y=d(fe[b],Z));var re,se,z={};for(var oe in fe)re=T(oe),se=O(re,fe[oe],J,Y),z[re]=se;z&&z.font&&a.parseFontDeclaration(z.font,z);var ce=c(J,z);return a.svgValidParentsRegEx.test(A.nodeName)?ce:L(ce)}},parseElements:function(A,E,I,H,J){new a.ElementsParser(A,E,I,H,J).parse()},parseStyleAttribute:function(A){var E={},I=A.getAttribute("style");return I&&(typeof I=="string"?F(I,E):M(I,E)),E},parsePointsAttribute:function(A){if(!A)return null;A=A.replace(/,/g," ").trim(),A=A.split(/\s+/);var E=[],I,H;for(I=0,H=A.length;I<H;I+=2)E.push({x:parseFloat(A[I]),y:parseFloat(A[I+1])});return E},getCSSRules:function(A){var E=A.getElementsByTagName("style"),I,H,J={},Y;for(I=0,H=E.length;I<H;I++){var Z=E[I].textContent;Z=Z.replace(/\/\*[\s\S]*?\*\//g,""),Z.trim()!==""&&(Y=Z.split("}"),Y=Y.filter(function(fe){return fe.trim()}),Y.forEach(function(fe){var X=fe.split("{"),re={},se=X[1].trim(),z=se.split(";").filter(function(ye){return ye.trim()});for(I=0,H=z.length;I<H;I++){var oe=z[I].split(":"),ce=oe[0].trim(),we=oe[1].trim();re[ce]=we}fe=X[0].trim(),fe.split(",").forEach(function(ye){ye=ye.replace(/^svg/i,"").trim(),ye!==""&&(J[ye]?a.util.object.extend(J[ye],re):J[ye]=a.util.object.clone(re))})}))}return J},loadSVGFromURL:function(A,E,I,H){A=A.replace(/^\n\s*/,"").trim(),new a.util.request(A,{method:"get",onComplete:J});function J(Y){var Z=Y.responseXML;if(!Z||!Z.documentElement)return E&&E(null),!1;a.parseSVGDocument(Z.documentElement,function(fe,X,re,se){E&&E(fe,X,re,se)},I,H)}},loadSVGFromString:function(A,E,I,H){var J=new a.window.DOMParser,Y=J.parseFromString(A.trim(),"text/xml");a.parseSVGDocument(Y.documentElement,function(Z,fe,X,re){E(Z,fe,X,re)},I,H)}})}(e),t.ElementsParser=function(o,a,c,f,h,d){this.elements=o,this.callback=a,this.options=c,this.reviver=f,this.svgUid=c&&c.svgUid||0,this.parsingOptions=h,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=d},function(o){o.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},o.createObjects=function(){var a=this;this.elements.forEach(function(c,f){c.setAttribute("svgUid",a.svgUid),a.createObject(c,f)})},o.findTag=function(a){return t[t.util.string.capitalize(a.tagName.replace("svg:",""))]},o.createObject=function(a,c){var f=this.findTag(a);if(f&&f.fromElement)try{f.fromElement(a,this.createCallback(c,a),this.options)}catch(h){t.log(h)}else this.checkIfDone()},o.createCallback=function(a,c){var f=this;return function(h){var d;f.resolveGradient(h,c,"fill"),f.resolveGradient(h,c,"stroke"),h instanceof t.Image&&h._originalElement&&(d=h.parsePreserveAspectRatioAttribute(c)),h._removeTransformMatrix(d),f.resolveClipPath(h,c),f.reviver&&f.reviver(c,h),f.instances[a]=h,f.checkIfDone()}},o.extractPropertyDefinition=function(a,c,f){var h=a[c],d=this.regexUrl;if(d.test(h)){d.lastIndex=0;var u=d.exec(h)[1];return d.lastIndex=0,t[f][this.svgUid][u]}},o.resolveGradient=function(a,c,f){var h=this.extractPropertyDefinition(a,f,"gradientDefs");if(h){var d=c.getAttribute(f+"-opacity"),u=t.Gradient.fromElement(h,a,d,this.options);a.set(f,u)}},o.createClipPathCallback=function(a,c){return function(f){f._removeTransformMatrix(),f.fillRule=f.clipRule,c.push(f)}},o.resolveClipPath=function(a,c){var f=this.extractPropertyDefinition(a,"clipPath","clipPaths"),h,d,u,p,m,g;if(f){p=[],u=t.util.invertTransform(a.calcTransformMatrix());for(var x=f[0].parentNode,y=c;y.parentNode&&y.getAttribute("clip-path")!==a.clipPath;)y=y.parentNode;y.parentNode.appendChild(x);for(var w=0;w<f.length;w++)h=f[w],d=this.findTag(h),d.fromElement(h,this.createClipPathCallback(a,p),this.options);p.length===1?f=p[0]:f=new t.Group(p),m=t.util.multiplyTransformMatrices(u,f.calcTransformMatrix()),f.clipPath&&this.resolveClipPath(f,y);var g=t.util.qrDecompose(m);f.flipX=!1,f.flipY=!1,f.set("scaleX",g.scaleX),f.set("scaleY",g.scaleY),f.angle=g.angle,f.skewX=g.skewX,f.skewY=0,f.setPositionByOrigin({x:g.translateX,y:g.translateY},"center","center"),a.clipPath=f}else delete a.clipPath},o.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(a){return a!=null}),this.callback(this.instances,this.elements))}}(t.ElementsParser.prototype),function(o){var a=o.fabric||(o.fabric={});if(a.Point){a.warn("fabric.Point is already defined");return}a.Point=c;function c(f,h){this.x=f,this.y=h}c.prototype={type:"point",constructor:c,add:function(f){return new c(this.x+f.x,this.y+f.y)},addEquals:function(f){return this.x+=f.x,this.y+=f.y,this},scalarAdd:function(f){return new c(this.x+f,this.y+f)},scalarAddEquals:function(f){return this.x+=f,this.y+=f,this},subtract:function(f){return new c(this.x-f.x,this.y-f.y)},subtractEquals:function(f){return this.x-=f.x,this.y-=f.y,this},scalarSubtract:function(f){return new c(this.x-f,this.y-f)},scalarSubtractEquals:function(f){return this.x-=f,this.y-=f,this},multiply:function(f){return new c(this.x*f,this.y*f)},multiplyEquals:function(f){return this.x*=f,this.y*=f,this},divide:function(f){return new c(this.x/f,this.y/f)},divideEquals:function(f){return this.x/=f,this.y/=f,this},eq:function(f){return this.x===f.x&&this.y===f.y},lt:function(f){return this.x<f.x&&this.y<f.y},lte:function(f){return this.x<=f.x&&this.y<=f.y},gt:function(f){return this.x>f.x&&this.y>f.y},gte:function(f){return this.x>=f.x&&this.y>=f.y},lerp:function(f,h){return typeof h>"u"&&(h=.5),h=Math.max(Math.min(1,h),0),new c(this.x+(f.x-this.x)*h,this.y+(f.y-this.y)*h)},distanceFrom:function(f){var h=this.x-f.x,d=this.y-f.y;return Math.sqrt(h*h+d*d)},midPointFrom:function(f){return this.lerp(f)},min:function(f){return new c(Math.min(this.x,f.x),Math.min(this.y,f.y))},max:function(f){return new c(Math.max(this.x,f.x),Math.max(this.y,f.y))},toString:function(){return this.x+","+this.y},setXY:function(f,h){return this.x=f,this.y=h,this},setX:function(f){return this.x=f,this},setY:function(f){return this.y=f,this},setFromPoint:function(f){return this.x=f.x,this.y=f.y,this},swap:function(f){var h=this.x,d=this.y;this.x=f.x,this.y=f.y,f.x=h,f.y=d},clone:function(){return new c(this.x,this.y)}}}(e),function(o){var a=o.fabric||(o.fabric={});if(a.Intersection){a.warn("fabric.Intersection is already defined");return}function c(f){this.status=f,this.points=[]}a.Intersection=c,a.Intersection.prototype={constructor:c,appendPoint:function(f){return this.points.push(f),this},appendPoints:function(f){return this.points=this.points.concat(f),this}},a.Intersection.intersectLineLine=function(f,h,d,u){var p,m=(u.x-d.x)*(f.y-d.y)-(u.y-d.y)*(f.x-d.x),g=(h.x-f.x)*(f.y-d.y)-(h.y-f.y)*(f.x-d.x),x=(u.y-d.y)*(h.x-f.x)-(u.x-d.x)*(h.y-f.y);if(x!==0){var y=m/x,w=g/x;0<=y&&y<=1&&0<=w&&w<=1?(p=new c("Intersection"),p.appendPoint(new a.Point(f.x+y*(h.x-f.x),f.y+y*(h.y-f.y)))):p=new c}else m===0||g===0?p=new c("Coincident"):p=new c("Parallel");return p},a.Intersection.intersectLinePolygon=function(f,h,d){var u=new c,p=d.length,m,g,x,y;for(y=0;y<p;y++)m=d[y],g=d[(y+1)%p],x=c.intersectLineLine(f,h,m,g),u.appendPoints(x.points);return u.points.length>0&&(u.status="Intersection"),u},a.Intersection.intersectPolygonPolygon=function(f,h){var d=new c,u=f.length,p;for(p=0;p<u;p++){var m=f[p],g=f[(p+1)%u],x=c.intersectLinePolygon(m,g,h);d.appendPoints(x.points)}return d.points.length>0&&(d.status="Intersection"),d},a.Intersection.intersectPolygonRectangle=function(f,h,d){var u=h.min(d),p=h.max(d),m=new a.Point(p.x,u.y),g=new a.Point(u.x,p.y),x=c.intersectLinePolygon(u,m,f),y=c.intersectLinePolygon(m,p,f),w=c.intersectLinePolygon(p,g,f),b=c.intersectLinePolygon(g,u,f),S=new c;return S.appendPoints(x.points),S.appendPoints(y.points),S.appendPoints(w.points),S.appendPoints(b.points),S.points.length>0&&(S.status="Intersection"),S}}(e),function(o){var a=o.fabric||(o.fabric={});if(a.Color){a.warn("fabric.Color is already defined.");return}function c(h){h?this._tryParsingColor(h):this.setSource([0,0,0,1])}a.Color=c,a.Color.prototype={_tryParsingColor:function(h){var d;h in c.colorNameMap&&(h=c.colorNameMap[h]),h==="transparent"&&(d=[255,255,255,0]),d||(d=c.sourceFromHex(h)),d||(d=c.sourceFromRgb(h)),d||(d=c.sourceFromHsl(h)),d||(d=[0,0,0,1]),d&&this.setSource(d)},_rgbToHsl:function(h,d,u){h/=255,d/=255,u/=255;var p,m,g,x=a.util.array.max([h,d,u]),y=a.util.array.min([h,d,u]);if(g=(x+y)/2,x===y)p=m=0;else{var w=x-y;switch(m=g>.5?w/(2-x-y):w/(x+y),x){case h:p=(d-u)/w+(d<u?6:0);break;case d:p=(u-h)/w+2;break;case u:p=(h-d)/w+4;break}p/=6}return[Math.round(p*360),Math.round(m*100),Math.round(g*100)]},getSource:function(){return this._source},setSource:function(h){this._source=h},toRgb:function(){var h=this.getSource();return"rgb("+h[0]+","+h[1]+","+h[2]+")"},toRgba:function(){var h=this.getSource();return"rgba("+h[0]+","+h[1]+","+h[2]+","+h[3]+")"},toHsl:function(){var h=this.getSource(),d=this._rgbToHsl(h[0],h[1],h[2]);return"hsl("+d[0]+","+d[1]+"%,"+d[2]+"%)"},toHsla:function(){var h=this.getSource(),d=this._rgbToHsl(h[0],h[1],h[2]);return"hsla("+d[0]+","+d[1]+"%,"+d[2]+"%,"+h[3]+")"},toHex:function(){var h=this.getSource(),d,u,p;return d=h[0].toString(16),d=d.length===1?"0"+d:d,u=h[1].toString(16),u=u.length===1?"0"+u:u,p=h[2].toString(16),p=p.length===1?"0"+p:p,d.toUpperCase()+u.toUpperCase()+p.toUpperCase()},toHexa:function(){var h=this.getSource(),d;return d=Math.round(h[3]*255),d=d.toString(16),d=d.length===1?"0"+d:d,this.toHex()+d.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(h){var d=this.getSource();return d[3]=h,this.setSource(d),this},toGrayscale:function(){var h=this.getSource(),d=parseInt((h[0]*.3+h[1]*.59+h[2]*.11).toFixed(0),10),u=h[3];return this.setSource([d,d,d,u]),this},toBlackWhite:function(h){var d=this.getSource(),u=(d[0]*.3+d[1]*.59+d[2]*.11).toFixed(0),p=d[3];return h=h||127,u=Number(u)<Number(h)?0:255,this.setSource([u,u,u,p]),this},overlayWith:function(h){h instanceof c||(h=new c(h));var d=[],u=this.getAlpha(),p=.5,m=this.getSource(),g=h.getSource(),x;for(x=0;x<3;x++)d.push(Math.round(m[x]*(1-p)+g[x]*p));return d[3]=u,this.setSource(d),this}},a.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,a.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,a.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,a.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function f(h,d,u){return u<0&&(u+=1),u>1&&(u-=1),u<1/6?h+(d-h)*6*u:u<1/2?d:u<2/3?h+(d-h)*(2/3-u)*6:h}a.Color.fromRgb=function(h){return c.fromSource(c.sourceFromRgb(h))},a.Color.sourceFromRgb=function(h){var d=h.match(c.reRGBa);if(d){var u=parseInt(d[1],10)/(/%$/.test(d[1])?100:1)*(/%$/.test(d[1])?255:1),p=parseInt(d[2],10)/(/%$/.test(d[2])?100:1)*(/%$/.test(d[2])?255:1),m=parseInt(d[3],10)/(/%$/.test(d[3])?100:1)*(/%$/.test(d[3])?255:1);return[parseInt(u,10),parseInt(p,10),parseInt(m,10),d[4]?parseFloat(d[4]):1]}},a.Color.fromRgba=c.fromRgb,a.Color.fromHsl=function(h){return c.fromSource(c.sourceFromHsl(h))},a.Color.sourceFromHsl=function(h){var d=h.match(c.reHSLa);if(d){var u=(parseFloat(d[1])%360+360)%360/360,p=parseFloat(d[2])/(/%$/.test(d[2])?100:1),m=parseFloat(d[3])/(/%$/.test(d[3])?100:1),g,x,y;if(p===0)g=x=y=m;else{var w=m<=.5?m*(p+1):m+p-m*p,b=m*2-w;g=f(b,w,u+1/3),x=f(b,w,u),y=f(b,w,u-1/3)}return[Math.round(g*255),Math.round(x*255),Math.round(y*255),d[4]?parseFloat(d[4]):1]}},a.Color.fromHsla=c.fromHsl,a.Color.fromHex=function(h){return c.fromSource(c.sourceFromHex(h))},a.Color.sourceFromHex=function(h){if(h.match(c.reHex)){var d=h.slice(h.indexOf("#")+1),u=d.length===3||d.length===4,p=d.length===8||d.length===4,m=u?d.charAt(0)+d.charAt(0):d.substring(0,2),g=u?d.charAt(1)+d.charAt(1):d.substring(2,4),x=u?d.charAt(2)+d.charAt(2):d.substring(4,6),y=p?u?d.charAt(3)+d.charAt(3):d.substring(6,8):"FF";return[parseInt(m,16),parseInt(g,16),parseInt(x,16),parseFloat((parseInt(y,16)/255).toFixed(2))]}},a.Color.fromSource=function(h){var d=new c;return d.setSource(h),d}}(e),function(o){var a=o.fabric||(o.fabric={}),c=["e","se","s","sw","w","nw","n","ne","e"],f=["ns","nesw","ew","nwse"],h={},d="left",u="top",p="right",m="bottom",g="center",x={top:m,bottom:u,left:p,right:d,center:g},y=a.util.radiansToDegrees,w=Math.sign||function(re){return(re>0)-(re<0)||+re};function b(re,se){var z=re.angle+y(Math.atan2(se.y,se.x))+360;return Math.round(z%360/45)}function S(re,se){var z=se.transform.target,oe=z.canvas,ce=a.util.object.clone(se);ce.target=z,oe&&oe.fire("object:"+re,ce),z.fire(re,se)}function T(re,se){var z=se.canvas,oe=z.uniScaleKey,ce=re[oe];return z.uniformScaling&&!ce||!z.uniformScaling&&ce}function O(re){return re.originX===g&&re.originY===g}function j(re,se,z){var oe=re.lockScalingX,ce=re.lockScalingY;return!!(oe&&ce||!se&&(oe||ce)&&z||oe&&se==="x"||ce&&se==="y")}function L(re,se,z){var oe="not-allowed",ce=T(re,z),we="";if(se.x!==0&&se.y===0?we="x":se.x===0&&se.y!==0&&(we="y"),j(z,we,ce))return oe;var ye=b(z,se);return c[ye]+"-resize"}function W(re,se,z){var oe="not-allowed";if(se.x!==0&&z.lockSkewingY||se.y!==0&&z.lockSkewingX)return oe;var ce=b(z,se)%4;return f[ce]+"-resize"}function F(re,se,z){return re[z.canvas.altActionKey]?h.skewCursorStyleHandler(re,se,z):h.scaleCursorStyleHandler(re,se,z)}function M(re,se,z){var oe=re[z.canvas.altActionKey];if(se.x===0)return oe?"skewX":"scaleY";if(se.y===0)return oe?"skewY":"scaleX"}function V(re,se,z){return z.lockRotation?"not-allowed":se.cursorStyle}function G(re,se,z,oe){return{e:re,transform:se,pointer:{x:z,y:oe}}}function te(re){return function(se,z,oe,ce){var we=z.target,ye=we.getCenterPoint(),de=we.translateToOriginPoint(ye,z.originX,z.originY),Te=re(se,z,oe,ce);return we.setPositionByOrigin(de,z.originX,z.originY),Te}}function ee(re,se){return function(z,oe,ce,we){var ye=se(z,oe,ce,we);return ye&&S(re,G(z,oe,ce,we)),ye}}function Q(re,se,z,oe,ce){var we=re.target,ye=we.controls[re.corner],de=we.canvas.getZoom(),Te=we.padding/de,pe=we.toLocalPoint(new a.Point(oe,ce),se,z);return pe.x>=Te&&(pe.x-=Te),pe.x<=-Te&&(pe.x+=Te),pe.y>=Te&&(pe.y-=Te),pe.y<=Te&&(pe.y+=Te),pe.x-=ye.offsetX,pe.y-=ye.offsetY,pe}function K(re){return re.flipX!==re.flipY}function N(re,se,z,oe,ce){if(re[se]!==0){var we=re._getTransformedDimensions()[oe],ye=ce/we*re[z];re.set(z,ye)}}function U(re,se,z,oe){var ce=se.target,we=ce._getTransformedDimensions(0,ce.skewY),ye=Q(se,se.originX,se.originY,z,oe),de=Math.abs(ye.x*2)-we.x,Te=ce.skewX,pe;de<2?pe=0:(pe=y(Math.atan2(de/ce.scaleX,we.y/ce.scaleY)),se.originX===d&&se.originY===m&&(pe=-pe),se.originX===p&&se.originY===u&&(pe=-pe),K(ce)&&(pe=-pe));var Ae=Te!==pe;if(Ae){var Ie=ce._getTransformedDimensions().y;ce.set("skewX",pe),N(ce,"skewY","scaleY","y",Ie)}return Ae}function R(re,se,z,oe){var ce=se.target,we=ce._getTransformedDimensions(ce.skewX,0),ye=Q(se,se.originX,se.originY,z,oe),de=Math.abs(ye.y*2)-we.y,Te=ce.skewY,pe;de<2?pe=0:(pe=y(Math.atan2(de/ce.scaleY,we.x/ce.scaleX)),se.originX===d&&se.originY===m&&(pe=-pe),se.originX===p&&se.originY===u&&(pe=-pe),K(ce)&&(pe=-pe));var Ae=Te!==pe;if(Ae){var Ie=ce._getTransformedDimensions().x;ce.set("skewY",pe),N(ce,"skewX","scaleX","x",Ie)}return Ae}function k(re,se,z,oe){var ce=se.target,we=ce.skewX,ye,de=se.originY;if(ce.lockSkewingX)return!1;if(we===0){var Te=Q(se,g,g,z,oe);Te.x>0?ye=d:ye=p}else we>0&&(ye=de===u?d:p),we<0&&(ye=de===u?p:d),K(ce)&&(ye=ye===d?p:d);se.originX=ye;var pe=ee("skewing",te(U));return pe(re,se,z,oe)}function P(re,se,z,oe){var ce=se.target,we=ce.skewY,ye,de=se.originX;if(ce.lockSkewingY)return!1;if(we===0){var Te=Q(se,g,g,z,oe);Te.y>0?ye=u:ye=m}else we>0&&(ye=de===d?u:m),we<0&&(ye=de===d?m:u),K(ce)&&(ye=ye===u?m:u);se.originY=ye;var pe=ee("skewing",te(R));return pe(re,se,z,oe)}function A(re,se,z,oe){var ce=se,we=ce.target,ye=we.translateToOriginPoint(we.getCenterPoint(),ce.originX,ce.originY);if(we.lockRotation)return!1;var de=Math.atan2(ce.ey-ye.y,ce.ex-ye.x),Te=Math.atan2(oe-ye.y,z-ye.x),pe=y(Te-de+ce.theta),Ae=!0;if(we.snapAngle>0){var Ie=we.snapAngle,je=we.snapThreshold||Ie,Le=Math.ceil(pe/Ie)*Ie,Xe=Math.floor(pe/Ie)*Ie;Math.abs(pe-Xe)<je?pe=Xe:Math.abs(pe-Le)<je&&(pe=Le)}return pe<0&&(pe=360+pe),pe%=360,Ae=we.angle!==pe,we.angle=pe,Ae}function E(re,se,z,oe,ce){ce=ce||{};var we=se.target,ye=we.lockScalingX,de=we.lockScalingY,Te=ce.by,pe,Ae,Ie,je,Le=T(re,we),Xe=j(we,Te,Le),Je,Ne,Oe=se.gestureScale;if(Xe)return!1;if(Oe)Ae=se.scaleX*Oe,Ie=se.scaleY*Oe;else{if(pe=Q(se,se.originX,se.originY,z,oe),Je=Te!=="y"?w(pe.x):1,Ne=Te!=="x"?w(pe.y):1,se.signX||(se.signX=Je),se.signY||(se.signY=Ne),we.lockScalingFlip&&(se.signX!==Je||se.signY!==Ne))return!1;if(je=we._getTransformedDimensions(),Le&&!Te){var De=Math.abs(pe.x)+Math.abs(pe.y),Ye=se.original,it=Math.abs(je.x*Ye.scaleX/we.scaleX)+Math.abs(je.y*Ye.scaleY/we.scaleY),Ke=De/it;Ae=Ye.scaleX*Ke,Ie=Ye.scaleY*Ke}else Ae=Math.abs(pe.x*we.scaleX/je.x),Ie=Math.abs(pe.y*we.scaleY/je.y);O(se)&&(Ae*=2,Ie*=2),se.signX!==Je&&Te!=="y"&&(se.originX=x[se.originX],Ae*=-1,se.signX=Je),se.signY!==Ne&&Te!=="x"&&(se.originY=x[se.originY],Ie*=-1,se.signY=Ne)}var et=we.scaleX,Ge=we.scaleY;return Te?(Te==="x"&&we.set("scaleX",Ae),Te==="y"&&we.set("scaleY",Ie)):(!ye&&we.set("scaleX",Ae),!de&&we.set("scaleY",Ie)),et!==we.scaleX||Ge!==we.scaleY}function I(re,se,z,oe){return E(re,se,z,oe)}function H(re,se,z,oe){return E(re,se,z,oe,{by:"x"})}function J(re,se,z,oe){return E(re,se,z,oe,{by:"y"})}function Y(re,se,z,oe){return re[se.target.canvas.altActionKey]?h.skewHandlerX(re,se,z,oe):h.scalingY(re,se,z,oe)}function Z(re,se,z,oe){return re[se.target.canvas.altActionKey]?h.skewHandlerY(re,se,z,oe):h.scalingX(re,se,z,oe)}function fe(re,se,z,oe){var ce=se.target,we=Q(se,se.originX,se.originY,z,oe),ye=ce.strokeWidth/(ce.strokeUniform?ce.scaleX:1),de=O(se)?2:1,Te=ce.width,pe=Math.abs(we.x*de/ce.scaleX)-ye;return ce.set("width",Math.max(pe,0)),Te!==pe}function X(re,se,z,oe){var ce=se.target,we=z-se.offsetX,ye=oe-se.offsetY,de=!ce.get("lockMovementX")&&ce.left!==we,Te=!ce.get("lockMovementY")&&ce.top!==ye;return de&&ce.set("left",we),Te&&ce.set("top",ye),(de||Te)&&S("moving",G(re,se,z,oe)),de||Te}h.scaleCursorStyleHandler=L,h.skewCursorStyleHandler=W,h.scaleSkewCursorStyleHandler=F,h.rotationWithSnapping=ee("rotating",te(A)),h.scalingEqually=ee("scaling",te(I)),h.scalingX=ee("scaling",te(H)),h.scalingY=ee("scaling",te(J)),h.scalingYOrSkewingX=Y,h.scalingXOrSkewingY=Z,h.changeWidth=ee("resizing",te(fe)),h.skewHandlerX=k,h.skewHandlerY=P,h.dragHandler=X,h.scaleOrSkewActionName=M,h.rotationStyleHandler=V,h.fireEvent=S,h.wrapWithFixedAnchor=te,h.wrapWithFireEvent=ee,h.getLocalPoint=Q,a.controlsUtils=h}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.degreesToRadians,f=a.controlsUtils;function h(u,p,m,g,x){g=g||{};var y=this.sizeX||g.cornerSize||x.cornerSize,w=this.sizeY||g.cornerSize||x.cornerSize,b=typeof g.transparentCorners<"u"?g.transparentCorners:x.transparentCorners,S=b?"stroke":"fill",T=!b&&(g.cornerStrokeColor||x.cornerStrokeColor),O=p,j=m,L;u.save(),u.fillStyle=g.cornerColor||x.cornerColor,u.strokeStyle=g.cornerStrokeColor||x.cornerStrokeColor,y>w?(L=y,u.scale(1,w/y),j=m*y/w):w>y?(L=w,u.scale(y/w,1),O=p*w/y):L=y,u.lineWidth=1,u.beginPath(),u.arc(O,j,L/2,0,2*Math.PI,!1),u[S](),T&&u.stroke(),u.restore()}function d(u,p,m,g,x){g=g||{};var y=this.sizeX||g.cornerSize||x.cornerSize,w=this.sizeY||g.cornerSize||x.cornerSize,b=typeof g.transparentCorners<"u"?g.transparentCorners:x.transparentCorners,S=b?"stroke":"fill",T=!b&&(g.cornerStrokeColor||x.cornerStrokeColor),O=y/2,j=w/2;u.save(),u.fillStyle=g.cornerColor||x.cornerColor,u.strokeStyle=g.cornerStrokeColor||x.cornerStrokeColor,u.lineWidth=1,u.translate(p,m),u.rotate(c(x.angle)),u[S+"Rect"](-O,-j,y,w),T&&u.strokeRect(-O,-j,y,w),u.restore()}f.renderCircleControl=h,f.renderSquareControl=d}(e),function(o){var a=o.fabric||(o.fabric={});function c(f){for(var h in f)this[h]=f[h]}a.Control=c,a.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(f,h){return h.cursorStyle},getActionName:function(f,h){return h.actionName},getVisibility:function(f,h){var d=f._controlsVisibility;return d&&typeof d[h]<"u"?d[h]:this.visible},setVisibility:function(f){this.visible=f},positionHandler:function(f,h){var d=a.util.transformPoint({x:this.x*f.x+this.offsetX,y:this.y*f.y+this.offsetY},h);return d},calcCornerCoords:function(f,h,d,u,p){var m,g,x,y,w=p?this.touchSizeX:this.sizeX,b=p?this.touchSizeY:this.sizeY;if(w&&b&&w!==b){var S=Math.atan2(b,w),T=Math.sqrt(w*w+b*b)/2,O=S-a.util.degreesToRadians(f),j=Math.PI/2-S-a.util.degreesToRadians(f);m=T*a.util.cos(O),g=T*a.util.sin(O),x=T*a.util.cos(j),y=T*a.util.sin(j)}else{var L=w&&b?w:h;T=L*.7071067812;var O=a.util.degreesToRadians(45-f);m=x=T*a.util.cos(O),g=y=T*a.util.sin(O)}return{tl:{x:d-y,y:u-x},tr:{x:d+m,y:u-g},bl:{x:d-m,y:u+g},br:{x:d+y,y:u+x}}},render:function(f,h,d,u,p){switch(u=u||{},u.cornerStyle||p.cornerStyle){case"circle":a.controlsUtils.renderCircleControl.call(this,f,h,d,u,p);break;default:a.controlsUtils.renderSquareControl.call(this,f,h,d,u,p)}}}}(e),function(){function o(d,u){var p=d.getAttribute("style"),m=d.getAttribute("offset")||0,g,x,y,w;if(m=parseFloat(m)/(/%$/.test(m)?100:1),m=m<0?0:m>1?1:m,p){var b=p.split(/\s*;\s*/);for(b[b.length-1]===""&&b.pop(),w=b.length;w--;){var S=b[w].split(/\s*:\s*/),T=S[0].trim(),O=S[1].trim();T==="stop-color"?g=O:T==="stop-opacity"&&(y=O)}}return g||(g=d.getAttribute("stop-color")||"rgb(0,0,0)"),y||(y=d.getAttribute("stop-opacity")),g=new t.Color(g),x=g.getAlpha(),y=isNaN(parseFloat(y))?1:parseFloat(y),y*=x*u,{offset:m,color:g.toRgb(),opacity:y}}function a(d){return{x1:d.getAttribute("x1")||0,y1:d.getAttribute("y1")||0,x2:d.getAttribute("x2")||"100%",y2:d.getAttribute("y2")||0}}function c(d){return{x1:d.getAttribute("fx")||d.getAttribute("cx")||"50%",y1:d.getAttribute("fy")||d.getAttribute("cy")||"50%",r1:0,x2:d.getAttribute("cx")||"50%",y2:d.getAttribute("cy")||"50%",r2:d.getAttribute("r")||"50%"}}var f=t.util.object.clone;t.Gradient=t.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(d){d||(d={}),d.coords||(d.coords={});var u,p=this;Object.keys(d).forEach(function(m){p[m]=d[m]}),this.id?this.id+="_"+t.Object.__uid++:this.id=t.Object.__uid++,u={x1:d.coords.x1||0,y1:d.coords.y1||0,x2:d.coords.x2||0,y2:d.coords.y2||0},this.type==="radial"&&(u.r1=d.coords.r1||0,u.r2=d.coords.r2||0),this.coords=u,this.colorStops=d.colorStops.slice()},addColorStop:function(d){for(var u in d){var p=new t.Color(d[u]);this.colorStops.push({offset:parseFloat(u),color:p.toRgb(),opacity:p.getAlpha()})}return this},toObject:function(d){var u={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return t.util.populateWithProperties(this,u,d),u},toSVG:function(d,x){var p=f(this.coords,!0),m,g,x=x||{},y,w,b=f(this.colorStops,!0),S=p.r1>p.r2,T=this.gradientTransform?this.gradientTransform.concat():t.iMatrix.concat(),O=-this.offsetX,j=-this.offsetY,L=!!x.additionalTransform,W=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(b.sort(function(te,ee){return te.offset-ee.offset}),W==="objectBoundingBox"?(O/=d.width,j/=d.height):(O+=d.width/2,j+=d.height/2),d.type==="path"&&this.gradientUnits!=="percentage"&&(O-=d.pathOffset.x,j-=d.pathOffset.y),T[4]-=O,T[5]-=j,w='id="SVGID_'+this.id+'" gradientUnits="'+W+'"',w+=' gradientTransform="'+(L?x.additionalTransform+" ":"")+t.util.matrixToSVG(T)+'" ',this.type==="linear"?y=["<linearGradient ",w,' x1="',p.x1,'" y1="',p.y1,'" x2="',p.x2,'" y2="',p.y2,`">
`]:this.type==="radial"&&(y=["<radialGradient ",w,' cx="',S?p.x1:p.x2,'" cy="',S?p.y1:p.y2,'" r="',S?p.r1:p.r2,'" fx="',S?p.x2:p.x1,'" fy="',S?p.y2:p.y1,`">
`]),this.type==="radial"){if(S)for(b=b.concat(),b.reverse(),m=0,g=b.length;m<g;m++)b[m].offset=1-b[m].offset;var F=Math.min(p.r1,p.r2);if(F>0){var M=Math.max(p.r1,p.r2),V=F/M;for(m=0,g=b.length;m<g;m++)b[m].offset+=V*(1-b[m].offset)}}for(m=0,g=b.length;m<g;m++){var G=b[m];y.push("<stop ",'offset="',G.offset*100+"%",'" style="stop-color:',G.color,typeof G.opacity<"u"?";stop-opacity: "+G.opacity:";",`"/>
`)}return y.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),y.join("")},toLive:function(d){var u,p=t.util.object.clone(this.coords),m,g;if(this.type){for(this.type==="linear"?u=d.createLinearGradient(p.x1,p.y1,p.x2,p.y2):this.type==="radial"&&(u=d.createRadialGradient(p.x1,p.y1,p.r1,p.x2,p.y2,p.r2)),m=0,g=this.colorStops.length;m<g;m++){var x=this.colorStops[m].color,y=this.colorStops[m].opacity,w=this.colorStops[m].offset;typeof y<"u"&&(x=new t.Color(x).setAlpha(y).toRgba()),u.addColorStop(w,x)}return u}}}),t.util.object.extend(t.Gradient,{fromElement:function(d,u,p,m){var g=parseFloat(p)/(/%$/.test(p)?100:1);g=g<0?0:g>1?1:g,isNaN(g)&&(g=1);var x=d.getElementsByTagName("stop"),y,w=d.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",b=d.getAttribute("gradientTransform")||"",S=[],T,O,j=0,L=0,W;for(d.nodeName==="linearGradient"||d.nodeName==="LINEARGRADIENT"?(y="linear",T=a(d)):(y="radial",T=c(d)),O=x.length;O--;)S.push(o(x[O],g));W=t.parseTransformAttribute(b),h(u,T,m,w),w==="pixels"&&(j=-u.left,L=-u.top);var F=new t.Gradient({id:d.getAttribute("id"),type:y,coords:T,colorStops:S,gradientUnits:w,gradientTransform:W,offsetX:j,offsetY:L});return F}});function h(d,u,p,m){var g,x;Object.keys(u).forEach(function(y){g=u[y],g==="Infinity"?x=1:g==="-Infinity"?x=0:(x=parseFloat(u[y],10),typeof g=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(g)&&(x*=.01,m==="pixels"&&((y==="x1"||y==="x2"||y==="r2")&&(x*=p.viewBoxWidth||p.width),(y==="y1"||y==="y2")&&(x*=p.viewBoxHeight||p.height)))),u[y]=x})}}(),function(){var o=t.util.toFixed;t.Pattern=t.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(a,c){if(a||(a={}),this.id=t.Object.__uid++,this.setOptions(a),!a.source||a.source&&typeof a.source!="string"){c&&c(this);return}else{var f=this;this.source=t.util.createImage(),t.util.loadImage(a.source,function(h,d){f.source=h,c&&c(f,d)},null,this.crossOrigin)}},toObject:function(a){var c=t.Object.NUM_FRACTION_DIGITS,f,h;return typeof this.source.src=="string"?f=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(f=this.source.toDataURL()),h={type:"pattern",source:f,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:o(this.offsetX,c),offsetY:o(this.offsetY,c),patternTransform:this.patternTransform?this.patternTransform.concat():null},t.util.populateWithProperties(this,h,a),h},toSVG:function(a){var c=typeof this.source=="function"?this.source():this.source,f=c.width/a.width,h=c.height/a.height,d=this.offsetX/a.width,u=this.offsetY/a.height,p="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(h=1,u&&(h+=Math.abs(u))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(f=1,d&&(f+=Math.abs(d))),c.src?p=c.src:c.toDataURL&&(p=c.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+d+'" y="'+u+'" width="'+f+'" height="'+h+`">
<image x="0" y="0" width="`+c.width+'" height="'+c.height+'" xlink:href="'+p+`"></image>
</pattern>
`},setOptions:function(a){for(var c in a)this[c]=a[c]},toLive:function(a){var c=this.source;return!c||typeof c.src<"u"&&(!c.complete||c.naturalWidth===0||c.naturalHeight===0)?"":a.createPattern(c,this.repeat)}})}(),function(o){var a=o.fabric||(o.fabric={}),c=a.util.toFixed;if(a.Shadow){a.warn("fabric.Shadow is already defined.");return}a.Shadow=a.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(f){typeof f=="string"&&(f=this._parseShadow(f));for(var h in f)this[h]=f[h];this.id=a.Object.__uid++},_parseShadow:function(f){var h=f.trim(),d=a.Shadow.reOffsetsAndBlur.exec(h)||[],u=h.replace(a.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:u.trim(),offsetX:parseFloat(d[1],10)||0,offsetY:parseFloat(d[2],10)||0,blur:parseFloat(d[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(f){var h=40,d=40,u=a.Object.NUM_FRACTION_DIGITS,p=a.util.rotateVector({x:this.offsetX,y:this.offsetY},a.util.degreesToRadians(-f.angle)),m=20,g=new a.Color(this.color);return f.width&&f.height&&(h=c((Math.abs(p.x)+this.blur)/f.width,u)*100+m,d=c((Math.abs(p.y)+this.blur)/f.height,u)*100+m),f.flipX&&(p.x*=-1),f.flipY&&(p.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+d+'%" height="'+(100+2*d)+'%" x="-'+h+'%" width="'+(100+2*h)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+c(this.blur?this.blur/2:0,u)+`"></feGaussianBlur>
	<feOffset dx="`+c(p.x,u)+'" dy="'+c(p.y,u)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+g.toRgb()+'" flood-opacity="'+g.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var f={},h=a.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(d){this[d]!==h[d]&&(f[d]=this[d])},this),f}}),a.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(e),function(){if(t.StaticCanvas){t.warn("fabric.StaticCanvas is already defined.");return}var o=t.util.object.extend,a=t.util.getElementOffset,c=t.util.removeFromArray,f=t.util.toFixed,h=t.util.transformPoint,d=t.util.invertTransform,u=t.util.getNodeCanvas,p=t.util.createCanvasElement,m=new Error("Could not initialize `canvas` element");t.StaticCanvas=t.util.createClass(t.CommonMethods,{initialize:function(g,x){x||(x={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(g,x)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:t.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(g,x){var y=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(g),this._initOptions(x),this.interactive||this._initRetinaScaling(),x.overlayImage&&this.setOverlayImage(x.overlayImage,y),x.backgroundImage&&this.setBackgroundImage(x.backgroundImage,y),x.backgroundColor&&this.setBackgroundColor(x.backgroundColor,y),x.overlayColor&&this.setOverlayColor(x.overlayColor,y),this.calcOffset()},_isRetinaScaling:function(){return t.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,t.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var g=t.devicePixelRatio;this.__initRetinaScaling(g,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(g,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(g,x,y){x.setAttribute("width",this.width*g),x.setAttribute("height",this.height*g),y.scale(g,g)},calcOffset:function(){return this._offset=a(this.lowerCanvasEl),this},setOverlayImage:function(g,x,y){return this.__setBgOverlayImage("overlayImage",g,x,y)},setBackgroundImage:function(g,x,y){return this.__setBgOverlayImage("backgroundImage",g,x,y)},setOverlayColor:function(g,x){return this.__setBgOverlayColor("overlayColor",g,x)},setBackgroundColor:function(g,x){return this.__setBgOverlayColor("backgroundColor",g,x)},__setBgOverlayImage:function(g,x,y,w){return typeof x=="string"?t.util.loadImage(x,function(b,S){if(b){var T=new t.Image(b,w);this[g]=T,T.canvas=this}y&&y(b,S)},this,w&&w.crossOrigin):(w&&x.setOptions(w),this[g]=x,x&&(x.canvas=this),y&&y(x,!1)),this},__setBgOverlayColor:function(g,x,y){return this[g]=x,this._initGradient(x,g),this._initPattern(x,g,y),this},_createCanvasElement:function(){var g=p();if(!g||(g.style||(g.style={}),typeof g.getContext>"u"))throw m;return g},_initOptions:function(g){var x=this.lowerCanvasEl;this._setOptions(g),this.width=this.width||parseInt(x.width,10)||0,this.height=this.height||parseInt(x.height,10)||0,this.lowerCanvasEl.style&&(x.width=this.width,x.height=this.height,x.style.width=this.width+"px",x.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(g){g&&g.getContext?this.lowerCanvasEl=g:this.lowerCanvasEl=t.util.getById(g)||this._createCanvasElement(),t.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(g,x){return this.setDimensions({width:g},x)},setHeight:function(g,x){return this.setDimensions({height:g},x)},setDimensions:function(g,x){var y;x=x||{};for(var w in g)y=g[w],x.cssOnly||(this._setBackstoreDimension(w,g[w]),y+="px",this.hasLostContext=!0),x.backstoreOnly||this._setCssDimension(w,y);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),x.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(g,x){return this.lowerCanvasEl[g]=x,this.upperCanvasEl&&(this.upperCanvasEl[g]=x),this.cacheCanvasEl&&(this.cacheCanvasEl[g]=x),this[g]=x,this},_setCssDimension:function(g,x){return this.lowerCanvasEl.style[g]=x,this.upperCanvasEl&&(this.upperCanvasEl.style[g]=x),this.wrapperEl&&(this.wrapperEl.style[g]=x),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(g){var x=this._activeObject,y=this.backgroundImage,w=this.overlayImage,b,S,T;for(this.viewportTransform=g,S=0,T=this._objects.length;S<T;S++)b=this._objects[S],b.group||b.setCoords(!0);return x&&x.setCoords(),y&&y.setCoords(!0),w&&w.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(g,x){var y=g,w=this.viewportTransform.slice(0);g=h(g,d(this.viewportTransform)),w[0]=x,w[3]=x;var b=h(g,w);return w[4]+=y.x-b.x,w[5]+=y.y-b.y,this.setViewportTransform(w)},setZoom:function(g){return this.zoomToPoint(new t.Point(0,0),g),this},absolutePan:function(g){var x=this.viewportTransform.slice(0);return x[4]=-g.x,x[5]=-g.y,this.setViewportTransform(x)},relativePan:function(g){return this.absolutePan(new t.Point(-g.x-this.viewportTransform[4],-g.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(g){this.stateful&&g.setupState(),g._set("canvas",this),g.setCoords(),this.fire("object:added",{target:g}),g.fire("added")},_onObjectRemoved:function(g){this.fire("object:removed",{target:g}),g.fire("removed"),delete g.canvas},clearContext:function(g){return g.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var g=this.contextContainer;return this.renderCanvas(g,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=t.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var g={},x=this.width,y=this.height,w=d(this.viewportTransform);return g.tl=h({x:0,y:0},w),g.br=h({x,y},w),g.tr=new t.Point(g.br.x,g.tl.y),g.bl=new t.Point(g.tl.x,g.br.y),this.vptCoords=g,g},cancelRequestedRender:function(){this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(g,x){var y=this.viewportTransform,w=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(g),t.util.setImageSmoothing(g,this.imageSmoothingEnabled),this.fire("before:render",{ctx:g}),this._renderBackground(g),g.save(),g.transform(y[0],y[1],y[2],y[3],y[4],y[5]),this._renderObjects(g,x),g.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(g),w&&(w.canvas=this,w.shouldCache(),w._transformDone=!0,w.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(g)),this._renderOverlay(g),this.controlsAboveOverlay&&this.interactive&&this.drawControls(g),this.fire("after:render",{ctx:g})},drawClipPathOnCanvas:function(g){var x=this.viewportTransform,y=this.clipPath;g.save(),g.transform(x[0],x[1],x[2],x[3],x[4],x[5]),g.globalCompositeOperation="destination-in",y.transform(g),g.scale(1/y.zoomX,1/y.zoomY),g.drawImage(y._cacheCanvas,-y.cacheTranslationX,-y.cacheTranslationY),g.restore()},_renderObjects:function(g,x){var y,w;for(y=0,w=x.length;y<w;++y)x[y]&&x[y].render(g)},_renderBackgroundOrOverlay:function(g,x){var y=this[x+"Color"],w=this[x+"Image"],b=this.viewportTransform,S=this[x+"Vpt"];if(!(!y&&!w)){if(y){g.save(),g.beginPath(),g.moveTo(0,0),g.lineTo(this.width,0),g.lineTo(this.width,this.height),g.lineTo(0,this.height),g.closePath(),g.fillStyle=y.toLive?y.toLive(g,this):y,S&&g.transform(b[0],b[1],b[2],b[3],b[4],b[5]),g.transform(1,0,0,1,y.offsetX||0,y.offsetY||0);var T=y.gradientTransform||y.patternTransform;T&&g.transform(T[0],T[1],T[2],T[3],T[4],T[5]),g.fill(),g.restore()}if(w){g.save();var O=this.skipOffscreen;this.skipOffscreen=S,S&&g.transform(b[0],b[1],b[2],b[3],b[4],b[5]),w.render(g),this.skipOffscreen=O,g.restore()}}},_renderBackground:function(g){this._renderBackgroundOrOverlay(g,"background")},_renderOverlay:function(g){this._renderBackgroundOrOverlay(g,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new t.Point(this.width/2,this.height/2)},centerObjectH:function(g){return this._centerObject(g,new t.Point(this.getCenterPoint().x,g.getCenterPoint().y))},centerObjectV:function(g){return this._centerObject(g,new t.Point(g.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(g){var x=this.getCenterPoint();return this._centerObject(g,x)},viewportCenterObject:function(g){var x=this.getVpCenter();return this._centerObject(g,x)},viewportCenterObjectH:function(g){var x=this.getVpCenter();return this._centerObject(g,new t.Point(x.x,g.getCenterPoint().y)),this},viewportCenterObjectV:function(g){var x=this.getVpCenter();return this._centerObject(g,new t.Point(g.getCenterPoint().x,x.y))},getVpCenter:function(){var g=this.getCenterPoint(),x=d(this.viewportTransform);return h(g,x)},_centerObject:function(g,x){return g.setPositionByOrigin(x,"center","center"),g.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(g){return this.toDatalessObject(g)},toObject:function(g){return this._toObjectMethod("toObject",g)},toDatalessObject:function(g){return this._toObjectMethod("toDatalessObject",g)},_toObjectMethod:function(g,x){var y=this.clipPath,w={version:t.version,objects:this._toObjects(g,x)};return y&&!y.excludeFromExport&&(w.clipPath=this._toObject(this.clipPath,g,x)),o(w,this.__serializeBgOverlay(g,x)),t.util.populateWithProperties(this,w,x),w},_toObjects:function(g,x){return this._objects.filter(function(y){return!y.excludeFromExport}).map(function(y){return this._toObject(y,g,x)},this)},_toObject:function(g,x,y){var w;this.includeDefaultValues||(w=g.includeDefaultValues,g.includeDefaultValues=!1);var b=g[x](y);return this.includeDefaultValues||(g.includeDefaultValues=w),b},__serializeBgOverlay:function(g,x){var y={},w=this.backgroundImage,b=this.overlayImage,S=this.backgroundColor,T=this.overlayColor;return S&&S.toObject?S.excludeFromExport||(y.background=S.toObject(x)):S&&(y.background=S),T&&T.toObject?T.excludeFromExport||(y.overlay=T.toObject(x)):T&&(y.overlay=T),w&&!w.excludeFromExport&&(y.backgroundImage=this._toObject(w,g,x)),b&&!b.excludeFromExport&&(y.overlayImage=this._toObject(b,g,x)),y},svgViewportTransformation:!0,toSVG:function(g,x){g||(g={}),g.reviver=x;var y=[];return this._setSVGPreamble(y,g),this._setSVGHeader(y,g),this.clipPath&&y.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(y,"background"),this._setSVGBgOverlayImage(y,"backgroundImage",x),this._setSVGObjects(y,x),this.clipPath&&y.push(`</g>
`),this._setSVGBgOverlayColor(y,"overlay"),this._setSVGBgOverlayImage(y,"overlayImage",x),y.push("</svg>"),y.join("")},_setSVGPreamble:function(g,x){x.suppressPreamble||g.push('<?xml version="1.0" encoding="',x.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(g,x){var y=x.width||this.width,w=x.height||this.height,b,S='viewBox="0 0 '+this.width+" "+this.height+'" ',T=t.Object.NUM_FRACTION_DIGITS;x.viewBox?S='viewBox="'+x.viewBox.x+" "+x.viewBox.y+" "+x.viewBox.width+" "+x.viewBox.height+'" ':this.svgViewportTransformation&&(b=this.viewportTransform,S='viewBox="'+f(-b[4]/b[0],T)+" "+f(-b[5]/b[3],T)+" "+f(this.width/b[0],T)+" "+f(this.height/b[3],T)+'" '),g.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',y,'" ','height="',w,'" ',S,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",t.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(x),`</defs>
`)},createSVGClipPathMarkup:function(g){var x=this.clipPath;return x?(x.clipPathId="CLIPPATH_"+t.Object.__uid++,'<clipPath id="'+x.clipPathId+`" >
`+this.clipPath.toClipPathSVG(g.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var g=this,x=["background","overlay"].map(function(y){var w=g[y+"Color"];if(w&&w.toLive){var b=g[y+"Vpt"],S=g.viewportTransform,T={width:g.width/(b?S[0]:1),height:g.height/(b?S[3]:1)};return w.toSVG(T,{additionalTransform:b?t.util.matrixToSVG(S):""})}});return x.join("")},createSVGFontFacesMarkup:function(){var g="",x={},y,w,b,S,T,O,j,L,W,F=t.fontPaths,M=[];for(this._objects.forEach(function G(te){M.push(te),te._objects&&te._objects.forEach(G)}),L=0,W=M.length;L<W;L++)if(y=M[L],w=y.fontFamily,!(y.type.indexOf("text")===-1||x[w]||!F[w])&&(x[w]=!0,!!y.styles)){b=y.styles;for(T in b){S=b[T];for(j in S)O=S[j],w=O.fontFamily,!x[w]&&F[w]&&(x[w]=!0)}}for(var V in x)g+=[`		@font-face {
`,"			font-family: '",V,`';
`,"			src: url('",F[V],`');
`,`		}
`].join("");return g&&(g=['	<style type="text/css">',`<![CDATA[
`,g,"]]>",`</style>
`].join("")),g},_setSVGObjects:function(g,x){var y,w,b,S=this._objects;for(w=0,b=S.length;w<b;w++)y=S[w],!y.excludeFromExport&&this._setSVGObject(g,y,x)},_setSVGObject:function(g,x,y){g.push(x.toSVG(y))},_setSVGBgOverlayImage:function(g,x,y){this[x]&&!this[x].excludeFromExport&&this[x].toSVG&&g.push(this[x].toSVG(y))},_setSVGBgOverlayColor:function(g,x){var y=this[x+"Color"],w=this.viewportTransform,b=this.width,S=this.height;if(y)if(y.toLive){var T=y.repeat,O=t.util.invertTransform(w),j=this[x+"Vpt"],L=j?t.util.matrixToSVG(O):"";g.push('<rect transform="'+L+" translate(",b/2,",",S/2,')"',' x="',y.offsetX-b/2,'" y="',y.offsetY-S/2,'" ','width="',T==="repeat-y"||T==="no-repeat"?y.source.width:b,'" height="',T==="repeat-x"||T==="no-repeat"?y.source.height:S,'" fill="url(#SVGID_'+y.id+')"',`></rect>
`)}else g.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',y,'"',`></rect>
`)},sendToBack:function(g){if(!g)return this;var x=this._activeObject,y,w,b;if(g===x&&g.type==="activeSelection")for(b=x._objects,y=b.length;y--;)w=b[y],c(this._objects,w),this._objects.unshift(w);else c(this._objects,g),this._objects.unshift(g);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(g){if(!g)return this;var x=this._activeObject,y,w,b;if(g===x&&g.type==="activeSelection")for(b=x._objects,y=0;y<b.length;y++)w=b[y],c(this._objects,w),this._objects.push(w);else c(this._objects,g),this._objects.push(g);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(g,x){if(!g)return this;var y=this._activeObject,w,b,S,T,O,j=0;if(g===y&&g.type==="activeSelection")for(O=y._objects,w=0;w<O.length;w++)b=O[w],S=this._objects.indexOf(b),S>0+j&&(T=S-1,c(this._objects,b),this._objects.splice(T,0,b)),j++;else S=this._objects.indexOf(g),S!==0&&(T=this._findNewLowerIndex(g,S,x),c(this._objects,g),this._objects.splice(T,0,g));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(g,x,y){var w,b;if(y)for(w=x,b=x-1;b>=0;--b){var S=g.intersectsWithObject(this._objects[b])||g.isContainedWithinObject(this._objects[b])||this._objects[b].isContainedWithinObject(g);if(S){w=b;break}}else w=x-1;return w},bringForward:function(g,x){if(!g)return this;var y=this._activeObject,w,b,S,T,O,j=0;if(g===y&&g.type==="activeSelection")for(O=y._objects,w=O.length;w--;)b=O[w],S=this._objects.indexOf(b),S<this._objects.length-1-j&&(T=S+1,c(this._objects,b),this._objects.splice(T,0,b)),j++;else S=this._objects.indexOf(g),S!==this._objects.length-1&&(T=this._findNewUpperIndex(g,S,x),c(this._objects,g),this._objects.splice(T,0,g));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(g,x,y){var w,b,S;if(y)for(w=x,b=x+1,S=this._objects.length;b<S;++b){var T=g.intersectsWithObject(this._objects[b])||g.isContainedWithinObject(this._objects[b])||this._objects[b].isContainedWithinObject(g);if(T){w=b;break}}else w=x+1;return w},moveTo:function(g,x){return c(this._objects,g),this._objects.splice(x,0,g),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(g){g.dispose&&g.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),t.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),t.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),o(t.StaticCanvas.prototype,t.Observable),o(t.StaticCanvas.prototype,t.Collection),o(t.StaticCanvas.prototype,t.DataURLExporter),o(t.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(g){var x=p();if(!x||!x.getContext)return null;var y=x.getContext("2d");if(!y)return null;switch(g){case"setLineDash":return typeof y.setLineDash<"u";default:return null}}}),t.StaticCanvas.prototype.toJSON=t.StaticCanvas.prototype.toObject,t.isLikelyNode&&(t.StaticCanvas.prototype.createPNGStream=function(){var g=u(this.lowerCanvasEl);return g&&g.createPNGStream()},t.StaticCanvas.prototype.createJPEGStream=function(g){var x=u(this.lowerCanvasEl);return x&&x.createJPEGStream(g)})}(),t.BaseBrush=t.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(o){o.strokeStyle=this.color,o.lineWidth=this.width,o.lineCap=this.strokeLineCap,o.miterLimit=this.strokeMiterLimit,o.lineJoin=this.strokeLineJoin,o.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(o){var a=this.canvas.viewportTransform;o.save(),o.transform(a[0],a[1],a[2],a[3],a[4],a[5])},_setShadow:function(){if(this.shadow){var o=this.canvas,a=this.shadow,c=o.contextTop,f=o.getZoom();o&&o._isRetinaScaling()&&(f*=t.devicePixelRatio),c.shadowColor=a.color,c.shadowBlur=a.blur*f,c.shadowOffsetX=a.offsetX*f,c.shadowOffsetY=a.offsetY*f}},needsFullRender:function(){var o=new t.Color(this.color);return o.getAlpha()<1||!!this.shadow},_resetShadow:function(){var o=this.canvas.contextTop;o.shadowColor="",o.shadowBlur=o.shadowOffsetX=o.shadowOffsetY=0},_isOutSideCanvas:function(o){return o.x<0||o.x>this.canvas.getWidth()||o.y<0||o.y>this.canvas.getHeight()}}),function(){t.PencilBrush=t.util.createClass(t.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(o){this.canvas=o,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(o,a,c){var f=a.midPointFrom(c);return o.quadraticCurveTo(a.x,a.y,f.x,f.y),f},onMouseDown:function(o,a){this.canvas._isMainEvent(a.e)&&(this.drawStraightLine=a.e[this.straightLineKey],this._prepareForDrawing(o),this._captureDrawingPath(o),this._render())},onMouseMove:function(o,a){if(this.canvas._isMainEvent(a.e)&&(this.drawStraightLine=a.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o))&&this._captureDrawingPath(o)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var c=this._points,f=c.length,h=this.canvas.contextTop;this._saveAndTransform(h),this.oldEnd&&(h.beginPath(),h.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(h,c[f-2],c[f-1],!0),h.stroke(),h.restore()}},onMouseUp:function(o){return this.canvas._isMainEvent(o.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(o){var a=new t.Point(o.x,o.y);this._reset(),this._addPoint(a),this.canvas.contextTop.moveTo(a.x,a.y)},_addPoint:function(o){return this._points.length>1&&o.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(o),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(o){var a=new t.Point(o.x,o.y);return this._addPoint(a)},_render:function(o){var a,c,f=this._points[0],h=this._points[1];if(o=o||this.canvas.contextTop,this._saveAndTransform(o),o.beginPath(),this._points.length===2&&f.x===h.x&&f.y===h.y){var d=this.width/1e3;f=new t.Point(f.x,f.y),h=new t.Point(h.x,h.y),f.x-=d,h.x+=d}for(o.moveTo(f.x,f.y),a=1,c=this._points.length;a<c;a++)this._drawSegment(o,f,h),f=this._points[a],h=this._points[a+1];o.lineTo(f.x,f.y),o.stroke(),o.restore()},convertPointsToSVGPath:function(o){var a=this.width/1e3;return t.util.getSmoothPathFromPoints(o,a)},_isEmptySVGPath:function(o){var a=t.util.joinPath(o);return a==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(o){var a=new t.Path(o,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,a.shadow=new t.Shadow(this.shadow)),a},decimatePoints:function(o,a){if(o.length<=2)return o;var c=this.canvas.getZoom(),f=Math.pow(a/c,2),h,d=o.length-1,u=o[0],p=[u],m;for(h=1;h<d-1;h++)m=Math.pow(u.x-o[h].x,2)+Math.pow(u.y-o[h].y,2),m>=f&&(u=o[h],p.push(u));return p.push(o[d]),p},_finalizeAndAddPath:function(){var o=this.canvas.contextTop;o.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var a=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(a)){this.canvas.requestRenderAll();return}var c=this.createPath(a);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:c}),this.canvas.add(c),this.canvas.requestRenderAll(),c.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:c})}})}(),t.CircleBrush=t.util.createClass(t.BaseBrush,{width:10,initialize:function(o){this.canvas=o,this.points=[]},drawDot:function(o){var a=this.addPoint(o),c=this.canvas.contextTop;this._saveAndTransform(c),this.dot(c,a),c.restore()},dot:function(o,a){o.fillStyle=a.fill,o.beginPath(),o.arc(a.x,a.y,a.radius,0,Math.PI*2,!1),o.closePath(),o.fill()},onMouseDown:function(o){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(o)},_render:function(){var o=this.canvas.contextTop,a,c,f=this.points;for(this._saveAndTransform(o),a=0,c=f.length;a<c;a++)this.dot(o,f[a]);o.restore()},onMouseMove:function(o){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(o),this._render()):this.drawDot(o))},onMouseUp:function(){var o=this.canvas.renderOnAddRemove,a,c;this.canvas.renderOnAddRemove=!1;var f=[];for(a=0,c=this.points.length;a<c;a++){var h=this.points[a],d=new t.Circle({radius:h.radius,left:h.x,top:h.y,originX:"center",originY:"center",fill:h.fill});this.shadow&&(d.shadow=new t.Shadow(this.shadow)),f.push(d)}var u=new t.Group(f);u.canvas=this.canvas,this.canvas.fire("before:path:created",{path:u}),this.canvas.add(u),this.canvas.fire("path:created",{path:u}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=o,this.canvas.requestRenderAll()},addPoint:function(o){var a=new t.Point(o.x,o.y),c=t.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,f=new t.Color(this.color).setAlpha(t.util.getRandomInt(0,100)/100).toRgba();return a.radius=c,a.fill=f,this.points.push(a),a}}),t.SprayBrush=t.util.createClass(t.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(o){this.canvas=o,this.sprayChunks=[]},onMouseDown:function(o){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(o),this.render(this.sprayChunkPoints)},onMouseMove:function(o){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o)||(this.addSprayChunk(o),this.render(this.sprayChunkPoints))},onMouseUp:function(){var o=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var a=[],c=0,f=this.sprayChunks.length;c<f;c++)for(var h=this.sprayChunks[c],d=0,u=h.length;d<u;d++){var p=new t.Rect({width:h[d].width,height:h[d].width,left:h[d].x+1,top:h[d].y+1,originX:"center",originY:"center",fill:this.color});a.push(p)}this.optimizeOverlapping&&(a=this._getOptimizedRects(a));var m=new t.Group(a);this.shadow&&m.set("shadow",new t.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:m}),this.canvas.add(m),this.canvas.fire("path:created",{path:m}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=o,this.canvas.requestRenderAll()},_getOptimizedRects:function(o){var a={},c,f,h;for(f=0,h=o.length;f<h;f++)c=o[f].left+""+o[f].top,a[c]||(a[c]=o[f]);var d=[];for(c in a)d.push(a[c]);return d},render:function(o){var a=this.canvas.contextTop,c,f;for(a.fillStyle=this.color,this._saveAndTransform(a),c=0,f=o.length;c<f;c++){var h=o[c];typeof h.opacity<"u"&&(a.globalAlpha=h.opacity),a.fillRect(h.x,h.y,h.width,h.width)}a.restore()},_render:function(){var o=this.canvas.contextTop,a,c;for(o.fillStyle=this.color,this._saveAndTransform(o),a=0,c=this.sprayChunks.length;a<c;a++)this.render(this.sprayChunks[a]);o.restore()},addSprayChunk:function(o){this.sprayChunkPoints=[];var a,c,f,h=this.width/2,d;for(d=0;d<this.density;d++){a=t.util.getRandomInt(o.x-h,o.x+h),c=t.util.getRandomInt(o.y-h,o.y+h),this.dotWidthVariance?f=t.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):f=this.dotWidth;var u=new t.Point(a,c);u.width=f,this.randomOpacity&&(u.opacity=t.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(u)}this.sprayChunks.push(this.sprayChunkPoints)}}),t.PatternBrush=t.util.createClass(t.PencilBrush,{getPatternSrc:function(){var o=20,a=5,c=t.util.createCanvasElement(),f=c.getContext("2d");return c.width=c.height=o+a,f.fillStyle=this.color,f.beginPath(),f.arc(o/2,o/2,o/2,0,Math.PI*2,!1),f.closePath(),f.fill(),c},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(o){return o.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(o){this.callSuper("_setBrushStyles",o),o.strokeStyle=this.getPattern(o)},createPath:function(o){var a=this.callSuper("createPath",o),c=a._getLeftTopCoords().scalarAdd(a.strokeWidth/2);return a.stroke=new t.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-c.x,offsetY:-c.y}),a}}),function(){var o=t.util.getPointer,a=t.util.degreesToRadians,c=t.util.isTouchEvent;t.Canvas=t.util.createClass(t.StaticCanvas,{initialize:function(h,d){d||(d={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(h,d),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=t.PencilBrush&&new t.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var h=this.getActiveObjects(),d,u,p;if(h.length>0&&!this.preserveObjectStacking){u=[],p=[];for(var m=0,g=this._objects.length;m<g;m++)d=this._objects[m],h.indexOf(d)===-1?u.push(d):p.push(d);h.length>1&&(this._activeObject._objects=p),u.push.apply(u,p)}else u=this._objects;return u},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var h=this.contextContainer;return this.renderCanvas(h,this._chooseObjectsToRender()),this},renderTopLayer:function(h){h.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(h),this.contextTopDirty=!0),h.restore()},renderTop:function(){var h=this.contextTop;return this.clearContext(h),this.renderTopLayer(h),this.fire("after:render"),this},_normalizePointer:function(h,d){var u=h.calcTransformMatrix(),p=t.util.invertTransform(u),m=this.restorePointerVpt(d);return t.util.transformPoint(m,p)},isTargetTransparent:function(h,d,u){if(h.shouldCache()&&h._cacheCanvas&&h!==this._activeObject){var p=this._normalizePointer(h,{x:d,y:u}),m=Math.max(h.cacheTranslationX+p.x*h.zoomX,0),g=Math.max(h.cacheTranslationY+p.y*h.zoomY,0),b=t.util.isTransparent(h._cacheContext,Math.round(m),Math.round(g),this.targetFindTolerance);return b}var x=this.contextCache,y=h.selectionBackgroundColor,w=this.viewportTransform;h.selectionBackgroundColor="",this.clearContext(x),x.save(),x.transform(w[0],w[1],w[2],w[3],w[4],w[5]),h.render(x),x.restore(),h.selectionBackgroundColor=y;var b=t.util.isTransparent(x,d,u,this.targetFindTolerance);return b},_isSelectionKeyPressed:function(h){var d=!1;return Array.isArray(this.selectionKey)?d=!!this.selectionKey.find(function(u){return h[u]===!0}):d=h[this.selectionKey],d},_shouldClearSelection:function(h,d){var u=this.getActiveObjects(),p=this._activeObject;return!d||d&&p&&u.length>1&&u.indexOf(d)===-1&&p!==d&&!this._isSelectionKeyPressed(h)||d&&!d.evented||d&&!d.selectable&&p&&p!==d},_shouldCenterTransform:function(h,d,u){if(h){var p;return d==="scale"||d==="scaleX"||d==="scaleY"||d==="resizing"?p=this.centeredScaling||h.centeredScaling:d==="rotate"&&(p=this.centeredRotation||h.centeredRotation),p?!u:u}},_getOriginFromCorner:function(h,d){var u={x:h.originX,y:h.originY};return d==="ml"||d==="tl"||d==="bl"?u.x="right":(d==="mr"||d==="tr"||d==="br")&&(u.x="left"),d==="tl"||d==="mt"||d==="tr"?u.y="bottom":(d==="bl"||d==="mb"||d==="br")&&(u.y="top"),u},_getActionFromCorner:function(h,d,u,p){if(!d||!h)return"drag";var m=p.controls[d];return m.getActionName(u,m,p)},_setupCurrentTransform:function(h,d,u){if(d){var p=this.getPointer(h),m=d.__corner,g=d.controls[m],x=u&&m?g.getActionHandler(h,d,g):t.controlsUtils.dragHandler,y=this._getActionFromCorner(u,m,h,d),w=this._getOriginFromCorner(d,m),b=h[this.centeredKey],S={target:d,action:y,actionHandler:x,corner:m,scaleX:d.scaleX,scaleY:d.scaleY,skewX:d.skewX,skewY:d.skewY,offsetX:p.x-d.left,offsetY:p.y-d.top,originX:w.x,originY:w.y,ex:p.x,ey:p.y,lastX:p.x,lastY:p.y,theta:a(d.angle),width:d.width*d.scaleX,shiftKey:h.shiftKey,altKey:b,original:t.util.saveObjectTransform(d)};this._shouldCenterTransform(d,y,b)&&(S.originX="center",S.originY="center"),S.original.originX=w.x,S.original.originY=w.y,this._currentTransform=S,this._beforeTransform(h)}},setCursor:function(h){this.upperCanvasEl.style.cursor=h},_drawSelection:function(h){var d=this._groupSelector,u=new t.Point(d.ex,d.ey),p=t.util.transformPoint(u,this.viewportTransform),m=new t.Point(d.ex+d.left,d.ey+d.top),g=t.util.transformPoint(m,this.viewportTransform),x=Math.min(p.x,g.x),y=Math.min(p.y,g.y),w=Math.max(p.x,g.x),b=Math.max(p.y,g.y),S=this.selectionLineWidth/2;this.selectionColor&&(h.fillStyle=this.selectionColor,h.fillRect(x,y,w-x,b-y)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(h.lineWidth=this.selectionLineWidth,h.strokeStyle=this.selectionBorderColor,x+=S,y+=S,w-=S,b-=S,t.Object.prototype._setLineDash.call(this,h,this.selectionDashArray),h.strokeRect(x,y,w-x,b-y))},findTarget:function(h,d){if(!this.skipTargetFind){var u=!0,p=this.getPointer(h,u),m=this._activeObject,g=this.getActiveObjects(),x,y,w=c(h),b=g.length>1&&!d||g.length===1;if(this.targets=[],b&&m._findTargetCorner(p,w)||g.length>1&&!d&&m===this._searchPossibleTargets([m],p))return m;if(g.length===1&&m===this._searchPossibleTargets([m],p))if(this.preserveObjectStacking)x=m,y=this.targets,this.targets=[];else return m;var S=this._searchPossibleTargets(this._objects,p);return h[this.altSelectionKey]&&S&&x&&S!==x&&(S=x,this.targets=y),S}},_checkTarget:function(h,d,u){if(d&&d.visible&&d.evented&&d.containsPoint(h))if((this.perPixelTargetFind||d.perPixelTargetFind)&&!d.isEditing){var p=this.isTargetTransparent(d,u.x,u.y);if(!p)return!0}else return!0},_searchPossibleTargets:function(h,d){for(var u,p=h.length,m;p--;){var g=h[p],x=g.group?this._normalizePointer(g.group,d):d;if(this._checkTarget(x,g,d)){u=h[p],u.subTargetCheck&&u instanceof t.Group&&(m=this._searchPossibleTargets(u._objects,d),m&&this.targets.push(m));break}}return u},restorePointerVpt:function(h){return t.util.transformPoint(h,t.util.invertTransform(this.viewportTransform))},getPointer:function(h,d){if(this._absolutePointer&&!d)return this._absolutePointer;if(this._pointer&&d)return this._pointer;var u=o(h),p=this.upperCanvasEl,m=p.getBoundingClientRect(),g=m.width||0,x=m.height||0,y;(!g||!x)&&("top"in m&&"bottom"in m&&(x=Math.abs(m.top-m.bottom)),"right"in m&&"left"in m&&(g=Math.abs(m.right-m.left))),this.calcOffset(),u.x=u.x-this._offset.left,u.y=u.y-this._offset.top,d||(u=this.restorePointerVpt(u));var w=this.getRetinaScaling();return w!==1&&(u.x/=w,u.y/=w),g===0||x===0?y={width:1,height:1}:y={width:p.width/g,height:p.height/x},{x:u.x*y.width,y:u.y*y.height}},_createUpperCanvas:function(){var h=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),d=this.lowerCanvasEl,u=this.upperCanvasEl;u?u.className="":(u=this._createCanvasElement(),this.upperCanvasEl=u),t.util.addClass(u,"upper-canvas "+h),this.wrapperEl.appendChild(u),this._copyCanvasStyle(d,u),this._applyCanvasStyle(u),this.contextTop=u.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=t.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),t.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),t.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(h){var d=this.width||h.width,u=this.height||h.height;t.util.setStyle(h,{position:"absolute",width:d+"px",height:u+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),h.width=d,h.height=u,t.util.makeElementUnselectable(h)},_copyCanvasStyle:function(h,d){d.style.cssText=h.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var h=this._activeObject;return h?h.type==="activeSelection"&&h._objects?h._objects.slice(0):[h]:[]},_onObjectRemoved:function(h){h===this._activeObject&&(this.fire("before:selection:cleared",{target:h}),this._discardActiveObject(),this.fire("selection:cleared",{target:h}),h.fire("deselected")),h===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",h)},_fireSelectionEvents:function(h,d){var u=!1,p=this.getActiveObjects(),m=[],g=[];h.forEach(function(x){p.indexOf(x)===-1&&(u=!0,x.fire("deselected",{e:d,target:x}),g.push(x))}),p.forEach(function(x){h.indexOf(x)===-1&&(u=!0,x.fire("selected",{e:d,target:x}),m.push(x))}),h.length>0&&p.length>0?u&&this.fire("selection:updated",{e:d,selected:m,deselected:g}):p.length>0?this.fire("selection:created",{e:d,selected:m}):h.length>0&&this.fire("selection:cleared",{e:d,deselected:g})},setActiveObject:function(h,d){var u=this.getActiveObjects();return this._setActiveObject(h,d),this._fireSelectionEvents(u,d),this},_setActiveObject:function(h,d){return this._activeObject===h||!this._discardActiveObject(d,h)||h.onSelect({e:d})?!1:(this._activeObject=h,!0)},_discardActiveObject:function(h,d){var u=this._activeObject;if(u){if(u.onDeselect({e:h,object:d}))return!1;this._activeObject=null}return!0},discardActiveObject:function(h){var d=this.getActiveObjects(),u=this.getActiveObject();return d.length&&this.fire("before:selection:cleared",{target:u,e:h}),this._discardActiveObject(h),this._fireSelectionEvents(d,h),this},dispose:function(){var h=this.wrapperEl;return this.removeListeners(),h.removeChild(this.upperCanvasEl),h.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach((function(d){t.util.cleanUpJsdomNode(this[d]),this[d]=void 0}).bind(this)),h.parentNode&&h.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,t.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(h){var d=this._activeObject;d&&d._renderControls(h)},_toObject:function(h,d,u){var p=this._realizeGroupTransformOnObject(h),m=this.callSuper("_toObject",h,d,u);return this._unwindGroupTransformOnObject(h,p),m},_realizeGroupTransformOnObject:function(h){if(h.group&&h.group.type==="activeSelection"&&this._activeObject===h.group){var d=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],u={};return d.forEach(function(p){u[p]=h[p]}),t.util.addTransformToObject(h,this._activeObject.calcOwnMatrix()),u}else return null},_unwindGroupTransformOnObject:function(h,d){d&&h.set(d)},_setSVGObject:function(h,d,u){var p=this._realizeGroupTransformOnObject(d);this.callSuper("_setSVGObject",h,d,u),this._unwindGroupTransformOnObject(d,p)},setViewportTransform:function(h){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),t.StaticCanvas.prototype.setViewportTransform.call(this,h)}});for(var f in t.StaticCanvas)f!=="prototype"&&(t.Canvas[f]=t.StaticCanvas[f])}(),function(){var o=t.util.addListener,a=t.util.removeListener,c=3,f=2,h=1,d={passive:!1};function u(p,m){return p.button&&p.button===m-1}t.util.object.extend(t.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(o,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(p,m){var g=this.upperCanvasEl,x=this._getEventPrefix();p(t.window,"resize",this._onResize),p(g,x+"down",this._onMouseDown),p(g,x+"move",this._onMouseMove,d),p(g,x+"out",this._onMouseOut),p(g,x+"enter",this._onMouseEnter),p(g,"wheel",this._onMouseWheel),p(g,"contextmenu",this._onContextMenu),p(g,"dblclick",this._onDoubleClick),p(g,"dragover",this._onDragOver),p(g,"dragenter",this._onDragEnter),p(g,"dragleave",this._onDragLeave),p(g,"drop",this._onDrop),this.enablePointerEvents||p(g,"touchstart",this._onTouchStart,d),typeof eventjs<"u"&&m in eventjs&&(eventjs[m](g,"gesture",this._onGesture),eventjs[m](g,"drag",this._onDrag),eventjs[m](g,"orientation",this._onOrientationChange),eventjs[m](g,"shake",this._onShake),eventjs[m](g,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(a,"remove");var p=this._getEventPrefix();a(t.document,p+"up",this._onMouseUp),a(t.document,"touchend",this._onTouchEnd,d),a(t.document,p+"move",this._onMouseMove,d),a(t.document,"touchmove",this._onMouseMove,d)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(p,m){this.__onTransformGesture&&this.__onTransformGesture(p,m)},_onDrag:function(p,m){this.__onDrag&&this.__onDrag(p,m)},_onMouseWheel:function(p){this.__onMouseWheel(p)},_onMouseOut:function(p){var m=this._hoveredTarget;this.fire("mouse:out",{target:m,e:p}),this._hoveredTarget=null,m&&m.fire("mouseout",{e:p});var g=this;this._hoveredTargets.forEach(function(x){g.fire("mouse:out",{target:x,e:p}),x&&x.fire("mouseout",{e:p})}),this._hoveredTargets=[]},_onMouseEnter:function(p){!this._currentTransform&&!this.findTarget(p)&&(this.fire("mouse:over",{target:null,e:p}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(p,m){this.__onOrientationChange&&this.__onOrientationChange(p,m)},_onShake:function(p,m){this.__onShake&&this.__onShake(p,m)},_onLongPress:function(p,m){this.__onLongPress&&this.__onLongPress(p,m)},_onDragOver:function(p){p.preventDefault();var m=this._simpleEventHandler("dragover",p);this._fireEnterLeaveEvents(m,p)},_onDrop:function(p){return this._simpleEventHandler("drop:before",p),this._simpleEventHandler("drop",p)},_onContextMenu:function(p){return this.stopContextMenu&&(p.stopPropagation(),p.preventDefault()),!1},_onDoubleClick:function(p){this._cacheTransformEventData(p),this._handleEvent(p,"dblclick"),this._resetTransformEventData(p)},getPointerId:function(p){var m=p.changedTouches;return m?m[0]&&m[0].identifier:this.enablePointerEvents?p.pointerId:-1},_isMainEvent:function(p){return p.isPrimary===!0?!0:p.isPrimary===!1?!1:p.type==="touchend"&&p.touches.length===0?!0:p.changedTouches?p.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(p){p.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(p)),this.__onMouseDown(p),this._resetTransformEventData();var m=this.upperCanvasEl,g=this._getEventPrefix();o(t.document,"touchend",this._onTouchEnd,d),o(t.document,"touchmove",this._onMouseMove,d),a(m,g+"down",this._onMouseDown)},_onMouseDown:function(p){this.__onMouseDown(p),this._resetTransformEventData();var m=this.upperCanvasEl,g=this._getEventPrefix();a(m,g+"move",this._onMouseMove,d),o(t.document,g+"up",this._onMouseUp),o(t.document,g+"move",this._onMouseMove,d)},_onTouchEnd:function(p){if(!(p.touches.length>0)){this.__onMouseUp(p),this._resetTransformEventData(),this.mainTouchId=null;var m=this._getEventPrefix();a(t.document,"touchend",this._onTouchEnd,d),a(t.document,"touchmove",this._onMouseMove,d);var g=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){o(g.upperCanvasEl,m+"down",g._onMouseDown),g._willAddMouseDown=0},400)}},_onMouseUp:function(p){this.__onMouseUp(p),this._resetTransformEventData();var m=this.upperCanvasEl,g=this._getEventPrefix();this._isMainEvent(p)&&(a(t.document,g+"up",this._onMouseUp),a(t.document,g+"move",this._onMouseMove,d),o(m,g+"move",this._onMouseMove,d))},_onMouseMove:function(p){!this.allowTouchScrolling&&p.preventDefault&&p.preventDefault(),this.__onMouseMove(p)},_onResize:function(){this.calcOffset()},_shouldRender:function(p){var m=this._activeObject;return!!m!=!!p||m&&p&&m!==p?!0:(m&&m.isEditing,!1)},__onMouseUp:function(p){var m,g=this._currentTransform,x=this._groupSelector,y=!1,w=!x||x.left===0&&x.top===0;if(this._cacheTransformEventData(p),m=this._target,this._handleEvent(p,"up:before"),u(p,c)){this.fireRightClick&&this._handleEvent(p,"up",c,w);return}if(u(p,f)){this.fireMiddleClick&&this._handleEvent(p,"up",f,w),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(p);return}if(this._isMainEvent(p)){if(g&&(this._finalizeCurrentTransform(p),y=g.actionPerformed),!w){var b=m===this._activeObject;this._maybeGroupObjects(p),y||(y=this._shouldRender(m)||!b&&m===this._activeObject)}var S,T;if(m){if(S=m._findTargetCorner(this.getPointer(p,!0),t.util.isTouchEvent(p)),m.selectable&&m!==this._activeObject&&m.activeOn==="up")this.setActiveObject(m,p),y=!0;else{var O=m.controls[S],j=O&&O.getMouseUpHandler(p,m,O);j&&(T=this.getPointer(p),j(p,g,T.x,T.y))}m.isMoving=!1}if(g&&(g.target!==m||g.corner!==S)){var L=g.target&&g.target.controls[g.corner],W=L&&L.getMouseUpHandler(p,m,O);T=T||this.getPointer(p),W&&W(p,g,T.x,T.y)}this._setCursorFromEvent(p,m),this._handleEvent(p,"up",h,w),this._groupSelector=null,this._currentTransform=null,m&&(m.__corner=0),y?this.requestRenderAll():w||this.renderTop()}},_simpleEventHandler:function(p,m){var g=this.findTarget(m),x=this.targets,y={e:m,target:g,subTargets:x};if(this.fire(p,y),g&&g.fire(p,y),!x)return g;for(var w=0;w<x.length;w++)x[w].fire(p,y);return g},_handleEvent:function(p,m,g,x){var y=this._target,w=this.targets||[],b={e:p,target:y,subTargets:w,button:g||h,isClick:x||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};m==="up"&&(b.currentTarget=this.findTarget(p),b.currentSubTargets=this.targets),this.fire("mouse:"+m,b),y&&y.fire("mouse"+m,b);for(var S=0;S<w.length;S++)w[S].fire("mouse"+m,b)},_finalizeCurrentTransform:function(p){var m=this._currentTransform,g=m.target,x={e:p,target:g,transform:m,action:m.action};g._scaling&&(g._scaling=!1),g.setCoords(),(m.actionPerformed||this.stateful&&g.hasStateChanged())&&this._fire("modified",x)},_onMouseDownInDrawingMode:function(p){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(p).requestRenderAll();var m=this.getPointer(p);this.freeDrawingBrush.onMouseDown(m,{e:p,pointer:m}),this._handleEvent(p,"down")},_onMouseMoveInDrawingMode:function(p){if(this._isCurrentlyDrawing){var m=this.getPointer(p);this.freeDrawingBrush.onMouseMove(m,{e:p,pointer:m})}this.setCursor(this.freeDrawingCursor),this._handleEvent(p,"move")},_onMouseUpInDrawingMode:function(p){var m=this.getPointer(p);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:p,pointer:m}),this._handleEvent(p,"up")},__onMouseDown:function(p){this._cacheTransformEventData(p),this._handleEvent(p,"down:before");var m=this._target;if(u(p,c)){this.fireRightClick&&this._handleEvent(p,"down",c);return}if(u(p,f)){this.fireMiddleClick&&this._handleEvent(p,"down",f);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(p);return}if(this._isMainEvent(p)&&!this._currentTransform){var g=this._pointer;this._previousPointer=g;var x=this._shouldRender(m),y=this._shouldGroup(p,m);if(this._shouldClearSelection(p,m)?this.discardActiveObject(p):y&&(this._handleGrouping(p,m),m=this._activeObject),this.selection&&(!m||!m.selectable&&!m.isEditing&&m!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),m){var w=m===this._activeObject;m.selectable&&m.activeOn==="down"&&this.setActiveObject(m,p);var b=m._findTargetCorner(this.getPointer(p,!0),t.util.isTouchEvent(p));if(m.__corner=b,m===this._activeObject&&(b||!y)){this._setupCurrentTransform(p,m,w);var S=m.controls[b],g=this.getPointer(p),T=S&&S.getMouseDownHandler(p,m,S);T&&T(p,this._currentTransform,g.x,g.y)}}this._handleEvent(p,"down"),(x||y)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(p){this._resetTransformEventData(),this._pointer=this.getPointer(p,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(p)||null},_beforeTransform:function(p){var m=this._currentTransform;this.stateful&&m.target.saveState(),this.fire("before:transform",{e:p,transform:m})},__onMouseMove:function(p){this._handleEvent(p,"move:before"),this._cacheTransformEventData(p);var m,g;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(p);return}if(this._isMainEvent(p)){var x=this._groupSelector;x?(g=this._absolutePointer,x.left=g.x-x.ex,x.top=g.y-x.ey,this.renderTop()):this._currentTransform?this._transformObject(p):(m=this.findTarget(p)||null,this._setCursorFromEvent(p,m),this._fireOverOutEvents(m,p)),this._handleEvent(p,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(p,m){var g=this._hoveredTarget,x=this._hoveredTargets,y=this.targets,w=Math.max(x.length,y.length);this.fireSyntheticInOutEvents(p,m,{oldTarget:g,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var b=0;b<w;b++)this.fireSyntheticInOutEvents(y[b],m,{oldTarget:x[b],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=p,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(p,m){var g=this._draggedoverTarget,x=this._hoveredTargets,y=this.targets,w=Math.max(x.length,y.length);this.fireSyntheticInOutEvents(p,m,{oldTarget:g,evtOut:"dragleave",evtIn:"dragenter"});for(var b=0;b<w;b++)this.fireSyntheticInOutEvents(y[b],m,{oldTarget:x[b],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=p},fireSyntheticInOutEvents:function(p,m,g){var x,y,w=g.oldTarget,b,S,T=w!==p,O=g.canvasEvtIn,j=g.canvasEvtOut;T&&(x={e:m,target:p,previousTarget:w},y={e:m,target:w,nextTarget:p}),S=p&&T,b=w&&T,b&&(j&&this.fire(j,y),w.fire(g.evtOut,y)),S&&(O&&this.fire(O,x),p.fire(g.evtIn,x))},__onMouseWheel:function(p){this._cacheTransformEventData(p),this._handleEvent(p,"wheel"),this._resetTransformEventData()},_transformObject:function(p){var m=this.getPointer(p),g=this._currentTransform;g.reset=!1,g.shiftKey=p.shiftKey,g.altKey=p[this.centeredKey],this._performTransformAction(p,g,m),g.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(p,m,g){var x=g.x,y=g.y,w=m.action,b=!1,S=m.actionHandler;S&&(b=S(p,m,x,y)),w==="drag"&&b&&(m.target.isMoving=!0,this.setCursor(m.target.moveCursor||this.moveCursor)),m.actionPerformed=m.actionPerformed||b},_fire:t.controlsUtils.fireEvent,_setCursorFromEvent:function(p,m){if(!m)return this.setCursor(this.defaultCursor),!1;var g=m.hoverCursor||this.hoverCursor,x=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,y=(!x||!x.contains(m))&&m._findTargetCorner(this.getPointer(p,!0));y?this.setCursor(this.getCornerCursor(y,m,p)):(m.subTargetCheck&&this.targets.concat().reverse().map(function(w){g=w.hoverCursor||g}),this.setCursor(g))},getCornerCursor:function(p,m,g){var x=m.controls[p];return x.cursorStyleHandler(g,x,m)}})}(),function(){var o=Math.min,a=Math.max;t.util.object.extend(t.Canvas.prototype,{_shouldGroup:function(c,f){var h=this._activeObject;return h&&this._isSelectionKeyPressed(c)&&f&&f.selectable&&this.selection&&(h!==f||h.type==="activeSelection")&&!f.onSelect({e:c})},_handleGrouping:function(c,f){var h=this._activeObject;h.__corner||f===h&&(f=this.findTarget(c,!0),!f||!f.selectable)||(h&&h.type==="activeSelection"?this._updateActiveSelection(f,c):this._createActiveSelection(f,c))},_updateActiveSelection:function(c,f){var h=this._activeObject,d=h._objects.slice(0);h.contains(c)?(h.removeWithUpdate(c),this._hoveredTarget=c,this._hoveredTargets=this.targets.concat(),h.size()===1&&this._setActiveObject(h.item(0),f)):(h.addWithUpdate(c),this._hoveredTarget=h,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(d,f)},_createActiveSelection:function(c,f){var h=this.getActiveObjects(),d=this._createGroup(c);this._hoveredTarget=d,this._setActiveObject(d,f),this._fireSelectionEvents(h,f)},_createGroup:function(c){var f=this._objects,h=f.indexOf(this._activeObject)<f.indexOf(c),d=h?[this._activeObject,c]:[c,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new t.ActiveSelection(d,{canvas:this})},_groupSelectedObjects:function(c){var f=this._collectObjects(c),h;f.length===1?this.setActiveObject(f[0],c):f.length>1&&(h=new t.ActiveSelection(f.reverse(),{canvas:this}),this.setActiveObject(h,c))},_collectObjects:function(c){for(var f=[],h,d=this._groupSelector.ex,u=this._groupSelector.ey,p=d+this._groupSelector.left,m=u+this._groupSelector.top,g=new t.Point(o(d,p),o(u,m)),x=new t.Point(a(d,p),a(u,m)),y=!this.selectionFullyContained,w=d===p&&u===m,b=this._objects.length;b--&&(h=this._objects[b],!(!(!h||!h.selectable||!h.visible)&&(y&&h.intersectsWithRect(g,x,!0)||h.isContainedWithinRect(g,x,!0)||y&&h.containsPoint(g,null,!0)||y&&h.containsPoint(x,null,!0))&&(f.push(h),w))););return f.length>1&&(f=f.filter(function(S){return!S.onSelect({e:c})})),f},_maybeGroupObjects:function(c){this.selection&&this._groupSelector&&this._groupSelectedObjects(c),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){t.util.object.extend(t.StaticCanvas.prototype,{toDataURL:function(o){o||(o={});var a=o.format||"png",c=o.quality||1,f=(o.multiplier||1)*(o.enableRetinaScaling?this.getRetinaScaling():1),h=this.toCanvasElement(f,o);return t.util.toDataURL(h,a,c)},toCanvasElement:function(o,a){o=o||1,a=a||{};var c=(a.width||this.width)*o,f=(a.height||this.height)*o,h=this.getZoom(),d=this.width,u=this.height,p=h*o,m=this.viewportTransform,g=(m[4]-(a.left||0))*o,x=(m[5]-(a.top||0))*o,y=this.interactive,w=[p,0,0,p,g,x],b=this.enableRetinaScaling,S=t.util.createCanvasElement(),T=this.contextTop;return S.width=c,S.height=f,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=w,this.width=c,this.height=f,this.calcViewportBoundaries(),this.renderCanvas(S.getContext("2d"),this._objects),this.viewportTransform=m,this.width=d,this.height=u,this.calcViewportBoundaries(),this.interactive=y,this.enableRetinaScaling=b,this.contextTop=T,S}})}(),t.util.object.extend(t.StaticCanvas.prototype,{loadFromJSON:function(o,a,c){if(o){var f=typeof o=="string"?JSON.parse(o):t.util.object.clone(o),h=this,d=f.clipPath,u=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete f.clipPath,this._enlivenObjects(f.objects,function(p){h.clear(),h._setBgOverlay(f,function(){d?h._enlivenObjects([d],function(m){h.clipPath=m[0],h.__setupCanvas.call(h,f,p,u,a)}):h.__setupCanvas.call(h,f,p,u,a)})},c),this}},__setupCanvas:function(o,a,c,f){var h=this;a.forEach(function(d,u){h.insertAt(d,u)}),this.renderOnAddRemove=c,delete o.objects,delete o.backgroundImage,delete o.overlayImage,delete o.background,delete o.overlay,this._setOptions(o),this.renderAll(),f&&f()},_setBgOverlay:function(o,a){var c={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!o.backgroundImage&&!o.overlayImage&&!o.background&&!o.overlay){a&&a();return}var f=function(){c.backgroundImage&&c.overlayImage&&c.backgroundColor&&c.overlayColor&&a&&a()};this.__setBgOverlay("backgroundImage",o.backgroundImage,c,f),this.__setBgOverlay("overlayImage",o.overlayImage,c,f),this.__setBgOverlay("backgroundColor",o.background,c,f),this.__setBgOverlay("overlayColor",o.overlay,c,f)},__setBgOverlay:function(o,a,c,f){var h=this;if(!a){c[o]=!0,f&&f();return}o==="backgroundImage"||o==="overlayImage"?t.util.enlivenObjects([a],function(d){h[o]=d[0],c[o]=!0,f&&f()}):this["set"+t.util.string.capitalize(o,!0)](a,function(){c[o]=!0,f&&f()})},_enlivenObjects:function(o,a,c){if(!o||o.length===0){a&&a([]);return}t.util.enlivenObjects(o,function(f){a&&a(f)},null,c)},_toDataURL:function(o,a){this.clone(function(c){a(c.toDataURL(o))})},_toDataURLWithMultiplier:function(o,a,c){this.clone(function(f){c(f.toDataURLWithMultiplier(o,a))})},clone:function(o,a){var c=JSON.stringify(this.toJSON(a));this.cloneWithoutData(function(f){f.loadFromJSON(c,function(){o&&o(f)})})},cloneWithoutData:function(o){var a=t.util.createCanvasElement();a.width=this.width,a.height=this.height;var c=new t.Canvas(a);this.backgroundImage?(c.setBackgroundImage(this.backgroundImage.src,function(){c.renderAll(),o&&o(c)}),c.backgroundImageOpacity=this.backgroundImageOpacity,c.backgroundImageStretch=this.backgroundImageStretch):o&&o(c)}}),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,f=a.util.object.clone,h=a.util.toFixed,d=a.util.string.capitalize,u=a.util.degreesToRadians,p=!a.isLikelyNode,m=2;a.Object||(a.Object=a.util.createClass(a.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:p,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(g){g&&this.setOptions(g)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=a.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(g){var x=a.perfLimitSizeTotal,y=g.width,w=g.height,b=a.maxCacheSideLimit,S=a.minCacheSideLimit;if(y<=b&&w<=b&&y*w<=x)return y<S&&(g.width=S),w<S&&(g.height=S),g;var T=y/w,O=a.util.limitDimsByArea(T,x),j=a.util.capValue,L=j(S,O.x,b),W=j(S,O.y,b);return y>L&&(g.zoomX/=y/L,g.width=L,g.capped=!0),w>W&&(g.zoomY/=w/W,g.height=W,g.capped=!0),g},_getCacheCanvasDimensions:function(){var g=this.getTotalObjectScaling(),x=this._getTransformedDimensions(0,0),y=x.x*g.scaleX/this.scaleX,w=x.y*g.scaleY/this.scaleY;return{width:Math.ceil(y+m),height:Math.ceil(w+m),zoomX:g.scaleX,zoomY:g.scaleY,x:y,y:w}},_updateCacheCanvas:function(){var g=this.canvas;if(this.noScaleCache&&g&&g._currentTransform){var x=g._currentTransform.target,y=g._currentTransform.action;if(this===x&&y.slice&&y.slice(0,5)==="scale")return!1}var w=this._cacheCanvas,b=this._limitCacheSize(this._getCacheCanvasDimensions()),S=b.width,T=b.height,O,j,L=b.zoomX,W=b.zoomY,F=S!==this.cacheWidth||T!==this.cacheHeight,M=this.zoomX!==L||this.zoomY!==W,V=F||M;return V?(F?(w.width=S,w.height=T):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,w.width,w.height)),O=b.x/2,j=b.y/2,this.cacheTranslationX=Math.round(w.width/2-O)+O,this.cacheTranslationY=Math.round(w.height/2-j)+j,this.cacheWidth=S,this.cacheHeight=T,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(L,W),this.zoomX=L,this.zoomY=W,!0):!1},setOptions:function(g){this._setOptions(g),this._initGradient(g.fill,"fill"),this._initGradient(g.stroke,"stroke"),this._initPattern(g.fill,"fill"),this._initPattern(g.stroke,"stroke")},transform:function(g){var x=this.group&&!this.group._transformDone||this.group&&this.canvas&&g===this.canvas.contextTop,y=this.calcTransformMatrix(!x);g.transform(y[0],y[1],y[2],y[3],y[4],y[5])},toObject:function(g){var x=a.Object.NUM_FRACTION_DIGITS,y={type:this.type,version:a.version,originX:this.originX,originY:this.originY,left:h(this.left,x),top:h(this.top,x),width:h(this.width,x),height:h(this.height,x),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:h(this.strokeWidth,x),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:h(this.strokeMiterLimit,x),scaleX:h(this.scaleX,x),scaleY:h(this.scaleY,x),angle:h(this.angle,x),flipX:this.flipX,flipY:this.flipY,opacity:h(this.opacity,x),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:h(this.skewX,x),skewY:h(this.skewY,x)};return this.clipPath&&!this.clipPath.excludeFromExport&&(y.clipPath=this.clipPath.toObject(g),y.clipPath.inverted=this.clipPath.inverted,y.clipPath.absolutePositioned=this.clipPath.absolutePositioned),a.util.populateWithProperties(this,y,g),this.includeDefaultValues||(y=this._removeDefaultValues(y)),y},toDatalessObject:function(g){return this.toObject(g)},_removeDefaultValues:function(g){var x=a.util.getKlass(g.type).prototype,y=x.stateProperties;return y.forEach(function(w){w==="left"||w==="top"||(g[w]===x[w]&&delete g[w],Array.isArray(g[w])&&Array.isArray(x[w])&&g[w].length===0&&x[w].length===0&&delete g[w])}),g},toString:function(){return"#<fabric."+d(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var g=a.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(g.scaleX),scaleY:Math.abs(g.scaleY)}},getTotalObjectScaling:function(){var g=this.getObjectScaling(),x=g.scaleX,y=g.scaleY;if(this.canvas){var w=this.canvas.getZoom(),b=this.canvas.getRetinaScaling();x*=w*b,y*=w*b}return{scaleX:x,scaleY:y}},getObjectOpacity:function(){var g=this.opacity;return this.group&&(g*=this.group.getObjectOpacity()),g},_set:function(g,x){var y=g==="scaleX"||g==="scaleY",w=this[g]!==x,b=!1;return y&&(x=this._constrainScale(x)),g==="scaleX"&&x<0?(this.flipX=!this.flipX,x*=-1):g==="scaleY"&&x<0?(this.flipY=!this.flipY,x*=-1):g==="shadow"&&x&&!(x instanceof a.Shadow)?x=new a.Shadow(x):g==="dirty"&&this.group&&this.group.set("dirty",x),this[g]=x,w&&(b=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(g)>-1?(this.dirty=!0,b&&this.group.set("dirty",!0)):b&&this.stateProperties.indexOf(g)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:a.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(g){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(g.save(),this._setupCompositeOperation(g),this.drawSelectionBackground(g),this.transform(g),this._setOpacity(g),this._setShadow(g,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(g)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(g),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),g.restore())},renderCache:function(g){g=g||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,g.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(g,x){if(g.save(),x.inverted?g.globalCompositeOperation="destination-out":g.globalCompositeOperation="destination-in",x.absolutePositioned){var y=a.util.invertTransform(this.calcTransformMatrix());g.transform(y[0],y[1],y[2],y[3],y[4],y[5])}x.transform(g),g.scale(1/x.zoomX,1/x.zoomY),g.drawImage(x._cacheCanvas,-x.cacheTranslationX,-x.cacheTranslationY),g.restore()},drawObject:function(g,x){var y=this.fill,w=this.stroke;x?(this.fill="black",this.stroke="",this._setClippingProperties(g)):this._renderBackground(g),this._render(g),this._drawClipPath(g,this.clipPath),this.fill=y,this.stroke=w},_drawClipPath:function(g,x){x&&(x.canvas=this.canvas,x.shouldCache(),x._transformDone=!0,x.renderCache({forClipping:!0}),this.drawClipPathOnCache(g,x))},drawCacheOnCanvas:function(g){g.scale(1/this.zoomX,1/this.zoomY),g.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(g){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!g&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!g){var x=this.cacheWidth/this.zoomX,y=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-x/2,-y/2,x,y)}return!0}return!1},_renderBackground:function(g){if(this.backgroundColor){var x=this._getNonTransformedDimensions();g.fillStyle=this.backgroundColor,g.fillRect(-x.x/2,-x.y/2,x.x,x.y),this._removeShadow(g)}},_setOpacity:function(g){this.group&&!this.group._transformDone?g.globalAlpha=this.getObjectOpacity():g.globalAlpha*=this.opacity},_setStrokeStyles:function(g,x){var y=x.stroke;y&&(g.lineWidth=x.strokeWidth,g.lineCap=x.strokeLineCap,g.lineDashOffset=x.strokeDashOffset,g.lineJoin=x.strokeLineJoin,g.miterLimit=x.strokeMiterLimit,y.toLive?y.gradientUnits==="percentage"||y.gradientTransform||y.patternTransform?this._applyPatternForTransformedGradient(g,y):(g.strokeStyle=y.toLive(g,this),this._applyPatternGradientTransform(g,y)):g.strokeStyle=x.stroke)},_setFillStyles:function(g,x){var y=x.fill;y&&(y.toLive?(g.fillStyle=y.toLive(g,this),this._applyPatternGradientTransform(g,x.fill)):g.fillStyle=y)},_setClippingProperties:function(g){g.globalAlpha=1,g.strokeStyle="transparent",g.fillStyle="#000000"},_setLineDash:function(g,x){!x||x.length===0||(1&x.length&&x.push.apply(x,x),g.setLineDash(x))},_renderControls:function(g,x){var y=this.getViewportTransform(),w=this.calcTransformMatrix(),b,S,T;x=x||{},S=typeof x.hasBorders<"u"?x.hasBorders:this.hasBorders,T=typeof x.hasControls<"u"?x.hasControls:this.hasControls,w=a.util.multiplyTransformMatrices(y,w),b=a.util.qrDecompose(w),g.save(),g.translate(b.translateX,b.translateY),g.lineWidth=1*this.borderScaleFactor,this.group||(g.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(b.angle-=180),g.rotate(u(this.group?b.angle:this.angle)),x.forActiveSelection||this.group?S&&this.drawBordersInGroup(g,b,x):S&&this.drawBorders(g,x),T&&this.drawControls(g,x),g.restore()},_setShadow:function(g){if(this.shadow){var x=this.shadow,y=this.canvas,w,b=y&&y.viewportTransform[0]||1,S=y&&y.viewportTransform[3]||1;x.nonScaling?w={scaleX:1,scaleY:1}:w=this.getObjectScaling(),y&&y._isRetinaScaling()&&(b*=a.devicePixelRatio,S*=a.devicePixelRatio),g.shadowColor=x.color,g.shadowBlur=x.blur*a.browserShadowBlurConstant*(b+S)*(w.scaleX+w.scaleY)/4,g.shadowOffsetX=x.offsetX*b*w.scaleX,g.shadowOffsetY=x.offsetY*S*w.scaleY}},_removeShadow:function(g){this.shadow&&(g.shadowColor="",g.shadowBlur=g.shadowOffsetX=g.shadowOffsetY=0)},_applyPatternGradientTransform:function(g,x){if(!x||!x.toLive)return{offsetX:0,offsetY:0};var y=x.gradientTransform||x.patternTransform,w=-this.width/2+x.offsetX||0,b=-this.height/2+x.offsetY||0;return x.gradientUnits==="percentage"?g.transform(this.width,0,0,this.height,w,b):g.transform(1,0,0,1,w,b),y&&g.transform(y[0],y[1],y[2],y[3],y[4],y[5]),{offsetX:w,offsetY:b}},_renderPaintInOrder:function(g){this.paintFirst==="stroke"?(this._renderStroke(g),this._renderFill(g)):(this._renderFill(g),this._renderStroke(g))},_render:function(){},_renderFill:function(g){this.fill&&(g.save(),this._setFillStyles(g,this),this.fillRule==="evenodd"?g.fill("evenodd"):g.fill(),g.restore())},_renderStroke:function(g){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(g),g.save(),this.strokeUniform&&this.group){var x=this.getObjectScaling();g.scale(1/x.scaleX,1/x.scaleY)}else this.strokeUniform&&g.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(g,this.strokeDashArray),this._setStrokeStyles(g,this),g.stroke(),g.restore()}},_applyPatternForTransformedGradient:function(g,x){var y=this._limitCacheSize(this._getCacheCanvasDimensions()),w=a.util.createCanvasElement(),b,S=this.canvas.getRetinaScaling(),T=y.x/this.scaleX/S,O=y.y/this.scaleY/S;w.width=Math.ceil(T),w.height=Math.ceil(O),b=w.getContext("2d"),b.beginPath(),b.moveTo(0,0),b.lineTo(T,0),b.lineTo(T,O),b.lineTo(0,O),b.closePath(),b.translate(T/2,O/2),b.scale(y.zoomX/this.scaleX/S,y.zoomY/this.scaleY/S),this._applyPatternGradientTransform(b,x),b.fillStyle=x.toLive(g),b.fill(),g.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),g.scale(S*this.scaleX/y.zoomX,S*this.scaleY/y.zoomY),g.strokeStyle=b.createPattern(w,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var g=a.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",g.scaleX),this.set("scaleY",g.scaleY),this.angle=g.angle,this.skewX=g.skewX,this.skewY=0}},_removeTransformMatrix:function(g){var x=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),x=a.util.transformPoint(x,this.transformMatrix)),this.transformMatrix=null,g&&(this.scaleX*=g.scaleX,this.scaleY*=g.scaleY,this.cropX=g.cropX,this.cropY=g.cropY,x.x+=g.offsetLeft,x.y+=g.offsetTop,this.width=g.width,this.height=g.height),this.setPositionByOrigin(x,"center","center")},clone:function(g,x){var y=this.toObject(x);this.constructor.fromObject?this.constructor.fromObject(y,g):a.Object._fromObject("Object",y,g)},cloneAsImage:function(g,x){var y=this.toCanvasElement(x);return g&&g(new a.Image(y)),this},toCanvasElement:function(g){g||(g={});var x=a.util,y=x.saveObjectTransform(this),w=this.group,b=this.shadow,S=Math.abs,T=(g.multiplier||1)*(g.enableRetinaScaling?a.devicePixelRatio:1);delete this.group,g.withoutTransform&&x.resetObjectTransform(this),g.withoutShadow&&(this.shadow=null);var O=a.util.createCanvasElement(),j=this.getBoundingRect(!0,!0),L=this.shadow,W,F={x:0,y:0},M,V,G;L&&(M=L.blur,L.nonScaling?W={scaleX:1,scaleY:1}:W=this.getObjectScaling(),F.x=2*Math.round(S(L.offsetX)+M)*S(W.scaleX),F.y=2*Math.round(S(L.offsetY)+M)*S(W.scaleY)),V=j.width+F.x,G=j.height+F.y,O.width=Math.ceil(V),O.height=Math.ceil(G);var te=new a.StaticCanvas(O,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});g.format==="jpeg"&&(te.backgroundColor="#fff"),this.setPositionByOrigin(new a.Point(te.width/2,te.height/2),"center","center");var ee=this.canvas;te.add(this);var Q=te.toCanvasElement(T||1,g);return this.shadow=b,this.set("canvas",ee),w&&(this.group=w),this.set(y).setCoords(),te._objects=[],te.dispose(),te=null,Q},toDataURL:function(g){return g||(g={}),a.util.toDataURL(this.toCanvasElement(g),g.format||"png",g.quality||1)},isType:function(g){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===g},complexity:function(){return 1},toJSON:function(g){return this.toObject(g)},rotate:function(g){var x=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return x&&this._setOriginToCenter(),this.set("angle",g),x&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(g,x){x=x||this.canvas.getPointer(g);var y=new a.Point(x.x,x.y),w=this._getLeftTopCoords();return this.angle&&(y=a.util.rotatePoint(y,w,u(-this.angle))),{x:y.x-w.x,y:y.y-w.y}},_setupCompositeOperation:function(g){this.globalCompositeOperation&&(g.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){a.runningAnimations&&a.runningAnimations.cancelByTarget(this)}}),a.util.createAccessors&&a.util.createAccessors(a.Object),c(a.Object.prototype,a.Observable),a.Object.NUM_FRACTION_DIGITS=2,a.Object.ENLIVEN_PROPS=["clipPath"],a.Object._fromObject=function(g,x,y,w){var b=a[g];x=f(x,!0),a.util.enlivenPatterns([x.fill,x.stroke],function(S){typeof S[0]<"u"&&(x.fill=S[0]),typeof S[1]<"u"&&(x.stroke=S[1]),a.util.enlivenObjectEnlivables(x,x,function(){var T=w?new b(x[w],x):new b(x);y&&y(T)})})},a.Object.__uid=0)}(e),function(){var o=t.util.degreesToRadians,a={left:-.5,center:0,right:.5},c={top:-.5,center:0,bottom:.5};t.util.object.extend(t.Object.prototype,{translateToGivenOrigin:function(f,h,d,u,p){var m=f.x,g=f.y,x,y,w;return typeof h=="string"?h=a[h]:h-=.5,typeof u=="string"?u=a[u]:u-=.5,x=u-h,typeof d=="string"?d=c[d]:d-=.5,typeof p=="string"?p=c[p]:p-=.5,y=p-d,(x||y)&&(w=this._getTransformedDimensions(),m=f.x+x*w.x,g=f.y+y*w.y),new t.Point(m,g)},translateToCenterPoint:function(f,h,d){var u=this.translateToGivenOrigin(f,h,d,"center","center");return this.angle?t.util.rotatePoint(u,f,o(this.angle)):u},translateToOriginPoint:function(f,h,d){var u=this.translateToGivenOrigin(f,"center","center",h,d);return this.angle?t.util.rotatePoint(u,f,o(this.angle)):u},getCenterPoint:function(){var f=new t.Point(this.left,this.top);return this.translateToCenterPoint(f,this.originX,this.originY)},getPointByOrigin:function(f,h){var d=this.getCenterPoint();return this.translateToOriginPoint(d,f,h)},toLocalPoint:function(f,h,d){var u=this.getCenterPoint(),p,m;return typeof h<"u"&&typeof d<"u"?p=this.translateToGivenOrigin(u,"center","center",h,d):p=new t.Point(this.left,this.top),m=new t.Point(f.x,f.y),this.angle&&(m=t.util.rotatePoint(m,u,-o(this.angle))),m.subtractEquals(p)},setPositionByOrigin:function(f,h,d){var u=this.translateToCenterPoint(f,h,d),p=this.translateToOriginPoint(u,this.originX,this.originY);this.set("left",p.x),this.set("top",p.y)},adjustPosition:function(f){var h=o(this.angle),d=this.getScaledWidth(),u=t.util.cos(h)*d,p=t.util.sin(h)*d,m,g;typeof this.originX=="string"?m=a[this.originX]:m=this.originX-.5,typeof f=="string"?g=a[f]:g=f-.5,this.left+=u*(g-m),this.top+=p*(g-m),this.setCoords(),this.originX=f},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var f=this.getCenterPoint();this.originX="center",this.originY="center",this.left=f.x,this.top=f.y},_resetOrigin:function(){var f=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=f.x,this.top=f.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function o(d){return[new t.Point(d.tl.x,d.tl.y),new t.Point(d.tr.x,d.tr.y),new t.Point(d.br.x,d.br.y),new t.Point(d.bl.x,d.bl.y)]}var a=t.util,c=a.degreesToRadians,f=a.multiplyTransformMatrices,h=a.transformPoint;a.object.extend(t.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(d,u){return u?d?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),d?this.aCoords:this.lineCoords)},getCoords:function(d,u){return o(this._getCoords(d,u))},intersectsWithRect:function(d,u,p,m){var g=this.getCoords(p,m),x=t.Intersection.intersectPolygonRectangle(g,d,u);return x.status==="Intersection"},intersectsWithObject:function(d,u,p){var m=t.Intersection.intersectPolygonPolygon(this.getCoords(u,p),d.getCoords(u,p));return m.status==="Intersection"||d.isContainedWithinObject(this,u,p)||this.isContainedWithinObject(d,u,p)},isContainedWithinObject:function(d,u,p){for(var m=this.getCoords(u,p),g=u?d.aCoords:d.lineCoords,x=0,y=d._getImageLines(g);x<4;x++)if(!d.containsPoint(m[x],y))return!1;return!0},isContainedWithinRect:function(d,u,p,m){var g=this.getBoundingRect(p,m);return g.left>=d.x&&g.left+g.width<=u.x&&g.top>=d.y&&g.top+g.height<=u.y},containsPoint:function(d,x,p,m){var g=this._getCoords(p,m),x=x||this._getImageLines(g),y=this._findCrossPoints(d,x);return y!==0&&y%2===1},isOnScreen:function(d){if(!this.canvas)return!1;var u=this.canvas.vptCoords.tl,p=this.canvas.vptCoords.br,m=this.getCoords(!0,d);return m.some(function(g){return g.x<=p.x&&g.x>=u.x&&g.y<=p.y&&g.y>=u.y})||this.intersectsWithRect(u,p,!0,d)?!0:this._containsCenterOfCanvas(u,p,d)},_containsCenterOfCanvas:function(d,u,p){var m={x:(d.x+u.x)/2,y:(d.y+u.y)/2};return!!this.containsPoint(m,null,!0,p)},isPartiallyOnScreen:function(d){if(!this.canvas)return!1;var u=this.canvas.vptCoords.tl,p=this.canvas.vptCoords.br;if(this.intersectsWithRect(u,p,!0,d))return!0;var m=this.getCoords(!0,d).every(function(g){return(g.x>=p.x||g.x<=u.x)&&(g.y>=p.y||g.y<=u.y)});return m&&this._containsCenterOfCanvas(u,p,d)},_getImageLines:function(d){var u={topline:{o:d.tl,d:d.tr},rightline:{o:d.tr,d:d.br},bottomline:{o:d.br,d:d.bl},leftline:{o:d.bl,d:d.tl}};return u},_findCrossPoints:function(d,u){var p,m,g,x,y,w=0,b;for(var S in u)if(b=u[S],!(b.o.y<d.y&&b.d.y<d.y)&&!(b.o.y>=d.y&&b.d.y>=d.y)&&(b.o.x===b.d.x&&b.o.x>=d.x?y=b.o.x:(p=0,m=(b.d.y-b.o.y)/(b.d.x-b.o.x),g=d.y-p*d.x,x=b.o.y-m*b.o.x,y=-(g-x)/(p-m)),y>=d.x&&(w+=1),w===2))break;return w},getBoundingRect:function(d,u){var p=this.getCoords(d,u);return a.makeBoundingBoxFromPoints(p)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(d){return Math.abs(d)<this.minScaleLimit?d<0?-this.minScaleLimit:this.minScaleLimit:d===0?1e-4:d},scale:function(d){return this._set("scaleX",d),this._set("scaleY",d),this.setCoords()},scaleToWidth:function(d,u){var p=this.getBoundingRect(u).width/this.getScaledWidth();return this.scale(d/this.width/p)},scaleToHeight:function(d,u){var p=this.getBoundingRect(u).height/this.getScaledHeight();return this.scale(d/this.height/p)},calcLineCoords:function(){var d=this.getViewportTransform(),u=this.padding,p=c(this.angle),m=a.cos(p),g=a.sin(p),x=m*u,y=g*u,w=x+y,b=x-y,S=this.calcACoords(),T={tl:h(S.tl,d),tr:h(S.tr,d),bl:h(S.bl,d),br:h(S.br,d)};return u&&(T.tl.x-=b,T.tl.y-=w,T.tr.x+=w,T.tr.y-=b,T.bl.x-=w,T.bl.y+=b,T.br.x+=b,T.br.y+=w),T},calcOCoords:function(){var d=this._calcRotateMatrix(),u=this._calcTranslateMatrix(),p=this.getViewportTransform(),m=f(p,u),g=f(m,d),g=f(g,[1/p[0],0,0,1/p[3],0,0]),x=this._calculateCurrentDimensions(),y={};return this.forEachControl(function(w,b,S){y[b]=w.positionHandler(x,g,S)}),y},calcACoords:function(){var d=this._calcRotateMatrix(),u=this._calcTranslateMatrix(),p=f(u,d),m=this._getTransformedDimensions(),g=m.x/2,x=m.y/2;return{tl:h({x:-g,y:-x},p),tr:h({x:g,y:-x},p),bl:h({x:-g,y:x},p),br:h({x:g,y:x},p)}},setCoords:function(d){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),d?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return a.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var d=this.getCenterPoint();return[1,0,0,1,d.x,d.y]},transformMatrixKey:function(d){var u="_",p="";return!d&&this.group&&(p=this.group.transformMatrixKey(d)+u),p+this.top+u+this.left+u+this.scaleX+u+this.scaleY+u+this.skewX+u+this.skewY+u+this.angle+u+this.originX+u+this.originY+u+this.width+u+this.height+u+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(d){var u=this.calcOwnMatrix();if(d||!this.group)return u;var p=this.transformMatrixKey(d),m=this.matrixCache||(this.matrixCache={});return m.key===p?m.value:(this.group&&(u=f(this.group.calcTransformMatrix(!1),u)),m.key=p,m.value=u,u)},calcOwnMatrix:function(){var d=this.transformMatrixKey(!0),u=this.ownMatrixCache||(this.ownMatrixCache={});if(u.key===d)return u.value;var p=this._calcTranslateMatrix(),m={angle:this.angle,translateX:p[4],translateY:p[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return u.key=d,u.value=a.composeMatrix(m),u.value},_getNonTransformedDimensions:function(){var d=this.strokeWidth,u=this.width+d,p=this.height+d;return{x:u,y:p}},_getTransformedDimensions:function(d,u){typeof d>"u"&&(d=this.skewX),typeof u>"u"&&(u=this.skewY);var p,m,g,x=d===0&&u===0;if(this.strokeUniform?(m=this.width,g=this.height):(p=this._getNonTransformedDimensions(),m=p.x,g=p.y),x)return this._finalizeDimensions(m*this.scaleX,g*this.scaleY);var y=a.sizeAfterTransform(m,g,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:d,skewY:u});return this._finalizeDimensions(y.x,y.y)},_finalizeDimensions:function(d,u){return this.strokeUniform?{x:d+this.strokeWidth,y:u+this.strokeWidth}:{x:d,y:u}},_calculateCurrentDimensions:function(){var d=this.getViewportTransform(),u=this._getTransformedDimensions(),p=h(u,d,!0);return p.scalarAdd(2*this.padding)}})}(),t.util.object.extend(t.Object.prototype,{sendToBack:function(){return this.group?t.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?t.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(o){return this.group?t.StaticCanvas.prototype.sendBackwards.call(this.group,this,o):this.canvas&&this.canvas.sendBackwards(this,o),this},bringForward:function(o){return this.group?t.StaticCanvas.prototype.bringForward.call(this.group,this,o):this.canvas&&this.canvas.bringForward(this,o),this},moveTo:function(o){return this.group&&this.group.type!=="activeSelection"?t.StaticCanvas.prototype.moveTo.call(this.group,this,o):this.canvas&&this.canvas.moveTo(this,o),this}}),function(){function o(c,f){if(f){if(f.toLive)return c+": url(#SVGID_"+f.id+"); ";var h=new t.Color(f),d=c+": "+h.toRgb()+"; ",u=h.getAlpha();return u!==1&&(d+=c+"-opacity: "+u.toString()+"; "),d}else return c+": none; "}var a=t.util.toFixed;t.util.object.extend(t.Object.prototype,{getSvgStyles:function(c){var f=this.fillRule?this.fillRule:"nonzero",h=this.strokeWidth?this.strokeWidth:"0",d=this.strokeDashArray?this.strokeDashArray.join(" "):"none",u=this.strokeDashOffset?this.strokeDashOffset:"0",p=this.strokeLineCap?this.strokeLineCap:"butt",m=this.strokeLineJoin?this.strokeLineJoin:"miter",g=this.strokeMiterLimit?this.strokeMiterLimit:"4",x=typeof this.opacity<"u"?this.opacity:"1",y=this.visible?"":" visibility: hidden;",w=c?"":this.getSvgFilter(),b=o("fill",this.fill),S=o("stroke",this.stroke);return[S,"stroke-width: ",h,"; ","stroke-dasharray: ",d,"; ","stroke-linecap: ",p,"; ","stroke-dashoffset: ",u,"; ","stroke-linejoin: ",m,"; ","stroke-miterlimit: ",g,"; ",b,"fill-rule: ",f,"; ","opacity: ",x,";",w,y].join("")},getSvgSpanStyles:function(c,f){var h="; ",u=c.fontFamily?"font-family: "+(c.fontFamily.indexOf("'")===-1&&c.fontFamily.indexOf('"')===-1?"'"+c.fontFamily+"'":c.fontFamily)+h:"",d=c.strokeWidth?"stroke-width: "+c.strokeWidth+h:"",u=u,p=c.fontSize?"font-size: "+c.fontSize+"px"+h:"",m=c.fontStyle?"font-style: "+c.fontStyle+h:"",g=c.fontWeight?"font-weight: "+c.fontWeight+h:"",x=c.fill?o("fill",c.fill):"",y=c.stroke?o("stroke",c.stroke):"",w=this.getSvgTextDecoration(c),b=c.deltaY?"baseline-shift: "+-c.deltaY+"; ":"";return w&&(w="text-decoration: "+w+h),[y,d,u,p,m,g,w,x,b,f?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(c){return["overline","underline","line-through"].filter(function(f){return c[f.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(c,f){var h=c?this.calcTransformMatrix():this.calcOwnMatrix(),d='transform="'+t.util.matrixToSVG(h);return d+(f||"")+'" '},_setSVGBg:function(c){if(this.backgroundColor){var f=t.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',a(-this.width/2,f),'" y="',a(-this.height/2,f),'" width="',a(this.width,f),'" height="',a(this.height,f),`"></rect>
`)}},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(c),{reviver:c})},toClipPathSVG:function(c){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(c),{reviver:c})},_createBaseClipPathSVGMarkup:function(c,f){f=f||{};var h=f.reviver,d=f.additionalTransform||"",u=[this.getSvgTransform(!0,d),this.getSvgCommons()].join(""),p=c.indexOf("COMMON_PARTS");return c[p]=u,h?h(c.join("")):c.join("")},_createBaseSVGMarkup:function(c,f){f=f||{};var h=f.noStyle,d=f.reviver,u=h?"":'style="'+this.getSvgStyles()+'" ',p=f.withShadow?'style="'+this.getSvgFilter()+'" ':"",m=this.clipPath,g=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",x=m&&m.absolutePositioned,y=this.stroke,w=this.fill,b=this.shadow,S,T=[],O,j=c.indexOf("COMMON_PARTS"),L=f.additionalTransform;return m&&(m.clipPathId="CLIPPATH_"+t.Object.__uid++,O='<clipPath id="'+m.clipPathId+`" >
`+m.toClipPathSVG(d)+`</clipPath>
`),x&&T.push("<g ",p,this.getSvgCommons(),` >
`),T.push("<g ",this.getSvgTransform(!1),x?"":p+this.getSvgCommons(),` >
`),S=[u,g,h?"":this.addPaintOrder()," ",L?'transform="'+L+'" ':""].join(""),c[j]=S,w&&w.toLive&&T.push(w.toSVG(this)),y&&y.toLive&&T.push(y.toSVG(this)),b&&T.push(b.toSVG(this)),m&&T.push(O),T.push(c.join("")),T.push(`</g>
`),x&&T.push(`</g>
`),d?d(T.join("")):T.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var o=t.util.object.extend,a="stateProperties";function c(h,d,u){var p={},m=!0;u.forEach(function(g){p[g]=h[g]}),o(h[d],p,m)}function f(h,d,u){if(h===d)return!0;if(Array.isArray(h)){if(!Array.isArray(d)||h.length!==d.length)return!1;for(var p=0,m=h.length;p<m;p++)if(!f(h[p],d[p]))return!1;return!0}else if(h&&typeof h=="object"){var g=Object.keys(h),x;if(!d||typeof d!="object"||!u&&g.length!==Object.keys(d).length)return!1;for(var p=0,m=g.length;p<m;p++)if(x=g[p],!(x==="canvas"||x==="group")&&!f(h[x],d[x]))return!1;return!0}}t.util.object.extend(t.Object.prototype,{hasStateChanged:function(h){h=h||a;var d="_"+h;return Object.keys(this[d]).length<this[h].length?!0:!f(this[d],this,!0)},saveState:function(h){var d=h&&h.propertySet||a,u="_"+d;return this[u]?(c(this,u,this[d]),h&&h.stateProperties&&c(this,u,h.stateProperties),this):this.setupState(h)},setupState:function(h){h=h||{};var d=h.propertySet||a;return h.propertySet=d,this["_"+d]={},this.saveState(h),this}})}(),function(){var o=t.util.degreesToRadians;t.util.object.extend(t.Object.prototype,{_findTargetCorner:function(a,c){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var f=a.x,h=a.y,d,u,p=Object.keys(this.oCoords),m=p.length-1,g;for(this.__corner=0;m>=0;m--)if(g=p[m],!!this.isControlVisible(g)&&(u=this._getImageLines(c?this.oCoords[g].touchCorner:this.oCoords[g].corner),d=this._findCrossPoints({x:f,y:h},u),d!==0&&d%2===1))return this.__corner=g,g;return!1},forEachControl:function(a){for(var c in this.controls)a(this.controls[c],c,this)},_setCornerCoords:function(){var a=this.oCoords;for(var c in a){var f=this.controls[c];a[c].corner=f.calcCornerCoords(this.angle,this.cornerSize,a[c].x,a[c].y,!1),a[c].touchCorner=f.calcCornerCoords(this.angle,this.touchCornerSize,a[c].x,a[c].y,!0)}},drawSelectionBackground:function(a){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;a.save();var c=this.getCenterPoint(),f=this._calculateCurrentDimensions(),h=this.canvas.viewportTransform;return a.translate(c.x,c.y),a.scale(1/h[0],1/h[3]),a.rotate(o(this.angle)),a.fillStyle=this.selectionBackgroundColor,a.fillRect(-f.x/2,-f.y/2,f.x,f.y),a.restore(),this},drawBorders:function(a,c){c=c||{};var f=this._calculateCurrentDimensions(),h=this.borderScaleFactor,d=f.x+h,u=f.y+h,p=typeof c.hasControls<"u"?c.hasControls:this.hasControls,m=!1;return a.save(),a.strokeStyle=c.borderColor||this.borderColor,this._setLineDash(a,c.borderDashArray||this.borderDashArray),a.strokeRect(-d/2,-u/2,d,u),p&&(a.beginPath(),this.forEachControl(function(g,x,y){g.withConnection&&g.getVisibility(y,x)&&(m=!0,a.moveTo(g.x*d,g.y*u),a.lineTo(g.x*d+g.offsetX,g.y*u+g.offsetY))}),m&&a.stroke()),a.restore(),this},drawBordersInGroup:function(a,c,f){f=f||{};var h=t.util.sizeAfterTransform(this.width,this.height,c),d=this.strokeWidth,u=this.strokeUniform,p=this.borderScaleFactor,m=h.x+d*(u?this.canvas.getZoom():c.scaleX)+p,g=h.y+d*(u?this.canvas.getZoom():c.scaleY)+p;return a.save(),this._setLineDash(a,f.borderDashArray||this.borderDashArray),a.strokeStyle=f.borderColor||this.borderColor,a.strokeRect(-m/2,-g/2,m,g),a.restore(),this},drawControls:function(a,c){c=c||{},a.save();var f=1,h,d;return this.canvas&&(f=this.canvas.getRetinaScaling()),a.setTransform(f,0,0,f,0,0),a.strokeStyle=a.fillStyle=c.cornerColor||this.cornerColor,this.transparentCorners||(a.strokeStyle=c.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(a,c.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(h=this.group.calcTransformMatrix()),this.forEachControl(function(u,p,m){d=m.oCoords[p],u.getVisibility(m,p)&&(h&&(d=t.util.transformPoint(d,h)),u.render(a,d.x,d.y,c,m))}),a.restore(),this},isControlVisible:function(a){return this.controls[a]&&this.controls[a].getVisibility(this,a)},setControlVisible:function(a,c){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[a]=c,this},setControlsVisibility:function(a){a||(a={});for(var c in a)this.setControlVisible(c,a[c]);return this},onDeselect:function(){},onSelect:function(){}})}(),t.util.object.extend(t.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(o,a){a=a||{};var c=function(){},f=a.onComplete||c,h=a.onChange||c,d=this;return t.util.animate({target:this,startValue:o.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(u){o.set("left",u),d.requestRenderAll(),h()},onComplete:function(){o.setCoords(),f()}})},fxCenterObjectV:function(o,a){a=a||{};var c=function(){},f=a.onComplete||c,h=a.onChange||c,d=this;return t.util.animate({target:this,startValue:o.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(u){o.set("top",u),d.requestRenderAll(),h()},onComplete:function(){o.setCoords(),f()}})},fxRemove:function(o,a){a=a||{};var c=function(){},f=a.onComplete||c,h=a.onChange||c,d=this;return t.util.animate({target:this,startValue:o.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(u){o.set("opacity",u),d.requestRenderAll(),h()},onComplete:function(){d.remove(o),f()}})}}),t.util.object.extend(t.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var o=[],a,c,f=[];for(a in arguments[0])o.push(a);for(var h=0,d=o.length;h<d;h++)a=o[h],c=h!==d-1,f.push(this._animate(a,arguments[0][a],arguments[1],c));return f}else return this._animate.apply(this,arguments)},_animate:function(o,a,c,f){var h=this,d;a=a.toString(),c?c=t.util.object.clone(c):c={},~o.indexOf(".")&&(d=o.split("."));var u=h.colorProperties.indexOf(o)>-1||d&&h.colorProperties.indexOf(d[1])>-1,p=d?this.get(d[0])[d[1]]:this.get(o);"from"in c||(c.from=p),u||(~a.indexOf("=")?a=p+parseFloat(a.replace("=","")):a=parseFloat(a));var m={target:this,startValue:c.from,endValue:a,byValue:c.by,easing:c.easing,duration:c.duration,abort:c.abort&&function(g,x,y){return c.abort.call(h,g,x,y)},onChange:function(g,x,y){d?h[d[0]][d[1]]=g:h.set(o,g),!f&&c.onChange&&c.onChange(g,x,y)},onComplete:function(g,x,y){f||(h.setCoords(),c.onComplete&&c.onComplete(g,x,y))}};return u?t.util.animateColor(m.startValue,m.endValue,m.duration,m):t.util.animate(m)}}),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,f=a.util.object.clone,h={x1:1,x2:1,y1:1,y2:1};if(a.Line){a.warn("fabric.Line is already defined");return}a.Line=a.util.createClass(a.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:a.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(u,p){u||(u=[0,0,0,0]),this.callSuper("initialize",p),this.set("x1",u[0]),this.set("y1",u[1]),this.set("x2",u[2]),this.set("y2",u[3]),this._setWidthHeight(p)},_setWidthHeight:function(u){u||(u={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in u?u.left:this._getLeftToOriginX(),this.top="top"in u?u.top:this._getTopToOriginY()},_set:function(u,p){return this.callSuper("_set",u,p),typeof h[u]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:d({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:d({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(u){u.beginPath();var p=this.calcLinePoints();u.moveTo(p.x1,p.y1),u.lineTo(p.x2,p.y2),u.lineWidth=this.strokeWidth;var m=u.strokeStyle;u.strokeStyle=this.stroke||u.fillStyle,this.stroke&&this._renderStroke(u),u.strokeStyle=m},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(u){return c(this.callSuper("toObject",u),this.calcLinePoints())},_getNonTransformedDimensions:function(){var u=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(u.y-=this.strokeWidth),this.height===0&&(u.x-=this.strokeWidth)),u},calcLinePoints:function(){var u=this.x1<=this.x2?-1:1,p=this.y1<=this.y2?-1:1,m=u*this.width*.5,g=p*this.height*.5,x=u*this.width*-.5,y=p*this.height*-.5;return{x1:m,x2:x,y1:g,y2:y}},_toSVG:function(){var u=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',u.x1,'" y1="',u.y1,'" x2="',u.x2,'" y2="',u.y2,`" />
`]}}),a.Line.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),a.Line.fromElement=function(u,p,m){m=m||{};var g=a.parseAttributes(u,a.Line.ATTRIBUTE_NAMES),x=[g.x1||0,g.y1||0,g.x2||0,g.y2||0];p(new a.Line(x,c(g,m)))},a.Line.fromObject=function(u,p){function m(x){delete x.points,p&&p(x)}var g=f(u,!0);g.points=[u.x1,u.y1,u.x2,u.y2],a.Object._fromObject("Line",g,m,"points")};function d(u,p){var m=u.origin,g=u.axis1,x=u.axis2,y=u.dimension,w=p.nearest,b=p.center,S=p.farthest;return function(){switch(this.get(m)){case w:return Math.min(this.get(g),this.get(x));case b:return Math.min(this.get(g),this.get(x))+.5*this.get(y);case S:return Math.max(this.get(g),this.get(x))}}}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.degreesToRadians;if(a.Circle){a.warn("fabric.Circle is already defined.");return}a.Circle=a.util.createClass(a.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:a.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(h,d){return this.callSuper("_set",h,d),h==="radius"&&this.setRadius(d),this},toObject:function(h){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(h))},_toSVG:function(){var h,d=0,u=0,p=(this.endAngle-this.startAngle)%360;if(p===0)h=["<circle ","COMMON_PARTS",'cx="'+d+'" cy="'+u+'" ','r="',this.radius,`" />
`];else{var m=c(this.startAngle),g=c(this.endAngle),x=this.radius,y=a.util.cos(m)*x,w=a.util.sin(m)*x,b=a.util.cos(g)*x,S=a.util.sin(g)*x,T=p>180?"1":"0";h=['<path d="M '+y+" "+w," A "+x+" "+x," 0 ",+T+" 1"," "+b+" "+S,'" ',"COMMON_PARTS",` />
`]}return h},_render:function(h){h.beginPath(),h.arc(0,0,this.radius,c(this.startAngle),c(this.endAngle),!1),this._renderPaintInOrder(h)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(h){return this.radius=h,this.set("width",h*2).set("height",h*2)}}),a.Circle.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),a.Circle.fromElement=function(h,d){var u=a.parseAttributes(h,a.Circle.ATTRIBUTE_NAMES);if(!f(u))throw new Error("value of `r` attribute is required and can not be negative");u.left=(u.left||0)-u.radius,u.top=(u.top||0)-u.radius,d(new a.Circle(u))};function f(h){return"radius"in h&&h.radius>=0}a.Circle.fromObject=function(h,d){a.Object._fromObject("Circle",h,d)}}(e),function(o){var a=o.fabric||(o.fabric={});if(a.Triangle){a.warn("fabric.Triangle is already defined");return}a.Triangle=a.util.createClass(a.Object,{type:"triangle",width:100,height:100,_render:function(c){var f=this.width/2,h=this.height/2;c.beginPath(),c.moveTo(-f,h),c.lineTo(0,-h),c.lineTo(f,h),c.closePath(),this._renderPaintInOrder(c)},_toSVG:function(){var c=this.width/2,f=this.height/2,h=[-c+" "+f,"0 "+-f,c+" "+f].join(",");return["<polygon ","COMMON_PARTS",'points="',h,'" />']}}),a.Triangle.fromObject=function(c,f){return a.Object._fromObject("Triangle",c,f)}}(e),function(o){var a=o.fabric||(o.fabric={}),c=Math.PI*2;if(a.Ellipse){a.warn("fabric.Ellipse is already defined.");return}a.Ellipse=a.util.createClass(a.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:a.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(f){this.callSuper("initialize",f),this.set("rx",f&&f.rx||0),this.set("ry",f&&f.ry||0)},_set:function(f,h){switch(this.callSuper("_set",f,h),f){case"rx":this.rx=h,this.set("width",h*2);break;case"ry":this.ry=h,this.set("height",h*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(f){return this.callSuper("toObject",["rx","ry"].concat(f))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(f){f.beginPath(),f.save(),f.transform(1,0,0,this.ry/this.rx,0,0),f.arc(0,0,this.rx,0,c,!1),f.restore(),this._renderPaintInOrder(f)}}),a.Ellipse.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),a.Ellipse.fromElement=function(f,h){var d=a.parseAttributes(f,a.Ellipse.ATTRIBUTE_NAMES);d.left=(d.left||0)-d.rx,d.top=(d.top||0)-d.ry,h(new a.Ellipse(d))},a.Ellipse.fromObject=function(f,h){a.Object._fromObject("Ellipse",f,h)}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend;if(a.Rect){a.warn("fabric.Rect is already defined");return}a.Rect=a.util.createClass(a.Object,{stateProperties:a.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:a.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(f){this.callSuper("initialize",f),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(f){var h=this.rx?Math.min(this.rx,this.width/2):0,d=this.ry?Math.min(this.ry,this.height/2):0,u=this.width,p=this.height,m=-this.width/2,g=-this.height/2,x=h!==0||d!==0,y=1-.5522847498;f.beginPath(),f.moveTo(m+h,g),f.lineTo(m+u-h,g),x&&f.bezierCurveTo(m+u-y*h,g,m+u,g+y*d,m+u,g+d),f.lineTo(m+u,g+p-d),x&&f.bezierCurveTo(m+u,g+p-y*d,m+u-y*h,g+p,m+u-h,g+p),f.lineTo(m+h,g+p),x&&f.bezierCurveTo(m+y*h,g+p,m,g+p-y*d,m,g+p-d),f.lineTo(m,g+d),x&&f.bezierCurveTo(m,g+y*d,m+y*h,g,m+h,g),f.closePath(),this._renderPaintInOrder(f)},toObject:function(f){return this.callSuper("toObject",["rx","ry"].concat(f))},_toSVG:function(){var f=-this.width/2,h=-this.height/2;return["<rect ","COMMON_PARTS",'x="',f,'" y="',h,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),a.Rect.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),a.Rect.fromElement=function(f,h,d){if(!f)return h(null);d=d||{};var u=a.parseAttributes(f,a.Rect.ATTRIBUTE_NAMES);u.left=u.left||0,u.top=u.top||0,u.height=u.height||0,u.width=u.width||0;var p=new a.Rect(c(d?a.util.object.clone(d):{},u));p.visible=p.visible&&p.width>0&&p.height>0,h(p)},a.Rect.fromObject=function(f,h){return a.Object._fromObject("Rect",f,h)}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,f=a.util.array.min,h=a.util.array.max,d=a.util.toFixed,u=a.util.projectStrokeOnPoints;if(a.Polyline){a.warn("fabric.Polyline is already defined");return}a.Polyline=a.util.createClass(a.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:a.Object.prototype.cacheProperties.concat("points"),initialize:function(p,m){m=m||{},this.points=p||[],this.callSuper("initialize",m),this._setPositionDimensions(m)},_projectStrokeOnPoints:function(){return u(this.points,this,!0)},_setPositionDimensions:function(p){var m=this._calcDimensions(p),g,x=this.exactBoundingBox?this.strokeWidth:0;this.width=m.width-x,this.height=m.height-x,p.fromSVG||(g=this.translateToGivenOrigin({x:m.left-this.strokeWidth/2+x/2,y:m.top-this.strokeWidth/2+x/2},"left","top",this.originX,this.originY)),typeof p.left>"u"&&(this.left=p.fromSVG?m.left:g.x),typeof p.top>"u"&&(this.top=p.fromSVG?m.top:g.y),this.pathOffset={x:m.left+this.width/2+x/2,y:m.top+this.height/2+x/2}},_calcDimensions:function(){var p=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,m=f(p,"x")||0,g=f(p,"y")||0,x=h(p,"x")||0,y=h(p,"y")||0,w=x-m,b=y-g;return{left:m,top:g,width:w,height:b}},toObject:function(p){return c(this.callSuper("toObject",p),{points:this.points.concat()})},_toSVG:function(){for(var p=[],m=this.pathOffset.x,g=this.pathOffset.y,x=a.Object.NUM_FRACTION_DIGITS,y=0,w=this.points.length;y<w;y++)p.push(d(this.points[y].x-m,x),",",d(this.points[y].y-g,x)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',p.join(""),`" />
`]},commonRender:function(p){var m,g=this.points.length,x=this.pathOffset.x,y=this.pathOffset.y;if(!g||isNaN(this.points[g-1].y))return!1;p.beginPath(),p.moveTo(this.points[0].x-x,this.points[0].y-y);for(var w=0;w<g;w++)m=this.points[w],p.lineTo(m.x-x,m.y-y);return!0},_render:function(p){this.commonRender(p)&&this._renderPaintInOrder(p)},complexity:function(){return this.get("points").length}}),a.Polyline.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat(),a.Polyline.fromElementGenerator=function(p){return function(m,g,x){if(!m)return g(null);x||(x={});var y=a.parsePointsAttribute(m.getAttribute("points")),w=a.parseAttributes(m,a[p].ATTRIBUTE_NAMES);w.fromSVG=!0,g(new a[p](y,c(w,x)))}},a.Polyline.fromElement=a.Polyline.fromElementGenerator("Polyline"),a.Polyline.fromObject=function(p,m){return a.Object._fromObject("Polyline",p,m,"points")}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.projectStrokeOnPoints;if(a.Polygon){a.warn("fabric.Polygon is already defined");return}a.Polygon=a.util.createClass(a.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return c(this.points,this)},_render:function(f){this.commonRender(f)&&(f.closePath(),this._renderPaintInOrder(f))}}),a.Polygon.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat(),a.Polygon.fromElement=a.Polyline.fromElementGenerator("Polygon"),a.Polygon.fromObject=function(f,h){a.Object._fromObject("Polygon",f,h,"points")}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.array.min,f=a.util.array.max,h=a.util.object.extend,d=a.util.object.clone,u=a.util.toFixed;if(a.Path){a.warn("fabric.Path is already defined");return}a.Path=a.util.createClass(a.Object,{type:"path",path:null,cacheProperties:a.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:a.Object.prototype.stateProperties.concat("path"),initialize:function(p,m){m=d(m||{}),delete m.path,this.callSuper("initialize",m),this._setPath(p||[],m)},_setPath:function(p,m){this.path=a.util.makePathSimpler(Array.isArray(p)?p:a.util.parsePath(p)),a.Polyline.prototype._setPositionDimensions.call(this,m||{})},_renderPathCommands:function(p){var m,g=0,x=0,y=0,w=0,b=0,S=0,T=-this.pathOffset.x,O=-this.pathOffset.y;p.beginPath();for(var j=0,L=this.path.length;j<L;++j)switch(m=this.path[j],m[0]){case"L":y=m[1],w=m[2],p.lineTo(y+T,w+O);break;case"M":y=m[1],w=m[2],g=y,x=w,p.moveTo(y+T,w+O);break;case"C":y=m[5],w=m[6],b=m[3],S=m[4],p.bezierCurveTo(m[1]+T,m[2]+O,b+T,S+O,y+T,w+O);break;case"Q":p.quadraticCurveTo(m[1]+T,m[2]+O,m[3]+T,m[4]+O),y=m[3],w=m[4],b=m[1],S=m[2];break;case"z":case"Z":y=g,w=x,p.closePath();break}},_render:function(p){this._renderPathCommands(p),this._renderPaintInOrder(p)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(p){return h(this.callSuper("toObject",p),{path:this.path.map(function(m){return m.slice()})})},toDatalessObject:function(p){var m=this.toObject(["sourcePath"].concat(p));return m.sourcePath&&delete m.path,m},_toSVG:function(){var p=a.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',p,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var p=a.Object.NUM_FRACTION_DIGITS;return" translate("+u(-this.pathOffset.x,p)+", "+u(-this.pathOffset.y,p)+")"},toClipPathSVG:function(p){var m=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:p,additionalTransform:m})},toSVG:function(p){var m=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:p,additionalTransform:m})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var p=[],m=[],g,x=0,y=0,w=0,b=0,S,T=0,O=this.path.length;T<O;++T){switch(g=this.path[T],g[0]){case"L":w=g[1],b=g[2],S=[];break;case"M":w=g[1],b=g[2],x=w,y=b,S=[];break;case"C":S=a.util.getBoundsOfCurve(w,b,g[1],g[2],g[3],g[4],g[5],g[6]),w=g[5],b=g[6];break;case"Q":S=a.util.getBoundsOfCurve(w,b,g[1],g[2],g[1],g[2],g[3],g[4]),w=g[3],b=g[4];break;case"z":case"Z":w=x,b=y;break}S.forEach(function(G){p.push(G.x),m.push(G.y)}),p.push(w),m.push(b)}var j=c(p)||0,L=c(m)||0,W=f(p)||0,F=f(m)||0,M=W-j,V=F-L;return{left:j,top:L,width:M,height:V}}}),a.Path.fromObject=function(p,m){if(typeof p.sourcePath=="string"){var g=p.sourcePath;a.loadSVGFromURL(g,function(x){var y=x[0];y.setOptions(p),p.clipPath?a.util.enlivenObjects([p.clipPath],function(w){y.clipPath=w[0],m&&m(y)}):m&&m(y)})}else a.Object._fromObject("Path",p,m,"path")},a.Path.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat(["d"]),a.Path.fromElement=function(p,m,g){var x=a.parseAttributes(p,a.Path.ATTRIBUTE_NAMES);x.fromSVG=!0,m(new a.Path(x.d,h(x,g)))}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.array.min,f=a.util.array.max;a.Group||(a.Group=a.util.createClass(a.Object,a.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(h,d,u){d=d||{},this._objects=[],u&&this.callSuper("initialize",d),this._objects=h||[];for(var p=this._objects.length;p--;)this._objects[p].group=this;if(u)this._updateObjectsACoords();else{var m=d&&d.centerPoint;d.originX!==void 0&&(this.originX=d.originX),d.originY!==void 0&&(this.originY=d.originY),m||this._calcBounds(),this._updateObjectsCoords(m),delete d.centerPoint,this.callSuper("initialize",d)}this.setCoords()},_updateObjectsACoords:function(){for(var h=!0,d=this._objects.length;d--;)this._objects[d].setCoords(h)},_updateObjectsCoords:function(d){for(var d=d||this.getCenterPoint(),u=this._objects.length;u--;)this._updateObjectCoords(this._objects[u],d)},_updateObjectCoords:function(h,d){var u=h.left,p=h.top,m=!0;h.set({left:u-d.x,top:p-d.y}),h.group=this,h.setCoords(m)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(h){var d=!!this.group;return this._restoreObjectsState(),a.util.resetObjectTransform(this),h&&(d&&a.util.removeTransformFromObject(h,this.group.calcTransformMatrix()),this._objects.push(h),h.group=this,h._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,d?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(h){return this._restoreObjectsState(),a.util.resetObjectTransform(this),this.remove(h),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(h){this.dirty=!0,h.group=this,h._set("canvas",this.canvas)},_onObjectRemoved:function(h){this.dirty=!0,delete h.group},_set:function(h,d){var u=this._objects.length;if(this.useSetOnGroup)for(;u--;)this._objects[u].setOnGroup(h,d);if(h==="canvas")for(;u--;)this._objects[u]._set(h,d);a.Object.prototype._set.call(this,h,d)},toObject:function(h){var d=this.includeDefaultValues,u=this._objects.filter(function(m){return!m.excludeFromExport}).map(function(m){var g=m.includeDefaultValues;m.includeDefaultValues=d;var x=m.toObject(h);return m.includeDefaultValues=g,x}),p=a.Object.prototype.toObject.call(this,h);return p.objects=u,p},toDatalessObject:function(h){var d,u=this.sourcePath;if(u)d=u;else{var p=this.includeDefaultValues;d=this._objects.map(function(g){var x=g.includeDefaultValues;g.includeDefaultValues=p;var y=g.toDatalessObject(h);return g.includeDefaultValues=x,y})}var m=a.Object.prototype.toDatalessObject.call(this,h);return m.objects=d,m},render:function(h){this._transformDone=!0,this.callSuper("render",h),this._transformDone=!1},shouldCache:function(){var h=a.Object.prototype.shouldCache.call(this);if(h){for(var d=0,u=this._objects.length;d<u;d++)if(this._objects[d].willDrawShadow())return this.ownCaching=!1,!1}return h},willDrawShadow:function(){if(a.Object.prototype.willDrawShadow.call(this))return!0;for(var h=0,d=this._objects.length;h<d;h++)if(this._objects[h].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(h){for(var d=0,u=this._objects.length;d<u;d++)this._objects[d].render(h);this._drawClipPath(h,this.clipPath)},isCacheDirty:function(h){if(this.callSuper("isCacheDirty",h))return!0;if(!this.statefullCache)return!1;for(var d=0,u=this._objects.length;d<u;d++)if(this._objects[d].isCacheDirty(!0)){if(this._cacheCanvas){var p=this.cacheWidth/this.zoomX,m=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-p/2,-m/2,p,m)}return!0}return!1},_restoreObjectsState:function(){var h=this.calcOwnMatrix();return this._objects.forEach(function(d){a.util.addTransformToObject(d,h),delete d.group,d.setCoords()}),this},destroy:function(){return this._objects.forEach(function(h){h.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(h){h.dispose&&h.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var h=this._objects,d=this.canvas;this._objects=[];var u=this.toObject();delete u.objects;var p=new a.ActiveSelection([]);return p.set(u),p.type="activeSelection",d.remove(this),h.forEach(function(m){m.group=p,m.dirty=!0,d.add(m)}),p.canvas=d,p._objects=h,d._activeObject=p,p.setCoords(),p}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var h=!0;return this.forEachObject(function(d){d.setCoords(h)}),this},_calcBounds:function(h){for(var d=[],u=[],p,m,g,x=["tr","br","bl","tl"],y=0,w=this._objects.length,b,S=x.length;y<w;++y){for(p=this._objects[y],g=p.calcACoords(),b=0;b<S;b++)m=x[b],d.push(g[m].x),u.push(g[m].y);p.aCoords=g}this._getBounds(d,u,h)},_getBounds:function(h,d,u){var p=new a.Point(c(h),c(d)),m=new a.Point(f(h),f(d)),g=p.y||0,x=p.x||0,y=m.x-p.x||0,w=m.y-p.y||0;this.width=y,this.height=w,u||this.setPositionByOrigin({x,y:g},"left","top")},_toSVG:function(h){for(var d=["<g ","COMMON_PARTS",` >
`],u=0,p=this._objects.length;u<p;u++)d.push("		",this._objects[u].toSVG(h));return d.push(`</g>
`),d},getSvgStyles:function(){var h=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",d=this.visible?"":" visibility: hidden;";return[h,this.getSvgFilter(),d].join("")},toClipPathSVG:function(h){for(var d=[],u=0,p=this._objects.length;u<p;u++)d.push("	",this._objects[u].toClipPathSVG(h));return this._createBaseClipPathSVGMarkup(d,{reviver:h})}}),a.Group.fromObject=function(h,d){var u=h.objects,p=a.util.object.clone(h,!0);if(delete p.objects,typeof u=="string"){a.loadSVGFromURL(u,function(m){var g=a.util.groupSVGElements(m,h,u),x=p.clipPath;delete p.clipPath,g.set(p),x?a.util.enlivenObjects([x],function(y){g.clipPath=y[0],d&&d(g)}):d&&d(g)});return}a.util.enlivenObjects(u,function(m){a.util.enlivenObjectEnlivables(h,p,function(){d&&d(new a.Group(m,p,!0))})})})}(e),function(o){var a=o.fabric||(o.fabric={});a.ActiveSelection||(a.ActiveSelection=a.util.createClass(a.Group,{type:"activeSelection",initialize:function(c,f){f=f||{},this._objects=c||[];for(var h=this._objects.length;h--;)this._objects[h].group=this;f.originX&&(this.originX=f.originX),f.originY&&(this.originY=f.originY),this._calcBounds(),this._updateObjectsCoords(),a.Object.prototype.initialize.call(this,f),this.setCoords()},toGroup:function(){var c=this._objects.concat();this._objects=[];var f=a.Object.prototype.toObject.call(this),h=new a.Group([]);if(delete f.type,h.set(f),c.forEach(function(u){u.canvas.remove(u),u.group=h}),h._objects=c,!this.canvas)return h;var d=this.canvas;return d.add(h),d._activeObject=h,h.setCoords(),h},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(c,f,h){c.save(),c.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,h=h||{},typeof h.hasControls>"u"&&(h.hasControls=!1),h.forActiveSelection=!0;for(var d=0,u=this._objects.length;d<u;d++)this._objects[d]._renderControls(c,h);this.callSuper("_renderControls",c,f),c.restore()}}),a.ActiveSelection.fromObject=function(c,f){a.util.enlivenObjects(c.objects,function(h){delete c.objects,f&&f(new a.ActiveSelection(h,c,!0))})})}(e),function(o){var a=t.util.object.extend;if(o.fabric||(o.fabric={}),o.fabric.Image){t.warn("fabric.Image is already defined.");return}t.Image=t.util.createClass(t.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:t.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:t.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(c,f){f||(f={}),this.filters=[],this.cacheKey="texture"+t.Object.__uid++,this.callSuper("initialize",f),this._initElement(c,f)},getElement:function(){return this._element||{}},setElement:function(c,f){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=c,this._originalElement=c,this._initConfig(f),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(c){var f=t.filterBackend;f&&f.evictCachesForKey&&f.evictCachesForKey(c)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((function(c){t.util.cleanUpJsdomNode(this[c]),this[c]=void 0}).bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var c=this.getElement();return{width:c.naturalWidth||c.width,height:c.naturalHeight||c.height}},_stroke:function(c){if(!(!this.stroke||this.strokeWidth===0)){var f=this.width/2,h=this.height/2;c.beginPath(),c.moveTo(-f,-h),c.lineTo(f,-h),c.lineTo(f,h),c.lineTo(-f,h),c.lineTo(-f,-h),c.closePath()}},toObject:function(c){var f=[];this.filters.forEach(function(d){d&&f.push(d.toObject())});var h=a(this.callSuper("toObject",["cropX","cropY"].concat(c)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:f});return this.resizeFilter&&(h.resizeFilter=this.resizeFilter.toObject()),h},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var c=[],f=[],h,d=this._element,u=-this.width/2,p=-this.height/2,m="",g="";if(!d)return[];if(this.hasCrop()){var x=t.Object.__uid++;c.push('<clipPath id="imageCrop_'+x+`">
`,'	<rect x="'+u+'" y="'+p+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),m=' clip-path="url(#imageCrop_'+x+')" '}if(this.imageSmoothing||(g='" image-rendering="optimizeSpeed'),f.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',u-this.cropX,'" y="',p-this.cropY,'" width="',d.width||d.naturalWidth,'" height="',d.height||d.height,g,'"',m,`></image>
`),this.stroke||this.strokeDashArray){var y=this.fill;this.fill=null,h=["	<rect ",'x="',u,'" y="',p,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=y}return this.paintFirst!=="fill"?c=c.concat(h,f):c=c.concat(f,h),c},getSrc:function(c){var f=c?this._element:this._originalElement;return f?f.toDataURL?f.toDataURL():this.srcFromAttribute?f.getAttribute("src"):f.src:this.src||""},setSrc:function(c,f,h){return t.util.loadImage(c,function(d,u){this.setElement(d,h),this._setWidthHeight(),f&&f(this,u)},this,h&&h.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var c=this.resizeFilter,f=this.minimumScaleTrigger,h=this.getTotalObjectScaling(),d=h.scaleX,u=h.scaleY,p=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!c||d>f&&u>f){this._element=p,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=d,this._lastScaleY=u;return}t.filterBackend||(t.filterBackend=t.initFilterBackend());var m=t.util.createCanvasElement(),g=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,x=p.width,y=p.height;m.width=x,m.height=y,this._element=m,this._lastScaleX=c.scaleX=d,this._lastScaleY=c.scaleY=u,t.filterBackend.applyFilters([c],p,x,y,this._element,g),this._filterScalingX=m.width/this._originalElement.width,this._filterScalingY=m.height/this._originalElement.height},applyFilters:function(c){if(c=c||this.filters||[],c=c.filter(function(p){return p&&!p.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),c.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var f=this._originalElement,h=f.naturalWidth||f.width,d=f.naturalHeight||f.height;if(this._element===this._originalElement){var u=t.util.createCanvasElement();u.width=h,u.height=d,this._element=u,this._filteredEl=u}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,h,d),this._lastScaleX=1,this._lastScaleY=1;return t.filterBackend||(t.filterBackend=t.initFilterBackend()),t.filterBackend.applyFilters(c,this._originalElement,h,d,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(c){t.util.setImageSmoothing(c,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(c),this._renderPaintInOrder(c)},drawCacheOnCanvas:function(c){t.util.setImageSmoothing(c,this.imageSmoothing),t.Object.prototype.drawCacheOnCanvas.call(this,c)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(c){var f=this._element;if(f){var h=this._filterScalingX,d=this._filterScalingY,u=this.width,p=this.height,m=Math.min,g=Math.max,x=g(this.cropX,0),y=g(this.cropY,0),w=f.naturalWidth||f.width,b=f.naturalHeight||f.height,S=x*h,T=y*d,O=m(u*h,w-S),j=m(p*d,b-T),L=-u/2,W=-p/2,F=m(u,w/h-x),M=m(p,b/d-y);f&&c.drawImage(f,S,T,O,j,L,W,F,M)}},_needsResize:function(){var c=this.getTotalObjectScaling();return c.scaleX!==this._lastScaleX||c.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(c,f){this.setElement(t.util.getById(c),f),t.util.addClass(this.getElement(),t.Image.CSS_CANVAS)},_initConfig:function(c){c||(c={}),this.setOptions(c),this._setWidthHeight(c)},_initFilters:function(c,f){c&&c.length?t.util.enlivenObjects(c,function(h){f&&f(h)},"fabric.Image.filters"):f&&f()},_setWidthHeight:function(c){c||(c={});var f=this.getElement();this.width=c.width||f.naturalWidth||f.width||0,this.height=c.height||f.naturalHeight||f.height||0},parsePreserveAspectRatioAttribute:function(){var c=t.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),f=this._element.width,h=this._element.height,d=1,u=1,p=0,m=0,g=0,x=0,y,w=this.width,b=this.height,S={width:w,height:b};return c&&(c.alignX!=="none"||c.alignY!=="none")?(c.meetOrSlice==="meet"&&(d=u=t.util.findScaleToFit(this._element,S),y=(w-f*d)/2,c.alignX==="Min"&&(p=-y),c.alignX==="Max"&&(p=y),y=(b-h*u)/2,c.alignY==="Min"&&(m=-y),c.alignY==="Max"&&(m=y)),c.meetOrSlice==="slice"&&(d=u=t.util.findScaleToCover(this._element,S),y=f-w/d,c.alignX==="Mid"&&(g=y/2),c.alignX==="Max"&&(g=y),y=h-b/u,c.alignY==="Mid"&&(x=y/2),c.alignY==="Max"&&(x=y),f=w/d,h=b/u)):(d=w/f,u=b/h),{width:f,height:h,scaleX:d,scaleY:u,offsetLeft:p,offsetTop:m,cropX:g,cropY:x}}}),t.Image.CSS_CANVAS="canvas-img",t.Image.prototype.getSvgSrc=t.Image.prototype.getSrc,t.Image.fromObject=function(c,f){var h=t.util.object.clone(c);t.util.loadImage(h.src,function(d,u){if(u){f&&f(null,!0);return}t.Image.prototype._initFilters.call(h,h.filters,function(p){h.filters=p||[],t.Image.prototype._initFilters.call(h,[h.resizeFilter],function(m){h.resizeFilter=m[0],t.util.enlivenObjectEnlivables(h,h,function(){var g=new t.Image(d,h);f(g,!1)})})})},null,h.crossOrigin)},t.Image.fromURL=function(c,f,h){t.util.loadImage(c,function(d,u){f&&f(new t.Image(d,h),u)},null,h&&h.crossOrigin)},t.Image.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),t.Image.fromElement=function(c,f,h){var d=t.parseAttributes(c,t.Image.ATTRIBUTE_NAMES);t.Image.fromURL(d["xlink:href"],f,a(h?t.util.object.clone(h):{},d))}}(e),t.util.object.extend(t.Object.prototype,{_getAngleValueForStraighten:function(){var o=this.angle%360;return o>0?Math.round((o-1)/90)*90:Math.round(o/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(o){o=o||{};var a=function(){},c=o.onComplete||a,f=o.onChange||a,h=this;return t.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(d){h.rotate(d),f()},onComplete:function(){h.setCoords(),c()}})}}),t.util.object.extend(t.StaticCanvas.prototype,{straightenObject:function(o){return o.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(o){return o.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function o(c,f){var h="precision "+f+` float;
void main(){}`,d=c.createShader(c.FRAGMENT_SHADER);return c.shaderSource(d,h),c.compileShader(d),!!c.getShaderParameter(d,c.COMPILE_STATUS)}t.isWebglSupported=function(c){if(t.isLikelyNode)return!1;c=c||t.WebglFilterBackend.prototype.tileSize;var f=document.createElement("canvas"),h=f.getContext("webgl")||f.getContext("experimental-webgl"),d=!1;if(h){t.maxTextureSize=h.getParameter(h.MAX_TEXTURE_SIZE),d=t.maxTextureSize>=c;for(var u=["highp","mediump","lowp"],p=0;p<3;p++)if(o(h,u[p])){t.webGlPrecision=u[p];break}}return this.isSupported=d,d},t.WebglFilterBackend=a;function a(c){c&&c.tileSize&&(this.tileSize=c.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}a.prototype={tileSize:2048,resources:{},setupGLContext:function(c,f){this.dispose(),this.createWebGLCanvas(c,f),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(c,f)},chooseFastestCopyGLTo2DMethod:function(c,f){var h=typeof window.performance<"u",d;try{new ImageData(1,1),d=!0}catch{d=!1}var u=typeof ArrayBuffer<"u",p=typeof Uint8ClampedArray<"u";if(h&&d&&u&&p){var m=t.util.createCanvasElement(),g=new ArrayBuffer(c*f*4);if(t.forceGLPutImageData){this.imageBuffer=g,this.copyGLTo2D=l;return}var x={imageBuffer:g,destinationWidth:c,destinationHeight:f,targetCanvas:m},y,w,b;m.width=c,m.height=f,y=window.performance.now(),s.call(x,this.gl,x),w=window.performance.now()-y,y=window.performance.now(),l.call(x,this.gl,x),b=window.performance.now()-y,w>b?(this.imageBuffer=g,this.copyGLTo2D=l):this.copyGLTo2D=s}},createWebGLCanvas:function(c,f){var h=t.util.createCanvasElement();h.width=c,h.height=f;var d={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},u=h.getContext("webgl",d);u||(u=h.getContext("experimental-webgl",d)),u&&(u.clearColor(0,0,0,0),this.canvas=h,this.gl=u)},applyFilters:function(c,f,h,d,u,p){var m=this.gl,g;p&&(g=this.getCachedTexture(p,f));var x={originalWidth:f.width||f.originalWidth,originalHeight:f.height||f.originalHeight,sourceWidth:h,sourceHeight:d,destinationWidth:h,destinationHeight:d,context:m,sourceTexture:this.createTexture(m,h,d,!g&&f),targetTexture:this.createTexture(m,h,d),originalTexture:g||this.createTexture(m,h,d,!g&&f),passes:c.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:u},y=m.createFramebuffer();return m.bindFramebuffer(m.FRAMEBUFFER,y),c.forEach(function(w){w&&w.applyTo(x)}),i(x),this.copyGLTo2D(m,x),m.bindTexture(m.TEXTURE_2D,null),m.deleteTexture(x.sourceTexture),m.deleteTexture(x.targetTexture),m.deleteFramebuffer(y),u.getContext("2d").setTransform(1,0,0,1,0,0),x},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(c,f,h,d,u){var p=c.createTexture();return c.bindTexture(c.TEXTURE_2D,p),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,u||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,u||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),d?c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,d):c.texImage2D(c.TEXTURE_2D,0,c.RGBA,f,h,0,c.RGBA,c.UNSIGNED_BYTE,null),p},getCachedTexture:function(c,f){if(this.textureCache[c])return this.textureCache[c];var h=this.createTexture(this.gl,f.width,f.height,f);return this.textureCache[c]=h,h},evictCachesForKey:function(c){this.textureCache[c]&&(this.gl.deleteTexture(this.textureCache[c]),delete this.textureCache[c])},copyGLTo2D:s,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var c=this.gl,f={renderer:"",vendor:""};if(!c)return f;var h=c.getExtension("WEBGL_debug_renderer_info");if(h){var d=c.getParameter(h.UNMASKED_RENDERER_WEBGL),u=c.getParameter(h.UNMASKED_VENDOR_WEBGL);d&&(f.renderer=d.toLowerCase()),u&&(f.vendor=u.toLowerCase())}return this.gpuInfo=f,f}}}();function i(o){var a=o.targetCanvas,c=a.width,f=a.height,h=o.destinationWidth,d=o.destinationHeight;(c!==h||f!==d)&&(a.width=h,a.height=d)}function s(o,a){var c=o.canvas,f=a.targetCanvas,h=f.getContext("2d");h.translate(0,f.height),h.scale(1,-1);var d=c.height-f.height;h.drawImage(c,0,d,f.width,f.height,0,0,f.width,f.height)}function l(o,a){var c=a.targetCanvas,f=c.getContext("2d"),h=a.destinationWidth,d=a.destinationHeight,u=h*d*4,p=new Uint8Array(this.imageBuffer,0,u),m=new Uint8ClampedArray(this.imageBuffer,0,u);o.readPixels(0,0,h,d,o.RGBA,o.UNSIGNED_BYTE,p);var g=new ImageData(m,h,d);f.putImageData(g,0,0)}(function(){var o=function(){};t.Canvas2dFilterBackend=a;function a(){}a.prototype={evictCachesForKey:o,dispose:o,clearWebGLCaches:o,resources:{},applyFilters:function(c,f,h,d,u){var p=u.getContext("2d");p.drawImage(f,0,0,h,d);var m=p.getImageData(0,0,h,d),g=p.getImageData(0,0,h,d),x={sourceWidth:h,sourceHeight:d,imageData:m,originalEl:f,originalImageData:g,canvasEl:u,ctx:p,filterBackend:this};return c.forEach(function(y){y.applyTo(x)}),(x.imageData.width!==h||x.imageData.height!==d)&&(u.width=x.imageData.width,u.height=x.imageData.height),p.putImageData(x.imageData,0,0),x}}})(),t.Image=t.Image||{},t.Image.filters=t.Image.filters||{},t.Image.filters.BaseFilter=t.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(o){o&&this.setOptions(o)},setOptions:function(o){for(var a in o)this[a]=o[a]},createProgram:function(o,a,c){a=a||this.fragmentSource,c=c||this.vertexSource,t.webGlPrecision!=="highp"&&(a=a.replace(/precision highp float/g,"precision "+t.webGlPrecision+" float"));var f=o.createShader(o.VERTEX_SHADER);if(o.shaderSource(f,c),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+o.getShaderInfoLog(f));var h=o.createShader(o.FRAGMENT_SHADER);if(o.shaderSource(h,a),o.compileShader(h),!o.getShaderParameter(h,o.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+o.getShaderInfoLog(h));var d=o.createProgram();if(o.attachShader(d,f),o.attachShader(d,h),o.linkProgram(d),!o.getProgramParameter(d,o.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+o.getProgramInfoLog(d));var u=this.getAttributeLocations(o,d),p=this.getUniformLocations(o,d)||{};return p.uStepW=o.getUniformLocation(d,"uStepW"),p.uStepH=o.getUniformLocation(d,"uStepH"),{program:d,attributeLocations:u,uniformLocations:p}},getAttributeLocations:function(o,a){return{aPosition:o.getAttribLocation(a,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(o,a,c){var f=a.aPosition,h=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,h),o.enableVertexAttribArray(f),o.vertexAttribPointer(f,2,o.FLOAT,!1,0,0),o.bufferData(o.ARRAY_BUFFER,c,o.STATIC_DRAW)},_setupFrameBuffer:function(o){var a=o.context,c,f;o.passes>1?(c=o.destinationWidth,f=o.destinationHeight,(o.sourceWidth!==c||o.sourceHeight!==f)&&(a.deleteTexture(o.targetTexture),o.targetTexture=o.filterBackend.createTexture(a,c,f)),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,o.targetTexture,0)):(a.bindFramebuffer(a.FRAMEBUFFER,null),a.finish())},_swapTextures:function(o){o.passes--,o.pass++;var a=o.targetTexture;o.targetTexture=o.sourceTexture,o.sourceTexture=a},isNeutralState:function(){var o=this.mainParameter,a=t.Image.filters[this.type].prototype;if(o)if(Array.isArray(a[o])){for(var c=a[o].length;c--;)if(this[o][c]!==a[o][c])return!1;return!0}else return a[o]===this[o];else return!1},applyTo:function(o){o.webgl?(this._setupFrameBuffer(o),this.applyToWebGL(o),this._swapTextures(o)):this.applyTo2d(o)},retrieveShader:function(o){return o.programCache.hasOwnProperty(this.type)||(o.programCache[this.type]=this.createProgram(o.context)),o.programCache[this.type]},applyToWebGL:function(o){var a=o.context,c=this.retrieveShader(o);o.pass===0&&o.originalTexture?a.bindTexture(a.TEXTURE_2D,o.originalTexture):a.bindTexture(a.TEXTURE_2D,o.sourceTexture),a.useProgram(c.program),this.sendAttributeData(a,c.attributeLocations,o.aPosition),a.uniform1f(c.uniformLocations.uStepW,1/o.sourceWidth),a.uniform1f(c.uniformLocations.uStepH,1/o.sourceHeight),this.sendUniformData(a,c.uniformLocations),a.viewport(0,0,o.destinationWidth,o.destinationHeight),a.drawArrays(a.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(o,a,c){o.activeTexture(c),o.bindTexture(o.TEXTURE_2D,a),o.activeTexture(o.TEXTURE0)},unbindAdditionalTexture:function(o,a){o.activeTexture(a),o.bindTexture(o.TEXTURE_2D,null),o.activeTexture(o.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(o){this[this.mainParameter]=o},sendUniformData:function(){},createHelpLayer:function(o){if(!o.helpLayer){var a=document.createElement("canvas");a.width=o.sourceWidth,a.height=o.sourceHeight,o.helpLayer=a}},toObject:function(){var o={type:this.type},a=this.mainParameter;return a&&(o[a]=this[a]),o},toJSON:function(){return this.toObject()}}),t.Image.filters.BaseFilter.fromObject=function(o,a){var c=new t.Image.filters[o.type](o);return a&&a(c),c},function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.ColorMatrix=f(c.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(h){this.callSuper("initialize",h),this.matrix=this.matrix.slice(0)},applyTo2d:function(h){var d=h.imageData,u=d.data,p=u.length,m=this.matrix,g,x,y,w,b,S=this.colorsOnly;for(b=0;b<p;b+=4)g=u[b],x=u[b+1],y=u[b+2],S?(u[b]=g*m[0]+x*m[1]+y*m[2]+m[4]*255,u[b+1]=g*m[5]+x*m[6]+y*m[7]+m[9]*255,u[b+2]=g*m[10]+x*m[11]+y*m[12]+m[14]*255):(w=u[b+3],u[b]=g*m[0]+x*m[1]+y*m[2]+w*m[3]+m[4]*255,u[b+1]=g*m[5]+x*m[6]+y*m[7]+w*m[8]+m[9]*255,u[b+2]=g*m[10]+x*m[11]+y*m[12]+w*m[13]+m[14]*255,u[b+3]=g*m[15]+x*m[16]+y*m[17]+w*m[18]+m[19]*255)},getUniformLocations:function(h,d){return{uColorMatrix:h.getUniformLocation(d,"uColorMatrix"),uConstants:h.getUniformLocation(d,"uConstants")}},sendUniformData:function(h,d){var u=this.matrix,p=[u[0],u[1],u[2],u[3],u[5],u[6],u[7],u[8],u[10],u[11],u[12],u[13],u[15],u[16],u[17],u[18]],m=[u[4],u[9],u[14],u[19]];h.uniformMatrix4fv(d.uColorMatrix,!1,p),h.uniform4fv(d.uConstants,m)}}),a.Image.filters.ColorMatrix.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Brightness=f(c.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(h){if(this.brightness!==0){var d=h.imageData,u=d.data,p,m=u.length,g=Math.round(this.brightness*255);for(p=0;p<m;p+=4)u[p]=u[p]+g,u[p+1]=u[p+1]+g,u[p+2]=u[p+2]+g}},getUniformLocations:function(h,d){return{uBrightness:h.getUniformLocation(d,"uBrightness")}},sendUniformData:function(h,d){h.uniform1f(d.uBrightness,this.brightness)}}),a.Image.filters.Brightness.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,f=a.Image.filters,h=a.util.createClass;f.Convolute=h(f.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(d){var u=Math.sqrt(this.matrix.length),p=this.type+"_"+u+"_"+(this.opaque?1:0),m=this.fragmentSource[p];return d.programCache.hasOwnProperty(p)||(d.programCache[p]=this.createProgram(d.context,m)),d.programCache[p]},applyTo2d:function(d){var u=d.imageData,p=u.data,m=this.matrix,g=Math.round(Math.sqrt(m.length)),x=Math.floor(g/2),y=u.width,w=u.height,b=d.ctx.createImageData(y,w),S=b.data,T=this.opaque?1:0,O,j,L,W,F,M,V,G,te,ee,Q,K,N;for(Q=0;Q<w;Q++)for(ee=0;ee<y;ee++){for(F=(Q*y+ee)*4,O=0,j=0,L=0,W=0,N=0;N<g;N++)for(K=0;K<g;K++)V=Q+N-x,M=ee+K-x,!(V<0||V>=w||M<0||M>=y)&&(G=(V*y+M)*4,te=m[N*g+K],O+=p[G]*te,j+=p[G+1]*te,L+=p[G+2]*te,T||(W+=p[G+3]*te));S[F]=O,S[F+1]=j,S[F+2]=L,T?S[F+3]=p[F+3]:S[F+3]=W}d.imageData=b},getUniformLocations:function(d,u){return{uMatrix:d.getUniformLocation(u,"uMatrix"),uOpaque:d.getUniformLocation(u,"uOpaque"),uHalfSize:d.getUniformLocation(u,"uHalfSize"),uSize:d.getUniformLocation(u,"uSize")}},sendUniformData:function(d,u){d.uniform1fv(u.uMatrix,this.matrix)},toObject:function(){return c(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),a.Image.filters.Convolute.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Grayscale=f(c.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(h){var d=h.imageData,u=d.data,p,m=u.length,g,x=this.mode;for(p=0;p<m;p+=4)x==="average"?g=(u[p]+u[p+1]+u[p+2])/3:x==="lightness"?g=(Math.min(u[p],u[p+1],u[p+2])+Math.max(u[p],u[p+1],u[p+2]))/2:x==="luminosity"&&(g=.21*u[p]+.72*u[p+1]+.07*u[p+2]),u[p]=g,u[p+1]=g,u[p+2]=g},retrieveShader:function(h){var d=this.type+"_"+this.mode;if(!h.programCache.hasOwnProperty(d)){var u=this.fragmentSource[this.mode];h.programCache[d]=this.createProgram(h.context,u)}return h.programCache[d]},getUniformLocations:function(h,d){return{uMode:h.getUniformLocation(d,"uMode")}},sendUniformData:function(h,d){var u=1;h.uniform1i(d.uMode,u)},isNeutralState:function(){return!1}}),a.Image.filters.Grayscale.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Invert=f(c.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(h){var d=h.imageData,u=d.data,p,m=u.length;for(p=0;p<m;p+=4)u[p]=255-u[p],u[p+1]=255-u[p+1],u[p+2]=255-u[p+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(h,d){return{uInvert:h.getUniformLocation(d,"uInvert")}},sendUniformData:function(h,d){h.uniform1i(d.uInvert,this.invert)}}),a.Image.filters.Invert.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,f=a.Image.filters,h=a.util.createClass;f.Noise=h(f.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(d){if(this.noise!==0){var u=d.imageData,p=u.data,m,g=p.length,x=this.noise,y;for(m=0,g=p.length;m<g;m+=4)y=(.5-Math.random())*x,p[m]+=y,p[m+1]+=y,p[m+2]+=y}},getUniformLocations:function(d,u){return{uNoise:d.getUniformLocation(u,"uNoise"),uSeed:d.getUniformLocation(u,"uSeed")}},sendUniformData:function(d,u){d.uniform1f(u.uNoise,this.noise/255),d.uniform1f(u.uSeed,Math.random())},toObject:function(){return c(this.callSuper("toObject"),{noise:this.noise})}}),a.Image.filters.Noise.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Pixelate=f(c.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(h){var d=h.imageData,u=d.data,p=d.height,m=d.width,g,x,y,w,b,S,T,O,j,L,W;for(x=0;x<p;x+=this.blocksize)for(y=0;y<m;y+=this.blocksize)for(g=x*4*m+y*4,w=u[g],b=u[g+1],S=u[g+2],T=u[g+3],L=Math.min(x+this.blocksize,p),W=Math.min(y+this.blocksize,m),O=x;O<L;O++)for(j=y;j<W;j++)g=O*4*m+j*4,u[g]=w,u[g+1]=b,u[g+2]=S,u[g+3]=T},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(h,d){return{uBlocksize:h.getUniformLocation(d,"uBlocksize"),uStepW:h.getUniformLocation(d,"uStepW"),uStepH:h.getUniformLocation(d,"uStepH")}},sendUniformData:function(h,d){h.uniform1f(d.uBlocksize,this.blocksize)}}),a.Image.filters.Pixelate.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,f=a.Image.filters,h=a.util.createClass;f.RemoveColor=h(f.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(d){var u=d.imageData,p=u.data,m,g=this.distance*255,x,y,w,b=new a.Color(this.color).getSource(),S=[b[0]-g,b[1]-g,b[2]-g],T=[b[0]+g,b[1]+g,b[2]+g];for(m=0;m<p.length;m+=4)x=p[m],y=p[m+1],w=p[m+2],x>S[0]&&y>S[1]&&w>S[2]&&x<T[0]&&y<T[1]&&w<T[2]&&(p[m+3]=0)},getUniformLocations:function(d,u){return{uLow:d.getUniformLocation(u,"uLow"),uHigh:d.getUniformLocation(u,"uHigh")}},sendUniformData:function(d,u){var p=new a.Color(this.color).getSource(),m=parseFloat(this.distance),g=[0+p[0]/255-m,0+p[1]/255-m,0+p[2]/255-m,1],x=[p[0]/255+m,p[1]/255+m,p[2]/255+m,1];d.uniform4fv(u.uLow,g),d.uniform4fv(u.uHigh,x)},toObject:function(){return c(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),a.Image.filters.RemoveColor.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass,h={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var d in h)c[d]=f(c.ColorMatrix,{type:d,matrix:h[d],mainParameter:!1,colorsOnly:!0}),a.Image.filters[d].fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric,c=a.Image.filters,f=a.util.createClass;c.BlendColor=f(c.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(h){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[h]+`}
}`},retrieveShader:function(h){var d=this.type+"_"+this.mode,u;return h.programCache.hasOwnProperty(d)||(u=this.buildSource(this.mode),h.programCache[d]=this.createProgram(h.context,u)),h.programCache[d]},applyTo2d:function(h){var d=h.imageData,u=d.data,p=u.length,m,g,x,y,w,b,S,T=1-this.alpha;S=new a.Color(this.color).getSource(),m=S[0]*this.alpha,g=S[1]*this.alpha,x=S[2]*this.alpha;for(var O=0;O<p;O+=4)switch(y=u[O],w=u[O+1],b=u[O+2],this.mode){case"multiply":u[O]=y*m/255,u[O+1]=w*g/255,u[O+2]=b*x/255;break;case"screen":u[O]=255-(255-y)*(255-m)/255,u[O+1]=255-(255-w)*(255-g)/255,u[O+2]=255-(255-b)*(255-x)/255;break;case"add":u[O]=y+m,u[O+1]=w+g,u[O+2]=b+x;break;case"diff":case"difference":u[O]=Math.abs(y-m),u[O+1]=Math.abs(w-g),u[O+2]=Math.abs(b-x);break;case"subtract":u[O]=y-m,u[O+1]=w-g,u[O+2]=b-x;break;case"darken":u[O]=Math.min(y,m),u[O+1]=Math.min(w,g),u[O+2]=Math.min(b,x);break;case"lighten":u[O]=Math.max(y,m),u[O+1]=Math.max(w,g),u[O+2]=Math.max(b,x);break;case"overlay":u[O]=m<128?2*y*m/255:255-2*(255-y)*(255-m)/255,u[O+1]=g<128?2*w*g/255:255-2*(255-w)*(255-g)/255,u[O+2]=x<128?2*b*x/255:255-2*(255-b)*(255-x)/255;break;case"exclusion":u[O]=m+y-2*m*y/255,u[O+1]=g+w-2*g*w/255,u[O+2]=x+b-2*x*b/255;break;case"tint":u[O]=m+y*T,u[O+1]=g+w*T,u[O+2]=x+b*T}},getUniformLocations:function(h,d){return{uColor:h.getUniformLocation(d,"uColor")}},sendUniformData:function(h,d){var u=new a.Color(this.color).getSource();u[0]=this.alpha*u[0]/255,u[1]=this.alpha*u[1]/255,u[2]=this.alpha*u[2]/255,u[3]=this.alpha,h.uniform4fv(d.uColor,u)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),a.Image.filters.BlendColor.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric,c=a.Image.filters,f=a.util.createClass;c.BlendImage=f(c.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(h){var d=this.type+"_"+this.mode,u=this.fragmentSource[this.mode];return h.programCache.hasOwnProperty(d)||(h.programCache[d]=this.createProgram(h.context,u)),h.programCache[d]},applyToWebGL:function(h){var d=h.context,u=this.createTexture(h.filterBackend,this.image);this.bindAdditionalTexture(d,u,d.TEXTURE1),this.callSuper("applyToWebGL",h),this.unbindAdditionalTexture(d,d.TEXTURE1)},createTexture:function(h,d){return h.getCachedTexture(d.cacheKey,d._element)},calculateMatrix:function(){var h=this.image,d=h._element.width,u=h._element.height;return[1/h.scaleX,0,0,0,1/h.scaleY,0,-h.left/d,-h.top/u,1]},applyTo2d:function(h){var d=h.imageData,u=h.filterBackend.resources,p=d.data,m=p.length,g=d.width,x=d.height,y,w,b,S,T,O,j,L,W,F,M=this.image,V;u.blendImage||(u.blendImage=a.util.createCanvasElement()),W=u.blendImage,F=W.getContext("2d"),W.width!==g||W.height!==x?(W.width=g,W.height=x):F.clearRect(0,0,g,x),F.setTransform(M.scaleX,0,0,M.scaleY,M.left,M.top),F.drawImage(M._element,0,0,g,x),V=F.getImageData(0,0,g,x).data;for(var G=0;G<m;G+=4)switch(T=p[G],O=p[G+1],j=p[G+2],L=p[G+3],y=V[G],w=V[G+1],b=V[G+2],S=V[G+3],this.mode){case"multiply":p[G]=T*y/255,p[G+1]=O*w/255,p[G+2]=j*b/255,p[G+3]=L*S/255;break;case"mask":p[G+3]=S;break}},getUniformLocations:function(h,d){return{uTransformMatrix:h.getUniformLocation(d,"uTransformMatrix"),uImage:h.getUniformLocation(d,"uImage")}},sendUniformData:function(h,d){var u=this.calculateMatrix();h.uniform1i(d.uImage,1),h.uniformMatrix3fv(d.uTransformMatrix,!1,u)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),a.Image.filters.BlendImage.fromObject=function(h,d){a.Image.fromObject(h.image,function(u){var p=a.util.object.clone(h);p.image=u,d(new a.Image.filters.BlendImage(p))})}}(e),function(o){var a=o.fabric||(o.fabric={}),c=Math.pow,f=Math.floor,h=Math.sqrt,d=Math.abs,u=Math.round,p=Math.sin,m=Math.ceil,g=a.Image.filters,x=a.util.createClass;g.Resize=x(g.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(y,w){return{uDelta:y.getUniformLocation(w,"uDelta"),uTaps:y.getUniformLocation(w,"uTaps")}},sendUniformData:function(y,w){y.uniform2fv(w.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),y.uniform1fv(w.uTaps,this.taps)},retrieveShader:function(y){var w=this.getFilterWindow(),b=this.type+"_"+w;if(!y.programCache.hasOwnProperty(b)){var S=this.generateShader(w);y.programCache[b]=this.createProgram(y.context,S)}return y.programCache[b]},getFilterWindow:function(){var y=this.tempScale;return Math.ceil(this.lanczosLobes/y)},getTaps:function(){for(var y=this.lanczosCreate(this.lanczosLobes),w=this.tempScale,b=this.getFilterWindow(),S=new Array(b),T=1;T<=b;T++)S[T-1]=y(T*w);return S},generateShader:function(S){for(var w=new Array(S),b=this.fragmentSourceTOP,S,T=1;T<=S;T++)w[T-1]=T+".0 * uDelta";return b+="uniform float uTaps["+S+`];
`,b+=`void main() {
`,b+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,b+=`  float sum = 1.0;
`,w.forEach(function(O,j){b+="  color += texture2D(uTexture, vTexCoord + "+O+") * uTaps["+j+`];
`,b+="  color += texture2D(uTexture, vTexCoord - "+O+") * uTaps["+j+`];
`,b+="  sum += 2.0 * uTaps["+j+`];
`}),b+=`  gl_FragColor = color / sum;
`,b+="}",b},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(y){y.webgl?(y.passes++,this.width=y.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=y.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),y.destinationWidth=this.dW,this._setupFrameBuffer(y),this.applyToWebGL(y),this._swapTextures(y),y.sourceWidth=y.destinationWidth,this.height=y.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),y.destinationHeight=this.dH,this._setupFrameBuffer(y),this.applyToWebGL(y),this._swapTextures(y),y.sourceHeight=y.destinationHeight):this.applyTo2d(y)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(y){return function(w){if(w>=y||w<=-y)return 0;if(w<11920929e-14&&w>-11920929e-14)return 1;w*=Math.PI;var b=w/y;return p(w)/w*p(b)/b}},applyTo2d:function(y){var w=y.imageData,b=this.scaleX,S=this.scaleY;this.rcpScaleX=1/b,this.rcpScaleY=1/S;var T=w.width,O=w.height,j=u(T*b),L=u(O*S),W;this.resizeType==="sliceHack"?W=this.sliceByTwo(y,T,O,j,L):this.resizeType==="hermite"?W=this.hermiteFastResize(y,T,O,j,L):this.resizeType==="bilinear"?W=this.bilinearFiltering(y,T,O,j,L):this.resizeType==="lanczos"&&(W=this.lanczosResize(y,T,O,j,L)),y.imageData=W},sliceByTwo:function(y,w,b,S,T){var O=y.imageData,j=.5,L=!1,W=!1,F=w*j,M=b*j,V=a.filterBackend.resources,G,te,ee=0,Q=0,K=w,N=0;for(V.sliceByTwo||(V.sliceByTwo=document.createElement("canvas")),G=V.sliceByTwo,(G.width<w*1.5||G.height<b)&&(G.width=w*1.5,G.height=b),te=G.getContext("2d"),te.clearRect(0,0,w*1.5,b),te.putImageData(O,0,0),S=f(S),T=f(T);!L||!W;)w=F,b=M,S<f(F*j)?F=f(F*j):(F=S,L=!0),T<f(M*j)?M=f(M*j):(M=T,W=!0),te.drawImage(G,ee,Q,w,b,K,N,F,M),ee=K,Q=N,N+=M;return te.getImageData(ee,Q,S,T)},lanczosResize:function(y,w,b,S,T){function O(R){var k,P,A,E,I,H,J,Y,Z,fe,X;for(N.x=(R+.5)*M,U.x=f(N.x),k=0;k<T;k++){for(N.y=(k+.5)*V,U.y=f(N.y),I=0,H=0,J=0,Y=0,Z=0,P=U.x-ee;P<=U.x+ee;P++)if(!(P<0||P>=w)){fe=f(1e3*d(P-N.x)),K[fe]||(K[fe]={});for(var re=U.y-Q;re<=U.y+Q;re++)re<0||re>=b||(X=f(1e3*d(re-N.y)),K[fe][X]||(K[fe][X]=F(h(c(fe*G,2)+c(X*te,2))/1e3)),A=K[fe][X],A>0&&(E=(re*w+P)*4,I+=A,H+=A*j[E],J+=A*j[E+1],Y+=A*j[E+2],Z+=A*j[E+3]))}E=(k*S+R)*4,W[E]=H/I,W[E+1]=J/I,W[E+2]=Y/I,W[E+3]=Z/I}return++R<S?O(R):L}var j=y.imageData.data,L=y.ctx.createImageData(S,T),W=L.data,F=this.lanczosCreate(this.lanczosLobes),M=this.rcpScaleX,V=this.rcpScaleY,G=2/this.rcpScaleX,te=2/this.rcpScaleY,ee=m(M*this.lanczosLobes/2),Q=m(V*this.lanczosLobes/2),K={},N={},U={};return O(0)},bilinearFiltering:function(y,w,b,S,T){var O,j,L,W,F,M,V,G,te,ee,Q,K,N=0,U,R=this.rcpScaleX,k=this.rcpScaleY,P=4*(w-1),A=y.imageData,E=A.data,I=y.ctx.createImageData(S,T),H=I.data;for(V=0;V<T;V++)for(G=0;G<S;G++)for(F=f(R*G),M=f(k*V),te=R*G-F,ee=k*V-M,U=4*(M*w+F),Q=0;Q<4;Q++)O=E[U+Q],j=E[U+4+Q],L=E[U+P+Q],W=E[U+P+4+Q],K=O*(1-te)*(1-ee)+j*te*(1-ee)+L*ee*(1-te)+W*te*ee,H[N++]=K;return I},hermiteFastResize:function(y,w,b,S,T){for(var O=this.rcpScaleX,j=this.rcpScaleY,L=m(O/2),W=m(j/2),F=y.imageData,M=F.data,V=y.ctx.createImageData(S,T),G=V.data,te=0;te<T;te++)for(var ee=0;ee<S;ee++){for(var Q=(ee+te*S)*4,K=0,N=0,U=0,R=0,k=0,P=0,A=0,E=(te+.5)*j,I=f(te*j);I<(te+1)*j;I++)for(var H=d(E-(I+.5))/W,J=(ee+.5)*O,Y=H*H,Z=f(ee*O);Z<(ee+1)*O;Z++){var fe=d(J-(Z+.5))/L,X=h(Y+fe*fe);X>1&&X<-1||(K=2*X*X*X-3*X*X+1,K>0&&(fe=4*(Z+I*w),A+=K*M[fe+3],U+=K,M[fe+3]<255&&(K=K*M[fe+3]/250),R+=K*M[fe],k+=K*M[fe+1],P+=K*M[fe+2],N+=K))}G[Q]=R/N,G[Q+1]=k/N,G[Q+2]=P/N,G[Q+3]=A/U}return V},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),a.Image.filters.Resize.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Contrast=f(c.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(h){if(this.contrast!==0){var d=h.imageData,u,m,p=d.data,m=p.length,g=Math.floor(this.contrast*255),x=259*(g+255)/(255*(259-g));for(u=0;u<m;u+=4)p[u]=x*(p[u]-128)+128,p[u+1]=x*(p[u+1]-128)+128,p[u+2]=x*(p[u+2]-128)+128}},getUniformLocations:function(h,d){return{uContrast:h.getUniformLocation(d,"uContrast")}},sendUniformData:function(h,d){h.uniform1f(d.uContrast,this.contrast)}}),a.Image.filters.Contrast.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Saturation=f(c.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(h){if(this.saturation!==0){var d=h.imageData,u=d.data,p=u.length,m=-this.saturation,g,x;for(g=0;g<p;g+=4)x=Math.max(u[g],u[g+1],u[g+2]),u[g]+=x!==u[g]?(x-u[g])*m:0,u[g+1]+=x!==u[g+1]?(x-u[g+1])*m:0,u[g+2]+=x!==u[g+2]?(x-u[g+2])*m:0}},getUniformLocations:function(h,d){return{uSaturation:h.getUniformLocation(d,"uSaturation")}},sendUniformData:function(h,d){h.uniform1f(d.uSaturation,-this.saturation)}}),a.Image.filters.Saturation.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Vibrance=f(c.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(h){if(this.vibrance!==0){var d=h.imageData,u=d.data,p=u.length,m=-this.vibrance,g,x,y,w;for(g=0;g<p;g+=4)x=Math.max(u[g],u[g+1],u[g+2]),y=(u[g]+u[g+1]+u[g+2])/3,w=Math.abs(x-y)*2/255*m,u[g]+=x!==u[g]?(x-u[g])*w:0,u[g+1]+=x!==u[g+1]?(x-u[g+1])*w:0,u[g+2]+=x!==u[g+2]?(x-u[g+2])*w:0}},getUniformLocations:function(h,d){return{uVibrance:h.getUniformLocation(d,"uVibrance")}},sendUniformData:function(h,d){h.uniform1f(d.uVibrance,-this.vibrance)}}),a.Image.filters.Vibrance.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Blur=f(c.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(h){h.webgl?(this.aspectRatio=h.sourceWidth/h.sourceHeight,h.passes++,this._setupFrameBuffer(h),this.horizontal=!0,this.applyToWebGL(h),this._swapTextures(h),this._setupFrameBuffer(h),this.horizontal=!1,this.applyToWebGL(h),this._swapTextures(h)):this.applyTo2d(h)},applyTo2d:function(h){h.imageData=this.simpleBlur(h)},simpleBlur:function(h){var d=h.filterBackend.resources,u,p,m=h.imageData.width,g=h.imageData.height;d.blurLayer1||(d.blurLayer1=a.util.createCanvasElement(),d.blurLayer2=a.util.createCanvasElement()),u=d.blurLayer1,p=d.blurLayer2,(u.width!==m||u.height!==g)&&(p.width=u.width=m,p.height=u.height=g);var x=u.getContext("2d"),y=p.getContext("2d"),w=15,b,S,T,O,j=this.blur*.06*.5;for(x.putImageData(h.imageData,0,0),y.clearRect(0,0,m,g),O=-w;O<=w;O++)b=(Math.random()-.5)/4,S=O/w,T=j*S*m+b,y.globalAlpha=1-Math.abs(S),y.drawImage(u,T,b),x.drawImage(p,0,0),y.globalAlpha=1,y.clearRect(0,0,p.width,p.height);for(O=-w;O<=w;O++)b=(Math.random()-.5)/4,S=O/w,T=j*S*g+b,y.globalAlpha=1-Math.abs(S),y.drawImage(u,b,T),x.drawImage(p,0,0),y.globalAlpha=1,y.clearRect(0,0,p.width,p.height);h.ctx.drawImage(u,0,0);var L=h.ctx.getImageData(0,0,u.width,u.height);return x.globalAlpha=1,x.clearRect(0,0,u.width,u.height),L},getUniformLocations:function(h,d){return{delta:h.getUniformLocation(d,"uDelta")}},sendUniformData:function(h,d){var u=this.chooseRightDelta();h.uniform2fv(d.delta,u)},chooseRightDelta:function(){var h=1,d=[0,0],u;return this.horizontal?this.aspectRatio>1&&(h=1/this.aspectRatio):this.aspectRatio<1&&(h=this.aspectRatio),u=h*this.blur*.12,this.horizontal?d[0]=u:d[1]=u,d}}),c.Blur.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Gamma=f(c.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(h){this.gamma=[1,1,1],c.BaseFilter.prototype.initialize.call(this,h)},applyTo2d:function(h){var d=h.imageData,u=d.data,p=this.gamma,m=u.length,g=1/p[0],x=1/p[1],y=1/p[2],w;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),w=0,m=256;w<m;w++)this.rVals[w]=Math.pow(w/255,g)*255,this.gVals[w]=Math.pow(w/255,x)*255,this.bVals[w]=Math.pow(w/255,y)*255;for(w=0,m=u.length;w<m;w+=4)u[w]=this.rVals[u[w]],u[w+1]=this.gVals[u[w+1]],u[w+2]=this.bVals[u[w+2]]},getUniformLocations:function(h,d){return{uGamma:h.getUniformLocation(d,"uGamma")}},sendUniformData:function(h,d){h.uniform3fv(d.uGamma,this.gamma)}}),a.Image.filters.Gamma.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Composed=f(c.BaseFilter,{type:"Composed",subFilters:[],initialize:function(h){this.callSuper("initialize",h),this.subFilters=this.subFilters.slice(0)},applyTo:function(h){h.passes+=this.subFilters.length-1,this.subFilters.forEach(function(d){d.applyTo(h)})},toObject:function(){return a.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(h){return h.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(h){return!h.isNeutralState()})}}),a.Image.filters.Composed.fromObject=function(h,d){var u=h.subFilters||[],p=u.map(function(g){return new a.Image.filters[g.type](g)}),m=new a.Image.filters.Composed({subFilters:p});return d&&d(m),m}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.HueRotation=f(c.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var h=this.rotation*Math.PI,d=a.util.cos(h),u=a.util.sin(h),p=1/3,m=Math.sqrt(p)*u,g=1-d;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=d+g/3,this.matrix[1]=p*g-m,this.matrix[2]=p*g+m,this.matrix[5]=p*g+m,this.matrix[6]=d+p*g,this.matrix[7]=p*g-m,this.matrix[10]=p*g-m,this.matrix[11]=p*g+m,this.matrix[12]=d+p*g},isNeutralState:function(h){return this.calculateMatrix(),c.BaseFilter.prototype.isNeutralState.call(this,h)},applyTo:function(h){this.calculateMatrix(),c.BaseFilter.prototype.applyTo.call(this,h)}}),a.Image.filters.HueRotation.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.clone;if(a.Text){a.warn("fabric.Text is already defined");return}var f="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");a.Text=a.util.createClass(a.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:a.Object.prototype.stateProperties.concat(f),cacheProperties:a.Object.prototype.cacheProperties.concat(f),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(h,d){this.styles=d?d.styles||{}:{},this.text=h,this.__skipDimension=!0,this.callSuper("initialize",d),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var h=this.path;h&&(h.segmentsInfo=a.util.getPathSegmentsInfo(h.path))},getMeasuringContext:function(){return a._measuringContext||(a._measuringContext=this.canvas&&this.canvas.contextCache||a.util.createCanvasElement().getContext("2d")),a._measuringContext},_splitText:function(){var h=this._splitTextIntoLines(this.text);return this.textLines=h.lines,this._textLines=h.graphemeLines,this._unwrappedTextLines=h._unwrappedLines,this._text=h.graphemeText,h},initDimensions:function(){if(!this.__skipDimension){if(this._splitText(),this._clearCache(),this.path){var h=this.getHeightOfLine(0)*1.1;this.width=this.path.width+h,this.height=this.path.height+h}else this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight();this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"})}},enlargeSpaces:function(){for(var h,d,u,p,m,g,x,y=0,w=this._textLines.length;y<w;y++)if(!(this.textAlign!=="justify"&&(y===w-1||this.isEndOfWrapping(y)))&&(p=0,m=this._textLines[y],d=this.getLineWidth(y),d<this.width&&(x=this.textLines[y].match(this._reSpacesAndTabs)))){u=x.length,h=(this.width-d)/u;for(var b=0,S=m.length;b<=S;b++)g=this.__charBounds[y][b],this._reSpaceAndTab.test(m[b])?(g.width+=h,g.kernedWidth+=h,g.left+=p,p+=h):g.left+=p}},isEndOfWrapping:function(h){return h===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var h=this.callSuper("_getCacheCanvasDimensions"),d=this.fontSize;return h.width+=d*h.zoomX,h.height+=d*h.zoomY,h},_render:function(h){var d=this.path;d&&!d.isNotVisible()&&d._render(h),this._setTextStyles(h),this._renderTextLinesBackground(h),this._renderTextDecoration(h,"underline"),this._renderText(h),this._renderTextDecoration(h,"overline"),this._renderTextDecoration(h,"linethrough")},_renderText:function(h){this.paintFirst==="stroke"?(this._renderTextStroke(h),this._renderTextFill(h)):(this._renderTextFill(h),this._renderTextStroke(h))},_setTextStyles:function(h,d,u){if(h.textBaseline="alphabetic",this.path)switch(this.pathAlign){case"center":h.textBaseline="middle";break;case"ascender":h.textBaseline="top";break;case"descender":h.textBaseline="bottom";break}h.font=this._getFontDeclaration(d,u)},calcTextWidth:function(){for(var h=this.getLineWidth(0),d=1,u=this._textLines.length;d<u;d++){var p=this.getLineWidth(d);p>h&&(h=p)}return h},_renderTextLine:function(h,d,u,p,m,g){this._renderChars(h,d,u,p,m,g)},_renderTextLinesBackground:function(h){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var d,u,p=h.fillStyle,m,g,x=this._getLeftOffset(),y=this._getTopOffset(),w=0,b=0,S,T,O=this.path,j,L=0,W=this._textLines.length;L<W;L++){if(d=this.getHeightOfLine(L),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",L)){y+=d;continue}m=this._textLines[L],u=this._getLineLeftOffset(L),b=0,w=0,g=this.getValueOfPropertyAt(L,0,"textBackgroundColor");for(var F=0,M=m.length;F<M;F++)S=this.__charBounds[L][F],T=this.getValueOfPropertyAt(L,F,"textBackgroundColor"),O?(h.save(),h.translate(S.renderLeft,S.renderTop),h.rotate(S.angle),h.fillStyle=T,T&&h.fillRect(-S.width/2,-d/this.lineHeight*(1-this._fontSizeFraction),S.width,d/this.lineHeight),h.restore()):T!==g?(j=x+u+w,this.direction==="rtl"&&(j=this.width-j-b),h.fillStyle=g,g&&h.fillRect(j,y,b,d/this.lineHeight),w=S.left,b=S.width,g=T):b+=S.kernedWidth;T&&!O&&(j=x+u+w,this.direction==="rtl"&&(j=this.width-j-b),h.fillStyle=T,h.fillRect(j,y,b,d/this.lineHeight)),y+=d}h.fillStyle=p,this._removeShadow(h)}},getFontCache:function(h){var d=h.fontFamily.toLowerCase();a.charWidthsCache[d]||(a.charWidthsCache[d]={});var u=a.charWidthsCache[d],p=h.fontStyle.toLowerCase()+"_"+(h.fontWeight+"").toLowerCase();return u[p]||(u[p]={}),u[p]},_measureChar:function(h,d,u,p){var m=this.getFontCache(d),g=this._getFontDeclaration(d),x=this._getFontDeclaration(p),y=u+h,w=g===x,b,S,T,O=d.fontSize/this.CACHE_FONT_SIZE,j;if(u&&m[u]!==void 0&&(T=m[u]),m[h]!==void 0&&(j=b=m[h]),w&&m[y]!==void 0&&(S=m[y],j=S-T),b===void 0||T===void 0||S===void 0){var L=this.getMeasuringContext();this._setTextStyles(L,d,!0)}return b===void 0&&(j=b=L.measureText(h).width,m[h]=b),T===void 0&&w&&u&&(T=L.measureText(u).width,m[u]=T),w&&S===void 0&&(S=L.measureText(y).width,m[y]=S,j=S-T),{width:b*O,kernedWidth:j*O}},getHeightOfChar:function(h,d){return this.getValueOfPropertyAt(h,d,"fontSize")},measureLine:function(h){var d=this._measureLine(h);return this.charSpacing!==0&&(d.width-=this._getWidthOfCharSpacing()),d.width<0&&(d.width=0),d},_measureLine:function(h){var d=0,u,p,m=this._textLines[h],g,x,y=0,w=new Array(m.length),b=0,S,T,O=this.path,j=this.pathSide==="right";for(this.__charBounds[h]=w,u=0;u<m.length;u++)p=m[u],x=this._getGraphemeBox(p,h,u,g),w[u]=x,d+=x.kernedWidth,g=p;if(w[u]={left:x?x.left+x.width:0,width:0,kernedWidth:0,height:this.fontSize},O){switch(T=O.segmentsInfo[O.segmentsInfo.length-1].length,S=a.util.getPointOnPath(O.path,0,O.segmentsInfo),S.x+=O.pathOffset.x,S.y+=O.pathOffset.y,this.textAlign){case"left":b=j?T-d:0;break;case"center":b=(T-d)/2;break;case"right":b=j?0:T-d;break}for(b+=this.pathStartOffset*(j?-1:1),u=j?m.length-1:0;j?u>=0:u<m.length;j?u--:u++)x=w[u],b>T?b%=T:b<0&&(b+=T),this._setGraphemeOnPath(b,x,S),b+=x.kernedWidth}return{width:d,numOfSpaces:y}},_setGraphemeOnPath:function(h,d,u){var p=h+d.kernedWidth/2,m=this.path,g=a.util.getPointOnPath(m.path,p,m.segmentsInfo);d.renderLeft=g.x-u.x,d.renderTop=g.y-u.y,d.angle=g.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(h,d,u,p,m){var g=this.getCompleteStyleDeclaration(d,u),x=p?this.getCompleteStyleDeclaration(d,u-1):{},y=this._measureChar(h,g,p,x),w=y.kernedWidth,b=y.width,S;this.charSpacing!==0&&(S=this._getWidthOfCharSpacing(),b+=S,w+=S);var T={width:b,left:0,height:g.fontSize,kernedWidth:w,deltaY:g.deltaY};if(u>0&&!m){var O=this.__charBounds[d][u-1];T.left=O.left+O.width+y.kernedWidth-y.width}return T},getHeightOfLine:function(h){if(this.__lineHeights[h])return this.__lineHeights[h];for(var d=this._textLines[h],u=this.getHeightOfChar(h,0),p=1,m=d.length;p<m;p++)u=Math.max(this.getHeightOfChar(h,p),u);return this.__lineHeights[h]=u*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var h,d=0,u=0,p=this._textLines.length;u<p;u++)h=this.getHeightOfLine(u),d+=u===p-1?h/this.lineHeight:h;return d},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(h,d){h.save();for(var u=0,p=this._getLeftOffset(),m=this._getTopOffset(),g=0,x=this._textLines.length;g<x;g++){var y=this.getHeightOfLine(g),w=y/this.lineHeight,b=this._getLineLeftOffset(g);this._renderTextLine(d,h,this._textLines[g],p+b,m+u+w,g),u+=y}h.restore()},_renderTextFill:function(h){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(h,"fillText")},_renderTextStroke:function(h){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(h),h.save(),this._setLineDash(h,this.strokeDashArray),h.beginPath(),this._renderTextCommon(h,"strokeText"),h.closePath(),h.restore())},_renderChars:function(h,d,u,p,m,g){var x=this.getHeightOfLine(g),y=this.textAlign.indexOf("justify")!==-1,w,b,S="",T,O=0,j,L=this.path,W=!y&&this.charSpacing===0&&this.isEmptyStyles(g)&&!L,F=this.direction==="ltr",M=this.direction==="ltr"?1:-1,V,G=d.canvas.getAttribute("dir");if(d.save(),G!==this.direction&&(d.canvas.setAttribute("dir",F?"ltr":"rtl"),d.direction=F?"ltr":"rtl",d.textAlign=F?"left":"right"),m-=x*this._fontSizeFraction/this.lineHeight,W){this._renderChar(h,d,g,0,u.join(""),p,m,x),d.restore();return}for(var te=0,ee=u.length-1;te<=ee;te++)j=te===ee||this.charSpacing||L,S+=u[te],T=this.__charBounds[g][te],O===0?(p+=M*(T.kernedWidth-T.width),O+=T.width):O+=T.kernedWidth,y&&!j&&this._reSpaceAndTab.test(u[te])&&(j=!0),j||(w=w||this.getCompleteStyleDeclaration(g,te),b=this.getCompleteStyleDeclaration(g,te+1),j=a.util.hasStyleChanged(w,b,!1)),j&&(L?(d.save(),d.translate(T.renderLeft,T.renderTop),d.rotate(T.angle),this._renderChar(h,d,g,te,S,-O/2,0,x),d.restore()):(V=p,this._renderChar(h,d,g,te,S,V,m,x)),S="",w=b,p+=M*O,O=0);d.restore()},_applyPatternGradientTransformText:function(h){var d=a.util.createCanvasElement(),u,p=this.width+this.strokeWidth,m=this.height+this.strokeWidth;return d.width=p,d.height=m,u=d.getContext("2d"),u.beginPath(),u.moveTo(0,0),u.lineTo(p,0),u.lineTo(p,m),u.lineTo(0,m),u.closePath(),u.translate(p/2,m/2),u.fillStyle=h.toLive(u),this._applyPatternGradientTransform(u,h),u.fill(),u.createPattern(d,"no-repeat")},handleFiller:function(h,d,u){var p,m;return u.toLive?u.gradientUnits==="percentage"||u.gradientTransform||u.patternTransform?(p=-this.width/2,m=-this.height/2,h.translate(p,m),h[d]=this._applyPatternGradientTransformText(u),{offsetX:p,offsetY:m}):(h[d]=u.toLive(h,this),this._applyPatternGradientTransform(h,u)):(h[d]=u,{offsetX:0,offsetY:0})},_setStrokeStyles:function(h,d){return h.lineWidth=d.strokeWidth,h.lineCap=this.strokeLineCap,h.lineDashOffset=this.strokeDashOffset,h.lineJoin=this.strokeLineJoin,h.miterLimit=this.strokeMiterLimit,this.handleFiller(h,"strokeStyle",d.stroke)},_setFillStyles:function(h,d){return this.handleFiller(h,"fillStyle",d.fill)},_renderChar:function(h,d,u,p,m,g,x){var y=this._getStyleDeclaration(u,p),w=this.getCompleteStyleDeclaration(u,p),b=h==="fillText"&&w.fill,S=h==="strokeText"&&w.stroke&&w.strokeWidth,T,O;!S&&!b||(d.save(),b&&(T=this._setFillStyles(d,w)),S&&(O=this._setStrokeStyles(d,w)),d.font=this._getFontDeclaration(w),y&&y.textBackgroundColor&&this._removeShadow(d),y&&y.deltaY&&(x+=y.deltaY),b&&d.fillText(m,g-T.offsetX,x-T.offsetY),S&&d.strokeText(m,g-O.offsetX,x-O.offsetY),d.restore())},setSuperscript:function(h,d){return this._setScript(h,d,this.superscript)},setSubscript:function(h,d){return this._setScript(h,d,this.subscript)},_setScript:function(h,d,u){var p=this.get2DCursorLocation(h,!0),m=this.getValueOfPropertyAt(p.lineIndex,p.charIndex,"fontSize"),g=this.getValueOfPropertyAt(p.lineIndex,p.charIndex,"deltaY"),x={fontSize:m*u.size,deltaY:g+m*u.baseline};return this.setSelectionStyles(x,h,d),this},_getLineLeftOffset:function(h){var d=this.getLineWidth(h),u=this.width-d,p=this.textAlign,m=this.direction,x,g=0,x=this.isEndOfWrapping(h);return p==="justify"||p==="justify-center"&&!x||p==="justify-right"&&!x||p==="justify-left"&&!x?0:(p==="center"&&(g=u/2),p==="right"&&(g=u),p==="justify-center"&&(g=u/2),p==="justify-right"&&(g=u),m==="rtl"&&(g-=u),g)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var h=this._forceClearCache;return h||(h=this.hasStateChanged("_dimensionAffectingProps")),h&&(this.dirty=!0,this._forceClearCache=!1),h},getLineWidth:function(h){if(this.__lineWidths[h]!==void 0)return this.__lineWidths[h];var d=this.measureLine(h),u=d.width;return this.__lineWidths[h]=u,u},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(h,d,u){var p=this._getStyleDeclaration(h,d);return p&&typeof p[u]<"u"?p[u]:this[u]},_renderTextDecoration:function(h,d){if(!(!this[d]&&!this.styleHas(d))){h.save(),(d==="overline"||d==="linethrough")&&this._removeShadow(h);for(var u,p,m,g,x,y,w,b,S=this._getLeftOffset(),T=this._getTopOffset(),O,j,L,W,F,M,V,G,te=this.path,ee=this._getWidthOfCharSpacing(),Q=this.offsets[d],K=0,N=this._textLines.length;K<N;K++){if(u=this.getHeightOfLine(K),!this[d]&&!this.styleHas(d,K)){T+=u;continue}w=this._textLines[K],M=u/this.lineHeight,g=this._getLineLeftOffset(K),j=0,L=0,b=this.getValueOfPropertyAt(K,0,d),G=this.getValueOfPropertyAt(K,0,"fill"),O=T+M*(1-this._fontSizeFraction),p=this.getHeightOfChar(K,0),x=this.getValueOfPropertyAt(K,0,"deltaY");for(var U=0,R=w.length;U<R;U++)if(W=this.__charBounds[K][U],F=this.getValueOfPropertyAt(K,U,d),V=this.getValueOfPropertyAt(K,U,"fill"),m=this.getHeightOfChar(K,U),y=this.getValueOfPropertyAt(K,U,"deltaY"),te&&F&&V)h.save(),h.fillStyle=G,h.translate(W.renderLeft,W.renderTop),h.rotate(W.angle),h.fillRect(-W.kernedWidth/2,Q*m+y,W.kernedWidth,this.fontSize/15),h.restore();else if((F!==b||V!==G||m!==p||y!==x)&&L>0){var k=S+g+j;this.direction==="rtl"&&(k=this.width-k-L),b&&G&&(h.fillStyle=G,h.fillRect(k,O+Q*p+x,L,this.fontSize/15)),j=W.left,L=W.width,b=F,G=V,p=m,x=y}else L+=W.kernedWidth;var k=S+g+j;this.direction==="rtl"&&(k=this.width-k-L),h.fillStyle=V,F&&V&&h.fillRect(k,O+Q*p+x,L-ee,this.fontSize/15),T+=u}h.restore()}},_getFontDeclaration:function(h,d){var u=h||this,p=this.fontFamily,m=a.Text.genericFonts.indexOf(p.toLowerCase())>-1,g=p===void 0||p.indexOf("'")>-1||p.indexOf(",")>-1||p.indexOf('"')>-1||m?u.fontFamily:'"'+u.fontFamily+'"';return[a.isLikelyNode?u.fontWeight:u.fontStyle,a.isLikelyNode?u.fontStyle:u.fontWeight,d?this.CACHE_FONT_SIZE+"px":u.fontSize+"px",g].join(" ")},render:function(h){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",h)))},_splitTextIntoLines:function(h){for(var d=h.split(this._reNewline),u=new Array(d.length),p=[`
`],m=[],g=0;g<d.length;g++)u[g]=a.util.string.graphemeSplit(d[g]),m=m.concat(u[g],p);return m.pop(),{_unwrappedLines:u,lines:d,graphemeText:m,graphemeLines:u}},toObject:function(h){var d=f.concat(h),u=this.callSuper("toObject",d);return u.styles=a.util.stylesToArray(this.styles,this.text),u.path&&(u.path=this.path.toObject()),u},set:function(h,d){this.callSuper("set",h,d);var u=!1,p=!1;if(typeof h=="object")for(var m in h)m==="path"&&this.setPathInfo(),u=u||this._dimensionAffectingProps.indexOf(m)!==-1,p=p||m==="path";else u=this._dimensionAffectingProps.indexOf(h)!==-1,p=h==="path";return p&&this.setPathInfo(),u&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),a.Text.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),a.Text.DEFAULT_SVG_FONT_SIZE=16,a.Text.fromElement=function(h,d,u){if(!h)return d(null);var p=a.parseAttributes(h,a.Text.ATTRIBUTE_NAMES),m=p.textAnchor||"left";if(u=a.util.object.extend(u?c(u):{},p),u.top=u.top||0,u.left=u.left||0,p.textDecoration){var g=p.textDecoration;g.indexOf("underline")!==-1&&(u.underline=!0),g.indexOf("overline")!==-1&&(u.overline=!0),g.indexOf("line-through")!==-1&&(u.linethrough=!0),delete u.textDecoration}"dx"in p&&(u.left+=p.dx),"dy"in p&&(u.top+=p.dy),"fontSize"in u||(u.fontSize=a.Text.DEFAULT_SVG_FONT_SIZE);var x="";"textContent"in h?x=h.textContent:"firstChild"in h&&h.firstChild!==null&&"data"in h.firstChild&&h.firstChild.data!==null&&(x=h.firstChild.data),x=x.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var y=u.strokeWidth;u.strokeWidth=0;var w=new a.Text(x,u),b=w.getScaledHeight()/w.height,S=(w.height+w.strokeWidth)*w.lineHeight-w.height,T=S*b,O=w.getScaledHeight()+T,j=0;m==="center"&&(j=w.getScaledWidth()/2),m==="right"&&(j=w.getScaledWidth()),w.set({left:w.left-j,top:w.top-(O-w.fontSize*(.07+w._fontSizeFraction))/w.lineHeight,strokeWidth:typeof y<"u"?y:1}),d(w)},a.Text.fromObject=function(h,d){var u=c(h),p=h.path;return delete u.path,a.Object._fromObject("Text",u,function(m){m.styles=a.util.stylesFromArray(h.styles,h.text),p?a.Object._fromObject("Path",p,function(g){m.set("path",g),d(m)},"path"):d(m)},"text")},a.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],a.util.createAccessors&&a.util.createAccessors(a.Text)}(e),function(){t.util.object.extend(t.Text.prototype,{isEmptyStyles:function(o){if(!this.styles||typeof o<"u"&&!this.styles[o])return!0;var a=typeof o>"u"?this.styles:{line:this.styles[o]};for(var c in a)for(var f in a[c])for(var h in a[c][f])return!1;return!0},styleHas:function(o,a){if(!this.styles||!o||o===""||typeof a<"u"&&!this.styles[a])return!1;var c=typeof a>"u"?this.styles:{0:this.styles[a]};for(var f in c)for(var h in c[f])if(typeof c[f][h][o]<"u")return!0;return!1},cleanStyle:function(o){if(!this.styles||!o||o==="")return!1;var a=this.styles,c=0,f,h,d=!0,u=0,p;for(var m in a){f=0;for(var g in a[m]){var p=a[m][g],x=p.hasOwnProperty(o);c++,x?(h?p[o]!==h&&(d=!1):h=p[o],p[o]===this[o]&&delete p[o]):d=!1,Object.keys(p).length!==0?f++:delete a[m][g]}f===0&&delete a[m]}for(var y=0;y<this._textLines.length;y++)u+=this._textLines[y].length;d&&c===u&&(this[o]=h,this.removeStyle(o))},removeStyle:function(o){if(!(!this.styles||!o||o==="")){var a=this.styles,c,f,h;for(f in a){c=a[f];for(h in c)delete c[h][o],Object.keys(c[h]).length===0&&delete c[h];Object.keys(c).length===0&&delete a[f]}}},_extendStyles:function(o,a){var c=this.get2DCursorLocation(o);this._getLineStyle(c.lineIndex)||this._setLineStyle(c.lineIndex),this._getStyleDeclaration(c.lineIndex,c.charIndex)||this._setStyleDeclaration(c.lineIndex,c.charIndex,{}),t.util.object.extend(this._getStyleDeclaration(c.lineIndex,c.charIndex),a)},get2DCursorLocation:function(o,a){typeof o>"u"&&(o=this.selectionStart);for(var c=a?this._unwrappedTextLines:this._textLines,f=c.length,h=0;h<f;h++){if(o<=c[h].length)return{lineIndex:h,charIndex:o};o-=c[h].length+this.missingNewlineOffset(h,a)}return{lineIndex:h-1,charIndex:c[h-1].length<o?c[h-1].length:o}},getSelectionStyles:function(o,a,c){typeof o>"u"&&(o=this.selectionStart||0),typeof a>"u"&&(a=this.selectionEnd||o);for(var f=[],h=o;h<a;h++)f.push(this.getStyleAtPosition(h,c));return f},getStyleAtPosition:function(o,a){var c=this.get2DCursorLocation(o),f=a?this.getCompleteStyleDeclaration(c.lineIndex,c.charIndex):this._getStyleDeclaration(c.lineIndex,c.charIndex);return f||{}},setSelectionStyles:function(o,a,c){typeof a>"u"&&(a=this.selectionStart||0),typeof c>"u"&&(c=this.selectionEnd||a);for(var f=a;f<c;f++)this._extendStyles(f,o);return this._forceClearCache=!0,this},_getStyleDeclaration:function(o,a){var c=this.styles&&this.styles[o];return c?c[a]:null},getCompleteStyleDeclaration:function(o,a){for(var c=this._getStyleDeclaration(o,a)||{},f={},h,d=0;d<this._styleProperties.length;d++)h=this._styleProperties[d],f[h]=typeof c[h]>"u"?this[h]:c[h];return f},_setStyleDeclaration:function(o,a,c){this.styles[o][a]=c},_deleteStyleDeclaration:function(o,a){delete this.styles[o][a]},_getLineStyle:function(o){return!!this.styles[o]},_setLineStyle:function(o){this.styles[o]={}},_deleteLineStyle:function(o){delete this.styles[o]}})}(),function(){function o(a){a.textDecoration&&(a.textDecoration.indexOf("underline")>-1&&(a.underline=!0),a.textDecoration.indexOf("line-through")>-1&&(a.linethrough=!0),a.textDecoration.indexOf("overline")>-1&&(a.overline=!0),delete a.textDecoration)}t.IText=t.util.createClass(t.Text,t.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(a,c){this.callSuper("initialize",a,c),this.initBehavior()},setSelectionStart:function(a){a=Math.max(a,0),this._updateAndFire("selectionStart",a)},setSelectionEnd:function(a){a=Math.min(a,this.text.length),this._updateAndFire("selectionEnd",a)},_updateAndFire:function(a,c){this[a]!==c&&(this._fireSelectionChanged(),this[a]=c),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(a){this.clearContextTop(),this.callSuper("render",a),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(a){this.callSuper("_render",a)},clearContextTop:function(a){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var c=this.canvas.contextTop,f=this.canvas.viewportTransform;c.save(),c.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this.transform(c),this._clearTextArea(c),a||c.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var a=this._getCursorBoundaries(),c=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(a,c):this.renderSelection(a,c),c.restore()}},_clearTextArea:function(a){var c=this.width+4,f=this.height+4;a.clearRect(-c/2,-f/2,c,f)},_getCursorBoundaries:function(a){typeof a>"u"&&(a=this.selectionStart);var c=this._getLeftOffset(),f=this._getTopOffset(),h=this._getCursorBoundariesOffsets(a);return{left:c,top:f,leftOffset:h.left,topOffset:h.top}},_getCursorBoundariesOffsets:function(a){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var c,f,h,d=0,u=0,p,m=this.get2DCursorLocation(a);h=m.charIndex,f=m.lineIndex;for(var g=0;g<f;g++)d+=this.getHeightOfLine(g);c=this._getLineLeftOffset(f);var x=this.__charBounds[f][h];return x&&(u=x.left),this.charSpacing!==0&&h===this._textLines[f].length&&(u-=this._getWidthOfCharSpacing()),p={top:d,left:c+(u>0?u:0)},this.direction==="rtl"&&(p.left*=-1),this.cursorOffsetCache=p,this.cursorOffsetCache},renderCursor:function(a,c){var f=this.get2DCursorLocation(),h=f.lineIndex,d=f.charIndex>0?f.charIndex-1:0,u=this.getValueOfPropertyAt(h,d,"fontSize"),p=this.scaleX*this.canvas.getZoom(),m=this.cursorWidth/p,g=a.topOffset,x=this.getValueOfPropertyAt(h,d,"deltaY");g+=(1-this._fontSizeFraction)*this.getHeightOfLine(h)/this.lineHeight-u*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(a,c),c.fillStyle=this.cursorColor||this.getValueOfPropertyAt(h,d,"fill"),c.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,c.fillRect(a.left+a.leftOffset-m/2,g+a.top+x,m,u)},renderSelection:function(a,c){for(var f=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,h=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,d=this.textAlign.indexOf("justify")!==-1,u=this.get2DCursorLocation(f),p=this.get2DCursorLocation(h),m=u.lineIndex,g=p.lineIndex,x=u.charIndex<0?0:u.charIndex,y=p.charIndex<0?0:p.charIndex,w=m;w<=g;w++){var b=this._getLineLeftOffset(w)||0,S=this.getHeightOfLine(w),T=0,O=0,j=0;if(w===m&&(O=this.__charBounds[m][x].left),w>=m&&w<g)j=d&&!this.isEndOfWrapping(w)?this.width:this.getLineWidth(w)||5;else if(w===g)if(y===0)j=this.__charBounds[g][y].left;else{var L=this._getWidthOfCharSpacing();j=this.__charBounds[g][y-1].left+this.__charBounds[g][y-1].width-L}T=S,(this.lineHeight<1||w===g&&this.lineHeight>1)&&(S/=this.lineHeight);var W=a.left+b+O,F=j-O,M=S,V=0;this.inCompositionMode?(c.fillStyle=this.compositionColor||"black",M=1,V=S):c.fillStyle=this.selectionColor,this.direction==="rtl"&&(W=this.width-W-F),c.fillRect(W,a.top+a.topOffset+V,F,M),a.topOffset+=T}},getCurrentCharFontSize:function(){var a=this._getCurrentCharIndex();return this.getValueOfPropertyAt(a.l,a.c,"fontSize")},getCurrentCharColor:function(){var a=this._getCurrentCharIndex();return this.getValueOfPropertyAt(a.l,a.c,"fill")},_getCurrentCharIndex:function(){var a=this.get2DCursorLocation(this.selectionStart,!0),c=a.charIndex>0?a.charIndex-1:0;return{l:a.lineIndex,c}}}),t.IText.fromObject=function(a,c){var f=t.util.stylesFromArray(a.styles,a.text),h=Object.assign({},a,{styles:f});if(delete h.path,o(h),h.styles)for(var d in h.styles)for(var u in h.styles[d])o(h.styles[d][u]);t.Object._fromObject("IText",h,function(p){a.path?t.Object._fromObject("Path",a.path,function(m){p.set("path",m),c(p)},"path"):c(p)},"text")}}(),function(){var o=t.util.object.clone;t.util.object.extend(t.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var a=this;this.on("added",function(){var c=a.canvas;c&&(c._hasITextHandlers||(c._hasITextHandlers=!0,a._initCanvasHandlers(c)),c._iTextInstances=c._iTextInstances||[],c._iTextInstances.push(a))})},initRemovedHandler:function(){var a=this;this.on("removed",function(){var c=a.canvas;c&&(c._iTextInstances=c._iTextInstances||[],t.util.removeFromArray(c._iTextInstances,a),c._iTextInstances.length===0&&(c._hasITextHandlers=!1,a._removeCanvasHandlers(c)))})},_initCanvasHandlers:function(a){a._mouseUpITextHandler=function(){a._iTextInstances&&a._iTextInstances.forEach(function(c){c.__isMousedown=!1})},a.on("mouse:up",a._mouseUpITextHandler)},_removeCanvasHandlers:function(a){a.off("mouse:up",a._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(a,c,f,h){var d;return d={isAborted:!1,abort:function(){this.isAborted=!0}},a.animate("_currentCursorOpacity",c,{duration:f,onComplete:function(){d.isAborted||a[h]()},onChange:function(){a.canvas&&a.selectionStart===a.selectionEnd&&a.renderCursorOrSelection()},abort:function(){return d.isAborted}}),d},_onTickComplete:function(){var a=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){a._currentTickCompleteState=a._animateCursor(a,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(a){var c=this,f=a?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){c._tick()},f)},abortCursorAnimation:function(){var a=this._currentTickState||this._currentTickCompleteState,c=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,a&&c&&c.clearContext(c.contextTop||c.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(a){var c=0,f=a-1;if(this._reSpace.test(this._text[f]))for(;this._reSpace.test(this._text[f]);)c++,f--;for(;/\S/.test(this._text[f])&&f>-1;)c++,f--;return a-c},findWordBoundaryRight:function(a){var c=0,f=a;if(this._reSpace.test(this._text[f]))for(;this._reSpace.test(this._text[f]);)c++,f++;for(;/\S/.test(this._text[f])&&f<this._text.length;)c++,f++;return a+c},findLineBoundaryLeft:function(a){for(var c=0,f=a-1;!/\n/.test(this._text[f])&&f>-1;)c++,f--;return a-c},findLineBoundaryRight:function(a){for(var c=0,f=a;!/\n/.test(this._text[f])&&f<this._text.length;)c++,f++;return a+c},searchWordBoundary:function(a,c){for(var f=this._text,h=this._reSpace.test(f[a])?a-1:a,d=f[h],u=t.reNonWord;!u.test(d)&&h>0&&h<f.length;)h+=c,d=f[h];return u.test(d)&&(h+=c===1?0:1),h},selectWord:function(a){a=a||this.selectionStart;var c=this.searchWordBoundary(a,-1),f=this.searchWordBoundary(a,1);this.selectionStart=c,this.selectionEnd=f,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(a){a=a||this.selectionStart;var c=this.findLineBoundaryLeft(a),f=this.findLineBoundaryRight(a);return this.selectionStart=c,this.selectionEnd=f,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(a){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(a),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(a){a._iTextInstances&&a._iTextInstances.forEach(function(c){c.selected=!1,c.isEditing&&c.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(a){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var c=this.getSelectionStartFromPointer(a.e),f=this.selectionStart,h=this.selectionEnd;(c!==this.__selectionStartOnMouseDown||f===h)&&(f===c||h===c)||(c>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=c):(this.selectionStart=c,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==f||this.selectionEnd!==h)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(a,c,f){var h=f.slice(0,a),d=t.util.string.graphemeSplit(h).length;if(a===c)return{selectionStart:d,selectionEnd:d};var u=f.slice(a,c),p=t.util.string.graphemeSplit(u).length;return{selectionStart:d,selectionEnd:d+p}},fromGraphemeToStringSelection:function(a,c,f){var h=f.slice(0,a),d=h.join("").length;if(a===c)return{selectionStart:d,selectionEnd:d};var u=f.slice(a,c),p=u.join("").length;return{selectionStart:d,selectionEnd:d+p}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var a=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=a.selectionStart,this.hiddenTextarea.selectionEnd=a.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var a=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=a.selectionEnd,this.inCompositionMode||(this.selectionStart=a.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var a=this._calcTextareaPosition();this.hiddenTextarea.style.left=a.left,this.hiddenTextarea.style.top=a.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var a=this.inCompositionMode?this.compositionStart:this.selectionStart,c=this._getCursorBoundaries(a),f=this.get2DCursorLocation(a),h=f.lineIndex,d=f.charIndex,u=this.getValueOfPropertyAt(h,d,"fontSize")*this.lineHeight,p=c.leftOffset,m=this.calcTransformMatrix(),g={x:c.left+p,y:c.top+c.topOffset+u},x=this.canvas.getRetinaScaling(),y=this.canvas.upperCanvasEl,w=y.width/x,b=y.height/x,S=w-u,T=b-u,O=y.clientWidth/w,j=y.clientHeight/b;return g=t.util.transformPoint(g,m),g=t.util.transformPoint(g,this.canvas.viewportTransform),g.x*=O,g.y*=j,g.x<0&&(g.x=0),g.x>S&&(g.x=S),g.y<0&&(g.y=0),g.y>T&&(g.y=T),g.x+=this.canvas._offset.left,g.y+=this.canvas._offset.top,{left:g.x+"px",top:g.y+"px",fontSize:u+"px",charHeight:u}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var a=this._textBeforeEdit!==this.text,c=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,c&&(c.blur&&c.blur(),c.parentNode&&c.parentNode.removeChild(c)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),a&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),a&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var a in this.styles)this._textLines[a]||delete this.styles[a]},removeStyleFromTo:function(a,c){var f=this.get2DCursorLocation(a,!0),h=this.get2DCursorLocation(c,!0),d=f.lineIndex,u=f.charIndex,p=h.lineIndex,m=h.charIndex,g,x;if(d!==p){if(this.styles[d])for(g=u;g<this._unwrappedTextLines[d].length;g++)delete this.styles[d][g];if(this.styles[p])for(g=m;g<this._unwrappedTextLines[p].length;g++)x=this.styles[p][g],x&&(this.styles[d]||(this.styles[d]={}),this.styles[d][u+g-m]=x);for(g=d+1;g<=p;g++)delete this.styles[g];this.shiftLineStyles(p,d-p)}else if(this.styles[d]){x=this.styles[d];var y=m-u,w,b;for(g=u;g<m;g++)delete x[g];for(b in this.styles[d])w=parseInt(b,10),w>=m&&(x[w-y]=x[b],delete x[b])}},shiftLineStyles:function(a,c){var f=o(this.styles);for(var h in this.styles){var d=parseInt(h,10);d>a&&(this.styles[d+c]=f[d],f[d-c]||delete this.styles[d])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(a,c,f,h){var d,u={},p=!1,m=this._unwrappedTextLines[a].length,g=m===c;f||(f=1),this.shiftLineStyles(a,f),this.styles[a]&&(d=this.styles[a][c===0?c:c-1]);for(var x in this.styles[a]){var y=parseInt(x,10);y>=c&&(p=!0,u[y-c]=this.styles[a][x],g&&c===0||delete this.styles[a][x])}var w=!1;for(p&&!g&&(this.styles[a+f]=u,w=!0),(w||m>c)&&f--;f>0;)h&&h[f-1]?this.styles[a+f]={0:o(h[f-1])}:d?this.styles[a+f]={0:o(d)}:delete this.styles[a+f],f--;this._forceClearCache=!0},insertCharStyleObject:function(a,c,f,h){this.styles||(this.styles={});var d=this.styles[a],u=d?o(d):{};f||(f=1);for(var p in u){var m=parseInt(p,10);m>=c&&(d[m+f]=u[m],u[m-f]||delete d[m])}if(this._forceClearCache=!0,h){for(;f--;)Object.keys(h[f]).length&&(this.styles[a]||(this.styles[a]={}),this.styles[a][c+f]=o(h[f]));return}if(d)for(var g=d[c?c-1:1];g&&f--;)this.styles[a][c+f]=o(g)},insertNewStyleBlock:function(a,c,f){for(var h=this.get2DCursorLocation(c,!0),d=[0],u=0,p=0;p<a.length;p++)a[p]===`
`?(u++,d[u]=0):d[u]++;d[0]>0&&(this.insertCharStyleObject(h.lineIndex,h.charIndex,d[0],f),f=f&&f.slice(d[0]+1)),u&&this.insertNewlineStyleObject(h.lineIndex,h.charIndex+d[0],u);for(var p=1;p<u;p++)d[p]>0?this.insertCharStyleObject(h.lineIndex+p,0,d[p],f):f&&this.styles[h.lineIndex+p]&&f[0]&&(this.styles[h.lineIndex+p][0]=f[0]),f=f&&f.slice(d[p]+1);d[p]>0&&this.insertCharStyleObject(h.lineIndex+p,0,d[p],f)},setSelectionStartEndWithShift:function(a,c,f){f<=a?(c===a?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=a),this.selectionStart=f):f>a&&f<c?this._selectionDirection==="right"?this.selectionEnd=f:this.selectionStart=f:(c===a?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=c),this.selectionEnd=f)},setSelectionInBoundaries:function(){var a=this.text.length;this.selectionStart>a?this.selectionStart=a:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>a?this.selectionEnd=a:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),t.util.object.extend(t.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(o){if(this.canvas){this.__newClickTime=+new Date;var a=o.pointer;this.isTripleClick(a)&&(this.fire("tripleclick",o),this._stopEvent(o.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=a,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(o){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===o.x&&this.__lastPointer.y===o.y},_stopEvent:function(o){o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(o){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(o.e))},tripleClickHandler:function(o){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(o.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(o){!this.canvas||!this.editable||o.e.button&&o.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(o.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(o){!this.canvas||!this.editable||o.e.button&&o.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(o){if(this.__isMousedown=!1,!(!this.editable||this.group||o.transform&&o.transform.actionPerformed||o.e.button&&o.e.button!==1)){if(this.canvas){var a=this.canvas._activeObject;if(a&&a!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(o.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(o){var a=this.getSelectionStartFromPointer(o),c=this.selectionStart,f=this.selectionEnd;o.shiftKey?this.setSelectionStartEndWithShift(c,f,a):(this.selectionStart=a,this.selectionEnd=a),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(o){for(var a=this.getLocalPointer(o),c=0,f=0,h=0,d=0,u=0,p,m,g=0,x=this._textLines.length;g<x&&h<=a.y;g++)h+=this.getHeightOfLine(g)*this.scaleY,u=g,g>0&&(d+=this._textLines[g-1].length+this.missingNewlineOffset(g-1));p=this._getLineLeftOffset(u),f=p*this.scaleX,m=this._textLines[u],this.direction==="rtl"&&(a.x=this.width*this.scaleX-a.x+f);for(var y=0,w=m.length;y<w&&(c=f,f+=this.__charBounds[u][y].kernedWidth*this.scaleX,f<=a.x);y++)d++;return this._getNewSelectionStartFromOffset(a,c,f,d,w)},_getNewSelectionStartFromOffset:function(o,a,c,f,h){var d=o.x-a,u=c-o.x,p=u>d||u<0?0:1,m=f+p;return this.flipX&&(m=h-m),m>this._text.length&&(m=this._text.length),m}}),t.util.object.extend(t.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=t.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var o=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+o.top+"; left: "+o.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+o.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):t.document.body.appendChild(this.hiddenTextarea),t.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),t.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),t.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),t.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(t.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(o){if(this.isEditing){var a=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(o.keyCode in a)this[a[o.keyCode]](o);else if(o.keyCode in this.ctrlKeysMapDown&&(o.ctrlKey||o.metaKey))this[this.ctrlKeysMapDown[o.keyCode]](o);else return;o.stopImmediatePropagation(),o.preventDefault(),o.keyCode>=33&&o.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(o){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(o.keyCode in this.ctrlKeysMapUp&&(o.ctrlKey||o.metaKey))this[this.ctrlKeysMapUp[o.keyCode]](o);else return;o.stopImmediatePropagation(),o.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(o){var a=this.fromPaste;if(this.fromPaste=!1,o&&o.stopPropagation(),!!this.isEditing){var c=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,f=this._text.length,h=c.length,d,u,p=h-f,m=this.selectionStart,g=this.selectionEnd,x=m!==g,y,w,b;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var S=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),T=m>S.selectionStart;x?(d=this._text.slice(m,g),p+=g-m):h<f&&(T?d=this._text.slice(g+p,g):d=this._text.slice(m,m-p)),u=c.slice(S.selectionEnd-p,S.selectionEnd),d&&d.length&&(u.length&&(y=this.getSelectionStyles(m,m+1,!1),y=u.map(function(){return y[0]})),x?(w=m,b=g):T?(w=g-d.length,b=g):(w=g,b=g+d.length),this.removeStyleFromTo(w,b)),u.length&&(a&&u.join("")===t.copiedText&&!t.disableStyleCopyPaste&&(y=t.copiedTextStyle),this.insertNewStyleBlock(u,m,y)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(o){this.compositionStart=o.target.selectionStart,this.compositionEnd=o.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(t.copiedText=this.getSelectedText(),t.disableStyleCopyPaste?t.copiedTextStyle=null:t.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(o){return o&&o.clipboardData||t.window.clipboardData},_getWidthBeforeCursor:function(o,a){var c=this._getLineLeftOffset(o),f;return a>0&&(f=this.__charBounds[o][a-1],c+=f.left+f.width),c},getDownCursorOffset:function(o,a){var c=this._getSelectionForOffset(o,a),f=this.get2DCursorLocation(c),h=f.lineIndex;if(h===this._textLines.length-1||o.metaKey||o.keyCode===34)return this._text.length-c;var d=f.charIndex,u=this._getWidthBeforeCursor(h,d),p=this._getIndexOnLine(h+1,u),m=this._textLines[h].slice(d);return m.length+p+1+this.missingNewlineOffset(h)},_getSelectionForOffset:function(o,a){return o.shiftKey&&this.selectionStart!==this.selectionEnd&&a?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(o,a){var c=this._getSelectionForOffset(o,a),f=this.get2DCursorLocation(c),h=f.lineIndex;if(h===0||o.metaKey||o.keyCode===33)return-c;var d=f.charIndex,u=this._getWidthBeforeCursor(h,d),p=this._getIndexOnLine(h-1,u),m=this._textLines[h].slice(0,d),g=this.missingNewlineOffset(h-1);return-this._textLines[h-1].length+p-m.length+(1-g)},_getIndexOnLine:function(o,a){for(var c=this._textLines[o],f=this._getLineLeftOffset(o),h=f,d=0,u,p,m=0,g=c.length;m<g;m++)if(u=this.__charBounds[o][m].width,h+=u,h>a){p=!0;var x=h-u,y=h,w=Math.abs(x-a),b=Math.abs(y-a);d=b<w?m:m-1;break}return p||(d=c.length-1),d},moveCursorDown:function(o){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",o)},moveCursorUp:function(o){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",o)},_moveCursorUpOrDown:function(o,a){var c="get"+o+"CursorOffset",f=this[c](a,this._selectionDirection==="right");a.shiftKey?this.moveCursorWithShift(f):this.moveCursorWithoutShift(f),f!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(o){var a=this._selectionDirection==="left"?this.selectionStart+o:this.selectionEnd+o;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,a),o!==0},moveCursorWithoutShift:function(o){return o<0?(this.selectionStart+=o,this.selectionEnd=this.selectionStart):(this.selectionEnd+=o,this.selectionStart=this.selectionEnd),o!==0},moveCursorLeft:function(o){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",o)},_move:function(o,a,c){var f;if(o.altKey)f=this["findWordBoundary"+c](this[a]);else if(o.metaKey||o.keyCode===35||o.keyCode===36)f=this["findLineBoundary"+c](this[a]);else return this[a]+=c==="Left"?-1:1,!0;if(typeof f<"u"&&this[a]!==f)return this[a]=f,!0},_moveLeft:function(o,a){return this._move(o,a,"Left")},_moveRight:function(o,a){return this._move(o,a,"Right")},moveCursorLeftWithoutShift:function(o){var a=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(a=this._moveLeft(o,"selectionStart")),this.selectionEnd=this.selectionStart,a},moveCursorLeftWithShift:function(o){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(o,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(o,"selectionStart")},moveCursorRight:function(o){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",o)},_moveCursorLeftOrRight:function(o,a){var c="moveCursor"+o+"With";this._currentCursorOpacity=1,a.shiftKey?c+="Shift":c+="outShift",this[c](a)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(o){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(o,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(o,"selectionEnd")},moveCursorRightWithoutShift:function(o){var a=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(a=this._moveRight(o,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,a},removeChars:function(o,a){typeof a>"u"&&(a=o+1),this.removeStyleFromTo(o,a),this._text.splice(o,a-o),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(o,a,c,f){typeof f>"u"&&(f=c),f>c&&this.removeStyleFromTo(c,f);var h=t.util.string.graphemeSplit(o);this.insertNewStyleBlock(h,c,a),this._text=[].concat(this._text.slice(0,c),h,this._text.slice(f)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var o=t.util.toFixed,a=t.util.radiansToDegrees,c=t.util.calcRotateMatrix,f=t.util.transformPoint,h=/  +/g;t.util.object.extend(t.Text.prototype,{_toSVG:function(){var d=this._getSVGLeftTopOffsets(),u=this._getSVGTextAndBg(d.textTop,d.textLeft);return this._wrapSVGTextAndBg(u)},toSVG:function(d){var u=this._createBaseSVGMarkup(this._toSVG(),{reviver:d,noStyle:!0,withShadow:!0}),p=this.path;return p?u+p._createBaseSVGMarkup(p._toSVG(),{reviver:d,withShadow:!0}):u},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(d){var u=!0,p=this.getSvgTextDecoration(this);return[d.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",p?'text-decoration="'+p+'" ':"",'style="',this.getSvgStyles(u),'"',this.addPaintOrder()," >",d.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(d,u){var p=[],m=[],g=d,x;this._setSVGBg(m);for(var y=0,w=this._textLines.length;y<w;y++)x=this._getLineLeftOffset(y),(this.textBackgroundColor||this.styleHas("textBackgroundColor",y))&&this._setSVGTextLineBg(m,y,u+x,g),this._setSVGTextLineText(p,y,u+x,g),g+=this.getHeightOfLine(y);return{textSpans:p,textBgRects:m}},_createTextCharSpan:function(d,u,p,m,g){var x=d!==d.trim()||d.match(h),y=this.getSvgSpanStyles(u,x),w=y?'style="'+y+'"':"",b=u.deltaY,S="",T=t.Object.NUM_FRACTION_DIGITS,O="";if(b&&(S=' dy="'+o(b,T)+'" '),g.renderLeft!==void 0){var j=g.angle;O=' rotate="'+o(a(j),t.Object.NUM_FRACTION_DIGITS)+'" ';var L=g.width/2,W=c({angle:a(j)});W[4]=g.renderLeft,W[5]=g.renderTop;var F=f({x:-L,y:0},W);p=F.x,m=F.y}return['<tspan x="',o(p,T),'" y="',o(m,T),'" ',S,w,O,">",t.util.string.escapeXml(d),"</tspan>"].join("")},_setSVGTextLineText:function(d,u,p,m){var g=this.getHeightOfLine(u),x=this.textAlign.indexOf("justify")!==-1,y,w,b="",S,T,O=0,j=this._textLines[u],L;m+=g*(1-this._fontSizeFraction)/this.lineHeight;for(var W=0,F=j.length-1;W<=F;W++)L=W===F||this.charSpacing||this.path,b+=j[W],S=this.__charBounds[u][W],O===0?(p+=S.kernedWidth-S.width,O+=S.width):O+=S.kernedWidth,x&&!L&&this._reSpaceAndTab.test(j[W])&&(L=!0),L||(y=y||this.getCompleteStyleDeclaration(u,W),w=this.getCompleteStyleDeclaration(u,W+1),L=t.util.hasStyleChanged(y,w,!0)),L&&(T=this._getStyleDeclaration(u,W)||{},d.push(this._createTextCharSpan(b,T,p,m,S)),b="",y=w,p+=O,O=0)},_pushTextBgRect:function(d,u,p,m,g,x){var y=t.Object.NUM_FRACTION_DIGITS;d.push("		<rect ",this._getFillAttributes(u),' x="',o(p,y),'" y="',o(m,y),'" width="',o(g,y),'" height="',o(x,y),`"></rect>
`)},_setSVGTextLineBg:function(d,u,p,m){for(var g=this._textLines[u],x=this.getHeightOfLine(u)/this.lineHeight,y=0,w=0,b,S,T=this.getValueOfPropertyAt(u,0,"textBackgroundColor"),O=0,j=g.length;O<j;O++)b=this.__charBounds[u][O],S=this.getValueOfPropertyAt(u,O,"textBackgroundColor"),S!==T?(T&&this._pushTextBgRect(d,T,p+w,m,y,x),w=b.left,y=b.width,T=S):y+=b.kernedWidth;S&&this._pushTextBgRect(d,S,p+w,m,y,x)},_getFillAttributes:function(d){var u=d&&typeof d=="string"?new t.Color(d):"";return!u||!u.getSource()||u.getAlpha()===1?'fill="'+d+'"':'opacity="'+u.getAlpha()+'" fill="'+u.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(d){for(var u=0,p=0,m=0;m<d;m++)u+=this.getHeightOfLine(m);return p=this.getHeightOfLine(m),{lineTop:u,offset:(this._fontSizeMult-this._fontSizeFraction)*p/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(d){var u=t.Object.prototype.getSvgStyles.call(this,d);return u+" white-space: pre;"}})}(),function(o){var a=o.fabric||(o.fabric={});a.Textbox=a.util.createClass(a.IText,a.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:a.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(c){for(var f=0,h=0,d=0,u={},p=0;p<c.graphemeLines.length;p++)c.graphemeText[d]===`
`&&p>0?(h=0,d++,f++):!this.splitByGrapheme&&this._reSpaceAndTab.test(c.graphemeText[d])&&p>0&&(h++,d++),u[p]={line:f,offset:h},d+=c.graphemeLines[p].length,h+=c.graphemeLines[p].length;return u},styleHas:function(c,f){if(this._styleMap&&!this.isWrapping){var h=this._styleMap[f];h&&(f=h.line)}return a.Text.prototype.styleHas.call(this,c,f)},isEmptyStyles:function(c){if(!this.styles)return!0;var f=0,h=c+1,d,u,p=!1,m=this._styleMap[c],g=this._styleMap[c+1];m&&(c=m.line,f=m.offset),g&&(h=g.line,p=h===c,d=g.offset),u=typeof c>"u"?this.styles:{line:this.styles[c]};for(var x in u)for(var y in u[x])if(y>=f&&(!p||y<d))for(var w in u[x][y])return!1;return!0},_getStyleDeclaration:function(c,f){if(this._styleMap&&!this.isWrapping){var h=this._styleMap[c];if(!h)return null;c=h.line,f=h.offset+f}return this.callSuper("_getStyleDeclaration",c,f)},_setStyleDeclaration:function(c,f,h){var d=this._styleMap[c];c=d.line,f=d.offset+f,this.styles[c][f]=h},_deleteStyleDeclaration:function(c,f){var h=this._styleMap[c];c=h.line,f=h.offset+f,delete this.styles[c][f]},_getLineStyle:function(c){var f=this._styleMap[c];return!!this.styles[f.line]},_setLineStyle:function(c){var f=this._styleMap[c];this.styles[f.line]={}},_wrapText:function(c,f){var h=[],d;for(this.isWrapping=!0,d=0;d<c.length;d++)h=h.concat(this._wrapLine(c[d],d,f));return this.isWrapping=!1,h},_measureWord:function(c,f,h){var d=0,u,p=!0;h=h||0;for(var m=0,g=c.length;m<g;m++){var x=this._getGraphemeBox(c[m],f,m+h,u,p);d+=x.kernedWidth,u=c[m]}return d},_wrapLine:function(c,f,h,W){var u=0,p=this.splitByGrapheme,m=[],g=[],x=p?a.util.string.graphemeSplit(c):c.split(this._wordJoiners),y="",w=0,b=p?"":" ",S=0,T=0,O=0,j=!0,L=this._getWidthOfCharSpacing(),W=W||0;x.length===0&&x.push([]),h-=W;for(var F=0;F<x.length;F++)y=p?x[F]:a.util.string.graphemeSplit(x[F]),S=this._measureWord(y,f,w),w+=y.length,u+=T+S-L,u>h&&!j?(m.push(g),g=[],u=S,j=!0):u+=L,!j&&!p&&g.push(b),g=g.concat(y),T=p?0:this._measureWord([b],f,w),w++,j=!1,S>O&&(O=S);return F&&m.push(g),O+W>this.dynamicMinWidth&&(this.dynamicMinWidth=O-L+W),m},isEndOfWrapping:function(c){return!this._styleMap[c+1]||this._styleMap[c+1].line!==this._styleMap[c].line},missingNewlineOffset:function(c,f){return this.splitByGrapheme&&!f?this.isEndOfWrapping(c)?1:0:1},_splitTextIntoLines:function(c){for(var f=a.Text.prototype._splitTextIntoLines.call(this,c),h=this._wrapText(f.lines,this.width),d=new Array(h.length),u=0;u<h.length;u++)d[u]=h[u].join("");return f.lines=d,f.graphemeLines=h,f},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var c={};for(var f in this._styleMap)this._textLines[f]&&(c[this._styleMap[f].line]=1);for(var f in this.styles)c[f]||delete this.styles[f]},toObject:function(c){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(c))}}),a.Textbox.fromObject=function(c,f){var h=a.util.stylesFromArray(c.styles,c.text),d=Object.assign({},c,{styles:h});return delete d.path,a.Object._fromObject("Textbox",d,function(u){c.path?a.Object._fromObject("Path",c.path,function(p){u.set("path",p),f(u)},"path"):f(u)},"text")}}(e),function(){var o=t.controlsUtils,a=o.scaleSkewCursorStyleHandler,c=o.scaleCursorStyleHandler,f=o.scalingEqually,h=o.scalingYOrSkewingX,d=o.scalingXOrSkewingY,u=o.scaleOrSkewActionName,p=t.Object.prototype.controls;if(p.ml=new t.Control({x:-.5,y:0,cursorStyleHandler:a,actionHandler:d,getActionName:u}),p.mr=new t.Control({x:.5,y:0,cursorStyleHandler:a,actionHandler:d,getActionName:u}),p.mb=new t.Control({x:0,y:.5,cursorStyleHandler:a,actionHandler:h,getActionName:u}),p.mt=new t.Control({x:0,y:-.5,cursorStyleHandler:a,actionHandler:h,getActionName:u}),p.tl=new t.Control({x:-.5,y:-.5,cursorStyleHandler:c,actionHandler:f}),p.tr=new t.Control({x:.5,y:-.5,cursorStyleHandler:c,actionHandler:f}),p.bl=new t.Control({x:-.5,y:.5,cursorStyleHandler:c,actionHandler:f}),p.br=new t.Control({x:.5,y:.5,cursorStyleHandler:c,actionHandler:f}),p.mtr=new t.Control({x:0,y:-.5,actionHandler:o.rotationWithSnapping,cursorStyleHandler:o.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),t.Textbox){var m=t.Textbox.prototype.controls={};m.mtr=p.mtr,m.tr=p.tr,m.br=p.br,m.tl=p.tl,m.bl=p.bl,m.mt=p.mt,m.mb=p.mb,m.mr=new t.Control({x:.5,y:0,actionHandler:o.changeWidth,cursorStyleHandler:a,actionName:"resizing"}),m.ml=new t.Control({x:-.5,y:0,actionHandler:o.changeWidth,cursorStyleHandler:a,actionName:"resizing"})}}()})(Ht);function Zg(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function PO(e,t,r,n){function i(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function o(f){try{c(n.next(f))}catch(h){l(h)}}function a(f){try{c(n.throw(f))}catch(h){l(h)}}function c(f){f.done?s(f.value):i(f.value).then(o,a)}c((n=n.apply(e,t||[])).next())})}const FO=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class X2 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class DO extends X2{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Wb extends X2{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Hb extends X2{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var hv;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(hv||(hv={}));class LO{constructor(t,{headers:r={},customFetch:n,region:i=hv.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=FO(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return PO(this,arguments,void 0,function*(r,n={}){var i;let s,l;try{const{headers:o,method:a,body:c,signal:f,timeout:h}=n;let d={},{region:u}=n;u||(u=this.region);const p=new URL(`${this.url}/${r}`);u&&u!=="any"&&(d["x-region"]=u,p.searchParams.set("forceFunctionRegion",u));let m;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",m=c):typeof c=="string"?(d["Content-Type"]="text/plain",m=c):typeof FormData<"u"&&c instanceof FormData?m=c:(d["Content-Type"]="application/json",m=JSON.stringify(c)):c&&typeof c!="string"&&!(typeof Blob<"u"&&c instanceof Blob)&&!(c instanceof ArrayBuffer)&&!(typeof FormData<"u"&&c instanceof FormData)?m=JSON.stringify(c):m=c;let g=f;h&&(l=new AbortController,s=setTimeout(()=>l.abort(),h),f?(g=l.signal,f.addEventListener("abort",()=>l.abort())):g=l.signal);const x=yield this.fetch(p.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),o),body:m,signal:g}).catch(S=>{throw new DO(S)}),y=x.headers.get("x-relay-error");if(y&&y==="true")throw new Wb(x);if(!x.ok)throw new Hb(x);let w=((i=x.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),b;return w==="application/json"?b=yield x.json():w==="application/octet-stream"||w==="application/pdf"?b=yield x.blob():w==="text/event-stream"?b=x:w==="multipart/form-data"?b=yield x.formData():b=yield x.text(),{data:b,error:null,response:x}}catch(o){return{data:null,error:o,response:o instanceof Hb||o instanceof Wb?o.context:void 0}}finally{s&&clearTimeout(s)}})}}var IO=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},MO=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{let l=null,o=null,a=null,c=s.status,f=s.statusText;if(s.ok){var h,d;if(r.method!=="HEAD"){var u;const x=await s.text();x===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((u=r.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?o=x:o=JSON.parse(x))}const m=(h=r.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),g=(d=s.headers.get("content-range"))===null||d===void 0?void 0:d.split("/");m&&g&&g.length>1&&(a=parseInt(g[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(o)&&(o.length>1?(l={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,a=null,c=406,f="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var p;const m=await s.text();try{l=JSON.parse(m),Array.isArray(l)&&s.status===404&&(o=[],l=null,c=200,f="OK")}catch{s.status===404&&m===""?(c=204,f="No Content"):l={message:m}}if(l&&r.isMaybeSingle&&(!(l==null||(p=l.details)===null||p===void 0)&&p.includes("0 rows"))&&(l=null,c=200,f="OK"),l&&r.shouldThrowOnError)throw new IO(l)}return{error:l,data:o,count:a,status:c,statusText:f}});return this.shouldThrowOnError||(i=i.catch(s=>{var l;let o="";const a=s==null?void 0:s.cause;if(a){var c,f,h,d;const p=(c=a==null?void 0:a.message)!==null&&c!==void 0?c:"",m=(f=a==null?void 0:a.code)!==null&&f!==void 0?f:"";o=`${(h=s==null?void 0:s.name)!==null&&h!==void 0?h:"FetchError"}: ${s==null?void 0:s.message}`,o+=`

Caused by: ${(d=a==null?void 0:a.name)!==null&&d!==void 0?d:"Error"}: ${p}`,m&&(o+=` (${m})`),a!=null&&a.stack&&(o+=`
${a.stack}`)}else{var u;o=(u=s==null?void 0:s.stack)!==null&&u!==void 0?u:""}return{error:{message:`${(l=s==null?void 0:s.name)!==null&&l!==void 0?l:"FetchError"}: ${s==null?void 0:s.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}},RO=class extends MO{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const s=i?`${i}.order`:"order",l=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"offset":`${n}.offset`,s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(s,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:s="text"}={}){var l;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),a=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${s}; for="${a}"; options=${o};`),s==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const $b=new RegExp("[,()]");var Cu=class extends RO{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&$b.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&$b.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const s=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${s}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},BO=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:n}=t??{},i=r?"HEAD":"GET";let s=!1;const l=(e??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join(""),{url:o,headers:a}=this.cloneRequestState();return o.searchParams.set("select",l),n&&a.append("Prefer",`count=${n}`),new Cu({method:i,url:o,headers:a,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const i="POST",{url:s,headers:l}=this.cloneRequestState();if(t&&l.append("Prefer",`count=${t}`),r||l.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((a,c)=>a.concat(Object.keys(c)),[]);if(o.length>0){const a=[...new Set(o)].map(c=>`"${c}"`);s.searchParams.set("columns",a.join(","))}}return new Cu({method:i,url:s,headers:l,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){var s;const l="POST",{url:o,headers:a}=this.cloneRequestState();if(a.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&o.searchParams.set("on_conflict",t),n&&a.append("Prefer",`count=${n}`),i||a.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((f,h)=>f.concat(Object.keys(h)),[]);if(c.length>0){const f=[...new Set(c)].map(h=>`"${h}"`);o.searchParams.set("columns",f.join(","))}}return new Cu({method:l,url:o,headers:a,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}update(e,{count:t}={}){var r;const n="PATCH",{url:i,headers:s}=this.cloneRequestState();return t&&s.append("Prefer",`count=${t}`),new Cu({method:n,url:i,headers:s,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:n,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new Cu({method:r,url:n,headers:i,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},UO=class i3{constructor(t,{headers:r={},schema:n,fetch:i}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=i}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new BO(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new i3(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:i=!1,count:s}={}){var l;let o;const a=new URL(`${this.url}/rpc/${t}`);let c;const f=u=>u!==null&&typeof u=="object"&&(!Array.isArray(u)||u.some(f)),h=n&&Object.values(r).some(f);h?(o="POST",c=r):n||i?(o=n?"HEAD":"GET",Object.entries(r).filter(([u,p])=>p!==void 0).map(([u,p])=>[u,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([u,p])=>{a.searchParams.append(u,p)})):(o="POST",c=r);const d=new Headers(this.headers);return h?d.set("Prefer",s?`count=${s},return=minimal`:"return=minimal"):s&&d.set("Prefer",`count=${s}`),new Cu({method:o,url:a,headers:d,schema:this.schemaName,body:c,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}};class zO{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const n=r.versions;if(n&&n.node){const i=n.node,s=parseInt(i.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const WO="2.93.1",HO=`realtime-js/${WO}`,$O="1.0.0",s3="2.0.0",qb=s3,dv=1e4,qO=1e3,VO=100;var dl;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(dl||(dl={}));var Vn;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Vn||(Vn={}));var pa;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(pa||(pa={}));var pv;(function(e){e.websocket="websocket"})(pv||(pv={}));var dc;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(dc||(dc={}));class GO{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},l=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(t,r,n){var i,s;const l=t.topic,o=(i=t.ref)!==null&&i!==void 0?i:"",a=(s=t.join_ref)!==null&&s!==void 0?s:"",c=t.payload.event,f=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},h=Object.keys(f).length===0?"":JSON.stringify(f);if(a.length>255)throw new Error(`joinRef length ${a.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const d=this.USER_BROADCAST_PUSH_META_LENGTH+a.length+o.length+l.length+c.length+h.length,u=new ArrayBuffer(this.HEADER_LENGTH+d);let p=new DataView(u),m=0;p.setUint8(m++,this.KINDS.userBroadcastPush),p.setUint8(m++,a.length),p.setUint8(m++,o.length),p.setUint8(m++,l.length),p.setUint8(m++,c.length),p.setUint8(m++,h.length),p.setUint8(m++,r),Array.from(a,x=>p.setUint8(m++,x.charCodeAt(0))),Array.from(o,x=>p.setUint8(m++,x.charCodeAt(0))),Array.from(l,x=>p.setUint8(m++,x.charCodeAt(0))),Array.from(c,x=>p.setUint8(m++,x.charCodeAt(0))),Array.from(h,x=>p.setUint8(m++,x.charCodeAt(0)));var g=new Uint8Array(u.byteLength+n.byteLength);return g.set(new Uint8Array(u),0),g.set(new Uint8Array(n),u.byteLength),g.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[i,s,l,o,a]=n;return r({join_ref:i,ref:s,topic:l,event:o,payload:a})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,i)}}_decodeUserBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2),l=r.getUint8(3),o=r.getUint8(4);let a=this.HEADER_LENGTH+4;const c=n.decode(t.slice(a,a+i));a=a+i;const f=n.decode(t.slice(a,a+s));a=a+s;const h=n.decode(t.slice(a,a+l));a=a+l;const d=t.slice(a,t.byteLength),u=o===this.JSON_ENCODING?JSON.parse(n.decode(d)):d,p={type:this.BROADCAST_EVENT,event:f,payload:u};return l>0&&(p.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class a3{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Mr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Mr||(Mr={}));const Vb=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((s,l)=>(s[l]=XO(l,e,t,i),s),{}):{}},XO=(e,t,r,n)=>{const i=t.find(o=>o.name===e),s=i==null?void 0:i.type,l=r[e];return s&&!n.includes(s)?o3(s,l):gv(l)},o3=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return QO(t,r)}switch(e){case Mr.bool:return YO(t);case Mr.float4:case Mr.float8:case Mr.int2:case Mr.int4:case Mr.int8:case Mr.numeric:case Mr.oid:return KO(t);case Mr.json:case Mr.jsonb:return JO(t);case Mr.timestamp:return ZO(t);case Mr.abstime:case Mr.date:case Mr.daterange:case Mr.int4range:case Mr.int8range:case Mr.money:case Mr.reltime:case Mr.text:case Mr.time:case Mr.timestamptz:case Mr.timetz:case Mr.tsrange:case Mr.tstzrange:return gv(t);default:return gv(t)}},gv=e=>e,YO=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},KO=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},JO=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},QO=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const l=e.slice(1,r);try{s=JSON.parse("["+l+"]")}catch{s=l?l.split(","):[]}return s.map(o=>o3(t,o))}return e},ZO=e=>typeof e=="string"?e.replace(" ","T"):e,l3=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class k1{constructor(t,r,n={},i=dv){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Gb;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Gb||(Gb={}));class Dh{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:l,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Dh.syncState(this.state,i,s,l),this.pendingDiffs.forEach(a=>{this.state=Dh.syncDiff(this.state,a,s,l)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:l,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Dh.syncDiff(this.state,i,s,l),o())}),this.onJoin((i,s,l)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:l})}),this.onLeave((i,s,l)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const s=this.cloneDeep(t),l=this.transformState(r),o={},a={};return this.map(s,(c,f)=>{l[c]||(a[c]=f)}),this.map(l,(c,f)=>{const h=s[c];if(h){const d=f.map(g=>g.presence_ref),u=h.map(g=>g.presence_ref),p=f.filter(g=>u.indexOf(g.presence_ref)<0),m=h.filter(g=>d.indexOf(g.presence_ref)<0);p.length>0&&(o[c]=p),m.length>0&&(a[c]=m)}else o[c]=f}),this.syncDiff(s,{joins:o,leaves:a},n,i)}static syncDiff(t,r,n,i){const{joins:s,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(o,a)=>{var c;const f=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(a),f.length>0){const h=t[o].map(u=>u.presence_ref),d=f.filter(u=>h.indexOf(u.presence_ref)<0);t[o].unshift(...d)}n(o,f,a)}),this.map(l,(o,a)=>{let c=t[o];if(!c)return;const f=a.map(h=>h.presence_ref);c=c.filter(h=>f.indexOf(h.presence_ref)<0),t[o]=c,i(o,c,a),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Xb;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Xb||(Xb={}));var Lh;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Lh||(Lh={}));var bo;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(bo||(bo={}));class Hu{constructor(t,r={config:{}},n){var i,s;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Vn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new k1(this,pa.join,this.params,this.timeout),this.rejoinTimer=new a3(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Vn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Vn.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Vn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Vn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Vn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(pa.reply,{},(l,o)=>{this._trigger(this._replyEventName(o),l)}),this.presence=new Dh(this),this.broadcastEndpointURL=l3(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Vn.closed){const{config:{broadcast:l,presence:o,private:a}}=this.params,c=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&i!==void 0?i:[],f=!!this.bindings[Lh.PRESENCE]&&this.bindings[Lh.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,h={},d={broadcast:l,presence:Object.assign(Object.assign({},o),{enabled:f}),postgres_changes:c,private:a};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(u=>t==null?void 0:t(bo.CHANNEL_ERROR,u)),this._onClose(()=>t==null?void 0:t(bo.CLOSED)),this.updateJoinPayload(Object.assign({config:d},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var p;if(this.socket._isManualToken()||this.socket.setAuth(),u===void 0){t==null||t(bo.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,g=(p=m==null?void 0:m.length)!==null&&p!==void 0?p:0,x=[];for(let y=0;y<g;y++){const w=m[y],{filter:{event:b,schema:S,table:T,filter:O}}=w,j=u&&u[y];if(j&&j.event===b&&Hu.isFilterValueEqual(j.schema,S)&&Hu.isFilterValueEqual(j.table,T)&&Hu.isFilterValueEqual(j.filter,O))x.push(Object.assign(Object.assign({},w),{id:j.id}));else{this.unsubscribe(),this.state=Vn.errored,t==null||t(bo.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(bo.SUBSCRIBED);return}}).receive("error",u=>{this.state=Vn.errored,t==null||t(bo.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(bo.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Vn.joined&&t===Lh.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var i;if(r==null)return Promise.reject("Payload is required for httpSend()");const s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(o.status===202)return{success:!0};let a=o.statusText;try{const c=await o.json();a=c.error||c.message||a}catch{}return Promise.reject(new Error(a))}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:l}=t,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:l,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var l,o,a;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((a=(o=(l=this.params)===null||l===void 0?void 0:l.config)===null||o===void 0?void 0:o.broadcast)===null||a===void 0)&&a.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Vn.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(pa.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new k1(this,pa.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Vn.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),l}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new k1(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>VO){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,s;const l=t.toLocaleLowerCase(),{close:o,error:a,leave:c,join:f}=pa;if(n&&[o,a,c,f].indexOf(l)>=0&&n!==this._joinRef())return;let d=this._onMessage(l,r,n);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(u=>{var p,m,g;return((p=u.filter)===null||p===void 0?void 0:p.event)==="*"||((g=(m=u.filter)===null||m===void 0?void 0:m.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===l}).map(u=>u.callback(d,n)):(s=this.bindings[l])===null||s===void 0||s.filter(u=>{var p,m,g,x,y,w;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in u){const b=u.id,S=(p=u.filter)===null||p===void 0?void 0:p.event;return b&&((m=r.ids)===null||m===void 0?void 0:m.includes(b))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const b=(y=(x=u==null?void 0:u.filter)===null||x===void 0?void 0:x.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return b==="*"||b===((w=r==null?void 0:r.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return u.type.toLocaleLowerCase()===l}).map(u=>{if(typeof d=="object"&&"ids"in d){const p=d.data,{schema:m,table:g,commit_timestamp:x,type:y,errors:w}=p;d=Object.assign(Object.assign({},{schema:m,table:g,commit_timestamp:x,eventType:y,new:{},old:{},errors:w}),this._getPayloadRecords(p))}u.callback(d,n)})}_isClosed(){return this.state===Vn.closed}_isJoined(){return this.state===Vn.joined}_isJoining(){return this.state===Vn.joining}_isLeaving(){return this.state===Vn.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Hu.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(pa.close,{},t)}_onError(t){this._on(pa.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Vn.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Vb(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Vb(t.columns,t.old_record)),r}}const S1=()=>{},Y0={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},ej=[1e3,2e3,5e3,1e4],tj=1e4,rj=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class nj{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=dv,this.transport=null,this.heartbeatIntervalMs=Y0.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=S1,this.ref=0,this.reconnectTimer=null,this.vsn=qb,this.logger=S1,this.conn=null,this.sendBuffer=[],this.serializer=new GO,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=i=>i?(...s)=>i(...s):(...s)=>fetch(...s),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${pv.websocket}`,this.httpEndpoint=l3(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=zO.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case dl.connecting:return dc.Connecting;case dl.open:return dc.Open;case dl.closing:return dc.Closing;default:return dc.Closed}}isConnected(){return this.connectionState()===dc.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new Hu(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:i,ref:s}=t,l=()=>{this.encode(t,o=>{var a;(a=this.conn)===null||a===void 0||a.send(o)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(qO,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Y0.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const c=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",c)}catch(f){this.log("error","error in heartbeat callback",f)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:i,payload:s,ref:l}=r,o=l?`(${l})`:"",a=s.status||"";this.log("receive",`${a} ${n} ${i} ${o}`.trim(),s),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(i,s,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===dl.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===dl.open||this.conn.readyState===dl.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t);try{this.heartbeatCallback("error")}catch(r){this.log("error","error in heartbeat callback",r)}}_triggerChanError(){this.channels.forEach(t=>t._trigger(pa.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([rj],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(i=>{const s={access_token:r,version:HO};r&&i.updateJoinPayload(s),i.joinedOnce&&i._isJoined()&&i._push(pa.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new a3(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Y0.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,s,l,o,a,c,f,h,d,u;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:dv,this.heartbeatIntervalMs=(i=t==null?void 0:t.heartbeatIntervalMs)!==null&&i!==void 0?i:Y0.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(l=t==null?void 0:t.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:S1,this.vsn=(a=t==null?void 0:t.vsn)!==null&&a!==void 0?a:qb,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:p=>ej[p-1]||tj,this.vsn){case $O:this.encode=(f=t==null?void 0:t.encode)!==null&&f!==void 0?f:(p,m)=>m(JSON.stringify(p)),this.decode=(h=t==null?void 0:t.decode)!==null&&h!==void 0?h:(p,m)=>m(JSON.parse(p));break;case s3:this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:this.serializer.encode.bind(this.serializer),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var md=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function ij(e,t,r){const n=new URL(t,e);if(r)for(const[i,s]of Object.entries(r))s!==void 0&&n.searchParams.set(i,s);return n.toString()}async function sj(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function aj(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:i,body:s,headers:l}){const o=ij(e.baseUrl,n,i),a=await sj(e.auth),c=await t(o,{method:r,headers:{...s?{"Content-Type":"application/json"}:{},...a,...l},body:s?JSON.stringify(s):void 0}),f=await c.text(),h=(c.headers.get("content-type")||"").includes("application/json"),d=h&&f?JSON.parse(f):f;if(!c.ok){const u=h?d:void 0,p=u==null?void 0:u.error;throw new md((p==null?void 0:p.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:p==null?void 0:p.type,icebergCode:p==null?void 0:p.code,details:u})}return{status:c.status,headers:c.headers,data:d}}}}function K0(e){return e.join("")}var oj=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:K0(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${K0(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${K0(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${K0(e.namespace)}`}),!0}catch(t){if(t instanceof md&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof md&&r.status===409)return;throw r}}};function hu(e){return e.join("")}var lj=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${hu(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${hu(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${hu(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${hu(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${hu(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${hu(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof md&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof md&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},cj=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=aj({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new oj(this.client,t),this.tableOps=new lj(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},em=class extends Error{constructor(e,t="storage",r,n){super(e),this.__isStorageError=!0,this.namespace=t,this.name=t==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=n}};function tm(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var J0=class extends em{constructor(e,t,r,n="storage"){super(e,n,t,r),this.name=n==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},c3=class extends em{constructor(e,t,r="storage"){super(e,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const uj=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),fj=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},mv=e=>{if(Array.isArray(e))return e.map(r=>mv(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=mv(n)}),t},hj=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function xd(e){"@babel/helpers - typeof";return xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xd(e)}function dj(e,t){if(xd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(xd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pj(e){var t=dj(e,"string");return xd(t)=="symbol"?t:t+""}function gj(e,t,r){return(t=pj(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Wt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yb(Object(r),!0).forEach(function(n){gj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const Kb=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},mj=async(e,t,r,n)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const i=e,s=i.status||500;if(typeof i.json=="function")i.json().then(l=>{const o=(l==null?void 0:l.statusCode)||(l==null?void 0:l.code)||s+"";t(new J0(Kb(l),s,o,n))}).catch(()=>{if(n==="vectors"){const l=s+"";t(new J0(i.statusText||`HTTP ${s} error`,s,l,n))}else{const l=s+"";t(new J0(i.statusText||`HTTP ${s} error`,s,l,n))}});else{const l=s+"";t(new J0(i.statusText||`HTTP ${s} error`,s,l,n))}}else t(new c3(Kb(e),e,n))},xj=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||e==="HEAD"||!n?Wt(Wt({},i),r):(fj(n)?(i.headers=Wt({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,t!=null&&t.duplex&&(i.duplex=t.duplex),Wt(Wt({},i),r))};async function hh(e,t,r,n,i,s,l){return new Promise((o,a)=>{e(r,xj(t,n,i,s)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;if(l==="vectors"){const f=c.headers.get("content-type");if(!f||!f.includes("application/json"))return{}}return c.json()}).then(c=>o(c)).catch(c=>mj(c,a,n,l))})}function vj(e="storage"){return{get:async(t,r,n,i)=>hh(t,"GET",r,n,i,void 0,e),post:async(t,r,n,i,s)=>hh(t,"POST",r,i,s,n,e),put:async(t,r,n,i,s)=>hh(t,"PUT",r,i,s,n,e),head:async(t,r,n,i)=>hh(t,"HEAD",r,Wt(Wt({},n),{},{noResolveJson:!0}),i,void 0,e),remove:async(t,r,n,i,s)=>hh(t,"DELETE",r,i,s,n,e)}}const yj=vj("storage"),{get:vd,post:Yr,put:xv,head:wj,remove:Y2}=yj;var Tf=class{constructor(e,t={},r,n="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=uj(r),this.namespace=n}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){var t=this;try{return{data:await e(),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(tm(r))return{data:null,error:r};throw r}}},bj=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(tm(t))return{data:null,error:t};throw t}}};let u3;u3=Symbol.toStringTag;var _j=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[u3]="BlobDownloadBuilder",this.promise=null}asStream(){return new bj(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(tm(t))return{data:null,error:t};throw t}}};const kj={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Jb={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Sj=class extends Tf{constructor(e,t={},r,n){super(e,t,n,"storage"),this.bucketId=r}async uploadOrUpdate(e,t,r,n){var i=this;return i.handleOperation(async()=>{let s;const l=Wt(Wt({},Jb),n);let o=Wt(Wt({},i.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const a=l.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",l.cacheControl),a&&s.append("metadata",i.encodeMetadata(a)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.has("cacheControl")||s.append("cacheControl",l.cacheControl),a&&!s.has("metadata")&&s.append("metadata",i.encodeMetadata(a))):(s=r,o["cache-control"]=`max-age=${l.cacheControl}`,o["content-type"]=l.contentType,a&&(o["x-metadata"]=i.toBase64(i.encodeMetadata(a))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!l.duplex&&(l.duplex="half")),n!=null&&n.headers&&(o=Wt(Wt({},o),n.headers));const c=i._removeEmptyFolders(t),f=i._getFinalPath(c),h=await(e=="PUT"?xv:Yr)(i.fetch,`${i.url}/object/${f}`,s,Wt({headers:o},l!=null&&l.duplex?{duplex:l.duplex}:{}));return{path:c,id:h.Id,fullPath:h.Key}})}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var i=this;const s=i._removeEmptyFolders(e),l=i._getFinalPath(s),o=new URL(i.url+`/object/upload/sign/${l}`);return o.searchParams.set("token",t),i.handleOperation(async()=>{let a;const c=Wt({upsert:Jb.upsert},n),f=Wt(Wt({},i.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",c.cacheControl),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.append("cacheControl",c.cacheControl)):(a=r,f["cache-control"]=`max-age=${c.cacheControl}`,f["content-type"]=c.contentType),{path:s,fullPath:(await xv(i.fetch,o.toString(),a,{headers:f})).Key}})}async createSignedUploadUrl(e,t){var r=this;return r.handleOperation(async()=>{let n=r._getFinalPath(e);const i=Wt({},r.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const s=await Yr(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:i}),l=new URL(r.url+s.url),o=l.searchParams.get("token");if(!o)throw new em("No token returned by API");return{signedUrl:l.toString(),path:e,token:o}})}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;return n.handleOperation(async()=>await Yr(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}))}async copy(e,t,r){var n=this;return n.handleOperation(async()=>({path:(await Yr(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key}))}async createSignedUrl(e,t,r){var n=this;return n.handleOperation(async()=>{let i=n._getFinalPath(e),s=await Yr(n.fetch,`${n.url}/object/sign/${i}`,Wt({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${n.url}${s.signedURL}${l}`)}})}async createSignedUrls(e,t,r){var n=this;return n.handleOperation(async()=>{const i=await Yr(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i.map(l=>Wt(Wt({},l),{},{signedUrl:l.signedURL?encodeURI(`${n.url}${l.signedURL}${s}`):null}))})}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=n?`?${n}`:"",s=this._getFinalPath(e),l=()=>vd(this.fetch,`${this.url}/${r}/${s}${i}`,{headers:this.headers,noResolveJson:!0});return new _j(l,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);return t.handleOperation(async()=>mv(await vd(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})))}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await wj(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(tm(n)&&n instanceof c3){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const s=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&n.push(l);let o=n.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${r}${o}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await Y2(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,r){var n=this;return n.handleOperation(async()=>{const i=Wt(Wt(Wt({},kj),t),{},{prefix:e||""});return await Yr(n.fetch,`${n.url}/object/list/${n.bucketId}`,i,{headers:n.headers},r)})}async listV2(e,t){var r=this;return r.handleOperation(async()=>{const n=Wt({},e);return await Yr(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const Cj="2.93.1",qd={"X-Client-Info":`storage-js/${Cj}`};var Ej=class extends Tf{constructor(e,t={},r,n){const i=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase."));const s=i.href.replace(/\/$/,""),l=Wt(Wt({},qd),t);super(s,l,r,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=t.listBucketOptionsToQueryString(e);return await vd(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await vd(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var r=this;return r.handleOperation(async()=>await Yr(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async updateBucket(e,t){var r=this;return r.handleOperation(async()=>await xv(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await Yr(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await Y2(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},Tj=class extends Tf{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=Wt(Wt({},qd),t);super(n,i,r,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await Yr(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),i=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return await vd(t.fetch,i,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await Y2(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!hj(e))throw new em("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new cj({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(i,s){const l=i[s];return typeof l!="function"?l:async(...o)=>{try{return{data:await l.apply(i,o),error:null}}catch(a){if(n)throw a;return{data:null,error:a}}}}})}},Nj=class extends Tf{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=Wt(Wt({},qd),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await Yr(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var r=this;return r.handleOperation(async()=>await Yr(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await Yr(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var r=this;return r.handleOperation(async()=>await Yr(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{})}},Aj=class extends Tf{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=Wt(Wt({},qd),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await Yr(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await Yr(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return t.handleOperation(async()=>await Yr(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await Yr(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await Yr(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},Oj=class extends Tf{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=Wt(Wt({},qd),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await Yr(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await Yr(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await Yr(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await Yr(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},jj=class extends Oj{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new Pj(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},Pj=class extends Nj{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new Fj(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},Fj=class extends Aj{constructor(e,t,r,n,i){super(e,t,i),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},Dj=class extends Ej{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new Sj(this.url,this.headers,e,this.fetch)}get vectors(){return new jj(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Tj(this.url+"/iceberg",this.headers,this.fetch)}};const f3="2.93.1",Eu=30*1e3,vv=3,C1=vv*Eu,Lj="http://localhost:9999",Ij="supabase.auth.token",Mj={"X-Client-Info":`gotrue-js/${f3}`},yv="X-Supabase-Api-Version",h3={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Rj=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Bj=10*60*1e3;class yd extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Dt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Uj extends yd{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function zj(e){return Dt(e)&&e.name==="AuthApiError"}class pc extends yd{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Uo extends yd{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class ms extends Uo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function E1(e){return Dt(e)&&e.name==="AuthSessionMissingError"}class du extends Uo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Q0 extends Uo{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Z0 extends Uo{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Wj(e){return Dt(e)&&e.name==="AuthImplicitGrantRedirectError"}class Qb extends Uo{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Hj extends Uo{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class wv extends Uo{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function T1(e){return Dt(e)&&e.name==="AuthRetryableFetchError"}class Zb extends Uo{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class bv extends Uo{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const gg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),e_=` 	
\r=`.split(""),$j=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<e_.length;t+=1)e[e_[t].charCodeAt(0)]=-2;for(let t=0;t<gg.length;t+=1)e[gg[t].charCodeAt(0)]=t;return e})();function t_(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(gg[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(gg[n]),t.queuedBits-=6}}function d3(e,t,r){const n=$j[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function r_(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=l=>{Gj(l,n,r)};for(let l=0;l<e.length;l+=1)d3(e.charCodeAt(l),i,s);return t.join("")}function qj(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Vj(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}qj(n,t)}}function Gj(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Qu(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)d3(e.charCodeAt(i),r,n);return new Uint8Array(t)}function Xj(e){const t=[];return Vj(e,r=>t.push(r)),new Uint8Array(t)}function wc(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>t_(i,r,n)),t_(null,r,n),t.join("")}function Yj(e){return Math.round(Date.now()/1e3)+e}function Kj(){return Symbol("auth-callback")}const fi=()=>typeof window<"u"&&typeof document<"u",ac={tested:!1,writable:!1},p3=()=>{if(!fi())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ac.tested)return ac.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ac.tested=!0,ac.writable=!0}catch{ac.tested=!0,ac.writable=!1}return ac.writable};function Jj(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const g3=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Qj=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Tu=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},oc=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ui=async(e,t)=>{await e.removeItem(t)};class rm{constructor(){this.promise=new rm.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}rm.promiseConstructor=Promise;function ep(e){const t=e.split(".");if(t.length!==3)throw new bv("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Rj.test(t[n]))throw new bv("JWT not in base64url format");return{header:JSON.parse(r_(t[0])),payload:JSON.parse(r_(t[1])),signature:Qu(t[2]),raw:{header:t[0],payload:t[1]}}}async function Zj(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function eP(e,t){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const l=await e(s);if(!t(s,null,l)){n(l);return}}catch(l){if(!t(s,l)){i(l);return}}})()})}function tP(e){return("0"+e.toString(16)).substr(-2)}function rP(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,tP).join("")}async function nP(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function iP(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await nP(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function pu(e,t,r=!1){const n=rP();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Tu(e,`${t}-code-verifier`,i);const s=await iP(n);return[s,n===s?"plain":"s256"]}const sP=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function aP(e){const t=e.headers.get(yv);if(!t||!t.match(sP))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function oP(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function lP(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const cP=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function gu(e){if(!cP.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function N1(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function uP(e,t){return new Proxy(e,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,i)}})}function n_(e){return JSON.parse(JSON.stringify(e))}const uc=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),fP=[502,503,504];async function i_(e){var t;if(!Qj(e))throw new wv(uc(e),0);if(fP.includes(e.status))throw new wv(uc(e),e.status);let r;try{r=await e.json()}catch(s){throw new pc(uc(s),s)}let n;const i=aP(e);if(i&&i.getTime()>=h3["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Zb(uc(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new ms}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0))throw new Zb(uc(r),e.status,r.weak_password.reasons);throw new Uj(uc(r),e.status||500,n)}const hP=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function Ut(e,t,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[yv]||(s[yv]=h3["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const l=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(l.redirect_to=n.redirectTo);const o=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",a=await dP(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(a):{data:Object.assign({},a),error:null}}async function dP(e,t,r,n,i,s){const l=hP(t,n,i,s);let o;try{o=await e(r,Object.assign({},l))}catch(a){throw console.error(a),new wv(uc(a),0)}if(o.ok||await i_(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(a){await i_(a)}}function fa(e){var t;let r=null;mP(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Yj(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function s_(e){const t=fa(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function ml(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function pP(e){return{data:e,error:null}}function gP(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,l=Zg(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},a=Object.assign({},l);return{data:{properties:o,user:a},error:null}}function a_(e){return e}function mP(e){return e.access_token&&e.refresh_token&&e.expires_in}const A1=["global","local","others"];class xP{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=g3(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=A1[0]){if(A1.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${A1.join(", ")}`);try{return await Ut(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Dt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ut(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ml})}catch(n){if(Dt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Zg(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await Ut(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:gP,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Dt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ut(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:ml})}catch(r){if(Dt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,s,l,o,a;try{const c={nextPage:null,lastPage:0,total:0},f=await Ut(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:a_});if(f.error)throw f.error;const h=await f.json(),d=(l=f.headers.get("x-total-count"))!==null&&l!==void 0?l:0,u=(a=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&a!==void 0?a:[];return u.length>0&&(u.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(p.split(";")[1].split("=")[1]);c[`${g}Page`]=m}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(Dt(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){gu(t);try{return await Ut(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:ml})}catch(r){if(Dt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){gu(t);try{return await Ut(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:ml})}catch(n){if(Dt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){gu(t);try{return await Ut(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:ml})}catch(n){if(Dt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){gu(t.userId);try{const{data:r,error:n}=await Ut(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(Dt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){gu(t.userId),gu(t.id);try{return{data:await Ut(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Dt(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,i,s,l,o,a;try{const c={nextPage:null,lastPage:0,total:0},f=await Ut(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:a_});if(f.error)throw f.error;const h=await f.json(),d=(l=f.headers.get("x-total-count"))!==null&&l!==void 0?l:0,u=(a=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&a!==void 0?a:[];return u.length>0&&(u.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(p.split(";")[1].split("=")[1]);c[`${g}Page`]=m}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(Dt(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(t){try{return await Ut(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Dt(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Ut(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Dt(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Ut(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Dt(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Ut(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Dt(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Ut(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Dt(r))return{data:null,error:r};throw r}}}function o_(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const mu={debug:!!(globalThis&&p3()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class m3 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class vP extends m3{}async function yP(e,t,r){mu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),mu.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){mu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{mu.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw mu.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new vP(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(mu.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function wP(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function x3(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function bP(e){return parseInt(e,16)}function _P(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function kP(e){var t;const{chainId:r,domain:n,expirationTime:i,issuedAt:s=new Date,nonce:l,notBefore:o,requestId:a,resources:c,scheme:f,uri:h,version:d}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(d!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${d}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const u=x3(e.address),p=f?`${f}://${n}`:n,m=e.statement?`${e.statement}
`:"",g=`${p} wants you to sign in with your Ethereum account:
${u}

${m}`;let x=`URI: ${h}
Version: ${d}
Chain ID: ${r}${l?`
Nonce: ${l}`:""}
Issued At: ${s.toISOString()}`;if(i&&(x+=`
Expiration Time: ${i.toISOString()}`),o&&(x+=`
Not Before: ${o.toISOString()}`),a&&(x+=`
Request ID: ${a}`),c){let y=`
Resources:`;for(const w of c){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);y+=`
- ${w}`}x+=y}return`${g}
${x}`}class Mn extends Error{constructor({message:t,code:r,cause:n,name:i}){var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=i??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class mg extends Mn{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function SP({error:e,options:t}){var r,n,i;const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Mn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Mn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Mn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=s.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Mn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Mn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Mn({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new Mn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Mn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const l=window.location.hostname;if(v3(l)){if(s.rp.id!==l)return new Mn({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Mn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new Mn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Mn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Mn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function CP({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Mn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Mn({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(v3(n)){if(r.rpId!==n)return new Mn({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Mn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Mn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Mn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class EP{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const TP=new EP;function NP(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,i=Zg(e,["challenge","user","excludeCredentials"]),s=Qu(t).buffer,l=Object.assign(Object.assign({},r),{id:Qu(r.id).buffer}),o=Object.assign(Object.assign({},i),{challenge:s,user:l});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let a=0;a<n.length;a++){const c=n[a];o.excludeCredentials[a]=Object.assign(Object.assign({},c),{id:Qu(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function AP(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Zg(e,["challenge","allowCredentials"]),i=Qu(t).buffer,s=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const o=r[l];s.allowCredentials[l]=Object.assign(Object.assign({},o),{id:Qu(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return s}function OP(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:wc(new Uint8Array(e.response.attestationObject)),clientDataJSON:wc(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function jP(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:wc(new Uint8Array(i.authenticatorData)),clientDataJSON:wc(new Uint8Array(i.clientDataJSON)),signature:wc(new Uint8Array(i.signature)),userHandle:i.userHandle?wc(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function v3(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function l_(){var e,t;return!!(fi()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function PP(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new mg("Browser returned unexpected credential type",t)}:{data:null,error:new mg("Empty credential response",t)}}catch(t){return{data:null,error:SP({error:t,options:e})}}}async function FP(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new mg("Browser returned unexpected credential type",t)}:{data:null,error:new mg("Empty credential response",t)}}catch(t){return{data:null,error:CP({error:t,options:e})}}}const DP={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},LP={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function xg(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of e)if(i)for(const s in i){const l=i[s];if(l!==void 0)if(Array.isArray(l))n[s]=l;else if(r(l))n[s]=l;else if(t(l)){const o=n[s];t(o)?n[s]=xg(o,l):n[s]=xg(l)}else n[s]=l}return n}function IP(e,t){return xg(DP,e,t||{})}function MP(e,t){return xg(LP,e,t||{})}class RP{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:i},s){try{const{data:l,error:o}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!l)return{data:null,error:o};const a=i??TP.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:c}=l.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${n}`),c.displayName||(c.displayName=c.name)}switch(l.webauthn.type){case"create":{const c=IP(l.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:f,error:h}=await PP({publicKey:c,signal:a});return f?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:f}},error:null}:{data:null,error:h}}case"request":{const c=MP(l.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:f,error:h}=await FP(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:c,signal:a}));return f?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:f}},error:null}:{data:null,error:h}}}}catch(l){return Dt(l)?{data:null,error:l}:{data:null,error:new pc("Unexpected error in challenge",l)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new yd("rpId is required for WebAuthn authentication")};try{if(!l_())return{data:null,error:new pc("Browser does not support WebAuthn",null)};const{data:l,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:s});if(!l)return{data:null,error:o};const{webauthn:a}=l;return this._verify({factorId:t,challengeId:l.challengeId,webauthn:{type:a.type,rpId:r,rpOrigins:n,credential_response:a.credential_response}})}catch(l){return Dt(l)?{data:null,error:l}:{data:null,error:new pc("Unexpected error in authenticate",l)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new yd("rpId is required for WebAuthn registration")};try{if(!l_())return{data:null,error:new pc("Browser does not support WebAuthn",null)};const{data:l,error:o}=await this._enroll({friendlyName:t});if(!l)return await this.client.mfa.listFactors().then(f=>{var h;return(h=f.data)===null||h===void 0?void 0:h.all.find(d=>d.factor_type==="webauthn"&&d.friendly_name===t&&d.status!=="unverified")}).then(f=>f?this.client.mfa.unenroll({factorId:f==null?void 0:f.id}):void 0),{data:null,error:o};const{data:a,error:c}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:s});return a?this._verify({factorId:l.id,challengeId:a.challengeId,webauthn:{rpId:r,rpOrigins:n,type:a.webauthn.type,credential_response:a.webauthn.credential_response}}):{data:null,error:c}}catch(l){return Dt(l)?{data:null,error:l}:{data:null,error:new pc("Unexpected error in register",l)}}}}wP();const BP={url:Lj,storageKey:Ij,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Mj,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function c_(e,t,r){return await r()}const xu={};class wd{get jwks(){var t,r;return(r=(t=xu[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){xu[this.storageKey]=Object.assign(Object.assign({},xu[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=xu[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){xu[this.storageKey]=Object.assign(Object.assign({},xu[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},BP),t);if(this.storageKey=s.storageKey,this.instanceID=(r=wd.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,wd.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&fi()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new xP({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=g3(s.fetch),this.lock=s.lock||c_,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,this.lockAcquireTimeout=s.lockAcquireTimeout,s.lock?this.lock=s.lock:this.persistSession&&fi()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=yP:this.lock=c_,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new RP(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:p3()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=o_(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=o_(this.memoryStorage)),fi()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l);try{await this._notifyAllSubscribers(l.data.event,l.data.session,!1)}catch(o){this._debug("#broadcastChannel","error",o)}})}this.initialize().catch(l=>{this._debug("#initialize()","error",l)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${f3}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(fi()&&(r=Jj(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),fi()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),Wj(s)){const a=(t=s.details)===null||t===void 0?void 0:t.code;if(a==="identity_already_exists"||a==="identity_not_found"||a==="single_identity_not_deletable")return{error:s}}return{error:s}}const{session:l,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",l,"redirect type",o),await this._saveSession(l),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Dt(r)?this._returnResult({error:r}):this._returnResult({error:new pc("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const s=await Ut(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:fa}),{data:l,error:o}=s;if(o||!l)return this._returnResult({data:{user:null,session:null},error:o});const a=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",a)),this._returnResult({data:{user:c,session:a},error:null})}catch(s){if(Dt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(t){var r,n,i;try{let s;if("email"in t){const{email:f,password:h,options:d}=t;let u=null,p=null;this.flowType==="pkce"&&([u,p]=await pu(this.storage,this.storageKey)),s=await Ut(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:f,password:h,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:u,code_challenge_method:p},xform:fa})}else if("phone"in t){const{phone:f,password:h,options:d}=t;s=await Ut(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:h,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},channel:(i=d==null?void 0:d.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:fa})}else throw new Q0("You must provide either an email or phone number and a password");const{data:l,error:o}=s;if(o||!l)return await ui(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const a=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",a)),this._returnResult({data:{user:c,session:a},error:null})}catch(s){if(await ui(this.storage,`${this.storageKey}-code-verifier`),Dt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:l,options:o}=t;r=await Ut(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:s_})}else if("phone"in t){const{phone:s,password:l,options:o}=t;r=await Ut(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:s_})}else throw new Q0("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const s=new du;return this._returnResult({data:{user:null,session:null},error:s})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(Dt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,i,s,l,o,a,c,f,h,d;let u,p;if("message"in t)u=t.message,p=t.signature;else{const{chain:m,wallet:g,statement:x,options:y}=t;let w;if(fi())if(typeof g=="object")w=g;else{const L=window;if("ethereum"in L&&typeof L.ethereum=="object"&&"request"in L.ethereum&&typeof L.ethereum.request=="function")w=L.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=g}const b=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href),S=await w.request({method:"eth_requestAccounts"}).then(L=>L).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!S||S.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const T=x3(S[0]);let O=(n=y==null?void 0:y.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!O){const L=await w.request({method:"eth_chainId"});O=bP(L)}const j={domain:b.host,address:T,statement:x,uri:b.href,version:"1",chainId:O,nonce:(i=y==null?void 0:y.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(l=(s=y==null?void 0:y.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(o=y==null?void 0:y.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(a=y==null?void 0:y.signInWithEthereum)===null||a===void 0?void 0:a.notBefore,requestId:(c=y==null?void 0:y.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(f=y==null?void 0:y.signInWithEthereum)===null||f===void 0?void 0:f.resources};u=kP(j),p=await w.request({method:"personal_sign",params:[_P(u),T]})}try{const{data:m,error:g}=await Ut(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:u,signature:p},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(d=t.options)===null||d===void 0?void 0:d.captchaToken}}:null),xform:fa});if(g)throw g;if(!m||!m.session||!m.user){const x=new du;return this._returnResult({data:{user:null,session:null},error:x})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:g})}catch(m){if(Dt(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(t){var r,n,i,s,l,o,a,c,f,h,d,u;let p,m;if("message"in t)p=t.message,m=t.signature;else{const{chain:g,wallet:x,statement:y,options:w}=t;let b;if(fi())if(typeof x=="object")b=x;else{const T=window;if("solana"in T&&typeof T.solana=="object"&&("signIn"in T.solana&&typeof T.solana.signIn=="function"||"signMessage"in T.solana&&typeof T.solana.signMessage=="function"))b=T.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=x}const S=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in b&&b.signIn){const T=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),y?{statement:y}:null));let O;if(Array.isArray(T)&&T[0]&&typeof T[0]=="object")O=T[0];else if(T&&typeof T=="object"&&"signedMessage"in T&&"signature"in T)O=T;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in O&&"signature"in O&&(typeof O.signedMessage=="string"||O.signedMessage instanceof Uint8Array)&&O.signature instanceof Uint8Array)p=typeof O.signedMessage=="string"?O.signedMessage:new TextDecoder().decode(O.signedMessage),m=O.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${S.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(i=(n=w==null?void 0:w.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=w==null?void 0:w.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((h=(f=w==null?void 0:w.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||h===void 0)&&h.length?["Resources",...w.signInWithSolana.resources.map(O=>`- ${O}`)]:[]].join(`
`);const T=await b.signMessage(new TextEncoder().encode(p),"utf8");if(!T||!(T instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=T}}try{const{data:g,error:x}=await Ut(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:wc(m)},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(u=t.options)===null||u===void 0?void 0:u.captchaToken}}:null),xform:fa});if(x)throw x;if(!g||!g.session||!g.user){const y=new du;return this._returnResult({data:{user:null,session:null},error:y})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:x})}catch(g){if(Dt(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(t){const r=await oc(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new Hj;const{data:s,error:l}=await Ut(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:fa});if(await ui(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!s||!s.session||!s.user){const o=new du;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:l})}catch(s){if(await ui(this.storage,`${this.storageKey}-code-verifier`),Dt(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:s,nonce:l}=t,o=await Ut(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:l,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:fa}),{data:a,error:c}=o;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!a||!a.session||!a.user){const f=new du;return this._returnResult({data:{user:null,session:null},error:f})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:a,error:c})}catch(r){if(Dt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,i,s,l;try{if("email"in t){const{email:o,options:a}=t;let c=null,f=null;this.flowType==="pkce"&&([c,f]=await pu(this.storage,this.storageKey));const{error:h}=await Ut(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=a==null?void 0:a.data)!==null&&r!==void 0?r:{},create_user:(n=a==null?void 0:a.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},code_challenge:c,code_challenge_method:f},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in t){const{phone:o,options:a}=t,{data:c,error:f}=await Ut(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=a==null?void 0:a.data)!==null&&i!==void 0?i:{},create_user:(s=a==null?void 0:a.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},channel:(l=a==null?void 0:a.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:f})}throw new Q0("You must provide either an email or phone number.")}catch(o){if(await ui(this.storage,`${this.storageKey}-code-verifier`),Dt(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var r,n;try{let i,s;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:o}=await Ut(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:fa});if(o)throw o;if(!l)throw new Error("An error occurred on token verification.");const a=l.session,c=l.user;return a!=null&&a.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",a)),this._returnResult({data:{user:c,session:a},error:null})}catch(i){if(Dt(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,n,i,s,l;try{let o=null,a=null;this.flowType==="pkce"&&([o,a]=await pu(this.storage,this.storageKey));const c=await Ut(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:a}),headers:this.headers,xform:pP});return!((s=c.data)===null||s===void 0)&&s.url&&fi()&&!(!((l=t.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(o){if(await ui(this.storage,`${this.storageKey}-code-verifier`),Dt(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new ms;const{error:i}=await Ut(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(Dt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:s}=t,{error:l}=await Ut(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in t){const{phone:n,type:i,options:s}=t,{data:l,error:o}=await Ut(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:o})}throw new Q0("You must provide either an email or phone number and a type")}catch(r){if(Dt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await oc(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<C1:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const l=await oc(this.userStorage,this.storageKey+"-user");l!=null&&l.user?t.user=l.user:t.user=N1()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};t.user=uP(t.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Ut(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:ml}):await this._useSession(async r=>{var n,i,s;const{data:l,error:o}=r;if(o)throw o;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ms}:await Ut(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:ml})})}catch(r){if(Dt(r))return E1(r)&&(await this._removeSession(),await ui(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new ms;const l=i.session;let o=null,a=null;this.flowType==="pkce"&&t.email!=null&&([o,a]=await pu(this.storage,this.storageKey));const{data:c,error:f}=await Ut(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:a}),jwt:l.access_token,xform:ml});if(f)throw f;return l.user=c.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(n){if(await ui(this.storage,`${this.storageKey}-code-verifier`),Dt(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ms;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:l}=ep(t.access_token);if(l.exp&&(n=l.exp,i=n<=r),i){const{data:o,error:a}=await this._callRefreshToken(t.refresh_token);if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:a}=await this._getUser(t.access_token);if(a)return this._returnResult({data:{user:null,session:null},error:a});s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(Dt(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:l,error:o}=r;if(o)throw o;t=(n=l.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new ms;const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Dt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!fi())throw new Z0("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Z0(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Qb("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Z0("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Qb("No code detected.");const{data:y,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:l,expires_in:o,expires_at:a,token_type:c}=t;if(!s||!o||!l||!c)throw new Z0("No session defined in URL");const f=Math.round(Date.now()/1e3),h=parseInt(o);let d=f+h;a&&(d=parseInt(a));const u=d-f;u*1e3<=Eu&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${u}s, should have been closer to ${h}s`);const p=d-h;f-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,f):f-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,d,f);const{data:m,error:g}=await this._getUser(s);if(g)throw g;const x={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:h,expires_at:d,refresh_token:l,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:t.type},error:null})}catch(n){if(Dt(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await oc(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s&&!E1(s))return this._returnResult({error:s});const l=(n=i.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:o}=await this.admin.signOut(l,t);if(o&&!(zj(o)&&(o.status===404||o.status===401||o.status===403)||E1(o)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await ui(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=Kj(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:l}=r;if(l)throw l;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await pu(this.storage,this.storageKey,!0));try{return await Ut(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(await ui(this.storage,`${this.storageKey}-code-verifier`),Dt(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Dt(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var l,o,a,c,f;const{data:h,error:d}=s;if(d)throw d;const u=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:!0});return await Ut(this.fetch,"GET",u,{headers:this.headers,jwt:(f=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&f!==void 0?f:void 0})});if(i)throw i;return fi()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(Dt(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:s}}=r;if(i)throw i;const{options:l,provider:o,token:a,access_token:c,nonce:f}=t,h=await Ut(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s==null?void 0:s.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:a,access_token:c,nonce:f,link_identity:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:fa}),{data:d,error:u}=h;return u?this._returnResult({data:{user:null,session:null},error:u}):!d||!d.session||!d.user?this._returnResult({data:{user:null,session:null},error:new du}):(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("USER_UPDATED",d.session)),this._returnResult({data:d,error:u}))}catch(i){if(await ui(this.storage,`${this.storageKey}-code-verifier`),Dt(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:l}=r;if(l)throw l;return await Ut(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(Dt(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await eP(async i=>(i>0&&await Zj(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await Ut(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:fa})),(i,s)=>{const l=200*Math.pow(2,i);return s&&T1(s)&&Date.now()+l-n<Eu})}catch(n){if(this._debug(r,"error",n),Dt(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),fi()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await oc(this.storage,this.storageKey);if(i&&this.userStorage){let l=await oc(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:i.user},await Tu(this.userStorage,this.storageKey+"-user",l)),i.user=(t=l==null?void 0:l.user)!==null&&t!==void 0?t:N1()}else if(i&&!i.user&&!i.user){const l=await oc(this.storage,this.storageKey+"-user");l&&(l!=null&&l.user)?(i.user=l.user,await ui(this.storage,this.storageKey+"-user"),await Tu(this.storage,this.storageKey,i)):i.user=N1()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<C1;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${C1}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:l}=await this._callRefreshToken(i.refresh_token);l&&(console.error(l),T1(l)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:o}=await this._getUser(i.access_token);!o&&(l!=null&&l.user)?(i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(n,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new ms;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new rm;const{data:s,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!s.session)throw new ms;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={data:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),Dt(s)){const l={data:null,error:s};return T1(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],l=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(a){s.push(a)}});if(await Promise.all(l),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await ui(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Tu(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=n_(i);await Tu(this.storage,this.storageKey,s)}else{const i=n_(r);await Tu(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await ui(this.storage,this.storageKey),await ui(this.storage,this.storageKey+"-code-verifier"),await ui(this.storage,this.storageKey+"-user"),this.userStorage&&await ui(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&fi()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Eu);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/Eu);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Eu}ms, refresh threshold is ${vv} ticks`),i<=vv&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof m3)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!fi()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(t){this._debug("#visibilityChangedCallback","error",t)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,l]=await pu(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(l)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?this._returnResult({data:null,error:s}):await Ut(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Dt(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:l}=r;if(l)return this._returnResult({data:null,error:l});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:a,error:c}=await Ut(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(t.factorType==="totp"&&a.type==="totp"&&(!((i=a==null?void 0:a.totp)===null||i===void 0)&&i.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),this._returnResult({data:a,error:null}))})}catch(r){if(Dt(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const l=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?OP(t.webauthn.credential_response):jP(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:a}=await Ut(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return a?this._returnResult({data:null,error:a}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:a}))})}catch(r){if(Dt(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const l=await Ut(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(l.error)return l;const{data:o}=l;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:NP(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:AP(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Dt(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const s of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])i.all.push(s),s.status==="verified"&&i[s.factor_type].push(s);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(t){var r,n,i,s;if(t)try{const{payload:u}=ep(t);let p=null;u.aal&&(p=u.aal);let m=p;const{data:{user:g},error:x}=await this.getUser(t);if(x)return this._returnResult({data:null,error:x});((n=(r=g==null?void 0:g.factors)===null||r===void 0?void 0:r.filter(b=>b.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(m="aal2");const w=u.amr||[];return{data:{currentLevel:p,nextLevel:m,currentAuthenticationMethods:w},error:null}}catch(u){if(Dt(u))return this._returnResult({data:null,error:u});throw u}const{data:{session:l},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=ep(l.access_token);let c=null;a.aal&&(c=a.aal);let f=c;((s=(i=l.user.factors)===null||i===void 0?void 0:i.filter(u=>u.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(f="aal2");const d=a.amr||[];return{data:{currentLevel:c,nextLevel:f,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await Ut(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new ms})})}catch(r){if(Dt(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new ms});const l=await Ut(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return l.data&&l.data.redirect_url&&fi()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(Dt(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new ms});const l=await Ut(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return l.data&&l.data.redirect_url&&fi()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(Dt(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await Ut(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new ms})})}catch(t){if(Dt(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?(await Ut(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new ms})})}catch(r){if(Dt(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+Bj>i)return n;const{data:s,error:l}=await Ut(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:u,error:p}=await this.getSession();if(p||!u.session)return this._returnResult({data:null,error:p});n=u.session.access_token}const{header:i,payload:s,signature:l,raw:{header:o,payload:a}}=ep(n);r!=null&&r.allowExpired||oP(s.exp);const c=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:u}=await this.getUser(n);if(u)throw u;return{data:{claims:s,header:i,signature:l},error:null}}const f=lP(i.alg),h=await crypto.subtle.importKey("jwk",c,f,!0,["verify"]);if(!await crypto.subtle.verify(f,h,l,Xj(`${o}.${a}`)))throw new bv("Invalid JWT signature");return{data:{claims:s,header:i,signature:l},error:null}}catch(n){if(Dt(n))return this._returnResult({data:null,error:n});throw n}}}wd.nextInstanceID={};const UP=wd,zP="2.93.1";let bh="";typeof Deno<"u"?bh="deno":typeof document<"u"?bh="web":typeof navigator<"u"&&navigator.product==="ReactNative"?bh="react-native":bh="node";function WP(){const e=globalThis.process;if(e&&e.platform){const t=e.platform;if(t==="darwin")return"macOS";if(t==="win32")return"Windows";if(t==="linux")return"Linux";if(t==="android")return"Android"}if(typeof navigator<"u"&&navigator.userAgentData&&navigator.userAgentData.platform){const t=navigator.userAgentData.platform;if(t==="macOS")return"macOS";if(t==="Windows")return"Windows";if(t==="Linux")return"Linux";if(t==="Android")return"Android";if(t==="iOS")return"iOS"}return null}function HP(){const e=globalThis.process;if(e){const t=e.versions;if(t&&t.node&&typeof window>"u")try{const r=globalThis.require;if(r)return r("os").release()}catch{return null}}if(typeof Deno<"u"&&Deno.osRelease)try{return Deno.osRelease()}catch{return null}return typeof navigator<"u"&&navigator.userAgentData&&navigator.userAgentData.platformVersion?navigator.userAgentData.platformVersion:null}function $P(){if(typeof Deno<"u")return"deno";if(typeof Bun<"u")return"bun";const e=globalThis.process;if(e){const t=e.versions;if(t&&t.node)return"node"}return null}function qP(){if(typeof Deno<"u"&&Deno.version)return Deno.version.deno;if(typeof Bun<"u"&&Bun.version)return Bun.version;const e=globalThis.process;if(e){const t=e.versions;if(t&&t.node)return t.node}return null}function VP(){const e={"X-Client-Info":`supabase-js-${bh}/${zP}`},t=WP();t&&(e["X-Supabase-Client-Platform"]=t);const r=HP();r&&(e["X-Supabase-Client-Platform-Version"]=r);const n=$P();n&&(e["X-Supabase-Client-Runtime"]=n);const i=qP();return i&&(e["X-Supabase-Client-Runtime-Version"]=i),e}const GP=VP(),XP={headers:GP},YP={schema:"public"},KP={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},JP={};function bd(e){"@babel/helpers - typeof";return bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bd(e)}function QP(e,t){if(bd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(bd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZP(e){var t=QP(e,"string");return bd(t)=="symbol"?t:t+""}function eF(e,t,r){return(t=ZP(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u_(Object(r),!0).forEach(function(n){eF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const tF=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),rF=()=>Headers,nF=(e,t,r)=>{const n=tF(r),i=rF();return async(s,l)=>{var o;const a=(o=await t())!==null&&o!==void 0?o:e;let c=new i(l==null?void 0:l.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${a}`),n(s,cn(cn({},l),{},{headers:c}))}};function iF(e){return e.endsWith("/")?e:e+"/"}function sF(e,t){var r,n;const{db:i,auth:s,realtime:l,global:o}=e,{db:a,auth:c,realtime:f,global:h}=t,d={db:cn(cn({},a),i),auth:cn(cn({},c),s),realtime:cn(cn({},f),l),storage:{},global:cn(cn(cn({},h),o),{},{headers:cn(cn({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}function aF(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(iF(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var oF=class extends UP{constructor(e){super(e)}},lF=class{constructor(e,t,r){var n,i;this.supabaseUrl=e,this.supabaseKey=t;const s=aF(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",s),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",s),this.storageUrl=new URL("storage/v1",s),this.functionsUrl=new URL("functions/v1",s);const l=`sb-${s.hostname.split(".")[0]}-auth-token`,o={db:YP,realtime:JP,auth:cn(cn({},KP),{},{storageKey:l}),global:XP},a=sF(r??{},o);if(this.storageKey=(n=a.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=a.global.headers)!==null&&i!==void 0?i:{},a.accessToken)this.accessToken=a.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=a.auth)!==null&&c!==void 0?c:{},this.headers,a.global.fetch)}this.fetch=nF(t,this._getAccessToken.bind(this),a.global.fetch),this.realtime=this._initRealtimeClient(cn({headers:this.headers,accessToken:this._getAccessToken.bind(this)},a.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(f=>this.realtime.setAuth(f)).catch(f=>console.warn("Failed to set initial Realtime auth token:",f)),this.rest=new UO(new URL("rest/v1",s).href,{headers:this.headers,schema:a.db.schema,fetch:this.fetch}),this.storage=new Dj(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),a.accessToken||this._listenForAuthEvents()}get functions(){return new LO(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,storageKey:s,flowType:l,lock:o,debug:a,throwOnError:c},f,h){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new oF({url:this.authUrl.href,headers:cn(cn({},d),f),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,flowType:l,lock:o,debug:a,throwOnError:c,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(u=>u.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new nj(this.realtimeUrl.href,cn(cn({},e),{},{params:cn(cn({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const cF=(e,t,r)=>new lF(e,t,r);function uF(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}uF()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const fF="https://kglshjhuofkouiodmkgs.supabase.co",hF="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtnbHNoamh1b2Zrb3Vpb2Rta2dzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk0NDE3ODgsImV4cCI6MjA4NTAxNzc4OH0.kqoUY-stIdwOw3vtpowcbzV_AvjgGtzXN6i9bjQCW-Y",He=cF(fF,hF,{auth:{persistSession:!0,storage:window.sessionStorage}}),dF=()=>{var ye;const e=xe.useRef(null),t=xe.useRef(null),[r,n]=xe.useState(null),[i,s]=xe.useState(""),[l,o]=xe.useState(""),[a,c]=xe.useState("A"),[f,h]=xe.useState("#5E5CE6"),[d,u]=xe.useState("#E5E5EA"),[p,m]=xe.useState("#D1D1D6"),[g,x]=xe.useState("#8E8E93"),[y,w]=xe.useState(12),[b,S]=xe.useState([]),[T,O]=xe.useState(null),[j,L]=xe.useState(!1),[W,F]=xe.useState(null),[M,V]=xe.useState(null),[G,te]=xe.useState(null),[ee,Q]=xe.useState([]),[K,N]=xe.useState({paper:"a4",orientation:"portrait"}),[U,R]=xe.useState([]),k=de=>{var it,Ke;const Te=de||t.current;if(!Te)return;const pe=Te.getObjects();if(pe.length===0)return;let Ae=1/0,Ie=1/0,je=-1/0,Le=-1/0;pe.forEach(et=>{const Ge=et.getBoundingRect(!0);Ae=Math.min(Ae,Ge.left),Ie=Math.min(Ie,Ge.top),je=Math.max(je,Ge.left+Ge.width),Le=Math.max(Le,Ge.top+Ge.height)});const Xe=je-Ae,Je=Le-Ie,Ne=((it=e.current)==null?void 0:it.clientWidth)||Te.getWidth(),Oe=((Ke=e.current)==null?void 0:Ke.clientHeight)||Te.getHeight(),De=Ne/2-(Ae+Xe/2),Ye=Oe/2-(Ie+Je/2);Te.setViewportTransform([1,0,0,1,De,Ye]),Te.requestRenderAll()},P=()=>{const de=t.current;if(!de)return;const Te=de.getObjects().map(pe=>{const Ae=pe.data||{};return{id:Ae.id,seatNumber:Ae.seatNumber,displayNumber:Ae.displayNumber,zoneName:Ae.zoneName,zoneColor:Ae.zoneColor,pos_x:pe.left,pos_y:pe.top,width:pe.width,height:pe.height,label:Ae.label,type:Ae.type,rotation:pe.angle,globalNumber:Ae.globalNumber}});Q(pe=>[...pe.slice(-19),Te])},A=xe.useRef(null),E=xe.useRef(null),I=xe.useRef(null),H=xe.useRef(null);xe.useEffect(()=>{A.current=W,E.current=M,I.current=G},[W,M,G]),xe.useEffect(()=>{J()},[]);const J=async()=>{const{data:de}=await He.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});de&&de.length>0&&(S(de),O(de[0].id))};xe.useEffect(()=>{if(!e.current||!T)return;let de=!0;t.current&&t.current.dispose(),e.current.innerHTML="";const Te=document.createElement("canvas");e.current.appendChild(Te);const pe=new Ht.fabric.Canvas(Te,{width:e.current.clientWidth,height:e.current.clientHeight,backgroundColor:"transparent",selection:!0});t.current=pe,new ResizeObserver(()=>{if(!e.current||!t.current)return;const Ne=e.current.clientWidth,Oe=e.current.clientHeight;t.current.setDimensions({width:Ne,height:Oe}),k(t.current)}).observe(e.current),(async()=>{L(!0);const{data:Ne,error:Oe}=await He.from("seats").select("*").eq("zone_id",T).order("global_number",{ascending:!0});de&&(Oe?console.error("Error loading seats:",Oe):Ne&&Ne.length>0?(t.current&&t.current.clear(),Ne.filter(Ye=>typeof Ye.pos_x=="number"&&typeof Ye.pos_y=="number").forEach(Ye=>{Z(Ye);const it=t.current.getObjects().find(Ke=>Ke.data.id===Ye.id);it&&delete it.data.isDirty}),setTimeout(()=>{de&&k(t.current)},100),t.current.renderAll()):t.current&&t.current.clear(),L(!1))})(),pe.on("mouse:down",Ne=>{var Oe,De,Ye,it;if(A.current==="structure"){pe.selection=!1;const Ke=pe.getPointer(Ne.e);V({x:Ke.x,y:Ke.y});const et=new Ht.fabric.Rect({left:Ke.x,top:Ke.y,width:0,height:0,fill:"#E5E5EA",stroke:"#C7C7CC",strokeWidth:1,opacity:.7});pe.add(et),te(et);return}Ne.target?P():(pe.isDragging=!0,pe.selection=!0,pe.lastPosX=Ne.e.clientX||((De=(Oe=Ne.e.touches)==null?void 0:Oe[0])==null?void 0:De.clientX),pe.lastPosY=Ne.e.clientY||((it=(Ye=Ne.e.touches)==null?void 0:Ye[0])==null?void 0:it.clientY))});const je=async()=>{if(ee.length===0)return;const Ne=ee[ee.length-1],Oe=ee.slice(0,-1);Q(Oe),t.current.clear(),Ne.forEach(De=>{Z({id:De.id,seat_number:De.seatNumber,display_number:De.displayNumber,zone_name:De.zoneName,zone_color:De.zoneColor,pos_x:De.pos_x,pos_y:De.pos_y,width:De.width,height:De.height,label:De.label,type:De.type,rotation:De.rotation,global_number:De.globalNumber})})},Le=()=>{const Ne=pe.getActiveObject();Ne&&Ne.clone(Oe=>{H.current=Oe},["data"])},Xe=()=>{if(!H.current||!t.current)return;const Ne=t.current;P();try{H.current.clone(Oe=>{var De,Ye,it;if(!(!Ne.getElement()||!Ne.contextContainer)){if(Ne.discardActiveObject(),Oe.set({left:Oe.left+20,top:Oe.top+20,evented:!0}),Oe.type==="activeSelection"){const Ke=[];Oe.forEachObject(Ge=>{var St,Bt;const ot=crypto.randomUUID();let _t=((St=Ge.data)==null?void 0:St.type)==="structure";!_t&&((Bt=Ge.data)!=null&&Bt.label)&&(_t=!0);const yt=Ge.data||{};_t&&(delete yt.zoneName,delete yt.zoneColor,delete yt.displayNumber),Ge.set("data",{...yt,id:ot,isDirty:!0,type:_t?"structure":"seat",seatNumber:yt.seatNumber||(_t?`STR_${ot.slice(-8)}`:"0")}),Ne.add(Ge),Ke.push(Ge)});const et=new Ht.fabric.ActiveSelection(Ke,{canvas:Ne});Ne.setActiveObject(et),et.setCoords()}else{const Ke=crypto.randomUUID();let et=((De=Oe.data)==null?void 0:De.type)==="structure";if(!et&&((Ye=Oe.data)!=null&&Ye.label)&&(et=!0),et){const ot=((it=Oe.data)==null?void 0:it.label)||"",_t=prompt("  ",ot);if(_t){Oe.data={...Oe.data,label:_t,type:"structure"};const yt=Oe.getObjects().find(St=>St.type==="i-text");yt&&yt.set("text",_t)}}const Ge=Oe.data||{};et&&(delete Ge.zoneName,delete Ge.zoneColor,delete Ge.displayNumber),Oe.set("data",{...Ge,id:Ke,isDirty:!0,type:et?"structure":"seat",seatNumber:et?`STR_${Ke.slice(-8)}`:Ge.seatNumber||"0"}),Ne.add(Oe),Ne.setActiveObject(Oe)}Ne.requestRenderAll()}},["data"])}catch(Oe){console.error("Error pasting objects:",Oe)}},Je=Ne=>{(Ne.ctrlKey||Ne.metaKey)&&Ne.key==="z"&&(Ne.preventDefault(),je()),(Ne.ctrlKey||Ne.metaKey)&&Ne.key==="c"&&document.activeElement.tagName!=="INPUT"&&document.activeElement.tagName!=="TEXTAREA"&&(Ne.preventDefault(),Le()),(Ne.ctrlKey||Ne.metaKey)&&Ne.key==="v"&&document.activeElement.tagName!=="INPUT"&&document.activeElement.tagName!=="TEXTAREA"&&(Ne.preventDefault(),Xe())};return window.addEventListener("keydown",Je),pe.on("mouse:move",Ne=>{var Oe,De,Ye,it;if(A.current==="structure"&&E.current&&I.current){const Ke=pe.getPointer(Ne.e),et=E.current,Ge=I.current,ot=Math.abs(Ke.x-et.x),_t=Math.abs(Ke.y-et.y),yt=Math.min(Ke.x,et.x),St=Math.min(Ke.y,et.y);Ge.set({width:ot,height:_t,left:yt,top:St}),pe.requestRenderAll();return}if(pe.isDragging){const Ke=Ne.e,et=Ke.clientX||((De=(Oe=Ke.touches)==null?void 0:Oe[0])==null?void 0:De.clientX),Ge=Ke.clientY||((it=(Ye=Ke.touches)==null?void 0:Ye[0])==null?void 0:it.clientY),ot=pe.viewportTransform;ot[4]+=et-pe.lastPosX,ot[5]+=Ge-pe.lastPosY,pe.requestRenderAll(),pe.lastPosX=et,pe.lastPosY=Ge}}),pe.on("mouse:wheel",Ne=>{const Oe=Ne.e.deltaY,De=pe.viewportTransform;De[5]-=Oe,pe.requestRenderAll(),Ne.e.preventDefault(),Ne.e.stopPropagation()}),pe.on("object:scaling",Ne=>{const Oe=Ne.target;if(Oe&&Oe.data){const De=Oe.getObjects().find(Ye=>Ye.type==="i-text");De&&De.set({scaleX:1/Oe.scaleX,scaleY:1/Oe.scaleY})}}),pe.on("mouse:dblclick",Ne=>{const Oe=Ne.target;if(!Oe||!Oe.data)return;const De=Oe.data.type;if(De!=="seat"&&De!=="structure")return;const Ye=Oe.getObjects().find(ot=>ot.type==="i-text");if(!Ye)return;P();const it={...Oe.data},Ke=Oe.left,et=Oe.top,Ge=Oe.angle;Oe._restoreObjectsState(),pe.remove(Oe),Oe.getObjects().forEach(ot=>{pe.add(ot),ot===Ye&&(pe.setActiveObject(ot),ot.enterEditing(),ot.selectAll())}),pe.requestRenderAll(),Ye.on("editing:exited",()=>{const ot=Ye.text;De==="structure"&&(it.label=ot),De==="seat"&&(it.displayNumber=ot);const yt=[Oe.getObjects().find(Bt=>Bt.type==="rect"),Ye];yt.forEach(Bt=>pe.remove(Bt));const St=new Ht.fabric.Group(yt,{left:Ke,top:et,angle:Ge,hasControls:!0,lockRotation:!1,subTargetCheck:!0});St.data=it,St.data.isDirty=!0,De==="seat"?St.set({borderColor:it.zoneColor||"#5E5CE6",cornerColor:"white",cornerStrokeColor:"#5E5CE6",transparentCorners:!1}):St.set({borderColor:"#007AFF",cornerColor:"white",cornerStrokeColor:"#007AFF",transparentCorners:!1}),pe.add(St),pe.setActiveObject(St),pe.requestRenderAll(),Ye.off("editing:exited")})}),pe.on("mouse:up",()=>{if(A.current==="structure"&&I.current){const Ne=I.current,Oe=Ne.width,De=Ne.height,Ye=Ne.left,it=Ne.top;Oe>20&&De>20?setTimeout(()=>{const Ke=prompt("  (: , , )","");pe.remove(Ne),te(null),V(null),F(null),Ke&&(P(),Y(Ye,it,Oe,De,Ke))},50):(pe.remove(Ne),te(null),V(null),F(null));return}pe.isDragging&&(pe.setViewportTransform(pe.viewportTransform),pe.isDragging=!1)}),pe.on("selection:created",Ne=>{var De,Ye,it,Ke,et;const Oe=Ne.selected;if(Oe.length===1){const Ge=Oe[0];n(Ge),((De=Ge.data)==null?void 0:De.type)==="structure"?(u(Ge.data.bgColor||"#E5E5EA"),m(Ge.data.strokeColor||"#D1D1D6"),x(Ge.data.textColor||"#8E8E93"),w(Ge.data.fontSize||12)):(s(((Ye=Ge.data)==null?void 0:Ye.seatNumber)||""),o(((it=Ge.data)==null?void 0:it.displayNumber)||""),c(((Ke=Ge.data)==null?void 0:Ke.zoneName)||"A"),h(((et=Ge.data)==null?void 0:et.zoneColor)||"#5E5CE6"))}else n(null)}),pe.on("selection:updated",Ne=>{var De,Ye,it,Ke,et;const Oe=Ne.selected;if(Oe.length===1){const Ge=Oe[0];n(Ge),((De=Ge.data)==null?void 0:De.type)==="structure"?(u(Ge.data.bgColor||"#E5E5EA"),m(Ge.data.strokeColor||"#D1D1D6"),x(Ge.data.textColor||"#8E8E93"),w(Ge.data.fontSize||12)):(s(((Ye=Ge.data)==null?void 0:Ye.seatNumber)||""),o(((it=Ge.data)==null?void 0:it.displayNumber)||""),c(((Ke=Ge.data)==null?void 0:Ke.zoneName)||"A"),h(((et=Ge.data)==null?void 0:et.zoneColor)||"#5E5CE6"))}else n(null)}),pe.on("selection:cleared",()=>{n(null),s(""),o(""),u("#E5E5EA"),m("#D1D1D6"),x("#8E8E93"),w(12)}),pe.on("object:modified",async Ne=>{const Oe=Ne.target;if(!Oe)return;(Oe.type==="activeSelection"?Oe.getObjects():[Oe]).forEach(Ye=>{var it;if(Ye.data){const Ke=Ye.width*Ye.scaleX,et=Ye.height*Ye.scaleY;Ye.set({width:Ke,height:et,scaleX:1,scaleY:1});const Ge=Ye.getObjects().find(ot=>ot.type==="i-text");if(Ge){Ge.set({scaleX:1,scaleY:1}),((it=Ye.data)==null?void 0:it.type)==="structure"?Ge.set({left:0,top:0,originX:"center",originY:"center"}):Ge.set({left:-Ke/2+6,top:-et/2+6,originX:"left",originY:"top"});const ot=Ye.getObjects().find(_t=>_t.type==="rect");ot&&(ot.set({width:Ke,height:et}),ot.set({left:-Ke/2,top:-et/2})),Ye.addWithUpdate()}}Ye.data&&(Ye.data.isDirty=!0)})}),()=>{de=!1,window.removeEventListener("keydown",Je),pe.dispose(),t.current=null}},[T]);const Y=(de,Te,pe,Ae,Ie)=>{const je=new Ht.fabric.Rect({fill:d,width:pe,height:Ae,stroke:p,strokeWidth:1}),Le=new Ht.fabric.IText(Ie,{fontSize:y,originX:"center",originY:"center",left:pe/2,top:Ae/2,fill:g,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),Xe=crypto.randomUUID(),Je=new Ht.fabric.Group([je,Le],{left:de,top:Te,originX:"left",originY:"top",perPixelTargetFind:!0,data:{id:Xe,type:"structure",label:Ie,width:pe,height:Ae,bgColor:d,strokeColor:p,textColor:g,fontSize:y,isDirty:!0,seatNumber:`STR_${Xe.slice(-8)}`}});t.current.add(Je),t.current.setActiveObject(Je)},Z=de=>{if(de.type==="structure"){const Ie=new Ht.fabric.Rect({fill:de.bg_color||"#E5E5EA",width:de.width||72,height:de.height||72,stroke:de.stroke_color||"#D1D1D6",strokeWidth:1}),je=new Ht.fabric.IText(de.label||"",{fontSize:de.font_size||12,originX:"center",originY:"center",left:(de.width||72)/2,top:(de.height||72)/2,fill:de.text_color||"#8E8E93",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),Le=new Ht.fabric.Group([Ie,je],{id:de.id,left:de.pos_x,top:de.pos_y,originX:"left",originY:"top",angle:de.rotation,perPixelTargetFind:!0,data:{id:de.id,type:"structure",label:de.label,width:de.width,height:de.height,bgColor:de.bg_color,strokeColor:de.stroke_color,textColor:de.text_color,fontSize:de.font_size}});t.current.add(Le);return}const Te=new Ht.fabric.Rect({fill:de.zone_color||"#5E5CE6",width:72,height:72,rx:6,ry:6,stroke:"rgba(255,255,255,0.1)",strokeWidth:2}),pe=new Ht.fabric.IText(de.display_number||de.seat_number,{fontSize:12,left:6,top:6,fill:"#ffffff",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"900",selectable:!1}),Ae=new Ht.fabric.Group([Te,pe],{left:de.pos_x,top:de.pos_y,originX:"left",originY:"top",angle:de.rotation,perPixelTargetFind:!0,data:{id:de.id,type:"seat",seatNumber:de.seat_number,displayNumber:de.display_number,zoneName:de.zone_name,zoneColor:de.zone_color,globalNumber:de.global_number}});t.current.add(Ae)},fe=()=>{var de;if(r){if(P(),((de=r.data)==null?void 0:de.type)==="structure"){r.set("data",{...r.data,bgColor:d,strokeColor:p,textColor:g,fontSize:y,isDirty:!0});const Te=r.getObjects().find(Ae=>Ae.type==="rect");Te&&Te.set({fill:d,stroke:p});const pe=r.getObjects().find(Ae=>Ae.type==="i-text");pe&&pe.set({fill:g,fontSize:y})}else{r.set("data",{...r.data,seatNumber:i,displayNumber:l,zoneName:a,zoneColor:f,isDirty:!0});const Te=r.getObjects().find(Ae=>Ae.type==="rect");Te&&Te.set("fill",f);const pe=r.getObjects().find(Ae=>Ae.type==="i-text");pe&&pe.set("text",l)}t.current.renderAll()}},X=()=>{P();const Te=`${t.current.getObjects().filter(je=>{var Le;return((Le=je.data)==null?void 0:Le.type)!=="structure"}).length+1}`,pe=new Ht.fabric.Rect({fill:f,width:72,height:72,rx:6,ry:6,stroke:"rgba(255,255,255,0.1)",strokeWidth:2}),Ae=new Ht.fabric.IText(Te,{fontSize:18,originX:"center",originY:"center",left:36,top:36,fill:"#ffffff",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"900",selectable:!1}),Ie=new Ht.fabric.Group([pe,Ae],{left:150,top:150,originX:"left",originY:"top",perPixelTargetFind:!0,data:{id:crypto.randomUUID(),type:"seat",seatNumber:Te,zoneName:a,zoneColor:f,isDirty:!0}});t.current.add(Ie),t.current.setActiveObject(Ie)},re=async()=>{const de=t.current;if(!de)return;const Te=de.getActiveObject();if(Te){P();const pe=Te.type==="activeSelection"?Te.getObjects():[Te],Ae=[];pe.forEach(Ie=>{var Le;const je=(Le=Ie.data)==null?void 0:Le.id;je&&je.length>20&&Ae.push(je)}),R(Ie=>[...Ie,...Ae]),de.discardActiveObject(),pe.forEach(Ie=>de.remove(Ie)),de.requestRenderAll(),n(null)}},se=()=>{P();const de=t.current.getObjects(),Te=["A","B","C"];let pe=1;Te.forEach(Ae=>{de.filter(je=>{var Le,Xe;return((Le=je.data)==null?void 0:Le.zoneName)===Ae&&((Xe=je.data)==null?void 0:Xe.type)!=="structure"}).sort((je,Le)=>Math.abs(je.top-Le.top)<20?je.left-Le.left:je.top-Le.top).forEach((je,Le)=>{const Xe=Le+1,Je=`${Ae}-${Xe.toString().padStart(2,"0")}`;je.set("data",{...je.data,seatNumber:Xe.toString(),displayNumber:Je,globalNumber:pe++});const Ne=je.getObjects().find(Oe=>Oe.type==="i-text");Ne&&Ne.set("text",Je)})}),t.current.renderAll()},z=()=>{const de=t.current.getActiveObject();de&&(P(),de.rotate(((de.angle||0)+90)%360),t.current.renderAll())},oe=async()=>{var de;if(t.current){L(!0);try{const Te=t.current,pe=Te.getObjects();if(pe.length===0){alert("  ."),L(!1);return}const Ae=Te.viewportTransform;Te.setViewportTransform([1,0,0,1,0,0]);let Ie=1/0,je=1/0,Le=-1/0,Xe=-1/0;pe.forEach(Et=>{if(!Et.visible||Et.opacity===0||(!Et.fill||Et.fill==="transparent")&&(!Et.stroke||Et.stroke==="transparent")&&!Et.text)return;let Jn=Et.getBoundingRect();Ie=Math.min(Ie,Jn.left),je=Math.min(je,Jn.top),Le=Math.max(Le,Jn.left+Jn.width),Xe=Math.max(Xe,Jn.top+Jn.height)});const Je=20,Ne=Ie-Je,Oe=je-Je,De=Le-Ie+Je*2,Ye=Xe-je+Je*2,it=Te.toDataURL({format:"png",left:Ne,top:Oe,width:De,height:Ye,multiplier:3});Te.setViewportTransform(Ae);const{paper:Ke,orientation:et}=K,Ge=Ke==="b4"?257:210,ot=Ke==="b4"?364:297,_t=et==="landscape"?ot:Ge,yt=et==="landscape"?Ge:ot,St=20,Bt=10,qt=10,Ct=document.createElement("iframe");Ct.style.position="fixed",Ct.style.right="0",Ct.style.bottom="0",Ct.style.width="0",Ct.style.height="0",Ct.style.border="0",document.body.appendChild(Ct);const sr=((de=b.find(Et=>Et.id===T))==null?void 0:de.name)||"",Xi=new Date().toISOString().split("T")[0],Dr=Ct.contentWindow.document;Dr.open(),Dr.write(`
          <html>
            <head>
              <title>  - ${sr}</title>
              <style>
                @page {
                  size: ${Ke} ${et};
                  margin: 0;
                }
                html, body {
                  margin: 0;
                  padding: 0;
                  width: 100%;
                  height: 100vh;
                  background: white;
                  -webkit-print-color-adjust: exact;
                  overflow: hidden !important;
                }
                .print-container {
                  width: 100%;
                  height: 100vh;
                  padding: ${St}mm ${Bt}mm ${qt}mm ${Bt}mm;
                  box-sizing: border-box;
                  display: flex;
                  flex-direction: column;
                  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                  overflow: hidden !important;
                  background: white;
                }
                .header {
                  flex-shrink: 0;
                  display: flex;
                  justify-content: space-between;
                  align-items: flex-end;
                  border-bottom: 2px solid #1C1C1E;
                  padding-bottom: 3mm; /* Reduced padding */
                  margin-bottom: 2mm; /* Reduced margin */
                }
                .header h1 {
                  margin: 0;
                  font-size: 16pt; /* Slightly smaller to save space */
                  font-weight: 900;
                  letter-spacing: -1px;
                  color: #1C1C1E;
                }
                .header .info {
                  text-align: right;
                }
                .header .info .zone {
                  font-size: 10pt;
                  font-weight: 800;
                  color: #5856D6;
                  margin: 0;
                }
                .header .info .date {
                  font-size: 8pt;
                  color: #8E8E93;
                  margin: 0;
                }
                /* Content area strictly confined to remaining space */
                .content {
                  flex: 1;
                  display: flex;
                  justify-content: center; /* Center */
                  align-items: center;
                  min-height: 0;
                  padding: 0; /* Remove arbitrary padding to maximize scale */
                  margin: 0;
                  overflow: hidden;
                }
                /* Image autoscaling using object-fit */
                .content img {
                  width: 100%;
                  height: 100%;
                  object-fit: contain;
                  object-position: center; /* Center image */
                  display: block;
                }
                .footer {
                  flex-shrink: 0;
                  margin-top: 1mm; /* Reduced margin */
                  text-align: center;
                  border-top: 1px solid #F2F2F7;
                  padding-top: 2mm;
                }
                .footer p {
                  margin: 0;
                  font-size: 7pt;
                  color: #AEAEB2;
                  font-weight: bold;
                  letter-spacing: 1px;
                }
              </style>
            </head>
            <body>
              <div class="print-container">
                <div class="header">
                  <h1> </h1>
                  <div class="info">
                    <p class="zone">${sr}</p>
                    <p class="date">${Xi} </p>
                  </div>
                </div>
                <div class="content">
                  <img src="${it}" />
                </div>
                <div class="footer">
                  <p>POGOK STUDY CAFE MANAGEMENT SYSTEM</p>
                </div>
              </div>
            </body>
          </html>
        `),Dr.close();const ii=()=>{const Et=Ct.contentWindow;Et.focus(),setTimeout(()=>{Et.print(),setTimeout(()=>{document.body.removeChild(Ct),L(!1)},1e3)},800)},Ii=Dr.querySelector("img");Ii.complete?ii():Ii.onload=ii}catch(Te){console.error("Print generation failed:",Te),alert("    ."),L(!1)}}},ce=async()=>{L(!0);try{if(U.length>0){const{error:Ae}=await He.from("seats").delete().in("id",U);if(Ae)throw console.error("Error deleting items:",Ae),Ae}const de=t.current.getObjects(),Te=[],pe=[];if(de.forEach(Ae=>{var Ne,Oe,De,Ye,it,Ke,et,Ge,ot,_t,yt,St,Bt;const Ie=Math.round(Ae.getScaledWidth()),je=Math.round(Ae.getScaledHeight()),Le=((Ne=Ae.data)==null?void 0:Ne.type)==="structure",Xe=((Oe=Ae.data)==null?void 0:Oe.seatNumber)||(Le?`STR_${Ae.data.id.slice(-8)}`:"0"),Je={zone_id:T,pos_x:Math.round(Ae.left),pos_y:Math.round(Ae.top),rotation:Math.round(Ae.angle||0),type:((De=Ae.data)==null?void 0:De.type)||"seat",width:Ie,height:je,label:((Ye=Ae.data)==null?void 0:Ye.label)||null,bg_color:((it=Ae.data)==null?void 0:it.bgColor)||null,stroke_color:((Ke=Ae.data)==null?void 0:Ke.strokeColor)||null,text_color:((et=Ae.data)==null?void 0:et.textColor)||null,font_size:((Ge=Ae.data)==null?void 0:Ge.fontSize)||null,seat_number:Xe,display_number:((ot=Ae.data)==null?void 0:ot.displayNumber)||null,zone_name:((_t=Ae.data)==null?void 0:_t.zoneName)||null,zone_color:((yt=Ae.data)==null?void 0:yt.zoneColor)||null,global_number:((St=Ae.data)==null?void 0:St.globalNumber)||null};(Bt=Ae.data)!=null&&Bt.id&&Ae.data.id.length>20?(Je.id=Ae.data.id,Te.push(Je)):pe.push(Je)}),Te.length>0){const{error:Ae}=await He.from("seats").upsert(Te);if(Ae)throw Ae}if(pe.length>0){const{error:Ae}=await He.from("seats").insert(pe);if(Ae)throw Ae}alert("."),R([]),t.current.getObjects().forEach(Ae=>{Ae.data&&delete Ae.data.isDirty}),window.location.reload()}catch(de){console.error("Error saving layout:",de),alert(" : "+(de.message||de.details||JSON.stringify(de)))}finally{L(!1)}},we=()=>{P();const de=t.current.getObjects(),Te=30,pe=de.filter(Le=>{var Xe;return(Xe=Le.data)==null?void 0:Xe.isDirty}),Ae=de.filter(Le=>{var Xe;return!((Xe=Le.data)!=null&&Xe.isDirty)}),Ie=Ae.map(Le=>Math.round(Le.left)),je=Ae.map(Le=>Math.round(Le.top));pe.forEach(Le=>{let Xe=Le.left,Je=Le.top,Ne=Xe,Oe=1/0;Ie.forEach(it=>{const Ke=Math.abs(Xe-it);Ke<Te&&Ke<Oe&&(Oe=Ke,Ne=it)}),Oe<Te&&Le.set("left",Ne);let De=Je,Ye=1/0;je.forEach(it=>{const Ke=Math.abs(Je-it);Ke<Te&&Ke<Ye&&(Ye=Ke,De=it)}),Ye<Te&&Le.set("top",De),Le.setCoords()}),t.current.renderAll()};return v.jsxs("div",{className:"flex flex-col w-full h-full mx-auto leading-normal overflow-hidden relative bg-[#F2F2F7]",children:[j&&v.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-50 flex items-center justify-center pointer-events-none",children:v.jsx("div",{className:"w-8 h-8 border-3 border-ios-indigo border-t-transparent rounded-full animate-spin"})}),v.jsxs("div",{className:"bg-white/80 backdrop-blur-md border-b border-black/5 p-4 flex items-center justify-between shadow-sm z-30",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:"flex gap-1",children:b.map(de=>v.jsx("button",{onClick:()=>O(de.id),className:`px-5 py-2 rounded-apple-md text-[11px] font-black transition-all border ${T===de.id?"bg-[#1C1C1E] text-white border-[#1C1C1E] shadow-sm":"bg-white text-ios-gray border-gray-100 hover:text-[#1C1C1E] hover:border-gray-200"}`,children:de.name},de.id))}),v.jsx("div",{className:"h-6 w-[1px] bg-gray-200 mx-2"}),v.jsxs("div",{className:"flex items-center gap-1.5",children:[v.jsxs("button",{onClick:X,className:"flex items-center gap-2 bg-ios-indigo text-white px-4 py-2 rounded-apple-md text-[11px] font-black hover:bg-ios-indigo/90 transition-all ios-tap shadow-sm shadow-ios-indigo/20",children:[v.jsx(dd,{className:"w-3.5 h-3.5"})," "]}),v.jsxs("button",{onClick:()=>F(de=>de==="structure"?null:"structure"),className:`flex items-center gap-2 px-4 py-2 rounded-apple-md text-[11px] font-black transition-all border ios-tap ${W==="structure"?"bg-[#1C1C1E] text-white border-[#1C1C1E]":"bg-white text-ios-gray border-gray-100 hover:bg-gray-50"}`,children:[v.jsx(R8,{className:"w-3.5 h-3.5"})," "]})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("button",{onClick:se,className:"p-2.5 rounded-apple-md bg-white border border-gray-100 text-ios-amber hover:bg-ios-amber/5 transition-all ios-tap group",title:"  ",children:v.jsx(D8,{className:"w-4 h-4 group-hover:scale-110 transition-transform"})}),v.jsx("button",{onClick:we,className:"p-2.5 rounded-apple-md bg-white border border-gray-100 text-ios-emerald hover:bg-ios-emerald/5 transition-all ios-tap group",title:" ",children:v.jsx(P8,{className:"w-4 h-4 group-hover:scale-110 transition-transform"})}),v.jsx("div",{className:"h-6 w-[1px] bg-gray-200 mx-2"}),v.jsxs("button",{onClick:ce,disabled:j,className:"flex items-center gap-2 bg-[#1C1C1E] text-white px-5 py-2.5 rounded-apple-md text-[12px] font-black hover:bg-black transition-all ios-tap disabled:opacity-50 shadow-lg shadow-black/5",children:[v.jsx(vf,{className:`w-4 h-4 ${j?"animate-spin":""}`})," "]}),v.jsxs("button",{onClick:oe,disabled:j,className:"flex items-center gap-2 bg-white text-[#1C1C1E] px-5 py-2.5 rounded-apple-md text-[12px] font-black border border-gray-200 hover:bg-gray-50 transition-all ios-tap disabled:opacity-50 shadow-sm ml-2",children:[v.jsx(Fl,{className:`w-4 h-4 ${j?"animate-pulse":""}`})," "]})]})]}),v.jsxs("div",{className:"flex-1 w-full relative overflow-hidden bg-white",children:[W==="structure"&&v.jsx("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 z-20 bg-[#1C1C1E]/80 backdrop-blur-lg px-6 py-2.5 rounded-full border border-white/10 shadow-xl pointer-events-none animate-spring-up",children:v.jsx("span",{className:"text-white text-[11px] font-black tracking-tight",children:"   "})}),v.jsx("div",{className:"w-full h-full flex flex-col",children:v.jsx("div",{ref:e,className:"flex-1 h-full relative overflow-hidden cursor-grab active:cursor-grabbing touch-none select-none scrollbar-hide"})}),v.jsx("div",{className:`absolute top-6 right-6 w-72 transition-all duration-500 ease-apple-out z-40 ${r?"opacity-100 translate-y-0 pointer-events-auto":"opacity-0 translate-y-4 pointer-events-none"}`,children:v.jsxs("div",{className:"glass-material rounded-apple-xl border border-white/40 shadow-2xl p-6 space-y-6",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("h3",{className:"text-[11px] font-black uppercase tracking-[0.2em] text-ios-indigo",children:" "}),v.jsxs("div",{className:"flex gap-1.5",children:[v.jsx("button",{onClick:z,className:"p-2 rounded-apple-md bg-white/50 hover:bg-white text-ios-indigo transition-all shadow-sm border border-white/40",title:"90 ",children:v.jsx(oO,{className:"w-3.5 h-3.5"})}),v.jsx("button",{onClick:re,className:"p-2 rounded-apple-md bg-ios-rose/5 hover:bg-ios-rose text-ios-rose hover:text-white transition-all shadow-sm border border-ios-rose/10",title:"",children:v.jsx(Dl,{className:"w-3.5 h-3.5"})})]})]}),((ye=r==null?void 0:r.data)==null?void 0:ye.type)!=="structure"?v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:"Display No"}),v.jsx("input",{type:"text",value:l,onChange:de=>o(de.target.value),className:"w-full bg-white/80 border border-white/60 rounded-[8px] p-2.5 text-xs font-black text-[#1C1C1E] focus:ring-1 focus:ring-ios-indigo",placeholder:": A-01"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:"Zone"}),v.jsxs("select",{value:a,onChange:de=>c(de.target.value),className:"w-full bg-white/80 border border-white/60 rounded-[8px] p-2.5 text-xs font-black text-[#1C1C1E] focus:ring-1 focus:ring-ios-indigo appearance-none",children:[v.jsx("option",{value:"A",children:"Zone A"}),v.jsx("option",{value:"B",children:"Zone B"}),v.jsx("option",{value:"C",children:"Zone C"})]})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1 flex items-center gap-1.5",children:[v.jsx(V8,{className:"w-2.5 h-2.5"})," Zone Color"]}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{type:"color",value:f,onChange:de=>h(de.target.value),className:"w-10 h-10 bg-transparent border-0 rounded-[8px] cursor-pointer overflow-hidden p-0 shadow-sm"}),v.jsx("input",{type:"text",value:f.toUpperCase(),onChange:de=>h(de.target.value),className:"flex-1 bg-white/80 border border-white/60 rounded-[8px] p-2.5 text-[10px] font-black text-[#1C1C1E]"})]})]}),v.jsxs("div",{className:"pt-2",children:[v.jsx("button",{onClick:fe,className:"w-full bg-ios-indigo text-white py-3 rounded-apple-md font-black text-[11px] shadow-lg shadow-ios-indigo/20 ios-tap",children:" "}),v.jsx("button",{onClick:()=>n(null),className:"w-full mt-2 text-ios-gray py-2 font-bold text-[10px] hover:text-[#1C1C1E] transition-colors",children:" "})]})]}):v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1 flex items-center gap-1.5",children:""}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{type:"color",value:d,onChange:de=>u(de.target.value),className:"w-10 h-10 bg-transparent border-0 rounded-[8px] cursor-pointer"}),v.jsx("input",{type:"text",value:d.toUpperCase(),onChange:de=>u(de.target.value),className:"flex-1 bg-white/80 border border-white/60 rounded-[8px] p-2.5 text-[10px] font-black"})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:""}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{type:"color",value:p,onChange:de=>m(de.target.value),className:"w-10 h-10 bg-transparent border-0 rounded-[8px] cursor-pointer"}),v.jsx("input",{type:"text",value:p.toUpperCase(),onChange:de=>m(de.target.value),className:"flex-1 bg-white/80 border border-white/60 rounded-[8px] p-2.5 text-[10px] font-black"})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:""}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{type:"color",value:g,onChange:de=>x(de.target.value),className:"w-10 h-10 bg-transparent border-0 rounded-[8px] cursor-pointer"}),v.jsx("input",{type:"text",value:g.toUpperCase(),onChange:de=>x(de.target.value),className:"flex-1 bg-white/80 border border-white/60 rounded-[8px] p-2.5 text-[10px] font-black"})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:["  (",y,"px)"]}),v.jsx("input",{type:"range",min:"6",max:"48",value:y,onChange:de=>w(parseInt(de.target.value)),className:"w-full"})]}),v.jsxs("div",{className:"pt-2",children:[v.jsx("button",{onClick:fe,className:"w-full bg-ios-indigo text-white py-3 rounded-apple-md font-black text-[11px] shadow-lg",children:" "}),v.jsx("button",{onClick:()=>n(null),className:"w-full mt-2 text-ios-gray py-2 font-bold text-[10px]",children:""})]})]})]})})]})]})},pF="modulepreload",gF=function(e){return"/"+e},f_={},O1=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));i=Promise.allSettled(r.map(a=>{if(a=gF(a),a in f_)return;f_[a]=!0;const c=a.endsWith(".css"),f=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${f}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":pF,c||(h.as="script"),h.crossOrigin="",h.href=a,o&&h.setAttribute("nonce",o),document.head.appendChild(h),c)return new Promise((d,u)=>{h.addEventListener("load",d),h.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${a}`)))})}))}function s(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return i.then(l=>{for(const o of l||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})};function Er(e){"@babel/helpers - typeof";return Er=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Er(e)}var ka=Uint8Array,ks=Uint16Array,K2=Int32Array,J2=new ka([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Q2=new ka([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),h_=new ka([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),y3=function(e,t){for(var r=new ks(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new K2(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return{b:r,r:i}},w3=y3(J2,2),mF=w3.b,_v=w3.r;mF[28]=258,_v[258]=28;var xF=y3(Q2,0),d_=xF.r,kv=new ks(32768);for(var Hr=0;Hr<32768;++Hr){var ol=(Hr&43690)>>1|(Hr&21845)<<1;ol=(ol&52428)>>2|(ol&13107)<<2,ol=(ol&61680)>>4|(ol&3855)<<4,kv[Hr]=((ol&65280)>>8|(ol&255)<<8)>>1}var Ih=function(e,t,r){for(var n=e.length,i=0,s=new ks(t);i<n;++i)e[i]&&++s[e[i]-1];var l=new ks(t);for(i=1;i<t;++i)l[i]=l[i-1]+s[i-1]<<1;var o;if(r){o=new ks(1<<t);var a=15-t;for(i=0;i<n;++i)if(e[i])for(var c=i<<4|e[i],f=t-e[i],h=l[e[i]-1]++<<f,d=h|(1<<f)-1;h<=d;++h)o[kv[h]>>a]=c}else for(o=new ks(n),i=0;i<n;++i)e[i]&&(o[i]=kv[l[e[i]-1]++]>>15-e[i]);return o},Dc=new ka(288);for(var Hr=0;Hr<144;++Hr)Dc[Hr]=8;for(var Hr=144;Hr<256;++Hr)Dc[Hr]=9;for(var Hr=256;Hr<280;++Hr)Dc[Hr]=7;for(var Hr=280;Hr<288;++Hr)Dc[Hr]=8;var vg=new ka(32);for(var Hr=0;Hr<32;++Hr)vg[Hr]=5;var vF=Ih(Dc,9,0),yF=Ih(vg,5,0),b3=function(e){return(e+7)/8|0},wF=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new ka(e.subarray(t,r))},vo=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},dh=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},j1=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,s=r.slice();if(!i)return{t:k3,l:0};if(i==1){var l=new ka(r[0].s+1);return l[r[0].s]=1,{t:l,l:1}}r.sort(function(S,T){return S.f-T.f}),r.push({s:-1,f:25001});var o=r[0],a=r[1],c=0,f=1,h=2;for(r[0]={s:-1,f:o.f+a.f,l:o,r:a};f!=i-1;)o=r[r[c].f<r[h].f?c++:h++],a=r[c!=f&&r[c].f<r[h].f?c++:h++],r[f++]={s:-1,f:o.f+a.f,l:o,r:a};for(var d=s[0].s,n=1;n<i;++n)s[n].s>d&&(d=s[n].s);var u=new ks(d+1),p=Sv(r[f-1],u,0);if(p>t){var n=0,m=0,g=p-t,x=1<<g;for(s.sort(function(T,O){return u[O.s]-u[T.s]||T.f-O.f});n<i;++n){var y=s[n].s;if(u[y]>t)m+=x-(1<<p-u[y]),u[y]=t;else break}for(m>>=g;m>0;){var w=s[n].s;u[w]<t?m-=1<<t-u[w]++-1:++n}for(;n>=0&&m;--n){var b=s[n].s;u[b]==t&&(--u[b],++m)}p=t}return{t:new ka(u),l:p}},Sv=function(e,t,r){return e.s==-1?Math.max(Sv(e.l,t,r+1),Sv(e.r,t,r+1)):t[e.s]=r},p_=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new ks(++t),n=0,i=e[0],s=1,l=function(a){r[n++]=a},o=1;o<=t;++o)if(e[o]==i&&o!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)l(32754);s>2&&(l(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(l(i),--s;s>6;s-=6)l(8304);s>2&&(l(s-3<<5|8208),s=0)}for(;s--;)l(i);s=1,i=e[o]}return{c:r.subarray(0,n),n:t}},ph=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},_3=function(e,t,r){var n=r.length,i=b3(t+2);e[i]=n&255,e[i+1]=n>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var s=0;s<n;++s)e[i+s+4]=r[s];return(i+4+n)*8},g_=function(e,t,r,n,i,s,l,o,a,c,f){vo(t,f++,r),++i[256];for(var h=j1(i,15),d=h.t,u=h.l,p=j1(s,15),m=p.t,g=p.l,x=p_(d),y=x.c,w=x.n,b=p_(m),S=b.c,T=b.n,O=new ks(19),j=0;j<y.length;++j)++O[y[j]&31];for(var j=0;j<S.length;++j)++O[S[j]&31];for(var L=j1(O,7),W=L.t,F=L.l,M=19;M>4&&!W[h_[M-1]];--M);var V=c+5<<3,G=ph(i,Dc)+ph(s,vg)+l,te=ph(i,d)+ph(s,m)+l+14+3*M+ph(O,W)+2*O[16]+3*O[17]+7*O[18];if(a>=0&&V<=G&&V<=te)return _3(t,f,e.subarray(a,a+c));var ee,Q,K,N;if(vo(t,f,1+(te<G)),f+=2,te<G){ee=Ih(d,u,0),Q=d,K=Ih(m,g,0),N=m;var U=Ih(W,F,0);vo(t,f,w-257),vo(t,f+5,T-1),vo(t,f+10,M-4),f+=14;for(var j=0;j<M;++j)vo(t,f+3*j,W[h_[j]]);f+=3*M;for(var R=[y,S],k=0;k<2;++k)for(var P=R[k],j=0;j<P.length;++j){var A=P[j]&31;vo(t,f,U[A]),f+=W[A],A>15&&(vo(t,f,P[j]>>5&127),f+=P[j]>>12)}}else ee=vF,Q=Dc,K=yF,N=vg;for(var j=0;j<o;++j){var E=n[j];if(E>255){var A=E>>18&31;dh(t,f,ee[A+257]),f+=Q[A+257],A>7&&(vo(t,f,E>>23&31),f+=J2[A]);var I=E&31;dh(t,f,K[I]),f+=N[I],I>3&&(dh(t,f,E>>5&8191),f+=Q2[I])}else dh(t,f,ee[E]),f+=Q[E]}return dh(t,f,ee[256]),f+Q[256]},bF=new K2([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),k3=new ka(0),_F=function(e,t,r,n,i,s){var l=s.z||e.length,o=new ka(n+l+5*(1+Math.ceil(l/7e3))+i),a=o.subarray(n,o.length-i),c=s.l,f=(s.r||0)&7;if(t){f&&(a[0]=s.r>>3);for(var h=bF[t-1],d=h>>13,u=h&8191,p=(1<<r)-1,m=s.p||new ks(32768),g=s.h||new ks(p+1),x=Math.ceil(r/3),y=2*x,w=function(se){return(e[se]^e[se+1]<<x^e[se+2]<<y)&p},b=new K2(25e3),S=new ks(288),T=new ks(32),O=0,j=0,L=s.i||0,W=0,F=s.w||0,M=0;L+2<l;++L){var V=w(L),G=L&32767,te=g[V];if(m[G]=te,g[V]=G,F<=L){var ee=l-L;if((O>7e3||W>24576)&&(ee>423||!c)){f=g_(e,a,0,b,S,T,j,W,M,L-M,f),W=O=j=0,M=L;for(var Q=0;Q<286;++Q)S[Q]=0;for(var Q=0;Q<30;++Q)T[Q]=0}var K=2,N=0,U=u,R=G-te&32767;if(ee>2&&V==w(L-R))for(var k=Math.min(d,ee)-1,P=Math.min(32767,L),A=Math.min(258,ee);R<=P&&--U&&G!=te;){if(e[L+K]==e[L+K-R]){for(var E=0;E<A&&e[L+E]==e[L+E-R];++E);if(E>K){if(K=E,N=R,E>k)break;for(var I=Math.min(R,E-2),H=0,Q=0;Q<I;++Q){var J=L-R+Q&32767,Y=m[J],Z=J-Y&32767;Z>H&&(H=Z,te=J)}}}G=te,te=m[G],R+=G-te&32767}if(N){b[W++]=268435456|_v[K]<<18|d_[N];var fe=_v[K]&31,X=d_[N]&31;j+=J2[fe]+Q2[X],++S[257+fe],++T[X],F=L+K,++O}else b[W++]=e[L],++S[e[L]]}}for(L=Math.max(L,F);L<l;++L)b[W++]=e[L],++S[e[L]];f=g_(e,a,c,b,S,T,j,W,M,L-M,f),c||(s.r=f&7|a[f/8|0]<<3,f-=7,s.h=g,s.p=m,s.i=L,s.w=F)}else{for(var L=s.w||0;L<l+c;L+=65535){var re=L+65535;re>=l&&(a[f/8|0]=c,re=l),f=_3(a,f+1,e.subarray(L,re))}s.i=l}return wF(o,0,n+b3(f)+i)},S3=function(){var e=1,t=0;return{p:function(r){for(var n=e,i=t,s=r.length|0,l=0;l!=s;){for(var o=Math.min(l+2655,s);l<o;++l)i+=n+=r[l];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}e=n,t=i},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},kF=function(e,t,r,n,i){if(!i&&(i={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),l=new ka(s.length+e.length);l.set(s),l.set(e,s.length),e=l,i.w=s.length}return _F(e,t.level==null?6:t.level,t.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,i)},C3=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},SF=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=S3();i.p(t.dictionary),C3(e,2,i.d())}};function Cv(e,t){t||(t={});var r=S3();r.p(e);var n=kF(e,t,t.dictionary?6:2,4);return SF(n,t),C3(n,n.length-4,r.d()),n}var CF=typeof TextDecoder<"u"&&new TextDecoder,EF=0;try{CF.decode(k3,{stream:!0}),EF=1}catch{}function TF(e){if(Array.isArray(e))return e}function NF(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,s,l,o=[],a=!0,c=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(a=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);a=!0);}catch(f){c=!0,i=f}finally{try{if(!a&&r.return!=null&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw i}}return o}}function m_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function AF(e,t){if(e){if(typeof e=="string")return m_(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m_(e,t):void 0}}function OF(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x_(e,t){return TF(e)||NF(e,t)||AF(e,t)||OF()}function v_(e,t="utf8"){return new TextDecoder(t).decode(e)}const jF=new TextEncoder;function PF(e){return jF.encode(e)}const FF=1024*8,DF=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),P1={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Z2{constructor(t=FF,r={}){dt(this,"buffer");dt(this,"byteLength");dt(this,"byteOffset");dt(this,"length");dt(this,"offset");dt(this,"lastWrittenByte");dt(this,"littleEndian");dt(this,"_data");dt(this,"_mark");dt(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const i=r.offset?r.offset>>>0:0,s=t.byteLength-i;let l=i;(ArrayBuffer.isView(t)||t instanceof Z2)&&(t.byteLength!==t.buffer.byteLength&&(l=t.byteOffset+i),t=t.buffer),n?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=t,this.length=s,this.byteLength=s,this.byteOffset=l,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,l,s),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,i=new Uint8Array(n);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=P1[r].BYTES_PER_ELEMENT*t,i=this.byteOffset+this.offset,s=this.buffer.slice(i,i+n);if(this.littleEndian===DF&&r!=="uint8"&&r!=="int8"){const o=new Uint8Array(this.buffer.slice(i,i+n));o.reverse();const a=new P1[r](o.buffer);return this.offset+=n,a.reverse(),a}const l=new P1[r](s);return this.offset+=n,l}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return v_(this.readBytes(t))}decodeText(t=1,r="utf8"){return v_(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(PF(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Nf(e){let t=e.length;for(;--t>=0;)e[t]=0}const LF=3,IF=258,E3=29,MF=256,RF=MF+1+E3,T3=30,BF=512,UF=new Array((RF+2)*2);Nf(UF);const zF=new Array(T3*2);Nf(zF);const WF=new Array(BF);Nf(WF);const HF=new Array(IF-LF+1);Nf(HF);const $F=new Array(E3);Nf($F);const qF=new Array(T3);Nf(qF);const VF=(e,t,r,n)=>{let i=e&65535|0,s=e>>>16&65535|0,l=0;for(;r!==0;){l=r>2e3?2e3:r,r-=l;do i=i+t[n++]|0,s=s+i|0;while(--l);i%=65521,s%=65521}return i|s<<16|0};var Ev=VF;const GF=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},XF=new Uint32Array(GF()),YF=(e,t,r,n)=>{const i=XF,s=n+r;e^=-1;for(let l=n;l<s;l++)e=e>>>8^i[(e^t[l])&255];return e^-1};var Da=YF,Tv={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},N3={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const KF=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var JF=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)KF(r,n)&&(e[n]=r[n])}}return e},QF=e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,i=0,s=e.length;n<s;n++){let l=e[n];r.set(l,i),i+=l.length}return r},A3={assign:JF,flattenChunks:QF};let O3=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{O3=!1}const _d=new Uint8Array(256);for(let e=0;e<256;e++)_d[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;_d[254]=_d[254]=1;var ZF=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,i,s,l=e.length,o=0;for(i=0;i<l;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<l&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(o),s=0,i=0;s<o;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<l&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|r&63):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|r&63):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|r&63);return t};const eD=(e,t)=>{if(t<65534&&e.subarray&&O3)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var tD=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,i;const s=new Array(r*2);for(i=0,n=0;n<r;){let l=e[n++];if(l<128){s[i++]=l;continue}let o=_d[l];if(o>4){s[i++]=65533,n+=o-1;continue}for(l&=o===2?31:o===3?15:7;o>1&&n<r;)l=l<<6|e[n++]&63,o--;if(o>1){s[i++]=65533;continue}l<65536?s[i++]=l:(l-=65536,s[i++]=55296|l>>10&1023,s[i++]=56320|l&1023)}return eD(s,i)},rD=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+_d[e[r]]>t?r:t},Nv={string2buf:ZF,buf2string:tD,utf8border:rD};function nD(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var iD=nD;const tp=16209,sD=16191;var aD=function(t,r){let n,i,s,l,o,a,c,f,h,d,u,p,m,g,x,y,w,b,S,T,O,j,L,W;const F=t.state;n=t.next_in,L=t.input,i=n+(t.avail_in-5),s=t.next_out,W=t.output,l=s-(r-t.avail_out),o=s+(t.avail_out-257),a=F.dmax,c=F.wsize,f=F.whave,h=F.wnext,d=F.window,u=F.hold,p=F.bits,m=F.lencode,g=F.distcode,x=(1<<F.lenbits)-1,y=(1<<F.distbits)-1;e:do{p<15&&(u+=L[n++]<<p,p+=8,u+=L[n++]<<p,p+=8),w=m[u&x];t:for(;;){if(b=w>>>24,u>>>=b,p-=b,b=w>>>16&255,b===0)W[s++]=w&65535;else if(b&16){S=w&65535,b&=15,b&&(p<b&&(u+=L[n++]<<p,p+=8),S+=u&(1<<b)-1,u>>>=b,p-=b),p<15&&(u+=L[n++]<<p,p+=8,u+=L[n++]<<p,p+=8),w=g[u&y];r:for(;;){if(b=w>>>24,u>>>=b,p-=b,b=w>>>16&255,b&16){if(T=w&65535,b&=15,p<b&&(u+=L[n++]<<p,p+=8,p<b&&(u+=L[n++]<<p,p+=8)),T+=u&(1<<b)-1,T>a){t.msg="invalid distance too far back",F.mode=tp;break e}if(u>>>=b,p-=b,b=s-l,T>b){if(b=T-b,b>f&&F.sane){t.msg="invalid distance too far back",F.mode=tp;break e}if(O=0,j=d,h===0){if(O+=c-b,b<S){S-=b;do W[s++]=d[O++];while(--b);O=s-T,j=W}}else if(h<b){if(O+=c+h-b,b-=h,b<S){S-=b;do W[s++]=d[O++];while(--b);if(O=0,h<S){b=h,S-=b;do W[s++]=d[O++];while(--b);O=s-T,j=W}}}else if(O+=h-b,b<S){S-=b;do W[s++]=d[O++];while(--b);O=s-T,j=W}for(;S>2;)W[s++]=j[O++],W[s++]=j[O++],W[s++]=j[O++],S-=3;S&&(W[s++]=j[O++],S>1&&(W[s++]=j[O++]))}else{O=s-T;do W[s++]=W[O++],W[s++]=W[O++],W[s++]=W[O++],S-=3;while(S>2);S&&(W[s++]=W[O++],S>1&&(W[s++]=W[O++]))}}else if(b&64){t.msg="invalid distance code",F.mode=tp;break e}else{w=g[(w&65535)+(u&(1<<b)-1)];continue r}break}}else if(b&64)if(b&32){F.mode=sD;break e}else{t.msg="invalid literal/length code",F.mode=tp;break e}else{w=m[(w&65535)+(u&(1<<b)-1)];continue t}break}}while(n<i&&s<o);S=p>>3,n-=S,p-=S<<3,u&=(1<<p)-1,t.next_in=n,t.next_out=s,t.avail_in=n<i?5+(i-n):5-(n-i),t.avail_out=s<o?257+(o-s):257-(s-o),F.hold=u,F.bits=p};const vu=15,y_=852,w_=592,b_=0,F1=1,__=2,oD=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lD=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),cD=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),uD=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),fD=(e,t,r,n,i,s,l,o)=>{const a=o.bits;let c=0,f=0,h=0,d=0,u=0,p=0,m=0,g=0,x=0,y=0,w,b,S,T,O,j=null,L;const W=new Uint16Array(vu+1),F=new Uint16Array(vu+1);let M=null,V,G,te;for(c=0;c<=vu;c++)W[c]=0;for(f=0;f<n;f++)W[t[r+f]]++;for(u=a,d=vu;d>=1&&W[d]===0;d--);if(u>d&&(u=d),d===0)return i[s++]=1<<24|64<<16|0,i[s++]=1<<24|64<<16|0,o.bits=1,0;for(h=1;h<d&&W[h]===0;h++);for(u<h&&(u=h),g=1,c=1;c<=vu;c++)if(g<<=1,g-=W[c],g<0)return-1;if(g>0&&(e===b_||d!==1))return-1;for(F[1]=0,c=1;c<vu;c++)F[c+1]=F[c]+W[c];for(f=0;f<n;f++)t[r+f]!==0&&(l[F[t[r+f]]++]=f);if(e===b_?(j=M=l,L=20):e===F1?(j=oD,M=lD,L=257):(j=cD,M=uD,L=0),y=0,f=0,c=h,O=s,p=u,m=0,S=-1,x=1<<u,T=x-1,e===F1&&x>y_||e===__&&x>w_)return 1;for(;;){V=c-m,l[f]+1<L?(G=0,te=l[f]):l[f]>=L?(G=M[l[f]-L],te=j[l[f]-L]):(G=96,te=0),w=1<<c-m,b=1<<p,h=b;do b-=w,i[O+(y>>m)+b]=V<<24|G<<16|te|0;while(b!==0);for(w=1<<c-1;y&w;)w>>=1;if(w!==0?(y&=w-1,y+=w):y=0,f++,--W[c]===0){if(c===d)break;c=t[r+l[f]]}if(c>u&&(y&T)!==S){for(m===0&&(m=u),O+=h,p=c-m,g=1<<p;p+m<d&&(g-=W[p+m],!(g<=0));)p++,g<<=1;if(x+=1<<p,e===F1&&x>y_||e===__&&x>w_)return 1;S=y&T,i[S]=u<<24|p<<16|O-s|0}}return y!==0&&(i[O+y]=c-m<<24|64<<16|0),o.bits=u,0};var Mh=fD;const hD=0,j3=1,P3=2,{Z_FINISH:k_,Z_BLOCK:dD,Z_TREES:rp,Z_OK:Lc,Z_STREAM_END:pD,Z_NEED_DICT:gD,Z_STREAM_ERROR:Qs,Z_DATA_ERROR:F3,Z_MEM_ERROR:D3,Z_BUF_ERROR:mD,Z_DEFLATED:S_}=N3,nm=16180,C_=16181,E_=16182,T_=16183,N_=16184,A_=16185,O_=16186,j_=16187,P_=16188,F_=16189,yg=16190,yo=16191,D1=16192,D_=16193,L1=16194,L_=16195,I_=16196,M_=16197,R_=16198,np=16199,ip=16200,B_=16201,U_=16202,z_=16203,W_=16204,H_=16205,I1=16206,$_=16207,q_=16208,Xr=16209,L3=16210,I3=16211,xD=852,vD=592,yD=15,wD=yD,V_=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function bD(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const qc=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<nm||t.mode>I3?1:0},M3=e=>{if(qc(e))return Qs;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=nm,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(xD),t.distcode=t.distdyn=new Int32Array(vD),t.sane=1,t.back=-1,Lc},R3=e=>{if(qc(e))return Qs;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,M3(e)},B3=(e,t)=>{let r;if(qc(e))return Qs;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Qs:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,R3(e))},U3=(e,t)=>{if(!e)return Qs;const r=new bD;e.state=r,r.strm=e,r.window=null,r.mode=nm;const n=B3(e,t);return n!==Lc&&(e.state=null),n},_D=e=>U3(e,wD);let G_=!0,M1,R1;const kD=e=>{if(G_){M1=new Int32Array(512),R1=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Mh(j3,e.lens,0,288,M1,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Mh(P3,e.lens,0,32,R1,0,e.work,{bits:5}),G_=!1}e.lencode=M1,e.lenbits=9,e.distcode=R1,e.distbits=5},z3=(e,t,r,n)=>{let i;const s=e.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(t.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>n&&(i=n),s.window.set(t.subarray(r-n,r-n+i),s.wnext),n-=i,n?(s.window.set(t.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},SD=(e,t)=>{let r,n,i,s,l,o,a,c,f,h,d,u,p,m,g=0,x,y,w,b,S,T,O,j;const L=new Uint8Array(4);let W,F;const M=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(qc(e)||!e.output||!e.input&&e.avail_in!==0)return Qs;r=e.state,r.mode===yo&&(r.mode=D1),l=e.next_out,i=e.output,a=e.avail_out,s=e.next_in,n=e.input,o=e.avail_in,c=r.hold,f=r.bits,h=o,d=a,j=Lc;e:for(;;)switch(r.mode){case nm:if(r.wrap===0){r.mode=D1;break}for(;f<16;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if(r.wrap&2&&c===35615){r.wbits===0&&(r.wbits=15),r.check=0,L[0]=c&255,L[1]=c>>>8&255,r.check=Da(r.check,L,2,0),c=0,f=0,r.mode=C_;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((c&255)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=Xr;break}if((c&15)!==S_){e.msg="unknown compression method",r.mode=Xr;break}if(c>>>=4,f-=4,O=(c&15)+8,r.wbits===0&&(r.wbits=O),O>15||O>r.wbits){e.msg="invalid window size",r.mode=Xr;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=c&512?F_:yo,c=0,f=0;break;case C_:for(;f<16;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if(r.flags=c,(r.flags&255)!==S_){e.msg="unknown compression method",r.mode=Xr;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Xr;break}r.head&&(r.head.text=c>>8&1),r.flags&512&&r.wrap&4&&(L[0]=c&255,L[1]=c>>>8&255,r.check=Da(r.check,L,2,0)),c=0,f=0,r.mode=E_;case E_:for(;f<32;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}r.head&&(r.head.time=c),r.flags&512&&r.wrap&4&&(L[0]=c&255,L[1]=c>>>8&255,L[2]=c>>>16&255,L[3]=c>>>24&255,r.check=Da(r.check,L,4,0)),c=0,f=0,r.mode=T_;case T_:for(;f<16;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}r.head&&(r.head.xflags=c&255,r.head.os=c>>8),r.flags&512&&r.wrap&4&&(L[0]=c&255,L[1]=c>>>8&255,r.check=Da(r.check,L,2,0)),c=0,f=0,r.mode=N_;case N_:if(r.flags&1024){for(;f<16;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}r.length=c,r.head&&(r.head.extra_len=c),r.flags&512&&r.wrap&4&&(L[0]=c&255,L[1]=c>>>8&255,r.check=Da(r.check,L,2,0)),c=0,f=0}else r.head&&(r.head.extra=null);r.mode=A_;case A_:if(r.flags&1024&&(u=r.length,u>o&&(u=o),u&&(r.head&&(O=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(s,s+u),O)),r.flags&512&&r.wrap&4&&(r.check=Da(r.check,n,u,s)),o-=u,s+=u,r.length-=u),r.length))break e;r.length=0,r.mode=O_;case O_:if(r.flags&2048){if(o===0)break e;u=0;do O=n[s+u++],r.head&&O&&r.length<65536&&(r.head.name+=String.fromCharCode(O));while(O&&u<o);if(r.flags&512&&r.wrap&4&&(r.check=Da(r.check,n,u,s)),o-=u,s+=u,O)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=j_;case j_:if(r.flags&4096){if(o===0)break e;u=0;do O=n[s+u++],r.head&&O&&r.length<65536&&(r.head.comment+=String.fromCharCode(O));while(O&&u<o);if(r.flags&512&&r.wrap&4&&(r.check=Da(r.check,n,u,s)),o-=u,s+=u,O)break e}else r.head&&(r.head.comment=null);r.mode=P_;case P_:if(r.flags&512){for(;f<16;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if(r.wrap&4&&c!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Xr;break}c=0,f=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=yo;break;case F_:for(;f<32;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}e.adler=r.check=V_(c),c=0,f=0,r.mode=yg;case yg:if(r.havedict===0)return e.next_out=l,e.avail_out=a,e.next_in=s,e.avail_in=o,r.hold=c,r.bits=f,gD;e.adler=r.check=1,r.mode=yo;case yo:if(t===dD||t===rp)break e;case D1:if(r.last){c>>>=f&7,f-=f&7,r.mode=I1;break}for(;f<3;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}switch(r.last=c&1,c>>>=1,f-=1,c&3){case 0:r.mode=D_;break;case 1:if(kD(r),r.mode=np,t===rp){c>>>=2,f-=2;break e}break;case 2:r.mode=I_;break;case 3:e.msg="invalid block type",r.mode=Xr}c>>>=2,f-=2;break;case D_:for(c>>>=f&7,f-=f&7;f<32;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if((c&65535)!==(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Xr;break}if(r.length=c&65535,c=0,f=0,r.mode=L1,t===rp)break e;case L1:r.mode=L_;case L_:if(u=r.length,u){if(u>o&&(u=o),u>a&&(u=a),u===0)break e;i.set(n.subarray(s,s+u),l),o-=u,s+=u,a-=u,l+=u,r.length-=u;break}r.mode=yo;break;case I_:for(;f<14;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if(r.nlen=(c&31)+257,c>>>=5,f-=5,r.ndist=(c&31)+1,c>>>=5,f-=5,r.ncode=(c&15)+4,c>>>=4,f-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Xr;break}r.have=0,r.mode=M_;case M_:for(;r.have<r.ncode;){for(;f<3;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}r.lens[M[r.have++]]=c&7,c>>>=3,f-=3}for(;r.have<19;)r.lens[M[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,W={bits:r.lenbits},j=Mh(hD,r.lens,0,19,r.lencode,0,r.work,W),r.lenbits=W.bits,j){e.msg="invalid code lengths set",r.mode=Xr;break}r.have=0,r.mode=R_;case R_:for(;r.have<r.nlen+r.ndist;){for(;g=r.lencode[c&(1<<r.lenbits)-1],x=g>>>24,y=g>>>16&255,w=g&65535,!(x<=f);){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if(w<16)c>>>=x,f-=x,r.lens[r.have++]=w;else{if(w===16){for(F=x+2;f<F;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if(c>>>=x,f-=x,r.have===0){e.msg="invalid bit length repeat",r.mode=Xr;break}O=r.lens[r.have-1],u=3+(c&3),c>>>=2,f-=2}else if(w===17){for(F=x+3;f<F;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}c>>>=x,f-=x,O=0,u=3+(c&7),c>>>=3,f-=3}else{for(F=x+7;f<F;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}c>>>=x,f-=x,O=0,u=11+(c&127),c>>>=7,f-=7}if(r.have+u>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Xr;break}for(;u--;)r.lens[r.have++]=O}}if(r.mode===Xr)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Xr;break}if(r.lenbits=9,W={bits:r.lenbits},j=Mh(j3,r.lens,0,r.nlen,r.lencode,0,r.work,W),r.lenbits=W.bits,j){e.msg="invalid literal/lengths set",r.mode=Xr;break}if(r.distbits=6,r.distcode=r.distdyn,W={bits:r.distbits},j=Mh(P3,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,W),r.distbits=W.bits,j){e.msg="invalid distances set",r.mode=Xr;break}if(r.mode=np,t===rp)break e;case np:r.mode=ip;case ip:if(o>=6&&a>=258){e.next_out=l,e.avail_out=a,e.next_in=s,e.avail_in=o,r.hold=c,r.bits=f,aD(e,d),l=e.next_out,i=e.output,a=e.avail_out,s=e.next_in,n=e.input,o=e.avail_in,c=r.hold,f=r.bits,r.mode===yo&&(r.back=-1);break}for(r.back=0;g=r.lencode[c&(1<<r.lenbits)-1],x=g>>>24,y=g>>>16&255,w=g&65535,!(x<=f);){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if(y&&!(y&240)){for(b=x,S=y,T=w;g=r.lencode[T+((c&(1<<b+S)-1)>>b)],x=g>>>24,y=g>>>16&255,w=g&65535,!(b+x<=f);){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}c>>>=b,f-=b,r.back+=b}if(c>>>=x,f-=x,r.back+=x,r.length=w,y===0){r.mode=H_;break}if(y&32){r.back=-1,r.mode=yo;break}if(y&64){e.msg="invalid literal/length code",r.mode=Xr;break}r.extra=y&15,r.mode=B_;case B_:if(r.extra){for(F=r.extra;f<F;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,f-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=U_;case U_:for(;g=r.distcode[c&(1<<r.distbits)-1],x=g>>>24,y=g>>>16&255,w=g&65535,!(x<=f);){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if(!(y&240)){for(b=x,S=y,T=w;g=r.distcode[T+((c&(1<<b+S)-1)>>b)],x=g>>>24,y=g>>>16&255,w=g&65535,!(b+x<=f);){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}c>>>=b,f-=b,r.back+=b}if(c>>>=x,f-=x,r.back+=x,y&64){e.msg="invalid distance code",r.mode=Xr;break}r.offset=w,r.extra=y&15,r.mode=z_;case z_:if(r.extra){for(F=r.extra;f<F;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,f-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Xr;break}r.mode=W_;case W_:if(a===0)break e;if(u=d-a,r.offset>u){if(u=r.offset-u,u>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Xr;break}u>r.wnext?(u-=r.wnext,p=r.wsize-u):p=r.wnext-u,u>r.length&&(u=r.length),m=r.window}else m=i,p=l-r.offset,u=r.length;u>a&&(u=a),a-=u,r.length-=u;do i[l++]=m[p++];while(--u);r.length===0&&(r.mode=ip);break;case H_:if(a===0)break e;i[l++]=r.length,a--,r.mode=ip;break;case I1:if(r.wrap){for(;f<32;){if(o===0)break e;o--,c|=n[s++]<<f,f+=8}if(d-=a,e.total_out+=d,r.total+=d,r.wrap&4&&d&&(e.adler=r.check=r.flags?Da(r.check,i,d,l-d):Ev(r.check,i,d,l-d)),d=a,r.wrap&4&&(r.flags?c:V_(c))!==r.check){e.msg="incorrect data check",r.mode=Xr;break}c=0,f=0}r.mode=$_;case $_:if(r.wrap&&r.flags){for(;f<32;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if(r.wrap&4&&c!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Xr;break}c=0,f=0}r.mode=q_;case q_:j=pD;break e;case Xr:j=F3;break e;case L3:return D3;case I3:default:return Qs}return e.next_out=l,e.avail_out=a,e.next_in=s,e.avail_in=o,r.hold=c,r.bits=f,(r.wsize||d!==e.avail_out&&r.mode<Xr&&(r.mode<I1||t!==k_))&&z3(e,e.output,e.next_out,d-e.avail_out),h-=e.avail_in,d-=e.avail_out,e.total_in+=h,e.total_out+=d,r.total+=d,r.wrap&4&&d&&(e.adler=r.check=r.flags?Da(r.check,i,d,e.next_out-d):Ev(r.check,i,d,e.next_out-d)),e.data_type=r.bits+(r.last?64:0)+(r.mode===yo?128:0)+(r.mode===np||r.mode===L1?256:0),(h===0&&d===0||t===k_)&&j===Lc&&(j=mD),j},CD=e=>{if(qc(e))return Qs;let t=e.state;return t.window&&(t.window=null),e.state=null,Lc},ED=(e,t)=>{if(qc(e))return Qs;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,Lc):Qs},TD=(e,t)=>{const r=t.length;let n,i,s;return qc(e)||(n=e.state,n.wrap!==0&&n.mode!==yg)?Qs:n.mode===yg&&(i=1,i=Ev(i,t,r,0),i!==n.check)?F3:(s=z3(e,t,r,r),s?(n.mode=L3,D3):(n.havedict=1,Lc))};var ND=R3,AD=B3,OD=M3,jD=_D,PD=U3,FD=SD,DD=CD,LD=ED,ID=TD,MD="pako inflate (from Nodeca project)",ko={inflateReset:ND,inflateReset2:AD,inflateResetKeep:OD,inflateInit:jD,inflateInit2:PD,inflate:FD,inflateEnd:DD,inflateGetHeader:LD,inflateSetDictionary:ID,inflateInfo:MD};function RD(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var BD=RD;const W3=Object.prototype.toString,{Z_NO_FLUSH:UD,Z_FINISH:zD,Z_OK:kd,Z_STREAM_END:B1,Z_NEED_DICT:U1,Z_STREAM_ERROR:WD,Z_DATA_ERROR:X_,Z_MEM_ERROR:HD}=N3;function Vd(e){this.options=A3.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new iD,this.strm.avail_out=0;let r=ko.inflateInit2(this.strm,t.windowBits);if(r!==kd)throw new Error(Tv[r]);if(this.header=new BD,ko.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Nv.string2buf(t.dictionary):W3.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=ko.inflateSetDictionary(this.strm,t.dictionary),r!==kd)))throw new Error(Tv[r])}Vd.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let s,l,o;if(this.ended)return!1;for(t===~~t?l=t:l=t===!0?zD:UD,W3.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),s=ko.inflate(r,l),s===U1&&i&&(s=ko.inflateSetDictionary(r,i),s===kd?s=ko.inflate(r,l):s===X_&&(s=U1));r.avail_in>0&&s===B1&&r.state.wrap>0&&e[r.next_in]!==0;)ko.inflateReset(r),s=ko.inflate(r,l);switch(s){case WD:case X_:case U1:case HD:return this.onEnd(s),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(r.avail_out===0||s===B1))if(this.options.to==="string"){let a=Nv.utf8border(r.output,r.next_out),c=r.next_out-a,f=Nv.buf2string(r.output,a);r.next_out=c,r.avail_out=n-c,c&&r.output.set(r.output.subarray(a,a+c),0),this.onData(f)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===kd&&o===0)){if(s===B1)return s=ko.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Vd.prototype.onData=function(e){this.chunks.push(e)};Vd.prototype.onEnd=function(e){e===kd&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=A3.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function $D(e,t){const r=new Vd(t);if(r.push(e),r.err)throw r.msg||Tv[r.err];return r.result}var qD=Vd,VD=$D,GD={Inflate:qD,inflate:VD};const{Inflate:XD,inflate:YD}=GD;var Y_=XD,KD=YD;const H3=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;H3[e]=t}const K_=4294967295;function JD(e,t,r){let n=e;for(let i=0;i<r;i++)n=H3[(n^t[i])&255]^n>>>8;return n}function QD(e,t){return(JD(K_,e,t)^K_)>>>0}function J_(e,t,r){const n=e.readUint32(),i=QD(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(i!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${i}`)}function $3(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function q3(e,t,r,n){let i=0;for(;i<n;i++)t[i]=e[i];for(;i<r;i++)t[i]=e[i]+t[i-n]&255}function V3(e,t,r,n){let i=0;if(r.length===0)for(;i<n;i++)t[i]=e[i];else for(;i<n;i++)t[i]=e[i]+r[i]&255}function G3(e,t,r,n,i){let s=0;if(r.length===0){for(;s<i;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+(t[s-i]>>1)&255}else{for(;s<i;s++)t[s]=e[s]+(r[s]>>1)&255;for(;s<n;s++)t[s]=e[s]+(t[s-i]+r[s]>>1)&255}}function X3(e,t,r,n,i){let s=0;if(r.length===0){for(;s<i;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+t[s-i]&255}else{for(;s<i;s++)t[s]=e[s]+r[s]&255;for(;s<n;s++)t[s]=e[s]+ZD(t[s-i],r[s],r[s-i])&255}}function ZD(e,t,r){const n=e+t-r,i=Math.abs(n-e),s=Math.abs(n-t),l=Math.abs(n-r);return i<=s&&i<=l?e:s<=l?t:r}function eL(e,t,r,n,i,s){switch(e){case 0:$3(t,r,i);break;case 1:q3(t,r,i,s);break;case 2:V3(t,r,n,i);break;case 3:G3(t,r,n,i,s);break;case 4:X3(t,r,n,i,s);break;default:throw new Error(`Unsupported filter: ${e}`)}}const tL=new Uint16Array([255]),rL=new Uint8Array(tL.buffer),nL=rL[0]===255;function iL(e){const{data:t,width:r,height:n,channels:i,depth:s}=e,l=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(s/8)*i,a=new Uint8Array(n*r*o);let c=0;for(let f=0;f<7;f++){const h=l[f],d=Math.ceil((r-h.x)/h.xStep),u=Math.ceil((n-h.y)/h.yStep);if(d<=0||u<=0)continue;const p=d*o,m=new Uint8Array(p);for(let g=0;g<u;g++){const x=t[c++],y=t.subarray(c,c+p);c+=p;const w=new Uint8Array(p);eL(x,y,w,m,p,o),m.set(w);for(let b=0;b<d;b++){const S=h.x+b*h.xStep,T=h.y+g*h.yStep;if(!(S>=r||T>=n))for(let O=0;O<o;O++)a[(T*r+S)*o+O]=w[b*o+O]}}}if(s===16){const f=new Uint16Array(a.buffer);if(nL)for(let h=0;h<f.length;h++)f[h]=sL(f[h]);return f}else return a}function sL(e){return(e&255)<<8|e>>8&255}const aL=new Uint16Array([255]),oL=new Uint8Array(aL.buffer),lL=oL[0]===255,cL=new Uint8Array(0);function Q_(e){const{data:t,width:r,height:n,channels:i,depth:s}=e,l=Math.ceil(s/8)*i,o=Math.ceil(s/8*i*r),a=new Uint8Array(n*o);let c=cL,f=0,h,d;for(let u=0;u<n;u++){switch(h=t.subarray(f+1,f+1+o),d=a.subarray(u*o,(u+1)*o),t[f]){case 0:$3(h,d,o);break;case 1:q3(h,d,o,l);break;case 2:V3(h,d,c,o);break;case 3:G3(h,d,c,o,l);break;case 4:X3(h,d,c,o,l);break;default:throw new Error(`Unsupported filter: ${t[f]}`)}c=d,f+=o+1}if(s===16){const u=new Uint16Array(a.buffer);if(lL)for(let p=0;p<u.length;p++)u[p]=uL(u[p]);return u}else return a}function uL(e){return(e&255)<<8|e>>8&255}const Lp=Uint8Array.of(137,80,78,71,13,10,26,10);function Z_(e){if(!fL(e.readBytes(Lp.length)))throw new Error("wrong PNG signature")}function fL(e){if(e.length<Lp.length)return!1;for(let t=0;t<Lp.length;t++)if(e[t]!==Lp[t])return!1;return!0}const hL="tEXt",dL=0,Y3=new TextDecoder("latin1");function pL(e){if(mL(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const gL=/^[\u0000-\u00FF]*$/;function mL(e){if(!gL.test(e))throw new Error("invalid latin1 text")}function xL(e,t,r){const n=K3(t);e[n]=vL(t,r-n.length-1)}function K3(e){for(e.mark();e.readByte()!==dL;);const t=e.offset;e.reset();const r=Y3.decode(e.readBytes(t-e.offset-1));return e.skip(1),pL(r),r}function vL(e,t){return Y3.decode(e.readBytes(t))}const gs={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},z1={UNKNOWN:-1,DEFLATE:0},e5={UNKNOWN:-1,ADAPTIVE:0},W1={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},sp={NONE:0,BACKGROUND:1,PREVIOUS:2},H1={SOURCE:0,OVER:1};class yL extends Z2{constructor(r,n={}){super(r);dt(this,"_checkCrc");dt(this,"_inflator");dt(this,"_png");dt(this,"_apng");dt(this,"_end");dt(this,"_hasPalette");dt(this,"_palette");dt(this,"_hasTransparency");dt(this,"_transparency");dt(this,"_compressionMethod");dt(this,"_filterMethod");dt(this,"_interlaceMethod");dt(this,"_colorType");dt(this,"_isAnimated");dt(this,"_numberOfFrames");dt(this,"_numberOfPlays");dt(this,"_frames");dt(this,"_writingDataChunks");const{checkCrc:i=!1}=n;this._checkCrc=i,this._inflator=new Y_,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=z1.UNKNOWN,this._filterMethod=e5.UNKNOWN,this._interlaceMethod=W1.UNKNOWN,this._colorType=gs.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Z_(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(Z_(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const i=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case hL:xL(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?J_(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const i=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=i+r;break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?J_(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=wL(this.readUint8());const n=this.readUint8();this._colorType=n;let i;switch(n){case gs.GREYSCALE:i=1;break;case gs.TRUECOLOUR:i=3;break;case gs.INDEXED_COLOUR:i=1;break;case gs.GREYSCALE_ALPHA:i=2;break;case gs.TRUECOLOUR_ALPHA:i=4;break;case gs.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==z1.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const i=[];this._palette=i;for(let s=0;s<n;s++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,i=this.offset+this.byteOffset;if(i+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case gs.GREYSCALE:case gs.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case gs.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const i=this.readByte();this._palette[n].push(i)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case gs.UNKNOWN:case gs.GREYSCALE_ALPHA:case gs.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=K3(this),i=this.readUint8();if(i!==z1.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const s=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:KD(s)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),i=this.readByte();this._png.resolution={x:r,y:n,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(r);if(i){if(i.data=Q_({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)n.data=i.data;else{const s=this._apng.frames.at(r-1);this.disposeFrame(i,s,n),this.addFrameDataToCanvas(n,i)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,i){switch(r.disposeOp){case sp.NONE:break;case sp.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let l=0;l<this._png.width;l++){const o=(s*r.width+l)*this._png.channels;for(let a=0;a<this._png.channels;a++)i.data[o+a]=0}break;case sp.PREVIOUS:i.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const i=1<<this._png.depth,s=(l,o)=>{const a=((l+n.yOffset)*this._png.width+n.xOffset+o)*this._png.channels,c=(l*n.width+o)*this._png.channels;return{index:a,frameIndex:c}};switch(n.blendOp){case H1.SOURCE:for(let l=0;l<n.height;l++)for(let o=0;o<n.width;o++){const{index:a,frameIndex:c}=s(l,o);for(let f=0;f<this._png.channels;f++)r.data[a+f]=n.data[c+f]}break;case H1.OVER:for(let l=0;l<n.height;l++)for(let o=0;o<n.width;o++){const{index:a,frameIndex:c}=s(l,o);for(let f=0;f<this._png.channels;f++){const h=n.data[c+this._png.channels-1]/i,d=f%(this._png.channels-1)===0?1:n.data[c+f],u=Math.floor(h*d+(1-h)*r.data[a+f]);r.data[a+f]+=u}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==e5.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===W1.NO_INTERLACE)this._png.data=Q_({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===W1.ADAM7)this._png.data=iL({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:sp.NONE,blendOp:H1.SOURCE,data:r}),this._inflator=new Y_,this._writingDataChunks=!1}}function wL(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var t5;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(t5||(t5={}));function bL(e,t){return new yL(e,t).decode()}var Xt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function $1(){Xt.console&&typeof Xt.console.log=="function"&&Xt.console.log.apply(Xt.console,arguments)}var Fr={log:$1,warn:function(e){Xt.console&&(typeof Xt.console.warn=="function"?Xt.console.warn.apply(Xt.console,arguments):$1.call(null,arguments))},error:function(e){Xt.console&&(typeof Xt.console.error=="function"?Xt.console.error.apply(Xt.console,arguments):$1(e))}};function q1(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){fc(n.response,t,r)},n.onerror=function(){Fr.error("could not download file")},n.send()}function r5(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function ap(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var fc=Xt.saveAs||((typeof window>"u"?"undefined":Er(window))!=="object"||window!==Xt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Xt.URL||Xt.webkitURL,i=document.createElement("a");t=t||e.name||"download",i.download=t,i.rel="noopener",typeof e=="string"?(i.href=e,i.origin!==location.origin?r5(i.href)?q1(e,t,r):ap(i,i.target="_blank"):ap(i)):(i.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){ap(i)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(r5(e))q1(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){ap(n)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:Er(s)!=="object"&&(Fr.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return q1(e,t,r);var i=e.type==="application/octet-stream",s=/constructor/i.test(Xt.HTMLElement)||Xt.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||i&&s)&&(typeof FileReader>"u"?"undefined":Er(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var f=o.result;f=l?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=f:location=f,n=null},o.readAsDataURL(e)}else{var a=Xt.URL||Xt.webkitURL,c=a.createObjectURL(e);n?n.location=c:location.href=c,n=null,setTimeout(function(){a.revokeObjectURL(c)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function J3(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,s=r[n].process,l=i.exec(e);l&&(t=s(l),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),a=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),a.length==1&&(a="0"+a),c.length==1&&(c="0"+c),"#"+o+a+c}}var Ip=Xt.atob.bind(Xt),n5=Xt.btoa.bind(Xt);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function V1(e,t){var r=e[0],n=e[1],i=e[2],s=e[3];r=_i(r,n,i,s,t[0],7,-680876936),s=_i(s,r,n,i,t[1],12,-389564586),i=_i(i,s,r,n,t[2],17,606105819),n=_i(n,i,s,r,t[3],22,-1044525330),r=_i(r,n,i,s,t[4],7,-176418897),s=_i(s,r,n,i,t[5],12,1200080426),i=_i(i,s,r,n,t[6],17,-1473231341),n=_i(n,i,s,r,t[7],22,-45705983),r=_i(r,n,i,s,t[8],7,1770035416),s=_i(s,r,n,i,t[9],12,-1958414417),i=_i(i,s,r,n,t[10],17,-42063),n=_i(n,i,s,r,t[11],22,-1990404162),r=_i(r,n,i,s,t[12],7,1804603682),s=_i(s,r,n,i,t[13],12,-40341101),i=_i(i,s,r,n,t[14],17,-1502002290),r=ki(r,n=_i(n,i,s,r,t[15],22,1236535329),i,s,t[1],5,-165796510),s=ki(s,r,n,i,t[6],9,-1069501632),i=ki(i,s,r,n,t[11],14,643717713),n=ki(n,i,s,r,t[0],20,-373897302),r=ki(r,n,i,s,t[5],5,-701558691),s=ki(s,r,n,i,t[10],9,38016083),i=ki(i,s,r,n,t[15],14,-660478335),n=ki(n,i,s,r,t[4],20,-405537848),r=ki(r,n,i,s,t[9],5,568446438),s=ki(s,r,n,i,t[14],9,-1019803690),i=ki(i,s,r,n,t[3],14,-187363961),n=ki(n,i,s,r,t[8],20,1163531501),r=ki(r,n,i,s,t[13],5,-1444681467),s=ki(s,r,n,i,t[2],9,-51403784),i=ki(i,s,r,n,t[7],14,1735328473),r=Si(r,n=ki(n,i,s,r,t[12],20,-1926607734),i,s,t[5],4,-378558),s=Si(s,r,n,i,t[8],11,-2022574463),i=Si(i,s,r,n,t[11],16,1839030562),n=Si(n,i,s,r,t[14],23,-35309556),r=Si(r,n,i,s,t[1],4,-1530992060),s=Si(s,r,n,i,t[4],11,1272893353),i=Si(i,s,r,n,t[7],16,-155497632),n=Si(n,i,s,r,t[10],23,-1094730640),r=Si(r,n,i,s,t[13],4,681279174),s=Si(s,r,n,i,t[0],11,-358537222),i=Si(i,s,r,n,t[3],16,-722521979),n=Si(n,i,s,r,t[6],23,76029189),r=Si(r,n,i,s,t[9],4,-640364487),s=Si(s,r,n,i,t[12],11,-421815835),i=Si(i,s,r,n,t[15],16,530742520),r=Ci(r,n=Si(n,i,s,r,t[2],23,-995338651),i,s,t[0],6,-198630844),s=Ci(s,r,n,i,t[7],10,1126891415),i=Ci(i,s,r,n,t[14],15,-1416354905),n=Ci(n,i,s,r,t[5],21,-57434055),r=Ci(r,n,i,s,t[12],6,1700485571),s=Ci(s,r,n,i,t[3],10,-1894986606),i=Ci(i,s,r,n,t[10],15,-1051523),n=Ci(n,i,s,r,t[1],21,-2054922799),r=Ci(r,n,i,s,t[8],6,1873313359),s=Ci(s,r,n,i,t[15],10,-30611744),i=Ci(i,s,r,n,t[6],15,-1560198380),n=Ci(n,i,s,r,t[13],21,1309151649),r=Ci(r,n,i,s,t[4],6,-145523070),s=Ci(s,r,n,i,t[11],10,-1120210379),i=Ci(i,s,r,n,t[2],15,718787259),n=Ci(n,i,s,r,t[9],21,-343485551),e[0]=yl(r,e[0]),e[1]=yl(n,e[1]),e[2]=yl(i,e[2]),e[3]=yl(s,e[3])}function im(e,t,r,n,i,s){return t=yl(yl(t,e),yl(n,s)),yl(t<<i|t>>>32-i,r)}function _i(e,t,r,n,i,s,l){return im(t&r|~t&n,e,t,i,s,l)}function ki(e,t,r,n,i,s,l){return im(t&n|r&~n,e,t,i,s,l)}function Si(e,t,r,n,i,s,l){return im(t^r^n,e,t,i,s,l)}function Ci(e,t,r,n,i,s,l){return im(r^(t|~n),e,t,i,s,l)}function Q3(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)V1(n,_L(e.substring(t-64,t)));e=e.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(V1(n,i),t=0;t<16;t++)i[t]=0;return i[14]=8*r,V1(n,i),n}function _L(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var i5="0123456789abcdef".split("");function kL(e){for(var t="",r=0;r<4;r++)t+=i5[e>>8*r+4&15]+i5[e>>8*r&15];return t}function SL(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Av(e){return Q3(e).map(SL).join("")}var CL=function(e){for(var t=0;t<e.length;t++)e[t]=kL(e[t]);return e.join("")}(Q3("hello"))!="5d41402abc4b2a76b9719d911017c592";function yl(e,t){if(CL){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Ov(e,t){var r,n,i,s;if(e!==r){for(var l=(i=e,s=1+(256/e.length|0),new Array(s+1).join(i)),o=[],a=0;a<256;a++)o[a]=a;var c=0;for(a=0;a<256;a++){var f=o[a];c=(c+f+l.charCodeAt(a))%256,o[a]=o[c],o[c]=f}r=e,n=o}else o=n;var h=t.length,d=0,u=0,p="";for(a=0;a<h;a++)u=(u+(f=o[d=(d+1)%256]))%256,o[d]=o[u],o[u]=f,l=o[(o[d]+o[u])%256],p+=String.fromCharCode(t.charCodeAt(a)^l);return p}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var s5={print:4,modify:8,copy:16,"annot-forms":32};function Nu(e,t,r,n){this.v=1,this.r=2;var i=192;e.forEach(function(o){if(s5.perm!==void 0)throw new Error("Invalid permission: "+o);i+=s5[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(t+this.padding).substr(0,32),l=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,l),this.P=-(1+(255^i)),this.encryptionKey=Av(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Ov(this.encryptionKey,this.padding)}function Au(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var i=e.charCodeAt(n);t+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):e[n]}return t}function a5(e){if(Er(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var s=Math.random().toString(35);return t[r][s]=[n,!!i],s},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var s in t[r]){var l=t[r][s];try{l[0].apply(e,n)}catch(o){Xt.console&&Fr.error("jsPDF PubSub Error",o.message,o)}l[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function wg(e){if(!(this instanceof wg))return new wg(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function Z3(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function gc(e,t,r,n,i){if(!(this instanceof gc))return new gc(e,t,r,n,i);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,Z3.call(this,n,i)}function $u(e,t,r,n,i){if(!(this instanceof $u))return new $u(e,t,r,n,i);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,Z3.call(this,n,i)}function Mt(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],s=arguments[3],l=[],o=1,a=16,c="S",f=null;Er(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,i=e.format||i,s=e.compress||e.compressPdf||s,(f=e.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(a=e.floatPrecision),c=e.defaultPathOperation||"S"),l=e.filters||(s===!0?["FlateEncode"]:l),n=n||"mm",r=(""+(r||"P")).toLowerCase();var h=e.putOnlyUsedFonts||!1,d={},u={internal:{},__private__:{}};u.__private__.PubSub=a5;var p="1.3",m=u.__private__.getPdfVersion=function(){return p};u.__private__.setPdfVersion=function(D){p=D};var g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};u.__private__.getPageFormats=function(){return g};var x=u.__private__.getPageFormat=function(D){return g[D]};i=i||"a4";var y="compat",w="advanced",b=y;function S(){this.saveGraphicsState(),z(new Et(Oe,0,0,-Oe,0,Kl()*Oe).toString()+" cm"),this.setFontSize(this.getFontSize()/Oe),c="n",b=w}function T(){this.restoreGraphicsState(),c="S",b=y}var O=u.__private__.combineFontStyleAndFontWeight=function(D,ne){if(D=="bold"&&ne=="normal"||D=="bold"&&ne==400||D=="normal"&&ne=="italic"||D=="bold"&&ne=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ne&&(D=ne==400||ne==="normal"?D==="italic"?"italic":"normal":ne!=700&&ne!=="bold"||D!=="normal"?(ne==700?"bold":ne)+""+D:"bold"),D};u.advancedAPI=function(D){var ne=b===y;return ne&&S.call(this),typeof D!="function"||(D(this),ne&&T.call(this)),this},u.compatAPI=function(D){var ne=b===w;return ne&&T.call(this),typeof D!="function"||(D(this),ne&&S.call(this)),this},u.isAdvancedAPI=function(){return b===w};var j,L=function(D){if(b!==w)throw new Error(D+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},W=u.roundToPrecision=u.__private__.roundToPrecision=function(D,ne){var Ce=t||ne;if(isNaN(D)||isNaN(Ce))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return D.toFixed(Ce).replace(/0+$/,"")};j=u.hpf=u.__private__.hpf=typeof a=="number"?function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.hpf");return W(D,a)}:a==="smart"?function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.hpf");return W(D,D>-1&&D<1?16:5)}:function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.hpf");return W(D,16)};var F=u.f2=u.__private__.f2=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.f2");return W(D,2)},M=u.__private__.f3=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.f3");return W(D,3)},V=u.scale=u.__private__.scale=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.scale");return b===y?D*Oe:b===w?D:void 0},G=function(D){return V(function(ne){return b===y?Kl()-ne:b===w?ne:void 0}(D))};u.__private__.setPrecision=u.setPrecision=function(D){typeof parseInt(D,10)=="number"&&(t=parseInt(D,10))};var te,ee="00000000000000000000000000000000",Q=u.__private__.getFileId=function(){return ee},K=u.__private__.setFileId=function(D){return ee=D!==void 0&&/^[a-fA-F0-9]{32}$/.test(D)?D.toUpperCase():ee.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(Un=new Nu(f.userPermissions,f.userPassword,f.ownerPassword,ee)),ee};u.setFileId=function(D){return K(D),this},u.getFileId=function(){return Q()};var N=u.__private__.convertDateToPDFDate=function(D){var ne=D.getTimezoneOffset(),Ce=ne<0?"+":"-",Pe=Math.floor(Math.abs(ne/60)),Re=Math.abs(ne%60),st=[Ce,A(Pe),"'",A(Re),"'"].join("");return["D:",D.getFullYear(),A(D.getMonth()+1),A(D.getDate()),A(D.getHours()),A(D.getMinutes()),A(D.getSeconds()),st].join("")},U=u.__private__.convertPDFDateToDate=function(D){var ne=parseInt(D.substr(2,4),10),Ce=parseInt(D.substr(6,2),10)-1,Pe=parseInt(D.substr(8,2),10),Re=parseInt(D.substr(10,2),10),st=parseInt(D.substr(12,2),10),ct=parseInt(D.substr(14,2),10);return new Date(ne,Ce,Pe,Re,st,ct,0)},R=u.__private__.setCreationDate=function(D){var ne;if(D===void 0&&(D=new Date),D instanceof Date)ne=N(D);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(D))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ne=D}return te=ne},k=u.__private__.getCreationDate=function(D){var ne=te;return D==="jsDate"&&(ne=U(te)),ne};u.setCreationDate=function(D){return R(D),this},u.getCreationDate=function(D){return k(D)};var P,A=u.__private__.padd2=function(D){return("0"+parseInt(D)).slice(-2)},E=u.__private__.padd2Hex=function(D){return("00"+(D=D.toString())).substr(D.length)},I=0,H=[],J=[],Y=0,Z=[],fe=[],X=!1,re=J;u.__private__.setCustomOutputDestination=function(D){X=!0,re=D};var se=function(D){X||(re=D)};u.__private__.resetCustomOutputDestination=function(){X=!1,re=J};var z=u.__private__.out=function(D){return D=D.toString(),Y+=D.length+1,re.push(D),re},oe=u.__private__.write=function(D){return z(arguments.length===1?D.toString():Array.prototype.join.call(arguments," "))},ce=u.__private__.getArrayBuffer=function(D){for(var ne=D.length,Ce=new ArrayBuffer(ne),Pe=new Uint8Array(Ce);ne--;)Pe[ne]=D.charCodeAt(ne);return Ce},we=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];u.__private__.getStandardFonts=function(){return we};var ye=e.fontSize||16;u.__private__.setFontSize=u.setFontSize=function(D){return ye=b===w?D/Oe:D,this};var de,Te=u.__private__.getFontSize=u.getFontSize=function(){return b===y?ye:ye*Oe},pe=e.R2L||!1;u.__private__.setR2L=u.setR2L=function(D){return pe=D,this},u.__private__.getR2L=u.getR2L=function(){return pe};var Ae,Ie=u.__private__.setZoomMode=function(D){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(D))de=D;else if(isNaN(D)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(D)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+D+'" is not recognized.');de=D}else de=parseInt(D,10)};u.__private__.getZoomMode=function(){return de};var je,Le=u.__private__.setPageMode=function(D){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(D)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+D+'" is not recognized.');Ae=D};u.__private__.getPageMode=function(){return Ae};var Xe=u.__private__.setLayoutMode=function(D){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(D)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+D+'" is not recognized.');je=D};u.__private__.getLayoutMode=function(){return je},u.__private__.setDisplayMode=u.setDisplayMode=function(D,ne,Ce){return Ie(D),Xe(ne),Le(Ce),this};var Je={title:"",subject:"",author:"",keywords:"",creator:""};u.__private__.getDocumentProperty=function(D){if(Object.keys(Je).indexOf(D)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Je[D]},u.__private__.getDocumentProperties=function(){return Je},u.__private__.setDocumentProperties=u.setProperties=u.setDocumentProperties=function(D){for(var ne in Je)Je.hasOwnProperty(ne)&&D[ne]&&(Je[ne]=D[ne]);return this},u.__private__.setDocumentProperty=function(D,ne){if(Object.keys(Je).indexOf(D)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Je[D]=ne};var Ne,Oe,De,Ye,it,Ke={},et={},Ge=[],ot={},_t={},yt={},St={},Bt=null,qt=0,Ct=[],sr=new a5(u),Xi=e.hotfixes||[],Dr={},ii={},Ii=[],Et=function D(ne,Ce,Pe,Re,st,ct){if(!(this instanceof D))return new D(ne,Ce,Pe,Re,st,ct);isNaN(ne)&&(ne=1),isNaN(Ce)&&(Ce=0),isNaN(Pe)&&(Pe=0),isNaN(Re)&&(Re=1),isNaN(st)&&(st=0),isNaN(ct)&&(ct=0),this._matrix=[ne,Ce,Pe,Re,st,ct]};Object.defineProperty(Et.prototype,"sx",{get:function(){return this._matrix[0]},set:function(D){this._matrix[0]=D}}),Object.defineProperty(Et.prototype,"shy",{get:function(){return this._matrix[1]},set:function(D){this._matrix[1]=D}}),Object.defineProperty(Et.prototype,"shx",{get:function(){return this._matrix[2]},set:function(D){this._matrix[2]=D}}),Object.defineProperty(Et.prototype,"sy",{get:function(){return this._matrix[3]},set:function(D){this._matrix[3]=D}}),Object.defineProperty(Et.prototype,"tx",{get:function(){return this._matrix[4]},set:function(D){this._matrix[4]=D}}),Object.defineProperty(Et.prototype,"ty",{get:function(){return this._matrix[5]},set:function(D){this._matrix[5]=D}}),Object.defineProperty(Et.prototype,"a",{get:function(){return this._matrix[0]},set:function(D){this._matrix[0]=D}}),Object.defineProperty(Et.prototype,"b",{get:function(){return this._matrix[1]},set:function(D){this._matrix[1]=D}}),Object.defineProperty(Et.prototype,"c",{get:function(){return this._matrix[2]},set:function(D){this._matrix[2]=D}}),Object.defineProperty(Et.prototype,"d",{get:function(){return this._matrix[3]},set:function(D){this._matrix[3]=D}}),Object.defineProperty(Et.prototype,"e",{get:function(){return this._matrix[4]},set:function(D){this._matrix[4]=D}}),Object.defineProperty(Et.prototype,"f",{get:function(){return this._matrix[5]},set:function(D){this._matrix[5]=D}}),Object.defineProperty(Et.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Et.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Et.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Et.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Et.prototype.join=function(D){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(j).join(D)},Et.prototype.multiply=function(D){var ne=D.sx*this.sx+D.shy*this.shx,Ce=D.sx*this.shy+D.shy*this.sy,Pe=D.shx*this.sx+D.sy*this.shx,Re=D.shx*this.shy+D.sy*this.sy,st=D.tx*this.sx+D.ty*this.shx+this.tx,ct=D.tx*this.shy+D.ty*this.sy+this.ty;return new Et(ne,Ce,Pe,Re,st,ct)},Et.prototype.decompose=function(){var D=this.sx,ne=this.shy,Ce=this.shx,Pe=this.sy,Re=this.tx,st=this.ty,ct=Math.sqrt(D*D+ne*ne),Ot=(D/=ct)*Ce+(ne/=ct)*Pe;Ce-=D*Ot,Pe-=ne*Ot;var Ft=Math.sqrt(Ce*Ce+Pe*Pe);return Ot/=Ft,D*(Pe/=Ft)<ne*(Ce/=Ft)&&(D=-D,ne=-ne,Ot=-Ot,ct=-ct),{scale:new Et(ct,0,0,Ft,0,0),translate:new Et(1,0,0,1,Re,st),rotate:new Et(D,ne,-ne,D,0,0),skew:new Et(1,0,Ot,1,0,0)}},Et.prototype.toString=function(D){return this.join(" ")},Et.prototype.inversed=function(){var D=this.sx,ne=this.shy,Ce=this.shx,Pe=this.sy,Re=this.tx,st=this.ty,ct=1/(D*Pe-ne*Ce),Ot=Pe*ct,Ft=-ne*ct,Yt=-Ce*ct,er=D*ct;return new Et(Ot,Ft,Yt,er,-Ot*Re-Yt*st,-Ft*Re-er*st)},Et.prototype.applyToPoint=function(D){var ne=D.x*this.sx+D.y*this.shx+this.tx,Ce=D.x*this.shy+D.y*this.sy+this.ty;return new ao(ne,Ce)},Et.prototype.applyToRectangle=function(D){var ne=this.applyToPoint(D),Ce=this.applyToPoint(new ao(D.x+D.w,D.y+D.h));return new Rf(ne.x,ne.y,Ce.x-ne.x,Ce.y-ne.y)},Et.prototype.clone=function(){var D=this.sx,ne=this.shy,Ce=this.shx,Pe=this.sy,Re=this.tx,st=this.ty;return new Et(D,ne,Ce,Pe,Re,st)},u.Matrix=Et;var Jn=u.matrixMult=function(D,ne){return ne.multiply(D)},ta=new Et(1,0,0,1,0,0);u.unitMatrix=u.identityMatrix=ta;var vi=function(D,ne){if(!_t[D]){var Ce=(ne instanceof gc?"Sh":"P")+(Object.keys(ot).length+1).toString(10);ne.id=Ce,_t[D]=Ce,ot[Ce]=ne,sr.publish("addPattern",ne)}};u.ShadingPattern=gc,u.TilingPattern=$u,u.addShadingPattern=function(D,ne){return L("addShadingPattern()"),vi(D,ne),this},u.beginTilingPattern=function(D){L("beginTilingPattern()"),Bf(D.boundingBox[0],D.boundingBox[1],D.boundingBox[2]-D.boundingBox[0],D.boundingBox[3]-D.boundingBox[1],D.matrix)},u.endTilingPattern=function(D,ne){L("endTilingPattern()"),ne.stream=fe[P].join(`
`),vi(D,ne),sr.publish("endTilingPattern",ne),Ii.pop().restore()};var Yi,Gr=u.__private__.newObject=function(){var D=An();return ae(D,!0),D},An=u.__private__.newObjectDeferred=function(){return I++,H[I]=function(){return Y},I},ae=function(D,ne){return ne=typeof ne=="boolean"&&ne,H[D]=Y,ne&&z(D+" 0 obj"),D},ke=u.__private__.newAdditionalObject=function(){var D={objId:An(),content:""};return Z.push(D),D},ge=An(),ve=An(),Se=u.__private__.decodeColorString=function(D){var ne=D.split(" ");if(ne.length!==2||ne[1]!=="g"&&ne[1]!=="G")ne.length!==5||ne[4]!=="k"&&ne[4]!=="K"||(ne=[(1-ne[0])*(1-ne[3]),(1-ne[1])*(1-ne[3]),(1-ne[2])*(1-ne[3]),"r"]);else{var Ce=parseFloat(ne[0]);ne=[Ce,Ce,Ce,"r"]}for(var Pe="#",Re=0;Re<3;Re++)Pe+=("0"+Math.floor(255*parseFloat(ne[Re])).toString(16)).slice(-2);return Pe},Ee=u.__private__.encodeColorString=function(D){var ne;typeof D=="string"&&(D={ch1:D});var Ce=D.ch1,Pe=D.ch2,Re=D.ch3,st=D.ch4,ct=D.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ce=="string"&&Ce.charAt(0)!=="#"){var Ot=new J3(Ce);if(Ot.ok)Ce=Ot.toHex();else if(!/^\d*\.?\d*$/.test(Ce))throw new Error('Invalid color "'+Ce+'" passed to jsPDF.encodeColorString.')}if(typeof Ce=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ce)&&(Ce="#"+Ce[1]+Ce[1]+Ce[2]+Ce[2]+Ce[3]+Ce[3]),typeof Ce=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ce)){var Ft=parseInt(Ce.substr(1),16);Ce=Ft>>16&255,Pe=Ft>>8&255,Re=255&Ft}if(Pe===void 0||st===void 0&&Ce===Pe&&Pe===Re)ne=typeof Ce=="string"?Ce+" "+ct[0]:D.precision===2?F(Ce/255)+" "+ct[0]:M(Ce/255)+" "+ct[0];else if(st===void 0||Er(st)==="object"){if(st&&!isNaN(st.a)&&st.a===0)return["1.","1.","1.",ct[1]].join(" ");ne=typeof Ce=="string"?[Ce,Pe,Re,ct[1]].join(" "):D.precision===2?[F(Ce/255),F(Pe/255),F(Re/255),ct[1]].join(" "):[M(Ce/255),M(Pe/255),M(Re/255),ct[1]].join(" ")}else ne=typeof Ce=="string"?[Ce,Pe,Re,st,ct[2]].join(" "):D.precision===2?[F(Ce),F(Pe),F(Re),F(st),ct[2]].join(" "):[M(Ce),M(Pe),M(Re),M(st),ct[2]].join(" ");return ne},Ue=u.__private__.getFilters=function(){return l},Qe=u.__private__.putStream=function(D){var ne=(D=D||{}).data||"",Ce=D.filters||Ue(),Pe=D.alreadyAppliedFilters||[],Re=D.addLength1||!1,st=ne.length,ct=D.objectId,Ot=function(zn){return zn};if(f!==null&&ct===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(Ot=Un.encryptor(ct,0));var Ft={};Ce===!0&&(Ce=["FlateEncode"]);var Yt=D.additionalKeyValues||[],er=(Ft=Mt.API.processDataByFilters!==void 0?Mt.API.processDataByFilters(ne,Ce):{data:ne,reverseChain:[]}).reverseChain+(Array.isArray(Pe)?Pe.join(" "):Pe.toString());if(Ft.data.length!==0&&(Yt.push({key:"Length",value:Ft.data.length}),Re===!0&&Yt.push({key:"Length1",value:st})),er.length!=0)if(er.split("/").length-1==1)Yt.push({key:"Filter",value:er});else{Yt.push({key:"Filter",value:"["+er+"]"});for(var hr=0;hr<Yt.length;hr+=1)if(Yt[hr].key==="DecodeParms"){for(var Jr=[],Pn=0;Pn<Ft.reverseChain.split("/").length-1;Pn+=1)Jr.push("null");Jr.push(Yt[hr].value),Yt[hr].value="["+Jr.join(" ")+"]"}}z("<<");for(var Lr=0;Lr<Yt.length;Lr++)z("/"+Yt[Lr].key+" "+Yt[Lr].value);z(">>"),Ft.data.length!==0&&(z("stream"),z(Ot(Ft.data)),z("endstream"))},ze=u.__private__.putPage=function(D){var ne=D.number,Ce=D.data,Pe=D.objId,Re=D.contentsObjId;ae(Pe,!0),z("<</Type /Page"),z("/Parent "+D.rootDictionaryObjId+" 0 R"),z("/Resources "+D.resourceDictionaryObjId+" 0 R"),z("/MediaBox ["+parseFloat(j(D.mediaBox.bottomLeftX))+" "+parseFloat(j(D.mediaBox.bottomLeftY))+" "+j(D.mediaBox.topRightX)+" "+j(D.mediaBox.topRightY)+"]"),D.cropBox!==null&&z("/CropBox ["+j(D.cropBox.bottomLeftX)+" "+j(D.cropBox.bottomLeftY)+" "+j(D.cropBox.topRightX)+" "+j(D.cropBox.topRightY)+"]"),D.bleedBox!==null&&z("/BleedBox ["+j(D.bleedBox.bottomLeftX)+" "+j(D.bleedBox.bottomLeftY)+" "+j(D.bleedBox.topRightX)+" "+j(D.bleedBox.topRightY)+"]"),D.trimBox!==null&&z("/TrimBox ["+j(D.trimBox.bottomLeftX)+" "+j(D.trimBox.bottomLeftY)+" "+j(D.trimBox.topRightX)+" "+j(D.trimBox.topRightY)+"]"),D.artBox!==null&&z("/ArtBox ["+j(D.artBox.bottomLeftX)+" "+j(D.artBox.bottomLeftY)+" "+j(D.artBox.topRightX)+" "+j(D.artBox.topRightY)+"]"),typeof D.userUnit=="number"&&D.userUnit!==1&&z("/UserUnit "+D.userUnit),sr.publish("putPage",{objId:Pe,pageContext:Ct[ne],pageNumber:ne,page:Ce}),z("/Contents "+Re+" 0 R"),z(">>"),z("endobj");var st=Ce.join(`
`);return b===w&&(st+=`
Q`),ae(Re,!0),Qe({data:st,filters:Ue(),objectId:Re}),z("endobj"),Pe},We=u.__private__.putPages=function(){var D,ne,Ce=[];for(D=1;D<=qt;D++)Ct[D].objId=An(),Ct[D].contentsObjId=An();for(D=1;D<=qt;D++)Ce.push(ze({number:D,data:fe[D],objId:Ct[D].objId,contentsObjId:Ct[D].contentsObjId,mediaBox:Ct[D].mediaBox,cropBox:Ct[D].cropBox,bleedBox:Ct[D].bleedBox,trimBox:Ct[D].trimBox,artBox:Ct[D].artBox,userUnit:Ct[D].userUnit,rootDictionaryObjId:ge,resourceDictionaryObjId:ve}));ae(ge,!0),z("<</Type /Pages");var Pe="/Kids [";for(ne=0;ne<qt;ne++)Pe+=Ce[ne]+" 0 R ";z(Pe+"]"),z("/Count "+qt),z(">>"),z("endobj"),sr.publish("postPutPages")},Ve=function(D){sr.publish("putFont",{font:D,out:z,newObject:Gr,putStream:Qe}),D.isAlreadyPutted!==!0&&(D.objectNumber=Gr(),z("<<"),z("/Type /Font"),z("/BaseFont /"+Au(D.postScriptName)),z("/Subtype /Type1"),typeof D.encoding=="string"&&z("/Encoding /"+D.encoding),z("/FirstChar 32"),z("/LastChar 255"),z(">>"),z("endobj"))},ft=function(D){D.objectNumber=Gr();var ne=[];ne.push({key:"Type",value:"/XObject"}),ne.push({key:"Subtype",value:"/Form"}),ne.push({key:"BBox",value:"["+[j(D.x),j(D.y),j(D.x+D.width),j(D.y+D.height)].join(" ")+"]"}),ne.push({key:"Matrix",value:"["+D.matrix.toString()+"]"});var Ce=D.pages[1].join(`
`);Qe({data:Ce,additionalKeyValues:ne,objectId:D.objectNumber}),z("endobj")},mt=function(D,ne){ne||(ne=21);var Ce=Gr(),Pe=function(ct,Ot){var Ft,Yt=[],er=1/(Ot-1);for(Ft=0;Ft<1;Ft+=er)Yt.push(Ft);if(Yt.push(1),ct[0].offset!=0){var hr={offset:0,color:ct[0].color};ct.unshift(hr)}if(ct[ct.length-1].offset!=1){var Jr={offset:1,color:ct[ct.length-1].color};ct.push(Jr)}for(var Pn="",Lr=0,zn=0;zn<Yt.length;zn++){for(Ft=Yt[zn];Ft>ct[Lr+1].offset;)Lr++;var Fn=ct[Lr].offset,si=(Ft-Fn)/(ct[Lr+1].offset-Fn),co=ct[Lr].color,ia=ct[Lr+1].color;Pn+=E(Math.round((1-si)*co[0]+si*ia[0]).toString(16))+E(Math.round((1-si)*co[1]+si*ia[1]).toString(16))+E(Math.round((1-si)*co[2]+si*ia[2]).toString(16))}return Pn.trim()}(D.colors,ne),Re=[];Re.push({key:"FunctionType",value:"0"}),Re.push({key:"Domain",value:"[0.0 1.0]"}),Re.push({key:"Size",value:"["+ne+"]"}),Re.push({key:"BitsPerSample",value:"8"}),Re.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Re.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Qe({data:Pe,additionalKeyValues:Re,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ce}),z("endobj"),D.objectNumber=Gr(),z("<< /ShadingType "+D.type),z("/ColorSpace /DeviceRGB");var st="/Coords ["+j(parseFloat(D.coords[0]))+" "+j(parseFloat(D.coords[1]))+" ";D.type===2?st+=j(parseFloat(D.coords[2]))+" "+j(parseFloat(D.coords[3])):st+=j(parseFloat(D.coords[2]))+" "+j(parseFloat(D.coords[3]))+" "+j(parseFloat(D.coords[4]))+" "+j(parseFloat(D.coords[5])),z(st+="]"),D.matrix&&z("/Matrix ["+D.matrix.toString()+"]"),z("/Function "+Ce+" 0 R"),z("/Extend [true true]"),z(">>"),z("endobj")},kt=function(D,ne){var Ce=An(),Pe=Gr();ne.push({resourcesOid:Ce,objectOid:Pe}),D.objectNumber=Pe;var Re=[];Re.push({key:"Type",value:"/Pattern"}),Re.push({key:"PatternType",value:"1"}),Re.push({key:"PaintType",value:"1"}),Re.push({key:"TilingType",value:"1"}),Re.push({key:"BBox",value:"["+D.boundingBox.map(j).join(" ")+"]"}),Re.push({key:"XStep",value:j(D.xStep)}),Re.push({key:"YStep",value:j(D.yStep)}),Re.push({key:"Resources",value:Ce+" 0 R"}),D.matrix&&Re.push({key:"Matrix",value:"["+D.matrix.toString()+"]"}),Qe({data:D.stream,additionalKeyValues:Re,objectId:D.objectNumber}),z("endobj")},gt=function(D){for(var ne in D.objectNumber=Gr(),z("<<"),D)switch(ne){case"opacity":z("/ca "+F(D[ne]));break;case"stroke-opacity":z("/CA "+F(D[ne]))}z(">>"),z("endobj")},bt=function(D){ae(D.resourcesOid,!0),z("<<"),z("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var ne in z("/Font <<"),Ke)Ke.hasOwnProperty(ne)&&(h===!1||h===!0&&d.hasOwnProperty(ne))&&z("/"+ne+" "+Ke[ne].objectNumber+" 0 R");z(">>")}(),function(){if(Object.keys(ot).length>0){for(var ne in z("/Shading <<"),ot)ot.hasOwnProperty(ne)&&ot[ne]instanceof gc&&ot[ne].objectNumber>=0&&z("/"+ne+" "+ot[ne].objectNumber+" 0 R");sr.publish("putShadingPatternDict"),z(">>")}}(),function(ne){if(Object.keys(ot).length>0){for(var Ce in z("/Pattern <<"),ot)ot.hasOwnProperty(Ce)&&ot[Ce]instanceof u.TilingPattern&&ot[Ce].objectNumber>=0&&ot[Ce].objectNumber<ne&&z("/"+Ce+" "+ot[Ce].objectNumber+" 0 R");sr.publish("putTilingPatternDict"),z(">>")}}(D.objectOid),function(){if(Object.keys(yt).length>0){var ne;for(ne in z("/ExtGState <<"),yt)yt.hasOwnProperty(ne)&&yt[ne].objectNumber>=0&&z("/"+ne+" "+yt[ne].objectNumber+" 0 R");sr.publish("putGStateDict"),z(">>")}}(),function(){for(var ne in z("/XObject <<"),Dr)Dr.hasOwnProperty(ne)&&Dr[ne].objectNumber>=0&&z("/"+ne+" "+Dr[ne].objectNumber+" 0 R");sr.publish("putXobjectDict"),z(">>")}(),z(">>"),z("endobj")},Vt=function(D){et[D.fontName]=et[D.fontName]||{},et[D.fontName][D.fontStyle]=D.id},Ar=function(D,ne,Ce,Pe,Re){var st={id:"F"+(Object.keys(Ke).length+1).toString(10),postScriptName:D,fontName:ne,fontStyle:Ce,encoding:Pe,isStandardFont:Re||!1,metadata:{}};return sr.publish("addFont",{font:st,instance:this}),Ke[st.id]=st,Vt(st),st.id},cr=u.__private__.pdfEscape=u.pdfEscape=function(D,ne){return function(Ce,Pe){var Re,st,ct,Ot,Ft,Yt,er,hr,Jr;if(ct=(Pe=Pe||{}).sourceEncoding||"Unicode",Ft=Pe.outputEncoding,(Pe.autoencode||Ft)&&Ke[Ne].metadata&&Ke[Ne].metadata[ct]&&Ke[Ne].metadata[ct].encoding&&(Ot=Ke[Ne].metadata[ct].encoding,!Ft&&Ke[Ne].encoding&&(Ft=Ke[Ne].encoding),!Ft&&Ot.codePages&&(Ft=Ot.codePages[0]),typeof Ft=="string"&&(Ft=Ot[Ft]),Ft)){for(er=!1,Yt=[],Re=0,st=Ce.length;Re<st;Re++)(hr=Ft[Ce.charCodeAt(Re)])?Yt.push(String.fromCharCode(hr)):Yt.push(Ce[Re]),Yt[Re].charCodeAt(0)>>8&&(er=!0);Ce=Yt.join("")}for(Re=Ce.length;er===void 0&&Re!==0;)Ce.charCodeAt(Re-1)>>8&&(er=!0),Re--;if(!er)return Ce;for(Yt=Pe.noBOM?[]:[254,255],Re=0,st=Ce.length;Re<st;Re++){if((Jr=(hr=Ce.charCodeAt(Re))>>8)>>8)throw new Error("Character at position "+Re+" of string '"+Ce+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Yt.push(Jr),Yt.push(hr-(Jr<<8))}return String.fromCharCode.apply(void 0,Yt)}(D,ne).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},sn=u.__private__.beginPage=function(D){fe[++qt]=[],Ct[qt]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(D[0]),topRightY:Number(D[1])}},Ta(qt),se(fe[P])},Ea=function(D,ne){var Ce,Pe,Re;switch(r=ne||r,typeof D=="string"&&(Ce=x(D.toLowerCase()),Array.isArray(Ce)&&(Pe=Ce[0],Re=Ce[1])),Array.isArray(D)&&(Pe=D[0]*Oe,Re=D[1]*Oe),isNaN(Pe)&&(Pe=i[0],Re=i[1]),(Pe>14400||Re>14400)&&(Fr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Pe=Math.min(14400,Pe),Re=Math.min(14400,Re)),i=[Pe,Re],r.substr(0,1)){case"l":Re>Pe&&(i=[Re,Pe]);break;case"p":Pe>Re&&(i=[Re,Pe])}sn(i),Kt(Df),z(iu),If!==0&&z(If+" J"),Mf!==0&&z(Mf+" j"),sr.publish("addPage",{pageNumber:qt})},ra=function(D){D>0&&D<=qt&&(fe.splice(D,1),Ct.splice(D,1),qt--,P>qt&&(P=qt),this.setPage(P))},Ta=function(D){D>0&&D<=qt&&(P=D)},Fs=u.__private__.getNumberOfPages=u.getNumberOfPages=function(){return fe.length-1},$o=function(D,ne,Ce){var Pe,Re=void 0;return Ce=Ce||{},D=D!==void 0?D:Ke[Ne].fontName,ne=ne!==void 0?ne:Ke[Ne].fontStyle,Pe=D.toLowerCase(),et[Pe]!==void 0&&et[Pe][ne]!==void 0?Re=et[Pe][ne]:et[D]!==void 0&&et[D][ne]!==void 0?Re=et[D][ne]:Ce.disableWarning===!1&&Fr.warn("Unable to look up font label for font '"+D+"', '"+ne+"'. Refer to getFontList() for available fonts."),Re||Ce.noFallback||(Re=et.times[ne])==null&&(Re=et.times.normal),Re},On=u.__private__.putInfo=function(){var D=Gr(),ne=function(Pe){return Pe};for(var Ce in f!==null&&(ne=Un.encryptor(D,0)),z("<<"),z("/Producer ("+cr(ne("jsPDF "+Mt.version))+")"),Je)Je.hasOwnProperty(Ce)&&Je[Ce]&&z("/"+Ce.substr(0,1).toUpperCase()+Ce.substr(1)+" ("+cr(ne(Je[Ce]))+")");z("/CreationDate ("+cr(ne(te))+")"),z(">>"),z("endobj")},tu=u.__private__.putCatalog=function(D){var ne=(D=D||{}).rootDictionaryObjId||ge;switch(Gr(),z("<<"),z("/Type /Catalog"),z("/Pages "+ne+" 0 R"),de||(de="fullwidth"),de){case"fullwidth":z("/OpenAction [3 0 R /FitH null]");break;case"fullheight":z("/OpenAction [3 0 R /FitV null]");break;case"fullpage":z("/OpenAction [3 0 R /Fit]");break;case"original":z("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ce=""+de;Ce.substr(Ce.length-1)==="%"&&(de=parseInt(de)/100),typeof de=="number"&&z("/OpenAction [3 0 R /XYZ null null "+F(de)+"]")}switch(je||(je="continuous"),je){case"continuous":z("/PageLayout /OneColumn");break;case"single":z("/PageLayout /SinglePage");break;case"two":case"twoleft":z("/PageLayout /TwoColumnLeft");break;case"tworight":z("/PageLayout /TwoColumnRight")}Ae&&z("/PageMode /"+Ae),sr.publish("putCatalog"),z(">>"),z("endobj")},xm=u.__private__.putTrailer=function(){z("trailer"),z("<<"),z("/Size "+(I+1)),z("/Root "+I+" 0 R"),z("/Info "+(I-1)+" 0 R"),f!==null&&z("/Encrypt "+Un.oid+" 0 R"),z("/ID [ <"+ee+"> <"+ee+"> ]"),z(">>")},jn=u.__private__.putHeader=function(){z("%PDF-"+p),z("%")},r0=u.__private__.putXRef=function(){var D="0000000000";z("xref"),z("0 "+(I+1)),z("0000000000 65535 f ");for(var ne=1;ne<=I;ne++)typeof H[ne]=="function"?z((D+H[ne]()).slice(-10)+" 00000 n "):H[ne]!==void 0?z((D+H[ne]).slice(-10)+" 00000 n "):z("0000000000 00000 n ")},Na=u.__private__.buildDocument=function(){var D;I=0,Y=0,J=[],H=[],Z=[],ge=An(),ve=An(),se(J),sr.publish("buildDocument"),jn(),We(),function(){sr.publish("putAdditionalObjects");for(var Ce=0;Ce<Z.length;Ce++){var Pe=Z[Ce];ae(Pe.objId,!0),z(Pe.content),z("endobj")}sr.publish("postPutAdditionalObjects")}(),D=[],function(){for(var Ce in Ke)Ke.hasOwnProperty(Ce)&&(h===!1||h===!0&&d.hasOwnProperty(Ce))&&Ve(Ke[Ce])}(),function(){var Ce;for(Ce in yt)yt.hasOwnProperty(Ce)&&gt(yt[Ce])}(),function(){for(var Ce in Dr)Dr.hasOwnProperty(Ce)&&ft(Dr[Ce])}(),function(Ce){var Pe;for(Pe in ot)ot.hasOwnProperty(Pe)&&(ot[Pe]instanceof gc?mt(ot[Pe]):ot[Pe]instanceof $u&&kt(ot[Pe],Ce))}(D),sr.publish("putResources"),D.forEach(bt),bt({resourcesOid:ve,objectOid:Number.MAX_SAFE_INTEGER}),sr.publish("postPutResources"),f!==null&&(Un.oid=Gr(),z("<<"),z("/Filter /Standard"),z("/V "+Un.v),z("/R "+Un.r),z("/U <"+Un.toHexString(Un.U)+">"),z("/O <"+Un.toHexString(Un.O)+">"),z("/P "+Un.P),z(">>"),z("endobj")),On(),tu();var ne=Y;return r0(),xm(),z("startxref"),z(""+ne),z("%%EOF"),se(fe[P]),J.join(`
`)},ru=u.__private__.getBlob=function(D){return new Blob([ce(D)],{type:"application/pdf"})},n0=u.output=u.__private__.output=(Yi=function(D,ne){switch(typeof(ne=ne||{})=="string"?ne={filename:ne}:ne.filename=ne.filename||"generated.pdf",D){case void 0:return Na();case"save":u.save(ne.filename);break;case"arraybuffer":return ce(Na());case"blob":return ru(Na());case"bloburi":case"bloburl":if(Xt.URL!==void 0&&typeof Xt.URL.createObjectURL=="function")return Xt.URL&&Xt.URL.createObjectURL(ru(Na()))||void 0;Fr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ce="",Pe=Na();try{Ce=n5(Pe)}catch{Ce=n5(unescape(encodeURIComponent(Pe)))}return"data:application/pdf;filename="+ne.filename+";base64,"+Ce;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Xt)==="[object Window]"){var Re="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",st=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ne.pdfObjectUrl&&(Re=ne.pdfObjectUrl,st="");var ct='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Re+'"'+st+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ne)+");<\/script></body></html>",Ot=Xt.open();return Ot!==null&&Ot.document.write(ct),Ot}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Xt)==="[object Window]"){var Ft='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ne.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ne.filename+'" width="500px" height="400px" /></body></html>',Yt=Xt.open();if(Yt!==null){Yt.document.write(Ft);var er=this;Yt.document.documentElement.querySelector("#pdfViewer").onload=function(){Yt.document.title=ne.filename,Yt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(er.output("bloburl"))}}return Yt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Xt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var hr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ne)+'"></iframe></body></html>',Jr=Xt.open();if(Jr!==null&&(Jr.document.write(hr),Jr.document.title=ne.filename),Jr||typeof safari>"u")return Jr;break;case"datauri":case"dataurl":return Xt.document.location.href=this.output("datauristring",ne);default:return null}},Yi.foo=function(){try{return Yi.apply(this,arguments)}catch(Ce){var D=Ce.stack||"";~D.indexOf(" at ")&&(D=D.split(" at ")[1]);var ne="Error in function "+D.split(`
`)[0].split("<")[0]+": "+Ce.message;if(!Xt.console)throw new Error(ne);Xt.console.error(ne,Ce),Xt.alert&&alert(ne)}},Yi.foo.bar=Yi,Yi.foo),Ds=function(D){return Array.isArray(Xi)===!0&&Xi.indexOf(D)>-1};switch(n){case"pt":Oe=1;break;case"mm":Oe=72/25.4;break;case"cm":Oe=72/2.54;break;case"in":Oe=72;break;case"px":Oe=Ds("px_scaling")==1?.75:96/72;break;case"pc":case"em":Oe=12;break;case"ex":Oe=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Oe=n}var Un=null;R(),K();var ro=u.__private__.getPageInfo=u.getPageInfo=function(D){if(isNaN(D)||D%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ct[D].objId,pageNumber:D,pageContext:Ct[D]}},i0=u.__private__.getPageInfoByObjId=function(D){if(isNaN(D)||D%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ne in Ct)if(Ct[ne].objId===D)break;return ro(ne)},vm=u.__private__.getCurrentPageInfo=u.getCurrentPageInfo=function(){return{objId:Ct[P].objId,pageNumber:P,pageContext:Ct[P]}};u.addPage=function(){return Ea.apply(this,arguments),this},u.setPage=function(){return Ta.apply(this,arguments),se.call(this,fe[P]),this},u.insertPage=function(D){return this.addPage(),this.movePage(P,D),this},u.movePage=function(D,ne){var Ce,Pe;if(D>ne){Ce=fe[D],Pe=Ct[D];for(var Re=D;Re>ne;Re--)fe[Re]=fe[Re-1],Ct[Re]=Ct[Re-1];fe[ne]=Ce,Ct[ne]=Pe,this.setPage(ne)}else if(D<ne){Ce=fe[D],Pe=Ct[D];for(var st=D;st<ne;st++)fe[st]=fe[st+1],Ct[st]=Ct[st+1];fe[ne]=Ce,Ct[ne]=Pe,this.setPage(ne)}return this},u.deletePage=function(){return ra.apply(this,arguments),this},u.__private__.text=u.text=function(D,ne,Ce,Pe,Re){var st,ct,Ot,Ft,Yt,er,hr,Jr,Pn,Lr=(Pe=Pe||{}).scope||this;if(typeof D=="number"&&typeof ne=="number"&&(typeof Ce=="string"||Array.isArray(Ce))){var zn=Ce;Ce=ne,ne=D,D=zn}if(arguments[3]instanceof Et==0?(Ot=arguments[4],Ft=arguments[5],Er(hr=arguments[3])==="object"&&hr!==null||(typeof Ot=="string"&&(Ft=Ot,Ot=null),typeof hr=="string"&&(Ft=hr,hr=null),typeof hr=="number"&&(Ot=hr,hr=null),Pe={flags:hr,angle:Ot,align:Ft})):(L("The transform parameter of text() with a Matrix value"),Pn=Re),isNaN(ne)||isNaN(Ce)||D==null)throw new Error("Invalid arguments passed to jsPDF.text");if(D.length===0)return Lr;var Fn,si="",co=typeof Pe.lineHeightFactor=="number"?Pe.lineHeightFactor:Gl,ia=Lr.internal.scaleFactor;function uo(yr){return yr=yr.split("	").join(Array(Pe.TabLen||9).join(" ")),cr(yr,hr)}function zf(yr){for(var jr,xn=yr.concat(),Wn=[],po=xn.length;po--;)typeof(jr=xn.shift())=="string"?Wn.push(jr):Array.isArray(yr)&&(jr.length===1||jr[1]===void 0&&jr[2]===void 0)?Wn.push(jr[0]):Wn.push([jr[0],jr[1],jr[2]]);return Wn}function au(yr,jr){var xn;if(typeof yr=="string")xn=jr(yr)[0];else if(Array.isArray(yr)){for(var Wn,po,Jf=yr.concat(),cu=[],g0=Jf.length;g0--;)typeof(Wn=Jf.shift())=="string"?cu.push(jr(Wn)[0]):Array.isArray(Wn)&&typeof Wn[0]=="string"&&(po=jr(Wn[0],Wn[1],Wn[2]),cu.push([po[0],po[1],po[2]]));xn=cu}return xn}var qo=!1,Jl=!0;if(typeof D=="string")qo=!0;else if(Array.isArray(D)){var Ql=D.concat();ct=[];for(var Vo,ai=Ql.length;ai--;)(typeof(Vo=Ql.shift())!="string"||Array.isArray(Vo)&&typeof Vo[0]!="string")&&(Jl=!1);qo=Jl}if(qo===!1)throw new Error('Type of text must be string or Array. "'+D+'" is not recognized.');typeof D=="string"&&(D=D.match(/[\r?\n]/)?D.split(/\r\n|\r|\n/g):[D]);var Zl=ye/Lr.internal.scaleFactor,ec=Zl*(co-1);switch(Pe.baseline){case"bottom":Ce-=ec;break;case"top":Ce+=Zl-ec;break;case"hanging":Ce+=Zl-2*ec;break;case"middle":Ce+=Zl/2-ec}if((er=Pe.maxWidth||0)>0&&(typeof D=="string"?D=Lr.splitTextToSize(D,er):Object.prototype.toString.call(D)==="[object Array]"&&(D=D.reduce(function(yr,jr){return yr.concat(Lr.splitTextToSize(jr,er))},[]))),st={text:D,x:ne,y:Ce,options:Pe,mutex:{pdfEscape:cr,activeFontKey:Ne,fonts:Ke,activeFontSize:ye}},sr.publish("preProcessText",st),D=st.text,Ot=(Pe=st.options).angle,Pn instanceof Et==0&&Ot&&typeof Ot=="number"){Ot*=Math.PI/180,Pe.rotationDirection===0&&(Ot=-Ot),b===w&&(Ot=-Ot);var Wf=Math.cos(Ot),Hf=Math.sin(Ot);Pn=new Et(Wf,Hf,-Hf,Wf,0,0)}else Ot&&Ot instanceof Et&&(Pn=Ot);b!==w||Pn||(Pn=ta),(Yt=Pe.charSpace||so)!==void 0&&(si+=j(V(Yt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Jr=Pe.horizontalScale)!==void 0&&(si+=j(100*Jr)+` Tz
`),Pe.lang;var Mi=-1,fo=Pe.renderingMode!==void 0?Pe.renderingMode:Pe.stroke,ou=Lr.internal.getCurrentPageInfo().pageContext;switch(fo){case 0:case!1:case"fill":Mi=0;break;case 1:case!0:case"stroke":Mi=1;break;case 2:case"fillThenStroke":Mi=2;break;case 3:case"invisible":Mi=3;break;case 4:case"fillAndAddForClipping":Mi=4;break;case 5:case"strokeAndAddPathForClipping":Mi=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Mi=6;break;case 7:case"addToPathForClipping":Mi=7}var d0=ou.usedRenderingMode!==void 0?ou.usedRenderingMode:-1;Mi!==-1?si+=Mi+` Tr
`:d0!==-1&&(si+=`0 Tr
`),Mi!==-1&&(ou.usedRenderingMode=Mi),Ft=Pe.align||"left";var Ls,tc=ye*co,$f=Lr.internal.pageSize.getWidth(),qf=Ke[Ne];Yt=Pe.charSpace||so,er=Pe.maxWidth||0,hr=Object.assign({autoencode:!0,noBOM:!0},Pe.flags);var Go=[],rc=function(yr){return Lr.getStringUnitWidth(yr,{font:qf,charSpace:Yt,fontSize:ye,doKerning:!1})*ye/ia};if(Object.prototype.toString.call(D)==="[object Array]"){var os;ct=zf(D),Ft!=="left"&&(Ls=ct.map(rc));var ls,Xo=0;if(Ft==="right"){ne-=Ls[0],D=[],ai=ct.length;for(var ho=0;ho<ai;ho++)ho===0?(ls=no(ne),os=io(Ce)):(ls=V(Xo-Ls[ho]),os=-tc),D.push([ct[ho],ls,os]),Xo=Ls[ho]}else if(Ft==="center"){ne-=Ls[0]/2,D=[],ai=ct.length;for(var Yo=0;Yo<ai;Yo++)Yo===0?(ls=no(ne),os=io(Ce)):(ls=V((Xo-Ls[Yo])/2),os=-tc),D.push([ct[Yo],ls,os]),Xo=Ls[Yo]}else if(Ft==="left"){D=[],ai=ct.length;for(var Vf=0;Vf<ai;Vf++)D.push(ct[Vf])}else if(Ft==="justify"&&qf.encoding==="Identity-H"){D=[],ai=ct.length,er=er!==0?er:$f;for(var lu=0,mn=0;mn<ai;mn++)if(os=mn===0?io(Ce):-tc,ls=mn===0?no(ne):lu,mn<ai-1){var p0=V((er-Ls[mn])/(ct[mn].split(" ").length-1)),Oa=ct[mn].split(" ");D.push([Oa[0]+" ",ls,os]),lu=0;for(var ja=1;ja<Oa.length;ja++){var Gf=(rc(Oa[ja-1]+" "+Oa[ja])-rc(Oa[ja]))*ia+p0;ja==Oa.length-1?D.push([Oa[ja],Gf,0]):D.push([Oa[ja]+" ",Gf,0]),lu-=Gf}}else D.push([ct[mn],ls,os]);D.push(["",lu,0])}else{if(Ft!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(D=[],ai=ct.length,er=er!==0?er:$f,mn=0;mn<ai;mn++){os=mn===0?io(Ce):-tc,ls=mn===0?no(ne):0;var Xf=ct[mn].split(" ").length-1,Yf=Xf>0?(er-Ls[mn])/Xf:0;mn<ai-1?Go.push(j(V(Yf))):Go.push(0),D.push([ct[mn],ls,os])}}}(typeof Pe.R2L=="boolean"?Pe.R2L:pe)===!0&&(D=au(D,function(yr,jr,xn){return[yr.split("").reverse().join(""),jr,xn]})),st={text:D,x:ne,y:Ce,options:Pe,mutex:{pdfEscape:cr,activeFontKey:Ne,fonts:Ke,activeFontSize:ye}},sr.publish("postProcessText",st),D=st.text,Fn=st.mutex.isHex||!1;var Kf=Ke[Ne].encoding;Kf!=="WinAnsiEncoding"&&Kf!=="StandardEncoding"||(D=au(D,function(yr,jr,xn){return[uo(yr),jr,xn]})),ct=zf(D),D=[];for(var Ko,Jo,Qo,nc=Array.isArray(ct[0])?1:0,Zo="",ic=function(yr,jr,xn){var Wn="";return xn instanceof Et?(xn=typeof Pe.angle=="number"?Jn(xn,new Et(1,0,0,1,yr,jr)):Jn(new Et(1,0,0,1,yr,jr),xn),b===w&&(xn=Jn(new Et(1,0,0,-1,0,0),xn)),Wn=xn.join(" ")+` Tm
`):Wn=j(yr)+" "+j(jr)+` Td
`,Wn},Is=0;Is<ct.length;Is++){switch(Zo="",nc){case 1:Qo=(Fn?"<":"(")+ct[Is][0]+(Fn?">":")"),Ko=parseFloat(ct[Is][1]),Jo=parseFloat(ct[Is][2]);break;case 0:Qo=(Fn?"<":"(")+ct[Is]+(Fn?">":")"),Ko=no(ne),Jo=io(Ce)}Go!==void 0&&Go[Is]!==void 0&&(Zo=Go[Is]+` Tw
`),Is===0?D.push(Zo+ic(Ko,Jo,Pn)+Qo):nc===0?D.push(Zo+Qo):nc===1&&D.push(Zo+ic(Ko,Jo,Pn)+Qo)}D=nc===0?D.join(` Tj
T* `):D.join(` Tj
`),D+=` Tj
`;var Pa=`BT
/`;return Pa+=Ne+" "+ye+` Tf
`,Pa+=j(ye*co)+` TL
`,Pa+=Xl+`
`,Pa+=si,Pa+=D,z(Pa+="ET"),d[Ne]=!0,Lr};var ym=u.__private__.clip=u.clip=function(D){return z(D==="evenodd"?"W*":"W"),this};u.clipEvenOdd=function(){return ym("evenodd")},u.__private__.discardPath=u.discardPath=function(){return z("n"),this};var Aa=u.__private__.isValidStyle=function(D){var ne=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(D)!==-1&&(ne=!0),ne};u.__private__.setDefaultPathOperation=u.setDefaultPathOperation=function(D){return Aa(D)&&(c=D),this};var s0=u.__private__.getStyle=u.getStyle=function(D){var ne=c;switch(D){case"D":case"S":ne="S";break;case"F":ne="f";break;case"FD":case"DF":ne="B";break;case"f":case"f*":case"B":case"B*":ne=D}return ne},a0=u.close=function(){return z("h"),this};u.stroke=function(){return z("S"),this},u.fill=function(D){return nu("f",D),this},u.fillEvenOdd=function(D){return nu("f*",D),this},u.fillStroke=function(D){return nu("B",D),this},u.fillStrokeEvenOdd=function(D){return nu("B*",D),this};var nu=function(D,ne){Er(ne)==="object"?bm(ne,D):z(D)},Vl=function(D){D===null||b===w&&D===void 0||(D=s0(D),z(D))};function wm(D,ne,Ce,Pe,Re){var st=new $u(ne||this.boundingBox,Ce||this.xStep,Pe||this.yStep,this.gState,Re||this.matrix);st.stream=this.stream;var ct=D+"$$"+this.cloneIndex+++"$$";return vi(ct,st),st}var bm=function(D,ne){var Ce=_t[D.key],Pe=ot[Ce];if(Pe instanceof gc)z("q"),z(_m(ne)),Pe.gState&&u.setGState(Pe.gState),z(D.matrix.toString()+" cm"),z("/"+Ce+" sh"),z("Q");else if(Pe instanceof $u){var Re=new Et(1,0,0,-1,0,Kl());D.matrix&&(Re=Re.multiply(D.matrix||ta),Ce=wm.call(Pe,D.key,D.boundingBox,D.xStep,D.yStep,Re).id),z("q"),z("/Pattern cs"),z("/"+Ce+" scn"),Pe.gState&&u.setGState(Pe.gState),z(ne),z("Q")}},_m=function(D){switch(D){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Ff=u.moveTo=function(D,ne){return z(j(V(D))+" "+j(G(ne))+" m"),this},o0=u.lineTo=function(D,ne){return z(j(V(D))+" "+j(G(ne))+" l"),this},na=u.curveTo=function(D,ne,Ce,Pe,Re,st){return z([j(V(D)),j(G(ne)),j(V(Ce)),j(G(Pe)),j(V(Re)),j(G(st)),"c"].join(" ")),this};u.__private__.line=u.line=function(D,ne,Ce,Pe,Re){if(isNaN(D)||isNaN(ne)||isNaN(Ce)||isNaN(Pe)||!Aa(Re))throw new Error("Invalid arguments passed to jsPDF.line");return b===y?this.lines([[Ce-D,Pe-ne]],D,ne,[1,1],Re||"S"):this.lines([[Ce-D,Pe-ne]],D,ne,[1,1]).stroke()},u.__private__.lines=u.lines=function(D,ne,Ce,Pe,Re,st){var ct,Ot,Ft,Yt,er,hr,Jr,Pn,Lr,zn,Fn,si;if(typeof D=="number"&&(si=Ce,Ce=ne,ne=D,D=si),Pe=Pe||[1,1],st=st||!1,isNaN(ne)||isNaN(Ce)||!Array.isArray(D)||!Array.isArray(Pe)||!Aa(Re)||typeof st!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Ff(ne,Ce),ct=Pe[0],Ot=Pe[1],Yt=D.length,zn=ne,Fn=Ce,Ft=0;Ft<Yt;Ft++)(er=D[Ft]).length===2?(zn=er[0]*ct+zn,Fn=er[1]*Ot+Fn,o0(zn,Fn)):(hr=er[0]*ct+zn,Jr=er[1]*Ot+Fn,Pn=er[2]*ct+zn,Lr=er[3]*Ot+Fn,zn=er[4]*ct+zn,Fn=er[5]*Ot+Fn,na(hr,Jr,Pn,Lr,zn,Fn));return st&&a0(),Vl(Re),this},u.path=function(D){for(var ne=0;ne<D.length;ne++){var Ce=D[ne],Pe=Ce.c;switch(Ce.op){case"m":Ff(Pe[0],Pe[1]);break;case"l":o0(Pe[0],Pe[1]);break;case"c":na.apply(this,Pe);break;case"h":a0()}}return this},u.__private__.rect=u.rect=function(D,ne,Ce,Pe,Re){if(isNaN(D)||isNaN(ne)||isNaN(Ce)||isNaN(Pe)||!Aa(Re))throw new Error("Invalid arguments passed to jsPDF.rect");return b===y&&(Pe=-Pe),z([j(V(D)),j(G(ne)),j(V(Ce)),j(V(Pe)),"re"].join(" ")),Vl(Re),this},u.__private__.triangle=u.triangle=function(D,ne,Ce,Pe,Re,st,ct){if(isNaN(D)||isNaN(ne)||isNaN(Ce)||isNaN(Pe)||isNaN(Re)||isNaN(st)||!Aa(ct))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ce-D,Pe-ne],[Re-Ce,st-Pe],[D-Re,ne-st]],D,ne,[1,1],ct,!0),this},u.__private__.roundedRect=u.roundedRect=function(D,ne,Ce,Pe,Re,st,ct){if(isNaN(D)||isNaN(ne)||isNaN(Ce)||isNaN(Pe)||isNaN(Re)||isNaN(st)||!Aa(ct))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ot=4/3*(Math.SQRT2-1);return Re=Math.min(Re,.5*Ce),st=Math.min(st,.5*Pe),this.lines([[Ce-2*Re,0],[Re*Ot,0,Re,st-st*Ot,Re,st],[0,Pe-2*st],[0,st*Ot,-Re*Ot,st,-Re,st],[2*Re-Ce,0],[-Re*Ot,0,-Re,-st*Ot,-Re,-st],[0,2*st-Pe],[0,-st*Ot,Re*Ot,-st,Re,-st]],D+Re,ne,[1,1],ct,!0),this},u.__private__.ellipse=u.ellipse=function(D,ne,Ce,Pe,Re){if(isNaN(D)||isNaN(ne)||isNaN(Ce)||isNaN(Pe)||!Aa(Re))throw new Error("Invalid arguments passed to jsPDF.ellipse");var st=4/3*(Math.SQRT2-1)*Ce,ct=4/3*(Math.SQRT2-1)*Pe;return Ff(D+Ce,ne),na(D+Ce,ne-ct,D+st,ne-Pe,D,ne-Pe),na(D-st,ne-Pe,D-Ce,ne-ct,D-Ce,ne),na(D-Ce,ne+ct,D-st,ne+Pe,D,ne+Pe),na(D+st,ne+Pe,D+Ce,ne+ct,D+Ce,ne),Vl(Re),this},u.__private__.circle=u.circle=function(D,ne,Ce,Pe){if(isNaN(D)||isNaN(ne)||isNaN(Ce)||!Aa(Pe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(D,ne,Ce,Ce,Pe)},u.setFont=function(D,ne,Ce){return Ce&&(ne=O(ne,Ce)),Ne=$o(D,ne,{disableWarning:!1}),this};var km=u.__private__.getFont=u.getFont=function(){return Ke[$o.apply(u,arguments)]};u.__private__.getFontList=u.getFontList=function(){var D,ne,Ce={};for(D in et)if(et.hasOwnProperty(D))for(ne in Ce[D]=[],et[D])et[D].hasOwnProperty(ne)&&Ce[D].push(ne);return Ce},u.addFont=function(D,ne,Ce,Pe,Re){var st=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&st.indexOf(arguments[3])!==-1?Re=arguments[3]:arguments[3]&&st.indexOf(arguments[3])==-1&&(Ce=O(Ce,Pe)),Ar.call(this,D,ne,Ce,Re=Re||"Identity-H")};var Gl,Df=e.lineWidth||.200025,Sm=u.__private__.getLineWidth=u.getLineWidth=function(){return Df},Kt=u.__private__.setLineWidth=u.setLineWidth=function(D){return Df=D,z(j(V(D))+" w"),this};u.__private__.setLineDash=Mt.API.setLineDash=Mt.API.setLineDashPattern=function(D,ne){if(D=D||[],ne=ne||0,isNaN(ne)||!Array.isArray(D))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return D=D.map(function(Ce){return j(V(Ce))}).join(" "),ne=j(V(ne)),z("["+D+"] "+ne+" d"),this};var Cm=u.__private__.getLineHeight=u.getLineHeight=function(){return ye*Gl};u.__private__.getLineHeight=u.getLineHeight=function(){return ye*Gl};var Em=u.__private__.setLineHeightFactor=u.setLineHeightFactor=function(D){return typeof(D=D||1.15)=="number"&&(Gl=D),this},Tm=u.__private__.getLineHeightFactor=u.getLineHeightFactor=function(){return Gl};Em(e.lineHeight);var no=u.__private__.getHorizontalCoordinate=function(D){return V(D)},io=u.__private__.getVerticalCoordinate=function(D){return b===w?D:Ct[P].mediaBox.topRightY-Ct[P].mediaBox.bottomLeftY-V(D)},Nm=u.__private__.getHorizontalCoordinateString=u.getHorizontalCoordinateString=function(D){return j(no(D))},Am=u.__private__.getVerticalCoordinateString=u.getVerticalCoordinateString=function(D){return j(io(D))},iu=e.strokeColor||"0 G";u.__private__.getStrokeColor=u.getDrawColor=function(){return Se(iu)},u.__private__.setStrokeColor=u.setDrawColor=function(D,ne,Ce,Pe){return iu=Ee({ch1:D,ch2:ne,ch3:Ce,ch4:Pe,pdfColorType:"draw",precision:2}),z(iu),this};var Lf=e.fillColor||"0 g";u.__private__.getFillColor=u.getFillColor=function(){return Se(Lf)},u.__private__.setFillColor=u.setFillColor=function(D,ne,Ce,Pe){return Lf=Ee({ch1:D,ch2:ne,ch3:Ce,ch4:Pe,pdfColorType:"fill",precision:2}),z(Lf),this};var Xl=e.textColor||"0 g",Om=u.__private__.getTextColor=u.getTextColor=function(){return Se(Xl)};u.__private__.setTextColor=u.setTextColor=function(D,ne,Ce,Pe){return Xl=Ee({ch1:D,ch2:ne,ch3:Ce,ch4:Pe,pdfColorType:"text",precision:3}),this};var so=e.charSpace,jm=u.__private__.getCharSpace=u.getCharSpace=function(){return parseFloat(so||0)};u.__private__.setCharSpace=u.setCharSpace=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return so=D,this};var If=0;u.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},u.__private__.setLineCap=u.setLineCap=function(D){var ne=u.CapJoinStyles[D];if(ne===void 0)throw new Error("Line cap style of '"+D+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return If=ne,z(ne+" J"),this};var Mf=0;u.__private__.setLineJoin=u.setLineJoin=function(D){var ne=u.CapJoinStyles[D];if(ne===void 0)throw new Error("Line join style of '"+D+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Mf=ne,z(ne+" j"),this},u.__private__.setLineMiterLimit=u.__private__.setMiterLimit=u.setLineMiterLimit=u.setMiterLimit=function(D){if(D=D||0,isNaN(D))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return z(j(V(D))+" M"),this},u.GState=wg,u.setGState=function(D){(D=typeof D=="string"?yt[St[D]]:l0(null,D)).equals(Bt)||(z("/"+D.id+" gs"),Bt=D)};var l0=function(D,ne){if(!D||!St[D]){var Ce=!1;for(var Pe in yt)if(yt.hasOwnProperty(Pe)&&yt[Pe].equals(ne)){Ce=!0;break}if(Ce)ne=yt[Pe];else{var Re="GS"+(Object.keys(yt).length+1).toString(10);yt[Re]=ne,ne.id=Re}return D&&(St[D]=ne.id),sr.publish("addGState",ne),ne}};u.addGState=function(D,ne){return l0(D,ne),this},u.saveGraphicsState=function(){return z("q"),Ge.push({key:Ne,size:ye,color:Xl}),this},u.restoreGraphicsState=function(){z("Q");var D=Ge.pop();return Ne=D.key,ye=D.size,Xl=D.color,Bt=null,this},u.setCurrentTransformationMatrix=function(D){return z(D.toString()+" cm"),this},u.comment=function(D){return z("#"+D),this};var ao=function(D,ne){var Ce=D||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ce},set:function(st){isNaN(st)||(Ce=parseFloat(st))}});var Pe=ne||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Pe},set:function(st){isNaN(st)||(Pe=parseFloat(st))}});var Re="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Re},set:function(st){Re=st.toString()}}),this},Rf=function(D,ne,Ce,Pe){ao.call(this,D,ne),this.type="rect";var Re=Ce||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Re},set:function(ct){isNaN(ct)||(Re=parseFloat(ct))}});var st=Pe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return st},set:function(ct){isNaN(ct)||(st=parseFloat(ct))}}),this},su=function(){this.page=qt,this.currentPage=P,this.pages=fe.slice(0),this.pagesContext=Ct.slice(0),this.x=De,this.y=Ye,this.matrix=it,this.width=Uf(P),this.height=u0(P),this.outputDestination=re,this.id="",this.objectNumber=-1};su.prototype.restore=function(){qt=this.page,P=this.currentPage,Ct=this.pagesContext,fe=this.pages,De=this.x,Ye=this.y,it=this.matrix,c0(P,this.width),oo(P,this.height),re=this.outputDestination};var Bf=function(D,ne,Ce,Pe,Re){Ii.push(new su),qt=P=0,fe=[],De=D,Ye=ne,it=Re,sn([Ce,Pe])};for(var Yl in u.beginFormObject=function(D,ne,Ce,Pe,Re){return Bf(D,ne,Ce,Pe,Re),this},u.endFormObject=function(D){return function(ne){if(ii[ne])Ii.pop().restore();else{var Ce=new su,Pe="Xo"+(Object.keys(Dr).length+1).toString(10);Ce.id=Pe,ii[ne]=Pe,Dr[Pe]=Ce,sr.publish("addFormObject",Ce),Ii.pop().restore()}}(D),this},u.doFormObject=function(D,ne){var Ce=Dr[ii[D]];return z("q"),z(ne.toString()+" cm"),z("/"+Ce.id+" Do"),z("Q"),this},u.getFormObject=function(D){var ne=Dr[ii[D]];return{x:ne.x,y:ne.y,width:ne.width,height:ne.height,matrix:ne.matrix}},u.save=function(D,ne){return D=D||"generated.pdf",(ne=ne||{}).returnPromise=ne.returnPromise||!1,ne.returnPromise===!1?(fc(ru(Na()),D),typeof fc.unload=="function"&&Xt.setTimeout&&setTimeout(fc.unload,911),this):new Promise(function(Ce,Pe){try{var Re=fc(ru(Na()),D);typeof fc.unload=="function"&&Xt.setTimeout&&setTimeout(fc.unload,911),Ce(Re)}catch(st){Pe(st.message)}})},Mt.API)Mt.API.hasOwnProperty(Yl)&&(Yl==="events"&&Mt.API.events.length?function(D,ne){var Ce,Pe,Re;for(Re=ne.length-1;Re!==-1;Re--)Ce=ne[Re][0],Pe=ne[Re][1],D.subscribe.apply(D,[Ce].concat(typeof Pe=="function"?[Pe]:Pe))}(sr,Mt.API.events):u[Yl]=Mt.API[Yl]);function Uf(D){return Ct[D].mediaBox.topRightX-Ct[D].mediaBox.bottomLeftX}function c0(D,ne){Ct[D].mediaBox.topRightX=ne+Ct[D].mediaBox.bottomLeftX}function u0(D){return Ct[D].mediaBox.topRightY-Ct[D].mediaBox.bottomLeftY}function oo(D,ne){Ct[D].mediaBox.topRightY=ne+Ct[D].mediaBox.bottomLeftY}var lo=u.getPageWidth=function(D){return Uf(D=D||P)/Oe},f0=u.setPageWidth=function(D,ne){c0(D,ne*Oe)},Kl=u.getPageHeight=function(D){return u0(D=D||P)/Oe},h0=u.setPageHeight=function(D,ne){oo(D,ne*Oe)};return u.internal={pdfEscape:cr,getStyle:s0,getFont:km,getFontSize:Te,getCharSpace:jm,getTextColor:Om,getLineHeight:Cm,getLineHeightFactor:Tm,getLineWidth:Sm,write:oe,getHorizontalCoordinate:no,getVerticalCoordinate:io,getCoordinateString:Nm,getVerticalCoordinateString:Am,collections:{},newObject:Gr,newAdditionalObject:ke,newObjectDeferred:An,newObjectDeferredBegin:ae,getFilters:Ue,putStream:Qe,events:sr,scaleFactor:Oe,pageSize:{getWidth:function(){return lo(P)},setWidth:function(D){f0(P,D)},getHeight:function(){return Kl(P)},setHeight:function(D){h0(P,D)}},encryptionOptions:f,encryption:Un,getEncryptor:function(D){return f!==null?Un.encryptor(D,0):function(ne){return ne}},output:n0,getNumberOfPages:Fs,get pages(){return fe},out:z,f2:F,f3:M,getPageInfo:ro,getPageInfoByObjId:i0,getCurrentPageInfo:vm,getPDFVersion:m,Point:ao,Rectangle:Rf,Matrix:Et,hasHotfix:Ds},Object.defineProperty(u.internal.pageSize,"width",{get:function(){return lo(P)},set:function(D){f0(P,D)},enumerable:!0,configurable:!0}),Object.defineProperty(u.internal.pageSize,"height",{get:function(){return Kl(P)},set:function(D){h0(P,D)},enumerable:!0,configurable:!0}),(function(D){for(var ne=0,Ce=we.length;ne<Ce;ne++){var Pe=Ar.call(this,D[ne][0],D[ne][1],D[ne][2],we[ne][3],!0);h===!1&&(d[Pe]=!0);var Re=D[ne][0].split("-");Vt({id:Pe,fontName:Re[0],fontStyle:Re[1]||""})}sr.publish("addFonts",{fonts:Ke,dictionary:et})}).call(u,we),Ne="F1",Ea(i,r),sr.publish("initialized"),u}Nu.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Nu.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Nu.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Nu.prototype.processOwnerPassword=function(e,t){return Ov(Av(t).substr(0,5),e)},Nu.prototype.encryptor=function(e,t){var r=Av(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return Ov(r,n)}},wg.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Er(e)!==Er(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Mt.API={events:[]},Mt.version="4.0.0";var ln=Mt.API,ey=1,Vc=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},yu=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Qt=function(e){return e.toFixed(2)},ll=function(e){return e.toFixed(5)};ln.__acroform__={};var as=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},o5=function(e){return e*ey},Ia=function(e){var t=new tC,r=At.internal.getHeight(e)||0,n=At.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Qt(n)),Number(Qt(r))],t},EL=ln.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},TL=ln.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},NL=ln.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},_n=ln.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return NL(e,t-1)},kn=ln.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return EL(e,t-1)},Sn=ln.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return TL(e,t-1)},AL=ln.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,i=e[0],s=e[1],l=e[2],o=e[3],a={};return a.lowerLeft_X=r(i)||0,a.lowerLeft_Y=n(s+o)||0,a.upperRight_X=r(i+l)||0,a.upperRight_Y=n(s)||0,[Number(Qt(a.lowerLeft_X)),Number(Qt(a.lowerLeft_Y)),Number(Qt(a.upperRight_X)),Number(Qt(a.upperRight_Y))]},OL=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=jv(e,r),i=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+i+" "+Qt(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=Ia(e);return s.scope=e.scope,s.stream=t.join(`
`),s}},jv=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},i=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");i=e.multiline?i.map(function(F){return F.split(`
`)}):i.map(function(F){return[F]});var s=r,l=At.internal.getHeight(e)||0;l=l<0?-l:l;var o=At.internal.getWidth(e)||0;o=o<0?-o:o;var a=function(F,M,V){if(F+1<i.length){var G=M+" "+i[F+1][0];return op(G,e,V).width<=o-4}return!1};s++;e:for(;s>0;){t="",s--;var c,f,h=op("3",e,s).height,d=e.multiline?l-s:(l-h)/2,u=d+=2,p=0,m=0,g=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+op(t,e,s=12).width+", FieldWidth:"+o+`
`;break}for(var x="",y=0,w=0;w<i.length;w++)if(i.hasOwnProperty(w)){var b=!1;if(i[w].length!==1&&g!==i[w].length-1){if((h+2)*(y+2)+2>l)continue e;x+=i[w][g],b=!0,m=w,w--}else{x=(x+=i[w][g]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var S=parseInt(w),T=a(S,x,s),O=w>=i.length-1;if(T&&!O){x+=" ",g=0;continue}if(T||O){if(O)m=S;else if(e.multiline&&(h+2)*(y+2)+2>l)continue e}else{if(!e.multiline||(h+2)*(y+2)+2>l)continue e;m=S}}for(var j="",L=p;L<=m;L++){var W=i[L];if(e.multiline){if(L===m){j+=W[g]+" ",g=(g+1)%W.length;continue}if(L===p){j+=W[W.length-1]+" ";continue}}j+=W[0]+" "}switch(j=j.substr(j.length-1)==" "?j.substr(0,j.length-1):j,f=op(j,e,s).width,e.textAlign){case"right":c=o-f-2;break;case"center":c=(o-f)/2;break;default:c=2}t+=Qt(c)+" "+Qt(u)+` Td
`,t+="("+Vc(j)+`) Tj
`,t+=-Qt(c)+` 0 Td
`,u=-(s+2),f=0,p=b?m:m+1,y++,x=""}break}return n.text=t,n.fontSize=s,n},op=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},jL={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},PL=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},FL=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Sa.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(jL)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");ey=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new rC,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var s=n[i];s.objId=void 0,s.hasAnnotation&&PL(s,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,i){var s=!n;for(var l in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(l)){var o=n[l],a=[],c=o.Rect;if(o.Rect&&(o.Rect=AL(o.Rect,i)),i.internal.newObjectDeferredBegin(o.objId,!0),o.DA=At.createDefaultAppearanceStream(o),Er(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(a=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var f=OL(o);a.push({key:"AP",value:"<</N "+f+">>"}),i.internal.acroformPlugin.xForms.push(f)}if(o.appearanceStreamContent){var h="";for(var d in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(d)){var u=o.appearanceStreamContent[d];if(h+="/"+d+" ",h+="<<",Object.keys(u).length>=1||Array.isArray(u)){for(var l in u)if(u.hasOwnProperty(l)){var p=u[l];typeof p=="function"&&(p=p.call(i,o)),h+="/"+l+" "+p+" ",i.internal.acroformPlugin.xForms.indexOf(p)>=0||i.internal.acroformPlugin.xForms.push(p)}}else typeof(p=u)=="function"&&(p=p.call(i,o)),h+="/"+l+" "+p,i.internal.acroformPlugin.xForms.indexOf(p)>=0||i.internal.acroformPlugin.xForms.push(p);h+=">>"}a.push({key:"AP",value:`<<
`+h+">>"})}i.internal.putStream({additionalKeyValues:a,objectId:o.objId}),i.internal.out("endobj")}s&&function(m,g){for(var x in m)if(m.hasOwnProperty(x)){var y=x,w=m[x];g.internal.newObjectDeferredBegin(w.objId,!0),Er(w)==="object"&&typeof w.putStream=="function"&&w.putStream(),delete m[y]}}(i.internal.acroformPlugin.xForms,i)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},eC=ln.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(l){return l};if(Array.isArray(e)){for(var i="[",s=0;s<e.length;s++)switch(s!==0&&(i+=" "),Er(e[s])){case"boolean":case"number":case"object":i+=e[s].toString();break;case"string":e[s].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),i+="("+Vc(n(e[s].toString()))+")"):i+=e[s].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},G1=function(e,t,r){var n=function(i){return i};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+Vc(n(e))+")"},qa=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};qa.prototype.toString=function(){return this.objId+" 0 R"},qa.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},qa.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],i=this[n];i&&(Array.isArray(i)?e.push({key:n,value:eC(i,this.objId,this.scope)}):i instanceof qa?(i.scope=this.scope,e.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&e.push({key:n,value:i}))}return e};var tC=function(){qa.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};as(tC,qa);var rC=function(){qa.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Vc(r(e))+")"}},set:function(r){e=r}})};as(rC,qa);var Sa=function e(){qa.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');t=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!_n(t,3)},set:function(x){x?this.F=kn(t,3):this.F=Sn(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');r=x}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(x){n=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(x){n[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(x){n[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(x){n[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(x){n[3]=x}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof bg)return;s="FieldObject"+e.FieldNum++}var x=function(y){return y};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+Vc(x(s))+")"},set:function(x){s=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(x){s=x}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(x){l=x}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(x){o=x}});var a=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return a},set:function(x){a=x}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/ey:c},set:function(x){c=x}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(x){f=x}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof bg||this instanceof Sc))return G1(h,this.objId,this.scope)},set:function(x){x=x.toString(),h=x}});var d=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof ei==0?G1(d,this.objId,this.scope):d},set:function(x){x=x.toString(),d=this instanceof ei==0?x.substr(0,1)==="("?yu(x.substr(1,x.length-2)):yu(x):x}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ei==1?yu(d.substr(1,d.length-1)):d},set:function(x){x=x.toString(),d=this instanceof ei==1?"/"+x:x}});var u=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(u)return u},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(u)return this instanceof ei==0?G1(u,this.objId,this.scope):u},set:function(x){x=x.toString(),u=this instanceof ei==0?x.substr(0,1)==="("?yu(x.substr(1,x.length-2)):yu(x):x}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ei==1?yu(u.substr(1,u.length-1)):u},set:function(x){x=x.toString(),u=this instanceof ei==1?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var p,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(x){x=!!x,m=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(p)return p},set:function(x){p=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,1)},set:function(x){x?this.Ff=kn(this.Ff,1):this.Ff=Sn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,2)},set:function(x){x?this.Ff=kn(this.Ff,2):this.Ff=Sn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,3)},set:function(x){x?this.Ff=kn(this.Ff,3):this.Ff=Sn(this.Ff,3)}});var g=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(g!==null)return g},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');g=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(g){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:g=2;break;case"center":case 1:g=1;break;default:g=0}}})};as(Sa,qa);var Zu=function(){Sa.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return eC(t,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(s,l,o){o||(o=1);for(var a,c=[];a=l.exec(s);)c.push(a[o]);return c}(n,/\((.*?)\)/g)),t=i}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,18)},set:function(r){r?this.Ff=kn(this.Ff,18):this.Ff=Sn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=kn(this.Ff,19):this.Ff=Sn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,20)},set:function(r){r?(this.Ff=kn(this.Ff,20),t.sort()):this.Ff=Sn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,22)},set:function(r){r?this.Ff=kn(this.Ff,22):this.Ff=Sn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,23)},set:function(r){r?this.Ff=kn(this.Ff,23):this.Ff=Sn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,27)},set:function(r){r?this.Ff=kn(this.Ff,27):this.Ff=Sn(this.Ff,27)}}),this.hasAppearanceStream=!1};as(Zu,Sa);var ef=function(){Zu.call(this),this.fontName="helvetica",this.combo=!1};as(ef,Zu);var tf=function(){ef.call(this),this.combo=!0};as(tf,ef);var Mp=function(){tf.call(this),this.edit=!0};as(Mp,tf);var ei=function(){Sa.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,15)},set:function(r){r?this.Ff=kn(this.Ff,15):this.Ff=Sn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,16)},set:function(r){r?this.Ff=kn(this.Ff,16):this.Ff=Sn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,17)},set:function(r){r?this.Ff=kn(this.Ff,17):this.Ff=Sn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,26)},set:function(r){r?this.Ff=kn(this.Ff,26):this.Ff=Sn(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,i=[];for(n in i.push("<<"),t)i.push("/"+n+" ("+Vc(r(t[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){Er(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};as(ei,Sa);var Rp=function(){ei.call(this),this.pushButton=!0};as(Rp,ei);var rf=function(){ei.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};as(rf,ei);var bg=function(){var e,t;Sa.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(i){t=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(o){return o};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,l=[];for(s in l.push("<<"),n)l.push("/"+s+" ("+Vc(i(n[s]))+")");return l.push(">>"),l.join(`
`)},set:function(i){Er(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=At.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};as(bg,Sa),rf.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},rf.prototype.createOption=function(e){var t=new bg;return t.Parent=this,t.optionName=e,this.Kids.push(t),DL.call(this.scope,t),t};var Bp=function(){ei.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=At.CheckBox.createAppearanceStream()};as(Bp,ei);var Sc=function(){Sa.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,13)},set:function(t){t?this.Ff=kn(this.Ff,13):this.Ff=Sn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,21)},set:function(t){t?this.Ff=kn(this.Ff,21):this.Ff=Sn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,23)},set:function(t){t?this.Ff=kn(this.Ff,23):this.Ff=Sn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,24)},set:function(t){t?this.Ff=kn(this.Ff,24):this.Ff=Sn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,25)},set:function(t){t?this.Ff=kn(this.Ff,25):this.Ff=Sn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,26)},set:function(t){t?this.Ff=kn(this.Ff,26):this.Ff=Sn(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};as(Sc,Sa);var Up=function(){Sc.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,14)},set:function(e){e?this.Ff=kn(this.Ff,14):this.Ff=Sn(this.Ff,14)}}),this.password=!0};as(Up,Sc);var At={CheckBox:{createAppearanceStream:function(){return{N:{On:At.CheckBox.YesNormal},D:{On:At.CheckBox.YesPushDown,Off:At.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Ia(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),s=jv(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Qt(At.internal.getWidth(e))+" "+Qt(At.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Qt(s.fontSize)+" Tf "+i),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Ia(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),i=[],s=At.internal.getHeight(e),l=At.internal.getWidth(e),o=jv(e,e.caption);return i.push("1 g"),i.push("0 0 "+Qt(l)+" "+Qt(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Qt(l-1)+" "+Qt(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+Qt(o.fontSize)+" Tf "+n),i.push(o.text),i.push("ET"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(e){var t=Ia(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Qt(At.internal.getWidth(e))+" "+Qt(At.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:At.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=At.RadioButton.Circle.YesNormal,t.D[e]=At.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Ia(e);t.scope=e.scope;var r=[],n=At.internal.getWidth(e)<=At.internal.getHeight(e)?At.internal.getWidth(e)/4:At.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=At.internal.Bezier_C,s=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+ll(At.internal.getWidth(e)/2)+" "+ll(At.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Ia(e);t.scope=e.scope;var r=[],n=At.internal.getWidth(e)<=At.internal.getHeight(e)?At.internal.getWidth(e)/4:At.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*At.internal.Bezier_C).toFixed(5)),l=Number((n*At.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+ll(At.internal.getWidth(e)/2)+" "+ll(At.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),r.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),r.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),r.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+ll(At.internal.getWidth(e)/2)+" "+ll(At.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+l+" "+l+" "+n+" 0 "+n+" c"),r.push("-"+l+" "+n+" -"+n+" "+l+" -"+n+" 0 c"),r.push("-"+n+" -"+l+" -"+l+" -"+n+" 0 -"+n+" c"),r.push(l+" -"+n+" "+n+" -"+l+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Ia(e);t.scope=e.scope;var r=[],n=At.internal.getWidth(e)<=At.internal.getHeight(e)?At.internal.getWidth(e)/4:At.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*At.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+ll(At.internal.getWidth(e)/2)+" "+ll(At.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),r.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),r.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),r.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:At.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=At.RadioButton.Cross.YesNormal,t.D[e]=At.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Ia(e);t.scope=e.scope;var r=[],n=At.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Qt(At.internal.getWidth(e)-2)+" "+Qt(At.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Qt(n.x1.x)+" "+Qt(n.x1.y)+" m"),r.push(Qt(n.x2.x)+" "+Qt(n.x2.y)+" l"),r.push(Qt(n.x4.x)+" "+Qt(n.x4.y)+" m"),r.push(Qt(n.x3.x)+" "+Qt(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Ia(e);t.scope=e.scope;var r=At.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Qt(At.internal.getWidth(e))+" "+Qt(At.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Qt(At.internal.getWidth(e)-2)+" "+Qt(At.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Qt(r.x1.x)+" "+Qt(r.x1.y)+" m"),n.push(Qt(r.x2.x)+" "+Qt(r.x2.y)+" l"),n.push(Qt(r.x4.x)+" "+Qt(r.x4.y)+" m"),n.push(Qt(r.x3.x)+" "+Qt(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Ia(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Qt(At.internal.getWidth(e))+" "+Qt(At.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};At.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=At.internal.getWidth(e),r=At.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},At.internal.getWidth=function(e){var t=0;return Er(e)==="object"&&(t=o5(e.Rect[2])),t},At.internal.getHeight=function(e){var t=0;return Er(e)==="object"&&(t=o5(e.Rect[3])),t};var DL=ln.addField=function(e){if(FL(this,e),!(e instanceof Sa))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};ln.AcroFormChoiceField=Zu,ln.AcroFormListBox=ef,ln.AcroFormComboBox=tf,ln.AcroFormEditBox=Mp,ln.AcroFormButton=ei,ln.AcroFormPushButton=Rp,ln.AcroFormRadioButton=rf,ln.AcroFormCheckBox=Bp,ln.AcroFormTextField=Sc,ln.AcroFormPasswordField=Up,ln.AcroFormAppearance=At,ln.AcroForm={ChoiceField:Zu,ListBox:ef,ComboBox:tf,EditBox:Mp,Button:ei,PushButton:Rp,RadioButton:rf,CheckBox:Bp,TextField:Sc,PasswordField:Up,Appearance:At},Mt.AcroForm={ChoiceField:Zu,ListBox:ef,ComboBox:tf,EditBox:Mp,Button:ei,PushButton:Rp,RadioButton:rf,CheckBox:Bp,TextField:Sc,PasswordField:Up,Appearance:At};Mt.AcroForm;function nC(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=e.__addimage__.getImageFileTypeByImageData=function(F,M){var V,G,te,ee,Q,K=r;if((M=M||r)==="RGBA"||F.data!==void 0&&F.data instanceof Uint8ClampedArray&&"height"in F&&"width"in F)return"RGBA";if(T(F))for(Q in n)for(te=n[Q],V=0;V<te.length;V+=1){for(ee=!0,G=0;G<te[V].length;G+=1)if(te[V][G]!==void 0&&te[V][G]!==F[G]){ee=!1;break}if(ee===!0){K=Q;break}}else for(Q in n)for(te=n[Q],V=0;V<te.length;V+=1){for(ee=!0,G=0;G<te[V].length;G+=1)if(te[V][G]!==void 0&&te[V][G]!==F.charCodeAt(G)){ee=!1;break}if(ee===!0){K=Q;break}}return K===r&&M!==r&&(K=M),K},s=function F(M){for(var V=this.internal.write,G=this.internal.putStream,te=(0,this.internal.getFilters)();te.indexOf("FlateEncode")!==-1;)te.splice(te.indexOf("FlateEncode"),1);M.objectId=this.internal.newObject();var ee=[];if(ee.push({key:"Type",value:"/XObject"}),ee.push({key:"Subtype",value:"/Image"}),ee.push({key:"Width",value:M.width}),ee.push({key:"Height",value:M.height}),M.colorSpace===x.INDEXED?ee.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(M.palette.length/3-1)+" "+("sMask"in M&&M.sMask!==void 0?M.objectId+2:M.objectId+1)+" 0 R]"}):(ee.push({key:"ColorSpace",value:"/"+M.colorSpace}),M.colorSpace===x.DEVICE_CMYK&&ee.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ee.push({key:"BitsPerComponent",value:M.bitsPerComponent}),"decodeParameters"in M&&M.decodeParameters!==void 0&&ee.push({key:"DecodeParms",value:"<<"+M.decodeParameters+">>"}),"transparency"in M&&Array.isArray(M.transparency)&&M.transparency.length>0){for(var Q="",K=0,N=M.transparency.length;K<N;K++)Q+=M.transparency[K]+" "+M.transparency[K]+" ";ee.push({key:"Mask",value:"["+Q+"]"})}M.sMask!==void 0&&ee.push({key:"SMask",value:M.objectId+1+" 0 R"});var U=M.filter!==void 0?["/"+M.filter]:void 0;if(G({data:M.data,additionalKeyValues:ee,alreadyAppliedFilters:U,objectId:M.objectId}),V("endobj"),"sMask"in M&&M.sMask!==void 0){var R,k=(R=M.sMaskBitsPerComponent)!==null&&R!==void 0?R:M.bitsPerComponent,P={width:M.width,height:M.height,colorSpace:"DeviceGray",bitsPerComponent:k,data:M.sMask};"filter"in M&&(P.decodeParameters="/Predictor ".concat(M.predictor," /Colors 1 /BitsPerComponent ").concat(k," /Columns ").concat(M.width),P.filter=M.filter),F.call(this,P)}if(M.colorSpace===x.INDEXED){var A=this.internal.newObject();G({data:j(new Uint8Array(M.palette)),objectId:A}),V("endobj")}},l=function(){var F=this.internal.collections[t+"images"];for(var M in F)s.call(this,F[M])},o=function(){var F,M=this.internal.collections[t+"images"],V=this.internal.write;for(var G in M)V("/I"+(F=M[G]).index,F.objectId,"0","R")},a=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",l),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var F=this.internal.collections[t+"images"];return a.call(this),F},f=function(){return Object.keys(this.internal.collections[t+"images"]).length},h=function(F){return typeof e["process"+F.toUpperCase()]=="function"},d=function(F){return Er(F)==="object"&&F.nodeType===1},u=function(F,M){if(F.nodeName==="IMG"&&F.hasAttribute("src")){var V=""+F.getAttribute("src");if(V.indexOf("data:image/")===0)return Ip(unescape(V).split("base64,").pop());var G=e.loadFile(V,!0);if(G!==void 0)return G}if(F.nodeName==="CANVAS"){if(F.width===0||F.height===0)throw new Error("Given canvas must have data. Canvas width: "+F.width+", height: "+F.height);var te;switch(M){case"PNG":te="image/png";break;case"WEBP":te="image/webp";break;default:te="image/jpeg"}return Ip(F.toDataURL(te,1).split("base64,").pop())}},p=function(F){var M=this.internal.collections[t+"images"];if(M){for(var V in M)if(F===M[V].alias)return M[V]}},m=function(F,M,V){return F||M||(F=-96,M=-96),F<0&&(F=-1*V.width*72/F/this.internal.scaleFactor),M<0&&(M=-1*V.height*72/M/this.internal.scaleFactor),F===0&&(F=M*V.width/V.height),M===0&&(M=F*V.height/V.width),[F,M]},g=function(F,M,V,G,te,ee){var Q=m.call(this,V,G,te),K=this.internal.getCoordinateString,N=this.internal.getVerticalCoordinateString,U=c.call(this);if(V=Q[0],G=Q[1],U[te.index]=te,ee){ee*=Math.PI/180;var R=Math.cos(ee),k=Math.sin(ee),P=function(E){return E.toFixed(4)},A=[P(R),P(k),P(-1*k),P(R),0,0,"cm"]}this.internal.write("q"),ee?(this.internal.write([1,"0","0",1,K(F),N(M+G),"cm"].join(" ")),this.internal.write(A.join(" ")),this.internal.write([K(V),"0","0",K(G),"0","0","cm"].join(" "))):this.internal.write([K(V),"0","0",K(G),K(F),N(M+G),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+te.index+" Do"),this.internal.write("Q")},x=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(F){var M,V,G=0;if(typeof F=="string")for(V=F.length,M=0;M<V;M++)G=(G<<5)-G+F.charCodeAt(M),G|=0;else if(T(F))for(V=F.byteLength/2,M=0;M<V;M++)G=(G<<5)-G+F[M],G|=0;return G},b=e.__addimage__.validateStringAsBase64=function(F){(F=F||"").toString().trim();var M=!0;return F.length===0&&(M=!1),F.length%4!=0&&(M=!1),/^[A-Za-z0-9+/]+$/.test(F.substr(0,F.length-2))===!1&&(M=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(F.substr(-2))===!1&&(M=!1),M},S=e.__addimage__.extractImageFromDataUrl=function(F){if(F==null||!(F=F.trim()).startsWith("data:"))return null;var M=F.indexOf(",");return M<0?null:F.substring(0,M).trim().endsWith("base64")?F.substring(M+1):null};e.__addimage__.isArrayBuffer=function(F){return F instanceof ArrayBuffer};var T=e.__addimage__.isArrayBufferView=function(F){return F instanceof Int8Array||F instanceof Uint8Array||F instanceof Uint8ClampedArray||F instanceof Int16Array||F instanceof Uint16Array||F instanceof Int32Array||F instanceof Uint32Array||F instanceof Float32Array||F instanceof Float64Array},O=e.__addimage__.binaryStringToUint8Array=function(F){for(var M=F.length,V=new Uint8Array(M),G=0;G<M;G++)V[G]=F.charCodeAt(G);return V},j=e.__addimage__.arrayBufferToBinaryString=function(F){for(var M="",V=T(F)?F:new Uint8Array(F),G=0;G<V.length;G+=8192)M+=String.fromCharCode.apply(null,V.subarray(G,G+8192));return M};e.addImage=function(){var F,M,V,G,te,ee,Q,K,N;if(typeof arguments[1]=="number"?(M=r,V=arguments[1],G=arguments[2],te=arguments[3],ee=arguments[4],Q=arguments[5],K=arguments[6],N=arguments[7]):(M=arguments[1],V=arguments[2],G=arguments[3],te=arguments[4],ee=arguments[5],Q=arguments[6],K=arguments[7],N=arguments[8]),Er(F=arguments[0])==="object"&&!d(F)&&"imageData"in F){var U=F;F=U.imageData,M=U.format||M||r,V=U.x||V||0,G=U.y||G||0,te=U.w||U.width||te,ee=U.h||U.height||ee,Q=U.alias||Q,K=U.compression||K,N=U.rotation||U.angle||N}var R=this.internal.getFilters();if(K===void 0&&R.indexOf("FlateEncode")!==-1&&(K="SLOW"),isNaN(V)||isNaN(G))throw new Error("Invalid coordinates passed to jsPDF.addImage");a.call(this);var k=L.call(this,F,M,Q,K);return g.call(this,V,G,te,ee,k,N),this};var L=function(F,M,V,G){var te,ee,Q;if(typeof F=="string"&&i(F)===r){F=unescape(F);var K=W(F,!1);(K!==""||(K=e.loadFile(F,!0))!==void 0)&&(F=K)}if(d(F)&&(F=u(F,M)),M=i(F,M),!h(M))throw new Error("addImage does not support files of type '"+M+"', please ensure that a plugin for '"+M+"' support is added.");if(((Q=V)==null||Q.length===0)&&(V=function(N){return typeof N=="string"||T(N)?w(N):T(N.data)?w(N.data):null}(F)),(te=p.call(this,V))||(F instanceof Uint8Array||M==="RGBA"||(ee=F,F=O(F)),te=this["process"+M.toUpperCase()](F,f.call(this),V,function(N){return N&&typeof N=="string"&&(N=N.toUpperCase()),N in e.image_compression?N:y.NONE}(G),ee)),!te)throw new Error("An unknown error occurred whilst processing the image.");return te},W=e.__addimage__.convertBase64ToBinaryString=function(F,M){M=typeof M!="boolean"||M;var V,G="";if(typeof F=="string"){var te;V=(te=S(F))!==null&&te!==void 0?te:F;try{G=Ip(V)}catch(ee){if(M)throw b(V)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ee.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return G};e.getImageProperties=function(F){var M,V,G="";if(d(F)&&(F=u(F)),typeof F=="string"&&i(F)===r&&((G=W(F,!1))===""&&(G=e.loadFile(F)||""),F=G),V=i(F),!h(V))throw new Error("addImage does not support files of type '"+V+"', please ensure that a plugin for '"+V+"' support is added.");if(F instanceof Uint8Array||(F=O(F)),!(M=this["process"+V.toUpperCase()](F)))throw new Error("An unknown error occurred whilst processing the image");return M.fileType=V,M}})(Mt.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Mt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,i,s,l=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,a=this.internal.getPageInfoByObjId(r.objId),c=r.pageContext.annotations,f=!1,h=0;h<c.length&&!f;h++)switch((n=c[h]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var d=0;d<c.length;d++){n=c[d];var u=this.internal.pdfEscape,p=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var m=this.internal.newAdditionalObject(),g=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(m.objId),y=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+l(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+l(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+u(x(n.contents))+")",s+=" /Popup "+g.objId+" 0 R",s+=" /P "+a.objId+" 0 R",s+=" /T ("+u(x(y))+") >>",m.content=s;var w=m.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+l(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+l(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(s+=" /Open true"),s+=" >>",g.content=s,this.internal.write(m.objId,"0 R",g.objId,"0 R");break;case"freetext":i="/Rect ["+l(n.bounds.x)+" "+o(n.bounds.y)+" "+l(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var b=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+u(p(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+b+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var S=this.annotations._nameMap[n.options.name];n.options.pageNumber=S.page,n.options.top=S.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+u(p(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;default:var T=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+T+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,i,s,l){var o=this.internal.getCurrentPageInfo(),a=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:a(r),y:c(n),w:a(r+i),h:c(n+s)},options:l,type:"link"})},e.textWithLink=function(r,n,i,s){var l,o,a=this.getTextWidth(r),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){o=s.maxWidth;var f=this.splitTextToSize(r,o).length;l=Math.ceil(c*f)}else o=a,l=c;return this.text(r,n,i,s),i+=.2*c,s.align==="center"&&(n-=a/2),s.align==="right"&&(n-=a),this.link(n,i-c,o,l,s),a},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Mt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(m){return t[m.charCodeAt(0)]!==void 0},l=e.__arabicParser__.isArabicLetter=function(m){return typeof m=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(m)},o=e.__arabicParser__.isArabicEndLetter=function(m){return l(m)&&s(m)&&t[m.charCodeAt(0)].length<=2},a=e.__arabicParser__.isArabicAlfLetter=function(m){return l(m)&&i.indexOf(m.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(m){return l(m)&&s(m)&&t[m.charCodeAt(0)].length>=1};var c=e.__arabicParser__.arabicLetterHasFinalForm=function(m){return l(m)&&s(m)&&t[m.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(m){return l(m)&&s(m)&&t[m.charCodeAt(0)].length>=3};var f=e.__arabicParser__.arabicLetterHasMedialForm=function(m){return l(m)&&s(m)&&t[m.charCodeAt(0)].length==4},h=e.__arabicParser__.resolveLigatures=function(m){var g=0,x=r,y="",w=0;for(g=0;g<m.length;g+=1)x[m.charCodeAt(g)]!==void 0?(w++,typeof(x=x[m.charCodeAt(g)])=="number"&&(y+=String.fromCharCode(x),x=r,w=0),g===m.length-1&&(x=r,y+=m.charAt(g-(w-1)),g-=w-1,w=0)):(x=r,y+=m.charAt(g-w),g-=w,w=0);return y};e.__arabicParser__.isArabicDiacritic=function(m){return m!==void 0&&n[m.charCodeAt(0)]!==void 0};var d=e.__arabicParser__.getCorrectForm=function(m,g,x){return l(m)?s(m)===!1?-1:!c(m)||!l(g)&&!l(x)||!l(x)&&o(g)||o(m)&&!l(g)||o(m)&&a(g)||o(m)&&o(g)?0:f(m)&&l(g)&&!o(g)&&l(x)&&c(x)?3:o(m)||!l(x)?1:2:-1},u=function(m){var g=0,x=0,y=0,w="",b="",S="",T=(m=m||"").split("\\s+"),O=[];for(g=0;g<T.length;g+=1){for(O.push(""),x=0;x<T[g].length;x+=1)w=T[g][x],b=T[g][x-1],S=T[g][x+1],l(w)?(y=d(w,b,S),O[g]+=y!==-1?String.fromCharCode(t[w.charCodeAt(0)][y]):w):O[g]+=w;O[g]=h(O[g])}return O.join(" ")},p=e.__arabicParser__.processArabic=e.processArabic=function(){var m,g=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(g)){var y=0;for(x=[],y=0;y<g.length;y+=1)Array.isArray(g[y])?x.push([u(g[y][0]),g[y][1],g[y][2]]):x.push([u(g[y])]);m=x}else m=u(g);return typeof arguments[0]=="string"?m:(arguments[0].text=m,arguments[0])};e.events.push(["preProcessText",p])}(Mt.API),Mt.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(o){s=o}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(o){l=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Mt.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var a=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return a},set:function(m){a=m}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(m){c=m}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(m){f=m}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(m){h=m}});var d=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return d},set:function(m){d=m}});var u=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return u},set:function(m){u=m}});var p=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return p},set:function(m){p=m}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(a){return n.call(this),this.internal.__cell__.headerFunction=typeof a=="function"?a:void 0,this},e.getTextDimensions=function(a,c){n.call(this);var f=(c=c||{}).fontSize||this.getFontSize(),h=c.font||this.getFont(),d=c.scaleFactor||this.internal.scaleFactor,u=0,p=0,m=0,g=this;if(!Array.isArray(a)&&typeof a!="string"){if(typeof a!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");a=String(a)}var x=c.maxWidth;x>0?typeof a=="string"?a=this.splitTextToSize(a,x):Object.prototype.toString.call(a)==="[object Array]"&&(a=a.reduce(function(w,b){return w.concat(g.splitTextToSize(b,x))},[])):a=Array.isArray(a)?a:[a];for(var y=0;y<a.length;y++)u<(m=this.getStringUnitWidth(a[y],{font:h})*f)&&(u=m);return u!==0&&(p=a.length),{w:u/=d,h:Math.max((p*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/d,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var a=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(a.left,a.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=e.cell=function(){var a;a=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var c=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,h=this.internal.__cell__.margins||t,d=this.internal.__cell__.tableHeaderRow,u=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===a.lineNumber?(a.x=(c.x||0)+(c.width||0),a.y=c.y||0):c.y+c.height+a.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),a.y=h.top,u&&d&&(this.printHeaderRow(a.lineNumber,!0),a.y+=d[0].height)):a.y=c.y+c.height||a.y),a.text[0]!==void 0&&(this.rect(a.x,a.y,a.width,a.height,r===!0?"FD":void 0),a.align==="right"?this.text(a.text,a.x+a.width-f,a.y+f,{align:"right",baseline:"top"}):a.align==="center"?this.text(a.text,a.x+a.width/2,a.y+f,{align:"center",baseline:"top",maxWidth:a.width-f-f}):this.text(a.text,a.x+f,a.y+f,{align:"left",baseline:"top",maxWidth:a.width-f-f})),this.internal.__cell__.lastCell=a,this};e.table=function(a,c,f,h,d){if(n.call(this),!f)throw new Error("No data for PDF table.");var u,p,m,g,x=[],y=[],w=[],b={},S={},T=[],O=[],j=(d=d||{}).autoSize||!1,L=d.printHeaders!==!1,W=d.css&&d.css["font-size"]!==void 0?16*d.css["font-size"]:d.fontSize||12,F=d.margins||Object.assign({width:this.getPageWidth()},t),M=typeof d.padding=="number"?d.padding:3,V=d.headerBackgroundColor||"#c8c8c8",G=d.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=L,this.internal.__cell__.margins=F,this.internal.__cell__.table_font_size=W,this.internal.__cell__.padding=M,this.internal.__cell__.headerBackgroundColor=V,this.internal.__cell__.headerTextColor=G,this.setFontSize(W),h==null)y=x=Object.keys(f[0]),w=x.map(function(){return"left"});else if(Array.isArray(h)&&Er(h[0])==="object")for(x=h.map(function(U){return U.name}),y=h.map(function(U){return U.prompt||U.name||""}),w=h.map(function(U){return U.align||"left"}),u=0;u<h.length;u+=1)S[h[u].name]=.7499990551181103*h[u].width;else Array.isArray(h)&&typeof h[0]=="string"&&(y=x=h,w=x.map(function(){return"left"}));if(j||Array.isArray(h)&&typeof h[0]=="string")for(u=0;u<x.length;u+=1){for(b[g=x[u]]=f.map(function(U){return U[g]}),this.setFont(void 0,"bold"),T.push(this.getTextDimensions(y[u],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),p=b[g],this.setFont(void 0,"normal"),m=0;m<p.length;m+=1)T.push(this.getTextDimensions(p[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);S[g]=Math.max.apply(null,T)+M+M,T=[]}if(L){var te={};for(u=0;u<x.length;u+=1)te[x[u]]={},te[x[u]].text=y[u],te[x[u]].align=w[u];var ee=o.call(this,te,S);O=x.map(function(U){return new s(a,c,S[U],ee,te[U].text,void 0,te[U].align)}),this.setTableHeaderRow(O),this.printHeaderRow(1,!1)}var Q=h.reduce(function(U,R){return U[R.name]=R.align,U},{});for(u=0;u<f.length;u+=1){"rowStart"in d&&d.rowStart instanceof Function&&d.rowStart({row:u,data:f[u]},this);var K=o.call(this,f[u],S);for(m=0;m<x.length;m+=1){var N=f[u][x[m]];"cellStart"in d&&d.cellStart instanceof Function&&d.cellStart({row:u,col:m,data:N},this),l.call(this,new s(a,c,S[x[m]],K,N,u+2,Q[x[m]]))}}return this.internal.__cell__.table_x=a,this.internal.__cell__.table_y=c,this};var o=function(a,c){var f=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,d=this.internal.scaleFactor;return Object.keys(a).map(function(u){var p=a[u];return this.splitTextToSize(p.hasOwnProperty("text")?p.text:p,c[u]-f-f)},this).map(function(u){return this.getLineHeightFactor()*u.length*h/d+f+f},this).reduce(function(u,p){return Math.max(u,p)},0)};e.setTableHeaderRow=function(a){n.call(this),this.internal.__cell__.tableHeaderRow=a},e.printHeaderRow=function(a,c){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var d=[],u=0;u<this.internal.__cell__.tableHeaderRow.length;u+=1){f=this.internal.__cell__.tableHeaderRow[u].clone(),c&&(f.y=this.internal.__cell__.margins.top||0,d.push(f)),f.lineNumber=a;var p=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,f),this.setTextColor(p)}d.length>0&&this.setTableHeaderRow(d),this.setFont(void 0,"normal"),r=!1}}(Mt.API);var iC={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},sC=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Pv=nC(sC),aC=[100,200,300,400,500,600,700,800,900],LL=nC(aC);function X1(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return iC[s=s||"normal"]?s:"normal"}(e.style),n=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(e.weight),i=function(s){return typeof Pv[s=s||"normal"]=="number"?s:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:i,src:e.src||[],ref:e.ref||{name:t,style:[i,r,n].join(" ")}}}function l5(e,t,r,n){var i;for(i=r;i>=0&&i<t.length;i+=n)if(e[t[i]])return e[t[i]];for(i=r;i>=0&&i<t.length;i-=n)if(e[t[i]])return e[t[i]]}var IL={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},c5={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function u5(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function f5(e){return e.trimLeft()}function ML(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function RL(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var lp,h5,d5,wu,cp,p5,g5,m5,Y1=["times"];function x5(e,t,r,n,i){var s=4,l=y5;switch(i){case Mt.API.image_compression.FAST:s=1,l=v5;break;case Mt.API.image_compression.MEDIUM:s=6,l=w5;break;case Mt.API.image_compression.SLOW:s=9,l=b5}e=function(a,c,f,h){for(var d,u=a.length/c,p=new Uint8Array(a.length+u),m=[BL,v5,y5,w5,b5],g=0;g<u;g+=1){var x=g*c,y=a.subarray(x,x+c);if(h)p.set(h(y,f,d),x+g);else{for(var w=m.length,b=[],S=0;S<w;S+=1)b[S]=m[S](y,f,d);var T=zL(b.concat());p.set(b[T],x+g)}d=y}return p}(e,t,Math.ceil(r*n/8),l);var o=Cv(e,{level:s});return Mt.API.__addimage__.arrayBufferToBinaryString(o)}function BL(e){var t=Array.apply([],e);return t.unshift(0),t}function v5(e,t){var r=e.length,n=[];n[0]=1;for(var i=0;i<r;i+=1){var s=e[i-t]||0;n[i+1]=e[i]-s+256&255}return n}function y5(e,t,r){var n=e.length,i=[];i[0]=2;for(var s=0;s<n;s+=1){var l=r&&r[s]||0;i[s+1]=e[s]-l+256&255}return i}function w5(e,t,r){var n=e.length,i=[];i[0]=3;for(var s=0;s<n;s+=1){var l=e[s-t]||0,o=r&&r[s]||0;i[s+1]=e[s]+256-(l+o>>>1)&255}return i}function b5(e,t,r){var n=e.length,i=[];i[0]=4;for(var s=0;s<n;s+=1){var l=UL(e[s-t]||0,r&&r[s]||0,r&&r[s-t]||0);i[s+1]=e[s]-l+256&255}return i}function UL(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),i=Math.abs(e-r),s=Math.abs(e+t-r-r);return n<=i&&n<=s?e:i<=s?t:r}function zL(e){var t=e.map(function(r){return r.reduce(function(n,i){return n+Math.abs(i)},0)});return t.indexOf(Math.min.apply(null,t))}function K1(e,t,r){var n=t*r,i=Math.floor(n/8),s=16-(n-8*i+r),l=(1<<r)-1;return oC(e,i)>>s&l}function _5(e,t,r,n){var i=r*n,s=Math.floor(i/8),l=16-(i-8*s+n),o=(1<<n)-1,a=(t&o)<<l;(function(c,f,h){if(f+1<c.byteLength)c.setUint16(f,h,!1);else{var d=h>>8&255;c.setUint8(f,d)}})(e,s,oC(e,s)&~(o<<l)&65535|a)}function oC(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function WL(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,i=e[t++],s=i>>7,l=1<<1+(7&i);e[t++],e[t++];var o=null,a=null;s&&(o=t,a=l,t+=3*l);var c=!0,f=[],h=0,d=null,u=0,p=null;for(this.width=r,this.height=n;c&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,p=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var m=e[t++];h=e[t++]|e[t++]<<8,d=e[t++],1&m||(d=null),u=m>>2&7,t++;break;case 254:for(;;){if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var g=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,b=e[t++],S=b>>6&1,T=1<<1+(7&b),O=o,j=a,L=!1;b>>7&&(L=!0,O=t,j=T,t+=3*T);var W=t;for(t++;;){var F;if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}f.push({x:g,y:x,width:y,height:w,has_local_palette:L,palette_offset:O,palette_size:j,data_offset:W,data_length:t-W,transparent_index:d,interlaced:!!S,delay:h,disposal:u});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return p},this.frameInfo=function(M){if(M<0||M>=f.length)throw new Error("Frame index out of range.");return f[M]},this.decodeAndBlitFrameBGRA=function(M,V){var G=this.frameInfo(M),te=G.width*G.height,ee=new Uint8Array(te);k5(e,G.data_offset,ee,te);var Q=G.palette_offset,K=G.transparent_index;K===null&&(K=256);var N=G.width,U=r-N,R=N,k=4*(G.y*r+G.x),P=4*((G.y+G.height)*r+G.x),A=k,E=4*U;G.interlaced===!0&&(E+=4*r*7);for(var I=8,H=0,J=ee.length;H<J;++H){var Y=ee[H];if(R===0&&(R=N,(A+=E)>=P&&(E=4*U+4*r*(I-1),A=k+(N+U)*(I<<1),I>>=1)),Y===K)A+=4;else{var Z=e[Q+3*Y],fe=e[Q+3*Y+1],X=e[Q+3*Y+2];V[A++]=X,V[A++]=fe,V[A++]=Z,V[A++]=255}--R}},this.decodeAndBlitFrameRGBA=function(M,V){var G=this.frameInfo(M),te=G.width*G.height,ee=new Uint8Array(te);k5(e,G.data_offset,ee,te);var Q=G.palette_offset,K=G.transparent_index;K===null&&(K=256);var N=G.width,U=r-N,R=N,k=4*(G.y*r+G.x),P=4*((G.y+G.height)*r+G.x),A=k,E=4*U;G.interlaced===!0&&(E+=4*r*7);for(var I=8,H=0,J=ee.length;H<J;++H){var Y=ee[H];if(R===0&&(R=N,(A+=E)>=P&&(E=4*U+4*r*(I-1),A=k+(N+U)*(I<<1),I>>=1)),Y===K)A+=4;else{var Z=e[Q+3*Y],fe=e[Q+3*Y+1],X=e[Q+3*Y+2];V[A++]=Z,V[A++]=fe,V[A++]=X,V[A++]=255}--R}}}function k5(e,t,r,n){for(var i=e[t++],s=1<<i,l=s+1,o=l+1,a=i+1,c=(1<<a)-1,f=0,h=0,d=0,u=e[t++],p=new Int32Array(4096),m=null;;){for(;f<16&&u!==0;)h|=e[t++]<<f,f+=8,u===1?u=e[t++]:--u;if(f<a)break;var g=h&c;if(h>>=a,f-=a,g!==s){if(g===l)break;for(var x=g<o?g:m,y=0,w=x;w>s;)w=p[w]>>8,++y;var b=w;if(d+y+(x!==g?1:0)>n)return void Fr.log("Warning, gif stream longer than expected.");r[d++]=b;var S=d+=y;for(x!==g&&(r[d++]=b),w=x;y--;)w=p[w],r[--S]=255&w,w>>=8;m!==null&&o<4096&&(p[o++]=m<<8|b,o>=c+1&&a<12&&(++a,c=c<<1|1)),m=g}else o=l+1,c=(1<<(a=i+1))-1,m=null}return d!==n&&Fr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function J1(e){var t,r,n,i,s,l=Math.floor,o=new Array(64),a=new Array(64),c=new Array(64),f=new Array(64),h=new Array(65535),d=new Array(65535),u=new Array(64),p=new Array(64),m=[],g=0,x=7,y=new Array(64),w=new Array(64),b=new Array(64),S=new Array(256),T=new Array(2048),O=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],j=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],L=[0,1,2,3,4,5,6,7,8,9,10,11],W=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],F=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],M=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],V=[0,1,2,3,4,5,6,7,8,9,10,11],G=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],te=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ee(k,P){for(var A=0,E=0,I=new Array,H=1;H<=16;H++){for(var J=1;J<=k[H];J++)I[P[E]]=[],I[P[E]][0]=A,I[P[E]][1]=H,E++,A++;A*=2}return I}function Q(k){for(var P=k[0],A=k[1]-1;A>=0;)P&1<<A&&(g|=1<<x),A--,--x<0&&(g==255?(K(255),K(0)):K(g),x=7,g=0)}function K(k){m.push(k)}function N(k){K(k>>8&255),K(255&k)}function U(k,P,A,E,I){for(var H,J=I[0],Y=I[240],Z=function(ye,de){var Te,pe,Ae,Ie,je,Le,Xe,Je,Ne,Oe,De=0;for(Ne=0;Ne<8;++Ne){Te=ye[De],pe=ye[De+1],Ae=ye[De+2],Ie=ye[De+3],je=ye[De+4],Le=ye[De+5],Xe=ye[De+6];var Ye=Te+(Je=ye[De+7]),it=Te-Je,Ke=pe+Xe,et=pe-Xe,Ge=Ae+Le,ot=Ae-Le,_t=Ie+je,yt=Ie-je,St=Ye+_t,Bt=Ye-_t,qt=Ke+Ge,Ct=Ke-Ge;ye[De]=St+qt,ye[De+4]=St-qt;var sr=.707106781*(Ct+Bt);ye[De+2]=Bt+sr,ye[De+6]=Bt-sr;var Xi=.382683433*((St=yt+ot)-(Ct=et+it)),Dr=.5411961*St+Xi,ii=1.306562965*Ct+Xi,Ii=.707106781*(qt=ot+et),Et=it+Ii,Jn=it-Ii;ye[De+5]=Jn+Dr,ye[De+3]=Jn-Dr,ye[De+1]=Et+ii,ye[De+7]=Et-ii,De+=8}for(De=0,Ne=0;Ne<8;++Ne){Te=ye[De],pe=ye[De+8],Ae=ye[De+16],Ie=ye[De+24],je=ye[De+32],Le=ye[De+40],Xe=ye[De+48];var ta=Te+(Je=ye[De+56]),vi=Te-Je,Yi=pe+Xe,Gr=pe-Xe,An=Ae+Le,ae=Ae-Le,ke=Ie+je,ge=Ie-je,ve=ta+ke,Se=ta-ke,Ee=Yi+An,Ue=Yi-An;ye[De]=ve+Ee,ye[De+32]=ve-Ee;var Qe=.707106781*(Ue+Se);ye[De+16]=Se+Qe,ye[De+48]=Se-Qe;var ze=.382683433*((ve=ge+ae)-(Ue=Gr+vi)),We=.5411961*ve+ze,Ve=1.306562965*Ue+ze,ft=.707106781*(Ee=ae+Gr),mt=vi+ft,kt=vi-ft;ye[De+40]=kt+We,ye[De+24]=kt-We,ye[De+8]=mt+Ve,ye[De+56]=mt-Ve,De++}for(Ne=0;Ne<64;++Ne)Oe=ye[Ne]*de[Ne],u[Ne]=Oe>0?Oe+.5|0:Oe-.5|0;return u}(k,P),fe=0;fe<64;++fe)p[O[fe]]=Z[fe];var X=p[0]-A;A=p[0],X==0?Q(E[0]):(Q(E[d[H=32767+X]]),Q(h[H]));for(var re=63;re>0&&p[re]==0;)re--;if(re==0)return Q(J),A;for(var se,z=1;z<=re;){for(var oe=z;p[z]==0&&z<=re;)++z;var ce=z-oe;if(ce>=16){se=ce>>4;for(var we=1;we<=se;++we)Q(Y);ce&=15}H=32767+p[z],Q(I[(ce<<4)+d[H]]),Q(h[H]),z++}return re!=63&&Q(J),A}function R(k){k=Math.min(Math.max(k,1),100),s!=k&&(function(P){for(var A=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],E=0;E<64;E++){var I=l((A[E]*P+50)/100);I=Math.min(Math.max(I,1),255),o[O[E]]=I}for(var H=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],J=0;J<64;J++){var Y=l((H[J]*P+50)/100);Y=Math.min(Math.max(Y,1),255),a[O[J]]=Y}for(var Z=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],fe=0,X=0;X<8;X++)for(var re=0;re<8;re++)c[fe]=1/(o[O[fe]]*Z[X]*Z[re]*8),f[fe]=1/(a[O[fe]]*Z[X]*Z[re]*8),fe++}(k<50?Math.floor(5e3/k):Math.floor(200-2*k)),s=k)}this.encode=function(k,P){P&&R(P),m=new Array,g=0,x=7,N(65496),N(65504),N(16),K(74),K(70),K(73),K(70),K(0),K(1),K(1),K(0),N(1),N(1),K(0),K(0),function(){N(65499),N(132),K(0);for(var pe=0;pe<64;pe++)K(o[pe]);K(1);for(var Ae=0;Ae<64;Ae++)K(a[Ae])}(),function(pe,Ae){N(65472),N(17),K(8),N(Ae),N(pe),K(3),K(1),K(17),K(0),K(2),K(17),K(1),K(3),K(17),K(1)}(k.width,k.height),function(){N(65476),N(418),K(0);for(var pe=0;pe<16;pe++)K(j[pe+1]);for(var Ae=0;Ae<=11;Ae++)K(L[Ae]);K(16);for(var Ie=0;Ie<16;Ie++)K(W[Ie+1]);for(var je=0;je<=161;je++)K(F[je]);K(1);for(var Le=0;Le<16;Le++)K(M[Le+1]);for(var Xe=0;Xe<=11;Xe++)K(V[Xe]);K(17);for(var Je=0;Je<16;Je++)K(G[Je+1]);for(var Ne=0;Ne<=161;Ne++)K(te[Ne])}(),N(65498),N(12),K(3),K(1),K(0),K(2),K(17),K(3),K(17),K(0),K(63),K(0);var A=0,E=0,I=0;g=0,x=7,this.encode.displayName="_encode_";for(var H,J,Y,Z,fe,X,re,se,z,oe=k.data,ce=k.width,we=k.height,ye=4*ce,de=0;de<we;){for(H=0;H<ye;){for(fe=ye*de+H,re=-1,se=0,z=0;z<64;z++)X=fe+(se=z>>3)*ye+(re=4*(7&z)),de+se>=we&&(X-=ye*(de+1+se-we)),H+re>=ye&&(X-=H+re-ye+4),J=oe[X++],Y=oe[X++],Z=oe[X++],y[z]=(T[J]+T[Y+256|0]+T[Z+512|0]>>16)-128,w[z]=(T[J+768|0]+T[Y+1024|0]+T[Z+1280|0]>>16)-128,b[z]=(T[J+1280|0]+T[Y+1536|0]+T[Z+1792|0]>>16)-128;A=U(y,c,A,t,n),E=U(w,f,E,r,i),I=U(b,f,I,r,i),H+=32}de+=8}if(x>=0){var Te=[];Te[1]=x+1,Te[0]=(1<<x+1)-1,Q(Te)}return N(65497),new Uint8Array(m)},e=e||50,function(){for(var k=String.fromCharCode,P=0;P<256;P++)S[P]=k(P)}(),t=ee(j,L),r=ee(M,V),n=ee(W,F),i=ee(G,te),function(){for(var k=1,P=2,A=1;A<=15;A++){for(var E=k;E<P;E++)d[32767+E]=A,h[32767+E]=[],h[32767+E][1]=A,h[32767+E][0]=E;for(var I=-(P-1);I<=-k;I++)d[32767+I]=A,h[32767+I]=[],h[32767+I][1]=A,h[32767+I][0]=P-1+I;k<<=1,P<<=1}}(),function(){for(var k=0;k<256;k++)T[k]=19595*k,T[k+256|0]=38470*k,T[k+512|0]=7471*k+32768,T[k+768|0]=-11059*k,T[k+1024|0]=-21709*k,T[k+1280|0]=32768*k+8421375,T[k+1536|0]=-27439*k,T[k+1792|0]=-5329*k}(),R(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function ca(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function S5(e){function t(L){if(!L)throw Error("assert :P")}function r(L,W,F){for(var M=0;4>M;M++)if(L[W+M]!=F.charCodeAt(M))return!0;return!1}function n(L,W,F,M,V){for(var G=0;G<V;G++)L[W+G]=F[M+G]}function i(L,W,F,M){for(var V=0;V<M;V++)L[W+V]=F}function s(L){return new Int32Array(L)}function l(L,W){for(var F=[],M=0;M<L;M++)F.push(new W);return F}function o(L,W){var F=[];return function M(V,G,te){for(var ee=te[G],Q=0;Q<ee&&(V.push(te.length>G+1?[]:new W),!(te.length<G+1));Q++)M(V[Q],G+1,te)}(F,0,L),F}var a=function(){var L=this;function W(_,C){for(var B=1<<C-1>>>0;_&B;)B>>>=1;return B?(_&B-1)+B:_}function F(_,C,B,q,ie){t(!(q%B));do _[C+(q-=B)]=ie;while(0<q)}function M(_,C,B,q,ie){if(t(2328>=ie),512>=ie)var le=s(512);else if((le=s(ie))==null)return 0;return function(ue,he,me,be,Fe,qe){var _e,Me,Be=he,tt=1<<me,$e=s(16),nt=s(16);for(t(Fe!=0),t(be!=null),t(ue!=null),t(0<me),Me=0;Me<Fe;++Me){if(15<be[Me])return 0;++$e[be[Me]]}if($e[0]==Fe)return 0;for(nt[1]=0,_e=1;15>_e;++_e){if($e[_e]>1<<_e)return 0;nt[_e+1]=nt[_e]+$e[_e]}for(Me=0;Me<Fe;++Me)_e=be[Me],0<be[Me]&&(qe[nt[_e]++]=Me);if(nt[15]==1)return(be=new V).g=0,be.value=qe[0],F(ue,Be,1,tt,be),tt;var at,ht=-1,ut=tt-1,Lt=0,Nt=1,rr=1,jt=1<<me;for(Me=0,_e=1,Fe=2;_e<=me;++_e,Fe<<=1){if(Nt+=rr<<=1,0>(rr-=$e[_e]))return 0;for(;0<$e[_e];--$e[_e])(be=new V).g=_e,be.value=qe[Me++],F(ue,Be+Lt,Fe,jt,be),Lt=W(Lt,_e)}for(_e=me+1,Fe=2;15>=_e;++_e,Fe<<=1){if(Nt+=rr<<=1,0>(rr-=$e[_e]))return 0;for(;0<$e[_e];--$e[_e]){if(be=new V,(Lt&ut)!=ht){for(Be+=jt,at=1<<(ht=_e)-me;15>ht&&!(0>=(at-=$e[ht]));)++ht,at<<=1;tt+=jt=1<<(at=ht-me),ue[he+(ht=Lt&ut)].g=at+me,ue[he+ht].value=Be-he-ht}be.g=_e-me,be.value=qe[Me++],F(ue,Be+(Lt>>me),Fe,jt,be),Lt=W(Lt,_e)}}return Nt!=2*nt[15]-1?0:tt}(_,C,B,q,ie,le)}function V(){this.value=this.g=0}function G(){this.value=this.g=0}function te(){this.G=l(5,V),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(rc,G)}function ee(_,C,B,q){t(_!=null),t(C!=null),t(2147483648>q),_.Ca=254,_.I=0,_.b=-8,_.Ka=0,_.oa=C,_.pa=B,_.Jd=C,_.Yc=B+q,_.Zc=4<=q?B+q-4+1:B,J(_)}function Q(_,C){for(var B=0;0<C--;)B|=Z(_,128)<<C;return B}function K(_,C){var B=Q(_,C);return Y(_)?-B:B}function N(_,C,B,q){var ie,le=0;for(t(_!=null),t(C!=null),t(4294967288>q),_.Sb=q,_.Ra=0,_.u=0,_.h=0,4<q&&(q=4),ie=0;ie<q;++ie)le+=C[B+ie]<<8*ie;_.Ra=le,_.bb=q,_.oa=C,_.pa=B}function U(_){for(;8<=_.u&&_.bb<_.Sb;)_.Ra>>>=8,_.Ra+=_.oa[_.pa+_.bb]<<Xo-8>>>0,++_.bb,_.u-=8;E(_)&&(_.h=1,_.u=0)}function R(_,C){if(t(0<=C),!_.h&&C<=ls){var B=A(_)&os[C];return _.u+=C,U(_),B}return _.h=1,_.u=0}function k(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function P(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function A(_){return _.Ra>>>(_.u&Xo-1)>>>0}function E(_){return t(_.bb<=_.Sb),_.h||_.bb==_.Sb&&_.u>Xo}function I(_,C){_.u=C,_.h=E(_)}function H(_){_.u>=ho&&(t(_.u>=ho),U(_))}function J(_){t(_!=null&&_.oa!=null),_.pa<_.Zc?(_.I=(_.oa[_.pa++]|_.I<<8)>>>0,_.b+=8):(t(_!=null&&_.oa!=null),_.pa<_.Yc?(_.b+=8,_.I=_.oa[_.pa++]|_.I<<8):_.Ka?_.b=0:(_.I<<=8,_.b+=8,_.Ka=1))}function Y(_){return Q(_,1)}function Z(_,C){var B=_.Ca;0>_.b&&J(_);var q=_.b,ie=B*C>>>8,le=(_.I>>>q>ie)+0;for(le?(B-=ie,_.I-=ie+1<<q>>>0):B=ie+1,q=B,ie=0;256<=q;)ie+=8,q>>=8;return q=7^ie+Yo[q],_.b-=q,_.Ca=(B<<q)-1,le}function fe(_,C,B){_[C+0]=B>>24&255,_[C+1]=B>>16&255,_[C+2]=B>>8&255,_[C+3]=255&B}function X(_,C){return _[C+0]|_[C+1]<<8}function re(_,C){return X(_,C)|_[C+2]<<16}function se(_,C){return X(_,C)|X(_,C+2)<<16}function z(_,C){var B=1<<C;return t(_!=null),t(0<C),_.X=s(B),_.X==null?0:(_.Mb=32-C,_.Xa=C,1)}function oe(_,C){t(_!=null),t(C!=null),t(_.Xa==C.Xa),n(C.X,0,_.X,0,1<<C.Xa)}function ce(){this.X=[],this.Xa=this.Mb=0}function we(_,C,B,q){t(B!=null),t(q!=null);var ie=B[0],le=q[0];return ie==0&&(ie=(_*le+C/2)/C),le==0&&(le=(C*ie+_/2)/_),0>=ie||0>=le?0:(B[0]=ie,q[0]=le,1)}function ye(_,C){return _+(1<<C)-1>>>C}function de(_,C){return((4278255360&_)+(4278255360&C)>>>0&4278255360)+((16711935&_)+(16711935&C)>>>0&16711935)>>>0}function Te(_,C){L[C]=function(B,q,ie,le,ue,he,me){var be;for(be=0;be<ue;++be){var Fe=L[_](he[me+be-1],ie,le+be);he[me+be]=de(B[q+be],Fe)}}}function pe(){this.ud=this.hd=this.jd=0}function Ae(_,C){return((4278124286&(_^C))>>>1)+(_&C)>>>0}function Ie(_){return 0<=_&&256>_?_:0>_?0:255<_?255:void 0}function je(_,C){return Ie(_+(_-C+.5>>1))}function Le(_,C,B){return Math.abs(C-B)-Math.abs(_-B)}function Xe(_,C,B,q,ie,le,ue){for(q=le[ue-1],B=0;B<ie;++B)le[ue+B]=q=de(_[C+B],q)}function Je(_,C,B,q,ie){var le;for(le=0;le<B;++le){var ue=_[C+le],he=ue>>8&255,me=16711935&(me=(me=16711935&ue)+((he<<16)+he));q[ie+le]=(4278255360&ue)+me>>>0}}function Ne(_,C){C.jd=255&_,C.hd=_>>8&255,C.ud=_>>16&255}function Oe(_,C,B,q,ie,le){var ue;for(ue=0;ue<q;++ue){var he=C[B+ue],me=he>>>8,be=he,Fe=255&(Fe=(Fe=he>>>16)+((_.jd<<24>>24)*(me<<24>>24)>>>5));be=255&(be=(be+=(_.hd<<24>>24)*(me<<24>>24)>>>5)+((_.ud<<24>>24)*(Fe<<24>>24)>>>5)),ie[le+ue]=(4278255360&he)+(Fe<<16)+be}}function De(_,C,B,q,ie){L[C]=function(le,ue,he,me,be,Fe,qe,_e,Me){for(me=qe;me<_e;++me)for(qe=0;qe<Me;++qe)be[Fe++]=ie(he[q(le[ue++])])},L[_]=function(le,ue,he,me,be,Fe,qe){var _e=8>>le.b,Me=le.Ea,Be=le.K[0],tt=le.w;if(8>_e)for(le=(1<<le.b)-1,tt=(1<<_e)-1;ue<he;++ue){var $e,nt=0;for($e=0;$e<Me;++$e)$e&le||(nt=q(me[be++])),Fe[qe++]=ie(Be[nt&tt]),nt>>=_e}else L["VP8LMapColor"+B](me,be,Be,tt,Fe,qe,ue,he,Me)}}function Ye(_,C,B,q,ie){for(B=C+B;C<B;){var le=_[C++];q[ie++]=le>>16&255,q[ie++]=le>>8&255,q[ie++]=255&le}}function it(_,C,B,q,ie){for(B=C+B;C<B;){var le=_[C++];q[ie++]=le>>16&255,q[ie++]=le>>8&255,q[ie++]=255&le,q[ie++]=le>>24&255}}function Ke(_,C,B,q,ie){for(B=C+B;C<B;){var le=(ue=_[C++])>>16&240|ue>>12&15,ue=240&ue|ue>>28&15;q[ie++]=le,q[ie++]=ue}}function et(_,C,B,q,ie){for(B=C+B;C<B;){var le=(ue=_[C++])>>16&248|ue>>13&7,ue=ue>>5&224|ue>>3&31;q[ie++]=le,q[ie++]=ue}}function Ge(_,C,B,q,ie){for(B=C+B;C<B;){var le=_[C++];q[ie++]=255&le,q[ie++]=le>>8&255,q[ie++]=le>>16&255}}function ot(_,C,B,q,ie,le){if(le==0)for(B=C+B;C<B;)fe(q,((le=_[C++])[0]>>24|le[1]>>8&65280|le[2]<<8&16711680|le[3]<<24)>>>0),ie+=32;else n(q,ie,_,C,B)}function _t(_,C){L[C][0]=L[_+"0"],L[C][1]=L[_+"1"],L[C][2]=L[_+"2"],L[C][3]=L[_+"3"],L[C][4]=L[_+"4"],L[C][5]=L[_+"5"],L[C][6]=L[_+"6"],L[C][7]=L[_+"7"],L[C][8]=L[_+"8"],L[C][9]=L[_+"9"],L[C][10]=L[_+"10"],L[C][11]=L[_+"11"],L[C][12]=L[_+"12"],L[C][13]=L[_+"13"],L[C][14]=L[_+"0"],L[C][15]=L[_+"0"]}function yt(_){return _==Dm||_==Lm||_==b0||_==Im}function St(){this.eb=[],this.size=this.A=this.fb=0}function Bt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function qt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new St,this.f.kb=new Bt,this.sd=null}function Ct(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function sr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Xi(_){return alert("todo:WebPSamplerProcessPlane"),_.T}function Dr(_,C){var B=_.T,q=C.ba.f.RGBA,ie=q.eb,le=q.fb+_.ka*q.A,ue=Rs[C.ba.S],he=_.y,me=_.O,be=_.f,Fe=_.N,qe=_.ea,_e=_.W,Me=C.cc,Be=C.dc,tt=C.Mc,$e=C.Nc,nt=_.ka,at=_.ka+_.T,ht=_.U,ut=ht+1>>1;for(nt==0?ue(he,me,null,null,be,Fe,qe,_e,be,Fe,qe,_e,ie,le,null,null,ht):(ue(C.ec,C.fc,he,me,Me,Be,tt,$e,be,Fe,qe,_e,ie,le-q.A,ie,le,ht),++B);nt+2<at;nt+=2)Me=be,Be=Fe,tt=qe,$e=_e,Fe+=_.Rc,_e+=_.Rc,le+=2*q.A,ue(he,(me+=2*_.fa)-_.fa,he,me,Me,Be,tt,$e,be,Fe,qe,_e,ie,le-q.A,ie,le,ht);return me+=_.fa,_.j+at<_.o?(n(C.ec,C.fc,he,me,ht),n(C.cc,C.dc,be,Fe,ut),n(C.Mc,C.Nc,qe,_e,ut),B--):1&at||ue(he,me,null,null,be,Fe,qe,_e,be,Fe,qe,_e,ie,le+q.A,null,null,ht),B}function ii(_,C,B){var q=_.F,ie=[_.J];if(q!=null){var le=_.U,ue=C.ba.S,he=ue==w0||ue==b0;C=C.ba.f.RGBA;var me=[0],be=_.ka;me[0]=_.T,_.Kb&&(be==0?--me[0]:(--be,ie[0]-=_.width),_.j+_.ka+_.T==_.o&&(me[0]=_.o-_.j-be));var Fe=C.eb;be=C.fb+be*C.A,_=ew(q,ie[0],_.width,le,me,Fe,be+(he?0:3),C.A),t(B==me),_&&yt(ue)&&Qf(Fe,be,he,le,me,C.A)}return 0}function Ii(_){var C=_.ma,B=C.ba.S,q=11>B,ie=B==v0||B==y0||B==w0||B==Fm||B==12||yt(B);if(C.memory=null,C.Ib=null,C.Jb=null,C.Nd=null,!$f(C.Oa,_,ie?11:12))return 0;if(ie&&yt(B)&&zf(),_.da)alert("todo:use_scaling");else{if(q){if(C.Ib=Xi,_.Kb){if(B=_.U+1>>1,C.memory=s(_.U+2*B),C.memory==null)return 0;C.ec=C.memory,C.fc=0,C.cc=C.ec,C.dc=C.fc+_.U,C.Mc=C.cc,C.Nc=C.dc+B,C.Ib=Dr,zf()}}else alert("todo:EmitYUV");ie&&(C.Jb=ii,q&&ia())}if(q&&!mw){for(_=0;256>_;++_)nN[_]=89858*(_-128)+k0>>_0,aN[_]=-22014*(_-128)+k0,sN[_]=-45773*(_-128),iN[_]=113618*(_-128)+k0>>_0;for(_=eh;_<Bm;++_)C=76283*(_-16)+k0>>_0,oN[_-eh]=On(C,255),lN[_-eh]=On(C+8>>4,15);mw=1}return 1}function Et(_){var C=_.ma,B=_.U,q=_.T;return t(!(1&_.ka)),0>=B||0>=q?0:(B=C.Ib(_,C),C.Jb!=null&&C.Jb(_,C,B),C.Dc+=B,1)}function Jn(_){_.ma.memory=null}function ta(_,C,B,q){return R(_,8)!=47?0:(C[0]=R(_,14)+1,B[0]=R(_,14)+1,q[0]=R(_,1),R(_,3)!=0?0:!_.h)}function vi(_,C){if(4>_)return _+1;var B=_-2>>1;return(2+(1&_)<<B)+R(C,B)+1}function Yi(_,C){return 120<C?C-120:1<=(B=((B=HT[C-1])>>4)*_+(8-(15&B)))?B:1;var B}function Gr(_,C,B){var q=A(B),ie=_[C+=255&q].g-8;return 0<ie&&(I(B,B.u+8),q=A(B),C+=_[C].value,C+=q&(1<<ie)-1),I(B,B.u+_[C].g),_[C].value}function An(_,C,B){return B.g+=_.g,B.value+=_.value<<C>>>0,t(8>=B.g),_.g}function ae(_,C,B){var q=_.xc;return t((C=q==0?0:_.vc[_.md*(B>>q)+(C>>q)])<_.Wb),_.Ya[C]}function ke(_,C,B,q){var ie=_.ab,le=_.c*C,ue=_.C;C=ue+C;var he=B,me=q;for(q=_.Ta,B=_.Ua;0<ie--;){var be=_.gc[ie],Fe=ue,qe=C,_e=he,Me=me,Be=(me=q,he=B,be.Ea);switch(t(Fe<qe),t(qe<=be.nc),be.hc){case 2:mn(_e,Me,(qe-Fe)*Be,me,he);break;case 0:var tt=Fe,$e=qe,nt=me,at=he,ht=(jt=be).Ea;tt==0&&(Vf(_e,Me,null,null,1,nt,at),Xe(_e,Me+1,0,0,ht-1,nt,at+1),Me+=ht,at+=ht,++tt);for(var ut=1<<jt.b,Lt=ut-1,Nt=ye(ht,jt.b),rr=jt.K,jt=jt.w+(tt>>jt.b)*Nt;tt<$e;){var ur=rr,Hn=jt,nr=1;for(lu(_e,Me,nt,at-ht,1,nt,at);nr<ht;){var Pt=(nr&~Lt)+ut;Pt>ht&&(Pt=ht),(0,Xf[ur[Hn++]>>8&15])(_e,Me+ +nr,nt,at+nr-ht,Pt-nr,nt,at+nr),nr=Pt}Me+=ht,at+=ht,++tt&Lt||(jt+=Nt)}qe!=be.nc&&n(me,he-Be,me,he+(qe-Fe-1)*Be,Be);break;case 1:for(Be=_e,$e=Me,ht=(_e=be.Ea)-(at=_e&~(nt=(Me=1<<be.b)-1)),tt=ye(_e,be.b),ut=be.K,be=be.w+(Fe>>be.b)*tt;Fe<qe;){for(Lt=ut,Nt=be,rr=new pe,jt=$e+at,ur=$e+_e;$e<jt;)Ne(Lt[Nt++],rr),Yf(rr,Be,$e,Me,me,he),$e+=Me,he+=Me;$e<ur&&(Ne(Lt[Nt++],rr),Yf(rr,Be,$e,ht,me,he),$e+=ht,he+=ht),++Fe&nt||(be+=tt)}break;case 3:if(_e==me&&Me==he&&0<be.b){for($e=me,_e=Be=he+(qe-Fe)*Be-(at=(qe-Fe)*ye(be.Ea,be.b)),Me=me,nt=he,tt=[],at=(ht=at)-1;0<=at;--at)tt[at]=Me[nt+at];for(at=ht-1;0<=at;--at)$e[_e+at]=tt[at];p0(be,Fe,qe,me,Be,me,he)}else p0(be,Fe,qe,_e,Me,me,he)}he=q,me=B}me!=B&&n(q,B,he,me,le)}function ge(_,C){var B=_.V,q=_.Ba+_.c*_.C,ie=C-_.C;if(t(C<=_.l.o),t(16>=ie),0<ie){var le=_.l,ue=_.Ta,he=_.Ua,me=le.width;if(ke(_,ie,B,q),ie=he=[he],t((B=_.C)<(q=C)),t(le.v<le.va),q>le.o&&(q=le.o),B<le.j){var be=le.j-B;B=le.j,ie[0]+=be*me}if(B>=q?B=0:(ie[0]+=4*le.v,le.ka=B-le.j,le.U=le.va-le.v,le.T=q-B,B=1),B){if(he=he[0],11>(B=_.ca).S){var Fe=B.f.RGBA,qe=(q=B.S,ie=le.U,le=le.T,be=Fe.eb,Fe.A),_e=le;for(Fe=Fe.fb+_.Ma*Fe.A;0<_e--;){var Me=ue,Be=he,tt=ie,$e=be,nt=Fe;switch(q){case x0:Kf(Me,Be,tt,$e,nt);break;case v0:Ko(Me,Be,tt,$e,nt);break;case Dm:Ko(Me,Be,tt,$e,nt),Qf($e,nt,0,tt,1,0);break;case ow:nc(Me,Be,tt,$e,nt);break;case y0:ot(Me,Be,tt,$e,nt,1);break;case Lm:ot(Me,Be,tt,$e,nt,1),Qf($e,nt,0,tt,1,0);break;case w0:ot(Me,Be,tt,$e,nt,0);break;case b0:ot(Me,Be,tt,$e,nt,0),Qf($e,nt,1,tt,1,0);break;case Fm:Jo(Me,Be,tt,$e,nt);break;case Im:Jo(Me,Be,tt,$e,nt),Zy($e,nt,tt,1,0);break;case lw:Qo(Me,Be,tt,$e,nt);break;default:t(0)}he+=me,Fe+=qe}_.Ma+=le}else alert("todo:EmitRescaledRowsYUVA");t(_.Ma<=B.height)}}_.C=C,t(_.C<=_.i)}function ve(_){var C;if(0<_.ua)return 0;for(C=0;C<_.Wb;++C){var B=_.Ya[C].G,q=_.Ya[C].H;if(0<B[1][q[1]+0].g||0<B[2][q[2]+0].g||0<B[3][q[3]+0].g)return 0}return 1}function Se(_,C,B,q,ie,le){if(_.Z!=0){var ue=_.qd,he=_.rd;for(t(tl[_.Z]!=null);C<B;++C)tl[_.Z](ue,he,q,ie,q,ie,le),ue=q,he=ie,ie+=le;_.qd=ue,_.rd=he}}function Ee(_,C){var B=_.l.ma,q=B.Z==0||B.Z==1?_.l.j:_.C;if(q=_.C<q?q:_.C,t(C<=_.l.o),C>q){var ie=_.l.width,le=B.ca,ue=B.tb+ie*q,he=_.V,me=_.Ba+_.c*q,be=_.gc;t(_.ab==1),t(be[0].hc==3),ja(be[0],q,C,he,me,le,ue),Se(B,q,C,le,ue,ie)}_.C=_.Ma=C}function Ue(_,C,B,q,ie,le,ue){var he=_.$/q,me=_.$%q,be=_.m,Fe=_.s,qe=B+_.$,_e=qe;ie=B+q*ie;var Me=B+q*le,Be=280+Fe.ua,tt=_.Pb?he:16777216,$e=0<Fe.ua?Fe.Wa:null,nt=Fe.wc,at=qe<Me?ae(Fe,me,he):null;t(_.C<le),t(Me<=ie);var ht=!1;e:for(;;){for(;ht||qe<Me;){var ut=0;if(he>=tt){var Lt=qe-B;t((tt=_).Pb),tt.wd=tt.m,tt.xd=Lt,0<tt.s.ua&&oe(tt.s.Wa,tt.s.vb),tt=he+qT}if(me&nt||(at=ae(Fe,me,he)),t(at!=null),at.Qb&&(C[qe]=at.qb,ht=!0),!ht)if(H(be),at.jc){ut=be,Lt=C;var Nt=qe,rr=at.pd[A(ut)&rc-1];t(at.jc),256>rr.g?(I(ut,ut.u+rr.g),Lt[Nt]=rr.value,ut=0):(I(ut,ut.u+rr.g-256),t(256<=rr.value),ut=rr.value),ut==0&&(ht=!0)}else ut=Gr(at.G[0],at.H[0],be);if(be.h)break;if(ht||256>ut){if(!ht)if(at.nd)C[qe]=(at.qb|ut<<8)>>>0;else{if(H(be),ht=Gr(at.G[1],at.H[1],be),H(be),Lt=Gr(at.G[2],at.H[2],be),Nt=Gr(at.G[3],at.H[3],be),be.h)break;C[qe]=(Nt<<24|ht<<16|ut<<8|Lt)>>>0}if(ht=!1,++qe,++me>=q&&(me=0,++he,ue!=null&&he<=le&&!(he%16)&&ue(_,he),$e!=null))for(;_e<qe;)ut=C[_e++],$e.X[(506832829*ut&4294967295)>>>$e.Mb]=ut}else if(280>ut){if(ut=vi(ut-256,be),Lt=Gr(at.G[4],at.H[4],be),H(be),Lt=Yi(q,Lt=vi(Lt,be)),be.h)break;if(qe-B<Lt||ie-qe<ut)break e;for(Nt=0;Nt<ut;++Nt)C[qe+Nt]=C[qe+Nt-Lt];for(qe+=ut,me+=ut;me>=q;)me-=q,++he,ue!=null&&he<=le&&!(he%16)&&ue(_,he);if(t(qe<=ie),me&nt&&(at=ae(Fe,me,he)),$e!=null)for(;_e<qe;)ut=C[_e++],$e.X[(506832829*ut&4294967295)>>>$e.Mb]=ut}else{if(!(ut<Be))break e;for(ht=ut-280,t($e!=null);_e<qe;)ut=C[_e++],$e.X[(506832829*ut&4294967295)>>>$e.Mb]=ut;ut=qe,t(!(ht>>>(Lt=$e).Xa)),C[ut]=Lt.X[ht],ht=!0}ht||t(be.h==E(be))}if(_.Pb&&be.h&&qe<ie)t(_.m.h),_.a=5,_.m=_.wd,_.$=_.xd,0<_.s.ua&&oe(_.s.vb,_.s.Wa);else{if(be.h)break e;ue!=null&&ue(_,he>le?le:he),_.a=0,_.$=qe-B}return 1}return _.a=3,0}function Qe(_){t(_!=null),_.vc=null,_.yc=null,_.Ya=null;var C=_.Wa;C!=null&&(C.X=null),_.vb=null,t(_!=null)}function ze(){var _=new Yt;return _==null?null:(_.a=0,_.xb=fw,_t("Predictor","VP8LPredictors"),_t("Predictor","VP8LPredictors_C"),_t("PredictorAdd","VP8LPredictorsAdd"),_t("PredictorAdd","VP8LPredictorsAdd_C"),mn=Je,Yf=Oe,Kf=Ye,Ko=it,Jo=Ke,Qo=et,nc=Ge,L.VP8LMapColor32b=Oa,L.VP8LMapColor8b=Gf,_)}function We(_,C,B,q,ie){var le=1,ue=[_],he=[C],me=q.m,be=q.s,Fe=null,qe=0;e:for(;;){if(B)for(;le&&R(me,1);){var _e=ue,Me=he,Be=q,tt=1,$e=Be.m,nt=Be.gc[Be.ab],at=R($e,2);if(Be.Oc&1<<at)le=0;else{switch(Be.Oc|=1<<at,nt.hc=at,nt.Ea=_e[0],nt.nc=Me[0],nt.K=[null],++Be.ab,t(4>=Be.ab),at){case 0:case 1:nt.b=R($e,3)+2,tt=We(ye(nt.Ea,nt.b),ye(nt.nc,nt.b),0,Be,nt.K),nt.K=nt.K[0];break;case 3:var ht,ut=R($e,8)+1,Lt=16<ut?0:4<ut?1:2<ut?2:3;if(_e[0]=ye(nt.Ea,Lt),nt.b=Lt,ht=tt=We(ut,1,0,Be,nt.K)){var Nt,rr=ut,jt=nt,ur=1<<(8>>jt.b),Hn=s(ur);if(Hn==null)ht=0;else{var nr=jt.K[0],Pt=jt.w;for(Hn[0]=jt.K[0][0],Nt=1;Nt<1*rr;++Nt)Hn[Nt]=de(nr[Pt+Nt],Hn[Nt-1]);for(;Nt<4*ur;++Nt)Hn[Nt]=0;jt.K[0]=null,jt.K[0]=Hn,ht=1}}tt=ht;break;case 2:break;default:t(0)}le=tt}}if(ue=ue[0],he=he[0],le&&R(me,1)&&!(le=1<=(qe=R(me,4))&&11>=qe)){q.a=3;break e}var wt;if(wt=le)t:{var vn,Zt,fr,Br=q,oi=ue,Ri=he,an=qe,yi=B,Bi=Br.m,$n=Br.s,dr=[null],wr=1,on=0,br=$T[an];r:for(;;){if(yi&&R(Bi,1)){var li=R(Bi,3)+2,aa=ye(oi,li),yn=ye(Ri,li),Ki=aa*yn;if(!We(aa,yn,0,Br,dr))break r;for(dr=dr[0],$n.xc=li,vn=0;vn<Ki;++vn){var Pr=dr[vn]>>8&65535;dr[vn]=Pr,Pr>=wr&&(wr=Pr+1)}}if(Bi.h)break r;for(Zt=0;5>Zt;++Zt){var qn=cw[Zt];!Zt&&0<an&&(qn+=1<<an),on<qn&&(on=qn)}var us=l(wr*br,V),Ui=wr,fs=l(Ui,te);if(fs==null)var hs=null;else t(65536>=Ui),hs=fs;var Ji=s(on);if(hs==null||Ji==null||us==null){Br.a=1;break r}var ds=us;for(vn=fr=0;vn<wr;++vn){var Ir=hs[vn],ps=Ir.G,oa=Ir.H,sc=0,mo=1,ci=0;for(Zt=0;5>Zt;++Zt){qn=cw[Zt],ps[Zt]=ds,oa[Zt]=fr,!Zt&&0<an&&(qn+=1<<an);i:{var C0,Um=qn,E0=Br,th=Ji,fN=ds,hN=fr,zm=0,rl=E0.m,dN=R(rl,1);if(i(th,0,0,Um),dN){var pN=R(rl,1)+1,gN=R(rl,1),yw=R(rl,gN==0?1:8);th[yw]=1,pN==2&&(th[yw=R(rl,8)]=1);var T0=1}else{var ww=s(19),bw=R(rl,4)+4;if(19<bw){E0.a=3;var N0=0;break i}for(C0=0;C0<bw;++C0)ww[WT[C0]]=R(rl,3);var Wm=void 0,rh=void 0,_w=E0,mN=ww,A0=Um,kw=th,Hm=0,nl=_w.m,Sw=8,Cw=l(128,V);n:for(;M(Cw,0,7,mN,19);){if(R(nl,1)){var xN=2+2*R(nl,3);if((Wm=2+R(nl,xN))>A0)break n}else Wm=A0;for(rh=0;rh<A0&&Wm--;){H(nl);var Ew=Cw[0+(127&A(nl))];I(nl,nl.u+Ew.g);var uu=Ew.value;if(16>uu)kw[rh++]=uu,uu!=0&&(Sw=uu);else{var vN=uu==16,Tw=uu-16,yN=UT[Tw],Nw=R(nl,BT[Tw])+yN;if(rh+Nw>A0)break n;for(var wN=vN?Sw:0;0<Nw--;)kw[rh++]=wN}}Hm=1;break n}Hm||(_w.a=3),T0=Hm}(T0=T0&&!rl.h)&&(zm=M(fN,hN,8,th,Um)),T0&&zm!=0?N0=zm:(E0.a=3,N0=0)}if(N0==0)break r;if(mo&&zT[Zt]==1&&(mo=ds[fr].g==0),sc+=ds[fr].g,fr+=N0,3>=Zt){var nh,$m=Ji[0];for(nh=1;nh<qn;++nh)Ji[nh]>$m&&($m=Ji[nh]);ci+=$m}}if(Ir.nd=mo,Ir.Qb=0,mo&&(Ir.qb=(ps[3][oa[3]+0].value<<24|ps[1][oa[1]+0].value<<16|ps[2][oa[2]+0].value)>>>0,sc==0&&256>ps[0][oa[0]+0].value&&(Ir.Qb=1,Ir.qb+=ps[0][oa[0]+0].value<<8)),Ir.jc=!Ir.Qb&&6>ci,Ir.jc){var O0,xo=Ir;for(O0=0;O0<rc;++O0){var il=O0,sl=xo.pd[il],j0=xo.G[0][xo.H[0]+il];256<=j0.value?(sl.g=j0.g+256,sl.value=j0.value):(sl.g=0,sl.value=0,il>>=An(j0,8,sl),il>>=An(xo.G[1][xo.H[1]+il],16,sl),il>>=An(xo.G[2][xo.H[2]+il],0,sl),An(xo.G[3][xo.H[3]+il],24,sl))}}}$n.vc=dr,$n.Wb=wr,$n.Ya=hs,$n.yc=us,wt=1;break t}wt=0}if(!(le=wt)){q.a=3;break e}if(0<qe){if(be.ua=1<<qe,!z(be.Wa,qe)){q.a=1,le=0;break e}}else be.ua=0;var qm=q,Aw=ue,bN=he,Vm=qm.s,Gm=Vm.xc;if(qm.c=Aw,qm.i=bN,Vm.md=ye(Aw,Gm),Vm.wc=Gm==0?-1:(1<<Gm)-1,B){q.xb=QT;break e}if((Fe=s(ue*he))==null){q.a=1,le=0;break e}le=(le=Ue(q,Fe,0,ue,he,he,null))&&!me.h;break e}return le?(ie!=null?ie[0]=Fe:(t(Fe==null),t(B)),q.$=0,B||Qe(be)):Qe(be),le}function Ve(_,C){var B=_.c*_.i,q=B+C+16*C;return t(_.c<=C),_.V=s(q),_.V==null?(_.Ta=null,_.Ua=0,_.a=1,0):(_.Ta=_.V,_.Ua=_.Ba+B+C,1)}function ft(_,C){var B=_.C,q=C-B,ie=_.V,le=_.Ba+_.c*B;for(t(C<=_.l.o);0<q;){var ue=16<q?16:q,he=_.l.ma,me=_.l.width,be=me*ue,Fe=he.ca,qe=he.tb+me*B,_e=_.Ta,Me=_.Ua;ke(_,ue,ie,le),tw(_e,Me,Fe,qe,be),Se(he,B,B+ue,Fe,qe,me),q-=ue,ie+=ue*_.c,B+=ue}t(B==C),_.C=_.Ma=C}function mt(){this.ub=this.yd=this.td=this.Rb=0}function kt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function gt(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function bt(){this.Yb=function(){var _=[];return function C(B,q,ie){for(var le=ie[q],ue=0;ue<le&&(B.push(ie.length>q+1?[]:0),!(ie.length<q+1));ue++)C(B[ue],q+1,ie)}(_,0,[3,11]),_}()}function Vt(){this.jb=s(3),this.Wc=o([4,8],bt),this.Xc=o([4,17],bt)}function Ar(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function cr(){this.ld=this.La=this.dd=this.tc=0}function sn(){this.Na=this.la=0}function Ea(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ra(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ta(){this.uc=this.M=this.Nb=0,this.wa=Array(new cr),this.Y=0,this.ya=Array(new ra),this.aa=0,this.l=new tu}function Fs(){this.y=s(16),this.f=s(8),this.ea=s(8)}function $o(){this.cb=this.a=0,this.sc="",this.m=new k,this.Od=new mt,this.Kc=new kt,this.ed=new Ar,this.Qa=new gt,this.Ic=this.$c=this.Aa=0,this.D=new Ta,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,k),this.ia=0,this.pb=l(4,Ea),this.Pa=new Vt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Fs),this.Hd=0,this.rb=Array(new sn),this.sb=0,this.wa=Array(new cr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ra),this.L=this.aa=0,this.gd=o([4,2],cr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function On(_,C){return 0>_?0:_>C?C:_}function tu(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function xm(){var _=new $o;return _!=null&&(_.a=0,_.sc="OK",_.cb=0,_.Xb=0,Zf||(Zf=ru)),_}function jn(_,C,B){return _.a==0&&(_.a=C,_.sc=B,_.cb=0),0}function r0(_,C,B){return 3<=B&&_[C+0]==157&&_[C+1]==1&&_[C+2]==42}function Na(_,C){if(_==null)return 0;if(_.a=0,_.sc="OK",C==null)return jn(_,2,"null VP8Io passed to VP8GetHeaders()");var B=C.data,q=C.w,ie=C.ha;if(4>ie)return jn(_,7,"Truncated header.");var le=B[q+0]|B[q+1]<<8|B[q+2]<<16,ue=_.Od;if(ue.Rb=!(1&le),ue.td=le>>1&7,ue.yd=le>>4&1,ue.ub=le>>5,3<ue.td)return jn(_,3,"Incorrect keyframe parameters.");if(!ue.yd)return jn(_,4,"Frame not displayable.");q+=3,ie-=3;var he=_.Kc;if(ue.Rb){if(7>ie)return jn(_,7,"cannot parse picture header");if(!r0(B,q,ie))return jn(_,3,"Bad code word");he.c=16383&(B[q+4]<<8|B[q+3]),he.Td=B[q+4]>>6,he.i=16383&(B[q+6]<<8|B[q+5]),he.Ud=B[q+6]>>6,q+=7,ie-=7,_.za=he.c+15>>4,_.Ub=he.i+15>>4,C.width=he.c,C.height=he.i,C.Da=0,C.j=0,C.v=0,C.va=C.width,C.o=C.height,C.da=0,C.ib=C.width,C.hb=C.height,C.U=C.width,C.T=C.height,i((le=_.Pa).jb,0,255,le.jb.length),t((le=_.Qa)!=null),le.Cb=0,le.Bb=0,le.Fb=1,i(le.Zb,0,0,le.Zb.length),i(le.Lb,0,0,le.Lb)}if(ue.ub>ie)return jn(_,7,"bad partition length");ee(le=_.m,B,q,ue.ub),q+=ue.ub,ie-=ue.ub,ue.Rb&&(he.Ld=Y(le),he.Kd=Y(le)),he=_.Qa;var me,be=_.Pa;if(t(le!=null),t(he!=null),he.Cb=Y(le),he.Cb){if(he.Bb=Y(le),Y(le)){for(he.Fb=Y(le),me=0;4>me;++me)he.Zb[me]=Y(le)?K(le,7):0;for(me=0;4>me;++me)he.Lb[me]=Y(le)?K(le,6):0}if(he.Bb)for(me=0;3>me;++me)be.jb[me]=Y(le)?Q(le,8):255}else he.Bb=0;if(le.Ka)return jn(_,3,"cannot parse segment header");if((he=_.ed).zd=Y(le),he.Tb=Q(le,6),he.wb=Q(le,3),he.Pc=Y(le),he.Pc&&Y(le)){for(be=0;4>be;++be)Y(le)&&(he.vd[be]=K(le,6));for(be=0;4>be;++be)Y(le)&&(he.od[be]=K(le,6))}if(_.L=he.Tb==0?0:he.zd?1:2,le.Ka)return jn(_,3,"cannot parse filter header");var Fe=ie;if(ie=me=q,q=me+Fe,he=Fe,_.Xb=(1<<Q(_.m,2))-1,Fe<3*(be=_.Xb))B=7;else{for(me+=3*be,he-=3*be,Fe=0;Fe<be;++Fe){var qe=B[ie+0]|B[ie+1]<<8|B[ie+2]<<16;qe>he&&(qe=he),ee(_.Jc[+Fe],B,me,qe),me+=qe,he-=qe,ie+=3}ee(_.Jc[+be],B,me,he),B=me<q?0:5}if(B!=0)return jn(_,B,"cannot parse partitions");for(B=Q(me=_.m,7),ie=Y(me)?K(me,4):0,q=Y(me)?K(me,4):0,he=Y(me)?K(me,4):0,be=Y(me)?K(me,4):0,me=Y(me)?K(me,4):0,Fe=_.Qa,qe=0;4>qe;++qe){if(Fe.Cb){var _e=Fe.Zb[qe];Fe.Fb||(_e+=B)}else{if(0<qe){_.pb[qe]=_.pb[0];continue}_e=B}var Me=_.pb[qe];Me.Sc[0]=Mm[On(_e+ie,127)],Me.Sc[1]=Rm[On(_e+0,127)],Me.Eb[0]=2*Mm[On(_e+q,127)],Me.Eb[1]=101581*Rm[On(_e+he,127)]>>16,8>Me.Eb[1]&&(Me.Eb[1]=8),Me.Qc[0]=Mm[On(_e+be,117)],Me.Qc[1]=Rm[On(_e+me,127)],Me.lc=_e+me}if(!ue.Rb)return jn(_,4,"Not a key frame.");for(Y(le),ue=_.Pa,B=0;4>B;++B){for(ie=0;8>ie;++ie)for(q=0;3>q;++q)for(he=0;11>he;++he)be=Z(le,KT[B][ie][q][he])?Q(le,8):XT[B][ie][q][he],ue.Wc[B][ie].Yb[q][he]=be;for(ie=0;17>ie;++ie)ue.Xc[B][ie]=ue.Wc[B][JT[ie]]}return _.kc=Y(le),_.kc&&(_.Bd=Q(le,8)),_.cb=1}function ru(_,C,B,q,ie,le,ue){var he=C[ie].Yb[B];for(B=0;16>ie;++ie){if(!Z(_,he[B+0]))return ie;for(;!Z(_,he[B+1]);)if(he=C[++ie].Yb[0],B=0,ie==16)return 16;var me=C[ie+1].Yb;if(Z(_,he[B+2])){var be=_,Fe=0;if(Z(be,(_e=he)[(qe=B)+3]))if(Z(be,_e[qe+6])){for(he=0,qe=2*(Fe=Z(be,_e[qe+8]))+(_e=Z(be,_e[qe+9+Fe])),Fe=0,_e=VT[qe];_e[he];++he)Fe+=Fe+Z(be,_e[he]);Fe+=3+(8<<qe)}else Z(be,_e[qe+7])?(Fe=7+2*Z(be,165),Fe+=Z(be,145)):Fe=5+Z(be,159);else Fe=Z(be,_e[qe+4])?3+Z(be,_e[qe+5]):2;he=me[2]}else Fe=1,he=me[1];me=ue+GT[ie],0>(be=_).b&&J(be);var qe,_e=be.b,Me=(qe=be.Ca>>1)-(be.I>>_e)>>31;--be.b,be.Ca+=Me,be.Ca|=1,be.I-=(qe+1&Me)<<_e,le[me]=((Fe^Me)-Me)*q[(0<ie)+0]}return 16}function n0(_){var C=_.rb[_.sb-1];C.la=0,C.Na=0,i(_.zc,0,0,_.zc.length),_.ja=0}function Ds(_,C,B,q,ie){ie=_[C+B+32*q]+(ie>>3),_[C+B+32*q]=-256&ie?0>ie?0:255:ie}function Un(_,C,B,q,ie,le){Ds(_,C,0,B,q+ie),Ds(_,C,1,B,q+le),Ds(_,C,2,B,q-le),Ds(_,C,3,B,q-ie)}function ro(_){return(20091*_>>16)+_}function i0(_,C,B,q){var ie,le=0,ue=s(16);for(ie=0;4>ie;++ie){var he=_[C+0]+_[C+8],me=_[C+0]-_[C+8],be=(35468*_[C+4]>>16)-ro(_[C+12]),Fe=ro(_[C+4])+(35468*_[C+12]>>16);ue[le+0]=he+Fe,ue[le+1]=me+be,ue[le+2]=me-be,ue[le+3]=he-Fe,le+=4,C++}for(ie=le=0;4>ie;++ie)he=(_=ue[le+0]+4)+ue[le+8],me=_-ue[le+8],be=(35468*ue[le+4]>>16)-ro(ue[le+12]),Ds(B,q,0,0,he+(Fe=ro(ue[le+4])+(35468*ue[le+12]>>16))),Ds(B,q,1,0,me+be),Ds(B,q,2,0,me-be),Ds(B,q,3,0,he-Fe),le++,q+=32}function vm(_,C,B,q){var ie=_[C+0]+4,le=35468*_[C+4]>>16,ue=ro(_[C+4]),he=35468*_[C+1]>>16;Un(B,q,0,ie+ue,_=ro(_[C+1]),he),Un(B,q,1,ie+le,_,he),Un(B,q,2,ie-le,_,he),Un(B,q,3,ie-ue,_,he)}function ym(_,C,B,q,ie){i0(_,C,B,q),ie&&i0(_,C+16,B,q+4)}function Aa(_,C,B,q){ic(_,C+0,B,q,1),ic(_,C+32,B,q+128,1)}function s0(_,C,B,q){var ie;for(_=_[C+0]+4,ie=0;4>ie;++ie)for(C=0;4>C;++C)Ds(B,q,C,ie,_)}function a0(_,C,B,q){_[C+0]&&yr(_,C+0,B,q),_[C+16]&&yr(_,C+16,B,q+4),_[C+32]&&yr(_,C+32,B,q+128),_[C+48]&&yr(_,C+48,B,q+128+4)}function nu(_,C,B,q){var ie,le=s(16);for(ie=0;4>ie;++ie){var ue=_[C+0+ie]+_[C+12+ie],he=_[C+4+ie]+_[C+8+ie],me=_[C+4+ie]-_[C+8+ie],be=_[C+0+ie]-_[C+12+ie];le[0+ie]=ue+he,le[8+ie]=ue-he,le[4+ie]=be+me,le[12+ie]=be-me}for(ie=0;4>ie;++ie)ue=(_=le[0+4*ie]+3)+le[3+4*ie],he=le[1+4*ie]+le[2+4*ie],me=le[1+4*ie]-le[2+4*ie],be=_-le[3+4*ie],B[q+0]=ue+he>>3,B[q+16]=be+me>>3,B[q+32]=ue-he>>3,B[q+48]=be-me>>3,q+=64}function Vl(_,C,B){var q,ie=C-32,le=cs,ue=255-_[ie-1];for(q=0;q<B;++q){var he,me=le,be=ue+_[C-1];for(he=0;he<B;++he)_[C+he]=me[be+_[ie+he]];C+=32}}function wm(_,C){Vl(_,C,4)}function bm(_,C){Vl(_,C,8)}function _m(_,C){Vl(_,C,16)}function Ff(_,C){var B;for(B=0;16>B;++B)n(_,C+32*B,_,C-32,16)}function o0(_,C){var B;for(B=16;0<B;--B)i(_,C,_[C-1],16),C+=32}function na(_,C,B){var q;for(q=0;16>q;++q)i(C,B+32*q,_,16)}function km(_,C){var B,q=16;for(B=0;16>B;++B)q+=_[C-1+32*B]+_[C+B-32];na(q>>5,_,C)}function Gl(_,C){var B,q=8;for(B=0;16>B;++B)q+=_[C-1+32*B];na(q>>4,_,C)}function Df(_,C){var B,q=8;for(B=0;16>B;++B)q+=_[C+B-32];na(q>>4,_,C)}function Sm(_,C){na(128,_,C)}function Kt(_,C,B){return _+2*C+B+2>>2}function Cm(_,C){var B,q=C-32;for(q=new Uint8Array([Kt(_[q-1],_[q+0],_[q+1]),Kt(_[q+0],_[q+1],_[q+2]),Kt(_[q+1],_[q+2],_[q+3]),Kt(_[q+2],_[q+3],_[q+4])]),B=0;4>B;++B)n(_,C+32*B,q,0,q.length)}function Em(_,C){var B=_[C-1],q=_[C-1+32],ie=_[C-1+64],le=_[C-1+96];fe(_,C+0,16843009*Kt(_[C-1-32],B,q)),fe(_,C+32,16843009*Kt(B,q,ie)),fe(_,C+64,16843009*Kt(q,ie,le)),fe(_,C+96,16843009*Kt(ie,le,le))}function Tm(_,C){var B,q=4;for(B=0;4>B;++B)q+=_[C+B-32]+_[C-1+32*B];for(q>>=3,B=0;4>B;++B)i(_,C+32*B,q,4)}function no(_,C){var B=_[C-1+0],q=_[C-1+32],ie=_[C-1+64],le=_[C-1-32],ue=_[C+0-32],he=_[C+1-32],me=_[C+2-32],be=_[C+3-32];_[C+0+96]=Kt(q,ie,_[C-1+96]),_[C+1+96]=_[C+0+64]=Kt(B,q,ie),_[C+2+96]=_[C+1+64]=_[C+0+32]=Kt(le,B,q),_[C+3+96]=_[C+2+64]=_[C+1+32]=_[C+0+0]=Kt(ue,le,B),_[C+3+64]=_[C+2+32]=_[C+1+0]=Kt(he,ue,le),_[C+3+32]=_[C+2+0]=Kt(me,he,ue),_[C+3+0]=Kt(be,me,he)}function io(_,C){var B=_[C+1-32],q=_[C+2-32],ie=_[C+3-32],le=_[C+4-32],ue=_[C+5-32],he=_[C+6-32],me=_[C+7-32];_[C+0+0]=Kt(_[C+0-32],B,q),_[C+1+0]=_[C+0+32]=Kt(B,q,ie),_[C+2+0]=_[C+1+32]=_[C+0+64]=Kt(q,ie,le),_[C+3+0]=_[C+2+32]=_[C+1+64]=_[C+0+96]=Kt(ie,le,ue),_[C+3+32]=_[C+2+64]=_[C+1+96]=Kt(le,ue,he),_[C+3+64]=_[C+2+96]=Kt(ue,he,me),_[C+3+96]=Kt(he,me,me)}function Nm(_,C){var B=_[C-1+0],q=_[C-1+32],ie=_[C-1+64],le=_[C-1-32],ue=_[C+0-32],he=_[C+1-32],me=_[C+2-32],be=_[C+3-32];_[C+0+0]=_[C+1+64]=le+ue+1>>1,_[C+1+0]=_[C+2+64]=ue+he+1>>1,_[C+2+0]=_[C+3+64]=he+me+1>>1,_[C+3+0]=me+be+1>>1,_[C+0+96]=Kt(ie,q,B),_[C+0+64]=Kt(q,B,le),_[C+0+32]=_[C+1+96]=Kt(B,le,ue),_[C+1+32]=_[C+2+96]=Kt(le,ue,he),_[C+2+32]=_[C+3+96]=Kt(ue,he,me),_[C+3+32]=Kt(he,me,be)}function Am(_,C){var B=_[C+0-32],q=_[C+1-32],ie=_[C+2-32],le=_[C+3-32],ue=_[C+4-32],he=_[C+5-32],me=_[C+6-32],be=_[C+7-32];_[C+0+0]=B+q+1>>1,_[C+1+0]=_[C+0+64]=q+ie+1>>1,_[C+2+0]=_[C+1+64]=ie+le+1>>1,_[C+3+0]=_[C+2+64]=le+ue+1>>1,_[C+0+32]=Kt(B,q,ie),_[C+1+32]=_[C+0+96]=Kt(q,ie,le),_[C+2+32]=_[C+1+96]=Kt(ie,le,ue),_[C+3+32]=_[C+2+96]=Kt(le,ue,he),_[C+3+64]=Kt(ue,he,me),_[C+3+96]=Kt(he,me,be)}function iu(_,C){var B=_[C-1+0],q=_[C-1+32],ie=_[C-1+64],le=_[C-1+96];_[C+0+0]=B+q+1>>1,_[C+2+0]=_[C+0+32]=q+ie+1>>1,_[C+2+32]=_[C+0+64]=ie+le+1>>1,_[C+1+0]=Kt(B,q,ie),_[C+3+0]=_[C+1+32]=Kt(q,ie,le),_[C+3+32]=_[C+1+64]=Kt(ie,le,le),_[C+3+64]=_[C+2+64]=_[C+0+96]=_[C+1+96]=_[C+2+96]=_[C+3+96]=le}function Lf(_,C){var B=_[C-1+0],q=_[C-1+32],ie=_[C-1+64],le=_[C-1+96],ue=_[C-1-32],he=_[C+0-32],me=_[C+1-32],be=_[C+2-32];_[C+0+0]=_[C+2+32]=B+ue+1>>1,_[C+0+32]=_[C+2+64]=q+B+1>>1,_[C+0+64]=_[C+2+96]=ie+q+1>>1,_[C+0+96]=le+ie+1>>1,_[C+3+0]=Kt(he,me,be),_[C+2+0]=Kt(ue,he,me),_[C+1+0]=_[C+3+32]=Kt(B,ue,he),_[C+1+32]=_[C+3+64]=Kt(q,B,ue),_[C+1+64]=_[C+3+96]=Kt(ie,q,B),_[C+1+96]=Kt(le,ie,q)}function Xl(_,C){var B;for(B=0;8>B;++B)n(_,C+32*B,_,C-32,8)}function Om(_,C){var B;for(B=0;8>B;++B)i(_,C,_[C-1],8),C+=32}function so(_,C,B){var q;for(q=0;8>q;++q)i(C,B+32*q,_,8)}function jm(_,C){var B,q=8;for(B=0;8>B;++B)q+=_[C+B-32]+_[C-1+32*B];so(q>>4,_,C)}function If(_,C){var B,q=4;for(B=0;8>B;++B)q+=_[C+B-32];so(q>>3,_,C)}function Mf(_,C){var B,q=4;for(B=0;8>B;++B)q+=_[C-1+32*B];so(q>>3,_,C)}function l0(_,C){so(128,_,C)}function ao(_,C,B){var q=_[C-B],ie=_[C+0],le=3*(ie-q)+Pm[1020+_[C-2*B]-_[C+B]],ue=m0[112+(le+4>>3)];_[C-B]=cs[255+q+m0[112+(le+3>>3)]],_[C+0]=cs[255+ie-ue]}function Rf(_,C,B,q){var ie=_[C+0],le=_[C+B];return Ms[255+_[C-2*B]-_[C-B]]>q||Ms[255+le-ie]>q}function su(_,C,B,q){return 4*Ms[255+_[C-B]-_[C+0]]+Ms[255+_[C-2*B]-_[C+B]]<=q}function Bf(_,C,B,q,ie){var le=_[C-3*B],ue=_[C-2*B],he=_[C-B],me=_[C+0],be=_[C+B],Fe=_[C+2*B],qe=_[C+3*B];return 4*Ms[255+he-me]+Ms[255+ue-be]>q?0:Ms[255+_[C-4*B]-le]<=ie&&Ms[255+le-ue]<=ie&&Ms[255+ue-he]<=ie&&Ms[255+qe-Fe]<=ie&&Ms[255+Fe-be]<=ie&&Ms[255+be-me]<=ie}function Yl(_,C,B,q){var ie=2*q+1;for(q=0;16>q;++q)su(_,C+q,B,ie)&&ao(_,C+q,B)}function Uf(_,C,B,q){var ie=2*q+1;for(q=0;16>q;++q)su(_,C+q*B,1,ie)&&ao(_,C+q*B,1)}function c0(_,C,B,q){var ie;for(ie=3;0<ie;--ie)Yl(_,C+=4*B,B,q)}function u0(_,C,B,q){var ie;for(ie=3;0<ie;--ie)Uf(_,C+=4,B,q)}function oo(_,C,B,q,ie,le,ue,he){for(le=2*le+1;0<ie--;){if(Bf(_,C,B,le,ue))if(Rf(_,C,B,he))ao(_,C,B);else{var me=_,be=C,Fe=B,qe=me[be-2*Fe],_e=me[be-Fe],Me=me[be+0],Be=me[be+Fe],tt=me[be+2*Fe],$e=27*(at=Pm[1020+3*(Me-_e)+Pm[1020+qe-Be]])+63>>7,nt=18*at+63>>7,at=9*at+63>>7;me[be-3*Fe]=cs[255+me[be-3*Fe]+at],me[be-2*Fe]=cs[255+qe+nt],me[be-Fe]=cs[255+_e+$e],me[be+0]=cs[255+Me-$e],me[be+Fe]=cs[255+Be-nt],me[be+2*Fe]=cs[255+tt-at]}C+=q}}function lo(_,C,B,q,ie,le,ue,he){for(le=2*le+1;0<ie--;){if(Bf(_,C,B,le,ue))if(Rf(_,C,B,he))ao(_,C,B);else{var me=_,be=C,Fe=B,qe=me[be-Fe],_e=me[be+0],Me=me[be+Fe],Be=m0[112+(4+(tt=3*(_e-qe))>>3)],tt=m0[112+(tt+3>>3)],$e=Be+1>>1;me[be-2*Fe]=cs[255+me[be-2*Fe]+$e],me[be-Fe]=cs[255+qe+tt],me[be+0]=cs[255+_e-Be],me[be+Fe]=cs[255+Me-$e]}C+=q}}function f0(_,C,B,q,ie,le){oo(_,C,B,1,16,q,ie,le)}function Kl(_,C,B,q,ie,le){oo(_,C,1,B,16,q,ie,le)}function h0(_,C,B,q,ie,le){var ue;for(ue=3;0<ue;--ue)lo(_,C+=4*B,B,1,16,q,ie,le)}function D(_,C,B,q,ie,le){var ue;for(ue=3;0<ue;--ue)lo(_,C+=4,1,B,16,q,ie,le)}function ne(_,C,B,q,ie,le,ue,he){oo(_,C,ie,1,8,le,ue,he),oo(B,q,ie,1,8,le,ue,he)}function Ce(_,C,B,q,ie,le,ue,he){oo(_,C,1,ie,8,le,ue,he),oo(B,q,1,ie,8,le,ue,he)}function Pe(_,C,B,q,ie,le,ue,he){lo(_,C+4*ie,ie,1,8,le,ue,he),lo(B,q+4*ie,ie,1,8,le,ue,he)}function Re(_,C,B,q,ie,le,ue,he){lo(_,C+4,1,ie,8,le,ue,he),lo(B,q+4,1,ie,8,le,ue,he)}function st(){this.ba=new qt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new sr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ct(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ot(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ft(){this.ua=0,this.Wa=new ce,this.vb=new ce,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new te,this.yc=new V}function Yt(){this.xb=this.a=0,this.l=new tu,this.ca=new qt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new P,this.Pb=0,this.wd=new P,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ft,this.ab=0,this.gc=l(4,Ot),this.Oc=0}function er(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new tu,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function hr(_,C,B,q,ie,le,ue){for(_=_==null?0:_[C+0],C=0;C<ue;++C)ie[le+C]=_+B[q+C]&255,_=ie[le+C]}function Jr(_,C,B,q,ie,le,ue){var he;if(_==null)hr(null,null,B,q,ie,le,ue);else for(he=0;he<ue;++he)ie[le+he]=_[C+he]+B[q+he]&255}function Pn(_,C,B,q,ie,le,ue){if(_==null)hr(null,null,B,q,ie,le,ue);else{var he,me=_[C+0],be=me,Fe=me;for(he=0;he<ue;++he)be=Fe+(me=_[C+he])-be,Fe=B[q+he]+(-256&be?0>be?0:255:be)&255,be=me,ie[le+he]=Fe}}function Lr(_,C,B,q){var ie=C.width,le=C.o;if(t(_!=null&&C!=null),0>B||0>=q||B+q>le)return null;if(!_.Cc){if(_.ga==null){var ue;if(_.ga=new er,(ue=_.ga==null)||(ue=C.width*C.o,t(_.Gb.length==0),_.Gb=s(ue),_.Uc=0,_.Gb==null?ue=0:(_.mb=_.Gb,_.nb=_.Uc,_.rc=null,ue=1),ue=!ue),!ue){ue=_.ga;var he=_.Fa,me=_.P,be=_.qc,Fe=_.mb,qe=_.nb,_e=me+1,Me=be-1,Be=ue.l;if(t(he!=null&&Fe!=null&&C!=null),tl[0]=null,tl[1]=hr,tl[2]=Jr,tl[3]=Pn,ue.ca=Fe,ue.tb=qe,ue.c=C.width,ue.i=C.height,t(0<ue.c&&0<ue.i),1>=be)C=0;else if(ue.$a=3&he[me+0],ue.Z=he[me+0]>>2&3,ue.Lc=he[me+0]>>4&3,me=he[me+0]>>6&3,0>ue.$a||1<ue.$a||4<=ue.Z||1<ue.Lc||me)C=0;else if(Be.put=Et,Be.ac=Ii,Be.bc=Jn,Be.ma=ue,Be.width=C.width,Be.height=C.height,Be.Da=C.Da,Be.v=C.v,Be.va=C.va,Be.j=C.j,Be.o=C.o,ue.$a)e:{t(ue.$a==1),C=ze();t:for(;;){if(C==null){C=0;break e}if(t(ue!=null),ue.mc=C,C.c=ue.c,C.i=ue.i,C.l=ue.l,C.l.ma=ue,C.l.width=ue.c,C.l.height=ue.i,C.a=0,N(C.m,he,_e,Me),!We(ue.c,ue.i,1,C,null)||(C.ab==1&&C.gc[0].hc==3&&ve(C.s)?(ue.ic=1,he=C.c*C.i,C.Ta=null,C.Ua=0,C.V=s(he),C.Ba=0,C.V==null?(C.a=1,C=0):C=1):(ue.ic=0,C=Ve(C,ue.c)),!C))break t;C=1;break e}ue.mc=null,C=0}else C=Me>=ue.c*ue.i;ue=!C}if(ue)return null;_.ga.Lc!=1?_.Ga=0:q=le-B}t(_.ga!=null),t(B+q<=le);e:{if(C=(he=_.ga).c,le=he.l.o,he.$a==0){if(_e=_.rc,Me=_.Vc,Be=_.Fa,me=_.P+1+B*C,be=_.mb,Fe=_.nb+B*C,t(me<=_.P+_.qc),he.Z!=0)for(t(tl[he.Z]!=null),ue=0;ue<q;++ue)tl[he.Z](_e,Me,Be,me,be,Fe,C),_e=be,Me=Fe,Fe+=C,me+=C;else for(ue=0;ue<q;++ue)n(be,Fe,Be,me,C),_e=be,Me=Fe,Fe+=C,me+=C;_.rc=_e,_.Vc=Me}else{if(t(he.mc!=null),C=B+q,t((ue=he.mc)!=null),t(C<=ue.i),ue.C>=C)C=1;else if(he.ic||ia(),he.ic){he=ue.V,_e=ue.Ba,Me=ue.c;var tt=ue.i,$e=(Be=1,me=ue.$/Me,be=ue.$%Me,Fe=ue.m,qe=ue.s,ue.$),nt=Me*tt,at=Me*C,ht=qe.wc,ut=$e<at?ae(qe,be,me):null;t($e<=nt),t(C<=tt),t(ve(qe));t:for(;;){for(;!Fe.h&&$e<at;){if(be&ht||(ut=ae(qe,be,me)),t(ut!=null),H(Fe),256>(tt=Gr(ut.G[0],ut.H[0],Fe)))he[_e+$e]=tt,++$e,++be>=Me&&(be=0,++me<=C&&!(me%16)&&Ee(ue,me));else{if(!(280>tt)){Be=0;break t}tt=vi(tt-256,Fe);var Lt,Nt=Gr(ut.G[4],ut.H[4],Fe);if(H(Fe),!($e>=(Nt=Yi(Me,Nt=vi(Nt,Fe)))&&nt-$e>=tt)){Be=0;break t}for(Lt=0;Lt<tt;++Lt)he[_e+$e+Lt]=he[_e+$e+Lt-Nt];for($e+=tt,be+=tt;be>=Me;)be-=Me,++me<=C&&!(me%16)&&Ee(ue,me);$e<at&&be&ht&&(ut=ae(qe,be,me))}t(Fe.h==E(Fe))}Ee(ue,me>C?C:me);break t}!Be||Fe.h&&$e<nt?(Be=0,ue.a=Fe.h?5:3):ue.$=$e,C=Be}else C=Ue(ue,ue.V,ue.Ba,ue.c,ue.i,C,ft);if(!C){q=0;break e}}B+q>=le&&(_.Cc=1),q=1}if(!q)return null;if(_.Cc&&((q=_.ga)!=null&&(q.mc=null),_.ga=null,0<_.Ga))return alert("todo:WebPDequantizeLevels"),null}return _.nb+B*ie}function zn(_,C,B,q,ie,le){for(;0<ie--;){var ue,he=_,me=C+(B?1:0),be=_,Fe=C+(B?0:3);for(ue=0;ue<q;++ue){var qe=be[Fe+4*ue];qe!=255&&(qe*=32897,he[me+4*ue+0]=he[me+4*ue+0]*qe>>23,he[me+4*ue+1]=he[me+4*ue+1]*qe>>23,he[me+4*ue+2]=he[me+4*ue+2]*qe>>23)}C+=le}}function Fn(_,C,B,q,ie){for(;0<q--;){var le;for(le=0;le<B;++le){var ue=_[C+2*le+0],he=15&(be=_[C+2*le+1]),me=4369*he,be=(240&be|be>>4)*me>>16;_[C+2*le+0]=(240&ue|ue>>4)*me>>16&240|(15&ue|ue<<4)*me>>16>>4&15,_[C+2*le+1]=240&be|he}C+=ie}}function si(_,C,B,q,ie,le,ue,he){var me,be,Fe=255;for(be=0;be<ie;++be){for(me=0;me<q;++me){var qe=_[C+me];le[ue+4*me]=qe,Fe&=qe}C+=B,ue+=he}return Fe!=255}function co(_,C,B,q,ie){var le;for(le=0;le<ie;++le)B[q+le]=_[C+le]>>8}function ia(){Qf=zn,Zy=Fn,ew=si,tw=co}function uo(_,C,B){L[_]=function(q,ie,le,ue,he,me,be,Fe,qe,_e,Me,Be,tt,$e,nt,at,ht){var ut,Lt=ht-1>>1,Nt=he[me+0]|be[Fe+0]<<16,rr=qe[_e+0]|Me[Be+0]<<16;t(q!=null);var jt=3*Nt+rr+131074>>2;for(C(q[ie+0],255&jt,jt>>16,tt,$e),le!=null&&(jt=3*rr+Nt+131074>>2,C(le[ue+0],255&jt,jt>>16,nt,at)),ut=1;ut<=Lt;++ut){var ur=he[me+ut]|be[Fe+ut]<<16,Hn=qe[_e+ut]|Me[Be+ut]<<16,nr=Nt+ur+rr+Hn+524296,Pt=nr+2*(ur+rr)>>3;jt=Pt+Nt>>1,Nt=(nr=nr+2*(Nt+Hn)>>3)+ur>>1,C(q[ie+2*ut-1],255&jt,jt>>16,tt,$e+(2*ut-1)*B),C(q[ie+2*ut-0],255&Nt,Nt>>16,tt,$e+(2*ut-0)*B),le!=null&&(jt=nr+rr>>1,Nt=Pt+Hn>>1,C(le[ue+2*ut-1],255&jt,jt>>16,nt,at+(2*ut-1)*B),C(le[ue+2*ut+0],255&Nt,Nt>>16,nt,at+(2*ut+0)*B)),Nt=ur,rr=Hn}1&ht||(jt=3*Nt+rr+131074>>2,C(q[ie+ht-1],255&jt,jt>>16,tt,$e+(ht-1)*B),le!=null&&(jt=3*rr+Nt+131074>>2,C(le[ue+ht-1],255&jt,jt>>16,nt,at+(ht-1)*B)))}}function zf(){Rs[x0]=ZT,Rs[v0]=hw,Rs[ow]=eN,Rs[y0]=dw,Rs[w0]=pw,Rs[Fm]=gw,Rs[lw]=tN,Rs[Dm]=hw,Rs[Lm]=dw,Rs[b0]=pw,Rs[Im]=gw}function au(_){return _&-16384?0>_?0:255:_>>rN}function qo(_,C){return au((19077*_>>8)+(26149*C>>8)-14234)}function Jl(_,C,B){return au((19077*_>>8)-(6419*C>>8)-(13320*B>>8)+8708)}function Ql(_,C){return au((19077*_>>8)+(33050*C>>8)-17685)}function Vo(_,C,B,q,ie){q[ie+0]=qo(_,B),q[ie+1]=Jl(_,C,B),q[ie+2]=Ql(_,C)}function ai(_,C,B,q,ie){q[ie+0]=Ql(_,C),q[ie+1]=Jl(_,C,B),q[ie+2]=qo(_,B)}function Zl(_,C,B,q,ie){var le=Jl(_,C,B);C=le<<3&224|Ql(_,C)>>3,q[ie+0]=248&qo(_,B)|le>>5,q[ie+1]=C}function ec(_,C,B,q,ie){var le=240&Ql(_,C)|15;q[ie+0]=240&qo(_,B)|Jl(_,C,B)>>4,q[ie+1]=le}function Wf(_,C,B,q,ie){q[ie+0]=255,Vo(_,C,B,q,ie+1)}function Hf(_,C,B,q,ie){ai(_,C,B,q,ie),q[ie+3]=255}function Mi(_,C,B,q,ie){Vo(_,C,B,q,ie),q[ie+3]=255}function fo(_,C,B){L[_]=function(q,ie,le,ue,he,me,be,Fe,qe){for(var _e=Fe+(-2&qe)*B;Fe!=_e;)C(q[ie+0],le[ue+0],he[me+0],be,Fe),C(q[ie+1],le[ue+0],he[me+0],be,Fe+B),ie+=2,++ue,++me,Fe+=2*B;1&qe&&C(q[ie+0],le[ue+0],he[me+0],be,Fe)}}function ou(_,C,B){return B==0?_==0?C==0?6:5:C==0?4:0:B}function d0(_,C,B,q,ie){switch(_>>>30){case 3:ic(C,B,q,ie,0);break;case 2:Is(C,B,q,ie);break;case 1:yr(C,B,q,ie)}}function Ls(_,C){var B,q,ie=C.M,le=C.Nb,ue=_.oc,he=_.pc+40,me=_.oc,be=_.pc+584,Fe=_.oc,qe=_.pc+600;for(B=0;16>B;++B)ue[he+32*B-1]=129;for(B=0;8>B;++B)me[be+32*B-1]=129,Fe[qe+32*B-1]=129;for(0<ie?ue[he-1-32]=me[be-1-32]=Fe[qe-1-32]=129:(i(ue,he-32-1,127,21),i(me,be-32-1,127,9),i(Fe,qe-32-1,127,9)),q=0;q<_.za;++q){var _e=C.ya[C.aa+q];if(0<q){for(B=-1;16>B;++B)n(ue,he+32*B-4,ue,he+32*B+12,4);for(B=-1;8>B;++B)n(me,be+32*B-4,me,be+32*B+4,4),n(Fe,qe+32*B-4,Fe,qe+32*B+4,4)}var Me=_.Gd,Be=_.Hd+q,tt=_e.ad,$e=_e.Hc;if(0<ie&&(n(ue,he-32,Me[Be].y,0,16),n(me,be-32,Me[Be].f,0,8),n(Fe,qe-32,Me[Be].ea,0,8)),_e.Za){var nt=ue,at=he-32+16;for(0<ie&&(q>=_.za-1?i(nt,at,Me[Be].y[15],4):n(nt,at,Me[Be+1].y,0,4)),B=0;4>B;B++)nt[at+128+B]=nt[at+256+B]=nt[at+384+B]=nt[at+0+B];for(B=0;16>B;++B,$e<<=2)nt=ue,at=he+xw[B],sa[_e.Ob[B]](nt,at),d0($e,tt,16*+B,nt,at)}else if(nt=ou(q,ie,_e.Ob[0]),el[nt](ue,he),$e!=0)for(B=0;16>B;++B,$e<<=2)d0($e,tt,16*+B,ue,he+xw[B]);for(B=_e.Gc,nt=ou(q,ie,_e.Dd),go[nt](me,be),go[nt](Fe,qe),$e=tt,nt=me,at=be,255&(_e=0|B)&&(170&_e?Pa($e,256,nt,at):jr($e,256,nt,at)),_e=Fe,$e=qe,255&(B>>=8)&&(170&B?Pa(tt,320,_e,$e):jr(tt,320,_e,$e)),ie<_.Ub-1&&(n(Me[Be].y,0,ue,he+480,16),n(Me[Be].f,0,me,be+224,8),n(Me[Be].ea,0,Fe,qe+224,8)),B=8*le*_.B,Me=_.sa,Be=_.ta+16*q+16*le*_.R,tt=_.qa,_e=_.ra+8*q+B,$e=_.Ha,nt=_.Ia+8*q+B,B=0;16>B;++B)n(Me,Be+B*_.R,ue,he+32*B,16);for(B=0;8>B;++B)n(tt,_e+B*_.B,me,be+32*B,8),n($e,nt+B*_.B,Fe,qe+32*B,8)}}function tc(_,C,B,q,ie,le,ue,he,me){var be=[0],Fe=[0],qe=0,_e=me!=null?me.kd:0,Me=me??new ct;if(_==null||12>B)return 7;Me.data=_,Me.w=C,Me.ha=B,C=[C],B=[B],Me.gb=[Me.gb];e:{var Be=C,tt=B,$e=Me.gb;if(t(_!=null),t(tt!=null),t($e!=null),$e[0]=0,12<=tt[0]&&!r(_,Be[0],"RIFF")){if(r(_,Be[0]+8,"WEBP")){$e=3;break e}var nt=se(_,Be[0]+4);if(12>nt||4294967286<nt){$e=3;break e}if(_e&&nt>tt[0]-8){$e=7;break e}$e[0]=nt,Be[0]+=12,tt[0]-=12}$e=0}if($e!=0)return $e;for(nt=0<Me.gb[0],B=B[0];;){e:{var at=_;tt=C,$e=B;var ht=be,ut=Fe,Lt=Be=[0];if((jt=qe=[qe])[0]=0,8>$e[0])$e=7;else{if(!r(at,tt[0],"VP8X")){if(se(at,tt[0]+4)!=10){$e=3;break e}if(18>$e[0]){$e=7;break e}var Nt=se(at,tt[0]+8),rr=1+re(at,tt[0]+12);if(2147483648<=rr*(at=1+re(at,tt[0]+15))){$e=3;break e}Lt!=null&&(Lt[0]=Nt),ht!=null&&(ht[0]=rr),ut!=null&&(ut[0]=at),tt[0]+=18,$e[0]-=18,jt[0]=1}$e=0}}if(qe=qe[0],Be=Be[0],$e!=0)return $e;if(tt=!!(2&Be),!nt&&qe)return 3;if(le!=null&&(le[0]=!!(16&Be)),ue!=null&&(ue[0]=tt),he!=null&&(he[0]=0),ue=be[0],Be=Fe[0],qe&&tt&&me==null){$e=0;break}if(4>B){$e=7;break}if(nt&&qe||!nt&&!qe&&!r(_,C[0],"ALPH")){B=[B],Me.na=[Me.na],Me.P=[Me.P],Me.Sa=[Me.Sa];e:{Nt=_,$e=C,nt=B;var jt=Me.gb;ht=Me.na,ut=Me.P,Lt=Me.Sa,rr=22,t(Nt!=null),t(nt!=null),at=$e[0];var ur=nt[0];for(t(ht!=null),t(Lt!=null),ht[0]=null,ut[0]=null,Lt[0]=0;;){if($e[0]=at,nt[0]=ur,8>ur){$e=7;break e}var Hn=se(Nt,at+4);if(4294967286<Hn){$e=3;break e}var nr=8+Hn+1&-2;if(rr+=nr,0<jt&&rr>jt){$e=3;break e}if(!r(Nt,at,"VP8 ")||!r(Nt,at,"VP8L")){$e=0;break e}if(ur[0]<nr){$e=7;break e}r(Nt,at,"ALPH")||(ht[0]=Nt,ut[0]=at+8,Lt[0]=Hn),at+=nr,ur-=nr}}if(B=B[0],Me.na=Me.na[0],Me.P=Me.P[0],Me.Sa=Me.Sa[0],$e!=0)break}B=[B],Me.Ja=[Me.Ja],Me.xa=[Me.xa];e:if(jt=_,$e=C,nt=B,ht=Me.gb[0],ut=Me.Ja,Lt=Me.xa,Nt=$e[0],at=!r(jt,Nt,"VP8 "),rr=!r(jt,Nt,"VP8L"),t(jt!=null),t(nt!=null),t(ut!=null),t(Lt!=null),8>nt[0])$e=7;else{if(at||rr){if(jt=se(jt,Nt+4),12<=ht&&jt>ht-12){$e=3;break e}if(_e&&jt>nt[0]-8){$e=7;break e}ut[0]=jt,$e[0]+=8,nt[0]-=8,Lt[0]=rr}else Lt[0]=5<=nt[0]&&jt[Nt+0]==47&&!(jt[Nt+4]>>5),ut[0]=nt[0];$e=0}if(B=B[0],Me.Ja=Me.Ja[0],Me.xa=Me.xa[0],C=C[0],$e!=0)break;if(4294967286<Me.Ja)return 3;if(he==null||tt||(he[0]=Me.xa?2:1),ue=[ue],Be=[Be],Me.xa){if(5>B){$e=7;break}he=ue,_e=Be,tt=le,_==null||5>B?_=0:5<=B&&_[C+0]==47&&!(_[C+4]>>5)?(nt=[0],jt=[0],ht=[0],N(ut=new P,_,C,B),ta(ut,nt,jt,ht)?(he!=null&&(he[0]=nt[0]),_e!=null&&(_e[0]=jt[0]),tt!=null&&(tt[0]=ht[0]),_=1):_=0):_=0}else{if(10>B){$e=7;break}he=Be,_==null||10>B||!r0(_,C+3,B-3)?_=0:(_e=_[C+0]|_[C+1]<<8|_[C+2]<<16,tt=16383&(_[C+7]<<8|_[C+6]),_=16383&(_[C+9]<<8|_[C+8]),1&_e||3<(_e>>1&7)||!(_e>>4&1)||_e>>5>=Me.Ja||!tt||!_?_=0:(ue&&(ue[0]=tt),he&&(he[0]=_),_=1))}if(!_||(ue=ue[0],Be=Be[0],qe&&(be[0]!=ue||Fe[0]!=Be)))return 3;me!=null&&(me[0]=Me,me.offset=C-me.w,t(4294967286>C-me.w),t(me.offset==me.ha-B));break}return $e==0||$e==7&&qe&&me==null?(le!=null&&(le[0]|=Me.na!=null&&0<Me.na.length),q!=null&&(q[0]=ue),ie!=null&&(ie[0]=Be),0):$e}function $f(_,C,B){var q=C.width,ie=C.height,le=0,ue=0,he=q,me=ie;if(C.Da=_!=null&&0<_.Da,C.Da&&(he=_.cd,me=_.bd,le=_.v,ue=_.j,11>B||(le&=-2,ue&=-2),0>le||0>ue||0>=he||0>=me||le+he>q||ue+me>ie))return 0;if(C.v=le,C.j=ue,C.va=le+he,C.o=ue+me,C.U=he,C.T=me,C.da=_!=null&&0<_.da,C.da){if(!we(he,me,B=[_.ib],le=[_.hb]))return 0;C.ib=B[0],C.hb=le[0]}return C.ob=_!=null&&_.ob,C.Kb=_==null||!_.Sd,C.da&&(C.ob=C.ib<3*q/4&&C.hb<3*ie/4,C.Kb=0),1}function qf(_){if(_==null)return 2;if(11>_.S){var C=_.f.RGBA;C.fb+=(_.height-1)*C.A,C.A=-C.A}else C=_.f.kb,_=_.height,C.O+=(_-1)*C.fa,C.fa=-C.fa,C.N+=(_-1>>1)*C.Ab,C.Ab=-C.Ab,C.W+=(_-1>>1)*C.Db,C.Db=-C.Db,C.F!=null&&(C.J+=(_-1)*C.lb,C.lb=-C.lb);return 0}function Go(_,C,B,q){if(q==null||0>=_||0>=C)return 2;if(B!=null){if(B.Da){var ie=B.cd,le=B.bd,ue=-2&B.v,he=-2&B.j;if(0>ue||0>he||0>=ie||0>=le||ue+ie>_||he+le>C)return 2;_=ie,C=le}if(B.da){if(!we(_,C,ie=[B.ib],le=[B.hb]))return 2;_=ie[0],C=le[0]}}q.width=_,q.height=C;e:{var me=q.width,be=q.height;if(_=q.S,0>=me||0>=be||!(_>=x0&&13>_))_=2;else{if(0>=q.Rd&&q.sd==null){ue=le=ie=C=0;var Fe=(he=me*vw[_])*be;if(11>_||(le=(be+1)/2*(C=(me+1)/2),_==12&&(ue=(ie=me)*be)),(be=s(Fe+2*le+ue))==null){_=1;break e}q.sd=be,11>_?((me=q.f.RGBA).eb=be,me.fb=0,me.A=he,me.size=Fe):((me=q.f.kb).y=be,me.O=0,me.fa=he,me.Fd=Fe,me.f=be,me.N=0+Fe,me.Ab=C,me.Cd=le,me.ea=be,me.W=0+Fe+le,me.Db=C,me.Ed=le,_==12&&(me.F=be,me.J=0+Fe+2*le),me.Tc=ue,me.lb=ie)}if(C=1,ie=q.S,le=q.width,ue=q.height,ie>=x0&&13>ie)if(11>ie)_=q.f.RGBA,C&=(he=Math.abs(_.A))*(ue-1)+le<=_.size,C&=he>=le*vw[ie],C&=_.eb!=null;else{_=q.f.kb,he=(le+1)/2,Fe=(ue+1)/2,me=Math.abs(_.fa),be=Math.abs(_.Ab);var qe=Math.abs(_.Db),_e=Math.abs(_.lb),Me=_e*(ue-1)+le;C&=me*(ue-1)+le<=_.Fd,C&=be*(Fe-1)+he<=_.Cd,C=(C&=qe*(Fe-1)+he<=_.Ed)&me>=le&be>=he&qe>=he,C&=_.y!=null,C&=_.f!=null,C&=_.ea!=null,ie==12&&(C&=_e>=le,C&=Me<=_.Tc,C&=_.F!=null)}else C=0;_=C?0:2}}return _!=0||B!=null&&B.fd&&(_=qf(q)),_}var rc=64,os=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ls=24,Xo=32,ho=8,Yo=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Te("Predictor0","PredictorAdd0"),L.Predictor0=function(){return 4278190080},L.Predictor1=function(_){return _},L.Predictor2=function(_,C,B){return C[B+0]},L.Predictor3=function(_,C,B){return C[B+1]},L.Predictor4=function(_,C,B){return C[B-1]},L.Predictor5=function(_,C,B){return Ae(Ae(_,C[B+1]),C[B+0])},L.Predictor6=function(_,C,B){return Ae(_,C[B-1])},L.Predictor7=function(_,C,B){return Ae(_,C[B+0])},L.Predictor8=function(_,C,B){return Ae(C[B-1],C[B+0])},L.Predictor9=function(_,C,B){return Ae(C[B+0],C[B+1])},L.Predictor10=function(_,C,B){return Ae(Ae(_,C[B-1]),Ae(C[B+0],C[B+1]))},L.Predictor11=function(_,C,B){var q=C[B+0];return 0>=Le(q>>24&255,_>>24&255,(C=C[B-1])>>24&255)+Le(q>>16&255,_>>16&255,C>>16&255)+Le(q>>8&255,_>>8&255,C>>8&255)+Le(255&q,255&_,255&C)?q:_},L.Predictor12=function(_,C,B){var q=C[B+0];return(Ie((_>>24&255)+(q>>24&255)-((C=C[B-1])>>24&255))<<24|Ie((_>>16&255)+(q>>16&255)-(C>>16&255))<<16|Ie((_>>8&255)+(q>>8&255)-(C>>8&255))<<8|Ie((255&_)+(255&q)-(255&C)))>>>0},L.Predictor13=function(_,C,B){var q=C[B-1];return(je((_=Ae(_,C[B+0]))>>24&255,q>>24&255)<<24|je(_>>16&255,q>>16&255)<<16|je(_>>8&255,q>>8&255)<<8|je(255&_,255&q))>>>0};var Vf=L.PredictorAdd0;L.PredictorAdd1=Xe,Te("Predictor2","PredictorAdd2"),Te("Predictor3","PredictorAdd3"),Te("Predictor4","PredictorAdd4"),Te("Predictor5","PredictorAdd5"),Te("Predictor6","PredictorAdd6"),Te("Predictor7","PredictorAdd7"),Te("Predictor8","PredictorAdd8"),Te("Predictor9","PredictorAdd9"),Te("Predictor10","PredictorAdd10"),Te("Predictor11","PredictorAdd11"),Te("Predictor12","PredictorAdd12"),Te("Predictor13","PredictorAdd13");var lu=L.PredictorAdd2;De("ColorIndexInverseTransform","MapARGB","32b",function(_){return _>>8&255},function(_){return _}),De("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(_){return _},function(_){return _>>8&255});var mn,p0=L.ColorIndexInverseTransform,Oa=L.MapARGB,ja=L.VP8LColorIndexInverseTransformAlpha,Gf=L.MapAlpha,Xf=L.VP8LPredictorsAdd=[];Xf.length=16,(L.VP8LPredictors=[]).length=16,(L.VP8LPredictorsAdd_C=[]).length=16,(L.VP8LPredictors_C=[]).length=16;var Yf,Kf,Ko,Jo,Qo,nc,Zo,ic,Is,Pa,yr,jr,xn,Wn,po,Jf,cu,g0,Gy,Xy,Yy,Ky,Jy,Qy,Qf,Zy,ew,tw,rw=s(511),nw=s(2041),iw=s(225),sw=s(767),aw=0,Pm=nw,m0=iw,cs=sw,Ms=rw,x0=0,v0=1,ow=2,y0=3,w0=4,Fm=5,lw=6,Dm=7,Lm=8,b0=9,Im=10,BT=[2,3,7],UT=[3,3,11],cw=[280,256,256,256,40],zT=[0,1,1,1,0],WT=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],HT=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],$T=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],qT=8,Mm=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Rm=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Zf=null,VT=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],GT=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],uw=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],XT=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],YT=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],KT=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],JT=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],el=[],sa=[],go=[],QT=1,fw=2,tl=[],Rs=[];uo("UpsampleRgbLinePair",Vo,3),uo("UpsampleBgrLinePair",ai,3),uo("UpsampleRgbaLinePair",Mi,4),uo("UpsampleBgraLinePair",Hf,4),uo("UpsampleArgbLinePair",Wf,4),uo("UpsampleRgba4444LinePair",ec,2),uo("UpsampleRgb565LinePair",Zl,2);var ZT=L.UpsampleRgbLinePair,eN=L.UpsampleBgrLinePair,hw=L.UpsampleRgbaLinePair,dw=L.UpsampleBgraLinePair,pw=L.UpsampleArgbLinePair,gw=L.UpsampleRgba4444LinePair,tN=L.UpsampleRgb565LinePair,_0=16,k0=1<<_0-1,eh=-227,Bm=482,rN=6,mw=0,nN=s(256),iN=s(256),sN=s(256),aN=s(256),oN=s(Bm-eh),lN=s(Bm-eh);fo("YuvToRgbRow",Vo,3),fo("YuvToBgrRow",ai,3),fo("YuvToRgbaRow",Mi,4),fo("YuvToBgraRow",Hf,4),fo("YuvToArgbRow",Wf,4),fo("YuvToRgba4444Row",ec,2),fo("YuvToRgb565Row",Zl,2);var xw=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],S0=[0,2,8],cN=[8,7,6,4,4,2,2,2,1,1,1,1],uN=1;this.WebPDecodeRGBA=function(_,C,B,q,ie){var le=v0,ue=new st,he=new qt;ue.ba=he,he.S=le,he.width=[he.width],he.height=[he.height];var me=he.width,be=he.height,Fe=new Ct;if(Fe==null||_==null)var qe=2;else t(Fe!=null),qe=tc(_,C,B,Fe.width,Fe.height,Fe.Pd,Fe.Qd,Fe.format,null);if(qe!=0?me=0:(me!=null&&(me[0]=Fe.width[0]),be!=null&&(be[0]=Fe.height[0]),me=1),me){he.width=he.width[0],he.height=he.height[0],q!=null&&(q[0]=he.width),ie!=null&&(ie[0]=he.height);e:{if(q=new tu,(ie=new ct).data=_,ie.w=C,ie.ha=B,ie.kd=1,C=[0],t(ie!=null),((_=tc(ie.data,ie.w,ie.ha,null,null,null,C,null,ie))==0||_==7)&&C[0]&&(_=4),(C=_)==0){if(t(ue!=null),q.data=ie.data,q.w=ie.w+ie.offset,q.ha=ie.ha-ie.offset,q.put=Et,q.ac=Ii,q.bc=Jn,q.ma=ue,ie.xa){if((_=ze())==null){ue=1;break e}if(function(_e,Me){var Be=[0],tt=[0],$e=[0];t:for(;;){if(_e==null)return 0;if(Me==null)return _e.a=2,0;if(_e.l=Me,_e.a=0,N(_e.m,Me.data,Me.w,Me.ha),!ta(_e.m,Be,tt,$e)){_e.a=3;break t}if(_e.xb=fw,Me.width=Be[0],Me.height=tt[0],!We(Be[0],tt[0],1,_e,null))break t;return 1}return t(_e.a!=0),0}(_,q)){if(q=(C=Go(q.width,q.height,ue.Oa,ue.ba))==0){t:{q=_;r:for(;;){if(q==null){q=0;break t}if(t(q.s.yc!=null),t(q.s.Ya!=null),t(0<q.s.Wb),t((B=q.l)!=null),t((ie=B.ma)!=null),q.xb!=0){if(q.ca=ie.ba,q.tb=ie.tb,t(q.ca!=null),!$f(ie.Oa,B,y0)){q.a=2;break r}if(!Ve(q,B.width)||B.da)break r;if((B.da||yt(q.ca.S))&&ia(),11>q.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),q.ca.f.kb.F!=null&&ia()),q.Pb&&0<q.s.ua&&q.s.vb.X==null&&!z(q.s.vb,q.s.Wa.Xa)){q.a=1;break r}q.xb=0}if(!Ue(q,q.V,q.Ba,q.c,q.i,B.o,ge))break r;ie.Dc=q.Ma,q=1;break t}t(q.a!=0),q=0}q=!q}q&&(C=_.a)}else C=_.a}else{if((_=new xm)==null){ue=1;break e}if(_.Fa=ie.na,_.P=ie.P,_.qc=ie.Sa,Na(_,q)){if((C=Go(q.width,q.height,ue.Oa,ue.ba))==0){if(_.Aa=0,B=ue.Oa,t((ie=_)!=null),B!=null){if(0<(me=0>(me=B.Md)?0:100<me?255:255*me/100)){for(be=Fe=0;4>be;++be)12>(qe=ie.pb[be]).lc&&(qe.ia=me*cN[0>qe.lc?0:qe.lc]>>3),Fe|=qe.ia;Fe&&(alert("todo:VP8InitRandom"),ie.ia=1)}ie.Ga=B.Id,100<ie.Ga?ie.Ga=100:0>ie.Ga&&(ie.Ga=0)}(function(_e,Me){if(_e==null)return 0;if(Me==null)return jn(_e,2,"NULL VP8Io parameter in VP8Decode().");if(!_e.cb&&!Na(_e,Me))return 0;if(t(_e.cb),Me.ac==null||Me.ac(Me)){Me.ob&&(_e.L=0);var Be=S0[_e.L];if(_e.L==2?(_e.yb=0,_e.zb=0):(_e.yb=Me.v-Be>>4,_e.zb=Me.j-Be>>4,0>_e.yb&&(_e.yb=0),0>_e.zb&&(_e.zb=0)),_e.Va=Me.o+15+Be>>4,_e.Hb=Me.va+15+Be>>4,_e.Hb>_e.za&&(_e.Hb=_e.za),_e.Va>_e.Ub&&(_e.Va=_e.Ub),0<_e.L){var tt=_e.ed;for(Be=0;4>Be;++Be){var $e;if(_e.Qa.Cb){var nt=_e.Qa.Lb[Be];_e.Qa.Fb||(nt+=tt.Tb)}else nt=tt.Tb;for($e=0;1>=$e;++$e){var at=_e.gd[Be][$e],ht=nt;if(tt.Pc&&(ht+=tt.vd[0],$e&&(ht+=tt.od[0])),0<(ht=0>ht?0:63<ht?63:ht)){var ut=ht;0<tt.wb&&(ut=4<tt.wb?ut>>2:ut>>1)>9-tt.wb&&(ut=9-tt.wb),1>ut&&(ut=1),at.dd=ut,at.tc=2*ht+ut,at.ld=40<=ht?2:15<=ht?1:0}else at.tc=0;at.La=$e}}}Be=0}else jn(_e,6,"Frame setup failed"),Be=_e.a;if(Be=Be==0){if(Be){_e.$c=0,0<_e.Aa||(_e.Ic=uN);t:{Be=_e.Ic,tt=4*(ut=_e.za);var Lt=32*ut,Nt=ut+1,rr=0<_e.L?ut*(0<_e.Aa?2:1):0,jt=(_e.Aa==2?2:1)*ut;if((at=tt+832+($e=3*(16*Be+S0[_e.L])/2*Lt)+(nt=_e.Fa!=null&&0<_e.Fa.length?_e.Kc.c*_e.Kc.i:0))!=at)Be=0;else{if(at>_e.Vb){if(_e.Vb=0,_e.Ec=s(at),_e.Fc=0,_e.Ec==null){Be=jn(_e,1,"no memory during frame initialization.");break t}_e.Vb=at}at=_e.Ec,ht=_e.Fc,_e.Ac=at,_e.Bc=ht,ht+=tt,_e.Gd=l(Lt,Fs),_e.Hd=0,_e.rb=l(Nt+1,sn),_e.sb=1,_e.wa=rr?l(rr,cr):null,_e.Y=0,_e.D.Nb=0,_e.D.wa=_e.wa,_e.D.Y=_e.Y,0<_e.Aa&&(_e.D.Y+=ut),t(!0),_e.oc=at,_e.pc=ht,ht+=832,_e.ya=l(jt,ra),_e.aa=0,_e.D.ya=_e.ya,_e.D.aa=_e.aa,_e.Aa==2&&(_e.D.aa+=ut),_e.R=16*ut,_e.B=8*ut,ut=(Lt=S0[_e.L])*_e.R,Lt=Lt/2*_e.B,_e.sa=at,_e.ta=ht+ut,_e.qa=_e.sa,_e.ra=_e.ta+16*Be*_e.R+Lt,_e.Ha=_e.qa,_e.Ia=_e.ra+8*Be*_e.B+Lt,_e.$c=0,ht+=$e,_e.mb=nt?at:null,_e.nb=nt?ht:null,t(ht+nt<=_e.Fc+_e.Vb),n0(_e),i(_e.Ac,_e.Bc,0,tt),Be=1}}if(Be){if(Me.ka=0,Me.y=_e.sa,Me.O=_e.ta,Me.f=_e.qa,Me.N=_e.ra,Me.ea=_e.Ha,Me.Vd=_e.Ia,Me.fa=_e.R,Me.Rc=_e.B,Me.F=null,Me.J=0,!aw){for(Be=-255;255>=Be;++Be)rw[255+Be]=0>Be?-Be:Be;for(Be=-1020;1020>=Be;++Be)nw[1020+Be]=-128>Be?-128:127<Be?127:Be;for(Be=-112;112>=Be;++Be)iw[112+Be]=-16>Be?-16:15<Be?15:Be;for(Be=-255;510>=Be;++Be)sw[255+Be]=0>Be?0:255<Be?255:Be;aw=1}Zo=nu,ic=ym,Pa=Aa,yr=s0,jr=a0,Is=vm,xn=f0,Wn=Kl,po=ne,Jf=Ce,cu=h0,g0=D,Gy=Pe,Xy=Re,Yy=Yl,Ky=Uf,Jy=c0,Qy=u0,sa[0]=Tm,sa[1]=wm,sa[2]=Cm,sa[3]=Em,sa[4]=no,sa[5]=Nm,sa[6]=io,sa[7]=Am,sa[8]=Lf,sa[9]=iu,el[0]=km,el[1]=_m,el[2]=Ff,el[3]=o0,el[4]=Gl,el[5]=Df,el[6]=Sm,go[0]=jm,go[1]=bm,go[2]=Xl,go[3]=Om,go[4]=Mf,go[5]=If,go[6]=l0,Be=1}else Be=0}Be&&(Be=function(ur,Hn){for(ur.M=0;ur.M<ur.Va;++ur.M){var nr,Pt=ur.Jc[ur.M&ur.Xb],wt=ur.m,vn=ur;for(nr=0;nr<vn.za;++nr){var Zt=wt,fr=vn,Br=fr.Ac,oi=fr.Bc+4*nr,Ri=fr.zc,an=fr.ya[fr.aa+nr];if(fr.Qa.Bb?an.$b=Z(Zt,fr.Pa.jb[0])?2+Z(Zt,fr.Pa.jb[2]):Z(Zt,fr.Pa.jb[1]):an.$b=0,fr.kc&&(an.Ad=Z(Zt,fr.Bd)),an.Za=!Z(Zt,145)+0,an.Za){var yi=an.Ob,Bi=0;for(fr=0;4>fr;++fr){var $n,dr=Ri[0+fr];for($n=0;4>$n;++$n){dr=YT[Br[oi+$n]][dr];for(var wr=uw[Z(Zt,dr[0])];0<wr;)wr=uw[2*wr+Z(Zt,dr[wr])];dr=-wr,Br[oi+$n]=dr}n(yi,Bi,Br,oi,4),Bi+=4,Ri[0+fr]=dr}}else dr=Z(Zt,156)?Z(Zt,128)?1:3:Z(Zt,163)?2:0,an.Ob[0]=dr,i(Br,oi,dr,4),i(Ri,0,dr,4);an.Dd=Z(Zt,142)?Z(Zt,114)?Z(Zt,183)?1:3:2:0}if(vn.m.Ka)return jn(ur,7,"Premature end-of-partition0 encountered.");for(;ur.ja<ur.za;++ur.ja){if(vn=Pt,Zt=(wt=ur).rb[wt.sb-1],Br=wt.rb[wt.sb+wt.ja],nr=wt.ya[wt.aa+wt.ja],oi=wt.kc?nr.Ad:0)Zt.la=Br.la=0,nr.Za||(Zt.Na=Br.Na=0),nr.Hc=0,nr.Gc=0,nr.ia=0;else{var on,br;if(Zt=Br,Br=vn,oi=wt.Pa.Xc,Ri=wt.ya[wt.aa+wt.ja],an=wt.pb[Ri.$b],fr=Ri.ad,yi=0,Bi=wt.rb[wt.sb-1],dr=$n=0,i(fr,yi,0,384),Ri.Za)var li=0,aa=oi[3];else{wr=s(16);var yn=Zt.Na+Bi.Na;if(yn=Zf(Br,oi[1],yn,an.Eb,0,wr,0),Zt.Na=Bi.Na=(0<yn)+0,1<yn)Zo(wr,0,fr,yi);else{var Ki=wr[0]+3>>3;for(wr=0;256>wr;wr+=16)fr[yi+wr]=Ki}li=1,aa=oi[0]}var Pr=15&Zt.la,qn=15&Bi.la;for(wr=0;4>wr;++wr){var us=1&qn;for(Ki=br=0;4>Ki;++Ki)Pr=Pr>>1|(us=(yn=Zf(Br,aa,yn=us+(1&Pr),an.Sc,li,fr,yi))>li)<<7,br=br<<2|(3<yn?3:1<yn?2:fr[yi+0]!=0),yi+=16;Pr>>=4,qn=qn>>1|us<<7,$n=($n<<8|br)>>>0}for(aa=Pr,li=qn>>4,on=0;4>on;on+=2){for(br=0,Pr=Zt.la>>4+on,qn=Bi.la>>4+on,wr=0;2>wr;++wr){for(us=1&qn,Ki=0;2>Ki;++Ki)yn=us+(1&Pr),Pr=Pr>>1|(us=0<(yn=Zf(Br,oi[2],yn,an.Qc,0,fr,yi)))<<3,br=br<<2|(3<yn?3:1<yn?2:fr[yi+0]!=0),yi+=16;Pr>>=2,qn=qn>>1|us<<5}dr|=br<<4*on,aa|=Pr<<4<<on,li|=(240&qn)<<on}Zt.la=aa,Bi.la=li,Ri.Hc=$n,Ri.Gc=dr,Ri.ia=43690&dr?0:an.ia,oi=!($n|dr)}if(0<wt.L&&(wt.wa[wt.Y+wt.ja]=wt.gd[nr.$b][nr.Za],wt.wa[wt.Y+wt.ja].La|=!oi),vn.Ka)return jn(ur,7,"Premature end-of-file encountered.")}if(n0(ur),wt=Hn,vn=1,nr=(Pt=ur).D,Zt=0<Pt.L&&Pt.M>=Pt.zb&&Pt.M<=Pt.Va,Pt.Aa==0)t:{if(nr.M=Pt.M,nr.uc=Zt,Ls(Pt,nr),vn=1,nr=(br=Pt.D).Nb,Zt=(dr=S0[Pt.L])*Pt.R,Br=dr/2*Pt.B,wr=16*nr*Pt.R,Ki=8*nr*Pt.B,oi=Pt.sa,Ri=Pt.ta-Zt+wr,an=Pt.qa,fr=Pt.ra-Br+Ki,yi=Pt.Ha,Bi=Pt.Ia-Br+Ki,qn=(Pr=br.M)==0,$n=Pr>=Pt.Va-1,Pt.Aa==2&&Ls(Pt,br),br.uc)for(us=(yn=Pt).D.M,t(yn.D.uc),br=yn.yb;br<yn.Hb;++br){li=br,aa=us;var Ui=(fs=(ci=yn).D).Nb;on=ci.R;var fs=fs.wa[fs.Y+li],hs=ci.sa,Ji=ci.ta+16*Ui*on+16*li,ds=fs.dd,Ir=fs.tc;if(Ir!=0)if(t(3<=Ir),ci.L==1)0<li&&Ky(hs,Ji,on,Ir+4),fs.La&&Qy(hs,Ji,on,Ir),0<aa&&Yy(hs,Ji,on,Ir+4),fs.La&&Jy(hs,Ji,on,Ir);else{var ps=ci.B,oa=ci.qa,sc=ci.ra+8*Ui*ps+8*li,mo=ci.Ha,ci=ci.Ia+8*Ui*ps+8*li;Ui=fs.ld,0<li&&(Wn(hs,Ji,on,Ir+4,ds,Ui),Jf(oa,sc,mo,ci,ps,Ir+4,ds,Ui)),fs.La&&(g0(hs,Ji,on,Ir,ds,Ui),Xy(oa,sc,mo,ci,ps,Ir,ds,Ui)),0<aa&&(xn(hs,Ji,on,Ir+4,ds,Ui),po(oa,sc,mo,ci,ps,Ir+4,ds,Ui)),fs.La&&(cu(hs,Ji,on,Ir,ds,Ui),Gy(oa,sc,mo,ci,ps,Ir,ds,Ui))}}if(Pt.ia&&alert("todo:DitherRow"),wt.put!=null){if(br=16*Pr,Pr=16*(Pr+1),qn?(wt.y=Pt.sa,wt.O=Pt.ta+wr,wt.f=Pt.qa,wt.N=Pt.ra+Ki,wt.ea=Pt.Ha,wt.W=Pt.Ia+Ki):(br-=dr,wt.y=oi,wt.O=Ri,wt.f=an,wt.N=fr,wt.ea=yi,wt.W=Bi),$n||(Pr-=dr),Pr>wt.o&&(Pr=wt.o),wt.F=null,wt.J=null,Pt.Fa!=null&&0<Pt.Fa.length&&br<Pr&&(wt.J=Lr(Pt,wt,br,Pr-br),wt.F=Pt.mb,wt.F==null&&wt.F.length==0)){vn=jn(Pt,3,"Could not decode alpha data.");break t}br<wt.j&&(dr=wt.j-br,br=wt.j,t(!(1&dr)),wt.O+=Pt.R*dr,wt.N+=Pt.B*(dr>>1),wt.W+=Pt.B*(dr>>1),wt.F!=null&&(wt.J+=wt.width*dr)),br<Pr&&(wt.O+=wt.v,wt.N+=wt.v>>1,wt.W+=wt.v>>1,wt.F!=null&&(wt.J+=wt.v),wt.ka=br-wt.j,wt.U=wt.va-wt.v,wt.T=Pr-br,vn=wt.put(wt))}nr+1!=Pt.Ic||$n||(n(Pt.sa,Pt.ta-Zt,oi,Ri+16*Pt.R,Zt),n(Pt.qa,Pt.ra-Br,an,fr+8*Pt.B,Br),n(Pt.Ha,Pt.Ia-Br,yi,Bi+8*Pt.B,Br))}if(!vn)return jn(ur,6,"Output aborted.")}return 1}(_e,Me)),Me.bc!=null&&Me.bc(Me),Be&=1}return Be?(_e.cb=0,Be):0})(_,q)||(C=_.a)}}else C=_.a}C==0&&ue.Oa!=null&&ue.Oa.fd&&(C=qf(ue.ba))}ue=C}le=ue!=0?null:11>le?he.f.RGBA.eb:he.f.kb.y}else le=null;return le};var vw=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(L,W){for(var F="",M=0;M<4;M++)F+=String.fromCharCode(L[W++]);return F}function f(L,W){return L[W+0]|L[W+1]<<8}function h(L,W){return(L[W+0]|L[W+1]<<8|L[W+2]<<16)>>>0}function d(L,W){return(L[W+0]|L[W+1]<<8|L[W+2]<<16|L[W+3]<<24)>>>0}new a;var u=[0],p=[0],m=[],g=new a,x=e,y=function(L,W){var F={},M=0,V=!1,G=0,te=0;if(F.frames=[],!function(k,P){for(var A=0;A<4;A++)if(k[P+A]!="RIFF".charCodeAt(A))return!0;return!1}(L,W)){for(d(L,W+=4),W+=8;W<L.length;){var ee=c(L,W),Q=d(L,W+=4);W+=4;var K=Q+(1&Q);switch(ee){case"VP8 ":case"VP8L":F.frames[M]===void 0&&(F.frames[M]={}),(R=F.frames[M]).src_off=V?te:W-8,R.src_size=G+Q+8,M++,V&&(V=!1,G=0,te=0);break;case"VP8X":(R=F.header={}).feature_flags=L[W];var N=W+4;R.canvas_width=1+h(L,N),N+=3,R.canvas_height=1+h(L,N),N+=3;break;case"ALPH":V=!0,G=K+8,te=W-8;break;case"ANIM":(R=F.header).bgcolor=d(L,W),N=W+4,R.loop_count=f(L,N),N+=2;break;case"ANMF":var U,R;(R=F.frames[M]={}).offset_x=2*h(L,W),W+=3,R.offset_y=2*h(L,W),W+=3,R.width=1+h(L,W),W+=3,R.height=1+h(L,W),W+=3,R.duration=h(L,W),W+=3,U=L[W++],R.dispose=1&U,R.blend=U>>1&1}ee!="ANMF"&&(W+=K)}return F}}(x,0);y.response=x,y.rgbaoutput=!0,y.dataurl=!1;var w=y.header?y.header:null,b=y.frames?y.frames:null;if(w){w.loop_counter=w.loop_count,u=[w.canvas_height],p=[w.canvas_width];for(var S=0;S<b.length&&b[S].blend!=0;S++);}var T=b[0],O=g.WebPDecodeRGBA(x,T.src_off,T.src_size,p,u);T.rgba=O,T.imgwidth=p[0],T.imgheight=u[0];for(var j=0;j<p[0]*u[0]*4;j++)m[j]=O[j];return this.width=p,this.height=u,this.data=m,this}(function(e){var t,r,n,i,s,l,o,a,c,f=function(k){return k=k||{},this.isStrokeTransparent=k.isStrokeTransparent||!1,this.strokeOpacity=k.strokeOpacity||1,this.strokeStyle=k.strokeStyle||"#000000",this.fillStyle=k.fillStyle||"#000000",this.isFillTransparent=k.isFillTransparent||!1,this.fillOpacity=k.fillOpacity||1,this.font=k.font||"10px sans-serif",this.textBaseline=k.textBaseline||"alphabetic",this.textAlign=k.textAlign||"left",this.lineWidth=k.lineWidth||1,this.lineJoin=k.lineJoin||"miter",this.lineCap=k.lineCap||"butt",this.path=k.path||[],this.transform=k.transform!==void 0?k.transform.clone():new a,this.globalCompositeOperation=k.globalCompositeOperation||"normal",this.globalAlpha=k.globalAlpha||1,this.clip_path=k.clip_path||[],this.currentPoint=k.currentPoint||new l,this.miterLimit=k.miterLimit||10,this.lastPoint=k.lastPoint||new l,this.lineDashOffset=k.lineDashOffset||0,this.lineDash=k.lineDash||[],this.margin=k.margin||[0,0,0,0],this.prevPageLastElemOffset=k.prevPageLastElemOffset||0,this.ignoreClearRect=typeof k.ignoreClearRect!="boolean"||k.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new h(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,l=this.internal.Point,o=this.internal.Rectangle,a=this.internal.Matrix,c=new f}]);var h=function(k){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var P=k;Object.defineProperty(this,"pdf",{get:function(){return P}});var A=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return A},set:function(z){A=!!z}});var E=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return E},set:function(z){E=!!z}});var I=0;Object.defineProperty(this,"posX",{get:function(){return I},set:function(z){isNaN(z)||(I=z)}});var H=0;Object.defineProperty(this,"posY",{get:function(){return H},set:function(z){isNaN(z)||(H=z)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(z){var oe;typeof z=="number"?oe=[z,z,z,z]:((oe=new Array(4))[0]=z[0],oe[1]=z.length>=2?z[1]:oe[0],oe[2]=z.length>=3?z[2]:oe[0],oe[3]=z.length>=4?z[3]:oe[1]),c.margin=oe}});var J=!1;Object.defineProperty(this,"autoPaging",{get:function(){return J},set:function(z){J=z}});var Y=0;Object.defineProperty(this,"lastBreak",{get:function(){return Y},set:function(z){Y=z}});var Z=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Z},set:function(z){Z=z}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(z){z instanceof f&&(c=z)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(z){c.path=z}});var fe=[];Object.defineProperty(this,"ctxStack",{get:function(){return fe},set:function(z){fe=z}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(z){var oe;oe=d(z),this.ctx.fillStyle=oe.style,this.ctx.isFillTransparent=oe.a===0,this.ctx.fillOpacity=oe.a,this.pdf.setFillColor(oe.r,oe.g,oe.b,{a:oe.a}),this.pdf.setTextColor(oe.r,oe.g,oe.b,{a:oe.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(z){var oe=d(z);this.ctx.strokeStyle=oe.style,this.ctx.isStrokeTransparent=oe.a===0,this.ctx.strokeOpacity=oe.a,oe.a===0?this.pdf.setDrawColor(255,255,255):(oe.a,this.pdf.setDrawColor(oe.r,oe.g,oe.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(z){["butt","round","square"].indexOf(z)!==-1&&(this.ctx.lineCap=z,this.pdf.setLineCap(z))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(z){isNaN(z)||(this.ctx.lineWidth=z,this.pdf.setLineWidth(z))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(z){["bevel","round","miter"].indexOf(z)!==-1&&(this.ctx.lineJoin=z,this.pdf.setLineJoin(z))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(z){isNaN(z)||(this.ctx.miterLimit=z,this.pdf.setMiterLimit(z))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(z){this.ctx.textBaseline=z}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(z){["right","end","center","left","start"].indexOf(z)!==-1&&(this.ctx.textAlign=z)}});var X=null,re=null,se=null;Object.defineProperty(this,"fontFaces",{get:function(){return se},set:function(z){X=null,re=null,se=z}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(z){var oe;if(this.ctx.font=z,(oe=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(z))!==null){var ce=oe[1];oe[2];var we=oe[3],ye=oe[4];oe[5];var de=oe[6],Te=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ye)[2];ye=Math.floor(Te==="px"?parseFloat(ye)*this.pdf.internal.scaleFactor:Te==="em"?parseFloat(ye)*this.pdf.getFontSize():parseFloat(ye)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ye);var pe=function(De){var Ye,it,Ke=[],et=De.trim();if(et==="")return Y1;if(et in c5)return[c5[et]];for(;et!=="";){switch(it=null,Ye=(et=f5(et)).charAt(0)){case'"':case"'":it=ML(et.substring(1),Ye);break;default:it=RL(et)}if(it===null||(Ke.push(it[0]),(et=f5(it[1]))!==""&&et.charAt(0)!==","))return Y1;et=et.replace(/^,/,"")}return Ke}(de);if(this.fontFaces){var Ae=function(De,Ye){var it=De.getFontList(),Ke=JSON.stringify(it);if(X===null||re!==Ke){var et=function(Ge){var ot=[];return Object.keys(Ge).forEach(function(_t){Ge[_t].forEach(function(yt){var St=null;switch(yt){case"bold":St={family:_t,weight:"bold"};break;case"italic":St={family:_t,style:"italic"};break;case"bolditalic":St={family:_t,weight:"bold",style:"italic"};break;case"":case"normal":St={family:_t}}St!==null&&(St.ref={name:_t,style:yt},ot.push(St))})}),ot}(it);X=function(Ge){for(var ot={},_t=0;_t<Ge.length;++_t){var yt=X1(Ge[_t]),St=yt.family,Bt=yt.stretch,qt=yt.style,Ct=yt.weight;ot[St]=ot[St]||{},ot[St][Bt]=ot[St][Bt]||{},ot[St][Bt][qt]=ot[St][Bt][qt]||{},ot[St][Bt][qt][Ct]=yt}return ot}(et.concat(Ye)),re=Ke}return X}(this.pdf,this.fontFaces),Ie=pe.map(function(De){return{family:De,stretch:"normal",weight:we,style:ce}}),je=function(De,Ye,it){for(var Ke=(it=it||{}).defaultFontFamily||"times",et=Object.assign({},IL,it.genericFontFamilies||{}),Ge=null,ot=null,_t=0;_t<Ye.length;++_t)if(et[(Ge=X1(Ye[_t])).family]&&(Ge.family=et[Ge.family]),De.hasOwnProperty(Ge.family)){ot=De[Ge.family];break}if(!(ot=ot||De[Ke]))throw new Error("Could not find a font-family for the rule '"+u5(Ge)+"' and default family '"+Ke+"'.");if(ot=function(yt,St){if(St[yt])return St[yt];var Bt=Pv[yt],qt=Bt<=Pv.normal?-1:1,Ct=l5(St,sC,Bt,qt);if(!Ct)throw new Error("Could not find a matching font-stretch value for "+yt);return Ct}(Ge.stretch,ot),ot=function(yt,St){if(St[yt])return St[yt];for(var Bt=iC[yt],qt=0;qt<Bt.length;++qt)if(St[Bt[qt]])return St[Bt[qt]];throw new Error("Could not find a matching font-style for "+yt)}(Ge.style,ot),!(ot=function(yt,St){if(St[yt])return St[yt];if(yt===400&&St[500])return St[500];if(yt===500&&St[400])return St[400];var Bt=LL[yt],qt=l5(St,aC,Bt,yt<400?-1:1);if(!qt)throw new Error("Could not find a matching font-weight for value "+yt);return qt}(Ge.weight,ot)))throw new Error("Failed to resolve a font for the rule '"+u5(Ge)+"'.");return ot}(Ae,Ie);this.pdf.setFont(je.ref.name,je.ref.style)}else{var Le="";(we==="bold"||parseInt(we,10)>=700||ce==="bold")&&(Le="bold"),ce==="italic"&&(Le+="italic"),Le.length===0&&(Le="normal");for(var Xe="",Je={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ne=0;Ne<pe.length;Ne++){if(this.pdf.internal.getFont(pe[Ne],Le,{noFallback:!0,disableWarning:!0})!==void 0){Xe=pe[Ne];break}if(Le==="bolditalic"&&this.pdf.internal.getFont(pe[Ne],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Xe=pe[Ne],Le="bold";else if(this.pdf.internal.getFont(pe[Ne],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Xe=pe[Ne],Le="normal";break}}if(Xe===""){for(var Oe=0;Oe<pe.length;Oe++)if(Je[pe[Oe]]){Xe=Je[pe[Oe]];break}}Xe=Xe===""?"Times":Xe,this.pdf.setFont(Xe,Le)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(z){this.ctx.globalCompositeOperation=z}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(z){this.ctx.globalAlpha=z}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(z){this.ctx.lineDashOffset=z,R.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(z){this.ctx.lineDash=z,R.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(z){this.ctx.ignoreClearRect=!!z}})};h.prototype.setLineDash=function(k){this.lineDash=k},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){b.call(this,"fill",!1)},h.prototype.stroke=function(){b.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(k,P){if(isNaN(k)||isNaN(P))throw Fr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var A=this.ctx.transform.applyToPoint(new l(k,P));this.path.push({type:"mt",x:A.x,y:A.y}),this.ctx.lastPoint=new l(k,P)},h.prototype.closePath=function(){var k=new l(0,0),P=0;for(P=this.path.length-1;P!==-1;P--)if(this.path[P].type==="begin"&&Er(this.path[P+1])==="object"&&typeof this.path[P+1].x=="number"){k=new l(this.path[P+1].x,this.path[P+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(k.x,k.y)},h.prototype.lineTo=function(k,P){if(isNaN(k)||isNaN(P))throw Fr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var A=this.ctx.transform.applyToPoint(new l(k,P));this.path.push({type:"lt",x:A.x,y:A.y}),this.ctx.lastPoint=new l(A.x,A.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),b.call(this,null,!0)},h.prototype.quadraticCurveTo=function(k,P,A,E){if(isNaN(A)||isNaN(E)||isNaN(k)||isNaN(P))throw Fr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var I=this.ctx.transform.applyToPoint(new l(A,E)),H=this.ctx.transform.applyToPoint(new l(k,P));this.path.push({type:"qct",x1:H.x,y1:H.y,x:I.x,y:I.y}),this.ctx.lastPoint=new l(I.x,I.y)},h.prototype.bezierCurveTo=function(k,P,A,E,I,H){if(isNaN(I)||isNaN(H)||isNaN(k)||isNaN(P)||isNaN(A)||isNaN(E))throw Fr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var J=this.ctx.transform.applyToPoint(new l(I,H)),Y=this.ctx.transform.applyToPoint(new l(k,P)),Z=this.ctx.transform.applyToPoint(new l(A,E));this.path.push({type:"bct",x1:Y.x,y1:Y.y,x2:Z.x,y2:Z.y,x:J.x,y:J.y}),this.ctx.lastPoint=new l(J.x,J.y)},h.prototype.arc=function(k,P,A,E,I,H){if(isNaN(k)||isNaN(P)||isNaN(A)||isNaN(E)||isNaN(I))throw Fr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(H=!!H,!this.ctx.transform.isIdentity){var J=this.ctx.transform.applyToPoint(new l(k,P));k=J.x,P=J.y;var Y=this.ctx.transform.applyToPoint(new l(0,A)),Z=this.ctx.transform.applyToPoint(new l(0,0));A=Math.sqrt(Math.pow(Y.x-Z.x,2)+Math.pow(Y.y-Z.y,2))}Math.abs(I-E)>=2*Math.PI&&(E=0,I=2*Math.PI),this.path.push({type:"arc",x:k,y:P,radius:A,startAngle:E,endAngle:I,counterclockwise:H})},h.prototype.arcTo=function(k,P,A,E,I){throw new Error("arcTo not implemented.")},h.prototype.rect=function(k,P,A,E){if(isNaN(k)||isNaN(P)||isNaN(A)||isNaN(E))throw Fr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(k,P),this.lineTo(k+A,P),this.lineTo(k+A,P+E),this.lineTo(k,P+E),this.lineTo(k,P),this.lineTo(k+A,P),this.lineTo(k,P)},h.prototype.fillRect=function(k,P,A,E){if(isNaN(k)||isNaN(P)||isNaN(A)||isNaN(E))throw Fr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!u.call(this)){var I={};this.lineCap!=="butt"&&(I.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(I.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(k,P,A,E),this.fill(),I.hasOwnProperty("lineCap")&&(this.lineCap=I.lineCap),I.hasOwnProperty("lineJoin")&&(this.lineJoin=I.lineJoin)}},h.prototype.strokeRect=function(k,P,A,E){if(isNaN(k)||isNaN(P)||isNaN(A)||isNaN(E))throw Fr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");p.call(this)||(this.beginPath(),this.rect(k,P,A,E),this.stroke())},h.prototype.clearRect=function(k,P,A,E){if(isNaN(k)||isNaN(P)||isNaN(A)||isNaN(E))throw Fr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(k,P,A,E))},h.prototype.save=function(k){k=typeof k!="boolean"||k;for(var P=this.pdf.internal.getCurrentPageInfo().pageNumber,A=0;A<this.pdf.internal.getNumberOfPages();A++)this.pdf.setPage(A+1),this.pdf.internal.out("q");if(this.pdf.setPage(P),k){this.ctx.fontSize=this.pdf.internal.getFontSize();var E=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=E}},h.prototype.restore=function(k){k=typeof k!="boolean"||k;for(var P=this.pdf.internal.getCurrentPageInfo().pageNumber,A=0;A<this.pdf.internal.getNumberOfPages();A++)this.pdf.setPage(A+1),this.pdf.internal.out("Q");this.pdf.setPage(P),k&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var d=function(k){var P,A,E,I;if(k.isCanvasGradient===!0&&(k=k.getColor()),!k)return{r:0,g:0,b:0,a:0,style:k};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(k))P=0,A=0,E=0,I=0;else{var H=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(k);if(H!==null)P=parseInt(H[1]),A=parseInt(H[2]),E=parseInt(H[3]),I=1;else if((H=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(k))!==null)P=parseInt(H[1]),A=parseInt(H[2]),E=parseInt(H[3]),I=parseFloat(H[4]);else{if(I=1,typeof k=="string"&&k.charAt(0)!=="#"){var J=new J3(k);k=J.ok?J.toHex():"#000000"}k.length===4?(P=k.substring(1,2),P+=P,A=k.substring(2,3),A+=A,E=k.substring(3,4),E+=E):(P=k.substring(1,3),A=k.substring(3,5),E=k.substring(5,7)),P=parseInt(P,16),A=parseInt(A,16),E=parseInt(E,16)}}return{r:P,g:A,b:E,a:I,style:k}},u=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},p=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(k,P,A,E){if(isNaN(P)||isNaN(A)||typeof k!="string")throw Fr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(E=isNaN(E)?void 0:E,!u.call(this)){var I=K(this.ctx.transform.rotation),H=this.ctx.transform.scaleX;M.call(this,{text:k,x:P,y:A,scale:H,angle:I,align:this.textAlign,maxWidth:E})}},h.prototype.strokeText=function(k,P,A,E){if(isNaN(P)||isNaN(A)||typeof k!="string")throw Fr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!p.call(this)){E=isNaN(E)?void 0:E;var I=K(this.ctx.transform.rotation),H=this.ctx.transform.scaleX;M.call(this,{text:k,x:P,y:A,scale:H,renderingMode:"stroke",angle:I,align:this.textAlign,maxWidth:E})}},h.prototype.measureText=function(k){if(typeof k!="string")throw Fr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var P=this.pdf,A=this.pdf.internal.scaleFactor,E=P.internal.getFontSize(),I=P.getStringUnitWidth(k)*E/P.internal.scaleFactor;return new function(H){var J=(H=H||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return J}}),this}({width:I*=Math.round(96*A/72*1e4)/1e4})},h.prototype.scale=function(k,P){if(isNaN(k)||isNaN(P))throw Fr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var A=new a(k,0,0,P,0,0);this.ctx.transform=this.ctx.transform.multiply(A)},h.prototype.rotate=function(k){if(isNaN(k))throw Fr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var P=new a(Math.cos(k),Math.sin(k),-Math.sin(k),Math.cos(k),0,0);this.ctx.transform=this.ctx.transform.multiply(P)},h.prototype.translate=function(k,P){if(isNaN(k)||isNaN(P))throw Fr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var A=new a(1,0,0,1,k,P);this.ctx.transform=this.ctx.transform.multiply(A)},h.prototype.transform=function(k,P,A,E,I,H){if(isNaN(k)||isNaN(P)||isNaN(A)||isNaN(E)||isNaN(I)||isNaN(H))throw Fr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var J=new a(k,P,A,E,I,H);this.ctx.transform=this.ctx.transform.multiply(J)},h.prototype.setTransform=function(k,P,A,E,I,H){k=isNaN(k)?1:k,P=isNaN(P)?0:P,A=isNaN(A)?0:A,E=isNaN(E)?1:E,I=isNaN(I)?0:I,H=isNaN(H)?0:H,this.ctx.transform=new a(k,P,A,E,I,H)};var m=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(k,P,A,E,I,H,J,Y,Z){var fe=this.pdf.getImageProperties(k),X=1,re=1,se=1,z=1;E!==void 0&&Y!==void 0&&(se=Y/E,z=Z/I,X=fe.width/E*Y/E,re=fe.height/I*Z/I),H===void 0&&(H=P,J=A,P=0,A=0),E!==void 0&&Y===void 0&&(Y=E,Z=I),E===void 0&&Y===void 0&&(Y=fe.width,Z=fe.height);var oe=this.ctx.transform.decompose(),ce=K(oe.rotate.shx),we=new a,ye=(we=(we=(we=we.multiply(oe.translate)).multiply(oe.skew)).multiply(oe.scale)).applyToRectangle(new o(H-P*se,J-A*z,E*X,I*re));if(this.autoPaging){for(var de,Te=g.call(this,ye),pe=[],Ae=0;Ae<Te.length;Ae+=1)pe.indexOf(Te[Ae])===-1&&pe.push(Te[Ae]);w(pe);for(var Ie=pe[0],je=pe[pe.length-1],Le=Ie;Le<je+1;Le++){this.pdf.setPage(Le);var Xe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Je=Le===1?this.posY+this.margin[0]:this.margin[0],Ne=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Oe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],De=Le===1?0:Ne+(Le-2)*Oe;if(this.ctx.clip_path.length!==0){var Ye=this.path;de=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(de,this.posX+this.margin[3],-De+Je+this.ctx.prevPageLastElemOffset),S.call(this,"fill",!0),this.path=Ye}var it=JSON.parse(JSON.stringify(ye));it=y([it],this.posX+this.margin[3],-De+Je+this.ctx.prevPageLastElemOffset)[0];var Ke=(Le>Ie||Le<je)&&m.call(this);Ke&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Xe,Oe,null).clip().discardPath()),this.pdf.addImage(k,"JPEG",it.x,it.y,it.w,it.h,null,null,ce),Ke&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(k,"JPEG",ye.x,ye.y,ye.w,ye.h,null,null,ce)};var g=function(k,P,A){var E=[];P=P||this.pdf.internal.pageSize.width,A=A||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var I=this.posY+this.ctx.prevPageLastElemOffset;switch(k.type){default:case"mt":case"lt":E.push(Math.floor((k.y+I)/A)+1);break;case"arc":E.push(Math.floor((k.y+I-k.radius)/A)+1),E.push(Math.floor((k.y+I+k.radius)/A)+1);break;case"qct":var H=N(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x,k.y);E.push(Math.floor((H.y+I)/A)+1),E.push(Math.floor((H.y+H.h+I)/A)+1);break;case"bct":var J=U(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x2,k.y2,k.x,k.y);E.push(Math.floor((J.y+I)/A)+1),E.push(Math.floor((J.y+J.h+I)/A)+1);break;case"rect":E.push(Math.floor((k.y+I)/A)+1),E.push(Math.floor((k.y+k.h+I)/A)+1)}for(var Y=0;Y<E.length;Y+=1)for(;this.pdf.internal.getNumberOfPages()<E[Y];)x.call(this);return E},x=function(){var k=this.fillStyle,P=this.strokeStyle,A=this.font,E=this.lineCap,I=this.lineWidth,H=this.lineJoin;this.pdf.addPage(),this.fillStyle=k,this.strokeStyle=P,this.font=A,this.lineCap=E,this.lineWidth=I,this.lineJoin=H},y=function(k,P,A){for(var E=0;E<k.length;E++)switch(k[E].type){case"bct":k[E].x2+=P,k[E].y2+=A;case"qct":k[E].x1+=P,k[E].y1+=A;default:k[E].x+=P,k[E].y+=A}return k},w=function(k){return k.sort(function(P,A){return P-A})},b=function(k,P){var A=this.fillStyle,E=this.strokeStyle,I=this.lineCap,H=this.lineWidth,J=Math.abs(H*this.ctx.transform.scaleX),Y=this.lineJoin;if(this.autoPaging){for(var Z,fe,X=JSON.parse(JSON.stringify(this.path)),re=JSON.parse(JSON.stringify(this.path)),se=[],z=0;z<re.length;z++)if(re[z].x!==void 0)for(var oe=g.call(this,re[z]),ce=0;ce<oe.length;ce+=1)se.indexOf(oe[ce])===-1&&se.push(oe[ce]);for(var we=0;we<se.length;we++)for(;this.pdf.internal.getNumberOfPages()<se[we];)x.call(this);w(se);for(var ye=se[0],de=se[se.length-1],Te=ye;Te<de+1;Te++){this.pdf.setPage(Te),this.fillStyle=A,this.strokeStyle=E,this.lineCap=I,this.lineWidth=J,this.lineJoin=Y;var pe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ae=Te===1?this.posY+this.margin[0]:this.margin[0],Ie=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],je=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Le=Te===1?0:Ie+(Te-2)*je;if(this.ctx.clip_path.length!==0){var Xe=this.path;Z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(Z,this.posX+this.margin[3],-Le+Ae+this.ctx.prevPageLastElemOffset),S.call(this,k,!0),this.path=Xe}if(fe=JSON.parse(JSON.stringify(X)),this.path=y(fe,this.posX+this.margin[3],-Le+Ae+this.ctx.prevPageLastElemOffset),P===!1||Te===0){var Je=(Te>ye||Te<de)&&m.call(this);Je&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],pe,je,null).clip().discardPath()),S.call(this,k,P),Je&&this.pdf.restoreGraphicsState()}this.lineWidth=H}this.path=X}else this.lineWidth=J,S.call(this,k,P),this.lineWidth=H},S=function(k,P){if((k!=="stroke"||P||!p.call(this))&&(k==="stroke"||P||!u.call(this))){for(var A,E,I=[],H=this.path,J=0;J<H.length;J++){var Y=H[J];switch(Y.type){case"begin":I.push({begin:!0});break;case"close":I.push({close:!0});break;case"mt":I.push({start:Y,deltas:[],abs:[]});break;case"lt":var Z=I.length;if(H[J-1]&&!isNaN(H[J-1].x)&&(A=[Y.x-H[J-1].x,Y.y-H[J-1].y],Z>0)){for(;Z>=0;Z--)if(I[Z-1].close!==!0&&I[Z-1].begin!==!0){I[Z-1].deltas.push(A),I[Z-1].abs.push(Y);break}}break;case"bct":A=[Y.x1-H[J-1].x,Y.y1-H[J-1].y,Y.x2-H[J-1].x,Y.y2-H[J-1].y,Y.x-H[J-1].x,Y.y-H[J-1].y],I[I.length-1].deltas.push(A);break;case"qct":var fe=H[J-1].x+2/3*(Y.x1-H[J-1].x),X=H[J-1].y+2/3*(Y.y1-H[J-1].y),re=Y.x+2/3*(Y.x1-Y.x),se=Y.y+2/3*(Y.y1-Y.y),z=Y.x,oe=Y.y;A=[fe-H[J-1].x,X-H[J-1].y,re-H[J-1].x,se-H[J-1].y,z-H[J-1].x,oe-H[J-1].y],I[I.length-1].deltas.push(A);break;case"arc":I.push({deltas:[],abs:[],arc:!0}),Array.isArray(I[I.length-1].abs)&&I[I.length-1].abs.push(Y)}}E=P?null:k==="stroke"?"stroke":"fill";for(var ce=!1,we=0;we<I.length;we++)if(I[we].arc)for(var ye=I[we].abs,de=0;de<ye.length;de++){var Te=ye[de];Te.type==="arc"?j.call(this,Te.x,Te.y,Te.radius,Te.startAngle,Te.endAngle,Te.counterclockwise,void 0,P,!ce):V.call(this,Te.x,Te.y),ce=!0}else if(I[we].close===!0)this.pdf.internal.out("h"),ce=!1;else if(I[we].begin!==!0){var pe=I[we].start.x,Ae=I[we].start.y;G.call(this,I[we].deltas,pe,Ae),ce=!0}E&&L.call(this,E),P&&W.call(this)}},T=function(k){var P=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,A=P*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return k-A;case"top":return k+P-A;case"hanging":return k+P-2*A;case"middle":return k+P/2-A;default:return k}},O=function(k){return k+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var k=function(){};return k.colorStops=[],k.addColorStop=function(P,A){this.colorStops.push([P,A])},k.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},k.isCanvasGradient=!0,k},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var j=function(k,P,A,E,I,H,J,Y,Z){for(var fe=ee.call(this,A,E,I,H),X=0;X<fe.length;X++){var re=fe[X];X===0&&(Z?F.call(this,re.x1+k,re.y1+P):V.call(this,re.x1+k,re.y1+P)),te.call(this,k,P,re.x2,re.y2,re.x3,re.y3,re.x4,re.y4)}Y?W.call(this):L.call(this,J)},L=function(k){switch(k){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},W=function(){this.pdf.clip(),this.pdf.discardPath()},F=function(k,P){this.pdf.internal.out(r(k)+" "+n(P)+" m")},M=function(k){var P;switch(k.align){case"right":case"end":P="right";break;case"center":P="center";break;default:P="left"}var A,E,I,H=this.pdf.getTextDimensions(k.text),J=T.call(this,k.y),Y=O.call(this,J)-H.h,Z=this.ctx.transform.applyToPoint(new l(k.x,J));if(this.autoPaging){var fe=this.ctx.transform.decompose(),X=new a;X=(X=(X=X.multiply(fe.translate)).multiply(fe.skew)).multiply(fe.scale);for(var re=this.ctx.transform.applyToRectangle(new o(k.x,J,H.w,H.h)),se=X.applyToRectangle(new o(k.x,Y,H.w,H.h)),z=g.call(this,se),oe=[],ce=0;ce<z.length;ce+=1)oe.indexOf(z[ce])===-1&&oe.push(z[ce]);w(oe);for(var we=oe[0],ye=oe[oe.length-1],de=we;de<ye+1;de++){this.pdf.setPage(de);var Te=de===1?this.posY+this.margin[0]:this.margin[0],pe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ae=this.pdf.internal.pageSize.height-this.margin[2],Ie=Ae-this.margin[0],je=this.pdf.internal.pageSize.width-this.margin[1],Le=je-this.margin[3],Xe=de===1?0:pe+(de-2)*Ie;if(this.ctx.clip_path.length!==0){var Je=this.path;A=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(A,this.posX+this.margin[3],-1*Xe+Te),S.call(this,"fill",!0),this.path=Je}var Ne=y([JSON.parse(JSON.stringify(se))],this.posX+this.margin[3],-Xe+Te+this.ctx.prevPageLastElemOffset)[0];k.scale>=.01&&(E=this.pdf.internal.getFontSize(),this.pdf.setFontSize(E*k.scale),I=this.lineWidth,this.lineWidth=I*k.scale);var Oe=this.autoPaging!=="text";if(Oe||Ne.y+Ne.h<=Ae){if(Oe||Ne.y>=Te&&Ne.x<=je){var De=Oe?k.text:this.pdf.splitTextToSize(k.text,k.maxWidth||je-Ne.x)[0],Ye=y([JSON.parse(JSON.stringify(re))],this.posX+this.margin[3],-Xe+Te+this.ctx.prevPageLastElemOffset)[0],it=Oe&&(de>we||de<ye)&&m.call(this);it&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Le,Ie,null).clip().discardPath()),this.pdf.text(De,Ye.x,Ye.y,{angle:k.angle,align:P,renderingMode:k.renderingMode}),it&&this.pdf.restoreGraphicsState()}}else Ne.y<Ae&&(this.ctx.prevPageLastElemOffset+=Ae-Ne.y);k.scale>=.01&&(this.pdf.setFontSize(E),this.lineWidth=I)}}else k.scale>=.01&&(E=this.pdf.internal.getFontSize(),this.pdf.setFontSize(E*k.scale),I=this.lineWidth,this.lineWidth=I*k.scale),this.pdf.text(k.text,Z.x+this.posX,Z.y+this.posY,{angle:k.angle,align:P,renderingMode:k.renderingMode,maxWidth:k.maxWidth}),k.scale>=.01&&(this.pdf.setFontSize(E),this.lineWidth=I)},V=function(k,P,A,E){A=A||0,E=E||0,this.pdf.internal.out(r(k+A)+" "+n(P+E)+" l")},G=function(k,P,A){return this.pdf.lines(k,P,A,null,null)},te=function(k,P,A,E,I,H,J,Y){this.pdf.internal.out([t(i(A+k)),t(s(E+P)),t(i(I+k)),t(s(H+P)),t(i(J+k)),t(s(Y+P)),"c"].join(" "))},ee=function(k,P,A,E){for(var I=2*Math.PI,H=Math.PI/2;P>A;)P-=I;var J=Math.abs(A-P);J<I&&E&&(J=I-J);for(var Y=[],Z=E?-1:1,fe=P;J>1e-5;){var X=fe+Z*Math.min(J,H);Y.push(Q.call(this,k,fe,X)),J-=Math.abs(X-fe),fe=X}return Y},Q=function(k,P,A){var E=(A-P)/2,I=k*Math.cos(E),H=k*Math.sin(E),J=I,Y=-H,Z=J*J+Y*Y,fe=Z+J*I+Y*H,X=4/3*(Math.sqrt(2*Z*fe)-fe)/(J*H-Y*I),re=J-X*Y,se=Y+X*J,z=re,oe=-se,ce=E+P,we=Math.cos(ce),ye=Math.sin(ce);return{x1:k*Math.cos(P),y1:k*Math.sin(P),x2:re*we-se*ye,y2:re*ye+se*we,x3:z*we-oe*ye,y3:z*ye+oe*we,x4:k*Math.cos(A),y4:k*Math.sin(A)}},K=function(k){return 180*k/Math.PI},N=function(k,P,A,E,I,H){var J=k+.5*(A-k),Y=P+.5*(E-P),Z=I+.5*(A-I),fe=H+.5*(E-H),X=Math.min(k,I,J,Z),re=Math.max(k,I,J,Z),se=Math.min(P,H,Y,fe),z=Math.max(P,H,Y,fe);return new o(X,se,re-X,z-se)},U=function(k,P,A,E,I,H,J,Y){var Z,fe,X,re,se,z,oe,ce,we,ye,de,Te,pe,Ae,Ie=A-k,je=E-P,Le=I-A,Xe=H-E,Je=J-I,Ne=Y-H;for(fe=0;fe<41;fe++)we=(oe=(X=k+(Z=fe/40)*Ie)+Z*((se=A+Z*Le)-X))+Z*(se+Z*(I+Z*Je-se)-oe),ye=(ce=(re=P+Z*je)+Z*((z=E+Z*Xe)-re))+Z*(z+Z*(H+Z*Ne-z)-ce),fe==0?(de=we,Te=ye,pe=we,Ae=ye):(de=Math.min(de,we),Te=Math.min(Te,ye),pe=Math.max(pe,we),Ae=Math.max(Ae,ye));return new o(Math.round(de),Math.round(Te),Math.round(pe-de),Math.round(Ae-Te))},R=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var k,P,A=(k=this.ctx.lineDash,P=this.ctx.lineDashOffset,JSON.stringify({lineDash:k,lineDashOffset:P}));this.prevLineDash!==A&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=A)}}})(Mt.API),function(e){var t=function(l){var o,a,c,f,h,d,u,p,m,g;for(a=[],c=0,f=(l+=o="\0\0\0\0".slice(l.length%4||4)).length;f>c;c+=4)(h=(l.charCodeAt(c)<<24)+(l.charCodeAt(c+1)<<16)+(l.charCodeAt(c+2)<<8)+l.charCodeAt(c+3))!==0?(d=(h=((h=((h=((h=(h-(g=h%85))/85)-(m=h%85))/85)-(p=h%85))/85)-(u=h%85))/85)%85,a.push(d+33,u+33,p+33,m+33,g+33)):a.push(122);return function(x,y){for(var w=y;w>0;w--)x.pop()}(a,o.length),String.fromCharCode.apply(String,a)+"~>"},r=function(l){var o,a,c,f,h,d=String,u="length",p=255,m="charCodeAt",g="slice",x="replace";for(l[g](-2),l=l[g](0,-2)[x](/\s/g,"")[x]("z","!!!!!"),c=[],f=0,h=(l+=o="uuuuu"[g](l[u]%5||5))[u];h>f;f+=5)a=52200625*(l[m](f)-33)+614125*(l[m](f+1)-33)+7225*(l[m](f+2)-33)+85*(l[m](f+3)-33)+(l[m](f+4)-33),c.push(p&a>>24,p&a>>16,p&a>>8,p&a);return function(y,w){for(var b=w;b>0;b--)y.pop()}(c,o[u]),d.fromCharCode.apply(d,c)},n=function(l){return l.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(l){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((l=l.replace(/\s/g,"")).indexOf(">")!==-1&&(l=l.substr(0,l.indexOf(">"))),l.length%2&&(l+="0"),o.test(l)===!1)return"";for(var a="",c=0;c<l.length;c+=2)a+=String.fromCharCode("0x"+(l[c]+l[c+1]));return a},s=function(l){for(var o=new Uint8Array(l.length),a=l.length;a--;)o[a]=l.charCodeAt(a);return(o=Cv(o)).reduce(function(c,f){return c+String.fromCharCode(f)},"")};e.processDataByFilters=function(l,o){var a=0,c=l||"",f=[];for(typeof(o=o||[])=="string"&&(o=[o]),a=0;a<o.length;a+=1)switch(o[a]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=t(c),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=i(c),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=n(c),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=s(c),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[a]+'" is not implemented')}return{data:c,reverseChain:f.reverse().join(" ")}}}(Mt.API),function(e){e.loadFile=function(t,r,n){return function(i,s,l){s=s!==!1,l=typeof l=="function"?l:function(){};var o=void 0;try{o=function(a,c,f){var h=new XMLHttpRequest,d=0,u=function(p){var m=p.length,g=[],x=String.fromCharCode;for(d=0;d<m;d+=1)g.push(x(255&p.charCodeAt(d)));return g.join("")};if(h.open("GET",a,!c),h.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(h.onload=function(){h.status===200?f(u(this.responseText)):f(void 0)}),h.send(null),c&&h.status===200)return u(h.responseText)}(i,s,l)}catch{}return o}(t,r,n)},e.allowFsRead=void 0,e.loadImageFile=e.loadFile}(Mt.API),function(e){function t(){return(Xt.html2canvas?Promise.resolve(Xt.html2canvas):O1(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(Xt.DOMPurify?Promise.resolve(Xt.DOMPurify):O1(()=>import("./purify.es-B9ZVCkUG.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var a=Er(o);return a==="undefined"?"undefined":a==="string"||o instanceof String?"string":a==="number"||o instanceof Number?"number":a==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":a==="object"?"object":"unknown"},i=function(o,a){var c=document.createElement(o);for(var f in a.className&&(c.className=a.className),a.innerHTML&&a.dompurify&&(c.innerHTML=a.dompurify.sanitize(a.innerHTML)),a.style)c.style[f]=a.style[f];return c},s=function o(a,c){for(var f=a.nodeType===3?document.createTextNode(a.nodeValue):a.cloneNode(!1),h=a.firstChild;h;h=h.nextSibling)c!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||f.appendChild(o(h,c));return a.nodeType===1&&(a.nodeName==="CANVAS"?(f.width=a.width,f.height=a.height,f.getContext("2d").drawImage(a,0,0)):a.nodeName!=="TEXTAREA"&&a.nodeName!=="SELECT"||(f.value=a.value),f.addEventListener("load",function(){f.scrollTop=a.scrollTop,f.scrollLeft=a.scrollLeft},!0)),f},l=function o(a){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),f=o.convert(Promise.resolve(),c);return(f=f.setProgress(1,o,1,[o])).set(a)};(l.prototype=Object.create(Promise.prototype)).constructor=l,l.convert=function(o,a){return o.__proto__=a||l.prototype,o},l.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},l.prototype.from=function(o,a){return this.then(function(){switch(a=a||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o),a){case"string":return this.then(r).then(function(c){return this.set({src:i("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},l.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},l.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},a=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);a.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(a),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},l.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(a){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,a(this.prop.container,c)}).then(function(a){(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},l.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(a){var c=this.opt.jsPDF,f=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,d=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete d.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=f,f)for(var u=0;u<f.length;++u){var p=f[u],m=p.src.find(function(g){return g.format==="truetype"});m&&c.addFont(m.url,p.ref.name,p.ref.style)}return d.windowHeight=d.windowHeight||0,d.windowHeight=d.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):d.windowHeight,c.context2d.save(!0),a(this.prop.container,d)}).then(function(a){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},l.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},l.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},l.prototype.output=function(o,a,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,a):this.outputPdf(o,a)},l.prototype.outputPdf=function(o,a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,a)})},l.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},l.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},l.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},l.prototype.set=function(o){if(n(o)!=="object")return this;var a=Object.keys(o||{}).map(function(c){if(c in l.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(a)})},l.prototype.get=function(o,a){return this.then(function(){var c=o in l.template.prop?this.prop[o]:this.opt[o];return a?a(c):c})},l.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},l.prototype.setPageSize=function(o){function a(c,f){return Math.floor(c*f/72*96)}return this.then(function(){(o=o||Mt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:a(o.inner.width,o.k),height:a(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},l.prototype.setProgress=function(o,a,c,f){return o!=null&&(this.progress.val=o),a!=null&&(this.progress.state=a),c!=null&&(this.progress.n=c),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},l.prototype.updateProgress=function(o,a,c,f){return this.setProgress(o?this.progress.val+o:null,a||null,c?this.progress.n+c:null,f?this.progress.stack.concat(f):null)},l.prototype.then=function(o,a){var c=this;return this.thenCore(o,a,function(f,h){return c.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(d){return c.updateProgress(null,f),d}).then(f,h).then(function(d){return c.updateProgress(1),d})})},l.prototype.thenCore=function(o,a,c){c=c||Promise.prototype.then;var f=this;o&&(o=o.bind(f)),a&&(a=a.bind(f));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:l.convert(Object.assign({},f),Promise.prototype),d=c.call(h,o,a);return l.convert(d,f.__proto__)},l.prototype.thenExternal=function(o,a){return Promise.prototype.then.call(this,o,a)},l.prototype.thenList=function(o){var a=this;return o.forEach(function(c){a=a.thenCore(c)}),a},l.prototype.catch=function(o){o&&(o=o.bind(this));var a=Promise.prototype.catch.call(this,o);return l.convert(a,this)},l.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},l.prototype.error=function(o){return this.then(function(){throw new Error(o)})},l.prototype.using=l.prototype.set,l.prototype.saveAs=l.prototype.save,l.prototype.export=l.prototype.output,l.prototype.run=l.prototype.then,Mt.getPageSize=function(o,a,c){if(Er(o)==="object"){var f=o;o=f.orientation,a=f.unit||a,c=f.format||c}a=a||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var h,d=(""+c).toLowerCase(),u={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(a){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+a}var p,m=0,g=0;if(u.hasOwnProperty(d))m=u[d][1]/h,g=u[d][0]/h;else try{m=c[1],g=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",g>m&&(p=g,g=m,m=p);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",m>g&&(p=g,g=m,m=p)}return{width:g,height:m,unit:a,k:h,orientation:o}},e.html=function(o,a){(a=a||{}).callback=a.callback||function(){},a.html2canvas=a.html2canvas||{},a.html2canvas.canvas=a.html2canvas.canvas||this.canvas,a.jsPDF=a.jsPDF||this,a.fontFaces=a.fontFaces?a.fontFaces.map(X1):null;var c=new l(a);return a.worker?c:c.from(o).doCallback()}}(Mt.API),Mt.API.addJS=function(e){return d5=e,this.internal.events.subscribe("postPutResources",function(){lp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(lp+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),h5=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+d5+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){lp!==void 0&&h5!==void 0&&this.internal.out("/Names <</JavaScript "+lp+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),s=0;s<i.length;s++){var l=i[s],o=n.exec(l);if(o!=null){var a=o[1];r.internal.newObjectDeferredBegin(a,!1)}r.internal.write(l)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,f=[];for(s=0;s<c;s++){var h=r.internal.newObject();f.push(h);var d=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+d.objId+" 0 R /XYZ null null null]>> endobj")}var u=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<f.length;s++)r.internal.write("(page_"+(s+1)+")"+f[s]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+u+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,s){var l={title:i,options:s,children:[]};return n==null&&(n=this.root),n.children.push(l),l},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var l=n.children[s];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var o=this.count=this.count_r({count:0},l);if(o>0&&this.line("/Count "+o),l.options&&l.options.pageNumber){var a=r.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+a.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var c=0;c<n.children.length;c++)this.renderItems(n.children[c])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var s=0;s<i.children.length;s++)n.count++,this.count_r(n,i.children[s]);return n.count}}])}(Mt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,i,s,l,o){var a,c=this.decode.DCT_DECODE,f=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=l||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,a=function(h){for(var d,u=256*h.charCodeAt(4)+h.charCodeAt(5),p=h.length,m={width:0,height:0,numcomponents:1},g=4;g<p;g+=2){if(g+=u,t.indexOf(h.charCodeAt(g+1))!==-1){d=256*h.charCodeAt(g+5)+h.charCodeAt(g+6),m={width:256*h.charCodeAt(g+7)+h.charCodeAt(g+8),height:d,numcomponents:h.charCodeAt(g+9)};break}u=256*h.charCodeAt(g+2)+h.charCodeAt(g+3)}return m}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),a.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}f={data:r,width:a.width,height:a.height,colorSpace:o,bitsPerComponent:8,filter:c,index:n,alias:i}}return f}}(Mt.API),Mt.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var i,s=bL(e,{checkCrc:!0}),l=s.width,o=s.height,a=s.channels,c=s.palette,f=s.depth;i=c&&a===1?function(j){for(var L=j.width,W=j.height,F=j.data,M=j.palette,V=j.depth,G=!1,te=[],ee=[],Q=void 0,K=!1,N=0,U=0;U<M.length;U++){var R=x_(M[U],4),k=R[0],P=R[1],A=R[2],E=R[3];te.push(k,P,A),E!=null&&(E===0?(N++,ee.length<1&&ee.push(U)):E<255&&(K=!0))}if(K||N>1){G=!0,ee=void 0;var I=L*W;Q=new Uint8Array(I);for(var H=new DataView(F.buffer),J=0;J<I;J++){var Y=K1(H,J,V),Z=x_(M[Y],4)[3];Q[J]=Z}}else N===0&&(ee=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:G?8:void 0,colorBytes:F,alphaBytes:Q,needSMask:G,palette:te,mask:ee}}(s):a===2||a===4?function(j){for(var L=j.data,W=j.width,F=j.height,M=j.channels,V=j.depth,G=M===2?"DeviceGray":"DeviceRGB",te=M-1,ee=W*F,Q=te,K=ee*Q,N=1*ee,U=Math.ceil(K*V/8),R=Math.ceil(N*V/8),k=new Uint8Array(U),P=new Uint8Array(R),A=new DataView(L.buffer),E=new DataView(k.buffer),I=new DataView(P.buffer),H=!1,J=0;J<ee;J++){for(var Y=J*M,Z=0;Z<Q;Z++)_5(E,K1(A,Y+Z,V),J*Q+Z,V);var fe=K1(A,Y+Q,V);fe<(1<<V)-1&&(H=!0),_5(I,fe,1*J,V)}return{colorSpace:G,colorsPerPixel:te,sMaskBitsPerComponent:H?V:void 0,colorBytes:k,alphaBytes:P,needSMask:H}}(s):function(j){var L=j.data,W=j.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:W,colorsPerPixel:W==="DeviceGray"?1:3,colorBytes:L instanceof Uint16Array?function(F){for(var M=F.length,V=new Uint8Array(2*M),G=new DataView(V.buffer,V.byteOffset,V.byteLength),te=0;te<M;te++)G.setUint16(2*te,F[te],!1);return V}(L):L,needSMask:!1}}(s);var h,d,u,p=i,m=p.colorSpace,g=p.colorsPerPixel,x=p.sMaskBitsPerComponent,y=p.colorBytes,w=p.alphaBytes,b=p.needSMask,S=p.palette,T=p.mask,O=null;return n!==Mt.API.image_compression.NONE&&typeof Cv=="function"?(O=function(j){var L;switch(j){case Mt.API.image_compression.FAST:L=11;break;case Mt.API.image_compression.MEDIUM:L=13;break;case Mt.API.image_compression.SLOW:L=14;break;default:L=12}return L}(n),h=this.decode.FLATE_DECODE,d="/Predictor ".concat(O," /Colors ").concat(g," /BitsPerComponent ").concat(f," /Columns ").concat(l),e=x5(y,Math.ceil(l*g*f/8),g,f,n),b&&(u=x5(w,Math.ceil(l*x/8),1,x,n))):(h=void 0,d=void 0,e=y,b&&(u=w)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(u&&this.__addimage__.isArrayBuffer(u)||this.__addimage__.isArrayBufferView(u))&&(u=this.__addimage__.arrayBufferToBinaryString(u)),{alias:r,data:e,index:t,filter:h,decodeParameters:d,transparency:T,palette:S,sMask:u,predictor:O,width:l,height:o,bitsPerComponent:f,sMaskBitsPerComponent:x,colorSpace:m}}},function(e){e.processGIF89A=function(t,r,n,i){var s=new WL(t),l=s.width,o=s.height,a=[];s.decodeAndBlitFrameRGBA(0,a);var c={data:a,width:l,height:o},f=new J1(100).encode(c,100);return e.processJPEG.call(this,f,r,n,i)},e.processGIF87A=e.processGIF89A}(Mt.API),ca.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},ca.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){Fr.log("bit decode error:"+r)}},ca.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<t;i++)for(var s=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var a=this.palette[s>>7-o&1];this.data[l+4*o]=a.blue,this.data[l+4*o+1]=a.green,this.data[l+4*o+2]=a.red,this.data[l+4*o+3]=255}r!==0&&(this.pos+=4-r)}},ca.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<e;i++){var s=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+2*i*4,o=s>>4,a=15&s,c=this.palette[o];if(this.data[l]=c.blue,this.data[l+1]=c.green,this.data[l+2]=c.red,this.data[l+3]=255,2*i+1>=this.width)break;c=this.palette[a],this.data[l+4]=c.blue,this.data[l+4+1]=c.green,this.data[l+4+2]=c.red,this.data[l+4+3]=255}t!==0&&(this.pos+=4-t)}},ca.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(i<this.palette.length){var l=this.palette[i];this.data[s]=l.red,this.data[s+1]=l.green,this.data[s+2]=l.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},ca.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(s&t)/t*255|0,o=(s>>5&t)/t*255|0,a=(s>>10&t)/t*255|0,c=s>>15?255:0,f=n*this.width*4+4*i;this.data[f]=a,this.data[f+1]=o,this.data[f+2]=l,this.data[f+3]=c}this.pos+=e}},ca.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(l&t)/t*255|0,a=(l>>5&r)/r*255|0,c=(l>>11)/t*255|0,f=i*this.width*4+4*s;this.data[f]=c,this.data[f+1]=a,this.data[f+2]=o,this.data[f+3]=255}this.pos+=e}},ca.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=s,this.data[l+1]=i,this.data[l+2]=n,this.data[l+3]=255}this.pos+=this.width%4}},ca.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=l}},ca.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,i){var s=new ca(t,!1),l=s.width,o=s.height,a={data:s.getData(),width:l,height:o},c=new J1(100).encode(a,100);return e.processJPEG.call(this,c,r,n,i)}}(Mt.API),S5.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,i){var s=new S5(t),l=s.width,o=s.height,a={data:s.getData(),width:l,height:o},c=new J1(100).encode(a,100);return e.processJPEG.call(this,c,r,n,i)}}(Mt.API),Mt.API.processRGBA=function(e,t,r){for(var n=e.data,i=n.length,s=new Uint8Array(i/4*3),l=new Uint8Array(i/4),o=0,a=0,c=0;c<i;c+=4){var f=n[c],h=n[c+1],d=n[c+2],u=n[c+3];s[o++]=f,s[o++]=h,s[o++]=d,l[a++]=u}var p=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:p,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Mt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},wu=Mt.API,cp=wu.getCharWidthsArray=function(e,t){var r,n,i=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),l=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:i.metadata.Unicode.widths,a=o.fof?o.fof:1,c=t.kerning?t.kerning:i.metadata.Unicode.kerning,f=c.fof?c.fof:1,h=t.doKerning!==!1,d=0,u=e.length,p=0,m=o[0]||a,g=[];for(r=0;r<u;r++)n=e.charCodeAt(r),typeof i.metadata.widthOfString=="function"?g.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+l*(1e3/s)||0)/1e3):(d=h&&Er(c[n])==="object"&&!isNaN(parseInt(c[n][p],10))?c[n][p]/f:0,g.push((o[n]||m)/a+d)),p=n;return g},p5=wu.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return wu.processArabic&&(e=wu.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,i)/r:cp.apply(this,arguments).reduce(function(s,l){return s+l},0)},g5=function(e,t,r,n){for(var i=[],s=0,l=e.length,o=0;s!==l&&o+t[s]<r;)o+=t[s],s++;i.push(e.slice(0,s));var a=s;for(o=0;s!==l;)o+t[s]>n&&(i.push(e.slice(a,s)),o=0,a=s),o+=t[s],s++;return a!==s&&i.push(e.slice(a,s)),i},m5=function(e,t,r){r||(r={});var n,i,s,l,o,a,c,f=[],h=[f],d=r.textIndent||0,u=0,p=0,m=e.split(" "),g=cp.apply(this,[" ",r])[0];if(a=r.lineIndent===-1?m[0].length+2:r.lineIndent||0){var x=Array(a).join(" "),y=[];m.map(function(b){(b=b.split(/\s*\n/)).length>1?y=y.concat(b.map(function(S,T){return(T&&S.length?`
`:"")+S})):y.push(b[0])}),m=y,a=p5.apply(this,[x,r])}for(s=0,l=m.length;s<l;s++){var w=0;if(n=m[s],a&&n[0]==`
`&&(n=n.substr(1),w=1),d+u+(p=(i=cp.apply(this,[n,r])).reduce(function(b,S){return b+S},0))>t||w){if(p>t){for(o=g5.apply(this,[n,i,t-(d+u),t]),f.push(o.shift()),f=[o.pop()];o.length;)h.push([o.shift()]);p=i.slice(n.length-(f[0]?f[0].length:0)).reduce(function(b,S){return b+S},0)}else f=[n];h.push(f),d=p+a,u=g}else f.push(n),d+=u+p,u=g}return c=a?function(b,S){return(S?x:"")+b.join(" ")}:function(b){return b.join(" ")},h.map(c)},wu.splitTextToSize=function(e,t,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var h=this.internal.getFont(f.fontName,f.fontStyle),d="Unicode";return h.metadata[d]?{widths:h.metadata[d].widths||{0:1},kerning:h.metadata[d].kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var l=1*this.internal.scaleFactor*t/i;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=r.lineIndent;var o,a,c=[];for(o=0,a=n.length;o<a;o++)c=c.concat(m5.apply(this,[n[o],l,s]));return c},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},i={},s=0;s<16;s++)n[r[s]]=t[s],i[t[s]]=r[s];var l=function(d){return"0x"+parseInt(d,10).toString(16)},o=e.__fontmetrics__.compress=function(d){var u,p,m,g,x=["{"];for(var y in d){if(u=d[y],isNaN(parseInt(y,10))?p="'"+y+"'":(y=parseInt(y,10),p=(p=l(y).slice(2)).slice(0,-1)+i[p.slice(-1)]),typeof u=="number")u<0?(m=l(u).slice(3),g="-"):(m=l(u).slice(2),g=""),m=g+m.slice(0,-1)+i[m.slice(-1)];else{if(Er(u)!=="object")throw new Error("Don't know what to do with value type "+Er(u)+".");m=o(u)}x.push(p+m)}return x.push("}"),x.join("")},a=e.__fontmetrics__.uncompress=function(d){if(typeof d!="string")throw new Error("Invalid argument passed to uncompress.");for(var u,p,m,g,x={},y=1,w=x,b=[],S="",T="",O=d.length-1,j=1;j<O;j+=1)(g=d[j])=="'"?u?(m=u.join(""),u=void 0):u=[]:u?u.push(g):g=="{"?(b.push([w,m]),w={},m=void 0):g=="}"?((p=b.pop())[0][p[1]]=w,m=void 0,w=p[0]):g=="-"?y=-1:m===void 0?n.hasOwnProperty(g)?(S+=n[g],m=parseInt(S,16)*y,y=1,S=""):S+=g:n.hasOwnProperty(g)?(T+=n[g],w[m]=parseInt(T,16)*y,y=1,m=void 0,T=""):T+=g;return x},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:a("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},h={Unicode:{"Courier-Oblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":a("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":a("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:a("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:a("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":a("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":a("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(d){var u=d.font,p=h.Unicode[u.postScriptName];p&&(u.metadata.Unicode={},u.metadata.Unicode.widths=p.widths,u.metadata.Unicode.kerning=p.kerning);var m=f.Unicode[u.postScriptName];m&&(u.metadata.Unicode.encoding=m,u.encoding=m.codePages[0])}])}(Mt.API),function(e){var t=function(r){for(var n=r.length,i=new Uint8Array(n),s=0;s<n;s++)i[s]=r.charCodeAt(s);return i};e.API.events.push(["addFont",function(r){var n=void 0,i=r.font,s=r.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(l,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(Ip(o)),l.metadata=e.API.TTFFont.open(o),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(i,n)}}])}(Mt),Mt.API.addSvgAsImage=function(e,t,r,n,i,s,l,o){if(isNaN(t)||isNaN(r))throw Fr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(i))throw Fr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var a=document.createElement("canvas");a.width=n,a.height=i;var c=a.getContext("2d");c.fillStyle="#fff",c.fillRect(0,0,a.width,a.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return(Xt.canvg?Promise.resolve(Xt.canvg):O1(()=>import("./index.es-CVyFjCv4.js"),[])).catch(function(d){return Promise.reject(new Error("Could not load canvg: "+d))}).then(function(d){return d.default?d.default:d}).then(function(d){return d.fromString(c,e,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(d){return d.render(f)}).then(function(){h.addImage(a.toDataURL("image/jpeg",1),t,r,n,i,l,o)})},Mt.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(t,r);return this},Mt.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,i,s,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(l),a=[],c=0,f=0,h=0;function d(p,m){var g,x=!1;for(g=0;g<p.length;g+=1)p[g]===m&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var u=o.length;for(h=0;h<u;h+=1)r[o[h]].value=r[o[h]].defaultValue,r[o[h]].explicitSet=!1}if(Er(e)==="object"){for(i in e)if(s=e[i],d(o,i)&&s!==void 0){if(r[i].type==="boolean"&&typeof s=="boolean")r[i].value=s;else if(r[i].type==="name"&&d(r[i].valueSet,s))r[i].value=s;else if(r[i].type==="integer"&&Number.isInteger(s))r[i].value=s;else if(r[i].type==="array"){for(c=0;c<s.length;c+=1)if(n=!0,s[c].length===1&&typeof s[c][0]=="number")a.push(String(s[c]-1));else if(s[c].length>1){for(f=0;f<s[c].length;f+=1)typeof s[c][f]!="number"&&(n=!1);n===!0&&a.push([s[c][0]-1,s[c][1]-1].join(" "))}r[i].value="["+a.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var p,m=[];for(p in r)r[p].explicitSet===!0&&(r[p].type==="name"?m.push("/"+p+" /"+r[p].value):m.push("/"+p+" "+r[p].value));m.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+m.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),a=unescape(encodeURIComponent("</x:xmpmeta>")),c=s.length+l.length+o.length+i.length+a.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(i+s+l+o+a),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Mt.API),function(e){var t=e.API,r=t.pdfEscape16=function(s,l){for(var o,a=l.metadata.Unicode.widths,c=["","0","00","000","0000"],f=[""],h=0,d=s.length;h<d;++h){if(o=l.metadata.characterToGlyph(s.charCodeAt(h)),l.metadata.glyIdsUsed.push(o),l.metadata.toUnicode[o]=s.charCodeAt(h),a.indexOf(o)==-1&&(a.push(o),a.push([parseInt(l.metadata.widthOfGlyph(o),10)])),o=="0")return f.join("");o=o.toString(16),f.push(c[4-o.length],o)}return f.join("")},n=function(s){var l,o,a,c,f,h,d;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,a=[],h=0,d=(o=Object.keys(s).sort(function(u,p){return u-p})).length;h<d;h++)l=o[h],a.length>=100&&(f+=`
`+a.length+` beginbfchar
`+a.join(`
`)+`
endbfchar`,a=[]),s[l]!==void 0&&s[l]!==null&&typeof s[l].toString=="function"&&(c=("0000"+s[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),a.push("<"+l+"><"+c+">"));return a.length&&(f+=`
`+a.length+` beginbfchar
`+a.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(l){var o=l.font,a=l.out,c=l.newObject,f=l.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var h=o.metadata.Unicode.widths,d=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),u="",p=0;p<d.length;p++)u+=String.fromCharCode(d[p]);var m=c();f({data:u,addLength1:!0,objectId:m}),a("endobj");var g=c();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:g}),a("endobj");var x=c();a("<<"),a("/Type /FontDescriptor"),a("/FontName /"+Au(o.fontName)),a("/FontFile2 "+m+" 0 R"),a("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),a("/Flags "+o.metadata.flags),a("/StemV "+o.metadata.stemV),a("/ItalicAngle "+o.metadata.italicAngle),a("/Ascent "+o.metadata.ascender),a("/Descent "+o.metadata.decender),a("/CapHeight "+o.metadata.capHeight),a(">>"),a("endobj");var y=c();a("<<"),a("/Type /Font"),a("/BaseFont /"+Au(o.fontName)),a("/FontDescriptor "+x+" 0 R"),a("/W "+e.API.PDFObject.convert(h)),a("/CIDToGIDMap /Identity"),a("/DW 1000"),a("/Subtype /CIDFontType2"),a("/CIDSystemInfo"),a("<<"),a("/Supplement 0"),a("/Registry (Adobe)"),a("/Ordering ("+o.encoding+")"),a(">>"),a(">>"),a("endobj"),o.objectNumber=c(),a("<<"),a("/Type /Font"),a("/Subtype /Type0"),a("/ToUnicode "+g+" 0 R"),a("/BaseFont /"+Au(o.fontName)),a("/Encoding /"+o.encoding),a("/DescendantFonts ["+y+" 0 R]"),a(">>"),a("endobj"),o.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(l){var o=l.font,a=l.out,c=l.newObject,f=l.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var h=o.metadata.rawData,d="",u=0;u<h.length;u++)d+=String.fromCharCode(h[u]);var p=c();f({data:d,addLength1:!0,objectId:p}),a("endobj");var m=c();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:m}),a("endobj");var g=c();a("<<"),a("/Descent "+o.metadata.decender),a("/CapHeight "+o.metadata.capHeight),a("/StemV "+o.metadata.stemV),a("/Type /FontDescriptor"),a("/FontFile2 "+p+" 0 R"),a("/Flags 96"),a("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),a("/FontName /"+Au(o.fontName)),a("/ItalicAngle "+o.metadata.italicAngle),a("/Ascent "+o.metadata.ascender),a(">>"),a("endobj"),o.objectNumber=c();for(var x=0;x<o.metadata.hmtx.widths.length;x++)o.metadata.hmtx.widths[x]=parseInt(o.metadata.hmtx.widths[x]*(1e3/o.metadata.head.unitsPerEm));a("<</Subtype/TrueType/Type/Font/ToUnicode "+m+" 0 R/BaseFont/"+Au(o.fontName)+"/FontDescriptor "+g+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),a("endobj"),o.isAlreadyPutted=!0}})(s)}]);var i=function(s){var l,o=s.text||"",a=s.x,c=s.y,f=s.options||{},h=s.mutex||{},d=h.pdfEscape,u=h.activeFontKey,p=h.fonts,m=u,g="",x=0,y="",w=p[m].encoding;if(p[m].encoding!=="Identity-H")return{text:o,x:a,y:c,options:f,mutex:h};for(y=o,m=u,Array.isArray(o)&&(y=o[0]),x=0;x<y.length;x+=1)p[m].metadata.hasOwnProperty("cmap")&&(l=p[m].metadata.cmap.unicode.codeMap[y[x].charCodeAt(0)]),l||y[x].charCodeAt(0)<256&&p[m].metadata.hasOwnProperty("Unicode")?g+=y[x]:g+="";var b="";return parseInt(m.slice(1))<14||w==="WinAnsiEncoding"?b=d(g,m).split("").map(function(S){return S.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(b=r(g,p[m])),h.isHex=!0,{text:b,x:a,y:c,options:f,mutex:h}};t.events.push(["postProcessText",function(s){var l=s.text||"",o=[],a={text:l,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(l)){var c=0;for(c=0;c<l.length;c+=1)Array.isArray(l[c])&&l[c].length===3?o.push([i(Object.assign({},a,{text:l[c][0]})).text,l[c][1],l[c][2]]):o.push(i(Object.assign({},a,{text:l[c]})).text);s.text=o}else s.text=i(Object.assign({},a,{text:l})).text}])}(Mt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Mt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var i,s,l,o,a,c,f,h=t,d=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],u=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],p={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},m={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},g=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),y=!1,w=0;this.__bidiEngine__={};var b=function(F){var M=F.charCodeAt(),V=M>>8,G=m[V];return G!==void 0?h[256*G+(255&M)]:V===252||V===253?"AL":x.test(V)?"L":V===8?"R":"N"},S=function(F){for(var M,V=0;V<F.length;V++){if((M=b(F.charAt(V)))==="L")return!1;if(M==="R")return!0}return!1},T=function(F,M,V,G){var te,ee,Q,K,N=M[G];switch(N){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":y=!1;break;case"N":case"AN":break;case"EN":y&&(N="AN");break;case"AL":y=!0,N="R";break;case"WS":case"BN":N="N";break;case"CS":G<1||G+1>=M.length||(te=V[G-1])!=="EN"&&te!=="AN"||(ee=M[G+1])!=="EN"&&ee!=="AN"?N="N":y&&(ee="AN"),N=ee===te?ee:"N";break;case"ES":N=(te=G>0?V[G-1]:"B")==="EN"&&G+1<M.length&&M[G+1]==="EN"?"EN":"N";break;case"ET":if(G>0&&V[G-1]==="EN"){N="EN";break}if(y){N="N";break}for(Q=G+1,K=M.length;Q<K&&M[Q]==="ET";)Q++;N=Q<K&&M[Q]==="EN"?"EN":"N";break;case"NSM":if(l&&!o){for(K=M.length,Q=G+1;Q<K&&M[Q]==="NSM";)Q++;if(Q<K){var U=F[G],R=U>=1425&&U<=2303||U===64286;if(te=M[Q],R&&(te==="R"||te==="AL")){N="R";break}}}N=G<1||(te=M[G-1])==="B"?"N":V[G-1];break;case"B":y=!1,i=!0,N=w;break;case"S":s=!0,N="N"}return N},O=function(F,M,V){var G=F.split("");return V&&j(G,V,{hiLevel:w}),G.reverse(),M&&M.reverse(),G.join("")},j=function(F,M,V){var G,te,ee,Q,K,N=-1,U=F.length,R=0,k=[],P=w?u:d,A=[];for(y=!1,i=!1,s=!1,te=0;te<U;te++)A[te]=b(F[te]);for(ee=0;ee<U;ee++){if(K=R,k[ee]=T(F,A,k,ee),G=240&(R=P[K][p[k[ee]]]),R&=15,M[ee]=Q=P[R][5],G>0)if(G===16){for(te=N;te<ee;te++)M[te]=1;N=-1}else N=-1;if(P[R][6])N===-1&&(N=ee);else if(N>-1){for(te=N;te<ee;te++)M[te]=Q;N=-1}A[ee]==="B"&&(M[ee]=0),V.hiLevel|=Q}s&&function(E,I,H){for(var J=0;J<H;J++)if(E[J]==="S"){I[J]=w;for(var Y=J-1;Y>=0&&E[Y]==="WS";Y--)I[Y]=w}}(A,M,U)},L=function(F,M,V,G,te){if(!(te.hiLevel<F)){if(F===1&&w===1&&!i)return M.reverse(),void(V&&V.reverse());for(var ee,Q,K,N,U=M.length,R=0;R<U;){if(G[R]>=F){for(K=R+1;K<U&&G[K]>=F;)K++;for(N=R,Q=K-1;N<Q;N++,Q--)ee=M[N],M[N]=M[Q],M[Q]=ee,V&&(ee=V[N],V[N]=V[Q],V[Q]=ee);R=K}R++}}},W=function(F,M,V){var G=F.split(""),te={hiLevel:w};return V||(V=[]),j(G,V,te),function(ee,Q,K){if(K.hiLevel!==0&&f)for(var N,U=0;U<ee.length;U++)Q[U]===1&&(N=g.indexOf(ee[U]))>=0&&(ee[U]=g[N+1])}(G,V,te),L(2,G,M,V,te),L(1,G,M,V,te),G.join("")};return this.__bidiEngine__.doBidiReorder=function(F,M,V){if(function(te,ee){if(ee)for(var Q=0;Q<te.length;Q++)ee[Q]=Q;o===void 0&&(o=S(te)),c===void 0&&(c=S(te))}(F,M),l||!a||c)if(l&&a&&o^c)w=o?1:0,F=O(F,M,V);else if(!l&&a&&c)w=o?1:0,F=W(F,M,V),F=O(F,M);else if(!l||o||a||c){if(l&&!a&&o^c)F=O(F,M),o?(w=0,F=W(F,M,V)):(w=1,F=W(F,M,V),F=O(F,M));else if(l&&o&&!a&&c)w=1,F=W(F,M,V),F=O(F,M);else if(!l&&!a&&o^c){var G=f;o?(w=1,F=W(F,M,V),w=0,f=!1,F=W(F,M,V),f=G):(w=0,F=W(F,M,V),F=O(F,M),w=1,f=!1,F=W(F,M,V),f=G,F=O(F,M))}}else w=0,F=W(F,M,V);else w=o?1:0,F=W(F,M,V);return F},this.__bidiEngine__.setOptions=function(F){F&&(l=F.isInputVisual,a=F.isOutputVisual,o=F.isInputRtl,c=F.isOutputRtl,f=F.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var l=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var o=0;for(l=[],o=0;o<i.length;o+=1)Object.prototype.toString.call(i[o])==="[object Array]"?l.push([r.doBidiReorder(i[o][0]),i[o][1],i[o][2]]):l.push([r.doBidiReorder(i[o])]);n.text=l}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(Mt),Mt.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Ll(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new nI(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new HL(this.contents),this.head=new qL(this),this.name=new KL(this),this.cmap=new lC(this),this.toUnicode={},this.hhea=new VL(this),this.maxp=new JL(this),this.hmtx=new QL(this),this.post=new XL(this),this.os2=new GL(this),this.loca=new rI(this),this.glyf=new ZL(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,o,a,c;for(c=[],l=0,o=(a=this.bbox).length;l<o;l++)t=a[l],c.push(Math.round(t*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(r=i>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var i,s,l,o;for(l=0,s=0,o=(t=""+t).length;0<=o?s<o:s>o;s=0<=o?++s:--s)i=t.charCodeAt(s),l+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return l*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var Ca,Ll=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,i;for(i=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(t.charCodeAt(r)));return i},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,i,s,l,o,a;return t=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),s=this.readByte(),l=this.readByte(),o=this.readByte(),a=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^s)+65536*(255^l)+256*(255^o)+(255^a)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*i+16777216*s+65536*l+256*o+a},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,i,s;for(s=[],n=0,i=t.length;n<i;n++)r=t[n],s.push(this.writeByte(r));return s},e}(),HL=function(){var e;function t(r){var n,i,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,i,s,l,o,a,c,f,h,d,u,p,m;for(m in u=Object.keys(r).length,a=Math.log(2),h=16*Math.floor(Math.log(u)/a),l=Math.floor(h/a),f=16*u-h,(i=new Ll).writeInt(this.scalarType),i.writeShort(u),i.writeShort(h),i.writeShort(l),i.writeShort(f),s=16*u,c=i.pos+s,o=null,p=[],r)for(d=r[m],i.writeString(m),i.writeInt(e(d)),i.writeInt(c),i.writeInt(d.length),p=p.concat(d),m==="head"&&(o=c),c+=d.length;c%4;)p.push(0),c++;return i.write(p),n=2981146554-e(i.data),i.pos=o+8,i.writeUInt32(n),i.data},e=function(r){var n,i,s,l;for(r=cC.call(r);r.length%4;)r.push(0);for(s=new Ll(r),i=0,n=0,l=r.length;n<l;n=n+=4)i+=s.readUInt32();return 4294967295&i},t}(),$L={}.hasOwnProperty,Za=function(e,t){for(var r in t)$L.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};Ca=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var qL=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Za(e,Ca),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new Ll).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),C5=function(){function e(t,r){var n,i,s,l,o,a,c,f,h,d,u,p,m,g,x,y,w;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),h=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(a=0;a<256;++a)this.codeMap[a]=t.readByte();break;case 4:for(u=t.readUInt16(),d=u/2,t.pos+=6,s=function(){var b,S;for(S=[],a=b=0;0<=d?b<d:b>d;a=0<=d?++b:--b)S.push(t.readUInt16());return S}(),t.pos+=2,m=function(){var b,S;for(S=[],a=b=0;0<=d?b<d:b>d;a=0<=d?++b:--b)S.push(t.readUInt16());return S}(),c=function(){var b,S;for(S=[],a=b=0;0<=d?b<d:b>d;a=0<=d?++b:--b)S.push(t.readUInt16());return S}(),f=function(){var b,S;for(S=[],a=b=0;0<=d?b<d:b>d;a=0<=d?++b:--b)S.push(t.readUInt16());return S}(),i=(this.length-t.pos+this.offset)/2,o=function(){var b,S;for(S=[],a=b=0;0<=i?b<i:b>i;a=0<=i?++b:--b)S.push(t.readUInt16());return S}(),a=x=0,w=s.length;x<w;a=++x)for(g=s[a],n=y=p=m[a];p<=g?y<=g:y>=g;n=p<=g?++y:--y)f[a]===0?l=n+c[a]:(l=o[f[a]/2+(n-p)-(d-a)]||0)!==0&&(l+=c[a]),this.codeMap[n]=65535&l}t.pos=h}return e.encode=function(t,r){var n,i,s,l,o,a,c,f,h,d,u,p,m,g,x,y,w,b,S,T,O,j,L,W,F,M,V,G,te,ee,Q,K,N,U,R,k,P,A,E,I,H,J,Y,Z,fe,X;switch(G=new Ll,l=Object.keys(t).sort(function(re,se){return re-se}),r){case"macroman":for(m=0,g=function(){var re=[];for(p=0;p<256;++p)re.push(0);return re}(),y={0:0},s={},te=0,N=l.length;te<N;te++)y[Y=t[i=l[te]]]==null&&(y[Y]=++m),s[i]={old:t[i],new:y[t[i]]},g[i]=y[t[i]];return G.writeUInt16(1),G.writeUInt16(0),G.writeUInt32(12),G.writeUInt16(0),G.writeUInt16(262),G.writeUInt16(0),G.write(g),{charMap:s,subtable:G.data,maxGlyphID:m+1};case"unicode":for(M=[],h=[],w=0,y={},n={},x=c=null,ee=0,U=l.length;ee<U;ee++)y[S=t[i=l[ee]]]==null&&(y[S]=++w),n[i]={old:S,new:y[S]},o=y[S]-i,x!=null&&o===c||(x&&h.push(x),M.push(i),c=o),x=i;for(x&&h.push(x),h.push(65535),M.push(65535),W=2*(L=M.length),j=2*Math.pow(Math.log(L)/Math.LN2,2),d=Math.log(j/2)/Math.LN2,O=2*L-j,a=[],T=[],u=[],p=Q=0,R=M.length;Q<R;p=++Q){if(F=M[p],f=h[p],F===65535){a.push(0),T.push(0);break}if(F-(V=n[F].new)>=32768)for(a.push(0),T.push(2*(u.length+L-p)),i=K=F;F<=f?K<=f:K>=f;i=F<=f?++K:--K)u.push(n[i].new);else a.push(V-F),T.push(0)}for(G.writeUInt16(3),G.writeUInt16(1),G.writeUInt32(12),G.writeUInt16(4),G.writeUInt16(16+8*L+2*u.length),G.writeUInt16(0),G.writeUInt16(W),G.writeUInt16(j),G.writeUInt16(d),G.writeUInt16(O),H=0,k=h.length;H<k;H++)i=h[H],G.writeUInt16(i);for(G.writeUInt16(0),J=0,P=M.length;J<P;J++)i=M[J],G.writeUInt16(i);for(Z=0,A=a.length;Z<A;Z++)o=a[Z],G.writeUInt16(o);for(fe=0,E=T.length;fe<E;fe++)b=T[fe],G.writeUInt16(b);for(X=0,I=u.length;X<I;X++)m=u[X],G.writeUInt16(m);return{charMap:n,subtable:G.data,maxGlyphID:w+1}}},e}(),lC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Za(e,Ca),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,i;for(t.pos=this.offset,this.version=t.readUInt16(),i=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)r=new C5(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,i;return r==null&&(r="macroman"),n=C5.encode(t,r),(i=new Ll).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},e}(),VL=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Za(e,Ca),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),GL=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Za(e,Ca),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),XL=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Za(e,Ca),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,i;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(n=t.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],i=[];t.pos<this.offset+this.length;)r=t.readByte(),i.push(this.names.push(t.readString(r)));return i;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var l,o,a;for(a=[],s=l=0,o=this.file.maxp.numGlyphs;0<=o?l<o:l>o;s=0<=o?++l:--l)a.push(t.readUInt32());return a}).call(this)}},e}(),YL=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},KL=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Za(e,Ca),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,i,s,l,o,a,c,f,h,d;for(t.pos=this.offset,t.readShort(),r=t.readShort(),o=t.readShort(),n=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+o+t.readShort()});for(a={},s=f=0,h=n.length;f<h;s=++f)i=n[s],t.pos=i.offset,c=t.readString(i.length),l=new YL(c,i),a[d=i.nameID]==null&&(a[d]=[]),a[i.nameID].push(l);this.strings=a,this.copyright=a[0],this.fontFamily=a[1],this.fontSubfamily=a[2],this.uniqueSubfamily=a[3],this.fontName=a[4],this.version=a[5];try{this.postscriptName=a[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=a[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=a[7],this.manufacturer=a[8],this.designer=a[9],this.description=a[10],this.vendorUrl=a[11],this.designerUrl=a[12],this.license=a[13],this.licenseUrl=a[14],this.preferredFamily=a[15],this.preferredSubfamily=a[17],this.compatibleFull=a[18],this.sampleText=a[19]},e}(),JL=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Za(e,Ca),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),QL=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Za(e,Ca),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,i,s,l,o,a;for(t.pos=this.offset,this.metrics=[],r=0,o=this.file.hhea.numberOfMetrics;0<=o?r<o:r>o;r=0<=o?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var c,f;for(f=[],r=c=0;0<=i?c<i:c>i;r=0<=i?++c:--c)f.push(t.readInt16());return f}(),this.widths=(function(){var c,f,h,d;for(d=[],c=0,f=(h=this.metrics).length;c<f;c++)s=h[c],d.push(s.advance);return d}).call(this),n=this.widths[this.widths.length-1],a=[],r=l=0;0<=i?l<i:l>i;r=0<=i?++l:--l)a.push(this.widths.push(n));return a},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),cC=[].slice,ZL=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Za(e,Ca),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,i,s,l,o,a,c,f,h;return t in this.cache?this.cache[t]:(s=this.file.loca,r=this.file.contents,n=s.indexOf(t),(i=s.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,l=(o=new Ll(r.read(i))).readShort(),c=o.readShort(),h=o.readShort(),a=o.readShort(),f=o.readShort(),this.cache[t]=l===-1?new tI(o,c,h,a,f):new eI(o,l,c,h,a,f),this.cache[t]))},e.prototype.encode=function(t,r,n){var i,s,l,o,a;for(l=[],s=[],o=0,a=r.length;o<a;o++)i=t[r[o]],s.push(l.length),i&&(l=l.concat(i.encode(n)));return s.push(l.length),{table:l,offsets:s}},e}(),eI=function(){function e(t,r,n,i,s,l){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=s,this.yMax=l,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),tI=function(){function e(t,r,n,i,s){var l,o;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;o=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&o;)l.pos+=1&o?4:2,128&o?l.pos+=8:64&o?l.pos+=4:8&o&&(l.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Ll(cC.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),rI=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Za(e,Ca),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var i,s;for(s=[],n=0,i=this.length;n<i;n+=2)s.push(2*t.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],n=0,i=this.length;n<i;n+=4)s.push(t.readUInt32());return s}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),i=0,s=0,l=0;l<n.length;++l)if(n[l]=i,s<r.length&&r[s]==l){++s,n[l]=i;var o=this.offsets[l],a=this.offsets[l+1]-o;a>0&&(i+=a)}for(var c=new Array(4*n.length),f=0;f<n.length;++f)c[4*f+3]=255&n[f],c[4*f+2]=(65280&n[f])>>8,c[4*f+1]=(16711680&n[f])>>16,c[4*f]=(4278190080&n[f])>>24;return c},e}(),nI=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,i,s;for(r in i=this.font.cmap.tables[0].codeMap,t={},s=this.subset)n=s[r],t[r]=i[n];return t},e.prototype.glyphsFor=function(t){var r,n,i,s,l,o,a;for(i={},l=0,o=t.length;l<o;l++)i[s=t[l]]=this.font.glyf.glyphFor(s);for(s in r=[],i)(n=i[s])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(s in a=this.glyphsFor(r))n=a[s],i[s]=n;return i},e.prototype.encode=function(t,r){var n,i,s,l,o,a,c,f,h,d,u,p,m,g,x;for(i in n=lC.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(t),u={0:0},x=n.charMap)u[(a=x[i]).old]=a.new;for(p in d=n.maxGlyphID,l)p in u||(u[p]=d++);return f=function(y){var w,b;for(w in b={},y)b[y[w]]=w;return b}(u),h=Object.keys(f).sort(function(y,w){return y-w}),m=function(){var y,w,b;for(b=[],y=0,w=h.length;y<w;y++)o=h[y],b.push(f[o]);return b}(),s=this.font.glyf.encode(l,m,u),c=this.font.loca.encode(s.offsets,m),g={cmap:this.font.cmap.raw(),glyf:s.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(g["OS/2"]=this.font.os2.raw()),this.font.directory.encode(g)},e}();Mt.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,i,s,l;if(Array.isArray(r))return"["+function(){var o,a,c;for(c=[],o=0,a=r.length;o<a;o++)n=r[o],c.push(t.convert(n));return c}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in s=["<<"],r)l=r[i],s.push("/"+i+" "+t.convert(l));return s.push(">>"),s.join(`
`)}return""+r},t}();/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var _g={};_g.version="0.18.5";var uC=1252,iI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ty={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ry=function(e){iI.indexOf(e)!=-1&&(uC=ty[0]=e)};function sI(){ry(1252)}var ma=function(e){ry(e)};function ny(){ma(1200),sI()}function E5(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function aI(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function fC(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var _h=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?aI(e.slice(2)):t==254&&r==255?fC(e.slice(2)):t==65279?e.slice(1):e},up=function(t){return String.fromCharCode(t)},T5=function(t){return String.fromCharCode(t)},Sd,wl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Cd(e){for(var t="",r=0,n=0,i=0,s=0,l=0,o=0,a=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),l=(r&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,a=i&63,isNaN(n)?o=a=64:isNaN(i)&&(a=64),t+=wl.charAt(s)+wl.charAt(l)+wl.charAt(o)+wl.charAt(a);return t}function Os(e){var t="",r=0,n=0,i=0,s=0,l=0,o=0,a=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=wl.indexOf(e.charAt(c++)),l=wl.indexOf(e.charAt(c++)),r=s<<2|l>>4,t+=String.fromCharCode(r),o=wl.indexOf(e.charAt(c++)),n=(l&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),a=wl.indexOf(e.charAt(c++)),i=(o&3)<<6|a,a!==64&&(t+=String.fromCharCode(i));return t}var ar=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),zo=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Il(e){return ar?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function N5(e){return ar?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ws=function(t){return ar?zo(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function sm(e){if(typeof ArrayBuffer>"u")return ws(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Hl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function oI(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function iy(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return iy(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ti=ar?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:zo(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function lI(e){for(var t=[],r=0,n=e.length+250,i=Il(e.length+255),s=0;s<e.length;++s){var l=e.charCodeAt(s);if(l<128)i[r++]=l;else if(l<2048)i[r++]=192|l>>6&31,i[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|l>>8&7,i[r++]=128|l>>2&63,i[r++]=128|o>>6&15|(l&3)<<4,i[r++]=128|o&63}else i[r++]=224|l>>12&15,i[r++]=128|l>>6&63,i[r++]=128|l&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Il(65535),n=65530)}return t.push(i.slice(0,r)),ti(t)}var qi=/\u0000/g,kh=/[\u0001-\u0006]/g;function nf(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function xa(e,t){var r=""+e;return r.length>=t?r:hn("0",t-r.length)+r}function sy(e,t){var r=""+e;return r.length>=t?r:hn(" ",t-r.length)+r}function kg(e,t){var r=""+e;return r.length>=t?r:r+hn(" ",t-r.length)}function cI(e,t){var r=""+Math.round(e);return r.length>=t?r:hn("0",t-r.length)+r}function uI(e,t){var r=""+e;return r.length>=t?r:hn("0",t-r.length)+r}var A5=Math.pow(2,32);function bu(e,t){if(e>A5||e<-A5)return cI(e,t);var r=Math.round(e);return uI(r,t)}function Sg(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var O5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Q1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function fI(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var zt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},j5={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},hI={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Cg(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,l=1,o=0,a=1,c=0,f=0,h=Math.floor(i);c<t&&(h=Math.floor(i),o=h*l+s,f=h*c+a,!(i-h<5e-8));)i=1/(i-h),s=l,l=o,a=c,c=f;if(f>t&&(c>t?(f=a,o=s):(f=c,o=l)),!r)return[0,n*o,f];var d=Math.floor(n*o/f);return[d,n*o-d*f,f]}function bc(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,l=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)l=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var a=new Date(1900,0,1);a.setDate(a.getDate()+n-1),l=[a.getFullYear(),a.getMonth()+1,a.getDate()],s=a.getDay(),n<60&&(s=(s+6)%7),r&&(s=vI(a,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var hC=new Date(1899,11,31,0,0,0),dI=hC.getTime(),pI=new Date(1900,2,1,0,0,0);function dC(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=pI&&(r+=24*60*60*1e3),(r-(dI+(e.getTimezoneOffset()-hC.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function ay(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function gI(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function mI(e){var t=e<0?12:11,r=ay(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function xI(e){var t=ay(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Ed(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=mI(e):t===10?r=e.toFixed(10).substr(0,12):r=xI(e),ay(gI(r.toUpperCase()))}function Ic(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Ed(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Zs(14,dC(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function vI(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function yI(e,t,r,n){var i="",s=0,l=0,o=r.y,a,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:a=o%100,c=2;break;default:a=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:a=r.m,c=t.length;break;case 3:return Q1[r.m-1][1];case 5:return Q1[r.m-1][0];default:return Q1[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=r.d,c=t.length;break;case 3:return O5[r.q][0];default:return O5[r.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?xa(r.S,t.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,s=Math.round(l*(r.S+r.u)),s>=60*l&&(s=0),t==="s"?s===0?"0":""+s/l:(i=xa(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":a=r.D*24+r.H;break;case"[m]":case"[mm]":a=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":a=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:a=o,c=1;break}var f=c>0?xa(a,c):"";return f}function bl(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var pC=/%/g;function wI(e,t,r){var n=t.replace(pC,""),i=t.length-n.length;return No(e,n,r*Math.pow(10,2*i))+hn("%",i)}function bI(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return No(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function gC(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+gC(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,a,c,f){return a+c+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var mC=/# (\?+)( ?)\/( ?)(\d+)/;function _I(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),l=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(l===0?hn(" ",e[1].length+1+e[4].length):sy(l,e[1].length)+e[2]+"/"+e[3]+xa(o,e[4].length))}function kI(e,t,r){return r+(t===0?"":""+t)+hn(" ",e[1].length+2+e[4].length)}var xC=/^#*0*\.([0#]+)/,vC=/\).*[0#]/,yC=/\(###\) ###\\?-####/;function Wi(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function P5(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function F5(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function SI(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function CI(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Us(e,t,r){if(e.charCodeAt(0)===40&&!t.match(vC)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Us("n",n,r):"("+Us("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return bI(e,t,r);if(t.indexOf("%")!==-1)return wI(e,t,r);if(t.indexOf("E")!==-1)return gC(t,r);if(t.charCodeAt(0)===36)return"$"+Us(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,l,o,a=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+bu(a,t.length);if(t.match(/^[#?]+$/))return i=bu(r,0),i==="0"&&(i=""),i.length>t.length?i:Wi(t.substr(0,t.length-i.length))+i;if(s=t.match(mC))return _I(s,a,c);if(t.match(/^#+0+$/))return c+bu(a,t.length-t.indexOf("0"));if(s=t.match(xC))return i=P5(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Wi(s[1])).replace(/\.$/,"."+Wi(s[1])).replace(/\.(\d*)$/,function(p,m){return"."+m+hn("0",Wi(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+P5(a,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+bl(bu(a,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Us(e,t,-r):bl(""+(Math.floor(r)+SI(r,s[1].length)))+"."+xa(F5(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Us(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=nf(Us(e,t.replace(/[\\-]/g,""),r)),l=0,nf(nf(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<i.length?i.charAt(l++):p==="0"?"0":""}));if(t.match(yC))return i=Us(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),o=Cg(a,Math.pow(10,l)-1,!1),i=""+c,f=No("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=kg(o[2],l),f.length<s[4].length&&(f=Wi(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),o=Cg(a,Math.pow(10,l)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?sy(o[1],l)+s[2]+"/"+s[3]+kg(o[2],l):hn(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=bu(r,0),t.length<=i.length?i:Wi(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=i.indexOf(".");var h=t.indexOf(".")-l,d=t.length-i.length-h;return Wi(t.substr(0,h)+i+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return l=F5(r,s[1].length),r<0?"-"+Us(e,t,-r):bl(CI(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?xa(0,3-p.length):"")+p})+"."+xa(l,s[1].length);switch(t){case"###,##0.00":return Us(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var u=bl(bu(a,0));return u!=="0"?c+u:"";case"###,###.00":return Us(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Us(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function EI(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return No(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function TI(e,t,r){var n=t.replace(pC,""),i=t.length-n.length;return No(e,n,r*Math.pow(10,2*i))+hn("%",i)}function wC(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+wC(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,a,c,f){return a+c+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ma(e,t,r){if(e.charCodeAt(0)===40&&!t.match(vC)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ma("n",n,r):"("+Ma("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return EI(e,t,r);if(t.indexOf("%")!==-1)return TI(e,t,r);if(t.indexOf("E")!==-1)return wC(t,r);if(t.charCodeAt(0)===36)return"$"+Ma(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,l,o,a=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+xa(a,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Wi(t.substr(0,t.length-i.length))+i;if(s=t.match(mC))return kI(s,a,c);if(t.match(/^#+0+$/))return c+xa(a,t.length-t.indexOf("0"));if(s=t.match(xC))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Wi(s[1])).replace(/\.$/,"."+Wi(s[1])),i=i.replace(/\.(\d*)$/,function(p,m){return"."+m+hn("0",Wi(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+a).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+bl(""+a);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ma(e,t,-r):bl(""+r)+"."+hn("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Ma(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=nf(Ma(e,t.replace(/[\\-]/g,""),r)),l=0,nf(nf(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<i.length?i.charAt(l++):p==="0"?"0":""}));if(t.match(yC))return i=Ma(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),o=Cg(a,Math.pow(10,l)-1,!1),i=""+c,f=No("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=kg(o[2],l),f.length<s[4].length&&(f=Wi(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),o=Cg(a,Math.pow(10,l)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?sy(o[1],l)+s[2]+"/"+s[3]+kg(o[2],l):hn(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Wi(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=i.indexOf(".");var h=t.indexOf(".")-l,d=t.length-i.length-h;return Wi(t.substr(0,h)+i+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ma(e,t,-r):bl(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?xa(0,3-p.length):"")+p})+"."+xa(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var u=bl(""+a);return u!=="0"?c+u:"";default:if(t.match(/\.[0#?]*$/))return Ma(e,t.slice(0,t.lastIndexOf(".")),r)+Wi(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function No(e,t,r){return(r|0)===r?Ma(e,t,r):Us(e,t,r)}function NI(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var bC=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Af(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Sg(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(bC))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function AI(e,t,r,n){for(var i=[],s="",l=0,o="",a="t",c,f,h,d="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!Sg(e,l))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(h=e.charCodeAt(++l))!==34&&l<e.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++l;break;case"\\":var u=e.charAt(++l),p=u==="("||u===")"?u:"t";i[i.length]={t:p,v:u},++l;break;case"_":i[i.length]={t:"t",v:" "},l+=2;break;case"@":i[i.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(c==null&&(c=bc(t,r,e.charAt(l+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(l,2)},a=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=bc(t,r),c==null))return"";for(s=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)s+=o;o==="m"&&a.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:s},a=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=bc(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",d="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",l+=5,d="h"):e.substr(l,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",l+=5,d="h"):(m.t="t",++l),c==null&&m.t==="T")return"";i[i.length]=m,a=o;break;case"[":for(s=o;e.charAt(l++)!=="]"&&l<e.length;)s+=e.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(bC)){if(c==null&&(c=bc(t,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},a=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Af(e)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++l<e.length&&(o=e.charAt(l))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++l)===o;)s+=o;i[i.length]={t:o,v:s},a=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)s+=e.charAt(l);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++l;break;case"$":i[i.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++l;break}var g=0,x=0,y;for(l=i.length-1,a="t";l>=0;--l)switch(i[l].t){case"h":case"H":i[l].t=d,a="h",g<1&&(g=1);break;case"s":(y=i[l].v.match(/\.0+$/))&&(x=Math.max(x,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":a=i[l].t;break;case"m":a==="s"&&(i[l].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&i[l].v.match(/[Hh]/)&&(g=1),g<2&&i[l].v.match(/[Mm]/)&&(g=2),g<3&&i[l].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var w="",b;for(l=0;l<i.length;++l)switch(i[l].t){case"t":case"T":case" ":case"D":break;case"X":i[l].v="",i[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[l].v=yI(i[l].t.charCodeAt(0),i[l].v,c,x),i[l].t="t";break;case"n":case"?":for(b=l+1;i[b]!=null&&((o=i[b].t)==="?"||o==="D"||(o===" "||o==="t")&&i[b+1]!=null&&(i[b+1].t==="?"||i[b+1].t==="t"&&i[b+1].v==="/")||i[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[b].v==="/"||i[b].v===" "&&i[b+1]!=null&&i[b+1].t=="?"));)i[l].v+=i[b].v,i[b]={v:"",t:";"},++b;w+=i[l].v,l=b-1;break;case"G":i[l].t="t",i[l].v=Ic(t,r);break}var S="",T,O;if(w.length>0){w.charCodeAt(0)==40?(T=t<0&&w.charCodeAt(0)===45?-t:t,O=No("n",w,T)):(T=t<0&&n>1?-t:t,O=No("n",w,T),T<0&&i[0]&&i[0].t=="t"&&(O=O.substr(1),i[0].v="-"+i[0].v)),b=O.length-1;var j=i.length;for(l=0;l<i.length;++l)if(i[l]!=null&&i[l].t!="t"&&i[l].v.indexOf(".")>-1){j=l;break}var L=i.length;if(j===i.length&&O.indexOf("E")===-1){for(l=i.length-1;l>=0;--l)i[l]==null||"n?".indexOf(i[l].t)===-1||(b>=i[l].v.length-1?(b-=i[l].v.length,i[l].v=O.substr(b+1,i[l].v.length)):b<0?i[l].v="":(i[l].v=O.substr(0,b+1),b=-1),i[l].t="t",L=l);b>=0&&L<i.length&&(i[L].v=O.substr(0,b+1)+i[L].v)}else if(j!==i.length&&O.indexOf("E")===-1){for(b=O.indexOf(".")-1,l=j;l>=0;--l)if(!(i[l]==null||"n?".indexOf(i[l].t)===-1)){for(f=i[l].v.indexOf(".")>-1&&l===j?i[l].v.indexOf(".")-1:i[l].v.length-1,S=i[l].v.substr(f+1);f>=0;--f)b>=0&&(i[l].v.charAt(f)==="0"||i[l].v.charAt(f)==="#")&&(S=O.charAt(b--)+S);i[l].v=S,i[l].t="t",L=l}for(b>=0&&L<i.length&&(i[L].v=O.substr(0,b+1)+i[L].v),b=O.indexOf(".")+1,l=j;l<i.length;++l)if(!(i[l]==null||"n?(".indexOf(i[l].t)===-1&&l!==j)){for(f=i[l].v.indexOf(".")>-1&&l===j?i[l].v.indexOf(".")+1:0,S=i[l].v.substr(0,f);f<i[l].v.length;++f)b<O.length&&(S+=O.charAt(b++));i[l].v=S,i[l].t="t",L=l}}}for(l=0;l<i.length;++l)i[l]!=null&&"n?".indexOf(i[l].t)>-1&&(T=n>1&&t<0&&l>0&&i[l-1].v==="-"?-t:t,i[l].v=No(i[l].t,i[l].v,T),i[l].t="t");var W="";for(l=0;l!==i.length;++l)i[l]!=null&&(W+=i[l].v);return W}var D5=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function L5(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function OI(e,t){var r=NI(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(D5),o=r[1].match(D5);return L5(t,l)?[n,r[0]]:L5(t,o)?[n,r[1]]:[n,r[l!=null&&o!=null?2:1]]}return[n,s]}function Zs(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:zt)[e],n==null&&(n=r.table&&r.table[j5[e]]||zt[j5[e]]),n==null&&(n=hI[e]||"General");break}if(Sg(n,0))return Ic(t,r);t instanceof Date&&(t=dC(t,r.date1904));var i=OI(n,t);if(Sg(i[1]))return Ic(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return AI(i[1],t,r,i[0])}function Ao(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(zt[r]==null){t<0&&(t=r);continue}if(zt[r]==e){t=r;break}}t<0&&(t=391)}return zt[t]=e,t}function am(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Ao(e[t],t)}function Of(){zt=fI()}var jI={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},_C=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function PI(e){var t=typeof e=="number"?zt[e]:e;return t=t.replace(_C,"(\\d+)"),new RegExp("^"+t+"$")}function FI(e,t,r){var n=-1,i=-1,s=-1,l=-1,o=-1,a=-1;(t.match(_C)||[]).forEach(function(h,d){var u=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=u;break;case"d":s=u;break;case"h":l=u;break;case"s":a=u;break;case"m":l>=0?o=u:i=u;break}}),a>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2);return l==-1&&o==-1&&a==-1?c:n==-1&&i==-1&&s==-1?f:c+"T"+f}var DI=function(){var e={};e.version="1.2.0";function t(){for(var O=0,j=new Array(256),L=0;L!=256;++L)O=L,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,j[L]=O;return typeof Int32Array<"u"?new Int32Array(j):j}var r=t();function n(O){var j=0,L=0,W=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)F[W]=O[W];for(W=0;W!=256;++W)for(L=O[W],j=256+W;j<4096;j+=256)L=F[j]=L>>>8^O[L&255];var M=[];for(W=1;W!=16;++W)M[W-1]=typeof Int32Array<"u"?F.subarray(W*256,W*256+256):F.slice(W*256,W*256+256);return M}var i=n(r),s=i[0],l=i[1],o=i[2],a=i[3],c=i[4],f=i[5],h=i[6],d=i[7],u=i[8],p=i[9],m=i[10],g=i[11],x=i[12],y=i[13],w=i[14];function b(O,j){for(var L=j^-1,W=0,F=O.length;W<F;)L=L>>>8^r[(L^O.charCodeAt(W++))&255];return~L}function S(O,j){for(var L=j^-1,W=O.length-15,F=0;F<W;)L=w[O[F++]^L&255]^y[O[F++]^L>>8&255]^x[O[F++]^L>>16&255]^g[O[F++]^L>>>24]^m[O[F++]]^p[O[F++]]^u[O[F++]]^d[O[F++]]^h[O[F++]]^f[O[F++]]^c[O[F++]]^a[O[F++]]^o[O[F++]]^l[O[F++]]^s[O[F++]]^r[O[F++]];for(W+=15;F<W;)L=L>>>8^r[(L^O[F++])&255];return~L}function T(O,j){for(var L=j^-1,W=0,F=O.length,M=0,V=0;W<F;)M=O.charCodeAt(W++),M<128?L=L>>>8^r[(L^M)&255]:M<2048?(L=L>>>8^r[(L^(192|M>>6&31))&255],L=L>>>8^r[(L^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,V=O.charCodeAt(W++)&1023,L=L>>>8^r[(L^(240|M>>8&7))&255],L=L>>>8^r[(L^(128|M>>2&63))&255],L=L>>>8^r[(L^(128|V>>6&15|(M&3)<<4))&255],L=L>>>8^r[(L^(128|V&63))&255]):(L=L>>>8^r[(L^(224|M>>12&15))&255],L=L>>>8^r[(L^(128|M>>6&63))&255],L=L>>>8^r[(L^(128|M&63))&255]);return~L}return e.table=r,e.bstr=b,e.buf=S,e.str=T,e}(),Rt=function(){var t={};t.version="1.2.1";function r(ae,ke){for(var ge=ae.split("/"),ve=ke.split("/"),Se=0,Ee=0,Ue=Math.min(ge.length,ve.length);Se<Ue;++Se){if(Ee=ge[Se].length-ve[Se].length)return Ee;if(ge[Se]!=ve[Se])return ge[Se]<ve[Se]?-1:1}return ge.length-ve.length}function n(ae){if(ae.charAt(ae.length-1)=="/")return ae.slice(0,-1).indexOf("/")===-1?ae:n(ae.slice(0,-1));var ke=ae.lastIndexOf("/");return ke===-1?ae:ae.slice(0,ke+1)}function i(ae){if(ae.charAt(ae.length-1)=="/")return i(ae.slice(0,-1));var ke=ae.lastIndexOf("/");return ke===-1?ae:ae.slice(ke+1)}function s(ae,ke){typeof ke=="string"&&(ke=new Date(ke));var ge=ke.getHours();ge=ge<<6|ke.getMinutes(),ge=ge<<5|ke.getSeconds()>>>1,ae.write_shift(2,ge);var ve=ke.getFullYear()-1980;ve=ve<<4|ke.getMonth()+1,ve=ve<<5|ke.getDate(),ae.write_shift(2,ve)}function l(ae){var ke=ae.read_shift(2)&65535,ge=ae.read_shift(2)&65535,ve=new Date,Se=ge&31;ge>>>=5;var Ee=ge&15;ge>>>=4,ve.setMilliseconds(0),ve.setFullYear(ge+1980),ve.setMonth(Ee-1),ve.setDate(Se);var Ue=ke&31;ke>>>=5;var Qe=ke&63;return ke>>>=6,ve.setHours(ke),ve.setMinutes(Qe),ve.setSeconds(Ue<<1),ve}function o(ae){pi(ae,0);for(var ke={},ge=0;ae.l<=ae.length-4;){var ve=ae.read_shift(2),Se=ae.read_shift(2),Ee=ae.l+Se,Ue={};switch(ve){case 21589:ge=ae.read_shift(1),ge&1&&(Ue.mtime=ae.read_shift(4)),Se>5&&(ge&2&&(Ue.atime=ae.read_shift(4)),ge&4&&(Ue.ctime=ae.read_shift(4))),Ue.mtime&&(Ue.mt=new Date(Ue.mtime*1e3));break}ae.l=Ee,ke[ve]=Ue}return ke}var a;function c(){return a||(a={})}function f(ae,ke){if(ae[0]==80&&ae[1]==75)return St(ae,ke);if((ae[0]|32)==109&&(ae[1]|32)==105)return Et(ae,ke);if(ae.length<512)throw new Error("CFB file size "+ae.length+" < 512");var ge=3,ve=512,Se=0,Ee=0,Ue=0,Qe=0,ze=0,We=[],Ve=ae.slice(0,512);pi(Ve,0);var ft=h(Ve);switch(ge=ft[0],ge){case 3:ve=512;break;case 4:ve=4096;break;case 0:if(ft[1]==0)return St(ae,ke);default:throw new Error("Major Version: Expected 3 or 4 saw "+ge)}ve!==512&&(Ve=ae.slice(0,ve),pi(Ve,28));var mt=ae.slice(0,ve);d(Ve,ge);var kt=Ve.read_shift(4,"i");if(ge===3&&kt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+kt);Ve.l+=4,Ue=Ve.read_shift(4,"i"),Ve.l+=4,Ve.chk("00100000","Mini Stream Cutoff Size: "),Qe=Ve.read_shift(4,"i"),Se=Ve.read_shift(4,"i"),ze=Ve.read_shift(4,"i"),Ee=Ve.read_shift(4,"i");for(var gt=-1,bt=0;bt<109&&(gt=Ve.read_shift(4,"i"),!(gt<0));++bt)We[bt]=gt;var Vt=u(ae,ve);g(ze,Ee,Vt,ve,We);var Ar=y(Vt,Ue,We,ve);Ar[Ue].name="!Directory",Se>0&&Qe!==V&&(Ar[Qe].name="!MiniFAT"),Ar[We[0]].name="!FAT",Ar.fat_addrs=We,Ar.ssz=ve;var cr={},sn=[],Ea=[],ra=[];w(Ue,Ar,Vt,sn,Se,cr,Ea,Qe),p(Ea,ra,sn),sn.shift();var Ta={FileIndex:Ea,FullPaths:ra};return ke&&ke.raw&&(Ta.raw={header:mt,sectors:Vt}),Ta}function h(ae){if(ae[ae.l]==80&&ae[ae.l+1]==75)return[0,0];ae.chk(G,"Header Signature: "),ae.l+=16;var ke=ae.read_shift(2,"u");return[ae.read_shift(2,"u"),ke]}function d(ae,ke){var ge=9;switch(ae.l+=2,ge=ae.read_shift(2)){case 9:if(ke!=3)throw new Error("Sector Shift: Expected 9 saw "+ge);break;case 12:if(ke!=4)throw new Error("Sector Shift: Expected 12 saw "+ge);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ge)}ae.chk("0600","Mini Sector Shift: "),ae.chk("000000000000","Reserved: ")}function u(ae,ke){for(var ge=Math.ceil(ae.length/ke)-1,ve=[],Se=1;Se<ge;++Se)ve[Se-1]=ae.slice(Se*ke,(Se+1)*ke);return ve[ge-1]=ae.slice(ge*ke),ve}function p(ae,ke,ge){for(var ve=0,Se=0,Ee=0,Ue=0,Qe=0,ze=ge.length,We=[],Ve=[];ve<ze;++ve)We[ve]=Ve[ve]=ve,ke[ve]=ge[ve];for(;Qe<Ve.length;++Qe)ve=Ve[Qe],Se=ae[ve].L,Ee=ae[ve].R,Ue=ae[ve].C,We[ve]===ve&&(Se!==-1&&We[Se]!==Se&&(We[ve]=We[Se]),Ee!==-1&&We[Ee]!==Ee&&(We[ve]=We[Ee])),Ue!==-1&&(We[Ue]=ve),Se!==-1&&ve!=We[ve]&&(We[Se]=We[ve],Ve.lastIndexOf(Se)<Qe&&Ve.push(Se)),Ee!==-1&&ve!=We[ve]&&(We[Ee]=We[ve],Ve.lastIndexOf(Ee)<Qe&&Ve.push(Ee));for(ve=1;ve<ze;++ve)We[ve]===ve&&(Ee!==-1&&We[Ee]!==Ee?We[ve]=We[Ee]:Se!==-1&&We[Se]!==Se&&(We[ve]=We[Se]));for(ve=1;ve<ze;++ve)if(ae[ve].type!==0){if(Qe=ve,Qe!=We[Qe])do Qe=We[Qe],ke[ve]=ke[Qe]+"/"+ke[ve];while(Qe!==0&&We[Qe]!==-1&&Qe!=We[Qe]);We[ve]=-1}for(ke[0]+="/",ve=1;ve<ze;++ve)ae[ve].type!==2&&(ke[ve]+="/")}function m(ae,ke,ge){for(var ve=ae.start,Se=ae.size,Ee=[],Ue=ve;ge&&Se>0&&Ue>=0;)Ee.push(ke.slice(Ue*M,Ue*M+M)),Se-=M,Ue=mc(ge,Ue*4);return Ee.length===0?Ze(0):ti(Ee).slice(0,ae.size)}function g(ae,ke,ge,ve,Se){var Ee=V;if(ae===V){if(ke!==0)throw new Error("DIFAT chain shorter than expected")}else if(ae!==-1){var Ue=ge[ae],Qe=(ve>>>2)-1;if(!Ue)return;for(var ze=0;ze<Qe&&(Ee=mc(Ue,ze*4))!==V;++ze)Se.push(Ee);g(mc(Ue,ve-4),ke-1,ge,ve,Se)}}function x(ae,ke,ge,ve,Se){var Ee=[],Ue=[];Se||(Se=[]);var Qe=ve-1,ze=0,We=0;for(ze=ke;ze>=0;){Se[ze]=!0,Ee[Ee.length]=ze,Ue.push(ae[ze]);var Ve=ge[Math.floor(ze*4/ve)];if(We=ze*4&Qe,ve<4+We)throw new Error("FAT boundary crossed: "+ze+" 4 "+ve);if(!ae[Ve])break;ze=mc(ae[Ve],We)}return{nodes:Ee,data:G5([Ue])}}function y(ae,ke,ge,ve){var Se=ae.length,Ee=[],Ue=[],Qe=[],ze=[],We=ve-1,Ve=0,ft=0,mt=0,kt=0;for(Ve=0;Ve<Se;++Ve)if(Qe=[],mt=Ve+ke,mt>=Se&&(mt-=Se),!Ue[mt]){ze=[];var gt=[];for(ft=mt;ft>=0;){gt[ft]=!0,Ue[ft]=!0,Qe[Qe.length]=ft,ze.push(ae[ft]);var bt=ge[Math.floor(ft*4/ve)];if(kt=ft*4&We,ve<4+kt)throw new Error("FAT boundary crossed: "+ft+" 4 "+ve);if(!ae[bt]||(ft=mc(ae[bt],kt),gt[ft]))break}Ee[mt]={nodes:Qe,data:G5([ze])}}return Ee}function w(ae,ke,ge,ve,Se,Ee,Ue,Qe){for(var ze=0,We=ve.length?2:0,Ve=ke[ae].data,ft=0,mt=0,kt;ft<Ve.length;ft+=128){var gt=Ve.slice(ft,ft+128);pi(gt,64),mt=gt.read_shift(2),kt=dy(gt,0,mt-We),ve.push(kt);var bt={name:kt,type:gt.read_shift(1),color:gt.read_shift(1),L:gt.read_shift(4,"i"),R:gt.read_shift(4,"i"),C:gt.read_shift(4,"i"),clsid:gt.read_shift(16),state:gt.read_shift(4,"i"),start:0,size:0},Vt=gt.read_shift(2)+gt.read_shift(2)+gt.read_shift(2)+gt.read_shift(2);Vt!==0&&(bt.ct=b(gt,gt.l-8));var Ar=gt.read_shift(2)+gt.read_shift(2)+gt.read_shift(2)+gt.read_shift(2);Ar!==0&&(bt.mt=b(gt,gt.l-8)),bt.start=gt.read_shift(4,"i"),bt.size=gt.read_shift(4,"i"),bt.size<0&&bt.start<0&&(bt.size=bt.type=0,bt.start=V,bt.name=""),bt.type===5?(ze=bt.start,Se>0&&ze!==V&&(ke[ze].name="!StreamData")):bt.size>=4096?(bt.storage="fat",ke[bt.start]===void 0&&(ke[bt.start]=x(ge,bt.start,ke.fat_addrs,ke.ssz)),ke[bt.start].name=bt.name,bt.content=ke[bt.start].data.slice(0,bt.size)):(bt.storage="minifat",bt.size<0?bt.size=0:ze!==V&&bt.start!==V&&ke[ze]&&(bt.content=m(bt,ke[ze].data,(ke[Qe]||{}).data))),bt.content&&pi(bt.content,0),Ee[kt]=bt,Ue.push(bt)}}function b(ae,ke){return new Date((ys(ae,ke+4)/1e7*Math.pow(2,32)+ys(ae,ke)/1e7-11644473600)*1e3)}function S(ae,ke){return c(),f(a.readFileSync(ae),ke)}function T(ae,ke){var ge=ke&&ke.type;switch(ge||ar&&Buffer.isBuffer(ae)&&(ge="buffer"),ge||"base64"){case"file":return S(ae,ke);case"base64":return f(ws(Os(ae)),ke);case"binary":return f(ws(ae),ke)}return f(ae,ke)}function O(ae,ke){var ge=ke||{},ve=ge.root||"Root Entry";if(ae.FullPaths||(ae.FullPaths=[]),ae.FileIndex||(ae.FileIndex=[]),ae.FullPaths.length!==ae.FileIndex.length)throw new Error("inconsistent CFB structure");ae.FullPaths.length===0&&(ae.FullPaths[0]=ve+"/",ae.FileIndex[0]={name:ve,type:5}),ge.CLSID&&(ae.FileIndex[0].clsid=ge.CLSID),j(ae)}function j(ae){var ke="Sh33tJ5";if(!Rt.find(ae,"/"+ke)){var ge=Ze(4);ge[0]=55,ge[1]=ge[3]=50,ge[2]=54,ae.FileIndex.push({name:ke,type:2,content:ge,size:4,L:69,R:69,C:69}),ae.FullPaths.push(ae.FullPaths[0]+ke),L(ae)}}function L(ae,ke){O(ae);for(var ge=!1,ve=!1,Se=ae.FullPaths.length-1;Se>=0;--Se){var Ee=ae.FileIndex[Se];switch(Ee.type){case 0:ve?ge=!0:(ae.FileIndex.pop(),ae.FullPaths.pop());break;case 1:case 2:case 5:ve=!0,isNaN(Ee.R*Ee.L*Ee.C)&&(ge=!0),Ee.R>-1&&Ee.L>-1&&Ee.R==Ee.L&&(ge=!0);break;default:ge=!0;break}}if(!(!ge&&!ke)){var Ue=new Date(1987,1,19),Qe=0,ze=Object.create?Object.create(null):{},We=[];for(Se=0;Se<ae.FullPaths.length;++Se)ze[ae.FullPaths[Se]]=!0,ae.FileIndex[Se].type!==0&&We.push([ae.FullPaths[Se],ae.FileIndex[Se]]);for(Se=0;Se<We.length;++Se){var Ve=n(We[Se][0]);ve=ze[Ve],ve||(We.push([Ve,{name:i(Ve).replace("/",""),type:1,clsid:ee,ct:Ue,mt:Ue,content:null}]),ze[Ve]=!0)}for(We.sort(function(kt,gt){return r(kt[0],gt[0])}),ae.FullPaths=[],ae.FileIndex=[],Se=0;Se<We.length;++Se)ae.FullPaths[Se]=We[Se][0],ae.FileIndex[Se]=We[Se][1];for(Se=0;Se<We.length;++Se){var ft=ae.FileIndex[Se],mt=ae.FullPaths[Se];if(ft.name=i(mt).replace("/",""),ft.L=ft.R=ft.C=-(ft.color=1),ft.size=ft.content?ft.content.length:0,ft.start=0,ft.clsid=ft.clsid||ee,Se===0)ft.C=We.length>1?1:-1,ft.size=0,ft.type=5;else if(mt.slice(-1)=="/"){for(Qe=Se+1;Qe<We.length&&n(ae.FullPaths[Qe])!=mt;++Qe);for(ft.C=Qe>=We.length?-1:Qe,Qe=Se+1;Qe<We.length&&n(ae.FullPaths[Qe])!=n(mt);++Qe);ft.R=Qe>=We.length?-1:Qe,ft.type=1}else n(ae.FullPaths[Se+1]||"")==n(mt)&&(ft.R=Se+1),ft.type=2}}}function W(ae,ke){var ge=ke||{};if(ge.fileType=="mad")return Jn(ae,ge);switch(L(ae),ge.fileType){case"zip":return qt(ae,ge)}var ve=function(kt){for(var gt=0,bt=0,Vt=0;Vt<kt.FileIndex.length;++Vt){var Ar=kt.FileIndex[Vt];if(Ar.content){var cr=Ar.content.length;cr>0&&(cr<4096?gt+=cr+63>>6:bt+=cr+511>>9)}}for(var sn=kt.FullPaths.length+3>>2,Ea=gt+7>>3,ra=gt+127>>7,Ta=Ea+bt+sn+ra,Fs=Ta+127>>7,$o=Fs<=109?0:Math.ceil((Fs-109)/127);Ta+Fs+$o+127>>7>Fs;)$o=++Fs<=109?0:Math.ceil((Fs-109)/127);var On=[1,$o,Fs,ra,sn,bt,gt,0];return kt.FileIndex[0].size=gt<<6,On[7]=(kt.FileIndex[0].start=On[0]+On[1]+On[2]+On[3]+On[4]+On[5])+(On[6]+7>>3),On}(ae),Se=Ze(ve[7]<<9),Ee=0,Ue=0;{for(Ee=0;Ee<8;++Ee)Se.write_shift(1,te[Ee]);for(Ee=0;Ee<8;++Ee)Se.write_shift(2,0);for(Se.write_shift(2,62),Se.write_shift(2,3),Se.write_shift(2,65534),Se.write_shift(2,9),Se.write_shift(2,6),Ee=0;Ee<3;++Ee)Se.write_shift(2,0);for(Se.write_shift(4,0),Se.write_shift(4,ve[2]),Se.write_shift(4,ve[0]+ve[1]+ve[2]+ve[3]-1),Se.write_shift(4,0),Se.write_shift(4,4096),Se.write_shift(4,ve[3]?ve[0]+ve[1]+ve[2]-1:V),Se.write_shift(4,ve[3]),Se.write_shift(-4,ve[1]?ve[0]-1:V),Se.write_shift(4,ve[1]),Ee=0;Ee<109;++Ee)Se.write_shift(-4,Ee<ve[2]?ve[1]+Ee:-1)}if(ve[1])for(Ue=0;Ue<ve[1];++Ue){for(;Ee<236+Ue*127;++Ee)Se.write_shift(-4,Ee<ve[2]?ve[1]+Ee:-1);Se.write_shift(-4,Ue===ve[1]-1?V:Ue+1)}var Qe=function(kt){for(Ue+=kt;Ee<Ue-1;++Ee)Se.write_shift(-4,Ee+1);kt&&(++Ee,Se.write_shift(-4,V))};for(Ue=Ee=0,Ue+=ve[1];Ee<Ue;++Ee)Se.write_shift(-4,Q.DIFSECT);for(Ue+=ve[2];Ee<Ue;++Ee)Se.write_shift(-4,Q.FATSECT);Qe(ve[3]),Qe(ve[4]);for(var ze=0,We=0,Ve=ae.FileIndex[0];ze<ae.FileIndex.length;++ze)Ve=ae.FileIndex[ze],Ve.content&&(We=Ve.content.length,!(We<4096)&&(Ve.start=Ue,Qe(We+511>>9)));for(Qe(ve[6]+7>>3);Se.l&511;)Se.write_shift(-4,Q.ENDOFCHAIN);for(Ue=Ee=0,ze=0;ze<ae.FileIndex.length;++ze)Ve=ae.FileIndex[ze],Ve.content&&(We=Ve.content.length,!(!We||We>=4096)&&(Ve.start=Ue,Qe(We+63>>6)));for(;Se.l&511;)Se.write_shift(-4,Q.ENDOFCHAIN);for(Ee=0;Ee<ve[4]<<2;++Ee){var ft=ae.FullPaths[Ee];if(!ft||ft.length===0){for(ze=0;ze<17;++ze)Se.write_shift(4,0);for(ze=0;ze<3;++ze)Se.write_shift(4,-1);for(ze=0;ze<12;++ze)Se.write_shift(4,0);continue}Ve=ae.FileIndex[Ee],Ee===0&&(Ve.start=Ve.size?Ve.start-1:V);var mt=Ee===0&&ge.root||Ve.name;if(We=2*(mt.length+1),Se.write_shift(64,mt,"utf16le"),Se.write_shift(2,We),Se.write_shift(1,Ve.type),Se.write_shift(1,Ve.color),Se.write_shift(-4,Ve.L),Se.write_shift(-4,Ve.R),Se.write_shift(-4,Ve.C),Ve.clsid)Se.write_shift(16,Ve.clsid,"hex");else for(ze=0;ze<4;++ze)Se.write_shift(4,0);Se.write_shift(4,Ve.state||0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,Ve.start),Se.write_shift(4,Ve.size),Se.write_shift(4,0)}for(Ee=1;Ee<ae.FileIndex.length;++Ee)if(Ve=ae.FileIndex[Ee],Ve.size>=4096)if(Se.l=Ve.start+1<<9,ar&&Buffer.isBuffer(Ve.content))Ve.content.copy(Se,Se.l,0,Ve.size),Se.l+=Ve.size+511&-512;else{for(ze=0;ze<Ve.size;++ze)Se.write_shift(1,Ve.content[ze]);for(;ze&511;++ze)Se.write_shift(1,0)}for(Ee=1;Ee<ae.FileIndex.length;++Ee)if(Ve=ae.FileIndex[Ee],Ve.size>0&&Ve.size<4096)if(ar&&Buffer.isBuffer(Ve.content))Ve.content.copy(Se,Se.l,0,Ve.size),Se.l+=Ve.size+63&-64;else{for(ze=0;ze<Ve.size;++ze)Se.write_shift(1,Ve.content[ze]);for(;ze&63;++ze)Se.write_shift(1,0)}if(ar)Se.l=Se.length;else for(;Se.l<Se.length;)Se.write_shift(1,0);return Se}function F(ae,ke){var ge=ae.FullPaths.map(function(ze){return ze.toUpperCase()}),ve=ge.map(function(ze){var We=ze.split("/");return We[We.length-(ze.slice(-1)=="/"?2:1)]}),Se=!1;ke.charCodeAt(0)===47?(Se=!0,ke=ge[0].slice(0,-1)+ke):Se=ke.indexOf("/")!==-1;var Ee=ke.toUpperCase(),Ue=Se===!0?ge.indexOf(Ee):ve.indexOf(Ee);if(Ue!==-1)return ae.FileIndex[Ue];var Qe=!Ee.match(kh);for(Ee=Ee.replace(qi,""),Qe&&(Ee=Ee.replace(kh,"!")),Ue=0;Ue<ge.length;++Ue)if((Qe?ge[Ue].replace(kh,"!"):ge[Ue]).replace(qi,"")==Ee||(Qe?ve[Ue].replace(kh,"!"):ve[Ue]).replace(qi,"")==Ee)return ae.FileIndex[Ue];return null}var M=64,V=-2,G="d0cf11e0a1b11ae1",te=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",Q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:V,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function K(ae,ke,ge){c();var ve=W(ae,ge);a.writeFileSync(ke,ve)}function N(ae){for(var ke=new Array(ae.length),ge=0;ge<ae.length;++ge)ke[ge]=String.fromCharCode(ae[ge]);return ke.join("")}function U(ae,ke){var ge=W(ae,ke);switch(ke&&ke.type||"buffer"){case"file":return c(),a.writeFileSync(ke.filename,ge),ge;case"binary":return typeof ge=="string"?ge:N(ge);case"base64":return Cd(typeof ge=="string"?ge:N(ge));case"buffer":if(ar)return Buffer.isBuffer(ge)?ge:zo(ge);case"array":return typeof ge=="string"?ws(ge):ge}return ge}var R;function k(ae){try{var ke=ae.InflateRaw,ge=new ke;if(ge._processChunk(new Uint8Array([3,0]),ge._finishFlushFlag),ge.bytesRead)R=ae;else throw new Error("zlib does not expose bytesRead")}catch(ve){console.error("cannot use native zlib: "+(ve.message||ve))}}function P(ae,ke){if(!R)return _t(ae,ke);var ge=R.InflateRaw,ve=new ge,Se=ve._processChunk(ae.slice(ae.l),ve._finishFlushFlag);return ae.l+=ve.bytesRead,Se}function A(ae){return R?R.deflateRawSync(ae):Oe(ae)}var E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],I=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],H=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function J(ae){var ke=(ae<<1|ae<<11)&139536|(ae<<5|ae<<15)&558144;return(ke>>16|ke>>8|ke)&255}for(var Y=typeof Uint8Array<"u",Z=Y?new Uint8Array(256):[],fe=0;fe<256;++fe)Z[fe]=J(fe);function X(ae,ke){var ge=Z[ae&255];return ke<=8?ge>>>8-ke:(ge=ge<<8|Z[ae>>8&255],ke<=16?ge>>>16-ke:(ge=ge<<8|Z[ae>>16&255],ge>>>24-ke))}function re(ae,ke){var ge=ke&7,ve=ke>>>3;return(ae[ve]|(ge<=6?0:ae[ve+1]<<8))>>>ge&3}function se(ae,ke){var ge=ke&7,ve=ke>>>3;return(ae[ve]|(ge<=5?0:ae[ve+1]<<8))>>>ge&7}function z(ae,ke){var ge=ke&7,ve=ke>>>3;return(ae[ve]|(ge<=4?0:ae[ve+1]<<8))>>>ge&15}function oe(ae,ke){var ge=ke&7,ve=ke>>>3;return(ae[ve]|(ge<=3?0:ae[ve+1]<<8))>>>ge&31}function ce(ae,ke){var ge=ke&7,ve=ke>>>3;return(ae[ve]|(ge<=1?0:ae[ve+1]<<8))>>>ge&127}function we(ae,ke,ge){var ve=ke&7,Se=ke>>>3,Ee=(1<<ge)-1,Ue=ae[Se]>>>ve;return ge<8-ve||(Ue|=ae[Se+1]<<8-ve,ge<16-ve)||(Ue|=ae[Se+2]<<16-ve,ge<24-ve)||(Ue|=ae[Se+3]<<24-ve),Ue&Ee}function ye(ae,ke,ge){var ve=ke&7,Se=ke>>>3;return ve<=5?ae[Se]|=(ge&7)<<ve:(ae[Se]|=ge<<ve&255,ae[Se+1]=(ge&7)>>8-ve),ke+3}function de(ae,ke,ge){var ve=ke&7,Se=ke>>>3;return ge=(ge&1)<<ve,ae[Se]|=ge,ke+1}function Te(ae,ke,ge){var ve=ke&7,Se=ke>>>3;return ge<<=ve,ae[Se]|=ge&255,ge>>>=8,ae[Se+1]=ge,ke+8}function pe(ae,ke,ge){var ve=ke&7,Se=ke>>>3;return ge<<=ve,ae[Se]|=ge&255,ge>>>=8,ae[Se+1]=ge&255,ae[Se+2]=ge>>>8,ke+16}function Ae(ae,ke){var ge=ae.length,ve=2*ge>ke?2*ge:ke+5,Se=0;if(ge>=ke)return ae;if(ar){var Ee=N5(ve);if(ae.copy)ae.copy(Ee);else for(;Se<ae.length;++Se)Ee[Se]=ae[Se];return Ee}else if(Y){var Ue=new Uint8Array(ve);if(Ue.set)Ue.set(ae);else for(;Se<ge;++Se)Ue[Se]=ae[Se];return Ue}return ae.length=ve,ae}function Ie(ae){for(var ke=new Array(ae),ge=0;ge<ae;++ge)ke[ge]=0;return ke}function je(ae,ke,ge){var ve=1,Se=0,Ee=0,Ue=0,Qe=0,ze=ae.length,We=Y?new Uint16Array(32):Ie(32);for(Ee=0;Ee<32;++Ee)We[Ee]=0;for(Ee=ze;Ee<ge;++Ee)ae[Ee]=0;ze=ae.length;var Ve=Y?new Uint16Array(ze):Ie(ze);for(Ee=0;Ee<ze;++Ee)We[Se=ae[Ee]]++,ve<Se&&(ve=Se),Ve[Ee]=0;for(We[0]=0,Ee=1;Ee<=ve;++Ee)We[Ee+16]=Qe=Qe+We[Ee-1]<<1;for(Ee=0;Ee<ze;++Ee)Qe=ae[Ee],Qe!=0&&(Ve[Ee]=We[Qe+16]++);var ft=0;for(Ee=0;Ee<ze;++Ee)if(ft=ae[Ee],ft!=0)for(Qe=X(Ve[Ee],ve)>>ve-ft,Ue=(1<<ve+4-ft)-1;Ue>=0;--Ue)ke[Qe|Ue<<ft]=ft&15|Ee<<4;return ve}var Le=Y?new Uint16Array(512):Ie(512),Xe=Y?new Uint16Array(32):Ie(32);if(!Y){for(var Je=0;Je<512;++Je)Le[Je]=0;for(Je=0;Je<32;++Je)Xe[Je]=0}(function(){for(var ae=[],ke=0;ke<32;ke++)ae.push(5);je(ae,Xe,32);var ge=[];for(ke=0;ke<=143;ke++)ge.push(8);for(;ke<=255;ke++)ge.push(9);for(;ke<=279;ke++)ge.push(7);for(;ke<=287;ke++)ge.push(8);je(ge,Le,288)})();var Ne=function(){for(var ke=Y?new Uint8Array(32768):[],ge=0,ve=0;ge<H.length-1;++ge)for(;ve<H[ge+1];++ve)ke[ve]=ge;for(;ve<32768;++ve)ke[ve]=29;var Se=Y?new Uint8Array(259):[];for(ge=0,ve=0;ge<I.length-1;++ge)for(;ve<I[ge+1];++ve)Se[ve]=ge;function Ee(Qe,ze){for(var We=0;We<Qe.length;){var Ve=Math.min(65535,Qe.length-We),ft=We+Ve==Qe.length;for(ze.write_shift(1,+ft),ze.write_shift(2,Ve),ze.write_shift(2,~Ve&65535);Ve-- >0;)ze[ze.l++]=Qe[We++]}return ze.l}function Ue(Qe,ze){for(var We=0,Ve=0,ft=Y?new Uint16Array(32768):[];Ve<Qe.length;){var mt=Math.min(65535,Qe.length-Ve);if(mt<10){for(We=ye(ze,We,+(Ve+mt==Qe.length)),We&7&&(We+=8-(We&7)),ze.l=We/8|0,ze.write_shift(2,mt),ze.write_shift(2,~mt&65535);mt-- >0;)ze[ze.l++]=Qe[Ve++];We=ze.l*8;continue}We=ye(ze,We,+(Ve+mt==Qe.length)+2);for(var kt=0;mt-- >0;){var gt=Qe[Ve];kt=(kt<<5^gt)&32767;var bt=-1,Vt=0;if((bt=ft[kt])&&(bt|=Ve&-32768,bt>Ve&&(bt-=32768),bt<Ve))for(;Qe[bt+Vt]==Qe[Ve+Vt]&&Vt<250;)++Vt;if(Vt>2){gt=Se[Vt],gt<=22?We=Te(ze,We,Z[gt+1]>>1)-1:(Te(ze,We,3),We+=5,Te(ze,We,Z[gt-23]>>5),We+=3);var Ar=gt<8?0:gt-4>>2;Ar>0&&(pe(ze,We,Vt-I[gt]),We+=Ar),gt=ke[Ve-bt],We=Te(ze,We,Z[gt]>>3),We-=3;var cr=gt<4?0:gt-2>>1;cr>0&&(pe(ze,We,Ve-bt-H[gt]),We+=cr);for(var sn=0;sn<Vt;++sn)ft[kt]=Ve&32767,kt=(kt<<5^Qe[Ve])&32767,++Ve;mt-=Vt-1}else gt<=143?gt=gt+48:We=de(ze,We,1),We=Te(ze,We,Z[gt]),ft[kt]=Ve&32767,++Ve}We=Te(ze,We,0)-1}return ze.l=(We+7)/8|0,ze.l}return function(ze,We){return ze.length<8?Ee(ze,We):Ue(ze,We)}}();function Oe(ae){var ke=Ze(50+Math.floor(ae.length*1.1)),ge=Ne(ae,ke);return ke.slice(0,ge)}var De=Y?new Uint16Array(32768):Ie(32768),Ye=Y?new Uint16Array(32768):Ie(32768),it=Y?new Uint16Array(128):Ie(128),Ke=1,et=1;function Ge(ae,ke){var ge=oe(ae,ke)+257;ke+=5;var ve=oe(ae,ke)+1;ke+=5;var Se=z(ae,ke)+4;ke+=4;for(var Ee=0,Ue=Y?new Uint8Array(19):Ie(19),Qe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ze=1,We=Y?new Uint8Array(8):Ie(8),Ve=Y?new Uint8Array(8):Ie(8),ft=Ue.length,mt=0;mt<Se;++mt)Ue[E[mt]]=Ee=se(ae,ke),ze<Ee&&(ze=Ee),We[Ee]++,ke+=3;var kt=0;for(We[0]=0,mt=1;mt<=ze;++mt)Ve[mt]=kt=kt+We[mt-1]<<1;for(mt=0;mt<ft;++mt)(kt=Ue[mt])!=0&&(Qe[mt]=Ve[kt]++);var gt=0;for(mt=0;mt<ft;++mt)if(gt=Ue[mt],gt!=0){kt=Z[Qe[mt]]>>8-gt;for(var bt=(1<<7-gt)-1;bt>=0;--bt)it[kt|bt<<gt]=gt&7|mt<<3}var Vt=[];for(ze=1;Vt.length<ge+ve;)switch(kt=it[ce(ae,ke)],ke+=kt&7,kt>>>=3){case 16:for(Ee=3+re(ae,ke),ke+=2,kt=Vt[Vt.length-1];Ee-- >0;)Vt.push(kt);break;case 17:for(Ee=3+se(ae,ke),ke+=3;Ee-- >0;)Vt.push(0);break;case 18:for(Ee=11+ce(ae,ke),ke+=7;Ee-- >0;)Vt.push(0);break;default:Vt.push(kt),ze<kt&&(ze=kt);break}var Ar=Vt.slice(0,ge),cr=Vt.slice(ge);for(mt=ge;mt<286;++mt)Ar[mt]=0;for(mt=ve;mt<30;++mt)cr[mt]=0;return Ke=je(Ar,De,286),et=je(cr,Ye,30),ke}function ot(ae,ke){if(ae[0]==3&&!(ae[1]&3))return[Il(ke),2];for(var ge=0,ve=0,Se=N5(ke||1<<18),Ee=0,Ue=Se.length>>>0,Qe=0,ze=0;!(ve&1);){if(ve=se(ae,ge),ge+=3,ve>>>1)ve>>1==1?(Qe=9,ze=5):(ge=Ge(ae,ge),Qe=Ke,ze=et);else{ge&7&&(ge+=8-(ge&7));var We=ae[ge>>>3]|ae[(ge>>>3)+1]<<8;if(ge+=32,We>0)for(!ke&&Ue<Ee+We&&(Se=Ae(Se,Ee+We),Ue=Se.length);We-- >0;)Se[Ee++]=ae[ge>>>3],ge+=8;continue}for(;;){!ke&&Ue<Ee+32767&&(Se=Ae(Se,Ee+32767),Ue=Se.length);var Ve=we(ae,ge,Qe),ft=ve>>>1==1?Le[Ve]:De[Ve];if(ge+=ft&15,ft>>>=4,!(ft>>>8&255))Se[Ee++]=ft;else{if(ft==256)break;ft-=257;var mt=ft<8?0:ft-4>>2;mt>5&&(mt=0);var kt=Ee+I[ft];mt>0&&(kt+=we(ae,ge,mt),ge+=mt),Ve=we(ae,ge,ze),ft=ve>>>1==1?Xe[Ve]:Ye[Ve],ge+=ft&15,ft>>>=4;var gt=ft<4?0:ft-2>>1,bt=H[ft];for(gt>0&&(bt+=we(ae,ge,gt),ge+=gt),!ke&&Ue<kt&&(Se=Ae(Se,kt+100),Ue=Se.length);Ee<kt;)Se[Ee]=Se[Ee-bt],++Ee}}}return ke?[Se,ge+7>>>3]:[Se.slice(0,Ee),ge+7>>>3]}function _t(ae,ke){var ge=ae.slice(ae.l||0),ve=ot(ge,ke);return ae.l+=ve[1],ve[0]}function yt(ae,ke){if(ae)typeof console<"u"&&console.error(ke);else throw new Error(ke)}function St(ae,ke){var ge=ae;pi(ge,0);var ve=[],Se=[],Ee={FileIndex:ve,FullPaths:Se};O(Ee,{root:ke.root});for(var Ue=ge.length-4;(ge[Ue]!=80||ge[Ue+1]!=75||ge[Ue+2]!=5||ge[Ue+3]!=6)&&Ue>=0;)--Ue;ge.l=Ue+4,ge.l+=4;var Qe=ge.read_shift(2);ge.l+=6;var ze=ge.read_shift(4);for(ge.l=ze,Ue=0;Ue<Qe;++Ue){ge.l+=20;var We=ge.read_shift(4),Ve=ge.read_shift(4),ft=ge.read_shift(2),mt=ge.read_shift(2),kt=ge.read_shift(2);ge.l+=8;var gt=ge.read_shift(4),bt=o(ge.slice(ge.l+ft,ge.l+ft+mt));ge.l+=ft+mt+kt;var Vt=ge.l;ge.l=gt+4,Bt(ge,We,Ve,Ee,bt),ge.l=Vt}return Ee}function Bt(ae,ke,ge,ve,Se){ae.l+=2;var Ee=ae.read_shift(2),Ue=ae.read_shift(2),Qe=l(ae);if(Ee&8257)throw new Error("Unsupported ZIP encryption");for(var ze=ae.read_shift(4),We=ae.read_shift(4),Ve=ae.read_shift(4),ft=ae.read_shift(2),mt=ae.read_shift(2),kt="",gt=0;gt<ft;++gt)kt+=String.fromCharCode(ae[ae.l++]);if(mt){var bt=o(ae.slice(ae.l,ae.l+mt));(bt[21589]||{}).mt&&(Qe=bt[21589].mt),((Se||{})[21589]||{}).mt&&(Qe=Se[21589].mt)}ae.l+=mt;var Vt=ae.slice(ae.l,ae.l+We);switch(Ue){case 8:Vt=P(ae,Ve);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ue)}var Ar=!1;Ee&8&&(ze=ae.read_shift(4),ze==134695760&&(ze=ae.read_shift(4),Ar=!0),We=ae.read_shift(4),Ve=ae.read_shift(4)),We!=ke&&yt(Ar,"Bad compressed size: "+ke+" != "+We),Ve!=ge&&yt(Ar,"Bad uncompressed size: "+ge+" != "+Ve),vi(ve,kt,Vt,{unsafe:!0,mt:Qe})}function qt(ae,ke){var ge=ke||{},ve=[],Se=[],Ee=Ze(1),Ue=ge.compression?8:0,Qe=0,ze=0,We=0,Ve=0,ft=0,mt=ae.FullPaths[0],kt=mt,gt=ae.FileIndex[0],bt=[],Vt=0;for(ze=1;ze<ae.FullPaths.length;++ze)if(kt=ae.FullPaths[ze].slice(mt.length),gt=ae.FileIndex[ze],!(!gt.size||!gt.content||kt=="Sh33tJ5")){var Ar=Ve,cr=Ze(kt.length);for(We=0;We<kt.length;++We)cr.write_shift(1,kt.charCodeAt(We)&127);cr=cr.slice(0,cr.l),bt[ft]=DI.buf(gt.content,0);var sn=gt.content;Ue==8&&(sn=A(sn)),Ee=Ze(30),Ee.write_shift(4,67324752),Ee.write_shift(2,20),Ee.write_shift(2,Qe),Ee.write_shift(2,Ue),gt.mt?s(Ee,gt.mt):Ee.write_shift(4,0),Ee.write_shift(-4,bt[ft]),Ee.write_shift(4,sn.length),Ee.write_shift(4,gt.content.length),Ee.write_shift(2,cr.length),Ee.write_shift(2,0),Ve+=Ee.length,ve.push(Ee),Ve+=cr.length,ve.push(cr),Ve+=sn.length,ve.push(sn),Ee=Ze(46),Ee.write_shift(4,33639248),Ee.write_shift(2,0),Ee.write_shift(2,20),Ee.write_shift(2,Qe),Ee.write_shift(2,Ue),Ee.write_shift(4,0),Ee.write_shift(-4,bt[ft]),Ee.write_shift(4,sn.length),Ee.write_shift(4,gt.content.length),Ee.write_shift(2,cr.length),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(4,0),Ee.write_shift(4,Ar),Vt+=Ee.l,Se.push(Ee),Vt+=cr.length,Se.push(cr),++ft}return Ee=Ze(22),Ee.write_shift(4,101010256),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(2,ft),Ee.write_shift(2,ft),Ee.write_shift(4,Vt),Ee.write_shift(4,Ve),Ee.write_shift(2,0),ti([ti(ve),ti(Se),Ee])}var Ct={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function sr(ae,ke){if(ae.ctype)return ae.ctype;var ge=ae.name||"",ve=ge.match(/\.([^\.]+)$/);return ve&&Ct[ve[1]]||ke&&(ve=(ge=ke).match(/[\.\\]([^\.\\])+$/),ve&&Ct[ve[1]])?Ct[ve[1]]:"application/octet-stream"}function Xi(ae){for(var ke=Cd(ae),ge=[],ve=0;ve<ke.length;ve+=76)ge.push(ke.slice(ve,ve+76));return ge.join(`\r
`)+`\r
`}function Dr(ae){var ke=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(We){var Ve=We.charCodeAt(0).toString(16).toUpperCase();return"="+(Ve.length==1?"0"+Ve:Ve)});ke=ke.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ke.charAt(0)==`
`&&(ke="=0D"+ke.slice(1)),ke=ke.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ge=[],ve=ke.split(`\r
`),Se=0;Se<ve.length;++Se){var Ee=ve[Se];if(Ee.length==0){ge.push("");continue}for(var Ue=0;Ue<Ee.length;){var Qe=76,ze=Ee.slice(Ue,Ue+Qe);ze.charAt(Qe-1)=="="?Qe--:ze.charAt(Qe-2)=="="?Qe-=2:ze.charAt(Qe-3)=="="&&(Qe-=3),ze=Ee.slice(Ue,Ue+Qe),Ue+=Qe,Ue<Ee.length&&(ze+="="),ge.push(ze)}}return ge.join(`\r
`)}function ii(ae){for(var ke=[],ge=0;ge<ae.length;++ge){for(var ve=ae[ge];ge<=ae.length&&ve.charAt(ve.length-1)=="=";)ve=ve.slice(0,ve.length-1)+ae[++ge];ke.push(ve)}for(var Se=0;Se<ke.length;++Se)ke[Se]=ke[Se].replace(/[=][0-9A-Fa-f]{2}/g,function(Ee){return String.fromCharCode(parseInt(Ee.slice(1),16))});return ws(ke.join(`\r
`))}function Ii(ae,ke,ge){for(var ve="",Se="",Ee="",Ue,Qe=0;Qe<10;++Qe){var ze=ke[Qe];if(!ze||ze.match(/^\s*$/))break;var We=ze.match(/^(.*?):\s*([^\s].*)$/);if(We)switch(We[1].toLowerCase()){case"content-location":ve=We[2].trim();break;case"content-type":Ee=We[2].trim();break;case"content-transfer-encoding":Se=We[2].trim();break}}switch(++Qe,Se.toLowerCase()){case"base64":Ue=ws(Os(ke.slice(Qe).join("")));break;case"quoted-printable":Ue=ii(ke.slice(Qe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Se)}var Ve=vi(ae,ve.slice(ge.length),Ue,{unsafe:!0});Ee&&(Ve.ctype=Ee)}function Et(ae,ke){if(N(ae.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ge=ke&&ke.root||"",ve=(ar&&Buffer.isBuffer(ae)?ae.toString("binary"):N(ae)).split(`\r
`),Se=0,Ee="";for(Se=0;Se<ve.length;++Se)if(Ee=ve[Se],!!/^Content-Location:/i.test(Ee)&&(Ee=Ee.slice(Ee.indexOf("file")),ge||(ge=Ee.slice(0,Ee.lastIndexOf("/")+1)),Ee.slice(0,ge.length)!=ge))for(;ge.length>0&&(ge=ge.slice(0,ge.length-1),ge=ge.slice(0,ge.lastIndexOf("/")+1),Ee.slice(0,ge.length)!=ge););var Ue=(ve[1]||"").match(/boundary="(.*?)"/);if(!Ue)throw new Error("MAD cannot find boundary");var Qe="--"+(Ue[1]||""),ze=[],We=[],Ve={FileIndex:ze,FullPaths:We};O(Ve);var ft,mt=0;for(Se=0;Se<ve.length;++Se){var kt=ve[Se];kt!==Qe&&kt!==Qe+"--"||(mt++&&Ii(Ve,ve.slice(ft,Se),ge),ft=Se)}return Ve}function Jn(ae,ke){var ge=ke||{},ve=ge.boundary||"SheetJS";ve="------="+ve;for(var Se=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ve.slice(2)+'"',"","",""],Ee=ae.FullPaths[0],Ue=Ee,Qe=ae.FileIndex[0],ze=1;ze<ae.FullPaths.length;++ze)if(Ue=ae.FullPaths[ze].slice(Ee.length),Qe=ae.FileIndex[ze],!(!Qe.size||!Qe.content||Ue=="Sh33tJ5")){Ue=Ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Vt){return"_x"+Vt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Vt){return"_u"+Vt.charCodeAt(0).toString(16)+"_"});for(var We=Qe.content,Ve=ar&&Buffer.isBuffer(We)?We.toString("binary"):N(We),ft=0,mt=Math.min(1024,Ve.length),kt=0,gt=0;gt<=mt;++gt)(kt=Ve.charCodeAt(gt))>=32&&kt<128&&++ft;var bt=ft>=mt*4/5;Se.push(ve),Se.push("Content-Location: "+(ge.root||"file:///C:/SheetJS/")+Ue),Se.push("Content-Transfer-Encoding: "+(bt?"quoted-printable":"base64")),Se.push("Content-Type: "+sr(Qe,Ue)),Se.push(""),Se.push(bt?Dr(Ve):Xi(Ve))}return Se.push(ve+`--\r
`),Se.join(`\r
`)}function ta(ae){var ke={};return O(ke,ae),ke}function vi(ae,ke,ge,ve){var Se=ve&&ve.unsafe;Se||O(ae);var Ee=!Se&&Rt.find(ae,ke);if(!Ee){var Ue=ae.FullPaths[0];ke.slice(0,Ue.length)==Ue?Ue=ke:(Ue.slice(-1)!="/"&&(Ue+="/"),Ue=(Ue+ke).replace("//","/")),Ee={name:i(ke),type:2},ae.FileIndex.push(Ee),ae.FullPaths.push(Ue),Se||Rt.utils.cfb_gc(ae)}return Ee.content=ge,Ee.size=ge?ge.length:0,ve&&(ve.CLSID&&(Ee.clsid=ve.CLSID),ve.mt&&(Ee.mt=ve.mt),ve.ct&&(Ee.ct=ve.ct)),Ee}function Yi(ae,ke){O(ae);var ge=Rt.find(ae,ke);if(ge){for(var ve=0;ve<ae.FileIndex.length;++ve)if(ae.FileIndex[ve]==ge)return ae.FileIndex.splice(ve,1),ae.FullPaths.splice(ve,1),!0}return!1}function Gr(ae,ke,ge){O(ae);var ve=Rt.find(ae,ke);if(ve){for(var Se=0;Se<ae.FileIndex.length;++Se)if(ae.FileIndex[Se]==ve)return ae.FileIndex[Se].name=i(ge),ae.FullPaths[Se]=ge,!0}return!1}function An(ae){L(ae,!0)}return t.find=F,t.read=T,t.parse=f,t.write=U,t.writeFile=K,t.utils={cfb_new:ta,cfb_add:vi,cfb_del:Yi,cfb_mov:Gr,cfb_gc:An,ReadShift:Rh,CheckField:$C,prep_blob:pi,bconcat:ti,use_zlib:k,_deflateRaw:Oe,_inflateRaw:_t,consts:Q},t}();function LI(e){return typeof e=="string"?sm(e):Array.isArray(e)?oI(e):e}function Gd(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=sm(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Va(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([LI(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Hl(t)),o.write(t),o.close(),t}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("cannot save file "+e)}function II(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function pn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function I5(e,t){for(var r=[],n=pn(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function om(e){for(var t=[],r=pn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function lm(e){for(var t=[],r=pn(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function MI(e){for(var t=[],r=pn(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Eg=new Date(1899,11,30,0,0,0);function Kn(e,t){var r=e.getTime(),n=Eg.getTime()+(e.getTimezoneOffset()-Eg.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var kC=new Date,RI=Eg.getTime()+(kC.getTimezoneOffset()-Eg.getTimezoneOffset())*6e4,M5=kC.getTimezoneOffset();function cm(e){var t=new Date;return t.setTime(e*24*60*60*1e3+RI),t.getTimezoneOffset()!==M5&&t.setTime(t.getTime()+(t.getTimezoneOffset()-M5)*6e4),t}function BI(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var R5=new Date("2017-02-19T19:06:09.000Z"),SC=isNaN(R5.getFullYear())?new Date("2/19/17"):R5,UI=SC.getFullYear()==2017;function qr(e,t){var r=new Date(e);if(UI)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(SC.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Mc(e,t){if(ar&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Va(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Va(fC(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Va(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Va(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Vr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Vr(e[r]));return t}function hn(e,t){for(var r="";r.length<t;)r+=e;return r}function wa(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var zI=["january","february","march","april","may","june","july","august","september","october","november","december"];function yf(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&zI.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var WI=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),l=[s[0]],o=1;o<s.length;++o)l.push(i),l.push(s[o]);return l}}();function CC(e){return e?e.content&&e.type?Mc(e.content,!0):e.data?_h(e.data):e.asNodeBuffer&&ar?_h(e.asNodeBuffer().toString("binary")):e.asBinary?_h(e.asBinary()):e._data&&e._data.getContent?_h(Mc(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function EC(e){if(!e)return null;if(e.data)return E5(e.data);if(e.asNodeBuffer&&ar)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?E5(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function HI(e){return e&&e.name.slice(-4)===".bin"?EC(e):CC(e)}function Hs(e,t){for(var r=e.FullPaths||pn(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var l=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||i==l)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function oy(e,t){var r=Hs(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Ln(e,t,r){if(!r)return HI(oy(e,t));if(!t)return null;try{return Ln(e,t)}catch{return null}}function bs(e,t,r){if(!r)return CC(oy(e,t));if(!t)return null;try{return bs(e,t)}catch{return null}}function $I(e,t,r){return EC(oy(e,t))}function B5(e){for(var t=e.FullPaths||pn(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function ir(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return ar?n=zo(r):n=lI(r),Rt.utils.cfb_add(e,t,n)}Rt.utils.cfb_add(e,t,r)}else e.file(t,r)}function ly(){return Rt.utils.cfb_new()}function TC(e,t){switch(t.type){case"base64":return Rt.read(e,{type:"base64"});case"binary":return Rt.read(e,{type:"binary"});case"buffer":case"array":return Rt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Sh(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Nn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,qI=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,U5=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,VI=/<[^>]*>/g,Li=Nn.match(U5)?U5:VI,GI=/<\w*:/,XI=/<(\/?)\w+:/;function Gt(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var l=e.match(qI),o=0,a="",c=0,f="",h="",d=1;if(l)for(c=0;c!=l.length;++c){for(h=l[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(f=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(d=(i=h.charCodeAt(s+1))==34||i==39?1:0,a=h.slice(s+1+d,h.length-d),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=a,n[f.toLowerCase()]=a;else{var u=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[u]&&f.slice(o-3,o)=="ext")continue;n[u]=a,n[u.toLowerCase()]=a}}return n}function eo(e){return e.replace(XI,"<$1")}var NC={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},cy=om(NC),gr=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(o,a){return NC[o]||String.fromCharCode(parseInt(a,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,a){return String.fromCharCode(parseInt(a,16))});var l=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,l)+r(i.slice(l+3))}}(),uy=/[&<>'"]/g,YI=/[\u0000-\u0008\u000b-\u001f]/g;function Tr(e){var t=e+"";return t.replace(uy,function(r){return cy[r]}).replace(YI,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function z5(e){return Tr(e).replace(/ /g,"_x0020_")}var AC=/[\u0000-\u001f]/g;function fy(e){var t=e+"";return t.replace(uy,function(r){return cy[r]}).replace(/\n/g,"<br/>").replace(AC,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function KI(e){var t=e+"";return t.replace(uy,function(r){return cy[r]}).replace(AC,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var W5=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function JI(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function zr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Z1(e){for(var t="",r=0,n=0,i=0,s=0,l=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=i&63,t+=String.fromCharCode(l);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}l=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function H5(e){var t=Il(2*e.length),r,n,i=1,s=0,l=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[s++]=l&255,t[s++]=l>>>8,l=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function $5(e){return zo(e,"binary").toString("utf8")}var fp="foo bar baz",Or=ar&&($5(fp)==Z1(fp)&&$5||H5(fp)==Z1(fp)&&H5)||Z1,Va=ar?function(e){return zo(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Td=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),OC=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),QI=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),ZI=/<\/?(?:vt:)?variant>/g,e7=/<(?:vt:)([^>]*)>([\s\S]*)</;function q5(e,t){var r=Gt(e),n=e.match(QI(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var l=s.replace(ZI,"").match(e7);l&&i.push({v:Or(l[2]),t:l[1]})}),i}var jC=/(^\s|\s$|\n)/;function gi(e,t){return"<"+e+(t.match(jC)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Nd(e){return pn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function xt(e,t,r){return"<"+e+(r!=null?Nd(r):"")+(t!=null?(t.match(jC)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Fv(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function t7(e,t){switch(typeof e){case"string":var r=xt("vt:lpwstr",Tr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return xt((e|0)==e?"vt:i4":"vt:r8",Tr(String(e)));case"boolean":return xt("vt:bool",e?"true":"false")}if(e instanceof Date)return xt("vt:filetime",Fv(e));throw new Error("Unable to serialize "+e)}function hy(e){if(ar&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Or(Hl(iy(e)));throw new Error("Bad input format: expected Buffer or string")}var Ad=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Xn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Gc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],vs={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function r7(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function n7(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,l=n?-t:t;isFinite(l)?l==0?i=s=0:(i=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var V5=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},G5=ar?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:zo(t)})):V5(e)}:V5,X5=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Eo(e,i)));return n.join("").replace(qi,"")},dy=ar?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(qi,""):X5(e,t,r)}:X5,Y5=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},PC=ar?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Y5(e,t,r)}:Y5,K5=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Ou(e,i)));return n.join("")},Xd=ar?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):K5(t,r,n)}:K5,FC=function(e,t){var r=ys(e,t);return r>0?Xd(e,t+4,t+4+r-1):""},DC=FC,LC=function(e,t){var r=ys(e,t);return r>0?Xd(e,t+4,t+4+r-1):""},IC=LC,MC=function(e,t){var r=2*ys(e,t);return r>0?Xd(e,t+4,t+4+r-1):""},RC=MC,BC=function(t,r){var n=ys(t,r);return n>0?dy(t,r+4,r+4+n):""},UC=BC,zC=function(e,t){var r=ys(e,t);return r>0?Xd(e,t+4,t+4+r):""},WC=zC,HC=function(e,t){return r7(e,t)},Tg=HC,py=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ar&&(DC=function(t,r){if(!Buffer.isBuffer(t))return FC(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},IC=function(t,r){if(!Buffer.isBuffer(t))return LC(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},RC=function(t,r){if(!Buffer.isBuffer(t))return MC(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},UC=function(t,r){if(!Buffer.isBuffer(t))return BC(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},WC=function(t,r){if(!Buffer.isBuffer(t))return zC(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Tg=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):HC(t,r)},py=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ou=function(e,t){return e[t]},Eo=function(e,t){return e[t+1]*256+e[t]},i7=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ys=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},mc=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},s7=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Rh(e,t){var r="",n,i,s=[],l,o,a,c;switch(t){case"dbcs":if(c=this.l,ar&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(a=0;a<e;++a)r+=String.fromCharCode(Eo(this,c)),c+=2;e*=2;break;case"utf8":r=Xd(this,this.l,this.l+e);break;case"utf16le":e*=2,r=dy(this,this.l,this.l+e);break;case"wstr":return Rh.call(this,e,"dbcs");case"lpstr-ansi":r=DC(this,this.l),e=4+ys(this,this.l);break;case"lpstr-cp":r=IC(this,this.l),e=4+ys(this,this.l);break;case"lpwstr":r=RC(this,this.l),e=4+2*ys(this,this.l);break;case"lpp4":e=4+ys(this,this.l),r=UC(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ys(this,this.l),r=WC(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=Ou(this,this.l+e++))!==0;)s.push(up(l));r=s.join("");break;case"_wstr":for(e=0,r="";(l=Eo(this,this.l+e))!==0;)s.push(up(l)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,a=0;a<e;++a){if(this.lens&&this.lens.indexOf(c)!==-1)return l=Ou(this,c),this.l=c+1,o=Rh.call(this,e-a,l?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(up(Eo(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,a=0;a!=e;++a){if(this.lens&&this.lens.indexOf(c)!==-1)return l=Ou(this,c),this.l=c+1,o=Rh.call(this,e-a,l?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(up(Ou(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=Ou(this,this.l),this.l++,n;case 2:return n=(t==="i"?i7:Eo)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?mc:s7)(this,this.l),this.l+=4,n):(i=ys(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Tg(this,this.l):i=Tg([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=PC(this,this.l,e);break}}return this.l+=e,r}var a7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},o7=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},l7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function c7(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)l7(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var l=t.charCodeAt(i);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,a7(this,t,this.l);break;case 8:if(n=8,r==="f"){n7(this,t,this.l);break}case 16:break;case-4:n=4,o7(this,t,this.l);break}return this.l+=n,this}function $C(e,t){var r=PC(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function pi(e,t){e.l=t,e.read_shift=Rh,e.chk=$C,e.write_shift=c7}function Di(e,t){e.l+=t}function Ze(e){var t=Il(e);return pi(t,0),t}function Wo(e,t,r){if(e){var n,i,s;pi(e,e.l||0);for(var l=e.length,o=0,a=0;e.l<l;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=Ld[o]||Ld[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;a=e.l+s;var f=c.f&&c.f(e,s,r);if(e.l=a,t(f,c,o))return}}}function is(){var e=[],t=ar?256:2048,r=function(c){var f=Ze(c);return pi(f,0),f},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},l=function(){return i(),ti(e)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:l,_bufs:e}}function lt(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=Ld[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var l=e.next(s);i<=127?l.write_shift(1,i):(l.write_shift(1,(i&127)+128),l.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&py(r)&&e.push(r)}}function Bh(e,t,r){var n=Vr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function J5(e,t,r){var n=Vr(e);return n.s=Bh(n.s,t.s,r),n.e=Bh(n.e,t.s,r),n}function Uh(e,t){if(e.cRel&&e.c<0)for(e=Vr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Vr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=$t(e);return!e.cRel&&e.cRel!=null&&(r=h7(r)),!e.rRel&&e.rRel!=null&&(r=u7(r)),r}function ex(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+en(e.s.c)+":"+(e.e.cRel?"":"$")+en(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Tn(e.s.r)+":"+(e.e.rRel?"":"$")+Tn(e.e.r):Uh(e.s,t.biff)+":"+Uh(e.e,t.biff)}function gy(e){return parseInt(f7(e),10)-1}function Tn(e){return""+(e+1)}function u7(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function f7(e){return e.replace(/\$(\d+)$/,"$1")}function my(e){for(var t=d7(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function en(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function h7(e){return e.replace(/^([A-Z])/,"$$$1")}function d7(e){return e.replace(/^\$([A-Z])/,"$1")}function p7(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function tn(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function $t(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ss(e){var t=e.indexOf(":");return t==-1?{s:tn(e),e:tn(e)}:{s:tn(e.slice(0,t)),e:tn(e.slice(t+1))}}function tr(e,t){return typeof t>"u"||typeof t=="number"?tr(e.s,e.e):(typeof e!="string"&&(e=$t(e)),typeof t!="string"&&(t=$t(t)),e==t?e:e+":"+t)}function mr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function Q5(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Zs(e.z,r?Kn(t):t)}catch{}try{return e.w=Zs((e.XF||{}).numFmtId||(r?14:0),r?Kn(t):t)}catch{return""+t}}function Ro(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ho[e.v]||e.v:t==null?Q5(e,e.v):Q5(e,t))}function $l(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function qC(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),l=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var a=typeof n.origin=="string"?tn(n.origin):n.origin;l=a.r,o=a.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=mr(s["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),l==-1&&(c.e.r=l=f.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[h].length;++d)if(!(typeof t[h][d]>"u")){var u={v:t[h][d]},p=l+h,m=o+d;if(c.s.r>p&&(c.s.r=p),c.s.c>m&&(c.s.c=m),c.e.r<p&&(c.e.r=p),c.e.c<m&&(c.e.c=m),t[h][d]&&typeof t[h][d]=="object"&&!Array.isArray(t[h][d])&&!(t[h][d]instanceof Date))u=t[h][d];else if(Array.isArray(u.v)&&(u.f=t[h][d][1],u.v=u.v[0]),u.v===null)if(u.f)u.t="n";else if(n.nullError)u.t="e",u.v=0;else if(n.sheetStubs)u.t="z";else continue;else typeof u.v=="number"?u.t="n":typeof u.v=="boolean"?u.t="b":u.v instanceof Date?(u.z=n.dateNF||zt[14],n.cellDates?(u.t="d",u.w=Zs(u.z,Kn(u.v))):(u.t="n",u.v=Kn(u.v),u.w=Zs(u.z,u.v))):u.t="s";if(i)s[p]||(s[p]=[]),s[p][m]&&s[p][m].z&&(u.z=s[p][m].z),s[p][m]=u;else{var g=$t({c:m,r:p});s[g]&&s[g].z&&(u.z=s[g].z),s[g]=u}}}return c.s.c<1e7&&(s["!ref"]=tr(c)),s}function jf(e,t){return qC(null,e,t)}function g7(e){return e.read_shift(4,"i")}function ba(e,t){return t||(t=Ze(4)),t.write_shift(4,e),t}function Pi(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function ri(e,t){var r=!1;return t==null&&(r=!0,t=Ze(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function m7(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function x7(e,t){return t||(t=Ze(4)),t.write_shift(2,0),t.write_shift(2,0),t}function xy(e,t){var r=e.l,n=e.read_shift(1),i=Pi(e),s=[],l={t:i,h:i};if(n&1){for(var o=e.read_shift(4),a=0;a!=o;++a)s.push(m7(e));l.r=s}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function v7(e,t){var r=!1;return t==null&&(r=!0,t=Ze(15+4*e.t.length)),t.write_shift(1,0),ri(e.t,t),r?t.slice(0,t.l):t}var y7=xy;function w7(e,t){var r=!1;return t==null&&(r=!0,t=Ze(23+4*e.t.length)),t.write_shift(1,1),ri(e.t,t),t.write_shift(4,1),x7({},t),r?t.slice(0,t.l):t}function ea(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Xc(e,t){return t==null&&(t=Ze(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Yc(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Kc(e,t){return t==null&&(t=Ze(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var b7=Pi,VC=ri;function vy(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Ng(e,t){var r=!1;return t==null&&(r=!0,t=Ze(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var _7=Pi,Dv=vy,yy=Ng;function wy(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?Tg([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):mc(t,0)>>2;return r?i/100:i}function GC(e,t){t==null&&(t=Ze(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function XC(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function k7(e,t){return t||(t=Ze(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Jc=XC,Pf=k7;function ji(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Rc(e,t){return(t||Ze(8)).write_shift(8,e,"f")}function S7(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),a=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=Cc[i];c&&(t.rgb=jd(c));break;case 2:t.rgb=jd([l,o,a]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Ag(e,t){if(t||(t=Ze(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function C7(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function E7(e,t){t||(t=Ze(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function YC(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function T7(e){return YC(e,1)}function N7(e){return YC(e,2)}var by=2,Qi=3,hp=11,Z5=12,Og=19,dp=64,A7=65,O7=71,j7=4108,P7=4126,Qn=80,KC=81,F7=[Qn,KC],Lv={1:{n:"CodePage",t:by},2:{n:"Category",t:Qn},3:{n:"PresentationFormat",t:Qn},4:{n:"ByteCount",t:Qi},5:{n:"LineCount",t:Qi},6:{n:"ParagraphCount",t:Qi},7:{n:"SlideCount",t:Qi},8:{n:"NoteCount",t:Qi},9:{n:"HiddenCount",t:Qi},10:{n:"MultimediaClipCount",t:Qi},11:{n:"ScaleCrop",t:hp},12:{n:"HeadingPairs",t:j7},13:{n:"TitlesOfParts",t:P7},14:{n:"Manager",t:Qn},15:{n:"Company",t:Qn},16:{n:"LinksUpToDate",t:hp},17:{n:"CharacterCount",t:Qi},19:{n:"SharedDoc",t:hp},22:{n:"HyperlinksChanged",t:hp},23:{n:"AppVersion",t:Qi,p:"version"},24:{n:"DigSig",t:A7},26:{n:"ContentType",t:Qn},27:{n:"ContentStatus",t:Qn},28:{n:"Language",t:Qn},29:{n:"Version",t:Qn},255:{},2147483648:{n:"Locale",t:Og},2147483651:{n:"Behavior",t:Og},1919054434:{}},Iv={1:{n:"CodePage",t:by},2:{n:"Title",t:Qn},3:{n:"Subject",t:Qn},4:{n:"Author",t:Qn},5:{n:"Keywords",t:Qn},6:{n:"Comments",t:Qn},7:{n:"Template",t:Qn},8:{n:"LastAuthor",t:Qn},9:{n:"RevNumber",t:Qn},10:{n:"EditTime",t:dp},11:{n:"LastPrinted",t:dp},12:{n:"CreatedDate",t:dp},13:{n:"ModifiedDate",t:dp},14:{n:"PageCount",t:Qi},15:{n:"WordCount",t:Qi},16:{n:"CharCount",t:Qi},17:{n:"Thumbnail",t:O7},18:{n:"Application",t:Qn},19:{n:"DocSecurity",t:Qi},255:{},2147483648:{n:"Locale",t:Og},2147483651:{n:"Behavior",t:Og},1919054434:{}},ek={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},D7=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function L7(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var I7=L7([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Cc=Vr(I7),Ho={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},JC={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Mv={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},pp={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function _y(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function M7(e){var t=_y();if(!e||!e.match)return t;var r={};if((e.match(Li)||[]).forEach(function(n){var i=Gt(n);switch(i[0].replace(GI,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[Mv[i.ContentType]]!==void 0&&t[Mv[i.ContentType]].push(i.PartName);break}}),t.xmlns!==Xn.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function QC(e,t){var r=MI(Mv),n=[],i;n[n.length]=Nn,n[n.length]=xt("Types",null,{xmlns:Xn.CT,"xmlns:xsd":Xn.xsd,"xmlns:xsi":Xn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(a){return xt("Default",null,{Extension:a[0],ContentType:a[1]})}));var s=function(a){e[a]&&e[a].length>0&&(i=e[a][0],n[n.length]=xt("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:pp[a][t.bookType]||pp[a].xlsx}))},l=function(a){(e[a]||[]).forEach(function(c){n[n.length]=xt("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:pp[a][t.bookType]||pp[a].xlsx})})},o=function(a){(e[a]||[]).forEach(function(c){n[n.length]=xt("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[a][0]})})};return s("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var or={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Od(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function zh(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Li)||[]).forEach(function(i){var s=Gt(i);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Sh(s.Target,t);r[o]=l,n[s.Id]=l}}),r["!id"]=n,r}function sf(e){var t=[Nn,xt("Relationships",null,{xmlns:Xn.RELS})];return pn(e["!id"]).forEach(function(r){t[t.length]=xt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Sr(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[or.HLINK,or.XPATH,or.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var R7="application/vnd.oasis.opendocument.spreadsheet";function B7(e,t){for(var r=hy(e),n,i;n=Ad.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Gt(n[0],!1),i.path=="/"&&i.type!==R7)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function U7(e){var t=[Nn];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function tk(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function z7(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function W7(e){var t=[Nn];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(tk(e[r][0],e[r][1])),t.push(z7("",e[r][0]));return t.push(tk("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function ZC(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+_g.version+"</meta:generator></office:meta></office:document-meta>"}var Ys=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],H7=function(){for(var e=new Array(Ys.length),t=0;t<Ys.length;++t){var r=Ys[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function eE(e){var t={};e=Or(e);for(var r=0;r<Ys.length;++r){var n=Ys[r],i=e.match(H7[r]);i!=null&&i.length>0&&(t[n[1]]=gr(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=qr(t[n[1]]))}return t}function tx(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Tr(t),n[n.length]=r?xt(e,t,r):gi(e,t))}function tE(e,t){var r=t||{},n=[Nn,xt("cp:coreProperties",null,{"xmlns:cp":Xn.CORE_PROPS,"xmlns:dc":Xn.dc,"xmlns:dcterms":Xn.dcterms,"xmlns:dcmitype":Xn.dcmitype,"xmlns:xsi":Xn.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&tx("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Fv(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&tx("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Fv(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Ys.length;++s){var l=Ys[s],o=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&tx(l[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ec=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],rE=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function nE(e,t,r,n){var i=[];if(typeof e=="string")i=q5(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(f){return{v:f}}));var l=typeof t=="string"?q5(t,n).map(function(f){return f.v}):t,o=0,a=0;if(l.length>0)for(var c=0;c!==i.length;c+=2){switch(a=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=a,r.SheetNames=l.slice(o,o+a);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=a,r.DefinedNames=l.slice(o,o+a);break;case"Charts":case"Diagramme":r.Chartsheets=a,r.ChartNames=l.slice(o,o+a);break}o+=a}}function $7(e,t,r){var n={};return t||(t={}),e=Or(e),Ec.forEach(function(i){var s=(e.match(Td(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=gr(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var l=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));l&&l.length>0&&(n[i[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&nE(n.HeadingPairs,n.TitlesOfParts,t,r),t}function iE(e){var t=[],r=xt;return e||(e={}),e.Application="SheetJS",t[t.length]=Nn,t[t.length]=xt("Properties",null,{xmlns:Xn.EXT_PROPS,"xmlns:vt":Xn.vt}),Ec.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Tr(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Tr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var q7=/<[^>]+>[^<]*/g;function V7(e,t){var r={},n="",i=e.match(q7);if(i)for(var s=0;s!=i.length;++s){var l=i[s],o=Gt(l);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=gr(o.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var a=l.split(">"),c=a[0].slice(4),f=a[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=gr(f);break;case"bool":r[n]=zr(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=qr(f);break;case"cy":case"error":r[n]=gr(f);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,c,a)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function sE(e){var t=[Nn,xt("Properties",null,{xmlns:Xn.CUST_PROPS,"xmlns:vt":Xn.vt})];if(!e)return t.join("");var r=1;return pn(e).forEach(function(i){++r,t[t.length]=xt("property",t7(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Tr(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Rv={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},rx;function G7(e,t,r){rx||(rx=om(Rv)),t=rx[t]||t,e[t]=r}function X7(e,t){var r=[];return pn(Rv).map(function(n){for(var i=0;i<Ys.length;++i)if(Ys[i][1]==n)return Ys[i];for(i=0;i<Ec.length;++i)if(Ec[i][1]==n)return Ec[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(gi(Rv[n[1]]||n[1],i))}}),xt("DocumentProperties",r.join(""),{xmlns:vs.o})}function Y7(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&pn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var l=0;l<Ys.length;++l)if(s==Ys[l][1])return;for(l=0;l<Ec.length;++l)if(s==Ec[l][1])return;for(l=0;l<r.length;++l)if(s==r[l])return;var o=e[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o=String(o),i.push(xt(z5(s),o,{"dt:dt":a}))}}),t&&pn(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var l=t[s],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),i.push(xt(z5(s),l,{"dt:dt":o}))}}),"<"+n+' xmlns="'+vs.o+'">'+i.join("")+"</"+n+">"}function ky(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function K7(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var l=Ze(8);return l.write_shift(4,n),l.write_shift(4,i),l}function aE(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function oE(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function lE(e,t,r){return t===31?oE(e):aE(e,t,r)}function Bv(e,t,r){return lE(e,t,r===!1?0:4)}function J7(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return lE(e,t,0)}function Q7(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(qi,""),e.l-i&2&&(e.l+=2)}return r}function Z7(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(qi,"");return r}function eM(e){var t=e.l,r=jg(e,KC);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=jg(e,Qi);return[r,n]}function tM(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(eM(e));return r}function rk(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),l=e.read_shift(4);n[s]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(qi,"").replace(kh,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function cE(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function rM(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function jg(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==Z5&&n!==t&&F7.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Z5?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return aE(e,n,4).replace(qi,"");case 31:return oE(e);case 64:return ky(e);case 65:return cE(e);case 71:return rM(e);case 80:return Bv(e,n,!s.raw).replace(qi,"");case 81:return J7(e,n).replace(qi,"");case 4108:return tM(e);case 4126:case 4127:return n==4127?Q7(e):Z7(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function nk(e,t){var r=Ze(4),n=Ze(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Ze(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=K7(t);break;case 31:case 80:for(n=Ze(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return ti([r,n])}function ik(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],l=0,o=0,a=-1,c={};for(l=0;l!=i;++l){var f=e.read_shift(4),h=e.read_shift(4);s[l]=[f,h+r]}s.sort(function(y,w){return y[1]-w[1]});var d={};for(l=0;l!=i;++l){if(e.l!==s[l][1]){var u=!0;if(l>0&&t)switch(t[s[l-1][0]].t){case 2:e.l+2===s[l][1]&&(e.l+=2,u=!1);break;case 80:e.l<=s[l][1]&&(e.l=s[l][1],u=!1);break;case 4108:e.l<=s[l][1]&&(e.l=s[l][1],u=!1);break}if((!t||l==0)&&e.l<=s[l][1]&&(u=!1,e.l=s[l][1]),u)throw new Error("Read Error: Expected address "+s[l][1]+" at "+e.l+" :"+l)}if(t){var p=t[s[l][0]];if(d[p.n]=jg(e,p.t,{raw:!0}),p.p==="version"&&(d[p.n]=String(d[p.n]>>16)+"."+("0000"+String(d[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(d[p.n]){case 0:d[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ma(o=d[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[p.n])}}else if(s[l][0]===1){if(o=d.CodePage=jg(e,by),ma(o),a!==-1){var m=e.l;e.l=s[a][1],c=rk(e,o),e.l=m}}else if(s[l][0]===0){if(o===0){a=l,e.l=s[l+1][1];continue}c=rk(e,o)}else{var g=c[s[l][0]],x;switch(e[e.l]){case 65:e.l+=4,x=cE(e);break;case 30:e.l+=4,x=Bv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,x=Bv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,x=e.read_shift(4,"i");break;case 19:e.l+=4,x=e.read_shift(4);break;case 5:e.l+=4,x=e.read_shift(8,"f");break;case 11:e.l+=4,x=wn(e,4);break;case 64:e.l+=4,x=qr(ky(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[g]=x}}return e.l=r+n,d}var uE=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function nM(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function sk(e,t,r){var n=Ze(8),i=[],s=[],l=8,o=0,a=Ze(8),c=Ze(8);if(a.write_shift(4,2),a.write_shift(4,1200),c.write_shift(4,1),s.push(a),i.push(c),l+=8+a.length,!t){c=Ze(8),c.write_shift(4,0),i.unshift(c);var f=[Ze(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(a=Ze(8+2*(h.length+1)+(h.length%2?0:2)),a.write_shift(4,o+2),a.write_shift(4,h.length+1),a.write_shift(0,h,"dbcs");a.l!=a.length;)a.write_shift(1,0);f.push(a)}a=ti(f),s.unshift(a),l+=8+a.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(uE.indexOf(e[o][0])>-1||rE.indexOf(e[o][0])>-1)&&e[o][1]!=null){var d=e[o][1],u=0;if(t){u=+t[e[o][0]];var p=r[u];if(p.p=="version"&&typeof d=="string"){var m=d.split(".");d=(+m[0]<<16)+(+m[1]||0)}a=nk(p.t,d)}else{var g=nM(d);g==-1&&(g=31,d=String(d)),a=nk(g,d)}s.push(a),c=Ze(8),c.write_shift(4,t?u:2+o),i.push(c),l+=8+a.length}var x=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,x),x+=s[o].length;return n.write_shift(4,l),n.write_shift(4,s.length),ti([n].concat(i).concat(s))}function ak(e,t,r){var n=e.content;if(!n)return{};pi(n,0);var i,s,l,o,a=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),f=n.read_shift(16);if(f!==Rt.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(l=n.read_shift(16),a=n.read_shift(4));var h=ik(n,t),d={SystemIdentifier:c};for(var u in h)d[u]=h[u];if(d.FMTID=s,i===1)return d;if(a-n.l==2&&(n.l+=2),n.l!==a)throw new Error("Length mismatch 2: "+n.l+" !== "+a);var p;try{p=ik(n,null)}catch{}for(u in p)d[u]=p[u];return d.FMTID=[s,l],d}function ok(e,t,r,n,i,s){var l=Ze(i?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Rt.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,i?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,i?68:48);var a=sk(e,r,n);if(o.push(a),i){var c=sk(i,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+a.length),o.push(c)}return ti(o)}function cl(e,t){return e.read_shift(t),null}function iM(e,t){t||(t=Ze(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function sM(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function wn(e,t){return e.read_shift(t)===1}function Hi(e,t){return t||(t=Ze(2)),t.write_shift(2,+!!e),t}function In(e){return e.read_shift(2,"u")}function $s(e,t){return t||(t=Ze(2)),t.write_shift(2,e),t}function fE(e,t){return sM(e,t,In)}function aM(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function hE(e,t,r){return r||(r=Ze(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Yd(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var l=n?e.read_shift(n,i):"";return l}function oM(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),l=0,o,a={};i&&(l=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,c);return i&&(e.l+=4*l),n&&(e.l+=o),a.t=f,i||(a.raw="<t>"+a.t+"</t>",a.r=a.t),a}function lM(e){var t=e.t||"",r=Ze(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Ze(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return ti(i)}function Bc(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Kd(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Bc(e,n,r)}function Qc(e,t,r){if(r.biff>5)return Kd(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function dE(e,t,r){return r||(r=Ze(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function cM(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function uM(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(qi,"");return n&&(e.l+=24),i}function fM(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(s>>1,"utf16le").replace(qi,"");return r+l}function hM(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return uM(e);case"0303000000000000c000000000000046":return fM(e);default:throw new Error("Unsupported Moniker "+r)}}function gp(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(qi,""):"";return r}function lk(e,t){t||(t=Ze(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function dM(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,l,o,a,c="",f,h;i&16&&(s=gp(e,r-e.l)),i&128&&(l=gp(e,r-e.l)),(i&257)===257&&(o=gp(e,r-e.l)),(i&257)===1&&(a=hM(e,r-e.l)),i&8&&(c=gp(e,r-e.l)),i&32&&(f=e.read_shift(16)),i&64&&(h=ky(e)),e.l=r;var d=l||o||a||"";d&&c&&(d+="#"+c),d||(d="#"+c),i&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var u={Target:d};return f&&(u.guid=f),h&&(u.time=h),s&&(u.Tooltip=s),u}function pM(e){var t=Ze(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(s==28)n=n.slice(1),lk(n,t);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&lk(i>-1?n.slice(i+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var a=0;n.slice(a*3,a*3+3)=="../"||n.slice(a*3,a*3+3)=="..\\";)++a;for(t.write_shift(2,a),t.write_shift(4,n.length-3*a+1),r=0;r<n.length-3*a;++r)t.write_shift(1,n.charCodeAt(r+3*a)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function pE(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function gE(e,t){var r=pE(e);return r[3]=0,r}function to(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Uc(e,t,r,n){return n||(n=Ze(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function gM(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function mM(e,t,r){return t===0?"":Qc(e,t,r)}function xM(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[i,s,l]}function mE(e){var t=e.read_shift(2),r=wy(e);return[t,r]}function vM(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=Yd(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function um(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function xE(e,t){return t||(t=Ze(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function vE(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var yM=vE;function yE(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function wM(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function bM(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ei(e){e.l+=2,e.l+=e.read_shift(2)}var _M={0:Ei,4:Ei,5:Ei,6:Ei,7:bM,8:Ei,9:Ei,10:Ei,11:Ei,12:Ei,13:wM,14:Ei,15:Ei,16:Ei,17:Ei,18:Ei,19:Ei,20:Ei,21:yE};function kM(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(_M[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function mp(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Sy(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Ze(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function SM(e,t){return t===0||e.read_shift(2),1200}function CM(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=Qc(e,0,r);return e.read_shift(t+n-e.l),i}function EM(e,t){var r=!t||t.biff==8,n=Ze(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function TM(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function NM(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=Yd(e,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:i,dt:s,name:l}}function AM(e,t){var r=!t||t.biff>=8?2:1,n=Ze(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function OM(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],l=0;l!=i&&e.l<r;++l)s.push(oM(e));return s.Count=n,s.Unique=i,s}function jM(e,t){var r=Ze(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=lM(e[i]);var s=ti([r].concat(n));return s.parts=[r.length].concat(n.map(function(l){return l.length})),s}function PM(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function FM(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function DM(e){var t=gM(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function LM(e){return e.read_shift(2),e.read_shift(4)}function ck(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function IM(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),a=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:l,FirstTab:o,Selected:a,TabRatio:c}}function MM(){var e=Ze(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function RM(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function BM(e){var t=Ze(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function UM(){}function zM(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Yd(e,0,r),n}function WM(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=Ze(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function HM(e){var t=to(e);return t.isst=e.read_shift(4),t}function $M(e,t,r,n){var i=Ze(10);return Uc(e,t,n,i),i.write_shift(4,r),i}function qM(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=to(e);r.biff==2&&e.l++;var s=Kd(e,n-e.l,r);return i.val=s,i}function VM(e,t,r,n,i){var s=!i||i.biff==8,l=Ze(8+ +s+(1+s)*r.length);return Uc(e,t,n,l),l.write_shift(2,r.length),s&&l.write_shift(1,1),l.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),l}function GM(e,t,r){var n=e.read_shift(2),i=Qc(e,0,r);return[n,i]}function XM(e,t,r,n){var i=r&&r.biff==5;n||(n=Ze(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var YM=Qc;function uk(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),l=e.read_shift(i),o=e.read_shift(2),a=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:l,c:a}}}function KM(e,t){var r=t.biff==8||!t.biff?4:2,n=Ze(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function JM(e){var t=e.read_shift(2),r=e.read_shift(2),n=mE(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function QM(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(mE(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(s.length!=l-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:l,rkrec:s}}function ZM(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(s.length!=l-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:l,ixfe:s}}function eR(e,t,r,n){var i={},s=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(4),a=e.read_shift(2);return i.patternType=D7[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=l&15,i.dgRight=l>>4&15,i.dgTop=l>>8&15,i.dgBottom=l>>12&15,i.icvLeft=l>>16&127,i.icvRight=l>>23&127,i.grbitDiag=l>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=a&127,i.icvBack=a>>7&127,i.fsxButton=a>>14&1),i}function tR(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=eR(e,t,n.fStyle,r),n}function fk(e,t,r,n){var i=r&&r.biff==5;n||(n=Ze(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function rR(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function nR(e){var t=Ze(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function hk(e,t,r){var n=to(e);(r.biff==2||t==9)&&++e.l;var i=aM(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function iR(e,t,r,n,i,s){var l=Ze(8);return Uc(e,t,n,l),hE(r,s,l),l}function sR(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=to(e),i=ji(e);return n.val=i,n}function aR(e,t,r,n){var i=Ze(14);return Uc(e,t,n,i),Rc(r,i),i}var dk=mM;function oR(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=Bc(e,s),o=[];n>e.l;)o.push(Kd(e));return[s,i,l,o]}function pk(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=vM(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var lR=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function gk(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),a=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),a=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=Bc(e,l,r);i&32&&(c=lR[c.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var h=n==e.l||o===0||!(f>0)?[]:kz(e,f,r,o);return{chKey:s,Name:c,itab:a,rgce:h}}function wE(e,t,r){if(r.biff<8)return cR(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(xM(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function cR(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Yd(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function uR(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=Bc(e,n,r),l=Bc(e,i,r);return[s,l]}function fR(e,t,r){var n=vE(e);e.l++;var i=e.read_shift(1);return t-=8,[Sz(e,t,r),i,n]}function mk(e,t,r){var n=yM(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,bz(e,t,r)]}function hR(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function dR(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=Qc(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},o,l,s]}}function pR(e,t,r){return dR(e,t,r)}function gR(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(um(e));return r}function mR(e){var t=Ze(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)xE(e[r],t);return t}function xR(e,t,r){if(r&&r.biff<8)return yR(e,t,r);var n=yE(e),i=kM(e,t-22,n[1]);return{cmo:n,ft:i}}var vR={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function yR(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((vR[n]||Di)(e,t,r)),{cmo:[i,n,s],ft:l}}function wR(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:l=cM(e,6,r);var o=e.read_shift(2);e.read_shift(2),In(e,2);var a=e.read_shift(2);e.l+=a;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var f=e[e.l],h=Bc(e,e.lens[c+1]-e.lens[c]-1);if(i+=h,i.length>=(f?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function bR(e,t){var r=um(e);e.l+=16;var n=dM(e,t-24);return[r,n]}function _R(e){var t=Ze(24),r=tn(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return ti([t,pM(e[1])])}function kR(e,t){e.read_shift(2);var r=um(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(qi,""),[r,n]}function SR(e){var t=e[1].Tooltip,r=Ze(10+2*(t.length+1));r.write_shift(2,2048);var n=tn(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function CR(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=ek[r]||r,r=e.read_shift(2),t[1]=ek[r]||r,t}function ER(e){return e||(e=Ze(4)),e.write_shift(2,1),e.write_shift(2,1),e}function TR(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(gE(e));return r}function NR(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(gE(e));return r}function AR(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function bE(e,t,r){if(!r.cellStyles)return Di(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(n),a=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:s,w:l,ixfe:o,flags:a};return(r.biff>=5||!r.biff)&&(c.level=a>>8&7),c}function OR(e,t){var r=Ze(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function jR(e,t){var r={};return t<32||(e.l+=16,r.header=ji(e),r.footer=ji(e),e.l+=2),r}function PR(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}function FR(e){for(var t=Ze(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var DR=to,LR=fE,IR=Kd;function MR(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function RR(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=to(e);++e.l;var i=Qc(e,t-7,r);return n.t="str",n.val=i,n}function BR(e){var t=to(e);++e.l;var r=ji(e);return t.t="n",t.val=r,t}function UR(e,t,r){var n=Ze(15);return e0(n,e,t),n.write_shift(8,r,"f"),n}function zR(e){var t=to(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function WR(e,t,r){var n=Ze(9);return e0(n,e,t),n.write_shift(2,r),n}function HR(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function $R(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function qR(e,t,r){var n=e.l+t,i=to(e),s=e.read_shift(2),l=Bc(e,s,r);return e.l=n,i.t="str",i.val=l,i}var VR=[2,3,48,49,131,139,140,245],Uv=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=om({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,a){var c=[],f=Il(1);switch(a.type){case"base64":f=ws(Os(o));break;case"binary":f=ws(o);break;case"buffer":case"array":f=o;break}pi(f,0);var h=f.read_shift(1),d=!!(h&136),u=!1,p=!1;switch(h){case 2:break;case 3:break;case 48:u=!0,d=!0;break;case 49:u=!0,d=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,g=521;h==2&&(m=f.read_shift(2)),f.l+=3,h!=2&&(m=f.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(g=f.read_shift(2));var x=f.read_shift(2),y=a.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(y=e[f[f.l]]),f.l+=1,f.l+=2),p&&(f.l+=36);for(var w=[],b={},S=Math.min(f.length,h==2?521:g-10-(u?264:0)),T=p?32:11;f.l<S&&f[f.l]!=13;)switch(b={},b.name=Sd.utils.decode(y,f.slice(f.l,f.l+T)).replace(/[\u0000\r\n].*$/g,""),f.l+=T,b.type=String.fromCharCode(f.read_shift(1)),h!=2&&!p&&(b.offset=f.read_shift(4)),b.len=f.read_shift(1),h==2&&(b.offset=f.read_shift(2)),b.dec=f.read_shift(1),b.name.length&&w.push(b),h!=2&&(f.l+=p?13:14),b.type){case"B":(!u||b.len!=8)&&a.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":a.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(f[f.l]!==13&&(f.l=g-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=g;var O=0,j=0;for(c[0]=[],j=0;j!=w.length;++j)c[0][j]=w[j].name;for(;m-- >0;){if(f[f.l]===42){f.l+=x;continue}for(++f.l,c[++O]=[],j=0,j=0;j!=w.length;++j){var L=f.slice(f.l,f.l+w[j].len);f.l+=w[j].len,pi(L,0);var W=Sd.utils.decode(y,L);switch(w[j].type){case"C":W.trim().length&&(c[O][j]=W.replace(/\s+$/,""));break;case"D":W.length===8?c[O][j]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):c[O][j]=W;break;case"F":c[O][j]=parseFloat(W.trim());break;case"+":case"I":c[O][j]=p?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":c[O][j]=!0;break;case"N":case"F":c[O][j]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[O][j]="##MEMO##"+(p?parseInt(W.trim(),10):L.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(c[O][j]=+W||0);break;case"@":c[O][j]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":c[O][j]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":c[O][j]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[O][j]=-L.read_shift(-8,"f");break;case"B":if(u&&w[j].len==8){c[O][j]=L.read_shift(8,"f");break}case"G":case"P":L.l+=w[j].len;break;case"0":if(w[j].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[j].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return a&&a.sheetRows&&(c=c.slice(0,a.sheetRows)),a.DBF=w,c}function n(o,a){var c=a||{};c.dateNF||(c.dateNF="yyyymmdd");var f=jf(r(o,c),c);return f["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,f}function i(o,a){try{return $l(n(o,a),a)}catch(c){if(a&&a.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,a){var c=a||{};if(+c.codepage>=0&&ma(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=is(),h=Dg(o,{header:1,raw:!0,cellDates:!0}),d=h[0],u=h.slice(1),p=o["!cols"]||[],m=0,g=0,x=0,y=1;for(m=0;m<d.length;++m){if(((p[m]||{}).DBF||{}).name){d[m]=p[m].DBF.name,++x;continue}if(d[m]!=null){if(++x,typeof d[m]=="number"&&(d[m]=d[m].toString(10)),typeof d[m]!="string")throw new Error("DBF Invalid column name "+d[m]+" |"+typeof d[m]+"|");if(d.indexOf(d[m])!==m){for(g=0;g<1024;++g)if(d.indexOf(d[m]+"_"+g)==-1){d[m]+="_"+g;break}}}}var w=mr(o["!ref"]),b=[],S=[],T=[];for(m=0;m<=w.e.c-w.s.c;++m){var O="",j="",L=0,W=[];for(g=0;g<u.length;++g)u[g][m]!=null&&W.push(u[g][m]);if(W.length==0||d[m]==null){b[m]="?";continue}for(g=0;g<W.length;++g){switch(typeof W[g]){case"number":j="B";break;case"string":j="C";break;case"boolean":j="L";break;case"object":j=W[g]instanceof Date?"D":"C";break;default:j="C"}L=Math.max(L,String(W[g]).length),O=O&&O!=j?"C":j}L>250&&(L=250),j=((p[m]||{}).DBF||{}).type,j=="C"&&p[m].DBF.len>L&&(L=p[m].DBF.len),O=="B"&&j=="N"&&(O="N",T[m]=p[m].DBF.dec,L=p[m].DBF.len),S[m]=O=="C"||j=="N"?L:s[O]||0,y+=S[m],b[m]=O}var F=f.next(32);for(F.write_shift(4,318902576),F.write_shift(4,u.length),F.write_shift(2,296+32*x),F.write_shift(2,y),m=0;m<4;++m)F.write_shift(4,0);for(F.write_shift(4,0|(+t[uC]||3)<<8),m=0,g=0;m<d.length;++m)if(d[m]!=null){var M=f.next(32),V=(d[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,V,"sbcs"),M.write_shift(1,b[m]=="?"?"C":b[m],"sbcs"),M.write_shift(4,g),M.write_shift(1,S[m]||s[b[m]]||0),M.write_shift(1,T[m]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),g+=S[m]||s[b[m]]||0}var G=f.next(264);for(G.write_shift(4,13),m=0;m<65;++m)G.write_shift(4,0);for(m=0;m<u.length;++m){var te=f.next(y);for(te.write_shift(1,0),g=0;g<d.length;++g)if(d[g]!=null)switch(b[g]){case"L":te.write_shift(1,u[m][g]==null?63:u[m][g]?84:70);break;case"B":te.write_shift(8,u[m][g]||0,"f");break;case"N":var ee="0";for(typeof u[m][g]=="number"&&(ee=u[m][g].toFixed(T[g]||0)),x=0;x<S[g]-ee.length;++x)te.write_shift(1,32);te.write_shift(1,ee,"sbcs");break;case"D":u[m][g]?(te.write_shift(4,("0000"+u[m][g].getFullYear()).slice(-4),"sbcs"),te.write_shift(2,("00"+(u[m][g].getMonth()+1)).slice(-2),"sbcs"),te.write_shift(2,("00"+u[m][g].getDate()).slice(-2),"sbcs")):te.write_shift(8,"00000000","sbcs");break;case"C":var Q=String(u[m][g]!=null?u[m][g]:"").slice(0,S[g]);for(te.write_shift(1,Q,"sbcs"),x=0;x<S[g]-Q.length;++x)te.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:l}}(),_E=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+pn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,u){var p=e[u];return typeof p=="number"?T5(p):p},n=function(d,u,p){var m=u.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return m==59?d:T5(m)};e["|"]=254;function i(d,u){switch(u.type){case"base64":return s(Os(d),u);case"binary":return s(d,u);case"buffer":return s(ar&&Buffer.isBuffer(d)?d.toString("binary"):Hl(d),u);case"array":return s(Mc(d),u)}throw new Error("Unrecognized type "+u.type)}function s(d,u){var p=d.split(/[\n\r]+/),m=-1,g=-1,x=0,y=0,w=[],b=[],S=null,T={},O=[],j=[],L=[],W=0,F;for(+u.codepage>=0&&ma(+u.codepage);x!==p.length;++x){W=0;var M=p[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),V=M.replace(/;;/g,"\0").split(";").map(function(E){return E.replace(/\u0000/g,";")}),G=V[0],te;if(M.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":V[1].charAt(0)=="P"&&b.push(M.slice(3).replace(/;;/g,";"));break;case"C":var ee=!1,Q=!1,K=!1,N=!1,U=-1,R=-1;for(y=1;y<V.length;++y)switch(V[y].charAt(0)){case"A":break;case"X":g=parseInt(V[y].slice(1))-1,Q=!0;break;case"Y":for(m=parseInt(V[y].slice(1))-1,Q||(g=0),F=w.length;F<=m;++F)w[F]=[];break;case"K":te=V[y].slice(1),te.charAt(0)==='"'?te=te.slice(1,te.length-1):te==="TRUE"?te=!0:te==="FALSE"?te=!1:isNaN(wa(te))?isNaN(yf(te).getDate())||(te=qr(te)):(te=wa(te),S!==null&&Af(S)&&(te=cm(te))),ee=!0;break;case"E":N=!0;var k=af(V[y].slice(1),{r:m,c:g});w[m][g]=[w[m][g],k];break;case"S":K=!0,w[m][g]=[w[m][g],"S5S"];break;case"G":break;case"R":U=parseInt(V[y].slice(1))-1;break;case"C":R=parseInt(V[y].slice(1))-1;break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+M)}if(ee&&(w[m][g]&&w[m][g].length==2?w[m][g][0]=te:w[m][g]=te,S=null),K){if(N)throw new Error("SYLK shared formula cannot have own formula");var P=U>-1&&w[U][R];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");w[m][g][1]=UE(P[1],{r:m-U,c:g-R})}break;case"F":var A=0;for(y=1;y<V.length;++y)switch(V[y].charAt(0)){case"X":g=parseInt(V[y].slice(1))-1,++A;break;case"Y":for(m=parseInt(V[y].slice(1))-1,F=w.length;F<=m;++F)w[F]=[];break;case"M":W=parseInt(V[y].slice(1))/20;break;case"F":break;case"G":break;case"P":S=b[parseInt(V[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=V[y].slice(1).split(" "),F=parseInt(L[0],10);F<=parseInt(L[1],10);++F)W=parseInt(L[2],10),j[F-1]=W===0?{hidden:!0}:{wch:W},Ml(j[F-1]);break;case"C":g=parseInt(V[y].slice(1))-1,j[g]||(j[g]={});break;case"R":m=parseInt(V[y].slice(1))-1,O[m]||(O[m]={}),W>0?(O[m].hpt=W,O[m].hpx=bf(W)):W===0&&(O[m].hidden=!0);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+M)}A<1&&(S=null);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+M)}}return O.length>0&&(T["!rows"]=O),j.length>0&&(T["!cols"]=j),u&&u.sheetRows&&(w=w.slice(0,u.sheetRows)),[w,T]}function l(d,u){var p=i(d,u),m=p[0],g=p[1],x=jf(m,u);return pn(g).forEach(function(y){x[y]=g[y]}),x}function o(d,u){return $l(l(d,u),u)}function a(d,u,p,m){var g="C;Y"+(p+1)+";X"+(m+1)+";K";switch(d.t){case"n":g+=d.v||0,d.f&&!d.F&&(g+=";E"+Oy(d.f,{r:p,c:m}));break;case"b":g+=d.v?"TRUE":"FALSE";break;case"e":g+=d.w||d.v;break;case"d":g+='"'+(d.w||d.v)+'"';break;case"s":g+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(d,u){u.forEach(function(p,m){var g="F;W"+(m+1)+" "+(m+1)+" ";p.hidden?g+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Pd(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Fd(p.wpx)),typeof p.wch=="number"&&(g+=Math.round(p.wch))),g.charAt(g.length-1)!=" "&&d.push(g)})}function f(d,u){u.forEach(function(p,m){var g="F;";p.hidden?g+="M0;":p.hpt?g+="M"+20*p.hpt+";":p.hpx&&(g+="M"+20*Dd(p.hpx)+";"),g.length>2&&d.push(g+"R"+(m+1))})}function h(d,u){var p=["ID;PWXL;N;E"],m=[],g=mr(d["!ref"]),x,y=Array.isArray(d),w=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),d["!cols"]&&c(p,d["!cols"]),d["!rows"]&&f(p,d["!rows"]),p.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var b=g.s.r;b<=g.e.r;++b)for(var S=g.s.c;S<=g.e.c;++S){var T=$t({r:b,c:S});x=y?(d[b]||[])[S]:d[T],!(!x||x.v==null&&(!x.f||x.F))&&m.push(a(x,d,b,S))}return p.join(w)+w+m.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:l,from_sheet:h}}(),kE=function(){function e(s,l){switch(l.type){case"base64":return t(Os(s),l);case"binary":return t(s,l);case"buffer":return t(ar&&Buffer.isBuffer(s)?s.toString("binary"):Hl(s),l);case"array":return t(Mc(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){for(var o=s.split(`
`),a=-1,c=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++a]=[],c=0;continue}if(!(a<0)){var d=o[f].trim().split(","),u=d[0],p=d[1];++f;for(var m=o[f]||"";(m.match(/["]/g)||[]).length&1&&f<o.length-1;)m+=`
`+o[++f];switch(m=m.trim(),+u){case-1:if(m==="BOT"){h[++a]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[a][c]=!0:m==="FALSE"?h[a][c]=!1:isNaN(wa(p))?isNaN(yf(p).getDate())?h[a][c]=p:h[a][c]=qr(p):h[a][c]=wa(p),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[a][c++]=m!==""?m:null;break}if(m==="EOD")break}}return l&&l.sheetRows&&(h=h.slice(0,l.sheetRows)),h}function r(s,l){return jf(e(s,l),l)}function n(s,l){return $l(r(s,l),l)}var i=function(){var s=function(a,c,f,h,d){a.push(c),a.push(f+","+h),a.push('"'+d.replace(/"/g,'""')+'"')},l=function(a,c,f,h){a.push(c+","+f),a.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(a){var c=[],f=mr(a["!ref"]),h,d=Array.isArray(a);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,f.e.r-f.s.r+1,""),s(c,"TUPLES",0,f.e.c-f.s.c+1,""),s(c,"DATA",0,0,"");for(var u=f.s.r;u<=f.e.r;++u){l(c,-1,0,"BOT");for(var p=f.s.c;p<=f.e.c;++p){var m=$t({r:u,c:p});if(h=d?(a[u]||[])[p]:a[m],!h){l(c,1,0,"");continue}switch(h.t){case"n":var g=h.w;!g&&h.v!=null&&(g=h.v),g==null?h.f&&!h.F?l(c,1,0,"="+h.f):l(c,1,0,""):l(c,0,g,"V");break;case"b":l(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":l(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Zs(h.z||zt[14],Kn(qr(h.v)))),l(c,0,h.w,"V");break;default:l(c,1,0,"")}}}l(c,-1,0,"EOD");var x=`\r
`,y=c.join(x);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),SE=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var u=h.split(`
`),p=-1,m=-1,g=0,x=[];g!==u.length;++g){var y=u[g].trim().split(":");if(y[0]==="cell"){var w=tn(y[1]);if(x.length<=w.r)for(p=x.length;p<=w.r;++p)x[p]||(x[p]=[]);switch(p=w.r,m=w.c,y[2]){case"t":x[p][m]=e(y[3]);break;case"v":x[p][m]=+y[3];break;case"vtf":var b=y[y.length-1];case"vtc":switch(y[3]){case"nl":x[p][m]=!!+y[4];break;default:x[p][m]=+y[4];break}y[2]=="vtf"&&(x[p][m]=[x[p][m],b])}}}return d&&d.sheetRows&&(x=x.slice(0,d.sheetRows)),x}function n(h,d){return jf(r(h,d),d)}function i(h,d){return $l(n(h,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),a="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],u=[],p,m="",g=ss(h["!ref"]),x=Array.isArray(h),y=g.s.r;y<=g.e.r;++y)for(var w=g.s.c;w<=g.e.c;++w)if(m=$t({r:y,c:w}),p=x?(h[y]||[])[w]:h[m],!(!p||p.v==null||p.t==="z")){switch(u=["cell",m,"t"],p.t){case"s":case"str":u.push(t(p.v));break;case"n":p.f?(u[2]="vtf",u[3]="n",u[4]=p.v,u[5]=t(p.f)):(u[2]="v",u[3]=p.v);break;case"b":u[2]="vt"+(p.f?"f":"c"),u[3]="nl",u[4]=p.v?"1":"0",u[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var b=Kn(qr(p.v));u[2]="vtc",u[3]="nd",u[4]=""+b,u[5]=p.w||Zs(p.z||zt[14],b);break;case"e":continue}d.push(u.join(":"))}return d.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(h){return[s,l,o,l,c(h),a].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),wf=function(){function e(f,h,d,u,p){p.raw?h[d][u]=f:f===""||(f==="TRUE"?h[d][u]=!0:f==="FALSE"?h[d][u]=!1:isNaN(wa(f))?isNaN(yf(f).getDate())?h[d][u]=f:h[d][u]=qr(f):h[d][u]=wa(f))}function t(f,h){var d=h||{},u=[];if(!f||f.length===0)return u;for(var p=f.split(/[\r\n]/),m=p.length-1;m>=0&&p[m].length===0;)--m;for(var g=10,x=0,y=0;y<=m;++y)x=p[y].indexOf(" "),x==-1?x=p[y].length:x++,g=Math.max(g,x);for(y=0;y<=m;++y){u[y]=[];var w=0;for(e(p[y].slice(0,g).trim(),u,y,w,d),w=1;w<=(p[y].length-g)/10+1;++w)e(p[y].slice(g+(w-1)*10,g+w*10).trim(),u,y,w,d)}return d.sheetRows&&(u=u.slice(0,d.sheetRows)),u}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var h={},d=!1,u=0,p=0;u<f.length;++u)(p=f.charCodeAt(u))==34?d=!d:!d&&p in r&&(h[p]=(h[p]||0)+1);p=[];for(u in h)Object.prototype.hasOwnProperty.call(h,u)&&p.push([h[u],u]);if(!p.length){h=n;for(u in h)Object.prototype.hasOwnProperty.call(h,u)&&p.push([h[u],u])}return p.sort(function(m,g){return m[0]-g[0]||n[m[1]]-n[g[1]]}),r[p.pop()[1]]||44}function s(f,h){var d=h||{},u="",p=d.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(u=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(u=f.charAt(4),f=f.slice(6)):u=i(f.slice(0,1024)):d&&d.FS?u=d.FS:u=i(f.slice(0,1024));var g=0,x=0,y=0,w=0,b=0,S=u.charCodeAt(0),T=!1,O=0,j=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var L=d.dateNF!=null?PI(d.dateNF):null;function W(){var F=f.slice(w,b),M={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)M.t="z";else if(d.raw)M.t="s",M.v=F;else if(F.trim().length===0)M.t="s",M.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(M.t="s",M.v=F.slice(2,-1).replace(/""/g,'"')):oU(F)?(M.t="n",M.f=F.slice(1)):(M.t="s",M.v=F);else if(F=="TRUE")M.t="b",M.v=!0;else if(F=="FALSE")M.t="b",M.v=!1;else if(!isNaN(y=wa(F)))M.t="n",d.cellText!==!1&&(M.w=F),M.v=y;else if(!isNaN(yf(F).getDate())||L&&F.match(L)){M.z=d.dateNF||zt[14];var V=0;L&&F.match(L)&&(F=FI(F,d.dateNF,F.match(L)||[]),V=1),d.cellDates?(M.t="d",M.v=qr(F,V)):(M.t="n",M.v=Kn(qr(F,V))),d.cellText!==!1&&(M.w=Zs(M.z,M.v instanceof Date?Kn(M.v):M.v)),d.cellNF||delete M.z}else M.t="s",M.v=F;if(M.t=="z"||(d.dense?(p[g]||(p[g]=[]),p[g][x]=M):p[$t({c:x,r:g})]=M),w=b+1,j=f.charCodeAt(w),m.e.c<x&&(m.e.c=x),m.e.r<g&&(m.e.r=g),O==S)++x;else if(x=0,++g,d.sheetRows&&d.sheetRows<=g)return!0}e:for(;b<f.length;++b)switch(O=f.charCodeAt(b)){case 34:j===34&&(T=!T);break;case S:case 10:case 13:if(!T&&W())break e;break}return b-w>0&&W(),p["!ref"]=tr(m),p}function l(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,h):jf(t(f,h),h)}function o(f,h){var d="",u=h.type=="string"?[0,0,0,0]:Ry(f,h);switch(h.type){case"base64":d=Os(f);break;case"binary":d=f;break;case"buffer":h.codepage==65001?d=f.toString("utf8"):h.codepage&&typeof Sd<"u"||(d=ar&&Buffer.isBuffer(f)?f.toString("binary"):Hl(f));break;case"array":d=Mc(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+h.type)}return u[0]==239&&u[1]==187&&u[2]==191?d=Or(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=Or(d):h.type=="binary"&&typeof Sd<"u",d.slice(0,19)=="socialcalc:version:"?SE.to_sheet(h.type=="string"?d:Or(d),h):l(d,h)}function a(f,h){return $l(o(f,h),h)}function c(f){for(var h=[],d=mr(f["!ref"]),u,p=Array.isArray(f),m=d.s.r;m<=d.e.r;++m){for(var g=[],x=d.s.c;x<=d.e.c;++x){var y=$t({r:m,c:x});if(u=p?(f[m]||[])[x]:f[y],!u||u.v==null){g.push("          ");continue}for(var w=(u.w||(Ro(u),u.w)||"").slice(0,10);w.length<10;)w+=" ";g.push(w+(x===0?" ":""))}h.push(g.join(""))}return h.join(`
`)}return{to_workbook:a,to_sheet:o,from_sheet:c}}();function GR(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=_E.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return wf.to_workbook(e,t)}}var Tc=function(){function e(k,P,A){if(k){pi(k,k.l||0);for(var E=A.Enum||U;k.l<k.length;){var I=k.read_shift(2),H=E[I]||E[65535],J=k.read_shift(2),Y=k.l+J,Z=H.f&&H.f(k,J,A);if(k.l=Y,P(Z,H,I))return}}}function t(k,P){switch(P.type){case"base64":return r(ws(Os(k)),P);case"binary":return r(ws(k),P);case"buffer":case"array":return r(k,P)}throw"Unsupported type "+P.type}function r(k,P){if(!k)return k;var A=P||{},E=A.dense?[]:{},I="Sheet1",H="",J=0,Y={},Z=[],fe=[],X={s:{r:0,c:0},e:{r:0,c:0}},re=A.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)A.Enum=U,e(k,function(ce,we,ye){switch(ye){case 0:A.vers=ce,ce>=4096&&(A.qpro=!0);break;case 6:X=ce;break;case 204:ce&&(H=ce);break;case 222:H=ce;break;case 15:case 51:A.qpro||(ce[1].v=ce[1].v.slice(1));case 13:case 14:case 16:ye==14&&(ce[2]&112)==112&&(ce[2]&15)>1&&(ce[2]&15)<15&&(ce[1].z=A.dateNF||zt[14],A.cellDates&&(ce[1].t="d",ce[1].v=cm(ce[1].v))),A.qpro&&ce[3]>J&&(E["!ref"]=tr(X),Y[I]=E,Z.push(I),E=A.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},J=ce[3],I=H||"Sheet"+(J+1),H="");var de=A.dense?(E[ce[0].r]||[])[ce[0].c]:E[$t(ce[0])];if(de){de.t=ce[1].t,de.v=ce[1].v,ce[1].z!=null&&(de.z=ce[1].z),ce[1].f!=null&&(de.f=ce[1].f);break}A.dense?(E[ce[0].r]||(E[ce[0].r]=[]),E[ce[0].r][ce[0].c]=ce[1]):E[$t(ce[0])]=ce[1];break}},A);else if(k[2]==26||k[2]==14)A.Enum=R,k[2]==14&&(A.qpro=!0,k.l=0),e(k,function(ce,we,ye){switch(ye){case 204:I=ce;break;case 22:ce[1].v=ce[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ce[3]>J&&(E["!ref"]=tr(X),Y[I]=E,Z.push(I),E=A.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},J=ce[3],I="Sheet"+(J+1)),re>0&&ce[0].r>=re)break;A.dense?(E[ce[0].r]||(E[ce[0].r]=[]),E[ce[0].r][ce[0].c]=ce[1]):E[$t(ce[0])]=ce[1],X.e.c<ce[0].c&&(X.e.c=ce[0].c),X.e.r<ce[0].r&&(X.e.r=ce[0].r);break;case 27:ce[14e3]&&(fe[ce[14e3][0]]=ce[14e3][1]);break;case 1537:fe[ce[0]]=ce[1],ce[0]==J&&(I=ce[1]);break}},A);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(E["!ref"]=tr(X),Y[H||I]=E,Z.push(H||I),!fe.length)return{SheetNames:Z,Sheets:Y};for(var se={},z=[],oe=0;oe<fe.length;++oe)Y[Z[oe]]?(z.push(fe[oe]||Z[oe]),se[fe[oe]]=Y[fe[oe]]||Y[Z[oe]]):(z.push(fe[oe]),se[fe[oe]]={"!ref":"A1"});return{SheetNames:z,Sheets:se}}function n(k,P){var A=P||{};if(+A.codepage>=0&&ma(+A.codepage),A.type=="string")throw new Error("Cannot write WK1 to JS string");var E=is(),I=mr(k["!ref"]),H=Array.isArray(k),J=[];vt(E,0,s(1030)),vt(E,6,a(I));for(var Y=Math.min(I.e.r,8191),Z=I.s.r;Z<=Y;++Z)for(var fe=Tn(Z),X=I.s.c;X<=I.e.c;++X){Z===I.s.r&&(J[X]=en(X));var re=J[X]+fe,se=H?(k[Z]||[])[X]:k[re];if(!(!se||se.t=="z"))if(se.t=="n")(se.v|0)==se.v&&se.v>=-32768&&se.v<=32767?vt(E,13,u(Z,X,se.v)):vt(E,14,m(Z,X,se.v));else{var z=Ro(se);vt(E,15,h(Z,X,z.slice(0,239)))}}return vt(E,1),E.end()}function i(k,P){var A=P||{};if(+A.codepage>=0&&ma(+A.codepage),A.type=="string")throw new Error("Cannot write WK3 to JS string");var E=is();vt(E,0,l(k));for(var I=0,H=0;I<k.SheetNames.length;++I)(k.Sheets[k.SheetNames[I]]||{})["!ref"]&&vt(E,27,N(k.SheetNames[I],H++));var J=0;for(I=0;I<k.SheetNames.length;++I){var Y=k.Sheets[k.SheetNames[I]];if(!(!Y||!Y["!ref"])){for(var Z=mr(Y["!ref"]),fe=Array.isArray(Y),X=[],re=Math.min(Z.e.r,8191),se=Z.s.r;se<=re;++se)for(var z=Tn(se),oe=Z.s.c;oe<=Z.e.c;++oe){se===Z.s.r&&(X[oe]=en(oe));var ce=X[oe]+z,we=fe?(Y[se]||[])[oe]:Y[ce];if(!(!we||we.t=="z"))if(we.t=="n")vt(E,23,W(se,oe,J,we.v));else{var ye=Ro(we);vt(E,22,O(se,oe,J,ye.slice(0,239)))}}++J}}return vt(E,1),E.end()}function s(k){var P=Ze(2);return P.write_shift(2,k),P}function l(k){var P=Ze(26);P.write_shift(2,4096),P.write_shift(2,4),P.write_shift(4,0);for(var A=0,E=0,I=0,H=0;H<k.SheetNames.length;++H){var J=k.SheetNames[H],Y=k.Sheets[J];if(!(!Y||!Y["!ref"])){++I;var Z=ss(Y["!ref"]);A<Z.e.r&&(A=Z.e.r),E<Z.e.c&&(E=Z.e.c)}}return A>8191&&(A=8191),P.write_shift(2,A),P.write_shift(1,I),P.write_shift(1,E),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(1,1),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(4,0),P}function o(k,P,A){var E={s:{c:0,r:0},e:{c:0,r:0}};return P==8&&A.qpro?(E.s.c=k.read_shift(1),k.l++,E.s.r=k.read_shift(2),E.e.c=k.read_shift(1),k.l++,E.e.r=k.read_shift(2),E):(E.s.c=k.read_shift(2),E.s.r=k.read_shift(2),P==12&&A.qpro&&(k.l+=2),E.e.c=k.read_shift(2),E.e.r=k.read_shift(2),P==12&&A.qpro&&(k.l+=2),E.s.c==65535&&(E.s.c=E.e.c=E.s.r=E.e.r=0),E)}function a(k){var P=Ze(8);return P.write_shift(2,k.s.c),P.write_shift(2,k.s.r),P.write_shift(2,k.e.c),P.write_shift(2,k.e.r),P}function c(k,P,A){var E=[{c:0,r:0},{t:"n",v:0},0,0];return A.qpro&&A.vers!=20768?(E[0].c=k.read_shift(1),E[3]=k.read_shift(1),E[0].r=k.read_shift(2),k.l+=2):(E[2]=k.read_shift(1),E[0].c=k.read_shift(2),E[0].r=k.read_shift(2)),E}function f(k,P,A){var E=k.l+P,I=c(k,P,A);if(I[1].t="s",A.vers==20768){k.l++;var H=k.read_shift(1);return I[1].v=k.read_shift(H,"utf8"),I}return A.qpro&&k.l++,I[1].v=k.read_shift(E-k.l,"cstr"),I}function h(k,P,A){var E=Ze(7+A.length);E.write_shift(1,255),E.write_shift(2,P),E.write_shift(2,k),E.write_shift(1,39);for(var I=0;I<E.length;++I){var H=A.charCodeAt(I);E.write_shift(1,H>=128?95:H)}return E.write_shift(1,0),E}function d(k,P,A){var E=c(k,P,A);return E[1].v=k.read_shift(2,"i"),E}function u(k,P,A){var E=Ze(7);return E.write_shift(1,255),E.write_shift(2,P),E.write_shift(2,k),E.write_shift(2,A,"i"),E}function p(k,P,A){var E=c(k,P,A);return E[1].v=k.read_shift(8,"f"),E}function m(k,P,A){var E=Ze(13);return E.write_shift(1,255),E.write_shift(2,P),E.write_shift(2,k),E.write_shift(8,A,"f"),E}function g(k,P,A){var E=k.l+P,I=c(k,P,A);if(I[1].v=k.read_shift(8,"f"),A.qpro)k.l=E;else{var H=k.read_shift(2);b(k.slice(k.l,k.l+H),I),k.l+=H}return I}function x(k,P,A){var E=P&32768;return P&=-32769,P=(E?k:0)+(P>=8192?P-16384:P),(E?"":"$")+(A?en(P):Tn(P))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(k,P){pi(k,0);for(var A=[],E=0,I="",H="",J="",Y="";k.l<k.length;){var Z=k[k.l++];switch(Z){case 0:A.push(k.read_shift(8,"f"));break;case 1:H=x(P[0].c,k.read_shift(2),!0),I=x(P[0].r,k.read_shift(2),!1),A.push(H+I);break;case 2:{var fe=x(P[0].c,k.read_shift(2),!0),X=x(P[0].r,k.read_shift(2),!1);H=x(P[0].c,k.read_shift(2),!0),I=x(P[0].r,k.read_shift(2),!1),A.push(fe+X+":"+H+I)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:A.push("("+A.pop()+")");break;case 5:A.push(k.read_shift(2));break;case 6:{for(var re="";Z=k[k.l++];)re+=String.fromCharCode(Z);A.push('"'+re.replace(/"/g,'""')+'"')}break;case 8:A.push("-"+A.pop());break;case 23:A.push("+"+A.pop());break;case 22:A.push("NOT("+A.pop()+")");break;case 20:case 21:Y=A.pop(),J=A.pop(),A.push(["AND","OR"][Z-20]+"("+J+","+Y+")");break;default:if(Z<32&&w[Z])Y=A.pop(),J=A.pop(),A.push(J+w[Z]+Y);else if(y[Z]){if(E=y[Z][1],E==69&&(E=k[k.l++]),E>A.length){console.error("WK1 bad formula parse 0x"+Z.toString(16)+":|"+A.join("|")+"|");return}var se=A.slice(-E);A.length-=E,A.push(y[Z][0]+"("+se.join(",")+")")}else return Z<=7?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=24?console.error("WK1 unsupported op "+Z.toString(16)):Z<=30?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=115?console.error("WK1 unsupported function opcode "+Z.toString(16)):console.error("WK1 unrecognized opcode "+Z.toString(16))}}A.length==1?P[1].f=""+A[0]:console.error("WK1 bad formula parse |"+A.join("|")+"|")}function S(k){var P=[{c:0,r:0},{t:"n",v:0},0];return P[0].r=k.read_shift(2),P[3]=k[k.l++],P[0].c=k[k.l++],P}function T(k,P){var A=S(k);return A[1].t="s",A[1].v=k.read_shift(P-4,"cstr"),A}function O(k,P,A,E){var I=Ze(6+E.length);I.write_shift(2,k),I.write_shift(1,A),I.write_shift(1,P),I.write_shift(1,39);for(var H=0;H<E.length;++H){var J=E.charCodeAt(H);I.write_shift(1,J>=128?95:J)}return I.write_shift(1,0),I}function j(k,P){var A=S(k);A[1].v=k.read_shift(2);var E=A[1].v>>1;if(A[1].v&1)switch(E&7){case 0:E=(E>>3)*5e3;break;case 1:E=(E>>3)*500;break;case 2:E=(E>>3)/20;break;case 3:E=(E>>3)/200;break;case 4:E=(E>>3)/2e3;break;case 5:E=(E>>3)/2e4;break;case 6:E=(E>>3)/16;break;case 7:E=(E>>3)/64;break}return A[1].v=E,A}function L(k,P){var A=S(k),E=k.read_shift(4),I=k.read_shift(4),H=k.read_shift(2);if(H==65535)return E===0&&I===3221225472?(A[1].t="e",A[1].v=15):E===0&&I===3489660928?(A[1].t="e",A[1].v=42):A[1].v=0,A;var J=H&32768;return H=(H&32767)-16446,A[1].v=(1-J*2)*(I*Math.pow(2,H+32)+E*Math.pow(2,H)),A}function W(k,P,A,E){var I=Ze(14);if(I.write_shift(2,k),I.write_shift(1,A),I.write_shift(1,P),E==0)return I.write_shift(4,0),I.write_shift(4,0),I.write_shift(2,65535),I;var H=0,J=0,Y=0,Z=0;return E<0&&(H=1,E=-E),J=Math.log2(E)|0,E/=Math.pow(2,J-31),Z=E>>>0,Z&2147483648||(E/=2,++J,Z=E>>>0),E-=Z,Z|=2147483648,Z>>>=0,E*=Math.pow(2,32),Y=E>>>0,I.write_shift(4,Y),I.write_shift(4,Z),J+=16383+(H?32768:0),I.write_shift(2,J),I}function F(k,P){var A=L(k);return k.l+=P-14,A}function M(k,P){var A=S(k),E=k.read_shift(4);return A[1].v=E>>6,A}function V(k,P){var A=S(k),E=k.read_shift(8,"f");return A[1].v=E,A}function G(k,P){var A=V(k);return k.l+=P-10,A}function te(k,P){return k[k.l+P-1]==0?k.read_shift(P,"cstr"):""}function ee(k,P){var A=k[k.l++];A>P-1&&(A=P-1);for(var E="";E.length<A;)E+=String.fromCharCode(k[k.l++]);return E}function Q(k,P,A){if(!(!A.qpro||P<21)){var E=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var I=k.read_shift(P-21,"cstr");return[E,I]}}function K(k,P){for(var A={},E=k.l+P;k.l<E;){var I=k.read_shift(2);if(I==14e3){for(A[I]=[0,""],A[I][0]=k.read_shift(2);k[k.l];)A[I][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return A}function N(k,P){var A=Ze(5+k.length);A.write_shift(2,14e3),A.write_shift(2,P);for(var E=0;E<k.length;++E){var I=k.charCodeAt(E);A[A.l++]=I>127?95:I}return A[A.l++]=0,A}var U={0:{n:"BOF",f:In},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:p},15:{n:"LABEL",f},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:te},222:{n:"SHEETNAMELP",f:ee},65535:{n:""}},R={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:T},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:j},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:K},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:V},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:te},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function XR(e){var t={},r=e.match(Li),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Gt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=ty[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var YR=function(){var e=Td("t"),t=Td("rPr");function r(s){var l=s.match(e);if(!l)return{t:"s",v:""};var o={t:"s",v:gr(l[1])},a=s.match(t);return a&&(o.s=XR(a[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),KR=function(){var t=/(\r\n|\n)/g;function r(i,s,l){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),l.push("</b>")),i.i&&(s.push("<i>"),l.push("</i>")),i.strike&&(s.push("<s>"),l.push("</s>"));var a=i.valign||"";return a=="superscript"||a=="super"?a="sup":a=="subscript"&&(a="sub"),a!=""&&(s.push("<"+a+">"),l.push("</"+a+">")),l.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),JR=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,QR=/<(?:\w+:)?r>/,ZR=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Cy(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=gr(Or(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Or(e),r&&(n.h=fy(n.t))):e.match(QR)&&(n.r=Or(e),n.t=gr(Or((e.replace(ZR,"").match(JR)||[]).join("").replace(Li,""))),r&&(n.h=KR(YR(n.r)))),n):{t:""}}var e9=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,t9=/<(?:\w+:)?(?:si|sstItem)>/g,r9=/<\/(?:\w+:)?(?:si|sstItem)>/;function n9(e,t){var r=[],n="";if(!e)return r;var i=e.match(e9);if(i){n=i[2].replace(t9,"").split(r9);for(var s=0;s!=n.length;++s){var l=Cy(n[s].trim(),t);l!=null&&(r[r.length]=l)}i=Gt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var i9=/^\s|\s$|[\t\n\r]/;function CE(e,t){if(!t.bookSST)return"";var r=[Nn];r[r.length]=xt("sst",null,{xmlns:Gc[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(i9)&&(s+=' xml:space="preserve"'),s+=">"+Tr(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function s9(e){return[e.read_shift(4),e.read_shift(4)]}function a9(e,t){var r=[],n=!1;return Wo(e,function(s,l,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function o9(e,t){return t||(t=Ze(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var l9=v7;function c9(e){var t=is();lt(t,159,o9(e));for(var r=0;r<e.length;++r)lt(t,19,l9(e[r]));return lt(t,160),t.end()}function EE(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Oo(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function u9(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Oo(e,4),t.U=Oo(e,4),t.W=Oo(e,4),t}function f9(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function h9(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(f9(e));return t}function d9(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function p9(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Oo(e,4),t.U=Oo(e,4),t.W=Oo(e,4),t}function g9(e){var t=p9(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function TE(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function NE(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function m9(e){var t=Oo(e);switch(t.Minor){case 2:return[t.Minor,x9(e)];case 3:return[t.Minor,v9()];case 4:return[t.Minor,y9(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function x9(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=TE(e,r),i=NE(e,e.length-e.l);return{t:"Std",h:n,v:i}}function v9(){throw new Error("File is password-protected: ECMA-376 Extensible")}function y9(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Li,function(s){var l=Gt(s);switch(eo(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=l[o]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function w9(e,t){var r={},n=r.EncryptionVersionInfo=Oo(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=TE(e,i),t-=i,r.EncryptionVerifier=NE(e,t),r}function b9(e){var t={},r=t.EncryptionVersionInfo=Oo(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Ey(e){var t=0,r,n=EE(e),i=n.length+1,s,l,o,a,c;for(r=Il(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)l=r[s],o=t&16384?1:0,a=t<<1&32767,c=o|a,t=c^l;return t^52811}var AE=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},i=function(l,o){return n(l^o)},s=function(l){for(var o=t[l.length-1],a=104,c=l.length-1;c>=0;--c)for(var f=l[c],h=0;h!=7;++h)f&64&&(o^=r[a]),f*=2,--a;return o};return function(l){for(var o=EE(l),a=s(o),c=o.length,f=Il(16),h=0;h!=16;++h)f[h]=0;var d,u,p;for((c&1)===1&&(d=a>>8,f[c]=i(e[0],d),--c,d=a&255,u=o[o.length-1],f[c]=i(u,d));c>0;)--c,d=a>>8,f[c]=i(o[c],d),--c,d=a&255,f[c]=i(o[c],d);for(c=15,p=15-o.length;p>0;)d=a>>8,f[c]=i(e[p],d),--c,--p,d=a&255,f[c]=i(o[c],d),--c,--p;return f}}(),_9=function(e,t,r,n,i){i||(i=t),n||(n=AE(e));var s,l;for(s=0;s!=t.length;++s)l=t[s],l^=n[r],l=(l>>5|l<<3)&255,i[s]=l,++r;return[i,r,n]},k9=function(e){var t=0,r=AE(e);return function(n){var i=_9("",n,t,r);return t=i[1],i[0]}};function S9(e,t,r,n){var i={key:In(e),verificationBytes:In(e)};return r.password&&(i.verifier=Ey(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=k9(r.password)),i}function C9(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=b9(e):n.Data=w9(e,t),n}function E9(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?C9(e,t-2,n):S9(e,r.biff>=8?t:t-2,r,n),n}var OE=function(){function e(i,s){switch(s.type){case"base64":return t(Os(i),s);case"binary":return t(i,s);case"buffer":return t(ar&&Buffer.isBuffer(i)?i.toString("binary"):Hl(i),s);case"array":return t(Mc(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var l=s||{},o=l.dense?[]:{},a=i.match(/\\trowd.*?\\row\b/g);if(!a.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:a.length-1}};return a.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,u=0,p,m=-1;p=d.exec(f);){switch(p[0]){case"\\cell":var g=f.slice(u,d.lastIndex-p[0].length);if(g[0]==" "&&(g=g.slice(1)),++m,g.length){var x={v:g,t:"s"};Array.isArray(o)?o[h][m]=x:o[$t({r:h,c:m})]=x}break}u=d.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=tr(c),o}function r(i,s){return $l(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],l=mr(i["!ref"]),o,a=Array.isArray(i),c=l.s.r;c<=l.e.r;++c){s.push("\\trowd\\trautofit1");for(var f=l.s.c;f<=l.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=l.s.c;f<=l.e.c;++f){var h=$t({r:c,c:f});o=a?(i[c]||[])[f]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Ro(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function T9(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function jd(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function N9(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),l=i-s;if(l===0)return[0,0,t];var o=0,a=0,c=i+s;switch(a=l/(c>1?2-c:c),i){case t:o=((r-n)/l+6)%6;break;case r:o=(n-t)/l+2;break;case n:o=(t-r)/l+4;break}return[o/6,a,c/2]}function A9(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,l=[s,s,s],o=6*t,a;if(r!==0)switch(o|0){case 0:case 6:a=i*o,l[0]+=i,l[1]+=a;break;case 1:a=i*(2-o),l[0]+=a,l[1]+=i;break;case 2:a=i*(o-2),l[1]+=i,l[2]+=a;break;case 3:a=i*(4-o),l[1]+=a,l[2]+=i;break;case 4:a=i*(o-4),l[2]+=i,l[0]+=a;break;case 5:a=i*(6-o),l[2]+=a,l[0]+=i;break}for(var c=0;c!=3;++c)l[c]=Math.round(l[c]*255);return l}function Pg(e,t){if(t===0)return e;var r=N9(T9(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),jd(A9(r))}var jE=6,O9=15,j9=1,Oi=jE;function Pd(e){return Math.floor((e+Math.round(128/Oi)/256)*Oi)}function Fd(e){return Math.floor((e-5)/Oi*100+.5)/100}function Fg(e){return Math.round((e*Oi+5)/Oi*256)/256}function nx(e){return Fg(Fd(Pd(e)))}function Ty(e){var t=Math.abs(e-nx(e)),r=Oi;if(t>.005)for(Oi=j9;Oi<O9;++Oi)Math.abs(e-nx(e))<=t&&(t=Math.abs(e-nx(e)),r=Oi);Oi=r}function Ml(e){e.width?(e.wpx=Pd(e.width),e.wch=Fd(e.wpx),e.MDW=Oi):e.wpx?(e.wch=Fd(e.wpx),e.width=Fg(e.wch),e.MDW=Oi):typeof e.wch=="number"&&(e.width=Fg(e.wch),e.wpx=Pd(e.width),e.MDW=Oi),e.customWidth&&delete e.customWidth}var P9=96,PE=P9;function Dd(e){return e*96/PE}function bf(e){return e*PE/96}var F9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function D9(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(Li)||[]).forEach(function(l){var o=Gt(l);switch(eo(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=zr(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=zr(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function L9(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(Li)||[]).forEach(function(l){var o=Gt(l);switch(eo(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function I9(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(Li)||[]).forEach(function(l){var o=Gt(l);switch(eo(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=Or(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?zr(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?zr(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?zr(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?zr(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?zr(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?zr(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?zr(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=ty[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=zr(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var a=Cc[i.color.index];i.color.index==81&&(a=Cc[1]),a||(a=Cc[1]),i.color.rgb=a[0].toString(16)+a[1].toString(16)+a[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Pg(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function M9(e,t,r){t.NumberFmt=[];for(var n=pn(zt),i=0;i<n.length;++i)t.NumberFmt[n[i]]=zt[n[i]];var s=e[0].match(Li);if(s)for(i=0;i<s.length;++i){var l=Gt(s[i]);switch(eo(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=gr(Or(l.formatCode)),a=parseInt(l.numFmtId,10);if(t.NumberFmt[a]=o,a>0){if(a>392){for(a=392;a>60&&t.NumberFmt[a]!=null;--a);t.NumberFmt[a]=o}Ao(o,a)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function R9(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=xt("numFmt",null,{numFmtId:n,formatCode:Tr(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=xt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var xp=["numFmtId","fillId","fontId","borderId","xfId"],vp=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function B9(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Li)||[]).forEach(function(s){var l=Gt(s),o=0;switch(eo(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],o=0;o<xp.length;++o)n[xp[o]]&&(n[xp[o]]=parseInt(n[xp[o]],10));for(o=0;o<vp.length;++o)n[vp[o]]&&(n[vp[o]]=zr(n[vp[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var a={};l.vertical&&(a.vertical=l.vertical),l.horizontal&&(a.horizontal=l.horizontal),l.textRotation!=null&&(a.textRotation=l.textRotation),l.indent&&(a.indent=l.indent),l.wrapText&&(a.wrapText=zr(l.wrapText)),n.alignment=a;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function U9(e){var t=[];return t[t.length]=xt("cellXfs",null),e.forEach(function(r){t[t.length]=xt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=xt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var z9=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,a,c){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(t))&&M9(h,f,c),(h=o.match(i))&&I9(h,f,a,c),(h=o.match(n))&&L9(h,f,a,c),(h=o.match(s))&&D9(h,f,a,c),(h=o.match(r))&&B9(h,f,c),f}}();function FE(e,t){var r=[Nn,xt("styleSheet",null,{xmlns:Gc[0],"xmlns:vt":Xn.vt})],n;return e.SSF&&(n=R9(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=U9(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function W9(e,t){var r=e.read_shift(2),n=Pi(e);return[r,n]}function H9(e,t,r){r||(r=Ze(6+4*t.length)),r.write_shift(2,e),ri(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function $9(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=C7(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var o=e.read_shift(1);o>0&&(n.family=o);var a=e.read_shift(1);switch(a>0&&(n.charset=a),e.l++,n.color=S7(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Pi(e),n}function q9(e,t){t||(t=Ze(25+4*32)),t.write_shift(2,e.sz*20),E7(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Ag(e.color,t);var n=0;return n=2,t.write_shift(1,n),ri(e.name,t),t.length>t.l?t.slice(0,t.l):t}var V9=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ix,G9=Di;function xk(e,t){t||(t=Ze(4*3+8*7+16*1)),ix||(ix=om(V9));var r=ix[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Ag({auto:1},t),Ag({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function X9(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function DE(e,t,r){r||(r=Ze(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function gh(e,t){return t||(t=Ze(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Y9=Di;function K9(e,t){return t||(t=Ze(51)),t.write_shift(1,0),gh(null,t),gh(null,t),gh(null,t),gh(null,t),gh(null,t),t.length>t.l?t.slice(0,t.l):t}function J9(e,t){return t||(t=Ze(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Ng(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Q9(e,t,r){var n=Ze(2052);return n.write_shift(4,e),Ng(t,n),Ng(r,n),n.length>n.l?n.slice(0,n.l):n}function Z9(e,t,r){var n={};n.NumberFmt=[];for(var i in zt)n.NumberFmt[i]=zt[i];n.CellXf=[],n.Fonts=[];var s=[],l=!1;return Wo(e,function(a,c,f){switch(f){case 44:n.NumberFmt[a[0]]=a[1],Ao(a[1],a[0]);break;case 43:n.Fonts.push(a),a.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=Pg(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(a);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(f),l=!0;break;case 38:s.pop(),l=!1;break;default:if(c.T>0)s.push(f);else if(c.T<0)s.pop();else if(!l||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function eB(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(lt(e,615,ba(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&lt(e,44,H9(i,t[i]))}),lt(e,616))}}function tB(e){var t=1;lt(e,611,ba(t)),lt(e,43,q9({sz:12,color:{theme:1},name:"Calibri",family:2})),lt(e,612)}function rB(e){var t=2;lt(e,603,ba(t)),lt(e,45,xk({patternType:"none"})),lt(e,45,xk({patternType:"gray125"})),lt(e,604)}function nB(e){var t=1;lt(e,613,ba(t)),lt(e,46,K9()),lt(e,614)}function iB(e){var t=1;lt(e,626,ba(t)),lt(e,47,DE({numFmtId:0},65535)),lt(e,627)}function sB(e,t){lt(e,617,ba(t.length)),t.forEach(function(r){lt(e,47,DE(r,0))}),lt(e,618)}function aB(e){var t=1;lt(e,619,ba(t)),lt(e,48,J9({xfId:0,name:"Normal"})),lt(e,620)}function oB(e){var t=0;lt(e,505,ba(t)),lt(e,506)}function lB(e){var t=0;lt(e,508,Q9(t,"TableStyleMedium9","PivotStyleMedium4")),lt(e,509)}function cB(e,t){var r=is();return lt(r,278),eB(r,e.SSF),tB(r),rB(r),nB(r),iB(r),sB(r,t.cellXfs),aB(r),oB(r),lB(r),lt(r,279),r.end()}var uB=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function fB(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Li)||[]).forEach(function(i){var s=Gt(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[uB.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function hB(){}function dB(){}var pB=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,gB=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,mB=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function xB(e,t,r){t.themeElements={};var n;[["clrScheme",pB,fB],["fontScheme",gB,hB],["fmtScheme",mB,dB]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var vB=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function LE(e,t){(!e||e.length===0)&&(e=Ny());var r,n={};if(!(r=e.match(vB)))throw new Error("themeElements not found in theme");return xB(r[0],n,t),n.raw=e,n}function Ny(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Nn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function yB(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var l;try{l=TC(s,{type:"array"})}catch{return}var o=bs(l,"theme/theme/theme1.xml",!0);if(o)return LE(o,r)}}function wB(e){return e.read_shift(4)}function bB(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=_B(e,4);break;case 2:t.xclrValue=pE(e);break;case 3:t.xclrValue=wB(e);break;case 4:e.l+=4;break}return e.l+=8,t}function _B(e,t){return Di(e,t)}function kB(e,t){return Di(e,t)}function SB(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=bB(e);break;case 6:n[1]=kB(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function CB(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(SB(e,r-e.l));return{ixfe:n,ext:s}}function EB(e,t){t.forEach(function(r){switch(r[0]){}})}function TB(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Pi(e)}}function NB(e){var t=Ze(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),ri(e.name,t),t.slice(0,t.l)}function AB(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function OB(e){var t=Ze(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function jB(e,t){var r=Ze(8+2*t.length);return r.write_shift(4,e),ri(t,r),r.slice(0,r.l)}function PB(e){return e.l+=4,e.read_shift(4)!=0}function FB(e,t){var r=Ze(8);return r.write_shift(4,e),r.write_shift(4,1),r}function DB(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],l=!1,o=2;return Wo(e,function(a,c,f){switch(f){case 335:n.Types.push({name:a.name});break;case 51:a.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=a?1:0;break;case 338:o=2;break;case 35:s.push(f),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!c.T){if(!l||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function LB(){var e=is();return lt(e,332),lt(e,334,ba(1)),lt(e,335,NB({name:"XLDAPR",version:12e4,flags:3496657072})),lt(e,336),lt(e,339,jB(1,"XLDAPR")),lt(e,52),lt(e,35,ba(514)),lt(e,4096,ba(0)),lt(e,4097,$s(1)),lt(e,36),lt(e,53),lt(e,340),lt(e,337,FB(1)),lt(e,51,OB([[1,0]])),lt(e,338),lt(e,333),e.end()}function IB(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,l;return e.replace(Li,function(o){var a=Gt(o);switch(eo(a[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:a.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==a.name&&(l=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[a.t-1].name,index:+a.v}):s==0&&n.Value.push({type:n.Types[a.t-1].name,index:+a.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+a.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+a[0]+" in metadata")}return o}),n}function IE(){var e=[Nn];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function MB(e){var t=[];if(!e)return t;var r=1;return(e.match(Li)||[]).forEach(function(n){var i=Gt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function RB(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=$t(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function BB(e,t,r){var n=[];return Wo(e,function(s,l,o){switch(o){case 63:n.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function UB(e,t,r,n){if(!e)return e;var i=n||{},s=!1;Wo(e,function(o,a,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!a.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function zB(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var qu=1024;function ME(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[xt("xml",null,{"xmlns:v":vs.v,"xmlns:o":vs.o,"xmlns:x":vs.x,"xmlns:mv":vs.mv}).replace(/\/>/,">"),xt("o:shapelayout",xt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),xt("v:shapetype",[xt("v:stroke",null,{joinstyle:"miter"}),xt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];qu<e*1e3;)qu+=1e3;return t.forEach(function(s){var l=tn(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var a=o.type=="gradient"?xt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=xt("v:fill",a,o),f={on:"t",obscured:"t"};++qu,i=i.concat(["<v:shape"+Nd({id:"_x0000_s"+qu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,xt("v:shadow",null,f),xt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",gi("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),gi("x:AutoFill","False"),gi("x:Row",String(l.r)),gi("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function vk(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(l){var o=tn(l.ref);if(i?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[l.ref],!s){s={t:"z"},i?e[o.r][o.c]=s:e[l.ref]=s;var a=mr(e["!ref"]||"BDWGO1000001:A1");a.s.r>o.r&&(a.s.r=o.r),a.e.r<o.r&&(a.e.r=o.r),a.s.c>o.c&&(a.s.c=o.c),a.e.c<o.c&&(a.e.c=o.c);var c=tr(a);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var f={a:l.author,t:l.t,r:l.r,T:r};l.h&&(f.h=l.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(f.a==n[h].id){f.a=n[h].name||f.a;break}}s.c.push(f)})}function WB(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?comment[^>]*>/);if(o){var a=Gt(o[0]),c={author:a.authorId&&r[a.authorId]||"sheetjsghost",ref:a.ref,guid:a.guid},f=tn(a.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var h=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&Cy(h[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function RE(e){var t=[Nn,xt("comments",null,{xmlns:Gc[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=Tr(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(a){a.a&&(i=r.indexOf(Tr(a.a))),s.push(a.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(gi("t",Tr(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)l+=`Reply:
    `+s[o]+`
`;t.push(gi("t",Tr(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function HB(e,t){var r=[],n=!1,i={},s=0;return e.replace(Li,function(o,a){var c=Gt(o);switch(eo(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=a+o.length;break;case"</text>":i.t=e.slice(s,a).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function $B(e,t,r){var n=[Nn,xt("ThreadedComments",null,{xmlns:Xn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var a={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=a.id:a.parentId=s,l.ID=a.id,l.a&&(a.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),n.push(xt("threadedComment",gi("text",l.t||""),a))})}),n.push("</ThreadedComments>"),n.join("")}function qB(e,t){var r=[],n=!1;return e.replace(Li,function(s){var l=Gt(s);switch(eo(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),r}function VB(e){var t=[Nn,xt("personList",null,{xmlns:Xn.TCMNT,"xmlns:x":Gc[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(xt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function GB(e){var t={};t.iauthor=e.read_shift(4);var r=Jc(e);return t.rfx=r.s,t.ref=$t(r.s),e.l+=16,t}function XB(e,t){return t==null&&(t=Ze(36)),t.write_shift(4,e[1].iauthor),Pf(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var YB=Pi;function KB(e){return ri(e.slice(0,54))}function JB(e,t){var r=[],n=[],i={},s=!1;return Wo(e,function(o,a,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!a.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function QB(e){var t=is(),r=[];return lt(t,628),lt(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),lt(t,632,KB(i.a)))})}),lt(t,631),lt(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:tn(n[0]),e:tn(n[0])};lt(t,635,XB([s,i])),i.t&&i.t.length>0&&lt(t,637,w7(i)),lt(t,636),delete i.iauthor})}),lt(t,634),lt(t,629),t.end()}var ZB="application/vnd.ms-office.vbaProject";function eU(e){var t=Rt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Rt.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Rt.write(t)}function tU(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Rt.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var BE=["xlsb","xlsm","xlam","biff8","xla"];function rU(){return{"!type":"dialog"}}function nU(){return{"!type":"dialog"}}function iU(){return{"!type":"macro"}}function sU(){return{"!type":"macro"}}var af=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,l){var o=!1,a=!1;s.length==0?a=!0:s.charAt(0)=="["&&(a=!0,s=s.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,f=l.length>0?parseInt(l,10)|0:0;return o?f+=t.c:--f,a?c+=t.r:--c,i+(o?"":"$")+en(f)+(a?"":"$")+Tn(c)}return function(i,s){return t=s,i.replace(e,r)}}(),Ay=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Oy=function(){return function(t,r){return t.replace(Ay,function(n,i,s,l,o,a){var c=my(l)-(s?0:r.c),f=gy(a)-(o?0:r.r),h=f==0?"":o?f+1:"["+f+"]",d=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+d})}}();function UE(e,t){return e.replace(Ay,function(r,n,i,s,l,o){return n+(i=="$"?i+s:en(my(s)+t.c))+(l=="$"?l+o:Tn(gy(o)+t.r))})}function aU(e,t,r){var n=ss(t),i=n.s,s=tn(r),l={r:s.r-i.r,c:s.c-i.c};return UE(e,l)}function oU(e){return e.length!=1}function yk(e){return e.replace(/_xlfn\./g,"")}function Dn(e){e.l+=1}function Rl(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function zE(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return WE(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),l=Rl(e),o=Rl(e);return{s:{r:i,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function WE(e){var t=Rl(e),r=Rl(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function lU(e,t,r){if(r.biff<8)return WE(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=Rl(e),l=Rl(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function HE(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return cU(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Rl(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function cU(e){var t=Rl(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function uU(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function fU(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return hU(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),l=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:l,rRel:o}}function hU(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function dU(e,t,r){var n=(e[e.l++]&96)>>5,i=zE(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function pU(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var l=zE(e,s,r);return[n,i,l]}function gU(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function mU(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function xU(e,t,r){var n=(e[e.l++]&96)>>5,i=lU(e,t-1,r);return[n,i]}function vU(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function wk(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function yU(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function wU(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function bU(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function _U(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function kU(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function $E(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function SU(e){return e.read_shift(2),$E(e)}function CU(e){return e.read_shift(2),$E(e)}function EU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=HE(e,0,r);return[n,i]}function TU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=fU(e,0,r);return[n,i]}function NU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=HE(e,0,r);return[n,i,s]}function AU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[Pz[i],GE[i],n]}function OU(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:jU(e);return[i,(s[0]===0?GE:jz)[s[1]]]}function jU(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function PU(e,t,r){e.l+=r&&r.biff==2?3:4}function FU(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function DU(e){return e.l++,Ho[e.read_shift(1)]}function LU(e){return e.l++,e.read_shift(2)}function IU(e){return e.l++,e.read_shift(1)!==0}function MU(e){return e.l++,ji(e)}function RU(e,t,r){return e.l++,Yd(e,t-1,r)}function BU(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=wn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ho[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ji(e);break;case 2:r[1]=Qc(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function UU(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Jc:um)(e));return i}function zU(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,l=[];s!=n&&(l[s]=[]);++s)for(var o=0;o!=i;++o)l[s][o]=BU(e,r.biff);return l}function WU(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function HU(e,t,r){if(r.biff==5)return $U(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function $U(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function qU(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function VU(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function GU(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function XU(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var YU=Di,KU=Di,JU=Di;function Jd(e,t,r){return e.l+=2,[uU(e)]}function jy(e){return e.l+=6,[]}var QU=Jd,ZU=jy,ez=jy,tz=Jd;function qE(e){return e.l+=2,[In(e),e.read_shift(2)&1]}var rz=Jd,nz=qE,iz=jy,sz=Jd,az=Jd,oz=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function lz(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),l=oz[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:n,c:i,C:s}}function cz(e){return e.l+=2,[e.read_shift(4)]}function uz(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function fz(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function hz(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function dz(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function pz(e){return e.l+=4,[0,0]}var bk={1:{n:"PtgExp",f:FU},2:{n:"PtgTbl",f:JU},3:{n:"PtgAdd",f:Dn},4:{n:"PtgSub",f:Dn},5:{n:"PtgMul",f:Dn},6:{n:"PtgDiv",f:Dn},7:{n:"PtgPower",f:Dn},8:{n:"PtgConcat",f:Dn},9:{n:"PtgLt",f:Dn},10:{n:"PtgLe",f:Dn},11:{n:"PtgEq",f:Dn},12:{n:"PtgGe",f:Dn},13:{n:"PtgGt",f:Dn},14:{n:"PtgNe",f:Dn},15:{n:"PtgIsect",f:Dn},16:{n:"PtgUnion",f:Dn},17:{n:"PtgRange",f:Dn},18:{n:"PtgUplus",f:Dn},19:{n:"PtgUminus",f:Dn},20:{n:"PtgPercent",f:Dn},21:{n:"PtgParen",f:Dn},22:{n:"PtgMissArg",f:Dn},23:{n:"PtgStr",f:RU},26:{n:"PtgSheet",f:uz},27:{n:"PtgEndSheet",f:fz},28:{n:"PtgErr",f:DU},29:{n:"PtgBool",f:IU},30:{n:"PtgInt",f:LU},31:{n:"PtgNum",f:MU},32:{n:"PtgArray",f:vU},33:{n:"PtgFunc",f:AU},34:{n:"PtgFuncVar",f:OU},35:{n:"PtgName",f:WU},36:{n:"PtgRef",f:EU},37:{n:"PtgArea",f:dU},38:{n:"PtgMemArea",f:qU},39:{n:"PtgMemErr",f:YU},40:{n:"PtgMemNoMem",f:KU},41:{n:"PtgMemFunc",f:VU},42:{n:"PtgRefErr",f:GU},43:{n:"PtgAreaErr",f:gU},44:{n:"PtgRefN",f:TU},45:{n:"PtgAreaN",f:xU},46:{n:"PtgMemAreaN",f:hz},47:{n:"PtgMemNoMemN",f:dz},57:{n:"PtgNameX",f:HU},58:{n:"PtgRef3d",f:NU},59:{n:"PtgArea3d",f:pU},60:{n:"PtgRefErr3d",f:XU},61:{n:"PtgAreaErr3d",f:mU},255:{}},gz={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},mz={1:{n:"PtgElfLel",f:qE},2:{n:"PtgElfRw",f:sz},3:{n:"PtgElfCol",f:QU},6:{n:"PtgElfRwV",f:az},7:{n:"PtgElfColV",f:tz},10:{n:"PtgElfRadical",f:rz},11:{n:"PtgElfRadicalS",f:iz},13:{n:"PtgElfColS",f:ZU},15:{n:"PtgElfColSV",f:ez},16:{n:"PtgElfRadicalLel",f:nz},25:{n:"PtgList",f:lz},29:{n:"PtgSxName",f:cz},255:{}},xz={0:{n:"PtgAttrNoop",f:pz},1:{n:"PtgAttrSemi",f:kU},2:{n:"PtgAttrIf",f:bU},4:{n:"PtgAttrChoose",f:yU},8:{n:"PtgAttrGoto",f:wU},16:{n:"PtgAttrSum",f:PU},32:{n:"PtgAttrBaxcel",f:wk},33:{n:"PtgAttrBaxcel",f:wk},64:{n:"PtgAttrSpace",f:SU},65:{n:"PtgAttrSpaceSemi",f:CU},128:{n:"PtgAttrIfError",f:_U},255:{}};function Qd(e,t,r,n){if(n.biff<8)return Di(e,t);for(var i=e.l+t,s=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=zU(e,0,n),s.push(r[l][1]);break;case"PtgMemArea":r[l][2]=UU(e,r[l][1],n),s.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=e.read_shift(4),s.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=i-e.l,t!==0&&s.push(Di(e,t)),s}function Zd(e,t,r){for(var n=e.l+t,i,s,l=[];n!=e.l;)t=n-e.l,s=e[e.l],i=bk[s]||bk[gz[s]],(s===24||s===25)&&(i=(s===24?mz:xz)[e[e.l+1]]),!i||!i.f?Di(e,t):l.push([i.n,i.f(e,t,r)]);return l}function vz(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var l=n[s];if(l)switch(l[0]){case 2:i.push('"'+l[1].replace(/"/g,'""')+'"');break;default:i.push(l[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var yz={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function wz(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function VE(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function _k(e,t,r){var n=VE(e,t,r);return n=="#REF"?n:wz(n,r)}function Ni(e,t,r,n,i){var s=i&&i.biff||8,l={s:{c:0,r:0}},o=[],a,c,f,h=0,d=0,u,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",x=0,y=e[0].length;x<y;++x){var w=e[0][x];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(a=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=hn(" ",e[0][m][1][1]);break;case 1:g=hn("\r",e[0][m][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+g,m=-1}o.push(c+yz[w[0]]+a);break;case"PtgIsect":a=o.pop(),c=o.pop(),o.push(c+" "+a);break;case"PtgUnion":a=o.pop(),c=o.pop(),o.push(c+","+a);break;case"PtgRange":a=o.pop(),c=o.pop(),o.push(c+":"+a);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Bh(w[1][1],l,i),o.push(Uh(f,s));break;case"PtgRefN":f=r?Bh(w[1][1],r,i):w[1][1],o.push(Uh(f,s));break;case"PtgRef3d":h=w[1][1],f=Bh(w[1][2],l,i),p=_k(n,h,i),o.push(p+"!"+Uh(f,s));break;case"PtgFunc":case"PtgFuncVar":var b=w[1][0],S=w[1][1];b||(b=0),b&=127;var T=b==0?[]:o.slice(-b);o.length-=b,S==="User"&&(S=T.shift()),o.push(S+"("+T.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":u=J5(w[1][1],r?{s:r}:l,i),o.push(ex(u,i));break;case"PtgArea":u=J5(w[1][1],l,i),o.push(ex(u,i));break;case"PtgArea3d":h=w[1][1],u=w[1][2],p=_k(n,h,i),o.push(p+"!"+ex(u,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=w[1][2];var O=(n.names||[])[d-1]||(n[0]||[])[d],j=O?O.Name:"SH33TJSNAME"+String(d);j&&j.slice(0,6)=="_xlfn."&&!i.xlfn&&(j=j.slice(6)),o.push(j);break;case"PtgNameX":var L=w[1][1];d=w[1][2];var W;if(i.biff<=5)L<0&&(L=-L),n[L]&&(W=n[L][d]);else{var F="";if(((n[L]||[])[0]||[])[0]==14849||(((n[L]||[])[0]||[])[0]==1025?n[L][d]&&n[L][d].itab>0&&(F=n.SheetNames[n[L][d].itab-1]+"!"):F=n.SheetNames[d-1]+"!"),n[L]&&n[L][d])F+=n[L][d].Name;else if(n[0]&&n[0][d])F+=n[0][d].Name;else{var M=(VE(n,L,i)||"").split(";;");M[d-1]?F=M[d-1]:F+="SH33TJSERRX"}o.push(F);break}W||(W={Name:"SH33TJSERRY"}),o.push(W.Name);break;case"PtgParen":var V="(",G=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:V=hn(" ",e[0][m][1][1])+V;break;case 3:V=hn("\r",e[0][m][1][1])+V;break;case 4:G=hn(" ",e[0][m][1][1])+G;break;case 5:G=hn("\r",e[0][m][1][1])+G;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(V+o.pop()+G);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:w[1][1],r:w[1][0]};var te={c:r.c,r:r.r};if(n.sharedf[$t(f)]){var ee=n.sharedf[$t(f)];o.push(Ni(ee,l,te,n,i))}else{var Q=!1;for(a=0;a!=n.arrayf.length;++a)if(c=n.arrayf[a],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(Ni(c[1],l,te,n,i)),Q=!0;break}Q||o.push(w[1])}break;case"PtgArray":o.push("{"+vz(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var K=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&K.indexOf(e[0][x][0])==-1){w=e[0][m];var N=!0;switch(w[1][0]){case 4:N=!1;case 0:g=hn(" ",w[1][1]);break;case 5:N=!1;case 1:g=hn("\r",w[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((N?g:"")+o.pop()+(N?"":g)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function bz(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,l=e.read_shift(i);if(l==65535)return[[],Di(e,t-2)];var o=Zd(e,l,r);return t!==l+i&&(s=Qd(e,t-l-i,o,r)),e.l=n,[o,s]}function _z(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,l=e.read_shift(i);if(l==65535)return[[],Di(e,t-2)];var o=Zd(e,l,r);return t!==l+i&&(s=Qd(e,t-l-i,o,r)),e.l=n,[o,s]}function kz(e,t,r,n){var i=e.l+t,s=Zd(e,n,r),l;return i!==e.l&&(l=Qd(e,i-e.l,s,r)),[s,l]}function Sz(e,t,r){var n=e.l+t,i,s=e.read_shift(2),l=Zd(e,s,r);return s==65535?[[],Di(e,t-2)]:(t!==s+2&&(i=Qd(e,n-s-2,l,r)),[l,i])}function Cz(e){var t;if(Eo(e,e.l+6)!==65535)return[ji(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Ez(e){if(e==null){var t=Ze(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Rc(e);return Rc(0)}function sx(e,t,r){var n=e.l+t,i=to(e);r.biff==2&&++e.l;var s=Cz(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=_z(e,n-e.l,r);return{cell:i,val:s[0],formula:o,shared:l>>3&1,tt:s[1]}}function Tz(e,t,r,n,i){var s=Uc(t,r,i),l=Ez(e.v),o=Ze(6),a=33;o.write_shift(2,a),o.write_shift(4,0);for(var c=Ze(e.bf.length),f=0;f<e.bf.length;++f)c[f]=e.bf[f];var h=ti([s,l,o,c]);return h}function fm(e,t,r){var n=e.read_shift(4),i=Zd(e,n,r),s=e.read_shift(4),l=s>0?Qd(e,s,i,r):null;return[i,l]}var Nz=fm,hm=fm,Az=fm,Oz=fm,jz={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},GE={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Pz={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function kk(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Fz(e){var t="of:="+e.replace(Ay,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function ax(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Dz(e){return e.replace(/\./,"!")}var Wh={},of={},Hh=typeof Map<"u";function Py(e,t,r){var n=0,i=e.length;if(r){if(Hh?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Hh?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(Hh?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function dm(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Oi=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Fd(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Fg(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Nc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ql(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Ao(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function XE(e,t,r,n,i,s){try{n.cellNF&&(e.z=zt[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=qr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(zt[t]==null&&Ao(jI[t]||"General",t),e.t==="e")e.w=e.w||Ho[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ed(e.v);else if(e.t==="d"){var l=Kn(e.v);(l|0)===l?e.w=l.toString(10):e.w=Ed(l)}else{if(e.v===void 0)return"";e.w=Ic(e.v,of)}else e.t==="d"?e.w=Zs(t,Kn(e.v),of):e.w=Zs(t,e.v,of)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Pg(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Pg(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function Lz(e,t,r){if(e&&e["!ref"]){var n=mr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Iz(e,t){var r=mr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=tr(r))}var Mz=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Rz=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Bz=/<(?:\w:)?hyperlink [^>]*>/mg,Uz=/"(\w*:\w*)"/,zz=/<(?:\w:)?col\b[^>]*[\/]?>/g,Wz=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Hz=/<(?:\w:)?pageMargins[^>]*\/>/g,YE=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,$z=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,qz=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Vz(e,t,r,n,i,s,l){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},a={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",h=e.match(Rz);h?(c=e.slice(0,h.index),f=e.slice(h.index+h[0].length)):c=f=e;var d=c.match(YE);d?Fy(d[0],o,i,r):(d=c.match($z))&&Xz(d[0],d[1]||"",o,i,r);var u=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(u>0){var p=c.slice(u,u+50).match(Uz);p&&Iz(o,p[1])}var m=c.match(qz);m&&m[1]&&oW(m[1],i);var g=[];if(t.cellStyles){var x=c.match(zz);x&&rW(g,x)}h&&uW(h[1],o,t,a,s,l);var y=f.match(Wz);y&&(o["!autofilter"]=iW(y[0]));var w=[],b=f.match(Mz);if(b)for(u=0;u!=b.length;++u)w[u]=mr(b[u].slice(b[u].indexOf('"')+1));var S=f.match(Bz);S&&Zz(o,S,n);var T=f.match(Hz);if(T&&(o["!margins"]=eW(Gt(T[0]))),!o["!ref"]&&a.e.c>=a.s.c&&a.e.r>=a.s.r&&(o["!ref"]=tr(a)),t.sheetRows>0&&o["!ref"]){var O=mr(o["!ref"]);t.sheetRows<=+O.e.r&&(O.e.r=t.sheetRows-1,O.e.r>a.e.r&&(O.e.r=a.e.r),O.e.r<O.s.r&&(O.s.r=O.e.r),O.e.c>a.e.c&&(O.e.c=a.e.c),O.e.c<O.s.c&&(O.s.c=O.e.c),o["!fullref"]=o["!ref"],o["!ref"]=tr(O))}return g.length>0&&(o["!cols"]=g),w.length>0&&(o["!merges"]=w),o}function Gz(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+tr(e[r])+'"/>';return t+"</mergeCells>"}function Fy(e,t,r,n){var i=Gt(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=gr(Or(i.codeName)))}function Xz(e,t,r,n,i){Fy(e.slice(0,e.indexOf(">")),r,n,i)}function Yz(e,t,r,n,i){var s=!1,l={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var a=t.SheetNames[r];try{t.Workbook&&(a=t.Workbook.Sheets[r].CodeName||a)}catch{}s=!0,l.codeName=Va(Tr(a))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+xt("outlinePr",null,c)}!s&&!o||(i[i.length]=xt("sheetPr",o,l))}var Kz=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Jz=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Qz(e){var t={sheet:1};return Kz.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Jz.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Ey(e.password).toString(16).toUpperCase()),xt("sheetProtection",null,t)}function Zz(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=Gt(Or(t[i]),!0);if(!s.ref)return;var l=((r||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+gr(s.location))):(s.Target="#"+gr(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=mr(s.ref),a=o.s.r;a<=o.e.r;++a)for(var c=o.s.c;c<=o.e.c;++c){var f=$t({c,r:a});n?(e[a]||(e[a]=[]),e[a][c]||(e[a][c]={t:"z",v:void 0}),e[a][c].l=s):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=s)}}}function eW(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function tW(e){return Nc(e),xt("pageMargins",null,e)}function rW(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Gt(t[n],!0);i.hidden&&(i.hidden=zr(i.hidden));var s=parseInt(i.min,10)-1,l=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Ty(i.width)),Ml(i);s<=l;)e[s++]=Vr(i)}}function nW(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=xt("col",null,dm(i,n)));return r[r.length]="</cols>",r.join("")}function iW(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function sW(e,t,r,n){var i=typeof e.ref=="string"?e.ref:tr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=ss(i);l.s.r==l.e.r&&(l.e.r=ss(t["!ref"]).e.r,i=tr(l));for(var o=0;o<s.length;++o){var a=s[o];if(a.Name=="_xlnm._FilterDatabase"&&a.Sheet==n){a.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),xt("autoFilter",null,{ref:i})}var aW=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function oW(e,t){t.Views||(t.Views=[{}]),(e.match(aW)||[]).forEach(function(r,n){var i=Gt(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),zr(i.rightToLeft)&&(t.Views[n].RTL=!0)})}function lW(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),xt("sheetViews",xt("sheetView",null,i),{})}function cW(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Ho[e.v];break;case"d":n&&n.cellDates?i=qr(e.v,-1).toISOString():(e=Vr(e),e.t="n",i=""+(e.v=Kn(qr(e.v)))),typeof e.z>"u"&&(e.z=zt[14]);break;default:i=e.v;break}var o=gi("v",Tr(i)),a={r:t},c=ql(n.cellXfs,e,n);switch(c!==0&&(a.s=c),e.t){case"n":break;case"d":a.t="d";break;case"b":a.t="b";break;case"e":a.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=gi("v",""+Py(n.Strings,e.v,n.revStrings)),a.t="s";break}a.t="str";break}if(e.t!=s&&(e.t=s,e.v=l),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=xt("f",Tr(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(a.cm=1),xt("c",o,a)}var uW=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=Td("v"),l=Td("f");return function(a,c,f,h,d,u){for(var p=0,m="",g=[],x=[],y=0,w=0,b=0,S="",T,O,j=0,L=0,W,F,M=0,V=0,G=Array.isArray(u.CellXf),te,ee=[],Q=[],K=Array.isArray(c),N=[],U={},R=!1,k=!!f.sheetStubs,P=a.split(t),A=0,E=P.length;A!=E;++A){m=P[A].trim();var I=m.length;if(I!==0){var H=0;e:for(p=0;p<I;++p)switch(m[p]){case">":if(m[p-1]!="/"){++p;break e}if(f&&f.cellStyles){if(O=Gt(m.slice(H,p),!0),j=O.r!=null?parseInt(O.r,10):j+1,L=-1,f.sheetRows&&f.sheetRows<j)continue;U={},R=!1,O.ht&&(R=!0,U.hpt=parseFloat(O.ht),U.hpx=bf(U.hpt)),O.hidden=="1"&&(R=!0,U.hidden=!0),O.outlineLevel!=null&&(R=!0,U.level=+O.outlineLevel),R&&(N[j-1]=U)}break;case"<":H=p;break}if(H>=p)break;if(O=Gt(m.slice(H,p),!0),j=O.r!=null?parseInt(O.r,10):j+1,L=-1,!(f.sheetRows&&f.sheetRows<j)){h.s.r>j-1&&(h.s.r=j-1),h.e.r<j-1&&(h.e.r=j-1),f&&f.cellStyles&&(U={},R=!1,O.ht&&(R=!0,U.hpt=parseFloat(O.ht),U.hpx=bf(U.hpt)),O.hidden=="1"&&(R=!0,U.hidden=!0),O.outlineLevel!=null&&(R=!0,U.level=+O.outlineLevel),R&&(N[j-1]=U)),g=m.slice(p).split(e);for(var J=0;J!=g.length&&g[J].trim().charAt(0)=="<";++J);for(g=g.slice(J),p=0;p!=g.length;++p)if(m=g[p].trim(),m.length!==0){if(x=m.match(r),y=p,w=0,b=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,x!=null&&x.length===2){for(y=0,S=x[1],w=0;w!=S.length&&!((b=S.charCodeAt(w)-64)<1||b>26);++w)y=26*y+b;--y,L=y}else++L;for(w=0;w!=m.length&&m.charCodeAt(w)!==62;++w);if(++w,O=Gt(m.slice(0,w),!0),O.r||(O.r=$t({r:j-1,c:L})),S=m.slice(w),T={t:""},(x=S.match(s))!=null&&x[1]!==""&&(T.v=gr(x[1])),f.cellFormula){if((x=S.match(l))!=null&&x[1]!==""){if(T.f=gr(Or(x[1])).replace(/\r\n/g,`
`),f.xlfn||(T.f=yk(T.f)),x[0].indexOf('t="array"')>-1)T.F=(S.match(i)||[])[1],T.F.indexOf(":")>-1&&ee.push([mr(T.F),T.F]);else if(x[0].indexOf('t="shared"')>-1){F=Gt(x[0]);var Y=gr(Or(x[1]));f.xlfn||(Y=yk(Y)),Q[parseInt(F.si,10)]=[F,Y,O.r]}}else(x=S.match(/<f[^>]*\/>/))&&(F=Gt(x[0]),Q[F.si]&&(T.f=aU(Q[F.si][1],Q[F.si][2],O.r)));var Z=tn(O.r);for(w=0;w<ee.length;++w)Z.r>=ee[w][0].s.r&&Z.r<=ee[w][0].e.r&&Z.c>=ee[w][0].s.c&&Z.c<=ee[w][0].e.c&&(T.F=ee[w][1])}if(O.t==null&&T.v===void 0)if(T.f||T.F)T.v=0,T.t="n";else if(k)T.t="z";else continue;else T.t=O.t||"n";switch(h.s.c>L&&(h.s.c=L),h.e.c<L&&(h.e.c=L),T.t){case"n":if(T.v==""||T.v==null){if(!k)continue;T.t="z"}else T.v=parseFloat(T.v);break;case"s":if(typeof T.v>"u"){if(!k)continue;T.t="z"}else W=Wh[parseInt(T.v,10)],T.v=W.t,T.r=W.r,f.cellHTML&&(T.h=W.h);break;case"str":T.t="s",T.v=T.v!=null?Or(T.v):"",f.cellHTML&&(T.h=fy(T.v));break;case"inlineStr":x=S.match(n),T.t="s",x!=null&&(W=Cy(x[1]))?(T.v=W.t,f.cellHTML&&(T.h=W.h)):T.v="";break;case"b":T.v=zr(T.v);break;case"d":f.cellDates?T.v=qr(T.v,1):(T.v=Kn(qr(T.v,1)),T.t="n");break;case"e":(!f||f.cellText!==!1)&&(T.w=T.v),T.v=JC[T.v];break}if(M=V=0,te=null,G&&O.s!==void 0&&(te=u.CellXf[O.s],te!=null&&(te.numFmtId!=null&&(M=te.numFmtId),f.cellStyles&&te.fillId!=null&&(V=te.fillId))),XE(T,M,V,f,d,u),f.cellDates&&G&&T.t=="n"&&Af(zt[M])&&(T.t="d",T.v=cm(T.v)),O.cm&&f.xlmeta){var fe=(f.xlmeta.Cell||[])[+O.cm-1];fe&&fe.type=="XLDAPR"&&(T.D=!0)}if(K){var X=tn(O.r);c[X.r]||(c[X.r]=[]),c[X.r][X.c]=T}else c[O.r]=T}}}}N.length>0&&(c["!rows"]=N)}}();function fW(e,t,r,n){var i=[],s=[],l=mr(e["!ref"]),o="",a,c="",f=[],h=0,d=0,u=e["!rows"],p=Array.isArray(e),m={r:c},g,x=-1;for(d=l.s.c;d<=l.e.c;++d)f[d]=en(d);for(h=l.s.r;h<=l.e.r;++h){for(s=[],c=Tn(h),d=l.s.c;d<=l.e.c;++d){a=f[d]+c;var y=p?(e[h]||[])[d]:e[a];y!==void 0&&(o=cW(y,a,e,t))!=null&&s.push(o)}(s.length>0||u&&u[h])&&(m={r:c},u&&u[h]&&(g=u[h],g.hidden&&(m.hidden=1),x=-1,g.hpx?x=Dd(g.hpx):g.hpt&&(x=g.hpt),x>-1&&(m.ht=x,m.customHeight=1),g.level&&(m.outlineLevel=g.level)),i[i.length]=xt("row",s.join(""),m))}if(u)for(;h<u.length;++h)u&&u[h]&&(m={r:h+1},g=u[h],g.hidden&&(m.hidden=1),x=-1,g.hpx?x=Dd(g.hpx):g.hpt&&(x=g.hpt),x>-1&&(m.ht=x,m.customHeight=1),g.level&&(m.outlineLevel=g.level),i[i.length]=xt("row","",m));return i.join("")}function KE(e,t,r,n){var i=[Nn,xt("worksheet",null,{xmlns:Gc[0],"xmlns:r":Xn.r})],s=r.SheetNames[e],l=0,o="",a=r.Sheets[s];a==null&&(a={});var c=a["!ref"]||"A1",f=mr(c);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),c=tr(f)}n||(n={}),a["!comments"]=[];var h=[];Yz(a,r,e,t,i),i[i.length]=xt("dimension",null,{ref:c}),i[i.length]=lW(a,t,e,r),t.sheetFormat&&(i[i.length]=xt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),a["!cols"]!=null&&a["!cols"].length>0&&(i[i.length]=nW(a,a["!cols"])),i[l=i.length]="<sheetData/>",a["!links"]=[],a["!ref"]!=null&&(o=fW(a,t),o.length>0&&(i[i.length]=o)),i.length>l+1&&(i[i.length]="</sheetData>",i[l]=i[l].replace("/>",">")),a["!protect"]&&(i[i.length]=Qz(a["!protect"])),a["!autofilter"]!=null&&(i[i.length]=sW(a["!autofilter"],a,r,e)),a["!merges"]!=null&&a["!merges"].length>0&&(i[i.length]=Gz(a["!merges"]));var d=-1,u,p=-1;return a["!links"].length>0&&(i[i.length]="<hyperlinks>",a["!links"].forEach(function(m){m[1].Target&&(u={ref:m[0]},m[1].Target.charAt(0)!="#"&&(p=Sr(n,-1,Tr(m[1].Target).replace(/#.*$/,""),or.HLINK),u["r:id"]="rId"+p),(d=m[1].Target.indexOf("#"))>-1&&(u.location=Tr(m[1].Target.slice(d+1))),m[1].Tooltip&&(u.tooltip=Tr(m[1].Tooltip)),i[i.length]=xt("hyperlink",null,u))}),i[i.length]="</hyperlinks>"),delete a["!links"],a["!margins"]!=null&&(i[i.length]=tW(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=gi("ignoredErrors",xt("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(p=Sr(n,-1,"../drawings/drawing"+(e+1)+".xml",or.DRAW),i[i.length]=xt("drawing",null,{"r:id":"rId"+p}),a["!drawing"]=h),a["!comments"].length>0&&(p=Sr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",or.VML),i[i.length]=xt("legacyDrawing",null,{"r:id":"rId"+p}),a["!legacy"]=p),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function hW(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function dW(e,t,r){var n=Ze(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=Dd(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var l=0;i.level&&(l|=i.level),i.hidden&&(l|=16),(i.hpx||i.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var o=0,a=n.l;n.l+=4;for(var c={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var h=-1,d=-1,u=f<<10;u<f+1<<10;++u){c.c=u;var p=Array.isArray(r)?(r[c.r]||[])[c.c]:r[$t(c)];p&&(h<0&&(h=u),d=u)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,d))}var m=n.l;return n.l=a,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function pW(e,t,r,n){var i=dW(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&lt(e,0,i)}var gW=Jc,mW=Pf;function xW(){}function vW(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=b7(e),r}function yW(e,t,r){r==null&&(r=Ze(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Ag({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),VC(e,r),r.slice(0,r.l)}function wW(e){var t=ea(e);return[t]}function bW(e,t,r){return r==null&&(r=Ze(8)),Xc(t,r)}function _W(e){var t=Yc(e);return[t]}function kW(e,t,r){return r==null&&(r=Ze(4)),Kc(t,r)}function SW(e){var t=ea(e),r=e.read_shift(1);return[t,r,"b"]}function CW(e,t,r){return r==null&&(r=Ze(9)),Xc(t,r),r.write_shift(1,e.v?1:0),r}function EW(e){var t=Yc(e),r=e.read_shift(1);return[t,r,"b"]}function TW(e,t,r){return r==null&&(r=Ze(5)),Kc(t,r),r.write_shift(1,e.v?1:0),r}function NW(e){var t=ea(e),r=e.read_shift(1);return[t,r,"e"]}function AW(e,t,r){return r==null&&(r=Ze(9)),Xc(t,r),r.write_shift(1,e.v),r}function OW(e){var t=Yc(e),r=e.read_shift(1);return[t,r,"e"]}function jW(e,t,r){return r==null&&(r=Ze(8)),Kc(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function PW(e){var t=ea(e),r=e.read_shift(4);return[t,r,"s"]}function FW(e,t,r){return r==null&&(r=Ze(12)),Xc(t,r),r.write_shift(4,t.v),r}function DW(e){var t=Yc(e),r=e.read_shift(4);return[t,r,"s"]}function LW(e,t,r){return r==null&&(r=Ze(8)),Kc(t,r),r.write_shift(4,t.v),r}function IW(e){var t=ea(e),r=ji(e);return[t,r,"n"]}function MW(e,t,r){return r==null&&(r=Ze(16)),Xc(t,r),Rc(e.v,r),r}function JE(e){var t=Yc(e),r=ji(e);return[t,r,"n"]}function RW(e,t,r){return r==null&&(r=Ze(12)),Kc(t,r),Rc(e.v,r),r}function BW(e){var t=ea(e),r=wy(e);return[t,r,"n"]}function UW(e,t,r){return r==null&&(r=Ze(12)),Xc(t,r),GC(e.v,r),r}function zW(e){var t=Yc(e),r=wy(e);return[t,r,"n"]}function WW(e,t,r){return r==null&&(r=Ze(8)),Kc(t,r),GC(e.v,r),r}function HW(e){var t=ea(e),r=xy(e);return[t,r,"is"]}function $W(e){var t=ea(e),r=Pi(e);return[t,r,"str"]}function qW(e,t,r){return r==null&&(r=Ze(12+4*e.v.length)),Xc(t,r),ri(e.v,r),r.length>r.l?r.slice(0,r.l):r}function VW(e){var t=Yc(e),r=Pi(e);return[t,r,"str"]}function GW(e,t,r){return r==null&&(r=Ze(8+4*e.v.length)),Kc(t,r),ri(e.v,r),r.length>r.l?r.slice(0,r.l):r}function XW(e,t,r){var n=e.l+t,i=ea(e);i.r=r["!row"];var s=e.read_shift(1),l=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=hm(e,n-e.l,r);l[3]=Ni(o,null,i,r.supbooks,r)}else e.l=n;return l}function YW(e,t,r){var n=e.l+t,i=ea(e);i.r=r["!row"];var s=e.read_shift(1),l=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=hm(e,n-e.l,r);l[3]=Ni(o,null,i,r.supbooks,r)}else e.l=n;return l}function KW(e,t,r){var n=e.l+t,i=ea(e);i.r=r["!row"];var s=ji(e),l=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=hm(e,n-e.l,r);l[3]=Ni(o,null,i,r.supbooks,r)}else e.l=n;return l}function JW(e,t,r){var n=e.l+t,i=ea(e);i.r=r["!row"];var s=Pi(e),l=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=hm(e,n-e.l,r);l[3]=Ni(o,null,i,r.supbooks,r)}else e.l=n;return l}var QW=Jc,ZW=Pf;function eH(e,t){return t==null&&(t=Ze(4)),t.write_shift(4,e),t}function tH(e,t){var r=e.l+t,n=Jc(e),i=vy(e),s=Pi(e),l=Pi(e),o=Pi(e);e.l=r;var a={rfx:n,relId:i,loc:s,display:o};return l&&(a.Tooltip=l),a}function rH(e,t){var r=Ze(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Pf({s:tn(e[0]),e:tn(e[0])},r),yy("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return ri(i||"",r),ri(e[1].Tooltip||"",r),ri("",r),r.slice(0,r.l)}function nH(){}function iH(e,t,r){var n=e.l+t,i=XC(e),s=e.read_shift(1),l=[i];if(l[2]=s,r.cellFormula){var o=Nz(e,n-e.l,r);l[1]=o}else e.l=n;return l}function sH(e,t,r){var n=e.l+t,i=Jc(e),s=[i];if(r.cellFormula){var l=Oz(e,n-e.l,r);s[1]=l,e.l=n}else e.l=n;return s}function aH(e,t,r){r==null&&(r=Ze(18));var n=dm(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var QE=["left","right","top","bottom","header","footer"];function oH(e){var t={};return QE.forEach(function(r){t[r]=ji(e)}),t}function lH(e,t){return t==null&&(t=Ze(6*8)),Nc(e),QE.forEach(function(r){Rc(e[r],t)}),t}function cH(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function uH(e,t,r){r==null&&(r=Ze(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function fH(e){var t=Ze(24);return t.write_shift(4,4),t.write_shift(4,1),Pf(e,t),t}function hH(e,t){return t==null&&(t=Ze(16*4+2)),t.write_shift(2,e.password?Ey(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function dH(){}function pH(){}function gH(e,t,r,n,i,s,l){if(!e)return e;var o=t||{};n||(n={"!id":{}});var a=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,u,p,m,g,x,y,w,b,S,T=[];o.biff=12,o["!row"]=0;var O=0,j=!1,L=[],W={},F=o.supbooks||i.supbooks||[[]];if(F.sharedf=W,F.arrayf=L,F.SheetNames=i.SheetNames||i.Sheets.map(function(K){return K.name}),!o.supbooks&&(o.supbooks=F,i.Names))for(var M=0;M<i.Names.length;++M)F[0][M+1]=i.Names[M];var V=[],G=[],te=!1;Ld[16]={n:"BrtShortReal",f:JE};var ee;if(Wo(e,function(N,U,R){if(!d)switch(R){case 148:c=N;break;case 0:u=N,o.sheetRows&&o.sheetRows<=u.r&&(d=!0),b=Tn(g=u.r),o["!row"]=u.r,(N.hidden||N.hpt||N.level!=null)&&(N.hpt&&(N.hpx=bf(N.hpt)),G[N.r]=N);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:N[2]},N[2]){case"n":p.v=N[1];break;case"s":w=Wh[N[1]],p.v=w.t,p.r=w.r;break;case"b":p.v=!!N[1];break;case"e":p.v=N[1],o.cellText!==!1&&(p.w=Ho[p.v]);break;case"str":p.t="s",p.v=N[1];break;case"is":p.t="s",p.v=N[1].t;break}if((m=l.CellXf[N[0].iStyleRef])&&XE(p,m.numFmtId,null,o,s,l),x=N[0].c==-1?x+1:N[0].c,o.dense?(a[g]||(a[g]=[]),a[g][x]=p):a[en(x)+b]=p,o.cellFormula){for(j=!1,O=0;O<L.length;++O){var k=L[O];u.r>=k[0].s.r&&u.r<=k[0].e.r&&x>=k[0].s.c&&x<=k[0].e.c&&(p.F=tr(k[0]),j=!0)}!j&&N.length>3&&(p.f=N[3])}if(f.s.r>u.r&&(f.s.r=u.r),f.s.c>x&&(f.s.c=x),f.e.r<u.r&&(f.e.r=u.r),f.e.c<x&&(f.e.c=x),o.cellDates&&m&&p.t=="n"&&Af(zt[m.numFmtId])){var P=bc(p.v);P&&(p.t="d",p.v=new Date(P.y,P.m-1,P.d,P.H,P.M,P.S,P.u))}ee&&(ee.type=="XLDAPR"&&(p.D=!0),ee=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;p={t:"z",v:void 0},x=N[0].c==-1?x+1:N[0].c,o.dense?(a[g]||(a[g]=[]),a[g][x]=p):a[en(x)+b]=p,f.s.r>u.r&&(f.s.r=u.r),f.s.c>x&&(f.s.c=x),f.e.r<u.r&&(f.e.r=u.r),f.e.c<x&&(f.e.c=x),ee&&(ee.type=="XLDAPR"&&(p.D=!0),ee=void 0);break;case 176:T.push(N);break;case 49:ee=((o.xlmeta||{}).Cell||[])[N-1];break;case 494:var A=n["!id"][N.relId];for(A?(N.Target=A.Target,N.loc&&(N.Target+="#"+N.loc),N.Rel=A):N.relId==""&&(N.Target="#"+N.loc),g=N.rfx.s.r;g<=N.rfx.e.r;++g)for(x=N.rfx.s.c;x<=N.rfx.e.c;++x)o.dense?(a[g]||(a[g]=[]),a[g][x]||(a[g][x]={t:"z",v:void 0}),a[g][x].l=N):(y=$t({c:x,r:g}),a[y]||(a[y]={t:"z",v:void 0}),a[y].l=N);break;case 426:if(!o.cellFormula)break;L.push(N),S=o.dense?a[g][x]:a[en(x)+b],S.f=Ni(N[1],f,{r:u.r,c:x},F,o),S.F=tr(N[0]);break;case 427:if(!o.cellFormula)break;W[$t(N[0].s)]=N[1],S=o.dense?a[g][x]:a[en(x)+b],S.f=Ni(N[1],f,{r:u.r,c:x},F,o);break;case 60:if(!o.cellStyles)break;for(;N.e>=N.s;)V[N.e--]={width:N.w/256,hidden:!!(N.flags&1),level:N.level},te||(te=!0,Ty(N.w/256)),Ml(V[N.e+1]);break;case 161:a["!autofilter"]={ref:tr(N)};break;case 476:a["!margins"]=N;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),N.name&&(i.Sheets[r].CodeName=N.name),(N.above||N.left)&&(a["!outline"]={above:N.above,left:N.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),N.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!U.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+R.toString(16))}}},o),delete o.supbooks,delete o["!row"],!a["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(a["!ref"]=tr(c||f)),o.sheetRows&&a["!ref"]){var Q=mr(a["!ref"]);o.sheetRows<=+Q.e.r&&(Q.e.r=o.sheetRows-1,Q.e.r>f.e.r&&(Q.e.r=f.e.r),Q.e.r<Q.s.r&&(Q.s.r=Q.e.r),Q.e.c>f.e.c&&(Q.e.c=f.e.c),Q.e.c<Q.s.c&&(Q.s.c=Q.e.c),a["!fullref"]=a["!ref"],a["!ref"]=tr(Q))}return T.length>0&&(a["!merges"]=T),V.length>0&&(a["!cols"]=V),G.length>0&&(a["!rows"]=G),a}function mH(e,t,r,n,i,s,l){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Vr(t),t.z=t.z||zt[14],t.v=Kn(qr(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var a={r,c:n};switch(a.s=ql(i.cellXfs,t,i),t.l&&s["!links"].push([$t(a),t.l]),t.c&&s["!comments"].push([$t(a),t.c]),t.t){case"s":case"str":return i.bookSST?(o=Py(i.Strings,t.v,i.revStrings),a.t="s",a.v=o,l?lt(e,18,LW(t,a)):lt(e,7,FW(t,a))):(a.t="str",l?lt(e,17,GW(t,a)):lt(e,6,qW(t,a))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?lt(e,13,WW(t,a)):lt(e,2,UW(t,a)):l?lt(e,16,RW(t,a)):lt(e,5,MW(t,a)),!0;case"b":return a.t="b",l?lt(e,15,TW(t,a)):lt(e,4,CW(t,a)),!0;case"e":return a.t="e",l?lt(e,14,jW(t,a)):lt(e,3,AW(t,a)),!0}return l?lt(e,12,kW(t,a)):lt(e,1,bW(t,a)),!0}function xH(e,t,r,n){var i=mr(t["!ref"]||"A1"),s,l="",o=[];lt(e,145);var a=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var f=i.s.r;f<=c;++f){l=Tn(f),pW(e,t,i,f);var h=!1;if(f<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){f===i.s.r&&(o[d]=en(d)),s=o[d]+l;var u=a?(t[f]||[])[d]:t[s];if(!u){h=!1;continue}h=mH(e,u,f,d,n,t,h)}}lt(e,146)}function vH(e,t){!t||!t["!merges"]||(lt(e,177,eH(t["!merges"].length)),t["!merges"].forEach(function(r){lt(e,176,ZW(r))}),lt(e,178))}function yH(e,t){!t||!t["!cols"]||(lt(e,390),t["!cols"].forEach(function(r,n){r&&lt(e,60,aH(n,r))}),lt(e,391))}function wH(e,t){!t||!t["!ref"]||(lt(e,648),lt(e,649,fH(mr(t["!ref"]))),lt(e,650))}function bH(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=Sr(r,-1,n[1].Target.replace(/#.*$/,""),or.HLINK);lt(e,494,rH(n,i))}}),delete t["!links"]}function _H(e,t,r,n){if(t["!comments"].length>0){var i=Sr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",or.VML);lt(e,551,yy("rId"+i)),t["!legacy"]=i}}function kH(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:tr(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=ss(s);o.s.r==o.e.r&&(o.e.r=ss(t["!ref"]).e.r,s=tr(o));for(var a=0;a<l.length;++a){var c=l[a];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}a==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),lt(e,161,Pf(mr(s))),lt(e,162)}}function SH(e,t,r){lt(e,133),lt(e,137,uH(t,r)),lt(e,138),lt(e,134)}function CH(e,t){t["!protect"]&&lt(e,535,hH(t["!protect"]))}function EH(e,t,r,n){var i=is(),s=r.SheetNames[e],l=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var a=mr(l["!ref"]||"A1");if(a.e.c>16383||a.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");a.e.c=Math.min(a.e.c,16383),a.e.r=Math.min(a.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],lt(i,129),(r.vbaraw||l["!outline"])&&lt(i,147,yW(o,l["!outline"])),lt(i,148,mW(a)),SH(i,l,r.Workbook),yH(i,l),xH(i,l,e,t),CH(i,l),kH(i,l,r,e),vH(i,l),bH(i,l,n),l["!margins"]&&lt(i,476,lH(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&wH(i,l),_H(i,l,e,n),lt(i,130),i.end()}function TH(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var i=gr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function NH(e,t,r,n,i,s){var l=s||{"!type":"chart"};if(!e)return s;var o=0,a=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=TH(h);f.s.r=f.s.c=0,f.e.c=o,c=en(o),d[0].forEach(function(u,p){l[c+Tn(p)]={t:"n",v:u,z:d[1]},a=p}),f.e.r<a&&(f.e.r=a),++o}),o>0&&(l["!ref"]=tr(f)),l}function AH(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,o=e.match(YE);return o&&Fy(o[0],s,i,r),(l=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function OH(e,t){e.l+=10;var r=Pi(e);return{name:r}}function jH(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Wo(e,function(a,c,f){switch(f){case 550:s["!rel"]=a;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),a.name&&(i.Sheets[r].CodeName=a.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var Dy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],PH=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],FH=[],DH=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Sk(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=zr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function Ck(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=zr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function ZE(e){Ck(e.WBProps,Dy),Ck(e.CalcPr,DH),Sk(e.WBView,PH),Sk(e.Sheets,FH),of.date1904=zr(e.WBProps.date1904)}function LH(e){return!e.Workbook||!e.Workbook.WBProps?"false":zr(e.Workbook.WBProps.date1904)?"true":"false"}var IH="][*?/\\".split("");function eT(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return IH.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function MH(e,t,r){e.forEach(function(n,i){eT(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=t&&t[i]&&t[i].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function RH(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];MH(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Lz(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var BH=/<\w+:workbook/;function UH(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},l=0;if(e.replace(Li,function(a,c){var f=Gt(a);switch(eo(f[0])){case"<?xml":break;case"<workbook":a.match(BH)&&(i="xmlns"+a.match(/<(\w+):/)[1]),r.xmlns=f[i];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Dy.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=zr(f[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:r.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(r.WBProps.CodeName=Or(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=gr(Or(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Or(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),zr(f.hidden||"0")&&(s.Hidden=!0),l=c+a.length;break;case"</definedName>":s.Ref=gr(Or(e.slice(l,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return a}),Gc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return ZE(r),r}function tT(e){var t=[Nn];t[t.length]=xt("workbook",null,{xmlns:Gc[0],"xmlns:r":Xn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Dy.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=xt("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var l={name:Tr(e.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=xt("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var a={name:o.Name};o.Comment&&(a.comment=o.Comment),o.Sheet!=null&&(a.localSheetId=""+o.Sheet),o.Hidden&&(a.hidden="1"),o.Ref&&(t[t.length]=xt("definedName",Tr(o.Ref),a))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function zH(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Dv(e),r.name=Pi(e),r}function WH(e,t){return t||(t=Ze(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),yy(e.strRelID,t),ri(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function HH(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Pi(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function $H(e,t){t||(t=Ze(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),VC(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function qH(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function VH(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=_7(e),l=Az(e,0,r),o=vy(e);e.l=n;var a={Name:s,Ptg:l};return i<268435455&&(a.Sheet=i),o&&(a.Comment=o),a}function GH(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],Ld[16]={n:"BrtFRTArchID$",f:qH},Wo(e,function(a,c,f){switch(f){case 156:l.SheetNames.push(a.name),r.Sheets.push(a);break;case 153:r.WBProps=a;break;case 39:a.Sheet!=null&&(t.SID=a.Sheet),a.Ref=Ni(a.Ptg,null,null,l,t),delete t.SID,delete a.Ptg,s.push(a);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([f,a]):l[0]=[f,a],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(a),l.XTI=l.XTI.concat(a);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(f),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),ZE(r),r.Names=s,r.supbooks=l,r}function XH(e,t){lt(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};lt(e,156,WH(i))}lt(e,144)}function YH(e,t){t||(t=Ze(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return ri("SheetJS",t),ri(_g.version,t),ri(_g.version,t),ri("7262",t),t.length>t.l?t.slice(0,t.l):t}function KH(e,t){t||(t=Ze(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function JH(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(lt(e,135),lt(e,158,KH(i)),lt(e,136))}}function QH(e,t){var r=is();return lt(r,131),lt(r,128,YH()),lt(r,153,$H(e.Workbook&&e.Workbook.WBProps||null)),JH(r,e),XH(r,e),lt(r,132),r.end()}function ZH(e,t,r){return t.slice(-4)===".bin"?GH(e,r):UH(e,r)}function e$(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?gH(e,n,r,i,s,l,o):Vz(e,n,r,i,s,l,o)}function t$(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?jH(e,n,r,i,s):AH(e,n,r,i,s)}function r$(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?iU():sU()}function n$(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?rU():nU()}function i$(e,t,r,n){return t.slice(-4)===".bin"?Z9(e,r,n):z9(e,r,n)}function s$(e,t,r){return LE(e,r)}function a$(e,t,r){return t.slice(-4)===".bin"?a9(e,r):n9(e,r)}function o$(e,t,r){return t.slice(-4)===".bin"?JB(e,r):WB(e,r)}function l$(e,t,r){return t.slice(-4)===".bin"?BB(e):MB(e)}function c$(e,t,r,n){return r.slice(-4)===".bin"?UB(e,t,r,n):void 0}function u$(e,t,r){return t.slice(-4)===".bin"?DB(e,t,r):IB(e,t,r)}function f$(e,t,r){return(t.slice(-4)===".bin"?QH:tT)(e)}function h$(e,t,r,n,i){return(t.slice(-4)===".bin"?EH:KE)(e,r,n,i)}function d$(e,t,r){return(t.slice(-4)===".bin"?cB:FE)(e,r)}function p$(e,t,r){return(t.slice(-4)===".bin"?c9:CE)(e,r)}function g$(e,t,r){return(t.slice(-4)===".bin"?QB:RE)(e)}function m$(e){return(e.slice(-4)===".bin"?LB:IE)()}var rT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,nT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ua(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(rT),s,l,o,a;if(i)for(a=0;a!=i.length;++a)s=i[a].match(nT),(l=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(l+1),n[o]=s[2].slice(1,s[2].length-1));return n}function x$(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(rT),i,s,l,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(nT),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(s+1),r[l]=i[2].slice(1,i[2].length-1));return r}var $h;function v$(e,t){var r=$h[e]||gr(e);return r==="General"?Ic(t):Zs(r,t)}function y$(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=zr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=qr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[gr(t)]=i}function w$(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ho[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ed(e.v):e.w=Ic(e.v):e.w=v$(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=$h[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Af(n)){var i=bc(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function b$(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=F9[n.Pattern]||n.Pattern)}e[t.ID]=t}function _$(e,t,r,n,i,s,l,o,a,c){var f="General",h=n.StyleID,d={};c=c||{};var u=[],p=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&l&&(h=l.StyleID);s[h]!==void 0&&(s[h].nf&&(f=s[h].nf),s[h].Interior&&u.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=zr(e);break;case"String":n.t="s",n.r=W5(gr(e)),n.v=e.indexOf("<")>-1?gr(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(qr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=gr(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=JC[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=W5(t||e));break}if(w$(n,f,c),c.cellFormula!==!1)if(n.Formula){var m=gr(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=af(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=af("RC:RC",i):n.ArrayRange&&(n.F=af(n.ArrayRange,i),a.push([mr(n.F),n.F]))}else for(p=0;p<a.length;++p)i.r>=a[p][0].s.r&&i.r<=a[p][0].e.r&&i.c>=a[p][0].s.c&&i.c<=a[p][0].e.c&&(n.F=a[p][1]);c.cellStyles&&(u.forEach(function(g){!d.patternType&&g.patternType&&(d.patternType=g.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function k$(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ox(e,t){var r=t||{};Of();var n=_h(hy(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Or(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var l=Vr(r);return l.type="string",wf.to_workbook(n,l)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(we){i.indexOf("<"+we)>=0&&(s=!0)}),s)return lq(n,r);$h={"General Number":"General","General Date":zt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":zt[15],"Short Date":zt[14],"Long Time":zt[19],"Medium Time":zt[18],"Short Time":zt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:zt[2],Standard:zt[4],Percent:zt[10],Scientific:zt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,a=[],c,f={},h=[],d=r.dense?[]:{},u="",p={},m={},g=ua('<Data ss:Type="String">'),x=0,y=0,w=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},S={},T={},O="",j=0,L=[],W={},F={},M=0,V=[],G=[],te={},ee=[],Q,K=!1,N=[],U=[],R={},k=0,P=0,A={Sheets:[],WBProps:{date1904:!1}},E={};Ad.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var I="";o=Ad.exec(n);)switch(o[3]=(I=o[3]).toLowerCase()){case"data":if(I=="data"){if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&a.push([o[3],!0]);break}if(a[a.length-1][1])break;o[1]==="/"?_$(n.slice(x,o.index),O,g,a[a.length-1][0]=="comment"?te:p,{c:y,r:w},S,ee[y],m,N,r):(O="",g=ua(o[0]),x=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(G.length>0&&(p.c=G),(!r.sheetRows||r.sheetRows>w)&&p.v!==void 0&&(r.dense?(d[w]||(d[w]=[]),d[w][y]=p):d[en(y)+Tn(w)]=p),p.HRef&&(p.l={Target:gr(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(k=y+(parseInt(p.MergeAcross,10)|0),P=w+(parseInt(p.MergeDown,10)|0),L.push({s:{c:y,r:w},e:{c:k,r:P}})),!r.sheetStubs)p.MergeAcross?y=k+1:++y;else if(p.MergeAcross||p.MergeDown){for(var H=y;H<=k;++H)for(var J=w;J<=P;++J)(H>y||J>w)&&(r.dense?(d[J]||(d[J]=[]),d[J][H]={t:"z"}):d[en(H)+Tn(J)]={t:"z"});y=k+1}else++y;else p=x$(o[0]),p.Index&&(y=+p.Index-1),y<b.s.c&&(b.s.c=y),y>b.e.c&&(b.e.c=y),o[0].slice(-2)==="/>"&&++y,G=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<b.s.r&&(b.s.r=w),w>b.e.r&&(b.e.r=w),o[0].slice(-2)==="/>"&&(m=ua(o[0]),m.Index&&(w=+m.Index-1)),y=0,++w):(m=ua(o[0]),m.Index&&(w=+m.Index-1),R={},(m.AutoFitHeight=="0"||m.Height)&&(R.hpx=parseInt(m.Height,10),R.hpt=Dd(R.hpx),U[w]=R),m.Hidden=="1"&&(R.hidden=!0,U[w]=R));break;case"worksheet":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(u),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(d["!ref"]=tr(b),r.sheetRows&&r.sheetRows<=b.e.r&&(d["!fullref"]=d["!ref"],b.e.r=r.sheetRows-1,d["!ref"]=tr(b))),L.length&&(d["!merges"]=L),ee.length>0&&(d["!cols"]=ee),U.length>0&&(d["!rows"]=U),f[u]=d}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=y=0,a.push([o[3],!1]),c=ua(o[0]),u=gr(c.Name),d=r.dense?[]:{},L=[],N=[],U=[],E={name:u,Hidden:0},A.Sheets.push(E);break;case"table":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;a.push([o[3],!1]),ee=[],K=!1}break;case"style":o[1]==="/"?b$(S,T,r):T=ua(o[0]);break;case"numberformat":T.nf=gr(ua(o[0]).Format||"General"),$h[T.nf]&&(T.nf=$h[T.nf]);for(var Y=0;Y!=392&&zt[Y]!=T.nf;++Y);if(Y==392){for(Y=57;Y!=392;++Y)if(zt[Y]==null){Ao(T.nf,Y);break}}break;case"column":if(a[a.length-1][0]!=="table")break;if(Q=ua(o[0]),Q.Hidden&&(Q.hidden=!0,delete Q.Hidden),Q.Width&&(Q.wpx=parseInt(Q.Width,10)),!K&&Q.wpx>10){K=!0,Oi=jE;for(var Z=0;Z<ee.length;++Z)ee[Z]&&Ml(ee[Z])}K&&Ml(Q),ee[Q.Index-1||ee.length]=Q;for(var fe=0;fe<+Q.Span;++fe)ee[ee.length]=Vr(Q);break;case"namedrange":if(o[1]==="/")break;A.Names||(A.Names=[]);var X=Gt(o[0]),re={Name:X.Name,Ref:af(X.RefersTo.slice(1),{r:0,c:0})};A.Sheets.length>0&&(re.Sheet=A.Sheets.length-1),A.Names.push(re);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?O+=n.slice(j,o.index):j=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;T.Interior=ua(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?G7(W,I,n.slice(M,o.index)):M=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else a.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));k$(te),G.push(te)}else a.push([o[3],!1]),c=ua(o[0]),te={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var se=ua(o[0]);d["!autofilter"]={ref:af(se.Range).replace(/\$/g,"")},a.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&a.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&a.push([o[3],!0]);break;case"null":break;default:if(a.length==0&&o[3]=="document"||a.length==0&&o[3]=="uof")return Ok(n,r);var z=!0;switch(a[a.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:z=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:z=!1}break;case"excelworkbook":switch(o[3]){case"date1904":A.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:z=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:z=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(M,o.index)){case"SheetHidden":E.Hidden=1;break;case"SheetVeryHidden":E.Hidden=2;break}else M=o.index+o[0].length;break;case"header":d["!margins"]||Nc(d["!margins"]={},"xlml"),isNaN(+Gt(o[0]).Margin)||(d["!margins"].header=+Gt(o[0]).Margin);break;case"footer":d["!margins"]||Nc(d["!margins"]={},"xlml"),isNaN(+Gt(o[0]).Margin)||(d["!margins"].footer=+Gt(o[0]).Margin);break;case"pagemargins":var oe=Gt(o[0]);d["!margins"]||Nc(d["!margins"]={},"xlml"),isNaN(+oe.Top)||(d["!margins"].top=+oe.Top),isNaN(+oe.Left)||(d["!margins"].left=+oe.Left),isNaN(+oe.Right)||(d["!margins"].right=+oe.Right),isNaN(+oe.Bottom)||(d["!margins"].bottom=+oe.Bottom);break;case"displayrighttoleft":A.Views||(A.Views=[]),A.Views[0]||(A.Views[0]={}),A.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:z=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:z=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:z=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:z=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:z=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:z=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:z=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:z=!1}break;case"smarttags":break;default:z=!1;break}if(z||o[3].match(/!\[CDATA/))break;if(!a[a.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+a.join("|");if(a[a.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?y$(F,I,V,n.slice(M,o.index)):(V=o,M=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+a.join("|")}var ce={};return!r.bookSheets&&!r.bookProps&&(ce.Sheets=f),ce.SheetNames=h,ce.Workbook=A,ce.SSF=Vr(zt),ce.Props=W,ce.Custprops=F,ce}function zv(e,t){switch(Iy(t=t||{}),t.type||"base64"){case"base64":return ox(Os(e),t);case"binary":case"buffer":case"file":return ox(e,t);case"array":return ox(Hl(e),t)}}function S$(e,t){var r=[];return e.Props&&r.push(X7(e.Props,t)),e.Custprops&&r.push(Y7(e.Props,e.Custprops)),r.join("")}function C$(){return""}function E$(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(xt("NumberFormat",null,{"ss:Format":Tr(zt[n.numFmtId])}));var l={"ss:ID":"s"+(21+i)};r.push(xt("Style",s.join(""),l))}),xt("Styles",r.join(""))}function iT(e){return xt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Oy(e.Ref,{r:0,c:0})})}function T$(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(iT(i)))}return xt("Names",r.join(""))}function N$(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],l=0;l<i.length;++l){var o=i[l];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(iT(o)))}return s.join("")}function A$(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(xt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(xt("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(xt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(xt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(gi("ProtectContents","True")),e["!protect"].objects&&i.push(gi("ProtectObjects","True")),e["!protect"].scenarios&&i.push(gi("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(gi("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(gi("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&i.push("<"+l[1]+"/>")})),i.length==0?"":xt("WorksheetOptions",i.join(""),{xmlns:vs.x})}function O$(e){return e.map(function(t){var r=JI(t.t||""),n=xt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return xt("Comment",n,{"ss:Author":t.a})}).join("")}function j$(e,t,r,n,i,s,l){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Tr(Oy(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var a=tn(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(a.r==l.r?"":"["+(a.r-l.r)+"]")+"C"+(a.c==l.c?"":"["+(a.c-l.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Tr(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Tr(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],f=0;f!=c.length;++f)c[f].s.c!=l.c||c[f].s.r!=l.r||(c[f].e.c>c[f].s.c&&(o["ss:MergeAcross"]=c[f].e.c-c[f].s.c),c[f].e.r>c[f].s.r&&(o["ss:MergeDown"]=c[f].e.r-c[f].s.r));var h="",d="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",d=String(e.v);break;case"b":h="Boolean",d=e.v?"1":"0";break;case"e":h="Error",d=Ho[e.v];break;case"d":h="DateTime",d=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||zt[14]);break;case"s":h="String",d=KI(e.v||"");break}var u=ql(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+u),o["ss:Index"]=l.c+1;var p=e.v!=null?d:"",m=e.t=="z"?"":'<Data ss:Type="'+h+'">'+p+"</Data>";return(e.c||[]).length>0&&(m+=O$(e.c)),xt("Cell",m,o)}function P$(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=bf(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function F$(e,t,r,n){if(!e["!ref"])return"";var i=mr(e["!ref"]),s=e["!merges"]||[],l=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,x){Ml(g);var y=!!g.width,w=dm(x,g),b={"ss:Index":x+1};y&&(b["ss:Width"]=Pd(w.width)),g.hidden&&(b["ss:Hidden"]="1"),o.push(xt("Column",null,b))});for(var a=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var f=[P$(c,(e["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var d=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>h)&&!(s[l].s.r>c)&&!(s[l].e.c<h)&&!(s[l].e.r<c)){(s[l].s.c!=h||s[l].s.r!=c)&&(d=!0);break}if(!d){var u={r:c,c:h},p=$t(u),m=a?(e[c]||[])[h]:e[p];f.push(j$(m,p,e,t,r,n,u))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function D$(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],l=s?N$(s,t,e,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=s?F$(s,t,e,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(A$(s,t,e,r)),n.join("")}function L$(e,t){t||(t={}),e.SSF||(e.SSF=Vr(zt)),e.SSF&&(Of(),am(e.SSF),t.revssf=lm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ql(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(S$(e,t)),r.push(C$()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(xt("Worksheet",D$(n,t,e),{"ss:Name":Tr(e.SheetNames[n])}));return r[2]=E$(e,t),r[3]=T$(e),Nn+xt("Workbook",r.join(""),{xmlns:vs.ss,"xmlns:o":vs.o,"xmlns:x":vs.x,"xmlns:ss":vs.ss,"xmlns:dt":vs.dt,"xmlns:html":vs.html})}function I$(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=T7(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=N7(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var M$=[60,1084,2066,2165,2175];function R$(e,t,r,n,i){var s=n,l=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}l.push(o),r.l+=s;for(var a=Eo(r,r.l),c=Wv[a],f=0;c!=null&&M$.indexOf(a)>-1;)s=Eo(r,r.l+2),f=r.l+4,a==2066?f+=4:(a==2165||a==2175)&&(f+=12),o=r.slice(f,r.l+4+s),l.push(o),r.l+=4+s,c=Wv[a=Eo(r,r.l)];var h=ti(l);pi(h,0);var d=0;h.lens=[];for(var u=0;u<l.length;++u)h.lens.push(d),d+=l[u].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,i)}function La(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=zt[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ho[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ed(e.v):e.w=Ic(e.v):e.w=Zs(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&Af(zt[n]||String(n))){var i=bc(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function yp(e,t,r){return{v:e,ixfe:t,t:r}}function B$(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},l={},o=null,a=[],c="",f={},h,d="",u,p,m,g,x={},y=[],w,b,S=[],T=[],O={Sheets:[],WBProps:{date1904:!1},Views:[{}]},j={},L=function(Oe){return Oe<8?Cc[Oe]:Oe<64&&T[Oe-8]||Cc[Oe]},W=function(Oe,De,Ye){var it=De.XF.data;if(!(!it||!it.patternType||!Ye||!Ye.cellStyles)){De.s={},De.s.patternType=it.patternType;var Ke;(Ke=jd(L(it.icvFore)))&&(De.s.fgColor={rgb:Ke}),(Ke=jd(L(it.icvBack)))&&(De.s.bgColor={rgb:Ke})}},F=function(Oe,De,Ye){if(!(R>1)&&!(Ye.sheetRows&&Oe.r>=Ye.sheetRows)){if(Ye.cellStyles&&De.XF&&De.XF.data&&W(Oe,De,Ye),delete De.ixfe,delete De.XF,h=Oe,d=$t(Oe),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Oe.r<l.s.r&&(l.s.r=Oe.r),Oe.c<l.s.c&&(l.s.c=Oe.c),Oe.r+1>l.e.r&&(l.e.r=Oe.r+1),Oe.c+1>l.e.c&&(l.e.c=Oe.c+1),Ye.cellFormula&&De.f){for(var it=0;it<y.length;++it)if(!(y[it][0].s.c>Oe.c||y[it][0].s.r>Oe.r)&&!(y[it][0].e.c<Oe.c||y[it][0].e.r<Oe.r)){De.F=tr(y[it][0]),(y[it][0].s.c!=Oe.c||y[it][0].s.r!=Oe.r)&&delete De.f,De.f&&(De.f=""+Ni(y[it][1],l,Oe,N,M));break}}Ye.dense?(i[Oe.r]||(i[Oe.r]=[]),i[Oe.r][Oe.c]=De):i[d]=De}},M={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(M.password=t.password);var V,G=[],te=[],ee=[],Q=[],K=!1,N=[];N.SheetNames=M.snames,N.sharedf=M.sharedf,N.arrayf=M.arrayf,N.names=[],N.XTI=[];var U=0,R=0,k=0,P=[],A=[],E;M.codepage=1200,ma(1200);for(var I=!1;e.l<e.length-1;){var H=e.l,J=e.read_shift(2);if(J===0&&U===10)break;var Y=e.l===e.length?0:e.read_shift(2),Z=Wv[J];if(Z&&Z.f){if(t.bookSheets&&U===133&&J!==133)break;if(U=J,Z.r===2||Z.r==12){var fe=e.read_shift(2);if(Y-=2,!M.enc&&fe!==J&&((fe&255)<<8|fe>>8)!==J)throw new Error("rt mismatch: "+fe+"!="+J);Z.r==12&&(e.l+=10,Y-=10)}var X={};if(J===10?X=Z.f(e,Y,M):X=R$(J,Z,e,Y,M),R==0&&[9,521,1033,2057].indexOf(U)===-1)continue;switch(J){case 34:r.opts.Date1904=O.WBProps.date1904=X;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(M.enc||(e.l=0),M.enc=X,!t.password)throw new Error("File is password-protected");if(X.valid==null)throw new Error("Encryption scheme unsupported");if(!X.valid)throw new Error("Password is incorrect");break;case 92:M.lastuser=X;break;case 66:var re=Number(X);switch(re){case 21010:re=1200;break;case 32768:re=1e4;break;case 32769:re=1252;break}ma(M.codepage=re),I=!0;break;case 317:M.rrtabid=X;break;case 25:M.winlocked=X;break;case 439:r.opts.RefreshAll=X;break;case 12:r.opts.CalcCount=X;break;case 16:r.opts.CalcDelta=X;break;case 17:r.opts.CalcIter=X;break;case 13:r.opts.CalcMode=X;break;case 14:r.opts.CalcPrecision=X;break;case 95:r.opts.CalcSaveRecalc=X;break;case 15:M.CalcRefMode=X;break;case 2211:r.opts.FullCalc=X;break;case 129:X.fDialog&&(i["!type"]="dialog"),X.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),X.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:S.push(X);break;case 430:N.push([X]),N[N.length-1].XTI=[];break;case 35:case 547:N[N.length-1].push(X);break;case 24:case 536:E={Name:X.Name,Ref:Ni(X.rgce,l,null,N,M)},X.itab>0&&(E.Sheet=X.itab-1),N.names.push(E),N[0]||(N[0]=[],N[0].XTI=[]),N[N.length-1].push(X),X.Name=="_xlnm._FilterDatabase"&&X.itab>0&&X.rgce&&X.rgce[0]&&X.rgce[0][0]&&X.rgce[0][0][0]=="PtgArea3d"&&(A[X.itab-1]={ref:tr(X.rgce[0][0][1][2])});break;case 22:M.ExternCount=X;break;case 23:N.length==0&&(N[0]=[],N[0].XTI=[]),N[N.length-1].XTI=N[N.length-1].XTI.concat(X),N.XTI=N.XTI.concat(X);break;case 2196:if(M.biff<8)break;E!=null&&(E.Comment=X[1]);break;case 18:i["!protect"]=X;break;case 19:X!==0&&M.WTF&&console.error("Password verifier: "+X);break;case 133:s[X.pos]=X,M.snames.push(X.name);break;case 10:{if(--R)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,i["!ref"]=tr(l),t.sheetRows&&t.sheetRows<=l.e.r){var se=l.e.r;l.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=tr(l),l.e.r=se}l.e.r++,l.e.c++}G.length>0&&(i["!merges"]=G),te.length>0&&(i["!objects"]=te),ee.length>0&&(i["!cols"]=ee),Q.length>0&&(i["!rows"]=Q),O.Sheets.push(j)}c===""?f=i:n[c]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(M.biff===8&&(M.biff={9:2,521:3,1033:4}[J]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[X.BIFFVer]||8),M.biffguess=X.BIFFVer==0,X.BIFFVer==0&&X.dt==4096&&(M.biff=5,I=!0,ma(M.codepage=28591)),M.biff==8&&X.BIFFVer==0&&X.dt==16&&(M.biff=2),R++)break;if(i=t.dense?[]:{},M.biff<8&&!I&&(I=!0,ma(M.codepage=t.codepage||1252)),M.biff<5||X.BIFFVer==0&&X.dt==4096){c===""&&(c="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var z={pos:e.l-Y,name:c};s[z.pos]=z,M.snames.push(c)}else c=(s[H]||{name:""}).name;X.dt==32&&(i["!type"]="chart"),X.dt==64&&(i["!type"]="macro"),G=[],te=[],M.arrayf=y=[],ee=[],Q=[],K=!1,j={Hidden:(s[H]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[X.r]||[])[X.c]:i[$t({c:X.c,r:X.r})])&&++X.c,w={ixfe:X.ixfe,XF:S[X.ixfe]||{},v:X.val,t:"n"},k>0&&(w.z=P[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F({c:X.c,r:X.r},w,t);break;case 5:case 517:w={ixfe:X.ixfe,XF:S[X.ixfe],v:X.val,t:X.t},k>0&&(w.z=P[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F({c:X.c,r:X.r},w,t);break;case 638:w={ixfe:X.ixfe,XF:S[X.ixfe],v:X.rknum,t:"n"},k>0&&(w.z=P[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F({c:X.c,r:X.r},w,t);break;case 189:for(var oe=X.c;oe<=X.C;++oe){var ce=X.rkrec[oe-X.c][0];w={ixfe:ce,XF:S[ce],v:X.rkrec[oe-X.c][1],t:"n"},k>0&&(w.z=P[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F({c:oe,r:X.r},w,t)}break;case 6:case 518:case 1030:{if(X.val=="String"){o=X;break}if(w=yp(X.val,X.cell.ixfe,X.tt),w.XF=S[w.ixfe],t.cellFormula){var we=X.formula;if(we&&we[0]&&we[0][0]&&we[0][0][0]=="PtgExp"){var ye=we[0][0][1][0],de=we[0][0][1][1],Te=$t({r:ye,c:de});x[Te]?w.f=""+Ni(X.formula,l,X.cell,N,M):w.F=((t.dense?(i[ye]||[])[de]:i[Te])||{}).F}else w.f=""+Ni(X.formula,l,X.cell,N,M)}k>0&&(w.z=P[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F(X.cell,w,t),o=X}break;case 7:case 519:if(o)o.val=X,w=yp(X,o.cell.ixfe,"s"),w.XF=S[w.ixfe],t.cellFormula&&(w.f=""+Ni(o.formula,l,o.cell,N,M)),k>0&&(w.z=P[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F(o.cell,w,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(X);var pe=$t(X[0].s);if(u=t.dense?(i[X[0].s.r]||[])[X[0].s.c]:i[pe],t.cellFormula&&u){if(!o||!pe||!u)break;u.f=""+Ni(X[1],l,X[0],N,M),u.F=tr(X[0])}}break;case 1212:{if(!t.cellFormula)break;if(d){if(!o)break;x[$t(o.cell)]=X[0],u=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[$t(o.cell)],(u||{}).f=""+Ni(X[0],l,h,N,M)}}break;case 253:w=yp(a[X.isst].t,X.ixfe,"s"),a[X.isst].h&&(w.h=a[X.isst].h),w.XF=S[w.ixfe],k>0&&(w.z=P[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F({c:X.c,r:X.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:X.ixfe,XF:S[X.ixfe],t:"z"},k>0&&(w.z=P[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F({c:X.c,r:X.r},w,t));break;case 190:if(t.sheetStubs)for(var Ae=X.c;Ae<=X.C;++Ae){var Ie=X.ixfe[Ae-X.c];w={ixfe:Ie,XF:S[Ie],t:"z"},k>0&&(w.z=P[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F({c:Ae,r:X.r},w,t)}break;case 214:case 516:case 4:w=yp(X.val,X.ixfe,"s"),w.XF=S[w.ixfe],k>0&&(w.z=P[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F({c:X.c,r:X.r},w,t);break;case 0:case 512:R===1&&(l=X);break;case 252:a=X;break;case 1054:if(M.biff==4){P[k++]=X[1];for(var je=0;je<k+163&&zt[je]!=X[1];++je);je>=163&&Ao(X[1],k+163)}else Ao(X[1],X[0]);break;case 30:{P[k++]=X;for(var Le=0;Le<k+163&&zt[Le]!=X;++Le);Le>=163&&Ao(X,k+163)}break;case 229:G=G.concat(X);break;case 93:te[X.cmo[0]]=M.lastobj=X;break;case 438:M.lastobj.TxO=X;break;case 127:M.lastobj.ImData=X;break;case 440:for(g=X[0].s.r;g<=X[0].e.r;++g)for(m=X[0].s.c;m<=X[0].e.c;++m)u=t.dense?(i[g]||[])[m]:i[$t({c:m,r:g})],u&&(u.l=X[1]);break;case 2048:for(g=X[0].s.r;g<=X[0].e.r;++g)for(m=X[0].s.c;m<=X[0].e.c;++m)u=t.dense?(i[g]||[])[m]:i[$t({c:m,r:g})],u&&u.l&&(u.l.Tooltip=X[1]);break;case 28:{if(M.biff<=5&&M.biff>=2)break;u=t.dense?(i[X[0].r]||[])[X[0].c]:i[$t(X[0])];var Xe=te[X[2]];u||(t.dense?(i[X[0].r]||(i[X[0].r]=[]),u=i[X[0].r][X[0].c]={t:"z"}):u=i[$t(X[0])]={t:"z"},l.e.r=Math.max(l.e.r,X[0].r),l.s.r=Math.min(l.s.r,X[0].r),l.e.c=Math.max(l.e.c,X[0].c),l.s.c=Math.min(l.s.c,X[0].c)),u.c||(u.c=[]),p={a:X[1],t:Xe.TxO.t},u.c.push(p)}break;case 2173:EB(S[X.ixfe],X.ext);break;case 125:{if(!M.cellStyles)break;for(;X.e>=X.s;)ee[X.e--]={width:X.w/256,level:X.level||0,hidden:!!(X.flags&1)},K||(K=!0,Ty(X.w/256)),Ml(ee[X.e+1])}break;case 520:{var Je={};X.level!=null&&(Q[X.r]=Je,Je.level=X.level),X.hidden&&(Q[X.r]=Je,Je.hidden=!0),X.hpt&&(Q[X.r]=Je,Je.hpt=X.hpt,Je.hpx=bf(X.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Nc(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[J]]=X;break;case 161:i["!margins"]||Nc(i["!margins"]={}),i["!margins"].header=X.header,i["!margins"].footer=X.footer;break;case 574:X.RTL&&(O.Views[0].RTL=!0);break;case 146:T=X;break;case 2198:V=X;break;case 140:b=X;break;case 442:c?j.CodeName=X||j.name:O.WBProps.CodeName=X||"ThisWorkbook";break}}else Z||console.error("Missing Info for XLS Record 0x"+J.toString(16)),e.l+=Y}return r.SheetNames=pn(s).sort(function(Ne,Oe){return Number(Ne)-Number(Oe)}).map(function(Ne){return s[Ne].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&A.forEach(function(Ne,Oe){r.Sheets[r.SheetNames[Oe]]["!autofilter"]=Ne}),r.Strings=a,r.SSF=Vr(zt),M.enc&&(r.Encryption=M.enc),V&&(r.Themes=V),r.Metadata={},b!==void 0&&(r.Metadata.Country=b),N.names.length>0&&(O.Names=N.names),r.Workbook=O,r}var qh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function U$(e,t,r){var n=Rt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=ak(n,Lv,qh.DSI);for(var s in i)t[s]=i[s]}catch(c){if(r.WTF)throw c}var l=Rt.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var o=ak(l,Iv,qh.SI);for(var a in o)t[a]==null&&(t[a]=o[a])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(nE(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function z$(e,t){var r=[],n=[],i=[],s=0,l,o=I5(Lv,"n"),a=I5(Iv,"n");if(e.Props)for(l=pn(e.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(o,l[s])?r:Object.prototype.hasOwnProperty.call(a,l[s])?n:i).push([l[s],e.Props[l[s]]]);if(e.Custprops)for(l=pn(e.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(o,l[s])?r:Object.prototype.hasOwnProperty.call(a,l[s])?n:i).push([l[s],e.Custprops[l[s]]]);var c=[];for(s=0;s<i.length;++s)uE.indexOf(i[s][0])>-1||rE.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&Rt.utils.cfb_add(t,"/SummaryInformation",ok(n,qh.SI,a,Iv)),(r.length||c.length)&&Rt.utils.cfb_add(t,"/DocumentSummaryInformation",ok(r,qh.DSI,o,Lv,c.length?c:null,qh.UDI))}function sT(e,t){t||(t={}),Iy(t),ny(),t.codepage&&ry(t.codepage);var r,n;if(e.FullPaths){if(Rt.find(e,"/encryption"))throw new Error("File is password-protected");r=Rt.find(e,"!CompObj"),n=Rt.find(e,"/Workbook")||Rt.find(e,"/Book")}else{switch(t.type){case"base64":e=ws(Os(e));break;case"binary":e=ws(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}pi(e,0),n={content:e}}var i,s;if(r&&I$(r),t.bookProps&&!t.bookSheets)i={};else{var l=ar?"buffer":"array";if(n&&n.content)i=B$(n.content,t);else if((s=Rt.find(e,"PerfectOffice_MAIN"))&&s.content)i=Tc.to_workbook(s.content,(t.type=l,t));else if((s=Rt.find(e,"NativeContent_MAIN"))&&s.content)i=Tc.to_workbook(s.content,(t.type=l,t));else throw(s=Rt.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Rt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=eU(e))}var o={};return e.FullPaths&&U$(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}function W$(e,t){var r=t||{},n=Rt.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Rt.utils.cfb_add(n,i,aT(e,r)),r.biff==8&&(e.Props||e.Custprops)&&z$(e,n),r.biff==8&&e.vbaraw&&tU(n,Rt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Ld={0:{f:hW},1:{f:wW},2:{f:BW},3:{f:NW},4:{f:SW},5:{f:IW},6:{f:$W},7:{f:PW},8:{f:JW},9:{f:KW},10:{f:XW},11:{f:YW},12:{f:_W},13:{f:zW},14:{f:OW},15:{f:EW},16:{f:JE},17:{f:VW},18:{f:DW},19:{f:xy},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:VH},40:{},42:{},43:{f:$9},44:{f:W9},45:{f:G9},46:{f:Y9},47:{f:X9},48:{},49:{f:g7},50:{},51:{f:AB},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:bE},62:{f:HW},63:{f:RB},64:{f:dH},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Di,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:cH},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:vW},148:{f:gW,p:16},151:{f:nH},152:{},153:{f:HH},154:{},155:{},156:{f:zH},157:{},158:{},159:{T:1,f:s9},160:{T:-1},161:{T:1,f:Jc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:QW},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:TB},336:{T:-1},337:{f:PB,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Dv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:wE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:iH},427:{f:sH},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:oH},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:xW},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:tH},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Dv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:YB},633:{T:1},634:{T:-1},635:{T:1,f:GB},636:{T:-1},637:{f:y7},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:OH},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:pH},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Wv={6:{f:sx},10:{f:cl},12:{f:In},13:{f:In},14:{f:wn},15:{f:wn},16:{f:ji},17:{f:wn},18:{f:wn},19:{f:In},20:{f:dk},21:{f:dk},23:{f:wE},24:{f:gk},25:{f:wn},26:{},27:{},28:{f:pR},29:{},34:{f:wn},35:{f:pk},38:{f:ji},39:{f:ji},40:{f:ji},41:{f:ji},42:{f:wn},43:{f:wn},47:{f:E9},49:{f:zM},51:{f:In},60:{},61:{f:IM},64:{f:wn},65:{f:UM},66:{f:In},77:{},80:{},81:{},82:{},85:{f:In},89:{},90:{},91:{},92:{f:CM},93:{f:xR},94:{},95:{f:wn},96:{},97:{},99:{f:wn},125:{f:bE},128:{f:rR},129:{f:TM},130:{f:In},131:{f:wn},132:{f:wn},133:{f:NM},134:{},140:{f:CR},141:{f:In},144:{},146:{f:NR},151:{},152:{},153:{},154:{},155:{},156:{f:In},157:{},158:{},160:{f:LR},161:{f:jR},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:QM},190:{f:ZM},193:{f:cl},197:{},198:{},199:{},200:{},201:{},202:{f:wn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:In},220:{},221:{f:wn},222:{},224:{f:tR},225:{f:SM},226:{f:cl},227:{},229:{f:gR},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:OM},253:{f:HM},255:{f:PM},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:fE},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:wn},353:{f:cl},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:oR},431:{f:wn},432:{},433:{},434:{},437:{},438:{f:wR},439:{f:wn},440:{f:bR},441:{},442:{f:Kd},443:{},444:{f:In},445:{},446:{},448:{f:cl},449:{f:LM,r:2},450:{f:cl},512:{f:uk},513:{f:DR},515:{f:sR},516:{f:qM},517:{f:hk},519:{f:IR},520:{f:FM},523:{},545:{f:mk},549:{f:ck},566:{},574:{f:RM},638:{f:JM},659:{},1048:{},1054:{f:GM},1084:{},1212:{f:fR},2048:{f:kR},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:mp},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:cl},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:AR,r:12},2173:{f:CB,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:wn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:uR,r:12},2197:{},2198:{f:yB,r:12},2199:{},2200:{},2201:{},2202:{f:hR,r:12},2203:{f:cl},2204:{},2205:{},2206:{},2207:{},2211:{f:DM},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:In},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:PR},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:TR},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:uk},1:{},2:{f:zR},3:{f:BR},4:{f:RR},5:{f:hk},7:{f:HR},8:{},9:{f:mp},11:{},22:{f:In},30:{f:YM},31:{},32:{},33:{f:mk},36:{},37:{f:ck},50:{f:$R},62:{},52:{},67:{},68:{f:In},69:{},86:{},126:{},127:{f:MR},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:qR},223:{},234:{},354:{},421:{},518:{f:sx},521:{f:mp},536:{f:gk},547:{f:pk},561:{},579:{},1030:{f:sx},1033:{f:mp},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function vt(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,l=e.next(4);l.write_shift(2,i),l.write_shift(2,s),s>0&&py(r)&&e.push(r)}}function H$(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return vt(e,t,r,i);var s=t;if(!isNaN(s)){for(var l=r.parts||[],o=0,a=0,c=0;c+(l[o]||8224)<=8224;)c+=l[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,s),f.write_shift(2,c),e.push(r.slice(a,a+c)),a+=c;a<i;){for(f=e.next(4),f.write_shift(2,60),c=0;c+(l[o]||8224)<=8224;)c+=l[o]||8224,o++;f.write_shift(2,c),e.push(r.slice(a,a+c)),a+=c}}}function e0(e,t,r){return e||(e=Ze(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function $$(e,t,r,n){var i=Ze(9);return e0(i,e,t),hE(r,n||"b",i),i}function q$(e,t,r){var n=Ze(8+2*r.length);return e0(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function V$(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Kn(qr(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?vt(e,2,WR(r,n,i)):vt(e,3,UR(r,n,i));return;case"b":case"e":vt(e,5,$$(r,n,t.v,t.t));return;case"s":case"str":vt(e,4,q$(r,n,(t.v||"").slice(0,255)));return}vt(e,1,e0(null,r,n))}function G$(e,t,r,n){var i=Array.isArray(t),s=mr(t["!ref"]||"A1"),l,o="",a=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=tr(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Tn(c);for(var f=s.s.c;f<=s.e.c;++f){c===s.s.r&&(a[f]=en(f)),l=a[f]+o;var h=i?(t[c]||[])[f]:t[l];h&&V$(e,h,c,f)}}}function X$(e,t){for(var r=t||{},n=is(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return vt(n,r.biff==4?1033:r.biff==3?521:9,Sy(e,16,r)),G$(n,e.Sheets[e.SheetNames[i]],i,r),vt(n,10),n.end()}function Y$(e,t,r){vt(e,49,WM({sz:12,name:"Arial"},r))}function K$(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&vt(e,1054,XM(i,t[i],r))})}function J$(e,t){var r=Ze(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),vt(e,2151,r),r=Ze(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),xE(mr(t["!ref"]||"A1"),r),r.write_shift(4,4),vt(e,2152,r)}function Q$(e,t){for(var r=0;r<16;++r)vt(e,224,fk({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){vt(e,224,fk(n,0,t))})}function Z$(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];vt(e,440,_R(n)),n[1].Tooltip&&vt(e,2048,SR(n))}delete t["!links"]}function eq(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&vt(e,125,OR(dm(i,n),i))})}}function tq(e,t,r,n,i){var s=16+ql(i.cellXfs,t,i);if(t.v==null&&!t.bf){vt(e,513,Uc(r,n,s));return}if(t.bf)vt(e,6,Tz(t,r,n,i,s));else switch(t.t){case"d":case"n":var l=t.t=="d"?Kn(qr(t.v)):t.v;vt(e,515,aR(r,n,l,s));break;case"b":case"e":vt(e,517,iR(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var o=Py(i.Strings,t.v,i.revStrings);vt(e,253,$M(r,n,o,s))}else vt(e,516,VM(r,n,(t.v||"").slice(0,255),s,i));break;default:vt(e,513,Uc(r,n,s))}}function rq(e,t,r){var n=is(),i=r.SheetNames[e],s=r.Sheets[i]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[e]||{},a=Array.isArray(s),c=t.biff==8,f,h="",d=[],u=mr(s["!ref"]||"A1"),p=c?65536:16384;if(u.e.c>255||u.e.r>=p){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");u.e.c=Math.min(u.e.c,255),u.e.r=Math.min(u.e.c,p-1)}vt(n,2057,Sy(r,16,t)),vt(n,13,$s(1)),vt(n,12,$s(100)),vt(n,15,Hi(!0)),vt(n,17,Hi(!1)),vt(n,16,Rc(.001)),vt(n,95,Hi(!0)),vt(n,42,Hi(!1)),vt(n,43,Hi(!1)),vt(n,130,$s(1)),vt(n,128,nR()),vt(n,131,Hi(!1)),vt(n,132,Hi(!1)),c&&eq(n,s["!cols"]),vt(n,512,KM(u,t)),c&&(s["!links"]=[]);for(var m=u.s.r;m<=u.e.r;++m){h=Tn(m);for(var g=u.s.c;g<=u.e.c;++g){m===u.s.r&&(d[g]=en(g)),f=d[g]+h;var x=a?(s[m]||[])[g]:s[f];x&&(tq(n,x,m,g,t),c&&x.l&&s["!links"].push([f,x.l]))}}var y=o.CodeName||o.name||i;return c&&vt(n,574,BM((l.Views||[])[0])),c&&(s["!merges"]||[]).length&&vt(n,229,mR(s["!merges"])),c&&Z$(n,s),vt(n,442,dE(y)),c&&J$(n,s),vt(n,10),n.end()}function nq(e,t,r){var n=is(),i=(e||{}).Workbook||{},s=i.Sheets||[],l=i.WBProps||{},o=r.biff==8,a=r.biff==5;if(vt(n,2057,Sy(e,5,r)),r.bookType=="xla"&&vt(n,135),vt(n,225,o?$s(1200):null),vt(n,193,iM(2)),a&&vt(n,191),a&&vt(n,192),vt(n,226),vt(n,92,EM("SheetJS",r)),vt(n,66,$s(o?1200:1252)),o&&vt(n,353,$s(0)),o&&vt(n,448),vt(n,317,FR(e.SheetNames.length)),o&&e.vbaraw&&vt(n,211),o&&e.vbaraw){var c=l.CodeName||"ThisWorkbook";vt(n,442,dE(c))}vt(n,156,$s(17)),vt(n,25,Hi(!1)),vt(n,18,Hi(!1)),vt(n,19,$s(0)),o&&vt(n,431,Hi(!1)),o&&vt(n,444,$s(0)),vt(n,61,MM()),vt(n,64,Hi(!1)),vt(n,141,$s(0)),vt(n,34,Hi(LH(e)=="true")),vt(n,14,Hi(!0)),o&&vt(n,439,Hi(!1)),vt(n,218,$s(0)),Y$(n,e,r),K$(n,e.SSF,r),Q$(n,r),o&&vt(n,352,Hi(!1));var f=n.end(),h=is();o&&vt(h,140,ER()),o&&r.Strings&&H$(h,252,jM(r.Strings)),vt(h,10);var d=h.end(),u=is(),p=0,m=0;for(m=0;m<e.SheetNames.length;++m)p+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var g=f.length+p+d.length;for(m=0;m<e.SheetNames.length;++m){var x=s[m]||{};vt(u,133,AM({pos:g,hs:x.Hidden||0,dt:0,name:e.SheetNames[m]},r)),g+=t[m].length}var y=u.end();if(p!=y.length)throw new Error("BS8 "+p+" != "+y.length);var w=[];return f.length&&w.push(f),y.length&&w.push(y),d.length&&w.push(d),ti(w)}function iq(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Vr(zt)),e&&e.SSF&&(Of(),am(e.SSF),r.revssf=lm(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,My(r),r.cellXfs=[],ql(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=rq(i,r,e);return n.unshift(nq(e,n,r)),ti(n)}function aT(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=ss(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return iq(e,t);case 4:case 3:case 2:return X$(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Ek(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),l=i.index,o=s&&s.index||e.length,a=WI(e.slice(l,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,h=0,d=0,u={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(l=0;l<a.length;++l){var m=a[l].trim(),g=m.slice(0,3).toLowerCase();if(g=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}f=0;continue}if(!(g!="<td"&&g!="<th")){var x=m.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var y=x[o].trim();if(y.match(/<t[dh]/i)){for(var w=y,b=0;w.charAt(0)=="<"&&(b=w.indexOf(">"))>-1;)w=w.slice(b+1);for(var S=0;S<p.length;++S){var T=p[S];T.s.c==f&&T.s.r<c&&c<=T.e.r&&(f=T.e.c+1,S=-1)}var O=Gt(y.slice(0,y.indexOf(">")));d=O.colspan?+O.colspan:1,((h=+O.rowspan)>1||d>1)&&p.push({s:{r:c,c:f},e:{r:c+(h||1)-1,c:f+d-1}});var j=O.t||O["data-t"]||"";if(!w.length){f+=d;continue}if(w=OC(w),u.s.r>c&&(u.s.r=c),u.e.r<c&&(u.e.r=c),u.s.c>f&&(u.s.c=f),u.e.c<f&&(u.e.c=f),!w.length){f+=d;continue}var L={t:"s",v:w};r.raw||!w.trim().length||j=="s"||(w==="TRUE"?L={t:"b",v:!0}:w==="FALSE"?L={t:"b",v:!1}:isNaN(wa(w))?isNaN(yf(w).getDate())||(L={t:"d",v:qr(w)},r.cellDates||(L={t:"n",v:Kn(L.v)}),L.z=r.dateNF||zt[14]):L={t:"n",v:wa(w)}),r.dense?(n[c]||(n[c]=[]),n[c][f]=L):n[$t({r:c,c:f})]=L,f+=d}}}}return n["!ref"]=tr(u),p.length&&(n["!merges"]=p),n}function sq(e,t,r,n){for(var i=e["!merges"]||[],s=[],l=t.s.c;l<=t.e.c;++l){for(var o=0,a=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>l)&&!(i[c].e.r<r||i[c].e.c<l)){if(i[c].s.r<r||i[c].s.c<l){o=-1;break}o=i[c].e.r-i[c].s.r+1,a=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var f=$t({r,c:l}),h=n.dense?(e[r]||[])[l]:e[f],d=h&&h.v!=null&&(h.h||fy(h.w||(Ro(h),h.w)||""))||"",u={};o>1&&(u.rowspan=o),a>1&&(u.colspan=a),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(u["data-t"]=h&&h.t||"z",h.v!=null&&(u["data-v"]=h.v),h.z!=null&&(u["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),u.id=(n.id||"sjs")+"-"+f,s.push(xt("td",d,u))}}var p="<tr>";return p+s.join("")+"</tr>"}var aq='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',oq="</body></html>";function lq(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return $l(Ek(r[0],t),t);var n=Uy();return r.forEach(function(i,s){zy(n,Ek(i,t),"Sheet"+(s+1))}),n}function cq(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function oT(e,t){var r=t||{},n=r.header!=null?r.header:aq,i=r.footer!=null?r.footer:oq,s=[n],l=ss(e["!ref"]);r.dense=Array.isArray(e),s.push(cq(e,l,r));for(var o=l.s.r;o<=l.e.r;++o)s.push(sq(e,l,o,r));return s.push("</table>"+i),s.join("")}function lT(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?tn(n.origin):n.origin;i=l.r,s=l.c}var o=t.getElementsByTagName("tr"),a=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var f=ss(e["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),i==-1&&(c.e.r=i=f.e.r+1)}var h=[],d=0,u=e["!rows"]||(e["!rows"]=[]),p=0,m=0,g=0,x=0,y=0,w=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&m<a;++p){var b=o[p];if(Tk(b)){if(n.display)continue;u[m]={hidden:!0}}var S=b.children;for(g=x=0;g<S.length;++g){var T=S[g];if(!(n.display&&Tk(T))){var O=T.hasAttribute("data-v")?T.getAttribute("data-v"):T.hasAttribute("v")?T.getAttribute("v"):OC(T.innerHTML),j=T.getAttribute("data-z")||T.getAttribute("z");for(d=0;d<h.length;++d){var L=h[d];L.s.c==x+s&&L.s.r<m+i&&m+i<=L.e.r&&(x=L.e.c+1-s,d=-1)}w=+T.getAttribute("colspan")||1,((y=+T.getAttribute("rowspan")||1)>1||w>1)&&h.push({s:{r:m+i,c:x+s},e:{r:m+i+(y||1)-1,c:x+s+(w||1)-1}});var W={t:"s",v:O},F=T.getAttribute("data-t")||T.getAttribute("t")||"";O!=null&&(O.length==0?W.t=F||"z":n.raw||O.trim().length==0||F=="s"||(O==="TRUE"?W={t:"b",v:!0}:O==="FALSE"?W={t:"b",v:!1}:isNaN(wa(O))?isNaN(yf(O).getDate())||(W={t:"d",v:qr(O)},n.cellDates||(W={t:"n",v:Kn(W.v)}),W.z=n.dateNF||zt[14]):W={t:"n",v:wa(O)})),W.z===void 0&&j!=null&&(W.z=j);var M="",V=T.getElementsByTagName("A");if(V&&V.length)for(var G=0;G<V.length&&!(V[G].hasAttribute("href")&&(M=V[G].getAttribute("href"),M.charAt(0)!="#"));++G);M&&M.charAt(0)!="#"&&(W.l={Target:M}),n.dense?(e[m+i]||(e[m+i]=[]),e[m+i][x+s]=W):e[$t({c:x+s,r:m+i})]=W,c.e.c<x+s&&(c.e.c=x+s),x+=w}}++m}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,m-1+i),e["!ref"]=tr(c),m>=a&&(e["!fullref"]=tr((c.e.r=o.length-p+m-1+i,c))),e}function cT(e,t){var r=t||{},n=r.dense?[]:{};return lT(n,e,t)}function uq(e,t){return $l(cT(e,t),t)}function Tk(e){var t="",r=fq(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function fq(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function hq(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=gr(t.replace(/<[^>]*>/g,""));return[r]}var Nk={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function uT(e,t){var r=t||{},n=hy(e),i=[],s,l,o={name:""},a="",c=0,f,h,d={},u=[],p=r.dense?[]:{},m,g,x={value:""},y="",w=0,b=[],S=-1,T=-1,O={s:{r:1e6,c:1e7},e:{r:0,c:0}},j=0,L={},W=[],F={},M=0,V=0,G=[],te=1,ee=1,Q=[],K={Names:[]},N={},U=["",""],R=[],k={},P="",A=0,E=!1,I=!1,H=0;for(Ad.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Ad.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(O.e.c>=O.s.c&&O.e.r>=O.s.r?p["!ref"]=tr(O):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=O.e.r&&(p["!fullref"]=p["!ref"],O.e.r=r.sheetRows-1,p["!ref"]=tr(O)),W.length&&(p["!merges"]=W),G.length&&(p["!rows"]=G),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),u.push(f.name),d[f.name]=p,I=!1):m[0].charAt(m[0].length-2)!=="/"&&(f=Gt(m[0],!1),S=T=-1,O.s.r=O.s.c=1e7,O.e.r=O.e.c=0,p=r.dense?[]:{},W=[],G=[],I=!0);break;case"table-row-group":m[1]==="/"?--j:++j;break;case"table-row":case"":if(m[1]==="/"){S+=te,te=1;break}if(h=Gt(m[0],!1),h.?S=h.-1:S==-1&&(S=0),te=+h["number-rows-repeated"]||1,te<10)for(H=0;H<te;++H)j>0&&(G[S+H]={level:j});T=-1;break;case"covered-table-cell":m[1]!=="/"&&++T,r.sheetStubs&&(r.dense?(p[S]||(p[S]=[]),p[S][T]={t:"z"}):p[$t({r:S,c:T})]={t:"z"}),y="",b=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++T,x=Gt(m[0],!1),ee=parseInt(x["number-columns-repeated"]||"1",10),g={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(g.f=kk(gr(x.formula))),(x.||x["value-type"])=="string"&&(g.t="s",g.v=gr(x["string-value"]||""),r.dense?(p[S]||(p[S]=[]),p[S][T]=g):p[$t({r:S,c:T})]=g),T+=ee-1;else if(m[1]!=="/"){++T,y="",w=0,b=[],ee=1;var J=te?S+te-1:S;if(T>O.e.c&&(O.e.c=T),T<O.s.c&&(O.s.c=T),S<O.s.r&&(O.s.r=S),J>O.e.r&&(O.e.r=J),x=Gt(m[0],!1),R=[],k={},g={t:x.||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=gr(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(M=parseInt(x["number-matrix-rows-spanned"],10)||0,V=parseInt(x["number-matrix-columns-spanned"],10)||0,F={s:{r:S,c:T},e:{r:S+M-1,c:T+V-1}},g.F=tr(F),Q.push([F,g.F])),x.formula)g.f=kk(x.formula);else for(H=0;H<Q.length;++H)S>=Q[H][0].s.r&&S<=Q[H][0].e.r&&T>=Q[H][0].s.c&&T<=Q[H][0].e.c&&(g.F=Q[H][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(M=parseInt(x["number-rows-spanned"],10)||0,V=parseInt(x["number-columns-spanned"],10)||0,F={s:{r:S,c:T},e:{r:S+M-1,c:T+V-1}},W.push(F)),x["number-columns-repeated"]&&(ee=parseInt(x["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=zr(x["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(x.value);break;case"percentage":g.t="n",g.v=parseFloat(x.value);break;case"currency":g.t="n",g.v=parseFloat(x.value);break;case"date":g.t="d",g.v=qr(x["date-value"]),r.cellDates||(g.t="n",g.v=Kn(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=BI(x["time-value"])/86400,r.cellDates&&(g.t="d",g.v=cm(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(x.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",x["string-value"]!=null&&(y=gr(x["string-value"]),b=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(E=!1,g.t==="s"&&(g.v=y||"",b.length&&(g.R=b),E=w==0),N.Target&&(g.l=N),R.length>0&&(g.c=R,R=[]),y&&r.cellText!==!1&&(g.w=y),E&&(g.t="z",delete g.v),(!E||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=S))for(var Y=0;Y<te;++Y){if(ee=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(p[S+Y]||(p[S+Y]=[]),p[S+Y][T]=Y==0?g:Vr(g);--ee>0;)p[S+Y][T+ee]=Vr(g);else for(p[$t({r:S+Y,c:T})]=g;--ee>0;)p[$t({r:S+Y,c:T+ee})]=Vr(g);O.e.c<=T&&(O.e.c=T)}ee=parseInt(x["number-columns-repeated"]||"1",10),T+=ee-1,ee=0,g={},y="",b=[]}N={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s;k.t=y,b.length&&(k.R=b),k.a=P,R.push(k)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);P="",A=0,y="",w=0,b=[];break;case"creator":m[1]==="/"?P=n.slice(A,m.index):A=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);y="",w=0,b=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(L[o.name]=a,(s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(a="",o=Gt(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":l=Gt(m[0],!1),a+=Nk[m[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":l=Gt(m[0],!1),a+=Nk[m[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":a+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":l=Gt(m[0],!1),U=ax(l["cell-range-address"]);var Z={Name:l.name,Ref:U[0]+"!"+U[1]};I&&(Z.Sheet=u.length),K.Names.push(Z);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!x||!x["string-value"])){var fe=hq(n.slice(w,m.index));y=(y.length>0?y+`
`:"")+fe[0]}else Gt(m[0],!1),w=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{U=ax(Gt(m[0])["target-range-address"]),d[U[0]]["!autofilter"]={ref:U[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(N=Gt(m[0],!1),!N.href)break;N.Target=gr(N.href),delete N.href,N.Target.charAt(0)=="#"&&N.Target.indexOf(".")>-1?(U=ax(N.Target.slice(1)),N.Target="#"+U[0]+"!"+U[1]):N.Target.match(/^\.\.[\\\/]/)&&(N.Target=N.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var X={Sheets:d,SheetNames:u,Workbook:K};return r.bookSheets&&delete X.Sheets,X}function Ak(e,t){t=t||{},Hs(e,"META-INF/manifest.xml")&&B7(Ln(e,"META-INF/manifest.xml"),t);var r=bs(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=uT(Or(r),t);return Hs(e,"meta.xml")&&(n.Props=eE(Ln(e,"meta.xml"))),n}function Ok(e,t){return uT(e,t)}var dq=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Nd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Nn+t}}(),jk=function(){var e=function(s){return Tr(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,l,o){var a=[];a.push('      <table:table table:name="'+Tr(l.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,f=0,h=ss(s["!ref"]||"A1"),d=s["!merges"]||[],u=0,p=Array.isArray(s);if(s["!cols"])for(f=0;f<=h.e.c;++f)a.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var m="",g=s["!rows"]||[];for(c=0;c<h.s.r;++c)m=g[c]?' table:style-name="ro'+g[c].ods+'"':"",a.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=h.e.r;++c){for(m=g[c]?' table:style-name="ro'+g[c].ods+'"':"",a.push("        <table:table-row"+m+`>
`),f=0;f<h.s.c;++f)a.push(t);for(;f<=h.e.c;++f){var x=!1,y={},w="";for(u=0;u!=d.length;++u)if(!(d[u].s.c>f)&&!(d[u].s.r>c)&&!(d[u].e.c<f)&&!(d[u].e.r<c)){(d[u].s.c!=f||d[u].s.r!=c)&&(x=!0),y["table:number-columns-spanned"]=d[u].e.c-d[u].s.c+1,y["table:number-rows-spanned"]=d[u].e.r-d[u].s.r+1;break}if(x){a.push(r);continue}var b=$t({r:c,c:f}),S=p?(s[c]||[])[f]:s[b];if(S&&S.f&&(y["table:formula"]=Tr(Fz(S.f)),S.F&&S.F.slice(0,b.length)==b)){var T=ss(S.F);y["table:number-matrix-columns-spanned"]=T.e.c-T.s.c+1,y["table:number-matrix-rows-spanned"]=T.e.r-T.s.r+1}if(!S){a.push(t);continue}switch(S.t){case"b":w=S.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=S.v?"true":"false";break;case"n":w=S.w||String(S.v||0),y["office:value-type"]="float",y["office:value"]=S.v||0;break;case"s":case"str":w=S.v==null?"":S.v,y["office:value-type"]="string";break;case"d":w=S.w||qr(S.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=qr(S.v).toISOString(),y["table:style-name"]="ce1";break;default:a.push(t);continue}var O=e(w);if(S.l&&S.l.Target){var j=S.l.Target;j=j.charAt(0)=="#"?"#"+Dz(j.slice(1)):j,j.charAt(0)!="#"&&!j.match(/^\w+:/)&&(j="../"+j),O=xt("text:a",O,{"xlink:href":j.replace(/&/g,"&amp;")})}a.push("          "+xt("table:table-cell",xt("text:p",O,{}),y)+`
`)}a.push(`        </table:table-row>
`)}return a.push(`      </table:table>
`),a.join("")},i=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(c){return l.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var f=0;f<c["!cols"].length;++f)if(c["!cols"][f]){var h=c["!cols"][f];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Ml(h),h.ods=o;var d=c["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++o}}});var a=0;l.SheetNames.map(function(c){return l.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var f=0;f<c["!rows"].length;++f)if(c["!rows"][f]){c["!rows"][f].ods=a;var h=c["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+a+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++a}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,o){var a=[Nn],c=Nd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Nd({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(a.push("<office:document"+c+f+`>
`),a.push(ZC().replace(/office:document-meta/g,"office:meta"))):a.push("<office:document-content"+c+`>
`),i(a,l),a.push(`  <office:body>
`),a.push(`    <office:spreadsheet>
`);for(var h=0;h!=l.SheetNames.length;++h)a.push(n(l.Sheets[l.SheetNames[h]],l,h));return a.push(`    </office:spreadsheet>
`),a.push(`  </office:body>
`),o.bookType=="fods"?a.push("</office:document>"):a.push("</office:document-content>"),a.join("")}}();function fT(e,t){if(t.bookType=="fods")return jk(e,t);var r=ly(),n="",i=[],s=[];return n="mimetype",ir(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ir(r,n,jk(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",ir(r,n,dq(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",ir(r,n,Nn+ZC()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",ir(r,n,W7(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ir(r,n,U7(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function zc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Hv(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Or(Hl(e))}function pq(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ws(Va(e))}function gq(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Bl(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function Pk(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function mq(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function xq(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function Id(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function _r(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function dn(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function xr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=Id(e,r),s=i&7;i=Math.floor(i/8);var l=0,o;if(i==0)break;switch(s){case 0:{for(var a=r[0];e[r[0]++]>=128;);o=e.slice(a,r[0])}break;case 5:l=4,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=Id(e,r),o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function hi(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(_r(n*8+i.type)),i.type==2&&t.push(_r(i.data.length)),t.push(i.data))})}),Bl(t)}function Ly(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function zs(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=Id(e,n),s=xr(e.slice(n[0],n[0]+i));n[0]+=i;var l={id:dn(s[1][0].data),messages:[]};s[2].forEach(function(o){var a=xr(o.data),c=dn(a[3][0].data);l.messages.push({meta:a,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(l.merge=dn(s[3][0].data)>>>0>0),r.push(l)}return r}function _u(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:_r(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:_r(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(l){i.push(l.data),l.meta[3]=[{type:0,data:_r(l.data.length)}],n[2].push({data:hi(l.meta),type:2})});var s=hi(n);t.push(_r(s.length)),t.push(s),i.forEach(function(l){return t.push(l)})}),Bl(t)}function vq(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Id(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=t[r[0]],o>1&&(l|=t[r[0]+1]<<8),o>2&&(l|=t[r[0]+2]<<16),o>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}i.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var a=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,a=(t[r[0]++]&224)<<3,a|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(a=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(a=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Bl(i)],a==0)throw new Error("Invalid offset 0");if(a>i[0].length)throw new Error("Invalid offset beyond length");if(c>=a)for(i.push(i[0].slice(-a)),c-=a;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-a,-a+c))}}var f=Bl(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Ws(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(vq(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Bl(t)}function ku(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=_r(n),l=s.length;t.push(s),n<=60?(l++,t.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),l+=n,i[0]=0,i[1]=l&255,i[2]=l>>8&255,i[3]=l>>16&255,r+=n}return Bl(t)}function yq(e,t,r,n){var i=zc(e),s=i.getUint32(4,!0),l=(n>1?12:8)+Pk(s&(n>1?3470:398))*4,o=-1,a=-1,c=NaN,f=new Date(2001,0,1);s&512&&(o=i.getUint32(l,!0),l+=4),l+=Pk(s&(n>1?12288:4096))*4,s&16&&(a=i.getUint32(l,!0),l+=4),s&32&&(c=i.getFloat64(l,!0),l+=8),s&64&&(f.setTime(f.getTime()+i.getFloat64(l,!0)*1e3),l+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[a]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(a>-1)h={t:"s",v:t[a]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function wq(e,t,r){var n=zc(e),i=n.getUint32(8,!0),s=12,l=-1,o=-1,a=NaN,c=NaN,f=new Date(2001,0,1);i&1&&(a=mq(e,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(l=n.getUint32(s,!0),s+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:a};break;case 3:h={t:"s",v:t[o]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(l>-1)h={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:a};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return h}function lx(e,t){var r=new Uint8Array(32),n=zc(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,xq(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function cx(e,t){var r=new Uint8Array(32),n=zc(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function bq(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return yq(e,t,r,e[0]);case 5:return wq(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ti(e){var t=xr(e);return Id(t[1][0].data)}function Fk(e,t){var r=xr(t.data),n=dn(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(l){var o=xr(l.data),a=dn(o[1][0].data)>>>0;switch(n){case 1:s[a]=Hv(o[3][0].data);break;case 8:{var c=e[Ti(o[9][0].data)][0],f=xr(c.data),h=e[Ti(f[1][0].data)][0],d=dn(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var u=xr(h.data);s[a]=u[3].map(function(p){return Hv(p.data)}).join("")}break}}),s}function _q(e,t){var r,n,i,s,l,o,a,c,f,h,d,u,p,m,g=xr(e),x=dn(g[1][0].data)>>>0,y=dn(g[2][0].data)>>>0,w=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&dn(g[8][0].data)>0||!1,b,S;if((s=(i=g[7])==null?void 0:i[0])!=null&&s.data&&t!=0)b=(o=(l=g[7])==null?void 0:l[0])==null?void 0:o.data,S=(c=(a=g[6])==null?void 0:a[0])==null?void 0:c.data;else if((h=(f=g[4])==null?void 0:f[0])!=null&&h.data&&t!=1)b=(u=(d=g[4])==null?void 0:d[0])==null?void 0:u.data,S=(m=(p=g[3])==null?void 0:p[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var T=w?4:1,O=zc(b),j=[],L=0;L<b.length/2;++L){var W=O.getUint16(L*2,!0);W<65535&&j.push([L,W])}if(j.length!=y)throw"Expected ".concat(y," cells, found ").concat(j.length);var F=[];for(L=0;L<j.length-1;++L)F[j[L][0]]=S.subarray(j[L][1]*T,j[L+1][1]*T);return j.length>=1&&(F[j[j.length-1][0]]=S.subarray(j[j.length-1][1]*T)),{R:x,cells:F}}function kq(e,t){var r,n=xr(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?dn(n[7][0].data)>>>0>0?1:0:-1,s=Ly(n[5],function(l){return _q(l,i)});return{nrows:dn(n[4][0].data)>>>0,data:s.reduce(function(l,o){return l[o.R]||(l[o.R]=[]),o.cells.forEach(function(a,c){if(l[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));l[o.R][c]=a}),l},[])}}function Sq(e,t,r){var n,i=xr(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(dn(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(dn(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=tr(s);var l=xr(i[4][0].data),o=Fk(e,e[Ti(l[4][0].data)][0]),a=(n=l[17])!=null&&n[0]?Fk(e,e[Ti(l[17][0].data)][0]):[],c=xr(l[3][0].data),f=0;c[1].forEach(function(h){var d=xr(h.data),u=e[Ti(d[2][0].data)][0],p=dn(u.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var m=kq(e,u);m.data.forEach(function(g,x){g.forEach(function(y,w){var b=$t({r:f+x,c:w}),S=bq(y,o,a);S&&(r[b]=S)})}),f+=m.nrows})}function Cq(e,t){var r=xr(t.data),n={"!ref":"A1"},i=e[Ti(r[2][0].data)],s=dn(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Sq(e,i[0],n),n}function Eq(e,t){var r,n=xr(t.data),i={name:(r=n[1])!=null&&r[0]?Hv(n[1][0].data):"",sheets:[]},s=Ly(n[2],Ti);return s.forEach(function(l){e[l].forEach(function(o){var a=dn(o.meta[1][0].data);a==6e3&&i.sheets.push(Cq(e,o))})}),i}function Tq(e,t){var r=Uy(),n=xr(t.data),i=Ly(n[1],Ti);if(i.forEach(function(s){e[s].forEach(function(l){var o=dn(l.meta[1][0].data);if(o==2){var a=Eq(e,l);a.sheets.forEach(function(c,f){zy(r,c,f==0?a.name:a.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function ux(e){var t,r,n,i,s={},l=[];if(e.FullPaths.forEach(function(a){if(a.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(a){if(a.name.match(/\.iwa$/)){var c;try{c=Ws(a.content)}catch(h){return console.log("?? "+a.content.length+" "+(h.message||h))}var f;try{f=zs(c)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){s[h.id]=h.messages,l.push(h.id)})}}),!l.length)throw new Error("File has no messages");var o=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&dn(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||l.forEach(function(a){s[a].forEach(function(c){var f=dn(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Tq(s,o)}function Nq(e,t,r){var n,i,s,l;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(s=e[8])==null?void 0:s[0])==null?void 0:l.data)&&dn(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var a=0,c=zc(e[7][0].data),f=0,h=[],d=zc(e[4][0].data),u=0,p=[],m=0;m<t.length;++m){if(t[m]==null){c.setUint16(m*2,65535,!0),d.setUint16(m*2,65535);continue}c.setUint16(m*2,f,!0),d.setUint16(m*2,u,!0);var g,x;switch(typeof t[m]){case"string":g=lx({t:"s",v:t[m]},r),x=cx({t:"s",v:t[m]},r);break;case"number":g=lx({t:"n",v:t[m]},r),x=cx({t:"n",v:t[m]},r);break;case"boolean":g=lx({t:"b",v:t[m]},r),x=cx({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}h.push(g),f+=g.length,p.push(x),u+=x.length,++a}for(e[2][0].data=_r(a);m<e[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),d.setUint16(m*2,65535,!0);return e[6][0].data=Bl(h),e[3][0].data=Bl(p),a}function Aq(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ss(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(tr(n)));var s=Dg(r,{range:n,header:1}),l=["~Sh33tJ5~"];s.forEach(function(P){return P.forEach(function(A){typeof A=="string"&&l.push(A)})});var o={},a=[],c=Rt.read(t.numbers,{type:"base64"});c.FileIndex.map(function(P,A){return[P,c.FullPaths[A]]}).forEach(function(P){var A=P[0],E=P[1];if(A.type==2&&A.name.match(/\.iwa/)){var I=A.content,H=Ws(I),J=zs(H);J.forEach(function(Y){a.push(Y.id),o[Y.id]={deps:[],location:E,type:dn(Y.messages[0].meta[1][0].data)}})}}),a.sort(function(P,A){return P-A});var f=a.filter(function(P){return P>1}).map(function(P){return[P,_r(P)]});c.FileIndex.map(function(P,A){return[P,c.FullPaths[A]]}).forEach(function(P){var A=P[0];if(P[1],!!A.name.match(/\.iwa/)){var E=zs(Ws(A.content));E.forEach(function(I){I.messages.forEach(function(H){f.forEach(function(J){I.messages.some(function(Y){return dn(Y.meta[1][0].data)!=11006&&gq(Y.data,J[1])})&&o[J[0]].deps.push(I.id)})})})}});for(var h=Rt.find(c,o[1].location),d=zs(Ws(h.content)),u,p=0;p<d.length;++p){var m=d[p];m.id==1&&(u=m)}var g=Ti(xr(u.messages[0].data)[1][0].data);for(h=Rt.find(c,o[g].location),d=zs(Ws(h.content)),p=0;p<d.length;++p)m=d[p],m.id==g&&(u=m);for(g=Ti(xr(u.messages[0].data)[2][0].data),h=Rt.find(c,o[g].location),d=zs(Ws(h.content)),p=0;p<d.length;++p)m=d[p],m.id==g&&(u=m);for(g=Ti(xr(u.messages[0].data)[2][0].data),h=Rt.find(c,o[g].location),d=zs(Ws(h.content)),p=0;p<d.length;++p)m=d[p],m.id==g&&(u=m);var x=xr(u.messages[0].data);{x[6][0].data=_r(n.e.r+1),x[7][0].data=_r(n.e.c+1);var y=Ti(x[46][0].data),w=Rt.find(c,o[y].location),b=zs(Ws(w.content));{for(var S=0;S<b.length&&b[S].id!=y;++S);if(b[S].id!=y)throw"Bad ColumnRowUIDMapArchive";var T=xr(b[S].messages[0].data);T[1]=[],T[2]=[],T[3]=[];for(var O=0;O<=n.e.c;++O){var j=[];j[1]=j[2]=[{type:0,data:_r(O+420690)}],T[1].push({type:2,data:hi(j)}),T[2].push({type:0,data:_r(O)}),T[3].push({type:0,data:_r(O)})}T[4]=[],T[5]=[],T[6]=[];for(var L=0;L<=n.e.r;++L)j=[],j[1]=j[2]=[{type:0,data:_r(L+726270)}],T[4].push({type:2,data:hi(j)}),T[5].push({type:0,data:_r(L)}),T[6].push({type:0,data:_r(L)});b[S].messages[0].data=hi(T)}w.content=ku(_u(b)),w.size=w.content.length,delete x[46];var W=xr(x[4][0].data);{W[7][0].data=_r(n.e.r+1);var F=xr(W[1][0].data),M=Ti(F[2][0].data);w=Rt.find(c,o[M].location),b=zs(Ws(w.content));{if(b[0].id!=M)throw"Bad HeaderStorageBucket";var V=xr(b[0].messages[0].data);for(L=0;L<s.length;++L){var G=xr(V[2][0].data);G[1][0].data=_r(L),G[4][0].data=_r(s[L].length),V[2][L]={type:V[2][0].type,data:hi(G)}}b[0].messages[0].data=hi(V)}w.content=ku(_u(b)),w.size=w.content.length;var te=Ti(W[2][0].data);w=Rt.find(c,o[te].location),b=zs(Ws(w.content));{if(b[0].id!=te)throw"Bad HeaderStorageBucket";for(V=xr(b[0].messages[0].data),O=0;O<=n.e.c;++O)G=xr(V[2][0].data),G[1][0].data=_r(O),G[4][0].data=_r(n.e.r+1),V[2][O]={type:V[2][0].type,data:hi(G)};b[0].messages[0].data=hi(V)}w.content=ku(_u(b)),w.size=w.content.length;var ee=Ti(W[4][0].data);(function(){for(var P=Rt.find(c,o[ee].location),A=zs(Ws(P.content)),E,I=0;I<A.length;++I){var H=A[I];H.id==ee&&(E=H)}var J=xr(E.messages[0].data);{J[3]=[];var Y=[];l.forEach(function(X,re){Y[1]=[{type:0,data:_r(re)}],Y[2]=[{type:0,data:_r(1)}],Y[3]=[{type:2,data:pq(X)}],J[3].push({type:2,data:hi(Y)})})}E.messages[0].data=hi(J);var Z=_u(A),fe=ku(Z);P.content=fe,P.size=P.content.length})();var Q=xr(W[3][0].data);{var K=Q[1][0];delete Q[2];var N=xr(K.data);{var U=Ti(N[2][0].data);(function(){for(var P=Rt.find(c,o[U].location),A=zs(Ws(P.content)),E,I=0;I<A.length;++I){var H=A[I];H.id==U&&(E=H)}var J=xr(E.messages[0].data);{delete J[6],delete Q[7];var Y=new Uint8Array(J[5][0].data);J[5]=[];for(var Z=0,fe=0;fe<=n.e.r;++fe){var X=xr(Y);Z+=Nq(X,s[fe],l),X[1][0].data=_r(fe),J[5].push({data:hi(X),type:2})}J[1]=[{type:0,data:_r(n.e.c+1)}],J[2]=[{type:0,data:_r(n.e.r+1)}],J[3]=[{type:0,data:_r(Z)}],J[4]=[{type:0,data:_r(n.e.r+1)}]}E.messages[0].data=hi(J);var re=_u(A),se=ku(re);P.content=se,P.size=P.content.length})()}K.data=hi(N)}W[3][0].data=hi(Q)}x[4][0].data=hi(W)}u.messages[0].data=hi(x);var R=_u(d),k=ku(R);return h.content=k,h.size=h.content.length,c}function hT(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Iy(e){hT([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function My(e){hT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Oq(e){return or.WS.indexOf(e)>-1?"sheet":e==or.CS?"chart":e==or.DS?"dialog":e==or.MS?"macro":e&&e.length?e:"sheet"}function jq(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Oq(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Pq(e,t,r,n,i,s,l,o,a,c,f,h){try{s[n]=zh(bs(e,r,!0),t);var d=Ln(e,t),u;switch(o){case"sheet":u=e$(d,t,i,a,s[n],c,f,h);break;case"chart":if(u=t$(d,t,i,a,s[n],c,f,h),!u||!u["!drawel"])break;var p=Sh(u["!drawel"].Target,t),m=Od(p),g=zB(bs(e,p,!0),zh(bs(e,m,!0),p)),x=Sh(g,p),y=Od(x);u=NH(bs(e,x,!0),x,a,zh(bs(e,y,!0),x),c,u);break;case"macro":u=r$(d,t,i,a,s[n],c,f,h);break;case"dialog":u=n$(d,t,i,a,s[n],c,f,h);break;default:throw new Error("Unrecognized sheet type "+o)}l[n]=u;var w=[];s&&s[n]&&pn(s[n]).forEach(function(b){var S="";if(s[n][b].Type==or.CMNT){S=Sh(s[n][b].Target,t);var T=o$(Ln(e,S,!0),S,a);if(!T||!T.length)return;vk(u,T,!1)}s[n][b].Type==or.TCMNT&&(S=Sh(s[n][b].Target,t),w=w.concat(HB(Ln(e,S,!0),a)))}),w&&w.length&&vk(u,w,!0,a.people||[])}catch(b){if(a.WTF)throw b}}function Bs(e){return e.charAt(0)=="/"?e.slice(1):e}function Fq(e,t){if(Of(),t=t||{},Iy(t),Hs(e,"META-INF/manifest.xml")||Hs(e,"objectdata.xml"))return Ak(e,t);if(Hs(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ux<"u"){if(e.FileIndex)return ux(e);var r=Rt.utils.cfb_new();return B5(e).forEach(function(G){ir(r,G,$I(e,G))}),ux(r)}throw new Error("Unsupported NUMBERS file")}if(!Hs(e,"[Content_Types].xml"))throw Hs(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Hs(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=B5(e),i=M7(bs(e,"[Content_Types].xml")),s=!1,l,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Ln(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Ln(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var a={},c={};if(!t.bookSheets&&!t.bookProps){if(Wh=[],i.sst)try{Wh=a$(Ln(e,Bs(i.sst)),i.sst,t)}catch(G){if(t.WTF)throw G}t.cellStyles&&i.themes.length&&(a=s$(bs(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=i$(Ln(e,Bs(i.style)),i.style,a,t))}i.links.map(function(G){try{var te=zh(bs(e,Od(Bs(G))),G);return c$(Ln(e,Bs(G)),te,G,t)}catch{}});var f=ZH(Ln(e,Bs(i.workbooks[0])),i.workbooks[0],t),h={},d="";i.coreprops.length&&(d=Ln(e,Bs(i.coreprops[0]),!0),d&&(h=eE(d)),i.extprops.length!==0&&(d=Ln(e,Bs(i.extprops[0]),!0),d&&$7(d,h,t)));var u={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(d=bs(e,Bs(i.custprops[0]),!0),d&&(u=V7(d,t)));var p={};if((t.bookSheets||t.bookProps)&&(f.Sheets?l=f.Sheets.map(function(te){return te.name}):h.Worksheets&&h.SheetNames.length>0&&(l=h.SheetNames),t.bookProps&&(p.Props=h,p.Custprops=u),t.bookSheets&&typeof l<"u"&&(p.SheetNames=l),t.bookSheets?p.SheetNames:t.bookProps))return p;l={};var m={};t.bookDeps&&i.calcchain&&(m=l$(Ln(e,Bs(i.calcchain)),i.calcchain));var g=0,x={},y,w;{var b=f.Sheets;h.Worksheets=b.length,h.SheetNames=[];for(var S=0;S!=b.length;++S)h.SheetNames[S]=b[S].name}var T=s?"bin":"xml",O=i.workbooks[0].lastIndexOf("/"),j=(i.workbooks[0].slice(0,O+1)+"_rels/"+i.workbooks[0].slice(O+1)+".rels").replace(/^\//,"");Hs(e,j)||(j="xl/_rels/workbook."+T+".rels");var L=zh(bs(e,j,!0),j.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=u$(Ln(e,Bs(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=qB(Ln(e,Bs(i.people[0])),t)),L&&(L=jq(L,f.Sheets));var W=Ln(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=h.Worksheets;++g){var F="sheet";if(L&&L[g]?(y="xl/"+L[g][1].replace(/[\/]?xl\//,""),Hs(e,y)||(y=L[g][1]),Hs(e,y)||(y=j.replace(/_rels\/.*$/,"")+L[g][1]),F=L[g][2]):(y="xl/worksheets/sheet"+(g+1-W)+"."+T,y=y.replace(/sheet0\./,"sheet.")),w=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(h.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var M=!1,V=0;V!=t.sheets.length;++V)typeof t.sheets[V]=="number"&&t.sheets[V]==g&&(M=1),typeof t.sheets[V]=="string"&&t.sheets[V].toLowerCase()==h.SheetNames[g].toLowerCase()&&(M=1);if(!M)continue e}}Pq(e,y,w,h.SheetNames[g],g,x,l,F,t,f,a,c)}return p={Directory:i,Workbook:f,Props:h,Custprops:u,Deps:m,Sheets:l,SheetNames:h.SheetNames,Strings:Wh,Styles:c,Themes:a,SSF:Vr(zt)},t&&t.bookFiles&&(e.files?(p.keys=n,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(G,te){G=G.replace(/^Root Entry[\/]/,""),p.keys.push(G),p.files[G]=e.FileIndex[te]}))),t&&t.bookVBA&&(i.vba.length>0?p.vbaraw=Ln(e,Bs(i.vba[0]),!0):i.defaults&&i.defaults.bin===ZB&&(p.vbaraw=Ln(e,"xl/vbaProject.bin",!0))),p}function Dq(e,t){var r=t||{},n="Workbook",i=Rt.find(e,n);try{if(n="/!DataSpaces/Version",i=Rt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u9(i.content),n="/!DataSpaces/DataSpaceMap",i=Rt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=h9(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Rt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=d9(i.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Rt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);g9(i.content)}catch{}if(n="/EncryptionInfo",i=Rt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=m9(i.content);if(n="/EncryptedPackage",i=Rt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function Lq(e,t){return t.bookType=="ods"?fT(e,t):t.bookType=="numbers"?Aq(e,t):t.bookType=="xlsb"?Iq(e,t):Mq(e,t)}function Iq(e,t){qu=1024,e&&!e.SSF&&(e.SSF=Vr(zt)),e&&e.SSF&&(Of(),am(e.SSF),t.revssf=lm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Hh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=BE.indexOf(t.bookType)>-1,i=_y();My(t=t||{});var s=ly(),l="",o=0;if(t.cellXfs=[],ql(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",ir(s,l,tE(e.Props,t)),i.coreprops.push(l),Sr(t.rels,2,l,or.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var a=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&a.push(e.SheetNames[c]);e.Props.SheetNames=a}for(e.Props.Worksheets=e.Props.SheetNames.length,ir(s,l,iE(e.Props)),i.extprops.push(l),Sr(t.rels,3,l,or.EXT_PROPS),e.Custprops!==e.Props&&pn(e.Custprops||{}).length>0&&(l="docProps/custom.xml",ir(s,l,sE(e.Custprops)),i.custprops.push(l),Sr(t.rels,4,l,or.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,ir(s,l,h$(o-1,l,t,e,f)),i.sheets.push(l),Sr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,or.WS[0])}if(h){var u=h["!comments"],p=!1,m="";u&&u.length>0&&(m="xl/comments"+o+"."+r,ir(s,m,g$(u,m)),i.comments.push(m),Sr(f,-1,"../comments"+o+"."+r,or.CMNT),p=!0),h["!legacy"]&&p&&ir(s,"xl/drawings/vmlDrawing"+o+".vml",ME(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&ir(s,Od(l),sf(f))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,ir(s,l,p$(t.Strings,l,t)),i.strs.push(l),Sr(t.wbrels,-1,"sharedStrings."+r,or.SST)),l="xl/workbook."+r,ir(s,l,f$(e,l)),i.workbooks.push(l),Sr(t.rels,1,l,or.WB),l="xl/theme/theme1.xml",ir(s,l,Ny(e.Themes,t)),i.themes.push(l),Sr(t.wbrels,-1,"theme/theme1.xml",or.THEME),l="xl/styles."+r,ir(s,l,d$(e,l,t)),i.styles.push(l),Sr(t.wbrels,-1,"styles."+r,or.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",ir(s,l,e.vbaraw),i.vba.push(l),Sr(t.wbrels,-1,"vbaProject.bin",or.VBA)),l="xl/metadata."+r,ir(s,l,m$(l)),i.metadata.push(l),Sr(t.wbrels,-1,"metadata."+r,or.XLMETA),ir(s,"[Content_Types].xml",QC(i,t)),ir(s,"_rels/.rels",sf(t.rels)),ir(s,"xl/_rels/workbook."+r+".rels",sf(t.wbrels)),delete t.revssf,delete t.ssf,s}function Mq(e,t){qu=1024,e&&!e.SSF&&(e.SSF=Vr(zt)),e&&e.SSF&&(Of(),am(e.SSF),t.revssf=lm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Hh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=BE.indexOf(t.bookType)>-1,i=_y();My(t=t||{});var s=ly(),l="",o=0;if(t.cellXfs=[],ql(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",ir(s,l,tE(e.Props,t)),i.coreprops.push(l),Sr(t.rels,2,l,or.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var a=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&a.push(e.SheetNames[c]);e.Props.SheetNames=a}e.Props.Worksheets=e.Props.SheetNames.length,ir(s,l,iE(e.Props)),i.extprops.push(l),Sr(t.rels,3,l,or.EXT_PROPS),e.Custprops!==e.Props&&pn(e.Custprops||{}).length>0&&(l="docProps/custom.xml",ir(s,l,sE(e.Custprops)),i.custprops.push(l),Sr(t.rels,4,l,or.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],u=(d||{})["!type"]||"sheet";switch(u){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,ir(s,l,KE(o-1,t,e,h)),i.sheets.push(l),Sr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,or.WS[0])}if(d){var p=d["!comments"],m=!1,g="";if(p&&p.length>0){var x=!1;p.forEach(function(y){y[1].forEach(function(w){w.T==!0&&(x=!0)})}),x&&(g="xl/threadedComments/threadedComment"+o+"."+r,ir(s,g,$B(p,f,t)),i.threadedcomments.push(g),Sr(h,-1,"../threadedComments/threadedComment"+o+"."+r,or.TCMNT)),g="xl/comments"+o+"."+r,ir(s,g,RE(p)),i.comments.push(g),Sr(h,-1,"../comments"+o+"."+r,or.CMNT),m=!0}d["!legacy"]&&m&&ir(s,"xl/drawings/vmlDrawing"+o+".vml",ME(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&ir(s,Od(l),sf(h))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,ir(s,l,CE(t.Strings,t)),i.strs.push(l),Sr(t.wbrels,-1,"sharedStrings."+r,or.SST)),l="xl/workbook."+r,ir(s,l,tT(e)),i.workbooks.push(l),Sr(t.rels,1,l,or.WB),l="xl/theme/theme1.xml",ir(s,l,Ny(e.Themes,t)),i.themes.push(l),Sr(t.wbrels,-1,"theme/theme1.xml",or.THEME),l="xl/styles."+r,ir(s,l,FE(e,t)),i.styles.push(l),Sr(t.wbrels,-1,"styles."+r,or.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",ir(s,l,e.vbaraw),i.vba.push(l),Sr(t.wbrels,-1,"vbaProject.bin",or.VBA)),l="xl/metadata."+r,ir(s,l,IE()),i.metadata.push(l),Sr(t.wbrels,-1,"metadata."+r,or.XLMETA),f.length>1&&(l="xl/persons/person.xml",ir(s,l,VB(f)),i.people.push(l),Sr(t.wbrels,-1,"persons/person.xml",or.PEOPLE)),ir(s,"[Content_Types].xml",QC(i,t)),ir(s,"_rels/.rels",sf(t.rels)),ir(s,"xl/_rels/workbook."+r+".rels",sf(t.wbrels)),delete t.revssf,delete t.ssf,s}function Ry(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Os(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Rq(e,t){return Rt.find(e,"EncryptedPackage")?Dq(e,t):sT(e,t)}function Bq(e,t){var r,n=e,i=t||{};return i.type||(i.type=ar&&Buffer.isBuffer(e)?"buffer":"base64"),r=TC(n,i),Fq(r,i)}function dT(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return zv(e.slice(r),t);default:break e}return wf.to_workbook(e,t)}function Uq(e,t){var r="",n=Ry(e,t);switch(t.type){case"base64":r=Os(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Mc(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Or(r)),t.type="binary",dT(r,t)}function zq(e,t){var r=e;return t.type=="base64"&&(r=Os(r)),r=Sd.utils.decode(1200,r.slice(2),"str"),t.type="binary",dT(r,t)}function Wq(e){return e.match(/[^\x00-\x7F]/)?Va(e):e}function fx(e,t,r,n){return n?(r.type="string",wf.to_workbook(e,r)):wf.to_workbook(t,r)}function $v(e,t){ny();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return $v(new Uint8Array(e),(r=Vr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),of={},r.dateNF&&(of.dateNF=r.dateNF),r.type||(r.type=ar&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=ar?"buffer":"binary",n=II(e),typeof Uint8Array<"u"&&!ar&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=Wq(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),o=new Uint8Array(l);if(o.foo="bar",!o.foo)return r=Vr(r),r.type="array",$v(iy(n),r)}switch((i=Ry(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return Rq(Rt.read(n,r),r);break;case 9:if(i[1]<=8)return sT(n,r);break;case 60:return zv(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return GR(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return kE.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?Bq(n,r):fx(e,n,r,s);case 239:return i[3]===60?zv(n,r):fx(e,n,r,s);case 255:if(i[1]===254)return zq(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Tc.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Tc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Uv.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return OE.to_workbook(n,r);break;case 10:case 13:case 32:return Uq(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return VR.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Uv.to_workbook(n,r):fx(e,n,r,s)}function pT(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Gd(t.file,Rt.write(e,{type:ar?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Rt.write(e,t)}function Hq(e,t){var r=Vr(t||{}),n=Lq(e,r);return $q(n,r)}function $q(e,t){var r={},n=ar?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Rt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(sm(i))}return t.password&&typeof encrypt_agile<"u"?pT(encrypt_agile(i,t.password),t):t.type==="file"?Gd(t.file,i):t.type=="string"?Or(i):i}function qq(e,t){var r=t||{},n=W$(e,r);return pT(n,r)}function Ra(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Cd(Va(n));case"binary":return Va(n);case"string":return e;case"file":return Gd(t.file,n,"utf8");case"buffer":return ar?zo(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ra(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Vq(e,t){switch(t.type){case"base64":return Cd(e);case"binary":return e;case"string":return e;case"file":return Gd(t.file,e,"binary");case"buffer":return ar?zo(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function wp(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Cd(r):t.type=="string"?Or(r):r;case"file":return Gd(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function gT(e,t){ny(),RH(e);var r=Vr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=gT(e,r);return r.type="array",sm(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ra(L$(e,r),r);case"slk":case"sylk":return Ra(_E.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return Ra(oT(e.Sheets[e.SheetNames[i]],r),r);case"txt":return Vq(mT(e.Sheets[e.SheetNames[i]],r),r);case"csv":return Ra(By(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return Ra(kE.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return wp(Uv.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return Ra(wf.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return Ra(OE.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return Ra(SE.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return Ra(fT(e,r),r);case"wk1":return wp(Tc.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return wp(Tc.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),wp(aT(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),qq(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Hq(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Gq(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Xq(e,t,r){var n={};return n.type="file",n.file=t,Gq(n),gT(e,n)}function Yq(e,t,r,n,i,s,l,o){var a=Tn(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!l||e[r])for(var u=t.s.c;u<=t.e.c;++u){var p=l?e[r][u]:e[n[u]+a];if(p===void 0||p.t===void 0){if(c===void 0)continue;s[u]!=null&&(d[s[u]]=c);continue}var m=p.v;switch(p.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(s[u]!=null){if(m==null)if(p.t=="e"&&m===null)d[s[u]]=null;else if(c!==void 0)d[s[u]]=c;else if(f&&m===null)d[s[u]]=null;else continue;else d[s[u]]=f&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?m:Ro(p,m,o);m!=null&&(h=!1)}}return{row:d,isempty:h}}function Dg(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],l=0,o="",a={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},f=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":a=mr(f);break;case"number":a=mr(e["!ref"]),a.s.r=f;break;default:a=f}n>0&&(i=0);var h=Tn(a.s.r),d=[],u=[],p=0,m=0,g=Array.isArray(e),x=a.s.r,y=0,w={};g&&!e[x]&&(e[x]=[]);var b=c.skipHidden&&e["!cols"]||[],S=c.skipHidden&&e["!rows"]||[];for(y=a.s.c;y<=a.e.c;++y)if(!(b[y]||{}).hidden)switch(d[y]=en(y),r=g?e[x][y]:e[d[y]+h],n){case 1:s[y]=y-a.s.c;break;case 2:s[y]=d[y];break;case 3:s[y]=c.header[y-a.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=Ro(r,null,c),m=w[l]||0,!m)w[l]=1;else{do o=l+"_"+m++;while(w[o]);w[l]=m,w[o]=1}s[y]=o}for(x=a.s.r+i;x<=a.e.r;++x)if(!(S[x]||{}).hidden){var T=Yq(e,a,x,d,n,s,g,c);(T.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(u[p++]=T.row)}return u.length=p,u}var Dk=/"/g;function Kq(e,t,r,n,i,s,l,o){for(var a=!0,c=[],f="",h=Tn(r),d=t.s.c;d<=t.e.c;++d)if(n[d]){var u=o.dense?(e[r]||[])[d]:e[n[d]+h];if(u==null)f="";else if(u.v!=null){a=!1,f=""+(o.rawNumbers&&u.t=="n"?u.v:Ro(u,null,o));for(var p=0,m=0;p!==f.length;++p)if((m=f.charCodeAt(p))===i||m===s||m===34||o.forceQuotes){f='"'+f.replace(Dk,'""')+'"';break}f=="ID"&&(f='"ID"')}else u.f!=null&&!u.F?(a=!1,f="="+u.f,f.indexOf(",")>=0&&(f='"'+f.replace(Dk,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&a?null:c.join(l)}function By(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=mr(e["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,a=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),f="",h=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],u=n.skipHidden&&e["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(d[p]||{}).hidden||(h[p]=en(p));for(var m=0,g=i.s.r;g<=i.e.r;++g)(u[g]||{}).hidden||(f=Kq(e,i,g,h,l,a,s,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((m++?o:"")+f)));return delete n.dense,r.join("")}function mT(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=By(e,t);return r}function Jq(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=mr(e["!ref"]),s="",l=[],o,a=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)l[o]=en(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=Tn(f),o=i.s.c;o<=i.e.c;++o)if(t=l[o]+s,r=c?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}a[a.length]=t+"="+n}return a}function xT(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},l=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var a=typeof n.origin=="string"?tn(n.origin):n.origin;l=a.r,o=a.c}var c,f={s:{c:0,r:0},e:{c:o,r:l+t.length-1+i}};if(s["!ref"]){var h=mr(s["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),l==-1&&(l=h.e.r+1,f.e.r=l+t.length-1+i)}else l==-1&&(l=0,f.e.r=t.length-1+i);var d=n.header||[],u=0;t.forEach(function(m,g){pn(m).forEach(function(x){(u=d.indexOf(x))==-1&&(d[u=d.length]=x);var y=m[x],w="z",b="",S=$t({c:o+u,r:l+g+i});c=Md(s,S),y&&typeof y=="object"&&!(y instanceof Date)?s[S]=y:(typeof y=="number"?w="n":typeof y=="boolean"?w="b":typeof y=="string"?w="s":y instanceof Date?(w="d",n.cellDates||(w="n",y=Kn(y)),b=n.dateNF||zt[14]):y===null&&n.nullError&&(w="e",y=0),c?(c.t=w,c.v=y,delete c.w,delete c.R,b&&(c.z=b)):s[S]=c={t:w,v:y},b&&(c.z=b))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var p=Tn(l);if(i)for(u=0;u<d.length;++u)s[en(u+o)+p]={t:"s",v:d[u]};return s["!ref"]=tr(f),s}function Qq(e,t){return xT(null,e,t)}function Md(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=tn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Md(e,$t(t)):Md(e,$t({r:t,c:r||0}))}function Zq(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Uy(){return{SheetNames:[],Sheets:{}}}function zy(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var l=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=l+i)!=-1;++i);}if(eT(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function eV(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Zq(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function tV(e,t){return e.z=t,e}function vT(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function rV(e,t,r){return vT(e,"#"+t,r)}function nV(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function iV(e,t,r,n){for(var i=typeof t!="string"?t:mr(t),s=typeof t=="string"?t:tr(t),l=i.s.r;l<=i.e.r;++l)for(var o=i.s.c;o<=i.e.c;++o){var a=Md(e,l,o);a.t="n",a.F=s,delete a.v,l==i.s.r&&o==i.s.c&&(a.f=r,n&&(a.D=!0))}return e}var bp={encode_col:en,encode_row:Tn,encode_cell:$t,encode_range:tr,decode_col:my,decode_row:gy,split_cell:p7,decode_cell:tn,decode_range:ss,format_cell:Ro,sheet_add_aoa:qC,sheet_add_json:xT,sheet_add_dom:lT,aoa_to_sheet:jf,json_to_sheet:Qq,table_to_sheet:cT,table_to_book:uq,sheet_to_csv:By,sheet_to_txt:mT,sheet_to_json:Dg,sheet_to_html:oT,sheet_to_formulae:Jq,sheet_to_row_object_array:Dg,sheet_get_cell:Md,book_new:Uy,book_append_sheet:zy,book_set_sheet_visibility:eV,cell_set_number_format:tV,cell_set_hyperlink:vT,cell_set_internal_link:rV,cell_add_comment:nV,sheet_set_array_formula:iV,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const yT=({isMobileView:e=!1,externalZoneId:t=null,externalDate:r=null,externalSessionId:n=null})=>{const i=xe.useRef(null),s=xe.useRef(null),[l,o]=xe.useState([]),[a,c]=xe.useState(null),[f,h]=xe.useState(new Date().toISOString().split("T")[0]),[d,u]=xe.useState(null),[p,m]=xe.useState([]),[g,x]=xe.useState(!1),[y,w]=xe.useState({present:0,absent:0,total:0}),[b,S]=xe.useState(!1),[T,O]=xe.useState(!1),[j,L]=xe.useState({paper:"a4",orientation:"portrait"}),W=N=>{var X,re;const U=N||s.current;if(!U)return;const R=U.getObjects();if(R.length===0)return;let k=1/0,P=1/0,A=-1/0,E=-1/0;R.forEach(se=>{const z=se.getBoundingRect(!0);k=Math.min(k,z.left),P=Math.min(P,z.top),A=Math.max(A,z.left+z.width),E=Math.max(E,z.top+z.height)});const I=A-k,H=E-P,J=((X=i.current)==null?void 0:X.clientWidth)||U.getWidth(),Y=((re=i.current)==null?void 0:re.clientHeight)||U.getHeight(),Z=J/2-(k+I/2);let fe;e?fe=30-P:fe=Y/2-(P+H/2),U.setViewportTransform([1,0,0,1,Z,fe]),U.requestRenderAll()};xe.useEffect(()=>{F()},[]),xe.useEffect(()=>{t&&c(t)},[t]),xe.useEffect(()=>{r&&h(r)},[r]),xe.useEffect(()=>{n&&u(n)},[n]);const F=async()=>{x(!0);const{data:N}=await He.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});N&&N.length>0&&(o(N),c(N[0].id))};xe.useEffect(()=>{a&&M(a)},[a]);const M=async N=>{const{data:U}=await He.from("sessions").select("*").eq("zone_id",N).order("start_time",{ascending:!0});if(U){m(U);const R=new Date().toISOString().split("T")[0];if(f===R){const k=new Date,P=k.getHours().toString().padStart(2,"0")+":"+k.getMinutes().toString().padStart(2,"0")+":00",A=U.find(E=>P>=E.start_time&&P<=E.end_time);A?u(A.id):U.length>0&&u(U[0].id)}else U.length>0&&u(U[0].id)}};xe.useEffect(()=>{const N=new Date().toISOString().split("T")[0];if(f===N&&p.length>0){const U=new Date,R=U.getHours().toString().padStart(2,"0")+":"+U.getMinutes().toString().padStart(2,"0")+":00",k=p.find(P=>R>=P.start_time&&R<=P.end_time);k&&u(k.id)}},[f]),xe.useEffect(()=>{if(!i.current||!a||!d)return;let N=!0;s.current&&s.current.dispose(),i.current.innerHTML="";const U=document.createElement("canvas");i.current.appendChild(U);const R=new Ht.fabric.Canvas(U,{width:i.current.clientWidth,height:i.current.clientHeight,backgroundColor:"transparent",selection:!1,allowTouchScrolling:!0});s.current=R;const k=new ResizeObserver(()=>{if(!i.current||!s.current)return;const E=i.current.clientWidth,I=i.current.clientHeight;s.current.setDimensions({width:E,height:I}),W(s.current)});k.observe(i.current),(async()=>{await V(p),setTimeout(()=>{N&&W(s.current)},100)})(),R.on("mouse:down",E=>{var Z,fe,X,re,se;const I=E.e,H=E.target;if((Z=E.subTargets)==null?void 0:Z.find(z=>z.name==="actionButton"||z.name==="actionLabel")){Q(H);return}const Y=H&&H.data&&!H.data.booking;(!H||Y)&&(R.isDragging=!0,R.selection=!1,R.lastPosX=I.clientX||((X=(fe=I.touches)==null?void 0:fe[0])==null?void 0:X.clientX),R.lastPosY=I.clientY||((se=(re=I.touches)==null?void 0:re[0])==null?void 0:se.clientY))}),R.on("mouse:move",E=>{var I,H,J,Y;if(R.isDragging){const Z=E.e,fe=Z.clientX||((H=(I=Z.touches)==null?void 0:I[0])==null?void 0:H.clientX),X=Z.clientY||((Y=(J=Z.touches)==null?void 0:J[0])==null?void 0:Y.clientY),re=R.viewportTransform;re[4]+=fe-R.lastPosX,re[5]+=X-R.lastPosY,R.requestRenderAll(),R.lastPosX=fe,R.lastPosY=X}}),R.on("mouse:wheel",E=>{const I=E.e.deltaY,H=R.viewportTransform;H[5]-=I,R.requestRenderAll(),E.e.preventDefault(),E.e.stopPropagation()}),R.on("mouse:up",()=>{R.isDragging&&(R.setViewportTransform(R.viewportTransform),R.isDragging=!1)});const A=He.channel("attendance_changes").on("postgres_changes",{event:"*",schema:"public",table:"attendance"},()=>{V(p)}).subscribe(E=>{S(E==="SUBSCRIBED")});return()=>{N=!1,k.disconnect(),He.removeChannel(A),R.dispose(),s.current=null}},[d,a,f,n,t,r,p]);const V=async N=>{if(!s.current||!a||!d)return;x(!0);const{data:U}=await He.from("seats").select("*").eq("zone_id",a).order("global_number",{ascending:!0}),R=f,k=ee().split("T")[0],P=R===k,{data:A}=await He.from("bookings").select(`
          *,
          profiles:user_id(full_name, username),
          profiles_student:student_id(full_name, username),
          attendance(id, status, timestamp_in, timestamp_out)
        `).eq("date",R);if(A&&A.length>0){const z=new Date(new Date().getTime()+324e5).toISOString().split("T")[1].substring(0,8),oe=[];if(A.forEach(ce=>{const we=N.find(de=>de.id===ce.session_id);if(!we)return;const ye=Array.isArray(ce.attendance)?ce.attendance[0]:ce.attendance;if(ye&&(ye.status==="present"||ye.status==="late")&&!ye.timestamp_out){const de=we.end_time.length===5?we.end_time+":00":we.end_time;(R<k||P&&de<z)&&oe.push({id:ye.id,timestamp_out:`${R}T${de}+09:00`,updated_at:new Date().toISOString()})}}),oe.length>0){const{error:ce}=await He.from("attendance").upsert(oe);ce||oe.forEach(we=>{const ye=A.find(de=>{var pe,Ae;return(Array.isArray(de.attendance)?(pe=de.attendance[0])==null?void 0:pe.id:(Ae=de.attendance)==null?void 0:Ae.id)===we.id});ye&&(Array.isArray(ye.attendance)?ye.attendance[0].timestamp_out=we.timestamp_out:ye.attendance.timestamp_out=we.timestamp_out)})}}s.current&&s.current.clear();const E=U||[];if(E.length===0){x(!1);return}const I=E.map(se=>se.pos_x).filter(se=>typeof se=="number"&&!isNaN(se)),H=E.map(se=>se.pos_y).filter(se=>typeof se=="number"&&!isNaN(se));if(I.length===0||H.length===0){x(!1);return}Math.min(...I),Math.max(...E.map(se=>se.pos_x+(se.width||72)).filter(se=>!isNaN(se))),Math.min(...H),Math.max(...E.map(se=>se.pos_y+(se.height||72)).filter(se=>!isNaN(se)));const J=0,Y=0;if(s.current&&i.current){const se=i.current.clientWidth,z=i.current.clientHeight;s.current.setDimensions({width:se,height:z})}let Z=N==null?void 0:N.find(se=>se.id===d);if(!Z&&P){const se=new Date,z=se.getHours().toString().padStart(2,"0")+":"+se.getMinutes().toString().padStart(2,"0")+":00";Z=N==null?void 0:N.find(oe=>z>=oe.start_time&&z<=oe.end_time)}let fe=0;const re=((A==null?void 0:A.filter(se=>se.session_id===d))||[]).length;U.forEach(se=>{if(se.type==="structure"){G({...se,pos_x:se.pos_x+J,pos_y:se.pos_y+Y},null,null,[],null,N,!1);return}const z=(A==null?void 0:A.filter(de=>de.seat_id===se.id))||[],oe=z.find(de=>de.session_id===d),ce=Array.isArray(oe==null?void 0:oe.attendance)?oe.attendance[0]:(oe==null?void 0:oe.attendance)||null;let we=(ce==null?void 0:ce.status)||"absent";if(P&&oe&&!ce&&d&&N){const de=N.find(Te=>Te.id===d);if(de){const Te=new Date,pe=Te.getHours().toString().padStart(2,"0")+":"+Te.getMinutes().toString().padStart(2,"0")+":00";de.end_time<pe&&(we="absent")}}const ye=z.length>0;oe&&we==="present"&&fe++,G({...se,pos_x:se.pos_x+J,pos_y:se.pos_y+Y},oe,we,z,Z,N,ye)}),w({present:fe,absent:re-fe,total:re,rate:re>0?Math.round(fe/re*100):0}),x(!1)},G=(N,U,R,k,P,A,E,I)=>{if(N.type==="structure"){const ce=new Ht.fabric.Rect({fill:N.bg_color||"#E5E5EA",width:N.width||72,height:N.height||72,stroke:N.stroke_color||"#D1D1D6",strokeWidth:1}),we=new Ht.fabric.IText(N.label||"",{fontSize:N.font_size||10,originX:"center",originY:"center",left:(N.width||72)/2,top:(N.height||72)/2,fill:N.text_color||"#AEAEB2",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),ye=new Ht.fabric.Group([ce,we],{left:N.pos_x,top:N.pos_y,angle:N.rotation,selectable:!1,evented:!1,data:{...N}});s.current.add(ye);return}const H=!!U,J=E,Y=N.zone_color||"#5E5CE6",Z=new Ht.fabric.Rect({fill:"#FFFFFF",width:71,height:71,rx:12,ry:12,stroke:"#C7C7CC",strokeWidth:1.5,left:.5,top:.5,originX:"left",originY:"top",selectable:!1}),fe="M 0 12 Q 0 0 12 0 L 60 0 Q 72 0 72 12 L 72 18 L 0 18 z",X=new Ht.fabric.Path(fe,{fill:Y,strokeWidth:0,left:0,top:0,originX:"left",originY:"top",selectable:!1});let re=[Z,X];if(H){const ce=Array.isArray(U==null?void 0:U.attendance)?U.attendance[0]:(U==null?void 0:U.attendance)||null,ye=(R==="present"||R==="late")&&!(ce!=null&&ce.timestamp_out)?"#00FF00":"#FF3B30",de=new Ht.fabric.Circle({radius:3,fill:ye,left:58,top:9,originX:"center",originY:"center",selectable:!1,stroke:"rgba(255,255,255,0.8)",strokeWidth:1.5});re.push(de)}const se=new Ht.fabric.IText(N.display_number||N.seat_number,{fontSize:10,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"900",fill:"#ffffff",left:36,top:9,originX:"center",originY:"center",selectable:!1});if(re.push(se),H){const ce=U==null?void 0:U.profiles_student,we=ce?`${ce.username?ce.username+" ":""}${ce.full_name}`:"  ",ye=new Ht.fabric.IText(we,{fontSize:10,textAlign:"center",originX:"center",originY:"center",left:36,top:34,fill:"#1C1C1E",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1});re.push(ye);const de=Array.isArray(U==null?void 0:U.attendance)?U.attendance[0]:(U==null?void 0:U.attendance)||null,Te=!!(de!=null&&de.timestamp_out),pe=(R==="present"||R==="late")&&!Te;let Ae="",Ie="",je="#8E8E93",Le="#F2F2F7",Xe=Y,Je="#FFFFFF",Ne=!1;pe?(Ae="",Ie="",je="#FFFFFF",Le=Y,Xe="#FFFFFF",Je=Y,Ne=!0):Te&&(Ae="",Ie="",je="#1C1C1E",Le="#F2F2F7",Xe=Y,Je="#FFFFFF");const Oe="M 0 50 L 36 50 L 36 72 L 6 72 Q 0 72 0 66 Z",De=new Ht.fabric.Path(Oe,{fill:Le,selectable:!1}),Ye=new Ht.fabric.IText(Ae,{fontSize:8,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",fill:je,originX:"center",originY:"center",left:18,top:61,selectable:!1}),it="M 36 50 L 72 50 L 72 66 Q 72 72 66 72 L 36 72 Z",Ke=new Ht.fabric.Path(it,{fill:Xe,stroke:Ne?Y:null,strokeWidth:Ne?1:0,selectable:!1,hoverCursor:"pointer",name:"actionButton"}),et=new Ht.fabric.IText(Ie,{fontSize:8,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",fill:Je,originX:"center",originY:"center",left:54,top:61,selectable:!1,name:"actionLabel"});re.push(De,Ye,Ke,et)}else{const ce=new Ht.fabric.IText("",{fontSize:12,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",fill:"#E5E5EA",left:36,top:34,originX:"center",originY:"center",selectable:!1}),we="M 0 50 L 72 50 L 72 60 Q 72 72 60 72 L 12 72 Q 0 72 0 60 Z",ye=new Ht.fabric.Path(we,{fill:"#F2F2F7",opacity:.3,selectable:!1}),de=new Ht.fabric.IText("-",{fontSize:10,fill:"#AEAEB2",left:36,top:61,originX:"center",originY:"center",selectable:!1});re.push(ce,ye,de)}let z=1;H||(z=J?.4:.15);const oe=new Ht.fabric.Group(re,{left:N.pos_x,top:N.pos_y,opacity:z,angle:N.rotation,data:{...N,booking:U,status:R},selectable:!1,hoverCursor:H?"pointer":"default",subTargetCheck:!0});s.current.add(oe)},te=N=>{const U=new Date(f);U.setDate(U.getDate()+N),h(U.toISOString().split("T")[0])},ee=()=>{const N=new Date,U=9*60*60*1e3;return new Date(N.getTime()+U).toISOString().replace("Z","+09:00")},Q=async N=>{const{booking:U,status:R}=N.data;if(!U)return;const k=p.find(I=>I.id===U.session_id);if(!k)return;const P=Array.isArray(U.attendance)?U.attendance[0]:U.attendance||null,A=!!(P!=null&&P.timestamp_out);if((R==="present"||R==="late")&&!A){const{error:I}=await He.from("attendance").update({timestamp_out:ee(),updated_at:new Date().toISOString()}).eq("id",P.id);I&&console.error("Error during check-out:",I),I||await V(p)}else if(A){const{error:I}=await He.from("attendance").update({status:"absent",timestamp_in:null,timestamp_out:null,updated_at:new Date().toISOString()}).eq("id",P.id);I&&console.error("Error during reset to absent:",I),I||await V(p)}else{const I=(k==null?void 0:k.start_time)||"00:00:00",H={booking_id:U.id,status:"present",timestamp_in:`${f}T${I}${I.length===5?":00":""}+09:00`,timestamp_out:null,updated_at:new Date().toISOString()};P!=null&&P.id&&(H.id=P.id);const{error:J}=await He.from("attendance").upsert(H,{onConflict:"booking_id"});J?console.error("Error during attendance upsert:",J):await V(p)}},K=async()=>{var N;if(s.current){x(!0),O(!1);try{const U=s.current,R=U.getObjects();if(R.length===0){alert("  ."),x(!1);return}const k=U.viewportTransform;U.setViewportTransform([1,0,0,1,0,0]);let P=1/0,A=1/0,E=-1/0,I=-1/0;R.forEach(Ne=>{if(!Ne.visible||Ne.opacity===0||(!Ne.fill||Ne.fill==="transparent")&&(!Ne.stroke||Ne.stroke==="transparent")&&!Ne.text)return;let Oe=Ne.getBoundingRect();P=Math.min(P,Oe.left),A=Math.min(A,Oe.top),E=Math.max(E,Oe.left+Oe.width),I=Math.max(I,Oe.top+Oe.height)});const H=20,J=P-H,Y=A-H,Z=E-P+H*2,fe=I-A+H*2,X=U.toDataURL({format:"png",left:J,top:Y,width:Z,height:fe,multiplier:3});U.setViewportTransform(k);const{paper:re,orientation:se}=j,z=re==="b4"?257:210,oe=re==="b4"?364:297,ce=se==="landscape"?oe:z,we=se==="landscape"?z:oe,ye=20,de=10,Te=10,pe=ce-de*2,Ae=we-ye-Te,Ie=document.createElement("iframe");Ie.style.position="fixed",Ie.style.right="0",Ie.style.bottom="0",Ie.style.width="0",Ie.style.height="0",Ie.style.border="0",document.body.appendChild(Ie);const je=((N=l.find(Ne=>Ne.id===a))==null?void 0:N.name)||"",Le=Ie.contentWindow.document;Le.open(),Le.write(`
        <html>
          <head>
            <title>  - ${je}</title>
            <style>
              @page {
                size: ${re} ${se};
                margin: 0;
              }
              html, body {
                margin: 0;
                padding: 0;
                width: 100%;
                height: 100vh;
                background: white;
                -webkit-print-color-adjust: exact;
                overflow: hidden !important;
              }
              .print-container {
                width: 100%;
                height: 100vh;
                padding: ${ye}mm ${de}mm ${Te}mm ${de}mm;
                box-sizing: border-box;
                display: flex;
                flex-direction: column;
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                overflow: hidden !important;
                background: white;
              }
              .header {
                flex-shrink: 0;
                display: flex;
                justify-content: space-between;
                align-items: flex-end;
                border-bottom: 2px solid #1C1C1E;
                padding-bottom: 3mm; /* Reduced padding */
                margin-bottom: 2mm; /* Reduced margin */
              }
              .header h1 {
                margin: 0;
                font-size: 16pt; /* Slightly smaller to save space */
                font-weight: 900;
                letter-spacing: -1px;
                color: #1C1C1E;
              }
              .header .info {
                text-align: right;
              }
              .header .info .zone {
                font-size: 10pt;
                font-weight: 800;
                color: #5856D6;
                margin: 0;
              }
              .header .info .date {
                font-size: 8pt;
                color: #8E8E93;
                margin: 0;
              }
              /* Content area strictly confined to remaining space */
              .content {
                flex: 1;
                display: flex;
                justify-content: center; /* Center */
                align-items: center;
                min-height: 0;
                padding: 0; /* Remove arbitrary padding to maximize scale */
                margin: 0;
                overflow: hidden;
              }
              /* Image autoscaling using object-fit */
              .content img {
                width: 100%;
                height: 100%;
                object-fit: contain;
                object-position: center; /* Center image */
                display: block;
              }
              .footer {
                flex-shrink: 0;
                margin-top: 1mm; /* Reduced margin */
                text-align: center;
                border-top: 1px solid #F2F2F7;
                padding-top: 2mm;
              }
              .footer p {
                margin: 0;
                font-size: 7pt;
                color: #AEAEB2;
                font-weight: bold;
                letter-spacing: 1px;
              }
            </style>
          </head>
          <body>
            <div class="print-container">
              <div class="header">
                <h1> </h1>
                <div class="info">
                  <p class="zone">${je}</p>
                  <p class="date">${f} </p>
                </div>
              </div>
              <div class="content">
                <img src="${X}" />
              </div>
              <div class="footer">
                <p>POGOK STUDY CAFE MANAGEMENT SYSTEM</p>
              </div>
            </div>
          </body>
        </html>
      `),Le.close();const Xe=()=>{const Ne=Ie.contentWindow;Ne.focus(),setTimeout(()=>{Ne.print(),setTimeout(()=>{document.body.removeChild(Ie),x(!1)},1e3)},800)},Je=Le.querySelector("img");Je.complete?Xe():Je.onload=Xe}catch(U){console.error("Print generation failed:",U),alert("    ."),x(!1)}}};return v.jsxs("div",{className:`flex flex-col gap-4 w-full ${e?"min-h-fit":"h-full"} pt-[10px]`,children:[!e&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between px-2",children:[v.jsxs("div",{className:"flex items-center gap-4 ml-[10px] mt-[10px]",children:[v.jsx("div",{className:"flex bg-gray-100 rounded-apple-md h-10 box-border overflow-hidden border border-gray-100",children:l.map(N=>v.jsx("button",{onClick:()=>c(N.id),className:`h-10 px-6 text-[12px] font-black transition-all ios-tap flex items-center justify-center ${a===N.id?"bg-[#1C1C1E] text-white shadow-md":"text-ios-gray hover:text-[#1C1C1E] hover:bg-gray-200/40"}`,children:N.name},N.id))}),v.jsxs("div",{className:"flex items-center bg-gray-200/20 p-1 rounded-apple-md border border-white/40 backdrop-blur-xl h-10",children:[v.jsx("button",{onClick:()=>te(-1),className:"h-8 px-3 rounded-apple-md hover:bg-white text-ios-gray hover:text-[#1C1C1E] transition-all text-[12px] font-black",children:"<"}),v.jsxs("span",{className:"px-4 text-[13px] font-black min-w-[110px] text-center text-[#1C1C1E]",children:[f.substring(5)," (",["","","","","","",""][new Date(f).getDay()],")"]}),v.jsx("button",{onClick:()=>te(1),className:"h-8 px-3 rounded-apple-md hover:bg-white text-ios-gray hover:text-[#1C1C1E] transition-all text-[12px] font-black",children:">"})]}),(()=>{const N=l.find(R=>R.id===a),U=(N==null?void 0:N.color)||"#5E5CE6";return v.jsx("div",{className:"flex bg-gray-100 rounded-apple-md h-10 box-border overflow-hidden border border-gray-100",children:p.map(R=>v.jsx("button",{onClick:()=>u(R.id),className:`h-10 px-6 text-[11.5px] font-black transition-all duration-300 ios-tap flex items-center justify-center ${d===R.id?"text-white shadow-sm":"text-ios-gray hover:text-[#1C1C1E] hover:bg-gray-200/40"}`,style:d===R.id?{backgroundColor:U}:{},children:R.name.toUpperCase()},R.id))})})()]}),v.jsxs("div",{className:"flex items-center gap-2 mr-[10px] mt-[10px] relative",children:[T&&v.jsx("div",{className:"absolute top-12 right-0 bg-white shadow-deep border border-gray-100 p-4 rounded-apple-md z-50 min-w-[200px] animate-spring-up",children:v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-2 border-b border-gray-50 pb-2",children:[v.jsx(dO,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("span",{className:"text-xs font-black text-[#1C1C1E]",children:" "})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest block",children:" "}),v.jsx("div",{className:"flex gap-2",children:["a4","b4"].map(N=>v.jsx("button",{onClick:()=>L(U=>({...U,paper:N})),className:`flex-1 py-1.5 rounded-apple-sm text-[10px] font-bold uppercase transition-all ${j.paper===N?"bg-ios-indigo text-white":"bg-gray-100 text-ios-gray"}`,children:N},N))})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest block",children:" "}),v.jsx("div",{className:"flex gap-2",children:[{id:"portrait",label:""},{id:"landscape",label:""}].map(N=>v.jsx("button",{onClick:()=>L(U=>({...U,orientation:N.id})),className:`flex-1 py-1.5 rounded-apple-sm text-[10px] font-bold transition-all ${j.orientation===N.id?"bg-ios-indigo text-white":"bg-gray-100 text-ios-gray"}`,children:N.label},N.id))})]}),v.jsxs("button",{onClick:K,className:"w-full h-10 bg-[#1C1C1E] text-white rounded-apple-md text-xs font-black flex items-center justify-center gap-2 hover:bg-gray-800 transition-all active:scale-95",children:[v.jsx(Fl,{className:"w-3.5 h-3.5"})," "]})]})}),v.jsxs("button",{onClick:()=>O(!T),className:`h-10 px-4 rounded-apple-md shadow-sm border flex items-center justify-center gap-2 transition-all ios-tap ${T?"bg-[#1C1C1E] border-[#1C1C1E] text-white":"bg-white border-gray-100 text-[#1C1C1E]"}`,title:"  (PDF)",children:[v.jsx(Fl,{className:"w-4 h-4"}),v.jsx("span",{className:"text-[11px] font-black",children:" "})]}),v.jsx("div",{className:"bg-white h-10 px-4 rounded-apple-md shadow-sm border border-gray-100 flex items-center justify-center",title:b?"    .":"   ...",children:v.jsx("div",{className:`w-2.5 h-2.5 rounded-full shrink-0 border border-white shadow-sm transition-all duration-500 ${b?"bg-emerald-500 animate-pulse shadow-emerald-500/50":"bg-rose-500 opacity-80"}`})})]})]}),v.jsxs("div",{className:"flex items-center gap-2 px-2 ml-[10px] mt-2",children:[v.jsxs("div",{className:"flex items-center gap-1.5 bg-white shadow-sm border border-gray-100 px-4 py-2 rounded-apple-md",children:[v.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 shadow-sm shadow-emerald-500/30"}),v.jsxs("span",{className:"text-[10px] font-black text-[#1C1C1E]",children:[" ",v.jsx("span",{className:"text-emerald-500",children:y.present})]})]}),v.jsxs("div",{className:"flex items-center gap-1.5 bg-white shadow-sm border border-gray-100 px-4 py-2 rounded-apple-md",children:[v.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-rose-500 shadow-sm shadow-rose-500/30"}),v.jsxs("span",{className:"text-[10px] font-black text-[#1C1C1E]",children:[" ",v.jsx("span",{className:"text-rose-500",children:y.absent})]})]}),v.jsxs("div",{className:"flex items-center gap-1.5 bg-white shadow-sm border border-gray-100 px-4 py-2 rounded-apple-md",children:[v.jsx($d,{className:"w-3.5 h-3.5 text-ios-gray opacity-60"}),v.jsxs("span",{className:"text-[10px] font-black text-ios-gray",children:[" ",y.total]})]}),v.jsx("div",{className:"flex items-center gap-1.5 bg-white shadow-sm border border-gray-100 px-4 py-2 rounded-apple-md",children:v.jsxs("span",{className:"text-[10px] font-black text-ios-indigo",children:[" ",y.rate,"%"]})})]})]}),v.jsxs("div",{className:`${e?"w-full":"flex-1 flex flex-col w-full"} overflow-hidden relative`,children:[g&&v.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-30 flex items-center justify-center pointer-events-none",children:v.jsx("div",{className:"w-8 h-8 border-3 border-ios-indigo border-t-transparent rounded-full animate-spin"})}),v.jsx("div",{className:`${e?"w-full":"flex-1 w-full"} bg-white rounded-t-[6px] rounded-b-none border-0 overflow-hidden p-2.5 pb-0`,children:v.jsx("div",{ref:i,className:`relative overflow-hidden cursor-grab active:cursor-grabbing select-none scrollbar-hide ${e?"w-full min-h-[600px] h-auto touch-action-none":"flex-1 h-full"}`,style:e?{touchAction:"none"}:{}})})]})]})};function Jt(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Wr(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function Ss(e,t){const r=Jt(e);return isNaN(t)?Wr(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function t0(e,t){const r=Jt(e);if(isNaN(t))return Wr(e,NaN);if(!t)return r;const n=r.getDate(),i=Wr(e,r.getTime());i.setMonth(r.getMonth()+t+1,0);const s=i.getDate();return n>=s?i:(r.setFullYear(i.getFullYear(),i.getMonth(),n),r)}function sV(e,t){const r=+Jt(e);return Wr(e,r+t)}const wT=6048e5,aV=864e5,pm=6e4,Wy=36e5,oV=1e3;let lV={};function Zc(){return lV}function Bn(e,t){var o,a,c,f;const r=Zc(),n=(t==null?void 0:t.weekStartsOn)??((a=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:a.weekStartsOn)??r.weekStartsOn??((f=(c=r.locale)==null?void 0:c.options)==null?void 0:f.weekStartsOn)??0,i=Jt(e),s=i.getDay(),l=(s<n?7:0)+s-n;return i.setDate(i.getDate()-l),i.setHours(0,0,0,0),i}function _f(e){return Bn(e,{weekStartsOn:1})}function bT(e){const t=Jt(e),r=t.getFullYear(),n=Wr(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const i=_f(n),s=Wr(e,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);const l=_f(s);return t.getTime()>=i.getTime()?r+1:t.getTime()>=l.getTime()?r:r-1}function Ga(e){const t=Jt(e);return t.setHours(0,0,0,0),t}function Lg(e){const t=Jt(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function cV(e,t){const r=Ga(e),n=Ga(t),i=+r-Lg(r),s=+n-Lg(n);return Math.round((i-s)/aV)}function uV(e){const t=bT(e),r=Wr(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),_f(r)}function qv(e,t){return sV(e,t*pm)}function gm(e,t){const r=t*7;return Ss(e,r)}function fV(e){return Wr(e,Date.now())}function Ol(e,t){const r=Ga(e),n=Ga(t);return+r==+n}function hV(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function zp(e){if(!hV(e)&&typeof e!="number")return!1;const t=Jt(e);return!isNaN(Number(t))}function Rd(e){const t=Jt(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function eu(e,t){const r=Jt(e.start),n=Jt(e.end);let i=+r>+n;const s=i?+r:+n,l=i?n:r;l.setHours(0,0,0,0);let o=1;const a=[];for(;+l<=s;)a.push(Jt(l)),l.setDate(l.getDate()+o),l.setHours(0,0,0,0);return i?a.reverse():a}function dV(e,t){const r=Jt(e.start),n=Jt(e.end);let i=+r>+n;const s=i?+r:+n,l=i?n:r;l.setHours(0,0,0,0),l.setDate(1);let o=1;const a=[];for(;+l<=s;)a.push(Jt(l)),l.setMonth(l.getMonth()+o);return i?a.reverse():a}function Lk(e){const t=Jt(e),r=t.getMonth(),n=r-r%3;return t.setMonth(n,1),t.setHours(0,0,0,0),t}function pV(e,t){const r=Jt(e.start),n=Jt(e.end);let i=+r>+n;const s=Bn(i?n:r,t),l=Bn(i?r:n,t);s.setHours(15),l.setHours(15);const o=+l.getTime();let a=s,c=(t==null?void 0:t.step)??1;if(!c)return[];c<0&&(c=-c,i=!i);const f=[];for(;+a<=o;)a.setHours(0),f.push(Jt(a)),a=gm(a,c),a.setHours(15);return i?f.reverse():f}function kf(e){const t=Jt(e);return t.setDate(1),t.setHours(0,0,0,0),t}function gV(e){const t=Jt(e),r=Wr(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function jo(e,t){var o,a,c,f;const r=Zc(),n=(t==null?void 0:t.weekStartsOn)??((a=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:a.weekStartsOn)??r.weekStartsOn??((f=(c=r.locale)==null?void 0:c.options)==null?void 0:f.weekStartsOn)??0,i=Jt(e),s=i.getDay(),l=(s<n?-7:0)+6-(s-n);return i.setDate(i.getDate()+l),i.setHours(23,59,59,999),i}function Ik(e){const t=Jt(e),r=t.getMonth(),n=r-r%3+3;return t.setMonth(n,0),t.setHours(23,59,59,999),t}const mV={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},xV=(e,t,r)=>{let n;const i=mV[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function lf(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const vV={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},yV={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},wV={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},bV={date:lf({formats:vV,defaultWidth:"full"}),time:lf({formats:yV,defaultWidth:"full"}),dateTime:lf({formats:wV,defaultWidth:"full"})},_V={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},kV=(e,t,r,n)=>_V[e];function za(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let i;if(n==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):l;i=e.formattingValues[o]||e.formattingValues[l]}else{const l=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;i=e.values[o]||e.values[l]}const s=e.argumentCallback?e.argumentCallback(t):t;return i[s]}}const SV={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},CV={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},EV={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},TV={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},NV={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},AV={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},OV=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},jV={ordinalNumber:OV,era:za({values:SV,defaultWidth:"wide"}),quarter:za({values:CV,defaultWidth:"wide",argumentCallback:e=>e-1}),month:za({values:EV,defaultWidth:"wide"}),day:za({values:TV,defaultWidth:"wide"}),dayPeriod:za({values:NV,defaultWidth:"wide",formattingValues:AV,defaultFormattingWidth:"wide"})};function Wa(e){return(t,r={})=>{const n=r.width,i=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(i);if(!s)return null;const l=s[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],a=Array.isArray(o)?FV(o,h=>h.test(l)):PV(o,h=>h.test(l));let c;c=e.valueCallback?e.valueCallback(a):a,c=r.valueCallback?r.valueCallback(c):c;const f=t.slice(l.length);return{value:c,rest:f}}}function PV(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function FV(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function _T(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const i=n[0],s=t.match(e.parsePattern);if(!s)return null;let l=e.valueCallback?e.valueCallback(s[0]):s[0];l=r.valueCallback?r.valueCallback(l):l;const o=t.slice(i.length);return{value:l,rest:o}}}const DV=/^(\d+)(th|st|nd|rd)?/i,LV=/\d+/i,IV={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},MV={any:[/^b/i,/^(a|c)/i]},RV={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},BV={any:[/1/i,/2/i,/3/i,/4/i]},UV={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},zV={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},WV={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},HV={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},$V={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},qV={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},VV={ordinalNumber:_T({matchPattern:DV,parsePattern:LV,valueCallback:e=>parseInt(e,10)}),era:Wa({matchPatterns:IV,defaultMatchWidth:"wide",parsePatterns:MV,defaultParseWidth:"any"}),quarter:Wa({matchPatterns:RV,defaultMatchWidth:"wide",parsePatterns:BV,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Wa({matchPatterns:UV,defaultMatchWidth:"wide",parsePatterns:zV,defaultParseWidth:"any"}),day:Wa({matchPatterns:WV,defaultMatchWidth:"wide",parsePatterns:HV,defaultParseWidth:"any"}),dayPeriod:Wa({matchPatterns:$V,defaultMatchWidth:"any",parsePatterns:qV,defaultParseWidth:"any"})},kT={code:"en-US",formatDistance:xV,formatLong:bV,formatRelative:kV,localize:jV,match:VV,options:{weekStartsOn:0,firstWeekContainsDate:1}};function GV(e){const t=Jt(e);return cV(t,gV(t))+1}function ST(e){const t=Jt(e),r=+_f(t)-+uV(t);return Math.round(r/wT)+1}function Hy(e,t){var f,h,d,u;const r=Jt(e),n=r.getFullYear(),i=Zc(),s=(t==null?void 0:t.firstWeekContainsDate)??((h=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??i.firstWeekContainsDate??((u=(d=i.locale)==null?void 0:d.options)==null?void 0:u.firstWeekContainsDate)??1,l=Wr(e,0);l.setFullYear(n+1,0,s),l.setHours(0,0,0,0);const o=Bn(l,t),a=Wr(e,0);a.setFullYear(n,0,s),a.setHours(0,0,0,0);const c=Bn(a,t);return r.getTime()>=o.getTime()?n+1:r.getTime()>=c.getTime()?n:n-1}function XV(e,t){var o,a,c,f;const r=Zc(),n=(t==null?void 0:t.firstWeekContainsDate)??((a=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:a.firstWeekContainsDate)??r.firstWeekContainsDate??((f=(c=r.locale)==null?void 0:c.options)==null?void 0:f.firstWeekContainsDate)??1,i=Hy(e,t),s=Wr(e,0);return s.setFullYear(i,0,n),s.setHours(0,0,0,0),Bn(s,t)}function CT(e,t){const r=Jt(e),n=+Bn(r,t)-+XV(r,t);return Math.round(n/wT)+1}function kr(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const ul={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return kr(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):kr(r+1,2)},d(e,t){return kr(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return kr(e.getHours()%12||12,t.length)},H(e,t){return kr(e.getHours(),t.length)},m(e,t){return kr(e.getMinutes(),t.length)},s(e,t){return kr(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),i=Math.trunc(n*Math.pow(10,r-3));return kr(i,t.length)}},Su={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Mk={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),i=n>0?n:1-n;return r.ordinalNumber(i,{unit:"year"})}return ul.y(e,t)},Y:function(e,t,r,n){const i=Hy(e,n),s=i>0?i:1-i;if(t==="YY"){const l=s%100;return kr(l,2)}return t==="Yo"?r.ordinalNumber(s,{unit:"year"}):kr(s,t.length)},R:function(e,t){const r=bT(e);return kr(r,t.length)},u:function(e,t){const r=e.getFullYear();return kr(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return kr(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return kr(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return ul.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return kr(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const i=CT(e,n);return t==="wo"?r.ordinalNumber(i,{unit:"week"}):kr(i,t.length)},I:function(e,t,r){const n=ST(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):kr(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):ul.d(e,t)},D:function(e,t,r){const n=GV(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):kr(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return kr(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});case"eeee":default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return kr(s,t.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});case"cccc":default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),i=n===0?7:n;switch(t){case"i":return String(i);case"ii":return kr(i,t.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let i;switch(n===12?i=Su.noon:n===0?i=Su.midnight:i=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let i;switch(n>=17?i=Su.evening:n>=12?i=Su.afternoon:n>=4?i=Su.morning:i=Su.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return ul.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):ul.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):kr(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):kr(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):ul.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):ul.s(e,t)},S:function(e,t){return ul.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return Bk(n);case"XXXX":case"XX":return hc(n);case"XXXXX":case"XXX":default:return hc(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return Bk(n);case"xxxx":case"xx":return hc(n);case"xxxxx":case"xxx":default:return hc(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Rk(n,":");case"OOOO":default:return"GMT"+hc(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Rk(n,":");case"zzzz":default:return"GMT"+hc(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return kr(n,t.length)},T:function(e,t,r){const n=e.getTime();return kr(n,t.length)}};function Rk(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=Math.trunc(n/60),s=n%60;return s===0?r+String(i):r+String(i)+t+kr(s,2)}function Bk(e,t){return e%60===0?(e>0?"-":"+")+kr(Math.abs(e)/60,2):hc(e,t)}function hc(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=kr(Math.trunc(n/60),2),s=kr(n%60,2);return r+i+t+s}const Uk=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},ET=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},YV=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return Uk(e,t);let s;switch(n){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",Uk(n,t)).replace("{{time}}",ET(i,t))},Vv={p:ET,P:YV},KV=/^D+$/,JV=/^Y+$/,QV=["D","DD","YY","YYYY"];function TT(e){return KV.test(e)}function NT(e){return JV.test(e)}function Gv(e,t,r){const n=ZV(e,t,r);if(console.warn(n),QV.includes(e))throw new RangeError(n)}function ZV(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const eG=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,tG=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,rG=/^'([^]*?)'?$/,nG=/''/g,iG=/[a-zA-Z]/;function rt(e,t,r){var f,h,d,u,p,m,g,x;const n=Zc(),i=(r==null?void 0:r.locale)??n.locale??kT,s=(r==null?void 0:r.firstWeekContainsDate)??((h=(f=r==null?void 0:r.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(d=n.locale)==null?void 0:d.options)==null?void 0:u.firstWeekContainsDate)??1,l=(r==null?void 0:r.weekStartsOn)??((m=(p=r==null?void 0:r.locale)==null?void 0:p.options)==null?void 0:m.weekStartsOn)??n.weekStartsOn??((x=(g=n.locale)==null?void 0:g.options)==null?void 0:x.weekStartsOn)??0,o=Jt(e);if(!zp(o))throw new RangeError("Invalid time value");let a=t.match(tG).map(y=>{const w=y[0];if(w==="p"||w==="P"){const b=Vv[w];return b(y,i.formatLong)}return y}).join("").match(eG).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const w=y[0];if(w==="'")return{isToken:!1,value:sG(y)};if(Mk[w])return{isToken:!0,value:y};if(w.match(iG))throw new RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");return{isToken:!1,value:y}});i.localize.preprocessor&&(a=i.localize.preprocessor(o,a));const c={firstWeekContainsDate:s,weekStartsOn:l,locale:i};return a.map(y=>{if(!y.isToken)return y.value;const w=y.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&NT(w)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&TT(w))&&Gv(w,t,String(e));const b=Mk[w[0]];return b(o,w,i.localize,c)}).join("")}function sG(e){const t=e.match(rG);return t?t[1].replace(nG,"'"):e}function aG(){return Object.assign({},Zc())}function oG(e){let r=Jt(e).getDay();return r===0&&(r=7),r}function Xv(e,t){const r=Jt(e),n=Jt(t);return r.getTime()>n.getTime()}function Vh(e,t){const r=Jt(e),n=Jt(t);return+r<+n}function lG(e,t){const r=t instanceof Date?Wr(t,0):new t(0);return r.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),r.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),r}const cG=10;class AT{constructor(){dt(this,"subPriority",0)}validate(t,r){return!0}}class uG extends AT{constructor(t,r,n,i,s){super(),this.value=t,this.validateValue=r,this.setValue=n,this.priority=i,s&&(this.subPriority=s)}validate(t,r){return this.validateValue(t,this.value,r)}set(t,r,n){return this.setValue(t,r,this.value,n)}}class fG extends AT{constructor(){super(...arguments);dt(this,"priority",cG);dt(this,"subPriority",-1)}set(r,n){return n.timestampIsSet?r:Wr(r,lG(r,Date))}}class vr{run(t,r,n,i){const s=this.parse(t,r,n,i);return s?{setter:new uG(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(t,r,n){return!0}}class hG extends vr{constructor(){super(...arguments);dt(this,"priority",140);dt(this,"incompatibleTokens",["R","u","t","T"])}parse(r,n,i){switch(n){case"G":case"GG":case"GGG":return i.era(r,{width:"abbreviated"})||i.era(r,{width:"narrow"});case"GGGGG":return i.era(r,{width:"narrow"});case"GGGG":default:return i.era(r,{width:"wide"})||i.era(r,{width:"abbreviated"})||i.era(r,{width:"narrow"})}}set(r,n,i){return n.era=i,r.setFullYear(i,0,1),r.setHours(0,0,0,0),r}}const Cn={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Ha={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function En(e,t){return e&&{value:t(e.value),rest:e.rest}}function Zr(e,t){const r=t.match(e);return r?{value:parseInt(r[0],10),rest:t.slice(r[0].length)}:null}function $a(e,t){const r=t.match(e);if(!r)return null;if(r[0]==="Z")return{value:0,rest:t.slice(1)};const n=r[1]==="+"?1:-1,i=r[2]?parseInt(r[2],10):0,s=r[3]?parseInt(r[3],10):0,l=r[5]?parseInt(r[5],10):0;return{value:n*(i*Wy+s*pm+l*oV),rest:t.slice(r[0].length)}}function OT(e){return Zr(Cn.anyDigitsSigned,e)}function gn(e,t){switch(e){case 1:return Zr(Cn.singleDigit,t);case 2:return Zr(Cn.twoDigits,t);case 3:return Zr(Cn.threeDigits,t);case 4:return Zr(Cn.fourDigits,t);default:return Zr(new RegExp("^\\d{1,"+e+"}"),t)}}function Ig(e,t){switch(e){case 1:return Zr(Cn.singleDigitSigned,t);case 2:return Zr(Cn.twoDigitsSigned,t);case 3:return Zr(Cn.threeDigitsSigned,t);case 4:return Zr(Cn.fourDigitsSigned,t);default:return Zr(new RegExp("^-?\\d{1,"+e+"}"),t)}}function $y(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function jT(e,t){const r=t>0,n=r?t:1-t;let i;if(n<=50)i=e||100;else{const s=n+50,l=Math.trunc(s/100)*100,o=e>=s%100;i=e+l-(o?100:0)}return r?i:1-i}function PT(e){return e%400===0||e%4===0&&e%100!==0}class dG extends vr{constructor(){super(...arguments);dt(this,"priority",130);dt(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(r,n,i){const s=l=>({year:l,isTwoDigitYear:n==="yy"});switch(n){case"y":return En(gn(4,r),s);case"yo":return En(i.ordinalNumber(r,{unit:"year"}),s);default:return En(gn(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,i){const s=r.getFullYear();if(i.isTwoDigitYear){const o=jT(i.year,s);return r.setFullYear(o,0,1),r.setHours(0,0,0,0),r}const l=!("era"in n)||n.era===1?i.year:1-i.year;return r.setFullYear(l,0,1),r.setHours(0,0,0,0),r}}class pG extends vr{constructor(){super(...arguments);dt(this,"priority",130);dt(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(r,n,i){const s=l=>({year:l,isTwoDigitYear:n==="YY"});switch(n){case"Y":return En(gn(4,r),s);case"Yo":return En(i.ordinalNumber(r,{unit:"year"}),s);default:return En(gn(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,i,s){const l=Hy(r,s);if(i.isTwoDigitYear){const a=jT(i.year,l);return r.setFullYear(a,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),Bn(r,s)}const o=!("era"in n)||n.era===1?i.year:1-i.year;return r.setFullYear(o,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),Bn(r,s)}}class gG extends vr{constructor(){super(...arguments);dt(this,"priority",130);dt(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(r,n){return Ig(n==="R"?4:n.length,r)}set(r,n,i){const s=Wr(r,0);return s.setFullYear(i,0,4),s.setHours(0,0,0,0),_f(s)}}class mG extends vr{constructor(){super(...arguments);dt(this,"priority",130);dt(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(r,n){return Ig(n==="u"?4:n.length,r)}set(r,n,i){return r.setFullYear(i,0,1),r.setHours(0,0,0,0),r}}class xG extends vr{constructor(){super(...arguments);dt(this,"priority",120);dt(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,i){switch(n){case"Q":case"QQ":return gn(n.length,r);case"Qo":return i.ordinalNumber(r,{unit:"quarter"});case"QQQ":return i.quarter(r,{width:"abbreviated",context:"formatting"})||i.quarter(r,{width:"narrow",context:"formatting"});case"QQQQQ":return i.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return i.quarter(r,{width:"wide",context:"formatting"})||i.quarter(r,{width:"abbreviated",context:"formatting"})||i.quarter(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=1&&n<=4}set(r,n,i){return r.setMonth((i-1)*3,1),r.setHours(0,0,0,0),r}}class vG extends vr{constructor(){super(...arguments);dt(this,"priority",120);dt(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,i){switch(n){case"q":case"qq":return gn(n.length,r);case"qo":return i.ordinalNumber(r,{unit:"quarter"});case"qqq":return i.quarter(r,{width:"abbreviated",context:"standalone"})||i.quarter(r,{width:"narrow",context:"standalone"});case"qqqqq":return i.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return i.quarter(r,{width:"wide",context:"standalone"})||i.quarter(r,{width:"abbreviated",context:"standalone"})||i.quarter(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=1&&n<=4}set(r,n,i){return r.setMonth((i-1)*3,1),r.setHours(0,0,0,0),r}}class yG extends vr{constructor(){super(...arguments);dt(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);dt(this,"priority",110)}parse(r,n,i){const s=l=>l-1;switch(n){case"M":return En(Zr(Cn.month,r),s);case"MM":return En(gn(2,r),s);case"Mo":return En(i.ordinalNumber(r,{unit:"month"}),s);case"MMM":return i.month(r,{width:"abbreviated",context:"formatting"})||i.month(r,{width:"narrow",context:"formatting"});case"MMMMM":return i.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(r,{width:"wide",context:"formatting"})||i.month(r,{width:"abbreviated",context:"formatting"})||i.month(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=11}set(r,n,i){return r.setMonth(i,1),r.setHours(0,0,0,0),r}}class wG extends vr{constructor(){super(...arguments);dt(this,"priority",110);dt(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(r,n,i){const s=l=>l-1;switch(n){case"L":return En(Zr(Cn.month,r),s);case"LL":return En(gn(2,r),s);case"Lo":return En(i.ordinalNumber(r,{unit:"month"}),s);case"LLL":return i.month(r,{width:"abbreviated",context:"standalone"})||i.month(r,{width:"narrow",context:"standalone"});case"LLLLL":return i.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(r,{width:"wide",context:"standalone"})||i.month(r,{width:"abbreviated",context:"standalone"})||i.month(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=11}set(r,n,i){return r.setMonth(i,1),r.setHours(0,0,0,0),r}}function bG(e,t,r){const n=Jt(e),i=CT(n,r)-t;return n.setDate(n.getDate()-i*7),n}class _G extends vr{constructor(){super(...arguments);dt(this,"priority",100);dt(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(r,n,i){switch(n){case"w":return Zr(Cn.week,r);case"wo":return i.ordinalNumber(r,{unit:"week"});default:return gn(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,i,s){return Bn(bG(r,i,s),s)}}function kG(e,t){const r=Jt(e),n=ST(r)-t;return r.setDate(r.getDate()-n*7),r}class SG extends vr{constructor(){super(...arguments);dt(this,"priority",100);dt(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(r,n,i){switch(n){case"I":return Zr(Cn.week,r);case"Io":return i.ordinalNumber(r,{unit:"week"});default:return gn(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,i){return _f(kG(r,i))}}const CG=[31,28,31,30,31,30,31,31,30,31,30,31],EG=[31,29,31,30,31,30,31,31,30,31,30,31];class TG extends vr{constructor(){super(...arguments);dt(this,"priority",90);dt(this,"subPriority",1);dt(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(r,n,i){switch(n){case"d":return Zr(Cn.date,r);case"do":return i.ordinalNumber(r,{unit:"date"});default:return gn(n.length,r)}}validate(r,n){const i=r.getFullYear(),s=PT(i),l=r.getMonth();return s?n>=1&&n<=EG[l]:n>=1&&n<=CG[l]}set(r,n,i){return r.setDate(i),r.setHours(0,0,0,0),r}}class NG extends vr{constructor(){super(...arguments);dt(this,"priority",90);dt(this,"subpriority",1);dt(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(r,n,i){switch(n){case"D":case"DD":return Zr(Cn.dayOfYear,r);case"Do":return i.ordinalNumber(r,{unit:"date"});default:return gn(n.length,r)}}validate(r,n){const i=r.getFullYear();return PT(i)?n>=1&&n<=366:n>=1&&n<=365}set(r,n,i){return r.setMonth(0,i),r.setHours(0,0,0,0),r}}function qy(e,t,r){var h,d,u,p;const n=Zc(),i=(r==null?void 0:r.weekStartsOn)??((d=(h=r==null?void 0:r.locale)==null?void 0:h.options)==null?void 0:d.weekStartsOn)??n.weekStartsOn??((p=(u=n.locale)==null?void 0:u.options)==null?void 0:p.weekStartsOn)??0,s=Jt(e),l=s.getDay(),a=(t%7+7)%7,c=7-i,f=t<0||t>6?t-(l+c)%7:(a+c)%7-(l+c)%7;return Ss(s,f)}class AG extends vr{constructor(){super(...arguments);dt(this,"priority",90);dt(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(r,n,i){switch(n){case"E":case"EE":case"EEE":return i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"});case"EEEEE":return i.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"});case"EEEE":default:return i.day(r,{width:"wide",context:"formatting"})||i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,i,s){return r=qy(r,i,s),r.setHours(0,0,0,0),r}}class OG extends vr{constructor(){super(...arguments);dt(this,"priority",90);dt(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(r,n,i,s){const l=o=>{const a=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+a};switch(n){case"e":case"ee":return En(gn(n.length,r),l);case"eo":return En(i.ordinalNumber(r,{unit:"day"}),l);case"eee":return i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"});case"eeeee":return i.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"});case"eeee":default:return i.day(r,{width:"wide",context:"formatting"})||i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,i,s){return r=qy(r,i,s),r.setHours(0,0,0,0),r}}class jG extends vr{constructor(){super(...arguments);dt(this,"priority",90);dt(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(r,n,i,s){const l=o=>{const a=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+a};switch(n){case"c":case"cc":return En(gn(n.length,r),l);case"co":return En(i.ordinalNumber(r,{unit:"day"}),l);case"ccc":return i.day(r,{width:"abbreviated",context:"standalone"})||i.day(r,{width:"short",context:"standalone"})||i.day(r,{width:"narrow",context:"standalone"});case"ccccc":return i.day(r,{width:"narrow",context:"standalone"});case"cccccc":return i.day(r,{width:"short",context:"standalone"})||i.day(r,{width:"narrow",context:"standalone"});case"cccc":default:return i.day(r,{width:"wide",context:"standalone"})||i.day(r,{width:"abbreviated",context:"standalone"})||i.day(r,{width:"short",context:"standalone"})||i.day(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=6}set(r,n,i,s){return r=qy(r,i,s),r.setHours(0,0,0,0),r}}function PG(e,t){const r=Jt(e),n=oG(r),i=t-n;return Ss(r,i)}class FG extends vr{constructor(){super(...arguments);dt(this,"priority",90);dt(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(r,n,i){const s=l=>l===0?7:l;switch(n){case"i":case"ii":return gn(n.length,r);case"io":return i.ordinalNumber(r,{unit:"day"});case"iii":return En(i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"}),s);case"iiiii":return En(i.day(r,{width:"narrow",context:"formatting"}),s);case"iiiiii":return En(i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"}),s);case"iiii":default:return En(i.day(r,{width:"wide",context:"formatting"})||i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"}),s)}}validate(r,n){return n>=1&&n<=7}set(r,n,i){return r=PG(r,i),r.setHours(0,0,0,0),r}}class DG extends vr{constructor(){super(...arguments);dt(this,"priority",80);dt(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(r,n,i){switch(n){case"a":case"aa":case"aaa":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaaa":return i.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return i.dayPeriod(r,{width:"wide",context:"formatting"})||i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,i){return r.setHours($y(i),0,0,0),r}}class LG extends vr{constructor(){super(...arguments);dt(this,"priority",80);dt(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(r,n,i){switch(n){case"b":case"bb":case"bbb":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbbb":return i.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return i.dayPeriod(r,{width:"wide",context:"formatting"})||i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,i){return r.setHours($y(i),0,0,0),r}}class IG extends vr{constructor(){super(...arguments);dt(this,"priority",80);dt(this,"incompatibleTokens",["a","b","t","T"])}parse(r,n,i){switch(n){case"B":case"BB":case"BBB":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBBB":return i.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return i.dayPeriod(r,{width:"wide",context:"formatting"})||i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,i){return r.setHours($y(i),0,0,0),r}}class MG extends vr{constructor(){super(...arguments);dt(this,"priority",70);dt(this,"incompatibleTokens",["H","K","k","t","T"])}parse(r,n,i){switch(n){case"h":return Zr(Cn.hour12h,r);case"ho":return i.ordinalNumber(r,{unit:"hour"});default:return gn(n.length,r)}}validate(r,n){return n>=1&&n<=12}set(r,n,i){const s=r.getHours()>=12;return s&&i<12?r.setHours(i+12,0,0,0):!s&&i===12?r.setHours(0,0,0,0):r.setHours(i,0,0,0),r}}class RG extends vr{constructor(){super(...arguments);dt(this,"priority",70);dt(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(r,n,i){switch(n){case"H":return Zr(Cn.hour23h,r);case"Ho":return i.ordinalNumber(r,{unit:"hour"});default:return gn(n.length,r)}}validate(r,n){return n>=0&&n<=23}set(r,n,i){return r.setHours(i,0,0,0),r}}class BG extends vr{constructor(){super(...arguments);dt(this,"priority",70);dt(this,"incompatibleTokens",["h","H","k","t","T"])}parse(r,n,i){switch(n){case"K":return Zr(Cn.hour11h,r);case"Ko":return i.ordinalNumber(r,{unit:"hour"});default:return gn(n.length,r)}}validate(r,n){return n>=0&&n<=11}set(r,n,i){return r.getHours()>=12&&i<12?r.setHours(i+12,0,0,0):r.setHours(i,0,0,0),r}}class UG extends vr{constructor(){super(...arguments);dt(this,"priority",70);dt(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(r,n,i){switch(n){case"k":return Zr(Cn.hour24h,r);case"ko":return i.ordinalNumber(r,{unit:"hour"});default:return gn(n.length,r)}}validate(r,n){return n>=1&&n<=24}set(r,n,i){const s=i<=24?i%24:i;return r.setHours(s,0,0,0),r}}class zG extends vr{constructor(){super(...arguments);dt(this,"priority",60);dt(this,"incompatibleTokens",["t","T"])}parse(r,n,i){switch(n){case"m":return Zr(Cn.minute,r);case"mo":return i.ordinalNumber(r,{unit:"minute"});default:return gn(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,i){return r.setMinutes(i,0,0),r}}class WG extends vr{constructor(){super(...arguments);dt(this,"priority",50);dt(this,"incompatibleTokens",["t","T"])}parse(r,n,i){switch(n){case"s":return Zr(Cn.second,r);case"so":return i.ordinalNumber(r,{unit:"second"});default:return gn(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,i){return r.setSeconds(i,0),r}}class HG extends vr{constructor(){super(...arguments);dt(this,"priority",30);dt(this,"incompatibleTokens",["t","T"])}parse(r,n){const i=s=>Math.trunc(s*Math.pow(10,-n.length+3));return En(gn(n.length,r),i)}set(r,n,i){return r.setMilliseconds(i),r}}class $G extends vr{constructor(){super(...arguments);dt(this,"priority",10);dt(this,"incompatibleTokens",["t","T","x"])}parse(r,n){switch(n){case"X":return $a(Ha.basicOptionalMinutes,r);case"XX":return $a(Ha.basic,r);case"XXXX":return $a(Ha.basicOptionalSeconds,r);case"XXXXX":return $a(Ha.extendedOptionalSeconds,r);case"XXX":default:return $a(Ha.extended,r)}}set(r,n,i){return n.timestampIsSet?r:Wr(r,r.getTime()-Lg(r)-i)}}class qG extends vr{constructor(){super(...arguments);dt(this,"priority",10);dt(this,"incompatibleTokens",["t","T","X"])}parse(r,n){switch(n){case"x":return $a(Ha.basicOptionalMinutes,r);case"xx":return $a(Ha.basic,r);case"xxxx":return $a(Ha.basicOptionalSeconds,r);case"xxxxx":return $a(Ha.extendedOptionalSeconds,r);case"xxx":default:return $a(Ha.extended,r)}}set(r,n,i){return n.timestampIsSet?r:Wr(r,r.getTime()-Lg(r)-i)}}class VG extends vr{constructor(){super(...arguments);dt(this,"priority",40);dt(this,"incompatibleTokens","*")}parse(r){return OT(r)}set(r,n,i){return[Wr(r,i*1e3),{timestampIsSet:!0}]}}class GG extends vr{constructor(){super(...arguments);dt(this,"priority",20);dt(this,"incompatibleTokens","*")}parse(r){return OT(r)}set(r,n,i){return[Wr(r,i),{timestampIsSet:!0}]}}const XG={G:new hG,y:new dG,Y:new pG,R:new gG,u:new mG,Q:new xG,q:new vG,M:new yG,L:new wG,w:new _G,I:new SG,d:new TG,D:new NG,E:new AG,e:new OG,c:new jG,i:new FG,a:new DG,b:new LG,B:new IG,h:new MG,H:new RG,K:new BG,k:new UG,m:new zG,s:new WG,S:new HG,X:new $G,x:new qG,t:new VG,T:new GG},YG=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,KG=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,JG=/^'([^]*?)'?$/,QG=/''/g,ZG=/\S/,eX=/[a-zA-Z]/;function Gh(e,t,r,n){var m,g,x,y;const i=aG(),s=i.locale??kT,l=i.firstWeekContainsDate??((g=(m=i.locale)==null?void 0:m.options)==null?void 0:g.firstWeekContainsDate)??1,o=i.weekStartsOn??((y=(x=i.locale)==null?void 0:x.options)==null?void 0:y.weekStartsOn)??0,a={firstWeekContainsDate:l,weekStartsOn:o,locale:s},c=[new fG],f=t.match(KG).map(w=>{const b=w[0];if(b in Vv){const S=Vv[b];return S(w,s.formatLong)}return w}).join("").match(YG),h=[];for(let w of f){NT(w)&&Gv(w,t,e),TT(w)&&Gv(w,t,e);const b=w[0],S=XG[b];if(S){const{incompatibleTokens:T}=S;if(Array.isArray(T)){const j=h.find(L=>T.includes(L.token)||L.token===b);if(j)throw new RangeError(`The format string mustn't contain \`${j.fullToken}\` and \`${w}\` at the same time`)}else if(S.incompatibleTokens==="*"&&h.length>0)throw new RangeError(`The format string mustn't contain \`${w}\` and any other token at the same time`);h.push({token:b,fullToken:w});const O=S.run(e,w,s.match,a);if(!O)return Wr(r,NaN);c.push(O.setter),e=O.rest}else{if(b.match(eX))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");if(w==="''"?w="'":b==="'"&&(w=tX(w)),e.indexOf(w)===0)e=e.slice(w.length);else return Wr(r,NaN)}}if(e.length>0&&ZG.test(e))return Wr(r,NaN);const d=c.map(w=>w.priority).sort((w,b)=>b-w).filter((w,b,S)=>S.indexOf(w)===b).map(w=>c.filter(b=>b.priority===w).sort((b,S)=>S.subPriority-b.subPriority)).map(w=>w[0]);let u=Jt(r);if(isNaN(u.getTime()))return Wr(r,NaN);const p={};for(const w of d){if(!w.validate(u,a))return Wr(r,NaN);const b=w.set(u,p,a);Array.isArray(b)?(u=b[0],Object.assign(p,b[1])):u=b}return Wr(r,u)}function tX(e){return e.match(JG)[1].replace(QG,"'")}function rX(e){return+Jt(e)<Date.now()}function Yv(e,t){const r=Jt(e),n=Jt(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function Vy(e){return Ol(e,fV(e))}function Wc(e,t){const r=+Jt(e),[n,i]=[+Jt(t.start),+Jt(t.end)].sort((s,l)=>s-l);return r>=n&&r<=i}function Kv(e,t){return Ss(e,-t)}function Cr(e,t){const n=aX(e);let i;if(n.date){const a=oX(n.date,2);i=lX(a.restDateString,a.year)}if(!i||isNaN(i.getTime()))return new Date(NaN);const s=i.getTime();let l=0,o;if(n.time&&(l=cX(n.time),isNaN(l)))return new Date(NaN);if(n.timezone){if(o=uX(n.timezone),isNaN(o))return new Date(NaN)}else{const a=new Date(s+l),c=new Date(0);return c.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),c.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),c}return new Date(s+l+o)}const _p={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},nX=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,iX=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,sX=/^([+-])(\d{2})(?::?(\d{2}))?$/;function aX(e){const t={},r=e.split(_p.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],_p.timeZoneDelimiter.test(t.date)&&(t.date=e.split(_p.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const i=_p.timezone.exec(n);i?(t.time=n.replace(i[1],""),t.timezone=i[1]):t.time=n}return t}function oX(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const i=n[1]?parseInt(n[1]):null,s=n[2]?parseInt(n[2]):null;return{year:s===null?i:s*100,restDateString:e.slice((n[1]||n[2]).length)}}function lX(e,t){if(t===null)return new Date(NaN);const r=e.match(nX);if(!r)return new Date(NaN);const n=!!r[4],i=mh(r[1]),s=mh(r[2])-1,l=mh(r[3]),o=mh(r[4]),a=mh(r[5])-1;if(n)return gX(t,o,a)?fX(t,o,a):new Date(NaN);{const c=new Date(0);return!dX(t,s,l)||!pX(t,i)?new Date(NaN):(c.setUTCFullYear(t,s,Math.max(i,l)),c)}}function mh(e){return e?parseInt(e):1}function cX(e){const t=e.match(iX);if(!t)return NaN;const r=hx(t[1]),n=hx(t[2]),i=hx(t[3]);return mX(r,n,i)?r*Wy+n*pm+i*1e3:NaN}function hx(e){return e&&parseFloat(e.replace(",","."))||0}function uX(e){if(e==="Z")return 0;const t=e.match(sX);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;return xX(n,i)?r*(n*Wy+i*pm):NaN}function fX(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const i=n.getUTCDay()||7,s=(t-1)*7+r+1-i;return n.setUTCDate(n.getUTCDate()+s),n}const hX=[31,null,31,30,31,30,31,31,30,31,30,31];function FT(e){return e%400===0||e%4===0&&e%100!==0}function dX(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(hX[t]||(FT(e)?29:28))}function pX(e,t){return t>=1&&t<=(FT(e)?366:365)}function gX(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function mX(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function xX(e,t){return t>=0&&t<=59}function vX(e,t){const r=Jt(e);return r.setDate(t),r}function mm(e,t){return t0(e,-1)}function yX(e,t){return qv(e,-10)}function DT(e,t){return gm(e,-1)}const wX={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},bX=(e,t,r)=>{let n;const i=wX[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?n+" ":n+" ":n},_X={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},kX={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},SX={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},CX={date:lf({formats:_X,defaultWidth:"full"}),time:lf({formats:kX,defaultWidth:"full"}),dateTime:lf({formats:SX,defaultWidth:"full"})},EX={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},TX=(e,t,r,n)=>EX[e],NX={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},AX={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},OX={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},jX={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},PX={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},FX={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},DX=(e,t)=>{const r=Number(e);switch(String(t==null?void 0:t.unit)){case"minute":case"second":return String(r);case"date":return r+"";default:return r+""}},LX={ordinalNumber:DX,era:za({values:NX,defaultWidth:"wide"}),quarter:za({values:AX,defaultWidth:"wide",argumentCallback:e=>e-1}),month:za({values:OX,defaultWidth:"wide"}),day:za({values:jX,defaultWidth:"wide"}),dayPeriod:za({values:PX,defaultWidth:"wide",formattingValues:FX,defaultFormattingWidth:"wide"})},IX=/^(\d+)(|)?/i,MX=/\d+/i,RX={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},BX={any:[/^(bc|)/i,/^(ad|)/i]},UX={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},zX={any:[/1/i,/2/i,/3/i,/4/i]},WX={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},HX={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},$X={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},qX={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},VX={any:/^(am|pm|||||||)/i},GX={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},XX={ordinalNumber:_T({matchPattern:IX,parsePattern:MX,valueCallback:e=>parseInt(e,10)}),era:Wa({matchPatterns:RX,defaultMatchWidth:"wide",parsePatterns:BX,defaultParseWidth:"any"}),quarter:Wa({matchPatterns:UX,defaultMatchWidth:"wide",parsePatterns:zX,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Wa({matchPatterns:WX,defaultMatchWidth:"wide",parsePatterns:HX,defaultParseWidth:"any"}),day:Wa({matchPatterns:$X,defaultMatchWidth:"wide",parsePatterns:qX,defaultParseWidth:"any"}),dayPeriod:Wa({matchPatterns:VX,defaultMatchWidth:"any",parsePatterns:GX,defaultParseWidth:"any"})},fn={code:"ko",formatDistance:bX,formatLong:CX,formatRelative:TX,localize:LX,match:XX,options:{weekStartsOn:0,firstWeekContainsDate:1}},YX=({onSave:e,onCancel:t})=>{const r=xe.useRef(null),[n,i]=xe.useState(!1),[s,l]=xe.useState(!1);xe.useEffect(()=>{const u=r.current;if(!u)return;const p=u.getContext("2d"),m=window.devicePixelRatio||1,g=u.getBoundingClientRect();u.width=g.width*m,u.height=g.height*m,p.scale(m,m),p.strokeStyle="black",p.lineWidth=10,p.lineCap="round"},[]);const o=u=>{const m=r.current.getBoundingClientRect(),g=u.touches?u.touches[0].clientX:u.clientX,x=u.touches?u.touches[0].clientY:u.clientY;return{x:g-m.left,y:x-m.top}},a=u=>{i(!0);const{x:p,y:m}=o(u),g=r.current.getContext("2d");g.strokeStyle="black",g.lineWidth=10,g.lineCap="round",g.beginPath(),g.moveTo(p,m)},c=u=>{if(!n)return;const{x:p,y:m}=o(u),g=r.current.getContext("2d");g.lineTo(p,m),g.stroke(),l(!0)},f=()=>{i(!1)},h=()=>{const u=r.current;u.getContext("2d").clearRect(0,0,u.width,u.height),l(!1)},d=()=>{if(!s){alert("  .");return}r.current.toBlob(p=>{e(p)},"image/png")};return v.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-fade-in",onClick:t,children:v.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden animate-spring-up",onClick:u=>u.stopPropagation(),children:[v.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[v.jsxs("h4",{className:"text-sm font-black text-[#1C1C1E] flex items-center gap-2",children:[v.jsx(G2,{className:"w-4 h-4 text-ios-indigo"}),"  "]}),v.jsx("button",{onClick:t,className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:v.jsx(Ja,{className:"w-5 h-5"})})]}),v.jsxs("div",{className:"p-6 bg-white flex flex-col items-center gap-4",children:[v.jsx("p",{className:"text-xs text-ios-gray mb-2",children:"    ."}),v.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-xl bg-gray-50 touch-none overflow-hidden relative w-full h-[200px]",children:v.jsx("canvas",{ref:r,style:{width:"100%",height:"100%"},onMouseDown:a,onMouseMove:c,onMouseUp:f,onMouseLeave:f,onTouchStart:a,onTouchMove:c,onTouchEnd:f})})]}),v.jsxs("div",{className:"p-4 border-t border-gray-100 flex gap-3 bg-gray-50",children:[v.jsx("button",{onClick:h,className:"flex-1 py-3 bg-white border border-gray-200 text-[#1C1C1E] rounded-xl text-xs font-bold hover:bg-gray-50 transition-all",children:""}),v.jsxs("button",{onClick:d,className:"flex-[2] py-3 bg-[#1C1C1E] text-white rounded-xl text-xs font-bold hover:bg-gray-800 shadow-lg transition-all flex items-center justify-center gap-2",children:[v.jsx(Es,{className:"w-4 h-4"}),"  "]})]})]})})},KX=()=>{const[e,t]=xe.useState(new Date),[r,n]=xe.useState([]),[i,s]=xe.useState([]),[l,o]=xe.useState(null),[a,c]=xe.useState(!1),[f,h]=xe.useState(null),[d,u]=xe.useState([]),[p,m]=xe.useState([]),[g,x]=xe.useState([]),[y,w]=xe.useState({name:"",level:""}),S=e.getMonth()+1<3?e.getFullYear()-1:e.getFullYear(),[T,O]=xe.useState(null),[j,L]=xe.useState(null),[W,F]=xe.useState(null),[M,V]=xe.useState(!1),[G,te]=xe.useState(null),[ee,Q]=xe.useState(""),[K,N]=xe.useState(!1);xe.useEffect(()=>{P(),R(),U()},[]),xe.useEffect(()=>{l&&k()},[S,l]),xe.useEffect(()=>{l&&A()},[e,l]);const U=async()=>{const{data:z}=await He.from("configs").select("value").eq("key","school_info").single();z!=null&&z.value&&w(z.value)},R=async()=>{const{data:z}=await He.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});z&&z.length>0&&(s(z),o(z[0].id))},k=async()=>{const[z,oe,ce]=await Promise.all([He.from("operation_quarters").select("*").eq("academic_year",S).order("quarter",{ascending:!0}),He.from("operation_exceptions").select("*"),He.from("sessions").select("*").eq("zone_id",l).order("start_time",{ascending:!0})]);z.data&&u(z.data),oe.data&&x(oe.data);const{data:we}=await He.from("session_operating_days").select("session_id, day_of_week").in("session_id",(ce.data||[]).map(ye=>ye.id)).eq("is_active",!0);m(we||[])},P=async()=>{const{data:{user:z}}=await He.auth.getUser();if(z){const{data:oe}=await He.from("profiles").select("*").eq("id",z.id).single();h({...z,profile:oe})}},A=async()=>{if(!l)return;c(!0);const z=kf(e).toISOString(),oe=Rd(e).toISOString(),{data:ce,error:we}=await He.from("supervision_assignments").select("*").eq("zone_id",l).gte("date",z).lte("date",oe).order("created_at",{ascending:!0});ce&&n(ce),c(!1)},E=async()=>{if(!ee.trim()||!T||!l)return;const z=rt(T.date,"yyyy-MM-dd"),{error:oe}=await He.from("supervision_assignments").insert([{date:z,supervisor_name:ee.trim(),teacher_id:null,zone_id:l}]);oe?alert("  : "+oe.message):(Q(""),O(null),A())},I=async()=>{if(!ee.trim()||!j)return;const{error:z}=await He.from("supervision_assignments").update({supervisor_name:ee.trim()}).eq("id",j.id);z?alert(" : "+z.message):(Q(""),L(null),A())},H=z=>{if(!z)return null;const oe=z.split("/signatures/");return oe.length>1?oe[1]:null},J=async(z,oe)=>{if(oe.stopPropagation(),!confirm(" ?   ."))return;const ce=r.find(ye=>ye.id===z);if(ce!=null&&ce.signature_url){const ye=H(ce.signature_url);ye&&await He.storage.from("signatures").remove([ye])}const{error:we}=await He.from("supervision_assignments").delete().eq("id",z);we||A()},Y=async z=>{if(!W)return;const oe=r.find(pe=>pe.id===W.assignmentId);if(oe!=null&&oe.signature_url){const pe=H(oe.signature_url);pe&&await He.storage.from("signatures").remove([pe])}const ce=`sig_${W.assignmentId}_${Date.now()}.png`,{data:we,error:ye}=await He.storage.from("signatures").upload(ce,z,{contentType:"image/png",upsert:!0});if(ye){alert("  : "+ye.message);return}const{data:{publicUrl:de}}=He.storage.from("signatures").getPublicUrl(ce),{error:Te}=await He.from("supervision_assignments").update({signature_url:de}).eq("id",W.assignmentId);Te?alert("  : "+Te.message):(F(null),A())},Z=()=>{V(!0)},fe=async z=>{if(!l)return;c(!0);const{data:oe,error:ce}=await He.from("supervision_assignments").select("*").eq("zone_id",l).gte("date",z.start_date).lte("date",z.end_date).order("date",{ascending:!0});if(ce){alert("  : "+ce.message),c(!1);return}te({quarter:z,assignments:oe||[],operatingRules:p,exceptions:g}),V(!1),c(!1),setTimeout(()=>{window.print()},500)},X=()=>v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsxs("div",{className:"flex items-center gap-6",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("h3",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:rt(e,"yyyy M")}),v.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-xl border border-gray-200",children:[v.jsx("button",{onClick:()=>t(mm(e)),className:"p-1.5 hover:bg-white rounded-lg text-ios-gray hover:text-[#1C1C1E] transition-all ios-tap shadow-sm hover:shadow",children:v.jsx(Mo,{className:"w-4 h-4"})}),v.jsx("button",{onClick:()=>t(t0(e,1)),className:"p-1.5 hover:bg-white rounded-lg text-ios-gray hover:text-[#1C1C1E] transition-all ios-tap shadow-sm hover:shadow",children:v.jsx(Ts,{className:"w-4 h-4"})})]})]}),v.jsx("div",{className:"flex items-center gap-2",children:i.map(z=>v.jsx("button",{onClick:()=>o(z.id),className:`px-4 py-2 rounded-lg text-xs font-black transition-all ios-tap ${l===z.id?"bg-[#1C1C1E] text-white shadow-md":"text-ios-gray hover:text-[#1C1C1E]"}`,children:z.name},z.id))})]}),v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group select-none",children:[v.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${K?"bg-[#1C1C1E] border-[#1C1C1E]":"bg-white border-gray-300 group-hover:border-gray-400"}`,children:K&&v.jsx(Es,{className:"w-3 h-3 text-white"})}),v.jsx("input",{type:"checkbox",checked:K,onChange:z=>N(z.target.checked),className:"hidden"}),v.jsx("span",{className:"text-xs font-bold text-ios-gray group-hover:text-[#1C1C1E] transition-colors",children:" "})]}),v.jsxs("button",{onClick:Z,className:"flex items-center gap-2 bg-[#1C1C1E] text-white px-4 py-2 rounded-lg font-bold text-xs transition-all shadow-lg hover:bg-gray-800 hover:shadow-xl ios-tap",children:[v.jsx(Fl,{className:"w-3.5 h-3.5"}),"  "]})]})]}),re=()=>{const z=["","","","","","",""],oe=K?z:z.filter((ce,we)=>we!==0&&we!==6);return v.jsx("div",{className:`grid ${K?"grid-cols-7":"grid-cols-5"} mb-2 border-b border-gray-100`,children:oe.map((ce,we)=>v.jsx("div",{className:`py-3 text-[10px] font-black uppercase text-center tracking-widest ${K&&we===0?"text-ios-rose":K&&we===6?"text-ios-indigo":"text-ios-gray"}`,children:ce},we))})},se=()=>{const z=kf(e),oe=Rd(z),ce=Bn(z),we=jo(oe),ye=eu({start:ce,end:we});return v.jsx("div",{className:`grid ${K?"grid-cols-7":"grid-cols-5"} gap-px bg-gray-100 border border-gray-100 rounded-[12px] overflow-hidden shadow-sm`,children:ye.filter(de=>K||de.getDay()!==0&&de.getDay()!==6).map((de,Te)=>{var et;const pe=Vy(de),Ae=Yv(de,z),Ie=de.getDay(),je=rt(de,"yyyy-MM-dd"),Le=r.filter(Ge=>Ge.date===je),Xe=g.find(Ge=>Ge.exception_date===je),Je=d.find(Ge=>Ge.start_date&&Ge.end_date&&Wc(de,{start:Cr(Ge.start_date),end:Cr(Ge.end_date)})),Ne=p.filter(Ge=>Ge.day_of_week===Ie),Oe=Je&&!Xe&&Ne.length>0,De=Ne.length<=2,Ye=Oe?De?1:2:0,it=((et=f==null?void 0:f.profile)==null?void 0:et.role)==="admin",Ke=it||pe;return v.jsxs("div",{className:`h-[200px] p-2 flex flex-col gap-2 transition-colors border-b border-r border-gray-100 ${Ae?Oe?"bg-white":"bg-gray-50":"bg-gray-50/50 opacity-40"}`,children:[v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsx("span",{className:`text-[12px] font-black ${pe?"w-6 h-6 text-ios-indigo border-2 border-ios-indigo rounded-full flex items-center justify-center -mt-1 -ml-1 bg-white":Ie===0?"text-ios-rose":Ie===6?"text-ios-indigo":"text-[#1C1C1E]"}`,children:rt(de,"d")}),it&&Oe&&Le.length<Ye&&v.jsx("button",{onClick:()=>O({date:de}),className:"w-5 h-5 flex items-center justify-center rounded-full bg-[#1C1C1E] text-white hover:bg-gray-800 transition-all ios-tap shadow-sm",title:" ",children:v.jsx(dd,{className:"w-3 h-3"})})]}),v.jsx("div",{className:"flex-1 flex flex-col gap-1.5 overflow-y-auto scrollbar-hide",children:Le.map(Ge=>{var ot;return v.jsxs("div",{className:"relative group bg-gray-50 rounded-[8px] p-2 border border-dashed border-gray-200 hover:border-ios-indigo/30 transition-all",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("span",{className:"text-[11px] font-bold text-[#1C1C1E]",children:Ge.supervisor_name}),it&&v.jsxs("div",{className:"opacity-0 group-hover:opacity-100 flex items-center transition-opacity",children:[v.jsx("button",{onClick:_t=>{_t.stopPropagation(),Q(Ge.supervisor_name),L({id:Ge.id,name:Ge.supervisor_name,date:de})},className:"p-1 text-gray-400 hover:text-ios-indigo transition-colors",title:" ",children:v.jsx(K8,{className:"w-3 h-3"})}),v.jsx("button",{onClick:_t=>J(Ge.id,_t),className:"p-1 text-gray-400 hover:text-ios-rose transition-colors",title:"",children:v.jsx(Dl,{className:"w-3 h-3"})})]})]}),Ge.signature_url?v.jsxs("div",{className:"relative h-8 flex items-center",children:[v.jsx("img",{src:Ge.signature_url,alt:"",className:"h-full object-contain opacity-80"}),it&&v.jsx("button",{onClick:()=>F({assignmentId:Ge.id}),className:"absolute inset-0 bg-black/5 opacity-0 hover:opacity-100 flex items-center justify-center text-[9px] text-[#1C1C1E] font-black rounded backdrop-blur-[1px]",children:""})]}):v.jsx("div",{className:"h-8 flex items-center justify-center",children:it||((ot=f==null?void 0:f.profile)==null?void 0:ot.full_name)===Ge.supervisor_name&&Ke?v.jsxs("button",{onClick:()=>F({assignmentId:Ge.id}),className:"w-full h-full border border-dashed border-ios-indigo/30 rounded flex items-center justify-center gap-1 text-[9px] text-ios-indigo font-bold hover:bg-ios-indigo/5 transition-colors",children:[v.jsx(G2,{className:"w-3 h-3"})," "]}):!pe&&rX(de)?v.jsx("span",{className:"text-[9px] text-red-500 font-bold",children:""}):v.jsx("span",{className:"text-[9px] text-gray-300 font-medium",children:" "})})]},Ge.id)})})]},Te)})})};return v.jsxs("div",{className:"h-full flex flex-col p-6 animate-spring-up overflow-hidden relative print:hidden",children:[v.jsxs("div",{className:"flex-none",children:[X(),re()]}),v.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide -mr-2 pr-2",children:se()}),T&&v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm p-4 animate-fade-in",onClick:()=>O(null),children:v.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-xs overflow-hidden animate-spring-up",onClick:z=>z.stopPropagation(),children:[v.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[v.jsxs("h4",{className:"text-sm font-black text-[#1C1C1E]",children:[rt(T.date,"M d"),"  "]}),v.jsx("button",{onClick:()=>O(null),className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:v.jsx(Ja,{className:"w-4 h-4"})})]}),v.jsxs("div",{className:"p-4 space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-[10px] font-bold text-ios-gray uppercase tracking-wider mb-2",children:"  "}),v.jsx("input",{type:"text",value:ee,onChange:z=>Q(z.target.value),placeholder:" ",className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 text-sm font-bold text-[#1C1C1E] focus:outline-none focus:ring-2 focus:ring-ios-indigo/50 transition-all",onKeyDown:z=>z.key==="Enter"&&E(),autoFocus:!0})]}),v.jsx("button",{onClick:E,className:"w-full py-3 bg-[#1C1C1E] text-white rounded-xl text-xs font-bold hover:bg-gray-800 shadow-lg transition-all",children:""})]})]})}),j&&v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm p-4 animate-fade-in",onClick:()=>L(null),children:v.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-xs overflow-hidden animate-spring-up",onClick:z=>z.stopPropagation(),children:[v.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[v.jsx("h4",{className:"text-sm font-black text-[#1C1C1E]",children:"  "}),v.jsx("button",{onClick:()=>L(null),className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:v.jsx(Ja,{className:"w-4 h-4"})})]}),v.jsxs("div",{className:"p-4 space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-[10px] font-bold text-ios-gray uppercase tracking-wider mb-2",children:" "}),v.jsx("input",{type:"text",value:ee,onChange:z=>Q(z.target.value),placeholder:" ",className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 text-sm font-bold text-[#1C1C1E] focus:outline-none focus:ring-2 focus:ring-ios-indigo/50 transition-all",onKeyDown:z=>z.key==="Enter"&&I(),autoFocus:!0})]}),v.jsx("button",{onClick:I,className:"w-full py-3 bg-[#1C1C1E] text-white rounded-xl text-xs font-bold hover:bg-gray-800 shadow-lg transition-all",children:" "})]})]})}),W&&v.jsx(YX,{onSave:Y,onCancel:()=>F(null)}),M&&v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm p-4 animate-fade-in",onClick:()=>V(!1),children:v.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm overflow-hidden animate-spring-up",onClick:z=>z.stopPropagation(),children:[v.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[v.jsxs("h4",{className:"text-sm font-black text-[#1C1C1E] flex items-center gap-2",children:[v.jsx(Fl,{className:"w-4 h-4 text-ios-indigo"}),"  "]}),v.jsx("button",{onClick:()=>V(!1),className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:v.jsx(Ja,{className:"w-5 h-5"})})]}),v.jsxs("div",{className:"p-4 max-h-[60vh] overflow-y-auto",children:[v.jsx("p",{className:"text-xs text-ios-gray mb-4",children:" /  ."}),v.jsxs("div",{className:"grid gap-2",children:[d.map(z=>v.jsx("button",{onClick:()=>fe(z),className:"w-full p-3 rounded-xl border border-gray-100 hover:border-ios-indigo/50 hover:bg-ios-indigo/5 transition-all text-left group",children:v.jsxs("span",{className:"text-sm font-bold text-[#1C1C1E] group-hover:text-ios-indigo",children:[z.quarter_name?`${z.quarter_name}: `:"",z.start_date," ~ ",z.end_date]})},z.id)),d.length===0&&v.jsx("div",{className:"text-center py-6 text-gray-300 text-xs",children:"   ."})]})]})]})}),G&&hg.createPortal(v.jsxs("div",{id:"print-root",className:"bg-white text-black hidden print:block",children:[v.jsx("style",{children:`
                            @media print {
                                @page { size: A4 portrait; margin: 0; }
                                body { 
                                    margin: 0 !important;
                                    padding: 0 !important;
                                    background-color: white !important;
                                    font-family: 'Malgun Gothic', 'Dotum', 'Apple SD Gothic Neo', sans-serif !important;
                                    -webkit-print-color-adjust: exact !important;
                                    print-color-adjust: exact !important;
                                    color: #000000 !important;
                                }
                                body > #root {
                                    display: none !important;
                                }
                                body > #print-root {
                                    display: block !important;
                                    width: 210mm !important;
                                    min-height: 297mm !important;
                                    padding: 10mm !important;
                                    box-sizing: border-box !important;
                                    background-color: white !important;
                                    font-family: 'Malgun Gothic', 'Dotum', 'Apple SD Gothic Neo', sans-serif !important;
                                }
                                /* Force solid borders */
                                * {
                                    border-color: #000000 !important;
                                    border-style: solid !important;
                                }
                                /* Ensure text is strictly black */
                                .print-text-black {
                                    color: #000000 !important;
                                }
                            }
                            #print-root {
                                display: none;
                            }
                        `}),v.jsxs("div",{className:"flex flex-col w-full h-full bg-white relative",children:[v.jsxs("div",{className:"flex-none mb-2 text-center",children:[v.jsx("h1",{className:"text-[20pt] font-black tracking-widest mb-1 underline decoration-2 underline-offset-4 text-black",children:"  "}),v.jsxs("div",{className:"flex justify-between items-end border-b-2 border-black pb-1 mb-1 relative",children:[v.jsxs("span",{className:"text-[9pt] font-bold text-black absolute left-0 bottom-1",children:[G.quarter.quarter_name," (",G.quarter.start_date," ~ ",G.quarter.end_date,")"]}),v.jsx("span",{className:"w-full text-center text-[8pt] text-transparent",children:"."}),v.jsxs("span",{className:"text-[8pt] text-black absolute right-0 bottom-1",children:[": ",rt(new Date,"yyyy. MM. dd.")]})]})]}),v.jsx("div",{className:"flex-1 flex gap-2 items-start justify-center w-full",children:(()=>{try{const z=Cr(G.quarter.start_date),oe=Cr(G.quarter.end_date);return!zp(z)||!zp(oe)?v.jsx("div",{className:"w-full text-center p-10 text-red-500 font-bold",children:"   ."}):dV({start:z,end:oe}).map((ce,we)=>{const ye=Array.from({length:31},(de,Te)=>{const pe=Te+1;try{const Ae=vX(ce,pe);return!zp(Ae)||!Yv(Ae,ce)?null:Ae}catch{return null}});return v.jsx("div",{className:"flex-1 h-full flex flex-col min-w-0",children:v.jsxs("table",{className:"w-full border-collapse table-fixed border border-black",children:[v.jsxs("colgroup",{children:[v.jsx("col",{style:{width:"12%"}}),v.jsx("col",{style:{width:"22%"}}),v.jsx("col",{style:{width:"22%"}}),v.jsx("col",{style:{width:"22%"}}),v.jsx("col",{style:{width:"22%"}})]}),v.jsxs("thead",{children:[v.jsx("tr",{className:"bg-[#E5E7EB]",children:v.jsx("th",{colSpan:5,className:"border border-black text-center font-bold py-1 text-[10pt] text-black",children:rt(ce,"M")})}),v.jsxs("tr",{className:"bg-[#F3F4F6] text-[7pt] text-black font-bold h-[8mm]",children:[v.jsx("th",{rowSpan:2,className:"border border-black text-center align-middle",children:""}),v.jsx("th",{colSpan:2,className:"border border-black text-center align-middle h-[4mm]",children:" 1"}),v.jsx("th",{colSpan:2,className:"border border-black text-center align-middle h-[4mm]",children:" 2"})]}),v.jsxs("tr",{className:"bg-[#F3F4F6] text-[7pt] text-black font-bold h-[4mm]",children:[v.jsx("th",{className:"border border-black text-center align-middle",children:""}),v.jsx("th",{className:"border border-black text-center align-middle",children:""}),v.jsx("th",{className:"border border-black text-center align-middle",children:""}),v.jsx("th",{className:"border border-black text-center align-middle",children:""})]})]}),v.jsx("tbody",{children:ye.map((de,Te)=>{if(!de)return v.jsxs("tr",{className:"h-[7mm] bg-gray-100/30",children:[v.jsx("td",{className:"border border-black"}),v.jsx("td",{className:"border border-black"}),v.jsx("td",{className:"border border-black"}),v.jsx("td",{className:"border border-black"}),v.jsx("td",{className:"border border-black"})]},Te);const pe=rt(de,"yyyy-MM-dd"),Ae=rt(de,"E",{locale:fn}),Ie=G.assignments.filter(Oe=>Oe.date===pe),je=Ie[0],Le=Ie[1],Xe=G.exceptions.find(Oe=>Oe.exception_date===pe),Ne=Wc(de,{start:Cr(G.quarter.start_date),end:Cr(G.quarter.end_date)})&&!Xe&&G.operatingRules.some(Oe=>Oe.day_of_week===de.getDay());return v.jsxs("tr",{className:"h-[7mm] text-[7pt] text-black",children:[v.jsxs("td",{className:`border border-black text-center font-bold tracking-tighter align-middle p-0 ${Ae===""?"text-blue-700":Ae===""?"text-red-600":"text-black"}`,children:[rt(de,"d"),"(",Ae,")"]}),v.jsx("td",{className:"border border-black text-center break-all align-middle p-0.5",children:Ne?(je==null?void 0:je.supervisor_name)||"":"-"}),v.jsx("td",{className:"border border-black text-center align-middle p-0.5",children:Ne&&(je==null?void 0:je.signature_url)&&v.jsx("img",{src:je.signature_url,className:"max-h-[18px] w-auto mx-auto object-contain",alt:""})}),v.jsx("td",{className:"border border-black text-center break-all align-middle p-0.5",children:Ne&&(Le==null?void 0:Le.supervisor_name)||""}),v.jsx("td",{className:"border border-black text-center align-middle p-0.5",children:Ne&&(Le==null?void 0:Le.signature_url)&&v.jsx("img",{src:Le.signature_url,className:"max-h-[18px] w-auto mx-auto object-contain",alt:""})})]},Te)})})]})},we)})}catch{return v.jsx("div",{className:"w-full text-center text-red-500",children:"  "})}})()}),v.jsxs("div",{className:"mt-2 text-center text-[9pt] font-bold flex-none text-black",children:["      .  ",y.name?`${y.name}${y.level||""}`:"GOE",""]})]})]}),document.body)]})},JX=({onSave:e,onCancel:t,teacherName:r})=>{const n=xe.useRef(null),[i,s]=xe.useState(!1),[l,o]=xe.useState(!1);xe.useEffect(()=>{const u=n.current;if(!u)return;const p=u.getContext("2d"),m=window.devicePixelRatio||1,g=u.getBoundingClientRect();u.width=g.width*m,u.height=g.height*m,p.scale(m,m),p.strokeStyle="#1C1C1E",p.lineWidth=10,p.lineCap="round",p.lineJoin="round"},[]);const a=u=>{const m=n.current.getBoundingClientRect(),g=u.touches?u.touches[0].clientX:u.clientX,x=u.touches?u.touches[0].clientY:u.clientY;return{x:g-m.left,y:x-m.top}},c=u=>{s(!0);const{x:p,y:m}=a(u),g=n.current.getContext("2d");g.beginPath(),g.moveTo(p,m)},f=u=>{if(!i)return;const{x:p,y:m}=a(u),g=n.current.getContext("2d");g.lineTo(p,m),g.stroke(),o(!0)},h=()=>s(!1),d=()=>{if(!l)return alert("  .");n.current.toBlob(p=>e(p),"image/png")};return v.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-md flex flex-col justify-end",children:v.jsxs("div",{className:"bg-white/90 backdrop-blur-2xl rounded-t-[32px] p-6 mobile-slide-up h-[70vh] border-t border-white/20",children:[v.jsxs("div",{className:"flex justify-between items-center mb-8",children:[v.jsxs("div",{children:[v.jsxs("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:[r,""]}),v.jsx("p",{className:"text-ios-gray text-sm font-bold opacity-70",children:"     ."})]}),v.jsx("button",{onClick:t,className:"p-2.5 bg-gray-100/50 rounded-apple-md ios-tap",children:v.jsx(Ja,{className:"w-5 h-5 text-ios-gray"})})]}),v.jsx("div",{className:"mobile-signature-pad mb-8",children:v.jsx("canvas",{ref:n,style:{width:"100%",height:"100%"},onMouseDown:c,onMouseMove:f,onMouseUp:h,onMouseLeave:h,onTouchStart:c,onTouchMove:f,onTouchEnd:h})}),v.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[v.jsx("button",{onClick:()=>{n.current.getContext("2d").clearRect(0,0,n.current.width,n.current.height),o(!1)},className:"py-4 bg-gray-100/80 text-[#1C1C1E] rounded-apple-md font-black ios-tap",children:" "}),v.jsx("button",{onClick:d,className:"py-4 bg-[#007AFF] text-white rounded-apple-md font-black ios-tap shadow-lg shadow-blue-500/20",children:" "})]})]})})},QX=({onLogout:e,currentUser:t})=>{const r=xe.useRef(null),[n,i]=xe.useState("menu"),[s,l]=xe.useState(!0),[o,a]=xe.useState([]),[c,f]=xe.useState(null),[h,d]=xe.useState(!1),[u,p]=xe.useState([]),m={A:xe.useRef(null),B:xe.useRef(null),C:xe.useRef(null)},[g,x]=xe.useState([]),[y,w]=xe.useState(null),[b,S]=xe.useState([]),[T,O]=xe.useState(null),[j,L]=xe.useState(rt(new Date,"yyyy-MM-dd")),W=rt(new Date,"yyyy-MM-dd");xe.useEffect(()=>{F()},[]),xe.useEffect(()=>{G()},[j]),xe.useEffect(()=>{T&&te()},[T]),xe.useEffect(()=>{y&&(n==="attendance"||n==="seatmap")&&ee()},[y,n,j,T]);const F=async()=>{l(!0);const{data:H}=await He.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});let J=rt(new Date,"yyyy-MM-dd");if(H&&H.length>0){S(H);const Z=H[0].id;O(Z);const[fe,X,re]=await Promise.all([He.from("operation_quarters").select("*"),He.from("operation_exceptions").select("*").eq("zone_id",Z),He.from("sessions").select("id").eq("zone_id",Z)]);if(re.data&&re.data.length>0){const{data:se}=await He.from("session_operating_days").select("session_id, day_of_week").in("session_id",re.data.map(z=>z.id)).eq("is_active",!0);J=M(new Date,fe.data||[],X.data||[],se||[]),L(J)}}const{data:Y}=await He.from("supervision_assignments").select("*").eq("date",J);Y&&a(Y),l(!1)},M=(H,J,Y,Z)=>{let fe=Ga(H);for(let X=0;X<30;X++){const re=rt(fe,"yyyy-MM-dd");if(V(fe,J,Y,Z))return re;fe=Ss(fe,1)}return rt(H,"yyyy-MM-dd")},V=(H,J,Y,Z)=>{const fe=rt(H,"yyyy-MM-dd");if(J.length>0&&!J.some(se=>se.start_date&&se.end_date&&Wc(H,{start:Cr(se.start_date),end:Cr(se.end_date)}))||Y.some(re=>re.exception_date===fe))return!1;if(Z.length>0){const re=H.getDay();if(!Z.some(z=>z.day_of_week===re))return!1}return!0},G=async()=>{const{data:H,error:J}=await He.from("supervision_assignments").select("*").eq("date",j);H&&a(H),l(!1)},te=async()=>{var J;if(!T)return;const{data:H}=await He.from("sessions").select("*").eq("zone_id",T).order("start_time",{ascending:!0});if(H&&H.length>0){x(H);const Y=rt(new Date,"HH:mm:ss");let Z=null;for(let fe=0;fe<H.length;fe++){const X=H[fe],re=fe>0?H[fe-1]:null;if(re){if(Y>re.end_time&&Y<=X.end_time){Z=X;break}}else if(Y>="07:00:00"&&Y<=X.end_time){Z=X;break}}w(Z?Z.id:(J=H[0])==null?void 0:J.id)}},ee=async()=>{l(!0);const{data:H,error:J}=await He.from("seats").select("*, zone_color").order("seat_number",{ascending:!0});if(J){console.error("Error fetching seats:",J),l(!1);return}const{data:Y,error:Z}=await He.from("bookings").select(`
                id, seat_id, session_id,
                profiles (full_name, username, grade),
                profiles_student (full_name, username, grade),
                attendance (id, status, timestamp_in, timestamp_out)
            `).eq("date",j);if(H){const fe=H.map(X=>{var ce;const re=(Y||[]).find(we=>we.seat_id===X.id&&we.session_id===y),se=(Y||[]).some(we=>we.seat_id===X.id),z=(ce=re==null?void 0:re.attendance)==null?void 0:ce[0],oe=(re==null?void 0:re.profiles_student)||(re==null?void 0:re.profiles);return{seat_id:X.id,place_id:X.zone_id,zone_id:X.zone_id,seat_number:X.seat_number,display_number:X.display_number,zone_name:X.zone_name,zone_color:X.zone_color,booking_id:re==null?void 0:re.id,full_name:oe==null?void 0:oe.full_name,username:oe==null?void 0:oe.username,grade:oe==null?void 0:oe.grade,attendance_id:z==null?void 0:z.id,status:(z==null?void 0:z.status)||"absent",timestamp_in:z==null?void 0:z.timestamp_in,timestamp_out:z==null?void 0:z.timestamp_out,is_active:!!re,is_booked_today:se}});fe.sort((X,re)=>(X.seat_number||"").localeCompare(re.seat_number||"",void 0,{numeric:!0,sensitivity:"base"})),p(fe)}l(!1)},Q=async H=>{const J=`sig_duty_${c.id}_${Date.now()}.png`,{error:Y}=await He.storage.from("signatures").upload(J,H,{contentType:"image/png"});if(Y)return alert("  ");const{data:{publicUrl:Z}}=He.storage.from("signatures").getPublicUrl(J),{error:fe}=await He.from("supervision_assignments").update({signature_url:Z}).eq("id",c.id);fe||(d(!1),G())},K=()=>{const H=new Date,J=9*60*60*1e3;return new Date(H.getTime()+J).toISOString().replace("Z","+09:00")},N=async H=>{if(H.status!=="absent")return;const Y={id:H.attendance_id,booking_id:H.booking_id,status:"present",updated_at:new Date().toISOString()};if(!H.timestamp_in){const X=g.find(re=>re.id===y);X?(Y.timestamp_in=`${W}T${X.start_time}+09:00`,Y.status="present"):Y.timestamp_in=K()}const{data:Z,error:fe}=await He.from("attendance").upsert(Y,{onConflict:"booking_id"}).select().single();!fe&&Z?p(X=>X.map(re=>re.booking_id===H.booking_id?{...re,status:Z.status,attendance_id:Z.id,timestamp_in:Z.timestamp_in}:re)):ee()},U=async H=>{if(H.attendance_id)try{const{error:J}=await He.from("attendance").delete().eq("id",H.attendance_id);if(J)throw J;ee()}catch(J){console.error("Error resetting attendance:",J)}},R=()=>{e&&e()},k=H=>{const J=new Date(j);J.setDate(J.getDate()+H),L(rt(J,"yyyy-MM-dd"))};xe.useEffect(()=>{},[n]);const P=()=>{const H=b.find(fe=>fe.id===T),J=(H==null?void 0:H.name)||"";rt(new Date,"yyyy M d"),["","","","","","",""][new Date().getDay()],H!=null&&H.code,H!=null&&H.name;const Y=u.filter(fe=>fe.status==="present").length,Z=u.filter(fe=>fe.is_active&&(fe.status==="absent"||!fe.status)).length;return v.jsxs("header",{className:"flex-none glass-header px-6 pt-4 pb-4 flex flex-col gap-5 z-50",children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsxs("div",{className:"flex flex-col",children:[v.jsx("h1",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:" "}),v.jsx("p",{className:"text-[10px] font-black text-ios-indigo tracking-[0.2em] uppercase opacity-70",children:"Study Cafe Manager"})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[n==="attendance"&&v.jsx("button",{onClick:()=>i("seatmap"),className:"px-3 py-2.5 bg-ios-indigo/10 text-ios-indigo rounded-apple-md ios-tap border border-ios-indigo/10 text-[12px] font-black whitespace-nowrap",children:" "}),n!=="menu"?v.jsx("button",{onClick:()=>i(n==="seatmap"?"attendance":"menu"),className:"px-4 py-2.5 bg-gray-200/20 text-ios-gray rounded-apple-md ios-tap border border-white/40 text-[13px] font-black",children:n==="seatmap"?"":""}):v.jsx("button",{onClick:R,className:"p-2.5 bg-ios-rose/10 text-ios-rose rounded-apple-md ios-tap border border-ios-rose/10",children:v.jsx(fd,{className:"w-5 h-5"})})]})]}),(n==="attendance"||n==="seatmap"||n==="supervision")&&v.jsxs("div",{className:"flex flex-col gap-5 animate-in fade-in slide-in-from-top-4 duration-300",children:[v.jsxs("div",{className:"flex gap-2 items-stretch",children:[v.jsx("div",{className:"flex-1 bg-[#1C1C1E] p-1 rounded-apple-md border border-white/10 flex items-center justify-center min-h-[38px] shadow-sm",children:v.jsx("span",{className:"text-[12px] font-black text-white px-2",children:J})}),v.jsxs("div",{className:"flex-[2] flex items-center justify-between bg-gray-200/20 px-2 rounded-apple-md border border-white/40 backdrop-blur-xl min-h-[38px]",children:[v.jsx("button",{onClick:()=>k(-1),className:"w-8 h-8 flex items-center justify-center text-ios-gray ios-tap",children:v.jsx(Mo,{className:"w-4 h-4"})}),v.jsxs("span",{className:"text-[13px] font-black text-[#1C1C1E]",children:[j," (",["","","","","","",""][new Date(j).getDay()],")"]}),v.jsx("button",{onClick:()=>k(1),className:"w-8 h-8 flex items-center justify-center text-ios-gray ios-tap",children:v.jsx(Ts,{className:"w-4 h-4"})})]})]}),(n==="attendance"||n==="seatmap")&&v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"flex bg-gray-200/20 p-1 rounded-apple-md border border-white/40 overflow-x-auto scrollbar-hide",children:g.map(fe=>v.jsx("button",{onClick:()=>w(fe.id),className:`flex-1 px-3 py-2.5 rounded-apple-md text-xs font-black whitespace-nowrap transition-all ios-tap ${y===fe.id?"bg-ios-indigo text-white shadow-lg shadow-ios-indigo/20":"bg-white/50 text-ios-gray border border-gray-100"}`,children:fe.name},fe.id))}),v.jsxs("div",{className:"flex gap-3 h-20",children:[v.jsxs("div",{className:"flex-1 bg-white shadow-sm border border-gray-100 rounded-apple p-3 flex flex-col justify-center items-center font-black",children:[v.jsx("span",{className:"text-[10px] text-ios-blue uppercase tracking-wider mb-1",children:" "}),v.jsxs("span",{className:"text-2xl text-[#1C1C1E]",children:[Y,""]})]}),v.jsxs("div",{className:"flex-1 bg-white shadow-sm border border-gray-100 rounded-apple p-3 flex flex-col justify-center items-center font-black",children:[v.jsx("span",{className:"text-[10px] text-ios-rose uppercase tracking-wider mb-1",children:"/"}),v.jsxs("span",{className:"text-2xl text-[#1C1C1E]",children:[Z,""]})]})]})]})]})]})},A=()=>v.jsxs("div",{className:"mobile-menu-container",children:[v.jsxs("div",{className:"mobile-menu-grid",children:[v.jsxs("button",{onClick:()=>i("supervision"),className:"mobile-menu-btn",children:[v.jsx("div",{className:"mobile-menu-btn-icon bg-blue-50",children:v.jsx(G2,{className:"w-8 h-8 text-[#007AFF]"})}),v.jsx("span",{className:"mobile-menu-btn-text",children:" "})]}),v.jsxs("button",{onClick:()=>i("attendance"),className:"mobile-menu-btn",children:[v.jsx("div",{className:"mobile-menu-btn-icon bg-rose-50",children:v.jsx(Es,{className:"w-8 h-8 text-[#FF3B30]"})}),v.jsx("span",{className:"mobile-menu-btn-text",children:" "})]})]}),W&&v.jsx("div",{className:"text-center",children:v.jsxs("p",{className:"text-sm font-bold text-gray-400",children:[" ",rt(new Date,"yyyy M d")," ."]})})]}),E=()=>{const H=new Date,J=rt(H,"HH:mm:ss"),Y=g.length>0?g.reduce((oe,ce)=>ce.end_time>oe?ce.end_time:oe,"00:00:00"):"23:59:59",Z=rt(H,"yyyy-MM-dd"),fe=j<Z,X=j===Z,re=j>Z,se=(t==null?void 0:t.role)!=="admin"&&(fe||X&&J>Y),z=(t==null?void 0:t.role)!=="admin"&&re;return v.jsx("main",{className:"flex-1 flex flex-col h-full overflow-hidden",style:{padding:"0 1rem 1rem 1rem"},children:v.jsxs("div",{className:"flex-1 flex flex-col gap-4 h-full overflow-y-auto pb-6 pt-2",children:[o.map((oe,ce)=>v.jsx("div",{className:"flex-1 min-h-[300px] bg-white rounded-[32px] p-6 border border-gray-100 shadow-sm flex flex-col items-center justify-center",children:v.jsxs("div",{className:"flex flex-col items-center gap-4 w-full",children:[v.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center shadow-inner",children:v.jsx(gd,{className:"w-8 h-8 text-[#8E8E93]"})}),v.jsxs("div",{className:"text-center",children:[v.jsxs("h3",{className:"text-lg font-black text-[#1C1C1E]",children:[oe.supervisor_name," "]}),oe.signature_url?v.jsxs("p",{className:"mt-1.5 text-xs font-bold text-emerald-500 flex items-center justify-center gap-1.5",children:[v.jsx(Es,{className:"w-4 h-4"}),"   "]}):v.jsx("p",{className:"mt-1.5 text-xs font-bold text-[#FF9500]",children:"   "})]}),!oe.signature_url&&(z?v.jsx("div",{className:"w-full py-5 bg-gray-50 text-gray-400 rounded-2xl text-center border border-gray-100",children:v.jsx("p",{className:"text-sm font-bold",children:"  ."})}):se?v.jsx("div",{className:"w-full py-5 bg-gray-50 text-gray-400 rounded-2xl text-center border border-gray-100",children:v.jsx("p",{className:"text-sm font-bold",children:"     ."})}):v.jsx("button",{onClick:()=>{f(oe),d(!0)},className:"w-full py-5 bg-[#007AFF] text-white rounded-2xl text-base font-black mobile-tap-feedback shadow-lg shadow-blue-100",children:""})),oe.signature_url&&v.jsx("div",{className:"w-full bg-gray-50 rounded-2xl p-4 flex items-center justify-center border border-dashed border-gray-200 min-h-[100px]",children:v.jsx("img",{src:oe.signature_url,alt:"Signature",className:"max-h-16 opacity-60 object-contain"})})]})},oe.id)),o.length===1&&v.jsx("div",{className:"flex-1 min-h-0 p-6 border border-transparent opacity-0 pointer-events-none"}),o.length===0&&v.jsx("div",{className:"flex-1 bg-white rounded-[32px] border border-dashed border-gray-200 text-gray-400 text-center flex items-center justify-center p-6",children:v.jsx("p",{className:"text-base font-bold",children:"    ."})})]})})},I=()=>v.jsxs("main",{className:"mobile-attendance-list",children:[v.jsx("div",{className:"mobile-zone-grid",children:["A","B","C"].map(H=>{var fe;const J=`${H} zone`,Y=u.filter(X=>X.zone_name===J||X.zone_name===H||X.seat_number&&X.seat_number.startsWith(H)),Z=H==="A"?"#34C759":H==="B"?"#FF9500":"#FF3B30";return v.jsxs("div",{className:"zone-column",ref:m[H],children:[v.jsxs("div",{className:"zone-title-bar",style:{backgroundColor:((fe=Y[0])==null?void 0:fe.zone_color)||Z},children:[H," ZONE"]}),v.jsx("div",{className:"zone-divider"}),v.jsx("div",{className:"zone-seats-list",children:Y.map(X=>{const re=X.is_active?"tier-active":X.is_booked_today?"tier-reserved":"tier-empty",se=X.zone_color||Z,z=X.status==="present"?"green":"red";return v.jsxs("div",{className:`mobile-grid-card ${re}`,children:[v.jsxs("div",{className:"grid-card-header",style:{backgroundColor:se},children:[X.display_number||X.seat_number.replace(`${H}-`,""),X.is_active&&v.jsx("div",{className:`status-dot ${z}`})]}),v.jsx("div",{className:"grid-card-body",children:X.full_name?v.jsxs(v.Fragment,{children:[v.jsx("span",{className:"grid-card-student",children:X.full_name}),v.jsx("span",{className:"grid-card-id",children:X.username||" "})]}):v.jsx("span",{className:"grid-card-info text-gray-300",children:""})}),v.jsx("div",{className:"grid-card-footer",children:X.full_name?X.status==="absent"?v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"grid-status-btn status-absent-btn",children:""}),v.jsx("button",{className:"grid-action-btn",onClick:()=>N(X),style:{backgroundColor:se},children:""})]}):v.jsxs(v.Fragment,{children:[v.jsx("div",{className:`grid-status-btn ${X.status==="present"?"status-present-active":X.status==="late"?"status-late-active":"status-early-active"}`,style:{backgroundColor:X.status==="present"?se:void 0},children:(()=>{const oe=g.find(we=>we.id===y),ce=rt(new Date,"HH:mm:ss");return X.status==="present"?oe&&ce>oe.end_time?"":"":X.status==="late"?"":""})()}),v.jsx("button",{className:"grid-action-btn subtle",onClick:()=>U(X),children:""})]}):v.jsx("div",{className:"grid-status-btn status-absent-btn opacity-20",children:"-"})})]},X.seat_id)})})]},H)})}),u.length===0&&!s&&v.jsxs("div",{className:"text-center py-12",children:[v.jsx(Qa,{className:"w-8 h-8 text-gray-200 mx-auto mb-2"}),v.jsx("p",{className:"text-xs text-gray-300 font-bold",children:"   ."})]})]});return v.jsxs("div",{className:"mobile-dashboard-container h-[100dvh] overflow-hidden flex flex-col",children:[P(),s&&v.jsx("div",{className:"flex-1 flex items-center justify-center",children:v.jsx("p",{className:"text-sm font-bold text-gray-400",children:" ..."})}),!s&&n==="menu"&&A(),!s&&n==="supervision"&&E(),!s&&n==="attendance"&&I(),!s&&n==="seatmap"&&v.jsx("div",{ref:r,className:"mobile-seatmap-container flex-1 scrollbar-hide bg-[#F2F2F7] relative overflow-auto",children:v.jsx("div",{className:"mobile-seatmap-content bg-white shadow-xl",children:v.jsx(yT,{isMobileView:!0,externalZoneId:T,externalDate:j,externalSessionId:y})})}),h&&v.jsx(JX,{teacherName:c==null?void 0:c.supervisor_name,onSave:Q,onCancel:()=>d(!1)})]})},LT=({onSelectSeat:e,selectedProxyUser:t,viewDate:r,onDateChange:n,selectedZoneId:i,onZoneChange:s,minimal:l=!1})=>{const o=xe.useRef(null),a=xe.useRef(null),[c,f]=xe.useState(null),[h,d]=xe.useState([]),[u,p]=xe.useState(!1),[m,g]=xe.useState(null),[x,y]=xe.useState([]),[w,b]=xe.useState({quarters:[],exceptions:[],operatingRules:[]});xe.useEffect(()=>{S()},[]);const S=async()=>{const{data:{user:F}}=await He.auth.getUser();if(F){const{data:V}=await He.from("profiles").select("*").eq("id",F.id).single();g(V)}const{data:M}=await He.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});M&&M.length>0&&(d(M),i||s(M[0].id))};xe.useEffect(()=>{if(!i)return;let F=!0;return f(null),e&&e(null),a.current&&a.current.clear(),(async()=>{const[V,G,te]=await Promise.all([He.from("operation_quarters").select("*"),He.from("operation_exceptions").select("*").eq("zone_id",i),He.from("sessions").select("*").eq("zone_id",i).order("start_time",{ascending:!0})]);if(F){const{data:N}=await He.from("session_operating_days").select("session_id, day_of_week").in("session_id",(te.data||[]).map(k=>k.id)).eq("is_active",!0),U={quarters:V.data||[],exceptions:G.data||[],operatingRules:N||[]};b(U);const R=(k,P,A,E)=>{const I=Cr(k);if(!P.some(Y=>Y.start_date&&Y.end_date&&Wc(I,{start:Cr(Y.start_date),end:Cr(Y.end_date)}))||A.find(Y=>Y.exception_date===k))return!1;const J=I.getDay();return E.some(Y=>Y.day_of_week===J)};if(!R(r,U.quarters,U.exceptions,U.operatingRules)){let k=Ss(Cr(r),1),P=!1,A=0;for(;!P&&A<60;){const E=rt(k,"yyyy-MM-dd");R(E,U.quarters,U.exceptions,U.operatingRules)?(n(E),P=!0):(k=Ss(k,1),A++)}}}const ee=te.data||[];if(!F||(y(ee),!o.current))return;a.current&&a.current.dispose(),o.current.innerHTML="";const Q=document.createElement("canvas");o.current.appendChild(Q);const K=new Ht.fabric.Canvas(Q,{backgroundColor:"transparent",selection:!1,hoverCursor:"pointer",moveCursor:"grab"});a.current=K,await L(K,ee),F&&(K.on("mouse:down",N=>{var U,R,k,P;K.calcOffset(),K.isDragging=!0,K.selection=!1,K.lastPosX=N.e.clientX||((R=(U=N.e.touches)==null?void 0:U[0])==null?void 0:R.clientX),K.lastPosY=N.e.clientY||((P=(k=N.e.touches)==null?void 0:k[0])==null?void 0:P.clientY)}),K.on("mouse:dblclick",N=>{if(N.target&&N.target.data){const U=N.target.data;f(U),e&&e(U),K.getObjects().forEach(k=>{if(k.type==="group"){const P=k.getObjects().find(A=>A.name==="selectionBorder");P&&P.set({strokeWidth:0}),k.set("dirty",!0)}});const R=N.target.getObjects().find(k=>k.name==="selectionBorder");R&&R.set({strokeWidth:2}),N.target.set({dirty:!0,objectCaching:!1}),K.renderAll()}else f(null),e&&e(null)}),K.on("mouse:move",N=>{var U,R,k,P;if(K.calcOffset(),K.isDragging){const A=N.e,E=A.clientX||((R=(U=A.touches)==null?void 0:U[0])==null?void 0:R.clientX),I=A.clientY||((P=(k=A.touches)==null?void 0:k[0])==null?void 0:P.clientY),H=K.viewportTransform;H[4]+=E-K.lastPosX,H[5]+=I-K.lastPosY,K.requestRenderAll(),K.lastPosX=E,K.lastPosY=I}}),K.on("mouse:wheel",N=>{var A;const U=N.e.deltaY,R=K.viewportTransform;R[5]-=U;const k=K.getHeight(),P=((A=o.current)==null?void 0:A.clientHeight)||0;R[5]>0&&(R[5]=0),P>0&&R[5]<-(k-P)&&(R[5]=-(k-P)),K.requestRenderAll(),N.e.preventDefault(),N.e.stopPropagation()}),K.on("mouse:up",()=>{K.setViewportTransform(K.viewportTransform),K.isDragging=!1,K.selection=!1}))})(),()=>{F=!1,a.current&&(a.current.dispose(),a.current=null)}},[i,m,r]),xe.useEffect(()=>{let F;const M=()=>{F&&cancelAnimationFrame(F),F=requestAnimationFrame(()=>{a.current&&a.current.calcOffset()})};return window.addEventListener("resize",M),window.addEventListener("scroll",M,!0),()=>{window.removeEventListener("resize",M),window.removeEventListener("scroll",M,!0),F&&cancelAnimationFrame(F)}},[]);const T=F=>{const M=Cr(F);if(!w.quarters.some(Q=>Q.start_date&&Q.end_date&&Wc(M,{start:Cr(Q.start_date),end:Cr(Q.end_date)}))||w.exceptions.find(Q=>Q.exception_date===F))return!1;const te=M.getDay();return!!w.operatingRules.some(Q=>Q.day_of_week===te)},O=()=>{let F=Ss(Cr(r),1),M=!1,V=0;const G=180;for(;!M&&V<G;){const te=rt(F,"yyyy-MM-dd");T(te)?(n(te),M=!0):(F=Ss(F,1),V++)}},j=()=>{let F=Kv(Cr(r),1),M=!1,V=0;const G=180;for(;!M&&V<G;){const te=rt(F,"yyyy-MM-dd");T(te)?(n(te),M=!0):(F=Kv(F,1),V++)}},L=async(F,M,V)=>{var ee,Q;p(!0);const{data:G}=await He.from("seats").select("*").eq("zone_id",i).order("global_number",{ascending:!0});let te=[];if(M&&M.length>0){const K=M.map(U=>U.id),{data:N}=await He.from("bookings").select("*, profiles(username, full_name), profiles_student(username, full_name)").eq("date",r).in("session_id",K);N&&(te=N)}if(G&&G.length>0){if(!F||F.isDisposed||!F.getContext())return;F.clear();const K=Math.min(...G.map(re=>re.pos_x)),U=Math.max(...G.map(re=>re.pos_x+(re.width||72)))-K,R=((ee=o.current)==null?void 0:ee.clientWidth)||U,k=Math.max(U,R),P=Math.round((k-U)/2-K),A=Math.min(...G.map(re=>re.pos_y)),I=Math.max(...G.map(re=>re.pos_y+(re.height||72)))-A,H=Math.round(-A),J=((Q=o.current)==null?void 0:Q.clientHeight)||0,Y=Math.max(I,J);if(F.isDisposed||!F.getContext())return;F.setDimensions({width:k,height:Y});const Z=new Date,fe=Z.getHours().toString().padStart(2,"0")+":"+Z.getMinutes().toString().padStart(2,"0")+":00",X=M==null?void 0:M.find(re=>fe>=re.start_time&&fe<=re.end_time);if(G.forEach(re=>{const se=(te==null?void 0:te.filter(z=>z.seat_id===re.id))||[];W(F,{...re,pos_x:re.pos_x+P,pos_y:re.pos_y+H},se,X,M)}),U>R){const re=F.viewportTransform;re[4]=(R-U)/2,F.setViewportTransform(re),F.requestRenderAll()}}p(!1)},W=(F,M,V,G,te)=>{if(M.type==="structure"){const X=new Ht.fabric.Rect({fill:M.bg_color||"#E5E5EA",width:M.width||72,height:M.height||72,stroke:M.stroke_color||"#D1D1D6",strokeWidth:1}),re=new Ht.fabric.IText(M.label||"",{fontSize:M.font_size||10,originX:"center",originY:"center",left:(M.width||72)/2,top:(M.height||72)/2,fill:M.text_color||"#AEAEB2",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),se=new Ht.fabric.Group([X,re],{left:M.pos_x,top:M.pos_y,originX:"left",originY:"top",angle:M.rotation,selectable:!1,evented:!1,data:{...M}});F.add(se);return}const Q=!!V.find(X=>X.session_id===(G==null?void 0:G.id)),K=V.length>0,N=X=>m?!!(["admin","teacher"].includes(m.role)||X.user_id===m.id):!1,U=M.zone_color||"#5E5CE6",R=new Ht.fabric.Rect({fill:U,opacity:Q?.8:K?.12:.03,width:72,height:72,rx:12,ry:12,strokeWidth:0,left:0,top:0,originX:"left",originY:"top",selectable:!1}),k="M 0 12 Q 0 0 12 0 L 60 0 Q 72 0 72 12 L 72 18 L 0 18 z",P=new Ht.fabric.Path(k,{fill:U,opacity:Q?1:K?.45:.18,strokeWidth:0,left:0,top:0,originX:"left",originY:"top",selectable:!1}),A=new Ht.fabric.IText(M.display_number||M.seat_number,{fontSize:11,left:6,top:4,originX:"left",originY:"top",fill:Q?"#ffffff":U,fontFamily:"Inter, -apple-system",fontWeight:"900",selectable:!1}),E={Morning:"",Dinner:"","1st Period":"1 ","2nd Period":"2 ",period1:"1 ",period2:"2 "},I=X=>{if(E[X])return E[X];const re=X.match(/(\d+)/);return re?`${re[1]} `:X.substring(0,2)},H=[...te||[]].sort((X,re)=>X.id-re.id),J=H.length>4;let Y=[];if(J){const X=Math.ceil(H.length/2),re=H.slice(0,X),se=H.slice(X),z=we=>we.map(ye=>{const de=V.find(pe=>pe.session_id===ye.id),Te=I(ye.name);if(!de)return`${Te}:`;if(N(de)){const pe=de.profiles_student||de.profiles;return`${Te}:${(pe==null?void 0:pe.full_name.substring(0,4))||""}`}else return`${Te}:()`}).join(`
`),oe=new Ht.fabric.Text(z(re),{fontSize:5.5,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:Q?"#ffffff":"#000000",left:4,top:20,lineHeight:1.35,selectable:!1}),ce=new Ht.fabric.Text(z(se),{fontSize:5.5,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:Q?"#ffffff":"#000000",left:38,top:20,lineHeight:1.35,selectable:!1});Y=[oe,ce]}else H.forEach((X,re)=>{const se=V.find(Te=>Te.session_id===X.id),z=I(X.name),oe=21+re*13,ce=new Ht.fabric.Text(z,{fontSize:8,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:Q?"#ffffff":"#000000",left:4,top:oe+.5,originX:"left",originY:"top",selectable:!1});Y.push(ce);const we=new Ht.fabric.Line([17,oe,17,oe+10],{stroke:Q?"rgba(255,255,255,0.3)":"rgba(0,0,0,0.1)",strokeWidth:.5,originX:"left",originY:"top",selectable:!1});Y.push(we);let ye="";if(se)if(N(se)){const Te=se.profiles_student||se.profiles,pe=(Te==null?void 0:Te.username)||"",Ae=(Te==null?void 0:Te.full_name)||"";ye=pe?`${pe} ${Ae}`:Ae}else ye="()";const de=new Ht.fabric.Text(ye,{fontSize:8,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:Q?"#ffffff":"#000000",left:23,top:oe,originX:"left",originY:"top",selectable:!1});if(Y.push(de),re<H.length-1){const Te=new Ht.fabric.Line([4,oe+11.5,68,oe+11.5],{stroke:Q?"rgba(255,255,255,0.2)":"rgba(0,0,0,0.08)",strokeWidth:.5,originX:"left",originY:"top",selectable:!1});Y.push(Te)}});const Z=new Ht.fabric.Rect({width:76,height:76,rx:14,ry:14,fill:"transparent",stroke:U,strokeWidth:0,left:-2,top:-2,originX:"left",originY:"top",selectable:!1,name:"selectionBorder",strokeUniform:!0}),fe=new Ht.fabric.Group([R,P,A,...Y,Z],{left:M.pos_x,top:M.pos_y,originX:"left",originY:"top",angle:M.rotation,data:{...M,seatBookings:V,activeSession:G},selectable:!1,hoverCursor:"pointer"});F.add(fe)};return v.jsxs("div",{className:"flex flex-col gap-4 w-full h-full relative overflow-hidden",children:[!l&&v.jsxs("div",{className:"flex items-center gap-4 px-1",children:[v.jsx("div",{className:"flex gap-[10px] m-[10px] mb-0 border-none shrink-0 p-1 rounded-apple-md backdrop-blur-xl",children:h.map(F=>v.jsx("button",{onClick:()=>s(F.id),className:`px-6 py-2 rounded-apple-md text-xs font-black transition-all ios-tap border-none ${i===F.id?"bg-[#1C1C1E] text-white shadow-sm":"text-gray-400 hover:text-[#1C1C1E] hover:bg-gray-100"}`,children:F.name},F.id))}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(dg,{className:"w-4 h-4 text-ios-indigo"}),v.jsxs("span",{className:"text-xs font-black text-ios-indigo",children:["    ",v.jsx("span",{className:"text-ios-rose",children:" "})," ."]})]}),v.jsxs("div",{className:"flex bg-gray-200/20 p-1 rounded-apple-md border border-white/40 backdrop-blur-xl items-center gap-1 ml-auto",children:[v.jsx("button",{onClick:j,className:"p-1.5 hover:bg-white rounded-apple-md transition-all text-ios-gray hover:text-[#1C1C1E] ios-tap",children:v.jsx(Mo,{className:"w-4 h-4"})}),v.jsxs("div",{className:"relative group px-3 flex items-center gap-2 cursor-pointer",children:[v.jsx(Io,{className:"w-3.5 h-3.5 text-ios-indigo"}),v.jsx("span",{className:"text-[13px] font-black text-[#1C1C1E] whitespace-nowrap",children:rt(Cr(r),"MM.dd (EEE)",{locale:fn})}),v.jsx("input",{type:"date",value:r,onChange:F=>n(F.target.value),className:"absolute inset-0 opacity-0 cursor-pointer"})]}),v.jsx("button",{onClick:O,className:"p-1.5 hover:bg-white rounded-apple-md transition-all text-ios-gray hover:text-[#1C1C1E] ios-tap",children:v.jsx(Ts,{className:"w-4 h-4"})})]})]}),u&&v.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-30 flex items-center justify-center",children:v.jsx("div",{className:"w-8 h-8 border-3 border-ios-indigo border-t-transparent rounded-full animate-spin"})}),v.jsx("div",{ref:o,className:"flex-1 h-full relative overflow-hidden cursor-grab active:cursor-grabbing touch-none select-none scrollbar-hide"})]})},IT=({isOpen:e,onClose:t,zoneId:r,onSelect:n,selectedDate:i})=>{const[s,l]=xe.useState(!0);if(xe.useEffect(()=>{e&&l(!0)},[e]),!e)return null;const o=rt(i||new Date,"yyyy-MM-dd");return v.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:[v.jsxs("div",{className:"bg-white w-full h-[80vh] rounded-3xl overflow-hidden flex flex-col shadow-2xl relative",children:[v.jsx("button",{onClick:t,className:"absolute top-4 right-4 z-50 p-2 bg-white/90 backdrop-blur rounded-full shadow-lg text-black hover:bg-gray-100 transition-all border border-gray-100",children:v.jsx(Ja,{className:"w-6 h-6"})}),v.jsx("div",{className:"flex-1 bg-gray-50 relative overflow-hidden",children:v.jsx(LT,{viewDate:o,selectedZoneId:r,onDateChange:()=>{},onZoneChange:()=>{},isReadOnly:!0,minimal:!0,onSelectSeat:n})})]}),s&&v.jsx("div",{className:"absolute inset-0 z-[10000] flex items-center justify-center p-6 animate-fade-in",onClick:()=>l(!1),children:v.jsxs("div",{className:"bg-white/95 backdrop-blur-md rounded-2xl p-6 shadow-2xl max-w-xs w-full text-center border border-gray-100 transform transition-all scale-100 relative overflow-hidden",onClick:a=>a.stopPropagation(),children:[v.jsx("div",{className:"mb-4 flex justify-center",children:v.jsx("div",{className:"w-12 h-12 rounded-full bg-ios-indigo/10 flex items-center justify-center",children:v.jsx("span",{className:"text-2xl",children:""})})}),v.jsx("h3",{className:"text-lg font-black text-gray-900 mb-2",children:"  "}),v.jsxs("p",{className:"text-gray-600 text-[15px] font-medium leading-relaxed break-keep mb-6",children:["  ",v.jsx("br",{}),v.jsx("span",{className:"text-[#FF3B30] font-black text-lg",children:" (  )"}),v.jsx("br",{})," ."]}),v.jsx("button",{onClick:()=>l(!1),className:"w-full py-3.5 bg-[#1C1C1E] text-white rounded-xl font-bold text-sm hover:bg-gray-800 active:scale-95 transition-all shadow-lg shadow-gray-200",children:""})]})})]})},ZX=({onCancel:e,onSuccess:t,currentUser:r})=>{const[n,i]=xe.useState(0),[s,l]=xe.useState(!1),[o,a]=xe.useState([]),[c,f]=xe.useState([]),[h,d]=xe.useState([]),[u,p]=xe.useState({}),[m,g]=xe.useState(null),[x,y]=xe.useState([]),[w,b]=xe.useState(null),[S,T]=xe.useState(""),[O,j]=xe.useState("A"),[L,W]=xe.useState({}),[F,M]=xe.useState({enabled:!1,restrictions:{}}),[V,G]=xe.useState(null),[te,ee]=xe.useState({}),[Q,K]=xe.useState(null),N=Ie=>{if(!Ie)return"";const je=Ie.seat_number.toString(),Le=Ie.zone_name||"";return Le&&je.startsWith(`${Le}-`)?je.replace(`${Le}-`,""):Le&&je.startsWith(Le)?je.replace(Le,""):je},[U,R]=xe.useState([]),[k,P]=xe.useState([]),[A,E]=xe.useState([]),[I,H]=xe.useState(!1);xe.useEffect(()=>{(async()=>{var je,Le;l(!0);try{const{data:Xe}=await He.from("operation_quarters").select("*").order("start_date");a(Xe||[]);const{data:Je}=await He.from("zones").select("*").order("created_at");d(Je||[]);let Ne=null;Je&&Je.length>0&&(Ne=Je[0].id,b(Ne));const[Oe,De]=await Promise.all([He.from("configs").select("value").eq("key","grade_restriction_enabled").maybeSingle(),He.from("configs").select("value").eq("key","sub_zone_grade_restrictions").maybeSingle()]);M({enabled:!!((je=Oe.data)!=null&&je.value),restrictions:((Le=De.data)==null?void 0:Le.value)||{}})}catch(Xe){console.error("Error fetching wizard configs:",Xe)}finally{l(!1)}})()},[]),xe.useEffect(()=>{if(!w)return;(async()=>{l(!0);try{const[je,Le,Xe]=await Promise.all([He.from("sessions").select("*").eq("zone_id",w).order("start_time"),He.from("operation_exceptions").select("*").eq("zone_id",w),He.from("seats").select("*").eq("zone_id",w).order("global_number")]);f(je.data||[]),P(Le.data||[]),E(Xe.data||[]);const{data:Je}=await He.from("session_operating_days").select("session_id, day_of_week").in("session_id",(je.data||[]).map(Oe=>Oe.id)).eq("is_active",!0);R(Je||[]);const Ne=Xe.data||[];if(Ne.length>0){const Oe=Ne[0].zone_name||"";j(Oe)}y([]),T("")}catch(je){console.error("Error fetching zone data:",je)}finally{l(!1)}})()},[w]),xe.useEffect(()=>{if(!r)return;(async()=>{try{const{data:je}=await He.from("bookings").select(`
                    *,
                    sessions (id, name, start_time, end_time),
                    seats (id, seat_number, zone_name, zone_id, zones(name)),
                    attendance (
                        status
                    )
                `).or(`student_id.eq.${r.id},user_id.eq.${r.id}`);if(je){const Le={},Xe={},Je=rt(new Date,"yyyy-MM-dd");je.forEach(Ne=>{const Oe=Ne.date;Xe[Oe]||(Xe[Oe]=[]),Xe[Oe].push(Ne);const De=Ne.attendance&&Ne.attendance[0];let Ye="reserved";Oe<Je?De?De.status==="present"?Ye="present":De.status==="late"?Ye="late":Ye="absent":Ye="absent":Oe===Je&&De&&(De.status==="present"?Ye="present":De.status==="late"&&(Ye="late")),(!Le[Oe]||Ye==="present"&&Le[Oe]!=="present"||Ye==="late"&&Le[Oe]==="absent")&&(Le[Oe]=Ye)}),p(Le),ee(Xe)}}catch(je){console.error("Error fetching user activities:",je)}})()},[r]);const J=Ie=>{const je=Ga(new Date),Le=Ga(Ie),Xe=Ss(je,2);if(Vh(Le,Xe))return!1;const Je=o.find(et=>{const Ge=Cr(et.start_date),ot=Cr(et.end_date);return(Ol(Le,Ge)||Xv(Le,Ge))&&(Ol(Le,ot)||Vh(Le,ot))});if(!Je)return!1;const Ne=Cr(Je.start_date),Oe=Kv(Ne,7);if(Vh(je,Oe))return!1;const De=rt(Le,"yyyy-MM-dd"),Ye=k.find(et=>et.exception_date===De);if(Ye&&Ye.is_closed)return!1;const it=Le.getDay();return!!U.some(et=>et.day_of_week===it)},[Y,Z]=xe.useState(new Date),fe=()=>Z(Ie=>mm(Ie)),X=()=>Z(Ie=>t0(Ie,1)),re=()=>{const Ie=Ga(new Date(Y.getFullYear(),Y.getMonth(),1)),je=new Date(Y.getFullYear(),Y.getMonth()+1,0),Xe=Ga(Ie).getDay(),Je=Array(Xe).fill(null),Ne=[];for(let De=1;De<=je.getDate();De++)Ne.push(new Date(Y.getFullYear(),Y.getMonth(),De));const Oe=[...Je,...Ne];return v.jsxs("div",{className:"space-y-4 animate-fade-in",children:[v.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:" "}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"  ."}),v.jsxs("div",{className:"flex items-center justify-between bg-white rounded-2xl p-2 shadow-sm border border-gray-100 mb-4",children:[v.jsx("button",{onClick:fe,className:"p-2 hover:bg-gray-100 rounded-full text-ios-gray hover:text-black transition-colors",children:v.jsx(Mo,{className:"w-5 h-5"})}),v.jsx("span",{className:"text-base font-black text-[#1C1C1E]",children:rt(Y,"yyyy M")}),v.jsx("button",{onClick:X,className:"p-2 hover:bg-gray-100 rounded-full text-ios-gray hover:text-black transition-colors",children:v.jsx(Ts,{className:"w-5 h-5"})})]}),v.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["","","","","","",""].map((De,Ye)=>v.jsx("div",{className:`text-center text-xs font-bold py-2 ${Ye===0||Ye===6?"text-ios-rose":"text-gray-400"}`,children:De},De)),Oe.map((De,Ye)=>{if(!De)return v.jsx("div",{},`empty-${Ye}`);const it=J(De),Ke=m&&Ol(De,m),et=rt(De,"yyyy-MM-dd"),Ge=u[et],ot=De.getDay()===0||De.getDay()===6,_t=k.some(St=>St.exception_date===et),yt=ot||_t;return v.jsx("button",{disabled:!it&&!Ge,onClick:()=>{Ge?G(De):it&&g(De)},className:`
                                aspect-square rounded-xl flex flex-col items-center justify-center text-sm font-bold transition-all relative
                                ${Ke?"bg-ios-indigo text-white shadow-xl scale-105 z-10":Ge==="present"?"bg-ios-emerald text-white border-none":Ge==="late"?"bg-ios-amber text-white border-none":Ge==="absent"?"bg-ios-rose text-white border-none":Ge==="reserved"?"bg-ios-indigo text-white border-none":it?`bg-white border border-gray-100 hover:border-gray-300 ${yt?"text-ios-rose":"text-[#1C1C1E]"}`:`bg-transparent cursor-not-allowed ${yt?"text-ios-rose/50":"text-gray-400"}`}
                            `,children:v.jsx("span",{className:!it&&!Ge?"opacity-50":"",children:rt(De,"d")})},Ye)})]}),v.jsx("div",{className:"mt-6 pt-4 border-t border-gray-100",children:v.jsxs("div",{className:"flex flex-col gap-3",children:[v.jsx("span",{className:"text-[11px] font-black text-ios-gray uppercase tracking-[0.2em]",children:" "}),v.jsx("div",{className:"flex flex-wrap gap-4",children:[{label:"",color:"bg-ios-emerald"},{label:"",color:"bg-ios-amber"},{label:"",color:"bg-ios-rose"},{label:"",color:"bg-ios-indigo"}].map(De=>v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:`w-2 h-2 rounded-full ${De.color}`}),v.jsx("span",{className:"text-[10px] font-bold text-gray-400",children:De.label})]},De.label))})]})})]})},se=()=>{if(!V)return null;const Ie=rt(V,"yyyy-MM-dd"),je=te[Ie]||[],Le=J(V);je.sort((Ne,Oe)=>{var De,Ye;return(((De=Ne.sessions)==null?void 0:De.start_time)||"").localeCompare(((Ye=Oe.sessions)==null?void 0:Ye.start_time)||"")});const Xe=async()=>{if(confirm("   ?")){l(!0);try{const Ne=je.map(Ye=>Ye.id),{error:Oe}=await He.from("bookings").delete().in("id",Ne);if(Oe)throw Oe;alert(" ."),G(null);const{data:De}=await He.from("bookings").select(`
                    *,
                    sessions (id, name, start_time, end_time),
                    seats (id, seat_number, zone_name, zone_id, zones(name)),
                    attendance (status)
                `).or(`student_id.eq.${r.id},user_id.eq.${r.id}`);if(De){const Ye={},it={},Ke=rt(new Date,"yyyy-MM-dd");De.forEach(et=>{const Ge=et.date;it[Ge]||(it[Ge]=[]),it[Ge].push(et);const ot=et.attendance&&et.attendance[0];let _t="reserved";Ge<Ke?ot?_t=ot.status==="present"?"present":ot.status==="late"?"late":"absent":_t="absent":Ge===Ke&&ot&&(_t=ot.status==="present"?"present":ot.status==="late"?"late":"reserved"),(!Ye[Ge]||_t==="present"&&Ye[Ge]!=="present"||_t==="late"&&Ye[Ge]==="absent")&&(Ye[Ge]=_t)}),p(Ye),ee(it)}}catch(Ne){console.error("Delete failed:",Ne),alert("    .")}finally{l(!1)}}},Je=async()=>{var Ne;if(confirm(`   ,    .
   ,        .`)){l(!0);try{const Oe=je.map(Ye=>Ye.id),De=je[0];g(V),y(je.map(Ye=>Ye.session_id)),De&&De.seats&&(b(De.seats.zone_id),j(De.seats.zone_name||""),T(N(De.seats))),W(((Ne=De.study_plans)==null?void 0:Ne.content)||""),K(Oe),G(null),i(3)}catch(Oe){console.error("Modify failed:",Oe),alert("     .")}finally{l(!1)}}};return v.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",children:v.jsx("div",{className:"bg-white w-full max-w-sm rounded-3xl overflow-hidden shadow-2xl relative",children:v.jsxs("div",{className:"p-6",children:[v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsxs("h3",{className:"text-xl font-black text-[#1C1C1E]",children:[rt(V,"M d"),"  "]}),v.jsx("button",{onClick:()=>G(null),className:"p-2 -mr-2 text-gray-400 hover:text-black",children:v.jsx(Ja,{className:"w-5 h-5"})})]}),v.jsx("div",{className:"space-y-4 mb-8 max-h-[50vh] overflow-y-auto scrollbar-hide",children:je.length>0?je.map((Ne,Oe)=>{var yt,St,Bt,qt,Ct,sr,Xi,Dr,ii;const De=new Date,Ye=Ie===rt(De,"yyyy-MM-dd"),it=rt(De,"HH:mm:ss"),Ke=(yt=Ne.sessions)==null?void 0:yt.end_time,et=(St=Ne.attendance)==null?void 0:St[0],Ge=Ye&&Ke&&it>Ke,ot=et?et.status==="present"?"":et.status==="late"?"":"":Ge?"":"",_t=et?et.status==="present"?"text-ios-emerald bg-ios-emerald/10":et.status==="late"?"text-ios-amber bg-ios-amber/10":"text-ios-rose bg-ios-rose/10":Ge?"text-ios-rose bg-ios-rose/10":"text-gray-400 bg-gray-50";return v.jsxs("div",{className:"p-4 bg-gray-50 rounded-2xl flex items-center justify-between border border-gray-100",children:[v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[v.jsx("p",{className:"text-sm font-black text-[#1C1C1E]",children:(Bt=Ne.sessions)==null?void 0:Bt.name}),v.jsx("span",{className:`text-[10px] font-bold px-1.5 py-0.5 rounded-full ${_t}`,children:ot})]}),v.jsxs("p",{className:"text-xs text-ios-gray font-bold",children:[(qt=Ne.sessions)==null?void 0:qt.start_time.slice(0,5)," ~ ",(Ct=Ne.sessions)==null?void 0:Ct.end_time.slice(0,5)]})]}),v.jsxs("div",{className:"text-right",children:[v.jsx("p",{className:"text-[10px] font-black text-ios-indigo/60 mb-0.5",children:((Xi=(sr=Ne.seats)==null?void 0:sr.zones)==null?void 0:Xi.name)||""}),v.jsxs("p",{className:"text-xs font-black text-ios-indigo",children:[(Dr=Ne.seats)!=null&&Dr.zone_name?`${Ne.seats.zone_name}-`:"",Ne.seat_number||((ii=Ne.seats)==null?void 0:ii.seat_number)||"-"," "]})]})]},Oe)}):v.jsx("p",{className:"text-center text-gray-400 text-sm",children:"  ."})}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{onClick:Xe,disabled:!Le||s,className:`flex-1 py-3 rounded-xl font-bold text-sm border-2 border-red-100 text-red-500 bg-red-50 hover:bg-red-100 transition-colors
                                  ${!Le||s?"opacity-50 cursor-not-allowed":""}
                              `,children:" "}),v.jsx("button",{onClick:Je,disabled:!Le||s,className:`flex-1 py-3 rounded-xl font-bold text-sm bg-ios-indigo text-white hover:bg-ios-indigo/90 transition-colors shadow-lg shadow-ios-indigo/30
                                  ${!Le||s?"opacity-50 cursor-not-allowed shadow-none":""}
                              `,children:""})]}),!Le&&v.jsx("p",{className:"text-[10px] text-center text-gray-400 font-medium mt-3",children:"*   2      / ."})]})})})},z=()=>{const Ie=je=>{x.includes(je)?y(x.filter(Le=>Le!==je)):y([...x,je])};return v.jsxs("div",{className:"space-y-4 animate-fade-in",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:" "}),v.jsxs("p",{className:"text-sm font-bold text-ios-gray",children:["   .",v.jsx("br",{}),"(  )"]})]}),Q&&v.jsx("div",{className:"text-right",children:v.jsx("span",{className:"text-[10px] font-black text-ios-indigo bg-ios-indigo/10 px-2 py-1 rounded-full uppercase",children:" "})})]}),Q&&v.jsxs("div",{className:"p-3 bg-ios-indigo/5 border border-ios-indigo/10 rounded-xl flex items-start gap-3",children:[v.jsx("div",{className:"mt-0.5",children:v.jsx(dg,{className:"w-4 h-4 text-ios-indigo"})}),v.jsxs("p",{className:"text-[11px] font-bold text-ios-indigo leading-tight",children:["   , (",O,"-",S,") .           ."]})]}),v.jsx("div",{className:"space-y-3 mt-4",children:c.filter(je=>{if(!m)return!1;const Le=m.getDay();return U.some(Xe=>Xe.session_id===je.id&&Xe.day_of_week===Le)}).map(je=>{const Le=x.includes(je.id);return v.jsxs("button",{onClick:()=>Ie(je.id),className:`w-full p-4 rounded-2xl border-2 transition-all flex items-center justify-between group text-left ios-tap
                                ${Le?"border-ios-indigo bg-ios-indigo/5":"border-white bg-white shadow-sm"}
                            `,children:[v.jsxs("div",{children:[v.jsx("h4",{className:`text-base font-black ${Le?"text-ios-indigo":"text-[#1C1C1E]"}`,children:je.name}),v.jsxs("p",{className:"text-xs font-bold text-ios-gray mt-1",children:[je.start_time.slice(0,5)," ~ ",je.end_time.slice(0,5)]})]}),v.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors
                                ${Le?"border-ios-indigo bg-ios-indigo text-white":"border-gray-200 bg-gray-50"}
                            `,children:Le&&v.jsx(Ka,{className:"w-4 h-4"})})]},je.id)})})]})},oe=()=>v.jsxs("div",{className:"space-y-4 animate-fade-in",children:[v.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:"  "}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:" (Zone) ."}),v.jsx("div",{className:"space-y-3 mt-4",children:h.map(Ie=>{const je=w===Ie.id;return v.jsxs("button",{onClick:()=>b(Ie.id),className:`w-full p-5 rounded-2xl border-2 transition-all flex items-center justify-between text-left ios-tap
                                ${je?"border-ios-indigo bg-ios-indigo/5":"border-white bg-white shadow-sm"}
                            `,children:[v.jsx("span",{className:`text-lg font-black ${je?"text-ios-indigo":"text-[#1C1C1E]"}`,children:Ie.name}),je&&v.jsx("div",{className:"text-xs font-bold text-ios-indigo bg-ios-indigo/10 px-2 py-1 rounded",children:""})]},Ie.id)})})]}),ce=()=>{var Ye,it;const je=(()=>{if(!A||A.length===0)return[];const Ke=new Set;return A.forEach(et=>{et.zone_name&&Ke.add(et.zone_name)}),Array.from(Ke).sort()})(),Le=Ke=>{if(je.length===0)return;let et=je.indexOf(O);et===-1&&(et=0);let Ge;Ke==="up"?Ge=(et-1+je.length)%je.length:Ge=(et+1)%je.length;const ot=je[Ge];j(ot);const _t=A.find(yt=>(yt.zone_name||"")===ot);T(_t?N(_t):"")},Xe=Ke=>{if(!A||A.length===0)return;const et=O||je[0],Ge=A.filter(Bt=>(Bt.zone_name||"")===et);if(Ge.length===0)return;const ot=[...Ge].sort((Bt,qt)=>{const Ct=parseInt(Bt.seat_number.toString().replace(/\D/g,""))||0,sr=parseInt(qt.seat_number.toString().replace(/\D/g,""))||0;return Ct-sr}),_t=ot.find(Bt=>N(Bt)===S.toString());let yt=0;if(_t){const Bt=ot.indexOf(_t);Ke==="up"?yt=(Bt-1+ot.length)%ot.length:yt=(Bt+1)%ot.length}else yt=0;const St=ot[yt];T(N(St))},Je=O||(je.length>0?je[0]:"-"),Ne=(r==null?void 0:r.full_name)||(r==null?void 0:r.name)||"",Oe=(r==null?void 0:r.student_id)||(r==null?void 0:r.username)||"",De=parseInt(Oe.substring(0,1))||"";return v.jsxs("div",{className:"space-y-4 animate-fade-in",children:[v.jsxs("h3",{className:"text-xl font-black text-[#1C1C1E]",children:[(Ye=h.find(Ke=>Ke.id===w))==null?void 0:Ye.name,"  "]}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"(Section)    ."}),v.jsxs("div",{className:"bg-ios-rose/5 p-4 rounded-2xl border border-ios-rose/10 flex items-start gap-3 mt-2 animate-fade-in",children:[v.jsx("div",{className:"mt-0.5",children:v.jsx(dg,{className:"w-4 h-4 text-ios-rose"})}),v.jsxs("p",{className:"text-[11px] font-bold text-[#1C1C1E] leading-relaxed",children:[Ne," (",De||"?",")    .",v.jsx("br",{}),v.jsx("span",{className:"text-ios-rose font-bold whitespace-pre-wrap",children:(()=>{if(!F.enabled)return"      .";const Ke=F.restrictions[w]||{},et=Object.keys(Ke).filter(ot=>{const _t=Ke[ot];return Array.isArray(_t)&&_t.includes(De)}),Ge=Object.keys(Ke).filter(ot=>{const _t=Ke[ot];return Array.isArray(_t)&&!_t.includes(De)});return et.length===0&&Ge.length>0?"      .":Ge.length===0?"       .":`${et.join(", ")}    . (${Ge.join(", ")} )`})()})]})]}),v.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-gray-100 mt-4",children:[v.jsxs("div",{className:"flex gap-4",children:[v.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2",children:[v.jsx("label",{className:"text-xs font-black text-ios-gray uppercase tracking-widest",children:" (Section)"}),v.jsx("button",{onClick:()=>Le("up"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:v.jsx(lv,{className:"w-6 h-6"})}),v.jsx("div",{className:"h-16 flex items-center justify-center",children:v.jsx("span",{className:"text-5xl font-black text-[#1C1C1E] text-center leading-tight",children:Je})}),v.jsx("button",{onClick:()=>Le("down"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:v.jsx(ov,{className:"w-6 h-6"})})]}),v.jsx("div",{className:"w-px bg-gray-100 my-4"}),v.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2",children:[v.jsx("label",{className:"text-xs font-black text-ios-gray uppercase tracking-widest",children:" (No.)"}),v.jsx("button",{onClick:()=>Xe("up"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:v.jsx(lv,{className:"w-6 h-6"})}),v.jsx("div",{className:"h-16 flex items-center justify-center w-full",children:v.jsx("input",{type:"text",value:S,onChange:Ke=>T(Ke.target.value),placeholder:"-",className:"w-full text-5xl font-black text-center border-none focus:ring-0 outline-none bg-transparent text-[#1C1C1E] p-0"})}),v.jsx("button",{onClick:()=>Xe("down"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:v.jsx(ov,{className:"w-6 h-6"})})]})]}),v.jsx("div",{className:"border-t border-gray-100 pt-6 mt-2",children:v.jsxs("button",{onClick:()=>H(!0),className:"w-full py-4 rounded-xl bg-gray-50 hover:bg-gray-100 text-[#1C1C1E] font-bold text-sm flex items-center justify-center gap-2 transition-all border border-gray-200",children:[v.jsx(xf,{className:"w-4 h-4"}),"  "]})})]}),S&&v.jsxs("div",{className:"flex items-center gap-2 justify-center text-ios-indigo text-xs font-bold animate-fade-in",children:[v.jsx(Ka,{className:"w-3 h-3"}),(it=h.find(Ke=>Ke.id===w))==null?void 0:it.name," ",Je!==""?`${Je}`:""," - ",S,""]})]})},we=()=>{const Ie=c.filter(je=>x.includes(je.id));return v.jsxs("div",{className:"space-y-6 animate-fade-in",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:" "}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:" ()    ."})]}),v.jsx("div",{className:"space-y-4",children:Ie.map((je,Le)=>v.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-gray-100 shadow-sm",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[v.jsx("div",{className:"w-6 h-6 rounded-full bg-ios-indigo text-white flex items-center justify-center text-xs font-black",children:Le+1}),v.jsx("h4",{className:"text-base font-black text-[#1C1C1E]",children:je.name}),v.jsxs("span",{className:"text-xs font-bold text-ios-gray ml-auto",children:[je.start_time.slice(0,5)," ~ ",je.end_time.slice(0,5)]})]}),v.jsx("textarea",{value:L[je.id]||"",onChange:Xe=>W(Je=>({...Je,[je.id]:Xe.target.value})),placeholder:`${je.name}     (:  2)`,className:"w-full h-24 bg-gray-50 border border-gray-200 rounded-xl p-4 text-sm font-medium resize-none focus:ring-2 focus:ring-ios-indigo/20 outline-none transition-all"})]},je.id))})]})},ye=()=>{var Xe;const Ie=m?rt(m,"M d (EEE)",{locale:fn}):"",je=(Xe=h.find(Je=>Je.id===w))==null?void 0:Xe.name,Le=c.filter(Je=>x.includes(Je.id));return v.jsxs("div",{className:"space-y-6 animate-fade-in",children:[v.jsx("h3",{className:"text-xl font-black text-[#1C1C1E] text-center",children:"  "}),v.jsx("div",{className:"bg-white rounded-3xl shadow-[0_4px_20px_rgba(0,0,0,0.03)] border border-gray-100 overflow-hidden",children:v.jsxs("div",{className:"p-6 space-y-6",children:[v.jsxs("div",{className:"flex items-start gap-4",children:[v.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-indigo/10 flex items-center justify-center shrink-0",children:v.jsx(Io,{className:"w-5 h-5 text-ios-indigo"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-xs font-bold text-ios-gray",children:""}),v.jsx("p",{className:"text-lg font-black text-[#1C1C1E]",children:Ie})]})]}),v.jsxs("div",{className:"flex items-start gap-4",children:[v.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-rose/10 flex items-center justify-center shrink-0",children:v.jsx(Qa,{className:"w-5 h-5 text-ios-rose"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-xs font-bold text-ios-gray",children:""}),v.jsx("p",{className:"text-lg font-black text-[#1C1C1E]",children:Le.map(Je=>Je.name).join(", ")})]})]}),v.jsxs("div",{className:"flex items-start gap-4",children:[v.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-emerald/10 flex items-center justify-center shrink-0",children:v.jsx(xf,{className:"w-5 h-5 text-ios-emerald"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-xs font-bold text-ios-gray",children:""}),v.jsx("p",{className:"text-lg font-black text-[#1C1C1E]",children:je}),v.jsxs("p",{className:"text-base font-bold text-ios-indigo mt-0.5",children:[S," "]})]})]}),v.jsxs("div",{className:"flex items-start gap-4 border-t border-gray-50 pt-4",children:[v.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-amber/10 flex items-center justify-center shrink-0",children:v.jsx(q2,{className:"w-5 h-5 text-ios-amber"})}),v.jsxs("div",{className:"flex-1",children:[v.jsx("p",{className:"text-xs font-bold text-ios-gray mb-2",children:" "}),v.jsx("div",{className:"space-y-2",children:Le.map(Je=>v.jsxs("div",{className:"flex gap-2 text-sm",children:[v.jsxs("span",{className:"font-bold text-ios-gray min-w-[3rem]",children:[Je.name,":"]}),v.jsx("span",{className:"font-medium text-[#1C1C1E] line-clamp-1",children:L[Je.id]||" "})]},Je.id))})]})]})]})}),v.jsx("div",{className:"text-center",children:v.jsx("p",{className:"text-xs text-red-400 font-bold mb-2",children:"*      ."})})]})},de=()=>{switch(n){case 0:return!!m;case 1:return!!w;case 2:return!!S;case 3:return x.length>0;case 4:return x.every(je=>(L[je]||"").trim().length>0);default:return!0}},Te=()=>{if(n===0&&Q)i(3);else if(n===2){if(F.enabled){const je=(F.restrictions[w]||{})[O],Le=(r==null?void 0:r.student_id)||(r==null?void 0:r.username)||"",Xe=parseInt(Le.substring(0,1));if(je&&Array.isArray(je)&&je.length>0&&!je.includes(Xe)){alert(`'${O}'  ${je.sort().join(", ")}  .`);return}}i(Ie=>Ie+1)}else n<5&&de()&&i(Ie=>Ie+1)},pe=()=>{n===3&&Q?i(0):n>0?i(Ie=>Ie-1):e()},Ae=async()=>{if(!s){l(!0);try{const Ie=rt(m,"yyyy-MM-dd"),je=r.role==="student",Le=[...new Set(x)];let Xe=null;if(A&&A.length>0){const Oe=A.find(De=>(De.zone_name||"")===O&&N(De)===S.toString());Oe&&(Xe=Oe.id)}if(!Xe){alert("    .   ."),l(!1);return}const Je=je&&r.user_id||null,{error:Ne}=await He.rpc("manage_booking_v2",{p_user_id:je?Je:r.id,p_student_id:je?r.id:null,p_date:Ie,p_session_ids:Le,p_seat_id:Xe,p_study_contents:L,p_old_booking_ids:Q||[]});if(Ne)throw console.error("Booking Transaction Failed:",Ne),Ne.code==="23505"?new Error("   ."):Ne;alert(Q?" !":"  !"),t()}catch(Ie){console.error("Final Submit Error:",Ie);const je=Ie.message||"    .";alert(` .

: `+je)}finally{l(!1)}}};return v.jsxs("div",{className:"flex flex-col h-full bg-[#F2F2F7]",children:[v.jsxs("div",{className:"flex-none px-6 py-4 flex items-center justify-between bg-white/80 backdrop-blur border-b border-gray-200",children:[v.jsx("button",{onClick:pe,className:"p-2 -ml-2 rounded-full hover:bg-gray-100 text-ios-gray hover:text-[#1C1C1E] transition-colors",children:v.jsx(Mo,{className:"w-6 h-6"})}),v.jsxs("span",{className:"text-base font-black text-[#1C1C1E]",children:[" (",n+1,"/6)"]}),v.jsx("div",{className:"w-10"})," "]}),v.jsx("div",{className:"flex-1 overflow-y-auto p-6 pb-32",children:v.jsxs("div",{className:"max-w-md mx-auto",children:[n===0&&re(),n===1&&oe(),n===2&&ce(),n===3&&z(),n===4&&we(),n===5&&ye()]})}),v.jsx("div",{className:"flex-none p-6 bg-white border-t border-gray-100 pb-[max(1.5rem,env(safe-area-inset-bottom))]",children:v.jsx("button",{onClick:n===5?Ae:Te,disabled:!de()||s,className:`w-full py-4 rounded-2xl font-black text-base flex items-center justify-center gap-2 transition-all shadow-lg ios-tap
                    ${de()&&!s?"bg-[#1C1C1E] text-white hover:bg-gray-800":"bg-gray-200 text-gray-400 cursor-not-allowed shadow-none"}
                `,children:s?v.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):n===5?v.jsxs(v.Fragment,{children:[v.jsx(Ka,{className:"w-5 h-5"}),"  "]}):v.jsxs(v.Fragment,{children:["  ",v.jsx(Ts,{className:"w-5 h-5"})]})})}),v.jsx(IT,{isOpen:I,zoneId:w,selectedDate:m,onClose:()=>H(!1),onSelect:Ie=>{if(Ie){const je=Ie.zone_name||"";j(je);const Le=N(Ie);T(Le),H(!1)}}}),se()]})},MT=({user:e,isEarlyLeaveMode:t=!1,onSuccess:r})=>{const[n,i]=xe.useState("idle"),[s,l]=xe.useState(""),[o,a]=xe.useState(null),[c,f]=xe.useState(!0),[h,d]=xe.useState(new Date),u=()=>{const T=new Date,O=9*60*60*1e3;return new Date(T.getTime()+O).toISOString().replace("Z","+09:00")},p=xe.useCallback(T=>{const O=new Date,j=rt(O,"yyyy-MM-dd");return T.find(L=>{const W=Gh(`${j} ${L.start_time}`,"yyyy-MM-dd HH:mm:ss",new Date),F=yX(W),M=qv(W,30);return Xv(O,F)&&Vh(O,M)})},[]);xe.useEffect(()=>{const T=async()=>{f(!0);const{data:j}=await He.from("sessions").select("*");if(j){const L=p(j);a(L)}f(!1)};T();const O=setInterval(()=>{d(new Date),T()},3e4);return()=>clearInterval(O)},[p]);const[m,g]=xe.useState(!1),[x,y]=xe.useState(!1);xe.useEffect(()=>{const T=async()=>{var F,M;if(!e)return;const j=new Date,L=rt(j,"yyyy-MM-dd"),{data:W}=await He.from("sessions").select("*").order("start_time",{ascending:!0});if(W){const V=rt(j,"HH:mm:ss"),G=W.find(Q=>V>=Q.start_time&&V<=Q.end_time),te=W.find(Q=>Q.start_time>V);if(te){const K=(Gh(`${L} ${te.start_time}`,"yyyy-MM-dd HH:mm:ss",new Date).getTime()-j.getTime())/(1e3*60);g(K>=0&&K<=10)}else g(!1);const ee=G||te;if(ee){const{data:Q}=await He.from("bookings").select("attendance(timestamp_in)").eq("user_id",e.id).eq("date",L).eq("session_id",ee.id).maybeSingle();y(!!((M=(F=Q==null?void 0:Q.attendance)==null?void 0:F[0])!=null&&M.timestamp_in))}}};T();const O=setInterval(T,3e4);return()=>clearInterval(O)},[e,o]);const w=async T=>{if(i("locating"),l("  ..."),!navigator.geolocation){i("error"),l("     .");return}navigator.geolocation.getCurrentPosition(async O=>{const{latitude:j,longitude:L,accuracy:W}=O.coords,{data:F}=await He.from("configs").select("value").eq("key","gps_settings").single(),M=(F==null?void 0:F.value)||{},V=M.points||[{lat:M.lat||37.5665,lng:M.lng||126.978,name:" "}],G=M.radius||100;let te=!1,ee=1/0;const Q=6371e3;if(V.forEach(K=>{const N=j*Math.PI/180,U=K.lat*Math.PI/180,R=(K.lat-j)*Math.PI/180,k=(K.lng-L)*Math.PI/180,P=Math.sin(R/2)*Math.sin(R/2)+Math.cos(N)*Math.cos(U)*Math.sin(k/2)*Math.sin(k/2),A=2*Math.atan2(Math.sqrt(P),Math.sqrt(1-P)),E=Q*A;E<ee&&(ee=E),E<=G&&(te=!0)}),!te){i("error"),W>1e3?l("  .  GPS ."):l(`   . (${Math.round(ee)}m )`);return}try{const K=rt(new Date,"yyyy-MM-dd"),N=u();let U=o;if(!U){const{data:k}=await He.from("sessions").select("*").order("start_time",{ascending:!0}),P=rt(new Date,"HH:mm:ss");U=k.find(A=>A.start_time>P)}if(!U)throw new Error("    .");const{data:R}=await He.from("bookings").select("id").eq("user_id",e.id).eq("date",K).eq("session_id",U.id).maybeSingle();if(!R)throw new Error(`'${U.name}'   .`);if(T==="attendance"){const k=Gh(`${K} ${U.start_time}`,"yyyy-MM-dd HH:mm:ss",new Date),P=Xv(new Date,qv(k,10))?"late":"present";await He.from("attendance").upsert({booking_id:R.id,status:P,timestamp_in:N,updated_at:new Date().toISOString()},{onConflict:"booking_id"}),l(`'${U.name}'  !`)}else await He.from("attendance").upsert({booking_id:R.id,status:"early_leave",timestamp_out:N,updated_at:new Date().toISOString()},{onConflict:"booking_id"}),l(`'${U.name}' / !`);i("done"),r&&setTimeout(r,1500)}catch(K){l(K.message||" ."),i("error")}},O=>{i("error"),l("    .")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},b=o||m,S=t||m&&!o||x;return v.jsxs("div",{className:"bg-white p-8 max-w-[360px] w-full text-center space-y-6 relative overflow-hidden rounded-[32px] shadow-2xl border border-gray-50 animate-spring-up",children:[v.jsx("div",{className:"absolute top-0 left-0 w-32 h-32 bg-ios-indigo/5 blur-3xl -z-10"}),v.jsx("div",{className:`w-16 h-16 rounded-[1.2rem] mx-auto flex items-center justify-center transition-all duration-700 shadow-sm border ${n==="verified"||n==="done"?"bg-ios-emerald/10 text-ios-emerald border-ios-emerald/20":n==="error"?"bg-ios-rose/10 text-ios-rose border-ios-rose/20":n==="locating"?"bg-ios-indigo/10 text-ios-indigo animate-pulse border-ios-indigo/20":"bg-white text-gray-200 border-gray-100"}`,children:n==="done"?v.jsx(Ka,{className:"w-8 h-8"}):n==="error"?v.jsx(Ns,{className:"w-8 h-8"}):n==="locating"?v.jsx(xf,{className:"w-8 h-8"}):v.jsx(pd,{className:"w-8 h-8"})}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-[11px] font-black border ${x?"bg-ios-rose/5 text-ios-rose border-ios-rose/10":"bg-ios-indigo/5 text-ios-indigo border-ios-indigo/10"}`,children:[v.jsx(Qa,{className:"w-3.5 h-3.5"}),x?"   ":o?`'${o.name}'  `:"  "]}),v.jsx("h3",{className:"text-[26px] font-black tracking-tight text-[#1C1C1E] leading-tight",children:n==="done"?"":n==="locating"?"  ":"   "}),v.jsx("p",{className:"text-sm font-bold text-ios-gray leading-relaxed px-4",children:n==="done"?" .":"  ."})]}),v.jsxs("div",{className:"space-y-3 pt-2",children:[s&&v.jsx("p",{className:`text-[12px] font-black p-3.5 rounded-apple-md ${n==="error"?"bg-ios-rose/5 text-ios-rose border border-ios-rose/10":"bg-ios-emerald/5 text-ios-emerald border border-ios-emerald/10"}`,children:s}),n!=="done"&&v.jsxs(v.Fragment,{children:[b&&!x&&v.jsx("button",{onClick:()=>w("attendance"),disabled:n==="locating",className:"w-full py-[20px] bg-ios-indigo text-white rounded-3xl font-black text-[17px] shadow-lg shadow-indigo-500/20 transition-all active:scale-[0.98] ios-tap",children:o?`${o.name}  `:"   "}),(S||x)&&v.jsx("button",{onClick:()=>w("leave"),disabled:n==="locating",className:`w-full py-[20px] rounded-3xl font-black text-[17px] transition-all active:scale-[0.98] ios-tap ${x?"bg-ios-rose text-white shadow-xl shadow-red-500/20":"bg-ios-rose/10 text-ios-rose border border-ios-rose/20"}`,children:x?" ":"  "}),!b&&!S&&!x&&v.jsx("div",{className:"bg-gray-50 p-6 rounded-2xl border border-dashed border-gray-200",children:v.jsx("p",{className:"text-xs font-bold text-gray-400",children:"    ."})})]})]})]})},RT=({user:e})=>{const[t,r]=xe.useState([]),[n,i]=xe.useState(!1),[s,l]=xe.useState({cumulativeDays:0,cumulativeTime:0,attendanceRate:0,lateCount:0}),[o,a]=xe.useState([]),[c,f]=xe.useState(!1),[h,d]=xe.useState([]);xe.useEffect(()=>{if(!e)return;(async()=>{const g=new Date,x=g.getFullYear(),b=`${g.getMonth()+1>=3?x:x-1}-03-01`,S=rt(g,"yyyy-MM-dd"),{data:T}=await He.from("bookings").select(`
                *,
                sessions (
                    start_time,
                    end_time
                ),
                attendance (
                    status,
                    timestamp_in
                )
            `).or(`user_id.eq.${e.id},student_id.eq.${e.id}`).gte("date",b);if(T){d(T);let O=0,j=0,L=0,W=0;const F=new Set,M=new Date;T.forEach(V=>{if(V.date>S)return;let te=!0;if(V.date===S&&V.sessions){const K=new Date(`${V.date}T${V.sessions.start_time}+09:00`);M<K&&(te=!1)}te&&O++;const ee=V.attendance&&V.attendance[0];if(ee&&["present","late","early_leave"].includes(ee.status)&&(j++,F.add(V.date),ee.status==="late"&&L++,V.sessions)){const K=new Date(`${V.date}T${V.sessions.start_time}+09:00`),N=new Date(`${V.date}T${V.sessions.end_time}+09:00`);let U=K;if(ee.timestamp_in){const k=new Date(ee.timestamp_in);k>K&&(U=k)}let R=N;if(ee.timestamp_out){const k=new Date(ee.timestamp_out);k<N&&(R=k)}else ee.status;if(R>U){const k=(R-U)/6e4;W+=k}}}),l({cumulativeDays:F.size,cumulativeTime:Math.round(W),attendanceRate:O>0?Math.round(j/O*100):0,lateCount:L})}try{const{data:O}=await He.rpc("get_elite_leaderboard",{start_date:b,end_date:S});if(O){const j=O.map(L=>({rank:L.rank,name:L.student_name,info:`${L.grade}`,score:Math.round(L.total_time_minutes||0)}));a(j)}else a([])}catch(O){console.warn("Leaderboard fetch failed:",O),a([])}})()},[e]);const u=eu({start:kf(new Date),end:Rd(new Date)}),p=m=>{const g=Math.floor(m/60),x=m%60;return`${g} ${x}`};return v.jsxs("div",{className:"flex flex-col gap-4 md:gap-6",children:[v.jsx("div",{className:"animate-spring-up",children:v.jsxs("div",{className:"bg-white rounded-[32px] p-10 border border-gray-100 shadow-sm",children:[v.jsx("div",{className:"flex items-center justify-between mb-10",children:v.jsxs("h3",{className:"text-xl font-black flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 rounded-ios bg-ios-indigo/20 flex items-center justify-center",children:v.jsx(Io,{className:"w-5 h-5 text-ios-indigo"})}),"  "]})}),v.jsx("div",{className:"grid grid-cols-7 gap-3 text-center mb-6",children:["","","","","","",""].map((m,g)=>v.jsx("span",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest",children:m},g))}),v.jsx("div",{className:"grid grid-cols-7 gap-3",children:u.map((m,g)=>{const x=rt(m,"yyyy-MM-dd"),y=h.find(S=>S.date===x);let w=null;if(y){const S=rt(new Date,"yyyy-MM-dd");if(x>S)w="booking";else{const T=y.attendance&&y.attendance[0];T?w=T.status:w="absent"}}const b=Vy(m);return v.jsxs("div",{className:`aspect-square rounded-ios flex items-center justify-center text-[12px] font-black transition-all duration-500 ios-tap relative group ${b?"bg-ios-indigo text-white shadow-xl scale-[1.15] z-10":w==="present"?"bg-ios-emerald/10 text-ios-emerald":w==="late"?"bg-ios-amber/10 text-ios-amber":w==="absent"?"bg-ios-rose/10 text-ios-rose":w==="booking"?"bg-ios-indigo/10 text-ios-indigo":"bg-gray-50 text-gray-300 hover:bg-gray-100 hover:text-gray-500"}`,children:[rt(m,"d"),w&&!b&&w!=="booking"&&v.jsx("div",{className:`absolute bottom-1 w-1 h-1 rounded-full ${w==="present"?"bg-ios-emerald":w==="late"?"bg-ios-amber":"bg-ios-rose"}`}),w==="booking"&&!b&&v.jsx("div",{className:"absolute bottom-1 w-1 h-1 rounded-full bg-ios-indigo"})]},g)})}),v.jsx("div",{className:"mt-10 pt-8 border-t border-gray-100",children:v.jsxs("div",{className:"flex flex-col gap-4",children:[v.jsx("span",{className:"text-[11px] font-black text-ios-gray uppercase tracking-[0.2em]",children:" "}),v.jsx("div",{className:"flex flex-wrap gap-4",children:[{label:"",color:"bg-ios-emerald"},{label:"",color:"bg-ios-amber"},{label:"",color:"bg-ios-rose"},{label:"",color:"bg-gray-100"},{label:"",color:"bg-ios-indigo"}].map(m=>v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:`w-2 h-2 rounded-full ${m.color}`}),v.jsx("span",{className:"text-[10px] font-bold text-gray-400",children:m.label})]},m.label))})]})})]})}),v.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4 md:gap-6 overflow-visible",children:[v.jsx("div",{className:"xl:col-span-2 flex flex-col gap-4 md:gap-6 animate-spring-up",style:{animationDelay:"100ms"},children:v.jsxs("div",{className:"grid grid-cols-2 gap-4 md:gap-6",children:[v.jsxs("div",{className:"col-span-2 bg-white rounded-[32px] p-8 flex flex-col items-center text-center gap-2 group transition-all duration-500 ios-tap border border-gray-100 shadow-sm relative overflow-hidden",children:[v.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-ios-amber/10 blur-3xl -z-10"}),v.jsx("div",{className:"w-16 h-16 rounded-ios bg-ios-amber/10 text-ios-amber flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform mb-2",children:v.jsx(w1,{className:"w-8 h-8"})}),v.jsx("p",{className:"text-[11px] uppercase font-black text-ios-gray tracking-widest",children:"   "}),v.jsxs("div",{className:"flex flex-col items-center",children:[v.jsxs("p",{className:"text-4xl font-black text-[#1C1C1E]",children:[s.cumulativeDays,""]}),v.jsx("p",{className:"text-sm font-bold text-gray-400 mt-1",children:p(s.cumulativeTime)})]})]}),v.jsxs("div",{className:"bg-white rounded-[32px] p-8 flex flex-col items-center text-center gap-4 group transition-all duration-500 ios-tap border border-gray-100 shadow-sm",children:[v.jsx("div",{className:"w-12 h-12 rounded-ios bg-ios-emerald/10 text-ios-emerald flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform",children:v.jsx(Ka,{className:"w-6 h-6"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-[10px] uppercase font-black text-ios-gray tracking-widest mb-1",children:""}),v.jsxs("p",{className:"text-2xl font-black text-[#1C1C1E]",children:[s.attendanceRate,"%"]})]})]}),v.jsxs("div",{className:"bg-white rounded-[32px] p-8 flex flex-col items-center text-center gap-4 group transition-all duration-500 ios-tap border border-gray-100 shadow-sm",children:[v.jsx("div",{className:"w-12 h-12 rounded-ios bg-ios-rose/10 text-ios-rose flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform",children:v.jsx(SO,{className:"w-6 h-6"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-[10px] uppercase font-black text-ios-gray tracking-widest mb-1",children:" "}),v.jsxs("p",{className:"text-2xl font-black text-[#1C1C1E]",children:[s.lateCount,""]})]})]})]})}),v.jsx("div",{className:"animate-spring-up",style:{animationDelay:"200ms"},children:v.jsxs("div",{className:"bg-gradient-to-br from-ios-indigo via-[#7D7AFF] to-[#9B99FF] rounded-[32px] p-10 text-white shadow-2xl shadow-ios-indigo/30 relative overflow-hidden group ios-tap",children:[v.jsxs("div",{className:"relative z-10",children:[v.jsx("div",{className:"w-14 h-14 rounded-2xl bg-white/20 backdrop-blur-md flex items-center justify-center mb-6 shadow-inner-white",children:v.jsx(w1,{className:"w-8 h-8 text-white"})}),v.jsx("h4",{className:"text-2xl font-black tracking-tight mb-2",children:" "}),v.jsxs("p",{className:"text-[15px] text-white/80 font-medium mb-8 leading-relaxed",children:[" 5%  .",v.jsx("br",{}),"   ."]}),v.jsx("button",{onClick:()=>f(!0),className:"w-full py-4 bg-black hover:bg-gray-900 rounded-2xl text-xs font-black uppercase tracking-widest transition-all backdrop-blur-sm border border-white/10",children:" "})]}),v.jsx("div",{className:"absolute -right-16 -top-16 w-64 h-64 bg-white/10 rounded-full blur-3xl group-hover:scale-150 transition-transform duration-[2000ms]"}),v.jsx("div",{className:"absolute left-[-10%] bottom-[-10%] w-40 h-40 bg-white/5 rounded-full blur-2xl group-hover:translate-x-10 transition-transform duration-[2000ms]"})]})})]}),c&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 animate-in fade-in duration-200",children:[v.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>f(!1)}),v.jsxs("div",{className:"bg-white rounded-ios p-8 w-full max-w-md relative z-10 shadow-2xl animate-spring-up",children:[v.jsxs("div",{className:"flex items-center justify-between mb-8",children:[v.jsxs("h3",{className:"text-xl font-black flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 rounded-ios bg-ios-amber/20 flex items-center justify-center",children:v.jsx(w1,{className:"w-5 h-5 text-ios-amber"})})," "]}),v.jsx("div",{className:"bg-gray-100 rounded-full px-3 py-1",children:v.jsx("span",{className:"text-[10px] font-bold text-gray-500",children:"TOP 10"})})]}),v.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2",children:o.length>0?o.map((m,g)=>v.jsxs("div",{className:"flex items-center justify-between p-4 rounded-ios bg-gray-50 border border-gray-100/50",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:`w-8 h-8 flex items-center justify-center font-black rounded-full shadow-sm ${g===0?"bg-yellow-400 text-white":g===1?"bg-gray-400 text-white":g===2?"bg-orange-400 text-white":"bg-white text-gray-400 border border-gray-200"}`,children:m.rank}),v.jsx("div",{className:"flex flex-col",children:v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"text-sm font-black text-[#1C1C1E]",children:m.name}),v.jsx("span",{className:"text-[10px] font-bold text-gray-500 bg-white px-1.5 py-0.5 rounded border border-gray-200",children:m.info})]})})]}),v.jsx("p",{className:"text-xs font-bold text-ios-indigo bg-ios-indigo/5 px-2 py-1 rounded-lg",children:p(m.score)})]},g)):v.jsx("div",{className:"text-center py-12 text-gray-400 font-medium text-sm bg-gray-50 rounded-ios",children:"  ,   ."})}),v.jsx("button",{onClick:()=>f(!1),className:"w-full mt-6 py-4 bg-ios-indigo text-white rounded-ios font-black text-sm hover:scale-[1.02] active:scale-[0.98] transition-all shadow-lg",children:""})]})]})]})},eY=({onLogout:e,currentUser:t})=>{const[r,n]=xe.useState("home"),[i,s]=xe.useState(null),[l,o]=xe.useState(null),[a,c]=xe.useState(""),[f,h]=xe.useState(""),[d,u]=xe.useState({}),[p,m]=xe.useState(new Date),[g,x]=xe.useState(null),[y,w]=xe.useState([]),[b,S]=xe.useState(null),T=cf.useCallback(async()=>{if(!t)return;const V=rt(new Date,"yyyy-MM-dd"),G=Bn(p,{weekStartsOn:1}),te=jo(p,{weekStartsOn:1}),{data:ee}=await He.from("study_plans").select("content").or(`student_id.eq.${t.id},user_id.eq.${t.id}`).eq("date",V);ee&&ee.length>0?h(ee.map(N=>N.content).filter(Boolean).join(`
`)):h("");const{data:Q}=await He.from("bookings").select(`
            *,
            sessions (id, name, start_time, end_time),
            seats (id, seat_number, zone_name, zone_id, zones(name)),
            attendance (id, booking_id, status, timestamp_in, timestamp_out)
        `).or(`student_id.eq.${t.id},user_id.eq.${t.id}`).gte("date",rt(G,"yyyy-MM-dd")).lte("date",rt(te,"yyyy-MM-dd"));if(Q){const N={};Q.forEach(U=>{const R=U.date;N[R]||(N[R]={bookings:[],attendance:[]}),N[R].bookings.push(U),U.attendance&&U.attendance.length>0&&N[R].attendance.push(...U.attendance)}),u(N)}const{data:K}=await He.from("operation_exceptions").select("*").gte("exception_date",rt(G,"yyyy-MM-dd")).lte("exception_date",rt(te,"yyyy-MM-dd"));w(K||[])},[t,p]),O=cf.useCallback(async()=>{const{data:V}=await He.from("sessions").select("*").order("start_time",{ascending:!0});if(V){const te=rt(new Date,"HH:mm:00"),ee=V.find(K=>te>=K.start_time&&te<=K.end_time),Q=V.find(K=>K.start_time>te);s(ee),o(Q)}},[]);xe.useEffect(()=>{const V=async()=>{var ee;const{data:te}=await He.from("configs").select("value").eq("key","school_info").single();(ee=te==null?void 0:te.value)!=null&&ee.name_en&&c(te.value.name_en)};O(),V(),T();const G=setInterval(()=>{O(),T()},6e4);return()=>clearInterval(G)},[O,T]),xe.useEffect(()=>{const V=rt(new Date,"yyyy-MM-dd"),G=d[V];if(!G){S(null);return}const te=G.bookings||[],ee=G.attendance||[];if(i){const Q=te.find(N=>N.session_id===i.id),K=ee.find(N=>N.booking_id===(Q==null?void 0:Q.id));S(K||null)}else if(l){const Q=te.find(N=>N.session_id===l.id),K=ee.find(N=>N.booking_id===(Q==null?void 0:Q.id));S(K||null)}else S(null)},[d,i,l]),xe.useEffect(()=>{const V=setInterval(()=>{(async()=>{const{data:te}=await He.from("sessions").select("*").order("start_time",{ascending:!0});if(te){const Q=rt(new Date,"HH:mm:00"),K=te.find(U=>Q>=U.start_time&&Q<=U.end_time),N=te.find(U=>U.start_time>Q);s(K),o(N)}})()},6e4);return()=>clearInterval(V)},[]);const j=()=>m(V=>DT(V)),L=()=>m(V=>gm(V,1)),W=(V,G)=>{var I,H;if(!G||!G.bookings.length)return null;const te=new Date,ee=rt(te,"yyyy-MM-dd"),{bookings:Q,attendance:K}=G;if(V>ee)return{label:"",color:"text-ios-indigo bg-ios-indigo/10"};if(V<ee)return K.length?K.some(Y=>Y.status==="late")?{label:"",color:"text-ios-amber bg-ios-amber/10"}:{label:"",color:"text-ios-emerald bg-ios-emerald/10"}:{label:"",color:"text-ios-rose bg-ios-rose/10"};const N=rt(te,"HH:mm:ss"),U=[...Q].sort((J,Y)=>{var Z,fe;return(((Z=J.sessions)==null?void 0:Z.start_time)||"").localeCompare(((fe=Y.sessions)==null?void 0:fe.start_time)||"")});if(!U.length)return null;const R=(I=U[0].sessions)==null?void 0:I.start_time,k=(H=U[U.length-1].sessions)==null?void 0:H.end_time,P=Q.some(J=>{var Y;return(((Y=J.sessions)==null?void 0:Y.start_time)||"")>="17:00:00"}),A=N>="09:00:00"&&N<="17:00:00",E=U.find(J=>{const Y=J.sessions;return Y&&N>=Y.start_time&&N<=Y.end_time});return E?K.find(Y=>Y.booking_id===E.id)?{label:"",color:"text-white bg-ios-emerald"}:{label:"",color:"text-ios-rose bg-ios-rose/10"}:A&&P?{label:"",color:"text-gray-400 bg-gray-100"}:k&&N>k?{label:"",color:"text-gray-500 bg-gray-100"}:R&&N<R?{label:"",color:"text-ios-indigo bg-ios-indigo/10"}:{label:"",color:"text-ios-amber bg-ios-amber/10"}},F=()=>{switch(r){case"home":return v.jsxs("div",{className:"h-full flex flex-col gap-4 p-4 animate-fade-in relative overflow-hidden",children:[v.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-ios-indigo/5 blur-3xl -z-10"}),v.jsx("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-ios-blue/5 blur-3xl -z-10"}),v.jsxs("div",{className:"flex-[2] glass-card p-7 relative overflow-hidden flex flex-col",children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-ios-amber/10 flex items-center justify-center",children:v.jsx(q2,{className:"w-4 h-4 text-ios-amber"})}),v.jsx("h2",{className:"text-lg font-black text-[#1C1C1E] tracking-tight",children:" "})]}),v.jsxs("span",{className:"text-[10px] font-bold text-ios-gray bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100 max-sm:hidden",children:[rt(new Date,"M d")," "]})]}),v.jsx("div",{className:"flex-1 flex items-center justify-center text-center",children:f?v.jsx("p",{className:"text-[15px] text-[#1C1C1E] font-bold leading-relaxed whitespace-pre-line line-clamp-3",children:f}):v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-sm text-gray-400 font-bold leading-relaxed mb-1",children:"    ."}),v.jsx("span",{className:"text-xs font-medium text-gray-300",children:"   ."})]})}),v.jsxs("div",{className:"bg-gray-200/20 rounded-apple-md p-4 border border-white/40 mt-auto relative backdrop-blur-xl",children:[v.jsx("button",{onClick:j,className:"absolute left-1 top-1/2 -translate-y-1/2 w-8 h-8 flex items-center justify-center text-ios-gray hover:text-[#1C1C1E] transition-colors ios-tap",children:v.jsx(Mo,{className:"w-5 h-5"})}),v.jsx("button",{onClick:L,className:"absolute right-1 top-1/2 -translate-y-1/2 w-8 h-8 flex items-center justify-center text-ios-gray hover:text-[#1C1C1E] transition-colors ios-tap",children:v.jsx(Ts,{className:"w-5 h-5"})}),v.jsx("div",{className:"flex justify-between items-center px-6",children:eu({start:Bn(p,{weekStartsOn:1}),end:jo(p,{weekStartsOn:1})}).map((ee,Q)=>{const K=rt(ee,"yyyy-MM-dd"),N=d[K],U=W(K,N),R=Ol(ee,new Date);let k=R?U?"bg-ios-indigo text-white shadow-lg ring-4 ring-white z-10":"bg-white/50 border border-white/40 text-[#1C1C1E]":"bg-white/50 border border-white/40 text-gray-300";(U==null?void 0:U.label)===""||(U==null?void 0:U.label)===""||(U==null?void 0:U.label)===""?k="bg-ios-emerald text-white shadow-sm border-none":(U==null?void 0:U.label)===""?k="bg-ios-amber text-white shadow-sm border-none":(U==null?void 0:U.label)===""||(U==null?void 0:U.label)===""?k="bg-ios-rose text-white shadow-sm border-none":(U==null?void 0:U.label)===""&&(k="bg-ios-indigo text-white shadow-sm border-none");const P=Q===5||Q===6,A=y.some(I=>I.date===K);let E="text-gray-300";return R?E="text-ios-indigo":A||P?E="text-ios-rose/40":N&&N.bookings.length>0&&(E="text-ios-indigo"),v.jsxs("div",{className:`flex flex-col items-center gap-4 ${N?"cursor-pointer":""}`,onClick:()=>N&&x(ee),children:[v.jsx("span",{className:`text-[9px] font-black ${E}`,children:["","","","","","",""][Q]}),v.jsx("div",{className:`w-8 h-8 rounded-ios flex items-center justify-center text-[10px] font-black transition-all ios-tap ${k}`,children:rt(ee,"d")}),v.jsx("div",{className:"h-4 flex items-center justify-center",children:U?v.jsx("span",{className:`text-[8px] font-bold px-1.5 py-0.5 rounded-full whitespace-nowrap ${U.color}`,children:U.label}):R?v.jsx("span",{className:"text-[8px] font-black text-ios-indigo",children:""}):v.jsx("div",{className:"w-1 h-1 rounded-full bg-transparent"})})]},Q)})})]})]}),v.jsxs("button",{onClick:()=>n("map"),className:"flex-1 bg-white rounded-apple border border-gray-100 shadow-sm p-4 flex items-center justify-center gap-6 group transition-all active:scale-[0.98] relative overflow-hidden ios-tap",children:[v.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-ios-indigo/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),v.jsx("div",{className:"w-14 h-14 rounded-full bg-ios-indigo/10 flex items-center justify-center group-hover:scale-110 transition-transform duration-500",children:v.jsx(cv,{className:"w-7 h-7 text-ios-indigo"})}),v.jsxs("div",{className:"text-left space-y-1 relative z-10 flex-1",children:[v.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:""}),v.jsx("p",{className:"text-xs font-bold text-ios-gray",children:"      "})]}),v.jsx(Ts,{className:"w-5 h-5 text-gray-300"})]}),(()=>{const ee=new Date,Q=l&&(()=>{const P=rt(ee,"yyyy-MM-dd"),E=(Gh(`${P} ${l.start_time}`,"yyyy-MM-dd HH:mm:ss",new Date).getTime()-ee.getTime())/(1e3*60);return E>=0&&E<=10})(),K=i&&(b==null?void 0:b.timestamp_in),N=K?"":"",U=K?"   ":Q?"   ":"   ",R=K?"text-ios-rose bg-ios-rose/10":"text-ios-indigo bg-ios-indigo/10",k=K?fd:Ka;return v.jsxs("button",{onClick:()=>n("attendance"),className:"flex-1 bg-white rounded-apple border border-gray-100 shadow-sm p-4 flex items-center justify-between active:scale-[0.98] transition-all ios-tap mb-4",children:[v.jsxs("div",{className:"flex items-center gap-6",children:[v.jsx("div",{className:`w-14 h-14 rounded-full flex items-center justify-center ${R}`,children:v.jsx(k,{className:"w-7 h-7"})}),v.jsxs("div",{className:"text-left space-y-1",children:[v.jsx("h3",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:N}),v.jsx("p",{className:"text-xs font-bold text-gray-400",children:U})]})]}),v.jsx(Ts,{className:"w-5 h-5 text-gray-300"})]})})()]});case"map":return v.jsx("div",{className:"flex-1 bg-white relative overflow-hidden flex flex-col",children:v.jsx(ZX,{onCancel:()=>n("home"),onSuccess:()=>n("profile"),currentUser:t})});case"attendance":const V=new Date,G=l&&(()=>{const ee=rt(V,"yyyy-MM-dd"),K=(Gh(`${ee} ${l.start_time}`,"yyyy-MM-dd HH:mm:ss",new Date).getTime()-V.getTime())/(1e3*60);return K>=0&&K<=10})(),te=i&&(b==null?void 0:b.timestamp_in)||!i&&G;return v.jsx("div",{className:"flex-1 bg-white flex flex-col items-center justify-center overflow-y-auto scrollbar-hide px-6",children:v.jsx("div",{className:"w-full max-w-lg py-8 flex flex-col items-center justify-center",children:v.jsx(MT,{user:t,isEarlyLeaveMode:te,onSuccess:()=>{T(),n("home")}})})});case"profile":return v.jsx("div",{className:"flex-1 bg-[#F2F2F7] overflow-y-auto scrollbar-hide p-6",children:v.jsx(RT,{user:t})});default:return null}},M=()=>{if(!g)return null;const V=rt(g,"yyyy-MM-dd"),G=d[V],ee=[...(G==null?void 0:G.bookings)||[]].sort((Q,K)=>{var N,U;return(((N=Q.sessions)==null?void 0:N.start_time)||"").localeCompare(((U=K.sessions)==null?void 0:U.start_time)||"")});return v.jsx("div",{className:"fixed inset-0 z-[100] bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",children:v.jsx("div",{className:"bg-white w-full max-w-sm rounded-3xl overflow-hidden shadow-2xl relative animate-spring-up",children:v.jsxs("div",{className:"p-6",children:[v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsxs("h3",{className:"text-xl font-black text-[#1C1C1E]",children:[rt(g,"M d"),"  "]}),v.jsx("button",{onClick:()=>x(null),className:"p-2 -mr-2 text-gray-400 hover:text-black ios-tap",children:v.jsx(Ja,{className:"w-5 h-5"})})]}),v.jsx("div",{className:"space-y-4 mb-4 max-h-[50vh] overflow-y-auto scrollbar-hide",children:ee.length>0?ee.map((Q,K)=>{var H,J,Y,Z,fe,X,re,se,z;const N=new Date,U=V===rt(N,"yyyy-MM-dd"),R=rt(N,"HH:mm:ss"),k=(H=Q.sessions)==null?void 0:H.end_time,P=(J=Q.attendance)==null?void 0:J[0],A=U&&k&&R>k,E=P?P.status==="present"?"":P.status==="late"?"":"":A?"":"",I=P?P.status==="present"?"text-ios-emerald bg-ios-emerald/10":P.status==="late"?"text-ios-amber bg-ios-amber/10":"text-ios-rose bg-ios-rose/10":A?"text-ios-rose bg-ios-rose/10":"text-gray-400 bg-gray-50";return v.jsxs("div",{className:"p-4 bg-gray-50 rounded-2xl flex items-center justify-between border border-gray-100",children:[v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[v.jsx("p",{className:"text-sm font-black text-[#1C1C1E]",children:(Y=Q.sessions)==null?void 0:Y.name}),v.jsx("span",{className:`text-[10px] font-bold px-1.5 py-0.5 rounded-full ${I}`,children:E})]}),v.jsxs("p",{className:"text-xs text-ios-gray font-bold",children:[v.jsx(Qa,{className:"w-3 h-3 inline-block mr-1 mb-0.5"}),(Z=Q.sessions)==null?void 0:Z.start_time.slice(0,5)," ~ ",(fe=Q.sessions)==null?void 0:fe.end_time.slice(0,5)]})]}),v.jsxs("div",{className:"text-right",children:[v.jsx("p",{className:"text-[10px] font-black text-ios-indigo/60 mb-0.5",children:((re=(X=Q.seats)==null?void 0:X.zones)==null?void 0:re.name)||""}),v.jsxs("p",{className:"text-xs font-black text-ios-indigo",children:[(se=Q.seats)!=null&&se.zone_name?`${Q.seats.zone_name}-`:"",Q.seat_number||((z=Q.seats)==null?void 0:z.seat_number)||"-"," "]}),(P==null?void 0:P.timestamp_in)&&v.jsxs("p",{className:"text-[10px] text-ios-gray font-bold mt-1",children:[": ",rt(new Date(P.timestamp_in),"HH:mm")]})]})]},K)}):v.jsxs("div",{className:"py-12 text-center space-y-2",children:[v.jsx(Io,{className:"w-10 h-10 text-gray-200 mx-auto"}),v.jsx("p",{className:"text-sm font-bold text-gray-400",children:"   ."})]})}),v.jsx("button",{onClick:()=>x(null),className:"w-full py-4 bg-[#1C1C1E] text-white rounded-2xl font-black text-sm hover:scale-[1.02] active:scale-[0.98] transition-all shadow-lg",children:""})]})})})};return v.jsxs("div",{className:"mobile-container flex flex-col bg-[#F2F2F7] h-[100dvh] overflow-hidden font-sans pb-[safe-area-inset-bottom]",children:[v.jsxs("header",{className:"flex-none glass-header px-6 pt-4 pb-4 flex items-center justify-between shadow-sm z-50",children:[v.jsxs("div",{className:"flex flex-col",children:[v.jsx("h1",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:a.split(" ")[0]}),v.jsx("p",{className:"text-[10px] font-black text-ios-indigo tracking-[0.2em] uppercase opacity-70",children:"Study Cafe Manager"})]}),v.jsx("div",{className:"flex items-center gap-4",children:v.jsx("button",{onClick:e,className:"p-3 bg-gray-200/20 text-ios-gray hover:text-ios-rose hover:bg-ios-rose/10 rounded-apple-md transition-all ios-tap border border-white/40 backdrop-blur-xl",children:v.jsx(fd,{className:"w-5 h-5"})})})]}),v.jsx("main",{className:"flex-1 flex flex-col overflow-hidden relative",children:F()}),v.jsx("nav",{className:"flex-none glass-material pb-[calc(0.4rem+env(safe-area-inset-bottom,0px))] pt-2 px-6 flex justify-between items-center z-50 shadow-[0_-4px_40px_rgba(0,0,0,0.03)] border-t border-white/40",children:[{id:"home",icon:n3,label:""},{id:"map",icon:cv,label:""},{id:"attendance",icon:xf,label:""},{id:"profile",icon:gd,label:"MY"}].map(V=>v.jsxs("button",{onClick:()=>n(V.id),className:`flex flex-col items-center justify-center p-2 rounded-apple-md transition-all duration-300 w-16 group ios-tap ${r===V.id?"text-[#1C1C1E]":"text-gray-300 hover:text-gray-500"}`,children:[v.jsx("div",{className:"relative transition-transform duration-300",children:v.jsx(V.icon,{className:`w-7 h-7 stroke-[2.5px] ${r===V.id?"fill-ios-indigo/10":"fill-transparent"}`})}),v.jsx("span",{className:"text-[9px] font-black mt-1",children:V.label})]},V.id))}),M()]})},tY=({selectedSeat:e,onComplete:t,targetUser:r,loggedInUser:n,initialDate:i,onDateChange:s,currentZoneId:l,onOpenSeatModal:o})=>{var X;const[a,c]=xe.useState(1),[f,h]=xe.useState(i||rt(Ss(new Date,2),"yyyy-MM-dd")),[d,u]=xe.useState(rt(Ss(new Date,2),"yyyy-MM-dd")),[p,m]=xe.useState([]),[g,x]=xe.useState([]),[y,w]=xe.useState([]),[b,S]=xe.useState(null),[T,O]=xe.useState(null),[j,L]=xe.useState({quarters:[],exceptions:[],operatingRules:[]}),[W,F]=xe.useState([]),[M,V]=xe.useState([]),[G,te]=xe.useState(!1),[ee,Q]=xe.useState(""),[K,N]=xe.useState({enabled:!1,restrictions:{}});xe.useEffect(()=>{i&&h(i)},[i]),xe.useEffect(()=>{He.from("zones").select("id, name").then(({data:re})=>x(re||[]))},[]);const U={Morning:" ",Dinner:" ","1st Period":"1","2nd Period":"2"},R=re=>U[re]||re;xe.useEffect(()=>{(async()=>{var we,ye;const{data:{user:se}}=await He.auth.getUser();if(se){const{data:de}=await He.from("profiles").select("*").eq("id",se.id).single();S(r||de),O(de)}const z=(e==null?void 0:e.zone_id)||l;if(z){te(!0);const[de,Te,pe,Ae]=await Promise.all([He.from("sessions").select("*").eq("zone_id",z).order("start_time",{ascending:!0}),He.from("operation_quarters").select("*"),He.from("operation_exceptions").select("*").eq("zone_id",z),He.from("configs").select("*").eq("key",`zone_op_config_${z}`).maybeSingle()]);de.data&&m(de.data);const{data:Ie}=await He.from("session_operating_days").select("session_id, day_of_week").in("session_id",(de.data||[]).map(je=>je.id)).eq("is_active",!0);L({quarters:Te.data||[],exceptions:pe.data||[],operatingRules:Ie||[]}),te(!1)}else{const{data:de}=await He.from("operation_quarters").select("*");L(Te=>({...Te,quarters:de||[]}))}const[oe,ce]=await Promise.all([He.from("configs").select("value").eq("key","grade_restriction_enabled").maybeSingle(),He.from("configs").select("value").eq("key","sub_zone_grade_restrictions").maybeSingle()]);N({enabled:!!((we=oe.data)!=null&&we.value),restrictions:((ye=ce.data)==null?void 0:ye.value)||{}})})()},[e,l,r]),xe.useEffect(()=>{S(r||T)},[r,T]),xe.useEffect(()=>{b&&f&&e&&(k(),P()),w([])},[b,f,e,l]);const k=async()=>{const{data:re}=await He.from("bookings").select("*").eq("user_id",b.id).eq("date",f);F(re||[])},P=async()=>{if(!e)return;const{data:re}=await He.from("bookings").select("*, profiles(username, full_name), profiles_student(username, full_name)").eq("seat_id",e.id).eq("date",f);V(re||[])},A=re=>{const se=Cr(re),z=n||T,oe=z&&["admin","teacher"].includes(z.role),ce=Ga(Ss(new Date,oe?0:2));if(Vh(se,ce))return{ok:!1,msg:`   ${oe?"0":"2"}  .`};if(j.quarters.length>0&&!j.quarters.some(de=>de.start_date&&de.end_date&&Wc(se,{start:Cr(de.start_date),end:Cr(de.end_date)})))return{ok:!1,msg:"    ."};const we=j.exceptions.find(ye=>ye.exception_date===re);if(we)return{ok:!1,msg:`: ${we.reason}`};if(j.operatingRules.length>0){const ye=se.getDay();if(!j.operatingRules.some(Te=>Te.day_of_week===ye))return{ok:!1,msg:"   ."}}return{ok:!0}},E=()=>{if(a===1){const re=n||T;if(re&&["admin","teacher"].includes(re.role)&&!r){Q("/     .     .");return}const se=A(f);if(!se.ok){Q(se.msg);return}if(W.length>0&&e&&W[0].seat_id!==e.id){Q(`  ${W[0].seat_number}  .`);return}if(K.enabled&&e){const oe=(K.restrictions[e.zone_id]||{})[e.zone_name];if(oe&&Array.isArray(oe)&&oe.length>0){const ce=(b==null?void 0:b.username)||"",we=parseInt(ce.substring(0,1));if(!oe.includes(we)){Q(`'${e.zone_name}'  ${oe.sort().join(", ")}  .`);return}}}}Q(""),c(re=>re+1)},I=re=>{w(se=>se.find(oe=>oe.id===re.id)?se.filter(oe=>oe.id!==re.id):[...se,re].sort((oe,ce)=>oe.id-ce.id))};async function H(re,se){if(re.stopPropagation(),!!window.confirm("   ?"))try{te(!0);const{error:z}=await He.from("bookings").delete().eq("seat_id",e.id).eq("date",f).eq("session_id",se);if(z)throw z;V(oe=>oe.filter(ce=>ce.session_id!==se)),F(oe=>oe.filter(ce=>ce.session_id!==se)),alert(" .")}catch(z){console.error("Cancel Error:",z),Q(`    : ${z.message}`)}finally{te(!1)}}async function J(){if(y.length===0||G)return;const re=n||T;if(re&&["admin","teacher"].includes(re.role)&&!r){Q("/     ."),c(1);return}const se=()=>{const z=new Date,oe=9*60*60*1e3;return new Date(z.getTime()+oe).toISOString().replace("Z","+09:00")};te(!0);try{const{data:z}=await He.from("bookings").select("session_id, user_id, seat_id").eq("date",f).in("session_id",y.map(we=>we.id));if(z&&z.length>0){const we=z.some(de=>de.seat_id===e.id),ye=z.some(de=>de.user_id===b.id);if(we||ye){Q(we?"   .":"      ."),c(2),te(!1),k(),P();return}}const oe=y.map(we=>({user_id:n.id,student_id:r?r.id:n.id,seat_id:e.id,session_id:we.id,date:f,created_at:se(),status:"confirmed"})),{error:ce}=await He.from("bookings").insert(oe);ce?(Q(` : ${ce.message}`),c(2)):(alert(" ."),t(),window.location.reload())}catch{Q("   ")}finally{te(!1)}}const[Y,Z]=xe.useState(new Date),fe=()=>{const re=kf(Y),se=Rd(re),z=Bn(re),oe=jo(se),ce=eu({start:z,end:oe});return v.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-4 shadow-sm",children:[v.jsxs("div",{className:"flex items-center justify-between mb-4 px-1",children:[v.jsx("h4",{className:"text-sm font-black text-[#1C1C1E]",children:rt(Y,"yyyy M",{locale:fn})}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>Z(mm(Y)),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",children:v.jsx(Mo,{className:"w-4 h-4 text-ios-gray"})}),v.jsx("button",{onClick:()=>Z(t0(Y,1)),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",children:v.jsx(Ts,{className:"w-4 h-4 text-ios-gray"})})]})]}),v.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[["","","","","","",""].map(we=>v.jsx("div",{className:"text-center text-[10px] font-bold text-ios-gray/50 py-1",children:we},we)),ce.map((we,ye)=>{const de=rt(we,"yyyy-MM-dd"),Te=A(de),pe=f===de,Ae=Ol(kf(we),re),Ie=Vy(we);return v.jsx("button",{disabled:!Te.ok,onClick:()=>{h(de),s&&s(de)},className:`
                  h-9 w-full rounded-lg flex flex-col items-center justify-center transition-all relative
                  ${pe?"bg-[#1C1C1E] text-white shadow-md z-10":""}
                  ${!pe&&Ae&&Te.ok?"hover:bg-gray-100 text-[#1C1C1E] font-black":""}
                  ${!pe&&Te.ok&&!Ae?"text-ios-gray/40 font-black":""}
                  ${Te.ok?"":"opacity-20 cursor-not-allowed text-ios-gray grayscale"}
                  ${!pe&&Ie?"border border-ios-indigo text-ios-indigo font-black":""}
                `,children:v.jsx("span",{className:"text-xs",children:rt(we,"d")})},ye)})]}),v.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-50 flex items-center gap-4 px-1",children:[v.jsxs("div",{className:"flex items-center gap-1.5",children:[v.jsx("div",{className:"w-2 h-2 rounded-full bg-[#1C1C1E]"}),v.jsx("span",{className:"text-[10px] font-bold text-[#1C1C1E]",children:""})]}),v.jsxs("div",{className:"flex items-center gap-1.5",children:[v.jsx("div",{className:"w-2 h-2 rounded-full bg-ios-indigo/20"}),v.jsx("span",{className:"text-[10px] font-bold text-ios-indigo/70",children:""})]})]})]})};return v.jsxs("div",{className:"bg-white border border-gray-100 border-b-0 rounded-t-[6px] rounded-b-none pt-[10px] px-6 pb-6 lg:px-8 lg:pb-8 space-y-5 animate-spring-up relative min-h-full",children:[v.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-ios-indigo/5 blur-2xl -z-10"}),v.jsxs("div",{className:"bg-gray-50/50 rounded-[6px] mt-[10px] pt-4 px-4 pb-4 flex items-center gap-4 border border-gray-100",children:[v.jsx("div",{className:"w-12 h-12 rounded-[6px] bg-white text-[#000000] flex items-center justify-center font-black text-sm border border-gray-200 shadow-sm",children:e?e.display_number||e.seat_number:"?"}),v.jsxs("div",{children:[v.jsx("p",{className:"text-[9px] font-black text-[#000000] uppercase tracking-[0.2em] mb-0.5 opacity-50",children:e?"  ":"   "}),v.jsx("p",{className:"text-base font-black text-[#1C1C1E]",children:e?`Zone ${((X=g.find(re=>re.id===e.zone_id))==null?void 0:X.name)||""}`:"  "})]})]}),v.jsx("div",{className:"flex items-center gap-2",children:[1,2,3].map(re=>v.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-all duration-700 ${a>=re?"bg-[#1C1C1E]":"bg-gray-100"}`},re))}),a===1&&v.jsxs("div",{className:"space-y-6",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center",children:v.jsx(Io,{className:"w-5 h-5 text-ios-indigo"})}),v.jsx("h3",{className:"text-xl font-black tracking-tight text-[#1C1C1E]",children:"  "})]}),v.jsxs("div",{className:"space-y-4",children:[fe(),!A(f).ok&&v.jsxs("div",{className:"p-4 bg-ios-rose/5 border border-ios-rose/10 rounded-xl flex items-center gap-2 animate-shake",children:[v.jsx(Ns,{className:"w-4 h-4 text-ios-rose"}),v.jsx("p",{className:"text-[11px] font-black text-ios-rose italic",children:A(f).msg})]})]}),ee&&v.jsxs("div",{className:"p-4 bg-ios-rose/5 border border-ios-rose/10 rounded-[6px] flex items-center gap-2 animate-shake",children:[v.jsx(Ns,{className:"w-4 h-4 text-ios-rose"}),v.jsx("p",{className:"text-[11px] font-black text-ios-rose",children:ee})]}),v.jsxs("div",{className:"mt-1 pt-0 border-t-0 flex gap-3",children:[v.jsx("button",{onClick:t,className:"flex-1 py-3.5 rounded-xl text-sm font-black text-ios-gray bg-gray-50 hover:bg-gray-100 transition-all ios-tap",children:""}),v.jsx("button",{disabled:!A(f).ok||!e,onClick:E,className:`flex-[1.5] py-3.5 rounded-xl text-sm font-black text-white transition-all shadow-lg ios-tap ${A(f).ok&&e?"bg-[#1C1C1E] shadow-black/10 hover:bg-gray-800":"bg-gray-200 cursor-not-allowed shadow-none"}`,children:" "})]})]}),a===2&&v.jsxs("div",{className:"space-y-6",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center",children:v.jsx(Qa,{className:"w-5 h-5 text-ios-indigo"})}),v.jsx("h3",{className:"text-xl font-black tracking-tight text-[#1C1C1E]",children:"  "})]}),v.jsx("p",{className:"text-[11px] font-black text-ios-gray px-1",children:"      . (  )"}),v.jsx("div",{className:"grid grid-cols-1 gap-3",children:p.map(re=>{const se=Cr(f).getDay(),z=j.operatingRules.some(ye=>ye.session_id===re.id&&ye.day_of_week===se),oe=W.some(ye=>ye.session_id===re.id),ce=M.some(ye=>ye.session_id===re.id),we=y.some(ye=>ye.id===re.id);return z?v.jsxs("button",{disabled:oe||ce,onClick:()=>I(re),className:`p-4 rounded-[6px] border transition-all duration-300 flex items-center justify-between group ios-tap text-left ${we?"border-[#1C1C1E] bg-[#1C1C1E]/5 shadow-sm":oe||ce?["admin","teacher"].includes(b==null?void 0:b.role)?"border-red-100 bg-red-50/30":"opacity-30 bg-gray-100 cursor-not-allowed":"border-gray-100 bg-gray-50/50 hover:bg-gray-100/80"}`,children:[v.jsxs("div",{className:"flex-1 flex flex-col items-start",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("p",{className:"font-black text-base text-[#1C1C1E]",children:R(re.name)}),oe&&v.jsx("span",{className:"text-[9px] font-black text-ios-gray bg-gray-200 px-1.5 py-0.5 rounded-full uppercase",children:" "}),["admin","teacher"].includes(T==null?void 0:T.role)&&(()=>{const ye=M.find(Te=>Te.session_id===re.id);if(!ye)return null;const de=ye.profiles_student||ye.profiles;return de?v.jsxs("div",{className:"flex flex-col items-start gap-1",children:[v.jsx("span",{className:"text-[9px] font-black text-ios-rose bg-ios-rose/10 px-1.5 py-0.5 rounded-full uppercase",children:" "}),v.jsxs("span",{className:"text-[9px] font-bold text-ios-rose/70",children:[de.username," ",de.full_name]})]}):null})()]}),v.jsxs("p",{className:"text-[10px] font-black text-ios-gray/70 uppercase tracking-tight mt-0.5",children:[re.start_time.slice(0,5)," ~ ",re.end_time.slice(0,5)]})]}),we?v.jsx("div",{className:"w-5 h-5 rounded-full bg-[#1C1C1E] flex items-center justify-center shadow-sm",children:v.jsx(Es,{className:"w-3 h-3 text-white stroke-[3px]"})}):(oe||ce)&&["admin","teacher"].includes(b.role)?v.jsx("button",{onClick:ye=>H(ye,re.id),className:"w-8 h-8 rounded-full bg-red-50 hover:bg-red-100 flex items-center justify-center transition-all group/btn border border-red-200",title:" ",children:v.jsx(Dl,{className:"w-4 h-4 text-red-500 group-hover/btn:scale-110 transition-transform"})}):v.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-gray-300 bg-white"})]},re.id):null})}),ee&&v.jsxs("div",{className:"p-4 bg-ios-rose/5 border border-ios-rose/10 rounded-[6px] flex items-center gap-2 animate-shake",children:[v.jsx(Ns,{className:"w-4 h-4 text-ios-rose"}),v.jsx("p",{className:"text-[11px] font-black text-ios-rose",children:ee})]}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>t(),className:"flex-1 bg-gray-100 text-[#1C1C1E] py-4 rounded-[6px] font-black text-xs transition-all hover:bg-gray-200 ios-tap",children:""}),v.jsx("button",{onClick:()=>c(1),className:"flex-1 py-4 bg-gray-100 text-ios-gray rounded-[6px] font-black text-xs ios-tap",children:""}),v.jsxs("button",{disabled:y.length===0,onClick:E,className:"flex-[2] bg-[#1C1C1E] text-white py-4 rounded-[6px] font-black text-xs transition-all shadow-md disabled:opacity-20 ios-tap flex flex-col items-center justify-center leading-tight",children:[v.jsxs("span",{children:[y.length," "]}),v.jsx("span",{className:"opacity-60 text-[10px] mt-0.5",children:""})]})]})]}),a===3&&v.jsxs("div",{className:"space-y-8",children:[v.jsxs("div",{className:"text-center space-y-3",children:[v.jsx("div",{className:"w-12 h-12 rounded-[6px] bg-emerald-50 text-ios-emerald flex items-center justify-center mx-auto border border-emerald-100",children:v.jsx(Es,{className:"w-6 h-6"})}),v.jsxs("div",{className:"space-y-1.5",children:[v.jsx("h3",{className:"text-2xl font-black tracking-tight text-[#1C1C1E]",children:" "}),v.jsx("p",{className:"text-xs text-ios-gray font-medium",children:"    ."})]})]}),v.jsx("div",{className:"space-y-1.5",children:[{label:" ",value:rt(Cr(f),"yyyy M d (EEEE)",{locale:fn}),color:"text-[#1C1C1E]"},{label:" ",value:y.map(re=>R(re.name)).join(", "),color:"text-[#1C1C1E]"},{label:" ",value:e.zone_name,color:"text-[#1C1C1E]"},{label:" ",value:`${e.seat_number}`,color:"text-[#1C1C1E]"}].map((re,se)=>v.jsxs("div",{className:"flex justify-between items-center p-4 rounded-[6px] bg-gray-50 border border-gray-100",children:[v.jsx("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest leading-none",children:re.label}),v.jsx("span",{className:`text-sm font-black text-right max-w-[200px] ${re.color}`,children:re.value})]},se))}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>t(),className:"flex-1 bg-gray-100 text-[#1C1C1E] py-5 rounded-[6px] font-black text-base transition-all hover:bg-gray-200 ios-tap",children:""}),v.jsxs("button",{disabled:G,onClick:J,className:"flex-[2] bg-[#1C1C1E] text-white py-5 rounded-[6px] font-black text-base transition-all shadow-lg shadow-black/20 flex items-center justify-center gap-3 ios-tap overflow-hidden relative group disabled:opacity-50",children:[G?" ...":" "," ",v.jsx(Ts,{className:"w-5 h-5"})]})]})]})]})},zk=({applicant:e,schoolInfo:t})=>v.jsxs("div",{className:"pledge-doc",children:[v.jsxs("div",{children:[v.jsx("div",{className:"pledge-header",children:v.jsx("h1",{className:"pledge-title",children:"  "})}),v.jsxs("p",{className:"intro-text",children:["         ,",v.jsx("br",{}),"          ."]}),v.jsxs("div",{className:"content-flex",children:[v.jsxs("div",{className:"pledge-section",children:[v.jsx("div",{className:"section-title",children:"[    ]"}),v.jsxs("div",{className:"pledge-content",children:[v.jsx("p",{children:"1.     ,       ."}),v.jsx("p",{children:"2.        ."}),v.jsx("p",{children:"3.       , ,      ."}),v.jsx("p",{children:"4.      ,         ."}),v.jsx("p",{children:"5.       ,       ."})]})]}),v.jsxs("div",{className:"pledge-section",children:[v.jsx("div",{className:"section-title",children:"[    ]"}),v.jsxs("div",{className:"pledge-content",children:[v.jsx("p",{children:"1.    ,        ."}),v.jsx("p",{children:"2.         ."}),v.jsx("p",{children:"3.          ."})]})]}),v.jsxs("div",{className:"pledge-section",children:[v.jsx("div",{className:"section-title",children:"[   ]"}),v.jsxs("div",{className:"pledge-content",children:[v.jsx("p",{children:"1.             ."}),v.jsx("p",{children:"2.          ."})]})]}),v.jsxs("div",{className:"pledge-section",children:[v.jsx("div",{className:"section-title",children:"[   ]"}),v.jsxs("div",{className:"pledge-content",children:[v.jsx("p",{children:"1.        ."}),v.jsx("p",{children:"2.         ,    ."}),v.jsx("p",{children:"3.   ,  ."})]})]}),v.jsxs("div",{className:"pledge-section",children:[v.jsx("div",{className:"section-title",children:"[    ]"}),v.jsxs("div",{className:"pledge-content",children:[v.jsx("p",{children:"1.             ."}),v.jsx("p",{children:"2.          ."})]})]}),v.jsxs("div",{className:"pledge-section",children:[v.jsx("div",{className:"section-title",children:"[  ]"}),v.jsxs("div",{className:"pledge-content",children:[v.jsx("p",{children:"1.            ."}),v.jsx("p",{children:"2.    , ,   ,          ."}),v.jsx("p",{children:"3.        ,        ."})]})]})]})]}),v.jsxs("div",{children:[v.jsxs("div",{className:"info-grid",children:[v.jsxs("div",{className:"info-item",children:[v.jsx("span",{className:"info-label",children:" :"}),v.jsx("span",{children:e.student_id})]}),v.jsxs("div",{className:"info-item",children:[v.jsx("span",{className:"info-label",children:" :"}),v.jsx("span",{children:e.name})]}),v.jsxs("div",{className:"info-item",children:[v.jsx("span",{className:"info-label",children:":"}),v.jsx("span",{children:e.phone_number||"-"})]})]}),v.jsxs("div",{className:"signature-block",children:[v.jsxs("div",{className:"sig-container",children:[v.jsx("div",{className:"sig-pad",children:e.student_signature?v.jsx("img",{src:e.student_signature,alt:" ",className:"sig-image",crossOrigin:"anonymous"}):v.jsx("span",{className:"text-gray-300 text-[10px]",children:" "})}),v.jsx("div",{className:"sig-label",children:"  ()"})]}),v.jsxs("div",{className:"sig-container",children:[v.jsx("div",{className:"sig-pad",children:e.parent_signature?v.jsx("img",{src:e.parent_signature,alt:" ",className:"sig-image",crossOrigin:"anonymous"}):v.jsx("span",{className:"text-gray-300 text-[10px]",children:" "})}),v.jsx("div",{className:"sig-label",children:" ()"})]})]}),v.jsx("div",{className:"footer-date",children:e.pledged_at?new Date(e.pledged_at).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"}):"-"}),v.jsxs("div",{className:"footer-school",children:[t.name?`${t.name}${t.level||""}`:"GOE"," "]})]})]}),rY=()=>{const[e,t]=xe.useState([]),[r,n]=xe.useState(!1),[i,s]=xe.useState(""),[l,o]=xe.useState("all"),[a,c]=xe.useState(""),[f,h]=xe.useState(null),[d,u]=xe.useState("id-asc"),[p,m]=xe.useState(!1),[g,x]=xe.useState(!1),[y,w]=xe.useState(null),[b,S]=xe.useState([]),[T,O]=xe.useState(!1),[j,L]=xe.useState(["1"]),[W,F]=xe.useState({name:"",level:""});xe.useEffect(()=>{V(),M()},[]);const M=async()=>{const{data:R}=await He.from("configs").select("value").eq("key","school_info").single();R!=null&&R.value&&F(R.value)},V=async()=>{n(!0);const{data:R,error:k}=await He.from("applicant_pool").select("*").order("name",{ascending:!0});k?console.error("Error fetching applicants:",k):t(R||[]),n(!1)},G=()=>{const R=bp.json_to_sheet([{:"",:""}]);R["!cols"]=[{wch:15},{wch:15}];const k=bp.book_new();bp.book_append_sheet(k,R,""),Xq(k,"__.xlsx")},te=async R=>{const k=R.target.files[0];if(!k)return;n(!0);const P=new FileReader;P.onload=async A=>{const E=A.target.result,I=$v(E,{type:"binary"}),H=I.SheetNames[0],J=I.Sheets[H],Z=bp.sheet_to_json(J).map(X=>({name:X.,student_id:String(X.).padStart(5,"0"),role:X.===""?"parent":X.===""?"teacher":X.===""?"admin":"student",status:"applied"})).filter(X=>X.name&&X.student_id),{error:fe}=await He.from("applicant_pool").upsert(Z,{onConflict:"name,student_id"});fe?alert("  : "+fe.message):(alert(`${Z.length}   .`),V()),n(!1)},P.readAsBinaryString(k)},ee=R=>{if(!R)return null;const k=R.split("/");return k[k.length-1]},Q=async(R,k,P="",A=R.role)=>{n(!0);try{if(k==="applied"){const E=[];if(R.student_signature){const H=ee(R.student_signature);H&&E.push(He.storage.from("student-signatures").remove([H]))}if(R.parent_signature){const H=ee(R.parent_signature);H&&E.push(He.storage.from("parent-signatures").remove([H]))}E.length>0&&await Promise.all(E);const{error:I}=await He.from("applicant_pool").update({status:"applied",rejection_reason:null,phone_number:null,pledge_accepted:!1,privacy_accepted:!1,student_signature:null,parent_signature:null,pledged_at:null}).eq("id",R.id);if(I)throw I}else{const E={status:k,rejection_reason:P,role:A};k==="approved"&&(E.rejection_reason=null);const{error:I}=await He.from("applicant_pool").update(E).eq("id",R.id);if(I)throw I}V(),h(null),c("")}catch(E){alert(" : "+(E.message||"   "))}finally{n(!1)}},K=async R=>{w(R),m(!0),setTimeout(()=>{window.print(),m(!1),w(null)},1200)},N=async()=>{if(j.length===0){alert("     .");return}n(!0);try{let R=He.from("applicant_pool").select("*").eq("status","approved").eq("role","student").order("student_id",{ascending:!0});const k=j.map(E=>`student_id.like.${E}%`).join(",");R=R.or(k);const{data:P,error:A}=await R;if(A)throw A;if(!P||P.length===0){alert(`${j.join(", ")}   .`);return}S(P),x(!0),O(!1),setTimeout(()=>{window.print(),x(!1),S([])},1500)}catch(R){console.error("Error fetching bulk print data:",R),alert("     .")}finally{n(!1)}},U=e.filter(R=>{const k=R.name.includes(i)||R.student_id.includes(i),P=l==="all"||R.status===l,A=d==="grade-1"?R.student_id.startsWith("1"):d==="grade-2"?R.student_id.startsWith("2"):d==="grade-3"?R.student_id.startsWith("3"):!0;return k&&P&&A}).sort((R,k)=>d==="name-asc"?R.name.localeCompare(k.name):d==="name-desc"?k.name.localeCompare(R.name):d==="id-asc"||d.startsWith("grade")?R.student_id.localeCompare(k.student_id):d==="id-desc"?k.student_id.localeCompare(R.student_id):0);return v.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 flex flex-col h-full overflow-hidden shadow-sm animate-spring-up",children:[v.jsxs("div",{className:"p-6 border-b border-gray-50 flex flex-col md:flex-row md:items-center justify-between gap-4 shrink-0",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center",children:v.jsx($d,{className:"w-5 h-5 text-ios-indigo"})}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-[14px] font-black text-[#1C1C1E]",children:"    "}),v.jsx("p",{className:"text-[10px] text-ios-gray font-black uppercase tracking-widest mt-0.5",children:"Applicant Pool Management"})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("button",{onClick:()=>O(!0),className:"flex items-center gap-2 bg-white hover:bg-gray-50 text-[#1C1C1E] px-4 py-2.5 rounded-[6px] text-xs font-black transition-all border border-gray-200 ios-tap",children:[v.jsx(Fl,{className:"w-4 h-4 text-ios-indigo"}),"  "]}),v.jsxs("button",{onClick:G,className:"flex items-center gap-2 bg-white hover:bg-gray-50 text-[#1C1C1E] px-4 py-2.5 rounded-[6px] text-xs font-black transition-all border border-gray-200 ios-tap",children:[v.jsx(E8,{className:"w-4 h-4 text-ios-indigo"})," "]}),v.jsxs("label",{className:"flex items-center gap-2 bg-[#1C1C1E] hover:bg-[#2C2C2E] text-white px-4 py-2.5 rounded-[6px] text-xs font-black transition-all border border-transparent cursor-pointer ios-tap shadow-sm",children:[v.jsx(EO,{className:"w-4 h-4 text-white"})," ",v.jsx("input",{type:"file",className:"hidden",accept:".xlsx,.xls",onChange:te})]})]})]}),v.jsxs("div",{className:"px-6 py-4 bg-gray-50/50 border-b border-gray-50 flex flex-col md:flex-row gap-4 shrink-0",children:[v.jsxs("div",{className:"flex-1 relative",children:[v.jsx(fv,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{type:"text",placeholder:"   ...",value:i,onChange:R=>s(R.target.value),className:"flex-1 bg-white border border-gray-200 rounded-[6px] pl-10 pr-4 py-2 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all"}),v.jsxs("select",{value:d,onChange:R=>u(R.target.value),className:"bg-white border border-gray-200 rounded-[6px] px-3 py-2 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all outline-none cursor-pointer min-w-[140px]",children:[v.jsx("option",{value:"id-asc",children:" ()"}),v.jsx("option",{value:"id-desc",children:" ()"}),v.jsx("option",{value:"name-asc",children:" ()"}),v.jsx("option",{value:"name-desc",children:" ()"}),v.jsx("option",{value:"grade-1",children:"1 ()"}),v.jsx("option",{value:"grade-2",children:"2 ()"}),v.jsx("option",{value:"grade-3",children:"3 ()"})]})]})]}),v.jsx("div",{className:"flex gap-2",children:["all","applied","pending","approved","rejected"].map(R=>v.jsx("button",{onClick:()=>o(R),className:`px-4 py-2 rounded-[6px] text-[10px] font-black uppercase tracking-widest transition-all ${l===R?"bg-[#1C1C1E] text-white shadow-md":"bg-white text-ios-gray border border-gray-200 hover:border-ios-indigo"}`,children:R==="all"?"":R==="applied"?"":R==="pending"?"":R==="approved"?"":""},R))})]}),v.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-hide",children:[v.jsxs("table",{className:"w-full text-left border-collapse",children:[v.jsx("thead",{className:"sticky top-0 bg-gray-50/90 backdrop-blur-sm z-10",children:v.jsxs("tr",{children:[v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100 text-center",children:""}),v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100 text-center",children:""}),v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100 text-center",children:""}),v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100 text-center",children:""}),v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100 text-center",children:""}),v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100 text-center",children:""}),v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100 text-center",children:""})]})}),v.jsx("tbody",{children:U.map(R=>v.jsxs("tr",{className:"hover:bg-gray-50 transition-colors group",children:[v.jsx("td",{className:"px-6 py-4 align-middle text-xs font-mono font-black text-ios-indigo text-center",children:R.student_id}),v.jsx("td",{className:"px-6 py-4 align-middle text-xs font-bold text-[#1C1C1E] text-center",children:R.name}),v.jsx("td",{className:"px-6 py-4 align-middle text-center",children:v.jsx("span",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest",children:"Student"})}),v.jsx("td",{className:"px-6 py-4 align-middle text-center",children:v.jsx("div",{className:"flex items-center justify-center gap-1.5 text-xs font-medium text-ios-gray",children:R.phone_number?v.jsxs(v.Fragment,{children:[v.jsx(uv,{className:"w-3 h-3 text-ios-emerald"}),R.phone_number]}):"-"})}),v.jsx("td",{className:"px-6 py-4 align-middle text-center",children:R.pledge_accepted?v.jsxs("div",{className:"flex items-center justify-center gap-2 group/download",children:[v.jsxs("div",{className:"flex flex-col gap-0.5",children:[v.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-black text-ios-indigo",children:[v.jsx(b8,{className:"w-3 h-3"})," "]}),v.jsx("span",{className:"text-[9px] text-ios-gray opacity-50 font-mono",children:new Date(R.pledged_at).toLocaleDateString()})]}),v.jsx("button",{onClick:()=>K(R),className:"p-1.5 rounded-full bg-ios-indigo/5 text-ios-indigo hover:bg-ios-indigo hover:text-white transition-all shadow-sm",title:" ",children:v.jsx(r3,{className:"w-3 h-3"})})]}):v.jsx("span",{className:"text-[10px] font-black text-ios-gray opacity-30",children:""})}),v.jsx("td",{className:"px-6 py-4 align-middle text-center",children:v.jsx("span",{className:`px-3 py-1.5 rounded-full text-[10px] font-black uppercase tracking-wider ${R.status==="approved"?"bg-[#ECFDF5] text-[#065F46]":R.status==="pending"?"bg-[#FFFBEB] text-[#92400E]":R.status==="rejected"?"bg-[#FFF1F2] text-[#9F1239]":"bg-gray-100 text-ios-gray"}`,title:R.status==="rejected"?` : ${R.rejection_reason||" "}`:"",children:R.status==="approved"?"":R.status==="pending"?" ":R.status==="rejected"?"":" "})}),v.jsx("td",{className:"px-6 py-4 align-middle text-center",children:v.jsxs("div",{className:"flex items-center justify-center gap-2",children:[v.jsx("button",{onClick:()=>Q(R,"approved"),className:"p-2 rounded-[6px] bg-ios-emerald/10 text-ios-emerald hover:bg-ios-emerald hover:text-white transition-all ios-tap shadow-sm",title:"",children:v.jsx(Es,{className:"w-4 h-4"})}),v.jsx("button",{onClick:()=>h(R),className:"p-2 rounded-[6px] bg-ios-rose/10 text-ios-rose hover:bg-ios-rose hover:text-white transition-all ios-tap shadow-sm",title:"",children:v.jsx(Ja,{className:"w-4 h-4"})}),v.jsx("button",{onClick:()=>{confirm(`${R.name}   ? (    )`)&&Q(R,"applied")},className:"p-2 rounded-[6px] bg-gray-100 text-ios-gray hover:bg-[#1C1C1E] hover:text-white transition-all ios-tap shadow-sm",title:" ",children:v.jsx(sO,{className:"w-4 h-4"})})]})})]},R.id))})]}),U.length===0&&v.jsxs("div",{className:"py-20 flex flex-col items-center justify-center text-ios-gray space-y-3",children:[v.jsx(Ns,{className:"w-10 h-10 opacity-20"}),v.jsx("p",{className:"text-xs font-black",children:"  ."})]})]}),T&&v.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-50 flex items-center justify-center p-6",children:v.jsx("div",{className:"bg-white rounded-ios w-full max-w-sm shadow-2xl animate-spring-up overflow-hidden",children:v.jsxs("div",{className:"p-6 space-y-6",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("h4",{className:"text-[14px] font-black text-[#1C1C1E]",children:"  "}),v.jsx("p",{className:"text-[10px] text-ios-gray font-black uppercase tracking-widest",children:"Select Grade for Bulk Printing"})]}),v.jsx("div",{className:"grid grid-cols-3 gap-3",children:["1","2","3"].map(R=>v.jsxs("button",{onClick:()=>{L(k=>k.includes(R)?k.filter(P=>P!==R):[...k,R].sort())},className:`py-4 rounded-xl text-sm font-black transition-all ios-tap ${j.includes(R)?"bg-ios-indigo text-white shadow-lg shadow-ios-indigo/20":"bg-gray-50 text-ios-gray hover:bg-gray-100"}`,children:[R,""]},R))}),v.jsxs("div",{className:"bg-ios-amber/5 border border-ios-amber/10 rounded-xl p-4 space-y-2",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(Ns,{className:"w-3.5 h-3.5 text-ios-amber"}),v.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:"  "})]}),v.jsxs("p",{className:"text-[10px] text-ios-gray font-bold leading-relaxed",children:["  ",v.jsx("span",{className:"text-ios-indigo",children:""}),"   . ",v.jsx("br",{}),"      ."]})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-2",children:[v.jsx("button",{onClick:()=>O(!1),className:"w-full py-4 bg-gray-100 text-ios-gray rounded-xl text-xs font-black ios-tap",children:""}),v.jsx("button",{onClick:N,className:"w-full py-4 bg-ios-indigo text-white rounded-xl text-xs font-black shadow-lg shadow-ios-indigo/20 ios-tap",children:" "})]})]})})}),f&&v.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-50 flex items-center justify-center p-6",children:v.jsx("div",{className:"bg-white rounded-ios w-full max-w-sm shadow-2xl animate-spring-up overflow-hidden",children:v.jsxs("div",{className:"p-6 space-y-4",children:[v.jsxs("h4",{className:"text-[14px] font-black text-[#1C1C1E]",children:[f.name,"   "]}),v.jsx("textarea",{value:a,onChange:R=>c(R.target.value),placeholder:"  ... (:   )",className:"w-full h-32 bg-gray-50 border border-gray-200 rounded-[6px] p-3 text-xs font-bold focus:ring-1 focus:ring-ios-rose transition-all resize-none"}),v.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[v.jsx("button",{onClick:()=>h(null),className:"w-full py-3 bg-gray-100 text-ios-gray rounded-[6px] text-xs font-black ios-tap",children:""}),v.jsx("button",{onClick:()=>Q(f,"rejected",a),className:"w-full py-3 bg-[#1C1C1E] text-white rounded-[6px] text-xs font-black shadow-lg shadow-black/20 ios-tap",children:" "})]})]})})}),v.jsx("div",{className:"px-6 py-3 bg-gray-50/50 border-t border-gray-50 flex items-center justify-between shrink-0",children:v.jsxs("div",{className:"flex gap-6",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-ios-indigo"}),v.jsxs("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:[": ",e.length,""]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-ios-amber"}),v.jsxs("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:[": ",e.filter(R=>R.status==="pending").length,""]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-ios-emerald"}),v.jsxs("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:[": ",e.filter(R=>R.status==="approved").length,""]})]})]})}),g&&b.length>0&&hg.createPortal(v.jsxs("div",{id:"print-root-bulk",className:"bg-white text-black hidden print:block",children:[v.jsx("style",{children:`
                        @media print {
                            @page { 
                                size: A4 portrait; 
                                margin: 0; 
                            }
                            body { 
                                margin: 0 !important; 
                                padding: 0 !important; 
                                background: white !important;
                                -webkit-print-color-adjust: exact !important;
                                print-color-adjust: exact !important;
                            }
                            /* Hide app UI during printing */
                            body > #root { 
                                display: none !important; 
                            }
                            #print-root-bulk { display: block !important; }
                            .print-page {
                                width: 210mm !important;
                                min-height: 297mm !important;
                                margin: 0 auto !important;
                                padding: 0 !important;
                                box-sizing: border-box !important;
                                background: white !important;
                                page-break-after: always !important;
                                position: relative !important;
                                display: flex !important;
                                justify-content: center !important;
                                overflow: hidden !important;
                            }
                            .print-page:last-child { page-break-after: auto !important; }
                            .pledge-doc {
                                width: 180mm !important;
                                height: 260mm !important;
                                margin-top: 20mm !important;
                                margin-bottom: 10mm !important;
                                display: flex !important;
                                flex-direction: column !important;
                                justify-content: space-between !important;
                                font-family: 'Pretendard', 'Malgun Gothic', sans-serif !important;
                                color: #000 !important;
                            }
                            .pledge-header {
                                text-align: center !important;
                                margin-bottom: 25px !important;
                                border-bottom: 2px solid #000 !important;
                                padding-bottom: 10px !important;
                            }
                            .pledge-title {
                                font-size: 28pt !important;
                                font-weight: 900 !important;
                                letter-spacing: 10px !important;
                                margin: 0 !important;
                            }
                            .intro-text {
                                text-align: center !important;
                                font-weight: 700 !important;
                                margin-bottom: 25px !important;
                                line-height: 1.8 !important;
                                font-size: 11pt !important;
                                color: #000 !important;
                            }
                            .content-flex {
                                display: flex !important;
                                flex-wrap: wrap !important;
                                justify-content: space-between !important;
                                gap: 20px 0 !important;
                                width: 100% !important;
                            }
                            .pledge-section {
                                width: 48% !important;
                            }
                            .section-title {
                                font-size: 10pt !important;
                                font-weight: 900 !important;
                                margin-bottom: 6px !important;
                                color: #000 !important;
                                border-bottom: 1px solid #ddd !important;
                                display: inline-block !important;
                            }
                            .pledge-content {
                                font-size: 9pt !important;
                                text-align: justify !important;
                                color: #1a1a1a !important;
                                line-height: 1.5 !important;
                            }
                            .pledge-content p {
                                margin-bottom: 2px !important;
                            }
                            .info-grid {
                                display: flex !important;
                                justify-content: space-between !important;
                                margin: 30px 0 15px 0 !important;
                                border: 1.5px solid #000 !important;
                                padding: 12px 25px !important;
                                width: 100% !important;
                                box-sizing: border-box !important;
                            }
                            .info-item {
                                font-size: 11pt !important;
                                color: #000 !important;
                            }
                            .info-label {
                                font-weight: 900 !important;
                                margin-right: 8px !important;
                            }
                            .signature-block {
                                display: flex !important;
                                justify-content: space-around !important;
                                margin-top: 15px !important;
                                text-align: center !important;
                                width: 100% !important;
                            }
                            .sig-container {
                                display: flex !important;
                                flex-direction: column !important;
                                align-items: center !important;
                            }
                            .sig-pad {
                                width: 200px !important;
                                height: 80px !important;
                                border-bottom: 1.5px solid #000 !important;
                                margin-bottom: 8px !important;
                                display: flex !important;
                                align-items: center !important;
                                justify-content: center !important;
                            }
                            .sig-image {
                                max-width: 100% !important;
                                max-height: 100% !important;
                                object-fit: contain !important;
                            }
                            .sig-label {
                                font-size: 11pt !important;
                                font-weight: 800 !important;
                                color: #000 !important;
                            }
                            .footer-date {
                                text-align: center !important;
                                margin-top: 20px !important;
                                font-size: 14pt !important;
                                font-weight: 700 !important;
                                color: #000 !important;
                            }
                            .footer-school {
                                text-align: center !important;
                                margin-bottom: 0 !important;
                                font-size: 20pt !important;
                                font-weight: 900 !important;
                                color: #000 !important;
                            }
                        }
                    `}),b.map(R=>v.jsx("div",{className:"print-page",children:v.jsx(zk,{applicant:R,schoolInfo:W})},R.id))]}),document.body),p&&y&&hg.createPortal(v.jsxs("div",{id:"print-root",className:"bg-white text-black hidden print:block",children:[v.jsx("style",{children:`
                        @media print {
                            @page { 
                                size: A4 portrait; 
                                margin: 0; 
                            }
                            
                            body {
                                margin: 0 !important;
                                padding: 0 !important;
                                background: white !important;
                                -webkit-print-color-adjust: exact !important;
                                print-color-adjust: exact !important;
                            }

                            /* Hide everything except print-root */
                            body > #root {
                                display: none !important;
                            }

                            #print-root {
                                display: flex !important;
                                justify-content: center !important;
                                width: 210mm !important;
                                min-height: 297mm !important;
                                margin: 0 auto !important;
                                padding: 0 !important;
                                box-sizing: border-box !important;
                                background: white !important;
                                position: relative !important;
                                overflow: hidden !important;
                            }

                            .pledge-doc {
                                width: 180mm !important;
                                height: 260mm !important;
                                margin-top: 20mm !important;
                                margin-bottom: 10mm !important;
                                box-sizing: border-box !important;
                                color: #000 !important;
                                display: flex !important;
                                flex-direction: column !important;
                                justify-content: space-between !important;
                                font-family: 'Pretendard', 'Malgun Gothic', sans-serif !important;
                            }

                            .pledge-header {
                                text-align: center !important;
                                margin-bottom: 25px !important;
                                border-bottom: 2px solid #000 !important;
                                padding-bottom: 10px !important;
                            }

                            .pledge-title {
                                font-size: 28pt !important;
                                font-weight: 900 !important;
                                letter-spacing: 10px !important;
                                margin: 0 !important;
                            }

                            .intro-text {
                                text-align: center !important;
                                font-weight: 700 !important;
                                margin-bottom: 25px !important;
                                line-height: 1.8 !important;
                                font-size: 11pt !important;
                            }

                            .content-flex {
                                display: flex !important;
                                flex-wrap: wrap !important;
                                justify-content: space-between !important;
                                gap: 20px 0 !important;
                                width: 100% !important;
                            }

                            .pledge-section {
                                width: 48% !important;
                            }

                            .section-title {
                                font-size: 10pt !important;
                                font-weight: 900 !important;
                                margin-bottom: 6px !important;
                                color: #000 !important;
                                border-bottom: 1px solid #ddd !important;
                                display: inline-block !important;
                            }

                            .pledge-content {
                                font-size: 9pt !important;
                                text-align: justify !important;
                                color: #1a1a1a !important;
                                line-height: 1.5 !important;
                            }

                            .pledge-content p {
                                margin-bottom: 2px !important;
                            }

                            .info-grid {
                                display: flex !important;
                                justify-content: space-between !important;
                                margin: 30px 0 15px 0 !important;
                                border: 1.5px solid #000 !important;
                                padding: 12px 25px !important;
                                width: 100% !important;
                                box-sizing: border-box !important;
                            }

                            .info-item {
                                font-size: 11pt !important;
                            }

                            .info-label {
                                font-weight: 900 !important;
                                margin-right: 8px !important;
                            }

                            .signature-block {
                                display: flex !important;
                                justify-content: space-around !important;
                                margin-top: 15px !important;
                                text-align: center !important;
                                width: 100% !important;
                            }

                            .sig-container {
                                display: flex !important;
                                flex-direction: column !important;
                                align-items: center !important;
                            }

                            .sig-pad {
                                width: 200px !important;
                                height: 80px !important;
                                border-bottom: 1.5px solid #000 !important;
                                margin-bottom: 8px !important;
                                display: flex !important;
                                align-items: center !important;
                                justify-content: center !important;
                            }

                            .sig-image {
                                max-width: 100% !important;
                                max-height: 100% !important;
                                object-fit: contain !important;
                            }

                            .sig-label {
                                font-size: 11pt !important;
                                font-weight: 800 !important;
                            }

                            .footer-date {
                                text-align: center !important;
                                margin-top: 20px !important;
                                font-size: 14pt !important;
                                font-weight: 700 !important;
                            }

                            .footer-school {
                                text-align: center !important;
                                margin-bottom: 0 !important;
                                font-size: 20pt !important;
                                font-weight: 900 !important;
                            }
                        }
                        #print-root { display: none; }
                    `}),v.jsx("div",{id:"print-root",children:v.jsx(zk,{applicant:y,schoolInfo:W})})]}),document.body)]})},Wk=xe.forwardRef(({penColor:e="#1C1C1E"},t)=>{const r=xe.useRef(null),[n,i]=xe.useState(!1),[s,l]=xe.useState(null);xe.useEffect(()=>{const f=r.current;if(!f)return;const h=f.getContext("2d"),d=window.devicePixelRatio||1,u=f.getBoundingClientRect();f.width=u.width*d,f.height=u.height*d,h.scale(d,d),h.strokeStyle=e,h.lineWidth=10,h.lineCap="round"},[e]),xe.useImperativeHandle(t,()=>({clear:()=>{const f=r.current;f.getContext("2d").clearRect(0,0,f.width,f.height)},getCanvas:()=>r.current,isEmpty:()=>{const f=r.current,h=f.getContext("2d");return!new Uint32Array(h.getImageData(0,0,f.width,f.height).data.buffer).some(u=>u!==0)}}));const o=f=>{const d=r.current.getBoundingClientRect(),u=f.touches?f.touches[0].clientX:f.clientX,p=f.touches?f.touches[0].clientY:f.clientY;return{x:u-d.left,y:p-d.top}},a=f=>{i(!0);const{x:h,y:d}=o(f),u=r.current.getContext("2d");u.strokeStyle=e,u.lineWidth=10,u.lineCap="round",u.beginPath(),u.moveTo(h,d)},c=f=>{const h=o(f);if(f.touches||l(h),!n)return;const d=r.current.getContext("2d");d.lineTo(h.x,h.y),d.stroke()};return v.jsxs("div",{className:"w-full h-full relative cursor-none group",onMouseEnter:()=>!n&&l(null),onMouseLeave:()=>l(null),children:[v.jsx("canvas",{ref:r,onMouseDown:a,onMouseMove:c,onMouseUp:()=>i(!1),onTouchStart:a,onTouchMove:c,onTouchEnd:()=>i(!1),className:"w-full h-full touch-none"}),s&&v.jsx("div",{className:"absolute pointer-events-none rounded-full border border-white/50 shadow-sm",style:{left:s.x,top:s.y,width:"10px",height:"10px",backgroundColor:e,transform:"translate(-50%, -50%)"}})]})}),nY=({onLoginSuccess:e})=>{const[t,r]=xe.useState("student"),[n,i]=xe.useState("login"),[s,l]=xe.useState({name:"",studentId:"",phone:"",password:"",pledgeAccepted:!1,privacyAccepted:!1}),[o,a]=xe.useState(!1),[c,f]=xe.useState(""),[h,d]=xe.useState(""),[u,p]=xe.useState(null),m=cf.useRef(null),g=cf.useRef(null),[x,y]=xe.useState(()=>sessionStorage.getItem("schoolName")||"GOE");xe.useEffect(()=>{(async()=>{const{data:M}=await He.from("configs").select("value").eq("key","school_info").single();M!=null&&M.value&&(y(M.value.name_en||"GOE"),sessionStorage.setItem("schoolInfo",JSON.stringify(M.value)))})()},[]);const w=()=>f(""),b=F=>F.replace(/[^0-9]/g,"").replace(/^(\d{0,3})(\d{0,4})(\d{0,4})$/g,"$1-$2-$3").replace(/(-{1,2})$/g,""),S=F=>{r(F),i("login"),l({...s,name:"",studentId:"",phone:"",password:""}),w()},T=async F=>{F.preventDefault(),a(!0),f(""),t==="teacher"?await O():await j(),a(!1)},O=async()=>{const F=`${s.name}@goe.edu`,{data:M,error:V}=await He.auth.signInWithPassword({email:F,password:s.password});if(V){f("    .");return}const{data:G}=await He.from("profiles").select("*").eq("id",M.user.id).single();G?e({...G,full_name:G.full_name||s.name}):f("    .")},j=async()=>{const F=(s.name||"").normalize("NFC").trim(),M=(s.studentId||"").trim(),{data:V,error:G}=await He.from("applicant_pool").select("*").eq("student_id",M);if(G){f("    .     .");return}if(!V||V.length===0){f("  .");return}let te=V.find(Q=>{const K=(Q.name||"").normalize("NFC").replace(/\s+/g,""),N=F.replace(/\s+/g,"");return K===N});if(!te){f("    . (  )");return}p(te);const ee=te;if(t==="parent"&&(!ee.phone_number||!ee.pledge_accepted)){f("     .");return}ee.status==="applied"?(l(Q=>({...Q,phone:"",pledgeAccepted:!1,privacyAccepted:!1})),i("pledge")):ee.status==="pending"?i("pending"):ee.status==="rejected"?(d(ee.rejection_reason||"  ,   ."),i("rejected")):ee.status==="approved"&&i("challenge")},L=async F=>{var M,V;if(F.preventDefault(),!s.pledgeAccepted||!s.privacyAccepted){f("    .");return}if(s.phone.length<10){f("   .");return}if((M=m.current)!=null&&M.isEmpty()||(V=g.current)!=null&&V.isEmpty()){f("     .");return}a(!0),f("");try{const G=async(K,N)=>{const U=K.getCanvas();return new Promise((R,k)=>{U.toBlob(async P=>{if(!P){k(new Error("    ."));return}const A=`${u.student_id}_${Date.now()}.png`,{data:E,error:I}=await He.storage.from(N).upload(A,P,{contentType:"image/png",upsert:!0});if(I)k(I);else{const{data:{publicUrl:H}}=He.storage.from(N).getPublicUrl(A);R(H)}},"image/png")})},te=await G(m.current,"student-signatures"),ee=await G(g.current,"parent-signatures"),{error:Q}=await He.from("applicant_pool").update({phone_number:s.phone,pledge_accepted:!0,privacy_accepted:!0,student_signature:te,parent_signature:ee,pledged_at:new Date().toISOString(),status:"pending"}).eq("id",u.id);if(Q)throw Q;i("pending")}catch(G){f("    : "+(G.message||"   "))}finally{a(!1)}},W=async F=>{F.preventDefault(),s.phone===u.phone_number?e({...u,full_name:u.name,role:t}):f("     .")};return v.jsx("div",{className:"min-h-[100dvh] bg-[#F2F2F7] flex items-center justify-center p-6 font-sans",children:v.jsxs("div",{className:"w-full max-w-md bg-white rounded-[2rem] shadow-2xl shadow-ios-indigo/10 overflow-hidden animate-spring-up border border-gray-100",children:[v.jsxs("div",{className:"bg-white p-10 text-[#1C1C1E] relative overflow-hidden border-b border-gray-100",children:[v.jsxs("div",{className:"relative z-10 space-y-2",children:[v.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gray-50 flex items-center justify-center mb-6 border border-gray-100 shadow-sm overflow-hidden",children:v.jsx(hd,{className:"w-7 h-7 text-ios-indigo"})}),v.jsx("h1",{className:"text-3xl font-black tracking-tighter leading-none",children:x}),v.jsx("p",{className:"text-[10px] font-black tracking-[0.3em] uppercase text-ios-indigo",children:"Study Cafe System"})]}),v.jsx("div",{className:"absolute -right-10 -top-10 w-40 h-40 bg-ios-indigo/5 rounded-full blur-3xl"})]}),v.jsxs("div",{className:"p-8 space-y-8",children:[n==="login"&&v.jsx("div",{className:"flex bg-gray-50 p-1.5 rounded-2xl gap-1",children:[{id:"student",label:"",icon:O8},{id:"parent",label:"",icon:$d},{id:"teacher",label:"",icon:l8}].map(F=>v.jsxs("button",{onClick:()=>S(F.id),className:`flex-1 flex items-center justify-center gap-2 py-3 rounded-xl text-xs font-black transition-all ${t===F.id?"bg-white text-ios-indigo shadow-md":"text-ios-gray hover:text-[#1C1C1E]"}`,children:[v.jsx(F.icon,{className:`w-3.5 h-3.5 ${t===F.id?"text-ios-indigo":"text-ios-gray"}`}),F.label]},F.id))}),n==="login"&&v.jsxs("form",{onSubmit:T,className:"space-y-6",children:[v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"relative group",children:[v.jsx(gd,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),v.jsx("input",{required:!0,type:"text",placeholder:t==="teacher"?" (ID)":" (ID)",value:s.name,onChange:F=>l({...s,name:F.target.value}),autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false",className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none caret-ios-indigo"})]}),v.jsx("div",{className:"relative group",children:v.jsx("input",{required:!0,type:t==="teacher"?"password":"text",inputMode:t==="teacher"?"text":"numeric",pattern:t==="teacher"?void 0:"[0-9]*",placeholder:t==="teacher"?" (PW)":" 5 (PW)",maxLength:t==="teacher"?void 0:5,value:t==="teacher"?s.password:s.studentId,onChange:F=>{const M=F.target.value;l(t==="teacher"?{...s,password:M}:{...s,studentId:M.replace(/[^0-9]/g,"")})},autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false",className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none caret-ios-indigo"})})]}),c&&v.jsxs("div",{className:"flex items-center gap-2 text-ios-rose bg-ios-rose/5 p-4 rounded-xl animate-shake",children:[v.jsx(Ns,{className:"w-4 h-4 shrink-0"}),v.jsx("p",{className:"text-[11px] font-black",children:c})]}),v.jsx("button",{type:"submit",disabled:o,className:"w-full py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-sm flex items-center justify-center gap-2 hover:scale-[1.02] active:scale-[0.98] transition-all shadow-xl shadow-gray-200/50 ios-tap disabled:opacity-50",children:o?v.jsx(b1,{className:"w-4 h-4 animate-spin"}):v.jsxs(v.Fragment,{children:[" ",v.jsx(n8,{className:"w-4 h-4"})]})})]}),n==="pledge"&&v.jsxs("form",{onSubmit:L,className:"space-y-6 animate-spring-up",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight text-center",children:"  "}),v.jsx("p",{className:"text-[11px] text-ios-gray text-center font-bold",children:"         ,           ."})]}),v.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 max-h-48 overflow-y-auto space-y-4 text-[11px] font-bold text-ios-gray leading-relaxed border border-gray-100",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[    ]"}),v.jsx("p",{children:"1.     ,       ."}),v.jsx("p",{children:"2.        ."}),v.jsx("p",{children:"3.       , ,      ."}),v.jsx("p",{children:"4.      ,         ."}),v.jsx("p",{children:"5.       ,       ."})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[    ]"}),v.jsx("p",{children:"1.    ,        ."}),v.jsx("p",{children:"2.         ."}),v.jsx("p",{children:"3.          ."})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[   ]"}),v.jsx("p",{children:"1.             ."}),v.jsx("p",{children:"2.          ."})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[   ]"}),v.jsx("p",{children:"1.        ."}),v.jsx("p",{children:"2.         ,    ."}),v.jsx("p",{children:"3.   ,  ."})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[    ]"}),v.jsx("p",{children:"1.             ."}),v.jsx("p",{children:"2.          ."})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[  ]"}),v.jsx("p",{children:"1.            ."}),v.jsx("p",{children:"2.        ,        ."})]})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"relative group",children:[v.jsx(uv,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),v.jsx("input",{required:!0,type:"tel",autoComplete:"off",placeholder:"   ( )",value:s.phone,onChange:F=>l({...s,phone:b(F.target.value)}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none caret-ios-indigo"})]}),v.jsxs("label",{className:"flex items-start gap-3 p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100 transition-all border border-transparent hover:border-gray-200",children:[v.jsx("input",{type:"checkbox",checked:s.pledgeAccepted,onChange:F=>l({...s,pledgeAccepted:F.target.checked}),className:"mt-0.5"}),v.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:"      . ()"})]}),v.jsxs("label",{className:"flex items-start gap-3 p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100 transition-all border border-transparent hover:border-gray-200",children:[v.jsx("input",{type:"checkbox",checked:s.privacyAccepted,onChange:F=>l({...s,privacyAccepted:F.target.checked}),className:"mt-0.5"}),v.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:"    . ()"})]}),v.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-100",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:" "}),v.jsxs("button",{type:"button",onClick:()=>{var F;return(F=m.current)==null?void 0:F.clear()},className:"text-[10px] text-ios-gray font-bold flex items-center gap-1 hover:text-ios-rose transition-colors",children:[v.jsx(zb,{className:"w-3 h-3"})," "]})]}),v.jsx("div",{className:"bg-gray-50 rounded-2xl border border-gray-100 overflow-hidden h-32 relative",children:v.jsx(Wk,{ref:m,penColor:"#1C1C1E"})})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:" "}),v.jsxs("button",{type:"button",onClick:()=>{var F;return(F=g.current)==null?void 0:F.clear()},className:"text-[10px] text-ios-gray font-bold flex items-center gap-1 hover:text-ios-rose transition-colors",children:[v.jsx(zb,{className:"w-3 h-3"})," "]})]}),v.jsx("div",{className:"bg-gray-50 rounded-2xl border border-gray-100 overflow-hidden h-32 relative",children:v.jsx(Wk,{ref:g,penColor:"#1C1C1E"})}),v.jsx("p",{className:"text-[10px] text-ios-rose font-black text-center pt-1 animate-pulse",children:".     ."})]})]})]}),c&&v.jsx("div",{className:"text-ios-rose text-[11px] font-black text-center",children:c}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{type:"button",onClick:()=>i("login"),className:"flex-1 py-4 bg-gray-100 text-ios-gray rounded-2xl font-black text-sm ios-tap",children:""}),v.jsx("button",{type:"submit",disabled:o,className:"flex-[2] py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-sm shadow-xl shadow-gray-200/50 ios-tap",children:o?v.jsx(b1,{className:"w-4 h-4 animate-spin mx-auto"}):"   "})]})]}),n==="pending"&&v.jsxs("div",{className:"text-center space-y-6 py-4 animate-spring-up",children:[v.jsx("div",{className:"w-20 h-20 rounded-[2rem] bg-ios-amber/10 flex items-center justify-center mx-auto mb-2 border border-ios-amber/20 shadow-inner",children:v.jsx(b1,{className:"w-10 h-10 text-ios-amber animate-spin"})}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:"  "}),v.jsx("p",{className:"text-xs text-ios-gray font-medium leading-relaxed px-4",children:"   .      ."})]}),v.jsx("button",{onClick:()=>i("login"),className:"text-xs font-black text-ios-indigo uppercase tracking-widest",children:""})]}),n==="rejected"&&v.jsxs("div",{className:"text-center space-y-6 py-4 animate-spring-up",children:[v.jsx("div",{className:"w-20 h-20 rounded-[2rem] bg-ios-rose/10 flex items-center justify-center mx-auto mb-2 border border-ios-rose/20 shadow-inner",children:v.jsx(Ns,{className:"w-10 h-10 text-ios-rose"})}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:" "}),v.jsxs("div",{className:"bg-ios-rose/5 p-4 rounded-xl mt-4 max-w-[280px] mx-auto text-left",children:[v.jsx("p",{className:"text-[9px] font-black text-ios-rose/70 uppercase mb-1 tracking-widest",children:""}),v.jsx("p",{className:"text-[11px] font-bold text-ios-rose leading-relaxed",children:h})]})]}),v.jsx("button",{onClick:()=>i("login"),className:"w-full py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-xs shadow-xl shadow-gray-200/50 ios-tap uppercase tracking-widest",children:" "})]}),n==="challenge"&&v.jsxs("form",{onSubmit:W,className:"space-y-6 animate-spring-up",children:[v.jsxs("div",{className:"text-center space-y-4",children:[v.jsx("div",{className:"w-20 h-20 rounded-[2rem] bg-ios-emerald/10 flex items-center justify-center mx-auto border border-ios-emerald/20 shadow-inner",children:v.jsx(pd,{className:"w-10 h-10 text-ios-emerald"})}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:t==="parent"?" ":" "}),v.jsx("p",{className:"text-[11px] text-ios-gray font-bold",children:t==="parent"?"   .":"   ."})]})]}),v.jsxs("div",{className:"relative group",children:[v.jsx(uv,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),v.jsx("input",{required:!0,type:"tel",placeholder:t==="parent"?"  ":"  ",value:s.phone,onChange:F=>l({...s,phone:b(F.target.value)}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none caret-ios-indigo"})]}),c&&v.jsx("div",{className:"text-ios-rose text-[11px] font-black text-center animate-shake",children:c}),v.jsx("button",{type:"submit",className:"w-full py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-sm shadow-xl shadow-gray-200/50 ios-tap",children:t==="parent"?"  ":"  "})]})]})]})})},iY=({onLogout:e,currentUser:t})=>{const[r,n]=xe.useState("home"),[i,s]=xe.useState(""),[l,o]=xe.useState({bookings:[],attendance:[],currentSession:null,nextSession:null}),[a,c]=xe.useState({}),[f,h]=xe.useState(new Date),[d,u]=xe.useState(null),[p,m]=xe.useState({present:0,late:0,absent:0,earlyLeave:0,history:[]}),[g,x]=xe.useState(null),[y,w]=xe.useState(!0),[b,S]=xe.useState([]),T=()=>h(G=>DT(G)),O=()=>h(G=>gm(G,1)),j=(G,te)=>{var H,J;if(!te||!te.bookings.length)return null;const ee=new Date,Q=rt(ee,"yyyy-MM-dd"),{bookings:K,attendance:N}=te;if(G>Q)return{label:"",color:"text-ios-indigo bg-ios-indigo/10"};if(G<Q)return N.length?N.some(fe=>fe.status==="early_leave")?{label:"",color:"text-ios-blue bg-ios-blue/10"}:N.some(fe=>fe.status==="late")?{label:"",color:"text-ios-amber bg-ios-amber/10"}:{label:"",color:"text-ios-emerald bg-ios-emerald/10"}:{label:"",color:"text-ios-rose bg-ios-rose/10"};const U=rt(ee,"HH:mm:ss"),R=[...K].sort((Y,Z)=>{var fe,X;return(((fe=Y.sessions)==null?void 0:fe.start_time)||"").localeCompare(((X=Z.sessions)==null?void 0:X.start_time)||"")});if(!R.length)return null;const k=(H=R[0].sessions)==null?void 0:H.start_time,P=(J=R[R.length-1].sessions)==null?void 0:J.end_time,A=K.some(Y=>{var Z;return(((Z=Y.sessions)==null?void 0:Z.start_time)||"")>="17:00:00"}),E=U>="09:00:00"&&U<="17:00:00",I=R.find(Y=>{const Z=Y.sessions;return Z&&U>=Z.start_time&&U<=Z.end_time});return I?N.find(Z=>Z.booking_id===I.id)?{label:"",color:"text-white bg-ios-emerald"}:{label:"",color:"text-ios-rose bg-ios-rose/10"}:E&&A?{label:"",color:"text-gray-400 bg-gray-100"}:P&&U>P?{label:"",color:"text-gray-500 bg-gray-100"}:k&&U<k?{label:"",color:"text-ios-indigo bg-ios-indigo/10"}:{label:"",color:"text-ios-amber bg-ios-amber/10"}},L=()=>{const{bookings:G,attendance:te,currentSession:ee}=l;if(G.length===0)return{label:"  ",color:"bg-gray-100 text-gray-400",sub:"   ."};const Q=G.find(N=>N.session_id===(ee==null?void 0:ee.id)),K=te.length>0;if(Q)return te.find(U=>U.booking_id===Q.id)?{label:" ",color:"bg-ios-emerald text-white",sub:`${Q.sessions.name}  `}:{label:"",color:"bg-ios-rose text-white",sub:"    ."};if(K){const N=te.filter(Boolean).sort((U,R)=>(R.timestamp_in||"").localeCompare(U.timestamp_in||""))[0];if(N&&N.timestamp_out)return{label:" ",color:"bg-gray-800 text-white",sub:`${rt(new Date(N.timestamp_out),"HH:mm")}  `};if(N)return{label:" ",color:"bg-ios-amber text-white",sub:"    ."}}return{label:" ",color:"bg-ios-indigo text-white",sub:"   ."}},W=()=>{var ee,Q;const{bookings:G}=l;if(G.length===0)return"-";const te=[...G].sort((K,N)=>{var U,R;return(((U=K.sessions)==null?void 0:U.end_time)||"").localeCompare(((R=N.sessions)==null?void 0:R.end_time)||"")}).pop();return((Q=(ee=te==null?void 0:te.sessions)==null?void 0:ee.end_time)==null?void 0:Q.substring(0,5))||"-"};xe.useEffect(()=>{const G=async()=>{if(!t)return;const Q=rt(new Date,"yyyy-MM-dd"),{data:K}=await He.from("bookings").select("*, sessions (*), attendance (*)").or(`student_id.eq.${t.id},user_id.eq.${t.id}`).eq("date",Q).order("session_id",{ascending:!0}),N=Bn(f,{weekStartsOn:1}),U=jo(f,{weekStartsOn:1}),{data:R}=await He.from("bookings").select(`
          *,
          sessions (id, name, start_time, end_time),
          seats (id, seat_number, zone_name, zone_id, zones(name)),
          attendance (id, booking_id, status, timestamp_in, timestamp_out)
        `).or(`student_id.eq.${t.id},user_id.eq.${t.id}`).gte("date",rt(N,"yyyy-MM-dd")).lte("date",rt(U,"yyyy-MM-dd"));if(R){const A={};R.forEach(E=>{const I=E.date;A[I]||(A[I]={bookings:[],attendance:[]}),A[I].bookings.push(E),E.attendance&&E.attendance.length>0&&A[I].attendance.push(...E.attendance)}),c(A)}const{data:k}=await He.from("operation_exceptions").select("*").gte("exception_date",rt(N,"yyyy-MM-dd")).lte("exception_date",rt(U,"yyyy-MM-dd"));S(k||[]);const{data:P}=await He.from("sessions").select("*").order("start_time");if(P){const E=rt(new Date,"HH:mm:ss"),I=P.find(J=>E>=J.start_time&&E<=J.end_time),H=P.find(J=>J.start_time>E);o({bookings:K||[],attendance:(K==null?void 0:K.flatMap(J=>J.attendance).filter(Boolean))||[],currentSession:I,nextSession:H})}if(r==="stats"||y){const{data:A}=await He.from("operation_quarters").select("*").order("academic_year",{ascending:!0}).order("quarter",{ascending:!0}),E=rt(new Date,"yyyy-MM-dd");let I=null,H=rt(Lk(new Date),"yyyy-MM-dd"),J=rt(Ik(new Date),"yyyy-MM-dd");if(A&&A.length>0){if(I=A.find(re=>E>=re.start_date&&E<=re.end_date),!I){const re=new Date;I=A.reduce((se,z)=>{const oe=Math.abs(new Date(se.start_date)-re);return Math.abs(new Date(z.start_date)-re)<oe?z:se})}I&&(H=I.start_date,J=I.end_date,x(I))}const[Y,Z]=await Promise.all([He.from("bookings").select("id, date, session_id, attendance (status, timestamp_in), sessions (name)").or(`student_id.eq.${t.id},user_id.eq.${t.id}`).gte("date",H).lte("date",J).order("date",{ascending:!1}),He.from("study_plans").select("date, session_id, content").or(`student_id.eq.${t.id},user_id.eq.${t.id}`).gte("date",H).lte("date",J)]),fe=Y.data,X=Z.data;if(fe){const re={present:0,late:0,absent:0,earlyLeave:0},se=[],z={};fe.forEach(oe=>{var Te,pe;z[oe.date]||(z[oe.date]=[]),z[oe.date].push(oe);const ce=(Te=oe.attendance)==null?void 0:Te[0],we=rt(new Date,"yyyy-MM-dd"),ye=oe.date<we,de=(ce==null?void 0:ce.status)||(ye?"absent":null);if(de){const Ae=X==null?void 0:X.find(Ie=>Ie.date===oe.date&&Ie.session_id===oe.session_id);se.push({date:oe.date,status:de,time:ce!=null&&ce.timestamp_in?rt(new Date(ce.timestamp_in),"HH:mm"):"-",content:(Ae==null?void 0:Ae.content)||null,session_name:(pe=oe.sessions)==null?void 0:pe.name})}}),Object.keys(z).forEach(oe=>{const ce=rt(new Date,"yyyy-MM-dd");if(oe>ce)return;const we=z[oe],ye=we.filter(de=>de.attendance&&de.attendance.length>0);we.forEach(de=>{var Te,pe;((pe=(Te=de.attendance)==null?void 0:Te[0])==null?void 0:pe.status)==="late"&&re.late++}),ye.length===0?oe<ce&&re.absent++:ye.some(Te=>Te.attendance[0].status==="early_leave")?re.earlyLeave++:ye.length===we.length&&re.present++}),m({...re,history:se.sort((oe,ce)=>ce.date.localeCompare(oe.date)).slice(0,15)})}}w(!1)},te=async()=>{var K;const{data:Q}=await He.from("configs").select("value").eq("key","school_info").single();(K=Q==null?void 0:Q.value)!=null&&K.name_en&&s(Q.value.name_en)};G(),te();const ee=setInterval(G,6e4);return()=>clearInterval(ee)},[t,f,r,y]);const F=()=>{var Q,K;const G=L(),te=W(),ee=(Q=l.attendance.find(N=>N.timestamp_out))==null?void 0:Q.timestamp_out;return v.jsxs("div",{className:"h-full p-4 flex flex-col gap-2 animate-fade-in relative scrollbar-hide",children:[v.jsxs("div",{className:"flex-[2] glass-card pt-8 pb-5 px-5 flex flex-col items-center text-center relative overflow-hidden",children:[v.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-ios-indigo/10 blur-3xl -z-10"}),v.jsx("div",{className:`px-6 py-2 rounded-full text-[13px] font-black uppercase tracking-widest ${G.color} shadow-lg shadow-current/10`,children:G.label}),v.jsx("div",{className:"flex-1 flex flex-col items-center justify-center space-y-3",children:v.jsx("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:t==null?void 0:t.full_name})}),v.jsxs("div",{className:"w-full grid grid-cols-3 gap-2 pt-4 border-t border-gray-50",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("p",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest",children:" "}),v.jsx("p",{className:"text-[11px] font-black text-[#1C1C1E]",children:((K=l.bookings[0])==null?void 0:K.seat_number)||"-"})]}),v.jsxs("div",{className:"space-y-1 border-l border-gray-50",children:[v.jsx("p",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest",children:" "}),v.jsx("p",{className:"text-[11px] font-black text-[#1C1C1E] underline decoration-ios-indigo/30 underline-offset-4",children:te})]}),v.jsxs("div",{className:"space-y-1 border-l border-gray-50",children:[v.jsx("p",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest",children:" "}),v.jsx("p",{className:"text-[11px] font-black text-ios-indigo",children:ee?rt(new Date(ee),"HH:mm"):"--:--"})]})]})]}),v.jsxs("div",{className:"flex-1 glass-card p-5 flex flex-col justify-center space-y-2",children:[v.jsxs("div",{className:"flex items-center justify-between mb-1",children:[v.jsx("h3",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest",children:"  "}),v.jsxs("div",{className:"flex items-center gap-1",children:[v.jsx("div",{className:"w-1 h-1 rounded-full bg-ios-emerald shadow-[0_0_8px_rgba(52,199,89,0.5)]"}),v.jsx("span",{className:"text-[11px] font-black text-ios-emerald uppercase",children:"Live"})]})]}),v.jsx("div",{className:"space-y-2 overflow-y-auto max-h-[120px] pr-1 scrollbar-hide",children:l.bookings.length>0?l.bookings.map((N,U)=>{var P,A,E,I;const R=(P=N.attendance)==null?void 0:P[0],k=R?R.status==="present"?{label:"",color:"text-ios-emerald bg-ios-emerald/10"}:R.status==="late"?{label:"",color:"text-ios-amber bg-ios-amber/10"}:R.status==="early_leave"?{label:"",color:"text-ios-blue bg-ios-blue/10"}:{label:"",color:"text-ios-rose bg-ios-rose/10"}:{label:"",color:"text-gray-400 bg-gray-50"};return v.jsxs("div",{className:`flex items-center justify-between py-2 ${U!==l.bookings.length-1?"border-b border-gray-50":""}`,children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${(R==null?void 0:R.status)==="present"?"bg-ios-emerald":(R==null?void 0:R.status)==="late"?"bg-ios-amber":(R==null?void 0:R.status)==="early_leave"?"bg-ios-blue":"bg-gray-200"}`}),v.jsxs("div",{children:[v.jsx("p",{className:"text-[11px] font-black text-[#1C1C1E] leading-none mb-1",children:(A=N.sessions)==null?void 0:A.name}),v.jsxs("p",{className:"text-[11px] font-bold text-ios-gray leading-none",children:[(E=N.sessions)==null?void 0:E.start_time.substring(0,5)," - ",(I=N.sessions)==null?void 0:I.end_time.substring(0,5)]})]})]}),v.jsx("span",{className:`text-[11px] font-black px-2 py-0.5 rounded-full ${k.color}`,children:k.label})]},N.id)}):v.jsx("div",{className:"flex flex-col items-center justify-center py-4 bg-gray-50 rounded-2xl",children:v.jsx("p",{className:"text-[11px] font-black text-ios-gray",children:"   ."})})})]}),v.jsxs("div",{className:"flex-1 glass-card p-5 flex flex-col justify-center items-center",children:[v.jsxs("div",{className:"w-full flex items-center justify-between mb-3 px-1",children:[v.jsx("h3",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest",children:"   "}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:[rt(Bn(f,{weekStartsOn:1}),"yyyy.MM.dd",{locale:fn})," - ",rt(jo(f,{weekStartsOn:1}),"yyyy.MM.dd",{locale:fn})]}),v.jsx("button",{onClick:T,className:"p-1 hover:text-black text-gray-400 ios-tap",children:v.jsx(Mo,{className:"w-3 h-3"})}),v.jsx("button",{onClick:O,className:"p-1 hover:text-black text-gray-400 ios-tap",children:v.jsx(Ts,{className:"w-3 h-3"})})]})]}),v.jsx("div",{className:"flex justify-between items-center w-full",children:eu({start:Bn(f,{weekStartsOn:1}),end:jo(f,{weekStartsOn:1})}).map((N,U)=>{const R=rt(N,"yyyy-MM-dd"),k=a[R],P=j(R,k),A=Ol(N,new Date);let E=A?P?"bg-ios-indigo text-white shadow-md":"bg-white/50 border border-white/40 text-[#1C1C1E]":"bg-white/50 border border-white/40 text-gray-300";(P==null?void 0:P.label)===""||(P==null?void 0:P.label)===""||(P==null?void 0:P.label)===""?E="bg-ios-emerald text-white shadow-sm border-none":(P==null?void 0:P.label)===""?E="bg-ios-amber text-white shadow-sm border-none":(P==null?void 0:P.label)===""?E="bg-ios-blue text-white shadow-sm border-none":(P==null?void 0:P.label)===""||(P==null?void 0:P.label)===""?E="bg-ios-rose text-white shadow-sm border-none":(P==null?void 0:P.label)===""&&(E="bg-ios-indigo text-white shadow-sm border-none");const I=U===5||U===6,H=b.some(Y=>Y.date===R);let J="text-gray-300";return A?J="text-ios-indigo":H||I?J="text-ios-rose/40":k&&k.bookings.length>0&&(J="text-ios-indigo"),v.jsxs("div",{className:`flex flex-col items-center gap-4 ${k?"cursor-pointer":""}`,onClick:()=>k&&u(N),children:[v.jsx("span",{className:`text-[11px] font-black ${J}`,children:["","","","","","",""][U]}),v.jsx("div",{className:`w-7 h-7 rounded-ios flex items-center justify-center text-[11px] font-black transition-all ${E}`,children:rt(N,"d")}),v.jsx("div",{className:"h-3 flex items-center justify-center",children:P?v.jsx("span",{className:`text-[11px] font-bold px-1 py-0.5 rounded-full whitespace-nowrap ${P.color}`,children:P.label}):A?v.jsx("span",{className:"text-[11px] font-black text-ios-indigo",children:""}):v.jsx("div",{className:"w-1 h-1 rounded-full bg-transparent"})})]},U)})})]})]})},M=()=>v.jsxs("div",{className:"p-5 space-y-6 animate-fade-in scrollbar-hide",children:[v.jsxs("div",{className:"glass-card p-8 relative overflow-hidden",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-2 text-ios-indigo",children:[v.jsx(Ub,{className:"w-4 h-4"}),v.jsx("h3",{className:"text-xs font-black uppercase tracking-widest",children:"   "})]}),v.jsx("p",{className:"text-[11px] font-bold text-ios-gray mb-6 pl-6",children:g?`${g.quarter}: ${rt(new Date(g.start_date),"yyyy-MM-dd(EEE)",{locale:fn})} ~ ${rt(new Date(g.end_date),"yyyy-MM-dd(EEE)",{locale:fn})}`:`${Math.ceil((new Date().getMonth()+1)/3)}: ${rt(Lk(new Date),"yyyy-MM-dd(EEE)",{locale:fn})} ~ ${rt(Ik(new Date),"yyyy-MM-dd(EEE)",{locale:fn})}`}),v.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[v.jsxs("div",{className:"flex flex-col items-center p-4 bg-ios-emerald/5 rounded-apple",children:[v.jsx("span",{className:"text-[10px] font-black text-ios-emerald uppercase opacity-60 mb-1",children:""}),v.jsxs("div",{className:"flex items-baseline gap-1",children:[v.jsx("span",{className:"text-2xl font-black text-ios-emerald",children:p.present}),v.jsx("span",{className:"text-xs font-bold text-ios-emerald/70",children:""})]})]}),v.jsxs("div",{className:"flex flex-col items-center p-4 bg-ios-rose/5 rounded-apple",children:[v.jsx("span",{className:"text-[10px] font-black text-ios-rose uppercase opacity-60 mb-1",children:""}),v.jsxs("div",{className:"flex items-baseline gap-1",children:[v.jsx("span",{className:"text-2xl font-black text-ios-rose",children:p.absent}),v.jsx("span",{className:"text-xs font-bold text-ios-rose/70",children:""})]})]}),v.jsxs("div",{className:"flex flex-col items-center p-4 bg-ios-amber/5 rounded-apple",children:[v.jsx("span",{className:"text-[10px] font-black text-ios-amber uppercase opacity-60 mb-1",children:""}),v.jsxs("div",{className:"flex items-baseline gap-1",children:[v.jsx("span",{className:"text-2xl font-black text-ios-amber",children:p.late}),v.jsx("span",{className:"text-xs font-bold text-ios-amber/70",children:""})]})]}),v.jsxs("div",{className:"flex flex-col items-center p-4 bg-ios-blue/5 rounded-apple",children:[v.jsx("span",{className:"text-[10px] font-black text-ios-blue uppercase opacity-60 mb-1",children:""}),v.jsxs("div",{className:"flex items-baseline gap-1",children:[v.jsx("span",{className:"text-2xl font-black text-ios-blue",children:p.earlyLeave}),v.jsx("span",{className:"text-xs font-bold text-ios-blue/70",children:""})]})]})]})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-center justify-between px-2",children:[v.jsx("h3",{className:"text-xs font-black text-[#1C1C1E] uppercase tracking-widest",children:"  "}),v.jsx("span",{className:"text-[10px] font-bold text-ios-gray",children:" 15"})]}),v.jsx("div",{className:"space-y-3",children:p.history.length>0?p.history.map((G,te)=>v.jsxs("div",{className:"bg-white p-4 rounded-apple border border-gray-100 shadow-sm space-y-3 transition-all active:scale-[0.98]",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:`w-2 h-2 rounded-full ${G.status==="present"?"bg-ios-emerald":G.status==="late"?"bg-ios-amber":G.status==="early_leave"?"bg-ios-blue":"bg-ios-rose"}`}),v.jsxs("div",{className:"space-y-0.5",children:[v.jsxs("p",{className:"text-xs font-black text-[#1C1C1E]",children:[rt(new Date(G.date),"M d (EEE)",{locale:fn}),G.session_name&&v.jsxs("span",{className:"text-[10px] text-ios-gray font-bold ml-1.5",children:[" ",G.session_name]})]}),v.jsx("p",{className:"text-[10px] font-bold text-ios-gray uppercase tracking-widest leading-none",children:G.status==="present"?" ":G.status==="late"?"":G.status==="early_leave"?"":""})]})]}),v.jsxs("div",{className:"text-right",children:[v.jsx("p",{className:"text-xs font-black text-ios-gray",children:G.time!=="-"?G.time:"--:--"}),v.jsx("p",{className:"text-[9px] font-bold text-ios-gray/40 uppercase tracking-tighter leading-none",children:"Entry Time"})]})]}),G.content&&v.jsxs("div",{className:"pt-3 border-t border-gray-50 flex gap-3",children:[v.jsx("div",{className:"p-2 bg-ios-indigo/5 rounded-apple flex-shrink-0",children:v.jsx(q2,{className:"w-3.5 h-3.5 text-ios-indigo"})}),v.jsx("div",{className:"flex-1 flex items-center",children:v.jsx("p",{className:"text-xs font-bold text-gray-800 leading-relaxed",children:G.content})})]})]},te)):v.jsxs("div",{className:"py-20 text-center space-y-2",children:[v.jsx(Io,{className:"w-10 h-10 text-gray-200 mx-auto"}),v.jsx("p",{className:"text-xs font-black text-ios-gray",children:"  ."})]})})]})]}),V=()=>{if(!d)return null;const G=rt(d,"yyyy-MM-dd"),te=a[G],Q=[...(te==null?void 0:te.bookings)||[]].sort((K,N)=>{var U,R;return(((U=K.sessions)==null?void 0:U.start_time)||"").localeCompare(((R=N.sessions)==null?void 0:R.start_time)||"")});return v.jsx("div",{className:"fixed inset-0 z-[100] bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",children:v.jsx("div",{className:"bg-white w-full max-w-sm rounded-3xl overflow-hidden shadow-2xl relative animate-spring-up",children:v.jsxs("div",{className:"p-6",children:[v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsxs("h3",{className:"text-xl font-black text-[#1C1C1E]",children:[rt(d,"M d"),"  "]}),v.jsx("button",{onClick:()=>u(null),className:"p-2 -mr-2 text-gray-400 hover:text-black ios-tap",children:v.jsx(Ja,{className:"w-5 h-5"})})]}),v.jsx("div",{className:"space-y-4 mb-4 max-h-[50vh] overflow-y-auto scrollbar-hide",children:Q.length>0?Q.map((K,N)=>{var Y,Z,fe,X,re,se,z,oe,ce;const U=new Date,R=G===rt(U,"yyyy-MM-dd"),k=rt(U,"HH:mm:ss"),P=(Y=K.sessions)==null?void 0:Y.end_time,A=((Z=K.attendance)==null?void 0:Z[0])||K.attendance,E=Array.isArray(A)?A[0]:A,I=R&&P&&k>P,H=E?E.status==="present"?"":E.status==="late"?"":E.status==="early_leave"?"":"":I?"":"",J=E?E.status==="present"?"text-ios-emerald bg-ios-emerald/10":E.status==="late"?"text-ios-amber bg-ios-amber/10":E.status==="early_leave"?"text-ios-blue bg-ios-blue/10":"text-ios-rose bg-ios-rose/10":I?"text-ios-rose bg-ios-rose/10":"text-gray-400 bg-gray-50";return v.jsxs("div",{className:"p-4 bg-gray-50 rounded-2xl flex items-center justify-between border border-gray-100",children:[v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[v.jsx("p",{className:"text-sm font-black text-[#1C1C1E]",children:(fe=K.sessions)==null?void 0:fe.name}),v.jsx("span",{className:`text-[10px] font-bold px-1.5 py-0.5 rounded-full ${J}`,children:H})]}),v.jsxs("p",{className:"text-xs text-ios-gray font-bold",children:[v.jsx(Qa,{className:"w-3 h-3 inline-block mr-1 mb-0.5"}),(X=K.sessions)==null?void 0:X.start_time.slice(0,5)," ~ ",(re=K.sessions)==null?void 0:re.end_time.slice(0,5)]})]}),v.jsxs("div",{className:"text-right",children:[v.jsx("p",{className:"text-[10px] font-black text-ios-indigo/60 mb-0.5",children:((z=(se=K.seats)==null?void 0:se.zones)==null?void 0:z.name)||""}),v.jsxs("p",{className:"text-xs font-black text-ios-indigo",children:[(oe=K.seats)!=null&&oe.zone_name?`${K.seats.zone_name}-`:"",K.seat_number||((ce=K.seats)==null?void 0:ce.seat_number)||"-"," "]}),(E==null?void 0:E.timestamp_in)&&v.jsxs("p",{className:"text-[10px] text-ios-gray font-bold mt-1",children:[": ",rt(new Date(E.timestamp_in),"HH:mm")]})]})]},N)}):v.jsxs("div",{className:"py-12 text-center space-y-2",children:[v.jsx(Io,{className:"w-10 h-10 text-gray-200 mx-auto"}),v.jsx("p",{className:"text-sm font-bold text-gray-400",children:"   ."})]})}),v.jsx("button",{onClick:()=>u(null),className:"w-full py-4 bg-[#1C1C1E] text-white rounded-2xl font-black text-sm hover:scale-[1.02] active:scale-[0.98] transition-all shadow-lg",children:""})]})})})};return v.jsxs("div",{className:"mobile-container flex flex-col bg-[#F2F2F7] h-[100dvh] overflow-hidden font-sans pb-[safe-area-inset-bottom]",children:[v.jsxs("header",{className:"flex-none glass-header px-6 pt-4 pb-4 flex items-center justify-between shadow-sm",children:[v.jsxs("div",{className:"flex flex-col",children:[v.jsx("h1",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:i.split(" ")[0]}),v.jsx("p",{className:"text-[10px] font-black text-ios-indigo tracking-[0.2em] uppercase opacity-70",children:"PARENT VIEW"})]}),v.jsx("button",{onClick:e,className:"p-3 bg-gray-200/20 text-ios-gray hover:text-ios-rose hover:bg-ios-rose/10 rounded-apple-md transition-all ios-tap border border-white/40 backdrop-blur-xl",children:v.jsx(fd,{className:"w-5 h-5"})})]}),v.jsx("main",{className:"flex-1 overflow-hidden relative",children:y?v.jsxs("div",{className:"h-full flex flex-col items-center justify-center space-y-4 animate-pulse",children:[v.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-[2rem]"}),v.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded-full"})]}):v.jsx("div",{className:"h-full overflow-y-auto scrollbar-hide",children:r==="home"?F():M()})}),v.jsx("nav",{className:"flex-none glass-material pb-[calc(0.4rem+env(safe-area-inset-bottom,0px))] pt-2 px-16 flex justify-around items-center z-50 shadow-[0_-4px_40px_rgba(0,0,0,0.03)] border-t border-white/40",children:[{id:"home",icon:n3,label:""},{id:"stats",icon:Ub,label:""}].map(G=>v.jsxs("button",{onClick:()=>n(G.id),className:`flex flex-col items-center justify-center p-2 rounded-apple-md transition-all duration-300 w-20 group ios-tap ${r===G.id?"text-[#1C1C1E]":"text-gray-300 hover:text-gray-500"}`,children:[v.jsx(G.icon,{className:`w-7 h-7 stroke-[2.5px] ${r===G.id?"fill-ios-indigo/10":"fill-transparent"}`}),v.jsx("span",{className:"text-[9px] font-black mt-1",children:G.label})]},G.id))}),V()]})},sY=()=>{const[e,t]=xe.useState(new Date),[r,n]=xe.useState([]),[i,s]=xe.useState(null),[l,o]=xe.useState([]),[a,c]=xe.useState([]),[f,h]=xe.useState([]),[d,u]=xe.useState([]),[p,m]=xe.useState(!0),[g,x]=xe.useState(!1),[y,w]=xe.useState(!1),[b,S]=xe.useState(!1),[T,O]=xe.useState({date:rt(new Date,"yyyy-MM-dd"),reason:"",is_closed:!0}),[j,L]=xe.useState(new Date().getFullYear()),[W,F]=xe.useState(new Date().getFullYear());xe.useEffect(()=>{M()},[]);const M=async()=>{const{data:I}=await He.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});I&&I.length>0&&(n(I),s(I[0].id))};xe.useEffect(()=>{i&&V(j,i)},[j,i]);const V=async(I,H)=>{m(!0);const[J,Y,Z]=await Promise.all([He.from("operation_quarters").select("*").eq("academic_year",I).order("quarter",{ascending:!0}),He.from("operation_exceptions").select("*").eq("zone_id",H).order("exception_date",{ascending:!0}),He.from("sessions").select("*").eq("zone_id",H).order("start_time",{ascending:!0})]),fe=Z.data||[];u(fe);const X=J.data||[],se=[1,2,3,4].map(ye=>X.find(Te=>Te.quarter===ye)||{quarter:ye,start_date:null,end_date:null,academic_year:I}),z=X.filter(ye=>ye.quarter>4);o([...se,...z].sort((ye,de)=>ye.quarter-de.quarter));const{data:oe}=await He.from("session_operating_days").select("session_id, day_of_week").in("session_id",fe.map(ye=>ye.id)).eq("is_active",!0),ce=oe||[],we=[0,1,2,3,4,5,6].map(ye=>{const de=ce.filter(Te=>Te.day_of_week===ye).map(Te=>Te.session_id);return{day_of_week:ye,active_session_ids:de}});c(we),Y.data&&h(Y.data),m(!1)},G=()=>{L(W)},te=(I,H,J)=>{const Y=l.map(Z=>Z.quarter===I?{...Z,[H]:J}:Z);o(Y)},ee=async()=>{x(!0);const I=l.filter(J=>J.start_date||J.end_date).map(({id:J,quarter:Y,start_date:Z,end_date:fe,quarter_name:X})=>({quarter:Y,start_date:Z||null,end_date:fe||null,quarter_name:X||`${Y}`,academic_year:j})),{error:H}=await He.from("operation_quarters").upsert(I,{onConflict:"academic_year, quarter"});H?alert("     : "+H.message):(alert("   ."),V(j)),x(!1)},Q=async I=>{const H=l.find(J=>J.quarter===I);if(H){if(H.start_date&&H.end_date){const{count:J,error:Y}=await He.from("bookings").select("*",{count:"exact",head:!0}).gte("date",H.start_date).lte("date",H.end_date);if(Y)console.error("Error checking bookings:",Y);else if(J>0){if(!window.confirm(` (${H.start_date} ~ ${H.end_date})  ${J}  .    ?
(    ,    .)`))return}else if(!window.confirm(`${I}   ?`))return}else if(!window.confirm(`${I}  ?`))return;try{const{error:J}=await He.from("operation_quarters").delete().eq("academic_year",j).eq("quarter",I);if(J)throw J;I<=4?o(Y=>Y.map(Z=>Z.quarter===I?{...Z,start_date:null,end_date:null,quarter_name:null}:Z)):o(Y=>Y.filter(Z=>Z.quarter!==I)),alert(`${I}   .`)}catch(J){console.error("Error deleting quarter:",J),alert("   .")}}},K=()=>{const I=l.length>0?Math.max(...l.map(H=>H.quarter)):0;o([...l,{quarter:I+1,start_date:null,end_date:null,academic_year:j}])},N=(I,H)=>{c(J=>J.map(Y=>{if(Y.day_of_week!==I)return Y;const Z=Y.active_session_ids.includes(H)?Y.active_session_ids.filter(fe=>fe!==H):[...Y.active_session_ids,H];return{...Y,active_session_ids:Z}}))},U=async()=>{w(!0);try{const I=[];a.forEach(J=>{d.forEach(Y=>{I.push({session_id:Y.id,day_of_week:J.day_of_week,is_active:J.active_session_ids.includes(Y.id)})})});const{error:H}=await He.from("session_operating_days").upsert(I,{onConflict:"session_id, day_of_week"});if(H)throw H;alert("    ."),V(j,i)}catch(I){alert("      : "+I.message)}finally{w(!1)}},R=async I=>{if(I.preventDefault(),!i)return;const{error:H}=await He.from("operation_exceptions").insert([{exception_date:T.date,reason:T.reason,is_closed:!0,zone_id:i}]);H||(O({...T,reason:""}),V(j,i))},k=async I=>{await He.from("operation_exceptions").delete().eq("id",I),V(j)},P=()=>v.jsx("div",{className:"flex flex-col gap-6 mb-4 px-2",children:v.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:v.jsxs("div",{className:"flex items-center gap-8 flex-wrap",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("button",{onClick:()=>t(mm(e)),className:"p-1.5 hover:bg-gray-100 rounded-lg transition-colors ios-tap",children:v.jsx(Mo,{className:"w-5 h-5 text-ios-gray"})}),v.jsxs("div",{className:"text-center",children:[v.jsx("h3",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:rt(e,"yyyy MMMM",{locale:fn})}),v.jsx("p",{className:"text-[10px] font-black text-ios-indigo uppercase tracking-widest mt-0.5",children:"Operating Calendar"})]}),v.jsx("button",{onClick:()=>t(t0(e,1)),className:"p-1.5 hover:bg-gray-100 rounded-lg transition-colors ios-tap",children:v.jsx(Ts,{className:"w-5 h-5 text-ios-gray"})})]}),v.jsx("div",{className:"flex gap-1.5 flex-wrap",children:r.map(I=>v.jsx("button",{onClick:()=>s(I.id),className:`px-5 py-2 rounded-apple-md text-[11px] font-black transition-all border ios-tap ${i===I.id?"bg-[#1C1C1E] text-white border-[#1C1C1E] shadow-sm":"bg-white text-ios-gray border-gray-100 hover:text-[#1C1C1E] hover:border-gray-200"}`,children:I.name},I.id))})]})})}),A=()=>{const I=["","","","","","",""],H=b?I:I.slice(1,6);return v.jsx("div",{className:`grid ${b?"grid-cols-7":"grid-cols-5"} mb-2 border-b border-gray-100 sticky top-0 z-10 bg-white`,children:H.map((J,Y)=>{const Z=b?Y:Y+1;return v.jsx("div",{className:`py-3 text-[10px] font-black uppercase text-center tracking-widest ${Z===0?"text-ios-rose":Z===6?"text-ios-indigo":"text-ios-gray"}`,children:J},Z)})})},E=()=>{const I=kf(e),H=Rd(I),J=Bn(I,{weekStartsOn:b?0:1}),Y=jo(H,{weekStartsOn:b?0:1});let Z=eu({start:J,end:Y});return b||(Z=Z.filter(fe=>fe.getDay()!==0&&fe.getDay()!==6)),v.jsx("div",{className:`grid ${b?"grid-cols-7":"grid-cols-5"} gap-px bg-gray-100 border border-gray-100 rounded-[12px] overflow-hidden shadow-sm`,children:Z.map((fe,X)=>{var Te;const re=Ol(fe,new Date),se=Yv(fe,I),z=fe.getDay(),oe=rt(fe,"yyyy-MM-dd"),ce=f.find(pe=>pe.exception_date===oe),we=l.find(pe=>pe.start_date&&pe.end_date&&Wc(fe,{start:Cr(pe.start_date),end:Cr(pe.end_date)})),ye=a.find(pe=>pe.day_of_week===z),de=we&&!ce&&((Te=ye==null?void 0:ye.active_session_ids)==null?void 0:Te.length)>0;return v.jsxs("div",{className:`min-h-[100px] p-2 flex flex-col gap-1 transition-colors border-b border-r border-gray-100 ${se?ce?"bg-red-50/30":de?"bg-[#f0f9ff]":"bg-white":"opacity-30 bg-gray-50"}`,children:[v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsx("span",{className:`text-[11px] font-black ${re?"w-6 h-6 text-ios-indigo border-2 border-ios-indigo rounded-full flex items-center justify-center -mt-1 -ml-1 bg-white":z===0?"text-ios-rose":z===6?"text-ios-indigo":"text-[#1C1C1E]"}`,children:rt(fe,"d")}),we&&v.jsxs("span",{className:"text-[8px] font-black bg-white/50 text-ios-indigo px-1.5 py-0.5 rounded-full uppercase tracking-tighter border border-ios-indigo/10",children:["Q",we.quarter]})]}),ce?v.jsxs("div",{className:"mt-1 flex flex-col gap-1",children:[v.jsx("span",{className:"text-[10px] font-black text-red-600 uppercase tracking-widest",children:"CLOSED"}),v.jsx("span",{className:"text-[9px] font-bold text-ios-gray leading-tight",children:ce.reason})]}):de?v.jsx("div",{className:"mt-1 flex flex-col gap-0.5",children:d.map(pe=>{var Ie;const Ae=(Ie=ye==null?void 0:ye.active_session_ids)==null?void 0:Ie.includes(pe.id);return v.jsxs("div",{className:"flex justify-between items-center bg-white/40 rounded-[2px] px-1 py-0.5",children:[v.jsx("span",{className:"text-[8px] font-bold text-ios-gray truncate max-w-[40px]",children:pe.name}),v.jsx("span",{className:`text-[8px] font-black uppercase tracking-wider ${Ae?"text-ios-indigo":"text-red-400 opacity-30"}`,children:Ae?"ON":"OFF"})]},pe.id)})}):null]},X)})})};return p?v.jsx("div",{className:"h-full flex items-center justify-center",children:v.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-ios-indigo"})}):v.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 h-full overflow-hidden p-1",children:[v.jsxs("div",{className:"flex-1 min-h-0 bg-white rounded-[6px] border border-gray-100 flex flex-col p-6 shadow-sm overflow-hidden",children:[P(),v.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 pr-1",children:[A(),E(),v.jsx("div",{className:"mt-3 flex justify-start pb-2",children:v.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[v.jsxs("div",{className:"relative",children:[v.jsx("input",{type:"checkbox",className:"sr-only peer",checked:b,onChange:I=>S(I.target.checked)}),v.jsx("div",{className:"w-10 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-ios-indigo"})]}),v.jsx("span",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest peer-checked:text-[#1C1C1E] transition-colors",children:"/ "})]})})]})]}),v.jsxs("div",{className:"lg:w-96 shrink-0 flex flex-col gap-6 overflow-y-auto pb-6 pr-2",children:[v.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 p-6 shadow-sm",children:[v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(Qa,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h4",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"  "})]}),v.jsx("div",{className:"flex gap-2",children:v.jsxs("button",{onClick:ee,disabled:g,className:"bg-[#1C1C1E] text-white px-5 py-2.5 rounded-[8px] text-[11px] font-black uppercase tracking-widest flex items-center gap-2 hover:bg-gray-800 shadow-md transition-all active:scale-95",children:[v.jsx(vf,{className:"w-3.5 h-3.5"})," "]})})]}),v.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-[8px] border border-gray-100",children:[v.jsx("label",{className:"block text-[10px] font-black text-ios-gray uppercase tracking-widest mb-2",children:" "}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("select",{value:W,onChange:I=>F(Number(I.target.value)),className:"flex-1 bg-white border border-gray-200 rounded-[6px] px-3 py-2 text-xs font-bold text-[#1C1C1E] focus:outline-none focus:ring-1 focus:ring-ios-indigo",children:[j-2,j-1,j,j+1,j+2].sort().map(I=>v.jsxs("option",{value:I,children:[I,""]},I))}),v.jsx("button",{onClick:G,className:"bg-[#1C1C1E] text-white px-3 py-2 rounded-[6px] text-[10px] font-black uppercase whitespace-nowrap hover:bg-gray-800 transition-colors",children:""})]})]}),v.jsxs("div",{className:"space-y-6",children:[l.map(I=>v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("p",{className:"text-[11px] font-black text-ios-indigo",children:[I.quarter,""]}),(I.start_date||I.end_date||I.quarter>4)&&v.jsx("button",{onClick:()=>Q(I.quarter),className:"p-1 text-ios-gray hover:text-ios-rose transition-colors",title:" ",children:v.jsx(Dl,{className:"w-3 h-3"})})]}),v.jsxs("span",{className:"text-[8px] font-bold text-ios-gray bg-gray-50 px-2 py-0.5 rounded-full uppercase tracking-widest",children:["Year ",j," - Q",I.quarter]})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[v.jsx("input",{type:"date",value:I.start_date||"",onChange:H=>te(I.quarter,"start_date",H.target.value),className:"bg-gray-50 border-none rounded-[6px] px-3 py-2 text-[11px] font-bold focus:ring-1 focus:ring-ios-indigo transition-all"}),v.jsx("input",{type:"date",value:I.end_date||"",onChange:H=>te(I.quarter,"end_date",H.target.value),className:"bg-gray-50 border-none rounded-[6px] px-3 py-2 text-[11px] font-bold focus:ring-1 focus:ring-ios-indigo transition-all"})]})]},I.quarter)),v.jsxs("button",{onClick:K,className:"w-full py-3 bg-gray-50 text-ios-gray border border-dashed border-gray-200 rounded-[6px] text-[10px] font-black uppercase tracking-wider flex items-center justify-center gap-1.5 hover:bg-gray-100 hover:text-[#1C1C1E] hover:border-gray-300 transition-all active:scale-95",children:[v.jsx(dd,{className:"w-3.5 h-3.5"}),"  "]})]})]}),v.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 p-6 shadow-sm",children:[v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(Qa,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h4",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"   "})]}),v.jsxs("button",{onClick:U,disabled:y,className:"bg-[#1C1C1E] text-white px-5 py-2.5 rounded-[8px] text-[11px] font-black uppercase tracking-widest flex items-center gap-2 hover:bg-gray-800 shadow-md transition-all active:scale-95",children:[v.jsx(vf,{className:"w-3.5 h-3.5"})," "]})]}),v.jsxs("div",{className:"space-y-1 overflow-x-auto min-w-0",children:[v.jsxs("div",{className:"grid gap-2 pb-2 border-b border-gray-100 mb-2",style:{gridTemplateColumns:`40px repeat(${d.length}, minmax(40px, 1fr))`},children:[v.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest",children:""}),d.map(I=>v.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest text-center truncate px-1",title:I.name,children:I.name},I.id))]}),[1,2,3,4,5,6,0].map(I=>{const H=a.find(J=>J.day_of_week===I)||{active_session_ids:[]};return v.jsxs("div",{className:"grid gap-2 items-center py-2 hover:bg-gray-50 rounded-[4px] transition-colors",style:{gridTemplateColumns:`40px repeat(${d.length}, minmax(40px, 1fr))`},children:[v.jsx("span",{className:`text-[10px] font-black ${I===0?"text-ios-rose":I===6?"text-ios-indigo":"text-[#1C1C1E]"}`,children:["","","","","","",""][I]}),d.map(J=>{var Y;return v.jsx("div",{className:"flex justify-center",children:v.jsx("input",{type:"checkbox",checked:(Y=H.active_session_ids)==null?void 0:Y.includes(J.id),onChange:()=>N(I,J.id),className:"w-4 h-4 rounded-full border-gray-200 text-ios-indigo focus:ring-ios-indigo/20 transition-all cursor-pointer"})},J.id)})]},I)})]})]}),v.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 p-6 shadow-sm flex-1",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[v.jsx(Ns,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h4",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"()  "})]}),v.jsxs("form",{onSubmit:R,className:"space-y-4 mb-8",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("p",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest px-1",children:" "}),v.jsx("input",{type:"date",value:T.date,onChange:I=>O({...T,date:I.target.value}),className:"w-full bg-gray-50 border-none rounded-[6px] px-3 py-3 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all outline-none"})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("p",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest px-1",children:" "}),v.jsx("input",{type:"text",placeholder:": ,   ",value:T.reason,onChange:I=>O({...T,reason:I.target.value}),className:"w-full bg-gray-50 border-none rounded-[6px] px-3 py-3 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all outline-none"})]}),v.jsxs("button",{type:"submit",disabled:!T.reason,className:"w-full py-3 bg-[#1C1C1E] text-white rounded-[6px] font-black text-[11px] uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-gray-800 transition-all disabled:opacity-30 disabled:hover:bg-[#1C1C1E]",children:[v.jsx(dd,{className:"w-3 h-3"})," "]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest px-1 border-b border-gray-50 pb-2 mb-4",children:"  "}),v.jsxs("div",{className:"space-y-3 max-h-60 overflow-y-auto pr-2 scrollbar-hide",children:[f.length===0&&v.jsx("p",{className:"text-[10px] text-ios-gray italic text-center py-4",children:"  ."}),f.map(I=>v.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-[6px] hover:bg-ios-rose/5 transition-all group border border-transparent hover:border-ios-rose/10",children:[v.jsxs("div",{className:"flex-1",children:[v.jsx("p",{className:"text-[11px] font-black text-[#1C1C1E]",children:I.exception_date}),v.jsx("p",{className:"text-[9px] font-bold text-ios-gray truncate",children:I.reason})]}),v.jsx("button",{onClick:()=>k(I.id),className:"p-1.5 text-ios-gray hover:text-ios-rose transition-colors opacity-0 group-hover:opacity-100",children:v.jsx(Dl,{className:"w-3.5 h-3.5"})})]},I.id))]})]})]})]})]})},aY=()=>{var w,b;const[e,t]=xe.useState(!0),[r,n]=xe.useState(!1),[i,s]=xe.useState(null),[l,o]=xe.useState(!1),[a,c]=xe.useState(""),[f,h]=xe.useState(""),[d,u]=xe.useState(""),[p,m]=xe.useState({points:[{lat:37.5665,lng:126.978,name:" "}],radius:100}),g=S=>{m(S)};xe.useEffect(()=>{x()},[]);const x=async()=>{t(!0);try{const{data:S,error:T}=await He.from("configs").select("*").eq("key","school_info").single();if(T&&T.code!=="PGRST116")throw T;S&&(c(S.value.name||""),h(S.value.name_en||""),u(S.value.level||""));const{data:O,error:j}=await He.from("configs").select("*").eq("key","gps_settings").single();if(j&&j.code!=="PGRST116")throw j;O!=null&&O.value&&(O.value.points?m(O.value):O.value.lat&&m({points:[{lat:O.value.lat,lng:O.value.lng,name:" "}],radius:O.value.radius||100}))}catch(S){console.error("Error fetching initial data:",S),s("    .")}finally{t(!1)}},y=async()=>{n(!0),s(null),o(!1);try{await He.from("configs").upsert({key:"school_info",value:{name:a,name_en:f,level:d}});const{error:S}=await He.from("configs").upsert({key:"gps_settings",value:p});if(S)throw S;o(!0),setTimeout(()=>o(!1),2e3)}catch(S){console.error("Save error:",S),s("   : "+S.message)}finally{n(!1)}};return e?v.jsxs("div",{className:"h-full flex flex-col items-center justify-center bg-white rounded-t-[6px]",children:[v.jsx("div",{className:"w-10 h-10 border-4 border-ios-indigo/20 border-t-ios-indigo rounded-full animate-spin mb-4"}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"   ..."})]}):v.jsxs("div",{className:"bg-white rounded-t-[6px] h-full flex flex-col overflow-hidden animate-spring-up",children:[v.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide p-8 pb-32",children:v.jsxs("div",{className:"max-w-4xl mx-auto space-y-12",children:[v.jsxs("div",{className:"flex items-center justify-between bg-gray-50/50 p-6 rounded-2xl border border-gray-100",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:"w-12 h-12 rounded-xl bg-[#1C1C1E] flex items-center justify-center shadow-lg",children:v.jsx(pg,{className:"w-6 h-6 text-white"})}),v.jsxs("div",{children:[v.jsx("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:" "}),v.jsx("p",{className:"text-sm text-ios-gray font-bold",children:"        ."})]})]}),i&&v.jsxs("div",{className:"flex items-center gap-2 bg-ios-rose/10 px-4 py-2 rounded-lg border border-ios-rose/20 text-ios-rose font-bold text-xs animate-shake",children:[v.jsx(Ns,{className:"w-4 h-4"})," ",i]})]}),v.jsxs("section",{className:"space-y-6",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[v.jsx(uO,{className:"w-5 h-5 text-ios-indigo"}),v.jsx("h3",{className:"text-lg font-black text-[#1C1C1E]",children:"  "})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 auto-rows-min",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest ml-1",children:" "}),v.jsx("input",{type:"text",value:a,onChange:S=>c(S.target.value),className:"w-full bg-gray-50 border border-gray-100 focus:bg-white focus:border-ios-indigo/20 rounded-xl px-5 py-4 text-base font-bold text-[#1C1C1E] transition-all outline-none"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest ml-1",children:"  ()"}),v.jsx("input",{type:"text",value:f,onChange:S=>h(S.target.value),className:"w-full bg-gray-50 border border-gray-100 focus:bg-white focus:border-ios-indigo/20 rounded-xl px-5 py-4 text-base font-bold text-[#1C1C1E] transition-all outline-none",placeholder:"APP    ."})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest ml-1",children:""}),v.jsxs("div",{className:"relative",children:[v.jsxs("select",{value:d,onChange:S=>u(S.target.value),className:"w-full bg-gray-50 border border-gray-100 focus:bg-white focus:border-ios-indigo/20 rounded-xl px-5 py-4 text-base font-bold text-[#1C1C1E] transition-all outline-none appearance-none cursor-pointer",children:[v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""})]}),v.jsx("div",{className:"absolute right-5 top-1/2 -translate-y-1/2 pointer-events-none text-ios-gray",children:v.jsx(pg,{className:"w-4 h-4 opacity-30"})})]})]})]})]}),v.jsx("hr",{className:"border-gray-100"}),v.jsxs("section",{className:"space-y-6 animate-fade-in",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[v.jsx($8,{className:"w-5 h-5 text-ios-rose"}),v.jsx("h3",{className:"text-lg font-black text-[#1C1C1E]",children:"   "})]}),v.jsxs("div",{className:"bg-gray-50/50 p-6 rounded-2xl border border-gray-100 space-y-8",children:[v.jsxs("div",{className:"flex items-start gap-3 p-4 bg-ios-amber/5 border border-ios-amber/10 rounded-xl",children:[v.jsx(dg,{className:"w-4 h-4 text-ios-amber mt-0.5"}),v.jsxs("p",{className:"text-xs text-ios-amber font-bold leading-relaxed",children:["     GPS     .",v.jsx("br",{}),"     (Zone)  ."]})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsx("div",{className:"flex items-center justify-between",children:v.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest flex items-center gap-1.5 ml-1",children:"  "})}),v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(tO,{className:"w-5 h-5 text-ios-indigo"}),v.jsx("div",{className:"flex-1",children:v.jsx("input",{type:"number",value:p.radius||100,onChange:S=>g({...p,radius:parseInt(S.target.value)}),className:"w-full bg-white border border-gray-100 rounded-xl px-4 py-3 text-sm font-bold text-[#1C1C1E] outline-none focus:ring-1 focus:ring-ios-indigo transition-all",placeholder:"  (m)"})}),v.jsx("span",{className:"text-xs font-bold text-ios-gray",children:"(m)"})]})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest flex items-center gap-1.5 ml-1",children:["   (",((w=p.points)==null?void 0:w.length)||0,")"]}),(!p.points||p.points.length<10)&&v.jsx("button",{onClick:()=>{const S=[...p.points||[]];S.push({lat:37.5665,lng:126.978,name:` ${S.length+1}`}),g({...p,points:S})},className:"text-[10px] font-bold text-ios-indigo hover:bg-ios-indigo/10 px-2 py-1 rounded transition-colors",children:"+  "})]}),v.jsx("div",{className:"space-y-3",children:(b=p.points)==null?void 0:b.map((S,T)=>v.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm relative group",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[v.jsx(xf,{className:"w-4 h-4 text-ios-rose"}),v.jsx("input",{type:"text",value:S.name||` ${T+1}`,onChange:O=>{const j=[...p.points];j[T].name=O.target.value,g({...p,points:j})},className:"text-sm font-black text-[#1C1C1E] border-none p-0 focus:ring-0 w-32 bg-transparent",placeholder:" "}),p.points.length>1&&v.jsx("button",{onClick:()=>{const O=p.points.filter((j,L)=>L!==T);g({...p,points:O})},className:"ml-auto p-1.5 text-gray-300 hover:text-ios-rose hover:bg-red-50 rounded-lg transition-colors",children:v.jsx(Dl,{className:"w-3.5 h-3.5"})})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[v.jsxs("div",{children:[v.jsx("label",{className:"text-[9px] text-gray-400 font-bold mb-1 block",children:" (Latitude)"}),v.jsx("input",{type:"number",step:"0.000001",value:S.lat,onChange:O=>{const j=[...p.points];j[T].lat=parseFloat(O.target.value),g({...p,points:j})},className:"w-full bg-gray-50/50 border border-gray-100 rounded-lg px-3 py-2 text-xs font-bold font-mono text-[#1C1C1E] focus:bg-white focus:border-ios-indigo transition-all"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"text-[9px] text-gray-400 font-bold mb-1 block",children:" (Longitude)"}),v.jsx("input",{type:"number",step:"0.000001",value:S.lng,onChange:O=>{const j=[...p.points];j[T].lng=parseFloat(O.target.value),g({...p,points:j})},className:"w-full bg-gray-50/50 border border-gray-100 rounded-lg px-3 py-2 text-xs font-bold font-mono text-[#1C1C1E] focus:bg-white focus:border-ios-indigo transition-all"})]})]})]},T))})]})]})]})]})}),v.jsx("div",{className:"flex-none p-6 border-t border-gray-100 bg-white/80 backdrop-blur-xl z-20",children:v.jsxs("div",{className:"max-w-4xl mx-auto flex items-center gap-4",children:[v.jsx("button",{onClick:y,disabled:r,className:`flex-1 py-5 rounded-2xl font-black text-base flex items-center justify-center gap-3 transition-all ios-tap shadow-lg ${l?"bg-[#1C1C1E] text-white":"bg-[#1C1C1E] text-white hover:bg-gray-800"}`,children:r?v.jsx("div",{className:"w-5 h-5 border-2 border-white/20 border-t-white rounded-full animate-spin"}):l?v.jsxs(v.Fragment,{children:[v.jsx(Ka,{className:"w-5 h-5"}),"    "]}):v.jsxs(v.Fragment,{children:[v.jsx(vf,{className:"w-5 h-5"}),"    "]})}),l&&v.jsxs("div",{className:"bg-ios-emerald/10 text-ios-emerald px-6 py-5 rounded-2xl font-black text-sm animate-fade-in flex items-center gap-2",children:[v.jsx(Es,{className:"w-4 h-4"})," !"]})]})})]})},oY=()=>{const[e,t]=xe.useState(!0),[r,n]=xe.useState([]),[i,s]=xe.useState(null),[l,o]=xe.useState([]),[a,c]=xe.useState([]),[f,h]=xe.useState([]),[d,u]=xe.useState([]),[p,m]=xe.useState([1,2,3]),[g,x]=xe.useState(!1),[y,w]=xe.useState([]);xe.useEffect(()=>{b()},[]);const b=async()=>{t(!0);const{data:W}=await He.from("operation_quarters").select("*").order("academic_year",{ascending:!0}).order("quarter",{ascending:!0});if(W&&W.length>0){n(W);const M=rt(new Date,"yyyy-MM-dd");let V=W.find(G=>M>=G.start_date&&M<=G.end_date);if(!V){const G=new Date;V=W.reduce((te,ee)=>{const Q=Math.abs(new Date(te.start_date)-G);return Math.abs(new Date(ee.start_date)-G)<Q?ee:te})}V&&S(V)}const{data:F}=await He.from("zones").select("id").limit(1);if(F&&F.length>0){const{data:M}=await He.from("sessions").select("*").eq("zone_id",F[0].id).order("start_time",{ascending:!0});M&&(h(M),u(M.map(V=>V.id)))}t(!1)},S=W=>{s(W);const F=new Date(W.start_date),M=new Date(W.end_date),G=pV({start:F,end:M},{weekStartsOn:1}).map((te,ee)=>{let Q=jo(te,{weekStartsOn:1});const K=te<F?F:te,N=Q>M?M:Q;return{id:ee+1,start:K,end:N,label:`${ee+1} (${rt(K,"MM/dd(eee)",{locale:fn})} - ${rt(N,"MM/dd(eee)",{locale:fn})})`}});o(G),c(G.map(te=>te.id))},T=W=>{c(F=>F.includes(W)?F.filter(M=>M!==W):[...F,W])},O=W=>{m(F=>F.includes(W)?F.filter(M=>M!==W):[...F,W])},j=W=>{u(F=>F.includes(W)?F.filter(M=>M!==W):[...F,W])},L=async()=>{if(a.length===0||p.length===0||d.length===0){alert(" , ,    .");return}x(!0);try{const{data:W}=await He.from("profiles_student").select("*").order("grade",{ascending:!0}).order("class_number",{ascending:!0}).order("student_number",{ascending:!0});if(!W||W.length===0){alert("   ."),x(!1);return}const F=[];for(const M of a){const V=l.find(U=>U.id===M),G=rt(V.start,"yyyy-MM-dd"),te=rt(V.end,"yyyy-MM-dd"),{data:ee}=await He.from("bookings").select(`
                        *,
                        attendance(*)
                    `).gte("date",G).lte("date",te).in("session_id",d),Q=eu({start:V.start,end:V.end}),K=new Set((ee||[]).map(U=>U.date)),N=Q.filter(U=>{const R=[0,6].includes(U.getDay()),k=rt(U,"yyyy-MM-dd");return!R||K.has(k)});for(const U of p.sort()){const R=W.filter(A=>A.grade===U);if(R.length===0)continue;const k=R.map(A=>A.id),P=(ee||[]).filter(A=>k.includes(A.student_id));F.push({weekInfo:V,grade:U,students:R,bookings:P,businessDays:N,sessions:f.filter(A=>d.includes(A.id))})}}w(F),setTimeout(()=>{window.print(),x(!1)},1e3)}catch(W){console.error("Print error:",W),alert("     ."),x(!1)}};return e?v.jsxs("div",{className:"h-full flex flex-col items-center justify-center gap-4 bg-white/50 backdrop-blur-sm",children:[v.jsx("div",{className:"w-10 h-10 border-4 border-ios-indigo border-t-transparent rounded-full animate-spin"}),v.jsx("p",{className:"text-[13px] font-black text-ios-gray animate-pulse",children:"   ..."})]}):v.jsxs("div",{className:"h-full flex flex-col bg-[#F2F2F7]",children:[v.jsx("div",{className:"flex-1 overflow-y-auto p-8 pt-6 hide-on-print",children:v.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:"w-12 h-12 rounded-2xl bg-[#1C1C1E] flex items-center justify-center shadow-lg shadow-black/10",children:v.jsx(Fl,{className:"w-6 h-6 text-white"})}),v.jsxs("div",{children:[v.jsx("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:"  "}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"     PDF  ."})]})]}),v.jsx("button",{onClick:L,disabled:g,className:"bg-ios-indigo text-white px-8 py-4 rounded-2xl font-black text-[15px] shadow-lg shadow-ios-indigo/20 hover:scale-[1.02] active:scale-95 transition-all flex items-center gap-3 disabled:opacity-50",children:g?v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"  "]}):v.jsxs(v.Fragment,{children:[v.jsx(r3,{className:"w-5 h-5"}),"PDF   "]})})]}),v.jsxs("div",{className:"space-y-8",children:[v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[v.jsxs("div",{className:"bg-white rounded-[24px] p-6 shadow-sm border border-gray-100 flex flex-col h-full",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[v.jsx(Io,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h3",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:" "})]}),v.jsx("div",{className:"space-y-2 flex-1 overflow-y-auto pr-2 custom-scrollbar max-h-[300px]",children:r.map(W=>v.jsxs("button",{onClick:()=>S(W),className:`w-full text-left p-4 rounded-xl border-2 transition-all flex items-center justify-between group ${(i==null?void 0:i.id)===W.id?"bg-ios-indigo/5 border-ios-indigo text-ios-indigo":"bg-white border-gray-50 text-ios-gray hover:border-gray-200"}`,children:[v.jsxs("div",{children:[v.jsxs("p",{className:"text-[13px] font-black",children:[W.quarter_name," (",W.academic_year,")"]}),v.jsxs("p",{className:"text-[11px] opacity-70 mt-0.5",children:[rt(new Date(W.start_date),"yyyy-MM-dd(eee)",{locale:fn})," ~ ",rt(new Date(W.end_date),"yyyy-MM-dd(eee)",{locale:fn})]})]}),(i==null?void 0:i.id)===W.id&&v.jsx(Ka,{className:"w-5 h-5"})]},W.id))})]}),v.jsxs("div",{className:"bg-white rounded-[24px] p-6 shadow-sm border border-gray-100 flex flex-col h-full",children:[v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(N8,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h3",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"  "})]}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>c(l.map(W=>W.id)),className:"text-[11px] font-black text-ios-indigo hover:underline",children:""}),v.jsx("span",{className:"text-gray-200",children:"|"}),v.jsx("button",{onClick:()=>c([]),className:"text-[11px] font-black text-ios-rose hover:underline",children:""})]})]}),v.jsx("div",{className:"grid grid-cols-2 gap-3 flex-1 overflow-y-auto pr-2 custom-scrollbar max-h-[300px]",children:l.map(W=>v.jsxs("button",{onClick:()=>T(W.id),className:`relative p-4 rounded-2xl border-2 transition-all group ${a.includes(W.id)?"bg-ios-indigo/5 border-ios-indigo":"bg-white border-gray-100 hover:border-gray-200"}`,children:[v.jsxs("p",{className:`text-[13px] font-black ${a.includes(W.id)?"text-ios-indigo":"text-[#1C1C1E]"}`,children:[W.id,""]}),v.jsxs("p",{className:"text-[10px] text-ios-gray font-bold mt-1",children:[rt(W.start,"MM/dd(eee)",{locale:fn})," - ",rt(W.end,"MM/dd(eee)",{locale:fn})]}),a.includes(W.id)&&v.jsx("div",{className:"absolute top-2 right-2 flex items-center justify-center w-5 h-5 rounded-full bg-ios-indigo text-white shadow-sm scale-110",children:v.jsx(Es,{className:"w-3 h-3",strokeWidth:4})})]},W.id))})]})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 items-start",children:[v.jsxs("div",{className:"bg-white rounded-[24px] p-6 shadow-sm border border-gray-100",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[v.jsx($d,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h3",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:" "})]}),v.jsx("div",{className:"flex gap-3",children:[1,2,3].map(W=>v.jsxs("button",{onClick:()=>O(W),className:`flex-1 py-3 px-4 rounded-xl font-black text-[13px] transition-all border-2 flex items-center justify-between gap-2 ${p.includes(W)?"bg-ios-indigo text-white border-ios-indigo shadow-md shadow-ios-indigo/20":"bg-white text-ios-gray border-gray-100"}`,children:[v.jsxs("span",{className:"flex-1 text-center",children:[W,""]}),p.includes(W)&&v.jsx(Es,{className:"w-4 h-4",strokeWidth:3})]},W))})]}),v.jsxs("div",{className:"bg-white rounded-[24px] p-6 shadow-sm border border-gray-100",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[v.jsx(Qa,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h3",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:" "})]}),v.jsx("div",{className:"grid grid-cols-2 gap-3",children:f.map(W=>v.jsxs("button",{onClick:()=>j(W.id),className:`py-3 px-4 rounded-xl font-black text-[12px] transition-all border-2 flex items-center justify-between ${d.includes(W.id)?"bg-ios-indigo/5 border-ios-indigo text-ios-indigo":"bg-white text-ios-gray border-gray-100"}`,children:[v.jsx("span",{children:W.name}),d.includes(W.id)&&v.jsx(Es,{className:"w-4 h-4"})]},W.id))})]})]})]})]})}),v.jsxs("div",{className:`print-area ${g?"block opacity-0 pointer-events-none":"hidden"} fixed inset-0 z-[-1]`,children:[v.jsx("style",{children:`
                    @media print {
                        @page { 
                            size: A4 portrait; 
                            margin: 20mm 10mm 10mm 10mm; 
                        }
                        
                        /* Reset EVERYTHING to non-scrolling block layout */
                        html, body, #root, #root > div, main, main > div, 
                        .flex-1.flex, .admin-content-view, 
                        div[class*="rounded-2xl"], div[class*="bg-white"],
                        .flex-1.bg-\\[\\#F2F2F7\\] { 
                            height: auto !important;
                            overflow: visible !important;
                            display: block !important;
                            position: static !important;
                            margin: 0 !important;
                            padding: 0 !important;
                            border: none !important;
                            box-shadow: none !important;
                            flex: none !important;
                            width: 100% !important;
                        }

                        /* Hide app UI */
                        header, aside, .sidebar, .header, .nav-tabs, .selection-ui, .hide-on-print { 
                            display: none !important;
                        }

                        /* Force the printable content back to visible and opacity-1 */
                        .print-area { 
                            display: block !important; 
                            visibility: visible !important;
                            opacity: 1 !important;
                            position: static !important;
                            z-index: auto !important;
                        }

                        .print-area * {
                            visibility: visible !important;
                        }

                        /* Use standard flow for reliable pagination */
                        .print-area {
                            display: block !important;
                            position: static !important;
                            width: 100% !important;
                            margin: 0 !important;
                            padding: 0 !important;
                        }

                        .page-break { 
                            display: block !important;
                            page-break-after: always !important;
                            break-after: page !important;
                            width: 100% !important;
                            margin: 0 !important;
                            padding: 0 !important;
                            position: relative !important;
                        }

                        /* Ensure no top margin on the first page beyond the @page margin */
                        .page-break:first-child {
                            margin-top: 0 !important;
                        }

                        .header-row { 
                            display: flex; 
                            justify-content: space-between; 
                            align-items: flex-end; 
                            margin: 0 0 10px 0 !important; 
                            padding: 0 0 5px 0 !important;
                            border-bottom: 2px solid #000 !important; 
                        }
                        
                        .school-title { 
                            font-size: 20px !important; 
                            font-weight: 900 !important;
                            margin: 0 !important;
                            padding: 0 !important;
                            line-height: 1 !important;
                        }

                        .doc-title {
                            font-size: 10px !important;
                            margin: 0 !important;
                            padding: 0 !important;
                        }

                        .attendance-table { 
                            width: 100% !important; 
                            border-collapse: collapse !important; 
                            margin: 10px 0 0 0 !important;
                            font-size: 10px !important; 
                            table-layout: fixed !important;
                        }

                        .attendance-table th, .attendance-table td { 
                            border: 1px solid #000 !important; 
                            padding: 4px !important; 
                            text-align: center !important; 
                        }

                        .attendance-table th { 
                            background-color: #eee !important; 
                            -webkit-print-color-adjust: exact !important;
                        }
                    }
                `}),v.jsx("div",{className:"print-root",children:y.map((W,F)=>v.jsxs("div",{className:"page-break",children:[v.jsxs("div",{className:"header-row",children:[v.jsxs("h1",{className:"school-title",children:["   (",i==null?void 0:i.quarter_name,", ",W.weekInfo.id,")"]}),v.jsxs("div",{className:"doc-title",children:[rt(W.weekInfo.start,"yyyy-MM-dd(eee)",{locale:fn})," ~ ",rt(W.weekInfo.end,"yyyy-MM-dd(eee)",{locale:fn})]})]}),v.jsxs("div",{className:"flex justify-between items-center mb-2 px-1 text-[10px] font-bold",children:[v.jsxs("div",{className:"flex gap-4",children:[v.jsxs("span",{children:[": ",i==null?void 0:i.academic_year]}),v.jsxs("span",{children:[": ",W.grade,""]})]}),v.jsxs("div",{className:"flex gap-3 text-[9px] font-normal items-center",children:[v.jsx("span",{children:"[]"}),v.jsxs("span",{children:[": ",v.jsx("span",{style:{fontWeight:"bold"},children:"O"})]}),v.jsxs("span",{children:[": ",v.jsx("span",{style:{color:"#ff3b30",fontWeight:"bold"},children:"/"})]}),v.jsxs("span",{children:[": ",v.jsx("span",{style:{color:"#007aff",fontWeight:"bold"},children:""})]}),v.jsxs("span",{children:[": ",v.jsx("span",{style:{color:"#ff3b30",fontWeight:"bold"},children:""})]}),v.jsx("span",{children:": -"})]})]}),v.jsxs("table",{className:"attendance-table",children:[v.jsxs("thead",{children:[v.jsxs("tr",{children:[v.jsx("th",{style:{width:"40px"},children:"No"}),v.jsx("th",{style:{width:"60px"},children:""}),v.jsx("th",{style:{width:"60px"},children:""}),W.businessDays.map(M=>v.jsxs("th",{colSpan:W.sessions.length,children:[rt(M,"MM/dd")," (",rt(M,"E",{locale:fn})[0],")"]},M.toString()))]}),v.jsxs("tr",{children:[v.jsx("th",{colSpan:3,children:""}),W.businessDays.map(M=>W.sessions.map(V=>v.jsx("th",{style:{fontSize:"8px",padding:"2px 0",whiteSpace:"nowrap"},children:V.name},`${M}-${V.id}`)))]})]}),v.jsx("tbody",{children:W.students.map((M,V)=>v.jsxs("tr",{children:[v.jsx("td",{children:V+1}),v.jsxs("td",{children:[M.grade,String(M.class_number).padStart(2,"0"),String(M.student_number).padStart(2,"0")]}),v.jsx("td",{style:{fontWeight:"bold"},children:M.full_name}),W.businessDays.map(G=>{const te=rt(G,"yyyy-MM-dd");return W.sessions.map(ee=>{var P,A;const Q=W.bookings.find(E=>E.student_id===M.id&&E.date===te&&E.session_id===ee.id),K=(A=(P=Q==null?void 0:Q.attendance)==null?void 0:P[0])==null?void 0:A.status,N=rt(new Date,"yyyy-MM-dd");let U=K;Q&&!K&&te<N&&(U="absent");const R=U==="present"?"O":U==="late"?"":U==="early"?"/":U==="absent"?"":Q?"":"-",k=()=>U==="absent"||U==="early"?"#ff3b30":U==="late"?"#007aff":"inherit";return v.jsx("td",{style:{fontSize:"10px",fontWeight:"bold",color:k()},children:R},`${M.id}-${te}-${ee.id}`)})})]},M.id))})]})]},F))})]})]})},lY=()=>{var O;const[e,t]=xe.useState(!0),[r,n]=xe.useState(!1),[i,s]=xe.useState(null),[l,o]=xe.useState(!1),[a,c]=xe.useState([]),[f,h]=xe.useState(null),[d,u]=xe.useState([]);xe.useEffect(()=>{p()},[]),xe.useEffect(()=>{f&&m(f)},[f]);const p=async()=>{t(!0);try{const{data:j,error:L}=await He.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});if(L)throw L;c(j||[]),j&&j.length>0&&h(j[0].id)}catch(j){console.error("Error fetching zones:",j),s("     .")}finally{t(!1)}},m=async j=>{try{const{data:L,error:W}=await He.from("sessions").select("*").eq("zone_id",j).order("start_time",{ascending:!0});if(W)throw W;u(L||[])}catch(L){console.error("Error fetching sessions:",L),s("     .")}},g=async()=>{const j=prompt("     (: 2):");if(j){n(!0);try{const{data:L,error:W}=await He.from("zones").insert([{name:j,settings:{points:[{lat:37.5665,lng:126.978,name:" "}],radius:100}}]).select().single();if(W)throw W;c([...a,L]),h(L.id)}catch(L){alert("  : "+L.message)}finally{n(!1)}}},x=async(j,L)=>{const W=prompt("   :",L);if(!(!W||W===L)){n(!0);try{const{error:F}=await He.from("zones").update({name:W}).eq("id",j);if(F)throw F;c(a.map(M=>M.id===j?{...M,name:W}:M))}catch(F){alert("  : "+F.message)}finally{n(!1)}}},y=async j=>{if(confirm("   ?       !")){n(!0);try{const{error:L}=await He.from("zones").delete().eq("id",j);if(L)throw L;const W=a.filter(F=>F.id!==j);c(W),W.length>0?h(W[0].id):h(null)}catch(L){alert("  : "+L.message)}finally{n(!1)}}},w=async()=>{if(!f)return;const j=prompt("   (: 3):");if(j)try{const{data:L,error:W}=await He.from("sessions").insert([{zone_id:f,name:j,start_time:"09:00:00",end_time:"12:00:00"}]).select().single();if(W)throw W;u([...d,L])}catch{alert("  ")}},b=async j=>{if(!confirm(" ?"))return;const{error:L}=await He.from("sessions").delete().eq("id",j);L?alert(" "):u(d.filter(W=>W.id!==j))},S=(j,L,W)=>{u(d.map(F=>F.id===j?{...F,[L]:W}:F))},T=async()=>{if(f){n(!0),o(!1);try{if(d.length>0){const{error:j}=await He.from("sessions").upsert(d.map(L=>({id:L.id,zone_id:f,name:L.name,start_time:L.start_time,end_time:L.end_time})));if(j)throw j}o(!0),setTimeout(()=>o(!1),2e3)}catch(j){console.error("Save error:",j),s("   : "+j.message),setTimeout(()=>s(null),3e3)}finally{n(!1)}}};return e?v.jsxs("div",{className:"h-full flex flex-col items-center justify-center bg-white rounded-t-[6px]",children:[v.jsx("div",{className:"w-10 h-10 border-4 border-ios-indigo/20 border-t-ios-indigo rounded-full animate-spin mb-4"}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"   ..."})]}):v.jsxs("div",{className:"bg-white rounded-t-[6px] h-full flex flex-col overflow-hidden animate-spring-up",children:[v.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide p-8 pb-32",children:v.jsxs("div",{className:"max-w-4xl mx-auto space-y-12",children:[v.jsxs("div",{className:"flex items-center justify-between bg-gray-50/50 p-6 rounded-2xl border border-gray-100",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:"w-12 h-12 rounded-xl bg-[#1C1C1E] flex items-center justify-center shadow-lg",children:v.jsx(V2,{className:"w-6 h-6 text-white"})}),v.jsxs("div",{children:[v.jsx("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:"  "}),v.jsx("p",{className:"text-sm text-ios-gray font-bold",children:"  (Zone)    ."})]})]}),i&&v.jsxs("div",{className:"flex items-center gap-2 bg-ios-rose/10 px-4 py-2 rounded-lg border border-ios-rose/20 text-ios-rose font-bold text-xs animate-shake",children:[v.jsx(Ns,{className:"w-4 h-4"})," ",i]})]}),v.jsxs("section",{className:"space-y-6",children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(hd,{className:"w-5 h-5 text-ios-amber"}),v.jsx("h3",{className:"text-lg font-black text-[#1C1C1E]",children:"  "})]}),v.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-4 py-2 bg-[#1C1C1E] text-white rounded-lg text-xs font-bold shadow-lg hover:shadow-xl transition-all ios-tap",children:[v.jsx(dd,{className:"w-4 h-4"}),"  "]})]}),v.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(j=>v.jsx("div",{onClick:()=>h(j.id),className:`relative p-5 rounded-2xl border-2 transition-all cursor-pointer group ${f===j.id?"bg-ios-indigo/5 border-ios-indigo shadow-md":"bg-white border-gray-100 hover:border-gray-200"}`,children:v.jsxs("div",{className:"flex flex-col gap-1",children:[v.jsxs("div",{className:"flex items-start justify-between",children:[v.jsxs("span",{className:`text-[10px] font-black uppercase tracking-widest ${f===j.id?"text-ios-indigo":"text-ios-gray"}`,children:["ZONE #",j.id]}),v.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[v.jsx("button",{onClick:L=>{L.stopPropagation(),x(j.id,j.name)},className:"p-1.5 hover:bg-white rounded-md text-ios-gray hover:text-[#1C1C1E] shadow-sm",children:v.jsx(xO,{className:"w-3 h-3"})}),v.jsx("button",{onClick:L=>{L.stopPropagation(),y(j.id)},className:"p-1.5 hover:bg-white rounded-md text-ios-gray hover:text-ios-rose shadow-sm",children:v.jsx(Dl,{className:"w-3 h-3"})})]})]}),v.jsx("h4",{className:"text-lg font-black text-[#1C1C1E]",children:j.name}),v.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[v.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${f===j.id?"bg-ios-indigo animate-pulse":"bg-gray-300"}`}),v.jsx("span",{className:"text-[11px] font-bold text-ios-gray",children:f===j.id?" ":" "})]})]})},j.id))})]}),f&&v.jsxs(v.Fragment,{children:[v.jsx("hr",{className:"border-gray-100"}),v.jsxs("section",{className:"space-y-6 animate-fade-in",children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Qa,{className:"w-5 h-5 text-ios-emerald"}),v.jsxs("h3",{className:"text-lg font-black text-[#1C1C1E]",children:["[",(O=a.find(j=>j.id===f))==null?void 0:O.name,"]   "]})]}),v.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-4 py-2 bg-[#1C1C1E] text-white rounded-lg text-xs font-bold shadow-lg hover:shadow-xl transition-all ios-tap",children:[v.jsx(y8,{className:"w-4 h-4"}),"  "]})]}),v.jsx("div",{className:"grid grid-cols-1 gap-3",children:d.length===0?v.jsx("div",{className:"p-12 text-center bg-gray-50 border border-dashed border-gray-200 rounded-2xl",children:v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"  . ' ' ."})}):d.map((j,L)=>v.jsxs("div",{className:"group flex items-center justify-between bg-white border border-gray-100 p-5 rounded-2xl hover:shadow-md transition-all",children:[v.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-50 flex items-center justify-center text-[11px] font-black text-ios-gray border border-gray-100",children:L+1}),v.jsxs("div",{className:"w-40",children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest mb-1 block",children:" "}),v.jsx("input",{type:"text",value:j.name||"",onChange:W=>S(j.id,"name",W.target.value),className:"text-sm font-black text-[#1C1C1E] bg-transparent border-none p-0 focus:ring-0 w-full"})]}),v.jsxs("div",{className:"flex items-center gap-8",children:[v.jsxs("div",{children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest mb-1 block",children:""}),v.jsx("input",{type:"time",value:j.start_time||"",onChange:W=>S(j.id,"start_time",W.target.value),className:"text-sm font-black text-[#1C1C1E] border-none p-0 bg-transparent focus:ring-0 w-32 pr-2"})]}),v.jsx(Ts,{className:"w-4 h-4 text-gray-200 mt-4"}),v.jsxs("div",{children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest mb-1 block",children:""}),v.jsx("input",{type:"time",value:j.end_time||"",onChange:W=>S(j.id,"end_time",W.target.value),className:"text-sm font-black text-[#1C1C1E] border-none p-0 bg-transparent focus:ring-0 w-32 pr-2"})]})]})]}),v.jsx("button",{onClick:()=>b(j.id),className:"p-2.5 text-ios-gray hover:text-ios-rose hover:bg-ios-rose/5 rounded-xl transition-all opacity-0 group-hover:opacity-100",children:v.jsx(Dl,{className:"w-4 h-4"})})]},j.id))})]})]})]})}),v.jsx("div",{className:"flex-none p-6 border-t border-gray-100 bg-white/80 backdrop-blur-xl z-20",children:v.jsxs("div",{className:"max-w-4xl mx-auto flex items-center gap-4",children:[v.jsx("button",{onClick:T,disabled:r,className:`flex-1 py-5 rounded-2xl font-black text-base flex items-center justify-center gap-3 transition-all ios-tap shadow-lg ${l?"bg-ios-emerald text-white":"bg-[#1C1C1E] text-white hover:bg-gray-800"}`,children:r?v.jsx("div",{className:"w-5 h-5 border-2 border-white/20 border-t-white rounded-full animate-spin"}):l?v.jsxs(v.Fragment,{children:[v.jsx(Ka,{className:"w-5 h-5"}),"    "]}):v.jsxs(v.Fragment,{children:[v.jsx(vf,{className:"w-5 h-5"}),"    "]})}),l&&v.jsxs("div",{className:"bg-ios-emerald/10 text-ios-emerald px-6 py-5 rounded-2xl font-black text-sm animate-fade-in flex items-center gap-2",children:[v.jsx(Es,{className:"w-4 h-4"}),"  ."]})]})})]})},dx=({grade:e,isChecked:t,onChange:r})=>v.jsxs("button",{onClick:()=>r(e),className:`flex items-center gap-2 px-4 py-2 rounded-xl border-2 transition-all ${t?"bg-ios-indigo border-ios-indigo text-white shadow-md":"bg-white border-gray-100 text-ios-gray hover:border-gray-200"}`,children:[v.jsx("div",{className:`w-4 h-4 rounded-md border flex items-center justify-center transition-colors ${t?"bg-white border-white":"bg-gray-50 border-gray-200"}`,children:t&&v.jsx(Es,{className:"w-3 h-3 text-ios-indigo",strokeWidth:4})}),v.jsxs("span",{className:"text-xs font-black",children:[e,""]})]}),cY=()=>{const[e,t]=xe.useState(!0),[r,n]=xe.useState(!1),[i,s]=xe.useState(null),[l,o]=xe.useState(!1),[a,c]=xe.useState([]),[f,h]=xe.useState({}),[d,u]=xe.useState(!1),[p,m]=xe.useState(null);xe.useEffect(()=>{g()},[]);const g=async()=>{var w,b;t(!0);try{const{data:S,error:T}=await He.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});if(T)throw T;c(S||[]),(S==null?void 0:S.length)>0&&m(S[0].id);const{data:O,error:j}=await He.from("seats").select("zone_id, zone_name").not("zone_name","is",null);if(j)throw j;const[L,W]=await Promise.all([He.from("configs").select("value").eq("key","grade_restriction_enabled").maybeSingle(),He.from("configs").select("value").eq("key","sub_zone_grade_restrictions").maybeSingle()]);u(!!((w=L.data)!=null&&w.value));const F=((b=W.data)==null?void 0:b.value)||{},M={};O.forEach(G=>{M[G.zone_id]||(M[G.zone_id]=new Set),M[G.zone_id].add(G.zone_name)});const V={};for(const G in M){const te=F[G]||{};V[G]=Array.from(M[G]).sort().map(ee=>{let Q=te[ee];return Q!==null&&typeof Q=="number"&&(Q=[Q]),{name:ee,allowedGrades:Q||[]}})}h(V)}catch(S){console.error("Error fetching data:",S),s("    .")}finally{t(!1)}},x=(w,b,S)=>{h(T=>{const O=[...T[w]||[]],j=O.findIndex(L=>L.name===b);if(j>-1){const L=[...O[j].allowedGrades],W=L.indexOf(S);W>-1?L.splice(W,1):L.push(S),O[j]={...O[j],allowedGrades:L.sort()}}return{...T,[w]:O}})},y=async()=>{n(!0),s(null),o(!1);try{await He.from("configs").upsert({key:"grade_restriction_enabled",value:d});const w={};for(const b in f){const S={};f[b].forEach(T=>{T.allowedGrades.length>0&&(S[T.name]=T.allowedGrades)}),Object.keys(S).length>0&&(w[b]=S)}await He.from("configs").upsert({key:"sub_zone_grade_restrictions",value:w}),o(!0),setTimeout(()=>o(!1),2e3)}catch(w){console.error("Save error:",w),s("   .")}finally{n(!1)}};return e?v.jsxs("div",{className:"h-full flex flex-col items-center justify-center bg-white",children:[v.jsx("div",{className:"w-10 h-10 border-4 border-ios-indigo/20 border-t-ios-indigo rounded-full animate-spin mb-4"}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"  ..."})]}):v.jsxs("div",{className:"bg-white h-full flex flex-col overflow-hidden animate-spring-up font-sans",children:[v.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide p-8 pb-32",children:v.jsxs("div",{className:"max-w-3xl mx-auto space-y-12",children:[v.jsx("div",{className:"flex items-center justify-between bg-gray-50/50 p-6 rounded-2xl border border-gray-100",children:v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:"w-12 h-12 rounded-xl bg-[#1C1C1E] flex items-center justify-center shadow-lg",children:v.jsx(pd,{className:"w-6 h-6 text-white"})}),v.jsxs("div",{children:[v.jsx("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:"  "}),v.jsx("p",{className:"text-sm text-ios-gray font-bold",children:" (Section A, B, C )    ."})]})]})}),v.jsx("div",{className:"bg-white rounded-2xl border border-gray-100 p-6 shadow-sm space-y-4",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:`p-2 rounded-lg ${d?"bg-ios-indigo/10":"bg-gray-100"}`,children:d?v.jsx(bO,{className:"w-5 h-5 text-ios-indigo"}):v.jsx(yO,{className:"w-5 h-5 text-ios-gray"})}),v.jsxs("div",{children:[v.jsx("h4",{className:"text-base font-black text-[#1C1C1E]",children:"   "}),v.jsx("p",{className:"text-[11px] text-ios-gray font-bold italic",children:"ON       ."})]})]}),v.jsx("button",{onClick:()=>u(!d),className:`w-14 h-8 rounded-full transition-all relative ${d?"bg-ios-indigo":"bg-gray-200"}`,children:v.jsx("div",{className:`absolute top-1 w-6 h-6 bg-white rounded-full shadow-sm transition-all ${d?"left-7":"left-1"}`})})]})}),v.jsxs("section",{className:"space-y-6",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(hd,{className:"w-5 h-5 text-ios-amber"}),v.jsx("h3",{className:"text-lg font-black text-[#1C1C1E]",children:"    "})]}),v.jsx("div",{className:"space-y-4",children:a.map(w=>{const b=f[w.id]||[],S=p===w.id;return v.jsxs("div",{className:`rounded-3xl border transition-all ${S?"border-ios-indigo shadow-md":"border-gray-100 bg-white hover:border-gray-200"}`,children:[v.jsxs("button",{onClick:()=>m(S?null:w.id),className:"w-full flex items-center justify-between p-6 text-left",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center border transition-colors ${S?"bg-ios-indigo/10 border-ios-indigo text-ios-indigo":"bg-gray-50 border-gray-100 text-ios-gray"}`,children:v.jsx(V2,{className:"w-5 h-5"})}),v.jsxs("div",{children:[v.jsx("h4",{className:"text-lg font-black text-[#1C1C1E]",children:w.name}),v.jsxs("p",{className:"text-[10px] text-ios-gray font-bold uppercase tracking-widest mt-0.5",children:[b.length,"  "]})]})]}),S?v.jsx(lv,{className:"w-5 h-5 text-ios-indigo"}):v.jsx(ov,{className:"w-5 h-5 text-ios-gray"})]}),S&&v.jsx("div",{className:"px-6 pb-6 pt-2 border-t border-gray-50 animate-fade-in",children:b.length===0?v.jsx("div",{className:"py-8 text-center bg-gray-50/50 rounded-2xl border border-dashed border-gray-200",children:v.jsx("p",{className:"text-xs font-bold text-ios-gray",children:"    (A, B, C ) ."})}):v.jsx("div",{className:"grid grid-cols-1 gap-3",children:b.map(T=>v.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between p-6 bg-white border border-gray-100 rounded-3xl gap-4",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:"w-8 h-8 rounded-lg bg-gray-50 flex items-center justify-center text-xs font-black text-[#1C1C1E] border border-gray-100",children:T.name}),v.jsxs("div",{children:[v.jsxs("span",{className:"text-sm font-black text-[#1C1C1E]",children:[T.name," Zone"]}),v.jsx("p",{className:"text-[10px] text-ios-gray font-bold italic",children:"   "})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(dx,{grade:1,isChecked:T.allowedGrades.includes(1),onChange:O=>x(w.id,T.name,O)}),v.jsx(dx,{grade:2,isChecked:T.allowedGrades.includes(2),onChange:O=>x(w.id,T.name,O)}),v.jsx(dx,{grade:3,isChecked:T.allowedGrades.includes(3),onChange:O=>x(w.id,T.name,O)})]})]},T.name))})})]},w.id)})})]}),v.jsxs("div",{className:"bg-ios-indigo/5 p-6 rounded-2xl border border-ios-indigo/10 flex items-start gap-4",children:[v.jsx(Ns,{className:"w-5 h-5 text-ios-indigo shrink-0 mt-1"}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("h5",{className:"text-[13px] font-black text-ios-indigo",children:""}),v.jsxs("p",{className:"text-[11px] text-ios-indigo/70 font-bold leading-relaxed",children:["       ** **  . ( )",v.jsx("br",{}),"   ,      ."]})]})]})]})}),v.jsx("div",{className:"flex-none p-6 border-t border-gray-100 bg-white/80 backdrop-blur-xl z-20",children:v.jsxs("div",{className:"max-w-3xl mx-auto flex items-center gap-4",children:[v.jsx("button",{onClick:y,disabled:r,className:`flex-1 py-5 rounded-2xl font-black text-base flex items-center justify-center gap-3 transition-all ios-tap shadow-lg ${l?"bg-ios-emerald text-white":"bg-[#1C1C1E] text-white hover:bg-gray-800"}`,children:r?v.jsx("div",{className:"w-5 h-5 border-2 border-white/20 border-t-white rounded-full animate-spin"}):l?v.jsxs(v.Fragment,{children:[v.jsx(Ka,{className:"w-5 h-5"}),"   "]}):v.jsxs(v.Fragment,{children:[v.jsx(vf,{className:"w-5 h-5"}),"  "]})}),i&&v.jsxs("div",{className:"bg-ios-rose/10 text-ios-rose px-6 py-5 rounded-2xl font-black text-sm animate-shake flex items-center gap-2",children:[v.jsx(Ns,{className:"w-4 h-4"})," ",i]})]})})]})};function uY(){const[e,t]=xe.useState(()=>{const ee=sessionStorage.getItem("activeTab");if(ee)return ee;const Q=sessionStorage.getItem("currentUser");if(Q)try{const K=JSON.parse(Q);if(["admin","teacher"].includes(K.role))return"admin"}catch(K){console.error("Failed to parse saved user",K)}return"map"}),[r,n]=xe.useState(()=>sessionStorage.getItem("adminSubTab")||"attendance"),[i,s]=xe.useState(null),[l,o]=xe.useState(()=>{const ee=sessionStorage.getItem("currentUser");return ee?JSON.parse(ee):null}),[a,c]=xe.useState(rt(new Date,"yyyy-MM-dd")),[f,h]=xe.useState(null),[d,u]=xe.useState(()=>{const ee=sessionStorage.getItem("schoolInfo");return ee?JSON.parse(ee):{name:"POGOK",name_en:"POGOK",level:""}}),[p,m]=xe.useState(""),[g,x]=xe.useState([]),[y,w]=xe.useState(null),[b,S]=xe.useState(!1),[T,O]=xe.useState(()=>window.innerWidth<768&&window.innerHeight>window.innerWidth),[j,L]=xe.useState(!1);xe.useEffect(()=>{const ee=()=>{O(window.innerWidth<768&&window.innerHeight>window.innerWidth)};return window.addEventListener("resize",ee),()=>window.removeEventListener("resize",ee)},[]);const W=async ee=>{const Q=ee.trim();if(!Q)return;S(!0);let K=[];try{const{data:N,error:U}=await He.from("profiles_student").select("*").or(`full_name.ilike.%${Q}%,username.ilike.%${Q}%`).limit(50);U?console.error("[Search Error]",U):N&&(K=N.map(R=>({id:R.id,full_name:R.full_name,username:R.username,grade:R.grade||0,class_number:R.class_number||0,student_number:R.student_number||0,role:"student"}))),x(K)}catch(N){console.error("Search Error:",N),x([])}finally{S(!1)}};xe.useEffect(()=>{(async()=>{const{data:Q}=await He.from("configs").select("value").eq("key","school_info").single();Q!=null&&Q.value&&(u(Q.value),sessionStorage.setItem("schoolInfo",JSON.stringify(Q.value)))})()},[]),xe.useEffect(()=>{l?sessionStorage.setItem("currentUser",JSON.stringify(l)):sessionStorage.removeItem("currentUser")},[l]),xe.useEffect(()=>{sessionStorage.setItem("activeTab",e)},[e]),xe.useEffect(()=>{sessionStorage.setItem("adminSubTab",r)},[r]),xe.useEffect(()=>{["currentUser","activeTab","adminSubTab","schoolInfo","schoolName"].forEach(Q=>localStorage.removeItem(Q))},[]);const F=ee=>{h(ee),s(null)},M=()=>{o(null),sessionStorage.removeItem("currentUser"),sessionStorage.removeItem("activeTab"),sessionStorage.removeItem("adminSubTab"),t("map")};if(!l)return v.jsx(nY,{onLoginSuccess:ee=>{o(ee),["admin","teacher"].includes(ee.role)&&t("admin")}});const V=[{id:"admin",icon:pg,label:"/ ",roles:["admin","teacher"]},{id:"map",icon:hd,label:"",roles:["admin","student","parent","teacher"]},{id:"attendance",icon:xf,label:" ",roles:["student"]},{id:"profile",icon:gd,label:"  ",roles:["student","parent"]}].filter(ee=>!ee.roles||ee.roles.includes(l.role)),G=[{group:" ",items:[{id:"attendance",label:"  ",icon:fv,roles:["admin","teacher"]},{id:"attendance_print",label:" ",icon:Fl,roles:["admin","teacher"]},{id:"safety",label:" /",icon:pd,roles:["admin","teacher"]}]},{group:"   ",items:[{id:"zones",label:"  ",icon:V2,roles:["admin"]},{id:"layout",label:"  ",icon:cv,roles:["admin"]},{id:"zone_grades",label:"  ",icon:pd,roles:["admin"]},{id:"students",label:"  ",icon:$d,roles:["admin"]},{id:"schedule",label:"  ",icon:Io,roles:["admin"]}]},{group:" ",items:[{id:"settings",label:" ",icon:pg,roles:["admin"]}]}].map(ee=>({...ee,items:ee.items.filter(Q=>Q.roles.includes(l.role))})).filter(ee=>ee.items.length>0);return["admin","teacher"].includes(l.role),l.role==="teacher"||l.role==="admin"&&T?v.jsx(QX,{onLogout:M,currentUser:l}):l.role==="student"?v.jsx(eY,{onLogout:M,currentUser:l}):l.role==="parent"?v.jsx(iY,{onLogout:M,currentUser:l}):v.jsxs("div",{className:"flex flex-col h-[100dvh] bg-[#F2F2F7] text-[#1C1C1E] overflow-hidden font-sans selection:bg-ios-indigo/10",children:[v.jsxs("header",{className:"glass-header px-4 py-2.5 lg:px-8 flex items-center justify-between shadow-sm",children:[v.jsxs("div",{className:"flex items-center gap-6",children:[v.jsxs("div",{className:"flex items-center gap-3 group cursor-default",children:[v.jsx("div",{className:"w-9 h-9 rounded-apple-md bg-[#1C1C1E] flex items-center justify-center shadow-lg shadow-black/5 group-hover:scale-105 transition-transform",children:v.jsx(hd,{className:"w-5 h-5 text-white"})}),v.jsxs("div",{children:[v.jsx("h1",{className:"text-lg font-black tracking-tighter leading-none text-[#1C1C1E]",children:d.name_en||"GOE"}),v.jsx("p",{className:"text-[9px] font-black text-ios-indigo tracking-widest uppercase opacity-60 mt-1",children:"Study Cafe"})]})]}),v.jsx("nav",{className:"flex items-center gap-1 bg-gray-200/20 backdrop-blur-2xl p-1 rounded-apple-md border border-white/40 ml-4",children:V.map(ee=>v.jsxs("button",{onClick:()=>t(ee.id),className:`flex items-center gap-2 px-5 py-2 rounded-apple-md transition-all duration-300 ios-tap group relative ${e===ee.id?"bg-white shadow-sm text-[#1C1C1E]":"text-[#1C1C1E]/50 hover:text-[#1C1C1E] hover:bg-white/40"}`,children:[v.jsx(ee.icon,{className:`w-4 h-4 transition-all duration-300 ${e===ee.id?"text-ios-indigo":"group-hover:scale-110"}`}),v.jsx("span",{className:"font-black text-[13px]",children:ee.label})]},ee.id))}),e==="map"&&["admin","teacher"].includes(l.role)&&v.jsxs("div",{className:"relative ml-4 z-50",children:[y?v.jsxs("div",{className:"flex items-center gap-3 bg-white px-3 py-1.5 rounded-[12px] border-2 border-ios-indigo/20 shadow-sm animate-fade-in-scale",children:[v.jsxs("div",{className:"flex items-center gap-2 pr-2 border-r border-gray-100",children:[v.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-100 text-gray-700 flex items-center justify-center text-[10px] font-black shadow-sm border border-gray-200",children:y.full_name[0]}),v.jsxs("div",{className:"flex flex-col gap-0.5",children:[v.jsx("span",{className:"text-[12px] font-black text-[#1C1C1E]",children:y.full_name}),v.jsxs("span",{className:"text-[9px] text-gray-500 font-medium",children:["   (",y.username,")"]})]})]}),v.jsxs("button",{onClick:()=>{m(""),x([]),w(null)},className:"flex items-center gap-1.5 bg-gray-50 hover:bg-ios-rose/10 text-gray-500 hover:text-ios-rose px-2 py-1.5 rounded-[8px] transition-all group",children:[v.jsx(nO,{className:"w-3 h-3 group-hover:rotate-180 transition-transform duration-500"}),v.jsx("span",{className:"text-[10px] font-bold",children:"  "})]})]}):v.jsxs("div",{className:"group flex items-center gap-2 bg-gray-50/80 px-3 py-1.5 rounded-[10px] border border-gray-100 backdrop-blur-md transition-all focus-within:bg-white focus-within:shadow-md focus-within:w-72 w-56 focus-within:border-ios-indigo/50",children:[v.jsx(fv,{className:"w-3.5 h-3.5 text-gray-400 group-focus-within:text-ios-indigo transition-colors"}),v.jsx("input",{type:"text",value:p,onChange:ee=>{m(ee.target.value),ee.target.value.length>=1?W(ee.target.value):x([])},placeholder:"  (  )",className:"bg-transparent border-none outline-none text-[12px] font-bold placeholder:text-gray-400 w-full text-gray-700"})]}),g.length>0&&!y&&v.jsx("div",{className:"absolute top-full left-0 mt-2 w-72 bg-white/90 backdrop-blur-xl rounded-[12px] shadow-xl border border-gray-100 overflow-hidden animate-spring-up p-1 z-50",children:g.map(ee=>v.jsxs("button",{onClick:()=>{w(ee),m(""),x([])},className:"w-full text-left px-3 py-2.5 hover:bg-ios-indigo/5 rounded-[8px] transition-colors flex items-center justify-between group border-b border-gray-50 last:border-0",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-8 h-8 rounded-[8px] bg-gray-100 group-hover:bg-white group-hover:shadow-sm flex items-center justify-center text-[10px] font-bold text-gray-500 group-hover:text-ios-indigo transition-all",children:ee.full_name[0]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-[13px] font-bold text-[#1C1C1E] group-hover:text-ios-indigo transition-colors",children:ee.full_name}),v.jsx("div",{className:"text-[10px] text-gray-400 font-mono flex items-center gap-1",children:ee.grade>0&&v.jsxs("span",{children:[ee.grade," ",ee.class_number," ",ee.student_number,""]})})]})]}),v.jsx("div",{className:"text-[10px] bg-gray-50 text-gray-400 px-2 py-1 rounded-[6px] group-hover:bg-ios-indigo group-hover:text-white transition-colors font-bold",children:""})]},ee.id))})]})]}),v.jsxs("div",{className:"flex items-center gap-7",children:[v.jsxs("div",{className:"flex items-center gap-3 bg-gray-200/20 p-1 px-4 py-2 rounded-apple-md border border-white/40 backdrop-blur-lg",children:[v.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-white/50 border border-white flex items-center justify-center shadow-sm",children:v.jsx(gd,{className:"w-4 h-4 text-ios-indigo"})}),v.jsxs("div",{className:"text-left",children:[v.jsx("p",{className:"text-[13px] font-black leading-none text-[#1C1C1E] uppercase",children:l==null?void 0:l.full_name}),v.jsx("p",{className:"text-[9px] font-black text-ios-indigo tracking-widest mt-1 uppercase opacity-60 italic",children:l==null?void 0:l.role})]})]}),v.jsxs("button",{onClick:M,className:"flex items-center gap-2 p-2 px-5 rounded-apple-md text-ios-gray hover:text-ios-rose hover:bg-ios-rose/5 transition-all ios-tap border border-transparent hover:border-ios-rose/10 group",children:[v.jsx(fd,{className:"w-4 h-4 group-hover:-translate-x-0.5 transition-transform"}),v.jsx("span",{className:"font-bold text-[13px]",children:""})]})]})]}),v.jsx("main",{className:"flex-1 h-full flex overflow-hidden relative",children:e==="admin"?v.jsxs("div",{className:"flex-1 flex overflow-hidden w-full",children:[v.jsxs("aside",{className:"w-64 glass-material flex flex-col p-6 shrink-0 z-30 shadow-[4px_0_40px_rgba(0,0,0,0.02)] translate-x-0",children:[v.jsx("div",{className:"flex-1 space-y-9",children:G.map((ee,Q)=>v.jsxs("div",{className:"space-y-4",children:[v.jsx("h5",{className:"text-[10px] font-black text-ios-gray/60 uppercase tracking-[0.25em] px-3",children:ee.group}),v.jsx("div",{className:"space-y-1.5",children:ee.items.map(K=>v.jsxs("button",{onClick:()=>n(K.id),className:`w-full flex items-center gap-3.5 px-3 py-3 rounded-apple-md text-[13.5px] font-bold transition-all ios-tap group ${r===K.id?"bg-white shadow-sm text-[#1C1C1E]":"text-ios-gray hover:text-[#1C1C1E] hover:bg-white/40"}`,children:[v.jsx(K.icon,{className:`w-4 h-4 ${r===K.id?"text-ios-indigo":"text-ios-gray/50 group-hover:text-ios-indigo transition-colors"}`}),K.label]},K.id))})]},Q))}),v.jsx("div",{className:"pt-6 border-t border-gray-50",children:v.jsx("p",{className:"text-[8px] font-bold text-gray-300 tracking-tighter uppercase italic",children:"Copyright murmurgene 2026. All rights reserved."})})]}),v.jsx("div",{className:"flex-1 bg-[#F2F2F7] p-6 overflow-hidden",children:v.jsx("div",{className:"h-full w-full rounded-2xl overflow-hidden shadow-sm border border-black/5 bg-white",children:r==="zones"?v.jsx(lY,{}):r==="zone_grades"?v.jsx(cY,{}):r==="layout"?v.jsx(dF,{}):r==="attendance"?v.jsx(yT,{}):r==="attendance_print"?v.jsx(oY,{}):r==="students"?v.jsx(rY,{}):r==="schedule"?v.jsx(sY,{}):r==="settings"?v.jsx(aY,{}):v.jsx(KX,{})})})]}):v.jsx("div",{className:"flex-1 h-full flex flex-col overflow-hidden p-6",children:e==="attendance"?v.jsx("div",{className:"h-full flex flex-col items-center justify-center",children:v.jsx(MT,{})}):e==="profile"?v.jsx("div",{className:"h-full overflow-y-auto scrollbar-hide",children:v.jsx(RT,{})}):v.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden pt-2",children:[v.jsxs("section",{className:"flex-1 flex flex-col xl:flex-row gap-6 leading-normal overflow-hidden h-full",children:[v.jsx("div",{className:"flex-1 flex flex-col overflow-hidden h-full",children:v.jsx("div",{className:"flex-1 w-full glass-card overflow-hidden p-2 shadow-sm h-full",children:v.jsx(LT,{onSelectSeat:s,selectedProxyUser:y,viewDate:a,onDateChange:c,selectedZoneId:f,onZoneChange:F})})}),v.jsx("div",{className:"xl:w-[340px] h-full overflow-y-auto scrollbar-hide glass-card shadow-sm",children:v.jsx(tY,{selectedSeat:i,onComplete:()=>s(null),targetUser:y,loggedInUser:l,initialDate:a,onDateChange:c,currentZoneId:f,onOpenSeatModal:()=>L(!0)})})]}),v.jsx(IT,{isOpen:j,onClose:()=>L(!1),zoneId:f,onSelect:ee=>{s(ee),L(!1)},selectedDate:Cr(a)})]})})})]})}class fY extends cf.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){this.setState({error:t,errorInfo:r}),console.error("Uncaught error:",t,r)}render(){return this.state.hasError?v.jsxs("div",{className:"p-8 bg-white h-[100dvh] w-full flex flex-col items-center justify-center text-[#1C1C1E]",children:[v.jsx("h1",{className:"text-2xl font-black mb-4 text-ios-rose",children:"Application Crash"}),v.jsxs("pre",{className:"bg-gray-100 p-4 rounded text-xs overflow-auto max-w-full",children:[this.state.error&&this.state.error.toString(),v.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]}),v.jsx("button",{onClick:()=>window.location.reload(),className:"mt-6 px-6 py-3 bg-[#1C1C1E] text-white rounded-[6px] font-black",children:"Reload Application"})]}):this.props.children}}px.createRoot(document.getElementById("root")).render(v.jsx(cf.StrictMode,{children:v.jsx(fY,{children:v.jsx(uY,{})})}));export{Er as _,dY as c,SN as g};
