var o2=Object.defineProperty;var l2=(e,t,r)=>t in e?o2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Ue=(e,t,r)=>l2(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function c2(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function u2(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var Bx={exports:{}},Yu={},Ux={exports:{}},at={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $l=Symbol.for("react.element"),f2=Symbol.for("react.portal"),h2=Symbol.for("react.fragment"),d2=Symbol.for("react.strict_mode"),p2=Symbol.for("react.profiler"),g2=Symbol.for("react.provider"),m2=Symbol.for("react.context"),x2=Symbol.for("react.forward_ref"),v2=Symbol.for("react.suspense"),y2=Symbol.for("react.memo"),w2=Symbol.for("react.lazy"),Wp=Symbol.iterator;function _2(e){return e===null||typeof e!="object"?null:(e=Wp&&e[Wp]||e["@@iterator"],typeof e=="function"?e:null)}var Wx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},zx=Object.assign,Hx={};function no(e,t,r){this.props=e,this.context=t,this.refs=Hx,this.updater=r||Wx}no.prototype.isReactComponent={};no.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};no.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function $x(){}$x.prototype=no.prototype;function qd(e,t,r){this.props=e,this.context=t,this.refs=Hx,this.updater=r||Wx}var Kd=qd.prototype=new $x;Kd.constructor=qd;zx(Kd,no.prototype);Kd.isPureReactComponent=!0;var zp=Array.isArray,Vx=Object.prototype.hasOwnProperty,Jd={current:null},Xx={key:!0,ref:!0,__self:!0,__source:!0};function Yx(e,t,r){var n,i={},s=null,l=null;if(t!=null)for(n in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(s=""+t.key),t)Vx.call(t,n)&&!Xx.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var a=Array(o),c=0;c<o;c++)a[c]=arguments[c+2];i.children=a}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:$l,type:e,key:s,ref:l,props:i,_owner:Jd.current}}function b2(e,t){return{$$typeof:$l,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Qd(e){return typeof e=="object"&&e!==null&&e.$$typeof===$l}function k2(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Hp=/\/+/g;function Af(e,t){return typeof e=="object"&&e!==null&&e.key!=null?k2(""+e.key):t.toString(36)}function zc(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case $l:case f2:l=!0}}if(l)return l=e,i=i(l),e=n===""?"."+Af(l,0):n,zp(i)?(r="",e!=null&&(r=e.replace(Hp,"$&/")+"/"),zc(i,t,r,"",function(c){return c})):i!=null&&(Qd(i)&&(i=b2(i,r+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(Hp,"$&/")+"/")+e)),t.push(i)),1;if(l=0,n=n===""?".":n+":",zp(e))for(var o=0;o<e.length;o++){s=e[o];var a=n+Af(s,o);l+=zc(s,t,r,a,i)}else if(a=_2(e),typeof a=="function")for(e=a.call(e),o=0;!(s=e.next()).done;)s=s.value,a=n+Af(s,o++),l+=zc(s,t,r,a,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function oc(e,t,r){if(e==null)return e;var n=[],i=0;return zc(e,n,"","",function(s){return t.call(r,s,i++)}),n}function S2(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Wr={current:null},Hc={transition:null},C2={ReactCurrentDispatcher:Wr,ReactCurrentBatchConfig:Hc,ReactCurrentOwner:Jd};function Gx(){throw Error("act(...) is not supported in production builds of React.")}at.Children={map:oc,forEach:function(e,t,r){oc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return oc(e,function(){t++}),t},toArray:function(e){return oc(e,function(t){return t})||[]},only:function(e){if(!Qd(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};at.Component=no;at.Fragment=h2;at.Profiler=p2;at.PureComponent=qd;at.StrictMode=d2;at.Suspense=v2;at.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=C2;at.act=Gx;at.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=zx({},e.props),i=e.key,s=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,l=Jd.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(a in t)Vx.call(t,a)&&!Xx.hasOwnProperty(a)&&(n[a]=t[a]===void 0&&o!==void 0?o[a]:t[a])}var a=arguments.length-2;if(a===1)n.children=r;else if(1<a){o=Array(a);for(var c=0;c<a;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:$l,type:e.type,key:i,ref:s,props:n,_owner:l}};at.createContext=function(e){return e={$$typeof:m2,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:g2,_context:e},e.Consumer=e};at.createElement=Yx;at.createFactory=function(e){var t=Yx.bind(null,e);return t.type=e,t};at.createRef=function(){return{current:null}};at.forwardRef=function(e){return{$$typeof:x2,render:e}};at.isValidElement=Qd;at.lazy=function(e){return{$$typeof:w2,_payload:{_status:-1,_result:e},_init:S2}};at.memo=function(e,t){return{$$typeof:y2,type:e,compare:t===void 0?null:t}};at.startTransition=function(e){var t=Hc.transition;Hc.transition={};try{e()}finally{Hc.transition=t}};at.unstable_act=Gx;at.useCallback=function(e,t){return Wr.current.useCallback(e,t)};at.useContext=function(e){return Wr.current.useContext(e)};at.useDebugValue=function(){};at.useDeferredValue=function(e){return Wr.current.useDeferredValue(e)};at.useEffect=function(e,t){return Wr.current.useEffect(e,t)};at.useId=function(){return Wr.current.useId()};at.useImperativeHandle=function(e,t,r){return Wr.current.useImperativeHandle(e,t,r)};at.useInsertionEffect=function(e,t){return Wr.current.useInsertionEffect(e,t)};at.useLayoutEffect=function(e,t){return Wr.current.useLayoutEffect(e,t)};at.useMemo=function(e,t){return Wr.current.useMemo(e,t)};at.useReducer=function(e,t,r){return Wr.current.useReducer(e,t,r)};at.useRef=function(e){return Wr.current.useRef(e)};at.useState=function(e){return Wr.current.useState(e)};at.useSyncExternalStore=function(e,t,r){return Wr.current.useSyncExternalStore(e,t,r)};at.useTransition=function(){return Wr.current.useTransition()};at.version="18.3.1";Ux.exports=at;var ne=Ux.exports;const tu=c2(ne);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T2=ne,E2=Symbol.for("react.element"),N2=Symbol.for("react.fragment"),A2=Object.prototype.hasOwnProperty,O2=T2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,F2={key:!0,ref:!0,__self:!0,__source:!0};function qx(e,t,r){var n,i={},s=null,l=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)A2.call(t,n)&&!F2.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:E2,type:e,key:s,ref:l,props:i,_owner:O2.current}}Yu.Fragment=N2;Yu.jsx=qx;Yu.jsxs=qx;Bx.exports=Yu;var v=Bx.exports,Th={},Kx={exports:{}},cn={},Jx={exports:{}},Qx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Z,C){var L=Z.length;Z.push(C);e:for(;0<L;){var B=L-1>>>1,N=Z[B];if(0<i(N,C))Z[B]=C,Z[L]=N,L=B;else break e}}function r(Z){return Z.length===0?null:Z[0]}function n(Z){if(Z.length===0)return null;var C=Z[0],L=Z.pop();if(L!==C){Z[0]=L;e:for(var B=0,N=Z.length,U=N>>>1;B<U;){var A=2*(B+1)-1,T=Z[A],j=A+1,M=Z[j];if(0>i(T,L))j<N&&0>i(M,T)?(Z[B]=M,Z[j]=L,B=j):(Z[B]=T,Z[A]=L,B=A);else if(j<N&&0>i(M,L))Z[B]=M,Z[j]=L,B=j;else break e}}return C}function i(Z,C){var L=Z.sortIndex-C.sortIndex;return L!==0?L:Z.id-C.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var a=[],c=[],d=1,h=null,f=3,u=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(Z){for(var C=r(c);C!==null;){if(C.callback===null)n(c);else if(C.startTime<=Z)n(c),C.sortIndex=C.expirationTime,t(a,C);else break;C=r(c)}}function _(Z){if(m=!1,w(Z),!p)if(r(a)!==null)p=!0,ae(b);else{var C=r(c);C!==null&&le(_,C.startTime-Z)}}function b(Z,C){p=!1,m&&(m=!1,x(E),E=-1),u=!0;var L=f;try{for(w(C),h=r(a);h!==null&&(!(h.expirationTime>C)||Z&&!D());){var B=h.callback;if(typeof B=="function"){h.callback=null,f=h.priorityLevel;var N=B(h.expirationTime<=C);C=e.unstable_now(),typeof N=="function"?h.callback=N:h===r(a)&&n(a),w(C)}else n(a);h=r(a)}if(h!==null)var U=!0;else{var A=r(c);A!==null&&le(_,A.startTime-C),U=!1}return U}finally{h=null,f=L,u=!1}}var k=!1,S=null,E=-1,F=5,P=-1;function D(){return!(e.unstable_now()-P<F)}function I(){if(S!==null){var Z=e.unstable_now();P=Z;var C=!0;try{C=S(!0,Z)}finally{C?X():(k=!1,S=null)}}else k=!1}var X;if(typeof y=="function")X=function(){y(I)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,G=z.port2;z.port1.onmessage=I,X=function(){G.postMessage(null)}}else X=function(){g(I,0)};function ae(Z){S=Z,k||(k=!0,X())}function le(Z,C){E=g(function(){Z(e.unstable_now())},C)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Z){Z.callback=null},e.unstable_continueExecution=function(){p||u||(p=!0,ae(b))},e.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<Z?Math.floor(1e3/Z):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(a)},e.unstable_next=function(Z){switch(f){case 1:case 2:case 3:var C=3;break;default:C=f}var L=f;f=C;try{return Z()}finally{f=L}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Z,C){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var L=f;f=Z;try{return C()}finally{f=L}},e.unstable_scheduleCallback=function(Z,C,L){var B=e.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?B+L:B):L=B,Z){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=L+N,Z={id:d++,callback:C,priorityLevel:Z,startTime:L,expirationTime:N,sortIndex:-1},L>B?(Z.sortIndex=L,t(c,Z),r(a)===null&&Z===r(c)&&(m?(x(E),E=-1):m=!0,le(_,L-B))):(Z.sortIndex=N,t(a,Z),p||u||(p=!0,ae(b))),Z},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(Z){var C=f;return function(){var L=f;f=C;try{return Z.apply(this,arguments)}finally{f=L}}}})(Qx);Jx.exports=Qx;var j2=Jx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P2=ne,on=j2;function Fe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Zx=new Set,rl={};function Ys(e,t){Va(e,t),Va(e+"Capture",t)}function Va(e,t){for(rl[e]=t,e=0;e<t.length;e++)Zx.add(t[e])}var vi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Eh=Object.prototype.hasOwnProperty,D2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$p={},Vp={};function R2(e){return Eh.call(Vp,e)?!0:Eh.call($p,e)?!1:D2.test(e)?Vp[e]=!0:($p[e]=!0,!1)}function I2(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function M2(e,t,r,n){if(t===null||typeof t>"u"||I2(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function zr(e,t,r,n,i,s,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=l}var br={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){br[e]=new zr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];br[t]=new zr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){br[e]=new zr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){br[e]=new zr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){br[e]=new zr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){br[e]=new zr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){br[e]=new zr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){br[e]=new zr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){br[e]=new zr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Zd=/[\-:]([a-z])/g;function e0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Zd,e0);br[t]=new zr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Zd,e0);br[t]=new zr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Zd,e0);br[t]=new zr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){br[e]=new zr(e,1,!1,e.toLowerCase(),null,!1,!1)});br.xlinkHref=new zr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){br[e]=new zr(e,1,!1,e.toLowerCase(),null,!0,!0)});function t0(e,t,r,n){var i=br.hasOwnProperty(t)?br[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(M2(t,r,i,n)&&(r=null),n||i===null?R2(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Si=P2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,lc=Symbol.for("react.element"),ya=Symbol.for("react.portal"),wa=Symbol.for("react.fragment"),r0=Symbol.for("react.strict_mode"),Nh=Symbol.for("react.profiler"),e1=Symbol.for("react.provider"),t1=Symbol.for("react.context"),n0=Symbol.for("react.forward_ref"),Ah=Symbol.for("react.suspense"),Oh=Symbol.for("react.suspense_list"),i0=Symbol.for("react.memo"),ji=Symbol.for("react.lazy"),r1=Symbol.for("react.offscreen"),Xp=Symbol.iterator;function go(e){return e===null||typeof e!="object"?null:(e=Xp&&e[Xp]||e["@@iterator"],typeof e=="function"?e:null)}var Mt=Object.assign,Of;function Eo(e){if(Of===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Of=t&&t[1]||""}return`
`+Of+e}var Ff=!1;function jf(e,t){if(!e||Ff)return"";Ff=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),l=i.length-1,o=s.length-1;1<=l&&0<=o&&i[l]!==s[o];)o--;for(;1<=l&&0<=o;l--,o--)if(i[l]!==s[o]){if(l!==1||o!==1)do if(l--,o--,0>o||i[l]!==s[o]){var a=`
`+i[l].replace(" at new "," at ");return e.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",e.displayName)),a}while(1<=l&&0<=o);break}}}finally{Ff=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Eo(e):""}function L2(e){switch(e.tag){case 5:return Eo(e.type);case 16:return Eo("Lazy");case 13:return Eo("Suspense");case 19:return Eo("SuspenseList");case 0:case 2:case 15:return e=jf(e.type,!1),e;case 11:return e=jf(e.type.render,!1),e;case 1:return e=jf(e.type,!0),e;default:return""}}function Fh(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case wa:return"Fragment";case ya:return"Portal";case Nh:return"Profiler";case r0:return"StrictMode";case Ah:return"Suspense";case Oh:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case t1:return(e.displayName||"Context")+".Consumer";case e1:return(e._context.displayName||"Context")+".Provider";case n0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case i0:return t=e.displayName||null,t!==null?t:Fh(e.type)||"Memo";case ji:t=e._payload,e=e._init;try{return Fh(e(t))}catch{}}return null}function B2(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fh(t);case 8:return t===r0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Qi(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function n1(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function U2(e){var t=n1(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(l){n=""+l,s.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function cc(e){e._valueTracker||(e._valueTracker=U2(e))}function i1(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=n1(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function ru(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function jh(e,t){var r=t.checked;return Mt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Yp(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Qi(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function s1(e,t){t=t.checked,t!=null&&t0(e,"checked",t,!1)}function Ph(e,t){s1(e,t);var r=Qi(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Dh(e,t.type,r):t.hasOwnProperty("defaultValue")&&Dh(e,t.type,Qi(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Gp(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Dh(e,t,r){(t!=="number"||ru(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var No=Array.isArray;function Pa(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Qi(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Rh(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Fe(91));return Mt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function qp(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Fe(92));if(No(r)){if(1<r.length)throw Error(Fe(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Qi(r)}}function a1(e,t){var r=Qi(t.value),n=Qi(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Kp(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function o1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ih(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?o1(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var uc,l1=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(uc=uc||document.createElement("div"),uc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=uc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function nl(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Io={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},W2=["Webkit","ms","Moz","O"];Object.keys(Io).forEach(function(e){W2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Io[t]=Io[e]})});function c1(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Io.hasOwnProperty(e)&&Io[e]?(""+t).trim():t+"px"}function u1(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=c1(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var z2=Mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Mh(e,t){if(t){if(z2[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Fe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Fe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Fe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Fe(62))}}function Lh(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bh=null;function s0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Uh=null,Da=null,Ra=null;function Jp(e){if(e=Yl(e)){if(typeof Uh!="function")throw Error(Fe(280));var t=e.stateNode;t&&(t=Qu(t),Uh(e.stateNode,e.type,t))}}function f1(e){Da?Ra?Ra.push(e):Ra=[e]:Da=e}function h1(){if(Da){var e=Da,t=Ra;if(Ra=Da=null,Jp(e),t)for(e=0;e<t.length;e++)Jp(t[e])}}function d1(e,t){return e(t)}function p1(){}var Pf=!1;function g1(e,t,r){if(Pf)return e(t,r);Pf=!0;try{return d1(e,t,r)}finally{Pf=!1,(Da!==null||Ra!==null)&&(p1(),h1())}}function il(e,t){var r=e.stateNode;if(r===null)return null;var n=Qu(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Fe(231,t,typeof r));return r}var Wh=!1;if(vi)try{var mo={};Object.defineProperty(mo,"passive",{get:function(){Wh=!0}}),window.addEventListener("test",mo,mo),window.removeEventListener("test",mo,mo)}catch{Wh=!1}function H2(e,t,r,n,i,s,l,o,a){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var Mo=!1,nu=null,iu=!1,zh=null,$2={onError:function(e){Mo=!0,nu=e}};function V2(e,t,r,n,i,s,l,o,a){Mo=!1,nu=null,H2.apply($2,arguments)}function X2(e,t,r,n,i,s,l,o,a){if(V2.apply(this,arguments),Mo){if(Mo){var c=nu;Mo=!1,nu=null}else throw Error(Fe(198));iu||(iu=!0,zh=c)}}function Gs(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function m1(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Qp(e){if(Gs(e)!==e)throw Error(Fe(188))}function Y2(e){var t=e.alternate;if(!t){if(t=Gs(e),t===null)throw Error(Fe(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Qp(i),e;if(s===n)return Qp(i),t;s=s.sibling}throw Error(Fe(188))}if(r.return!==n.return)r=i,n=s;else{for(var l=!1,o=i.child;o;){if(o===r){l=!0,r=i,n=s;break}if(o===n){l=!0,n=i,r=s;break}o=o.sibling}if(!l){for(o=s.child;o;){if(o===r){l=!0,r=s,n=i;break}if(o===n){l=!0,n=s,r=i;break}o=o.sibling}if(!l)throw Error(Fe(189))}}if(r.alternate!==n)throw Error(Fe(190))}if(r.tag!==3)throw Error(Fe(188));return r.stateNode.current===r?e:t}function x1(e){return e=Y2(e),e!==null?v1(e):null}function v1(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=v1(e);if(t!==null)return t;e=e.sibling}return null}var y1=on.unstable_scheduleCallback,Zp=on.unstable_cancelCallback,G2=on.unstable_shouldYield,q2=on.unstable_requestPaint,Vt=on.unstable_now,K2=on.unstable_getCurrentPriorityLevel,a0=on.unstable_ImmediatePriority,w1=on.unstable_UserBlockingPriority,su=on.unstable_NormalPriority,J2=on.unstable_LowPriority,_1=on.unstable_IdlePriority,Gu=null,Zn=null;function Q2(e){if(Zn&&typeof Zn.onCommitFiberRoot=="function")try{Zn.onCommitFiberRoot(Gu,e,void 0,(e.current.flags&128)===128)}catch{}}var Mn=Math.clz32?Math.clz32:tb,Z2=Math.log,eb=Math.LN2;function tb(e){return e>>>=0,e===0?32:31-(Z2(e)/eb|0)|0}var fc=64,hc=4194304;function Ao(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function au(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~i;o!==0?n=Ao(o):(s&=l,s!==0&&(n=Ao(s)))}else l=r&~i,l!==0?n=Ao(l):s!==0&&(n=Ao(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Mn(t),i=1<<r,n|=e[r],t&=~i;return n}function rb(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nb(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var l=31-Mn(s),o=1<<l,a=i[l];a===-1?(!(o&r)||o&n)&&(i[l]=rb(o,t)):a<=t&&(e.expiredLanes|=o),s&=~o}}function Hh(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function b1(){var e=fc;return fc<<=1,!(fc&4194240)&&(fc=64),e}function Df(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Vl(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Mn(t),e[t]=r}function ib(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Mn(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function o0(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Mn(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var mt=0;function k1(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var S1,l0,C1,T1,E1,$h=!1,dc=[],zi=null,Hi=null,$i=null,sl=new Map,al=new Map,Ri=[],sb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function eg(e,t){switch(e){case"focusin":case"focusout":zi=null;break;case"dragenter":case"dragleave":Hi=null;break;case"mouseover":case"mouseout":$i=null;break;case"pointerover":case"pointerout":sl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":al.delete(t.pointerId)}}function xo(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=Yl(t),t!==null&&l0(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function ab(e,t,r,n,i){switch(t){case"focusin":return zi=xo(zi,e,t,r,n,i),!0;case"dragenter":return Hi=xo(Hi,e,t,r,n,i),!0;case"mouseover":return $i=xo($i,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return sl.set(s,xo(sl.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,al.set(s,xo(al.get(s)||null,e,t,r,n,i)),!0}return!1}function N1(e){var t=bs(e.target);if(t!==null){var r=Gs(t);if(r!==null){if(t=r.tag,t===13){if(t=m1(r),t!==null){e.blockedOn=t,E1(e.priority,function(){C1(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function $c(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Vh(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Bh=n,r.target.dispatchEvent(n),Bh=null}else return t=Yl(r),t!==null&&l0(t),e.blockedOn=r,!1;t.shift()}return!0}function tg(e,t,r){$c(e)&&r.delete(t)}function ob(){$h=!1,zi!==null&&$c(zi)&&(zi=null),Hi!==null&&$c(Hi)&&(Hi=null),$i!==null&&$c($i)&&($i=null),sl.forEach(tg),al.forEach(tg)}function vo(e,t){e.blockedOn===t&&(e.blockedOn=null,$h||($h=!0,on.unstable_scheduleCallback(on.unstable_NormalPriority,ob)))}function ol(e){function t(i){return vo(i,e)}if(0<dc.length){vo(dc[0],e);for(var r=1;r<dc.length;r++){var n=dc[r];n.blockedOn===e&&(n.blockedOn=null)}}for(zi!==null&&vo(zi,e),Hi!==null&&vo(Hi,e),$i!==null&&vo($i,e),sl.forEach(t),al.forEach(t),r=0;r<Ri.length;r++)n=Ri[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Ri.length&&(r=Ri[0],r.blockedOn===null);)N1(r),r.blockedOn===null&&Ri.shift()}var Ia=Si.ReactCurrentBatchConfig,ou=!0;function lb(e,t,r,n){var i=mt,s=Ia.transition;Ia.transition=null;try{mt=1,c0(e,t,r,n)}finally{mt=i,Ia.transition=s}}function cb(e,t,r,n){var i=mt,s=Ia.transition;Ia.transition=null;try{mt=4,c0(e,t,r,n)}finally{mt=i,Ia.transition=s}}function c0(e,t,r,n){if(ou){var i=Vh(e,t,r,n);if(i===null)$f(e,t,n,lu,r),eg(e,n);else if(ab(i,e,t,r,n))n.stopPropagation();else if(eg(e,n),t&4&&-1<sb.indexOf(e)){for(;i!==null;){var s=Yl(i);if(s!==null&&S1(s),s=Vh(e,t,r,n),s===null&&$f(e,t,n,lu,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else $f(e,t,n,null,r)}}var lu=null;function Vh(e,t,r,n){if(lu=null,e=s0(n),e=bs(e),e!==null)if(t=Gs(e),t===null)e=null;else if(r=t.tag,r===13){if(e=m1(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return lu=e,null}function A1(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(K2()){case a0:return 1;case w1:return 4;case su:case J2:return 16;case _1:return 536870912;default:return 16}default:return 16}}var Li=null,u0=null,Vc=null;function O1(){if(Vc)return Vc;var e,t=u0,r=t.length,n,i="value"in Li?Li.value:Li.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var l=r-e;for(n=1;n<=l&&t[r-n]===i[s-n];n++);return Vc=i.slice(e,1<n?1-n:void 0)}function Xc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function pc(){return!0}function rg(){return!1}function un(e){function t(r,n,i,s,l){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?pc:rg,this.isPropagationStopped=rg,this}return Mt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=pc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=pc)},persist:function(){},isPersistent:pc}),t}var io={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},f0=un(io),Xl=Mt({},io,{view:0,detail:0}),ub=un(Xl),Rf,If,yo,qu=Mt({},Xl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:h0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yo&&(yo&&e.type==="mousemove"?(Rf=e.screenX-yo.screenX,If=e.screenY-yo.screenY):If=Rf=0,yo=e),Rf)},movementY:function(e){return"movementY"in e?e.movementY:If}}),ng=un(qu),fb=Mt({},qu,{dataTransfer:0}),hb=un(fb),db=Mt({},Xl,{relatedTarget:0}),Mf=un(db),pb=Mt({},io,{animationName:0,elapsedTime:0,pseudoElement:0}),gb=un(pb),mb=Mt({},io,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),xb=un(mb),vb=Mt({},io,{data:0}),ig=un(vb),yb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_b={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bb(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=_b[e])?!!t[e]:!1}function h0(){return bb}var kb=Mt({},Xl,{key:function(e){if(e.key){var t=yb[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Xc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?wb[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:h0,charCode:function(e){return e.type==="keypress"?Xc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Xc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Sb=un(kb),Cb=Mt({},qu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sg=un(Cb),Tb=Mt({},Xl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:h0}),Eb=un(Tb),Nb=Mt({},io,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ab=un(Nb),Ob=Mt({},qu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Fb=un(Ob),jb=[9,13,27,32],d0=vi&&"CompositionEvent"in window,Lo=null;vi&&"documentMode"in document&&(Lo=document.documentMode);var Pb=vi&&"TextEvent"in window&&!Lo,F1=vi&&(!d0||Lo&&8<Lo&&11>=Lo),ag=" ",og=!1;function j1(e,t){switch(e){case"keyup":return jb.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function P1(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var _a=!1;function Db(e,t){switch(e){case"compositionend":return P1(t);case"keypress":return t.which!==32?null:(og=!0,ag);case"textInput":return e=t.data,e===ag&&og?null:e;default:return null}}function Rb(e,t){if(_a)return e==="compositionend"||!d0&&j1(e,t)?(e=O1(),Vc=u0=Li=null,_a=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return F1&&t.locale!=="ko"?null:t.data;default:return null}}var Ib={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Ib[e.type]:t==="textarea"}function D1(e,t,r,n){f1(n),t=cu(t,"onChange"),0<t.length&&(r=new f0("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Bo=null,ll=null;function Mb(e){V1(e,0)}function Ku(e){var t=Sa(e);if(i1(t))return e}function Lb(e,t){if(e==="change")return t}var R1=!1;if(vi){var Lf;if(vi){var Bf="oninput"in document;if(!Bf){var cg=document.createElement("div");cg.setAttribute("oninput","return;"),Bf=typeof cg.oninput=="function"}Lf=Bf}else Lf=!1;R1=Lf&&(!document.documentMode||9<document.documentMode)}function ug(){Bo&&(Bo.detachEvent("onpropertychange",I1),ll=Bo=null)}function I1(e){if(e.propertyName==="value"&&Ku(ll)){var t=[];D1(t,ll,e,s0(e)),g1(Mb,t)}}function Bb(e,t,r){e==="focusin"?(ug(),Bo=t,ll=r,Bo.attachEvent("onpropertychange",I1)):e==="focusout"&&ug()}function Ub(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ku(ll)}function Wb(e,t){if(e==="click")return Ku(t)}function zb(e,t){if(e==="input"||e==="change")return Ku(t)}function Hb(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Wn=typeof Object.is=="function"?Object.is:Hb;function cl(e,t){if(Wn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Eh.call(t,i)||!Wn(e[i],t[i]))return!1}return!0}function fg(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hg(e,t){var r=fg(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=fg(r)}}function M1(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?M1(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function L1(){for(var e=window,t=ru();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=ru(e.document)}return t}function p0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function $b(e){var t=L1(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&M1(r.ownerDocument.documentElement,r)){if(n!==null&&p0(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=hg(r,s);var l=hg(r,n);i&&l&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Vb=vi&&"documentMode"in document&&11>=document.documentMode,ba=null,Xh=null,Uo=null,Yh=!1;function dg(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Yh||ba==null||ba!==ru(n)||(n=ba,"selectionStart"in n&&p0(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Uo&&cl(Uo,n)||(Uo=n,n=cu(Xh,"onSelect"),0<n.length&&(t=new f0("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=ba)))}function gc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var ka={animationend:gc("Animation","AnimationEnd"),animationiteration:gc("Animation","AnimationIteration"),animationstart:gc("Animation","AnimationStart"),transitionend:gc("Transition","TransitionEnd")},Uf={},B1={};vi&&(B1=document.createElement("div").style,"AnimationEvent"in window||(delete ka.animationend.animation,delete ka.animationiteration.animation,delete ka.animationstart.animation),"TransitionEvent"in window||delete ka.transitionend.transition);function Ju(e){if(Uf[e])return Uf[e];if(!ka[e])return e;var t=ka[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in B1)return Uf[e]=t[r];return e}var U1=Ju("animationend"),W1=Ju("animationiteration"),z1=Ju("animationstart"),H1=Ju("transitionend"),$1=new Map,pg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function as(e,t){$1.set(e,t),Ys(t,[e])}for(var Wf=0;Wf<pg.length;Wf++){var zf=pg[Wf],Xb=zf.toLowerCase(),Yb=zf[0].toUpperCase()+zf.slice(1);as(Xb,"on"+Yb)}as(U1,"onAnimationEnd");as(W1,"onAnimationIteration");as(z1,"onAnimationStart");as("dblclick","onDoubleClick");as("focusin","onFocus");as("focusout","onBlur");as(H1,"onTransitionEnd");Va("onMouseEnter",["mouseout","mouseover"]);Va("onMouseLeave",["mouseout","mouseover"]);Va("onPointerEnter",["pointerout","pointerover"]);Va("onPointerLeave",["pointerout","pointerover"]);Ys("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ys("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ys("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ys("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ys("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ys("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Gb=new Set("cancel close invalid load scroll toggle".split(" ").concat(Oo));function gg(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,X2(n,t,void 0,e),e.currentTarget=null}function V1(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var l=n.length-1;0<=l;l--){var o=n[l],a=o.instance,c=o.currentTarget;if(o=o.listener,a!==s&&i.isPropagationStopped())break e;gg(i,o,c),s=a}else for(l=0;l<n.length;l++){if(o=n[l],a=o.instance,c=o.currentTarget,o=o.listener,a!==s&&i.isPropagationStopped())break e;gg(i,o,c),s=a}}}if(iu)throw e=zh,iu=!1,zh=null,e}function _t(e,t){var r=t[Qh];r===void 0&&(r=t[Qh]=new Set);var n=e+"__bubble";r.has(n)||(X1(t,e,2,!1),r.add(n))}function Hf(e,t,r){var n=0;t&&(n|=4),X1(r,e,n,t)}var mc="_reactListening"+Math.random().toString(36).slice(2);function ul(e){if(!e[mc]){e[mc]=!0,Zx.forEach(function(r){r!=="selectionchange"&&(Gb.has(r)||Hf(r,!1,e),Hf(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[mc]||(t[mc]=!0,Hf("selectionchange",!1,t))}}function X1(e,t,r,n){switch(A1(t)){case 1:var i=lb;break;case 4:i=cb;break;default:i=c0}r=i.bind(null,t,r,e),i=void 0,!Wh||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function $f(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(l===4)for(l=n.return;l!==null;){var a=l.tag;if((a===3||a===4)&&(a=l.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;l=l.return}for(;o!==null;){if(l=bs(o),l===null)return;if(a=l.tag,a===5||a===6){n=s=l;continue e}o=o.parentNode}}n=n.return}g1(function(){var c=s,d=s0(r),h=[];e:{var f=$1.get(e);if(f!==void 0){var u=f0,p=e;switch(e){case"keypress":if(Xc(r)===0)break e;case"keydown":case"keyup":u=Sb;break;case"focusin":p="focus",u=Mf;break;case"focusout":p="blur",u=Mf;break;case"beforeblur":case"afterblur":u=Mf;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=ng;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=hb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Eb;break;case U1:case W1:case z1:u=gb;break;case H1:u=Ab;break;case"scroll":u=ub;break;case"wheel":u=Fb;break;case"copy":case"cut":case"paste":u=xb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=sg}var m=(t&4)!==0,g=!m&&e==="scroll",x=m?f!==null?f+"Capture":null:f;m=[];for(var y=c,w;y!==null;){w=y;var _=w.stateNode;if(w.tag===5&&_!==null&&(w=_,x!==null&&(_=il(y,x),_!=null&&m.push(fl(y,_,w)))),g)break;y=y.return}0<m.length&&(f=new u(f,p,null,r,d),h.push({event:f,listeners:m}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",u=e==="mouseout"||e==="pointerout",f&&r!==Bh&&(p=r.relatedTarget||r.fromElement)&&(bs(p)||p[yi]))break e;if((u||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,u?(p=r.relatedTarget||r.toElement,u=c,p=p?bs(p):null,p!==null&&(g=Gs(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(u=null,p=c),u!==p)){if(m=ng,_="onMouseLeave",x="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=sg,_="onPointerLeave",x="onPointerEnter",y="pointer"),g=u==null?f:Sa(u),w=p==null?f:Sa(p),f=new m(_,y+"leave",u,r,d),f.target=g,f.relatedTarget=w,_=null,bs(d)===c&&(m=new m(x,y+"enter",p,r,d),m.target=w,m.relatedTarget=g,_=m),g=_,u&&p)t:{for(m=u,x=p,y=0,w=m;w;w=ia(w))y++;for(w=0,_=x;_;_=ia(_))w++;for(;0<y-w;)m=ia(m),y--;for(;0<w-y;)x=ia(x),w--;for(;y--;){if(m===x||x!==null&&m===x.alternate)break t;m=ia(m),x=ia(x)}m=null}else m=null;u!==null&&mg(h,f,u,m,!1),p!==null&&g!==null&&mg(h,g,p,m,!0)}}e:{if(f=c?Sa(c):window,u=f.nodeName&&f.nodeName.toLowerCase(),u==="select"||u==="input"&&f.type==="file")var b=Lb;else if(lg(f))if(R1)b=zb;else{b=Ub;var k=Bb}else(u=f.nodeName)&&u.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(b=Wb);if(b&&(b=b(e,c))){D1(h,b,r,d);break e}k&&k(e,f,c),e==="focusout"&&(k=f._wrapperState)&&k.controlled&&f.type==="number"&&Dh(f,"number",f.value)}switch(k=c?Sa(c):window,e){case"focusin":(lg(k)||k.contentEditable==="true")&&(ba=k,Xh=c,Uo=null);break;case"focusout":Uo=Xh=ba=null;break;case"mousedown":Yh=!0;break;case"contextmenu":case"mouseup":case"dragend":Yh=!1,dg(h,r,d);break;case"selectionchange":if(Vb)break;case"keydown":case"keyup":dg(h,r,d)}var S;if(d0)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else _a?j1(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(F1&&r.locale!=="ko"&&(_a||E!=="onCompositionStart"?E==="onCompositionEnd"&&_a&&(S=O1()):(Li=d,u0="value"in Li?Li.value:Li.textContent,_a=!0)),k=cu(c,E),0<k.length&&(E=new ig(E,e,null,r,d),h.push({event:E,listeners:k}),S?E.data=S:(S=P1(r),S!==null&&(E.data=S)))),(S=Pb?Db(e,r):Rb(e,r))&&(c=cu(c,"onBeforeInput"),0<c.length&&(d=new ig("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:c}),d.data=S))}V1(h,t)})}function fl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function cu(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=il(e,r),s!=null&&n.unshift(fl(e,s,i)),s=il(e,t),s!=null&&n.push(fl(e,s,i))),e=e.return}return n}function ia(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function mg(e,t,r,n,i){for(var s=t._reactName,l=[];r!==null&&r!==n;){var o=r,a=o.alternate,c=o.stateNode;if(a!==null&&a===n)break;o.tag===5&&c!==null&&(o=c,i?(a=il(r,s),a!=null&&l.unshift(fl(r,a,o))):i||(a=il(r,s),a!=null&&l.push(fl(r,a,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var qb=/\r\n?/g,Kb=/\u0000|\uFFFD/g;function xg(e){return(typeof e=="string"?e:""+e).replace(qb,`
`).replace(Kb,"")}function xc(e,t,r){if(t=xg(t),xg(e)!==t&&r)throw Error(Fe(425))}function uu(){}var Gh=null,qh=null;function Kh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Jh=typeof setTimeout=="function"?setTimeout:void 0,Jb=typeof clearTimeout=="function"?clearTimeout:void 0,vg=typeof Promise=="function"?Promise:void 0,Qb=typeof queueMicrotask=="function"?queueMicrotask:typeof vg<"u"?function(e){return vg.resolve(null).then(e).catch(Zb)}:Jh;function Zb(e){setTimeout(function(){throw e})}function Vf(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),ol(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);ol(t)}function Vi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function yg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var so=Math.random().toString(36).slice(2),Yn="__reactFiber$"+so,hl="__reactProps$"+so,yi="__reactContainer$"+so,Qh="__reactEvents$"+so,ek="__reactListeners$"+so,tk="__reactHandles$"+so;function bs(e){var t=e[Yn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[yi]||r[Yn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=yg(e);e!==null;){if(r=e[Yn])return r;e=yg(e)}return t}e=r,r=e.parentNode}return null}function Yl(e){return e=e[Yn]||e[yi],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Sa(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Fe(33))}function Qu(e){return e[hl]||null}var Zh=[],Ca=-1;function os(e){return{current:e}}function St(e){0>Ca||(e.current=Zh[Ca],Zh[Ca]=null,Ca--)}function wt(e,t){Ca++,Zh[Ca]=e.current,e.current=t}var Zi={},Pr=os(Zi),Xr=os(!1),Rs=Zi;function Xa(e,t){var r=e.type.contextTypes;if(!r)return Zi;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Yr(e){return e=e.childContextTypes,e!=null}function fu(){St(Xr),St(Pr)}function wg(e,t,r){if(Pr.current!==Zi)throw Error(Fe(168));wt(Pr,t),wt(Xr,r)}function Y1(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Fe(108,B2(e)||"Unknown",i));return Mt({},r,n)}function hu(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Zi,Rs=Pr.current,wt(Pr,e),wt(Xr,Xr.current),!0}function _g(e,t,r){var n=e.stateNode;if(!n)throw Error(Fe(169));r?(e=Y1(e,t,Rs),n.__reactInternalMemoizedMergedChildContext=e,St(Xr),St(Pr),wt(Pr,e)):St(Xr),wt(Xr,r)}var li=null,Zu=!1,Xf=!1;function G1(e){li===null?li=[e]:li.push(e)}function rk(e){Zu=!0,G1(e)}function ls(){if(!Xf&&li!==null){Xf=!0;var e=0,t=mt;try{var r=li;for(mt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}li=null,Zu=!1}catch(i){throw li!==null&&(li=li.slice(e+1)),y1(a0,ls),i}finally{mt=t,Xf=!1}}return null}var Ta=[],Ea=0,du=null,pu=0,vn=[],yn=0,Is=null,ci=1,ui="";function gs(e,t){Ta[Ea++]=pu,Ta[Ea++]=du,du=e,pu=t}function q1(e,t,r){vn[yn++]=ci,vn[yn++]=ui,vn[yn++]=Is,Is=e;var n=ci;e=ui;var i=32-Mn(n)-1;n&=~(1<<i),r+=1;var s=32-Mn(t)+i;if(30<s){var l=i-i%5;s=(n&(1<<l)-1).toString(32),n>>=l,i-=l,ci=1<<32-Mn(t)+i|r<<i|n,ui=s+e}else ci=1<<s|r<<i|n,ui=e}function g0(e){e.return!==null&&(gs(e,1),q1(e,1,0))}function m0(e){for(;e===du;)du=Ta[--Ea],Ta[Ea]=null,pu=Ta[--Ea],Ta[Ea]=null;for(;e===Is;)Is=vn[--yn],vn[yn]=null,ui=vn[--yn],vn[yn]=null,ci=vn[--yn],vn[yn]=null}var sn=null,nn=null,Nt=!1,Dn=null;function K1(e,t){var r=wn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function bg(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,sn=e,nn=Vi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,sn=e,nn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Is!==null?{id:ci,overflow:ui}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=wn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,sn=e,nn=null,!0):!1;default:return!1}}function ed(e){return(e.mode&1)!==0&&(e.flags&128)===0}function td(e){if(Nt){var t=nn;if(t){var r=t;if(!bg(e,t)){if(ed(e))throw Error(Fe(418));t=Vi(r.nextSibling);var n=sn;t&&bg(e,t)?K1(n,r):(e.flags=e.flags&-4097|2,Nt=!1,sn=e)}}else{if(ed(e))throw Error(Fe(418));e.flags=e.flags&-4097|2,Nt=!1,sn=e}}}function kg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;sn=e}function vc(e){if(e!==sn)return!1;if(!Nt)return kg(e),Nt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Kh(e.type,e.memoizedProps)),t&&(t=nn)){if(ed(e))throw J1(),Error(Fe(418));for(;t;)K1(e,t),t=Vi(t.nextSibling)}if(kg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Fe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){nn=Vi(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}nn=null}}else nn=sn?Vi(e.stateNode.nextSibling):null;return!0}function J1(){for(var e=nn;e;)e=Vi(e.nextSibling)}function Ya(){nn=sn=null,Nt=!1}function x0(e){Dn===null?Dn=[e]:Dn.push(e)}var nk=Si.ReactCurrentBatchConfig;function wo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Fe(309));var n=r.stateNode}if(!n)throw Error(Fe(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(l){var o=i.refs;l===null?delete o[s]:o[s]=l},t._stringRef=s,t)}if(typeof e!="string")throw Error(Fe(284));if(!r._owner)throw Error(Fe(290,e))}return e}function yc(e,t){throw e=Object.prototype.toString.call(t),Error(Fe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Sg(e){var t=e._init;return t(e._payload)}function Q1(e){function t(x,y){if(e){var w=x.deletions;w===null?(x.deletions=[y],x.flags|=16):w.push(y)}}function r(x,y){if(!e)return null;for(;y!==null;)t(x,y),y=y.sibling;return null}function n(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function i(x,y){return x=qi(x,y),x.index=0,x.sibling=null,x}function s(x,y,w){return x.index=w,e?(w=x.alternate,w!==null?(w=w.index,w<y?(x.flags|=2,y):w):(x.flags|=2,y)):(x.flags|=1048576,y)}function l(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,y,w,_){return y===null||y.tag!==6?(y=Zf(w,x.mode,_),y.return=x,y):(y=i(y,w),y.return=x,y)}function a(x,y,w,_){var b=w.type;return b===wa?d(x,y,w.props.children,_,w.key):y!==null&&(y.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===ji&&Sg(b)===y.type)?(_=i(y,w.props),_.ref=wo(x,y,w),_.return=x,_):(_=Zc(w.type,w.key,w.props,null,x.mode,_),_.ref=wo(x,y,w),_.return=x,_)}function c(x,y,w,_){return y===null||y.tag!==4||y.stateNode.containerInfo!==w.containerInfo||y.stateNode.implementation!==w.implementation?(y=eh(w,x.mode,_),y.return=x,y):(y=i(y,w.children||[]),y.return=x,y)}function d(x,y,w,_,b){return y===null||y.tag!==7?(y=As(w,x.mode,_,b),y.return=x,y):(y=i(y,w),y.return=x,y)}function h(x,y,w){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Zf(""+y,x.mode,w),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case lc:return w=Zc(y.type,y.key,y.props,null,x.mode,w),w.ref=wo(x,null,y),w.return=x,w;case ya:return y=eh(y,x.mode,w),y.return=x,y;case ji:var _=y._init;return h(x,_(y._payload),w)}if(No(y)||go(y))return y=As(y,x.mode,w,null),y.return=x,y;yc(x,y)}return null}function f(x,y,w,_){var b=y!==null?y.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return b!==null?null:o(x,y,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case lc:return w.key===b?a(x,y,w,_):null;case ya:return w.key===b?c(x,y,w,_):null;case ji:return b=w._init,f(x,y,b(w._payload),_)}if(No(w)||go(w))return b!==null?null:d(x,y,w,_,null);yc(x,w)}return null}function u(x,y,w,_,b){if(typeof _=="string"&&_!==""||typeof _=="number")return x=x.get(w)||null,o(y,x,""+_,b);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case lc:return x=x.get(_.key===null?w:_.key)||null,a(y,x,_,b);case ya:return x=x.get(_.key===null?w:_.key)||null,c(y,x,_,b);case ji:var k=_._init;return u(x,y,w,k(_._payload),b)}if(No(_)||go(_))return x=x.get(w)||null,d(y,x,_,b,null);yc(y,_)}return null}function p(x,y,w,_){for(var b=null,k=null,S=y,E=y=0,F=null;S!==null&&E<w.length;E++){S.index>E?(F=S,S=null):F=S.sibling;var P=f(x,S,w[E],_);if(P===null){S===null&&(S=F);break}e&&S&&P.alternate===null&&t(x,S),y=s(P,y,E),k===null?b=P:k.sibling=P,k=P,S=F}if(E===w.length)return r(x,S),Nt&&gs(x,E),b;if(S===null){for(;E<w.length;E++)S=h(x,w[E],_),S!==null&&(y=s(S,y,E),k===null?b=S:k.sibling=S,k=S);return Nt&&gs(x,E),b}for(S=n(x,S);E<w.length;E++)F=u(S,x,E,w[E],_),F!==null&&(e&&F.alternate!==null&&S.delete(F.key===null?E:F.key),y=s(F,y,E),k===null?b=F:k.sibling=F,k=F);return e&&S.forEach(function(D){return t(x,D)}),Nt&&gs(x,E),b}function m(x,y,w,_){var b=go(w);if(typeof b!="function")throw Error(Fe(150));if(w=b.call(w),w==null)throw Error(Fe(151));for(var k=b=null,S=y,E=y=0,F=null,P=w.next();S!==null&&!P.done;E++,P=w.next()){S.index>E?(F=S,S=null):F=S.sibling;var D=f(x,S,P.value,_);if(D===null){S===null&&(S=F);break}e&&S&&D.alternate===null&&t(x,S),y=s(D,y,E),k===null?b=D:k.sibling=D,k=D,S=F}if(P.done)return r(x,S),Nt&&gs(x,E),b;if(S===null){for(;!P.done;E++,P=w.next())P=h(x,P.value,_),P!==null&&(y=s(P,y,E),k===null?b=P:k.sibling=P,k=P);return Nt&&gs(x,E),b}for(S=n(x,S);!P.done;E++,P=w.next())P=u(S,x,E,P.value,_),P!==null&&(e&&P.alternate!==null&&S.delete(P.key===null?E:P.key),y=s(P,y,E),k===null?b=P:k.sibling=P,k=P);return e&&S.forEach(function(I){return t(x,I)}),Nt&&gs(x,E),b}function g(x,y,w,_){if(typeof w=="object"&&w!==null&&w.type===wa&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case lc:e:{for(var b=w.key,k=y;k!==null;){if(k.key===b){if(b=w.type,b===wa){if(k.tag===7){r(x,k.sibling),y=i(k,w.props.children),y.return=x,x=y;break e}}else if(k.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===ji&&Sg(b)===k.type){r(x,k.sibling),y=i(k,w.props),y.ref=wo(x,k,w),y.return=x,x=y;break e}r(x,k);break}else t(x,k);k=k.sibling}w.type===wa?(y=As(w.props.children,x.mode,_,w.key),y.return=x,x=y):(_=Zc(w.type,w.key,w.props,null,x.mode,_),_.ref=wo(x,y,w),_.return=x,x=_)}return l(x);case ya:e:{for(k=w.key;y!==null;){if(y.key===k)if(y.tag===4&&y.stateNode.containerInfo===w.containerInfo&&y.stateNode.implementation===w.implementation){r(x,y.sibling),y=i(y,w.children||[]),y.return=x,x=y;break e}else{r(x,y);break}else t(x,y);y=y.sibling}y=eh(w,x.mode,_),y.return=x,x=y}return l(x);case ji:return k=w._init,g(x,y,k(w._payload),_)}if(No(w))return p(x,y,w,_);if(go(w))return m(x,y,w,_);yc(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,y!==null&&y.tag===6?(r(x,y.sibling),y=i(y,w),y.return=x,x=y):(r(x,y),y=Zf(w,x.mode,_),y.return=x,x=y),l(x)):r(x,y)}return g}var Ga=Q1(!0),Z1=Q1(!1),gu=os(null),mu=null,Na=null,v0=null;function y0(){v0=Na=mu=null}function w0(e){var t=gu.current;St(gu),e._currentValue=t}function rd(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ma(e,t){mu=e,v0=Na=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Vr=!0),e.firstContext=null)}function Sn(e){var t=e._currentValue;if(v0!==e)if(e={context:e,memoizedValue:t,next:null},Na===null){if(mu===null)throw Error(Fe(308));Na=e,mu.dependencies={lanes:0,firstContext:e}}else Na=Na.next=e;return t}var ks=null;function _0(e){ks===null?ks=[e]:ks.push(e)}function ev(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,_0(t)):(r.next=i.next,i.next=r),t.interleaved=r,wi(e,n)}function wi(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Pi=!1;function b0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function tv(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function di(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Xi(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ot&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,wi(e,r)}return i=n.interleaved,i===null?(t.next=t,_0(n)):(t.next=i.next,i.next=t),n.interleaved=t,wi(e,r)}function Yc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,o0(e,r)}}function Cg(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=l:s=s.next=l,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function xu(e,t,r,n){var i=e.updateQueue;Pi=!1;var s=i.firstBaseUpdate,l=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var a=o,c=a.next;a.next=null,l===null?s=c:l.next=c,l=a;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==l&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=a))}if(s!==null){var h=i.baseState;l=0,d=c=a=null,o=s;do{var f=o.lane,u=o.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:u,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,m=o;switch(f=t,u=r,m.tag){case 1:if(p=m.payload,typeof p=="function"){h=p.call(u,h,f);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,f=typeof p=="function"?p.call(u,h,f):p,f==null)break e;h=Mt({},h,f);break e;case 2:Pi=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,f=i.effects,f===null?i.effects=[o]:f.push(o))}else u={eventTime:u,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=u,a=h):d=d.next=u,l|=f;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;f=o,o=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(d===null&&(a=h),i.baseState=a,i.firstBaseUpdate=c,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do l|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Ls|=l,e.lanes=l,e.memoizedState=h}}function Tg(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Fe(191,i));i.call(n)}}}var Gl={},ei=os(Gl),dl=os(Gl),pl=os(Gl);function Ss(e){if(e===Gl)throw Error(Fe(174));return e}function k0(e,t){switch(wt(pl,t),wt(dl,e),wt(ei,Gl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ih(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ih(t,e)}St(ei),wt(ei,t)}function qa(){St(ei),St(dl),St(pl)}function rv(e){Ss(pl.current);var t=Ss(ei.current),r=Ih(t,e.type);t!==r&&(wt(dl,e),wt(ei,r))}function S0(e){dl.current===e&&(St(ei),St(dl))}var Ft=os(0);function vu(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Yf=[];function C0(){for(var e=0;e<Yf.length;e++)Yf[e]._workInProgressVersionPrimary=null;Yf.length=0}var Gc=Si.ReactCurrentDispatcher,Gf=Si.ReactCurrentBatchConfig,Ms=0,It=null,ir=null,ur=null,yu=!1,Wo=!1,gl=0,ik=0;function Sr(){throw Error(Fe(321))}function T0(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Wn(e[r],t[r]))return!1;return!0}function E0(e,t,r,n,i,s){if(Ms=s,It=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Gc.current=e===null||e.memoizedState===null?lk:ck,e=r(n,i),Wo){s=0;do{if(Wo=!1,gl=0,25<=s)throw Error(Fe(301));s+=1,ur=ir=null,t.updateQueue=null,Gc.current=uk,e=r(n,i)}while(Wo)}if(Gc.current=wu,t=ir!==null&&ir.next!==null,Ms=0,ur=ir=It=null,yu=!1,t)throw Error(Fe(300));return e}function N0(){var e=gl!==0;return gl=0,e}function Xn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ur===null?It.memoizedState=ur=e:ur=ur.next=e,ur}function Cn(){if(ir===null){var e=It.alternate;e=e!==null?e.memoizedState:null}else e=ir.next;var t=ur===null?It.memoizedState:ur.next;if(t!==null)ur=t,ir=e;else{if(e===null)throw Error(Fe(310));ir=e,e={memoizedState:ir.memoizedState,baseState:ir.baseState,baseQueue:ir.baseQueue,queue:ir.queue,next:null},ur===null?It.memoizedState=ur=e:ur=ur.next=e}return ur}function ml(e,t){return typeof t=="function"?t(e):t}function qf(e){var t=Cn(),r=t.queue;if(r===null)throw Error(Fe(311));r.lastRenderedReducer=e;var n=ir,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var l=i.next;i.next=s.next,s.next=l}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=l=null,a=null,c=s;do{var d=c.lane;if((Ms&d)===d)a!==null&&(a=a.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};a===null?(o=a=h,l=n):a=a.next=h,It.lanes|=d,Ls|=d}c=c.next}while(c!==null&&c!==s);a===null?l=n:a.next=o,Wn(n,t.memoizedState)||(Vr=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=a,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,It.lanes|=s,Ls|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Kf(e){var t=Cn(),r=t.queue;if(r===null)throw Error(Fe(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var l=i=i.next;do s=e(s,l.action),l=l.next;while(l!==i);Wn(s,t.memoizedState)||(Vr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function nv(){}function iv(e,t){var r=It,n=Cn(),i=t(),s=!Wn(n.memoizedState,i);if(s&&(n.memoizedState=i,Vr=!0),n=n.queue,A0(ov.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||ur!==null&&ur.memoizedState.tag&1){if(r.flags|=2048,xl(9,av.bind(null,r,n,i,t),void 0,null),dr===null)throw Error(Fe(349));Ms&30||sv(r,t,i)}return i}function sv(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=It.updateQueue,t===null?(t={lastEffect:null,stores:null},It.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function av(e,t,r,n){t.value=r,t.getSnapshot=n,lv(t)&&cv(e)}function ov(e,t,r){return r(function(){lv(t)&&cv(e)})}function lv(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Wn(e,r)}catch{return!0}}function cv(e){var t=wi(e,1);t!==null&&Ln(t,e,1,-1)}function Eg(e){var t=Xn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ml,lastRenderedState:e},t.queue=e,e=e.dispatch=ok.bind(null,It,e),[t.memoizedState,e]}function xl(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=It.updateQueue,t===null?(t={lastEffect:null,stores:null},It.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function uv(){return Cn().memoizedState}function qc(e,t,r,n){var i=Xn();It.flags|=e,i.memoizedState=xl(1|t,r,void 0,n===void 0?null:n)}function ef(e,t,r,n){var i=Cn();n=n===void 0?null:n;var s=void 0;if(ir!==null){var l=ir.memoizedState;if(s=l.destroy,n!==null&&T0(n,l.deps)){i.memoizedState=xl(t,r,s,n);return}}It.flags|=e,i.memoizedState=xl(1|t,r,s,n)}function Ng(e,t){return qc(8390656,8,e,t)}function A0(e,t){return ef(2048,8,e,t)}function fv(e,t){return ef(4,2,e,t)}function hv(e,t){return ef(4,4,e,t)}function dv(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function pv(e,t,r){return r=r!=null?r.concat([e]):null,ef(4,4,dv.bind(null,t,e),r)}function O0(){}function gv(e,t){var r=Cn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&T0(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function mv(e,t){var r=Cn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&T0(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function xv(e,t,r){return Ms&21?(Wn(r,t)||(r=b1(),It.lanes|=r,Ls|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Vr=!0),e.memoizedState=r)}function sk(e,t){var r=mt;mt=r!==0&&4>r?r:4,e(!0);var n=Gf.transition;Gf.transition={};try{e(!1),t()}finally{mt=r,Gf.transition=n}}function vv(){return Cn().memoizedState}function ak(e,t,r){var n=Gi(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},yv(e))wv(t,r);else if(r=ev(e,t,r,n),r!==null){var i=Br();Ln(r,e,n,i),_v(r,t,n)}}function ok(e,t,r){var n=Gi(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(yv(e))wv(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var l=t.lastRenderedState,o=s(l,r);if(i.hasEagerState=!0,i.eagerState=o,Wn(o,l)){var a=t.interleaved;a===null?(i.next=i,_0(t)):(i.next=a.next,a.next=i),t.interleaved=i;return}}catch{}finally{}r=ev(e,t,i,n),r!==null&&(i=Br(),Ln(r,e,n,i),_v(r,t,n))}}function yv(e){var t=e.alternate;return e===It||t!==null&&t===It}function wv(e,t){Wo=yu=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function _v(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,o0(e,r)}}var wu={readContext:Sn,useCallback:Sr,useContext:Sr,useEffect:Sr,useImperativeHandle:Sr,useInsertionEffect:Sr,useLayoutEffect:Sr,useMemo:Sr,useReducer:Sr,useRef:Sr,useState:Sr,useDebugValue:Sr,useDeferredValue:Sr,useTransition:Sr,useMutableSource:Sr,useSyncExternalStore:Sr,useId:Sr,unstable_isNewReconciler:!1},lk={readContext:Sn,useCallback:function(e,t){return Xn().memoizedState=[e,t===void 0?null:t],e},useContext:Sn,useEffect:Ng,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,qc(4194308,4,dv.bind(null,t,e),r)},useLayoutEffect:function(e,t){return qc(4194308,4,e,t)},useInsertionEffect:function(e,t){return qc(4,2,e,t)},useMemo:function(e,t){var r=Xn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Xn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=ak.bind(null,It,e),[n.memoizedState,e]},useRef:function(e){var t=Xn();return e={current:e},t.memoizedState=e},useState:Eg,useDebugValue:O0,useDeferredValue:function(e){return Xn().memoizedState=e},useTransition:function(){var e=Eg(!1),t=e[0];return e=sk.bind(null,e[1]),Xn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=It,i=Xn();if(Nt){if(r===void 0)throw Error(Fe(407));r=r()}else{if(r=t(),dr===null)throw Error(Fe(349));Ms&30||sv(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,Ng(ov.bind(null,n,s,e),[e]),n.flags|=2048,xl(9,av.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Xn(),t=dr.identifierPrefix;if(Nt){var r=ui,n=ci;r=(n&~(1<<32-Mn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=gl++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=ik++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ck={readContext:Sn,useCallback:gv,useContext:Sn,useEffect:A0,useImperativeHandle:pv,useInsertionEffect:fv,useLayoutEffect:hv,useMemo:mv,useReducer:qf,useRef:uv,useState:function(){return qf(ml)},useDebugValue:O0,useDeferredValue:function(e){var t=Cn();return xv(t,ir.memoizedState,e)},useTransition:function(){var e=qf(ml)[0],t=Cn().memoizedState;return[e,t]},useMutableSource:nv,useSyncExternalStore:iv,useId:vv,unstable_isNewReconciler:!1},uk={readContext:Sn,useCallback:gv,useContext:Sn,useEffect:A0,useImperativeHandle:pv,useInsertionEffect:fv,useLayoutEffect:hv,useMemo:mv,useReducer:Kf,useRef:uv,useState:function(){return Kf(ml)},useDebugValue:O0,useDeferredValue:function(e){var t=Cn();return ir===null?t.memoizedState=e:xv(t,ir.memoizedState,e)},useTransition:function(){var e=Kf(ml)[0],t=Cn().memoizedState;return[e,t]},useMutableSource:nv,useSyncExternalStore:iv,useId:vv,unstable_isNewReconciler:!1};function Fn(e,t){if(e&&e.defaultProps){t=Mt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function nd(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Mt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var tf={isMounted:function(e){return(e=e._reactInternals)?Gs(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Br(),i=Gi(e),s=di(n,i);s.payload=t,r!=null&&(s.callback=r),t=Xi(e,s,i),t!==null&&(Ln(t,e,i,n),Yc(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Br(),i=Gi(e),s=di(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Xi(e,s,i),t!==null&&(Ln(t,e,i,n),Yc(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Br(),n=Gi(e),i=di(r,n);i.tag=2,t!=null&&(i.callback=t),t=Xi(e,i,n),t!==null&&(Ln(t,e,n,r),Yc(t,e,n))}};function Ag(e,t,r,n,i,s,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,l):t.prototype&&t.prototype.isPureReactComponent?!cl(r,n)||!cl(i,s):!0}function bv(e,t,r){var n=!1,i=Zi,s=t.contextType;return typeof s=="object"&&s!==null?s=Sn(s):(i=Yr(t)?Rs:Pr.current,n=t.contextTypes,s=(n=n!=null)?Xa(e,i):Zi),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=tf,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function Og(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&tf.enqueueReplaceState(t,t.state,null)}function id(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},b0(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Sn(s):(s=Yr(t)?Rs:Pr.current,i.context=Xa(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(nd(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&tf.enqueueReplaceState(i,i.state,null),xu(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Ka(e,t){try{var r="",n=t;do r+=L2(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Jf(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function sd(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var fk=typeof WeakMap=="function"?WeakMap:Map;function kv(e,t,r){r=di(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){bu||(bu=!0,gd=n),sd(e,t)},r}function Sv(e,t,r){r=di(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){sd(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){sd(e,t),typeof n!="function"&&(Yi===null?Yi=new Set([this]):Yi.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function Fg(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new fk;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=Ck.bind(null,e,t,r),t.then(e,e))}function jg(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Pg(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=di(-1,1),t.tag=2,Xi(r,t,1))),r.lanes|=1),e)}var hk=Si.ReactCurrentOwner,Vr=!1;function Ir(e,t,r,n){t.child=e===null?Z1(t,null,r,n):Ga(t,e.child,r,n)}function Dg(e,t,r,n,i){r=r.render;var s=t.ref;return Ma(t,i),n=E0(e,t,r,n,s,i),r=N0(),e!==null&&!Vr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,_i(e,t,i)):(Nt&&r&&g0(t),t.flags|=1,Ir(e,t,n,i),t.child)}function Rg(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!L0(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,Cv(e,t,s,n,i)):(e=Zc(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var l=s.memoizedProps;if(r=r.compare,r=r!==null?r:cl,r(l,n)&&e.ref===t.ref)return _i(e,t,i)}return t.flags|=1,e=qi(s,n),e.ref=t.ref,e.return=t,t.child=e}function Cv(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(cl(s,n)&&e.ref===t.ref)if(Vr=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(Vr=!0);else return t.lanes=e.lanes,_i(e,t,i)}return ad(e,t,r,n,i)}function Tv(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},wt(Oa,Qr),Qr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,wt(Oa,Qr),Qr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,wt(Oa,Qr),Qr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,wt(Oa,Qr),Qr|=n;return Ir(e,t,i,r),t.child}function Ev(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function ad(e,t,r,n,i){var s=Yr(r)?Rs:Pr.current;return s=Xa(t,s),Ma(t,i),r=E0(e,t,r,n,s,i),n=N0(),e!==null&&!Vr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,_i(e,t,i)):(Nt&&n&&g0(t),t.flags|=1,Ir(e,t,r,i),t.child)}function Ig(e,t,r,n,i){if(Yr(r)){var s=!0;hu(t)}else s=!1;if(Ma(t,i),t.stateNode===null)Kc(e,t),bv(t,r,n),id(t,r,n,i),n=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var a=l.context,c=r.contextType;typeof c=="object"&&c!==null?c=Sn(c):(c=Yr(r)?Rs:Pr.current,c=Xa(t,c));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof l.getSnapshotBeforeUpdate=="function";h||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||a!==c)&&Og(t,l,n,c),Pi=!1;var f=t.memoizedState;l.state=f,xu(t,n,l,i),a=t.memoizedState,o!==n||f!==a||Xr.current||Pi?(typeof d=="function"&&(nd(t,r,d,n),a=t.memoizedState),(o=Pi||Ag(t,r,o,n,f,a,c))?(h||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=a),l.props=n,l.state=a,l.context=c,n=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,tv(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Fn(t.type,o),l.props=c,h=t.pendingProps,f=l.context,a=r.contextType,typeof a=="object"&&a!==null?a=Sn(a):(a=Yr(r)?Rs:Pr.current,a=Xa(t,a));var u=r.getDerivedStateFromProps;(d=typeof u=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==h||f!==a)&&Og(t,l,n,a),Pi=!1,f=t.memoizedState,l.state=f,xu(t,n,l,i);var p=t.memoizedState;o!==h||f!==p||Xr.current||Pi?(typeof u=="function"&&(nd(t,r,u,n),p=t.memoizedState),(c=Pi||Ag(t,r,c,n,f,p,a)||!1)?(d||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,p,a),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,p,a)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),l.props=n,l.state=p,l.context=a,n=c):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return od(e,t,r,n,s,i)}function od(e,t,r,n,i,s){Ev(e,t);var l=(t.flags&128)!==0;if(!n&&!l)return i&&_g(t,r,!1),_i(e,t,s);n=t.stateNode,hk.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&l?(t.child=Ga(t,e.child,null,s),t.child=Ga(t,null,o,s)):Ir(e,t,o,s),t.memoizedState=n.state,i&&_g(t,r,!0),t.child}function Nv(e){var t=e.stateNode;t.pendingContext?wg(e,t.pendingContext,t.pendingContext!==t.context):t.context&&wg(e,t.context,!1),k0(e,t.containerInfo)}function Mg(e,t,r,n,i){return Ya(),x0(i),t.flags|=256,Ir(e,t,r,n),t.child}var ld={dehydrated:null,treeContext:null,retryLane:0};function cd(e){return{baseLanes:e,cachePool:null,transitions:null}}function Av(e,t,r){var n=t.pendingProps,i=Ft.current,s=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),wt(Ft,i&1),e===null)return td(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=n.children,e=n.fallback,s?(n=t.mode,s=t.child,l={mode:"hidden",children:l},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=l):s=sf(l,n,0,null),e=As(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=cd(r),t.memoizedState=ld,e):F0(t,l));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return dk(e,t,l,n,o,i,r);if(s){s=n.fallback,l=t.mode,i=e.child,o=i.sibling;var a={mode:"hidden",children:n.children};return!(l&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=a,t.deletions=null):(n=qi(i,a),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=qi(o,s):(s=As(s,l,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,l=e.child.memoizedState,l=l===null?cd(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~r,t.memoizedState=ld,n}return s=e.child,e=s.sibling,n=qi(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function F0(e,t){return t=sf({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function wc(e,t,r,n){return n!==null&&x0(n),Ga(t,e.child,null,r),e=F0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function dk(e,t,r,n,i,s,l){if(r)return t.flags&256?(t.flags&=-257,n=Jf(Error(Fe(422))),wc(e,t,l,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=sf({mode:"visible",children:n.children},i,0,null),s=As(s,i,l,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Ga(t,e.child,null,l),t.child.memoizedState=cd(l),t.memoizedState=ld,s);if(!(t.mode&1))return wc(e,t,l,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Fe(419)),n=Jf(s,n,void 0),wc(e,t,l,n)}if(o=(l&e.childLanes)!==0,Vr||o){if(n=dr,n!==null){switch(l&-l){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|l)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,wi(e,i),Ln(n,e,i,-1))}return M0(),n=Jf(Error(Fe(421))),wc(e,t,l,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=Tk.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,nn=Vi(i.nextSibling),sn=t,Nt=!0,Dn=null,e!==null&&(vn[yn++]=ci,vn[yn++]=ui,vn[yn++]=Is,ci=e.id,ui=e.overflow,Is=t),t=F0(t,n.children),t.flags|=4096,t)}function Lg(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),rd(e.return,t,r)}function Qf(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function Ov(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Ir(e,t,n.children,r),n=Ft.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Lg(e,r,t);else if(e.tag===19)Lg(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(wt(Ft,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&vu(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Qf(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&vu(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Qf(t,!0,r,null,s);break;case"together":Qf(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Kc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function _i(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ls|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Fe(153));if(t.child!==null){for(e=t.child,r=qi(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=qi(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function pk(e,t,r){switch(t.tag){case 3:Nv(t),Ya();break;case 5:rv(t);break;case 1:Yr(t.type)&&hu(t);break;case 4:k0(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;wt(gu,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(wt(Ft,Ft.current&1),t.flags|=128,null):r&t.child.childLanes?Av(e,t,r):(wt(Ft,Ft.current&1),e=_i(e,t,r),e!==null?e.sibling:null);wt(Ft,Ft.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Ov(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),wt(Ft,Ft.current),n)break;return null;case 22:case 23:return t.lanes=0,Tv(e,t,r)}return _i(e,t,r)}var Fv,ud,jv,Pv;Fv=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};ud=function(){};jv=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Ss(ei.current);var s=null;switch(r){case"input":i=jh(e,i),n=jh(e,n),s=[];break;case"select":i=Mt({},i,{value:void 0}),n=Mt({},n,{value:void 0}),s=[];break;case"textarea":i=Rh(e,i),n=Rh(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=uu)}Mh(r,n);var l;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(rl.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var a=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&a!==o&&(a!=null||o!=null))if(c==="style")if(o){for(l in o)!o.hasOwnProperty(l)||a&&a.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in a)a.hasOwnProperty(l)&&o[l]!==a[l]&&(r||(r={}),r[l]=a[l])}else r||(s||(s=[]),s.push(c,r)),r=a;else c==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,o=o?o.__html:void 0,a!=null&&o!==a&&(s=s||[]).push(c,a)):c==="children"?typeof a!="string"&&typeof a!="number"||(s=s||[]).push(c,""+a):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(rl.hasOwnProperty(c)?(a!=null&&c==="onScroll"&&_t("scroll",e),s||o===a||(s=[])):(s=s||[]).push(c,a))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};Pv=function(e,t,r,n){r!==n&&(t.flags|=4)};function _o(e,t){if(!Nt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Cr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function gk(e,t,r){var n=t.pendingProps;switch(m0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Cr(t),null;case 1:return Yr(t.type)&&fu(),Cr(t),null;case 3:return n=t.stateNode,qa(),St(Xr),St(Pr),C0(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(vc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Dn!==null&&(vd(Dn),Dn=null))),ud(e,t),Cr(t),null;case 5:S0(t);var i=Ss(pl.current);if(r=t.type,e!==null&&t.stateNode!=null)jv(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Fe(166));return Cr(t),null}if(e=Ss(ei.current),vc(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Yn]=t,n[hl]=s,e=(t.mode&1)!==0,r){case"dialog":_t("cancel",n),_t("close",n);break;case"iframe":case"object":case"embed":_t("load",n);break;case"video":case"audio":for(i=0;i<Oo.length;i++)_t(Oo[i],n);break;case"source":_t("error",n);break;case"img":case"image":case"link":_t("error",n),_t("load",n);break;case"details":_t("toggle",n);break;case"input":Yp(n,s),_t("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},_t("invalid",n);break;case"textarea":qp(n,s),_t("invalid",n)}Mh(r,s),i=null;for(var l in s)if(s.hasOwnProperty(l)){var o=s[l];l==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&xc(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&xc(n.textContent,o,e),i=["children",""+o]):rl.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&_t("scroll",n)}switch(r){case"input":cc(n),Gp(n,s,!0);break;case"textarea":cc(n),Kp(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=uu)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{l=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=o1(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),r==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[Yn]=t,e[hl]=n,Fv(e,t,!1,!1),t.stateNode=e;e:{switch(l=Lh(r,n),r){case"dialog":_t("cancel",e),_t("close",e),i=n;break;case"iframe":case"object":case"embed":_t("load",e),i=n;break;case"video":case"audio":for(i=0;i<Oo.length;i++)_t(Oo[i],e);i=n;break;case"source":_t("error",e),i=n;break;case"img":case"image":case"link":_t("error",e),_t("load",e),i=n;break;case"details":_t("toggle",e),i=n;break;case"input":Yp(e,n),i=jh(e,n),_t("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Mt({},n,{value:void 0}),_t("invalid",e);break;case"textarea":qp(e,n),i=Rh(e,n),_t("invalid",e);break;default:i=n}Mh(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="style"?u1(e,a):s==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&l1(e,a)):s==="children"?typeof a=="string"?(r!=="textarea"||a!=="")&&nl(e,a):typeof a=="number"&&nl(e,""+a):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(rl.hasOwnProperty(s)?a!=null&&s==="onScroll"&&_t("scroll",e):a!=null&&t0(e,s,a,l))}switch(r){case"input":cc(e),Gp(e,n,!1);break;case"textarea":cc(e),Kp(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Qi(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Pa(e,!!n.multiple,s,!1):n.defaultValue!=null&&Pa(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=uu)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Cr(t),null;case 6:if(e&&t.stateNode!=null)Pv(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Fe(166));if(r=Ss(pl.current),Ss(ei.current),vc(t)){if(n=t.stateNode,r=t.memoizedProps,n[Yn]=t,(s=n.nodeValue!==r)&&(e=sn,e!==null))switch(e.tag){case 3:xc(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&xc(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Yn]=t,t.stateNode=n}return Cr(t),null;case 13:if(St(Ft),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Nt&&nn!==null&&t.mode&1&&!(t.flags&128))J1(),Ya(),t.flags|=98560,s=!1;else if(s=vc(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(Fe(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Fe(317));s[Yn]=t}else Ya(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Cr(t),s=!1}else Dn!==null&&(vd(Dn),Dn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ft.current&1?ar===0&&(ar=3):M0())),t.updateQueue!==null&&(t.flags|=4),Cr(t),null);case 4:return qa(),ud(e,t),e===null&&ul(t.stateNode.containerInfo),Cr(t),null;case 10:return w0(t.type._context),Cr(t),null;case 17:return Yr(t.type)&&fu(),Cr(t),null;case 19:if(St(Ft),s=t.memoizedState,s===null)return Cr(t),null;if(n=(t.flags&128)!==0,l=s.rendering,l===null)if(n)_o(s,!1);else{if(ar!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=vu(e),l!==null){for(t.flags|=128,_o(s,!1),n=l.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,l=s.alternate,l===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return wt(Ft,Ft.current&1|2),t.child}e=e.sibling}s.tail!==null&&Vt()>Ja&&(t.flags|=128,n=!0,_o(s,!1),t.lanes=4194304)}else{if(!n)if(e=vu(l),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),_o(s,!0),s.tail===null&&s.tailMode==="hidden"&&!l.alternate&&!Nt)return Cr(t),null}else 2*Vt()-s.renderingStartTime>Ja&&r!==1073741824&&(t.flags|=128,n=!0,_o(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(r=s.last,r!==null?r.sibling=l:t.child=l,s.last=l)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Vt(),t.sibling=null,r=Ft.current,wt(Ft,n?r&1|2:r&1),t):(Cr(t),null);case 22:case 23:return I0(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Qr&1073741824&&(Cr(t),t.subtreeFlags&6&&(t.flags|=8192)):Cr(t),null;case 24:return null;case 25:return null}throw Error(Fe(156,t.tag))}function mk(e,t){switch(m0(t),t.tag){case 1:return Yr(t.type)&&fu(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return qa(),St(Xr),St(Pr),C0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return S0(t),null;case 13:if(St(Ft),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Fe(340));Ya()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return St(Ft),null;case 4:return qa(),null;case 10:return w0(t.type._context),null;case 22:case 23:return I0(),null;case 24:return null;default:return null}}var _c=!1,Ar=!1,xk=typeof WeakSet=="function"?WeakSet:Set,He=null;function Aa(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Bt(e,t,n)}else r.current=null}function fd(e,t,r){try{r()}catch(n){Bt(e,t,n)}}var Bg=!1;function vk(e,t){if(Gh=ou,e=L1(),p0(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var l=0,o=-1,a=-1,c=0,d=0,h=e,f=null;t:for(;;){for(var u;h!==r||i!==0&&h.nodeType!==3||(o=l+i),h!==s||n!==0&&h.nodeType!==3||(a=l+n),h.nodeType===3&&(l+=h.nodeValue.length),(u=h.firstChild)!==null;)f=h,h=u;for(;;){if(h===e)break t;if(f===r&&++c===i&&(o=l),f===s&&++d===n&&(a=l),(u=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=u}r=o===-1||a===-1?null:{start:o,end:a}}else r=null}r=r||{start:0,end:0}}else r=null;for(qh={focusedElem:e,selectionRange:r},ou=!1,He=t;He!==null;)if(t=He,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,He=e;else for(;He!==null;){t=He;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,x=t.stateNode,y=x.getSnapshotBeforeUpdate(t.elementType===t.type?m:Fn(t.type,m),g);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Fe(163))}}catch(_){Bt(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,He=e;break}He=t.return}return p=Bg,Bg=!1,p}function zo(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&fd(t,r,s)}i=i.next}while(i!==n)}}function rf(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function hd(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Dv(e){var t=e.alternate;t!==null&&(e.alternate=null,Dv(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Yn],delete t[hl],delete t[Qh],delete t[ek],delete t[tk])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Rv(e){return e.tag===5||e.tag===3||e.tag===4}function Ug(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Rv(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function dd(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=uu));else if(n!==4&&(e=e.child,e!==null))for(dd(e,t,r),e=e.sibling;e!==null;)dd(e,t,r),e=e.sibling}function pd(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(pd(e,t,r),e=e.sibling;e!==null;)pd(e,t,r),e=e.sibling}var xr=null,jn=!1;function Ai(e,t,r){for(r=r.child;r!==null;)Iv(e,t,r),r=r.sibling}function Iv(e,t,r){if(Zn&&typeof Zn.onCommitFiberUnmount=="function")try{Zn.onCommitFiberUnmount(Gu,r)}catch{}switch(r.tag){case 5:Ar||Aa(r,t);case 6:var n=xr,i=jn;xr=null,Ai(e,t,r),xr=n,jn=i,xr!==null&&(jn?(e=xr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):xr.removeChild(r.stateNode));break;case 18:xr!==null&&(jn?(e=xr,r=r.stateNode,e.nodeType===8?Vf(e.parentNode,r):e.nodeType===1&&Vf(e,r),ol(e)):Vf(xr,r.stateNode));break;case 4:n=xr,i=jn,xr=r.stateNode.containerInfo,jn=!0,Ai(e,t,r),xr=n,jn=i;break;case 0:case 11:case 14:case 15:if(!Ar&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,l=s.destroy;s=s.tag,l!==void 0&&(s&2||s&4)&&fd(r,t,l),i=i.next}while(i!==n)}Ai(e,t,r);break;case 1:if(!Ar&&(Aa(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Bt(r,t,o)}Ai(e,t,r);break;case 21:Ai(e,t,r);break;case 22:r.mode&1?(Ar=(n=Ar)||r.memoizedState!==null,Ai(e,t,r),Ar=n):Ai(e,t,r);break;default:Ai(e,t,r)}}function Wg(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new xk),t.forEach(function(n){var i=Ek.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Nn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:xr=o.stateNode,jn=!1;break e;case 3:xr=o.stateNode.containerInfo,jn=!0;break e;case 4:xr=o.stateNode.containerInfo,jn=!0;break e}o=o.return}if(xr===null)throw Error(Fe(160));Iv(s,l,i),xr=null,jn=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(c){Bt(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Mv(t,e),t=t.sibling}function Mv(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Nn(t,e),zn(e),n&4){try{zo(3,e,e.return),rf(3,e)}catch(m){Bt(e,e.return,m)}try{zo(5,e,e.return)}catch(m){Bt(e,e.return,m)}}break;case 1:Nn(t,e),zn(e),n&512&&r!==null&&Aa(r,r.return);break;case 5:if(Nn(t,e),zn(e),n&512&&r!==null&&Aa(r,r.return),e.flags&32){var i=e.stateNode;try{nl(i,"")}catch(m){Bt(e,e.return,m)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,l=r!==null?r.memoizedProps:s,o=e.type,a=e.updateQueue;if(e.updateQueue=null,a!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&s1(i,s),Lh(o,l);var c=Lh(o,s);for(l=0;l<a.length;l+=2){var d=a[l],h=a[l+1];d==="style"?u1(i,h):d==="dangerouslySetInnerHTML"?l1(i,h):d==="children"?nl(i,h):t0(i,d,h,c)}switch(o){case"input":Ph(i,s);break;case"textarea":a1(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var u=s.value;u!=null?Pa(i,!!s.multiple,u,!1):f!==!!s.multiple&&(s.defaultValue!=null?Pa(i,!!s.multiple,s.defaultValue,!0):Pa(i,!!s.multiple,s.multiple?[]:"",!1))}i[hl]=s}catch(m){Bt(e,e.return,m)}}break;case 6:if(Nn(t,e),zn(e),n&4){if(e.stateNode===null)throw Error(Fe(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(m){Bt(e,e.return,m)}}break;case 3:if(Nn(t,e),zn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{ol(t.containerInfo)}catch(m){Bt(e,e.return,m)}break;case 4:Nn(t,e),zn(e);break;case 13:Nn(t,e),zn(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(D0=Vt())),n&4&&Wg(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Ar=(c=Ar)||d,Nn(t,e),Ar=c):Nn(t,e),zn(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!d&&e.mode&1)for(He=e,d=e.child;d!==null;){for(h=He=d;He!==null;){switch(f=He,u=f.child,f.tag){case 0:case 11:case 14:case 15:zo(4,f,f.return);break;case 1:Aa(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){Bt(n,r,m)}}break;case 5:Aa(f,f.return);break;case 22:if(f.memoizedState!==null){Hg(h);continue}}u!==null?(u.return=f,He=u):Hg(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,a=h.memoizedProps.style,l=a!=null&&a.hasOwnProperty("display")?a.display:null,o.style.display=c1("display",l))}catch(m){Bt(e,e.return,m)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){Bt(e,e.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Nn(t,e),zn(e),n&4&&Wg(e);break;case 21:break;default:Nn(t,e),zn(e)}}function zn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Rv(r)){var n=r;break e}r=r.return}throw Error(Fe(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(nl(i,""),n.flags&=-33);var s=Ug(e);pd(e,s,i);break;case 3:case 4:var l=n.stateNode.containerInfo,o=Ug(e);dd(e,o,l);break;default:throw Error(Fe(161))}}catch(a){Bt(e,e.return,a)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function yk(e,t,r){He=e,Lv(e)}function Lv(e,t,r){for(var n=(e.mode&1)!==0;He!==null;){var i=He,s=i.child;if(i.tag===22&&n){var l=i.memoizedState!==null||_c;if(!l){var o=i.alternate,a=o!==null&&o.memoizedState!==null||Ar;o=_c;var c=Ar;if(_c=l,(Ar=a)&&!c)for(He=i;He!==null;)l=He,a=l.child,l.tag===22&&l.memoizedState!==null?$g(i):a!==null?(a.return=l,He=a):$g(i);for(;s!==null;)He=s,Lv(s),s=s.sibling;He=i,_c=o,Ar=c}zg(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,He=s):zg(e)}}function zg(e){for(;He!==null;){var t=He;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ar||rf(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ar)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Fn(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Tg(t,s,n);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Tg(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var a=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&r.focus();break;case"img":a.src&&(r.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&ol(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Fe(163))}Ar||t.flags&512&&hd(t)}catch(f){Bt(t,t.return,f)}}if(t===e){He=null;break}if(r=t.sibling,r!==null){r.return=t.return,He=r;break}He=t.return}}function Hg(e){for(;He!==null;){var t=He;if(t===e){He=null;break}var r=t.sibling;if(r!==null){r.return=t.return,He=r;break}He=t.return}}function $g(e){for(;He!==null;){var t=He;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{rf(4,t)}catch(a){Bt(t,r,a)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(a){Bt(t,i,a)}}var s=t.return;try{hd(t)}catch(a){Bt(t,s,a)}break;case 5:var l=t.return;try{hd(t)}catch(a){Bt(t,l,a)}}}catch(a){Bt(t,t.return,a)}if(t===e){He=null;break}var o=t.sibling;if(o!==null){o.return=t.return,He=o;break}He=t.return}}var wk=Math.ceil,_u=Si.ReactCurrentDispatcher,j0=Si.ReactCurrentOwner,_n=Si.ReactCurrentBatchConfig,ot=0,dr=null,tr=null,_r=0,Qr=0,Oa=os(0),ar=0,vl=null,Ls=0,nf=0,P0=0,Ho=null,$r=null,D0=0,Ja=1/0,ai=null,bu=!1,gd=null,Yi=null,bc=!1,Bi=null,ku=0,$o=0,md=null,Jc=-1,Qc=0;function Br(){return ot&6?Vt():Jc!==-1?Jc:Jc=Vt()}function Gi(e){return e.mode&1?ot&2&&_r!==0?_r&-_r:nk.transition!==null?(Qc===0&&(Qc=b1()),Qc):(e=mt,e!==0||(e=window.event,e=e===void 0?16:A1(e.type)),e):1}function Ln(e,t,r,n){if(50<$o)throw $o=0,md=null,Error(Fe(185));Vl(e,r,n),(!(ot&2)||e!==dr)&&(e===dr&&(!(ot&2)&&(nf|=r),ar===4&&Ii(e,_r)),Gr(e,n),r===1&&ot===0&&!(t.mode&1)&&(Ja=Vt()+500,Zu&&ls()))}function Gr(e,t){var r=e.callbackNode;nb(e,t);var n=au(e,e===dr?_r:0);if(n===0)r!==null&&Zp(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Zp(r),t===1)e.tag===0?rk(Vg.bind(null,e)):G1(Vg.bind(null,e)),Qb(function(){!(ot&6)&&ls()}),r=null;else{switch(k1(n)){case 1:r=a0;break;case 4:r=w1;break;case 16:r=su;break;case 536870912:r=_1;break;default:r=su}r=Xv(r,Bv.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Bv(e,t){if(Jc=-1,Qc=0,ot&6)throw Error(Fe(327));var r=e.callbackNode;if(La()&&e.callbackNode!==r)return null;var n=au(e,e===dr?_r:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Su(e,n);else{t=n;var i=ot;ot|=2;var s=Wv();(dr!==e||_r!==t)&&(ai=null,Ja=Vt()+500,Ns(e,t));do try{kk();break}catch(o){Uv(e,o)}while(!0);y0(),_u.current=s,ot=i,tr!==null?t=0:(dr=null,_r=0,t=ar)}if(t!==0){if(t===2&&(i=Hh(e),i!==0&&(n=i,t=xd(e,i))),t===1)throw r=vl,Ns(e,0),Ii(e,n),Gr(e,Vt()),r;if(t===6)Ii(e,n);else{if(i=e.current.alternate,!(n&30)&&!_k(i)&&(t=Su(e,n),t===2&&(s=Hh(e),s!==0&&(n=s,t=xd(e,s))),t===1))throw r=vl,Ns(e,0),Ii(e,n),Gr(e,Vt()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Fe(345));case 2:ms(e,$r,ai);break;case 3:if(Ii(e,n),(n&130023424)===n&&(t=D0+500-Vt(),10<t)){if(au(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Br(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Jh(ms.bind(null,e,$r,ai),t);break}ms(e,$r,ai);break;case 4:if(Ii(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var l=31-Mn(n);s=1<<l,l=t[l],l>i&&(i=l),n&=~s}if(n=i,n=Vt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*wk(n/1960))-n,10<n){e.timeoutHandle=Jh(ms.bind(null,e,$r,ai),n);break}ms(e,$r,ai);break;case 5:ms(e,$r,ai);break;default:throw Error(Fe(329))}}}return Gr(e,Vt()),e.callbackNode===r?Bv.bind(null,e):null}function xd(e,t){var r=Ho;return e.current.memoizedState.isDehydrated&&(Ns(e,t).flags|=256),e=Su(e,t),e!==2&&(t=$r,$r=r,t!==null&&vd(t)),e}function vd(e){$r===null?$r=e:$r.push.apply($r,e)}function _k(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Wn(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ii(e,t){for(t&=~P0,t&=~nf,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Mn(t),n=1<<r;e[r]=-1,t&=~n}}function Vg(e){if(ot&6)throw Error(Fe(327));La();var t=au(e,0);if(!(t&1))return Gr(e,Vt()),null;var r=Su(e,t);if(e.tag!==0&&r===2){var n=Hh(e);n!==0&&(t=n,r=xd(e,n))}if(r===1)throw r=vl,Ns(e,0),Ii(e,t),Gr(e,Vt()),r;if(r===6)throw Error(Fe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ms(e,$r,ai),Gr(e,Vt()),null}function R0(e,t){var r=ot;ot|=1;try{return e(t)}finally{ot=r,ot===0&&(Ja=Vt()+500,Zu&&ls())}}function Bs(e){Bi!==null&&Bi.tag===0&&!(ot&6)&&La();var t=ot;ot|=1;var r=_n.transition,n=mt;try{if(_n.transition=null,mt=1,e)return e()}finally{mt=n,_n.transition=r,ot=t,!(ot&6)&&ls()}}function I0(){Qr=Oa.current,St(Oa)}function Ns(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Jb(r)),tr!==null)for(r=tr.return;r!==null;){var n=r;switch(m0(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&fu();break;case 3:qa(),St(Xr),St(Pr),C0();break;case 5:S0(n);break;case 4:qa();break;case 13:St(Ft);break;case 19:St(Ft);break;case 10:w0(n.type._context);break;case 22:case 23:I0()}r=r.return}if(dr=e,tr=e=qi(e.current,null),_r=Qr=t,ar=0,vl=null,P0=nf=Ls=0,$r=Ho=null,ks!==null){for(t=0;t<ks.length;t++)if(r=ks[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var l=s.next;s.next=i,n.next=l}r.pending=n}ks=null}return e}function Uv(e,t){do{var r=tr;try{if(y0(),Gc.current=wu,yu){for(var n=It.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}yu=!1}if(Ms=0,ur=ir=It=null,Wo=!1,gl=0,j0.current=null,r===null||r.return===null){ar=1,vl=t,tr=null;break}e:{var s=e,l=r.return,o=r,a=t;if(t=_r,o.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var c=a,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var u=jg(l);if(u!==null){u.flags&=-257,Pg(u,l,o,s,t),u.mode&1&&Fg(s,c,t),t=u,a=c;var p=t.updateQueue;if(p===null){var m=new Set;m.add(a),t.updateQueue=m}else p.add(a);break e}else{if(!(t&1)){Fg(s,c,t),M0();break e}a=Error(Fe(426))}}else if(Nt&&o.mode&1){var g=jg(l);if(g!==null){!(g.flags&65536)&&(g.flags|=256),Pg(g,l,o,s,t),x0(Ka(a,o));break e}}s=a=Ka(a,o),ar!==4&&(ar=2),Ho===null?Ho=[s]:Ho.push(s),s=l;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var x=kv(s,a,t);Cg(s,x);break e;case 1:o=a;var y=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Yi===null||!Yi.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var _=Sv(s,o,t);Cg(s,_);break e}}s=s.return}while(s!==null)}Hv(r)}catch(b){t=b,tr===r&&r!==null&&(tr=r=r.return);continue}break}while(!0)}function Wv(){var e=_u.current;return _u.current=wu,e===null?wu:e}function M0(){(ar===0||ar===3||ar===2)&&(ar=4),dr===null||!(Ls&268435455)&&!(nf&268435455)||Ii(dr,_r)}function Su(e,t){var r=ot;ot|=2;var n=Wv();(dr!==e||_r!==t)&&(ai=null,Ns(e,t));do try{bk();break}catch(i){Uv(e,i)}while(!0);if(y0(),ot=r,_u.current=n,tr!==null)throw Error(Fe(261));return dr=null,_r=0,ar}function bk(){for(;tr!==null;)zv(tr)}function kk(){for(;tr!==null&&!G2();)zv(tr)}function zv(e){var t=Vv(e.alternate,e,Qr);e.memoizedProps=e.pendingProps,t===null?Hv(e):tr=t,j0.current=null}function Hv(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=mk(r,t),r!==null){r.flags&=32767,tr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ar=6,tr=null;return}}else if(r=gk(r,t,Qr),r!==null){tr=r;return}if(t=t.sibling,t!==null){tr=t;return}tr=t=e}while(t!==null);ar===0&&(ar=5)}function ms(e,t,r){var n=mt,i=_n.transition;try{_n.transition=null,mt=1,Sk(e,t,r,n)}finally{_n.transition=i,mt=n}return null}function Sk(e,t,r,n){do La();while(Bi!==null);if(ot&6)throw Error(Fe(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Fe(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(ib(e,s),e===dr&&(tr=dr=null,_r=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||bc||(bc=!0,Xv(su,function(){return La(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=_n.transition,_n.transition=null;var l=mt;mt=1;var o=ot;ot|=4,j0.current=null,vk(e,r),Mv(r,e),$b(qh),ou=!!Gh,qh=Gh=null,e.current=r,yk(r),q2(),ot=o,mt=l,_n.transition=s}else e.current=r;if(bc&&(bc=!1,Bi=e,ku=i),s=e.pendingLanes,s===0&&(Yi=null),Q2(r.stateNode),Gr(e,Vt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(bu)throw bu=!1,e=gd,gd=null,e;return ku&1&&e.tag!==0&&La(),s=e.pendingLanes,s&1?e===md?$o++:($o=0,md=e):$o=0,ls(),null}function La(){if(Bi!==null){var e=k1(ku),t=_n.transition,r=mt;try{if(_n.transition=null,mt=16>e?16:e,Bi===null)var n=!1;else{if(e=Bi,Bi=null,ku=0,ot&6)throw Error(Fe(331));var i=ot;for(ot|=4,He=e.current;He!==null;){var s=He,l=s.child;if(He.flags&16){var o=s.deletions;if(o!==null){for(var a=0;a<o.length;a++){var c=o[a];for(He=c;He!==null;){var d=He;switch(d.tag){case 0:case 11:case 15:zo(8,d,s)}var h=d.child;if(h!==null)h.return=d,He=h;else for(;He!==null;){d=He;var f=d.sibling,u=d.return;if(Dv(d),d===c){He=null;break}if(f!==null){f.return=u,He=f;break}He=u}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}He=s}}if(s.subtreeFlags&2064&&l!==null)l.return=s,He=l;else e:for(;He!==null;){if(s=He,s.flags&2048)switch(s.tag){case 0:case 11:case 15:zo(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,He=x;break e}He=s.return}}var y=e.current;for(He=y;He!==null;){l=He;var w=l.child;if(l.subtreeFlags&2064&&w!==null)w.return=l,He=w;else e:for(l=y;He!==null;){if(o=He,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:rf(9,o)}}catch(b){Bt(o,o.return,b)}if(o===l){He=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,He=_;break e}He=o.return}}if(ot=i,ls(),Zn&&typeof Zn.onPostCommitFiberRoot=="function")try{Zn.onPostCommitFiberRoot(Gu,e)}catch{}n=!0}return n}finally{mt=r,_n.transition=t}}return!1}function Xg(e,t,r){t=Ka(r,t),t=kv(e,t,1),e=Xi(e,t,1),t=Br(),e!==null&&(Vl(e,1,t),Gr(e,t))}function Bt(e,t,r){if(e.tag===3)Xg(e,e,r);else for(;t!==null;){if(t.tag===3){Xg(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Yi===null||!Yi.has(n))){e=Ka(r,e),e=Sv(t,e,1),t=Xi(t,e,1),e=Br(),t!==null&&(Vl(t,1,e),Gr(t,e));break}}t=t.return}}function Ck(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Br(),e.pingedLanes|=e.suspendedLanes&r,dr===e&&(_r&r)===r&&(ar===4||ar===3&&(_r&130023424)===_r&&500>Vt()-D0?Ns(e,0):P0|=r),Gr(e,t)}function $v(e,t){t===0&&(e.mode&1?(t=hc,hc<<=1,!(hc&130023424)&&(hc=4194304)):t=1);var r=Br();e=wi(e,t),e!==null&&(Vl(e,t,r),Gr(e,r))}function Tk(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),$v(e,r)}function Ek(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Fe(314))}n!==null&&n.delete(t),$v(e,r)}var Vv;Vv=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Xr.current)Vr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Vr=!1,pk(e,t,r);Vr=!!(e.flags&131072)}else Vr=!1,Nt&&t.flags&1048576&&q1(t,pu,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Kc(e,t),e=t.pendingProps;var i=Xa(t,Pr.current);Ma(t,r),i=E0(null,t,n,e,i,r);var s=N0();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Yr(n)?(s=!0,hu(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,b0(t),i.updater=tf,t.stateNode=i,i._reactInternals=t,id(t,n,e,r),t=od(null,t,n,!0,s,r)):(t.tag=0,Nt&&s&&g0(t),Ir(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Kc(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=Ak(n),e=Fn(n,e),i){case 0:t=ad(null,t,n,e,r);break e;case 1:t=Ig(null,t,n,e,r);break e;case 11:t=Dg(null,t,n,e,r);break e;case 14:t=Rg(null,t,n,Fn(n.type,e),r);break e}throw Error(Fe(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Fn(n,i),ad(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Fn(n,i),Ig(e,t,n,i,r);case 3:e:{if(Nv(t),e===null)throw Error(Fe(387));n=t.pendingProps,s=t.memoizedState,i=s.element,tv(e,t),xu(t,n,null,r);var l=t.memoizedState;if(n=l.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=Ka(Error(Fe(423)),t),t=Mg(e,t,n,r,i);break e}else if(n!==i){i=Ka(Error(Fe(424)),t),t=Mg(e,t,n,r,i);break e}else for(nn=Vi(t.stateNode.containerInfo.firstChild),sn=t,Nt=!0,Dn=null,r=Z1(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ya(),n===i){t=_i(e,t,r);break e}Ir(e,t,n,r)}t=t.child}return t;case 5:return rv(t),e===null&&td(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,l=i.children,Kh(n,i)?l=null:s!==null&&Kh(n,s)&&(t.flags|=32),Ev(e,t),Ir(e,t,l,r),t.child;case 6:return e===null&&td(t),null;case 13:return Av(e,t,r);case 4:return k0(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Ga(t,null,n,r):Ir(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Fn(n,i),Dg(e,t,n,i,r);case 7:return Ir(e,t,t.pendingProps,r),t.child;case 8:return Ir(e,t,t.pendingProps.children,r),t.child;case 12:return Ir(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,l=i.value,wt(gu,n._currentValue),n._currentValue=l,s!==null)if(Wn(s.value,l)){if(s.children===i.children&&!Xr.current){t=_i(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){l=s.child;for(var a=o.firstContext;a!==null;){if(a.context===n){if(s.tag===1){a=di(-1,r&-r),a.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?a.next=a:(a.next=d.next,d.next=a),c.pending=a}}s.lanes|=r,a=s.alternate,a!==null&&(a.lanes|=r),rd(s.return,r,t),o.lanes|=r;break}a=a.next}}else if(s.tag===10)l=s.type===t.type?null:s.child;else if(s.tag===18){if(l=s.return,l===null)throw Error(Fe(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),rd(l,r,t),l=s.sibling}else l=s.child;if(l!==null)l.return=s;else for(l=s;l!==null;){if(l===t){l=null;break}if(s=l.sibling,s!==null){s.return=l.return,l=s;break}l=l.return}s=l}Ir(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Ma(t,r),i=Sn(i),n=n(i),t.flags|=1,Ir(e,t,n,r),t.child;case 14:return n=t.type,i=Fn(n,t.pendingProps),i=Fn(n.type,i),Rg(e,t,n,i,r);case 15:return Cv(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Fn(n,i),Kc(e,t),t.tag=1,Yr(n)?(e=!0,hu(t)):e=!1,Ma(t,r),bv(t,n,i),id(t,n,i,r),od(null,t,n,!0,e,r);case 19:return Ov(e,t,r);case 22:return Tv(e,t,r)}throw Error(Fe(156,t.tag))};function Xv(e,t){return y1(e,t)}function Nk(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wn(e,t,r,n){return new Nk(e,t,r,n)}function L0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ak(e){if(typeof e=="function")return L0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===n0)return 11;if(e===i0)return 14}return 2}function qi(e,t){var r=e.alternate;return r===null?(r=wn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Zc(e,t,r,n,i,s){var l=2;if(n=e,typeof e=="function")L0(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case wa:return As(r.children,i,s,t);case r0:l=8,i|=8;break;case Nh:return e=wn(12,r,t,i|2),e.elementType=Nh,e.lanes=s,e;case Ah:return e=wn(13,r,t,i),e.elementType=Ah,e.lanes=s,e;case Oh:return e=wn(19,r,t,i),e.elementType=Oh,e.lanes=s,e;case r1:return sf(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case e1:l=10;break e;case t1:l=9;break e;case n0:l=11;break e;case i0:l=14;break e;case ji:l=16,n=null;break e}throw Error(Fe(130,e==null?e:typeof e,""))}return t=wn(l,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function As(e,t,r,n){return e=wn(7,e,n,t),e.lanes=r,e}function sf(e,t,r,n){return e=wn(22,e,n,t),e.elementType=r1,e.lanes=r,e.stateNode={isHidden:!1},e}function Zf(e,t,r){return e=wn(6,e,null,t),e.lanes=r,e}function eh(e,t,r){return t=wn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ok(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Df(0),this.expirationTimes=Df(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Df(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function B0(e,t,r,n,i,s,l,o,a){return e=new Ok(e,t,r,o,a),t===1?(t=1,s===!0&&(t|=8)):t=0,s=wn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},b0(s),e}function Fk(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ya,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Yv(e){if(!e)return Zi;e=e._reactInternals;e:{if(Gs(e)!==e||e.tag!==1)throw Error(Fe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Yr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Fe(171))}if(e.tag===1){var r=e.type;if(Yr(r))return Y1(e,r,t)}return t}function Gv(e,t,r,n,i,s,l,o,a){return e=B0(r,n,!0,e,i,s,l,o,a),e.context=Yv(null),r=e.current,n=Br(),i=Gi(r),s=di(n,i),s.callback=t??null,Xi(r,s,i),e.current.lanes=i,Vl(e,i,n),Gr(e,n),e}function af(e,t,r,n){var i=t.current,s=Br(),l=Gi(i);return r=Yv(r),t.context===null?t.context=r:t.pendingContext=r,t=di(s,l),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Xi(i,t,l),e!==null&&(Ln(e,i,l,s),Yc(e,i,l)),l}function Cu(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Yg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function U0(e,t){Yg(e,t),(e=e.alternate)&&Yg(e,t)}function jk(){return null}var qv=typeof reportError=="function"?reportError:function(e){console.error(e)};function W0(e){this._internalRoot=e}of.prototype.render=W0.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Fe(409));af(e,t,null,null)};of.prototype.unmount=W0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Bs(function(){af(null,e,null,null)}),t[yi]=null}};function of(e){this._internalRoot=e}of.prototype.unstable_scheduleHydration=function(e){if(e){var t=T1();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Ri.length&&t!==0&&t<Ri[r].priority;r++);Ri.splice(r,0,e),r===0&&N1(e)}};function z0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function lf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Gg(){}function Pk(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=Cu(l);s.call(c)}}var l=Gv(t,n,e,0,null,!1,!1,"",Gg);return e._reactRootContainer=l,e[yi]=l.current,ul(e.nodeType===8?e.parentNode:e),Bs(),l}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=Cu(a);o.call(c)}}var a=B0(e,0,!1,null,null,!1,!1,"",Gg);return e._reactRootContainer=a,e[yi]=a.current,ul(e.nodeType===8?e.parentNode:e),Bs(function(){af(t,a,r,n)}),a}function cf(e,t,r,n,i){var s=r._reactRootContainer;if(s){var l=s;if(typeof i=="function"){var o=i;i=function(){var a=Cu(l);o.call(a)}}af(t,l,e,i)}else l=Pk(r,t,e,i,n);return Cu(l)}S1=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Ao(t.pendingLanes);r!==0&&(o0(t,r|1),Gr(t,Vt()),!(ot&6)&&(Ja=Vt()+500,ls()))}break;case 13:Bs(function(){var n=wi(e,1);if(n!==null){var i=Br();Ln(n,e,1,i)}}),U0(e,1)}};l0=function(e){if(e.tag===13){var t=wi(e,134217728);if(t!==null){var r=Br();Ln(t,e,134217728,r)}U0(e,134217728)}};C1=function(e){if(e.tag===13){var t=Gi(e),r=wi(e,t);if(r!==null){var n=Br();Ln(r,e,t,n)}U0(e,t)}};T1=function(){return mt};E1=function(e,t){var r=mt;try{return mt=e,t()}finally{mt=r}};Uh=function(e,t,r){switch(t){case"input":if(Ph(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Qu(n);if(!i)throw Error(Fe(90));i1(n),Ph(n,i)}}}break;case"textarea":a1(e,r);break;case"select":t=r.value,t!=null&&Pa(e,!!r.multiple,t,!1)}};d1=R0;p1=Bs;var Dk={usingClientEntryPoint:!1,Events:[Yl,Sa,Qu,f1,h1,R0]},bo={findFiberByHostInstance:bs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Rk={bundleType:bo.bundleType,version:bo.version,rendererPackageName:bo.rendererPackageName,rendererConfig:bo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Si.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=x1(e),e===null?null:e.stateNode},findFiberByHostInstance:bo.findFiberByHostInstance||jk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kc.isDisabled&&kc.supportsFiber)try{Gu=kc.inject(Rk),Zn=kc}catch{}}cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Dk;cn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!z0(t))throw Error(Fe(200));return Fk(e,t,null,r)};cn.createRoot=function(e,t){if(!z0(e))throw Error(Fe(299));var r=!1,n="",i=qv;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=B0(e,1,!1,null,null,r,!1,n,i),e[yi]=t.current,ul(e.nodeType===8?e.parentNode:e),new W0(t)};cn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Fe(188)):(e=Object.keys(e).join(","),Error(Fe(268,e)));return e=x1(t),e=e===null?null:e.stateNode,e};cn.flushSync=function(e){return Bs(e)};cn.hydrate=function(e,t,r){if(!lf(t))throw Error(Fe(200));return cf(null,e,t,!0,r)};cn.hydrateRoot=function(e,t,r){if(!z0(e))throw Error(Fe(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",l=qv;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=Gv(t,null,e,1,r??null,i,!1,s,l),e[yi]=t.current,ul(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new of(t)};cn.render=function(e,t,r){if(!lf(t))throw Error(Fe(200));return cf(null,e,t,!1,r)};cn.unmountComponentAtNode=function(e){if(!lf(e))throw Error(Fe(40));return e._reactRootContainer?(Bs(function(){cf(null,null,e,!1,function(){e._reactRootContainer=null,e[yi]=null})}),!0):!1};cn.unstable_batchedUpdates=R0;cn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!lf(r))throw Error(Fe(200));if(e==null||e._reactInternals===void 0)throw Error(Fe(38));return cf(e,t,r,!1,n)};cn.version="18.3.1-next-f1338f8080-20240426";function Kv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Kv)}catch(e){console.error(e)}}Kv(),Kx.exports=cn;var Jv=Kx.exports,qg=Jv;Th.createRoot=qg.createRoot,Th.hydrateRoot=qg.hydrateRoot;/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qv=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ik=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mk=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kg=e=>{const t=Mk(e);return t.charAt(0).toUpperCase()+t.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Lk={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bk=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uk=ne.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:l,...o},a)=>ne.createElement("svg",{ref:a,...Lk,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:Qv("lucide",i),...!s&&!Bk(o)&&{"aria-hidden":"true"},...o},[...l.map(([c,d])=>ne.createElement(c,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=(e,t)=>{const r=ne.forwardRef(({className:n,...i},s)=>ne.createElement(Uk,{ref:s,iconNode:t,className:Qv(`lucide-${Ik(Kg(e))}`,`lucide-${e}`,n),...i}));return r.displayName=Kg(e),r};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wk=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],zk=Ve("arrow-right",Wk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hk=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],th=Ve("award",Hk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $k=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Zv=Ve("book-open",$k);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vk=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],ey=Ve("box",Vk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xk=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],Yk=Ve("briefcase",Xk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gk=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],qs=Ve("calendar",Gk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qk=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Jg=Ve("chart-column",qk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kk=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],bn=Ve("check",Kk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jk=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Qg=Ve("chevron-down",Jk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qk=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],bi=Ve("chevron-left",Qk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zk=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],an=Ve("chevron-right",Zk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eS=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Zg=Ve("chevron-up",eS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ti=Ve("circle-alert",tS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Ki=Ve("circle-check",rS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],iS=Ve("circle-plus",nS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sS=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],aS=Ve("clipboard-check",sS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oS=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],es=Ve("clock",oS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lS=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],ty=Ve("download",lS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cS=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],uS=Ve("ellipsis",cS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fS=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],em=Ve("eraser",fS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],dS=Ve("file-down",hS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],gS=Ve("file-text",pS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mS=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],xS=Ve("graduation-cap",mS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],yS=Ve("grid-3x3",vS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wS=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],_S=Ve("hash",wS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bS=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],ry=Ve("house",bS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],ny=Ve("info",kS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SS=[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]],CS=Ve("layout-template",SS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TS=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],rh=Ve("loader-circle",TS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ES=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],NS=Ve("lock",ES);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AS=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],uf=Ve("log-out",AS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OS=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Us=Ve("map-pin",OS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FS=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],Tu=Ve("map",FS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jS=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],PS=Ve("navigation",jS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DS=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],RS=Ve("palette",DS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IS=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],Eu=Ve("panels-top-left",IS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MS=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],H0=Ve("pen-tool",MS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LS=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],BS=Ve("pen",LS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const US=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],yd=Ve("phone",US);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WS=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],yl=Ve("plus",WS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zS=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Nu=Ve("printer",zS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HS=[["path",{d:"M20.34 17.52a10 10 0 1 0-2.82 2.82",key:"fydyku"}],["circle",{cx:"19",cy:"19",r:"2",key:"17f5cg"}],["path",{d:"m13.41 13.41 4.18 4.18",key:"1gqbwc"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],$S=Ve("radius",HS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VS=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],XS=Ve("refresh-cw",VS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YS=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],GS=Ve("rotate-cw",YS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qS=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],wl=Ve("save",qS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KS=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],JS=Ve("school",KS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QS=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],wd=Ve("search",QS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZS=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],_d=Ve("settings",ZS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eC=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],$0=Ve("shield-check",eC);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tC=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],rC=Ve("square-pen",tC);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nC=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ts=Ve("trash-2",nC);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iC=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],sC=Ve("triangle-alert",iC);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aC=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],oC=Ve("upload",aC);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lC=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],_l=Ve("user",lC);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cC=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ql=Ve("users",cC);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uC=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Os=Ve("x",uC);var Ke={};const fC={},hC=Object.freeze(Object.defineProperty({__proto__:null,default:fC},Symbol.toStringTag,{value:"Module"})),nh=u2(hC);(function(e){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var t=t||{version:"5.5.2"};if(e.fabric=t,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?t.document=document:t.document=document.implementation.createHTMLDocument(""),t.window=window;else{var r=nh,n=new r.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;t.document=n.document,t.jsdomImplForWrapper=nh.implForWrapper,t.nodeCanvas=nh.Canvas,t.window=n,DOMParser=t.window.DOMParser}t.isTouchSupported="ontouchstart"in t.window||"ontouchstart"in t.document||t.window&&t.window.navigator&&t.window.navigator.maxTouchPoints>0,t.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",t.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],t.DPI=96,t.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",t.commaWsp="(?:\\s+,?\\s*|,\\s*)",t.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,t.reNonWord=/[ \n\.,;!\?\-]/,t.fontPaths={},t.iMatrix=[1,0,0,1,0,0],t.svgNS="http://www.w3.org/2000/svg",t.perfLimitSizeTotal=2097152,t.maxCacheSideLimit=4096,t.minCacheSideLimit=256,t.charWidthsCache={},t.textureSize=2048,t.disableStyleCopyPaste=!1,t.enableGLFiltering=!0,t.devicePixelRatio=t.window.devicePixelRatio||t.window.webkitDevicePixelRatio||t.window.mozDevicePixelRatio||1,t.browserShadowBlurConstant=1,t.arcToSegmentsCache={},t.boundsOfCurveCache={},t.cachesBoundsOfCurve=!0,t.forceGLPutImageData=!1,t.initFilterBackend=function(){if(t.enableGLFiltering&&t.isWebglSupported&&t.isWebglSupported(t.textureSize))return console.log("max texture size: "+t.maxTextureSize),new t.WebglFilterBackend({tileSize:t.textureSize});if(t.Canvas2dFilterBackend)return new t.Canvas2dFilterBackend},typeof document<"u"&&typeof window<"u"&&(window.fabric=t),function(){function o(u,p){if(this.__eventListeners[u]){var m=this.__eventListeners[u];p?m[m.indexOf(p)]=!1:t.util.array.fill(m,!1)}}function a(u,p){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var m in u)this.on(m,u[m]);else this.__eventListeners[u]||(this.__eventListeners[u]=[]),this.__eventListeners[u].push(p);return this}function c(u,p){var m=(function(){p.apply(this,arguments),this.off(u,m)}).bind(this);this.on(u,m)}function d(u,p){if(arguments.length===1)for(var m in u)c.call(this,m,u[m]);else c.call(this,u,p);return this}function h(u,p){if(!this.__eventListeners)return this;if(arguments.length===0)for(u in this.__eventListeners)o.call(this,u);else if(arguments.length===1&&typeof arguments[0]=="object")for(var m in u)o.call(this,m,u[m]);else o.call(this,u,p);return this}function f(u,p){if(!this.__eventListeners)return this;var m=this.__eventListeners[u];if(!m)return this;for(var g=0,x=m.length;g<x;g++)m[g]&&m[g].call(this,p||{});return this.__eventListeners[u]=m.filter(function(y){return y!==!1}),this}t.Observable={fire:f,on:a,once:d,off:h}}(),t.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var o=0,a=arguments.length;o<a;o++)this._onObjectAdded(arguments[o]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(o,a,c){var d=this._objects;return c?d[a]=o:d.splice(a,0,o),this._onObjectAdded&&this._onObjectAdded(o),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var o=this._objects,a,c=!1,d=0,h=arguments.length;d<h;d++)a=o.indexOf(arguments[d]),a!==-1&&(c=!0,o.splice(a,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[d]));return this.renderOnAddRemove&&c&&this.requestRenderAll(),this},forEachObject:function(o,a){for(var c=this.getObjects(),d=0,h=c.length;d<h;d++)o.call(a,c[d],d,c);return this},getObjects:function(o){return typeof o>"u"?this._objects.concat():this._objects.filter(function(a){return a.type===o})},item:function(o){return this._objects[o]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(o,a){return this._objects.indexOf(o)>-1?!0:a?this._objects.some(function(c){return typeof c.contains=="function"&&c.contains(o,!0)}):!1},complexity:function(){return this._objects.reduce(function(o,a){return o+=a.complexity?a.complexity():0,o},0)}},t.CommonMethods={_setOptions:function(o){for(var a in o)this.set(a,o[a])},_initGradient:function(o,a){o&&o.colorStops&&!(o instanceof t.Gradient)&&this.set(a,new t.Gradient(o))},_initPattern:function(o,a,c){o&&o.source&&!(o instanceof t.Pattern)?this.set(a,new t.Pattern(o,c)):c&&c()},_setObject:function(o){for(var a in o)this._set(a,o[a])},set:function(o,a){return typeof o=="object"?this._setObject(o):this._set(o,a),this},_set:function(o,a){this[o]=a},toggle:function(o){var a=this.get(o);return typeof a=="boolean"&&this.set(o,!a),this},get:function(o){return this[o]}},function(o){var a=Math.sqrt,c=Math.atan2,d=Math.pow,h=Math.PI/180,f=Math.PI/2;t.util={cos:function(u){if(u===0)return 1;u<0&&(u=-u);var p=u/f;switch(p){case 1:case 3:return 0;case 2:return-1}return Math.cos(u)},sin:function(u){if(u===0)return 0;var p=u/f,m=1;switch(u<0&&(m=-1),p){case 1:return m;case 2:return 0;case 3:return-m}return Math.sin(u)},removeFromArray:function(u,p){var m=u.indexOf(p);return m!==-1&&u.splice(m,1),u},getRandomInt:function(u,p){return Math.floor(Math.random()*(p-u+1))+u},degreesToRadians:function(u){return u*h},radiansToDegrees:function(u){return u/h},rotatePoint:function(u,p,m){var g=new t.Point(u.x-p.x,u.y-p.y),x=t.util.rotateVector(g,m);return new t.Point(x.x,x.y).addEquals(p)},rotateVector:function(u,p){var m=t.util.sin(p),g=t.util.cos(p),x=u.x*g-u.y*m,y=u.x*m+u.y*g;return{x,y}},createVector:function(u,p){return new t.Point(p.x-u.x,p.y-u.y)},calcAngleBetweenVectors:function(u,p){return Math.acos((u.x*p.x+u.y*p.y)/(Math.hypot(u.x,u.y)*Math.hypot(p.x,p.y)))},getHatVector:function(u){return new t.Point(u.x,u.y).multiply(1/Math.hypot(u.x,u.y))},getBisector:function(u,p,m){var g=t.util.createVector(u,p),x=t.util.createVector(u,m),y=t.util.calcAngleBetweenVectors(g,x),w=t.util.calcAngleBetweenVectors(t.util.rotateVector(g,y),x),_=y*(w===0?1:-1)/2;return{vector:t.util.getHatVector(t.util.rotateVector(g,_)),angle:y}},projectStrokeOnPoints:function(u,p,m){var g=[],x=p.strokeWidth/2,y=p.strokeUniform?new t.Point(1/p.scaleX,1/p.scaleY):new t.Point(1,1),w=function(_){var b=x/Math.hypot(_.x,_.y);return new t.Point(_.x*b*y.x,_.y*b*y.y)};return u.length<=1||u.forEach(function(_,b){var k=new t.Point(_.x,_.y),S,E;b===0?(E=u[b+1],S=m?w(t.util.createVector(E,k)).addEquals(k):u[u.length-1]):b===u.length-1?(S=u[b-1],E=m?w(t.util.createVector(S,k)).addEquals(k):u[0]):(S=u[b-1],E=u[b+1]);var F=t.util.getBisector(k,S,E),P=F.vector,D=F.angle,I,X;if(p.strokeLineJoin==="miter"&&(I=-x/Math.sin(D/2),X=new t.Point(P.x*I*y.x,P.y*I*y.y),Math.hypot(X.x,X.y)/x<=p.strokeMiterLimit)){g.push(k.add(X)),g.push(k.subtract(X));return}I=-x*Math.SQRT2,X=new t.Point(P.x*I*y.x,P.y*I*y.y),g.push(k.add(X)),g.push(k.subtract(X))}),g},transformPoint:function(u,p,m){return m?new t.Point(p[0]*u.x+p[2]*u.y,p[1]*u.x+p[3]*u.y):new t.Point(p[0]*u.x+p[2]*u.y+p[4],p[1]*u.x+p[3]*u.y+p[5])},makeBoundingBoxFromPoints:function(u,p){if(p)for(var m=0;m<u.length;m++)u[m]=t.util.transformPoint(u[m],p);var g=[u[0].x,u[1].x,u[2].x,u[3].x],x=t.util.array.min(g),y=t.util.array.max(g),w=y-x,_=[u[0].y,u[1].y,u[2].y,u[3].y],b=t.util.array.min(_),k=t.util.array.max(_),S=k-b;return{left:x,top:b,width:w,height:S}},invertTransform:function(u){var p=1/(u[0]*u[3]-u[1]*u[2]),m=[p*u[3],-p*u[1],-p*u[2],p*u[0]],g=t.util.transformPoint({x:u[4],y:u[5]},m,!0);return m[4]=-g.x,m[5]=-g.y,m},toFixed:function(u,p){return parseFloat(Number(u).toFixed(p))},parseUnit:function(u,p){var m=/\D{0,2}$/.exec(u),g=parseFloat(u);switch(p||(p=t.Text.DEFAULT_SVG_FONT_SIZE),m[0]){case"mm":return g*t.DPI/25.4;case"cm":return g*t.DPI/2.54;case"in":return g*t.DPI;case"pt":return g*t.DPI/72;case"pc":return g*t.DPI/72*12;case"em":return g*p;default:return g}},falseFunction:function(){return!1},getKlass:function(u,p){return u=t.util.string.camelize(u.charAt(0).toUpperCase()+u.slice(1)),t.util.resolveNamespace(p)[u]},getSvgAttributes:function(u){var p=["instantiated_by_use","style","id","class"];switch(u){case"linearGradient":p=p.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":p=p.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":p=p.concat(["offset","stop-color","stop-opacity"]);break}return p},resolveNamespace:function(u){if(!u)return t;var p=u.split("."),m=p.length,g,x=o||t.window;for(g=0;g<m;++g)x=x[p[g]];return x},loadImage:function(u,p,m,g){if(!u){p&&p.call(m,u);return}var x=t.util.createImage(),y=function(){p&&p.call(m,x,!1),x=x.onload=x.onerror=null};x.onload=y,x.onerror=function(){t.log("Error loading "+x.src),p&&p.call(m,null,!0),x=x.onload=x.onerror=null},u.indexOf("data")!==0&&g!==void 0&&g!==null&&(x.crossOrigin=g),u.substring(0,14)==="data:image/svg"&&(x.onload=null,t.util.loadImageInDom(x,y)),x.src=u},loadImageInDom:function(u,p){var m=t.document.createElement("div");m.style.width=m.style.height="1px",m.style.left=m.style.top="-100%",m.style.position="absolute",m.appendChild(u),t.document.querySelector("body").appendChild(m),u.onload=function(){p(),m.parentNode.removeChild(m),m=null}},enlivenObjects:function(u,p,m,g){u=u||[];var x=[],y=0,w=u.length;function _(){++y===w&&p&&p(x.filter(function(b){return b}))}if(!w){p&&p(x);return}u.forEach(function(b,k){if(!b||!b.type){_();return}var S=t.util.getKlass(b.type,m);S.fromObject(b,function(E,F){F||(x[k]=E),g&&g(b,E,F),_()})})},enlivenObjectEnlivables:function(u,p,m){var g=t.Object.ENLIVEN_PROPS.filter(function(x){return!!u[x]});t.util.enlivenObjects(g.map(function(x){return u[x]}),function(x){var y={};g.forEach(function(w,_){y[w]=x[_],p&&(p[w]=x[_])}),m&&m(y)})},enlivenPatterns:function(u,p){u=u||[];function m(){++x===y&&p&&p(g)}var g=[],x=0,y=u.length;if(!y){p&&p(g);return}u.forEach(function(w,_){w&&w.source?new t.Pattern(w,function(b){g[_]=b,m()}):(g[_]=w,m())})},groupSVGElements:function(u,p,m){var g;return u&&u.length===1?(typeof m<"u"&&(u[0].sourcePath=m),u[0]):(p&&(p.width&&p.height?p.centerPoint={x:p.width/2,y:p.height/2}:(delete p.width,delete p.height)),g=new t.Group(u,p),typeof m<"u"&&(g.sourcePath=m),g)},populateWithProperties:function(u,p,m){if(m&&Array.isArray(m))for(var g=0,x=m.length;g<x;g++)m[g]in u&&(p[m[g]]=u[m[g]])},createCanvasElement:function(){return t.document.createElement("canvas")},copyCanvasElement:function(u){var p=t.util.createCanvasElement();return p.width=u.width,p.height=u.height,p.getContext("2d").drawImage(u,0,0),p},toDataURL:function(u,p,m){return u.toDataURL("image/"+p,m)},createImage:function(){return t.document.createElement("img")},multiplyTransformMatrices:function(u,p,m){return[u[0]*p[0]+u[2]*p[1],u[1]*p[0]+u[3]*p[1],u[0]*p[2]+u[2]*p[3],u[1]*p[2]+u[3]*p[3],m?0:u[0]*p[4]+u[2]*p[5]+u[4],m?0:u[1]*p[4]+u[3]*p[5]+u[5]]},qrDecompose:function(u){var p=c(u[1],u[0]),m=d(u[0],2)+d(u[1],2),g=a(m),x=(u[0]*u[3]-u[2]*u[1])/g,y=c(u[0]*u[2]+u[1]*u[3],m);return{angle:p/h,scaleX:g,scaleY:x,skewX:y/h,skewY:0,translateX:u[4],translateY:u[5]}},calcRotateMatrix:function(u){if(!u.angle)return t.iMatrix.concat();var p=t.util.degreesToRadians(u.angle),m=t.util.cos(p),g=t.util.sin(p);return[m,g,-g,m,0,0]},calcDimensionsMatrix:function(u){var p=typeof u.scaleX>"u"?1:u.scaleX,m=typeof u.scaleY>"u"?1:u.scaleY,g=[u.flipX?-p:p,0,0,u.flipY?-m:m,0,0],x=t.util.multiplyTransformMatrices,y=t.util.degreesToRadians;return u.skewX&&(g=x(g,[1,0,Math.tan(y(u.skewX)),1],!0)),u.skewY&&(g=x(g,[1,Math.tan(y(u.skewY)),0,1],!0)),g},composeMatrix:function(u){var p=[1,0,0,1,u.translateX||0,u.translateY||0],m=t.util.multiplyTransformMatrices;return u.angle&&(p=m(p,t.util.calcRotateMatrix(u))),(u.scaleX!==1||u.scaleY!==1||u.skewX||u.skewY||u.flipX||u.flipY)&&(p=m(p,t.util.calcDimensionsMatrix(u))),p},resetObjectTransform:function(u){u.scaleX=1,u.scaleY=1,u.skewX=0,u.skewY=0,u.flipX=!1,u.flipY=!1,u.rotate(0)},saveObjectTransform:function(u){return{scaleX:u.scaleX,scaleY:u.scaleY,skewX:u.skewX,skewY:u.skewY,angle:u.angle,left:u.left,flipX:u.flipX,flipY:u.flipY,top:u.top}},isTransparent:function(u,p,m,g){g>0&&(p>g?p-=g:p=0,m>g?m-=g:m=0);var x=!0,y,w,_=u.getImageData(p,m,g*2||1,g*2||1),b=_.data.length;for(y=3;y<b&&(w=_.data[y],x=w<=0,x!==!1);y+=4);return _=null,x},parsePreserveAspectRatioAttribute:function(u){var p="meet",m="Mid",g="Mid",x=u.split(" "),y;return x&&x.length&&(p=x.pop(),p!=="meet"&&p!=="slice"?(y=p,p="meet"):x.length&&(y=x.pop())),m=y!=="none"?y.slice(1,4):"none",g=y!=="none"?y.slice(5,8):"none",{meetOrSlice:p,alignX:m,alignY:g}},clearFabricFontCache:function(u){u=(u||"").toLowerCase(),u?t.charWidthsCache[u]&&delete t.charWidthsCache[u]:t.charWidthsCache={}},limitDimsByArea:function(u,p){var m=Math.sqrt(p*u),g=Math.floor(p/m);return{x:Math.floor(m),y:g}},capValue:function(u,p,m){return Math.max(u,Math.min(p,m))},findScaleToFit:function(u,p){return Math.min(p.width/u.width,p.height/u.height)},findScaleToCover:function(u,p){return Math.max(p.width/u.width,p.height/u.height)},matrixToSVG:function(u){return"matrix("+u.map(function(p){return t.util.toFixed(p,t.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(u,p){var m=t.util.invertTransform(p),g=t.util.multiplyTransformMatrices(m,u.calcOwnMatrix());t.util.applyTransformToObject(u,g)},addTransformToObject:function(u,p){t.util.applyTransformToObject(u,t.util.multiplyTransformMatrices(p,u.calcOwnMatrix()))},applyTransformToObject:function(u,p){var m=t.util.qrDecompose(p),g=new t.Point(m.translateX,m.translateY);u.flipX=!1,u.flipY=!1,u.set("scaleX",m.scaleX),u.set("scaleY",m.scaleY),u.skewX=m.skewX,u.skewY=m.skewY,u.angle=m.angle,u.setPositionByOrigin(g,"center","center")},sizeAfterTransform:function(u,p,m){var g=u/2,x=p/2,y=[{x:-g,y:-x},{x:g,y:-x},{x:-g,y:x},{x:g,y:x}],w=t.util.calcDimensionsMatrix(m),_=t.util.makeBoundingBoxFromPoints(y,w);return{x:_.width,y:_.height}},mergeClipPaths:function(u,p){var m=u,g=p;m.inverted&&!g.inverted&&(m=p,g=u),t.util.applyTransformToObject(g,t.util.multiplyTransformMatrices(t.util.invertTransform(m.calcTransformMatrix()),g.calcTransformMatrix()));var x=m.inverted&&g.inverted;return x&&(m.inverted=g.inverted=!1),new t.Group([m],{clipPath:g,inverted:x})},hasStyleChanged:function(u,p,m){return m=m||!1,u.fill!==p.fill||u.stroke!==p.stroke||u.strokeWidth!==p.strokeWidth||u.fontSize!==p.fontSize||u.fontFamily!==p.fontFamily||u.fontWeight!==p.fontWeight||u.fontStyle!==p.fontStyle||u.textBackgroundColor!==p.textBackgroundColor||u.deltaY!==p.deltaY||m&&(u.overline!==p.overline||u.underline!==p.underline||u.linethrough!==p.linethrough)},stylesToArray:function(m,p){for(var m=t.util.object.clone(m,!0),g=p.split(`
`),x=-1,y={},w=[],_=0;_<g.length;_++){if(!m[_]){x+=g[_].length;continue}for(var b=0;b<g[_].length;b++){x++;var k=m[_][b];if(k&&Object.keys(k).length>0){var S=t.util.hasStyleChanged(y,k,!0);S?w.push({start:x,end:x+1,style:k}):w[w.length-1].end++}y=k||{}}}return w},stylesFromArray:function(u,p){if(!Array.isArray(u))return u;for(var m=p.split(`
`),g=-1,x=0,y={},w=0;w<m.length;w++)for(var _=0;_<m[w].length;_++)g++,u[x]&&u[x].start<=g&&g<u[x].end&&(y[w]=y[w]||{},y[w][_]=Object.assign({},u[x].style),g===u[x].end-1&&x++);return y}}}(e),function(){var o=Array.prototype.join,a={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},c={m:"l",M:"L"};function d(C,L,B,N,U,A,T,j,M,Y,H){var V=t.util.cos(C),fe=t.util.sin(C),O=t.util.cos(L),Q=t.util.sin(L),K=B*U*O-N*A*Q+T,ce=N*U*O+B*A*Q+j,te=Y+M*(-B*U*fe-N*A*V),R=H+M*(-N*U*fe+B*A*V),ue=K+M*(B*U*Q+N*A*O),oe=ce+M*(N*U*Q-B*A*O);return["C",te,R,ue,oe,K,ce]}function h(C,L,B,N,U,A,T){var j=Math.PI,M=T*j/180,Y=t.util.sin(M),H=t.util.cos(M),V=0,fe=0;B=Math.abs(B),N=Math.abs(N);var O=-H*C*.5-Y*L*.5,Q=-H*L*.5+Y*C*.5,K=B*B,ce=N*N,te=Q*Q,R=O*O,ue=K*ce-K*te-ce*R,oe=0;if(ue<0){var he=Math.sqrt(1-ue/(K*ce));B*=he,N*=he}else oe=(U===A?-1:1)*Math.sqrt(ue/(K*te+ce*R));var de=oe*B*Q/N,ie=-oe*N*O/B,pe=H*de-Y*ie+C*.5,Se=Y*de+H*ie+L*.5,De=f(1,0,(O-de)/B,(Q-ie)/N),we=f((O-de)/B,(Q-ie)/N,(-O-de)/B,(-Q-ie)/N);A===0&&we>0?we-=2*j:A===1&&we<0&&(we+=2*j);for(var ve=Math.ceil(Math.abs(we/j*2)),Ae=[],Ee=we/ve,Ne=8/3*Math.sin(Ee/4)*Math.sin(Ee/4)/Math.sin(Ee/2),Ie=De+Ee,We=0;We<ve;We++)Ae[We]=d(De,Ie,H,Y,B,N,pe,Se,Ne,V,fe),V=Ae[We][5],fe=Ae[We][6],De=Ie,Ie+=Ee;return Ae}function f(C,L,B,N){var U=Math.atan2(L,C),A=Math.atan2(N,B);return A>=U?A-U:2*Math.PI-(U-A)}function u(C,L,B,N,U,A,T,j){var M;if(t.cachesBoundsOfCurve&&(M=o.call(arguments),t.boundsOfCurveCache[M]))return t.boundsOfCurveCache[M];var Y=Math.sqrt,H=Math.min,V=Math.max,fe=Math.abs,O=[],Q=[[],[]],K,ce,te,R,ue,oe,he,de;ce=6*C-12*B+6*U,K=-3*C+9*B-9*U+3*T,te=3*B-3*C;for(var ie=0;ie<2;++ie){if(ie>0&&(ce=6*L-12*N+6*A,K=-3*L+9*N-9*A+3*j,te=3*N-3*L),fe(K)<1e-12){if(fe(ce)<1e-12)continue;R=-te/ce,0<R&&R<1&&O.push(R);continue}he=ce*ce-4*te*K,!(he<0)&&(de=Y(he),ue=(-ce+de)/(2*K),0<ue&&ue<1&&O.push(ue),oe=(-ce-de)/(2*K),0<oe&&oe<1&&O.push(oe))}for(var pe,Se,De=O.length,we=De,ve;De--;)R=O[De],ve=1-R,pe=ve*ve*ve*C+3*ve*ve*R*B+3*ve*R*R*U+R*R*R*T,Q[0][De]=pe,Se=ve*ve*ve*L+3*ve*ve*R*N+3*ve*R*R*A+R*R*R*j,Q[1][De]=Se;Q[0][we]=C,Q[1][we]=L,Q[0][we+1]=T,Q[1][we+1]=j;var Ae=[{x:H.apply(null,Q[0]),y:H.apply(null,Q[1])},{x:V.apply(null,Q[0]),y:V.apply(null,Q[1])}];return t.cachesBoundsOfCurve&&(t.boundsOfCurveCache[M]=Ae),Ae}function p(C,L,B){for(var N=B[1],U=B[2],A=B[3],T=B[4],j=B[5],M=B[6],Y=B[7],H=h(M-C,Y-L,N,U,T,j,A),V=0,fe=H.length;V<fe;V++)H[V][1]+=C,H[V][2]+=L,H[V][3]+=C,H[V][4]+=L,H[V][5]+=C,H[V][6]+=L;return H}function m(C){var L=0,B=0,N=C.length,U=0,A=0,T,j,M,Y=[],H,V,fe;for(j=0;j<N;++j){switch(M=!1,T=C[j].slice(0),T[0]){case"l":T[0]="L",T[1]+=L,T[2]+=B;case"L":L=T[1],B=T[2];break;case"h":T[1]+=L;case"H":T[0]="L",T[2]=B,L=T[1];break;case"v":T[1]+=B;case"V":T[0]="L",B=T[1],T[1]=L,T[2]=B;break;case"m":T[0]="M",T[1]+=L,T[2]+=B;case"M":L=T[1],B=T[2],U=T[1],A=T[2];break;case"c":T[0]="C",T[1]+=L,T[2]+=B,T[3]+=L,T[4]+=B,T[5]+=L,T[6]+=B;case"C":V=T[3],fe=T[4],L=T[5],B=T[6];break;case"s":T[0]="S",T[1]+=L,T[2]+=B,T[3]+=L,T[4]+=B;case"S":H==="C"?(V=2*L-V,fe=2*B-fe):(V=L,fe=B),L=T[3],B=T[4],T[0]="C",T[5]=T[3],T[6]=T[4],T[3]=T[1],T[4]=T[2],T[1]=V,T[2]=fe,V=T[3],fe=T[4];break;case"q":T[0]="Q",T[1]+=L,T[2]+=B,T[3]+=L,T[4]+=B;case"Q":V=T[1],fe=T[2],L=T[3],B=T[4];break;case"t":T[0]="T",T[1]+=L,T[2]+=B;case"T":H==="Q"?(V=2*L-V,fe=2*B-fe):(V=L,fe=B),T[0]="Q",L=T[1],B=T[2],T[1]=V,T[2]=fe,T[3]=L,T[4]=B;break;case"a":T[0]="A",T[6]+=L,T[7]+=B;case"A":M=!0,Y=Y.concat(p(L,B,T)),L=T[6],B=T[7];break;case"z":case"Z":L=U,B=A;break}M||Y.push(T),H=T[0]}return Y}function g(C,L,B,N){return Math.sqrt((B-C)*(B-C)+(N-L)*(N-L))}function x(C){return C*C*C}function y(C){return 3*C*C*(1-C)}function w(C){return 3*C*(1-C)*(1-C)}function _(C){return(1-C)*(1-C)*(1-C)}function b(C,L,B,N,U,A,T,j){return function(M){var Y=x(M),H=y(M),V=w(M),fe=_(M);return{x:T*Y+U*H+B*V+C*fe,y:j*Y+A*H+N*V+L*fe}}}function k(C,L,B,N,U,A,T,j){return function(M){var Y=1-M,H=3*Y*Y*(B-C)+6*Y*M*(U-B)+3*M*M*(T-U),V=3*Y*Y*(N-L)+6*Y*M*(A-N)+3*M*M*(j-A);return Math.atan2(V,H)}}function S(C){return C*C}function E(C){return 2*C*(1-C)}function F(C){return(1-C)*(1-C)}function P(C,L,B,N,U,A){return function(T){var j=S(T),M=E(T),Y=F(T);return{x:U*j+B*M+C*Y,y:A*j+N*M+L*Y}}}function D(C,L,B,N,U,A){return function(T){var j=1-T,M=2*j*(B-C)+2*T*(U-B),Y=2*j*(N-L)+2*T*(A-N);return Math.atan2(Y,M)}}function I(C,L,B){var N={x:L,y:B},U,A=0,T;for(T=1;T<=100;T+=1)U=C(T/100),A+=g(N.x,N.y,U.x,U.y),N=U;return A}function X(C,L){for(var B=0,N=0,U=C.iterator,A={x:C.x,y:C.y},T,j,M=.01,Y=C.angleFinder,H;N<L&&M>1e-4;)T=U(B),H=B,j=g(A.x,A.y,T.x,T.y),j+N>L?(B-=M,M/=2):(A=T,B+=M,N+=j);return T.angle=Y(H),T}function z(C){for(var L=0,B=C.length,N,U=0,A=0,T=0,j=0,M=[],Y,H,V,fe=0;fe<B;fe++){switch(N=C[fe],H={x:U,y:A,command:N[0]},N[0]){case"M":H.length=0,T=U=N[1],j=A=N[2];break;case"L":H.length=g(U,A,N[1],N[2]),U=N[1],A=N[2];break;case"C":Y=b(U,A,N[1],N[2],N[3],N[4],N[5],N[6]),V=k(U,A,N[1],N[2],N[3],N[4],N[5],N[6]),H.iterator=Y,H.angleFinder=V,H.length=I(Y,U,A),U=N[5],A=N[6];break;case"Q":Y=P(U,A,N[1],N[2],N[3],N[4]),V=D(U,A,N[1],N[2],N[3],N[4]),H.iterator=Y,H.angleFinder=V,H.length=I(Y,U,A),U=N[3],A=N[4];break;case"Z":case"z":H.destX=T,H.destY=j,H.length=g(U,A,T,j),U=T,A=j;break}L+=H.length,M.push(H)}return M.push({length:L,x:U,y:A}),M}function G(C,L,B){B||(B=z(C));for(var N=0;L-B[N].length>0&&N<B.length-2;)L-=B[N].length,N++;var U=B[N],A=L/U.length,T=U.command,j=C[N],M;switch(T){case"M":return{x:U.x,y:U.y,angle:0};case"Z":case"z":return M=new t.Point(U.x,U.y).lerp(new t.Point(U.destX,U.destY),A),M.angle=Math.atan2(U.destY-U.y,U.destX-U.x),M;case"L":return M=new t.Point(U.x,U.y).lerp(new t.Point(j[1],j[2]),A),M.angle=Math.atan2(j[2]-U.y,j[1]-U.x),M;case"C":return X(U,L);case"Q":return X(U,L)}}function ae(C){var L=[],B=[],N,U,A=t.rePathCommand,T="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",j="("+T+")"+t.commaWsp,M="([01])"+t.commaWsp+"?",Y=j+"?"+j+"?"+j+M+M+j+"?("+T+")",H=new RegExp(Y,"g"),V,fe,O;if(!C||!C.match)return L;O=C.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var Q=0,K,ce=O.length;Q<ce;Q++){N=O[Q],fe=N.slice(1).trim(),B.length=0;var te=N.charAt(0);if(K=[te],te.toLowerCase()==="a")for(var R;R=H.exec(fe);)for(var ue=1;ue<R.length;ue++)B.push(R[ue]);else for(;V=A.exec(fe);)B.push(V[0]);for(var ue=0,oe=B.length;ue<oe;ue++)U=parseFloat(B[ue]),isNaN(U)||K.push(U);var he=a[te.toLowerCase()],de=c[te]||te;if(K.length-1>he)for(var ie=1,pe=K.length;ie<pe;ie+=he)L.push([te].concat(K.slice(ie,ie+he))),te=de;else L.push(K)}return L}function le(C,L){var B=[],N,U=new t.Point(C[0].x,C[0].y),A=new t.Point(C[1].x,C[1].y),T=C.length,j=1,M=0,Y=T>2;for(L=L||0,Y&&(j=C[2].x<A.x?-1:C[2].x===A.x?0:1,M=C[2].y<A.y?-1:C[2].y===A.y?0:1),B.push(["M",U.x-j*L,U.y-M*L]),N=1;N<T;N++){if(!U.eq(A)){var H=U.midPointFrom(A);B.push(["Q",U.x,U.y,H.x,H.y])}U=C[N],N+1<C.length&&(A=C[N+1])}return Y&&(j=U.x>C[N-2].x?1:U.x===C[N-2].x?0:-1,M=U.y>C[N-2].y?1:U.y===C[N-2].y?0:-1),B.push(["L",U.x+j*L,U.y+M*L]),B}function Z(C,L,B){return B&&(L=t.util.multiplyTransformMatrices(L,[1,0,0,1,-B.x,-B.y])),C.map(function(N){for(var U=N.slice(0),A={},T=1;T<N.length-1;T+=2)A.x=N[T],A.y=N[T+1],A=t.util.transformPoint(A,L),U[T]=A.x,U[T+1]=A.y;return U})}t.util.joinPath=function(C){return C.map(function(L){return L.join(" ")}).join(" ")},t.util.parsePath=ae,t.util.makePathSimpler=m,t.util.getSmoothPathFromPoints=le,t.util.getPathSegmentsInfo=z,t.util.getBoundsOfCurve=u,t.util.getPointOnPath=G,t.util.transformPath=Z}(),function(){var o=Array.prototype.slice;function a(u,p){for(var m=o.call(arguments,2),g=[],x=0,y=u.length;x<y;x++)g[x]=m.length?u[x][p].apply(u[x],m):u[x][p].call(u[x]);return g}function c(u,p){return f(u,p,function(m,g){return m>=g})}function d(u,p){return f(u,p,function(m,g){return m<g})}function h(u,p){for(var m=u.length;m--;)u[m]=p;return u}function f(u,p,m){if(!(!u||u.length===0)){var g=u.length-1,x=p?u[g][p]:u[g];if(p)for(;g--;)m(u[g][p],x)&&(x=u[g][p]);else for(;g--;)m(u[g],x)&&(x=u[g]);return x}}t.util.array={fill:h,invoke:a,min:d,max:c}}(),function(){function o(c,d,h){if(h)if(!t.isLikelyNode&&d instanceof Element)c=d;else if(d instanceof Array){c=[];for(var f=0,u=d.length;f<u;f++)c[f]=o({},d[f],h)}else if(d&&typeof d=="object")for(var p in d)p==="canvas"||p==="group"?c[p]=null:d.hasOwnProperty(p)&&(c[p]=o({},d[p],h));else c=d;else for(var p in d)c[p]=d[p];return c}function a(c,d){return o({},c,d)}t.util.object={extend:o,clone:a},t.util.object.extend(t.util,t.Observable)}(),function(){function o(f){return f.replace(/-+(.)?/g,function(u,p){return p?p.toUpperCase():""})}function a(f,u){return f.charAt(0).toUpperCase()+(u?f.slice(1):f.slice(1).toLowerCase())}function c(f){return f.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function d(f){var u=0,p,m=[];for(u=0,p;u<f.length;u++)(p=h(f,u))!==!1&&m.push(p);return m}function h(f,u){var p=f.charCodeAt(u);if(isNaN(p))return"";if(p<55296||p>57343)return f.charAt(u);if(55296<=p&&p<=56319){if(f.length<=u+1)throw"High surrogate without following low surrogate";var m=f.charCodeAt(u+1);if(56320>m||m>57343)throw"High surrogate without following low surrogate";return f.charAt(u)+f.charAt(u+1)}if(u===0)throw"Low surrogate without preceding high surrogate";var g=f.charCodeAt(u-1);if(55296>g||g>56319)throw"Low surrogate without preceding high surrogate";return!1}t.util.string={camelize:o,capitalize:a,escapeXml:c,graphemeSplit:d}}(),function(){var o=Array.prototype.slice,a=function(){},c=function(){for(var p in{toString:1})if(p==="toString")return!1;return!0}(),d=function(p,m,g){for(var x in m)x in p.prototype&&typeof p.prototype[x]=="function"&&(m[x]+"").indexOf("callSuper")>-1?p.prototype[x]=function(y){return function(){var w=this.constructor.superclass;this.constructor.superclass=g;var _=m[y].apply(this,arguments);if(this.constructor.superclass=w,y!=="initialize")return _}}(x):p.prototype[x]=m[x],c&&(m.toString!==Object.prototype.toString&&(p.prototype.toString=m.toString),m.valueOf!==Object.prototype.valueOf&&(p.prototype.valueOf=m.valueOf))};function h(){}function f(p){for(var m=null,g=this;g.constructor.superclass;){var x=g.constructor.superclass.prototype[p];if(g[p]!==x){m=x;break}g=g.constructor.superclass.prototype}return m?arguments.length>1?m.apply(this,o.call(arguments,1)):m.call(this):console.log("tried to callSuper "+p+", method not found in prototype chain",this)}function u(){var p=null,m=o.call(arguments,0);typeof m[0]=="function"&&(p=m.shift());function g(){this.initialize.apply(this,arguments)}g.superclass=p,g.subclasses=[],p&&(h.prototype=p.prototype,g.prototype=new h,p.subclasses.push(g));for(var x=0,y=m.length;x<y;x++)d(g,m[x],p);return g.prototype.initialize||(g.prototype.initialize=a),g.prototype.constructor=g,g.prototype.callSuper=f,g}t.util.createClass=u}(),function(){var o=!!t.document.createElement("div").attachEvent,a=["touchstart","touchmove","touchend"];t.util.addListener=function(d,h,f,u){d&&d.addEventListener(h,f,o?!1:u)},t.util.removeListener=function(d,h,f,u){d&&d.removeEventListener(h,f,o?!1:u)};function c(d){var h=d.changedTouches;return h&&h[0]?h[0]:d}t.util.getPointer=function(d){var h=d.target,f=t.util.getScrollLeftTop(h),u=c(d);return{x:u.clientX+f.left,y:u.clientY+f.top}},t.util.isTouchEvent=function(d){return a.indexOf(d.type)>-1||d.pointerType==="touch"}}(),function(){function o(u,p){var m=u.style;if(!m)return u;if(typeof p=="string")return u.style.cssText+=";"+p,p.indexOf("opacity")>-1?f(u,p.match(/opacity:\s*(\d?\.?\d*)/)[1]):u;for(var g in p)if(g==="opacity")f(u,p[g]);else{var x=g==="float"||g==="cssFloat"?typeof m.styleFloat>"u"?"cssFloat":"styleFloat":g;m.setProperty(x,p[g])}return u}var a=t.document.createElement("div"),c=typeof a.style.opacity=="string",d=typeof a.style.filter=="string",h=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,f=function(u){return u};c?f=function(u,p){return u.style.opacity=p,u}:d&&(f=function(u,p){var m=u.style;return u.currentStyle&&!u.currentStyle.hasLayout&&(m.zoom=1),h.test(m.filter)?(p=p>=.9999?"":"alpha(opacity="+p*100+")",m.filter=m.filter.replace(h,p)):m.filter+=" alpha(opacity="+p*100+")",u}),t.util.setStyle=o}(),function(){var o=Array.prototype.slice;function a(_){return typeof _=="string"?t.document.getElementById(_):_}var c,d=function(_){return o.call(_,0)};try{c=d(t.document.childNodes)instanceof Array}catch{}c||(d=function(_){for(var b=new Array(_.length),k=_.length;k--;)b[k]=_[k];return b});function h(_,b){var k=t.document.createElement(_);for(var S in b)S==="class"?k.className=b[S]:S==="for"?k.htmlFor=b[S]:k.setAttribute(S,b[S]);return k}function f(_,b){_&&(" "+_.className+" ").indexOf(" "+b+" ")===-1&&(_.className+=(_.className?" ":"")+b)}function u(_,b,k){return typeof b=="string"&&(b=h(b,k)),_.parentNode&&_.parentNode.replaceChild(b,_),b.appendChild(_),b}function p(_){for(var b=0,k=0,S=t.document.documentElement,E=t.document.body||{scrollLeft:0,scrollTop:0};_&&(_.parentNode||_.host)&&(_=_.parentNode||_.host,_===t.document?(b=E.scrollLeft||S.scrollLeft||0,k=E.scrollTop||S.scrollTop||0):(b+=_.scrollLeft||0,k+=_.scrollTop||0),!(_.nodeType===1&&_.style.position==="fixed")););return{left:b,top:k}}function m(_){var b,k=_&&_.ownerDocument,S={left:0,top:0},E={left:0,top:0},F,P={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!k)return E;for(var D in P)E[P[D]]+=parseInt(g(_,D),10)||0;return b=k.documentElement,typeof _.getBoundingClientRect<"u"&&(S=_.getBoundingClientRect()),F=p(_),{left:S.left+F.left-(b.clientLeft||0)+E.left,top:S.top+F.top-(b.clientTop||0)+E.top}}var g;t.document.defaultView&&t.document.defaultView.getComputedStyle?g=function(_,b){var k=t.document.defaultView.getComputedStyle(_,null);return k?k[b]:void 0}:g=function(_,b){var k=_.style[b];return!k&&_.currentStyle&&(k=_.currentStyle[b]),k},function(){var _=t.document.documentElement.style,b="userSelect"in _?"userSelect":"MozUserSelect"in _?"MozUserSelect":"WebkitUserSelect"in _?"WebkitUserSelect":"KhtmlUserSelect"in _?"KhtmlUserSelect":"";function k(E){return typeof E.onselectstart<"u"&&(E.onselectstart=t.util.falseFunction),b?E.style[b]="none":typeof E.unselectable=="string"&&(E.unselectable="on"),E}function S(E){return typeof E.onselectstart<"u"&&(E.onselectstart=null),b?E.style[b]="":typeof E.unselectable=="string"&&(E.unselectable=""),E}t.util.makeElementUnselectable=k,t.util.makeElementSelectable=S}();function x(_){var b=t.jsdomImplForWrapper(_);return b._canvas||b._image}function y(_){if(t.isLikelyNode){var b=t.jsdomImplForWrapper(_);b&&(b._image=null,b._canvas=null,b._currentSrc=null,b._attributes=null,b._classList=null)}}function w(_,b){_.imageSmoothingEnabled=_.imageSmoothingEnabled||_.webkitImageSmoothingEnabled||_.mozImageSmoothingEnabled||_.msImageSmoothingEnabled||_.oImageSmoothingEnabled,_.imageSmoothingEnabled=b}t.util.setImageSmoothing=w,t.util.getById=a,t.util.toArray=d,t.util.addClass=f,t.util.makeElement=h,t.util.wrapElement=u,t.util.getScrollLeftTop=p,t.util.getElementOffset=m,t.util.getNodeCanvas=x,t.util.cleanUpJsdomNode=y}(),function(){function o(d,h){return d+(/\?/.test(d)?"&":"?")+h}function a(){}function c(d,h){h||(h={});var f=h.method?h.method.toUpperCase():"GET",u=h.onComplete||function(){},p=new t.window.XMLHttpRequest,m=h.body||h.parameters;return p.onreadystatechange=function(){p.readyState===4&&(u(p),p.onreadystatechange=a)},f==="GET"&&(m=null,typeof h.parameters=="string"&&(d=o(d,h.parameters))),p.open(f,d,!0),(f==="POST"||f==="PUT")&&p.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),p.send(m),p}t.util.request=c}(),t.log=console.log,t.warn=console.warn,function(){var o=t.util.object.extend,a=t.util.object.clone,c=[];t.util.object.extend(c,{cancelAll:function(){var x=this.splice(0);return x.forEach(function(y){y.cancel()}),x},cancelByCanvas:function(x){if(!x)return[];var y=this.filter(function(w){return typeof w.target=="object"&&w.target.canvas===x});return y.forEach(function(w){w.cancel()}),y},cancelByTarget:function(x){var y=this.findAnimationsByTarget(x);return y.forEach(function(w){w.cancel()}),y},findAnimationIndex:function(x){return this.indexOf(this.findAnimation(x))},findAnimation:function(x){return this.find(function(y){return y.cancel===x})},findAnimationsByTarget:function(x){return x?this.filter(function(y){return y.target===x}):[]}});function d(){return!1}function h(x,y,w,_){return-w*Math.cos(x/_*(Math.PI/2))+w+y}function f(x){x||(x={});var y=!1,w,_=function(){var b=t.runningAnimations.indexOf(w);return b>-1&&t.runningAnimations.splice(b,1)[0]};return w=o(a(x),{cancel:function(){return y=!0,_()},currentValue:"startValue"in x?x.startValue:0,completionRate:0,durationRate:0}),t.runningAnimations.push(w),m(function(b){var k=b||+new Date,S=x.duration||500,E=k+S,F,P=x.onChange||d,D=x.abort||d,I=x.onComplete||d,X=x.easing||h,z="startValue"in x?x.startValue.length>0:!1,G="startValue"in x?x.startValue:0,ae="endValue"in x?x.endValue:100,le=x.byValue||(z?G.map(function(Z,C){return ae[C]-G[C]}):ae-G);x.onStart&&x.onStart(),function Z(C){F=C||+new Date;var L=F>E?S:F-k,B=L/S,N=z?G.map(function(A,T){return X(L,G[T],le[T],S)}):X(L,G,le,S),U=Math.abs(z?(N[0]-G[0])/le[0]:(N-G)/le);if(w.currentValue=z?N.slice():N,w.completionRate=U,w.durationRate=B,!y){if(D(N,U,B)){_();return}if(F>E){w.currentValue=z?ae.slice():ae,w.completionRate=1,w.durationRate=1,P(z?ae.slice():ae,1,1),I(ae,1,1),_();return}else P(N,U,B),m(Z)}}(k)}),w.cancel}var u=t.window.requestAnimationFrame||t.window.webkitRequestAnimationFrame||t.window.mozRequestAnimationFrame||t.window.oRequestAnimationFrame||t.window.msRequestAnimationFrame||function(x){return t.window.setTimeout(x,1e3/60)},p=t.window.cancelAnimationFrame||t.window.clearTimeout;function m(){return u.apply(t.window,arguments)}function g(){return p.apply(t.window,arguments)}t.util.animate=f,t.util.requestAnimFrame=m,t.util.cancelAnimFrame=g,t.runningAnimations=c}(),function(){function o(c,d,h){var f="rgba("+parseInt(c[0]+h*(d[0]-c[0]),10)+","+parseInt(c[1]+h*(d[1]-c[1]),10)+","+parseInt(c[2]+h*(d[2]-c[2]),10);return f+=","+(c&&d?parseFloat(c[3]+h*(d[3]-c[3])):1),f+=")",f}function a(c,d,h,f){var u=new t.Color(c).getSource(),p=new t.Color(d).getSource(),m=f.onComplete,g=f.onChange;return f=f||{},t.util.animate(t.util.object.extend(f,{duration:h||500,startValue:u,endValue:p,byValue:p,easing:function(x,y,w,_){var b=f.colorEasing?f.colorEasing(x,_):1-Math.cos(x/_*(Math.PI/2));return o(y,w,b)},onComplete:function(x,y,w){if(m)return m(o(p,p,0),y,w)},onChange:function(x,y,w){if(g){if(Array.isArray(x))return g(o(x,x,0),y,w);g(x,y,w)}}}))}t.util.animateColor=a}(),function(){function o(C,L,B,N){return C<Math.abs(L)?(C=L,N=B/4):L===0&&C===0?N=B/(2*Math.PI)*Math.asin(1):N=B/(2*Math.PI)*Math.asin(L/C),{a:C,c:L,p:B,s:N}}function a(C,L,B){return C.a*Math.pow(2,10*(L-=1))*Math.sin((L*B-C.s)*(2*Math.PI)/C.p)}function c(C,L,B,N){return B*((C=C/N-1)*C*C+1)+L}function d(C,L,B,N){return C/=N/2,C<1?B/2*C*C*C+L:B/2*((C-=2)*C*C+2)+L}function h(C,L,B,N){return B*(C/=N)*C*C*C+L}function f(C,L,B,N){return-B*((C=C/N-1)*C*C*C-1)+L}function u(C,L,B,N){return C/=N/2,C<1?B/2*C*C*C*C+L:-B/2*((C-=2)*C*C*C-2)+L}function p(C,L,B,N){return B*(C/=N)*C*C*C*C+L}function m(C,L,B,N){return B*((C=C/N-1)*C*C*C*C+1)+L}function g(C,L,B,N){return C/=N/2,C<1?B/2*C*C*C*C*C+L:B/2*((C-=2)*C*C*C*C+2)+L}function x(C,L,B,N){return-B*Math.cos(C/N*(Math.PI/2))+B+L}function y(C,L,B,N){return B*Math.sin(C/N*(Math.PI/2))+L}function w(C,L,B,N){return-B/2*(Math.cos(Math.PI*C/N)-1)+L}function _(C,L,B,N){return C===0?L:B*Math.pow(2,10*(C/N-1))+L}function b(C,L,B,N){return C===N?L+B:B*(-Math.pow(2,-10*C/N)+1)+L}function k(C,L,B,N){return C===0?L:C===N?L+B:(C/=N/2,C<1?B/2*Math.pow(2,10*(C-1))+L:B/2*(-Math.pow(2,-10*--C)+2)+L)}function S(C,L,B,N){return-B*(Math.sqrt(1-(C/=N)*C)-1)+L}function E(C,L,B,N){return B*Math.sqrt(1-(C=C/N-1)*C)+L}function F(C,L,B,N){return C/=N/2,C<1?-B/2*(Math.sqrt(1-C*C)-1)+L:B/2*(Math.sqrt(1-(C-=2)*C)+1)+L}function P(C,L,B,N){var U=1.70158,A=0,T=B;if(C===0)return L;if(C/=N,C===1)return L+B;A||(A=N*.3);var j=o(T,B,A,U);return-a(j,C,N)+L}function D(C,L,B,N){var U=1.70158,A=0,T=B;if(C===0)return L;if(C/=N,C===1)return L+B;A||(A=N*.3);var j=o(T,B,A,U);return j.a*Math.pow(2,-10*C)*Math.sin((C*N-j.s)*(2*Math.PI)/j.p)+j.c+L}function I(C,L,B,N){var U=1.70158,A=0,T=B;if(C===0)return L;if(C/=N/2,C===2)return L+B;A||(A=N*(.3*1.5));var j=o(T,B,A,U);return C<1?-.5*a(j,C,N)+L:j.a*Math.pow(2,-10*(C-=1))*Math.sin((C*N-j.s)*(2*Math.PI)/j.p)*.5+j.c+L}function X(C,L,B,N,U){return U===void 0&&(U=1.70158),B*(C/=N)*C*((U+1)*C-U)+L}function z(C,L,B,N,U){return U===void 0&&(U=1.70158),B*((C=C/N-1)*C*((U+1)*C+U)+1)+L}function G(C,L,B,N,U){return U===void 0&&(U=1.70158),C/=N/2,C<1?B/2*(C*C*(((U*=1.525)+1)*C-U))+L:B/2*((C-=2)*C*(((U*=1.525)+1)*C+U)+2)+L}function ae(C,L,B,N){return B-le(N-C,0,B,N)+L}function le(C,L,B,N){return(C/=N)<1/2.75?B*(7.5625*C*C)+L:C<2/2.75?B*(7.5625*(C-=1.5/2.75)*C+.75)+L:C<2.5/2.75?B*(7.5625*(C-=2.25/2.75)*C+.9375)+L:B*(7.5625*(C-=2.625/2.75)*C+.984375)+L}function Z(C,L,B,N){return C<N/2?ae(C*2,0,B,N)*.5+L:le(C*2-N,0,B,N)*.5+B*.5+L}t.util.ease={easeInQuad:function(C,L,B,N){return B*(C/=N)*C+L},easeOutQuad:function(C,L,B,N){return-B*(C/=N)*(C-2)+L},easeInOutQuad:function(C,L,B,N){return C/=N/2,C<1?B/2*C*C+L:-B/2*(--C*(C-2)-1)+L},easeInCubic:function(C,L,B,N){return B*(C/=N)*C*C+L},easeOutCubic:c,easeInOutCubic:d,easeInQuart:h,easeOutQuart:f,easeInOutQuart:u,easeInQuint:p,easeOutQuint:m,easeInOutQuint:g,easeInSine:x,easeOutSine:y,easeInOutSine:w,easeInExpo:_,easeOutExpo:b,easeInOutExpo:k,easeInCirc:S,easeOutCirc:E,easeInOutCirc:F,easeInElastic:P,easeOutElastic:D,easeInOutElastic:I,easeInBack:X,easeOutBack:z,easeInOutBack:G,easeInBounce:ae,easeOutBounce:le,easeInOutBounce:Z}}(),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.util.object.clone,h=a.util.toFixed,f=a.util.parseUnit,u=a.util.multiplyTransformMatrices,p=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],m=["symbol","image","marker","pattern","view","svg"],g=["pattern","defs","symbol","metadata","clipPath","mask","desc"],x=["symbol","g","a","svg","clipPath","defs"],y={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},w={stroke:"strokeOpacity",fill:"fillOpacity"},_="font-size",b="clip-path";a.svgValidTagNamesRegEx=E(p),a.svgViewBoxElementsRegEx=E(m),a.svgInvalidAncestorsRegEx=E(g),a.svgValidParentsRegEx=E(x),a.cssRules={},a.gradientDefs={},a.clipPaths={};function k(A){return A in y?y[A]:A}function S(A,T,j,M){var Y=Array.isArray(T),H;if((A==="fill"||A==="stroke")&&T==="none")T="";else{if(A==="strokeUniform")return T==="non-scaling-stroke";if(A==="strokeDashArray")T==="none"?T=null:T=T.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(A==="transformMatrix")j&&j.transformMatrix?T=u(j.transformMatrix,a.parseTransformAttribute(T)):T=a.parseTransformAttribute(T);else if(A==="visible")T=T!=="none"&&T!=="hidden",j&&j.visible===!1&&(T=!1);else if(A==="opacity")T=parseFloat(T),j&&typeof j.opacity<"u"&&(T*=j.opacity);else if(A==="textAnchor")T=T==="start"?"left":T==="end"?"right":"center";else if(A==="charSpacing")H=f(T,M)/M*1e3;else if(A==="paintFirst"){var V=T.indexOf("fill"),fe=T.indexOf("stroke"),T="fill";(V>-1&&fe>-1&&fe<V||V===-1&&fe>-1)&&(T="stroke")}else{if(A==="href"||A==="xlink:href"||A==="font")return T;if(A==="imageSmoothing")return T==="optimizeQuality";H=Y?T.map(f):f(T,M)}}return!Y&&isNaN(H)?T:H}function E(A){return new RegExp("^("+A.join("|")+")\\b","i")}function F(A){for(var T in w)if(!(typeof A[w[T]]>"u"||A[T]==="")){if(typeof A[T]>"u"){if(!a.Object.prototype[T])continue;A[T]=a.Object.prototype[T]}if(A[T].indexOf("url(")!==0){var j=new a.Color(A[T]);A[T]=j.setAlpha(h(j.getAlpha()*A[w[T]],2)).toRgba()}}return A}function P(A,T){var j,M=[],Y,H,V;for(H=0,V=T.length;H<V;H++)j=T[H],Y=A.getElementsByTagName(j),M=M.concat(Array.prototype.slice.call(Y));return M}a.parseTransformAttribute=function(){function A(ie,pe){var Se=a.util.cos(pe[0]),De=a.util.sin(pe[0]),we=0,ve=0;pe.length===3&&(we=pe[1],ve=pe[2]),ie[0]=Se,ie[1]=De,ie[2]=-De,ie[3]=Se,ie[4]=we-(Se*we-De*ve),ie[5]=ve-(De*we+Se*ve)}function T(ie,pe){var Se=pe[0],De=pe.length===2?pe[1]:pe[0];ie[0]=Se,ie[3]=De}function j(ie,pe,Se){ie[Se]=Math.tan(a.util.degreesToRadians(pe[0]))}function M(ie,pe){ie[4]=pe[0],pe.length===2&&(ie[5]=pe[1])}var Y=a.iMatrix,H=a.reNum,V=a.commaWsp,fe="(?:(skewX)\\s*\\(\\s*("+H+")\\s*\\))",O="(?:(skewY)\\s*\\(\\s*("+H+")\\s*\\))",Q="(?:(rotate)\\s*\\(\\s*("+H+")(?:"+V+"("+H+")"+V+"("+H+"))?\\s*\\))",K="(?:(scale)\\s*\\(\\s*("+H+")(?:"+V+"("+H+"))?\\s*\\))",ce="(?:(translate)\\s*\\(\\s*("+H+")(?:"+V+"("+H+"))?\\s*\\))",te="(?:(matrix)\\s*\\(\\s*("+H+")"+V+"("+H+")"+V+"("+H+")"+V+"("+H+")"+V+"("+H+")"+V+"("+H+")\\s*\\))",R="(?:"+te+"|"+ce+"|"+K+"|"+Q+"|"+fe+"|"+O+")",ue="(?:"+R+"(?:"+V+"*"+R+")*)",oe="^\\s*(?:"+ue+"?)\\s*$",he=new RegExp(oe),de=new RegExp(R,"g");return function(ie){var pe=Y.concat(),Se=[];if(!ie||ie&&!he.test(ie))return pe;ie.replace(de,function(we){var ve=new RegExp(R).exec(we).filter(function(Ne){return!!Ne}),Ae=ve[1],Ee=ve.slice(2).map(parseFloat);switch(Ae){case"translate":M(pe,Ee);break;case"rotate":Ee[0]=a.util.degreesToRadians(Ee[0]),A(pe,Ee);break;case"scale":T(pe,Ee);break;case"skewX":j(pe,Ee,2);break;case"skewY":j(pe,Ee,1);break;case"matrix":pe=Ee;break}Se.push(pe.concat()),pe=Y.concat()});for(var De=Se[0];Se.length>1;)Se.shift(),De=a.util.multiplyTransformMatrices(De,Se[0]);return De}}();function D(A,T){var j,M;A.replace(/;\s*$/,"").split(";").forEach(function(Y){var H=Y.split(":");j=H[0].trim().toLowerCase(),M=H[1].trim(),T[j]=M})}function I(A,T){var j,M;for(var Y in A)typeof A[Y]>"u"||(j=Y.toLowerCase(),M=A[Y],T[j]=M)}function X(A,T){var j={};for(var M in a.cssRules[T])if(z(A,M.split(" ")))for(var Y in a.cssRules[T][M])j[Y]=a.cssRules[T][M][Y];return j}function z(A,T){var j,M=!0;return j=ae(A,T.pop()),j&&T.length&&(M=G(A,T)),j&&M&&T.length===0}function G(A,T){for(var j,M=!0;A.parentNode&&A.parentNode.nodeType===1&&T.length;)M&&(j=T.pop()),A=A.parentNode,M=ae(A,j);return T.length===0}function ae(A,T){var j=A.nodeName,M=A.getAttribute("class"),Y=A.getAttribute("id"),H,V;if(H=new RegExp("^"+j,"i"),T=T.replace(H,""),Y&&T.length&&(H=new RegExp("#"+Y+"(?![a-zA-Z\\-]+)","i"),T=T.replace(H,"")),M&&T.length)for(M=M.split(" "),V=M.length;V--;)H=new RegExp("\\."+M[V]+"(?![a-zA-Z\\-]+)","i"),T=T.replace(H,"");return T.length===0}function le(A,T){var j;if(A.getElementById&&(j=A.getElementById(T)),j)return j;var M,Y,H,V=A.getElementsByTagName("*");for(Y=0,H=V.length;Y<H;Y++)if(M=V[Y],T===M.getAttribute("id"))return M}function Z(A){for(var T=P(A,["use","svg:use"]),j=0;T.length&&j<T.length;){var M=T[j],Y=M.getAttribute("xlink:href")||M.getAttribute("href");if(Y===null)return;var H=Y.slice(1),V=M.getAttribute("x")||0,fe=M.getAttribute("y")||0,O=le(A,H).cloneNode(!0),Q=(O.getAttribute("transform")||"")+" translate("+V+", "+fe+")",K,ce=T.length,te,R,ue,oe,he=a.svgNS;if(L(O),/^svg$/i.test(O.nodeName)){var de=O.ownerDocument.createElementNS(he,"g");for(R=0,ue=O.attributes,oe=ue.length;R<oe;R++)te=ue.item(R),de.setAttributeNS(he,te.nodeName,te.nodeValue);for(;O.firstChild;)de.appendChild(O.firstChild);O=de}for(R=0,ue=M.attributes,oe=ue.length;R<oe;R++)te=ue.item(R),!(te.nodeName==="x"||te.nodeName==="y"||te.nodeName==="xlink:href"||te.nodeName==="href")&&(te.nodeName==="transform"?Q=te.nodeValue+" "+Q:O.setAttribute(te.nodeName,te.nodeValue));O.setAttribute("transform",Q),O.setAttribute("instantiated_by_use","1"),O.removeAttribute("id"),K=M.parentNode,K.replaceChild(O,M),T.length===ce&&j++}}var C=new RegExp("^\\s*("+a.reNum+"+)\\s*,?\\s*("+a.reNum+"+)\\s*,?\\s*("+a.reNum+"+)\\s*,?\\s*("+a.reNum+"+)\\s*$");function L(A){if(!a.svgViewBoxElementsRegEx.test(A.nodeName))return{};var T=A.getAttribute("viewBox"),j=1,M=1,Y=0,H=0,V,fe,O,Q,K=A.getAttribute("width"),ce=A.getAttribute("height"),te=A.getAttribute("x")||0,R=A.getAttribute("y")||0,ue=A.getAttribute("preserveAspectRatio")||"",oe=!T||!(T=T.match(C)),he=!K||!ce||K==="100%"||ce==="100%",de=oe&&he,ie={},pe="",Se=0,De=0;if(ie.width=0,ie.height=0,ie.toBeParsed=de,oe&&(te||R)&&A.parentNode&&A.parentNode.nodeName!=="#document"&&(pe=" translate("+f(te)+" "+f(R)+") ",O=(A.getAttribute("transform")||"")+pe,A.setAttribute("transform",O),A.removeAttribute("x"),A.removeAttribute("y")),de)return ie;if(oe)return ie.width=f(K),ie.height=f(ce),ie;if(Y=-parseFloat(T[1]),H=-parseFloat(T[2]),V=parseFloat(T[3]),fe=parseFloat(T[4]),ie.minX=Y,ie.minY=H,ie.viewBoxWidth=V,ie.viewBoxHeight=fe,he?(ie.width=V,ie.height=fe):(ie.width=f(K),ie.height=f(ce),j=ie.width/V,M=ie.height/fe),ue=a.util.parsePreserveAspectRatioAttribute(ue),ue.alignX!=="none"&&(ue.meetOrSlice==="meet"&&(M=j=j>M?M:j),ue.meetOrSlice==="slice"&&(M=j=j>M?j:M),Se=ie.width-V*j,De=ie.height-fe*j,ue.alignX==="Mid"&&(Se/=2),ue.alignY==="Mid"&&(De/=2),ue.alignX==="Min"&&(Se=0),ue.alignY==="Min"&&(De=0)),j===1&&M===1&&Y===0&&H===0&&te===0&&R===0)return ie;if((te||R)&&A.parentNode.nodeName!=="#document"&&(pe=" translate("+f(te)+" "+f(R)+") "),O=pe+" matrix("+j+" 0 0 "+M+" "+(Y*j+Se)+" "+(H*M+De)+") ",A.nodeName==="svg"){for(Q=A.ownerDocument.createElementNS(a.svgNS,"g");A.firstChild;)Q.appendChild(A.firstChild);A.appendChild(Q)}else Q=A,Q.removeAttribute("x"),Q.removeAttribute("y"),O=Q.getAttribute("transform")+O;return Q.setAttribute("transform",O),ie}function B(A,T){for(;A&&(A=A.parentNode);)if(A.nodeName&&T.test(A.nodeName.replace("svg:",""))&&!A.getAttribute("instantiated_by_use"))return!0;return!1}a.parseSVGDocument=function(A,T,j,M){if(A){Z(A);var Y=a.Object.__uid++,H,V,fe=L(A),O=a.util.toArray(A.getElementsByTagName("*"));if(fe.crossOrigin=M&&M.crossOrigin,fe.svgUid=Y,O.length===0&&a.isLikelyNode){O=A.selectNodes('//*[name(.)!="svg"]');var Q=[];for(H=0,V=O.length;H<V;H++)Q[H]=O[H];O=Q}var K=O.filter(function(te){return L(te),a.svgValidTagNamesRegEx.test(te.nodeName.replace("svg:",""))&&!B(te,a.svgInvalidAncestorsRegEx)});if(!K||K&&!K.length){T&&T([],{});return}var ce={};O.filter(function(te){return te.nodeName.replace("svg:","")==="clipPath"}).forEach(function(te){var R=te.getAttribute("id");ce[R]=a.util.toArray(te.getElementsByTagName("*")).filter(function(ue){return a.svgValidTagNamesRegEx.test(ue.nodeName.replace("svg:",""))})}),a.gradientDefs[Y]=a.getGradientDefs(A),a.cssRules[Y]=a.getCSSRules(A),a.clipPaths[Y]=ce,a.parseElements(K,function(te,R){T&&(T(te,fe,R,O),delete a.gradientDefs[Y],delete a.cssRules[Y],delete a.clipPaths[Y])},d(fe),j,M)}};function N(A,T){var j=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],M="xlink:href",Y=T.getAttribute(M).slice(1),H=le(A,Y);if(H&&H.getAttribute(M)&&N(A,H),j.forEach(function(fe){H&&!T.hasAttribute(fe)&&H.hasAttribute(fe)&&T.setAttribute(fe,H.getAttribute(fe))}),!T.children.length)for(var V=H.cloneNode(!0);V.firstChild;)T.appendChild(V.firstChild);T.removeAttribute(M)}var U=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+a.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+a.reNum+"))?\\s+(.*)");c(a,{parseFontDeclaration:function(A,T){var j=A.match(U);if(j){var M=j[1],Y=j[3],H=j[4],V=j[5],fe=j[6];M&&(T.fontStyle=M),Y&&(T.fontWeight=isNaN(parseFloat(Y))?Y:parseFloat(Y)),H&&(T.fontSize=f(H)),fe&&(T.fontFamily=fe),V&&(T.lineHeight=V==="normal"?1:V)}},getGradientDefs:function(A){var T=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],j=P(A,T),M,Y=0,H={};for(Y=j.length;Y--;)M=j[Y],M.getAttribute("xlink:href")&&N(A,M),H[M.getAttribute("id")]=M;return H},parseAttributes:function(A,T,j){if(A){var M,Y={},H,V;typeof j>"u"&&(j=A.getAttribute("svgUid")),A.parentNode&&a.svgValidParentsRegEx.test(A.parentNode.nodeName)&&(Y=a.parseAttributes(A.parentNode,T,j));var fe=T.reduce(function(ue,oe){return M=A.getAttribute(oe),M&&(ue[oe]=M),ue},{}),O=c(X(A,j),a.parseStyleAttribute(A));fe=c(fe,O),O[b]&&A.setAttribute(b,O[b]),H=V=Y.fontSize||a.Text.DEFAULT_SVG_FONT_SIZE,fe[_]&&(fe[_]=H=f(fe[_],V));var Q,K,ce={};for(var te in fe)Q=k(te),K=S(Q,fe[te],Y,H),ce[Q]=K;ce&&ce.font&&a.parseFontDeclaration(ce.font,ce);var R=c(Y,ce);return a.svgValidParentsRegEx.test(A.nodeName)?R:F(R)}},parseElements:function(A,T,j,M,Y){new a.ElementsParser(A,T,j,M,Y).parse()},parseStyleAttribute:function(A){var T={},j=A.getAttribute("style");return j&&(typeof j=="string"?D(j,T):I(j,T)),T},parsePointsAttribute:function(A){if(!A)return null;A=A.replace(/,/g," ").trim(),A=A.split(/\s+/);var T=[],j,M;for(j=0,M=A.length;j<M;j+=2)T.push({x:parseFloat(A[j]),y:parseFloat(A[j+1])});return T},getCSSRules:function(A){var T=A.getElementsByTagName("style"),j,M,Y={},H;for(j=0,M=T.length;j<M;j++){var V=T[j].textContent;V=V.replace(/\/\*[\s\S]*?\*\//g,""),V.trim()!==""&&(H=V.split("}"),H=H.filter(function(fe){return fe.trim()}),H.forEach(function(fe){var O=fe.split("{"),Q={},K=O[1].trim(),ce=K.split(";").filter(function(oe){return oe.trim()});for(j=0,M=ce.length;j<M;j++){var te=ce[j].split(":"),R=te[0].trim(),ue=te[1].trim();Q[R]=ue}fe=O[0].trim(),fe.split(",").forEach(function(oe){oe=oe.replace(/^svg/i,"").trim(),oe!==""&&(Y[oe]?a.util.object.extend(Y[oe],Q):Y[oe]=a.util.object.clone(Q))})}))}return Y},loadSVGFromURL:function(A,T,j,M){A=A.replace(/^\n\s*/,"").trim(),new a.util.request(A,{method:"get",onComplete:Y});function Y(H){var V=H.responseXML;if(!V||!V.documentElement)return T&&T(null),!1;a.parseSVGDocument(V.documentElement,function(fe,O,Q,K){T&&T(fe,O,Q,K)},j,M)}},loadSVGFromString:function(A,T,j,M){var Y=new a.window.DOMParser,H=Y.parseFromString(A.trim(),"text/xml");a.parseSVGDocument(H.documentElement,function(V,fe,O,Q){T(V,fe,O,Q)},j,M)}})}(e),t.ElementsParser=function(o,a,c,d,h,f){this.elements=o,this.callback=a,this.options=c,this.reviver=d,this.svgUid=c&&c.svgUid||0,this.parsingOptions=h,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=f},function(o){o.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},o.createObjects=function(){var a=this;this.elements.forEach(function(c,d){c.setAttribute("svgUid",a.svgUid),a.createObject(c,d)})},o.findTag=function(a){return t[t.util.string.capitalize(a.tagName.replace("svg:",""))]},o.createObject=function(a,c){var d=this.findTag(a);if(d&&d.fromElement)try{d.fromElement(a,this.createCallback(c,a),this.options)}catch(h){t.log(h)}else this.checkIfDone()},o.createCallback=function(a,c){var d=this;return function(h){var f;d.resolveGradient(h,c,"fill"),d.resolveGradient(h,c,"stroke"),h instanceof t.Image&&h._originalElement&&(f=h.parsePreserveAspectRatioAttribute(c)),h._removeTransformMatrix(f),d.resolveClipPath(h,c),d.reviver&&d.reviver(c,h),d.instances[a]=h,d.checkIfDone()}},o.extractPropertyDefinition=function(a,c,d){var h=a[c],f=this.regexUrl;if(f.test(h)){f.lastIndex=0;var u=f.exec(h)[1];return f.lastIndex=0,t[d][this.svgUid][u]}},o.resolveGradient=function(a,c,d){var h=this.extractPropertyDefinition(a,d,"gradientDefs");if(h){var f=c.getAttribute(d+"-opacity"),u=t.Gradient.fromElement(h,a,f,this.options);a.set(d,u)}},o.createClipPathCallback=function(a,c){return function(d){d._removeTransformMatrix(),d.fillRule=d.clipRule,c.push(d)}},o.resolveClipPath=function(a,c){var d=this.extractPropertyDefinition(a,"clipPath","clipPaths"),h,f,u,p,m,g;if(d){p=[],u=t.util.invertTransform(a.calcTransformMatrix());for(var x=d[0].parentNode,y=c;y.parentNode&&y.getAttribute("clip-path")!==a.clipPath;)y=y.parentNode;y.parentNode.appendChild(x);for(var w=0;w<d.length;w++)h=d[w],f=this.findTag(h),f.fromElement(h,this.createClipPathCallback(a,p),this.options);p.length===1?d=p[0]:d=new t.Group(p),m=t.util.multiplyTransformMatrices(u,d.calcTransformMatrix()),d.clipPath&&this.resolveClipPath(d,y);var g=t.util.qrDecompose(m);d.flipX=!1,d.flipY=!1,d.set("scaleX",g.scaleX),d.set("scaleY",g.scaleY),d.angle=g.angle,d.skewX=g.skewX,d.skewY=0,d.setPositionByOrigin({x:g.translateX,y:g.translateY},"center","center"),a.clipPath=d}else delete a.clipPath},o.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(a){return a!=null}),this.callback(this.instances,this.elements))}}(t.ElementsParser.prototype),function(o){var a=o.fabric||(o.fabric={});if(a.Point){a.warn("fabric.Point is already defined");return}a.Point=c;function c(d,h){this.x=d,this.y=h}c.prototype={type:"point",constructor:c,add:function(d){return new c(this.x+d.x,this.y+d.y)},addEquals:function(d){return this.x+=d.x,this.y+=d.y,this},scalarAdd:function(d){return new c(this.x+d,this.y+d)},scalarAddEquals:function(d){return this.x+=d,this.y+=d,this},subtract:function(d){return new c(this.x-d.x,this.y-d.y)},subtractEquals:function(d){return this.x-=d.x,this.y-=d.y,this},scalarSubtract:function(d){return new c(this.x-d,this.y-d)},scalarSubtractEquals:function(d){return this.x-=d,this.y-=d,this},multiply:function(d){return new c(this.x*d,this.y*d)},multiplyEquals:function(d){return this.x*=d,this.y*=d,this},divide:function(d){return new c(this.x/d,this.y/d)},divideEquals:function(d){return this.x/=d,this.y/=d,this},eq:function(d){return this.x===d.x&&this.y===d.y},lt:function(d){return this.x<d.x&&this.y<d.y},lte:function(d){return this.x<=d.x&&this.y<=d.y},gt:function(d){return this.x>d.x&&this.y>d.y},gte:function(d){return this.x>=d.x&&this.y>=d.y},lerp:function(d,h){return typeof h>"u"&&(h=.5),h=Math.max(Math.min(1,h),0),new c(this.x+(d.x-this.x)*h,this.y+(d.y-this.y)*h)},distanceFrom:function(d){var h=this.x-d.x,f=this.y-d.y;return Math.sqrt(h*h+f*f)},midPointFrom:function(d){return this.lerp(d)},min:function(d){return new c(Math.min(this.x,d.x),Math.min(this.y,d.y))},max:function(d){return new c(Math.max(this.x,d.x),Math.max(this.y,d.y))},toString:function(){return this.x+","+this.y},setXY:function(d,h){return this.x=d,this.y=h,this},setX:function(d){return this.x=d,this},setY:function(d){return this.y=d,this},setFromPoint:function(d){return this.x=d.x,this.y=d.y,this},swap:function(d){var h=this.x,f=this.y;this.x=d.x,this.y=d.y,d.x=h,d.y=f},clone:function(){return new c(this.x,this.y)}}}(e),function(o){var a=o.fabric||(o.fabric={});if(a.Intersection){a.warn("fabric.Intersection is already defined");return}function c(d){this.status=d,this.points=[]}a.Intersection=c,a.Intersection.prototype={constructor:c,appendPoint:function(d){return this.points.push(d),this},appendPoints:function(d){return this.points=this.points.concat(d),this}},a.Intersection.intersectLineLine=function(d,h,f,u){var p,m=(u.x-f.x)*(d.y-f.y)-(u.y-f.y)*(d.x-f.x),g=(h.x-d.x)*(d.y-f.y)-(h.y-d.y)*(d.x-f.x),x=(u.y-f.y)*(h.x-d.x)-(u.x-f.x)*(h.y-d.y);if(x!==0){var y=m/x,w=g/x;0<=y&&y<=1&&0<=w&&w<=1?(p=new c("Intersection"),p.appendPoint(new a.Point(d.x+y*(h.x-d.x),d.y+y*(h.y-d.y)))):p=new c}else m===0||g===0?p=new c("Coincident"):p=new c("Parallel");return p},a.Intersection.intersectLinePolygon=function(d,h,f){var u=new c,p=f.length,m,g,x,y;for(y=0;y<p;y++)m=f[y],g=f[(y+1)%p],x=c.intersectLineLine(d,h,m,g),u.appendPoints(x.points);return u.points.length>0&&(u.status="Intersection"),u},a.Intersection.intersectPolygonPolygon=function(d,h){var f=new c,u=d.length,p;for(p=0;p<u;p++){var m=d[p],g=d[(p+1)%u],x=c.intersectLinePolygon(m,g,h);f.appendPoints(x.points)}return f.points.length>0&&(f.status="Intersection"),f},a.Intersection.intersectPolygonRectangle=function(d,h,f){var u=h.min(f),p=h.max(f),m=new a.Point(p.x,u.y),g=new a.Point(u.x,p.y),x=c.intersectLinePolygon(u,m,d),y=c.intersectLinePolygon(m,p,d),w=c.intersectLinePolygon(p,g,d),_=c.intersectLinePolygon(g,u,d),b=new c;return b.appendPoints(x.points),b.appendPoints(y.points),b.appendPoints(w.points),b.appendPoints(_.points),b.points.length>0&&(b.status="Intersection"),b}}(e),function(o){var a=o.fabric||(o.fabric={});if(a.Color){a.warn("fabric.Color is already defined.");return}function c(h){h?this._tryParsingColor(h):this.setSource([0,0,0,1])}a.Color=c,a.Color.prototype={_tryParsingColor:function(h){var f;h in c.colorNameMap&&(h=c.colorNameMap[h]),h==="transparent"&&(f=[255,255,255,0]),f||(f=c.sourceFromHex(h)),f||(f=c.sourceFromRgb(h)),f||(f=c.sourceFromHsl(h)),f||(f=[0,0,0,1]),f&&this.setSource(f)},_rgbToHsl:function(h,f,u){h/=255,f/=255,u/=255;var p,m,g,x=a.util.array.max([h,f,u]),y=a.util.array.min([h,f,u]);if(g=(x+y)/2,x===y)p=m=0;else{var w=x-y;switch(m=g>.5?w/(2-x-y):w/(x+y),x){case h:p=(f-u)/w+(f<u?6:0);break;case f:p=(u-h)/w+2;break;case u:p=(h-f)/w+4;break}p/=6}return[Math.round(p*360),Math.round(m*100),Math.round(g*100)]},getSource:function(){return this._source},setSource:function(h){this._source=h},toRgb:function(){var h=this.getSource();return"rgb("+h[0]+","+h[1]+","+h[2]+")"},toRgba:function(){var h=this.getSource();return"rgba("+h[0]+","+h[1]+","+h[2]+","+h[3]+")"},toHsl:function(){var h=this.getSource(),f=this._rgbToHsl(h[0],h[1],h[2]);return"hsl("+f[0]+","+f[1]+"%,"+f[2]+"%)"},toHsla:function(){var h=this.getSource(),f=this._rgbToHsl(h[0],h[1],h[2]);return"hsla("+f[0]+","+f[1]+"%,"+f[2]+"%,"+h[3]+")"},toHex:function(){var h=this.getSource(),f,u,p;return f=h[0].toString(16),f=f.length===1?"0"+f:f,u=h[1].toString(16),u=u.length===1?"0"+u:u,p=h[2].toString(16),p=p.length===1?"0"+p:p,f.toUpperCase()+u.toUpperCase()+p.toUpperCase()},toHexa:function(){var h=this.getSource(),f;return f=Math.round(h[3]*255),f=f.toString(16),f=f.length===1?"0"+f:f,this.toHex()+f.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(h){var f=this.getSource();return f[3]=h,this.setSource(f),this},toGrayscale:function(){var h=this.getSource(),f=parseInt((h[0]*.3+h[1]*.59+h[2]*.11).toFixed(0),10),u=h[3];return this.setSource([f,f,f,u]),this},toBlackWhite:function(h){var f=this.getSource(),u=(f[0]*.3+f[1]*.59+f[2]*.11).toFixed(0),p=f[3];return h=h||127,u=Number(u)<Number(h)?0:255,this.setSource([u,u,u,p]),this},overlayWith:function(h){h instanceof c||(h=new c(h));var f=[],u=this.getAlpha(),p=.5,m=this.getSource(),g=h.getSource(),x;for(x=0;x<3;x++)f.push(Math.round(m[x]*(1-p)+g[x]*p));return f[3]=u,this.setSource(f),this}},a.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,a.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,a.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,a.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function d(h,f,u){return u<0&&(u+=1),u>1&&(u-=1),u<1/6?h+(f-h)*6*u:u<1/2?f:u<2/3?h+(f-h)*(2/3-u)*6:h}a.Color.fromRgb=function(h){return c.fromSource(c.sourceFromRgb(h))},a.Color.sourceFromRgb=function(h){var f=h.match(c.reRGBa);if(f){var u=parseInt(f[1],10)/(/%$/.test(f[1])?100:1)*(/%$/.test(f[1])?255:1),p=parseInt(f[2],10)/(/%$/.test(f[2])?100:1)*(/%$/.test(f[2])?255:1),m=parseInt(f[3],10)/(/%$/.test(f[3])?100:1)*(/%$/.test(f[3])?255:1);return[parseInt(u,10),parseInt(p,10),parseInt(m,10),f[4]?parseFloat(f[4]):1]}},a.Color.fromRgba=c.fromRgb,a.Color.fromHsl=function(h){return c.fromSource(c.sourceFromHsl(h))},a.Color.sourceFromHsl=function(h){var f=h.match(c.reHSLa);if(f){var u=(parseFloat(f[1])%360+360)%360/360,p=parseFloat(f[2])/(/%$/.test(f[2])?100:1),m=parseFloat(f[3])/(/%$/.test(f[3])?100:1),g,x,y;if(p===0)g=x=y=m;else{var w=m<=.5?m*(p+1):m+p-m*p,_=m*2-w;g=d(_,w,u+1/3),x=d(_,w,u),y=d(_,w,u-1/3)}return[Math.round(g*255),Math.round(x*255),Math.round(y*255),f[4]?parseFloat(f[4]):1]}},a.Color.fromHsla=c.fromHsl,a.Color.fromHex=function(h){return c.fromSource(c.sourceFromHex(h))},a.Color.sourceFromHex=function(h){if(h.match(c.reHex)){var f=h.slice(h.indexOf("#")+1),u=f.length===3||f.length===4,p=f.length===8||f.length===4,m=u?f.charAt(0)+f.charAt(0):f.substring(0,2),g=u?f.charAt(1)+f.charAt(1):f.substring(2,4),x=u?f.charAt(2)+f.charAt(2):f.substring(4,6),y=p?u?f.charAt(3)+f.charAt(3):f.substring(6,8):"FF";return[parseInt(m,16),parseInt(g,16),parseInt(x,16),parseFloat((parseInt(y,16)/255).toFixed(2))]}},a.Color.fromSource=function(h){var f=new c;return f.setSource(h),f}}(e),function(o){var a=o.fabric||(o.fabric={}),c=["e","se","s","sw","w","nw","n","ne","e"],d=["ns","nesw","ew","nwse"],h={},f="left",u="top",p="right",m="bottom",g="center",x={top:m,bottom:u,left:p,right:f,center:g},y=a.util.radiansToDegrees,w=Math.sign||function(Q){return(Q>0)-(Q<0)||+Q};function _(Q,K){var ce=Q.angle+y(Math.atan2(K.y,K.x))+360;return Math.round(ce%360/45)}function b(Q,K){var ce=K.transform.target,te=ce.canvas,R=a.util.object.clone(K);R.target=ce,te&&te.fire("object:"+Q,R),ce.fire(Q,K)}function k(Q,K){var ce=K.canvas,te=ce.uniScaleKey,R=Q[te];return ce.uniformScaling&&!R||!ce.uniformScaling&&R}function S(Q){return Q.originX===g&&Q.originY===g}function E(Q,K,ce){var te=Q.lockScalingX,R=Q.lockScalingY;return!!(te&&R||!K&&(te||R)&&ce||te&&K==="x"||R&&K==="y")}function F(Q,K,ce){var te="not-allowed",R=k(Q,ce),ue="";if(K.x!==0&&K.y===0?ue="x":K.x===0&&K.y!==0&&(ue="y"),E(ce,ue,R))return te;var oe=_(ce,K);return c[oe]+"-resize"}function P(Q,K,ce){var te="not-allowed";if(K.x!==0&&ce.lockSkewingY||K.y!==0&&ce.lockSkewingX)return te;var R=_(ce,K)%4;return d[R]+"-resize"}function D(Q,K,ce){return Q[ce.canvas.altActionKey]?h.skewCursorStyleHandler(Q,K,ce):h.scaleCursorStyleHandler(Q,K,ce)}function I(Q,K,ce){var te=Q[ce.canvas.altActionKey];if(K.x===0)return te?"skewX":"scaleY";if(K.y===0)return te?"skewY":"scaleX"}function X(Q,K,ce){return ce.lockRotation?"not-allowed":K.cursorStyle}function z(Q,K,ce,te){return{e:Q,transform:K,pointer:{x:ce,y:te}}}function G(Q){return function(K,ce,te,R){var ue=ce.target,oe=ue.getCenterPoint(),he=ue.translateToOriginPoint(oe,ce.originX,ce.originY),de=Q(K,ce,te,R);return ue.setPositionByOrigin(he,ce.originX,ce.originY),de}}function ae(Q,K){return function(ce,te,R,ue){var oe=K(ce,te,R,ue);return oe&&b(Q,z(ce,te,R,ue)),oe}}function le(Q,K,ce,te,R){var ue=Q.target,oe=ue.controls[Q.corner],he=ue.canvas.getZoom(),de=ue.padding/he,ie=ue.toLocalPoint(new a.Point(te,R),K,ce);return ie.x>=de&&(ie.x-=de),ie.x<=-de&&(ie.x+=de),ie.y>=de&&(ie.y-=de),ie.y<=de&&(ie.y+=de),ie.x-=oe.offsetX,ie.y-=oe.offsetY,ie}function Z(Q){return Q.flipX!==Q.flipY}function C(Q,K,ce,te,R){if(Q[K]!==0){var ue=Q._getTransformedDimensions()[te],oe=R/ue*Q[ce];Q.set(ce,oe)}}function L(Q,K,ce,te){var R=K.target,ue=R._getTransformedDimensions(0,R.skewY),oe=le(K,K.originX,K.originY,ce,te),he=Math.abs(oe.x*2)-ue.x,de=R.skewX,ie;he<2?ie=0:(ie=y(Math.atan2(he/R.scaleX,ue.y/R.scaleY)),K.originX===f&&K.originY===m&&(ie=-ie),K.originX===p&&K.originY===u&&(ie=-ie),Z(R)&&(ie=-ie));var pe=de!==ie;if(pe){var Se=R._getTransformedDimensions().y;R.set("skewX",ie),C(R,"skewY","scaleY","y",Se)}return pe}function B(Q,K,ce,te){var R=K.target,ue=R._getTransformedDimensions(R.skewX,0),oe=le(K,K.originX,K.originY,ce,te),he=Math.abs(oe.y*2)-ue.y,de=R.skewY,ie;he<2?ie=0:(ie=y(Math.atan2(he/R.scaleY,ue.x/R.scaleX)),K.originX===f&&K.originY===m&&(ie=-ie),K.originX===p&&K.originY===u&&(ie=-ie),Z(R)&&(ie=-ie));var pe=de!==ie;if(pe){var Se=R._getTransformedDimensions().x;R.set("skewY",ie),C(R,"skewX","scaleX","x",Se)}return pe}function N(Q,K,ce,te){var R=K.target,ue=R.skewX,oe,he=K.originY;if(R.lockSkewingX)return!1;if(ue===0){var de=le(K,g,g,ce,te);de.x>0?oe=f:oe=p}else ue>0&&(oe=he===u?f:p),ue<0&&(oe=he===u?p:f),Z(R)&&(oe=oe===f?p:f);K.originX=oe;var ie=ae("skewing",G(L));return ie(Q,K,ce,te)}function U(Q,K,ce,te){var R=K.target,ue=R.skewY,oe,he=K.originX;if(R.lockSkewingY)return!1;if(ue===0){var de=le(K,g,g,ce,te);de.y>0?oe=u:oe=m}else ue>0&&(oe=he===f?u:m),ue<0&&(oe=he===f?m:u),Z(R)&&(oe=oe===u?m:u);K.originY=oe;var ie=ae("skewing",G(B));return ie(Q,K,ce,te)}function A(Q,K,ce,te){var R=K,ue=R.target,oe=ue.translateToOriginPoint(ue.getCenterPoint(),R.originX,R.originY);if(ue.lockRotation)return!1;var he=Math.atan2(R.ey-oe.y,R.ex-oe.x),de=Math.atan2(te-oe.y,ce-oe.x),ie=y(de-he+R.theta),pe=!0;if(ue.snapAngle>0){var Se=ue.snapAngle,De=ue.snapThreshold||Se,we=Math.ceil(ie/Se)*Se,ve=Math.floor(ie/Se)*Se;Math.abs(ie-ve)<De?ie=ve:Math.abs(ie-we)<De&&(ie=we)}return ie<0&&(ie=360+ie),ie%=360,pe=ue.angle!==ie,ue.angle=ie,pe}function T(Q,K,ce,te,R){R=R||{};var ue=K.target,oe=ue.lockScalingX,he=ue.lockScalingY,de=R.by,ie,pe,Se,De,we=k(Q,ue),ve=E(ue,de,we),Ae,Ee,Ne=K.gestureScale;if(ve)return!1;if(Ne)pe=K.scaleX*Ne,Se=K.scaleY*Ne;else{if(ie=le(K,K.originX,K.originY,ce,te),Ae=de!=="y"?w(ie.x):1,Ee=de!=="x"?w(ie.y):1,K.signX||(K.signX=Ae),K.signY||(K.signY=Ee),ue.lockScalingFlip&&(K.signX!==Ae||K.signY!==Ee))return!1;if(De=ue._getTransformedDimensions(),we&&!de){var Ie=Math.abs(ie.x)+Math.abs(ie.y),We=K.original,Te=Math.abs(De.x*We.scaleX/ue.scaleX)+Math.abs(De.y*We.scaleY/ue.scaleY),et=Ie/Te;pe=We.scaleX*et,Se=We.scaleY*et}else pe=Math.abs(ie.x*ue.scaleX/De.x),Se=Math.abs(ie.y*ue.scaleY/De.y);S(K)&&(pe*=2,Se*=2),K.signX!==Ae&&de!=="y"&&(K.originX=x[K.originX],pe*=-1,K.signX=Ae),K.signY!==Ee&&de!=="x"&&(K.originY=x[K.originY],Se*=-1,K.signY=Ee)}var vt=ue.scaleX,Kt=ue.scaleY;return de?(de==="x"&&ue.set("scaleX",pe),de==="y"&&ue.set("scaleY",Se)):(!oe&&ue.set("scaleX",pe),!he&&ue.set("scaleY",Se)),vt!==ue.scaleX||Kt!==ue.scaleY}function j(Q,K,ce,te){return T(Q,K,ce,te)}function M(Q,K,ce,te){return T(Q,K,ce,te,{by:"x"})}function Y(Q,K,ce,te){return T(Q,K,ce,te,{by:"y"})}function H(Q,K,ce,te){return Q[K.target.canvas.altActionKey]?h.skewHandlerX(Q,K,ce,te):h.scalingY(Q,K,ce,te)}function V(Q,K,ce,te){return Q[K.target.canvas.altActionKey]?h.skewHandlerY(Q,K,ce,te):h.scalingX(Q,K,ce,te)}function fe(Q,K,ce,te){var R=K.target,ue=le(K,K.originX,K.originY,ce,te),oe=R.strokeWidth/(R.strokeUniform?R.scaleX:1),he=S(K)?2:1,de=R.width,ie=Math.abs(ue.x*he/R.scaleX)-oe;return R.set("width",Math.max(ie,0)),de!==ie}function O(Q,K,ce,te){var R=K.target,ue=ce-K.offsetX,oe=te-K.offsetY,he=!R.get("lockMovementX")&&R.left!==ue,de=!R.get("lockMovementY")&&R.top!==oe;return he&&R.set("left",ue),de&&R.set("top",oe),(he||de)&&b("moving",z(Q,K,ce,te)),he||de}h.scaleCursorStyleHandler=F,h.skewCursorStyleHandler=P,h.scaleSkewCursorStyleHandler=D,h.rotationWithSnapping=ae("rotating",G(A)),h.scalingEqually=ae("scaling",G(j)),h.scalingX=ae("scaling",G(M)),h.scalingY=ae("scaling",G(Y)),h.scalingYOrSkewingX=H,h.scalingXOrSkewingY=V,h.changeWidth=ae("resizing",G(fe)),h.skewHandlerX=N,h.skewHandlerY=U,h.dragHandler=O,h.scaleOrSkewActionName=I,h.rotationStyleHandler=X,h.fireEvent=b,h.wrapWithFixedAnchor=G,h.wrapWithFireEvent=ae,h.getLocalPoint=le,a.controlsUtils=h}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.degreesToRadians,d=a.controlsUtils;function h(u,p,m,g,x){g=g||{};var y=this.sizeX||g.cornerSize||x.cornerSize,w=this.sizeY||g.cornerSize||x.cornerSize,_=typeof g.transparentCorners<"u"?g.transparentCorners:x.transparentCorners,b=_?"stroke":"fill",k=!_&&(g.cornerStrokeColor||x.cornerStrokeColor),S=p,E=m,F;u.save(),u.fillStyle=g.cornerColor||x.cornerColor,u.strokeStyle=g.cornerStrokeColor||x.cornerStrokeColor,y>w?(F=y,u.scale(1,w/y),E=m*y/w):w>y?(F=w,u.scale(y/w,1),S=p*w/y):F=y,u.lineWidth=1,u.beginPath(),u.arc(S,E,F/2,0,2*Math.PI,!1),u[b](),k&&u.stroke(),u.restore()}function f(u,p,m,g,x){g=g||{};var y=this.sizeX||g.cornerSize||x.cornerSize,w=this.sizeY||g.cornerSize||x.cornerSize,_=typeof g.transparentCorners<"u"?g.transparentCorners:x.transparentCorners,b=_?"stroke":"fill",k=!_&&(g.cornerStrokeColor||x.cornerStrokeColor),S=y/2,E=w/2;u.save(),u.fillStyle=g.cornerColor||x.cornerColor,u.strokeStyle=g.cornerStrokeColor||x.cornerStrokeColor,u.lineWidth=1,u.translate(p,m),u.rotate(c(x.angle)),u[b+"Rect"](-S,-E,y,w),k&&u.strokeRect(-S,-E,y,w),u.restore()}d.renderCircleControl=h,d.renderSquareControl=f}(e),function(o){var a=o.fabric||(o.fabric={});function c(d){for(var h in d)this[h]=d[h]}a.Control=c,a.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(d,h){return h.cursorStyle},getActionName:function(d,h){return h.actionName},getVisibility:function(d,h){var f=d._controlsVisibility;return f&&typeof f[h]<"u"?f[h]:this.visible},setVisibility:function(d){this.visible=d},positionHandler:function(d,h){var f=a.util.transformPoint({x:this.x*d.x+this.offsetX,y:this.y*d.y+this.offsetY},h);return f},calcCornerCoords:function(d,h,f,u,p){var m,g,x,y,w=p?this.touchSizeX:this.sizeX,_=p?this.touchSizeY:this.sizeY;if(w&&_&&w!==_){var b=Math.atan2(_,w),k=Math.sqrt(w*w+_*_)/2,S=b-a.util.degreesToRadians(d),E=Math.PI/2-b-a.util.degreesToRadians(d);m=k*a.util.cos(S),g=k*a.util.sin(S),x=k*a.util.cos(E),y=k*a.util.sin(E)}else{var F=w&&_?w:h;k=F*.7071067812;var S=a.util.degreesToRadians(45-d);m=x=k*a.util.cos(S),g=y=k*a.util.sin(S)}return{tl:{x:f-y,y:u-x},tr:{x:f+m,y:u-g},bl:{x:f-m,y:u+g},br:{x:f+y,y:u+x}}},render:function(d,h,f,u,p){switch(u=u||{},u.cornerStyle||p.cornerStyle){case"circle":a.controlsUtils.renderCircleControl.call(this,d,h,f,u,p);break;default:a.controlsUtils.renderSquareControl.call(this,d,h,f,u,p)}}}}(e),function(){function o(f,u){var p=f.getAttribute("style"),m=f.getAttribute("offset")||0,g,x,y,w;if(m=parseFloat(m)/(/%$/.test(m)?100:1),m=m<0?0:m>1?1:m,p){var _=p.split(/\s*;\s*/);for(_[_.length-1]===""&&_.pop(),w=_.length;w--;){var b=_[w].split(/\s*:\s*/),k=b[0].trim(),S=b[1].trim();k==="stop-color"?g=S:k==="stop-opacity"&&(y=S)}}return g||(g=f.getAttribute("stop-color")||"rgb(0,0,0)"),y||(y=f.getAttribute("stop-opacity")),g=new t.Color(g),x=g.getAlpha(),y=isNaN(parseFloat(y))?1:parseFloat(y),y*=x*u,{offset:m,color:g.toRgb(),opacity:y}}function a(f){return{x1:f.getAttribute("x1")||0,y1:f.getAttribute("y1")||0,x2:f.getAttribute("x2")||"100%",y2:f.getAttribute("y2")||0}}function c(f){return{x1:f.getAttribute("fx")||f.getAttribute("cx")||"50%",y1:f.getAttribute("fy")||f.getAttribute("cy")||"50%",r1:0,x2:f.getAttribute("cx")||"50%",y2:f.getAttribute("cy")||"50%",r2:f.getAttribute("r")||"50%"}}var d=t.util.object.clone;t.Gradient=t.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(f){f||(f={}),f.coords||(f.coords={});var u,p=this;Object.keys(f).forEach(function(m){p[m]=f[m]}),this.id?this.id+="_"+t.Object.__uid++:this.id=t.Object.__uid++,u={x1:f.coords.x1||0,y1:f.coords.y1||0,x2:f.coords.x2||0,y2:f.coords.y2||0},this.type==="radial"&&(u.r1=f.coords.r1||0,u.r2=f.coords.r2||0),this.coords=u,this.colorStops=f.colorStops.slice()},addColorStop:function(f){for(var u in f){var p=new t.Color(f[u]);this.colorStops.push({offset:parseFloat(u),color:p.toRgb(),opacity:p.getAlpha()})}return this},toObject:function(f){var u={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return t.util.populateWithProperties(this,u,f),u},toSVG:function(f,x){var p=d(this.coords,!0),m,g,x=x||{},y,w,_=d(this.colorStops,!0),b=p.r1>p.r2,k=this.gradientTransform?this.gradientTransform.concat():t.iMatrix.concat(),S=-this.offsetX,E=-this.offsetY,F=!!x.additionalTransform,P=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(_.sort(function(G,ae){return G.offset-ae.offset}),P==="objectBoundingBox"?(S/=f.width,E/=f.height):(S+=f.width/2,E+=f.height/2),f.type==="path"&&this.gradientUnits!=="percentage"&&(S-=f.pathOffset.x,E-=f.pathOffset.y),k[4]-=S,k[5]-=E,w='id="SVGID_'+this.id+'" gradientUnits="'+P+'"',w+=' gradientTransform="'+(F?x.additionalTransform+" ":"")+t.util.matrixToSVG(k)+'" ',this.type==="linear"?y=["<linearGradient ",w,' x1="',p.x1,'" y1="',p.y1,'" x2="',p.x2,'" y2="',p.y2,`">
`]:this.type==="radial"&&(y=["<radialGradient ",w,' cx="',b?p.x1:p.x2,'" cy="',b?p.y1:p.y2,'" r="',b?p.r1:p.r2,'" fx="',b?p.x2:p.x1,'" fy="',b?p.y2:p.y1,`">
`]),this.type==="radial"){if(b)for(_=_.concat(),_.reverse(),m=0,g=_.length;m<g;m++)_[m].offset=1-_[m].offset;var D=Math.min(p.r1,p.r2);if(D>0){var I=Math.max(p.r1,p.r2),X=D/I;for(m=0,g=_.length;m<g;m++)_[m].offset+=X*(1-_[m].offset)}}for(m=0,g=_.length;m<g;m++){var z=_[m];y.push("<stop ",'offset="',z.offset*100+"%",'" style="stop-color:',z.color,typeof z.opacity<"u"?";stop-opacity: "+z.opacity:";",`"/>
`)}return y.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),y.join("")},toLive:function(f){var u,p=t.util.object.clone(this.coords),m,g;if(this.type){for(this.type==="linear"?u=f.createLinearGradient(p.x1,p.y1,p.x2,p.y2):this.type==="radial"&&(u=f.createRadialGradient(p.x1,p.y1,p.r1,p.x2,p.y2,p.r2)),m=0,g=this.colorStops.length;m<g;m++){var x=this.colorStops[m].color,y=this.colorStops[m].opacity,w=this.colorStops[m].offset;typeof y<"u"&&(x=new t.Color(x).setAlpha(y).toRgba()),u.addColorStop(w,x)}return u}}}),t.util.object.extend(t.Gradient,{fromElement:function(f,u,p,m){var g=parseFloat(p)/(/%$/.test(p)?100:1);g=g<0?0:g>1?1:g,isNaN(g)&&(g=1);var x=f.getElementsByTagName("stop"),y,w=f.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",_=f.getAttribute("gradientTransform")||"",b=[],k,S,E=0,F=0,P;for(f.nodeName==="linearGradient"||f.nodeName==="LINEARGRADIENT"?(y="linear",k=a(f)):(y="radial",k=c(f)),S=x.length;S--;)b.push(o(x[S],g));P=t.parseTransformAttribute(_),h(u,k,m,w),w==="pixels"&&(E=-u.left,F=-u.top);var D=new t.Gradient({id:f.getAttribute("id"),type:y,coords:k,colorStops:b,gradientUnits:w,gradientTransform:P,offsetX:E,offsetY:F});return D}});function h(f,u,p,m){var g,x;Object.keys(u).forEach(function(y){g=u[y],g==="Infinity"?x=1:g==="-Infinity"?x=0:(x=parseFloat(u[y],10),typeof g=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(g)&&(x*=.01,m==="pixels"&&((y==="x1"||y==="x2"||y==="r2")&&(x*=p.viewBoxWidth||p.width),(y==="y1"||y==="y2")&&(x*=p.viewBoxHeight||p.height)))),u[y]=x})}}(),function(){var o=t.util.toFixed;t.Pattern=t.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(a,c){if(a||(a={}),this.id=t.Object.__uid++,this.setOptions(a),!a.source||a.source&&typeof a.source!="string"){c&&c(this);return}else{var d=this;this.source=t.util.createImage(),t.util.loadImage(a.source,function(h,f){d.source=h,c&&c(d,f)},null,this.crossOrigin)}},toObject:function(a){var c=t.Object.NUM_FRACTION_DIGITS,d,h;return typeof this.source.src=="string"?d=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(d=this.source.toDataURL()),h={type:"pattern",source:d,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:o(this.offsetX,c),offsetY:o(this.offsetY,c),patternTransform:this.patternTransform?this.patternTransform.concat():null},t.util.populateWithProperties(this,h,a),h},toSVG:function(a){var c=typeof this.source=="function"?this.source():this.source,d=c.width/a.width,h=c.height/a.height,f=this.offsetX/a.width,u=this.offsetY/a.height,p="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(h=1,u&&(h+=Math.abs(u))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(d=1,f&&(d+=Math.abs(f))),c.src?p=c.src:c.toDataURL&&(p=c.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+f+'" y="'+u+'" width="'+d+'" height="'+h+`">
<image x="0" y="0" width="`+c.width+'" height="'+c.height+'" xlink:href="'+p+`"></image>
</pattern>
`},setOptions:function(a){for(var c in a)this[c]=a[c]},toLive:function(a){var c=this.source;return!c||typeof c.src<"u"&&(!c.complete||c.naturalWidth===0||c.naturalHeight===0)?"":a.createPattern(c,this.repeat)}})}(),function(o){var a=o.fabric||(o.fabric={}),c=a.util.toFixed;if(a.Shadow){a.warn("fabric.Shadow is already defined.");return}a.Shadow=a.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(d){typeof d=="string"&&(d=this._parseShadow(d));for(var h in d)this[h]=d[h];this.id=a.Object.__uid++},_parseShadow:function(d){var h=d.trim(),f=a.Shadow.reOffsetsAndBlur.exec(h)||[],u=h.replace(a.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:u.trim(),offsetX:parseFloat(f[1],10)||0,offsetY:parseFloat(f[2],10)||0,blur:parseFloat(f[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(d){var h=40,f=40,u=a.Object.NUM_FRACTION_DIGITS,p=a.util.rotateVector({x:this.offsetX,y:this.offsetY},a.util.degreesToRadians(-d.angle)),m=20,g=new a.Color(this.color);return d.width&&d.height&&(h=c((Math.abs(p.x)+this.blur)/d.width,u)*100+m,f=c((Math.abs(p.y)+this.blur)/d.height,u)*100+m),d.flipX&&(p.x*=-1),d.flipY&&(p.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+f+'%" height="'+(100+2*f)+'%" x="-'+h+'%" width="'+(100+2*h)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+c(this.blur?this.blur/2:0,u)+`"></feGaussianBlur>
	<feOffset dx="`+c(p.x,u)+'" dy="'+c(p.y,u)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+g.toRgb()+'" flood-opacity="'+g.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var d={},h=a.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(f){this[f]!==h[f]&&(d[f]=this[f])},this),d}}),a.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(e),function(){if(t.StaticCanvas){t.warn("fabric.StaticCanvas is already defined.");return}var o=t.util.object.extend,a=t.util.getElementOffset,c=t.util.removeFromArray,d=t.util.toFixed,h=t.util.transformPoint,f=t.util.invertTransform,u=t.util.getNodeCanvas,p=t.util.createCanvasElement,m=new Error("Could not initialize `canvas` element");t.StaticCanvas=t.util.createClass(t.CommonMethods,{initialize:function(g,x){x||(x={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(g,x)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:t.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(g,x){var y=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(g),this._initOptions(x),this.interactive||this._initRetinaScaling(),x.overlayImage&&this.setOverlayImage(x.overlayImage,y),x.backgroundImage&&this.setBackgroundImage(x.backgroundImage,y),x.backgroundColor&&this.setBackgroundColor(x.backgroundColor,y),x.overlayColor&&this.setOverlayColor(x.overlayColor,y),this.calcOffset()},_isRetinaScaling:function(){return t.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,t.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var g=t.devicePixelRatio;this.__initRetinaScaling(g,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(g,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(g,x,y){x.setAttribute("width",this.width*g),x.setAttribute("height",this.height*g),y.scale(g,g)},calcOffset:function(){return this._offset=a(this.lowerCanvasEl),this},setOverlayImage:function(g,x,y){return this.__setBgOverlayImage("overlayImage",g,x,y)},setBackgroundImage:function(g,x,y){return this.__setBgOverlayImage("backgroundImage",g,x,y)},setOverlayColor:function(g,x){return this.__setBgOverlayColor("overlayColor",g,x)},setBackgroundColor:function(g,x){return this.__setBgOverlayColor("backgroundColor",g,x)},__setBgOverlayImage:function(g,x,y,w){return typeof x=="string"?t.util.loadImage(x,function(_,b){if(_){var k=new t.Image(_,w);this[g]=k,k.canvas=this}y&&y(_,b)},this,w&&w.crossOrigin):(w&&x.setOptions(w),this[g]=x,x&&(x.canvas=this),y&&y(x,!1)),this},__setBgOverlayColor:function(g,x,y){return this[g]=x,this._initGradient(x,g),this._initPattern(x,g,y),this},_createCanvasElement:function(){var g=p();if(!g||(g.style||(g.style={}),typeof g.getContext>"u"))throw m;return g},_initOptions:function(g){var x=this.lowerCanvasEl;this._setOptions(g),this.width=this.width||parseInt(x.width,10)||0,this.height=this.height||parseInt(x.height,10)||0,this.lowerCanvasEl.style&&(x.width=this.width,x.height=this.height,x.style.width=this.width+"px",x.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(g){g&&g.getContext?this.lowerCanvasEl=g:this.lowerCanvasEl=t.util.getById(g)||this._createCanvasElement(),t.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(g,x){return this.setDimensions({width:g},x)},setHeight:function(g,x){return this.setDimensions({height:g},x)},setDimensions:function(g,x){var y;x=x||{};for(var w in g)y=g[w],x.cssOnly||(this._setBackstoreDimension(w,g[w]),y+="px",this.hasLostContext=!0),x.backstoreOnly||this._setCssDimension(w,y);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),x.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(g,x){return this.lowerCanvasEl[g]=x,this.upperCanvasEl&&(this.upperCanvasEl[g]=x),this.cacheCanvasEl&&(this.cacheCanvasEl[g]=x),this[g]=x,this},_setCssDimension:function(g,x){return this.lowerCanvasEl.style[g]=x,this.upperCanvasEl&&(this.upperCanvasEl.style[g]=x),this.wrapperEl&&(this.wrapperEl.style[g]=x),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(g){var x=this._activeObject,y=this.backgroundImage,w=this.overlayImage,_,b,k;for(this.viewportTransform=g,b=0,k=this._objects.length;b<k;b++)_=this._objects[b],_.group||_.setCoords(!0);return x&&x.setCoords(),y&&y.setCoords(!0),w&&w.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(g,x){var y=g,w=this.viewportTransform.slice(0);g=h(g,f(this.viewportTransform)),w[0]=x,w[3]=x;var _=h(g,w);return w[4]+=y.x-_.x,w[5]+=y.y-_.y,this.setViewportTransform(w)},setZoom:function(g){return this.zoomToPoint(new t.Point(0,0),g),this},absolutePan:function(g){var x=this.viewportTransform.slice(0);return x[4]=-g.x,x[5]=-g.y,this.setViewportTransform(x)},relativePan:function(g){return this.absolutePan(new t.Point(-g.x-this.viewportTransform[4],-g.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(g){this.stateful&&g.setupState(),g._set("canvas",this),g.setCoords(),this.fire("object:added",{target:g}),g.fire("added")},_onObjectRemoved:function(g){this.fire("object:removed",{target:g}),g.fire("removed"),delete g.canvas},clearContext:function(g){return g.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var g=this.contextContainer;return this.renderCanvas(g,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=t.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var g={},x=this.width,y=this.height,w=f(this.viewportTransform);return g.tl=h({x:0,y:0},w),g.br=h({x,y},w),g.tr=new t.Point(g.br.x,g.tl.y),g.bl=new t.Point(g.tl.x,g.br.y),this.vptCoords=g,g},cancelRequestedRender:function(){this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(g,x){var y=this.viewportTransform,w=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(g),t.util.setImageSmoothing(g,this.imageSmoothingEnabled),this.fire("before:render",{ctx:g}),this._renderBackground(g),g.save(),g.transform(y[0],y[1],y[2],y[3],y[4],y[5]),this._renderObjects(g,x),g.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(g),w&&(w.canvas=this,w.shouldCache(),w._transformDone=!0,w.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(g)),this._renderOverlay(g),this.controlsAboveOverlay&&this.interactive&&this.drawControls(g),this.fire("after:render",{ctx:g})},drawClipPathOnCanvas:function(g){var x=this.viewportTransform,y=this.clipPath;g.save(),g.transform(x[0],x[1],x[2],x[3],x[4],x[5]),g.globalCompositeOperation="destination-in",y.transform(g),g.scale(1/y.zoomX,1/y.zoomY),g.drawImage(y._cacheCanvas,-y.cacheTranslationX,-y.cacheTranslationY),g.restore()},_renderObjects:function(g,x){var y,w;for(y=0,w=x.length;y<w;++y)x[y]&&x[y].render(g)},_renderBackgroundOrOverlay:function(g,x){var y=this[x+"Color"],w=this[x+"Image"],_=this.viewportTransform,b=this[x+"Vpt"];if(!(!y&&!w)){if(y){g.save(),g.beginPath(),g.moveTo(0,0),g.lineTo(this.width,0),g.lineTo(this.width,this.height),g.lineTo(0,this.height),g.closePath(),g.fillStyle=y.toLive?y.toLive(g,this):y,b&&g.transform(_[0],_[1],_[2],_[3],_[4],_[5]),g.transform(1,0,0,1,y.offsetX||0,y.offsetY||0);var k=y.gradientTransform||y.patternTransform;k&&g.transform(k[0],k[1],k[2],k[3],k[4],k[5]),g.fill(),g.restore()}if(w){g.save();var S=this.skipOffscreen;this.skipOffscreen=b,b&&g.transform(_[0],_[1],_[2],_[3],_[4],_[5]),w.render(g),this.skipOffscreen=S,g.restore()}}},_renderBackground:function(g){this._renderBackgroundOrOverlay(g,"background")},_renderOverlay:function(g){this._renderBackgroundOrOverlay(g,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new t.Point(this.width/2,this.height/2)},centerObjectH:function(g){return this._centerObject(g,new t.Point(this.getCenterPoint().x,g.getCenterPoint().y))},centerObjectV:function(g){return this._centerObject(g,new t.Point(g.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(g){var x=this.getCenterPoint();return this._centerObject(g,x)},viewportCenterObject:function(g){var x=this.getVpCenter();return this._centerObject(g,x)},viewportCenterObjectH:function(g){var x=this.getVpCenter();return this._centerObject(g,new t.Point(x.x,g.getCenterPoint().y)),this},viewportCenterObjectV:function(g){var x=this.getVpCenter();return this._centerObject(g,new t.Point(g.getCenterPoint().x,x.y))},getVpCenter:function(){var g=this.getCenterPoint(),x=f(this.viewportTransform);return h(g,x)},_centerObject:function(g,x){return g.setPositionByOrigin(x,"center","center"),g.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(g){return this.toDatalessObject(g)},toObject:function(g){return this._toObjectMethod("toObject",g)},toDatalessObject:function(g){return this._toObjectMethod("toDatalessObject",g)},_toObjectMethod:function(g,x){var y=this.clipPath,w={version:t.version,objects:this._toObjects(g,x)};return y&&!y.excludeFromExport&&(w.clipPath=this._toObject(this.clipPath,g,x)),o(w,this.__serializeBgOverlay(g,x)),t.util.populateWithProperties(this,w,x),w},_toObjects:function(g,x){return this._objects.filter(function(y){return!y.excludeFromExport}).map(function(y){return this._toObject(y,g,x)},this)},_toObject:function(g,x,y){var w;this.includeDefaultValues||(w=g.includeDefaultValues,g.includeDefaultValues=!1);var _=g[x](y);return this.includeDefaultValues||(g.includeDefaultValues=w),_},__serializeBgOverlay:function(g,x){var y={},w=this.backgroundImage,_=this.overlayImage,b=this.backgroundColor,k=this.overlayColor;return b&&b.toObject?b.excludeFromExport||(y.background=b.toObject(x)):b&&(y.background=b),k&&k.toObject?k.excludeFromExport||(y.overlay=k.toObject(x)):k&&(y.overlay=k),w&&!w.excludeFromExport&&(y.backgroundImage=this._toObject(w,g,x)),_&&!_.excludeFromExport&&(y.overlayImage=this._toObject(_,g,x)),y},svgViewportTransformation:!0,toSVG:function(g,x){g||(g={}),g.reviver=x;var y=[];return this._setSVGPreamble(y,g),this._setSVGHeader(y,g),this.clipPath&&y.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(y,"background"),this._setSVGBgOverlayImage(y,"backgroundImage",x),this._setSVGObjects(y,x),this.clipPath&&y.push(`</g>
`),this._setSVGBgOverlayColor(y,"overlay"),this._setSVGBgOverlayImage(y,"overlayImage",x),y.push("</svg>"),y.join("")},_setSVGPreamble:function(g,x){x.suppressPreamble||g.push('<?xml version="1.0" encoding="',x.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(g,x){var y=x.width||this.width,w=x.height||this.height,_,b='viewBox="0 0 '+this.width+" "+this.height+'" ',k=t.Object.NUM_FRACTION_DIGITS;x.viewBox?b='viewBox="'+x.viewBox.x+" "+x.viewBox.y+" "+x.viewBox.width+" "+x.viewBox.height+'" ':this.svgViewportTransformation&&(_=this.viewportTransform,b='viewBox="'+d(-_[4]/_[0],k)+" "+d(-_[5]/_[3],k)+" "+d(this.width/_[0],k)+" "+d(this.height/_[3],k)+'" '),g.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',y,'" ','height="',w,'" ',b,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",t.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(x),`</defs>
`)},createSVGClipPathMarkup:function(g){var x=this.clipPath;return x?(x.clipPathId="CLIPPATH_"+t.Object.__uid++,'<clipPath id="'+x.clipPathId+`" >
`+this.clipPath.toClipPathSVG(g.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var g=this,x=["background","overlay"].map(function(y){var w=g[y+"Color"];if(w&&w.toLive){var _=g[y+"Vpt"],b=g.viewportTransform,k={width:g.width/(_?b[0]:1),height:g.height/(_?b[3]:1)};return w.toSVG(k,{additionalTransform:_?t.util.matrixToSVG(b):""})}});return x.join("")},createSVGFontFacesMarkup:function(){var g="",x={},y,w,_,b,k,S,E,F,P,D=t.fontPaths,I=[];for(this._objects.forEach(function z(G){I.push(G),G._objects&&G._objects.forEach(z)}),F=0,P=I.length;F<P;F++)if(y=I[F],w=y.fontFamily,!(y.type.indexOf("text")===-1||x[w]||!D[w])&&(x[w]=!0,!!y.styles)){_=y.styles;for(k in _){b=_[k];for(E in b)S=b[E],w=S.fontFamily,!x[w]&&D[w]&&(x[w]=!0)}}for(var X in x)g+=[`		@font-face {
`,"			font-family: '",X,`';
`,"			src: url('",D[X],`');
`,`		}
`].join("");return g&&(g=['	<style type="text/css">',`<![CDATA[
`,g,"]]>",`</style>
`].join("")),g},_setSVGObjects:function(g,x){var y,w,_,b=this._objects;for(w=0,_=b.length;w<_;w++)y=b[w],!y.excludeFromExport&&this._setSVGObject(g,y,x)},_setSVGObject:function(g,x,y){g.push(x.toSVG(y))},_setSVGBgOverlayImage:function(g,x,y){this[x]&&!this[x].excludeFromExport&&this[x].toSVG&&g.push(this[x].toSVG(y))},_setSVGBgOverlayColor:function(g,x){var y=this[x+"Color"],w=this.viewportTransform,_=this.width,b=this.height;if(y)if(y.toLive){var k=y.repeat,S=t.util.invertTransform(w),E=this[x+"Vpt"],F=E?t.util.matrixToSVG(S):"";g.push('<rect transform="'+F+" translate(",_/2,",",b/2,')"',' x="',y.offsetX-_/2,'" y="',y.offsetY-b/2,'" ','width="',k==="repeat-y"||k==="no-repeat"?y.source.width:_,'" height="',k==="repeat-x"||k==="no-repeat"?y.source.height:b,'" fill="url(#SVGID_'+y.id+')"',`></rect>
`)}else g.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',y,'"',`></rect>
`)},sendToBack:function(g){if(!g)return this;var x=this._activeObject,y,w,_;if(g===x&&g.type==="activeSelection")for(_=x._objects,y=_.length;y--;)w=_[y],c(this._objects,w),this._objects.unshift(w);else c(this._objects,g),this._objects.unshift(g);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(g){if(!g)return this;var x=this._activeObject,y,w,_;if(g===x&&g.type==="activeSelection")for(_=x._objects,y=0;y<_.length;y++)w=_[y],c(this._objects,w),this._objects.push(w);else c(this._objects,g),this._objects.push(g);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(g,x){if(!g)return this;var y=this._activeObject,w,_,b,k,S,E=0;if(g===y&&g.type==="activeSelection")for(S=y._objects,w=0;w<S.length;w++)_=S[w],b=this._objects.indexOf(_),b>0+E&&(k=b-1,c(this._objects,_),this._objects.splice(k,0,_)),E++;else b=this._objects.indexOf(g),b!==0&&(k=this._findNewLowerIndex(g,b,x),c(this._objects,g),this._objects.splice(k,0,g));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(g,x,y){var w,_;if(y)for(w=x,_=x-1;_>=0;--_){var b=g.intersectsWithObject(this._objects[_])||g.isContainedWithinObject(this._objects[_])||this._objects[_].isContainedWithinObject(g);if(b){w=_;break}}else w=x-1;return w},bringForward:function(g,x){if(!g)return this;var y=this._activeObject,w,_,b,k,S,E=0;if(g===y&&g.type==="activeSelection")for(S=y._objects,w=S.length;w--;)_=S[w],b=this._objects.indexOf(_),b<this._objects.length-1-E&&(k=b+1,c(this._objects,_),this._objects.splice(k,0,_)),E++;else b=this._objects.indexOf(g),b!==this._objects.length-1&&(k=this._findNewUpperIndex(g,b,x),c(this._objects,g),this._objects.splice(k,0,g));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(g,x,y){var w,_,b;if(y)for(w=x,_=x+1,b=this._objects.length;_<b;++_){var k=g.intersectsWithObject(this._objects[_])||g.isContainedWithinObject(this._objects[_])||this._objects[_].isContainedWithinObject(g);if(k){w=_;break}}else w=x+1;return w},moveTo:function(g,x){return c(this._objects,g),this._objects.splice(x,0,g),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(g){g.dispose&&g.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),t.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),t.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),o(t.StaticCanvas.prototype,t.Observable),o(t.StaticCanvas.prototype,t.Collection),o(t.StaticCanvas.prototype,t.DataURLExporter),o(t.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(g){var x=p();if(!x||!x.getContext)return null;var y=x.getContext("2d");if(!y)return null;switch(g){case"setLineDash":return typeof y.setLineDash<"u";default:return null}}}),t.StaticCanvas.prototype.toJSON=t.StaticCanvas.prototype.toObject,t.isLikelyNode&&(t.StaticCanvas.prototype.createPNGStream=function(){var g=u(this.lowerCanvasEl);return g&&g.createPNGStream()},t.StaticCanvas.prototype.createJPEGStream=function(g){var x=u(this.lowerCanvasEl);return x&&x.createJPEGStream(g)})}(),t.BaseBrush=t.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(o){o.strokeStyle=this.color,o.lineWidth=this.width,o.lineCap=this.strokeLineCap,o.miterLimit=this.strokeMiterLimit,o.lineJoin=this.strokeLineJoin,o.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(o){var a=this.canvas.viewportTransform;o.save(),o.transform(a[0],a[1],a[2],a[3],a[4],a[5])},_setShadow:function(){if(this.shadow){var o=this.canvas,a=this.shadow,c=o.contextTop,d=o.getZoom();o&&o._isRetinaScaling()&&(d*=t.devicePixelRatio),c.shadowColor=a.color,c.shadowBlur=a.blur*d,c.shadowOffsetX=a.offsetX*d,c.shadowOffsetY=a.offsetY*d}},needsFullRender:function(){var o=new t.Color(this.color);return o.getAlpha()<1||!!this.shadow},_resetShadow:function(){var o=this.canvas.contextTop;o.shadowColor="",o.shadowBlur=o.shadowOffsetX=o.shadowOffsetY=0},_isOutSideCanvas:function(o){return o.x<0||o.x>this.canvas.getWidth()||o.y<0||o.y>this.canvas.getHeight()}}),function(){t.PencilBrush=t.util.createClass(t.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(o){this.canvas=o,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(o,a,c){var d=a.midPointFrom(c);return o.quadraticCurveTo(a.x,a.y,d.x,d.y),d},onMouseDown:function(o,a){this.canvas._isMainEvent(a.e)&&(this.drawStraightLine=a.e[this.straightLineKey],this._prepareForDrawing(o),this._captureDrawingPath(o),this._render())},onMouseMove:function(o,a){if(this.canvas._isMainEvent(a.e)&&(this.drawStraightLine=a.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o))&&this._captureDrawingPath(o)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var c=this._points,d=c.length,h=this.canvas.contextTop;this._saveAndTransform(h),this.oldEnd&&(h.beginPath(),h.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(h,c[d-2],c[d-1],!0),h.stroke(),h.restore()}},onMouseUp:function(o){return this.canvas._isMainEvent(o.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(o){var a=new t.Point(o.x,o.y);this._reset(),this._addPoint(a),this.canvas.contextTop.moveTo(a.x,a.y)},_addPoint:function(o){return this._points.length>1&&o.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(o),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(o){var a=new t.Point(o.x,o.y);return this._addPoint(a)},_render:function(o){var a,c,d=this._points[0],h=this._points[1];if(o=o||this.canvas.contextTop,this._saveAndTransform(o),o.beginPath(),this._points.length===2&&d.x===h.x&&d.y===h.y){var f=this.width/1e3;d=new t.Point(d.x,d.y),h=new t.Point(h.x,h.y),d.x-=f,h.x+=f}for(o.moveTo(d.x,d.y),a=1,c=this._points.length;a<c;a++)this._drawSegment(o,d,h),d=this._points[a],h=this._points[a+1];o.lineTo(d.x,d.y),o.stroke(),o.restore()},convertPointsToSVGPath:function(o){var a=this.width/1e3;return t.util.getSmoothPathFromPoints(o,a)},_isEmptySVGPath:function(o){var a=t.util.joinPath(o);return a==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(o){var a=new t.Path(o,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,a.shadow=new t.Shadow(this.shadow)),a},decimatePoints:function(o,a){if(o.length<=2)return o;var c=this.canvas.getZoom(),d=Math.pow(a/c,2),h,f=o.length-1,u=o[0],p=[u],m;for(h=1;h<f-1;h++)m=Math.pow(u.x-o[h].x,2)+Math.pow(u.y-o[h].y,2),m>=d&&(u=o[h],p.push(u));return p.push(o[f]),p},_finalizeAndAddPath:function(){var o=this.canvas.contextTop;o.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var a=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(a)){this.canvas.requestRenderAll();return}var c=this.createPath(a);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:c}),this.canvas.add(c),this.canvas.requestRenderAll(),c.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:c})}})}(),t.CircleBrush=t.util.createClass(t.BaseBrush,{width:10,initialize:function(o){this.canvas=o,this.points=[]},drawDot:function(o){var a=this.addPoint(o),c=this.canvas.contextTop;this._saveAndTransform(c),this.dot(c,a),c.restore()},dot:function(o,a){o.fillStyle=a.fill,o.beginPath(),o.arc(a.x,a.y,a.radius,0,Math.PI*2,!1),o.closePath(),o.fill()},onMouseDown:function(o){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(o)},_render:function(){var o=this.canvas.contextTop,a,c,d=this.points;for(this._saveAndTransform(o),a=0,c=d.length;a<c;a++)this.dot(o,d[a]);o.restore()},onMouseMove:function(o){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(o),this._render()):this.drawDot(o))},onMouseUp:function(){var o=this.canvas.renderOnAddRemove,a,c;this.canvas.renderOnAddRemove=!1;var d=[];for(a=0,c=this.points.length;a<c;a++){var h=this.points[a],f=new t.Circle({radius:h.radius,left:h.x,top:h.y,originX:"center",originY:"center",fill:h.fill});this.shadow&&(f.shadow=new t.Shadow(this.shadow)),d.push(f)}var u=new t.Group(d);u.canvas=this.canvas,this.canvas.fire("before:path:created",{path:u}),this.canvas.add(u),this.canvas.fire("path:created",{path:u}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=o,this.canvas.requestRenderAll()},addPoint:function(o){var a=new t.Point(o.x,o.y),c=t.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,d=new t.Color(this.color).setAlpha(t.util.getRandomInt(0,100)/100).toRgba();return a.radius=c,a.fill=d,this.points.push(a),a}}),t.SprayBrush=t.util.createClass(t.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(o){this.canvas=o,this.sprayChunks=[]},onMouseDown:function(o){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(o),this.render(this.sprayChunkPoints)},onMouseMove:function(o){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o)||(this.addSprayChunk(o),this.render(this.sprayChunkPoints))},onMouseUp:function(){var o=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var a=[],c=0,d=this.sprayChunks.length;c<d;c++)for(var h=this.sprayChunks[c],f=0,u=h.length;f<u;f++){var p=new t.Rect({width:h[f].width,height:h[f].width,left:h[f].x+1,top:h[f].y+1,originX:"center",originY:"center",fill:this.color});a.push(p)}this.optimizeOverlapping&&(a=this._getOptimizedRects(a));var m=new t.Group(a);this.shadow&&m.set("shadow",new t.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:m}),this.canvas.add(m),this.canvas.fire("path:created",{path:m}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=o,this.canvas.requestRenderAll()},_getOptimizedRects:function(o){var a={},c,d,h;for(d=0,h=o.length;d<h;d++)c=o[d].left+""+o[d].top,a[c]||(a[c]=o[d]);var f=[];for(c in a)f.push(a[c]);return f},render:function(o){var a=this.canvas.contextTop,c,d;for(a.fillStyle=this.color,this._saveAndTransform(a),c=0,d=o.length;c<d;c++){var h=o[c];typeof h.opacity<"u"&&(a.globalAlpha=h.opacity),a.fillRect(h.x,h.y,h.width,h.width)}a.restore()},_render:function(){var o=this.canvas.contextTop,a,c;for(o.fillStyle=this.color,this._saveAndTransform(o),a=0,c=this.sprayChunks.length;a<c;a++)this.render(this.sprayChunks[a]);o.restore()},addSprayChunk:function(o){this.sprayChunkPoints=[];var a,c,d,h=this.width/2,f;for(f=0;f<this.density;f++){a=t.util.getRandomInt(o.x-h,o.x+h),c=t.util.getRandomInt(o.y-h,o.y+h),this.dotWidthVariance?d=t.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):d=this.dotWidth;var u=new t.Point(a,c);u.width=d,this.randomOpacity&&(u.opacity=t.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(u)}this.sprayChunks.push(this.sprayChunkPoints)}}),t.PatternBrush=t.util.createClass(t.PencilBrush,{getPatternSrc:function(){var o=20,a=5,c=t.util.createCanvasElement(),d=c.getContext("2d");return c.width=c.height=o+a,d.fillStyle=this.color,d.beginPath(),d.arc(o/2,o/2,o/2,0,Math.PI*2,!1),d.closePath(),d.fill(),c},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(o){return o.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(o){this.callSuper("_setBrushStyles",o),o.strokeStyle=this.getPattern(o)},createPath:function(o){var a=this.callSuper("createPath",o),c=a._getLeftTopCoords().scalarAdd(a.strokeWidth/2);return a.stroke=new t.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-c.x,offsetY:-c.y}),a}}),function(){var o=t.util.getPointer,a=t.util.degreesToRadians,c=t.util.isTouchEvent;t.Canvas=t.util.createClass(t.StaticCanvas,{initialize:function(h,f){f||(f={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(h,f),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=t.PencilBrush&&new t.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var h=this.getActiveObjects(),f,u,p;if(h.length>0&&!this.preserveObjectStacking){u=[],p=[];for(var m=0,g=this._objects.length;m<g;m++)f=this._objects[m],h.indexOf(f)===-1?u.push(f):p.push(f);h.length>1&&(this._activeObject._objects=p),u.push.apply(u,p)}else u=this._objects;return u},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var h=this.contextContainer;return this.renderCanvas(h,this._chooseObjectsToRender()),this},renderTopLayer:function(h){h.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(h),this.contextTopDirty=!0),h.restore()},renderTop:function(){var h=this.contextTop;return this.clearContext(h),this.renderTopLayer(h),this.fire("after:render"),this},_normalizePointer:function(h,f){var u=h.calcTransformMatrix(),p=t.util.invertTransform(u),m=this.restorePointerVpt(f);return t.util.transformPoint(m,p)},isTargetTransparent:function(h,f,u){if(h.shouldCache()&&h._cacheCanvas&&h!==this._activeObject){var p=this._normalizePointer(h,{x:f,y:u}),m=Math.max(h.cacheTranslationX+p.x*h.zoomX,0),g=Math.max(h.cacheTranslationY+p.y*h.zoomY,0),_=t.util.isTransparent(h._cacheContext,Math.round(m),Math.round(g),this.targetFindTolerance);return _}var x=this.contextCache,y=h.selectionBackgroundColor,w=this.viewportTransform;h.selectionBackgroundColor="",this.clearContext(x),x.save(),x.transform(w[0],w[1],w[2],w[3],w[4],w[5]),h.render(x),x.restore(),h.selectionBackgroundColor=y;var _=t.util.isTransparent(x,f,u,this.targetFindTolerance);return _},_isSelectionKeyPressed:function(h){var f=!1;return Array.isArray(this.selectionKey)?f=!!this.selectionKey.find(function(u){return h[u]===!0}):f=h[this.selectionKey],f},_shouldClearSelection:function(h,f){var u=this.getActiveObjects(),p=this._activeObject;return!f||f&&p&&u.length>1&&u.indexOf(f)===-1&&p!==f&&!this._isSelectionKeyPressed(h)||f&&!f.evented||f&&!f.selectable&&p&&p!==f},_shouldCenterTransform:function(h,f,u){if(h){var p;return f==="scale"||f==="scaleX"||f==="scaleY"||f==="resizing"?p=this.centeredScaling||h.centeredScaling:f==="rotate"&&(p=this.centeredRotation||h.centeredRotation),p?!u:u}},_getOriginFromCorner:function(h,f){var u={x:h.originX,y:h.originY};return f==="ml"||f==="tl"||f==="bl"?u.x="right":(f==="mr"||f==="tr"||f==="br")&&(u.x="left"),f==="tl"||f==="mt"||f==="tr"?u.y="bottom":(f==="bl"||f==="mb"||f==="br")&&(u.y="top"),u},_getActionFromCorner:function(h,f,u,p){if(!f||!h)return"drag";var m=p.controls[f];return m.getActionName(u,m,p)},_setupCurrentTransform:function(h,f,u){if(f){var p=this.getPointer(h),m=f.__corner,g=f.controls[m],x=u&&m?g.getActionHandler(h,f,g):t.controlsUtils.dragHandler,y=this._getActionFromCorner(u,m,h,f),w=this._getOriginFromCorner(f,m),_=h[this.centeredKey],b={target:f,action:y,actionHandler:x,corner:m,scaleX:f.scaleX,scaleY:f.scaleY,skewX:f.skewX,skewY:f.skewY,offsetX:p.x-f.left,offsetY:p.y-f.top,originX:w.x,originY:w.y,ex:p.x,ey:p.y,lastX:p.x,lastY:p.y,theta:a(f.angle),width:f.width*f.scaleX,shiftKey:h.shiftKey,altKey:_,original:t.util.saveObjectTransform(f)};this._shouldCenterTransform(f,y,_)&&(b.originX="center",b.originY="center"),b.original.originX=w.x,b.original.originY=w.y,this._currentTransform=b,this._beforeTransform(h)}},setCursor:function(h){this.upperCanvasEl.style.cursor=h},_drawSelection:function(h){var f=this._groupSelector,u=new t.Point(f.ex,f.ey),p=t.util.transformPoint(u,this.viewportTransform),m=new t.Point(f.ex+f.left,f.ey+f.top),g=t.util.transformPoint(m,this.viewportTransform),x=Math.min(p.x,g.x),y=Math.min(p.y,g.y),w=Math.max(p.x,g.x),_=Math.max(p.y,g.y),b=this.selectionLineWidth/2;this.selectionColor&&(h.fillStyle=this.selectionColor,h.fillRect(x,y,w-x,_-y)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(h.lineWidth=this.selectionLineWidth,h.strokeStyle=this.selectionBorderColor,x+=b,y+=b,w-=b,_-=b,t.Object.prototype._setLineDash.call(this,h,this.selectionDashArray),h.strokeRect(x,y,w-x,_-y))},findTarget:function(h,f){if(!this.skipTargetFind){var u=!0,p=this.getPointer(h,u),m=this._activeObject,g=this.getActiveObjects(),x,y,w=c(h),_=g.length>1&&!f||g.length===1;if(this.targets=[],_&&m._findTargetCorner(p,w)||g.length>1&&!f&&m===this._searchPossibleTargets([m],p))return m;if(g.length===1&&m===this._searchPossibleTargets([m],p))if(this.preserveObjectStacking)x=m,y=this.targets,this.targets=[];else return m;var b=this._searchPossibleTargets(this._objects,p);return h[this.altSelectionKey]&&b&&x&&b!==x&&(b=x,this.targets=y),b}},_checkTarget:function(h,f,u){if(f&&f.visible&&f.evented&&f.containsPoint(h))if((this.perPixelTargetFind||f.perPixelTargetFind)&&!f.isEditing){var p=this.isTargetTransparent(f,u.x,u.y);if(!p)return!0}else return!0},_searchPossibleTargets:function(h,f){for(var u,p=h.length,m;p--;){var g=h[p],x=g.group?this._normalizePointer(g.group,f):f;if(this._checkTarget(x,g,f)){u=h[p],u.subTargetCheck&&u instanceof t.Group&&(m=this._searchPossibleTargets(u._objects,f),m&&this.targets.push(m));break}}return u},restorePointerVpt:function(h){return t.util.transformPoint(h,t.util.invertTransform(this.viewportTransform))},getPointer:function(h,f){if(this._absolutePointer&&!f)return this._absolutePointer;if(this._pointer&&f)return this._pointer;var u=o(h),p=this.upperCanvasEl,m=p.getBoundingClientRect(),g=m.width||0,x=m.height||0,y;(!g||!x)&&("top"in m&&"bottom"in m&&(x=Math.abs(m.top-m.bottom)),"right"in m&&"left"in m&&(g=Math.abs(m.right-m.left))),this.calcOffset(),u.x=u.x-this._offset.left,u.y=u.y-this._offset.top,f||(u=this.restorePointerVpt(u));var w=this.getRetinaScaling();return w!==1&&(u.x/=w,u.y/=w),g===0||x===0?y={width:1,height:1}:y={width:p.width/g,height:p.height/x},{x:u.x*y.width,y:u.y*y.height}},_createUpperCanvas:function(){var h=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),f=this.lowerCanvasEl,u=this.upperCanvasEl;u?u.className="":(u=this._createCanvasElement(),this.upperCanvasEl=u),t.util.addClass(u,"upper-canvas "+h),this.wrapperEl.appendChild(u),this._copyCanvasStyle(f,u),this._applyCanvasStyle(u),this.contextTop=u.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=t.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),t.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),t.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(h){var f=this.width||h.width,u=this.height||h.height;t.util.setStyle(h,{position:"absolute",width:f+"px",height:u+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),h.width=f,h.height=u,t.util.makeElementUnselectable(h)},_copyCanvasStyle:function(h,f){f.style.cssText=h.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var h=this._activeObject;return h?h.type==="activeSelection"&&h._objects?h._objects.slice(0):[h]:[]},_onObjectRemoved:function(h){h===this._activeObject&&(this.fire("before:selection:cleared",{target:h}),this._discardActiveObject(),this.fire("selection:cleared",{target:h}),h.fire("deselected")),h===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",h)},_fireSelectionEvents:function(h,f){var u=!1,p=this.getActiveObjects(),m=[],g=[];h.forEach(function(x){p.indexOf(x)===-1&&(u=!0,x.fire("deselected",{e:f,target:x}),g.push(x))}),p.forEach(function(x){h.indexOf(x)===-1&&(u=!0,x.fire("selected",{e:f,target:x}),m.push(x))}),h.length>0&&p.length>0?u&&this.fire("selection:updated",{e:f,selected:m,deselected:g}):p.length>0?this.fire("selection:created",{e:f,selected:m}):h.length>0&&this.fire("selection:cleared",{e:f,deselected:g})},setActiveObject:function(h,f){var u=this.getActiveObjects();return this._setActiveObject(h,f),this._fireSelectionEvents(u,f),this},_setActiveObject:function(h,f){return this._activeObject===h||!this._discardActiveObject(f,h)||h.onSelect({e:f})?!1:(this._activeObject=h,!0)},_discardActiveObject:function(h,f){var u=this._activeObject;if(u){if(u.onDeselect({e:h,object:f}))return!1;this._activeObject=null}return!0},discardActiveObject:function(h){var f=this.getActiveObjects(),u=this.getActiveObject();return f.length&&this.fire("before:selection:cleared",{target:u,e:h}),this._discardActiveObject(h),this._fireSelectionEvents(f,h),this},dispose:function(){var h=this.wrapperEl;return this.removeListeners(),h.removeChild(this.upperCanvasEl),h.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach((function(f){t.util.cleanUpJsdomNode(this[f]),this[f]=void 0}).bind(this)),h.parentNode&&h.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,t.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(h){var f=this._activeObject;f&&f._renderControls(h)},_toObject:function(h,f,u){var p=this._realizeGroupTransformOnObject(h),m=this.callSuper("_toObject",h,f,u);return this._unwindGroupTransformOnObject(h,p),m},_realizeGroupTransformOnObject:function(h){if(h.group&&h.group.type==="activeSelection"&&this._activeObject===h.group){var f=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],u={};return f.forEach(function(p){u[p]=h[p]}),t.util.addTransformToObject(h,this._activeObject.calcOwnMatrix()),u}else return null},_unwindGroupTransformOnObject:function(h,f){f&&h.set(f)},_setSVGObject:function(h,f,u){var p=this._realizeGroupTransformOnObject(f);this.callSuper("_setSVGObject",h,f,u),this._unwindGroupTransformOnObject(f,p)},setViewportTransform:function(h){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),t.StaticCanvas.prototype.setViewportTransform.call(this,h)}});for(var d in t.StaticCanvas)d!=="prototype"&&(t.Canvas[d]=t.StaticCanvas[d])}(),function(){var o=t.util.addListener,a=t.util.removeListener,c=3,d=2,h=1,f={passive:!1};function u(p,m){return p.button&&p.button===m-1}t.util.object.extend(t.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(o,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(p,m){var g=this.upperCanvasEl,x=this._getEventPrefix();p(t.window,"resize",this._onResize),p(g,x+"down",this._onMouseDown),p(g,x+"move",this._onMouseMove,f),p(g,x+"out",this._onMouseOut),p(g,x+"enter",this._onMouseEnter),p(g,"wheel",this._onMouseWheel),p(g,"contextmenu",this._onContextMenu),p(g,"dblclick",this._onDoubleClick),p(g,"dragover",this._onDragOver),p(g,"dragenter",this._onDragEnter),p(g,"dragleave",this._onDragLeave),p(g,"drop",this._onDrop),this.enablePointerEvents||p(g,"touchstart",this._onTouchStart,f),typeof eventjs<"u"&&m in eventjs&&(eventjs[m](g,"gesture",this._onGesture),eventjs[m](g,"drag",this._onDrag),eventjs[m](g,"orientation",this._onOrientationChange),eventjs[m](g,"shake",this._onShake),eventjs[m](g,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(a,"remove");var p=this._getEventPrefix();a(t.document,p+"up",this._onMouseUp),a(t.document,"touchend",this._onTouchEnd,f),a(t.document,p+"move",this._onMouseMove,f),a(t.document,"touchmove",this._onMouseMove,f)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(p,m){this.__onTransformGesture&&this.__onTransformGesture(p,m)},_onDrag:function(p,m){this.__onDrag&&this.__onDrag(p,m)},_onMouseWheel:function(p){this.__onMouseWheel(p)},_onMouseOut:function(p){var m=this._hoveredTarget;this.fire("mouse:out",{target:m,e:p}),this._hoveredTarget=null,m&&m.fire("mouseout",{e:p});var g=this;this._hoveredTargets.forEach(function(x){g.fire("mouse:out",{target:x,e:p}),x&&x.fire("mouseout",{e:p})}),this._hoveredTargets=[]},_onMouseEnter:function(p){!this._currentTransform&&!this.findTarget(p)&&(this.fire("mouse:over",{target:null,e:p}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(p,m){this.__onOrientationChange&&this.__onOrientationChange(p,m)},_onShake:function(p,m){this.__onShake&&this.__onShake(p,m)},_onLongPress:function(p,m){this.__onLongPress&&this.__onLongPress(p,m)},_onDragOver:function(p){p.preventDefault();var m=this._simpleEventHandler("dragover",p);this._fireEnterLeaveEvents(m,p)},_onDrop:function(p){return this._simpleEventHandler("drop:before",p),this._simpleEventHandler("drop",p)},_onContextMenu:function(p){return this.stopContextMenu&&(p.stopPropagation(),p.preventDefault()),!1},_onDoubleClick:function(p){this._cacheTransformEventData(p),this._handleEvent(p,"dblclick"),this._resetTransformEventData(p)},getPointerId:function(p){var m=p.changedTouches;return m?m[0]&&m[0].identifier:this.enablePointerEvents?p.pointerId:-1},_isMainEvent:function(p){return p.isPrimary===!0?!0:p.isPrimary===!1?!1:p.type==="touchend"&&p.touches.length===0?!0:p.changedTouches?p.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(p){p.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(p)),this.__onMouseDown(p),this._resetTransformEventData();var m=this.upperCanvasEl,g=this._getEventPrefix();o(t.document,"touchend",this._onTouchEnd,f),o(t.document,"touchmove",this._onMouseMove,f),a(m,g+"down",this._onMouseDown)},_onMouseDown:function(p){this.__onMouseDown(p),this._resetTransformEventData();var m=this.upperCanvasEl,g=this._getEventPrefix();a(m,g+"move",this._onMouseMove,f),o(t.document,g+"up",this._onMouseUp),o(t.document,g+"move",this._onMouseMove,f)},_onTouchEnd:function(p){if(!(p.touches.length>0)){this.__onMouseUp(p),this._resetTransformEventData(),this.mainTouchId=null;var m=this._getEventPrefix();a(t.document,"touchend",this._onTouchEnd,f),a(t.document,"touchmove",this._onMouseMove,f);var g=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){o(g.upperCanvasEl,m+"down",g._onMouseDown),g._willAddMouseDown=0},400)}},_onMouseUp:function(p){this.__onMouseUp(p),this._resetTransformEventData();var m=this.upperCanvasEl,g=this._getEventPrefix();this._isMainEvent(p)&&(a(t.document,g+"up",this._onMouseUp),a(t.document,g+"move",this._onMouseMove,f),o(m,g+"move",this._onMouseMove,f))},_onMouseMove:function(p){!this.allowTouchScrolling&&p.preventDefault&&p.preventDefault(),this.__onMouseMove(p)},_onResize:function(){this.calcOffset()},_shouldRender:function(p){var m=this._activeObject;return!!m!=!!p||m&&p&&m!==p?!0:(m&&m.isEditing,!1)},__onMouseUp:function(p){var m,g=this._currentTransform,x=this._groupSelector,y=!1,w=!x||x.left===0&&x.top===0;if(this._cacheTransformEventData(p),m=this._target,this._handleEvent(p,"up:before"),u(p,c)){this.fireRightClick&&this._handleEvent(p,"up",c,w);return}if(u(p,d)){this.fireMiddleClick&&this._handleEvent(p,"up",d,w),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(p);return}if(this._isMainEvent(p)){if(g&&(this._finalizeCurrentTransform(p),y=g.actionPerformed),!w){var _=m===this._activeObject;this._maybeGroupObjects(p),y||(y=this._shouldRender(m)||!_&&m===this._activeObject)}var b,k;if(m){if(b=m._findTargetCorner(this.getPointer(p,!0),t.util.isTouchEvent(p)),m.selectable&&m!==this._activeObject&&m.activeOn==="up")this.setActiveObject(m,p),y=!0;else{var S=m.controls[b],E=S&&S.getMouseUpHandler(p,m,S);E&&(k=this.getPointer(p),E(p,g,k.x,k.y))}m.isMoving=!1}if(g&&(g.target!==m||g.corner!==b)){var F=g.target&&g.target.controls[g.corner],P=F&&F.getMouseUpHandler(p,m,S);k=k||this.getPointer(p),P&&P(p,g,k.x,k.y)}this._setCursorFromEvent(p,m),this._handleEvent(p,"up",h,w),this._groupSelector=null,this._currentTransform=null,m&&(m.__corner=0),y?this.requestRenderAll():w||this.renderTop()}},_simpleEventHandler:function(p,m){var g=this.findTarget(m),x=this.targets,y={e:m,target:g,subTargets:x};if(this.fire(p,y),g&&g.fire(p,y),!x)return g;for(var w=0;w<x.length;w++)x[w].fire(p,y);return g},_handleEvent:function(p,m,g,x){var y=this._target,w=this.targets||[],_={e:p,target:y,subTargets:w,button:g||h,isClick:x||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};m==="up"&&(_.currentTarget=this.findTarget(p),_.currentSubTargets=this.targets),this.fire("mouse:"+m,_),y&&y.fire("mouse"+m,_);for(var b=0;b<w.length;b++)w[b].fire("mouse"+m,_)},_finalizeCurrentTransform:function(p){var m=this._currentTransform,g=m.target,x={e:p,target:g,transform:m,action:m.action};g._scaling&&(g._scaling=!1),g.setCoords(),(m.actionPerformed||this.stateful&&g.hasStateChanged())&&this._fire("modified",x)},_onMouseDownInDrawingMode:function(p){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(p).requestRenderAll();var m=this.getPointer(p);this.freeDrawingBrush.onMouseDown(m,{e:p,pointer:m}),this._handleEvent(p,"down")},_onMouseMoveInDrawingMode:function(p){if(this._isCurrentlyDrawing){var m=this.getPointer(p);this.freeDrawingBrush.onMouseMove(m,{e:p,pointer:m})}this.setCursor(this.freeDrawingCursor),this._handleEvent(p,"move")},_onMouseUpInDrawingMode:function(p){var m=this.getPointer(p);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:p,pointer:m}),this._handleEvent(p,"up")},__onMouseDown:function(p){this._cacheTransformEventData(p),this._handleEvent(p,"down:before");var m=this._target;if(u(p,c)){this.fireRightClick&&this._handleEvent(p,"down",c);return}if(u(p,d)){this.fireMiddleClick&&this._handleEvent(p,"down",d);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(p);return}if(this._isMainEvent(p)&&!this._currentTransform){var g=this._pointer;this._previousPointer=g;var x=this._shouldRender(m),y=this._shouldGroup(p,m);if(this._shouldClearSelection(p,m)?this.discardActiveObject(p):y&&(this._handleGrouping(p,m),m=this._activeObject),this.selection&&(!m||!m.selectable&&!m.isEditing&&m!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),m){var w=m===this._activeObject;m.selectable&&m.activeOn==="down"&&this.setActiveObject(m,p);var _=m._findTargetCorner(this.getPointer(p,!0),t.util.isTouchEvent(p));if(m.__corner=_,m===this._activeObject&&(_||!y)){this._setupCurrentTransform(p,m,w);var b=m.controls[_],g=this.getPointer(p),k=b&&b.getMouseDownHandler(p,m,b);k&&k(p,this._currentTransform,g.x,g.y)}}this._handleEvent(p,"down"),(x||y)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(p){this._resetTransformEventData(),this._pointer=this.getPointer(p,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(p)||null},_beforeTransform:function(p){var m=this._currentTransform;this.stateful&&m.target.saveState(),this.fire("before:transform",{e:p,transform:m})},__onMouseMove:function(p){this._handleEvent(p,"move:before"),this._cacheTransformEventData(p);var m,g;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(p);return}if(this._isMainEvent(p)){var x=this._groupSelector;x?(g=this._absolutePointer,x.left=g.x-x.ex,x.top=g.y-x.ey,this.renderTop()):this._currentTransform?this._transformObject(p):(m=this.findTarget(p)||null,this._setCursorFromEvent(p,m),this._fireOverOutEvents(m,p)),this._handleEvent(p,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(p,m){var g=this._hoveredTarget,x=this._hoveredTargets,y=this.targets,w=Math.max(x.length,y.length);this.fireSyntheticInOutEvents(p,m,{oldTarget:g,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var _=0;_<w;_++)this.fireSyntheticInOutEvents(y[_],m,{oldTarget:x[_],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=p,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(p,m){var g=this._draggedoverTarget,x=this._hoveredTargets,y=this.targets,w=Math.max(x.length,y.length);this.fireSyntheticInOutEvents(p,m,{oldTarget:g,evtOut:"dragleave",evtIn:"dragenter"});for(var _=0;_<w;_++)this.fireSyntheticInOutEvents(y[_],m,{oldTarget:x[_],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=p},fireSyntheticInOutEvents:function(p,m,g){var x,y,w=g.oldTarget,_,b,k=w!==p,S=g.canvasEvtIn,E=g.canvasEvtOut;k&&(x={e:m,target:p,previousTarget:w},y={e:m,target:w,nextTarget:p}),b=p&&k,_=w&&k,_&&(E&&this.fire(E,y),w.fire(g.evtOut,y)),b&&(S&&this.fire(S,x),p.fire(g.evtIn,x))},__onMouseWheel:function(p){this._cacheTransformEventData(p),this._handleEvent(p,"wheel"),this._resetTransformEventData()},_transformObject:function(p){var m=this.getPointer(p),g=this._currentTransform;g.reset=!1,g.shiftKey=p.shiftKey,g.altKey=p[this.centeredKey],this._performTransformAction(p,g,m),g.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(p,m,g){var x=g.x,y=g.y,w=m.action,_=!1,b=m.actionHandler;b&&(_=b(p,m,x,y)),w==="drag"&&_&&(m.target.isMoving=!0,this.setCursor(m.target.moveCursor||this.moveCursor)),m.actionPerformed=m.actionPerformed||_},_fire:t.controlsUtils.fireEvent,_setCursorFromEvent:function(p,m){if(!m)return this.setCursor(this.defaultCursor),!1;var g=m.hoverCursor||this.hoverCursor,x=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,y=(!x||!x.contains(m))&&m._findTargetCorner(this.getPointer(p,!0));y?this.setCursor(this.getCornerCursor(y,m,p)):(m.subTargetCheck&&this.targets.concat().reverse().map(function(w){g=w.hoverCursor||g}),this.setCursor(g))},getCornerCursor:function(p,m,g){var x=m.controls[p];return x.cursorStyleHandler(g,x,m)}})}(),function(){var o=Math.min,a=Math.max;t.util.object.extend(t.Canvas.prototype,{_shouldGroup:function(c,d){var h=this._activeObject;return h&&this._isSelectionKeyPressed(c)&&d&&d.selectable&&this.selection&&(h!==d||h.type==="activeSelection")&&!d.onSelect({e:c})},_handleGrouping:function(c,d){var h=this._activeObject;h.__corner||d===h&&(d=this.findTarget(c,!0),!d||!d.selectable)||(h&&h.type==="activeSelection"?this._updateActiveSelection(d,c):this._createActiveSelection(d,c))},_updateActiveSelection:function(c,d){var h=this._activeObject,f=h._objects.slice(0);h.contains(c)?(h.removeWithUpdate(c),this._hoveredTarget=c,this._hoveredTargets=this.targets.concat(),h.size()===1&&this._setActiveObject(h.item(0),d)):(h.addWithUpdate(c),this._hoveredTarget=h,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(f,d)},_createActiveSelection:function(c,d){var h=this.getActiveObjects(),f=this._createGroup(c);this._hoveredTarget=f,this._setActiveObject(f,d),this._fireSelectionEvents(h,d)},_createGroup:function(c){var d=this._objects,h=d.indexOf(this._activeObject)<d.indexOf(c),f=h?[this._activeObject,c]:[c,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new t.ActiveSelection(f,{canvas:this})},_groupSelectedObjects:function(c){var d=this._collectObjects(c),h;d.length===1?this.setActiveObject(d[0],c):d.length>1&&(h=new t.ActiveSelection(d.reverse(),{canvas:this}),this.setActiveObject(h,c))},_collectObjects:function(c){for(var d=[],h,f=this._groupSelector.ex,u=this._groupSelector.ey,p=f+this._groupSelector.left,m=u+this._groupSelector.top,g=new t.Point(o(f,p),o(u,m)),x=new t.Point(a(f,p),a(u,m)),y=!this.selectionFullyContained,w=f===p&&u===m,_=this._objects.length;_--&&(h=this._objects[_],!(!(!h||!h.selectable||!h.visible)&&(y&&h.intersectsWithRect(g,x,!0)||h.isContainedWithinRect(g,x,!0)||y&&h.containsPoint(g,null,!0)||y&&h.containsPoint(x,null,!0))&&(d.push(h),w))););return d.length>1&&(d=d.filter(function(b){return!b.onSelect({e:c})})),d},_maybeGroupObjects:function(c){this.selection&&this._groupSelector&&this._groupSelectedObjects(c),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){t.util.object.extend(t.StaticCanvas.prototype,{toDataURL:function(o){o||(o={});var a=o.format||"png",c=o.quality||1,d=(o.multiplier||1)*(o.enableRetinaScaling?this.getRetinaScaling():1),h=this.toCanvasElement(d,o);return t.util.toDataURL(h,a,c)},toCanvasElement:function(o,a){o=o||1,a=a||{};var c=(a.width||this.width)*o,d=(a.height||this.height)*o,h=this.getZoom(),f=this.width,u=this.height,p=h*o,m=this.viewportTransform,g=(m[4]-(a.left||0))*o,x=(m[5]-(a.top||0))*o,y=this.interactive,w=[p,0,0,p,g,x],_=this.enableRetinaScaling,b=t.util.createCanvasElement(),k=this.contextTop;return b.width=c,b.height=d,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=w,this.width=c,this.height=d,this.calcViewportBoundaries(),this.renderCanvas(b.getContext("2d"),this._objects),this.viewportTransform=m,this.width=f,this.height=u,this.calcViewportBoundaries(),this.interactive=y,this.enableRetinaScaling=_,this.contextTop=k,b}})}(),t.util.object.extend(t.StaticCanvas.prototype,{loadFromJSON:function(o,a,c){if(o){var d=typeof o=="string"?JSON.parse(o):t.util.object.clone(o),h=this,f=d.clipPath,u=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete d.clipPath,this._enlivenObjects(d.objects,function(p){h.clear(),h._setBgOverlay(d,function(){f?h._enlivenObjects([f],function(m){h.clipPath=m[0],h.__setupCanvas.call(h,d,p,u,a)}):h.__setupCanvas.call(h,d,p,u,a)})},c),this}},__setupCanvas:function(o,a,c,d){var h=this;a.forEach(function(f,u){h.insertAt(f,u)}),this.renderOnAddRemove=c,delete o.objects,delete o.backgroundImage,delete o.overlayImage,delete o.background,delete o.overlay,this._setOptions(o),this.renderAll(),d&&d()},_setBgOverlay:function(o,a){var c={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!o.backgroundImage&&!o.overlayImage&&!o.background&&!o.overlay){a&&a();return}var d=function(){c.backgroundImage&&c.overlayImage&&c.backgroundColor&&c.overlayColor&&a&&a()};this.__setBgOverlay("backgroundImage",o.backgroundImage,c,d),this.__setBgOverlay("overlayImage",o.overlayImage,c,d),this.__setBgOverlay("backgroundColor",o.background,c,d),this.__setBgOverlay("overlayColor",o.overlay,c,d)},__setBgOverlay:function(o,a,c,d){var h=this;if(!a){c[o]=!0,d&&d();return}o==="backgroundImage"||o==="overlayImage"?t.util.enlivenObjects([a],function(f){h[o]=f[0],c[o]=!0,d&&d()}):this["set"+t.util.string.capitalize(o,!0)](a,function(){c[o]=!0,d&&d()})},_enlivenObjects:function(o,a,c){if(!o||o.length===0){a&&a([]);return}t.util.enlivenObjects(o,function(d){a&&a(d)},null,c)},_toDataURL:function(o,a){this.clone(function(c){a(c.toDataURL(o))})},_toDataURLWithMultiplier:function(o,a,c){this.clone(function(d){c(d.toDataURLWithMultiplier(o,a))})},clone:function(o,a){var c=JSON.stringify(this.toJSON(a));this.cloneWithoutData(function(d){d.loadFromJSON(c,function(){o&&o(d)})})},cloneWithoutData:function(o){var a=t.util.createCanvasElement();a.width=this.width,a.height=this.height;var c=new t.Canvas(a);this.backgroundImage?(c.setBackgroundImage(this.backgroundImage.src,function(){c.renderAll(),o&&o(c)}),c.backgroundImageOpacity=this.backgroundImageOpacity,c.backgroundImageStretch=this.backgroundImageStretch):o&&o(c)}}),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.util.object.clone,h=a.util.toFixed,f=a.util.string.capitalize,u=a.util.degreesToRadians,p=!a.isLikelyNode,m=2;a.Object||(a.Object=a.util.createClass(a.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:p,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(g){g&&this.setOptions(g)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=a.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(g){var x=a.perfLimitSizeTotal,y=g.width,w=g.height,_=a.maxCacheSideLimit,b=a.minCacheSideLimit;if(y<=_&&w<=_&&y*w<=x)return y<b&&(g.width=b),w<b&&(g.height=b),g;var k=y/w,S=a.util.limitDimsByArea(k,x),E=a.util.capValue,F=E(b,S.x,_),P=E(b,S.y,_);return y>F&&(g.zoomX/=y/F,g.width=F,g.capped=!0),w>P&&(g.zoomY/=w/P,g.height=P,g.capped=!0),g},_getCacheCanvasDimensions:function(){var g=this.getTotalObjectScaling(),x=this._getTransformedDimensions(0,0),y=x.x*g.scaleX/this.scaleX,w=x.y*g.scaleY/this.scaleY;return{width:Math.ceil(y+m),height:Math.ceil(w+m),zoomX:g.scaleX,zoomY:g.scaleY,x:y,y:w}},_updateCacheCanvas:function(){var g=this.canvas;if(this.noScaleCache&&g&&g._currentTransform){var x=g._currentTransform.target,y=g._currentTransform.action;if(this===x&&y.slice&&y.slice(0,5)==="scale")return!1}var w=this._cacheCanvas,_=this._limitCacheSize(this._getCacheCanvasDimensions()),b=_.width,k=_.height,S,E,F=_.zoomX,P=_.zoomY,D=b!==this.cacheWidth||k!==this.cacheHeight,I=this.zoomX!==F||this.zoomY!==P,X=D||I;return X?(D?(w.width=b,w.height=k):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,w.width,w.height)),S=_.x/2,E=_.y/2,this.cacheTranslationX=Math.round(w.width/2-S)+S,this.cacheTranslationY=Math.round(w.height/2-E)+E,this.cacheWidth=b,this.cacheHeight=k,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(F,P),this.zoomX=F,this.zoomY=P,!0):!1},setOptions:function(g){this._setOptions(g),this._initGradient(g.fill,"fill"),this._initGradient(g.stroke,"stroke"),this._initPattern(g.fill,"fill"),this._initPattern(g.stroke,"stroke")},transform:function(g){var x=this.group&&!this.group._transformDone||this.group&&this.canvas&&g===this.canvas.contextTop,y=this.calcTransformMatrix(!x);g.transform(y[0],y[1],y[2],y[3],y[4],y[5])},toObject:function(g){var x=a.Object.NUM_FRACTION_DIGITS,y={type:this.type,version:a.version,originX:this.originX,originY:this.originY,left:h(this.left,x),top:h(this.top,x),width:h(this.width,x),height:h(this.height,x),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:h(this.strokeWidth,x),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:h(this.strokeMiterLimit,x),scaleX:h(this.scaleX,x),scaleY:h(this.scaleY,x),angle:h(this.angle,x),flipX:this.flipX,flipY:this.flipY,opacity:h(this.opacity,x),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:h(this.skewX,x),skewY:h(this.skewY,x)};return this.clipPath&&!this.clipPath.excludeFromExport&&(y.clipPath=this.clipPath.toObject(g),y.clipPath.inverted=this.clipPath.inverted,y.clipPath.absolutePositioned=this.clipPath.absolutePositioned),a.util.populateWithProperties(this,y,g),this.includeDefaultValues||(y=this._removeDefaultValues(y)),y},toDatalessObject:function(g){return this.toObject(g)},_removeDefaultValues:function(g){var x=a.util.getKlass(g.type).prototype,y=x.stateProperties;return y.forEach(function(w){w==="left"||w==="top"||(g[w]===x[w]&&delete g[w],Array.isArray(g[w])&&Array.isArray(x[w])&&g[w].length===0&&x[w].length===0&&delete g[w])}),g},toString:function(){return"#<fabric."+f(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var g=a.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(g.scaleX),scaleY:Math.abs(g.scaleY)}},getTotalObjectScaling:function(){var g=this.getObjectScaling(),x=g.scaleX,y=g.scaleY;if(this.canvas){var w=this.canvas.getZoom(),_=this.canvas.getRetinaScaling();x*=w*_,y*=w*_}return{scaleX:x,scaleY:y}},getObjectOpacity:function(){var g=this.opacity;return this.group&&(g*=this.group.getObjectOpacity()),g},_set:function(g,x){var y=g==="scaleX"||g==="scaleY",w=this[g]!==x,_=!1;return y&&(x=this._constrainScale(x)),g==="scaleX"&&x<0?(this.flipX=!this.flipX,x*=-1):g==="scaleY"&&x<0?(this.flipY=!this.flipY,x*=-1):g==="shadow"&&x&&!(x instanceof a.Shadow)?x=new a.Shadow(x):g==="dirty"&&this.group&&this.group.set("dirty",x),this[g]=x,w&&(_=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(g)>-1?(this.dirty=!0,_&&this.group.set("dirty",!0)):_&&this.stateProperties.indexOf(g)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:a.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(g){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(g.save(),this._setupCompositeOperation(g),this.drawSelectionBackground(g),this.transform(g),this._setOpacity(g),this._setShadow(g,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(g)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(g),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),g.restore())},renderCache:function(g){g=g||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,g.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(g,x){if(g.save(),x.inverted?g.globalCompositeOperation="destination-out":g.globalCompositeOperation="destination-in",x.absolutePositioned){var y=a.util.invertTransform(this.calcTransformMatrix());g.transform(y[0],y[1],y[2],y[3],y[4],y[5])}x.transform(g),g.scale(1/x.zoomX,1/x.zoomY),g.drawImage(x._cacheCanvas,-x.cacheTranslationX,-x.cacheTranslationY),g.restore()},drawObject:function(g,x){var y=this.fill,w=this.stroke;x?(this.fill="black",this.stroke="",this._setClippingProperties(g)):this._renderBackground(g),this._render(g),this._drawClipPath(g,this.clipPath),this.fill=y,this.stroke=w},_drawClipPath:function(g,x){x&&(x.canvas=this.canvas,x.shouldCache(),x._transformDone=!0,x.renderCache({forClipping:!0}),this.drawClipPathOnCache(g,x))},drawCacheOnCanvas:function(g){g.scale(1/this.zoomX,1/this.zoomY),g.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(g){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!g&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!g){var x=this.cacheWidth/this.zoomX,y=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-x/2,-y/2,x,y)}return!0}return!1},_renderBackground:function(g){if(this.backgroundColor){var x=this._getNonTransformedDimensions();g.fillStyle=this.backgroundColor,g.fillRect(-x.x/2,-x.y/2,x.x,x.y),this._removeShadow(g)}},_setOpacity:function(g){this.group&&!this.group._transformDone?g.globalAlpha=this.getObjectOpacity():g.globalAlpha*=this.opacity},_setStrokeStyles:function(g,x){var y=x.stroke;y&&(g.lineWidth=x.strokeWidth,g.lineCap=x.strokeLineCap,g.lineDashOffset=x.strokeDashOffset,g.lineJoin=x.strokeLineJoin,g.miterLimit=x.strokeMiterLimit,y.toLive?y.gradientUnits==="percentage"||y.gradientTransform||y.patternTransform?this._applyPatternForTransformedGradient(g,y):(g.strokeStyle=y.toLive(g,this),this._applyPatternGradientTransform(g,y)):g.strokeStyle=x.stroke)},_setFillStyles:function(g,x){var y=x.fill;y&&(y.toLive?(g.fillStyle=y.toLive(g,this),this._applyPatternGradientTransform(g,x.fill)):g.fillStyle=y)},_setClippingProperties:function(g){g.globalAlpha=1,g.strokeStyle="transparent",g.fillStyle="#000000"},_setLineDash:function(g,x){!x||x.length===0||(1&x.length&&x.push.apply(x,x),g.setLineDash(x))},_renderControls:function(g,x){var y=this.getViewportTransform(),w=this.calcTransformMatrix(),_,b,k;x=x||{},b=typeof x.hasBorders<"u"?x.hasBorders:this.hasBorders,k=typeof x.hasControls<"u"?x.hasControls:this.hasControls,w=a.util.multiplyTransformMatrices(y,w),_=a.util.qrDecompose(w),g.save(),g.translate(_.translateX,_.translateY),g.lineWidth=1*this.borderScaleFactor,this.group||(g.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(_.angle-=180),g.rotate(u(this.group?_.angle:this.angle)),x.forActiveSelection||this.group?b&&this.drawBordersInGroup(g,_,x):b&&this.drawBorders(g,x),k&&this.drawControls(g,x),g.restore()},_setShadow:function(g){if(this.shadow){var x=this.shadow,y=this.canvas,w,_=y&&y.viewportTransform[0]||1,b=y&&y.viewportTransform[3]||1;x.nonScaling?w={scaleX:1,scaleY:1}:w=this.getObjectScaling(),y&&y._isRetinaScaling()&&(_*=a.devicePixelRatio,b*=a.devicePixelRatio),g.shadowColor=x.color,g.shadowBlur=x.blur*a.browserShadowBlurConstant*(_+b)*(w.scaleX+w.scaleY)/4,g.shadowOffsetX=x.offsetX*_*w.scaleX,g.shadowOffsetY=x.offsetY*b*w.scaleY}},_removeShadow:function(g){this.shadow&&(g.shadowColor="",g.shadowBlur=g.shadowOffsetX=g.shadowOffsetY=0)},_applyPatternGradientTransform:function(g,x){if(!x||!x.toLive)return{offsetX:0,offsetY:0};var y=x.gradientTransform||x.patternTransform,w=-this.width/2+x.offsetX||0,_=-this.height/2+x.offsetY||0;return x.gradientUnits==="percentage"?g.transform(this.width,0,0,this.height,w,_):g.transform(1,0,0,1,w,_),y&&g.transform(y[0],y[1],y[2],y[3],y[4],y[5]),{offsetX:w,offsetY:_}},_renderPaintInOrder:function(g){this.paintFirst==="stroke"?(this._renderStroke(g),this._renderFill(g)):(this._renderFill(g),this._renderStroke(g))},_render:function(){},_renderFill:function(g){this.fill&&(g.save(),this._setFillStyles(g,this),this.fillRule==="evenodd"?g.fill("evenodd"):g.fill(),g.restore())},_renderStroke:function(g){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(g),g.save(),this.strokeUniform&&this.group){var x=this.getObjectScaling();g.scale(1/x.scaleX,1/x.scaleY)}else this.strokeUniform&&g.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(g,this.strokeDashArray),this._setStrokeStyles(g,this),g.stroke(),g.restore()}},_applyPatternForTransformedGradient:function(g,x){var y=this._limitCacheSize(this._getCacheCanvasDimensions()),w=a.util.createCanvasElement(),_,b=this.canvas.getRetinaScaling(),k=y.x/this.scaleX/b,S=y.y/this.scaleY/b;w.width=Math.ceil(k),w.height=Math.ceil(S),_=w.getContext("2d"),_.beginPath(),_.moveTo(0,0),_.lineTo(k,0),_.lineTo(k,S),_.lineTo(0,S),_.closePath(),_.translate(k/2,S/2),_.scale(y.zoomX/this.scaleX/b,y.zoomY/this.scaleY/b),this._applyPatternGradientTransform(_,x),_.fillStyle=x.toLive(g),_.fill(),g.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),g.scale(b*this.scaleX/y.zoomX,b*this.scaleY/y.zoomY),g.strokeStyle=_.createPattern(w,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var g=a.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",g.scaleX),this.set("scaleY",g.scaleY),this.angle=g.angle,this.skewX=g.skewX,this.skewY=0}},_removeTransformMatrix:function(g){var x=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),x=a.util.transformPoint(x,this.transformMatrix)),this.transformMatrix=null,g&&(this.scaleX*=g.scaleX,this.scaleY*=g.scaleY,this.cropX=g.cropX,this.cropY=g.cropY,x.x+=g.offsetLeft,x.y+=g.offsetTop,this.width=g.width,this.height=g.height),this.setPositionByOrigin(x,"center","center")},clone:function(g,x){var y=this.toObject(x);this.constructor.fromObject?this.constructor.fromObject(y,g):a.Object._fromObject("Object",y,g)},cloneAsImage:function(g,x){var y=this.toCanvasElement(x);return g&&g(new a.Image(y)),this},toCanvasElement:function(g){g||(g={});var x=a.util,y=x.saveObjectTransform(this),w=this.group,_=this.shadow,b=Math.abs,k=(g.multiplier||1)*(g.enableRetinaScaling?a.devicePixelRatio:1);delete this.group,g.withoutTransform&&x.resetObjectTransform(this),g.withoutShadow&&(this.shadow=null);var S=a.util.createCanvasElement(),E=this.getBoundingRect(!0,!0),F=this.shadow,P,D={x:0,y:0},I,X,z;F&&(I=F.blur,F.nonScaling?P={scaleX:1,scaleY:1}:P=this.getObjectScaling(),D.x=2*Math.round(b(F.offsetX)+I)*b(P.scaleX),D.y=2*Math.round(b(F.offsetY)+I)*b(P.scaleY)),X=E.width+D.x,z=E.height+D.y,S.width=Math.ceil(X),S.height=Math.ceil(z);var G=new a.StaticCanvas(S,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});g.format==="jpeg"&&(G.backgroundColor="#fff"),this.setPositionByOrigin(new a.Point(G.width/2,G.height/2),"center","center");var ae=this.canvas;G.add(this);var le=G.toCanvasElement(k||1,g);return this.shadow=_,this.set("canvas",ae),w&&(this.group=w),this.set(y).setCoords(),G._objects=[],G.dispose(),G=null,le},toDataURL:function(g){return g||(g={}),a.util.toDataURL(this.toCanvasElement(g),g.format||"png",g.quality||1)},isType:function(g){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===g},complexity:function(){return 1},toJSON:function(g){return this.toObject(g)},rotate:function(g){var x=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return x&&this._setOriginToCenter(),this.set("angle",g),x&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(g,x){x=x||this.canvas.getPointer(g);var y=new a.Point(x.x,x.y),w=this._getLeftTopCoords();return this.angle&&(y=a.util.rotatePoint(y,w,u(-this.angle))),{x:y.x-w.x,y:y.y-w.y}},_setupCompositeOperation:function(g){this.globalCompositeOperation&&(g.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){a.runningAnimations&&a.runningAnimations.cancelByTarget(this)}}),a.util.createAccessors&&a.util.createAccessors(a.Object),c(a.Object.prototype,a.Observable),a.Object.NUM_FRACTION_DIGITS=2,a.Object.ENLIVEN_PROPS=["clipPath"],a.Object._fromObject=function(g,x,y,w){var _=a[g];x=d(x,!0),a.util.enlivenPatterns([x.fill,x.stroke],function(b){typeof b[0]<"u"&&(x.fill=b[0]),typeof b[1]<"u"&&(x.stroke=b[1]),a.util.enlivenObjectEnlivables(x,x,function(){var k=w?new _(x[w],x):new _(x);y&&y(k)})})},a.Object.__uid=0)}(e),function(){var o=t.util.degreesToRadians,a={left:-.5,center:0,right:.5},c={top:-.5,center:0,bottom:.5};t.util.object.extend(t.Object.prototype,{translateToGivenOrigin:function(d,h,f,u,p){var m=d.x,g=d.y,x,y,w;return typeof h=="string"?h=a[h]:h-=.5,typeof u=="string"?u=a[u]:u-=.5,x=u-h,typeof f=="string"?f=c[f]:f-=.5,typeof p=="string"?p=c[p]:p-=.5,y=p-f,(x||y)&&(w=this._getTransformedDimensions(),m=d.x+x*w.x,g=d.y+y*w.y),new t.Point(m,g)},translateToCenterPoint:function(d,h,f){var u=this.translateToGivenOrigin(d,h,f,"center","center");return this.angle?t.util.rotatePoint(u,d,o(this.angle)):u},translateToOriginPoint:function(d,h,f){var u=this.translateToGivenOrigin(d,"center","center",h,f);return this.angle?t.util.rotatePoint(u,d,o(this.angle)):u},getCenterPoint:function(){var d=new t.Point(this.left,this.top);return this.translateToCenterPoint(d,this.originX,this.originY)},getPointByOrigin:function(d,h){var f=this.getCenterPoint();return this.translateToOriginPoint(f,d,h)},toLocalPoint:function(d,h,f){var u=this.getCenterPoint(),p,m;return typeof h<"u"&&typeof f<"u"?p=this.translateToGivenOrigin(u,"center","center",h,f):p=new t.Point(this.left,this.top),m=new t.Point(d.x,d.y),this.angle&&(m=t.util.rotatePoint(m,u,-o(this.angle))),m.subtractEquals(p)},setPositionByOrigin:function(d,h,f){var u=this.translateToCenterPoint(d,h,f),p=this.translateToOriginPoint(u,this.originX,this.originY);this.set("left",p.x),this.set("top",p.y)},adjustPosition:function(d){var h=o(this.angle),f=this.getScaledWidth(),u=t.util.cos(h)*f,p=t.util.sin(h)*f,m,g;typeof this.originX=="string"?m=a[this.originX]:m=this.originX-.5,typeof d=="string"?g=a[d]:g=d-.5,this.left+=u*(g-m),this.top+=p*(g-m),this.setCoords(),this.originX=d},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var d=this.getCenterPoint();this.originX="center",this.originY="center",this.left=d.x,this.top=d.y},_resetOrigin:function(){var d=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=d.x,this.top=d.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function o(f){return[new t.Point(f.tl.x,f.tl.y),new t.Point(f.tr.x,f.tr.y),new t.Point(f.br.x,f.br.y),new t.Point(f.bl.x,f.bl.y)]}var a=t.util,c=a.degreesToRadians,d=a.multiplyTransformMatrices,h=a.transformPoint;a.object.extend(t.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(f,u){return u?f?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),f?this.aCoords:this.lineCoords)},getCoords:function(f,u){return o(this._getCoords(f,u))},intersectsWithRect:function(f,u,p,m){var g=this.getCoords(p,m),x=t.Intersection.intersectPolygonRectangle(g,f,u);return x.status==="Intersection"},intersectsWithObject:function(f,u,p){var m=t.Intersection.intersectPolygonPolygon(this.getCoords(u,p),f.getCoords(u,p));return m.status==="Intersection"||f.isContainedWithinObject(this,u,p)||this.isContainedWithinObject(f,u,p)},isContainedWithinObject:function(f,u,p){for(var m=this.getCoords(u,p),g=u?f.aCoords:f.lineCoords,x=0,y=f._getImageLines(g);x<4;x++)if(!f.containsPoint(m[x],y))return!1;return!0},isContainedWithinRect:function(f,u,p,m){var g=this.getBoundingRect(p,m);return g.left>=f.x&&g.left+g.width<=u.x&&g.top>=f.y&&g.top+g.height<=u.y},containsPoint:function(f,x,p,m){var g=this._getCoords(p,m),x=x||this._getImageLines(g),y=this._findCrossPoints(f,x);return y!==0&&y%2===1},isOnScreen:function(f){if(!this.canvas)return!1;var u=this.canvas.vptCoords.tl,p=this.canvas.vptCoords.br,m=this.getCoords(!0,f);return m.some(function(g){return g.x<=p.x&&g.x>=u.x&&g.y<=p.y&&g.y>=u.y})||this.intersectsWithRect(u,p,!0,f)?!0:this._containsCenterOfCanvas(u,p,f)},_containsCenterOfCanvas:function(f,u,p){var m={x:(f.x+u.x)/2,y:(f.y+u.y)/2};return!!this.containsPoint(m,null,!0,p)},isPartiallyOnScreen:function(f){if(!this.canvas)return!1;var u=this.canvas.vptCoords.tl,p=this.canvas.vptCoords.br;if(this.intersectsWithRect(u,p,!0,f))return!0;var m=this.getCoords(!0,f).every(function(g){return(g.x>=p.x||g.x<=u.x)&&(g.y>=p.y||g.y<=u.y)});return m&&this._containsCenterOfCanvas(u,p,f)},_getImageLines:function(f){var u={topline:{o:f.tl,d:f.tr},rightline:{o:f.tr,d:f.br},bottomline:{o:f.br,d:f.bl},leftline:{o:f.bl,d:f.tl}};return u},_findCrossPoints:function(f,u){var p,m,g,x,y,w=0,_;for(var b in u)if(_=u[b],!(_.o.y<f.y&&_.d.y<f.y)&&!(_.o.y>=f.y&&_.d.y>=f.y)&&(_.o.x===_.d.x&&_.o.x>=f.x?y=_.o.x:(p=0,m=(_.d.y-_.o.y)/(_.d.x-_.o.x),g=f.y-p*f.x,x=_.o.y-m*_.o.x,y=-(g-x)/(p-m)),y>=f.x&&(w+=1),w===2))break;return w},getBoundingRect:function(f,u){var p=this.getCoords(f,u);return a.makeBoundingBoxFromPoints(p)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(f){return Math.abs(f)<this.minScaleLimit?f<0?-this.minScaleLimit:this.minScaleLimit:f===0?1e-4:f},scale:function(f){return this._set("scaleX",f),this._set("scaleY",f),this.setCoords()},scaleToWidth:function(f,u){var p=this.getBoundingRect(u).width/this.getScaledWidth();return this.scale(f/this.width/p)},scaleToHeight:function(f,u){var p=this.getBoundingRect(u).height/this.getScaledHeight();return this.scale(f/this.height/p)},calcLineCoords:function(){var f=this.getViewportTransform(),u=this.padding,p=c(this.angle),m=a.cos(p),g=a.sin(p),x=m*u,y=g*u,w=x+y,_=x-y,b=this.calcACoords(),k={tl:h(b.tl,f),tr:h(b.tr,f),bl:h(b.bl,f),br:h(b.br,f)};return u&&(k.tl.x-=_,k.tl.y-=w,k.tr.x+=w,k.tr.y-=_,k.bl.x-=w,k.bl.y+=_,k.br.x+=_,k.br.y+=w),k},calcOCoords:function(){var f=this._calcRotateMatrix(),u=this._calcTranslateMatrix(),p=this.getViewportTransform(),m=d(p,u),g=d(m,f),g=d(g,[1/p[0],0,0,1/p[3],0,0]),x=this._calculateCurrentDimensions(),y={};return this.forEachControl(function(w,_,b){y[_]=w.positionHandler(x,g,b)}),y},calcACoords:function(){var f=this._calcRotateMatrix(),u=this._calcTranslateMatrix(),p=d(u,f),m=this._getTransformedDimensions(),g=m.x/2,x=m.y/2;return{tl:h({x:-g,y:-x},p),tr:h({x:g,y:-x},p),bl:h({x:-g,y:x},p),br:h({x:g,y:x},p)}},setCoords:function(f){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),f?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return a.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var f=this.getCenterPoint();return[1,0,0,1,f.x,f.y]},transformMatrixKey:function(f){var u="_",p="";return!f&&this.group&&(p=this.group.transformMatrixKey(f)+u),p+this.top+u+this.left+u+this.scaleX+u+this.scaleY+u+this.skewX+u+this.skewY+u+this.angle+u+this.originX+u+this.originY+u+this.width+u+this.height+u+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(f){var u=this.calcOwnMatrix();if(f||!this.group)return u;var p=this.transformMatrixKey(f),m=this.matrixCache||(this.matrixCache={});return m.key===p?m.value:(this.group&&(u=d(this.group.calcTransformMatrix(!1),u)),m.key=p,m.value=u,u)},calcOwnMatrix:function(){var f=this.transformMatrixKey(!0),u=this.ownMatrixCache||(this.ownMatrixCache={});if(u.key===f)return u.value;var p=this._calcTranslateMatrix(),m={angle:this.angle,translateX:p[4],translateY:p[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return u.key=f,u.value=a.composeMatrix(m),u.value},_getNonTransformedDimensions:function(){var f=this.strokeWidth,u=this.width+f,p=this.height+f;return{x:u,y:p}},_getTransformedDimensions:function(f,u){typeof f>"u"&&(f=this.skewX),typeof u>"u"&&(u=this.skewY);var p,m,g,x=f===0&&u===0;if(this.strokeUniform?(m=this.width,g=this.height):(p=this._getNonTransformedDimensions(),m=p.x,g=p.y),x)return this._finalizeDimensions(m*this.scaleX,g*this.scaleY);var y=a.sizeAfterTransform(m,g,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:f,skewY:u});return this._finalizeDimensions(y.x,y.y)},_finalizeDimensions:function(f,u){return this.strokeUniform?{x:f+this.strokeWidth,y:u+this.strokeWidth}:{x:f,y:u}},_calculateCurrentDimensions:function(){var f=this.getViewportTransform(),u=this._getTransformedDimensions(),p=h(u,f,!0);return p.scalarAdd(2*this.padding)}})}(),t.util.object.extend(t.Object.prototype,{sendToBack:function(){return this.group?t.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?t.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(o){return this.group?t.StaticCanvas.prototype.sendBackwards.call(this.group,this,o):this.canvas&&this.canvas.sendBackwards(this,o),this},bringForward:function(o){return this.group?t.StaticCanvas.prototype.bringForward.call(this.group,this,o):this.canvas&&this.canvas.bringForward(this,o),this},moveTo:function(o){return this.group&&this.group.type!=="activeSelection"?t.StaticCanvas.prototype.moveTo.call(this.group,this,o):this.canvas&&this.canvas.moveTo(this,o),this}}),function(){function o(c,d){if(d){if(d.toLive)return c+": url(#SVGID_"+d.id+"); ";var h=new t.Color(d),f=c+": "+h.toRgb()+"; ",u=h.getAlpha();return u!==1&&(f+=c+"-opacity: "+u.toString()+"; "),f}else return c+": none; "}var a=t.util.toFixed;t.util.object.extend(t.Object.prototype,{getSvgStyles:function(c){var d=this.fillRule?this.fillRule:"nonzero",h=this.strokeWidth?this.strokeWidth:"0",f=this.strokeDashArray?this.strokeDashArray.join(" "):"none",u=this.strokeDashOffset?this.strokeDashOffset:"0",p=this.strokeLineCap?this.strokeLineCap:"butt",m=this.strokeLineJoin?this.strokeLineJoin:"miter",g=this.strokeMiterLimit?this.strokeMiterLimit:"4",x=typeof this.opacity<"u"?this.opacity:"1",y=this.visible?"":" visibility: hidden;",w=c?"":this.getSvgFilter(),_=o("fill",this.fill),b=o("stroke",this.stroke);return[b,"stroke-width: ",h,"; ","stroke-dasharray: ",f,"; ","stroke-linecap: ",p,"; ","stroke-dashoffset: ",u,"; ","stroke-linejoin: ",m,"; ","stroke-miterlimit: ",g,"; ",_,"fill-rule: ",d,"; ","opacity: ",x,";",w,y].join("")},getSvgSpanStyles:function(c,d){var h="; ",u=c.fontFamily?"font-family: "+(c.fontFamily.indexOf("'")===-1&&c.fontFamily.indexOf('"')===-1?"'"+c.fontFamily+"'":c.fontFamily)+h:"",f=c.strokeWidth?"stroke-width: "+c.strokeWidth+h:"",u=u,p=c.fontSize?"font-size: "+c.fontSize+"px"+h:"",m=c.fontStyle?"font-style: "+c.fontStyle+h:"",g=c.fontWeight?"font-weight: "+c.fontWeight+h:"",x=c.fill?o("fill",c.fill):"",y=c.stroke?o("stroke",c.stroke):"",w=this.getSvgTextDecoration(c),_=c.deltaY?"baseline-shift: "+-c.deltaY+"; ":"";return w&&(w="text-decoration: "+w+h),[y,f,u,p,m,g,w,x,_,d?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(c){return["overline","underline","line-through"].filter(function(d){return c[d.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(c,d){var h=c?this.calcTransformMatrix():this.calcOwnMatrix(),f='transform="'+t.util.matrixToSVG(h);return f+(d||"")+'" '},_setSVGBg:function(c){if(this.backgroundColor){var d=t.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',a(-this.width/2,d),'" y="',a(-this.height/2,d),'" width="',a(this.width,d),'" height="',a(this.height,d),`"></rect>
`)}},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(c),{reviver:c})},toClipPathSVG:function(c){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(c),{reviver:c})},_createBaseClipPathSVGMarkup:function(c,d){d=d||{};var h=d.reviver,f=d.additionalTransform||"",u=[this.getSvgTransform(!0,f),this.getSvgCommons()].join(""),p=c.indexOf("COMMON_PARTS");return c[p]=u,h?h(c.join("")):c.join("")},_createBaseSVGMarkup:function(c,d){d=d||{};var h=d.noStyle,f=d.reviver,u=h?"":'style="'+this.getSvgStyles()+'" ',p=d.withShadow?'style="'+this.getSvgFilter()+'" ':"",m=this.clipPath,g=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",x=m&&m.absolutePositioned,y=this.stroke,w=this.fill,_=this.shadow,b,k=[],S,E=c.indexOf("COMMON_PARTS"),F=d.additionalTransform;return m&&(m.clipPathId="CLIPPATH_"+t.Object.__uid++,S='<clipPath id="'+m.clipPathId+`" >
`+m.toClipPathSVG(f)+`</clipPath>
`),x&&k.push("<g ",p,this.getSvgCommons(),` >
`),k.push("<g ",this.getSvgTransform(!1),x?"":p+this.getSvgCommons(),` >
`),b=[u,g,h?"":this.addPaintOrder()," ",F?'transform="'+F+'" ':""].join(""),c[E]=b,w&&w.toLive&&k.push(w.toSVG(this)),y&&y.toLive&&k.push(y.toSVG(this)),_&&k.push(_.toSVG(this)),m&&k.push(S),k.push(c.join("")),k.push(`</g>
`),x&&k.push(`</g>
`),f?f(k.join("")):k.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var o=t.util.object.extend,a="stateProperties";function c(h,f,u){var p={},m=!0;u.forEach(function(g){p[g]=h[g]}),o(h[f],p,m)}function d(h,f,u){if(h===f)return!0;if(Array.isArray(h)){if(!Array.isArray(f)||h.length!==f.length)return!1;for(var p=0,m=h.length;p<m;p++)if(!d(h[p],f[p]))return!1;return!0}else if(h&&typeof h=="object"){var g=Object.keys(h),x;if(!f||typeof f!="object"||!u&&g.length!==Object.keys(f).length)return!1;for(var p=0,m=g.length;p<m;p++)if(x=g[p],!(x==="canvas"||x==="group")&&!d(h[x],f[x]))return!1;return!0}}t.util.object.extend(t.Object.prototype,{hasStateChanged:function(h){h=h||a;var f="_"+h;return Object.keys(this[f]).length<this[h].length?!0:!d(this[f],this,!0)},saveState:function(h){var f=h&&h.propertySet||a,u="_"+f;return this[u]?(c(this,u,this[f]),h&&h.stateProperties&&c(this,u,h.stateProperties),this):this.setupState(h)},setupState:function(h){h=h||{};var f=h.propertySet||a;return h.propertySet=f,this["_"+f]={},this.saveState(h),this}})}(),function(){var o=t.util.degreesToRadians;t.util.object.extend(t.Object.prototype,{_findTargetCorner:function(a,c){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var d=a.x,h=a.y,f,u,p=Object.keys(this.oCoords),m=p.length-1,g;for(this.__corner=0;m>=0;m--)if(g=p[m],!!this.isControlVisible(g)&&(u=this._getImageLines(c?this.oCoords[g].touchCorner:this.oCoords[g].corner),f=this._findCrossPoints({x:d,y:h},u),f!==0&&f%2===1))return this.__corner=g,g;return!1},forEachControl:function(a){for(var c in this.controls)a(this.controls[c],c,this)},_setCornerCoords:function(){var a=this.oCoords;for(var c in a){var d=this.controls[c];a[c].corner=d.calcCornerCoords(this.angle,this.cornerSize,a[c].x,a[c].y,!1),a[c].touchCorner=d.calcCornerCoords(this.angle,this.touchCornerSize,a[c].x,a[c].y,!0)}},drawSelectionBackground:function(a){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;a.save();var c=this.getCenterPoint(),d=this._calculateCurrentDimensions(),h=this.canvas.viewportTransform;return a.translate(c.x,c.y),a.scale(1/h[0],1/h[3]),a.rotate(o(this.angle)),a.fillStyle=this.selectionBackgroundColor,a.fillRect(-d.x/2,-d.y/2,d.x,d.y),a.restore(),this},drawBorders:function(a,c){c=c||{};var d=this._calculateCurrentDimensions(),h=this.borderScaleFactor,f=d.x+h,u=d.y+h,p=typeof c.hasControls<"u"?c.hasControls:this.hasControls,m=!1;return a.save(),a.strokeStyle=c.borderColor||this.borderColor,this._setLineDash(a,c.borderDashArray||this.borderDashArray),a.strokeRect(-f/2,-u/2,f,u),p&&(a.beginPath(),this.forEachControl(function(g,x,y){g.withConnection&&g.getVisibility(y,x)&&(m=!0,a.moveTo(g.x*f,g.y*u),a.lineTo(g.x*f+g.offsetX,g.y*u+g.offsetY))}),m&&a.stroke()),a.restore(),this},drawBordersInGroup:function(a,c,d){d=d||{};var h=t.util.sizeAfterTransform(this.width,this.height,c),f=this.strokeWidth,u=this.strokeUniform,p=this.borderScaleFactor,m=h.x+f*(u?this.canvas.getZoom():c.scaleX)+p,g=h.y+f*(u?this.canvas.getZoom():c.scaleY)+p;return a.save(),this._setLineDash(a,d.borderDashArray||this.borderDashArray),a.strokeStyle=d.borderColor||this.borderColor,a.strokeRect(-m/2,-g/2,m,g),a.restore(),this},drawControls:function(a,c){c=c||{},a.save();var d=1,h,f;return this.canvas&&(d=this.canvas.getRetinaScaling()),a.setTransform(d,0,0,d,0,0),a.strokeStyle=a.fillStyle=c.cornerColor||this.cornerColor,this.transparentCorners||(a.strokeStyle=c.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(a,c.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(h=this.group.calcTransformMatrix()),this.forEachControl(function(u,p,m){f=m.oCoords[p],u.getVisibility(m,p)&&(h&&(f=t.util.transformPoint(f,h)),u.render(a,f.x,f.y,c,m))}),a.restore(),this},isControlVisible:function(a){return this.controls[a]&&this.controls[a].getVisibility(this,a)},setControlVisible:function(a,c){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[a]=c,this},setControlsVisibility:function(a){a||(a={});for(var c in a)this.setControlVisible(c,a[c]);return this},onDeselect:function(){},onSelect:function(){}})}(),t.util.object.extend(t.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(o,a){a=a||{};var c=function(){},d=a.onComplete||c,h=a.onChange||c,f=this;return t.util.animate({target:this,startValue:o.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(u){o.set("left",u),f.requestRenderAll(),h()},onComplete:function(){o.setCoords(),d()}})},fxCenterObjectV:function(o,a){a=a||{};var c=function(){},d=a.onComplete||c,h=a.onChange||c,f=this;return t.util.animate({target:this,startValue:o.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(u){o.set("top",u),f.requestRenderAll(),h()},onComplete:function(){o.setCoords(),d()}})},fxRemove:function(o,a){a=a||{};var c=function(){},d=a.onComplete||c,h=a.onChange||c,f=this;return t.util.animate({target:this,startValue:o.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(u){o.set("opacity",u),f.requestRenderAll(),h()},onComplete:function(){f.remove(o),d()}})}}),t.util.object.extend(t.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var o=[],a,c,d=[];for(a in arguments[0])o.push(a);for(var h=0,f=o.length;h<f;h++)a=o[h],c=h!==f-1,d.push(this._animate(a,arguments[0][a],arguments[1],c));return d}else return this._animate.apply(this,arguments)},_animate:function(o,a,c,d){var h=this,f;a=a.toString(),c?c=t.util.object.clone(c):c={},~o.indexOf(".")&&(f=o.split("."));var u=h.colorProperties.indexOf(o)>-1||f&&h.colorProperties.indexOf(f[1])>-1,p=f?this.get(f[0])[f[1]]:this.get(o);"from"in c||(c.from=p),u||(~a.indexOf("=")?a=p+parseFloat(a.replace("=","")):a=parseFloat(a));var m={target:this,startValue:c.from,endValue:a,byValue:c.by,easing:c.easing,duration:c.duration,abort:c.abort&&function(g,x,y){return c.abort.call(h,g,x,y)},onChange:function(g,x,y){f?h[f[0]][f[1]]=g:h.set(o,g),!d&&c.onChange&&c.onChange(g,x,y)},onComplete:function(g,x,y){d||(h.setCoords(),c.onComplete&&c.onComplete(g,x,y))}};return u?t.util.animateColor(m.startValue,m.endValue,m.duration,m):t.util.animate(m)}}),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.util.object.clone,h={x1:1,x2:1,y1:1,y2:1};if(a.Line){a.warn("fabric.Line is already defined");return}a.Line=a.util.createClass(a.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:a.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(u,p){u||(u=[0,0,0,0]),this.callSuper("initialize",p),this.set("x1",u[0]),this.set("y1",u[1]),this.set("x2",u[2]),this.set("y2",u[3]),this._setWidthHeight(p)},_setWidthHeight:function(u){u||(u={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in u?u.left:this._getLeftToOriginX(),this.top="top"in u?u.top:this._getTopToOriginY()},_set:function(u,p){return this.callSuper("_set",u,p),typeof h[u]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:f({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:f({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(u){u.beginPath();var p=this.calcLinePoints();u.moveTo(p.x1,p.y1),u.lineTo(p.x2,p.y2),u.lineWidth=this.strokeWidth;var m=u.strokeStyle;u.strokeStyle=this.stroke||u.fillStyle,this.stroke&&this._renderStroke(u),u.strokeStyle=m},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(u){return c(this.callSuper("toObject",u),this.calcLinePoints())},_getNonTransformedDimensions:function(){var u=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(u.y-=this.strokeWidth),this.height===0&&(u.x-=this.strokeWidth)),u},calcLinePoints:function(){var u=this.x1<=this.x2?-1:1,p=this.y1<=this.y2?-1:1,m=u*this.width*.5,g=p*this.height*.5,x=u*this.width*-.5,y=p*this.height*-.5;return{x1:m,x2:x,y1:g,y2:y}},_toSVG:function(){var u=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',u.x1,'" y1="',u.y1,'" x2="',u.x2,'" y2="',u.y2,`" />
`]}}),a.Line.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),a.Line.fromElement=function(u,p,m){m=m||{};var g=a.parseAttributes(u,a.Line.ATTRIBUTE_NAMES),x=[g.x1||0,g.y1||0,g.x2||0,g.y2||0];p(new a.Line(x,c(g,m)))},a.Line.fromObject=function(u,p){function m(x){delete x.points,p&&p(x)}var g=d(u,!0);g.points=[u.x1,u.y1,u.x2,u.y2],a.Object._fromObject("Line",g,m,"points")};function f(u,p){var m=u.origin,g=u.axis1,x=u.axis2,y=u.dimension,w=p.nearest,_=p.center,b=p.farthest;return function(){switch(this.get(m)){case w:return Math.min(this.get(g),this.get(x));case _:return Math.min(this.get(g),this.get(x))+.5*this.get(y);case b:return Math.max(this.get(g),this.get(x))}}}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.degreesToRadians;if(a.Circle){a.warn("fabric.Circle is already defined.");return}a.Circle=a.util.createClass(a.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:a.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(h,f){return this.callSuper("_set",h,f),h==="radius"&&this.setRadius(f),this},toObject:function(h){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(h))},_toSVG:function(){var h,f=0,u=0,p=(this.endAngle-this.startAngle)%360;if(p===0)h=["<circle ","COMMON_PARTS",'cx="'+f+'" cy="'+u+'" ','r="',this.radius,`" />
`];else{var m=c(this.startAngle),g=c(this.endAngle),x=this.radius,y=a.util.cos(m)*x,w=a.util.sin(m)*x,_=a.util.cos(g)*x,b=a.util.sin(g)*x,k=p>180?"1":"0";h=['<path d="M '+y+" "+w," A "+x+" "+x," 0 ",+k+" 1"," "+_+" "+b,'" ',"COMMON_PARTS",` />
`]}return h},_render:function(h){h.beginPath(),h.arc(0,0,this.radius,c(this.startAngle),c(this.endAngle),!1),this._renderPaintInOrder(h)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(h){return this.radius=h,this.set("width",h*2).set("height",h*2)}}),a.Circle.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),a.Circle.fromElement=function(h,f){var u=a.parseAttributes(h,a.Circle.ATTRIBUTE_NAMES);if(!d(u))throw new Error("value of `r` attribute is required and can not be negative");u.left=(u.left||0)-u.radius,u.top=(u.top||0)-u.radius,f(new a.Circle(u))};function d(h){return"radius"in h&&h.radius>=0}a.Circle.fromObject=function(h,f){a.Object._fromObject("Circle",h,f)}}(e),function(o){var a=o.fabric||(o.fabric={});if(a.Triangle){a.warn("fabric.Triangle is already defined");return}a.Triangle=a.util.createClass(a.Object,{type:"triangle",width:100,height:100,_render:function(c){var d=this.width/2,h=this.height/2;c.beginPath(),c.moveTo(-d,h),c.lineTo(0,-h),c.lineTo(d,h),c.closePath(),this._renderPaintInOrder(c)},_toSVG:function(){var c=this.width/2,d=this.height/2,h=[-c+" "+d,"0 "+-d,c+" "+d].join(",");return["<polygon ","COMMON_PARTS",'points="',h,'" />']}}),a.Triangle.fromObject=function(c,d){return a.Object._fromObject("Triangle",c,d)}}(e),function(o){var a=o.fabric||(o.fabric={}),c=Math.PI*2;if(a.Ellipse){a.warn("fabric.Ellipse is already defined.");return}a.Ellipse=a.util.createClass(a.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:a.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(d){this.callSuper("initialize",d),this.set("rx",d&&d.rx||0),this.set("ry",d&&d.ry||0)},_set:function(d,h){switch(this.callSuper("_set",d,h),d){case"rx":this.rx=h,this.set("width",h*2);break;case"ry":this.ry=h,this.set("height",h*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(d){return this.callSuper("toObject",["rx","ry"].concat(d))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(d){d.beginPath(),d.save(),d.transform(1,0,0,this.ry/this.rx,0,0),d.arc(0,0,this.rx,0,c,!1),d.restore(),this._renderPaintInOrder(d)}}),a.Ellipse.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),a.Ellipse.fromElement=function(d,h){var f=a.parseAttributes(d,a.Ellipse.ATTRIBUTE_NAMES);f.left=(f.left||0)-f.rx,f.top=(f.top||0)-f.ry,h(new a.Ellipse(f))},a.Ellipse.fromObject=function(d,h){a.Object._fromObject("Ellipse",d,h)}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend;if(a.Rect){a.warn("fabric.Rect is already defined");return}a.Rect=a.util.createClass(a.Object,{stateProperties:a.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:a.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(d){this.callSuper("initialize",d),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(d){var h=this.rx?Math.min(this.rx,this.width/2):0,f=this.ry?Math.min(this.ry,this.height/2):0,u=this.width,p=this.height,m=-this.width/2,g=-this.height/2,x=h!==0||f!==0,y=1-.5522847498;d.beginPath(),d.moveTo(m+h,g),d.lineTo(m+u-h,g),x&&d.bezierCurveTo(m+u-y*h,g,m+u,g+y*f,m+u,g+f),d.lineTo(m+u,g+p-f),x&&d.bezierCurveTo(m+u,g+p-y*f,m+u-y*h,g+p,m+u-h,g+p),d.lineTo(m+h,g+p),x&&d.bezierCurveTo(m+y*h,g+p,m,g+p-y*f,m,g+p-f),d.lineTo(m,g+f),x&&d.bezierCurveTo(m,g+y*f,m+y*h,g,m+h,g),d.closePath(),this._renderPaintInOrder(d)},toObject:function(d){return this.callSuper("toObject",["rx","ry"].concat(d))},_toSVG:function(){var d=-this.width/2,h=-this.height/2;return["<rect ","COMMON_PARTS",'x="',d,'" y="',h,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),a.Rect.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),a.Rect.fromElement=function(d,h,f){if(!d)return h(null);f=f||{};var u=a.parseAttributes(d,a.Rect.ATTRIBUTE_NAMES);u.left=u.left||0,u.top=u.top||0,u.height=u.height||0,u.width=u.width||0;var p=new a.Rect(c(f?a.util.object.clone(f):{},u));p.visible=p.visible&&p.width>0&&p.height>0,h(p)},a.Rect.fromObject=function(d,h){return a.Object._fromObject("Rect",d,h)}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.util.array.min,h=a.util.array.max,f=a.util.toFixed,u=a.util.projectStrokeOnPoints;if(a.Polyline){a.warn("fabric.Polyline is already defined");return}a.Polyline=a.util.createClass(a.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:a.Object.prototype.cacheProperties.concat("points"),initialize:function(p,m){m=m||{},this.points=p||[],this.callSuper("initialize",m),this._setPositionDimensions(m)},_projectStrokeOnPoints:function(){return u(this.points,this,!0)},_setPositionDimensions:function(p){var m=this._calcDimensions(p),g,x=this.exactBoundingBox?this.strokeWidth:0;this.width=m.width-x,this.height=m.height-x,p.fromSVG||(g=this.translateToGivenOrigin({x:m.left-this.strokeWidth/2+x/2,y:m.top-this.strokeWidth/2+x/2},"left","top",this.originX,this.originY)),typeof p.left>"u"&&(this.left=p.fromSVG?m.left:g.x),typeof p.top>"u"&&(this.top=p.fromSVG?m.top:g.y),this.pathOffset={x:m.left+this.width/2+x/2,y:m.top+this.height/2+x/2}},_calcDimensions:function(){var p=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,m=d(p,"x")||0,g=d(p,"y")||0,x=h(p,"x")||0,y=h(p,"y")||0,w=x-m,_=y-g;return{left:m,top:g,width:w,height:_}},toObject:function(p){return c(this.callSuper("toObject",p),{points:this.points.concat()})},_toSVG:function(){for(var p=[],m=this.pathOffset.x,g=this.pathOffset.y,x=a.Object.NUM_FRACTION_DIGITS,y=0,w=this.points.length;y<w;y++)p.push(f(this.points[y].x-m,x),",",f(this.points[y].y-g,x)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',p.join(""),`" />
`]},commonRender:function(p){var m,g=this.points.length,x=this.pathOffset.x,y=this.pathOffset.y;if(!g||isNaN(this.points[g-1].y))return!1;p.beginPath(),p.moveTo(this.points[0].x-x,this.points[0].y-y);for(var w=0;w<g;w++)m=this.points[w],p.lineTo(m.x-x,m.y-y);return!0},_render:function(p){this.commonRender(p)&&this._renderPaintInOrder(p)},complexity:function(){return this.get("points").length}}),a.Polyline.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat(),a.Polyline.fromElementGenerator=function(p){return function(m,g,x){if(!m)return g(null);x||(x={});var y=a.parsePointsAttribute(m.getAttribute("points")),w=a.parseAttributes(m,a[p].ATTRIBUTE_NAMES);w.fromSVG=!0,g(new a[p](y,c(w,x)))}},a.Polyline.fromElement=a.Polyline.fromElementGenerator("Polyline"),a.Polyline.fromObject=function(p,m){return a.Object._fromObject("Polyline",p,m,"points")}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.projectStrokeOnPoints;if(a.Polygon){a.warn("fabric.Polygon is already defined");return}a.Polygon=a.util.createClass(a.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return c(this.points,this)},_render:function(d){this.commonRender(d)&&(d.closePath(),this._renderPaintInOrder(d))}}),a.Polygon.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat(),a.Polygon.fromElement=a.Polyline.fromElementGenerator("Polygon"),a.Polygon.fromObject=function(d,h){a.Object._fromObject("Polygon",d,h,"points")}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.array.min,d=a.util.array.max,h=a.util.object.extend,f=a.util.object.clone,u=a.util.toFixed;if(a.Path){a.warn("fabric.Path is already defined");return}a.Path=a.util.createClass(a.Object,{type:"path",path:null,cacheProperties:a.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:a.Object.prototype.stateProperties.concat("path"),initialize:function(p,m){m=f(m||{}),delete m.path,this.callSuper("initialize",m),this._setPath(p||[],m)},_setPath:function(p,m){this.path=a.util.makePathSimpler(Array.isArray(p)?p:a.util.parsePath(p)),a.Polyline.prototype._setPositionDimensions.call(this,m||{})},_renderPathCommands:function(p){var m,g=0,x=0,y=0,w=0,_=0,b=0,k=-this.pathOffset.x,S=-this.pathOffset.y;p.beginPath();for(var E=0,F=this.path.length;E<F;++E)switch(m=this.path[E],m[0]){case"L":y=m[1],w=m[2],p.lineTo(y+k,w+S);break;case"M":y=m[1],w=m[2],g=y,x=w,p.moveTo(y+k,w+S);break;case"C":y=m[5],w=m[6],_=m[3],b=m[4],p.bezierCurveTo(m[1]+k,m[2]+S,_+k,b+S,y+k,w+S);break;case"Q":p.quadraticCurveTo(m[1]+k,m[2]+S,m[3]+k,m[4]+S),y=m[3],w=m[4],_=m[1],b=m[2];break;case"z":case"Z":y=g,w=x,p.closePath();break}},_render:function(p){this._renderPathCommands(p),this._renderPaintInOrder(p)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(p){return h(this.callSuper("toObject",p),{path:this.path.map(function(m){return m.slice()})})},toDatalessObject:function(p){var m=this.toObject(["sourcePath"].concat(p));return m.sourcePath&&delete m.path,m},_toSVG:function(){var p=a.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',p,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var p=a.Object.NUM_FRACTION_DIGITS;return" translate("+u(-this.pathOffset.x,p)+", "+u(-this.pathOffset.y,p)+")"},toClipPathSVG:function(p){var m=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:p,additionalTransform:m})},toSVG:function(p){var m=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:p,additionalTransform:m})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var p=[],m=[],g,x=0,y=0,w=0,_=0,b,k=0,S=this.path.length;k<S;++k){switch(g=this.path[k],g[0]){case"L":w=g[1],_=g[2],b=[];break;case"M":w=g[1],_=g[2],x=w,y=_,b=[];break;case"C":b=a.util.getBoundsOfCurve(w,_,g[1],g[2],g[3],g[4],g[5],g[6]),w=g[5],_=g[6];break;case"Q":b=a.util.getBoundsOfCurve(w,_,g[1],g[2],g[1],g[2],g[3],g[4]),w=g[3],_=g[4];break;case"z":case"Z":w=x,_=y;break}b.forEach(function(z){p.push(z.x),m.push(z.y)}),p.push(w),m.push(_)}var E=c(p)||0,F=c(m)||0,P=d(p)||0,D=d(m)||0,I=P-E,X=D-F;return{left:E,top:F,width:I,height:X}}}),a.Path.fromObject=function(p,m){if(typeof p.sourcePath=="string"){var g=p.sourcePath;a.loadSVGFromURL(g,function(x){var y=x[0];y.setOptions(p),p.clipPath?a.util.enlivenObjects([p.clipPath],function(w){y.clipPath=w[0],m&&m(y)}):m&&m(y)})}else a.Object._fromObject("Path",p,m,"path")},a.Path.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat(["d"]),a.Path.fromElement=function(p,m,g){var x=a.parseAttributes(p,a.Path.ATTRIBUTE_NAMES);x.fromSVG=!0,m(new a.Path(x.d,h(x,g)))}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.array.min,d=a.util.array.max;a.Group||(a.Group=a.util.createClass(a.Object,a.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(h,f,u){f=f||{},this._objects=[],u&&this.callSuper("initialize",f),this._objects=h||[];for(var p=this._objects.length;p--;)this._objects[p].group=this;if(u)this._updateObjectsACoords();else{var m=f&&f.centerPoint;f.originX!==void 0&&(this.originX=f.originX),f.originY!==void 0&&(this.originY=f.originY),m||this._calcBounds(),this._updateObjectsCoords(m),delete f.centerPoint,this.callSuper("initialize",f)}this.setCoords()},_updateObjectsACoords:function(){for(var h=!0,f=this._objects.length;f--;)this._objects[f].setCoords(h)},_updateObjectsCoords:function(f){for(var f=f||this.getCenterPoint(),u=this._objects.length;u--;)this._updateObjectCoords(this._objects[u],f)},_updateObjectCoords:function(h,f){var u=h.left,p=h.top,m=!0;h.set({left:u-f.x,top:p-f.y}),h.group=this,h.setCoords(m)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(h){var f=!!this.group;return this._restoreObjectsState(),a.util.resetObjectTransform(this),h&&(f&&a.util.removeTransformFromObject(h,this.group.calcTransformMatrix()),this._objects.push(h),h.group=this,h._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,f?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(h){return this._restoreObjectsState(),a.util.resetObjectTransform(this),this.remove(h),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(h){this.dirty=!0,h.group=this,h._set("canvas",this.canvas)},_onObjectRemoved:function(h){this.dirty=!0,delete h.group},_set:function(h,f){var u=this._objects.length;if(this.useSetOnGroup)for(;u--;)this._objects[u].setOnGroup(h,f);if(h==="canvas")for(;u--;)this._objects[u]._set(h,f);a.Object.prototype._set.call(this,h,f)},toObject:function(h){var f=this.includeDefaultValues,u=this._objects.filter(function(m){return!m.excludeFromExport}).map(function(m){var g=m.includeDefaultValues;m.includeDefaultValues=f;var x=m.toObject(h);return m.includeDefaultValues=g,x}),p=a.Object.prototype.toObject.call(this,h);return p.objects=u,p},toDatalessObject:function(h){var f,u=this.sourcePath;if(u)f=u;else{var p=this.includeDefaultValues;f=this._objects.map(function(g){var x=g.includeDefaultValues;g.includeDefaultValues=p;var y=g.toDatalessObject(h);return g.includeDefaultValues=x,y})}var m=a.Object.prototype.toDatalessObject.call(this,h);return m.objects=f,m},render:function(h){this._transformDone=!0,this.callSuper("render",h),this._transformDone=!1},shouldCache:function(){var h=a.Object.prototype.shouldCache.call(this);if(h){for(var f=0,u=this._objects.length;f<u;f++)if(this._objects[f].willDrawShadow())return this.ownCaching=!1,!1}return h},willDrawShadow:function(){if(a.Object.prototype.willDrawShadow.call(this))return!0;for(var h=0,f=this._objects.length;h<f;h++)if(this._objects[h].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(h){for(var f=0,u=this._objects.length;f<u;f++)this._objects[f].render(h);this._drawClipPath(h,this.clipPath)},isCacheDirty:function(h){if(this.callSuper("isCacheDirty",h))return!0;if(!this.statefullCache)return!1;for(var f=0,u=this._objects.length;f<u;f++)if(this._objects[f].isCacheDirty(!0)){if(this._cacheCanvas){var p=this.cacheWidth/this.zoomX,m=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-p/2,-m/2,p,m)}return!0}return!1},_restoreObjectsState:function(){var h=this.calcOwnMatrix();return this._objects.forEach(function(f){a.util.addTransformToObject(f,h),delete f.group,f.setCoords()}),this},destroy:function(){return this._objects.forEach(function(h){h.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(h){h.dispose&&h.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var h=this._objects,f=this.canvas;this._objects=[];var u=this.toObject();delete u.objects;var p=new a.ActiveSelection([]);return p.set(u),p.type="activeSelection",f.remove(this),h.forEach(function(m){m.group=p,m.dirty=!0,f.add(m)}),p.canvas=f,p._objects=h,f._activeObject=p,p.setCoords(),p}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var h=!0;return this.forEachObject(function(f){f.setCoords(h)}),this},_calcBounds:function(h){for(var f=[],u=[],p,m,g,x=["tr","br","bl","tl"],y=0,w=this._objects.length,_,b=x.length;y<w;++y){for(p=this._objects[y],g=p.calcACoords(),_=0;_<b;_++)m=x[_],f.push(g[m].x),u.push(g[m].y);p.aCoords=g}this._getBounds(f,u,h)},_getBounds:function(h,f,u){var p=new a.Point(c(h),c(f)),m=new a.Point(d(h),d(f)),g=p.y||0,x=p.x||0,y=m.x-p.x||0,w=m.y-p.y||0;this.width=y,this.height=w,u||this.setPositionByOrigin({x,y:g},"left","top")},_toSVG:function(h){for(var f=["<g ","COMMON_PARTS",` >
`],u=0,p=this._objects.length;u<p;u++)f.push("		",this._objects[u].toSVG(h));return f.push(`</g>
`),f},getSvgStyles:function(){var h=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",f=this.visible?"":" visibility: hidden;";return[h,this.getSvgFilter(),f].join("")},toClipPathSVG:function(h){for(var f=[],u=0,p=this._objects.length;u<p;u++)f.push("	",this._objects[u].toClipPathSVG(h));return this._createBaseClipPathSVGMarkup(f,{reviver:h})}}),a.Group.fromObject=function(h,f){var u=h.objects,p=a.util.object.clone(h,!0);if(delete p.objects,typeof u=="string"){a.loadSVGFromURL(u,function(m){var g=a.util.groupSVGElements(m,h,u),x=p.clipPath;delete p.clipPath,g.set(p),x?a.util.enlivenObjects([x],function(y){g.clipPath=y[0],f&&f(g)}):f&&f(g)});return}a.util.enlivenObjects(u,function(m){a.util.enlivenObjectEnlivables(h,p,function(){f&&f(new a.Group(m,p,!0))})})})}(e),function(o){var a=o.fabric||(o.fabric={});a.ActiveSelection||(a.ActiveSelection=a.util.createClass(a.Group,{type:"activeSelection",initialize:function(c,d){d=d||{},this._objects=c||[];for(var h=this._objects.length;h--;)this._objects[h].group=this;d.originX&&(this.originX=d.originX),d.originY&&(this.originY=d.originY),this._calcBounds(),this._updateObjectsCoords(),a.Object.prototype.initialize.call(this,d),this.setCoords()},toGroup:function(){var c=this._objects.concat();this._objects=[];var d=a.Object.prototype.toObject.call(this),h=new a.Group([]);if(delete d.type,h.set(d),c.forEach(function(u){u.canvas.remove(u),u.group=h}),h._objects=c,!this.canvas)return h;var f=this.canvas;return f.add(h),f._activeObject=h,h.setCoords(),h},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(c,d,h){c.save(),c.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,h=h||{},typeof h.hasControls>"u"&&(h.hasControls=!1),h.forActiveSelection=!0;for(var f=0,u=this._objects.length;f<u;f++)this._objects[f]._renderControls(c,h);this.callSuper("_renderControls",c,d),c.restore()}}),a.ActiveSelection.fromObject=function(c,d){a.util.enlivenObjects(c.objects,function(h){delete c.objects,d&&d(new a.ActiveSelection(h,c,!0))})})}(e),function(o){var a=t.util.object.extend;if(o.fabric||(o.fabric={}),o.fabric.Image){t.warn("fabric.Image is already defined.");return}t.Image=t.util.createClass(t.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:t.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:t.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(c,d){d||(d={}),this.filters=[],this.cacheKey="texture"+t.Object.__uid++,this.callSuper("initialize",d),this._initElement(c,d)},getElement:function(){return this._element||{}},setElement:function(c,d){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=c,this._originalElement=c,this._initConfig(d),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(c){var d=t.filterBackend;d&&d.evictCachesForKey&&d.evictCachesForKey(c)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((function(c){t.util.cleanUpJsdomNode(this[c]),this[c]=void 0}).bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var c=this.getElement();return{width:c.naturalWidth||c.width,height:c.naturalHeight||c.height}},_stroke:function(c){if(!(!this.stroke||this.strokeWidth===0)){var d=this.width/2,h=this.height/2;c.beginPath(),c.moveTo(-d,-h),c.lineTo(d,-h),c.lineTo(d,h),c.lineTo(-d,h),c.lineTo(-d,-h),c.closePath()}},toObject:function(c){var d=[];this.filters.forEach(function(f){f&&d.push(f.toObject())});var h=a(this.callSuper("toObject",["cropX","cropY"].concat(c)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:d});return this.resizeFilter&&(h.resizeFilter=this.resizeFilter.toObject()),h},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var c=[],d=[],h,f=this._element,u=-this.width/2,p=-this.height/2,m="",g="";if(!f)return[];if(this.hasCrop()){var x=t.Object.__uid++;c.push('<clipPath id="imageCrop_'+x+`">
`,'	<rect x="'+u+'" y="'+p+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),m=' clip-path="url(#imageCrop_'+x+')" '}if(this.imageSmoothing||(g='" image-rendering="optimizeSpeed'),d.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',u-this.cropX,'" y="',p-this.cropY,'" width="',f.width||f.naturalWidth,'" height="',f.height||f.height,g,'"',m,`></image>
`),this.stroke||this.strokeDashArray){var y=this.fill;this.fill=null,h=["	<rect ",'x="',u,'" y="',p,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=y}return this.paintFirst!=="fill"?c=c.concat(h,d):c=c.concat(d,h),c},getSrc:function(c){var d=c?this._element:this._originalElement;return d?d.toDataURL?d.toDataURL():this.srcFromAttribute?d.getAttribute("src"):d.src:this.src||""},setSrc:function(c,d,h){return t.util.loadImage(c,function(f,u){this.setElement(f,h),this._setWidthHeight(),d&&d(this,u)},this,h&&h.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var c=this.resizeFilter,d=this.minimumScaleTrigger,h=this.getTotalObjectScaling(),f=h.scaleX,u=h.scaleY,p=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!c||f>d&&u>d){this._element=p,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=f,this._lastScaleY=u;return}t.filterBackend||(t.filterBackend=t.initFilterBackend());var m=t.util.createCanvasElement(),g=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,x=p.width,y=p.height;m.width=x,m.height=y,this._element=m,this._lastScaleX=c.scaleX=f,this._lastScaleY=c.scaleY=u,t.filterBackend.applyFilters([c],p,x,y,this._element,g),this._filterScalingX=m.width/this._originalElement.width,this._filterScalingY=m.height/this._originalElement.height},applyFilters:function(c){if(c=c||this.filters||[],c=c.filter(function(p){return p&&!p.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),c.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var d=this._originalElement,h=d.naturalWidth||d.width,f=d.naturalHeight||d.height;if(this._element===this._originalElement){var u=t.util.createCanvasElement();u.width=h,u.height=f,this._element=u,this._filteredEl=u}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,h,f),this._lastScaleX=1,this._lastScaleY=1;return t.filterBackend||(t.filterBackend=t.initFilterBackend()),t.filterBackend.applyFilters(c,this._originalElement,h,f,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(c){t.util.setImageSmoothing(c,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(c),this._renderPaintInOrder(c)},drawCacheOnCanvas:function(c){t.util.setImageSmoothing(c,this.imageSmoothing),t.Object.prototype.drawCacheOnCanvas.call(this,c)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(c){var d=this._element;if(d){var h=this._filterScalingX,f=this._filterScalingY,u=this.width,p=this.height,m=Math.min,g=Math.max,x=g(this.cropX,0),y=g(this.cropY,0),w=d.naturalWidth||d.width,_=d.naturalHeight||d.height,b=x*h,k=y*f,S=m(u*h,w-b),E=m(p*f,_-k),F=-u/2,P=-p/2,D=m(u,w/h-x),I=m(p,_/f-y);d&&c.drawImage(d,b,k,S,E,F,P,D,I)}},_needsResize:function(){var c=this.getTotalObjectScaling();return c.scaleX!==this._lastScaleX||c.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(c,d){this.setElement(t.util.getById(c),d),t.util.addClass(this.getElement(),t.Image.CSS_CANVAS)},_initConfig:function(c){c||(c={}),this.setOptions(c),this._setWidthHeight(c)},_initFilters:function(c,d){c&&c.length?t.util.enlivenObjects(c,function(h){d&&d(h)},"fabric.Image.filters"):d&&d()},_setWidthHeight:function(c){c||(c={});var d=this.getElement();this.width=c.width||d.naturalWidth||d.width||0,this.height=c.height||d.naturalHeight||d.height||0},parsePreserveAspectRatioAttribute:function(){var c=t.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),d=this._element.width,h=this._element.height,f=1,u=1,p=0,m=0,g=0,x=0,y,w=this.width,_=this.height,b={width:w,height:_};return c&&(c.alignX!=="none"||c.alignY!=="none")?(c.meetOrSlice==="meet"&&(f=u=t.util.findScaleToFit(this._element,b),y=(w-d*f)/2,c.alignX==="Min"&&(p=-y),c.alignX==="Max"&&(p=y),y=(_-h*u)/2,c.alignY==="Min"&&(m=-y),c.alignY==="Max"&&(m=y)),c.meetOrSlice==="slice"&&(f=u=t.util.findScaleToCover(this._element,b),y=d-w/f,c.alignX==="Mid"&&(g=y/2),c.alignX==="Max"&&(g=y),y=h-_/u,c.alignY==="Mid"&&(x=y/2),c.alignY==="Max"&&(x=y),d=w/f,h=_/u)):(f=w/d,u=_/h),{width:d,height:h,scaleX:f,scaleY:u,offsetLeft:p,offsetTop:m,cropX:g,cropY:x}}}),t.Image.CSS_CANVAS="canvas-img",t.Image.prototype.getSvgSrc=t.Image.prototype.getSrc,t.Image.fromObject=function(c,d){var h=t.util.object.clone(c);t.util.loadImage(h.src,function(f,u){if(u){d&&d(null,!0);return}t.Image.prototype._initFilters.call(h,h.filters,function(p){h.filters=p||[],t.Image.prototype._initFilters.call(h,[h.resizeFilter],function(m){h.resizeFilter=m[0],t.util.enlivenObjectEnlivables(h,h,function(){var g=new t.Image(f,h);d(g,!1)})})})},null,h.crossOrigin)},t.Image.fromURL=function(c,d,h){t.util.loadImage(c,function(f,u){d&&d(new t.Image(f,h),u)},null,h&&h.crossOrigin)},t.Image.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),t.Image.fromElement=function(c,d,h){var f=t.parseAttributes(c,t.Image.ATTRIBUTE_NAMES);t.Image.fromURL(f["xlink:href"],d,a(h?t.util.object.clone(h):{},f))}}(e),t.util.object.extend(t.Object.prototype,{_getAngleValueForStraighten:function(){var o=this.angle%360;return o>0?Math.round((o-1)/90)*90:Math.round(o/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(o){o=o||{};var a=function(){},c=o.onComplete||a,d=o.onChange||a,h=this;return t.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(f){h.rotate(f),d()},onComplete:function(){h.setCoords(),c()}})}}),t.util.object.extend(t.StaticCanvas.prototype,{straightenObject:function(o){return o.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(o){return o.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function o(c,d){var h="precision "+d+` float;
void main(){}`,f=c.createShader(c.FRAGMENT_SHADER);return c.shaderSource(f,h),c.compileShader(f),!!c.getShaderParameter(f,c.COMPILE_STATUS)}t.isWebglSupported=function(c){if(t.isLikelyNode)return!1;c=c||t.WebglFilterBackend.prototype.tileSize;var d=document.createElement("canvas"),h=d.getContext("webgl")||d.getContext("experimental-webgl"),f=!1;if(h){t.maxTextureSize=h.getParameter(h.MAX_TEXTURE_SIZE),f=t.maxTextureSize>=c;for(var u=["highp","mediump","lowp"],p=0;p<3;p++)if(o(h,u[p])){t.webGlPrecision=u[p];break}}return this.isSupported=f,f},t.WebglFilterBackend=a;function a(c){c&&c.tileSize&&(this.tileSize=c.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}a.prototype={tileSize:2048,resources:{},setupGLContext:function(c,d){this.dispose(),this.createWebGLCanvas(c,d),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(c,d)},chooseFastestCopyGLTo2DMethod:function(c,d){var h=typeof window.performance<"u",f;try{new ImageData(1,1),f=!0}catch{f=!1}var u=typeof ArrayBuffer<"u",p=typeof Uint8ClampedArray<"u";if(h&&f&&u&&p){var m=t.util.createCanvasElement(),g=new ArrayBuffer(c*d*4);if(t.forceGLPutImageData){this.imageBuffer=g,this.copyGLTo2D=l;return}var x={imageBuffer:g,destinationWidth:c,destinationHeight:d,targetCanvas:m},y,w,_;m.width=c,m.height=d,y=window.performance.now(),s.call(x,this.gl,x),w=window.performance.now()-y,y=window.performance.now(),l.call(x,this.gl,x),_=window.performance.now()-y,w>_?(this.imageBuffer=g,this.copyGLTo2D=l):this.copyGLTo2D=s}},createWebGLCanvas:function(c,d){var h=t.util.createCanvasElement();h.width=c,h.height=d;var f={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},u=h.getContext("webgl",f);u||(u=h.getContext("experimental-webgl",f)),u&&(u.clearColor(0,0,0,0),this.canvas=h,this.gl=u)},applyFilters:function(c,d,h,f,u,p){var m=this.gl,g;p&&(g=this.getCachedTexture(p,d));var x={originalWidth:d.width||d.originalWidth,originalHeight:d.height||d.originalHeight,sourceWidth:h,sourceHeight:f,destinationWidth:h,destinationHeight:f,context:m,sourceTexture:this.createTexture(m,h,f,!g&&d),targetTexture:this.createTexture(m,h,f),originalTexture:g||this.createTexture(m,h,f,!g&&d),passes:c.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:u},y=m.createFramebuffer();return m.bindFramebuffer(m.FRAMEBUFFER,y),c.forEach(function(w){w&&w.applyTo(x)}),i(x),this.copyGLTo2D(m,x),m.bindTexture(m.TEXTURE_2D,null),m.deleteTexture(x.sourceTexture),m.deleteTexture(x.targetTexture),m.deleteFramebuffer(y),u.getContext("2d").setTransform(1,0,0,1,0,0),x},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(c,d,h,f,u){var p=c.createTexture();return c.bindTexture(c.TEXTURE_2D,p),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,u||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,u||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),f?c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,f):c.texImage2D(c.TEXTURE_2D,0,c.RGBA,d,h,0,c.RGBA,c.UNSIGNED_BYTE,null),p},getCachedTexture:function(c,d){if(this.textureCache[c])return this.textureCache[c];var h=this.createTexture(this.gl,d.width,d.height,d);return this.textureCache[c]=h,h},evictCachesForKey:function(c){this.textureCache[c]&&(this.gl.deleteTexture(this.textureCache[c]),delete this.textureCache[c])},copyGLTo2D:s,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var c=this.gl,d={renderer:"",vendor:""};if(!c)return d;var h=c.getExtension("WEBGL_debug_renderer_info");if(h){var f=c.getParameter(h.UNMASKED_RENDERER_WEBGL),u=c.getParameter(h.UNMASKED_VENDOR_WEBGL);f&&(d.renderer=f.toLowerCase()),u&&(d.vendor=u.toLowerCase())}return this.gpuInfo=d,d}}}();function i(o){var a=o.targetCanvas,c=a.width,d=a.height,h=o.destinationWidth,f=o.destinationHeight;(c!==h||d!==f)&&(a.width=h,a.height=f)}function s(o,a){var c=o.canvas,d=a.targetCanvas,h=d.getContext("2d");h.translate(0,d.height),h.scale(1,-1);var f=c.height-d.height;h.drawImage(c,0,f,d.width,d.height,0,0,d.width,d.height)}function l(o,a){var c=a.targetCanvas,d=c.getContext("2d"),h=a.destinationWidth,f=a.destinationHeight,u=h*f*4,p=new Uint8Array(this.imageBuffer,0,u),m=new Uint8ClampedArray(this.imageBuffer,0,u);o.readPixels(0,0,h,f,o.RGBA,o.UNSIGNED_BYTE,p);var g=new ImageData(m,h,f);d.putImageData(g,0,0)}(function(){var o=function(){};t.Canvas2dFilterBackend=a;function a(){}a.prototype={evictCachesForKey:o,dispose:o,clearWebGLCaches:o,resources:{},applyFilters:function(c,d,h,f,u){var p=u.getContext("2d");p.drawImage(d,0,0,h,f);var m=p.getImageData(0,0,h,f),g=p.getImageData(0,0,h,f),x={sourceWidth:h,sourceHeight:f,imageData:m,originalEl:d,originalImageData:g,canvasEl:u,ctx:p,filterBackend:this};return c.forEach(function(y){y.applyTo(x)}),(x.imageData.width!==h||x.imageData.height!==f)&&(u.width=x.imageData.width,u.height=x.imageData.height),p.putImageData(x.imageData,0,0),x}}})(),t.Image=t.Image||{},t.Image.filters=t.Image.filters||{},t.Image.filters.BaseFilter=t.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(o){o&&this.setOptions(o)},setOptions:function(o){for(var a in o)this[a]=o[a]},createProgram:function(o,a,c){a=a||this.fragmentSource,c=c||this.vertexSource,t.webGlPrecision!=="highp"&&(a=a.replace(/precision highp float/g,"precision "+t.webGlPrecision+" float"));var d=o.createShader(o.VERTEX_SHADER);if(o.shaderSource(d,c),o.compileShader(d),!o.getShaderParameter(d,o.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+o.getShaderInfoLog(d));var h=o.createShader(o.FRAGMENT_SHADER);if(o.shaderSource(h,a),o.compileShader(h),!o.getShaderParameter(h,o.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+o.getShaderInfoLog(h));var f=o.createProgram();if(o.attachShader(f,d),o.attachShader(f,h),o.linkProgram(f),!o.getProgramParameter(f,o.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+o.getProgramInfoLog(f));var u=this.getAttributeLocations(o,f),p=this.getUniformLocations(o,f)||{};return p.uStepW=o.getUniformLocation(f,"uStepW"),p.uStepH=o.getUniformLocation(f,"uStepH"),{program:f,attributeLocations:u,uniformLocations:p}},getAttributeLocations:function(o,a){return{aPosition:o.getAttribLocation(a,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(o,a,c){var d=a.aPosition,h=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,h),o.enableVertexAttribArray(d),o.vertexAttribPointer(d,2,o.FLOAT,!1,0,0),o.bufferData(o.ARRAY_BUFFER,c,o.STATIC_DRAW)},_setupFrameBuffer:function(o){var a=o.context,c,d;o.passes>1?(c=o.destinationWidth,d=o.destinationHeight,(o.sourceWidth!==c||o.sourceHeight!==d)&&(a.deleteTexture(o.targetTexture),o.targetTexture=o.filterBackend.createTexture(a,c,d)),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,o.targetTexture,0)):(a.bindFramebuffer(a.FRAMEBUFFER,null),a.finish())},_swapTextures:function(o){o.passes--,o.pass++;var a=o.targetTexture;o.targetTexture=o.sourceTexture,o.sourceTexture=a},isNeutralState:function(){var o=this.mainParameter,a=t.Image.filters[this.type].prototype;if(o)if(Array.isArray(a[o])){for(var c=a[o].length;c--;)if(this[o][c]!==a[o][c])return!1;return!0}else return a[o]===this[o];else return!1},applyTo:function(o){o.webgl?(this._setupFrameBuffer(o),this.applyToWebGL(o),this._swapTextures(o)):this.applyTo2d(o)},retrieveShader:function(o){return o.programCache.hasOwnProperty(this.type)||(o.programCache[this.type]=this.createProgram(o.context)),o.programCache[this.type]},applyToWebGL:function(o){var a=o.context,c=this.retrieveShader(o);o.pass===0&&o.originalTexture?a.bindTexture(a.TEXTURE_2D,o.originalTexture):a.bindTexture(a.TEXTURE_2D,o.sourceTexture),a.useProgram(c.program),this.sendAttributeData(a,c.attributeLocations,o.aPosition),a.uniform1f(c.uniformLocations.uStepW,1/o.sourceWidth),a.uniform1f(c.uniformLocations.uStepH,1/o.sourceHeight),this.sendUniformData(a,c.uniformLocations),a.viewport(0,0,o.destinationWidth,o.destinationHeight),a.drawArrays(a.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(o,a,c){o.activeTexture(c),o.bindTexture(o.TEXTURE_2D,a),o.activeTexture(o.TEXTURE0)},unbindAdditionalTexture:function(o,a){o.activeTexture(a),o.bindTexture(o.TEXTURE_2D,null),o.activeTexture(o.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(o){this[this.mainParameter]=o},sendUniformData:function(){},createHelpLayer:function(o){if(!o.helpLayer){var a=document.createElement("canvas");a.width=o.sourceWidth,a.height=o.sourceHeight,o.helpLayer=a}},toObject:function(){var o={type:this.type},a=this.mainParameter;return a&&(o[a]=this[a]),o},toJSON:function(){return this.toObject()}}),t.Image.filters.BaseFilter.fromObject=function(o,a){var c=new t.Image.filters[o.type](o);return a&&a(c),c},function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.ColorMatrix=d(c.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(h){this.callSuper("initialize",h),this.matrix=this.matrix.slice(0)},applyTo2d:function(h){var f=h.imageData,u=f.data,p=u.length,m=this.matrix,g,x,y,w,_,b=this.colorsOnly;for(_=0;_<p;_+=4)g=u[_],x=u[_+1],y=u[_+2],b?(u[_]=g*m[0]+x*m[1]+y*m[2]+m[4]*255,u[_+1]=g*m[5]+x*m[6]+y*m[7]+m[9]*255,u[_+2]=g*m[10]+x*m[11]+y*m[12]+m[14]*255):(w=u[_+3],u[_]=g*m[0]+x*m[1]+y*m[2]+w*m[3]+m[4]*255,u[_+1]=g*m[5]+x*m[6]+y*m[7]+w*m[8]+m[9]*255,u[_+2]=g*m[10]+x*m[11]+y*m[12]+w*m[13]+m[14]*255,u[_+3]=g*m[15]+x*m[16]+y*m[17]+w*m[18]+m[19]*255)},getUniformLocations:function(h,f){return{uColorMatrix:h.getUniformLocation(f,"uColorMatrix"),uConstants:h.getUniformLocation(f,"uConstants")}},sendUniformData:function(h,f){var u=this.matrix,p=[u[0],u[1],u[2],u[3],u[5],u[6],u[7],u[8],u[10],u[11],u[12],u[13],u[15],u[16],u[17],u[18]],m=[u[4],u[9],u[14],u[19]];h.uniformMatrix4fv(f.uColorMatrix,!1,p),h.uniform4fv(f.uConstants,m)}}),a.Image.filters.ColorMatrix.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Brightness=d(c.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(h){if(this.brightness!==0){var f=h.imageData,u=f.data,p,m=u.length,g=Math.round(this.brightness*255);for(p=0;p<m;p+=4)u[p]=u[p]+g,u[p+1]=u[p+1]+g,u[p+2]=u[p+2]+g}},getUniformLocations:function(h,f){return{uBrightness:h.getUniformLocation(f,"uBrightness")}},sendUniformData:function(h,f){h.uniform1f(f.uBrightness,this.brightness)}}),a.Image.filters.Brightness.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.Image.filters,h=a.util.createClass;d.Convolute=h(d.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(f){var u=Math.sqrt(this.matrix.length),p=this.type+"_"+u+"_"+(this.opaque?1:0),m=this.fragmentSource[p];return f.programCache.hasOwnProperty(p)||(f.programCache[p]=this.createProgram(f.context,m)),f.programCache[p]},applyTo2d:function(f){var u=f.imageData,p=u.data,m=this.matrix,g=Math.round(Math.sqrt(m.length)),x=Math.floor(g/2),y=u.width,w=u.height,_=f.ctx.createImageData(y,w),b=_.data,k=this.opaque?1:0,S,E,F,P,D,I,X,z,G,ae,le,Z,C;for(le=0;le<w;le++)for(ae=0;ae<y;ae++){for(D=(le*y+ae)*4,S=0,E=0,F=0,P=0,C=0;C<g;C++)for(Z=0;Z<g;Z++)X=le+C-x,I=ae+Z-x,!(X<0||X>=w||I<0||I>=y)&&(z=(X*y+I)*4,G=m[C*g+Z],S+=p[z]*G,E+=p[z+1]*G,F+=p[z+2]*G,k||(P+=p[z+3]*G));b[D]=S,b[D+1]=E,b[D+2]=F,k?b[D+3]=p[D+3]:b[D+3]=P}f.imageData=_},getUniformLocations:function(f,u){return{uMatrix:f.getUniformLocation(u,"uMatrix"),uOpaque:f.getUniformLocation(u,"uOpaque"),uHalfSize:f.getUniformLocation(u,"uHalfSize"),uSize:f.getUniformLocation(u,"uSize")}},sendUniformData:function(f,u){f.uniform1fv(u.uMatrix,this.matrix)},toObject:function(){return c(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),a.Image.filters.Convolute.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Grayscale=d(c.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(h){var f=h.imageData,u=f.data,p,m=u.length,g,x=this.mode;for(p=0;p<m;p+=4)x==="average"?g=(u[p]+u[p+1]+u[p+2])/3:x==="lightness"?g=(Math.min(u[p],u[p+1],u[p+2])+Math.max(u[p],u[p+1],u[p+2]))/2:x==="luminosity"&&(g=.21*u[p]+.72*u[p+1]+.07*u[p+2]),u[p]=g,u[p+1]=g,u[p+2]=g},retrieveShader:function(h){var f=this.type+"_"+this.mode;if(!h.programCache.hasOwnProperty(f)){var u=this.fragmentSource[this.mode];h.programCache[f]=this.createProgram(h.context,u)}return h.programCache[f]},getUniformLocations:function(h,f){return{uMode:h.getUniformLocation(f,"uMode")}},sendUniformData:function(h,f){var u=1;h.uniform1i(f.uMode,u)},isNeutralState:function(){return!1}}),a.Image.filters.Grayscale.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Invert=d(c.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(h){var f=h.imageData,u=f.data,p,m=u.length;for(p=0;p<m;p+=4)u[p]=255-u[p],u[p+1]=255-u[p+1],u[p+2]=255-u[p+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(h,f){return{uInvert:h.getUniformLocation(f,"uInvert")}},sendUniformData:function(h,f){h.uniform1i(f.uInvert,this.invert)}}),a.Image.filters.Invert.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.Image.filters,h=a.util.createClass;d.Noise=h(d.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(f){if(this.noise!==0){var u=f.imageData,p=u.data,m,g=p.length,x=this.noise,y;for(m=0,g=p.length;m<g;m+=4)y=(.5-Math.random())*x,p[m]+=y,p[m+1]+=y,p[m+2]+=y}},getUniformLocations:function(f,u){return{uNoise:f.getUniformLocation(u,"uNoise"),uSeed:f.getUniformLocation(u,"uSeed")}},sendUniformData:function(f,u){f.uniform1f(u.uNoise,this.noise/255),f.uniform1f(u.uSeed,Math.random())},toObject:function(){return c(this.callSuper("toObject"),{noise:this.noise})}}),a.Image.filters.Noise.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Pixelate=d(c.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(h){var f=h.imageData,u=f.data,p=f.height,m=f.width,g,x,y,w,_,b,k,S,E,F,P;for(x=0;x<p;x+=this.blocksize)for(y=0;y<m;y+=this.blocksize)for(g=x*4*m+y*4,w=u[g],_=u[g+1],b=u[g+2],k=u[g+3],F=Math.min(x+this.blocksize,p),P=Math.min(y+this.blocksize,m),S=x;S<F;S++)for(E=y;E<P;E++)g=S*4*m+E*4,u[g]=w,u[g+1]=_,u[g+2]=b,u[g+3]=k},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(h,f){return{uBlocksize:h.getUniformLocation(f,"uBlocksize"),uStepW:h.getUniformLocation(f,"uStepW"),uStepH:h.getUniformLocation(f,"uStepH")}},sendUniformData:function(h,f){h.uniform1f(f.uBlocksize,this.blocksize)}}),a.Image.filters.Pixelate.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.Image.filters,h=a.util.createClass;d.RemoveColor=h(d.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(f){var u=f.imageData,p=u.data,m,g=this.distance*255,x,y,w,_=new a.Color(this.color).getSource(),b=[_[0]-g,_[1]-g,_[2]-g],k=[_[0]+g,_[1]+g,_[2]+g];for(m=0;m<p.length;m+=4)x=p[m],y=p[m+1],w=p[m+2],x>b[0]&&y>b[1]&&w>b[2]&&x<k[0]&&y<k[1]&&w<k[2]&&(p[m+3]=0)},getUniformLocations:function(f,u){return{uLow:f.getUniformLocation(u,"uLow"),uHigh:f.getUniformLocation(u,"uHigh")}},sendUniformData:function(f,u){var p=new a.Color(this.color).getSource(),m=parseFloat(this.distance),g=[0+p[0]/255-m,0+p[1]/255-m,0+p[2]/255-m,1],x=[p[0]/255+m,p[1]/255+m,p[2]/255+m,1];f.uniform4fv(u.uLow,g),f.uniform4fv(u.uHigh,x)},toObject:function(){return c(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),a.Image.filters.RemoveColor.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass,h={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var f in h)c[f]=d(c.ColorMatrix,{type:f,matrix:h[f],mainParameter:!1,colorsOnly:!0}),a.Image.filters[f].fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric,c=a.Image.filters,d=a.util.createClass;c.BlendColor=d(c.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(h){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[h]+`}
}`},retrieveShader:function(h){var f=this.type+"_"+this.mode,u;return h.programCache.hasOwnProperty(f)||(u=this.buildSource(this.mode),h.programCache[f]=this.createProgram(h.context,u)),h.programCache[f]},applyTo2d:function(h){var f=h.imageData,u=f.data,p=u.length,m,g,x,y,w,_,b,k=1-this.alpha;b=new a.Color(this.color).getSource(),m=b[0]*this.alpha,g=b[1]*this.alpha,x=b[2]*this.alpha;for(var S=0;S<p;S+=4)switch(y=u[S],w=u[S+1],_=u[S+2],this.mode){case"multiply":u[S]=y*m/255,u[S+1]=w*g/255,u[S+2]=_*x/255;break;case"screen":u[S]=255-(255-y)*(255-m)/255,u[S+1]=255-(255-w)*(255-g)/255,u[S+2]=255-(255-_)*(255-x)/255;break;case"add":u[S]=y+m,u[S+1]=w+g,u[S+2]=_+x;break;case"diff":case"difference":u[S]=Math.abs(y-m),u[S+1]=Math.abs(w-g),u[S+2]=Math.abs(_-x);break;case"subtract":u[S]=y-m,u[S+1]=w-g,u[S+2]=_-x;break;case"darken":u[S]=Math.min(y,m),u[S+1]=Math.min(w,g),u[S+2]=Math.min(_,x);break;case"lighten":u[S]=Math.max(y,m),u[S+1]=Math.max(w,g),u[S+2]=Math.max(_,x);break;case"overlay":u[S]=m<128?2*y*m/255:255-2*(255-y)*(255-m)/255,u[S+1]=g<128?2*w*g/255:255-2*(255-w)*(255-g)/255,u[S+2]=x<128?2*_*x/255:255-2*(255-_)*(255-x)/255;break;case"exclusion":u[S]=m+y-2*m*y/255,u[S+1]=g+w-2*g*w/255,u[S+2]=x+_-2*x*_/255;break;case"tint":u[S]=m+y*k,u[S+1]=g+w*k,u[S+2]=x+_*k}},getUniformLocations:function(h,f){return{uColor:h.getUniformLocation(f,"uColor")}},sendUniformData:function(h,f){var u=new a.Color(this.color).getSource();u[0]=this.alpha*u[0]/255,u[1]=this.alpha*u[1]/255,u[2]=this.alpha*u[2]/255,u[3]=this.alpha,h.uniform4fv(f.uColor,u)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),a.Image.filters.BlendColor.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric,c=a.Image.filters,d=a.util.createClass;c.BlendImage=d(c.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(h){var f=this.type+"_"+this.mode,u=this.fragmentSource[this.mode];return h.programCache.hasOwnProperty(f)||(h.programCache[f]=this.createProgram(h.context,u)),h.programCache[f]},applyToWebGL:function(h){var f=h.context,u=this.createTexture(h.filterBackend,this.image);this.bindAdditionalTexture(f,u,f.TEXTURE1),this.callSuper("applyToWebGL",h),this.unbindAdditionalTexture(f,f.TEXTURE1)},createTexture:function(h,f){return h.getCachedTexture(f.cacheKey,f._element)},calculateMatrix:function(){var h=this.image,f=h._element.width,u=h._element.height;return[1/h.scaleX,0,0,0,1/h.scaleY,0,-h.left/f,-h.top/u,1]},applyTo2d:function(h){var f=h.imageData,u=h.filterBackend.resources,p=f.data,m=p.length,g=f.width,x=f.height,y,w,_,b,k,S,E,F,P,D,I=this.image,X;u.blendImage||(u.blendImage=a.util.createCanvasElement()),P=u.blendImage,D=P.getContext("2d"),P.width!==g||P.height!==x?(P.width=g,P.height=x):D.clearRect(0,0,g,x),D.setTransform(I.scaleX,0,0,I.scaleY,I.left,I.top),D.drawImage(I._element,0,0,g,x),X=D.getImageData(0,0,g,x).data;for(var z=0;z<m;z+=4)switch(k=p[z],S=p[z+1],E=p[z+2],F=p[z+3],y=X[z],w=X[z+1],_=X[z+2],b=X[z+3],this.mode){case"multiply":p[z]=k*y/255,p[z+1]=S*w/255,p[z+2]=E*_/255,p[z+3]=F*b/255;break;case"mask":p[z+3]=b;break}},getUniformLocations:function(h,f){return{uTransformMatrix:h.getUniformLocation(f,"uTransformMatrix"),uImage:h.getUniformLocation(f,"uImage")}},sendUniformData:function(h,f){var u=this.calculateMatrix();h.uniform1i(f.uImage,1),h.uniformMatrix3fv(f.uTransformMatrix,!1,u)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),a.Image.filters.BlendImage.fromObject=function(h,f){a.Image.fromObject(h.image,function(u){var p=a.util.object.clone(h);p.image=u,f(new a.Image.filters.BlendImage(p))})}}(e),function(o){var a=o.fabric||(o.fabric={}),c=Math.pow,d=Math.floor,h=Math.sqrt,f=Math.abs,u=Math.round,p=Math.sin,m=Math.ceil,g=a.Image.filters,x=a.util.createClass;g.Resize=x(g.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(y,w){return{uDelta:y.getUniformLocation(w,"uDelta"),uTaps:y.getUniformLocation(w,"uTaps")}},sendUniformData:function(y,w){y.uniform2fv(w.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),y.uniform1fv(w.uTaps,this.taps)},retrieveShader:function(y){var w=this.getFilterWindow(),_=this.type+"_"+w;if(!y.programCache.hasOwnProperty(_)){var b=this.generateShader(w);y.programCache[_]=this.createProgram(y.context,b)}return y.programCache[_]},getFilterWindow:function(){var y=this.tempScale;return Math.ceil(this.lanczosLobes/y)},getTaps:function(){for(var y=this.lanczosCreate(this.lanczosLobes),w=this.tempScale,_=this.getFilterWindow(),b=new Array(_),k=1;k<=_;k++)b[k-1]=y(k*w);return b},generateShader:function(b){for(var w=new Array(b),_=this.fragmentSourceTOP,b,k=1;k<=b;k++)w[k-1]=k+".0 * uDelta";return _+="uniform float uTaps["+b+`];
`,_+=`void main() {
`,_+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,_+=`  float sum = 1.0;
`,w.forEach(function(S,E){_+="  color += texture2D(uTexture, vTexCoord + "+S+") * uTaps["+E+`];
`,_+="  color += texture2D(uTexture, vTexCoord - "+S+") * uTaps["+E+`];
`,_+="  sum += 2.0 * uTaps["+E+`];
`}),_+=`  gl_FragColor = color / sum;
`,_+="}",_},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(y){y.webgl?(y.passes++,this.width=y.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=y.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),y.destinationWidth=this.dW,this._setupFrameBuffer(y),this.applyToWebGL(y),this._swapTextures(y),y.sourceWidth=y.destinationWidth,this.height=y.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),y.destinationHeight=this.dH,this._setupFrameBuffer(y),this.applyToWebGL(y),this._swapTextures(y),y.sourceHeight=y.destinationHeight):this.applyTo2d(y)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(y){return function(w){if(w>=y||w<=-y)return 0;if(w<11920929e-14&&w>-11920929e-14)return 1;w*=Math.PI;var _=w/y;return p(w)/w*p(_)/_}},applyTo2d:function(y){var w=y.imageData,_=this.scaleX,b=this.scaleY;this.rcpScaleX=1/_,this.rcpScaleY=1/b;var k=w.width,S=w.height,E=u(k*_),F=u(S*b),P;this.resizeType==="sliceHack"?P=this.sliceByTwo(y,k,S,E,F):this.resizeType==="hermite"?P=this.hermiteFastResize(y,k,S,E,F):this.resizeType==="bilinear"?P=this.bilinearFiltering(y,k,S,E,F):this.resizeType==="lanczos"&&(P=this.lanczosResize(y,k,S,E,F)),y.imageData=P},sliceByTwo:function(y,w,_,b,k){var S=y.imageData,E=.5,F=!1,P=!1,D=w*E,I=_*E,X=a.filterBackend.resources,z,G,ae=0,le=0,Z=w,C=0;for(X.sliceByTwo||(X.sliceByTwo=document.createElement("canvas")),z=X.sliceByTwo,(z.width<w*1.5||z.height<_)&&(z.width=w*1.5,z.height=_),G=z.getContext("2d"),G.clearRect(0,0,w*1.5,_),G.putImageData(S,0,0),b=d(b),k=d(k);!F||!P;)w=D,_=I,b<d(D*E)?D=d(D*E):(D=b,F=!0),k<d(I*E)?I=d(I*E):(I=k,P=!0),G.drawImage(z,ae,le,w,_,Z,C,D,I),ae=Z,le=C,C+=I;return G.getImageData(ae,le,b,k)},lanczosResize:function(y,w,_,b,k){function S(B){var N,U,A,T,j,M,Y,H,V,fe,O;for(C.x=(B+.5)*I,L.x=d(C.x),N=0;N<k;N++){for(C.y=(N+.5)*X,L.y=d(C.y),j=0,M=0,Y=0,H=0,V=0,U=L.x-ae;U<=L.x+ae;U++)if(!(U<0||U>=w)){fe=d(1e3*f(U-C.x)),Z[fe]||(Z[fe]={});for(var Q=L.y-le;Q<=L.y+le;Q++)Q<0||Q>=_||(O=d(1e3*f(Q-C.y)),Z[fe][O]||(Z[fe][O]=D(h(c(fe*z,2)+c(O*G,2))/1e3)),A=Z[fe][O],A>0&&(T=(Q*w+U)*4,j+=A,M+=A*E[T],Y+=A*E[T+1],H+=A*E[T+2],V+=A*E[T+3]))}T=(N*b+B)*4,P[T]=M/j,P[T+1]=Y/j,P[T+2]=H/j,P[T+3]=V/j}return++B<b?S(B):F}var E=y.imageData.data,F=y.ctx.createImageData(b,k),P=F.data,D=this.lanczosCreate(this.lanczosLobes),I=this.rcpScaleX,X=this.rcpScaleY,z=2/this.rcpScaleX,G=2/this.rcpScaleY,ae=m(I*this.lanczosLobes/2),le=m(X*this.lanczosLobes/2),Z={},C={},L={};return S(0)},bilinearFiltering:function(y,w,_,b,k){var S,E,F,P,D,I,X,z,G,ae,le,Z,C=0,L,B=this.rcpScaleX,N=this.rcpScaleY,U=4*(w-1),A=y.imageData,T=A.data,j=y.ctx.createImageData(b,k),M=j.data;for(X=0;X<k;X++)for(z=0;z<b;z++)for(D=d(B*z),I=d(N*X),G=B*z-D,ae=N*X-I,L=4*(I*w+D),le=0;le<4;le++)S=T[L+le],E=T[L+4+le],F=T[L+U+le],P=T[L+U+4+le],Z=S*(1-G)*(1-ae)+E*G*(1-ae)+F*ae*(1-G)+P*G*ae,M[C++]=Z;return j},hermiteFastResize:function(y,w,_,b,k){for(var S=this.rcpScaleX,E=this.rcpScaleY,F=m(S/2),P=m(E/2),D=y.imageData,I=D.data,X=y.ctx.createImageData(b,k),z=X.data,G=0;G<k;G++)for(var ae=0;ae<b;ae++){for(var le=(ae+G*b)*4,Z=0,C=0,L=0,B=0,N=0,U=0,A=0,T=(G+.5)*E,j=d(G*E);j<(G+1)*E;j++)for(var M=f(T-(j+.5))/P,Y=(ae+.5)*S,H=M*M,V=d(ae*S);V<(ae+1)*S;V++){var fe=f(Y-(V+.5))/F,O=h(H+fe*fe);O>1&&O<-1||(Z=2*O*O*O-3*O*O+1,Z>0&&(fe=4*(V+j*w),A+=Z*I[fe+3],L+=Z,I[fe+3]<255&&(Z=Z*I[fe+3]/250),B+=Z*I[fe],N+=Z*I[fe+1],U+=Z*I[fe+2],C+=Z))}z[le]=B/C,z[le+1]=N/C,z[le+2]=U/C,z[le+3]=A/L}return X},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),a.Image.filters.Resize.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Contrast=d(c.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(h){if(this.contrast!==0){var f=h.imageData,u,m,p=f.data,m=p.length,g=Math.floor(this.contrast*255),x=259*(g+255)/(255*(259-g));for(u=0;u<m;u+=4)p[u]=x*(p[u]-128)+128,p[u+1]=x*(p[u+1]-128)+128,p[u+2]=x*(p[u+2]-128)+128}},getUniformLocations:function(h,f){return{uContrast:h.getUniformLocation(f,"uContrast")}},sendUniformData:function(h,f){h.uniform1f(f.uContrast,this.contrast)}}),a.Image.filters.Contrast.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Saturation=d(c.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(h){if(this.saturation!==0){var f=h.imageData,u=f.data,p=u.length,m=-this.saturation,g,x;for(g=0;g<p;g+=4)x=Math.max(u[g],u[g+1],u[g+2]),u[g]+=x!==u[g]?(x-u[g])*m:0,u[g+1]+=x!==u[g+1]?(x-u[g+1])*m:0,u[g+2]+=x!==u[g+2]?(x-u[g+2])*m:0}},getUniformLocations:function(h,f){return{uSaturation:h.getUniformLocation(f,"uSaturation")}},sendUniformData:function(h,f){h.uniform1f(f.uSaturation,-this.saturation)}}),a.Image.filters.Saturation.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Vibrance=d(c.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(h){if(this.vibrance!==0){var f=h.imageData,u=f.data,p=u.length,m=-this.vibrance,g,x,y,w;for(g=0;g<p;g+=4)x=Math.max(u[g],u[g+1],u[g+2]),y=(u[g]+u[g+1]+u[g+2])/3,w=Math.abs(x-y)*2/255*m,u[g]+=x!==u[g]?(x-u[g])*w:0,u[g+1]+=x!==u[g+1]?(x-u[g+1])*w:0,u[g+2]+=x!==u[g+2]?(x-u[g+2])*w:0}},getUniformLocations:function(h,f){return{uVibrance:h.getUniformLocation(f,"uVibrance")}},sendUniformData:function(h,f){h.uniform1f(f.uVibrance,-this.vibrance)}}),a.Image.filters.Vibrance.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Blur=d(c.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(h){h.webgl?(this.aspectRatio=h.sourceWidth/h.sourceHeight,h.passes++,this._setupFrameBuffer(h),this.horizontal=!0,this.applyToWebGL(h),this._swapTextures(h),this._setupFrameBuffer(h),this.horizontal=!1,this.applyToWebGL(h),this._swapTextures(h)):this.applyTo2d(h)},applyTo2d:function(h){h.imageData=this.simpleBlur(h)},simpleBlur:function(h){var f=h.filterBackend.resources,u,p,m=h.imageData.width,g=h.imageData.height;f.blurLayer1||(f.blurLayer1=a.util.createCanvasElement(),f.blurLayer2=a.util.createCanvasElement()),u=f.blurLayer1,p=f.blurLayer2,(u.width!==m||u.height!==g)&&(p.width=u.width=m,p.height=u.height=g);var x=u.getContext("2d"),y=p.getContext("2d"),w=15,_,b,k,S,E=this.blur*.06*.5;for(x.putImageData(h.imageData,0,0),y.clearRect(0,0,m,g),S=-w;S<=w;S++)_=(Math.random()-.5)/4,b=S/w,k=E*b*m+_,y.globalAlpha=1-Math.abs(b),y.drawImage(u,k,_),x.drawImage(p,0,0),y.globalAlpha=1,y.clearRect(0,0,p.width,p.height);for(S=-w;S<=w;S++)_=(Math.random()-.5)/4,b=S/w,k=E*b*g+_,y.globalAlpha=1-Math.abs(b),y.drawImage(u,_,k),x.drawImage(p,0,0),y.globalAlpha=1,y.clearRect(0,0,p.width,p.height);h.ctx.drawImage(u,0,0);var F=h.ctx.getImageData(0,0,u.width,u.height);return x.globalAlpha=1,x.clearRect(0,0,u.width,u.height),F},getUniformLocations:function(h,f){return{delta:h.getUniformLocation(f,"uDelta")}},sendUniformData:function(h,f){var u=this.chooseRightDelta();h.uniform2fv(f.delta,u)},chooseRightDelta:function(){var h=1,f=[0,0],u;return this.horizontal?this.aspectRatio>1&&(h=1/this.aspectRatio):this.aspectRatio<1&&(h=this.aspectRatio),u=h*this.blur*.12,this.horizontal?f[0]=u:f[1]=u,f}}),c.Blur.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Gamma=d(c.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(h){this.gamma=[1,1,1],c.BaseFilter.prototype.initialize.call(this,h)},applyTo2d:function(h){var f=h.imageData,u=f.data,p=this.gamma,m=u.length,g=1/p[0],x=1/p[1],y=1/p[2],w;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),w=0,m=256;w<m;w++)this.rVals[w]=Math.pow(w/255,g)*255,this.gVals[w]=Math.pow(w/255,x)*255,this.bVals[w]=Math.pow(w/255,y)*255;for(w=0,m=u.length;w<m;w+=4)u[w]=this.rVals[u[w]],u[w+1]=this.gVals[u[w+1]],u[w+2]=this.bVals[u[w+2]]},getUniformLocations:function(h,f){return{uGamma:h.getUniformLocation(f,"uGamma")}},sendUniformData:function(h,f){h.uniform3fv(f.uGamma,this.gamma)}}),a.Image.filters.Gamma.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Composed=d(c.BaseFilter,{type:"Composed",subFilters:[],initialize:function(h){this.callSuper("initialize",h),this.subFilters=this.subFilters.slice(0)},applyTo:function(h){h.passes+=this.subFilters.length-1,this.subFilters.forEach(function(f){f.applyTo(h)})},toObject:function(){return a.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(h){return h.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(h){return!h.isNeutralState()})}}),a.Image.filters.Composed.fromObject=function(h,f){var u=h.subFilters||[],p=u.map(function(g){return new a.Image.filters[g.type](g)}),m=new a.Image.filters.Composed({subFilters:p});return f&&f(m),m}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.HueRotation=d(c.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var h=this.rotation*Math.PI,f=a.util.cos(h),u=a.util.sin(h),p=1/3,m=Math.sqrt(p)*u,g=1-f;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=f+g/3,this.matrix[1]=p*g-m,this.matrix[2]=p*g+m,this.matrix[5]=p*g+m,this.matrix[6]=f+p*g,this.matrix[7]=p*g-m,this.matrix[10]=p*g-m,this.matrix[11]=p*g+m,this.matrix[12]=f+p*g},isNeutralState:function(h){return this.calculateMatrix(),c.BaseFilter.prototype.isNeutralState.call(this,h)},applyTo:function(h){this.calculateMatrix(),c.BaseFilter.prototype.applyTo.call(this,h)}}),a.Image.filters.HueRotation.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.clone;if(a.Text){a.warn("fabric.Text is already defined");return}var d="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");a.Text=a.util.createClass(a.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:a.Object.prototype.stateProperties.concat(d),cacheProperties:a.Object.prototype.cacheProperties.concat(d),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(h,f){this.styles=f?f.styles||{}:{},this.text=h,this.__skipDimension=!0,this.callSuper("initialize",f),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var h=this.path;h&&(h.segmentsInfo=a.util.getPathSegmentsInfo(h.path))},getMeasuringContext:function(){return a._measuringContext||(a._measuringContext=this.canvas&&this.canvas.contextCache||a.util.createCanvasElement().getContext("2d")),a._measuringContext},_splitText:function(){var h=this._splitTextIntoLines(this.text);return this.textLines=h.lines,this._textLines=h.graphemeLines,this._unwrappedTextLines=h._unwrappedLines,this._text=h.graphemeText,h},initDimensions:function(){if(!this.__skipDimension){if(this._splitText(),this._clearCache(),this.path){var h=this.getHeightOfLine(0)*1.1;this.width=this.path.width+h,this.height=this.path.height+h}else this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight();this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"})}},enlargeSpaces:function(){for(var h,f,u,p,m,g,x,y=0,w=this._textLines.length;y<w;y++)if(!(this.textAlign!=="justify"&&(y===w-1||this.isEndOfWrapping(y)))&&(p=0,m=this._textLines[y],f=this.getLineWidth(y),f<this.width&&(x=this.textLines[y].match(this._reSpacesAndTabs)))){u=x.length,h=(this.width-f)/u;for(var _=0,b=m.length;_<=b;_++)g=this.__charBounds[y][_],this._reSpaceAndTab.test(m[_])?(g.width+=h,g.kernedWidth+=h,g.left+=p,p+=h):g.left+=p}},isEndOfWrapping:function(h){return h===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var h=this.callSuper("_getCacheCanvasDimensions"),f=this.fontSize;return h.width+=f*h.zoomX,h.height+=f*h.zoomY,h},_render:function(h){var f=this.path;f&&!f.isNotVisible()&&f._render(h),this._setTextStyles(h),this._renderTextLinesBackground(h),this._renderTextDecoration(h,"underline"),this._renderText(h),this._renderTextDecoration(h,"overline"),this._renderTextDecoration(h,"linethrough")},_renderText:function(h){this.paintFirst==="stroke"?(this._renderTextStroke(h),this._renderTextFill(h)):(this._renderTextFill(h),this._renderTextStroke(h))},_setTextStyles:function(h,f,u){if(h.textBaseline="alphabetic",this.path)switch(this.pathAlign){case"center":h.textBaseline="middle";break;case"ascender":h.textBaseline="top";break;case"descender":h.textBaseline="bottom";break}h.font=this._getFontDeclaration(f,u)},calcTextWidth:function(){for(var h=this.getLineWidth(0),f=1,u=this._textLines.length;f<u;f++){var p=this.getLineWidth(f);p>h&&(h=p)}return h},_renderTextLine:function(h,f,u,p,m,g){this._renderChars(h,f,u,p,m,g)},_renderTextLinesBackground:function(h){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var f,u,p=h.fillStyle,m,g,x=this._getLeftOffset(),y=this._getTopOffset(),w=0,_=0,b,k,S=this.path,E,F=0,P=this._textLines.length;F<P;F++){if(f=this.getHeightOfLine(F),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",F)){y+=f;continue}m=this._textLines[F],u=this._getLineLeftOffset(F),_=0,w=0,g=this.getValueOfPropertyAt(F,0,"textBackgroundColor");for(var D=0,I=m.length;D<I;D++)b=this.__charBounds[F][D],k=this.getValueOfPropertyAt(F,D,"textBackgroundColor"),S?(h.save(),h.translate(b.renderLeft,b.renderTop),h.rotate(b.angle),h.fillStyle=k,k&&h.fillRect(-b.width/2,-f/this.lineHeight*(1-this._fontSizeFraction),b.width,f/this.lineHeight),h.restore()):k!==g?(E=x+u+w,this.direction==="rtl"&&(E=this.width-E-_),h.fillStyle=g,g&&h.fillRect(E,y,_,f/this.lineHeight),w=b.left,_=b.width,g=k):_+=b.kernedWidth;k&&!S&&(E=x+u+w,this.direction==="rtl"&&(E=this.width-E-_),h.fillStyle=k,h.fillRect(E,y,_,f/this.lineHeight)),y+=f}h.fillStyle=p,this._removeShadow(h)}},getFontCache:function(h){var f=h.fontFamily.toLowerCase();a.charWidthsCache[f]||(a.charWidthsCache[f]={});var u=a.charWidthsCache[f],p=h.fontStyle.toLowerCase()+"_"+(h.fontWeight+"").toLowerCase();return u[p]||(u[p]={}),u[p]},_measureChar:function(h,f,u,p){var m=this.getFontCache(f),g=this._getFontDeclaration(f),x=this._getFontDeclaration(p),y=u+h,w=g===x,_,b,k,S=f.fontSize/this.CACHE_FONT_SIZE,E;if(u&&m[u]!==void 0&&(k=m[u]),m[h]!==void 0&&(E=_=m[h]),w&&m[y]!==void 0&&(b=m[y],E=b-k),_===void 0||k===void 0||b===void 0){var F=this.getMeasuringContext();this._setTextStyles(F,f,!0)}return _===void 0&&(E=_=F.measureText(h).width,m[h]=_),k===void 0&&w&&u&&(k=F.measureText(u).width,m[u]=k),w&&b===void 0&&(b=F.measureText(y).width,m[y]=b,E=b-k),{width:_*S,kernedWidth:E*S}},getHeightOfChar:function(h,f){return this.getValueOfPropertyAt(h,f,"fontSize")},measureLine:function(h){var f=this._measureLine(h);return this.charSpacing!==0&&(f.width-=this._getWidthOfCharSpacing()),f.width<0&&(f.width=0),f},_measureLine:function(h){var f=0,u,p,m=this._textLines[h],g,x,y=0,w=new Array(m.length),_=0,b,k,S=this.path,E=this.pathSide==="right";for(this.__charBounds[h]=w,u=0;u<m.length;u++)p=m[u],x=this._getGraphemeBox(p,h,u,g),w[u]=x,f+=x.kernedWidth,g=p;if(w[u]={left:x?x.left+x.width:0,width:0,kernedWidth:0,height:this.fontSize},S){switch(k=S.segmentsInfo[S.segmentsInfo.length-1].length,b=a.util.getPointOnPath(S.path,0,S.segmentsInfo),b.x+=S.pathOffset.x,b.y+=S.pathOffset.y,this.textAlign){case"left":_=E?k-f:0;break;case"center":_=(k-f)/2;break;case"right":_=E?0:k-f;break}for(_+=this.pathStartOffset*(E?-1:1),u=E?m.length-1:0;E?u>=0:u<m.length;E?u--:u++)x=w[u],_>k?_%=k:_<0&&(_+=k),this._setGraphemeOnPath(_,x,b),_+=x.kernedWidth}return{width:f,numOfSpaces:y}},_setGraphemeOnPath:function(h,f,u){var p=h+f.kernedWidth/2,m=this.path,g=a.util.getPointOnPath(m.path,p,m.segmentsInfo);f.renderLeft=g.x-u.x,f.renderTop=g.y-u.y,f.angle=g.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(h,f,u,p,m){var g=this.getCompleteStyleDeclaration(f,u),x=p?this.getCompleteStyleDeclaration(f,u-1):{},y=this._measureChar(h,g,p,x),w=y.kernedWidth,_=y.width,b;this.charSpacing!==0&&(b=this._getWidthOfCharSpacing(),_+=b,w+=b);var k={width:_,left:0,height:g.fontSize,kernedWidth:w,deltaY:g.deltaY};if(u>0&&!m){var S=this.__charBounds[f][u-1];k.left=S.left+S.width+y.kernedWidth-y.width}return k},getHeightOfLine:function(h){if(this.__lineHeights[h])return this.__lineHeights[h];for(var f=this._textLines[h],u=this.getHeightOfChar(h,0),p=1,m=f.length;p<m;p++)u=Math.max(this.getHeightOfChar(h,p),u);return this.__lineHeights[h]=u*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var h,f=0,u=0,p=this._textLines.length;u<p;u++)h=this.getHeightOfLine(u),f+=u===p-1?h/this.lineHeight:h;return f},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(h,f){h.save();for(var u=0,p=this._getLeftOffset(),m=this._getTopOffset(),g=0,x=this._textLines.length;g<x;g++){var y=this.getHeightOfLine(g),w=y/this.lineHeight,_=this._getLineLeftOffset(g);this._renderTextLine(f,h,this._textLines[g],p+_,m+u+w,g),u+=y}h.restore()},_renderTextFill:function(h){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(h,"fillText")},_renderTextStroke:function(h){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(h),h.save(),this._setLineDash(h,this.strokeDashArray),h.beginPath(),this._renderTextCommon(h,"strokeText"),h.closePath(),h.restore())},_renderChars:function(h,f,u,p,m,g){var x=this.getHeightOfLine(g),y=this.textAlign.indexOf("justify")!==-1,w,_,b="",k,S=0,E,F=this.path,P=!y&&this.charSpacing===0&&this.isEmptyStyles(g)&&!F,D=this.direction==="ltr",I=this.direction==="ltr"?1:-1,X,z=f.canvas.getAttribute("dir");if(f.save(),z!==this.direction&&(f.canvas.setAttribute("dir",D?"ltr":"rtl"),f.direction=D?"ltr":"rtl",f.textAlign=D?"left":"right"),m-=x*this._fontSizeFraction/this.lineHeight,P){this._renderChar(h,f,g,0,u.join(""),p,m,x),f.restore();return}for(var G=0,ae=u.length-1;G<=ae;G++)E=G===ae||this.charSpacing||F,b+=u[G],k=this.__charBounds[g][G],S===0?(p+=I*(k.kernedWidth-k.width),S+=k.width):S+=k.kernedWidth,y&&!E&&this._reSpaceAndTab.test(u[G])&&(E=!0),E||(w=w||this.getCompleteStyleDeclaration(g,G),_=this.getCompleteStyleDeclaration(g,G+1),E=a.util.hasStyleChanged(w,_,!1)),E&&(F?(f.save(),f.translate(k.renderLeft,k.renderTop),f.rotate(k.angle),this._renderChar(h,f,g,G,b,-S/2,0,x),f.restore()):(X=p,this._renderChar(h,f,g,G,b,X,m,x)),b="",w=_,p+=I*S,S=0);f.restore()},_applyPatternGradientTransformText:function(h){var f=a.util.createCanvasElement(),u,p=this.width+this.strokeWidth,m=this.height+this.strokeWidth;return f.width=p,f.height=m,u=f.getContext("2d"),u.beginPath(),u.moveTo(0,0),u.lineTo(p,0),u.lineTo(p,m),u.lineTo(0,m),u.closePath(),u.translate(p/2,m/2),u.fillStyle=h.toLive(u),this._applyPatternGradientTransform(u,h),u.fill(),u.createPattern(f,"no-repeat")},handleFiller:function(h,f,u){var p,m;return u.toLive?u.gradientUnits==="percentage"||u.gradientTransform||u.patternTransform?(p=-this.width/2,m=-this.height/2,h.translate(p,m),h[f]=this._applyPatternGradientTransformText(u),{offsetX:p,offsetY:m}):(h[f]=u.toLive(h,this),this._applyPatternGradientTransform(h,u)):(h[f]=u,{offsetX:0,offsetY:0})},_setStrokeStyles:function(h,f){return h.lineWidth=f.strokeWidth,h.lineCap=this.strokeLineCap,h.lineDashOffset=this.strokeDashOffset,h.lineJoin=this.strokeLineJoin,h.miterLimit=this.strokeMiterLimit,this.handleFiller(h,"strokeStyle",f.stroke)},_setFillStyles:function(h,f){return this.handleFiller(h,"fillStyle",f.fill)},_renderChar:function(h,f,u,p,m,g,x){var y=this._getStyleDeclaration(u,p),w=this.getCompleteStyleDeclaration(u,p),_=h==="fillText"&&w.fill,b=h==="strokeText"&&w.stroke&&w.strokeWidth,k,S;!b&&!_||(f.save(),_&&(k=this._setFillStyles(f,w)),b&&(S=this._setStrokeStyles(f,w)),f.font=this._getFontDeclaration(w),y&&y.textBackgroundColor&&this._removeShadow(f),y&&y.deltaY&&(x+=y.deltaY),_&&f.fillText(m,g-k.offsetX,x-k.offsetY),b&&f.strokeText(m,g-S.offsetX,x-S.offsetY),f.restore())},setSuperscript:function(h,f){return this._setScript(h,f,this.superscript)},setSubscript:function(h,f){return this._setScript(h,f,this.subscript)},_setScript:function(h,f,u){var p=this.get2DCursorLocation(h,!0),m=this.getValueOfPropertyAt(p.lineIndex,p.charIndex,"fontSize"),g=this.getValueOfPropertyAt(p.lineIndex,p.charIndex,"deltaY"),x={fontSize:m*u.size,deltaY:g+m*u.baseline};return this.setSelectionStyles(x,h,f),this},_getLineLeftOffset:function(h){var f=this.getLineWidth(h),u=this.width-f,p=this.textAlign,m=this.direction,x,g=0,x=this.isEndOfWrapping(h);return p==="justify"||p==="justify-center"&&!x||p==="justify-right"&&!x||p==="justify-left"&&!x?0:(p==="center"&&(g=u/2),p==="right"&&(g=u),p==="justify-center"&&(g=u/2),p==="justify-right"&&(g=u),m==="rtl"&&(g-=u),g)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var h=this._forceClearCache;return h||(h=this.hasStateChanged("_dimensionAffectingProps")),h&&(this.dirty=!0,this._forceClearCache=!1),h},getLineWidth:function(h){if(this.__lineWidths[h]!==void 0)return this.__lineWidths[h];var f=this.measureLine(h),u=f.width;return this.__lineWidths[h]=u,u},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(h,f,u){var p=this._getStyleDeclaration(h,f);return p&&typeof p[u]<"u"?p[u]:this[u]},_renderTextDecoration:function(h,f){if(!(!this[f]&&!this.styleHas(f))){h.save(),(f==="overline"||f==="linethrough")&&this._removeShadow(h);for(var u,p,m,g,x,y,w,_,b=this._getLeftOffset(),k=this._getTopOffset(),S,E,F,P,D,I,X,z,G=this.path,ae=this._getWidthOfCharSpacing(),le=this.offsets[f],Z=0,C=this._textLines.length;Z<C;Z++){if(u=this.getHeightOfLine(Z),!this[f]&&!this.styleHas(f,Z)){k+=u;continue}w=this._textLines[Z],I=u/this.lineHeight,g=this._getLineLeftOffset(Z),E=0,F=0,_=this.getValueOfPropertyAt(Z,0,f),z=this.getValueOfPropertyAt(Z,0,"fill"),S=k+I*(1-this._fontSizeFraction),p=this.getHeightOfChar(Z,0),x=this.getValueOfPropertyAt(Z,0,"deltaY");for(var L=0,B=w.length;L<B;L++)if(P=this.__charBounds[Z][L],D=this.getValueOfPropertyAt(Z,L,f),X=this.getValueOfPropertyAt(Z,L,"fill"),m=this.getHeightOfChar(Z,L),y=this.getValueOfPropertyAt(Z,L,"deltaY"),G&&D&&X)h.save(),h.fillStyle=z,h.translate(P.renderLeft,P.renderTop),h.rotate(P.angle),h.fillRect(-P.kernedWidth/2,le*m+y,P.kernedWidth,this.fontSize/15),h.restore();else if((D!==_||X!==z||m!==p||y!==x)&&F>0){var N=b+g+E;this.direction==="rtl"&&(N=this.width-N-F),_&&z&&(h.fillStyle=z,h.fillRect(N,S+le*p+x,F,this.fontSize/15)),E=P.left,F=P.width,_=D,z=X,p=m,x=y}else F+=P.kernedWidth;var N=b+g+E;this.direction==="rtl"&&(N=this.width-N-F),h.fillStyle=X,D&&X&&h.fillRect(N,S+le*p+x,F-ae,this.fontSize/15),k+=u}h.restore()}},_getFontDeclaration:function(h,f){var u=h||this,p=this.fontFamily,m=a.Text.genericFonts.indexOf(p.toLowerCase())>-1,g=p===void 0||p.indexOf("'")>-1||p.indexOf(",")>-1||p.indexOf('"')>-1||m?u.fontFamily:'"'+u.fontFamily+'"';return[a.isLikelyNode?u.fontWeight:u.fontStyle,a.isLikelyNode?u.fontStyle:u.fontWeight,f?this.CACHE_FONT_SIZE+"px":u.fontSize+"px",g].join(" ")},render:function(h){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",h)))},_splitTextIntoLines:function(h){for(var f=h.split(this._reNewline),u=new Array(f.length),p=[`
`],m=[],g=0;g<f.length;g++)u[g]=a.util.string.graphemeSplit(f[g]),m=m.concat(u[g],p);return m.pop(),{_unwrappedLines:u,lines:f,graphemeText:m,graphemeLines:u}},toObject:function(h){var f=d.concat(h),u=this.callSuper("toObject",f);return u.styles=a.util.stylesToArray(this.styles,this.text),u.path&&(u.path=this.path.toObject()),u},set:function(h,f){this.callSuper("set",h,f);var u=!1,p=!1;if(typeof h=="object")for(var m in h)m==="path"&&this.setPathInfo(),u=u||this._dimensionAffectingProps.indexOf(m)!==-1,p=p||m==="path";else u=this._dimensionAffectingProps.indexOf(h)!==-1,p=h==="path";return p&&this.setPathInfo(),u&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),a.Text.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),a.Text.DEFAULT_SVG_FONT_SIZE=16,a.Text.fromElement=function(h,f,u){if(!h)return f(null);var p=a.parseAttributes(h,a.Text.ATTRIBUTE_NAMES),m=p.textAnchor||"left";if(u=a.util.object.extend(u?c(u):{},p),u.top=u.top||0,u.left=u.left||0,p.textDecoration){var g=p.textDecoration;g.indexOf("underline")!==-1&&(u.underline=!0),g.indexOf("overline")!==-1&&(u.overline=!0),g.indexOf("line-through")!==-1&&(u.linethrough=!0),delete u.textDecoration}"dx"in p&&(u.left+=p.dx),"dy"in p&&(u.top+=p.dy),"fontSize"in u||(u.fontSize=a.Text.DEFAULT_SVG_FONT_SIZE);var x="";"textContent"in h?x=h.textContent:"firstChild"in h&&h.firstChild!==null&&"data"in h.firstChild&&h.firstChild.data!==null&&(x=h.firstChild.data),x=x.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var y=u.strokeWidth;u.strokeWidth=0;var w=new a.Text(x,u),_=w.getScaledHeight()/w.height,b=(w.height+w.strokeWidth)*w.lineHeight-w.height,k=b*_,S=w.getScaledHeight()+k,E=0;m==="center"&&(E=w.getScaledWidth()/2),m==="right"&&(E=w.getScaledWidth()),w.set({left:w.left-E,top:w.top-(S-w.fontSize*(.07+w._fontSizeFraction))/w.lineHeight,strokeWidth:typeof y<"u"?y:1}),f(w)},a.Text.fromObject=function(h,f){var u=c(h),p=h.path;return delete u.path,a.Object._fromObject("Text",u,function(m){m.styles=a.util.stylesFromArray(h.styles,h.text),p?a.Object._fromObject("Path",p,function(g){m.set("path",g),f(m)},"path"):f(m)},"text")},a.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],a.util.createAccessors&&a.util.createAccessors(a.Text)}(e),function(){t.util.object.extend(t.Text.prototype,{isEmptyStyles:function(o){if(!this.styles||typeof o<"u"&&!this.styles[o])return!0;var a=typeof o>"u"?this.styles:{line:this.styles[o]};for(var c in a)for(var d in a[c])for(var h in a[c][d])return!1;return!0},styleHas:function(o,a){if(!this.styles||!o||o===""||typeof a<"u"&&!this.styles[a])return!1;var c=typeof a>"u"?this.styles:{0:this.styles[a]};for(var d in c)for(var h in c[d])if(typeof c[d][h][o]<"u")return!0;return!1},cleanStyle:function(o){if(!this.styles||!o||o==="")return!1;var a=this.styles,c=0,d,h,f=!0,u=0,p;for(var m in a){d=0;for(var g in a[m]){var p=a[m][g],x=p.hasOwnProperty(o);c++,x?(h?p[o]!==h&&(f=!1):h=p[o],p[o]===this[o]&&delete p[o]):f=!1,Object.keys(p).length!==0?d++:delete a[m][g]}d===0&&delete a[m]}for(var y=0;y<this._textLines.length;y++)u+=this._textLines[y].length;f&&c===u&&(this[o]=h,this.removeStyle(o))},removeStyle:function(o){if(!(!this.styles||!o||o==="")){var a=this.styles,c,d,h;for(d in a){c=a[d];for(h in c)delete c[h][o],Object.keys(c[h]).length===0&&delete c[h];Object.keys(c).length===0&&delete a[d]}}},_extendStyles:function(o,a){var c=this.get2DCursorLocation(o);this._getLineStyle(c.lineIndex)||this._setLineStyle(c.lineIndex),this._getStyleDeclaration(c.lineIndex,c.charIndex)||this._setStyleDeclaration(c.lineIndex,c.charIndex,{}),t.util.object.extend(this._getStyleDeclaration(c.lineIndex,c.charIndex),a)},get2DCursorLocation:function(o,a){typeof o>"u"&&(o=this.selectionStart);for(var c=a?this._unwrappedTextLines:this._textLines,d=c.length,h=0;h<d;h++){if(o<=c[h].length)return{lineIndex:h,charIndex:o};o-=c[h].length+this.missingNewlineOffset(h,a)}return{lineIndex:h-1,charIndex:c[h-1].length<o?c[h-1].length:o}},getSelectionStyles:function(o,a,c){typeof o>"u"&&(o=this.selectionStart||0),typeof a>"u"&&(a=this.selectionEnd||o);for(var d=[],h=o;h<a;h++)d.push(this.getStyleAtPosition(h,c));return d},getStyleAtPosition:function(o,a){var c=this.get2DCursorLocation(o),d=a?this.getCompleteStyleDeclaration(c.lineIndex,c.charIndex):this._getStyleDeclaration(c.lineIndex,c.charIndex);return d||{}},setSelectionStyles:function(o,a,c){typeof a>"u"&&(a=this.selectionStart||0),typeof c>"u"&&(c=this.selectionEnd||a);for(var d=a;d<c;d++)this._extendStyles(d,o);return this._forceClearCache=!0,this},_getStyleDeclaration:function(o,a){var c=this.styles&&this.styles[o];return c?c[a]:null},getCompleteStyleDeclaration:function(o,a){for(var c=this._getStyleDeclaration(o,a)||{},d={},h,f=0;f<this._styleProperties.length;f++)h=this._styleProperties[f],d[h]=typeof c[h]>"u"?this[h]:c[h];return d},_setStyleDeclaration:function(o,a,c){this.styles[o][a]=c},_deleteStyleDeclaration:function(o,a){delete this.styles[o][a]},_getLineStyle:function(o){return!!this.styles[o]},_setLineStyle:function(o){this.styles[o]={}},_deleteLineStyle:function(o){delete this.styles[o]}})}(),function(){function o(a){a.textDecoration&&(a.textDecoration.indexOf("underline")>-1&&(a.underline=!0),a.textDecoration.indexOf("line-through")>-1&&(a.linethrough=!0),a.textDecoration.indexOf("overline")>-1&&(a.overline=!0),delete a.textDecoration)}t.IText=t.util.createClass(t.Text,t.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(a,c){this.callSuper("initialize",a,c),this.initBehavior()},setSelectionStart:function(a){a=Math.max(a,0),this._updateAndFire("selectionStart",a)},setSelectionEnd:function(a){a=Math.min(a,this.text.length),this._updateAndFire("selectionEnd",a)},_updateAndFire:function(a,c){this[a]!==c&&(this._fireSelectionChanged(),this[a]=c),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(a){this.clearContextTop(),this.callSuper("render",a),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(a){this.callSuper("_render",a)},clearContextTop:function(a){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var c=this.canvas.contextTop,d=this.canvas.viewportTransform;c.save(),c.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this.transform(c),this._clearTextArea(c),a||c.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var a=this._getCursorBoundaries(),c=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(a,c):this.renderSelection(a,c),c.restore()}},_clearTextArea:function(a){var c=this.width+4,d=this.height+4;a.clearRect(-c/2,-d/2,c,d)},_getCursorBoundaries:function(a){typeof a>"u"&&(a=this.selectionStart);var c=this._getLeftOffset(),d=this._getTopOffset(),h=this._getCursorBoundariesOffsets(a);return{left:c,top:d,leftOffset:h.left,topOffset:h.top}},_getCursorBoundariesOffsets:function(a){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var c,d,h,f=0,u=0,p,m=this.get2DCursorLocation(a);h=m.charIndex,d=m.lineIndex;for(var g=0;g<d;g++)f+=this.getHeightOfLine(g);c=this._getLineLeftOffset(d);var x=this.__charBounds[d][h];return x&&(u=x.left),this.charSpacing!==0&&h===this._textLines[d].length&&(u-=this._getWidthOfCharSpacing()),p={top:f,left:c+(u>0?u:0)},this.direction==="rtl"&&(p.left*=-1),this.cursorOffsetCache=p,this.cursorOffsetCache},renderCursor:function(a,c){var d=this.get2DCursorLocation(),h=d.lineIndex,f=d.charIndex>0?d.charIndex-1:0,u=this.getValueOfPropertyAt(h,f,"fontSize"),p=this.scaleX*this.canvas.getZoom(),m=this.cursorWidth/p,g=a.topOffset,x=this.getValueOfPropertyAt(h,f,"deltaY");g+=(1-this._fontSizeFraction)*this.getHeightOfLine(h)/this.lineHeight-u*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(a,c),c.fillStyle=this.cursorColor||this.getValueOfPropertyAt(h,f,"fill"),c.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,c.fillRect(a.left+a.leftOffset-m/2,g+a.top+x,m,u)},renderSelection:function(a,c){for(var d=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,h=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,f=this.textAlign.indexOf("justify")!==-1,u=this.get2DCursorLocation(d),p=this.get2DCursorLocation(h),m=u.lineIndex,g=p.lineIndex,x=u.charIndex<0?0:u.charIndex,y=p.charIndex<0?0:p.charIndex,w=m;w<=g;w++){var _=this._getLineLeftOffset(w)||0,b=this.getHeightOfLine(w),k=0,S=0,E=0;if(w===m&&(S=this.__charBounds[m][x].left),w>=m&&w<g)E=f&&!this.isEndOfWrapping(w)?this.width:this.getLineWidth(w)||5;else if(w===g)if(y===0)E=this.__charBounds[g][y].left;else{var F=this._getWidthOfCharSpacing();E=this.__charBounds[g][y-1].left+this.__charBounds[g][y-1].width-F}k=b,(this.lineHeight<1||w===g&&this.lineHeight>1)&&(b/=this.lineHeight);var P=a.left+_+S,D=E-S,I=b,X=0;this.inCompositionMode?(c.fillStyle=this.compositionColor||"black",I=1,X=b):c.fillStyle=this.selectionColor,this.direction==="rtl"&&(P=this.width-P-D),c.fillRect(P,a.top+a.topOffset+X,D,I),a.topOffset+=k}},getCurrentCharFontSize:function(){var a=this._getCurrentCharIndex();return this.getValueOfPropertyAt(a.l,a.c,"fontSize")},getCurrentCharColor:function(){var a=this._getCurrentCharIndex();return this.getValueOfPropertyAt(a.l,a.c,"fill")},_getCurrentCharIndex:function(){var a=this.get2DCursorLocation(this.selectionStart,!0),c=a.charIndex>0?a.charIndex-1:0;return{l:a.lineIndex,c}}}),t.IText.fromObject=function(a,c){var d=t.util.stylesFromArray(a.styles,a.text),h=Object.assign({},a,{styles:d});if(delete h.path,o(h),h.styles)for(var f in h.styles)for(var u in h.styles[f])o(h.styles[f][u]);t.Object._fromObject("IText",h,function(p){a.path?t.Object._fromObject("Path",a.path,function(m){p.set("path",m),c(p)},"path"):c(p)},"text")}}(),function(){var o=t.util.object.clone;t.util.object.extend(t.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var a=this;this.on("added",function(){var c=a.canvas;c&&(c._hasITextHandlers||(c._hasITextHandlers=!0,a._initCanvasHandlers(c)),c._iTextInstances=c._iTextInstances||[],c._iTextInstances.push(a))})},initRemovedHandler:function(){var a=this;this.on("removed",function(){var c=a.canvas;c&&(c._iTextInstances=c._iTextInstances||[],t.util.removeFromArray(c._iTextInstances,a),c._iTextInstances.length===0&&(c._hasITextHandlers=!1,a._removeCanvasHandlers(c)))})},_initCanvasHandlers:function(a){a._mouseUpITextHandler=function(){a._iTextInstances&&a._iTextInstances.forEach(function(c){c.__isMousedown=!1})},a.on("mouse:up",a._mouseUpITextHandler)},_removeCanvasHandlers:function(a){a.off("mouse:up",a._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(a,c,d,h){var f;return f={isAborted:!1,abort:function(){this.isAborted=!0}},a.animate("_currentCursorOpacity",c,{duration:d,onComplete:function(){f.isAborted||a[h]()},onChange:function(){a.canvas&&a.selectionStart===a.selectionEnd&&a.renderCursorOrSelection()},abort:function(){return f.isAborted}}),f},_onTickComplete:function(){var a=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){a._currentTickCompleteState=a._animateCursor(a,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(a){var c=this,d=a?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){c._tick()},d)},abortCursorAnimation:function(){var a=this._currentTickState||this._currentTickCompleteState,c=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,a&&c&&c.clearContext(c.contextTop||c.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(a){var c=0,d=a-1;if(this._reSpace.test(this._text[d]))for(;this._reSpace.test(this._text[d]);)c++,d--;for(;/\S/.test(this._text[d])&&d>-1;)c++,d--;return a-c},findWordBoundaryRight:function(a){var c=0,d=a;if(this._reSpace.test(this._text[d]))for(;this._reSpace.test(this._text[d]);)c++,d++;for(;/\S/.test(this._text[d])&&d<this._text.length;)c++,d++;return a+c},findLineBoundaryLeft:function(a){for(var c=0,d=a-1;!/\n/.test(this._text[d])&&d>-1;)c++,d--;return a-c},findLineBoundaryRight:function(a){for(var c=0,d=a;!/\n/.test(this._text[d])&&d<this._text.length;)c++,d++;return a+c},searchWordBoundary:function(a,c){for(var d=this._text,h=this._reSpace.test(d[a])?a-1:a,f=d[h],u=t.reNonWord;!u.test(f)&&h>0&&h<d.length;)h+=c,f=d[h];return u.test(f)&&(h+=c===1?0:1),h},selectWord:function(a){a=a||this.selectionStart;var c=this.searchWordBoundary(a,-1),d=this.searchWordBoundary(a,1);this.selectionStart=c,this.selectionEnd=d,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(a){a=a||this.selectionStart;var c=this.findLineBoundaryLeft(a),d=this.findLineBoundaryRight(a);return this.selectionStart=c,this.selectionEnd=d,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(a){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(a),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(a){a._iTextInstances&&a._iTextInstances.forEach(function(c){c.selected=!1,c.isEditing&&c.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(a){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var c=this.getSelectionStartFromPointer(a.e),d=this.selectionStart,h=this.selectionEnd;(c!==this.__selectionStartOnMouseDown||d===h)&&(d===c||h===c)||(c>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=c):(this.selectionStart=c,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==d||this.selectionEnd!==h)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(a,c,d){var h=d.slice(0,a),f=t.util.string.graphemeSplit(h).length;if(a===c)return{selectionStart:f,selectionEnd:f};var u=d.slice(a,c),p=t.util.string.graphemeSplit(u).length;return{selectionStart:f,selectionEnd:f+p}},fromGraphemeToStringSelection:function(a,c,d){var h=d.slice(0,a),f=h.join("").length;if(a===c)return{selectionStart:f,selectionEnd:f};var u=d.slice(a,c),p=u.join("").length;return{selectionStart:f,selectionEnd:f+p}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var a=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=a.selectionStart,this.hiddenTextarea.selectionEnd=a.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var a=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=a.selectionEnd,this.inCompositionMode||(this.selectionStart=a.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var a=this._calcTextareaPosition();this.hiddenTextarea.style.left=a.left,this.hiddenTextarea.style.top=a.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var a=this.inCompositionMode?this.compositionStart:this.selectionStart,c=this._getCursorBoundaries(a),d=this.get2DCursorLocation(a),h=d.lineIndex,f=d.charIndex,u=this.getValueOfPropertyAt(h,f,"fontSize")*this.lineHeight,p=c.leftOffset,m=this.calcTransformMatrix(),g={x:c.left+p,y:c.top+c.topOffset+u},x=this.canvas.getRetinaScaling(),y=this.canvas.upperCanvasEl,w=y.width/x,_=y.height/x,b=w-u,k=_-u,S=y.clientWidth/w,E=y.clientHeight/_;return g=t.util.transformPoint(g,m),g=t.util.transformPoint(g,this.canvas.viewportTransform),g.x*=S,g.y*=E,g.x<0&&(g.x=0),g.x>b&&(g.x=b),g.y<0&&(g.y=0),g.y>k&&(g.y=k),g.x+=this.canvas._offset.left,g.y+=this.canvas._offset.top,{left:g.x+"px",top:g.y+"px",fontSize:u+"px",charHeight:u}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var a=this._textBeforeEdit!==this.text,c=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,c&&(c.blur&&c.blur(),c.parentNode&&c.parentNode.removeChild(c)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),a&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),a&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var a in this.styles)this._textLines[a]||delete this.styles[a]},removeStyleFromTo:function(a,c){var d=this.get2DCursorLocation(a,!0),h=this.get2DCursorLocation(c,!0),f=d.lineIndex,u=d.charIndex,p=h.lineIndex,m=h.charIndex,g,x;if(f!==p){if(this.styles[f])for(g=u;g<this._unwrappedTextLines[f].length;g++)delete this.styles[f][g];if(this.styles[p])for(g=m;g<this._unwrappedTextLines[p].length;g++)x=this.styles[p][g],x&&(this.styles[f]||(this.styles[f]={}),this.styles[f][u+g-m]=x);for(g=f+1;g<=p;g++)delete this.styles[g];this.shiftLineStyles(p,f-p)}else if(this.styles[f]){x=this.styles[f];var y=m-u,w,_;for(g=u;g<m;g++)delete x[g];for(_ in this.styles[f])w=parseInt(_,10),w>=m&&(x[w-y]=x[_],delete x[_])}},shiftLineStyles:function(a,c){var d=o(this.styles);for(var h in this.styles){var f=parseInt(h,10);f>a&&(this.styles[f+c]=d[f],d[f-c]||delete this.styles[f])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(a,c,d,h){var f,u={},p=!1,m=this._unwrappedTextLines[a].length,g=m===c;d||(d=1),this.shiftLineStyles(a,d),this.styles[a]&&(f=this.styles[a][c===0?c:c-1]);for(var x in this.styles[a]){var y=parseInt(x,10);y>=c&&(p=!0,u[y-c]=this.styles[a][x],g&&c===0||delete this.styles[a][x])}var w=!1;for(p&&!g&&(this.styles[a+d]=u,w=!0),(w||m>c)&&d--;d>0;)h&&h[d-1]?this.styles[a+d]={0:o(h[d-1])}:f?this.styles[a+d]={0:o(f)}:delete this.styles[a+d],d--;this._forceClearCache=!0},insertCharStyleObject:function(a,c,d,h){this.styles||(this.styles={});var f=this.styles[a],u=f?o(f):{};d||(d=1);for(var p in u){var m=parseInt(p,10);m>=c&&(f[m+d]=u[m],u[m-d]||delete f[m])}if(this._forceClearCache=!0,h){for(;d--;)Object.keys(h[d]).length&&(this.styles[a]||(this.styles[a]={}),this.styles[a][c+d]=o(h[d]));return}if(f)for(var g=f[c?c-1:1];g&&d--;)this.styles[a][c+d]=o(g)},insertNewStyleBlock:function(a,c,d){for(var h=this.get2DCursorLocation(c,!0),f=[0],u=0,p=0;p<a.length;p++)a[p]===`
`?(u++,f[u]=0):f[u]++;f[0]>0&&(this.insertCharStyleObject(h.lineIndex,h.charIndex,f[0],d),d=d&&d.slice(f[0]+1)),u&&this.insertNewlineStyleObject(h.lineIndex,h.charIndex+f[0],u);for(var p=1;p<u;p++)f[p]>0?this.insertCharStyleObject(h.lineIndex+p,0,f[p],d):d&&this.styles[h.lineIndex+p]&&d[0]&&(this.styles[h.lineIndex+p][0]=d[0]),d=d&&d.slice(f[p]+1);f[p]>0&&this.insertCharStyleObject(h.lineIndex+p,0,f[p],d)},setSelectionStartEndWithShift:function(a,c,d){d<=a?(c===a?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=a),this.selectionStart=d):d>a&&d<c?this._selectionDirection==="right"?this.selectionEnd=d:this.selectionStart=d:(c===a?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=c),this.selectionEnd=d)},setSelectionInBoundaries:function(){var a=this.text.length;this.selectionStart>a?this.selectionStart=a:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>a?this.selectionEnd=a:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),t.util.object.extend(t.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(o){if(this.canvas){this.__newClickTime=+new Date;var a=o.pointer;this.isTripleClick(a)&&(this.fire("tripleclick",o),this._stopEvent(o.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=a,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(o){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===o.x&&this.__lastPointer.y===o.y},_stopEvent:function(o){o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(o){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(o.e))},tripleClickHandler:function(o){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(o.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(o){!this.canvas||!this.editable||o.e.button&&o.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(o.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(o){!this.canvas||!this.editable||o.e.button&&o.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(o){if(this.__isMousedown=!1,!(!this.editable||this.group||o.transform&&o.transform.actionPerformed||o.e.button&&o.e.button!==1)){if(this.canvas){var a=this.canvas._activeObject;if(a&&a!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(o.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(o){var a=this.getSelectionStartFromPointer(o),c=this.selectionStart,d=this.selectionEnd;o.shiftKey?this.setSelectionStartEndWithShift(c,d,a):(this.selectionStart=a,this.selectionEnd=a),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(o){for(var a=this.getLocalPointer(o),c=0,d=0,h=0,f=0,u=0,p,m,g=0,x=this._textLines.length;g<x&&h<=a.y;g++)h+=this.getHeightOfLine(g)*this.scaleY,u=g,g>0&&(f+=this._textLines[g-1].length+this.missingNewlineOffset(g-1));p=this._getLineLeftOffset(u),d=p*this.scaleX,m=this._textLines[u],this.direction==="rtl"&&(a.x=this.width*this.scaleX-a.x+d);for(var y=0,w=m.length;y<w&&(c=d,d+=this.__charBounds[u][y].kernedWidth*this.scaleX,d<=a.x);y++)f++;return this._getNewSelectionStartFromOffset(a,c,d,f,w)},_getNewSelectionStartFromOffset:function(o,a,c,d,h){var f=o.x-a,u=c-o.x,p=u>f||u<0?0:1,m=d+p;return this.flipX&&(m=h-m),m>this._text.length&&(m=this._text.length),m}}),t.util.object.extend(t.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=t.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var o=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+o.top+"; left: "+o.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+o.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):t.document.body.appendChild(this.hiddenTextarea),t.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),t.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),t.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),t.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(t.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(o){if(this.isEditing){var a=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(o.keyCode in a)this[a[o.keyCode]](o);else if(o.keyCode in this.ctrlKeysMapDown&&(o.ctrlKey||o.metaKey))this[this.ctrlKeysMapDown[o.keyCode]](o);else return;o.stopImmediatePropagation(),o.preventDefault(),o.keyCode>=33&&o.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(o){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(o.keyCode in this.ctrlKeysMapUp&&(o.ctrlKey||o.metaKey))this[this.ctrlKeysMapUp[o.keyCode]](o);else return;o.stopImmediatePropagation(),o.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(o){var a=this.fromPaste;if(this.fromPaste=!1,o&&o.stopPropagation(),!!this.isEditing){var c=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,d=this._text.length,h=c.length,f,u,p=h-d,m=this.selectionStart,g=this.selectionEnd,x=m!==g,y,w,_;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var b=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),k=m>b.selectionStart;x?(f=this._text.slice(m,g),p+=g-m):h<d&&(k?f=this._text.slice(g+p,g):f=this._text.slice(m,m-p)),u=c.slice(b.selectionEnd-p,b.selectionEnd),f&&f.length&&(u.length&&(y=this.getSelectionStyles(m,m+1,!1),y=u.map(function(){return y[0]})),x?(w=m,_=g):k?(w=g-f.length,_=g):(w=g,_=g+f.length),this.removeStyleFromTo(w,_)),u.length&&(a&&u.join("")===t.copiedText&&!t.disableStyleCopyPaste&&(y=t.copiedTextStyle),this.insertNewStyleBlock(u,m,y)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(o){this.compositionStart=o.target.selectionStart,this.compositionEnd=o.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(t.copiedText=this.getSelectedText(),t.disableStyleCopyPaste?t.copiedTextStyle=null:t.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(o){return o&&o.clipboardData||t.window.clipboardData},_getWidthBeforeCursor:function(o,a){var c=this._getLineLeftOffset(o),d;return a>0&&(d=this.__charBounds[o][a-1],c+=d.left+d.width),c},getDownCursorOffset:function(o,a){var c=this._getSelectionForOffset(o,a),d=this.get2DCursorLocation(c),h=d.lineIndex;if(h===this._textLines.length-1||o.metaKey||o.keyCode===34)return this._text.length-c;var f=d.charIndex,u=this._getWidthBeforeCursor(h,f),p=this._getIndexOnLine(h+1,u),m=this._textLines[h].slice(f);return m.length+p+1+this.missingNewlineOffset(h)},_getSelectionForOffset:function(o,a){return o.shiftKey&&this.selectionStart!==this.selectionEnd&&a?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(o,a){var c=this._getSelectionForOffset(o,a),d=this.get2DCursorLocation(c),h=d.lineIndex;if(h===0||o.metaKey||o.keyCode===33)return-c;var f=d.charIndex,u=this._getWidthBeforeCursor(h,f),p=this._getIndexOnLine(h-1,u),m=this._textLines[h].slice(0,f),g=this.missingNewlineOffset(h-1);return-this._textLines[h-1].length+p-m.length+(1-g)},_getIndexOnLine:function(o,a){for(var c=this._textLines[o],d=this._getLineLeftOffset(o),h=d,f=0,u,p,m=0,g=c.length;m<g;m++)if(u=this.__charBounds[o][m].width,h+=u,h>a){p=!0;var x=h-u,y=h,w=Math.abs(x-a),_=Math.abs(y-a);f=_<w?m:m-1;break}return p||(f=c.length-1),f},moveCursorDown:function(o){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",o)},moveCursorUp:function(o){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",o)},_moveCursorUpOrDown:function(o,a){var c="get"+o+"CursorOffset",d=this[c](a,this._selectionDirection==="right");a.shiftKey?this.moveCursorWithShift(d):this.moveCursorWithoutShift(d),d!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(o){var a=this._selectionDirection==="left"?this.selectionStart+o:this.selectionEnd+o;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,a),o!==0},moveCursorWithoutShift:function(o){return o<0?(this.selectionStart+=o,this.selectionEnd=this.selectionStart):(this.selectionEnd+=o,this.selectionStart=this.selectionEnd),o!==0},moveCursorLeft:function(o){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",o)},_move:function(o,a,c){var d;if(o.altKey)d=this["findWordBoundary"+c](this[a]);else if(o.metaKey||o.keyCode===35||o.keyCode===36)d=this["findLineBoundary"+c](this[a]);else return this[a]+=c==="Left"?-1:1,!0;if(typeof d<"u"&&this[a]!==d)return this[a]=d,!0},_moveLeft:function(o,a){return this._move(o,a,"Left")},_moveRight:function(o,a){return this._move(o,a,"Right")},moveCursorLeftWithoutShift:function(o){var a=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(a=this._moveLeft(o,"selectionStart")),this.selectionEnd=this.selectionStart,a},moveCursorLeftWithShift:function(o){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(o,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(o,"selectionStart")},moveCursorRight:function(o){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",o)},_moveCursorLeftOrRight:function(o,a){var c="moveCursor"+o+"With";this._currentCursorOpacity=1,a.shiftKey?c+="Shift":c+="outShift",this[c](a)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(o){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(o,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(o,"selectionEnd")},moveCursorRightWithoutShift:function(o){var a=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(a=this._moveRight(o,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,a},removeChars:function(o,a){typeof a>"u"&&(a=o+1),this.removeStyleFromTo(o,a),this._text.splice(o,a-o),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(o,a,c,d){typeof d>"u"&&(d=c),d>c&&this.removeStyleFromTo(c,d);var h=t.util.string.graphemeSplit(o);this.insertNewStyleBlock(h,c,a),this._text=[].concat(this._text.slice(0,c),h,this._text.slice(d)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var o=t.util.toFixed,a=t.util.radiansToDegrees,c=t.util.calcRotateMatrix,d=t.util.transformPoint,h=/  +/g;t.util.object.extend(t.Text.prototype,{_toSVG:function(){var f=this._getSVGLeftTopOffsets(),u=this._getSVGTextAndBg(f.textTop,f.textLeft);return this._wrapSVGTextAndBg(u)},toSVG:function(f){var u=this._createBaseSVGMarkup(this._toSVG(),{reviver:f,noStyle:!0,withShadow:!0}),p=this.path;return p?u+p._createBaseSVGMarkup(p._toSVG(),{reviver:f,withShadow:!0}):u},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(f){var u=!0,p=this.getSvgTextDecoration(this);return[f.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",p?'text-decoration="'+p+'" ':"",'style="',this.getSvgStyles(u),'"',this.addPaintOrder()," >",f.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(f,u){var p=[],m=[],g=f,x;this._setSVGBg(m);for(var y=0,w=this._textLines.length;y<w;y++)x=this._getLineLeftOffset(y),(this.textBackgroundColor||this.styleHas("textBackgroundColor",y))&&this._setSVGTextLineBg(m,y,u+x,g),this._setSVGTextLineText(p,y,u+x,g),g+=this.getHeightOfLine(y);return{textSpans:p,textBgRects:m}},_createTextCharSpan:function(f,u,p,m,g){var x=f!==f.trim()||f.match(h),y=this.getSvgSpanStyles(u,x),w=y?'style="'+y+'"':"",_=u.deltaY,b="",k=t.Object.NUM_FRACTION_DIGITS,S="";if(_&&(b=' dy="'+o(_,k)+'" '),g.renderLeft!==void 0){var E=g.angle;S=' rotate="'+o(a(E),t.Object.NUM_FRACTION_DIGITS)+'" ';var F=g.width/2,P=c({angle:a(E)});P[4]=g.renderLeft,P[5]=g.renderTop;var D=d({x:-F,y:0},P);p=D.x,m=D.y}return['<tspan x="',o(p,k),'" y="',o(m,k),'" ',b,w,S,">",t.util.string.escapeXml(f),"</tspan>"].join("")},_setSVGTextLineText:function(f,u,p,m){var g=this.getHeightOfLine(u),x=this.textAlign.indexOf("justify")!==-1,y,w,_="",b,k,S=0,E=this._textLines[u],F;m+=g*(1-this._fontSizeFraction)/this.lineHeight;for(var P=0,D=E.length-1;P<=D;P++)F=P===D||this.charSpacing||this.path,_+=E[P],b=this.__charBounds[u][P],S===0?(p+=b.kernedWidth-b.width,S+=b.width):S+=b.kernedWidth,x&&!F&&this._reSpaceAndTab.test(E[P])&&(F=!0),F||(y=y||this.getCompleteStyleDeclaration(u,P),w=this.getCompleteStyleDeclaration(u,P+1),F=t.util.hasStyleChanged(y,w,!0)),F&&(k=this._getStyleDeclaration(u,P)||{},f.push(this._createTextCharSpan(_,k,p,m,b)),_="",y=w,p+=S,S=0)},_pushTextBgRect:function(f,u,p,m,g,x){var y=t.Object.NUM_FRACTION_DIGITS;f.push("		<rect ",this._getFillAttributes(u),' x="',o(p,y),'" y="',o(m,y),'" width="',o(g,y),'" height="',o(x,y),`"></rect>
`)},_setSVGTextLineBg:function(f,u,p,m){for(var g=this._textLines[u],x=this.getHeightOfLine(u)/this.lineHeight,y=0,w=0,_,b,k=this.getValueOfPropertyAt(u,0,"textBackgroundColor"),S=0,E=g.length;S<E;S++)_=this.__charBounds[u][S],b=this.getValueOfPropertyAt(u,S,"textBackgroundColor"),b!==k?(k&&this._pushTextBgRect(f,k,p+w,m,y,x),w=_.left,y=_.width,k=b):y+=_.kernedWidth;b&&this._pushTextBgRect(f,b,p+w,m,y,x)},_getFillAttributes:function(f){var u=f&&typeof f=="string"?new t.Color(f):"";return!u||!u.getSource()||u.getAlpha()===1?'fill="'+f+'"':'opacity="'+u.getAlpha()+'" fill="'+u.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(f){for(var u=0,p=0,m=0;m<f;m++)u+=this.getHeightOfLine(m);return p=this.getHeightOfLine(m),{lineTop:u,offset:(this._fontSizeMult-this._fontSizeFraction)*p/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(f){var u=t.Object.prototype.getSvgStyles.call(this,f);return u+" white-space: pre;"}})}(),function(o){var a=o.fabric||(o.fabric={});a.Textbox=a.util.createClass(a.IText,a.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:a.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(c){for(var d=0,h=0,f=0,u={},p=0;p<c.graphemeLines.length;p++)c.graphemeText[f]===`
`&&p>0?(h=0,f++,d++):!this.splitByGrapheme&&this._reSpaceAndTab.test(c.graphemeText[f])&&p>0&&(h++,f++),u[p]={line:d,offset:h},f+=c.graphemeLines[p].length,h+=c.graphemeLines[p].length;return u},styleHas:function(c,d){if(this._styleMap&&!this.isWrapping){var h=this._styleMap[d];h&&(d=h.line)}return a.Text.prototype.styleHas.call(this,c,d)},isEmptyStyles:function(c){if(!this.styles)return!0;var d=0,h=c+1,f,u,p=!1,m=this._styleMap[c],g=this._styleMap[c+1];m&&(c=m.line,d=m.offset),g&&(h=g.line,p=h===c,f=g.offset),u=typeof c>"u"?this.styles:{line:this.styles[c]};for(var x in u)for(var y in u[x])if(y>=d&&(!p||y<f))for(var w in u[x][y])return!1;return!0},_getStyleDeclaration:function(c,d){if(this._styleMap&&!this.isWrapping){var h=this._styleMap[c];if(!h)return null;c=h.line,d=h.offset+d}return this.callSuper("_getStyleDeclaration",c,d)},_setStyleDeclaration:function(c,d,h){var f=this._styleMap[c];c=f.line,d=f.offset+d,this.styles[c][d]=h},_deleteStyleDeclaration:function(c,d){var h=this._styleMap[c];c=h.line,d=h.offset+d,delete this.styles[c][d]},_getLineStyle:function(c){var d=this._styleMap[c];return!!this.styles[d.line]},_setLineStyle:function(c){var d=this._styleMap[c];this.styles[d.line]={}},_wrapText:function(c,d){var h=[],f;for(this.isWrapping=!0,f=0;f<c.length;f++)h=h.concat(this._wrapLine(c[f],f,d));return this.isWrapping=!1,h},_measureWord:function(c,d,h){var f=0,u,p=!0;h=h||0;for(var m=0,g=c.length;m<g;m++){var x=this._getGraphemeBox(c[m],d,m+h,u,p);f+=x.kernedWidth,u=c[m]}return f},_wrapLine:function(c,d,h,P){var u=0,p=this.splitByGrapheme,m=[],g=[],x=p?a.util.string.graphemeSplit(c):c.split(this._wordJoiners),y="",w=0,_=p?"":" ",b=0,k=0,S=0,E=!0,F=this._getWidthOfCharSpacing(),P=P||0;x.length===0&&x.push([]),h-=P;for(var D=0;D<x.length;D++)y=p?x[D]:a.util.string.graphemeSplit(x[D]),b=this._measureWord(y,d,w),w+=y.length,u+=k+b-F,u>h&&!E?(m.push(g),g=[],u=b,E=!0):u+=F,!E&&!p&&g.push(_),g=g.concat(y),k=p?0:this._measureWord([_],d,w),w++,E=!1,b>S&&(S=b);return D&&m.push(g),S+P>this.dynamicMinWidth&&(this.dynamicMinWidth=S-F+P),m},isEndOfWrapping:function(c){return!this._styleMap[c+1]||this._styleMap[c+1].line!==this._styleMap[c].line},missingNewlineOffset:function(c,d){return this.splitByGrapheme&&!d?this.isEndOfWrapping(c)?1:0:1},_splitTextIntoLines:function(c){for(var d=a.Text.prototype._splitTextIntoLines.call(this,c),h=this._wrapText(d.lines,this.width),f=new Array(h.length),u=0;u<h.length;u++)f[u]=h[u].join("");return d.lines=f,d.graphemeLines=h,d},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var c={};for(var d in this._styleMap)this._textLines[d]&&(c[this._styleMap[d].line]=1);for(var d in this.styles)c[d]||delete this.styles[d]},toObject:function(c){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(c))}}),a.Textbox.fromObject=function(c,d){var h=a.util.stylesFromArray(c.styles,c.text),f=Object.assign({},c,{styles:h});return delete f.path,a.Object._fromObject("Textbox",f,function(u){c.path?a.Object._fromObject("Path",c.path,function(p){u.set("path",p),d(u)},"path"):d(u)},"text")}}(e),function(){var o=t.controlsUtils,a=o.scaleSkewCursorStyleHandler,c=o.scaleCursorStyleHandler,d=o.scalingEqually,h=o.scalingYOrSkewingX,f=o.scalingXOrSkewingY,u=o.scaleOrSkewActionName,p=t.Object.prototype.controls;if(p.ml=new t.Control({x:-.5,y:0,cursorStyleHandler:a,actionHandler:f,getActionName:u}),p.mr=new t.Control({x:.5,y:0,cursorStyleHandler:a,actionHandler:f,getActionName:u}),p.mb=new t.Control({x:0,y:.5,cursorStyleHandler:a,actionHandler:h,getActionName:u}),p.mt=new t.Control({x:0,y:-.5,cursorStyleHandler:a,actionHandler:h,getActionName:u}),p.tl=new t.Control({x:-.5,y:-.5,cursorStyleHandler:c,actionHandler:d}),p.tr=new t.Control({x:.5,y:-.5,cursorStyleHandler:c,actionHandler:d}),p.bl=new t.Control({x:-.5,y:.5,cursorStyleHandler:c,actionHandler:d}),p.br=new t.Control({x:.5,y:.5,cursorStyleHandler:c,actionHandler:d}),p.mtr=new t.Control({x:0,y:-.5,actionHandler:o.rotationWithSnapping,cursorStyleHandler:o.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),t.Textbox){var m=t.Textbox.prototype.controls={};m.mtr=p.mtr,m.tr=p.tr,m.br=p.br,m.tl=p.tl,m.bl=p.bl,m.mt=p.mt,m.mb=p.mb,m.mr=new t.Control({x:.5,y:0,actionHandler:o.changeWidth,cursorStyleHandler:a,actionName:"resizing"}),m.ml=new t.Control({x:-.5,y:0,actionHandler:o.changeWidth,cursorStyleHandler:a,actionName:"resizing"})}}()})(Ke);function ff(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function dC(e,t,r,n){function i(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function o(d){try{c(n.next(d))}catch(h){l(h)}}function a(d){try{c(n.throw(d))}catch(h){l(h)}}function c(d){d.done?s(d.value):i(d.value).then(o,a)}c((n=n.apply(e,t||[])).next())})}const pC=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class V0 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class gC extends V0{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class tm extends V0{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class rm extends V0{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var bd;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(bd||(bd={}));class mC{constructor(t,{headers:r={},customFetch:n,region:i=bd.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=pC(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return dC(this,arguments,void 0,function*(r,n={}){var i;let s,l;try{const{headers:o,method:a,body:c,signal:d,timeout:h}=n;let f={},{region:u}=n;u||(u=this.region);const p=new URL(`${this.url}/${r}`);u&&u!=="any"&&(f["x-region"]=u,p.searchParams.set("forceFunctionRegion",u));let m;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",m=c):typeof c=="string"?(f["Content-Type"]="text/plain",m=c):typeof FormData<"u"&&c instanceof FormData?m=c:(f["Content-Type"]="application/json",m=JSON.stringify(c)):c&&typeof c!="string"&&!(typeof Blob<"u"&&c instanceof Blob)&&!(c instanceof ArrayBuffer)&&!(typeof FormData<"u"&&c instanceof FormData)?m=JSON.stringify(c):m=c;let g=d;h&&(l=new AbortController,s=setTimeout(()=>l.abort(),h),d?(g=l.signal,d.addEventListener("abort",()=>l.abort())):g=l.signal);const x=yield this.fetch(p.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),o),body:m,signal:g}).catch(b=>{throw new gC(b)}),y=x.headers.get("x-relay-error");if(y&&y==="true")throw new tm(x);if(!x.ok)throw new rm(x);let w=((i=x.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),_;return w==="application/json"?_=yield x.json():w==="application/octet-stream"||w==="application/pdf"?_=yield x.blob():w==="text/event-stream"?_=x:w==="multipart/form-data"?_=yield x.formData():_=yield x.text(),{data:_,error:null,response:x}}catch(o){return{data:null,error:o,response:o instanceof rm||o instanceof tm?o.context:void 0}}finally{s&&clearTimeout(s)}})}}var xC=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},vC=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{let l=null,o=null,a=null,c=s.status,d=s.statusText;if(s.ok){var h,f;if(r.method!=="HEAD"){var u;const x=await s.text();x===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((u=r.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?o=x:o=JSON.parse(x))}const m=(h=r.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),g=(f=s.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");m&&g&&g.length>1&&(a=parseInt(g[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(o)&&(o.length>1?(l={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,a=null,c=406,d="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var p;const m=await s.text();try{l=JSON.parse(m),Array.isArray(l)&&s.status===404&&(o=[],l=null,c=200,d="OK")}catch{s.status===404&&m===""?(c=204,d="No Content"):l={message:m}}if(l&&r.isMaybeSingle&&(!(l==null||(p=l.details)===null||p===void 0)&&p.includes("0 rows"))&&(l=null,c=200,d="OK"),l&&r.shouldThrowOnError)throw new xC(l)}return{error:l,data:o,count:a,status:c,statusText:d}});return this.shouldThrowOnError||(i=i.catch(s=>{var l;let o="";const a=s==null?void 0:s.cause;if(a){var c,d,h,f;const p=(c=a==null?void 0:a.message)!==null&&c!==void 0?c:"",m=(d=a==null?void 0:a.code)!==null&&d!==void 0?d:"";o=`${(h=s==null?void 0:s.name)!==null&&h!==void 0?h:"FetchError"}: ${s==null?void 0:s.message}`,o+=`

Caused by: ${(f=a==null?void 0:a.name)!==null&&f!==void 0?f:"Error"}: ${p}`,m&&(o+=` (${m})`),a!=null&&a.stack&&(o+=`
${a.stack}`)}else{var u;o=(u=s==null?void 0:s.stack)!==null&&u!==void 0?u:""}return{error:{message:`${(l=s==null?void 0:s.name)!==null&&l!==void 0?l:"FetchError"}: ${s==null?void 0:s.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}},yC=class extends vC{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const s=i?`${i}.order`:"order",l=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"offset":`${n}.offset`,s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(s,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:s="text"}={}){var l;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),a=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${s}; for="${a}"; options=${o};`),s==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const nm=new RegExp("[,()]");var ga=class extends yC{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&nm.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&nm.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const s=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${s}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},wC=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:n}=t??{},i=r?"HEAD":"GET";let s=!1;const l=(e??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join(""),{url:o,headers:a}=this.cloneRequestState();return o.searchParams.set("select",l),n&&a.append("Prefer",`count=${n}`),new ga({method:i,url:o,headers:a,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const i="POST",{url:s,headers:l}=this.cloneRequestState();if(t&&l.append("Prefer",`count=${t}`),r||l.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((a,c)=>a.concat(Object.keys(c)),[]);if(o.length>0){const a=[...new Set(o)].map(c=>`"${c}"`);s.searchParams.set("columns",a.join(","))}}return new ga({method:i,url:s,headers:l,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){var s;const l="POST",{url:o,headers:a}=this.cloneRequestState();if(a.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&o.searchParams.set("on_conflict",t),n&&a.append("Prefer",`count=${n}`),i||a.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(c.length>0){const d=[...new Set(c)].map(h=>`"${h}"`);o.searchParams.set("columns",d.join(","))}}return new ga({method:l,url:o,headers:a,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}update(e,{count:t}={}){var r;const n="PATCH",{url:i,headers:s}=this.cloneRequestState();return t&&s.append("Prefer",`count=${t}`),new ga({method:n,url:i,headers:s,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:n,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new ga({method:r,url:n,headers:i,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},_C=class iy{constructor(t,{headers:r={},schema:n,fetch:i}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=i}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new wC(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new iy(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:i=!1,count:s}={}){var l;let o;const a=new URL(`${this.url}/rpc/${t}`);let c;const d=u=>u!==null&&typeof u=="object"&&(!Array.isArray(u)||u.some(d)),h=n&&Object.values(r).some(d);h?(o="POST",c=r):n||i?(o=n?"HEAD":"GET",Object.entries(r).filter(([u,p])=>p!==void 0).map(([u,p])=>[u,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([u,p])=>{a.searchParams.append(u,p)})):(o="POST",c=r);const f=new Headers(this.headers);return h?f.set("Prefer",s?`count=${s},return=minimal`:"return=minimal"):s&&f.set("Prefer",`count=${s}`),new ga({method:o,url:a,headers:f,schema:this.schemaName,body:c,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}};class bC{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const n=r.versions;if(n&&n.node){const i=n.node,s=parseInt(i.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const kC="2.93.1",SC=`realtime-js/${kC}`,CC="1.0.0",sy="2.0.0",im=sy,kd=1e4,TC=1e3,EC=100;var Di;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Di||(Di={}));var nr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(nr||(nr={}));var Pn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Pn||(Pn={}));var Sd;(function(e){e.websocket="websocket"})(Sd||(Sd={}));var ys;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(ys||(ys={}));class NC{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},l=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(t,r,n){var i,s;const l=t.topic,o=(i=t.ref)!==null&&i!==void 0?i:"",a=(s=t.join_ref)!==null&&s!==void 0?s:"",c=t.payload.event,d=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},h=Object.keys(d).length===0?"":JSON.stringify(d);if(a.length>255)throw new Error(`joinRef length ${a.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+a.length+o.length+l.length+c.length+h.length,u=new ArrayBuffer(this.HEADER_LENGTH+f);let p=new DataView(u),m=0;p.setUint8(m++,this.KINDS.userBroadcastPush),p.setUint8(m++,a.length),p.setUint8(m++,o.length),p.setUint8(m++,l.length),p.setUint8(m++,c.length),p.setUint8(m++,h.length),p.setUint8(m++,r),Array.from(a,x=>p.setUint8(m++,x.charCodeAt(0))),Array.from(o,x=>p.setUint8(m++,x.charCodeAt(0))),Array.from(l,x=>p.setUint8(m++,x.charCodeAt(0))),Array.from(c,x=>p.setUint8(m++,x.charCodeAt(0))),Array.from(h,x=>p.setUint8(m++,x.charCodeAt(0)));var g=new Uint8Array(u.byteLength+n.byteLength);return g.set(new Uint8Array(u),0),g.set(new Uint8Array(n),u.byteLength),g.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[i,s,l,o,a]=n;return r({join_ref:i,ref:s,topic:l,event:o,payload:a})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,i)}}_decodeUserBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2),l=r.getUint8(3),o=r.getUint8(4);let a=this.HEADER_LENGTH+4;const c=n.decode(t.slice(a,a+i));a=a+i;const d=n.decode(t.slice(a,a+s));a=a+s;const h=n.decode(t.slice(a,a+l));a=a+l;const f=t.slice(a,t.byteLength),u=o===this.JSON_ENCODING?JSON.parse(n.decode(f)):f,p={type:this.BROADCAST_EVENT,event:d,payload:u};return l>0&&(p.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class ay{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var yt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(yt||(yt={}));const sm=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((s,l)=>(s[l]=AC(l,e,t,i),s),{}):{}},AC=(e,t,r,n)=>{const i=t.find(o=>o.name===e),s=i==null?void 0:i.type,l=r[e];return s&&!n.includes(s)?oy(s,l):Cd(l)},oy=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return PC(t,r)}switch(e){case yt.bool:return OC(t);case yt.float4:case yt.float8:case yt.int2:case yt.int4:case yt.int8:case yt.numeric:case yt.oid:return FC(t);case yt.json:case yt.jsonb:return jC(t);case yt.timestamp:return DC(t);case yt.abstime:case yt.date:case yt.daterange:case yt.int4range:case yt.int8range:case yt.money:case yt.reltime:case yt.text:case yt.time:case yt.timestamptz:case yt.timetz:case yt.tsrange:case yt.tstzrange:return Cd(t);default:return Cd(t)}},Cd=e=>e,OC=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},FC=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},jC=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},PC=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const l=e.slice(1,r);try{s=JSON.parse("["+l+"]")}catch{s=l?l.split(","):[]}return s.map(o=>oy(t,o))}return e},DC=e=>typeof e=="string"?e.replace(" ","T"):e,ly=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class ih{constructor(t,r,n={},i=kd){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var am;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(am||(am={}));class Vo{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:l,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Vo.syncState(this.state,i,s,l),this.pendingDiffs.forEach(a=>{this.state=Vo.syncDiff(this.state,a,s,l)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:l,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Vo.syncDiff(this.state,i,s,l),o())}),this.onJoin((i,s,l)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:l})}),this.onLeave((i,s,l)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const s=this.cloneDeep(t),l=this.transformState(r),o={},a={};return this.map(s,(c,d)=>{l[c]||(a[c]=d)}),this.map(l,(c,d)=>{const h=s[c];if(h){const f=d.map(g=>g.presence_ref),u=h.map(g=>g.presence_ref),p=d.filter(g=>u.indexOf(g.presence_ref)<0),m=h.filter(g=>f.indexOf(g.presence_ref)<0);p.length>0&&(o[c]=p),m.length>0&&(a[c]=m)}else o[c]=d}),this.syncDiff(s,{joins:o,leaves:a},n,i)}static syncDiff(t,r,n,i){const{joins:s,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(o,a)=>{var c;const d=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(a),d.length>0){const h=t[o].map(u=>u.presence_ref),f=d.filter(u=>h.indexOf(u.presence_ref)<0);t[o].unshift(...f)}n(o,d,a)}),this.map(l,(o,a)=>{let c=t[o];if(!c)return;const d=a.map(h=>h.presence_ref);c=c.filter(h=>d.indexOf(h.presence_ref)<0),t[o]=c,i(o,c,a),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var om;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(om||(om={}));var Xo;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Xo||(Xo={}));var oi;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(oi||(oi={}));class Fa{constructor(t,r={config:{}},n){var i,s;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=nr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new ih(this,Pn.join,this.params,this.timeout),this.rejoinTimer=new ay(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=nr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=nr.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=nr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=nr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=nr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Pn.reply,{},(l,o)=>{this._trigger(this._replyEventName(o),l)}),this.presence=new Vo(this),this.broadcastEndpointURL=ly(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==nr.closed){const{config:{broadcast:l,presence:o,private:a}}=this.params,c=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&i!==void 0?i:[],d=!!this.bindings[Xo.PRESENCE]&&this.bindings[Xo.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,h={},f={broadcast:l,presence:Object.assign(Object.assign({},o),{enabled:d}),postgres_changes:c,private:a};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(u=>t==null?void 0:t(oi.CHANNEL_ERROR,u)),this._onClose(()=>t==null?void 0:t(oi.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var p;if(this.socket._isManualToken()||this.socket.setAuth(),u===void 0){t==null||t(oi.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,g=(p=m==null?void 0:m.length)!==null&&p!==void 0?p:0,x=[];for(let y=0;y<g;y++){const w=m[y],{filter:{event:_,schema:b,table:k,filter:S}}=w,E=u&&u[y];if(E&&E.event===_&&Fa.isFilterValueEqual(E.schema,b)&&Fa.isFilterValueEqual(E.table,k)&&Fa.isFilterValueEqual(E.filter,S))x.push(Object.assign(Object.assign({},w),{id:E.id}));else{this.unsubscribe(),this.state=nr.errored,t==null||t(oi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(oi.SUBSCRIBED);return}}).receive("error",u=>{this.state=nr.errored,t==null||t(oi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(oi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===nr.joined&&t===Xo.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var i;if(r==null)return Promise.reject("Payload is required for httpSend()");const s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(o.status===202)return{success:!0};let a=o.statusText;try{const c=await o.json();a=c.error||c.message||a}catch{}return Promise.reject(new Error(a))}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:l}=t,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:l,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var l,o,a;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((a=(o=(l=this.params)===null||l===void 0?void 0:l.config)===null||o===void 0?void 0:o.broadcast)===null||a===void 0)&&a.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=nr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Pn.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new ih(this,Pn.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=nr.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),l}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new ih(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>EC){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,s;const l=t.toLocaleLowerCase(),{close:o,error:a,leave:c,join:d}=Pn;if(n&&[o,a,c,d].indexOf(l)>=0&&n!==this._joinRef())return;let f=this._onMessage(l,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(u=>{var p,m,g;return((p=u.filter)===null||p===void 0?void 0:p.event)==="*"||((g=(m=u.filter)===null||m===void 0?void 0:m.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===l}).map(u=>u.callback(f,n)):(s=this.bindings[l])===null||s===void 0||s.filter(u=>{var p,m,g,x,y,w;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in u){const _=u.id,b=(p=u.filter)===null||p===void 0?void 0:p.event;return _&&((m=r.ids)===null||m===void 0?void 0:m.includes(_))&&(b==="*"||(b==null?void 0:b.toLocaleLowerCase())===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const _=(y=(x=u==null?void 0:u.filter)===null||x===void 0?void 0:x.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return _==="*"||_===((w=r==null?void 0:r.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return u.type.toLocaleLowerCase()===l}).map(u=>{if(typeof f=="object"&&"ids"in f){const p=f.data,{schema:m,table:g,commit_timestamp:x,type:y,errors:w}=p;f=Object.assign(Object.assign({},{schema:m,table:g,commit_timestamp:x,eventType:y,new:{},old:{},errors:w}),this._getPayloadRecords(p))}u.callback(f,n)})}_isClosed(){return this.state===nr.closed}_isJoined(){return this.state===nr.joined}_isJoining(){return this.state===nr.joining}_isLeaving(){return this.state===nr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Fa.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Pn.close,{},t)}_onError(t){this._on(Pn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=nr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=sm(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=sm(t.columns,t.old_record)),r}}const sh=()=>{},Sc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},RC=[1e3,2e3,5e3,1e4],IC=1e4,MC=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class LC{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=kd,this.transport=null,this.heartbeatIntervalMs=Sc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=sh,this.ref=0,this.reconnectTimer=null,this.vsn=im,this.logger=sh,this.conn=null,this.sendBuffer=[],this.serializer=new NC,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=i=>i?(...s)=>i(...s):(...s)=>fetch(...s),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Sd.websocket}`,this.httpEndpoint=ly(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=bC.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Di.connecting:return ys.Connecting;case Di.open:return ys.Open;case Di.closing:return ys.Closing;default:return ys.Closed}}isConnected(){return this.connectionState()===ys.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new Fa(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:i,ref:s}=t,l=()=>{this.encode(t,o=>{var a;(a=this.conn)===null||a===void 0||a.send(o)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(TC,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Sc.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const c=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",c)}catch(d){this.log("error","error in heartbeat callback",d)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:i,payload:s,ref:l}=r,o=l?`(${l})`:"",a=s.status||"";this.log("receive",`${a} ${n} ${i} ${o}`.trim(),s),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(i,s,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===Di.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Di.open||this.conn.readyState===Di.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t);try{this.heartbeatCallback("error")}catch(r){this.log("error","error in heartbeat callback",r)}}_triggerChanError(){this.channels.forEach(t=>t._trigger(Pn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([MC],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(i=>{const s={access_token:r,version:SC};r&&i.updateJoinPayload(s),i.joinedOnce&&i._isJoined()&&i._push(Pn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new ay(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Sc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,s,l,o,a,c,d,h,f,u;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:kd,this.heartbeatIntervalMs=(i=t==null?void 0:t.heartbeatIntervalMs)!==null&&i!==void 0?i:Sc.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(l=t==null?void 0:t.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:sh,this.vsn=(a=t==null?void 0:t.vsn)!==null&&a!==void 0?a:im,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:p=>RC[p-1]||IC,this.vsn){case CC:this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(p,m)=>m(JSON.stringify(p)),this.decode=(h=t==null?void 0:t.decode)!==null&&h!==void 0?h:(p,m)=>m(JSON.parse(p));break;case sy:this.encode=(f=t==null?void 0:t.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var bl=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function BC(e,t,r){const n=new URL(t,e);if(r)for(const[i,s]of Object.entries(r))s!==void 0&&n.searchParams.set(i,s);return n.toString()}async function UC(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function WC(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:i,body:s,headers:l}){const o=BC(e.baseUrl,n,i),a=await UC(e.auth),c=await t(o,{method:r,headers:{...s?{"Content-Type":"application/json"}:{},...a,...l},body:s?JSON.stringify(s):void 0}),d=await c.text(),h=(c.headers.get("content-type")||"").includes("application/json"),f=h&&d?JSON.parse(d):d;if(!c.ok){const u=h?f:void 0,p=u==null?void 0:u.error;throw new bl((p==null?void 0:p.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:p==null?void 0:p.type,icebergCode:p==null?void 0:p.code,details:u})}return{status:c.status,headers:c.headers,data:f}}}}function Cc(e){return e.join("")}var zC=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:Cc(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Cc(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Cc(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Cc(e.namespace)}`}),!0}catch(t){if(t instanceof bl&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof bl&&r.status===409)return;throw r}}};function sa(e){return e.join("")}var HC=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${sa(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${sa(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${sa(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${sa(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${sa(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${sa(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof bl&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof bl&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},$C=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=WC({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new zC(this.client,t),this.tableOps=new HC(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},hf=class extends Error{constructor(e,t="storage",r,n){super(e),this.__isStorageError=!0,this.namespace=t,this.name=t==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=n}};function df(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var Tc=class extends hf{constructor(e,t,r,n="storage"){super(e,n,t,r),this.name=n==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},cy=class extends hf{constructor(e,t,r="storage"){super(e,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const VC=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),XC=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Td=e=>{if(Array.isArray(e))return e.map(r=>Td(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=Td(n)}),t},YC=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function kl(e){"@babel/helpers - typeof";return kl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kl(e)}function GC(e,t){if(kl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(kl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qC(e){var t=GC(e,"string");return kl(t)=="symbol"?t:t+""}function KC(e,t,r){return(t=qC(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function qe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lm(Object(r),!0).forEach(function(n){KC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lm(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const cm=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},JC=async(e,t,r,n)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const i=e,s=i.status||500;if(typeof i.json=="function")i.json().then(l=>{const o=(l==null?void 0:l.statusCode)||(l==null?void 0:l.code)||s+"";t(new Tc(cm(l),s,o,n))}).catch(()=>{if(n==="vectors"){const l=s+"";t(new Tc(i.statusText||`HTTP ${s} error`,s,l,n))}else{const l=s+"";t(new Tc(i.statusText||`HTTP ${s} error`,s,l,n))}});else{const l=s+"";t(new Tc(i.statusText||`HTTP ${s} error`,s,l,n))}}else t(new cy(cm(e),e,n))},QC=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||e==="HEAD"||!n?qe(qe({},i),r):(XC(n)?(i.headers=qe({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,t!=null&&t.duplex&&(i.duplex=t.duplex),qe(qe({},i),r))};async function ko(e,t,r,n,i,s,l){return new Promise((o,a)=>{e(r,QC(t,n,i,s)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;if(l==="vectors"){const d=c.headers.get("content-type");if(!d||!d.includes("application/json"))return{}}return c.json()}).then(c=>o(c)).catch(c=>JC(c,a,n,l))})}function ZC(e="storage"){return{get:async(t,r,n,i)=>ko(t,"GET",r,n,i,void 0,e),post:async(t,r,n,i,s)=>ko(t,"POST",r,i,s,n,e),put:async(t,r,n,i,s)=>ko(t,"PUT",r,i,s,n,e),head:async(t,r,n,i)=>ko(t,"HEAD",r,qe(qe({},n),{},{noResolveJson:!0}),i,void 0,e),remove:async(t,r,n,i,s)=>ko(t,"DELETE",r,i,s,n,e)}}const eT=ZC("storage"),{get:Sl,post:Et,put:Ed,head:tT,remove:X0}=eT;var ao=class{constructor(e,t={},r,n="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=VC(r),this.namespace=n}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){var t=this;try{return{data:await e(),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(df(r))return{data:null,error:r};throw r}}},rT=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(df(t))return{data:null,error:t};throw t}}};let uy;uy=Symbol.toStringTag;var nT=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[uy]="BlobDownloadBuilder",this.promise=null}asStream(){return new rT(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(df(t))return{data:null,error:t};throw t}}};const iT={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},um={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var sT=class extends ao{constructor(e,t={},r,n){super(e,t,n,"storage"),this.bucketId=r}async uploadOrUpdate(e,t,r,n){var i=this;return i.handleOperation(async()=>{let s;const l=qe(qe({},um),n);let o=qe(qe({},i.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const a=l.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",l.cacheControl),a&&s.append("metadata",i.encodeMetadata(a)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.has("cacheControl")||s.append("cacheControl",l.cacheControl),a&&!s.has("metadata")&&s.append("metadata",i.encodeMetadata(a))):(s=r,o["cache-control"]=`max-age=${l.cacheControl}`,o["content-type"]=l.contentType,a&&(o["x-metadata"]=i.toBase64(i.encodeMetadata(a))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!l.duplex&&(l.duplex="half")),n!=null&&n.headers&&(o=qe(qe({},o),n.headers));const c=i._removeEmptyFolders(t),d=i._getFinalPath(c),h=await(e=="PUT"?Ed:Et)(i.fetch,`${i.url}/object/${d}`,s,qe({headers:o},l!=null&&l.duplex?{duplex:l.duplex}:{}));return{path:c,id:h.Id,fullPath:h.Key}})}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var i=this;const s=i._removeEmptyFolders(e),l=i._getFinalPath(s),o=new URL(i.url+`/object/upload/sign/${l}`);return o.searchParams.set("token",t),i.handleOperation(async()=>{let a;const c=qe({upsert:um.upsert},n),d=qe(qe({},i.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",c.cacheControl),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.append("cacheControl",c.cacheControl)):(a=r,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType),{path:s,fullPath:(await Ed(i.fetch,o.toString(),a,{headers:d})).Key}})}async createSignedUploadUrl(e,t){var r=this;return r.handleOperation(async()=>{let n=r._getFinalPath(e);const i=qe({},r.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const s=await Et(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:i}),l=new URL(r.url+s.url),o=l.searchParams.get("token");if(!o)throw new hf("No token returned by API");return{signedUrl:l.toString(),path:e,token:o}})}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;return n.handleOperation(async()=>await Et(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}))}async copy(e,t,r){var n=this;return n.handleOperation(async()=>({path:(await Et(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key}))}async createSignedUrl(e,t,r){var n=this;return n.handleOperation(async()=>{let i=n._getFinalPath(e),s=await Et(n.fetch,`${n.url}/object/sign/${i}`,qe({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${n.url}${s.signedURL}${l}`)}})}async createSignedUrls(e,t,r){var n=this;return n.handleOperation(async()=>{const i=await Et(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i.map(l=>qe(qe({},l),{},{signedUrl:l.signedURL?encodeURI(`${n.url}${l.signedURL}${s}`):null}))})}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=n?`?${n}`:"",s=this._getFinalPath(e),l=()=>Sl(this.fetch,`${this.url}/${r}/${s}${i}`,{headers:this.headers,noResolveJson:!0});return new nT(l,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);return t.handleOperation(async()=>Td(await Sl(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})))}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await tT(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(df(n)&&n instanceof cy){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const s=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&n.push(l);let o=n.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${r}${o}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await X0(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,r){var n=this;return n.handleOperation(async()=>{const i=qe(qe(qe({},iT),t),{},{prefix:e||""});return await Et(n.fetch,`${n.url}/object/list/${n.bucketId}`,i,{headers:n.headers},r)})}async listV2(e,t){var r=this;return r.handleOperation(async()=>{const n=qe({},e);return await Et(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const aT="2.93.1",Kl={"X-Client-Info":`storage-js/${aT}`};var oT=class extends ao{constructor(e,t={},r,n){const i=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase."));const s=i.href.replace(/\/$/,""),l=qe(qe({},Kl),t);super(s,l,r,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=t.listBucketOptionsToQueryString(e);return await Sl(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await Sl(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var r=this;return r.handleOperation(async()=>await Et(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async updateBucket(e,t){var r=this;return r.handleOperation(async()=>await Ed(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await Et(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await X0(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},lT=class extends ao{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=qe(qe({},Kl),t);super(n,i,r,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await Et(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),i=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return await Sl(t.fetch,i,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await X0(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!YC(e))throw new hf("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new $C({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(i,s){const l=i[s];return typeof l!="function"?l:async(...o)=>{try{return{data:await l.apply(i,o),error:null}}catch(a){if(n)throw a;return{data:null,error:a}}}}})}},cT=class extends ao{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=qe(qe({},Kl),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await Et(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var r=this;return r.handleOperation(async()=>await Et(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await Et(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var r=this;return r.handleOperation(async()=>await Et(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{})}},uT=class extends ao{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=qe(qe({},Kl),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await Et(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await Et(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return t.handleOperation(async()=>await Et(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await Et(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await Et(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},fT=class extends ao{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=qe(qe({},Kl),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await Et(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await Et(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await Et(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await Et(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},hT=class extends fT{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new dT(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},dT=class extends cT{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,qe(qe({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,qe(qe({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new pT(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},pT=class extends uT{constructor(e,t,r,n,i){super(e,t,i),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,qe(qe({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,qe(qe({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,qe(qe({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,qe(qe({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,qe(qe({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},gT=class extends oT{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new sT(this.url,this.headers,e,this.fetch)}get vectors(){return new hT(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new lT(this.url+"/iceberg",this.headers,this.fetch)}};const fy="2.93.1",ma=30*1e3,Nd=3,ah=Nd*ma,mT="http://localhost:9999",xT="supabase.auth.token",vT={"X-Client-Info":`gotrue-js/${fy}`},Ad="X-Supabase-Api-Version",hy={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},yT=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,wT=10*60*1e3;class Cl extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function $e(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class _T extends Cl{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function bT(e){return $e(e)&&e.name==="AuthApiError"}class ws extends Cl{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Ci extends Cl{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class Jr extends Ci{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function oh(e){return $e(e)&&e.name==="AuthSessionMissingError"}class aa extends Ci{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ec extends Ci{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Nc extends Ci{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function kT(e){return $e(e)&&e.name==="AuthImplicitGrantRedirectError"}class fm extends Ci{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ST extends Ci{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Od extends Ci{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function lh(e){return $e(e)&&e.name==="AuthRetryableFetchError"}class hm extends Ci{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Fd extends Ci{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Au="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),dm=` 	
\r=`.split(""),CT=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<dm.length;t+=1)e[dm[t].charCodeAt(0)]=-2;for(let t=0;t<Au.length;t+=1)e[Au[t].charCodeAt(0)]=t;return e})();function pm(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Au[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Au[n]),t.queuedBits-=6}}function dy(e,t,r){const n=CT[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function gm(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=l=>{NT(l,n,r)};for(let l=0;l<e.length;l+=1)dy(e.charCodeAt(l),i,s);return t.join("")}function TT(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function ET(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}TT(n,t)}}function NT(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Ba(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)dy(e.charCodeAt(i),r,n);return new Uint8Array(t)}function AT(e){const t=[];return ET(e,r=>t.push(r)),new Uint8Array(t)}function Cs(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>pm(i,r,n)),pm(null,r,n),t.join("")}function OT(e){return Math.round(Date.now()/1e3)+e}function FT(){return Symbol("auth-callback")}const gr=()=>typeof window<"u"&&typeof document<"u",ds={tested:!1,writable:!1},py=()=>{if(!gr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ds.tested)return ds.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ds.tested=!0,ds.writable=!0}catch{ds.tested=!0,ds.writable=!1}return ds.writable};function jT(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const gy=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),PT=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",xa=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ps=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},pr=async(e,t)=>{await e.removeItem(t)};class pf{constructor(){this.promise=new pf.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}pf.promiseConstructor=Promise;function Ac(e){const t=e.split(".");if(t.length!==3)throw new Fd("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!yT.test(t[n]))throw new Fd("JWT not in base64url format");return{header:JSON.parse(gm(t[0])),payload:JSON.parse(gm(t[1])),signature:Ba(t[2]),raw:{header:t[0],payload:t[1]}}}async function DT(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function RT(e,t){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const l=await e(s);if(!t(s,null,l)){n(l);return}}catch(l){if(!t(s,l)){i(l);return}}})()})}function IT(e){return("0"+e.toString(16)).substr(-2)}function MT(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,IT).join("")}async function LT(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function BT(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await LT(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function oa(e,t,r=!1){const n=MT();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await xa(e,`${t}-code-verifier`,i);const s=await BT(n);return[s,n===s?"plain":"s256"]}const UT=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function WT(e){const t=e.headers.get(Ad);if(!t||!t.match(UT))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function zT(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function HT(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const $T=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function la(e){if(!$T.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ch(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function VT(e,t){return new Proxy(e,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,i)}})}function mm(e){return JSON.parse(JSON.stringify(e))}const xs=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),XT=[502,503,504];async function xm(e){var t;if(!PT(e))throw new Od(xs(e),0);if(XT.includes(e.status))throw new Od(xs(e),e.status);let r;try{r=await e.json()}catch(s){throw new ws(xs(s),s)}let n;const i=WT(e);if(i&&i.getTime()>=hy["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new hm(xs(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Jr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0))throw new hm(xs(r),e.status,r.weak_password.reasons);throw new _T(xs(r),e.status||500,n)}const YT=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function Ye(e,t,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[Ad]||(s[Ad]=hy["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const l=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(l.redirect_to=n.redirectTo);const o=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",a=await GT(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(a):{data:Object.assign({},a),error:null}}async function GT(e,t,r,n,i,s){const l=YT(t,n,i,s);let o;try{o=await e(r,Object.assign({},l))}catch(a){throw console.error(a),new Od(xs(a),0)}if(o.ok||await xm(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(a){await xm(a)}}function On(e){var t;let r=null;JT(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=OT(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function vm(e){const t=On(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Mi(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function qT(e){return{data:e,error:null}}function KT(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,l=ff(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},a=Object.assign({},l);return{data:{properties:o,user:a},error:null}}function ym(e){return e}function JT(e){return e.access_token&&e.refresh_token&&e.expires_in}const uh=["global","local","others"];class QT{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=gy(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=uh[0]){if(uh.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${uh.join(", ")}`);try{return await Ye(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if($e(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ye(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Mi})}catch(n){if($e(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=ff(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await Ye(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:KT,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if($e(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ye(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Mi})}catch(r){if($e(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,s,l,o,a;try{const c={nextPage:null,lastPage:0,total:0},d=await Ye(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:ym});if(d.error)throw d.error;const h=await d.json(),f=(l=d.headers.get("x-total-count"))!==null&&l!==void 0?l:0,u=(a=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&a!==void 0?a:[];return u.length>0&&(u.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(p.split(";")[1].split("=")[1]);c[`${g}Page`]=m}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if($e(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){la(t);try{return await Ye(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Mi})}catch(r){if($e(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){la(t);try{return await Ye(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Mi})}catch(n){if($e(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){la(t);try{return await Ye(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Mi})}catch(n){if($e(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){la(t.userId);try{const{data:r,error:n}=await Ye(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if($e(r))return{data:null,error:r};throw r}}async _deleteFactor(t){la(t.userId),la(t.id);try{return{data:await Ye(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if($e(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,i,s,l,o,a;try{const c={nextPage:null,lastPage:0,total:0},d=await Ye(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:ym});if(d.error)throw d.error;const h=await d.json(),f=(l=d.headers.get("x-total-count"))!==null&&l!==void 0?l:0,u=(a=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&a!==void 0?a:[];return u.length>0&&(u.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(p.split(";")[1].split("=")[1]);c[`${g}Page`]=m}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if($e(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(t){try{return await Ye(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if($e(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Ye(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if($e(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Ye(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if($e(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Ye(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if($e(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Ye(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if($e(r))return{data:null,error:r};throw r}}}function wm(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const ca={debug:!!(globalThis&&py()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class my extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class ZT extends my{}async function eE(e,t,r){ca.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),ca.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){ca.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{ca.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw ca.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new ZT(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(ca.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function tE(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function xy(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function rE(e){return parseInt(e,16)}function nE(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function iE(e){var t;const{chainId:r,domain:n,expirationTime:i,issuedAt:s=new Date,nonce:l,notBefore:o,requestId:a,resources:c,scheme:d,uri:h,version:f}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const u=xy(e.address),p=d?`${d}://${n}`:n,m=e.statement?`${e.statement}
`:"",g=`${p} wants you to sign in with your Ethereum account:
${u}

${m}`;let x=`URI: ${h}
Version: ${f}
Chain ID: ${r}${l?`
Nonce: ${l}`:""}
Issued At: ${s.toISOString()}`;if(i&&(x+=`
Expiration Time: ${i.toISOString()}`),o&&(x+=`
Not Before: ${o.toISOString()}`),a&&(x+=`
Request ID: ${a}`),c){let y=`
Resources:`;for(const w of c){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);y+=`
- ${w}`}x+=y}return`${g}
${x}`}class er extends Error{constructor({message:t,code:r,cause:n,name:i}){var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=i??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class Ou extends er{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function sE({error:e,options:t}){var r,n,i;const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new er({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new er({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new er({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=s.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new er({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new er({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new er({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new er({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new er({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const l=window.location.hostname;if(vy(l)){if(s.rp.id!==l)return new er({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new er({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new er({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new er({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new er({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function aE({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new er({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new er({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(vy(n)){if(r.rpId!==n)return new er({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new er({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new er({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new er({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class oE{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const lE=new oE;function cE(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,i=ff(e,["challenge","user","excludeCredentials"]),s=Ba(t).buffer,l=Object.assign(Object.assign({},r),{id:Ba(r.id).buffer}),o=Object.assign(Object.assign({},i),{challenge:s,user:l});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let a=0;a<n.length;a++){const c=n[a];o.excludeCredentials[a]=Object.assign(Object.assign({},c),{id:Ba(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function uE(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=ff(e,["challenge","allowCredentials"]),i=Ba(t).buffer,s=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const o=r[l];s.allowCredentials[l]=Object.assign(Object.assign({},o),{id:Ba(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return s}function fE(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Cs(new Uint8Array(e.response.attestationObject)),clientDataJSON:Cs(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function hE(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Cs(new Uint8Array(i.authenticatorData)),clientDataJSON:Cs(new Uint8Array(i.clientDataJSON)),signature:Cs(new Uint8Array(i.signature)),userHandle:i.userHandle?Cs(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function vy(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function _m(){var e,t;return!!(gr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function dE(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ou("Browser returned unexpected credential type",t)}:{data:null,error:new Ou("Empty credential response",t)}}catch(t){return{data:null,error:sE({error:t,options:e})}}}async function pE(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ou("Browser returned unexpected credential type",t)}:{data:null,error:new Ou("Empty credential response",t)}}catch(t){return{data:null,error:aE({error:t,options:e})}}}const gE={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},mE={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Fu(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of e)if(i)for(const s in i){const l=i[s];if(l!==void 0)if(Array.isArray(l))n[s]=l;else if(r(l))n[s]=l;else if(t(l)){const o=n[s];t(o)?n[s]=Fu(o,l):n[s]=Fu(l)}else n[s]=l}return n}function xE(e,t){return Fu(gE,e,t||{})}function vE(e,t){return Fu(mE,e,t||{})}class yE{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:i},s){try{const{data:l,error:o}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!l)return{data:null,error:o};const a=i??lE.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:c}=l.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${n}`),c.displayName||(c.displayName=c.name)}switch(l.webauthn.type){case"create":{const c=xE(l.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:d,error:h}=await dE({publicKey:c,signal:a});return d?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}case"request":{const c=vE(l.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:d,error:h}=await pE(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:c,signal:a}));return d?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}}}catch(l){return $e(l)?{data:null,error:l}:{data:null,error:new ws("Unexpected error in challenge",l)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new Cl("rpId is required for WebAuthn authentication")};try{if(!_m())return{data:null,error:new ws("Browser does not support WebAuthn",null)};const{data:l,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:s});if(!l)return{data:null,error:o};const{webauthn:a}=l;return this._verify({factorId:t,challengeId:l.challengeId,webauthn:{type:a.type,rpId:r,rpOrigins:n,credential_response:a.credential_response}})}catch(l){return $e(l)?{data:null,error:l}:{data:null,error:new ws("Unexpected error in authenticate",l)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new Cl("rpId is required for WebAuthn registration")};try{if(!_m())return{data:null,error:new ws("Browser does not support WebAuthn",null)};const{data:l,error:o}=await this._enroll({friendlyName:t});if(!l)return await this.client.mfa.listFactors().then(d=>{var h;return(h=d.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===t&&f.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:o};const{data:a,error:c}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:s});return a?this._verify({factorId:l.id,challengeId:a.challengeId,webauthn:{rpId:r,rpOrigins:n,type:a.webauthn.type,credential_response:a.webauthn.credential_response}}):{data:null,error:c}}catch(l){return $e(l)?{data:null,error:l}:{data:null,error:new ws("Unexpected error in register",l)}}}}tE();const wE={url:mT,storageKey:xT,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:vT,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function bm(e,t,r){return await r()}const ua={};class Tl{get jwks(){var t,r;return(r=(t=ua[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){ua[this.storageKey]=Object.assign(Object.assign({},ua[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=ua[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){ua[this.storageKey]=Object.assign(Object.assign({},ua[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},wE),t);if(this.storageKey=s.storageKey,this.instanceID=(r=Tl.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Tl.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&gr()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new QT({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=gy(s.fetch),this.lock=s.lock||bm,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,this.lockAcquireTimeout=s.lockAcquireTimeout,s.lock?this.lock=s.lock:this.persistSession&&gr()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=eE:this.lock=bm,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new yE(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:py()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=wm(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=wm(this.memoryStorage)),gr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l);try{await this._notifyAllSubscribers(l.data.event,l.data.session,!1)}catch(o){this._debug("#broadcastChannel","error",o)}})}this.initialize().catch(l=>{this._debug("#initialize()","error",l)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${fy}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(gr()&&(r=jT(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),gr()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),kT(s)){const a=(t=s.details)===null||t===void 0?void 0:t.code;if(a==="identity_already_exists"||a==="identity_not_found"||a==="single_identity_not_deletable")return{error:s}}return{error:s}}const{session:l,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",l,"redirect type",o),await this._saveSession(l),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return $e(r)?this._returnResult({error:r}):this._returnResult({error:new ws("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const s=await Ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:On}),{data:l,error:o}=s;if(o||!l)return this._returnResult({data:{user:null,session:null},error:o});const a=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",a)),this._returnResult({data:{user:c,session:a},error:null})}catch(s){if($e(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(t){var r,n,i;try{let s;if("email"in t){const{email:d,password:h,options:f}=t;let u=null,p=null;this.flowType==="pkce"&&([u,p]=await oa(this.storage,this.storageKey)),s=await Ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:u,code_challenge_method:p},xform:On})}else if("phone"in t){const{phone:d,password:h,options:f}=t;s=await Ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(i=f==null?void 0:f.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:On})}else throw new Ec("You must provide either an email or phone number and a password");const{data:l,error:o}=s;if(o||!l)return await pr(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const a=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",a)),this._returnResult({data:{user:c,session:a},error:null})}catch(s){if(await pr(this.storage,`${this.storageKey}-code-verifier`),$e(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:l,options:o}=t;r=await Ye(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:vm})}else if("phone"in t){const{phone:s,password:l,options:o}=t;r=await Ye(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:vm})}else throw new Ec("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const s=new aa;return this._returnResult({data:{user:null,session:null},error:s})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if($e(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,i,s,l,o,a,c,d,h,f;let u,p;if("message"in t)u=t.message,p=t.signature;else{const{chain:m,wallet:g,statement:x,options:y}=t;let w;if(gr())if(typeof g=="object")w=g;else{const F=window;if("ethereum"in F&&typeof F.ethereum=="object"&&"request"in F.ethereum&&typeof F.ethereum.request=="function")w=F.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=g}const _=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href),b=await w.request({method:"eth_requestAccounts"}).then(F=>F).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!b||b.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const k=xy(b[0]);let S=(n=y==null?void 0:y.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!S){const F=await w.request({method:"eth_chainId"});S=rE(F)}const E={domain:_.host,address:k,statement:x,uri:_.href,version:"1",chainId:S,nonce:(i=y==null?void 0:y.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(l=(s=y==null?void 0:y.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(o=y==null?void 0:y.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(a=y==null?void 0:y.signInWithEthereum)===null||a===void 0?void 0:a.notBefore,requestId:(c=y==null?void 0:y.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(d=y==null?void 0:y.signInWithEthereum)===null||d===void 0?void 0:d.resources};u=iE(E),p=await w.request({method:"personal_sign",params:[nE(u),k]})}try{const{data:m,error:g}=await Ye(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:u,signature:p},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=t.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:On});if(g)throw g;if(!m||!m.session||!m.user){const x=new aa;return this._returnResult({data:{user:null,session:null},error:x})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:g})}catch(m){if($e(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(t){var r,n,i,s,l,o,a,c,d,h,f,u;let p,m;if("message"in t)p=t.message,m=t.signature;else{const{chain:g,wallet:x,statement:y,options:w}=t;let _;if(gr())if(typeof x=="object")_=x;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))_=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=x}const b=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in _&&_.signIn){const k=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:b.host,uri:b.href}),y?{statement:y}:null));let S;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")S=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)S=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)p=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),m=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${b.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${b.href}`,`Issued At: ${(i=(n=w==null?void 0:w.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=w==null?void 0:w.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((h=(d=w==null?void 0:w.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...w.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const k=await _.signMessage(new TextEncoder().encode(p),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=k}}try{const{data:g,error:x}=await Ye(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:Cs(m)},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(u=t.options)===null||u===void 0?void 0:u.captchaToken}}:null),xform:On});if(x)throw x;if(!g||!g.session||!g.user){const y=new aa;return this._returnResult({data:{user:null,session:null},error:y})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:x})}catch(g){if($e(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(t){const r=await ps(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new ST;const{data:s,error:l}=await Ye(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:On});if(await pr(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!s||!s.session||!s.user){const o=new aa;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:l})}catch(s){if(await pr(this.storage,`${this.storageKey}-code-verifier`),$e(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:s,nonce:l}=t,o=await Ye(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:l,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:On}),{data:a,error:c}=o;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!a||!a.session||!a.user){const d=new aa;return this._returnResult({data:{user:null,session:null},error:d})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:a,error:c})}catch(r){if($e(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,i,s,l;try{if("email"in t){const{email:o,options:a}=t;let c=null,d=null;this.flowType==="pkce"&&([c,d]=await oa(this.storage,this.storageKey));const{error:h}=await Ye(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=a==null?void 0:a.data)!==null&&r!==void 0?r:{},create_user:(n=a==null?void 0:a.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in t){const{phone:o,options:a}=t,{data:c,error:d}=await Ye(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=a==null?void 0:a.data)!==null&&i!==void 0?i:{},create_user:(s=a==null?void 0:a.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},channel:(l=a==null?void 0:a.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d})}throw new Ec("You must provide either an email or phone number.")}catch(o){if(await pr(this.storage,`${this.storageKey}-code-verifier`),$e(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var r,n;try{let i,s;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:o}=await Ye(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:On});if(o)throw o;if(!l)throw new Error("An error occurred on token verification.");const a=l.session,c=l.user;return a!=null&&a.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",a)),this._returnResult({data:{user:c,session:a},error:null})}catch(i){if($e(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,n,i,s,l;try{let o=null,a=null;this.flowType==="pkce"&&([o,a]=await oa(this.storage,this.storageKey));const c=await Ye(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:a}),headers:this.headers,xform:qT});return!((s=c.data)===null||s===void 0)&&s.url&&gr()&&!(!((l=t.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(o){if(await pr(this.storage,`${this.storageKey}-code-verifier`),$e(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Jr;const{error:i}=await Ye(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if($e(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:s}=t,{error:l}=await Ye(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in t){const{phone:n,type:i,options:s}=t,{data:l,error:o}=await Ye(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:o})}throw new Ec("You must provide either an email or phone number and a type")}catch(r){if($e(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ps(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<ah:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const l=await ps(this.userStorage,this.storageKey+"-user");l!=null&&l.user?t.user=l.user:t.user=ch()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};t.user=VT(t.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Ye(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Mi}):await this._useSession(async r=>{var n,i,s;const{data:l,error:o}=r;if(o)throw o;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Jr}:await Ye(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:Mi})})}catch(r){if($e(r))return oh(r)&&(await this._removeSession(),await pr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new Jr;const l=i.session;let o=null,a=null;this.flowType==="pkce"&&t.email!=null&&([o,a]=await oa(this.storage,this.storageKey));const{data:c,error:d}=await Ye(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:a}),jwt:l.access_token,xform:Mi});if(d)throw d;return l.user=c.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(n){if(await pr(this.storage,`${this.storageKey}-code-verifier`),$e(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Jr;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:l}=Ac(t.access_token);if(l.exp&&(n=l.exp,i=n<=r),i){const{data:o,error:a}=await this._callRefreshToken(t.refresh_token);if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:a}=await this._getUser(t.access_token);if(a)return this._returnResult({data:{user:null,session:null},error:a});s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if($e(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:l,error:o}=r;if(o)throw o;t=(n=l.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Jr;const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if($e(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!gr())throw new Nc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Nc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new fm("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Nc("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new fm("No code detected.");const{data:y,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:l,expires_in:o,expires_at:a,token_type:c}=t;if(!s||!o||!l||!c)throw new Nc("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(o);let f=d+h;a&&(f=parseInt(a));const u=f-d;u*1e3<=ma&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${u}s, should have been closer to ${h}s`);const p=f-h;d-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,f,d):d-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,f,d);const{data:m,error:g}=await this._getUser(s);if(g)throw g;const x={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:h,expires_at:f,refresh_token:l,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:t.type},error:null})}catch(n){if($e(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ps(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s&&!oh(s))return this._returnResult({error:s});const l=(n=i.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:o}=await this.admin.signOut(l,t);if(o&&!(bT(o)&&(o.status===404||o.status===401||o.status===403)||oh(o)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await pr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=FT(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:l}=r;if(l)throw l;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await oa(this.storage,this.storageKey,!0));try{return await Ye(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(await pr(this.storage,`${this.storageKey}-code-verifier`),$e(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if($e(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var l,o,a,c,d;const{data:h,error:f}=s;if(f)throw f;const u=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:!0});return await Ye(this.fetch,"GET",u,{headers:this.headers,jwt:(d=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(i)throw i;return gr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if($e(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:s}}=r;if(i)throw i;const{options:l,provider:o,token:a,access_token:c,nonce:d}=t,h=await Ye(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s==null?void 0:s.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:a,access_token:c,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:On}),{data:f,error:u}=h;return u?this._returnResult({data:{user:null,session:null},error:u}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new aa}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:u}))}catch(i){if(await pr(this.storage,`${this.storageKey}-code-verifier`),$e(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:l}=r;if(l)throw l;return await Ye(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if($e(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await RT(async i=>(i>0&&await DT(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await Ye(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:On})),(i,s)=>{const l=200*Math.pow(2,i);return s&&lh(s)&&Date.now()+l-n<ma})}catch(n){if(this._debug(r,"error",n),$e(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),gr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await ps(this.storage,this.storageKey);if(i&&this.userStorage){let l=await ps(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:i.user},await xa(this.userStorage,this.storageKey+"-user",l)),i.user=(t=l==null?void 0:l.user)!==null&&t!==void 0?t:ch()}else if(i&&!i.user&&!i.user){const l=await ps(this.storage,this.storageKey+"-user");l&&(l!=null&&l.user)?(i.user=l.user,await pr(this.storage,this.storageKey+"-user"),await xa(this.storage,this.storageKey,i)):i.user=ch()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<ah;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${ah}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:l}=await this._callRefreshToken(i.refresh_token);l&&(console.error(l),lh(l)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:o}=await this._getUser(i.access_token);!o&&(l!=null&&l.user)?(i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(n,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Jr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new pf;const{data:s,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!s.session)throw new Jr;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={data:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),$e(s)){const l={data:null,error:s};return lh(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],l=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(a){s.push(a)}});if(await Promise.all(l),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await pr(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await xa(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=mm(i);await xa(this.storage,this.storageKey,s)}else{const i=mm(r);await xa(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await pr(this.storage,this.storageKey),await pr(this.storage,this.storageKey+"-code-verifier"),await pr(this.storage,this.storageKey+"-user"),this.userStorage&&await pr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&gr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),ma);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/ma);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${ma}ms, refresh threshold is ${Nd} ticks`),i<=Nd&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof my)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!gr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(t){this._debug("#visibilityChangedCallback","error",t)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,l]=await oa(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(l)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?this._returnResult({data:null,error:s}):await Ye(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if($e(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:l}=r;if(l)return this._returnResult({data:null,error:l});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:a,error:c}=await Ye(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(t.factorType==="totp"&&a.type==="totp"&&(!((i=a==null?void 0:a.totp)===null||i===void 0)&&i.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),this._returnResult({data:a,error:null}))})}catch(r){if($e(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const l=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?fE(t.webauthn.credential_response):hE(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:a}=await Ye(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return a?this._returnResult({data:null,error:a}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:a}))})}catch(r){if($e(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const l=await Ye(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(l.error)return l;const{data:o}=l;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:cE(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:uE(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if($e(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const s of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])i.all.push(s),s.status==="verified"&&i[s.factor_type].push(s);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(t){var r,n,i,s;if(t)try{const{payload:u}=Ac(t);let p=null;u.aal&&(p=u.aal);let m=p;const{data:{user:g},error:x}=await this.getUser(t);if(x)return this._returnResult({data:null,error:x});((n=(r=g==null?void 0:g.factors)===null||r===void 0?void 0:r.filter(_=>_.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(m="aal2");const w=u.amr||[];return{data:{currentLevel:p,nextLevel:m,currentAuthenticationMethods:w},error:null}}catch(u){if($e(u))return this._returnResult({data:null,error:u});throw u}const{data:{session:l},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Ac(l.access_token);let c=null;a.aal&&(c=a.aal);let d=c;((s=(i=l.user.factors)===null||i===void 0?void 0:i.filter(u=>u.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(d="aal2");const f=a.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:f},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await Ye(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Jr})})}catch(r){if($e(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Jr});const l=await Ye(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return l.data&&l.data.redirect_url&&gr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if($e(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Jr});const l=await Ye(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return l.data&&l.data.redirect_url&&gr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if($e(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await Ye(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Jr})})}catch(t){if($e(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?(await Ye(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Jr})})}catch(r){if($e(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+wT>i)return n;const{data:s,error:l}=await Ye(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:u,error:p}=await this.getSession();if(p||!u.session)return this._returnResult({data:null,error:p});n=u.session.access_token}const{header:i,payload:s,signature:l,raw:{header:o,payload:a}}=Ac(n);r!=null&&r.allowExpired||zT(s.exp);const c=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:u}=await this.getUser(n);if(u)throw u;return{data:{claims:s,header:i,signature:l},error:null}}const d=HT(i.alg),h=await crypto.subtle.importKey("jwk",c,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,l,AT(`${o}.${a}`)))throw new Fd("Invalid JWT signature");return{data:{claims:s,header:i,signature:l},error:null}}catch(n){if($e(n))return this._returnResult({data:null,error:n});throw n}}}Tl.nextInstanceID={};const _E=Tl,bE="2.93.1";let Fo="";typeof Deno<"u"?Fo="deno":typeof document<"u"?Fo="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Fo="react-native":Fo="node";function kE(){const e=globalThis.process;if(e&&e.platform){const t=e.platform;if(t==="darwin")return"macOS";if(t==="win32")return"Windows";if(t==="linux")return"Linux";if(t==="android")return"Android"}if(typeof navigator<"u"&&navigator.userAgentData&&navigator.userAgentData.platform){const t=navigator.userAgentData.platform;if(t==="macOS")return"macOS";if(t==="Windows")return"Windows";if(t==="Linux")return"Linux";if(t==="Android")return"Android";if(t==="iOS")return"iOS"}return null}function SE(){const e=globalThis.process;if(e){const t=e.versions;if(t&&t.node&&typeof window>"u")try{const r=globalThis.require;if(r)return r("os").release()}catch{return null}}if(typeof Deno<"u"&&Deno.osRelease)try{return Deno.osRelease()}catch{return null}return typeof navigator<"u"&&navigator.userAgentData&&navigator.userAgentData.platformVersion?navigator.userAgentData.platformVersion:null}function CE(){if(typeof Deno<"u")return"deno";if(typeof Bun<"u")return"bun";const e=globalThis.process;if(e){const t=e.versions;if(t&&t.node)return"node"}return null}function TE(){if(typeof Deno<"u"&&Deno.version)return Deno.version.deno;if(typeof Bun<"u"&&Bun.version)return Bun.version;const e=globalThis.process;if(e){const t=e.versions;if(t&&t.node)return t.node}return null}function EE(){const e={"X-Client-Info":`supabase-js-${Fo}/${bE}`},t=kE();t&&(e["X-Supabase-Client-Platform"]=t);const r=SE();r&&(e["X-Supabase-Client-Platform-Version"]=r);const n=CE();n&&(e["X-Supabase-Client-Runtime"]=n);const i=TE();return i&&(e["X-Supabase-Client-Runtime-Version"]=i),e}const NE=EE(),AE={headers:NE},OE={schema:"public"},FE={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},jE={};function El(e){"@babel/helpers - typeof";return El=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},El(e)}function PE(e,t){if(El(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(El(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DE(e){var t=PE(e,"string");return El(t)=="symbol"?t:t+""}function RE(e,t,r){return(t=DE(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function km(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Lt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?km(Object(r),!0).forEach(function(n){RE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):km(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const IE=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),ME=()=>Headers,LE=(e,t,r)=>{const n=IE(r),i=ME();return async(s,l)=>{var o;const a=(o=await t())!==null&&o!==void 0?o:e;let c=new i(l==null?void 0:l.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${a}`),n(s,Lt(Lt({},l),{},{headers:c}))}};function BE(e){return e.endsWith("/")?e:e+"/"}function UE(e,t){var r,n;const{db:i,auth:s,realtime:l,global:o}=e,{db:a,auth:c,realtime:d,global:h}=t,f={db:Lt(Lt({},a),i),auth:Lt(Lt({},c),s),realtime:Lt(Lt({},d),l),storage:{},global:Lt(Lt(Lt({},h),o),{},{headers:Lt(Lt({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}function WE(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(BE(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var zE=class extends _E{constructor(e){super(e)}},HE=class{constructor(e,t,r){var n,i;this.supabaseUrl=e,this.supabaseKey=t;const s=WE(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",s),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",s),this.storageUrl=new URL("storage/v1",s),this.functionsUrl=new URL("functions/v1",s);const l=`sb-${s.hostname.split(".")[0]}-auth-token`,o={db:OE,realtime:jE,auth:Lt(Lt({},FE),{},{storageKey:l}),global:AE},a=UE(r??{},o);if(this.storageKey=(n=a.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=a.global.headers)!==null&&i!==void 0?i:{},a.accessToken)this.accessToken=a.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=a.auth)!==null&&c!==void 0?c:{},this.headers,a.global.fetch)}this.fetch=LE(t,this._getAccessToken.bind(this),a.global.fetch),this.realtime=this._initRealtimeClient(Lt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},a.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new _C(new URL("rest/v1",s).href,{headers:this.headers,schema:a.db.schema,fetch:this.fetch}),this.storage=new gT(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),a.accessToken||this._listenForAuthEvents()}get functions(){return new mC(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,storageKey:s,flowType:l,lock:o,debug:a,throwOnError:c},d,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new zE({url:this.authUrl.href,headers:Lt(Lt({},f),d),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,flowType:l,lock:o,debug:a,throwOnError:c,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(u=>u.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new LC(this.realtimeUrl.href,Lt(Lt({},e),{},{params:Lt(Lt({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const $E=(e,t,r)=>new HE(e,t,r);function VE(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}VE()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const XE="https://kglshjhuofkouiodmkgs.supabase.co",YE="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtnbHNoamh1b2Zrb3Vpb2Rta2dzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk0NDE3ODgsImV4cCI6MjA4NTAxNzc4OH0.kqoUY-stIdwOw3vtpowcbzV_AvjgGtzXN6i9bjQCW-Y",_e=$E(XE,YE),GE=()=>{var te;const e=ne.useRef(null),t=ne.useRef(null),[r,n]=ne.useState(null),[i,s]=ne.useState(""),[l,o]=ne.useState(""),[a,c]=ne.useState("A"),[d,h]=ne.useState("#5E5CE6"),[f,u]=ne.useState("#E5E5EA"),[p,m]=ne.useState("#D1D1D6"),[g,x]=ne.useState("#8E8E93"),[y,w]=ne.useState(12),[_,b]=ne.useState([]),[k,S]=ne.useState(null),[E,F]=ne.useState(!1),[P,D]=ne.useState(null),[I,X]=ne.useState(null),[z,G]=ne.useState(null),[ae,le]=ne.useState([]),[Z,C]=ne.useState([]),L=R=>{var Ne,Ie;const ue=R||t.current;if(!ue)return;const oe=ue.getObjects();if(oe.length===0)return;let he=1/0,de=1/0,ie=-1/0,pe=-1/0;oe.forEach(We=>{const Te=We.getBoundingRect(!0);he=Math.min(he,Te.left),de=Math.min(de,Te.top),ie=Math.max(ie,Te.left+Te.width),pe=Math.max(pe,Te.top+Te.height)});const Se=ie-he,De=pe-de,we=((Ne=e.current)==null?void 0:Ne.clientWidth)||ue.getWidth(),ve=((Ie=e.current)==null?void 0:Ie.clientHeight)||ue.getHeight(),Ae=we/2-(he+Se/2),Ee=ve/2-(de+De/2);ue.setViewportTransform([1,0,0,1,Ae,Ee]),ue.requestRenderAll()},B=()=>{const R=t.current;if(!R)return;const ue=R.getObjects().map(oe=>{const he=oe.data||{};return{id:he.id,seatNumber:he.seatNumber,displayNumber:he.displayNumber,zoneName:he.zoneName,zoneColor:he.zoneColor,pos_x:oe.left,pos_y:oe.top,width:oe.width,height:oe.height,label:he.label,type:he.type,rotation:oe.angle,globalNumber:he.globalNumber}});le(oe=>[...oe.slice(-19),ue])},N=ne.useRef(null),U=ne.useRef(null),A=ne.useRef(null),T=ne.useRef(null);ne.useEffect(()=>{N.current=P,U.current=I,A.current=z},[P,I,z]),ne.useEffect(()=>{j()},[]);const j=async()=>{const{data:R}=await _e.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});R&&R.length>0&&(b(R),S(R[0].id))};ne.useEffect(()=>{if(!e.current||!k)return;let R=!0;t.current&&t.current.dispose(),e.current.innerHTML="";const ue=document.createElement("canvas");e.current.appendChild(ue);const oe=new Ke.fabric.Canvas(ue,{width:e.current.clientWidth,height:e.current.clientHeight,backgroundColor:"transparent",selection:!0});t.current=oe,new ResizeObserver(()=>{if(!e.current||!t.current)return;const we=e.current.clientWidth,ve=e.current.clientHeight;t.current.setDimensions({width:we,height:ve}),L(t.current)}).observe(e.current),(async()=>{F(!0);const{data:we,error:ve}=await _e.from("seats").select("*").eq("zone_id",k).order("global_number",{ascending:!0});R&&(ve?console.error("Error loading seats:",ve):we&&we.length>0?(t.current&&t.current.clear(),we.filter(Ee=>typeof Ee.pos_x=="number"&&typeof Ee.pos_y=="number").forEach(Ee=>{Y(Ee);const Ne=t.current.getObjects().find(Ie=>Ie.data.id===Ee.id);Ne&&delete Ne.data.isDirty}),setTimeout(()=>{R&&L(t.current)},100),t.current.renderAll()):t.current&&t.current.clear(),F(!1))})(),oe.on("mouse:down",we=>{var ve,Ae,Ee,Ne;if(N.current==="structure"){oe.selection=!1;const Ie=oe.getPointer(we.e);X({x:Ie.x,y:Ie.y});const We=new Ke.fabric.Rect({left:Ie.x,top:Ie.y,width:0,height:0,fill:"#E5E5EA",rx:6,ry:6,stroke:"#C7C7CC",strokeWidth:1,opacity:.7});oe.add(We),G(We);return}we.target?B():(oe.isDragging=!0,oe.selection=!0,oe.lastPosX=we.e.clientX||((Ae=(ve=we.e.touches)==null?void 0:ve[0])==null?void 0:Ae.clientX),oe.lastPosY=we.e.clientY||((Ne=(Ee=we.e.touches)==null?void 0:Ee[0])==null?void 0:Ne.clientY))});const ie=async()=>{if(ae.length===0)return;const we=ae[ae.length-1],ve=ae.slice(0,-1);le(ve),t.current.clear(),we.forEach(Ae=>{Y({id:Ae.id,seat_number:Ae.seatNumber,display_number:Ae.displayNumber,zone_name:Ae.zoneName,zone_color:Ae.zoneColor,pos_x:Ae.pos_x,pos_y:Ae.pos_y,width:Ae.width,height:Ae.height,label:Ae.label,type:Ae.type,rotation:Ae.rotation,global_number:Ae.globalNumber})})},pe=()=>{const we=oe.getActiveObject();we&&we.clone(ve=>{T.current=ve},["data"])},Se=()=>{if(!T.current||!t.current)return;const we=t.current;B();try{T.current.clone(ve=>{var Ae,Ee,Ne;if(!(!we.getElement()||!we.contextContainer)){if(we.discardActiveObject(),ve.set({left:ve.left+20,top:ve.top+20,evented:!0}),ve.type==="activeSelection"){const Ie=[];ve.forEachObject(Te=>{var lr,fn;const et=crypto.randomUUID();let vt=((lr=Te.data)==null?void 0:lr.type)==="structure";!vt&&((fn=Te.data)!=null&&fn.label)&&(vt=!0);const Kt=Te.data||{};vt&&(delete Kt.zoneName,delete Kt.zoneColor,delete Kt.displayNumber),Te.set("data",{...Kt,id:et,isDirty:!0,type:vt?"structure":"seat",seatNumber:Kt.seatNumber||(vt?`STR_${et.slice(-8)}`:"0")}),we.add(Te),Ie.push(Te)});const We=new Ke.fabric.ActiveSelection(Ie,{canvas:we});we.setActiveObject(We),We.setCoords()}else{const Ie=crypto.randomUUID();let We=((Ae=ve.data)==null?void 0:Ae.type)==="structure";if(!We&&((Ee=ve.data)!=null&&Ee.label)&&(We=!0),We){const et=((Ne=ve.data)==null?void 0:Ne.label)||"",vt=prompt("  ",et);if(vt){ve.data={...ve.data,label:vt,type:"structure"};const Kt=ve.getObjects().find(lr=>lr.type==="i-text");Kt&&Kt.set("text",vt)}}const Te=ve.data||{};We&&(delete Te.zoneName,delete Te.zoneColor,delete Te.displayNumber),ve.set("data",{...Te,id:Ie,isDirty:!0,type:We?"structure":"seat",seatNumber:We?`STR_${Ie.slice(-8)}`:Te.seatNumber||"0"}),we.add(ve),we.setActiveObject(ve)}we.requestRenderAll()}},["data"])}catch(ve){console.error("Error pasting objects:",ve)}},De=we=>{(we.ctrlKey||we.metaKey)&&we.key==="z"&&(we.preventDefault(),ie()),(we.ctrlKey||we.metaKey)&&we.key==="c"&&document.activeElement.tagName!=="INPUT"&&document.activeElement.tagName!=="TEXTAREA"&&(we.preventDefault(),pe()),(we.ctrlKey||we.metaKey)&&we.key==="v"&&document.activeElement.tagName!=="INPUT"&&document.activeElement.tagName!=="TEXTAREA"&&(we.preventDefault(),Se())};return window.addEventListener("keydown",De),oe.on("mouse:move",we=>{var ve,Ae,Ee,Ne;if(N.current==="structure"&&U.current&&A.current){const Ie=oe.getPointer(we.e),We=U.current,Te=A.current,et=Math.abs(Ie.x-We.x),vt=Math.abs(Ie.y-We.y),Kt=Math.min(Ie.x,We.x),lr=Math.min(Ie.y,We.y);Te.set({width:et,height:vt,left:Kt,top:lr}),oe.requestRenderAll();return}if(oe.isDragging){const Ie=we.e,We=Ie.clientX||((Ae=(ve=Ie.touches)==null?void 0:ve[0])==null?void 0:Ae.clientX),Te=Ie.clientY||((Ne=(Ee=Ie.touches)==null?void 0:Ee[0])==null?void 0:Ne.clientY),et=oe.viewportTransform;et[4]+=We-oe.lastPosX,et[5]+=Te-oe.lastPosY,oe.requestRenderAll(),oe.lastPosX=We,oe.lastPosY=Te}}),oe.on("mouse:wheel",we=>{const ve=we.e.deltaY,Ae=oe.viewportTransform;Ae[5]-=ve,oe.requestRenderAll(),we.e.preventDefault(),we.e.stopPropagation()}),oe.on("object:scaling",we=>{const ve=we.target;if(ve&&ve.data){const Ae=ve.getObjects().find(Ee=>Ee.type==="i-text");Ae&&Ae.set({scaleX:1/ve.scaleX,scaleY:1/ve.scaleY})}}),oe.on("mouse:dblclick",we=>{const ve=we.target;if(!ve||!ve.data)return;const Ae=ve.data.type;if(Ae!=="seat"&&Ae!=="structure")return;const Ee=ve.getObjects().find(et=>et.type==="i-text");if(!Ee)return;B();const Ne={...ve.data},Ie=ve.left,We=ve.top,Te=ve.angle;ve._restoreObjectsState(),oe.remove(ve),ve.getObjects().forEach(et=>{oe.add(et),et===Ee&&(oe.setActiveObject(et),et.enterEditing(),et.selectAll())}),oe.requestRenderAll(),Ee.on("editing:exited",()=>{const et=Ee.text;Ae==="structure"&&(Ne.label=et),Ae==="seat"&&(Ne.displayNumber=et);const Kt=[ve.getObjects().find(fn=>fn.type==="rect"),Ee];Kt.forEach(fn=>oe.remove(fn));const lr=new Ke.fabric.Group(Kt,{left:Ie,top:We,angle:Te,hasControls:!0,lockRotation:!1,subTargetCheck:!0});lr.data=Ne,lr.data.isDirty=!0,Ae==="seat"?lr.set({borderColor:Ne.zoneColor||"#5E5CE6",cornerColor:"white",cornerStrokeColor:"#5E5CE6",transparentCorners:!1}):lr.set({borderColor:"#007AFF",cornerColor:"white",cornerStrokeColor:"#007AFF",transparentCorners:!1}),oe.add(lr),oe.setActiveObject(lr),oe.requestRenderAll(),Ee.off("editing:exited")})}),oe.on("mouse:up",()=>{if(N.current==="structure"&&A.current){const we=A.current,ve=we.width,Ae=we.height,Ee=we.left,Ne=we.top;oe.remove(we),G(null),X(null),D(null),ve>20&&Ae>20&&setTimeout(()=>{const Ie=prompt("  (: , , )","");Ie&&(B(),M(Ee,Ne,ve,Ae,Ie))},50);return}oe.isDragging&&(oe.setViewportTransform(oe.viewportTransform),oe.isDragging=!1)}),oe.on("selection:created",we=>{var Ae,Ee,Ne,Ie,We;const ve=we.selected;if(ve.length===1){const Te=ve[0];n(Te),((Ae=Te.data)==null?void 0:Ae.type)==="structure"?(u(Te.data.bgColor||"#E5E5EA"),m(Te.data.strokeColor||"#D1D1D6"),x(Te.data.textColor||"#8E8E93"),w(Te.data.fontSize||12)):(s(((Ee=Te.data)==null?void 0:Ee.seatNumber)||""),o(((Ne=Te.data)==null?void 0:Ne.displayNumber)||""),c(((Ie=Te.data)==null?void 0:Ie.zoneName)||"A"),h(((We=Te.data)==null?void 0:We.zoneColor)||"#5E5CE6"))}else n(null)}),oe.on("selection:updated",we=>{var Ae,Ee,Ne,Ie,We;const ve=we.selected;if(ve.length===1){const Te=ve[0];n(Te),((Ae=Te.data)==null?void 0:Ae.type)==="structure"?(u(Te.data.bgColor||"#E5E5EA"),m(Te.data.strokeColor||"#D1D1D6"),x(Te.data.textColor||"#8E8E93"),w(Te.data.fontSize||12)):(s(((Ee=Te.data)==null?void 0:Ee.seatNumber)||""),o(((Ne=Te.data)==null?void 0:Ne.displayNumber)||""),c(((Ie=Te.data)==null?void 0:Ie.zoneName)||"A"),h(((We=Te.data)==null?void 0:We.zoneColor)||"#5E5CE6"))}else n(null)}),oe.on("selection:cleared",()=>{n(null),s(""),o(""),u("#E5E5EA"),m("#D1D1D6"),x("#8E8E93"),w(12)}),oe.on("object:modified",async we=>{const ve=we.target;if(!ve)return;(ve.type==="activeSelection"?ve.getObjects():[ve]).forEach(Ee=>{var Ne;if(Ee.data){const Ie=Ee.width*Ee.scaleX,We=Ee.height*Ee.scaleY;Ee.set({width:Ie,height:We,scaleX:1,scaleY:1});const Te=Ee.getObjects().find(et=>et.type==="i-text");if(Te){Te.set({scaleX:1,scaleY:1}),((Ne=Ee.data)==null?void 0:Ne.type)==="structure"?Te.set({left:0,top:0,originX:"center",originY:"center"}):Te.set({left:-Ie/2+6,top:-We/2+6,originX:"left",originY:"top"});const et=Ee.getObjects().find(vt=>vt.type==="rect");et&&(et.set({width:Ie,height:We}),et.set({left:-Ie/2,top:-We/2})),Ee.addWithUpdate()}}Ee.data&&(Ee.data.isDirty=!0)})}),()=>{R=!1,window.removeEventListener("keydown",De),oe.dispose(),t.current=null}},[k]);const M=(R,ue,oe,he,de)=>{const ie=new Ke.fabric.Rect({fill:f,width:oe,height:he,rx:6,ry:6,stroke:p,strokeWidth:1}),pe=new Ke.fabric.IText(de,{fontSize:y,originX:"center",originY:"center",left:oe/2,top:he/2,fill:g,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),Se=crypto.randomUUID(),De=new Ke.fabric.Group([ie,pe],{left:R,top:ue,originX:"left",originY:"top",perPixelTargetFind:!0,data:{id:Se,type:"structure",label:de,width:oe,height:he,bgColor:f,strokeColor:p,textColor:g,fontSize:y,isDirty:!0,seatNumber:`STR_${Se.slice(-8)}`}});t.current.add(De),t.current.setActiveObject(De)},Y=R=>{if(R.type==="structure"){const de=new Ke.fabric.Rect({fill:R.bg_color||"#E5E5EA",width:R.width||72,height:R.height||72,rx:6,ry:6,stroke:R.stroke_color||"#D1D1D6",strokeWidth:1}),ie=new Ke.fabric.IText(R.label||"",{fontSize:R.font_size||12,originX:"center",originY:"center",left:(R.width||72)/2,top:(R.height||72)/2,fill:R.text_color||"#8E8E93",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),pe=new Ke.fabric.Group([de,ie],{id:R.id,left:R.pos_x,top:R.pos_y,originX:"left",originY:"top",angle:R.rotation,perPixelTargetFind:!0,data:{id:R.id,type:"structure",label:R.label,width:R.width,height:R.height,bgColor:R.bg_color,strokeColor:R.stroke_color,textColor:R.text_color,fontSize:R.font_size}});t.current.add(pe);return}const ue=new Ke.fabric.Rect({fill:R.zone_color||"#5E5CE6",width:72,height:72,rx:6,ry:6,stroke:"rgba(255,255,255,0.1)",strokeWidth:2}),oe=new Ke.fabric.IText(R.display_number||R.seat_number,{fontSize:12,left:6,top:6,fill:"#ffffff",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"900",selectable:!1}),he=new Ke.fabric.Group([ue,oe],{left:R.pos_x,top:R.pos_y,originX:"left",originY:"top",angle:R.rotation,perPixelTargetFind:!0,data:{id:R.id,type:"seat",seatNumber:R.seat_number,displayNumber:R.display_number,zoneName:R.zone_name,zoneColor:R.zone_color,globalNumber:R.global_number}});t.current.add(he)},H=()=>{var R;if(r){if(B(),((R=r.data)==null?void 0:R.type)==="structure"){r.set("data",{...r.data,bgColor:f,strokeColor:p,textColor:g,fontSize:y,isDirty:!0});const ue=r.getObjects().find(he=>he.type==="rect");ue&&ue.set({fill:f,stroke:p});const oe=r.getObjects().find(he=>he.type==="i-text");oe&&oe.set({fill:g,fontSize:y})}else{r.set("data",{...r.data,seatNumber:i,displayNumber:l,zoneName:a,zoneColor:d,isDirty:!0});const ue=r.getObjects().find(he=>he.type==="rect");ue&&ue.set("fill",d);const oe=r.getObjects().find(he=>he.type==="i-text");oe&&oe.set("text",l)}t.current.renderAll()}},V=()=>{B();const ue=`${t.current.getObjects().filter(ie=>{var pe;return((pe=ie.data)==null?void 0:pe.type)!=="structure"}).length+1}`,oe=new Ke.fabric.Rect({fill:d,width:72,height:72,rx:6,ry:6,stroke:"rgba(255,255,255,0.1)",strokeWidth:2}),he=new Ke.fabric.IText(ue,{fontSize:18,originX:"center",originY:"center",left:36,top:36,fill:"#ffffff",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"900",selectable:!1}),de=new Ke.fabric.Group([oe,he],{left:150,top:150,originX:"left",originY:"top",perPixelTargetFind:!0,data:{id:crypto.randomUUID(),type:"seat",seatNumber:ue,zoneName:a,zoneColor:d,isDirty:!0}});t.current.add(de),t.current.setActiveObject(de)},fe=async()=>{const R=t.current;if(!R)return;const ue=R.getActiveObject();if(ue){B();const oe=ue.type==="activeSelection"?ue.getObjects():[ue],he=[];oe.forEach(de=>{var pe;const ie=(pe=de.data)==null?void 0:pe.id;ie&&ie.length>20&&he.push(ie)}),C(de=>[...de,...he]),R.discardActiveObject(),oe.forEach(de=>R.remove(de)),R.requestRenderAll(),n(null)}},O=()=>{B();const R=t.current.getObjects(),ue=["A","B","C"];let oe=1;ue.forEach(he=>{R.filter(ie=>{var pe,Se;return((pe=ie.data)==null?void 0:pe.zoneName)===he&&((Se=ie.data)==null?void 0:Se.type)!=="structure"}).sort((ie,pe)=>Math.abs(ie.top-pe.top)<20?ie.left-pe.left:ie.top-pe.top).forEach((ie,pe)=>{const Se=pe+1,De=`${he}-${Se.toString().padStart(2,"0")}`;ie.set("data",{...ie.data,seatNumber:Se.toString(),displayNumber:De,globalNumber:oe++});const we=ie.getObjects().find(ve=>ve.type==="i-text");we&&we.set("text",De)})}),t.current.renderAll()},Q=()=>{const R=t.current.getActiveObject();R&&(B(),R.rotate(((R.angle||0)+90)%360),t.current.renderAll())},K=async()=>{F(!0);try{if(Z.length>0){const{error:he}=await _e.from("seats").delete().in("id",Z);if(he)throw console.error("Error deleting items:",he),he}const R=t.current.getObjects(),ue=[],oe=[];if(R.forEach(he=>{var we,ve,Ae,Ee,Ne,Ie,We,Te,et,vt,Kt,lr,fn;const de=Math.round(he.getScaledWidth()),ie=Math.round(he.getScaledHeight()),pe=((we=he.data)==null?void 0:we.type)==="structure",Se=((ve=he.data)==null?void 0:ve.seatNumber)||(pe?`STR_${he.data.id.slice(-8)}`:"0"),De={zone_id:k,pos_x:Math.round(he.left),pos_y:Math.round(he.top),rotation:Math.round(he.angle||0),type:((Ae=he.data)==null?void 0:Ae.type)||"seat",width:de,height:ie,label:((Ee=he.data)==null?void 0:Ee.label)||null,bg_color:((Ne=he.data)==null?void 0:Ne.bgColor)||null,stroke_color:((Ie=he.data)==null?void 0:Ie.strokeColor)||null,text_color:((We=he.data)==null?void 0:We.textColor)||null,font_size:((Te=he.data)==null?void 0:Te.fontSize)||null,seat_number:Se,display_number:((et=he.data)==null?void 0:et.displayNumber)||null,zone_name:((vt=he.data)==null?void 0:vt.zoneName)||null,zone_color:((Kt=he.data)==null?void 0:Kt.zoneColor)||null,global_number:((lr=he.data)==null?void 0:lr.globalNumber)||null};(fn=he.data)!=null&&fn.id&&he.data.id.length>20?(De.id=he.data.id,ue.push(De)):oe.push(De)}),ue.length>0){const{error:he}=await _e.from("seats").upsert(ue);if(he)throw he}if(oe.length>0){const{error:he}=await _e.from("seats").insert(oe);if(he)throw he}alert("."),C([]),t.current.getObjects().forEach(he=>{he.data&&delete he.data.isDirty}),window.location.reload()}catch(R){console.error("Error saving layout:",R),alert(" : "+(R.message||R.details||JSON.stringify(R)))}finally{F(!1)}},ce=()=>{B();const R=t.current.getObjects(),ue=30,oe=R.filter(pe=>{var Se;return(Se=pe.data)==null?void 0:Se.isDirty}),he=R.filter(pe=>{var Se;return!((Se=pe.data)!=null&&Se.isDirty)}),de=he.map(pe=>Math.round(pe.left)),ie=he.map(pe=>Math.round(pe.top));oe.forEach(pe=>{let Se=pe.left,De=pe.top,we=Se,ve=1/0;de.forEach(Ne=>{const Ie=Math.abs(Se-Ne);Ie<ue&&Ie<ve&&(ve=Ie,we=Ne)}),ve<ue&&pe.set("left",we);let Ae=De,Ee=1/0;ie.forEach(Ne=>{const Ie=Math.abs(De-Ne);Ie<ue&&Ie<Ee&&(Ee=Ie,Ae=Ne)}),Ee<ue&&pe.set("top",Ae),pe.setCoords()}),t.current.renderAll()};return v.jsxs("div",{className:"flex flex-col w-full h-full mx-auto leading-normal overflow-hidden relative bg-[#F2F2F7]",children:[E&&v.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-50 flex items-center justify-center pointer-events-none",children:v.jsx("div",{className:"w-8 h-8 border-3 border-ios-indigo border-t-transparent rounded-full animate-spin"})}),v.jsxs("div",{className:"bg-white/80 backdrop-blur-md border-b border-black/5 p-4 flex items-center justify-between shadow-sm z-30",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:"flex gap-1",children:_.map(R=>v.jsx("button",{onClick:()=>S(R.id),className:`px-5 py-2 rounded-apple-md text-[11px] font-black transition-all border ${k===R.id?"bg-[#1C1C1E] text-white border-[#1C1C1E] shadow-sm":"bg-white text-ios-gray border-gray-100 hover:text-[#1C1C1E] hover:border-gray-200"}`,children:R.name},R.id))}),v.jsx("div",{className:"h-6 w-[1px] bg-gray-200 mx-2"}),v.jsxs("div",{className:"flex items-center gap-1.5",children:[v.jsxs("button",{onClick:V,className:"flex items-center gap-2 bg-ios-indigo text-white px-4 py-2 rounded-apple-md text-[11px] font-black hover:bg-ios-indigo/90 transition-all ios-tap shadow-sm shadow-ios-indigo/20",children:[v.jsx(yl,{className:"w-3.5 h-3.5"})," "]}),v.jsxs("button",{onClick:()=>D(R=>R==="structure"?null:"structure"),className:`flex items-center gap-2 px-4 py-2 rounded-apple-md text-[11px] font-black transition-all border ios-tap ${P==="structure"?"bg-[#1C1C1E] text-white border-[#1C1C1E]":"bg-white text-ios-gray border-gray-100 hover:bg-gray-50"}`,children:[v.jsx(CS,{className:"w-3.5 h-3.5"})," "]})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("button",{onClick:O,className:"p-2.5 rounded-apple-md bg-white border border-gray-100 text-ios-amber hover:bg-ios-amber/5 transition-all ios-tap group",title:"  ",children:v.jsx(_S,{className:"w-4 h-4 group-hover:scale-110 transition-transform"})}),v.jsx("button",{onClick:ce,className:"p-2.5 rounded-apple-md bg-white border border-gray-100 text-ios-emerald hover:bg-ios-emerald/5 transition-all ios-tap group",title:" ",children:v.jsx(yS,{className:"w-4 h-4 group-hover:scale-110 transition-transform"})}),v.jsx("div",{className:"h-6 w-[1px] bg-gray-200 mx-2"}),v.jsxs("button",{onClick:K,disabled:E,className:"flex items-center gap-2 bg-[#1C1C1E] text-white px-5 py-2.5 rounded-apple-md text-[12px] font-black hover:bg-black transition-all ios-tap disabled:opacity-50 shadow-lg shadow-black/5",children:[v.jsx(wl,{className:`w-4 h-4 ${E?"animate-spin":""}`})," "]})]})]}),v.jsxs("div",{className:"flex-1 w-full relative overflow-hidden bg-white",children:[P==="structure"&&v.jsx("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 z-20 bg-[#1C1C1E]/80 backdrop-blur-lg px-6 py-2.5 rounded-full border border-white/10 shadow-xl pointer-events-none animate-spring-up",children:v.jsx("span",{className:"text-white text-[11px] font-black tracking-tight",children:"   "})}),v.jsx("div",{className:"w-full h-full flex flex-col",children:v.jsx("div",{ref:e,className:"flex-1 h-full relative overflow-hidden cursor-grab active:cursor-grabbing touch-none select-none scrollbar-hide"})}),v.jsx("div",{className:`absolute top-6 right-6 w-72 transition-all duration-500 ease-apple-out z-40 ${r?"opacity-100 translate-y-0 pointer-events-auto":"opacity-0 translate-y-4 pointer-events-none"}`,children:v.jsxs("div",{className:"glass-material rounded-apple-xl border border-white/40 shadow-2xl p-6 space-y-6",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("h3",{className:"text-[11px] font-black uppercase tracking-[0.2em] text-ios-indigo",children:" "}),v.jsxs("div",{className:"flex gap-1.5",children:[v.jsx("button",{onClick:Q,className:"p-2 rounded-apple-md bg-white/50 hover:bg-white text-ios-indigo transition-all shadow-sm border border-white/40",title:"90 ",children:v.jsx(GS,{className:"w-3.5 h-3.5"})}),v.jsx("button",{onClick:fe,className:"p-2 rounded-apple-md bg-ios-rose/5 hover:bg-ios-rose text-ios-rose hover:text-white transition-all shadow-sm border border-ios-rose/10",title:"",children:v.jsx(ts,{className:"w-3.5 h-3.5"})})]})]}),((te=r==null?void 0:r.data)==null?void 0:te.type)!=="structure"?v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:"Display No"}),v.jsx("input",{type:"text",value:l,onChange:R=>o(R.target.value),className:"w-full bg-white/80 border border-white/60 rounded-[8px] p-2.5 text-xs font-black text-[#1C1C1E] focus:ring-1 focus:ring-ios-indigo",placeholder:": A-01"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:"Zone"}),v.jsxs("select",{value:a,onChange:R=>c(R.target.value),className:"w-full bg-white/80 border border-white/60 rounded-[8px] p-2.5 text-xs font-black text-[#1C1C1E] focus:ring-1 focus:ring-ios-indigo appearance-none",children:[v.jsx("option",{value:"A",children:"Zone A"}),v.jsx("option",{value:"B",children:"Zone B"}),v.jsx("option",{value:"C",children:"Zone C"})]})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1 flex items-center gap-1.5",children:[v.jsx(RS,{className:"w-2.5 h-2.5"})," Zone Color"]}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{type:"color",value:d,onChange:R=>h(R.target.value),className:"w-10 h-10 bg-transparent border-0 rounded-[8px] cursor-pointer overflow-hidden p-0 shadow-sm"}),v.jsx("input",{type:"text",value:d.toUpperCase(),onChange:R=>h(R.target.value),className:"flex-1 bg-white/80 border border-white/60 rounded-[8px] p-2.5 text-[10px] font-black text-[#1C1C1E]"})]})]}),v.jsxs("div",{className:"pt-2",children:[v.jsx("button",{onClick:H,className:"w-full bg-ios-indigo text-white py-3 rounded-apple-md font-black text-[11px] shadow-lg shadow-ios-indigo/20 ios-tap",children:" "}),v.jsx("button",{onClick:()=>n(null),className:"w-full mt-2 text-ios-gray py-2 font-bold text-[10px] hover:text-[#1C1C1E] transition-colors",children:" "})]})]}):v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1 flex items-center gap-1.5",children:""}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{type:"color",value:f,onChange:R=>u(R.target.value),className:"w-10 h-10 bg-transparent border-0 rounded-[8px] cursor-pointer"}),v.jsx("input",{type:"text",value:f.toUpperCase(),onChange:R=>u(R.target.value),className:"flex-1 bg-white/80 border border-white/60 rounded-[8px] p-2.5 text-[10px] font-black"})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:""}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{type:"color",value:p,onChange:R=>m(R.target.value),className:"w-10 h-10 bg-transparent border-0 rounded-[8px] cursor-pointer"}),v.jsx("input",{type:"text",value:p.toUpperCase(),onChange:R=>m(R.target.value),className:"flex-1 bg-white/80 border border-white/60 rounded-[8px] p-2.5 text-[10px] font-black"})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:""}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{type:"color",value:g,onChange:R=>x(R.target.value),className:"w-10 h-10 bg-transparent border-0 rounded-[8px] cursor-pointer"}),v.jsx("input",{type:"text",value:g.toUpperCase(),onChange:R=>x(R.target.value),className:"flex-1 bg-white/80 border border-white/60 rounded-[8px] p-2.5 text-[10px] font-black"})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:["  (",y,"px)"]}),v.jsx("input",{type:"range",min:"6",max:"48",value:y,onChange:R=>w(parseInt(R.target.value)),className:"w-full"})]}),v.jsxs("div",{className:"pt-2",children:[v.jsx("button",{onClick:H,className:"w-full bg-ios-indigo text-white py-3 rounded-apple-md font-black text-[11px] shadow-lg",children:" "}),v.jsx("button",{onClick:()=>n(null),className:"w-full mt-2 text-ios-gray py-2 font-bold text-[10px]",children:""})]})]})]})})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ju={};ju.version="0.18.5";var yy=1252,qE=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Y0={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},G0=function(e){qE.indexOf(e)!=-1&&(yy=Y0[0]=e)};function KE(){G0(1252)}var Rn=function(e){G0(e)};function q0(){Rn(1200),KE()}function Sm(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function JE(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function wy(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var jo=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?JE(e.slice(2)):t==254&&r==255?wy(e.slice(2)):t==65279?e.slice(1):e},Oc=function(t){return String.fromCharCode(t)},Cm=function(t){return String.fromCharCode(t)},Nl,Ui="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Al(e){for(var t="",r=0,n=0,i=0,s=0,l=0,o=0,a=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),l=(r&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,a=i&63,isNaN(n)?o=a=64:isNaN(i)&&(a=64),t+=Ui.charAt(s)+Ui.charAt(l)+Ui.charAt(o)+Ui.charAt(a);return t}function ln(e){var t="",r=0,n=0,i=0,s=0,l=0,o=0,a=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=Ui.indexOf(e.charAt(c++)),l=Ui.indexOf(e.charAt(c++)),r=s<<2|l>>4,t+=String.fromCharCode(r),o=Ui.indexOf(e.charAt(c++)),n=(l&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),a=Ui.indexOf(e.charAt(c++)),i=(o&3)<<6|a,a!==64&&(t+=String.fromCharCode(i));return t}var it=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ti=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function rs(e){return it?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Tm(e){return it?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var tn=function(t){return it?Ti(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function gf(e){if(typeof ArrayBuffer>"u")return tn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function cs(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function QE(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function K0(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return K0(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var fr=it?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ti(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function ZE(e){for(var t=[],r=0,n=e.length+250,i=rs(e.length+255),s=0;s<e.length;++s){var l=e.charCodeAt(s);if(l<128)i[r++]=l;else if(l<2048)i[r++]=192|l>>6&31,i[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|l>>8&7,i[r++]=128|l>>2&63,i[r++]=128|o>>6&15|(l&3)<<4,i[r++]=128|o&63}else i[r++]=224|l>>12&15,i[r++]=128|l>>6&63,i[r++]=128|l&63;r>n&&(t.push(i.slice(0,r)),r=0,i=rs(65535),n=65530)}return t.push(i.slice(0,r)),fr(t)}var Ur=/\u0000/g,Po=/[\u0001-\u0006]/g;function Ua(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function In(e,t){var r=""+e;return r.length>=t?r:Ut("0",t-r.length)+r}function J0(e,t){var r=""+e;return r.length>=t?r:Ut(" ",t-r.length)+r}function Pu(e,t){var r=""+e;return r.length>=t?r:r+Ut(" ",t-r.length)}function e4(e,t){var r=""+Math.round(e);return r.length>=t?r:Ut("0",t-r.length)+r}function t4(e,t){var r=""+e;return r.length>=t?r:Ut("0",t-r.length)+r}var Em=Math.pow(2,32);function fa(e,t){if(e>Em||e<-Em)return e4(e,t);var r=Math.round(e);return t4(r,t)}function Du(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Nm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],fh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function r4(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ge={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Am={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},n4={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ru(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,l=1,o=0,a=1,c=0,d=0,h=Math.floor(i);c<t&&(h=Math.floor(i),o=h*l+s,d=h*c+a,!(i-h<5e-8));)i=1/(i-h),s=l,l=o,a=c,c=d;if(d>t&&(c>t?(d=a,o=s):(d=c,o=l)),!r)return[0,n*o,d];var f=Math.floor(n*o/d);return[f,n*o-f*d,d]}function Ts(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,l=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)l=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var a=new Date(1900,0,1);a.setDate(a.getDate()+n-1),l=[a.getFullYear(),a.getMonth()+1,a.getDate()],s=a.getDay(),n<60&&(s=(s+6)%7),r&&(s=c4(a,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var _y=new Date(1899,11,31,0,0,0),i4=_y.getTime(),s4=new Date(1900,2,1,0,0,0);function by(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=s4&&(r+=24*60*60*1e3),(r-(i4+(e.getTimezoneOffset()-_y.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Q0(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function a4(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function o4(e){var t=e<0?12:11,r=Q0(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function l4(e){var t=Q0(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Ol(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=o4(e):t===10?r=e.toFixed(10).substr(0,12):r=l4(e),Q0(a4(r.toUpperCase()))}function Ws(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Ol(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Tn(14,by(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function c4(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function u4(e,t,r,n){var i="",s=0,l=0,o=r.y,a,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:a=o%100,c=2;break;default:a=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:a=r.m,c=t.length;break;case 3:return fh[r.m-1][1];case 5:return fh[r.m-1][0];default:return fh[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=r.d,c=t.length;break;case 3:return Nm[r.q][0];default:return Nm[r.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?In(r.S,t.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,s=Math.round(l*(r.S+r.u)),s>=60*l&&(s=0),t==="s"?s===0?"0":""+s/l:(i=In(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":a=r.D*24+r.H;break;case"[m]":case"[mm]":a=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":a=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:a=o,c=1;break}var d=c>0?In(a,c):"";return d}function Wi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var ky=/%/g;function f4(e,t,r){var n=t.replace(ky,""),i=t.length-n.length;return pi(e,n,r*Math.pow(10,2*i))+Ut("%",i)}function h4(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return pi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Sy(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Sy(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,a,c,d){return a+c+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Cy=/# (\?+)( ?)\/( ?)(\d+)/;function d4(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),l=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(l===0?Ut(" ",e[1].length+1+e[4].length):J0(l,e[1].length)+e[2]+"/"+e[3]+In(o,e[4].length))}function p4(e,t,r){return r+(t===0?"":""+t)+Ut(" ",e[1].length+2+e[4].length)}var Ty=/^#*0*\.([0#]+)/,Ey=/\).*[0#]/,Ny=/\(###\) ###\\?-####/;function Mr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Om(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Fm(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function g4(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function m4(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function dn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Ey)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?dn("n",n,r):"("+dn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return h4(e,t,r);if(t.indexOf("%")!==-1)return f4(e,t,r);if(t.indexOf("E")!==-1)return Sy(t,r);if(t.charCodeAt(0)===36)return"$"+dn(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,l,o,a=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+fa(a,t.length);if(t.match(/^[#?]+$/))return i=fa(r,0),i==="0"&&(i=""),i.length>t.length?i:Mr(t.substr(0,t.length-i.length))+i;if(s=t.match(Cy))return d4(s,a,c);if(t.match(/^#+0+$/))return c+fa(a,t.length-t.indexOf("0"));if(s=t.match(Ty))return i=Om(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Mr(s[1])).replace(/\.$/,"."+Mr(s[1])).replace(/\.(\d*)$/,function(p,m){return"."+m+Ut("0",Mr(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+Om(a,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Wi(fa(a,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+dn(e,t,-r):Wi(""+(Math.floor(r)+g4(r,s[1].length)))+"."+In(Fm(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return dn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ua(dn(e,t.replace(/[\\-]/g,""),r)),l=0,Ua(Ua(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<i.length?i.charAt(l++):p==="0"?"0":""}));if(t.match(Ny))return i=dn(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),o=Ru(a,Math.pow(10,l)-1,!1),i=""+c,d=pi("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=Pu(o[2],l),d.length<s[4].length&&(d=Mr(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),o=Ru(a,Math.pow(10,l)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?J0(o[1],l)+s[2]+"/"+s[3]+Pu(o[2],l):Ut(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=fa(r,0),t.length<=i.length?i:Mr(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=i.indexOf(".");var h=t.indexOf(".")-l,f=t.length-i.length-h;return Mr(t.substr(0,h)+i+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return l=Fm(r,s[1].length),r<0?"-"+dn(e,t,-r):Wi(m4(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?In(0,3-p.length):"")+p})+"."+In(l,s[1].length);switch(t){case"###,##0.00":return dn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var u=Wi(fa(a,0));return u!=="0"?c+u:"";case"###,###.00":return dn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return dn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function x4(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return pi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function v4(e,t,r){var n=t.replace(ky,""),i=t.length-n.length;return pi(e,n,r*Math.pow(10,2*i))+Ut("%",i)}function Ay(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Ay(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,a,c,d){return a+c+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function $n(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Ey)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?$n("n",n,r):"("+$n("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return x4(e,t,r);if(t.indexOf("%")!==-1)return v4(e,t,r);if(t.indexOf("E")!==-1)return Ay(t,r);if(t.charCodeAt(0)===36)return"$"+$n(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,l,o,a=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+In(a,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Mr(t.substr(0,t.length-i.length))+i;if(s=t.match(Cy))return p4(s,a,c);if(t.match(/^#+0+$/))return c+In(a,t.length-t.indexOf("0"));if(s=t.match(Ty))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Mr(s[1])).replace(/\.$/,"."+Mr(s[1])),i=i.replace(/\.(\d*)$/,function(p,m){return"."+m+Ut("0",Mr(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+a).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Wi(""+a);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+$n(e,t,-r):Wi(""+r)+"."+Ut("0",s[1].length);if(s=t.match(/^#,#*,#0/))return $n(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ua($n(e,t.replace(/[\\-]/g,""),r)),l=0,Ua(Ua(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<i.length?i.charAt(l++):p==="0"?"0":""}));if(t.match(Ny))return i=$n(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),o=Ru(a,Math.pow(10,l)-1,!1),i=""+c,d=pi("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=Pu(o[2],l),d.length<s[4].length&&(d=Mr(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),o=Ru(a,Math.pow(10,l)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?J0(o[1],l)+s[2]+"/"+s[3]+Pu(o[2],l):Ut(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Mr(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=i.indexOf(".");var h=t.indexOf(".")-l,f=t.length-i.length-h;return Mr(t.substr(0,h)+i+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+$n(e,t,-r):Wi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?In(0,3-p.length):"")+p})+"."+In(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var u=Wi(""+a);return u!=="0"?c+u:"";default:if(t.match(/\.[0#?]*$/))return $n(e,t.slice(0,t.lastIndexOf(".")),r)+Mr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function pi(e,t,r){return(r|0)===r?$n(e,t,r):dn(e,t,r)}function y4(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Oy=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function oo(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Du(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Oy))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function w4(e,t,r,n){for(var i=[],s="",l=0,o="",a="t",c,d,h,f="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!Du(e,l))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(h=e.charCodeAt(++l))!==34&&l<e.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++l;break;case"\\":var u=e.charAt(++l),p=u==="("||u===")"?u:"t";i[i.length]={t:p,v:u},++l;break;case"_":i[i.length]={t:"t",v:" "},l+=2;break;case"@":i[i.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(c==null&&(c=Ts(t,r,e.charAt(l+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(l,2)},a=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Ts(t,r),c==null))return"";for(s=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)s+=o;o==="m"&&a.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=f),i[i.length]={t:o,v:s},a=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=Ts(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",f="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",l+=5,f="h"):e.substr(l,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",l+=5,f="h"):(m.t="t",++l),c==null&&m.t==="T")return"";i[i.length]=m,a=o;break;case"[":for(s=o;e.charAt(l++)!=="]"&&l<e.length;)s+=e.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Oy)){if(c==null&&(c=Ts(t,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},a=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",oo(e)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++l<e.length&&(o=e.charAt(l))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++l)===o;)s+=o;i[i.length]={t:o,v:s},a=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)s+=e.charAt(l);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++l;break;case"$":i[i.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++l;break}var g=0,x=0,y;for(l=i.length-1,a="t";l>=0;--l)switch(i[l].t){case"h":case"H":i[l].t=f,a="h",g<1&&(g=1);break;case"s":(y=i[l].v.match(/\.0+$/))&&(x=Math.max(x,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":a=i[l].t;break;case"m":a==="s"&&(i[l].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&i[l].v.match(/[Hh]/)&&(g=1),g<2&&i[l].v.match(/[Mm]/)&&(g=2),g<3&&i[l].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var w="",_;for(l=0;l<i.length;++l)switch(i[l].t){case"t":case"T":case" ":case"D":break;case"X":i[l].v="",i[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[l].v=u4(i[l].t.charCodeAt(0),i[l].v,c,x),i[l].t="t";break;case"n":case"?":for(_=l+1;i[_]!=null&&((o=i[_].t)==="?"||o==="D"||(o===" "||o==="t")&&i[_+1]!=null&&(i[_+1].t==="?"||i[_+1].t==="t"&&i[_+1].v==="/")||i[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[_].v==="/"||i[_].v===" "&&i[_+1]!=null&&i[_+1].t=="?"));)i[l].v+=i[_].v,i[_]={v:"",t:";"},++_;w+=i[l].v,l=_-1;break;case"G":i[l].t="t",i[l].v=Ws(t,r);break}var b="",k,S;if(w.length>0){w.charCodeAt(0)==40?(k=t<0&&w.charCodeAt(0)===45?-t:t,S=pi("n",w,k)):(k=t<0&&n>1?-t:t,S=pi("n",w,k),k<0&&i[0]&&i[0].t=="t"&&(S=S.substr(1),i[0].v="-"+i[0].v)),_=S.length-1;var E=i.length;for(l=0;l<i.length;++l)if(i[l]!=null&&i[l].t!="t"&&i[l].v.indexOf(".")>-1){E=l;break}var F=i.length;if(E===i.length&&S.indexOf("E")===-1){for(l=i.length-1;l>=0;--l)i[l]==null||"n?".indexOf(i[l].t)===-1||(_>=i[l].v.length-1?(_-=i[l].v.length,i[l].v=S.substr(_+1,i[l].v.length)):_<0?i[l].v="":(i[l].v=S.substr(0,_+1),_=-1),i[l].t="t",F=l);_>=0&&F<i.length&&(i[F].v=S.substr(0,_+1)+i[F].v)}else if(E!==i.length&&S.indexOf("E")===-1){for(_=S.indexOf(".")-1,l=E;l>=0;--l)if(!(i[l]==null||"n?".indexOf(i[l].t)===-1)){for(d=i[l].v.indexOf(".")>-1&&l===E?i[l].v.indexOf(".")-1:i[l].v.length-1,b=i[l].v.substr(d+1);d>=0;--d)_>=0&&(i[l].v.charAt(d)==="0"||i[l].v.charAt(d)==="#")&&(b=S.charAt(_--)+b);i[l].v=b,i[l].t="t",F=l}for(_>=0&&F<i.length&&(i[F].v=S.substr(0,_+1)+i[F].v),_=S.indexOf(".")+1,l=E;l<i.length;++l)if(!(i[l]==null||"n?(".indexOf(i[l].t)===-1&&l!==E)){for(d=i[l].v.indexOf(".")>-1&&l===E?i[l].v.indexOf(".")+1:0,b=i[l].v.substr(0,d);d<i[l].v.length;++d)_<S.length&&(b+=S.charAt(_++));i[l].v=b,i[l].t="t",F=l}}}for(l=0;l<i.length;++l)i[l]!=null&&"n?".indexOf(i[l].t)>-1&&(k=n>1&&t<0&&l>0&&i[l-1].v==="-"?-t:t,i[l].v=pi(i[l].t,i[l].v,k),i[l].t="t");var P="";for(l=0;l!==i.length;++l)i[l]!=null&&(P+=i[l].v);return P}var jm=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Pm(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function _4(e,t){var r=y4(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(jm),o=r[1].match(jm);return Pm(t,l)?[n,r[0]]:Pm(t,o)?[n,r[1]]:[n,r[l!=null&&o!=null?2:1]]}return[n,s]}function Tn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ge)[e],n==null&&(n=r.table&&r.table[Am[e]]||Ge[Am[e]]),n==null&&(n=n4[e]||"General");break}if(Du(n,0))return Ws(t,r);t instanceof Date&&(t=by(t,r.date1904));var i=_4(n,t);if(Du(i[1]))return Ws(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return w4(i[1],t,r,i[0])}function gi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ge[r]==null){t<0&&(t=r);continue}if(Ge[r]==e){t=r;break}}t<0&&(t=391)}return Ge[t]=e,t}function mf(e){for(var t=0;t!=392;++t)e[t]!==void 0&&gi(e[t],t)}function lo(){Ge=r4()}var b4={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Fy=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function k4(e){var t=typeof e=="number"?Ge[e]:e;return t=t.replace(Fy,"(\\d+)"),new RegExp("^"+t+"$")}function S4(e,t,r){var n=-1,i=-1,s=-1,l=-1,o=-1,a=-1;(t.match(Fy)||[]).forEach(function(h,f){var u=parseInt(r[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=u;break;case"d":s=u;break;case"h":l=u;break;case"s":a=u;break;case"m":l>=0?o=u:i=u;break}}),a>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var d=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2);return l==-1&&o==-1&&a==-1?c:n==-1&&i==-1&&s==-1?d:c+"T"+d}var C4=function(){var e={};e.version="1.2.0";function t(){for(var S=0,E=new Array(256),F=0;F!=256;++F)S=F,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,E[F]=S;return typeof Int32Array<"u"?new Int32Array(E):E}var r=t();function n(S){var E=0,F=0,P=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(P=0;P!=256;++P)D[P]=S[P];for(P=0;P!=256;++P)for(F=S[P],E=256+P;E<4096;E+=256)F=D[E]=F>>>8^S[F&255];var I=[];for(P=1;P!=16;++P)I[P-1]=typeof Int32Array<"u"?D.subarray(P*256,P*256+256):D.slice(P*256,P*256+256);return I}var i=n(r),s=i[0],l=i[1],o=i[2],a=i[3],c=i[4],d=i[5],h=i[6],f=i[7],u=i[8],p=i[9],m=i[10],g=i[11],x=i[12],y=i[13],w=i[14];function _(S,E){for(var F=E^-1,P=0,D=S.length;P<D;)F=F>>>8^r[(F^S.charCodeAt(P++))&255];return~F}function b(S,E){for(var F=E^-1,P=S.length-15,D=0;D<P;)F=w[S[D++]^F&255]^y[S[D++]^F>>8&255]^x[S[D++]^F>>16&255]^g[S[D++]^F>>>24]^m[S[D++]]^p[S[D++]]^u[S[D++]]^f[S[D++]]^h[S[D++]]^d[S[D++]]^c[S[D++]]^a[S[D++]]^o[S[D++]]^l[S[D++]]^s[S[D++]]^r[S[D++]];for(P+=15;D<P;)F=F>>>8^r[(F^S[D++])&255];return~F}function k(S,E){for(var F=E^-1,P=0,D=S.length,I=0,X=0;P<D;)I=S.charCodeAt(P++),I<128?F=F>>>8^r[(F^I)&255]:I<2048?(F=F>>>8^r[(F^(192|I>>6&31))&255],F=F>>>8^r[(F^(128|I&63))&255]):I>=55296&&I<57344?(I=(I&1023)+64,X=S.charCodeAt(P++)&1023,F=F>>>8^r[(F^(240|I>>8&7))&255],F=F>>>8^r[(F^(128|I>>2&63))&255],F=F>>>8^r[(F^(128|X>>6&15|(I&3)<<4))&255],F=F>>>8^r[(F^(128|X&63))&255]):(F=F>>>8^r[(F^(224|I>>12&15))&255],F=F>>>8^r[(F^(128|I>>6&63))&255],F=F>>>8^r[(F^(128|I&63))&255]);return~F}return e.table=r,e.bstr=_,e.buf=b,e.str=k,e}(),Xe=function(){var t={};t.version="1.2.1";function r(W,ee){for(var q=W.split("/"),J=ee.split("/"),re=0,se=0,me=Math.min(q.length,J.length);re<me;++re){if(se=q[re].length-J[re].length)return se;if(q[re]!=J[re])return q[re]<J[re]?-1:1}return q.length-J.length}function n(W){if(W.charAt(W.length-1)=="/")return W.slice(0,-1).indexOf("/")===-1?W:n(W.slice(0,-1));var ee=W.lastIndexOf("/");return ee===-1?W:W.slice(0,ee+1)}function i(W){if(W.charAt(W.length-1)=="/")return i(W.slice(0,-1));var ee=W.lastIndexOf("/");return ee===-1?W:W.slice(ee+1)}function s(W,ee){typeof ee=="string"&&(ee=new Date(ee));var q=ee.getHours();q=q<<6|ee.getMinutes(),q=q<<5|ee.getSeconds()>>>1,W.write_shift(2,q);var J=ee.getFullYear()-1980;J=J<<4|ee.getMonth()+1,J=J<<5|ee.getDate(),W.write_shift(2,J)}function l(W){var ee=W.read_shift(2)&65535,q=W.read_shift(2)&65535,J=new Date,re=q&31;q>>>=5;var se=q&15;q>>>=4,J.setMilliseconds(0),J.setFullYear(q+1980),J.setMonth(se-1),J.setDate(re);var me=ee&31;ee>>>=5;var ke=ee&63;return ee>>>=6,J.setHours(ee),J.setMinutes(ke),J.setSeconds(me<<1),J}function o(W){yr(W,0);for(var ee={},q=0;W.l<=W.length-4;){var J=W.read_shift(2),re=W.read_shift(2),se=W.l+re,me={};switch(J){case 21589:q=W.read_shift(1),q&1&&(me.mtime=W.read_shift(4)),re>5&&(q&2&&(me.atime=W.read_shift(4)),q&4&&(me.ctime=W.read_shift(4))),me.mtime&&(me.mt=new Date(me.mtime*1e3));break}W.l=se,ee[J]=me}return ee}var a;function c(){return a||(a={})}function d(W,ee){if(W[0]==80&&W[1]==75)return Up(W,ee);if((W[0]|32)==109&&(W[1]|32)==105)return t2(W,ee);if(W.length<512)throw new Error("CFB file size "+W.length+" < 512");var q=3,J=512,re=0,se=0,me=0,ke=0,ge=0,xe=[],ye=W.slice(0,512);yr(ye,0);var Oe=h(ye);switch(q=Oe[0],q){case 3:J=512;break;case 4:J=4096;break;case 0:if(Oe[1]==0)return Up(W,ee);default:throw new Error("Major Version: Expected 3 or 4 saw "+q)}J!==512&&(ye=W.slice(0,J),yr(ye,28));var Le=W.slice(0,J);f(ye,q);var ze=ye.read_shift(4,"i");if(q===3&&ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ze);ye.l+=4,me=ye.read_shift(4,"i"),ye.l+=4,ye.chk("00100000","Mini Stream Cutoff Size: "),ke=ye.read_shift(4,"i"),re=ye.read_shift(4,"i"),ge=ye.read_shift(4,"i"),se=ye.read_shift(4,"i");for(var Pe=-1,Be=0;Be<109&&(Pe=ye.read_shift(4,"i"),!(Pe<0));++Be)xe[Be]=Pe;var tt=u(W,J);g(ge,se,tt,J,xe);var At=y(tt,me,xe,J);At[me].name="!Directory",re>0&&ke!==X&&(At[ke].name="!MiniFAT"),At[xe[0]].name="!FAT",At.fat_addrs=xe,At.ssz=J;var Ot={},kr=[],fo=[],ho=[];w(me,At,tt,kr,re,Ot,fo,ke),p(fo,ho,kr),kr.shift();var po={FileIndex:fo,FullPaths:ho};return ee&&ee.raw&&(po.raw={header:Le,sectors:tt}),po}function h(W){if(W[W.l]==80&&W[W.l+1]==75)return[0,0];W.chk(z,"Header Signature: "),W.l+=16;var ee=W.read_shift(2,"u");return[W.read_shift(2,"u"),ee]}function f(W,ee){var q=9;switch(W.l+=2,q=W.read_shift(2)){case 9:if(ee!=3)throw new Error("Sector Shift: Expected 9 saw "+q);break;case 12:if(ee!=4)throw new Error("Sector Shift: Expected 12 saw "+q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+q)}W.chk("0600","Mini Sector Shift: "),W.chk("000000000000","Reserved: ")}function u(W,ee){for(var q=Math.ceil(W.length/ee)-1,J=[],re=1;re<q;++re)J[re-1]=W.slice(re*ee,(re+1)*ee);return J[q-1]=W.slice(q*ee),J}function p(W,ee,q){for(var J=0,re=0,se=0,me=0,ke=0,ge=q.length,xe=[],ye=[];J<ge;++J)xe[J]=ye[J]=J,ee[J]=q[J];for(;ke<ye.length;++ke)J=ye[ke],re=W[J].L,se=W[J].R,me=W[J].C,xe[J]===J&&(re!==-1&&xe[re]!==re&&(xe[J]=xe[re]),se!==-1&&xe[se]!==se&&(xe[J]=xe[se])),me!==-1&&(xe[me]=J),re!==-1&&J!=xe[J]&&(xe[re]=xe[J],ye.lastIndexOf(re)<ke&&ye.push(re)),se!==-1&&J!=xe[J]&&(xe[se]=xe[J],ye.lastIndexOf(se)<ke&&ye.push(se));for(J=1;J<ge;++J)xe[J]===J&&(se!==-1&&xe[se]!==se?xe[J]=xe[se]:re!==-1&&xe[re]!==re&&(xe[J]=xe[re]));for(J=1;J<ge;++J)if(W[J].type!==0){if(ke=J,ke!=xe[ke])do ke=xe[ke],ee[J]=ee[ke]+"/"+ee[J];while(ke!==0&&xe[ke]!==-1&&ke!=xe[ke]);xe[J]=-1}for(ee[0]+="/",J=1;J<ge;++J)W[J].type!==2&&(ee[J]+="/")}function m(W,ee,q){for(var J=W.start,re=W.size,se=[],me=J;q&&re>0&&me>=0;)se.push(ee.slice(me*I,me*I+I)),re-=I,me=_s(q,me*4);return se.length===0?be(0):fr(se).slice(0,W.size)}function g(W,ee,q,J,re){var se=X;if(W===X){if(ee!==0)throw new Error("DIFAT chain shorter than expected")}else if(W!==-1){var me=q[W],ke=(J>>>2)-1;if(!me)return;for(var ge=0;ge<ke&&(se=_s(me,ge*4))!==X;++ge)re.push(se);g(_s(me,J-4),ee-1,q,J,re)}}function x(W,ee,q,J,re){var se=[],me=[];re||(re=[]);var ke=J-1,ge=0,xe=0;for(ge=ee;ge>=0;){re[ge]=!0,se[se.length]=ge,me.push(W[ge]);var ye=q[Math.floor(ge*4/J)];if(xe=ge*4&ke,J<4+xe)throw new Error("FAT boundary crossed: "+ge+" 4 "+J);if(!W[ye])break;ge=_s(W[ye],xe)}return{nodes:se,data:Vm([me])}}function y(W,ee,q,J){var re=W.length,se=[],me=[],ke=[],ge=[],xe=J-1,ye=0,Oe=0,Le=0,ze=0;for(ye=0;ye<re;++ye)if(ke=[],Le=ye+ee,Le>=re&&(Le-=re),!me[Le]){ge=[];var Pe=[];for(Oe=Le;Oe>=0;){Pe[Oe]=!0,me[Oe]=!0,ke[ke.length]=Oe,ge.push(W[Oe]);var Be=q[Math.floor(Oe*4/J)];if(ze=Oe*4&xe,J<4+ze)throw new Error("FAT boundary crossed: "+Oe+" 4 "+J);if(!W[Be]||(Oe=_s(W[Be],ze),Pe[Oe]))break}se[Le]={nodes:ke,data:Vm([ge])}}return se}function w(W,ee,q,J,re,se,me,ke){for(var ge=0,xe=J.length?2:0,ye=ee[W].data,Oe=0,Le=0,ze;Oe<ye.length;Oe+=128){var Pe=ye.slice(Oe,Oe+128);yr(Pe,64),Le=Pe.read_shift(2),ze=sp(Pe,0,Le-xe),J.push(ze);var Be={name:ze,type:Pe.read_shift(1),color:Pe.read_shift(1),L:Pe.read_shift(4,"i"),R:Pe.read_shift(4,"i"),C:Pe.read_shift(4,"i"),clsid:Pe.read_shift(16),state:Pe.read_shift(4,"i"),start:0,size:0},tt=Pe.read_shift(2)+Pe.read_shift(2)+Pe.read_shift(2)+Pe.read_shift(2);tt!==0&&(Be.ct=_(Pe,Pe.l-8));var At=Pe.read_shift(2)+Pe.read_shift(2)+Pe.read_shift(2)+Pe.read_shift(2);At!==0&&(Be.mt=_(Pe,Pe.l-8)),Be.start=Pe.read_shift(4,"i"),Be.size=Pe.read_shift(4,"i"),Be.size<0&&Be.start<0&&(Be.size=Be.type=0,Be.start=X,Be.name=""),Be.type===5?(ge=Be.start,re>0&&ge!==X&&(ee[ge].name="!StreamData")):Be.size>=4096?(Be.storage="fat",ee[Be.start]===void 0&&(ee[Be.start]=x(q,Be.start,ee.fat_addrs,ee.ssz)),ee[Be.start].name=Be.name,Be.content=ee[Be.start].data.slice(0,Be.size)):(Be.storage="minifat",Be.size<0?Be.size=0:ge!==X&&Be.start!==X&&ee[ge]&&(Be.content=m(Be,ee[ge].data,(ee[ke]||{}).data))),Be.content&&yr(Be.content,0),se[ze]=Be,me.push(Be)}}function _(W,ee){return new Date((en(W,ee+4)/1e7*Math.pow(2,32)+en(W,ee)/1e7-11644473600)*1e3)}function b(W,ee){return c(),d(a.readFileSync(W),ee)}function k(W,ee){var q=ee&&ee.type;switch(q||it&&Buffer.isBuffer(W)&&(q="buffer"),q||"base64"){case"file":return b(W,ee);case"base64":return d(tn(ln(W)),ee);case"binary":return d(tn(W),ee)}return d(W,ee)}function S(W,ee){var q=ee||{},J=q.root||"Root Entry";if(W.FullPaths||(W.FullPaths=[]),W.FileIndex||(W.FileIndex=[]),W.FullPaths.length!==W.FileIndex.length)throw new Error("inconsistent CFB structure");W.FullPaths.length===0&&(W.FullPaths[0]=J+"/",W.FileIndex[0]={name:J,type:5}),q.CLSID&&(W.FileIndex[0].clsid=q.CLSID),E(W)}function E(W){var ee="Sh33tJ5";if(!Xe.find(W,"/"+ee)){var q=be(4);q[0]=55,q[1]=q[3]=50,q[2]=54,W.FileIndex.push({name:ee,type:2,content:q,size:4,L:69,R:69,C:69}),W.FullPaths.push(W.FullPaths[0]+ee),F(W)}}function F(W,ee){S(W);for(var q=!1,J=!1,re=W.FullPaths.length-1;re>=0;--re){var se=W.FileIndex[re];switch(se.type){case 0:J?q=!0:(W.FileIndex.pop(),W.FullPaths.pop());break;case 1:case 2:case 5:J=!0,isNaN(se.R*se.L*se.C)&&(q=!0),se.R>-1&&se.L>-1&&se.R==se.L&&(q=!0);break;default:q=!0;break}}if(!(!q&&!ee)){var me=new Date(1987,1,19),ke=0,ge=Object.create?Object.create(null):{},xe=[];for(re=0;re<W.FullPaths.length;++re)ge[W.FullPaths[re]]=!0,W.FileIndex[re].type!==0&&xe.push([W.FullPaths[re],W.FileIndex[re]]);for(re=0;re<xe.length;++re){var ye=n(xe[re][0]);J=ge[ye],J||(xe.push([ye,{name:i(ye).replace("/",""),type:1,clsid:ae,ct:me,mt:me,content:null}]),ge[ye]=!0)}for(xe.sort(function(ze,Pe){return r(ze[0],Pe[0])}),W.FullPaths=[],W.FileIndex=[],re=0;re<xe.length;++re)W.FullPaths[re]=xe[re][0],W.FileIndex[re]=xe[re][1];for(re=0;re<xe.length;++re){var Oe=W.FileIndex[re],Le=W.FullPaths[re];if(Oe.name=i(Le).replace("/",""),Oe.L=Oe.R=Oe.C=-(Oe.color=1),Oe.size=Oe.content?Oe.content.length:0,Oe.start=0,Oe.clsid=Oe.clsid||ae,re===0)Oe.C=xe.length>1?1:-1,Oe.size=0,Oe.type=5;else if(Le.slice(-1)=="/"){for(ke=re+1;ke<xe.length&&n(W.FullPaths[ke])!=Le;++ke);for(Oe.C=ke>=xe.length?-1:ke,ke=re+1;ke<xe.length&&n(W.FullPaths[ke])!=n(Le);++ke);Oe.R=ke>=xe.length?-1:ke,Oe.type=1}else n(W.FullPaths[re+1]||"")==n(Le)&&(Oe.R=re+1),Oe.type=2}}}function P(W,ee){var q=ee||{};if(q.fileType=="mad")return r2(W,q);switch(F(W),q.fileType){case"zip":return q_(W,q)}var J=function(ze){for(var Pe=0,Be=0,tt=0;tt<ze.FileIndex.length;++tt){var At=ze.FileIndex[tt];if(At.content){var Ot=At.content.length;Ot>0&&(Ot<4096?Pe+=Ot+63>>6:Be+=Ot+511>>9)}}for(var kr=ze.FullPaths.length+3>>2,fo=Pe+7>>3,ho=Pe+127>>7,po=fo+Be+kr+ho,hs=po+127>>7,Nf=hs<=109?0:Math.ceil((hs-109)/127);po+hs+Nf+127>>7>hs;)Nf=++hs<=109?0:Math.ceil((hs-109)/127);var si=[1,Nf,hs,ho,kr,Be,Pe,0];return ze.FileIndex[0].size=Pe<<6,si[7]=(ze.FileIndex[0].start=si[0]+si[1]+si[2]+si[3]+si[4]+si[5])+(si[6]+7>>3),si}(W),re=be(J[7]<<9),se=0,me=0;{for(se=0;se<8;++se)re.write_shift(1,G[se]);for(se=0;se<8;++se)re.write_shift(2,0);for(re.write_shift(2,62),re.write_shift(2,3),re.write_shift(2,65534),re.write_shift(2,9),re.write_shift(2,6),se=0;se<3;++se)re.write_shift(2,0);for(re.write_shift(4,0),re.write_shift(4,J[2]),re.write_shift(4,J[0]+J[1]+J[2]+J[3]-1),re.write_shift(4,0),re.write_shift(4,4096),re.write_shift(4,J[3]?J[0]+J[1]+J[2]-1:X),re.write_shift(4,J[3]),re.write_shift(-4,J[1]?J[0]-1:X),re.write_shift(4,J[1]),se=0;se<109;++se)re.write_shift(-4,se<J[2]?J[1]+se:-1)}if(J[1])for(me=0;me<J[1];++me){for(;se<236+me*127;++se)re.write_shift(-4,se<J[2]?J[1]+se:-1);re.write_shift(-4,me===J[1]-1?X:me+1)}var ke=function(ze){for(me+=ze;se<me-1;++se)re.write_shift(-4,se+1);ze&&(++se,re.write_shift(-4,X))};for(me=se=0,me+=J[1];se<me;++se)re.write_shift(-4,le.DIFSECT);for(me+=J[2];se<me;++se)re.write_shift(-4,le.FATSECT);ke(J[3]),ke(J[4]);for(var ge=0,xe=0,ye=W.FileIndex[0];ge<W.FileIndex.length;++ge)ye=W.FileIndex[ge],ye.content&&(xe=ye.content.length,!(xe<4096)&&(ye.start=me,ke(xe+511>>9)));for(ke(J[6]+7>>3);re.l&511;)re.write_shift(-4,le.ENDOFCHAIN);for(me=se=0,ge=0;ge<W.FileIndex.length;++ge)ye=W.FileIndex[ge],ye.content&&(xe=ye.content.length,!(!xe||xe>=4096)&&(ye.start=me,ke(xe+63>>6)));for(;re.l&511;)re.write_shift(-4,le.ENDOFCHAIN);for(se=0;se<J[4]<<2;++se){var Oe=W.FullPaths[se];if(!Oe||Oe.length===0){for(ge=0;ge<17;++ge)re.write_shift(4,0);for(ge=0;ge<3;++ge)re.write_shift(4,-1);for(ge=0;ge<12;++ge)re.write_shift(4,0);continue}ye=W.FileIndex[se],se===0&&(ye.start=ye.size?ye.start-1:X);var Le=se===0&&q.root||ye.name;if(xe=2*(Le.length+1),re.write_shift(64,Le,"utf16le"),re.write_shift(2,xe),re.write_shift(1,ye.type),re.write_shift(1,ye.color),re.write_shift(-4,ye.L),re.write_shift(-4,ye.R),re.write_shift(-4,ye.C),ye.clsid)re.write_shift(16,ye.clsid,"hex");else for(ge=0;ge<4;++ge)re.write_shift(4,0);re.write_shift(4,ye.state||0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,ye.start),re.write_shift(4,ye.size),re.write_shift(4,0)}for(se=1;se<W.FileIndex.length;++se)if(ye=W.FileIndex[se],ye.size>=4096)if(re.l=ye.start+1<<9,it&&Buffer.isBuffer(ye.content))ye.content.copy(re,re.l,0,ye.size),re.l+=ye.size+511&-512;else{for(ge=0;ge<ye.size;++ge)re.write_shift(1,ye.content[ge]);for(;ge&511;++ge)re.write_shift(1,0)}for(se=1;se<W.FileIndex.length;++se)if(ye=W.FileIndex[se],ye.size>0&&ye.size<4096)if(it&&Buffer.isBuffer(ye.content))ye.content.copy(re,re.l,0,ye.size),re.l+=ye.size+63&-64;else{for(ge=0;ge<ye.size;++ge)re.write_shift(1,ye.content[ge]);for(;ge&63;++ge)re.write_shift(1,0)}if(it)re.l=re.length;else for(;re.l<re.length;)re.write_shift(1,0);return re}function D(W,ee){var q=W.FullPaths.map(function(ge){return ge.toUpperCase()}),J=q.map(function(ge){var xe=ge.split("/");return xe[xe.length-(ge.slice(-1)=="/"?2:1)]}),re=!1;ee.charCodeAt(0)===47?(re=!0,ee=q[0].slice(0,-1)+ee):re=ee.indexOf("/")!==-1;var se=ee.toUpperCase(),me=re===!0?q.indexOf(se):J.indexOf(se);if(me!==-1)return W.FileIndex[me];var ke=!se.match(Po);for(se=se.replace(Ur,""),ke&&(se=se.replace(Po,"!")),me=0;me<q.length;++me)if((ke?q[me].replace(Po,"!"):q[me]).replace(Ur,"")==se||(ke?J[me].replace(Po,"!"):J[me]).replace(Ur,"")==se)return W.FileIndex[me];return null}var I=64,X=-2,z="d0cf11e0a1b11ae1",G=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:X,FREESECT:-1,HEADER_SIGNATURE:z,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Z(W,ee,q){c();var J=P(W,q);a.writeFileSync(ee,J)}function C(W){for(var ee=new Array(W.length),q=0;q<W.length;++q)ee[q]=String.fromCharCode(W[q]);return ee.join("")}function L(W,ee){var q=P(W,ee);switch(ee&&ee.type||"buffer"){case"file":return c(),a.writeFileSync(ee.filename,q),q;case"binary":return typeof q=="string"?q:C(q);case"base64":return Al(typeof q=="string"?q:C(q));case"buffer":if(it)return Buffer.isBuffer(q)?q:Ti(q);case"array":return typeof q=="string"?tn(q):q}return q}var B;function N(W){try{var ee=W.InflateRaw,q=new ee;if(q._processChunk(new Uint8Array([3,0]),q._finishFlushFlag),q.bytesRead)B=W;else throw new Error("zlib does not expose bytesRead")}catch(J){console.error("cannot use native zlib: "+(J.message||J))}}function U(W,ee){if(!B)return fn(W,ee);var q=B.InflateRaw,J=new q,re=J._processChunk(W.slice(W.l),J._finishFlushFlag);return W.l+=J.bytesRead,re}function A(W){return B?B.deflateRawSync(W):Ne(W)}var T=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],j=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],M=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Y(W){var ee=(W<<1|W<<11)&139536|(W<<5|W<<15)&558144;return(ee>>16|ee>>8|ee)&255}for(var H=typeof Uint8Array<"u",V=H?new Uint8Array(256):[],fe=0;fe<256;++fe)V[fe]=Y(fe);function O(W,ee){var q=V[W&255];return ee<=8?q>>>8-ee:(q=q<<8|V[W>>8&255],ee<=16?q>>>16-ee:(q=q<<8|V[W>>16&255],q>>>24-ee))}function Q(W,ee){var q=ee&7,J=ee>>>3;return(W[J]|(q<=6?0:W[J+1]<<8))>>>q&3}function K(W,ee){var q=ee&7,J=ee>>>3;return(W[J]|(q<=5?0:W[J+1]<<8))>>>q&7}function ce(W,ee){var q=ee&7,J=ee>>>3;return(W[J]|(q<=4?0:W[J+1]<<8))>>>q&15}function te(W,ee){var q=ee&7,J=ee>>>3;return(W[J]|(q<=3?0:W[J+1]<<8))>>>q&31}function R(W,ee){var q=ee&7,J=ee>>>3;return(W[J]|(q<=1?0:W[J+1]<<8))>>>q&127}function ue(W,ee,q){var J=ee&7,re=ee>>>3,se=(1<<q)-1,me=W[re]>>>J;return q<8-J||(me|=W[re+1]<<8-J,q<16-J)||(me|=W[re+2]<<16-J,q<24-J)||(me|=W[re+3]<<24-J),me&se}function oe(W,ee,q){var J=ee&7,re=ee>>>3;return J<=5?W[re]|=(q&7)<<J:(W[re]|=q<<J&255,W[re+1]=(q&7)>>8-J),ee+3}function he(W,ee,q){var J=ee&7,re=ee>>>3;return q=(q&1)<<J,W[re]|=q,ee+1}function de(W,ee,q){var J=ee&7,re=ee>>>3;return q<<=J,W[re]|=q&255,q>>>=8,W[re+1]=q,ee+8}function ie(W,ee,q){var J=ee&7,re=ee>>>3;return q<<=J,W[re]|=q&255,q>>>=8,W[re+1]=q&255,W[re+2]=q>>>8,ee+16}function pe(W,ee){var q=W.length,J=2*q>ee?2*q:ee+5,re=0;if(q>=ee)return W;if(it){var se=Tm(J);if(W.copy)W.copy(se);else for(;re<W.length;++re)se[re]=W[re];return se}else if(H){var me=new Uint8Array(J);if(me.set)me.set(W);else for(;re<q;++re)me[re]=W[re];return me}return W.length=J,W}function Se(W){for(var ee=new Array(W),q=0;q<W;++q)ee[q]=0;return ee}function De(W,ee,q){var J=1,re=0,se=0,me=0,ke=0,ge=W.length,xe=H?new Uint16Array(32):Se(32);for(se=0;se<32;++se)xe[se]=0;for(se=ge;se<q;++se)W[se]=0;ge=W.length;var ye=H?new Uint16Array(ge):Se(ge);for(se=0;se<ge;++se)xe[re=W[se]]++,J<re&&(J=re),ye[se]=0;for(xe[0]=0,se=1;se<=J;++se)xe[se+16]=ke=ke+xe[se-1]<<1;for(se=0;se<ge;++se)ke=W[se],ke!=0&&(ye[se]=xe[ke+16]++);var Oe=0;for(se=0;se<ge;++se)if(Oe=W[se],Oe!=0)for(ke=O(ye[se],J)>>J-Oe,me=(1<<J+4-Oe)-1;me>=0;--me)ee[ke|me<<Oe]=Oe&15|se<<4;return J}var we=H?new Uint16Array(512):Se(512),ve=H?new Uint16Array(32):Se(32);if(!H){for(var Ae=0;Ae<512;++Ae)we[Ae]=0;for(Ae=0;Ae<32;++Ae)ve[Ae]=0}(function(){for(var W=[],ee=0;ee<32;ee++)W.push(5);De(W,ve,32);var q=[];for(ee=0;ee<=143;ee++)q.push(8);for(;ee<=255;ee++)q.push(9);for(;ee<=279;ee++)q.push(7);for(;ee<=287;ee++)q.push(8);De(q,we,288)})();var Ee=function(){for(var ee=H?new Uint8Array(32768):[],q=0,J=0;q<M.length-1;++q)for(;J<M[q+1];++J)ee[J]=q;for(;J<32768;++J)ee[J]=29;var re=H?new Uint8Array(259):[];for(q=0,J=0;q<j.length-1;++q)for(;J<j[q+1];++J)re[J]=q;function se(ke,ge){for(var xe=0;xe<ke.length;){var ye=Math.min(65535,ke.length-xe),Oe=xe+ye==ke.length;for(ge.write_shift(1,+Oe),ge.write_shift(2,ye),ge.write_shift(2,~ye&65535);ye-- >0;)ge[ge.l++]=ke[xe++]}return ge.l}function me(ke,ge){for(var xe=0,ye=0,Oe=H?new Uint16Array(32768):[];ye<ke.length;){var Le=Math.min(65535,ke.length-ye);if(Le<10){for(xe=oe(ge,xe,+(ye+Le==ke.length)),xe&7&&(xe+=8-(xe&7)),ge.l=xe/8|0,ge.write_shift(2,Le),ge.write_shift(2,~Le&65535);Le-- >0;)ge[ge.l++]=ke[ye++];xe=ge.l*8;continue}xe=oe(ge,xe,+(ye+Le==ke.length)+2);for(var ze=0;Le-- >0;){var Pe=ke[ye];ze=(ze<<5^Pe)&32767;var Be=-1,tt=0;if((Be=Oe[ze])&&(Be|=ye&-32768,Be>ye&&(Be-=32768),Be<ye))for(;ke[Be+tt]==ke[ye+tt]&&tt<250;)++tt;if(tt>2){Pe=re[tt],Pe<=22?xe=de(ge,xe,V[Pe+1]>>1)-1:(de(ge,xe,3),xe+=5,de(ge,xe,V[Pe-23]>>5),xe+=3);var At=Pe<8?0:Pe-4>>2;At>0&&(ie(ge,xe,tt-j[Pe]),xe+=At),Pe=ee[ye-Be],xe=de(ge,xe,V[Pe]>>3),xe-=3;var Ot=Pe<4?0:Pe-2>>1;Ot>0&&(ie(ge,xe,ye-Be-M[Pe]),xe+=Ot);for(var kr=0;kr<tt;++kr)Oe[ze]=ye&32767,ze=(ze<<5^ke[ye])&32767,++ye;Le-=tt-1}else Pe<=143?Pe=Pe+48:xe=he(ge,xe,1),xe=de(ge,xe,V[Pe]),Oe[ze]=ye&32767,++ye}xe=de(ge,xe,0)-1}return ge.l=(xe+7)/8|0,ge.l}return function(ge,xe){return ge.length<8?se(ge,xe):me(ge,xe)}}();function Ne(W){var ee=be(50+Math.floor(W.length*1.1)),q=Ee(W,ee);return ee.slice(0,q)}var Ie=H?new Uint16Array(32768):Se(32768),We=H?new Uint16Array(32768):Se(32768),Te=H?new Uint16Array(128):Se(128),et=1,vt=1;function Kt(W,ee){var q=te(W,ee)+257;ee+=5;var J=te(W,ee)+1;ee+=5;var re=ce(W,ee)+4;ee+=4;for(var se=0,me=H?new Uint8Array(19):Se(19),ke=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ge=1,xe=H?new Uint8Array(8):Se(8),ye=H?new Uint8Array(8):Se(8),Oe=me.length,Le=0;Le<re;++Le)me[T[Le]]=se=K(W,ee),ge<se&&(ge=se),xe[se]++,ee+=3;var ze=0;for(xe[0]=0,Le=1;Le<=ge;++Le)ye[Le]=ze=ze+xe[Le-1]<<1;for(Le=0;Le<Oe;++Le)(ze=me[Le])!=0&&(ke[Le]=ye[ze]++);var Pe=0;for(Le=0;Le<Oe;++Le)if(Pe=me[Le],Pe!=0){ze=V[ke[Le]]>>8-Pe;for(var Be=(1<<7-Pe)-1;Be>=0;--Be)Te[ze|Be<<Pe]=Pe&7|Le<<3}var tt=[];for(ge=1;tt.length<q+J;)switch(ze=Te[R(W,ee)],ee+=ze&7,ze>>>=3){case 16:for(se=3+Q(W,ee),ee+=2,ze=tt[tt.length-1];se-- >0;)tt.push(ze);break;case 17:for(se=3+K(W,ee),ee+=3;se-- >0;)tt.push(0);break;case 18:for(se=11+R(W,ee),ee+=7;se-- >0;)tt.push(0);break;default:tt.push(ze),ge<ze&&(ge=ze);break}var At=tt.slice(0,q),Ot=tt.slice(q);for(Le=q;Le<286;++Le)At[Le]=0;for(Le=J;Le<30;++Le)Ot[Le]=0;return et=De(At,Ie,286),vt=De(Ot,We,30),ee}function lr(W,ee){if(W[0]==3&&!(W[1]&3))return[rs(ee),2];for(var q=0,J=0,re=Tm(ee||1<<18),se=0,me=re.length>>>0,ke=0,ge=0;!(J&1);){if(J=K(W,q),q+=3,J>>>1)J>>1==1?(ke=9,ge=5):(q=Kt(W,q),ke=et,ge=vt);else{q&7&&(q+=8-(q&7));var xe=W[q>>>3]|W[(q>>>3)+1]<<8;if(q+=32,xe>0)for(!ee&&me<se+xe&&(re=pe(re,se+xe),me=re.length);xe-- >0;)re[se++]=W[q>>>3],q+=8;continue}for(;;){!ee&&me<se+32767&&(re=pe(re,se+32767),me=re.length);var ye=ue(W,q,ke),Oe=J>>>1==1?we[ye]:Ie[ye];if(q+=Oe&15,Oe>>>=4,!(Oe>>>8&255))re[se++]=Oe;else{if(Oe==256)break;Oe-=257;var Le=Oe<8?0:Oe-4>>2;Le>5&&(Le=0);var ze=se+j[Oe];Le>0&&(ze+=ue(W,q,Le),q+=Le),ye=ue(W,q,ge),Oe=J>>>1==1?ve[ye]:We[ye],q+=Oe&15,Oe>>>=4;var Pe=Oe<4?0:Oe-2>>1,Be=M[Oe];for(Pe>0&&(Be+=ue(W,q,Pe),q+=Pe),!ee&&me<ze&&(re=pe(re,ze+100),me=re.length);se<ze;)re[se]=re[se-Be],++se}}}return ee?[re,q+7>>>3]:[re.slice(0,se),q+7>>>3]}function fn(W,ee){var q=W.slice(W.l||0),J=lr(q,ee);return W.l+=J[1],J[0]}function Bp(W,ee){if(W)typeof console<"u"&&console.error(ee);else throw new Error(ee)}function Up(W,ee){var q=W;yr(q,0);var J=[],re=[],se={FileIndex:J,FullPaths:re};S(se,{root:ee.root});for(var me=q.length-4;(q[me]!=80||q[me+1]!=75||q[me+2]!=5||q[me+3]!=6)&&me>=0;)--me;q.l=me+4,q.l+=4;var ke=q.read_shift(2);q.l+=6;var ge=q.read_shift(4);for(q.l=ge,me=0;me<ke;++me){q.l+=20;var xe=q.read_shift(4),ye=q.read_shift(4),Oe=q.read_shift(2),Le=q.read_shift(2),ze=q.read_shift(2);q.l+=8;var Pe=q.read_shift(4),Be=o(q.slice(q.l+Oe,q.l+Oe+Le));q.l+=Oe+Le+ze;var tt=q.l;q.l=Pe+4,G_(q,xe,ye,se,Be),q.l=tt}return se}function G_(W,ee,q,J,re){W.l+=2;var se=W.read_shift(2),me=W.read_shift(2),ke=l(W);if(se&8257)throw new Error("Unsupported ZIP encryption");for(var ge=W.read_shift(4),xe=W.read_shift(4),ye=W.read_shift(4),Oe=W.read_shift(2),Le=W.read_shift(2),ze="",Pe=0;Pe<Oe;++Pe)ze+=String.fromCharCode(W[W.l++]);if(Le){var Be=o(W.slice(W.l,W.l+Le));(Be[21589]||{}).mt&&(ke=Be[21589].mt),((re||{})[21589]||{}).mt&&(ke=re[21589].mt)}W.l+=Le;var tt=W.slice(W.l,W.l+xe);switch(me){case 8:tt=U(W,ye);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+me)}var At=!1;se&8&&(ge=W.read_shift(4),ge==134695760&&(ge=W.read_shift(4),At=!0),xe=W.read_shift(4),ye=W.read_shift(4)),xe!=ee&&Bp(At,"Bad compressed size: "+ee+" != "+xe),ye!=q&&Bp(At,"Bad uncompressed size: "+q+" != "+ye),Ef(J,ze,tt,{unsafe:!0,mt:ke})}function q_(W,ee){var q=ee||{},J=[],re=[],se=be(1),me=q.compression?8:0,ke=0,ge=0,xe=0,ye=0,Oe=0,Le=W.FullPaths[0],ze=Le,Pe=W.FileIndex[0],Be=[],tt=0;for(ge=1;ge<W.FullPaths.length;++ge)if(ze=W.FullPaths[ge].slice(Le.length),Pe=W.FileIndex[ge],!(!Pe.size||!Pe.content||ze=="Sh33tJ5")){var At=ye,Ot=be(ze.length);for(xe=0;xe<ze.length;++xe)Ot.write_shift(1,ze.charCodeAt(xe)&127);Ot=Ot.slice(0,Ot.l),Be[Oe]=C4.buf(Pe.content,0);var kr=Pe.content;me==8&&(kr=A(kr)),se=be(30),se.write_shift(4,67324752),se.write_shift(2,20),se.write_shift(2,ke),se.write_shift(2,me),Pe.mt?s(se,Pe.mt):se.write_shift(4,0),se.write_shift(-4,Be[Oe]),se.write_shift(4,kr.length),se.write_shift(4,Pe.content.length),se.write_shift(2,Ot.length),se.write_shift(2,0),ye+=se.length,J.push(se),ye+=Ot.length,J.push(Ot),ye+=kr.length,J.push(kr),se=be(46),se.write_shift(4,33639248),se.write_shift(2,0),se.write_shift(2,20),se.write_shift(2,ke),se.write_shift(2,me),se.write_shift(4,0),se.write_shift(-4,Be[Oe]),se.write_shift(4,kr.length),se.write_shift(4,Pe.content.length),se.write_shift(2,Ot.length),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(4,0),se.write_shift(4,At),tt+=se.l,re.push(se),tt+=Ot.length,re.push(Ot),++Oe}return se=be(22),se.write_shift(4,101010256),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,Oe),se.write_shift(2,Oe),se.write_shift(4,tt),se.write_shift(4,ye),se.write_shift(2,0),fr([fr(J),fr(re),se])}var ac={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function K_(W,ee){if(W.ctype)return W.ctype;var q=W.name||"",J=q.match(/\.([^\.]+)$/);return J&&ac[J[1]]||ee&&(J=(q=ee).match(/[\.\\]([^\.\\])+$/),J&&ac[J[1]])?ac[J[1]]:"application/octet-stream"}function J_(W){for(var ee=Al(W),q=[],J=0;J<ee.length;J+=76)q.push(ee.slice(J,J+76));return q.join(`\r
`)+`\r
`}function Q_(W){var ee=W.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(xe){var ye=xe.charCodeAt(0).toString(16).toUpperCase();return"="+(ye.length==1?"0"+ye:ye)});ee=ee.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ee.charAt(0)==`
`&&(ee="=0D"+ee.slice(1)),ee=ee.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var q=[],J=ee.split(`\r
`),re=0;re<J.length;++re){var se=J[re];if(se.length==0){q.push("");continue}for(var me=0;me<se.length;){var ke=76,ge=se.slice(me,me+ke);ge.charAt(ke-1)=="="?ke--:ge.charAt(ke-2)=="="?ke-=2:ge.charAt(ke-3)=="="&&(ke-=3),ge=se.slice(me,me+ke),me+=ke,me<se.length&&(ge+="="),q.push(ge)}}return q.join(`\r
`)}function Z_(W){for(var ee=[],q=0;q<W.length;++q){for(var J=W[q];q<=W.length&&J.charAt(J.length-1)=="=";)J=J.slice(0,J.length-1)+W[++q];ee.push(J)}for(var re=0;re<ee.length;++re)ee[re]=ee[re].replace(/[=][0-9A-Fa-f]{2}/g,function(se){return String.fromCharCode(parseInt(se.slice(1),16))});return tn(ee.join(`\r
`))}function e2(W,ee,q){for(var J="",re="",se="",me,ke=0;ke<10;++ke){var ge=ee[ke];if(!ge||ge.match(/^\s*$/))break;var xe=ge.match(/^(.*?):\s*([^\s].*)$/);if(xe)switch(xe[1].toLowerCase()){case"content-location":J=xe[2].trim();break;case"content-type":se=xe[2].trim();break;case"content-transfer-encoding":re=xe[2].trim();break}}switch(++ke,re.toLowerCase()){case"base64":me=tn(ln(ee.slice(ke).join("")));break;case"quoted-printable":me=Z_(ee.slice(ke));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+re)}var ye=Ef(W,J.slice(q.length),me,{unsafe:!0});se&&(ye.ctype=se)}function t2(W,ee){if(C(W.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var q=ee&&ee.root||"",J=(it&&Buffer.isBuffer(W)?W.toString("binary"):C(W)).split(`\r
`),re=0,se="";for(re=0;re<J.length;++re)if(se=J[re],!!/^Content-Location:/i.test(se)&&(se=se.slice(se.indexOf("file")),q||(q=se.slice(0,se.lastIndexOf("/")+1)),se.slice(0,q.length)!=q))for(;q.length>0&&(q=q.slice(0,q.length-1),q=q.slice(0,q.lastIndexOf("/")+1),se.slice(0,q.length)!=q););var me=(J[1]||"").match(/boundary="(.*?)"/);if(!me)throw new Error("MAD cannot find boundary");var ke="--"+(me[1]||""),ge=[],xe=[],ye={FileIndex:ge,FullPaths:xe};S(ye);var Oe,Le=0;for(re=0;re<J.length;++re){var ze=J[re];ze!==ke&&ze!==ke+"--"||(Le++&&e2(ye,J.slice(Oe,re),q),Oe=re)}return ye}function r2(W,ee){var q=ee||{},J=q.boundary||"SheetJS";J="------="+J;for(var re=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+J.slice(2)+'"',"","",""],se=W.FullPaths[0],me=se,ke=W.FileIndex[0],ge=1;ge<W.FullPaths.length;++ge)if(me=W.FullPaths[ge].slice(se.length),ke=W.FileIndex[ge],!(!ke.size||!ke.content||me=="Sh33tJ5")){me=me.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(tt){return"_x"+tt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(tt){return"_u"+tt.charCodeAt(0).toString(16)+"_"});for(var xe=ke.content,ye=it&&Buffer.isBuffer(xe)?xe.toString("binary"):C(xe),Oe=0,Le=Math.min(1024,ye.length),ze=0,Pe=0;Pe<=Le;++Pe)(ze=ye.charCodeAt(Pe))>=32&&ze<128&&++Oe;var Be=Oe>=Le*4/5;re.push(J),re.push("Content-Location: "+(q.root||"file:///C:/SheetJS/")+me),re.push("Content-Transfer-Encoding: "+(Be?"quoted-printable":"base64")),re.push("Content-Type: "+K_(ke,me)),re.push(""),re.push(Be?Q_(ye):J_(ye))}return re.push(J+`--\r
`),re.join(`\r
`)}function n2(W){var ee={};return S(ee,W),ee}function Ef(W,ee,q,J){var re=J&&J.unsafe;re||S(W);var se=!re&&Xe.find(W,ee);if(!se){var me=W.FullPaths[0];ee.slice(0,me.length)==me?me=ee:(me.slice(-1)!="/"&&(me+="/"),me=(me+ee).replace("//","/")),se={name:i(ee),type:2},W.FileIndex.push(se),W.FullPaths.push(me),re||Xe.utils.cfb_gc(W)}return se.content=q,se.size=q?q.length:0,J&&(J.CLSID&&(se.clsid=J.CLSID),J.mt&&(se.mt=J.mt),J.ct&&(se.ct=J.ct)),se}function i2(W,ee){S(W);var q=Xe.find(W,ee);if(q){for(var J=0;J<W.FileIndex.length;++J)if(W.FileIndex[J]==q)return W.FileIndex.splice(J,1),W.FullPaths.splice(J,1),!0}return!1}function s2(W,ee,q){S(W);var J=Xe.find(W,ee);if(J){for(var re=0;re<W.FileIndex.length;++re)if(W.FileIndex[re]==J)return W.FileIndex[re].name=i(q),W.FullPaths[re]=q,!0}return!1}function a2(W){F(W,!0)}return t.find=D,t.read=k,t.parse=d,t.write=L,t.writeFile=Z,t.utils={cfb_new:n2,cfb_add:Ef,cfb_del:i2,cfb_mov:s2,cfb_gc:a2,ReadShift:Yo,CheckField:Zy,prep_blob:yr,bconcat:fr,use_zlib:N,_deflateRaw:Ne,_inflateRaw:fn,consts:le},t}();function T4(e){return typeof e=="string"?gf(e):Array.isArray(e)?QE(e):e}function Jl(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=gf(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Qn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([T4(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=cs(t)),o.write(t),o.close(),t}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("cannot save file "+e)}function E4(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function zt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Dm(e,t){for(var r=[],n=zt(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function xf(e){for(var t=[],r=zt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function vf(e){for(var t=[],r=zt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function N4(e){for(var t=[],r=zt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Iu=new Date(1899,11,30,0,0,0);function or(e,t){var r=e.getTime(),n=Iu.getTime()+(e.getTimezoneOffset()-Iu.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var jy=new Date,A4=Iu.getTime()+(jy.getTimezoneOffset()-Iu.getTimezoneOffset())*6e4,Rm=jy.getTimezoneOffset();function yf(e){var t=new Date;return t.setTime(e*24*60*60*1e3+A4),t.getTimezoneOffset()!==Rm&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Rm)*6e4),t}function O4(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var Im=new Date("2017-02-19T19:06:09.000Z"),Py=isNaN(Im.getFullYear())?new Date("2/19/17"):Im,F4=Py.getFullYear()==2017;function Ct(e,t){var r=new Date(e);if(F4)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Py.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function zs(e,t){if(it&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Qn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Qn(wy(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Qn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Qn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Tt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Tt(e[r]));return t}function Ut(e,t){for(var r="";r.length<t;)r+=e;return r}function Bn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var j4=["january","february","march","april","may","june","july","august","september","october","november","december"];function Qa(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&j4.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var P4=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),l=[s[0]],o=1;o<s.length;++o)l.push(i),l.push(s[o]);return l}}();function Dy(e){return e?e.content&&e.type?zs(e.content,!0):e.data?jo(e.data):e.asNodeBuffer&&it?jo(e.asNodeBuffer().toString("binary")):e.asBinary?jo(e.asBinary()):e._data&&e._data.getContent?jo(zs(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Ry(e){if(!e)return null;if(e.data)return Sm(e.data);if(e.asNodeBuffer&&it)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Sm(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function D4(e){return e&&e.name.slice(-4)===".bin"?Ry(e):Dy(e)}function mn(e,t){for(var r=e.FullPaths||zt(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var l=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||i==l)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Z0(e,t){var r=mn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Qt(e,t,r){if(!r)return D4(Z0(e,t));if(!t)return null;try{return Qt(e,t)}catch{return null}}function rn(e,t,r){if(!r)return Dy(Z0(e,t));if(!t)return null;try{return rn(e,t)}catch{return null}}function R4(e,t,r){return Ry(Z0(e,t))}function Mm(e){for(var t=e.FullPaths||zt(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function nt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return it?n=Ti(r):n=ZE(r),Xe.utils.cfb_add(e,t,n)}Xe.utils.cfb_add(e,t,r)}else e.file(t,r)}function ep(){return Xe.utils.cfb_new()}function Iy(e,t){switch(t.type){case"base64":return Xe.read(e,{type:"base64"});case"binary":return Xe.read(e,{type:"binary"});case"buffer":case"array":return Xe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Do(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var qt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,I4=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Lm=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,M4=/<[^>]*>/g,Rr=qt.match(Lm)?Lm:M4,L4=/<\w*:/,B4=/<(\/?)\w+:/;function Qe(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var l=e.match(I4),o=0,a="",c=0,d="",h="",f=1;if(l)for(c=0;c!=l.length;++c){for(h=l[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(d=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(f=(i=h.charCodeAt(s+1))==34||i==39?1:0,a=h.slice(s+1+f,h.length-f),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=a,n[d.toLowerCase()]=a;else{var u=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[u]&&d.slice(o-3,o)=="ext")continue;n[u]=a,n[u.toLowerCase()]=a}}return n}function ni(e){return e.replace(B4,"<$1")}var My={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},tp=xf(My),lt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(o,a){return My[o]||String.fromCharCode(parseInt(a,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,a){return String.fromCharCode(parseInt(a,16))});var l=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,l)+r(i.slice(l+3))}}(),rp=/[&<>'"]/g,U4=/[\u0000-\u0008\u000b-\u001f]/g;function gt(e){var t=e+"";return t.replace(rp,function(r){return tp[r]}).replace(U4,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Bm(e){return gt(e).replace(/ /g,"_x0020_")}var Ly=/[\u0000-\u001f]/g;function np(e){var t=e+"";return t.replace(rp,function(r){return tp[r]}).replace(/\n/g,"<br/>").replace(Ly,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function W4(e){var t=e+"";return t.replace(rp,function(r){return tp[r]}).replace(Ly,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Um=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function z4(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function bt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function hh(e){for(var t="",r=0,n=0,i=0,s=0,l=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=i&63,t+=String.fromCharCode(l);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}l=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Wm(e){var t=rs(2*e.length),r,n,i=1,s=0,l=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[s++]=l&255,t[s++]=l>>>8,l=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function zm(e){return Ti(e,"binary").toString("utf8")}var Fc="foo bar baz",xt=it&&(zm(Fc)==hh(Fc)&&zm||Wm(Fc)==hh(Fc)&&Wm)||hh,Qn=it?function(e){return Ti(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Fl=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),By=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),H4=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),$4=/<\/?(?:vt:)?variant>/g,V4=/<(?:vt:)([^>]*)>([\s\S]*)</;function Hm(e,t){var r=Qe(e),n=e.match(H4(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var l=s.replace($4,"").match(V4);l&&i.push({v:xt(l[2]),t:l[1]})}),i}var Uy=/(^\s|\s$|\n)/;function wr(e,t){return"<"+e+(t.match(Uy)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function jl(e){return zt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Re(e,t,r){return"<"+e+(r!=null?jl(r):"")+(t!=null?(t.match(Uy)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function jd(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function X4(e,t){switch(typeof e){case"string":var r=Re("vt:lpwstr",gt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Re((e|0)==e?"vt:i4":"vt:r8",gt(String(e)));case"boolean":return Re("vt:bool",e?"true":"false")}if(e instanceof Date)return Re("vt:filetime",jd(e));throw new Error("Unable to serialize "+e)}function ip(e){if(it&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return xt(cs(K0(e)));throw new Error("Bad input format: expected Buffer or string")}var Pl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,sr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ks=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Zr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Y4(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function G4(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,l=n?-t:t;isFinite(l)?l==0?i=s=0:(i=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var $m=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},Vm=it?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ti(t)})):$m(e)}:$m,Xm=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(fi(e,i)));return n.join("").replace(Ur,"")},sp=it?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ur,""):Xm(e,t,r)}:Xm,Ym=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},Wy=it?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Ym(e,t,r)}:Ym,Gm=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(va(e,i)));return n.join("")},Ql=it?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Gm(t,r,n)}:Gm,zy=function(e,t){var r=en(e,t);return r>0?Ql(e,t+4,t+4+r-1):""},Hy=zy,$y=function(e,t){var r=en(e,t);return r>0?Ql(e,t+4,t+4+r-1):""},Vy=$y,Xy=function(e,t){var r=2*en(e,t);return r>0?Ql(e,t+4,t+4+r-1):""},Yy=Xy,Gy=function(t,r){var n=en(t,r);return n>0?sp(t,r+4,r+4+n):""},qy=Gy,Ky=function(e,t){var r=en(e,t);return r>0?Ql(e,t+4,t+4+r):""},Jy=Ky,Qy=function(e,t){return Y4(e,t)},Mu=Qy,ap=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};it&&(Hy=function(t,r){if(!Buffer.isBuffer(t))return zy(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Vy=function(t,r){if(!Buffer.isBuffer(t))return $y(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Yy=function(t,r){if(!Buffer.isBuffer(t))return Xy(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},qy=function(t,r){if(!Buffer.isBuffer(t))return Gy(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Jy=function(t,r){if(!Buffer.isBuffer(t))return Ky(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Mu=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Qy(t,r)},ap=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var va=function(e,t){return e[t]},fi=function(e,t){return e[t+1]*256+e[t]},q4=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},en=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},_s=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},K4=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Yo(e,t){var r="",n,i,s=[],l,o,a,c;switch(t){case"dbcs":if(c=this.l,it&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(a=0;a<e;++a)r+=String.fromCharCode(fi(this,c)),c+=2;e*=2;break;case"utf8":r=Ql(this,this.l,this.l+e);break;case"utf16le":e*=2,r=sp(this,this.l,this.l+e);break;case"wstr":return Yo.call(this,e,"dbcs");case"lpstr-ansi":r=Hy(this,this.l),e=4+en(this,this.l);break;case"lpstr-cp":r=Vy(this,this.l),e=4+en(this,this.l);break;case"lpwstr":r=Yy(this,this.l),e=4+2*en(this,this.l);break;case"lpp4":e=4+en(this,this.l),r=qy(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+en(this,this.l),r=Jy(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=va(this,this.l+e++))!==0;)s.push(Oc(l));r=s.join("");break;case"_wstr":for(e=0,r="";(l=fi(this,this.l+e))!==0;)s.push(Oc(l)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,a=0;a<e;++a){if(this.lens&&this.lens.indexOf(c)!==-1)return l=va(this,c),this.l=c+1,o=Yo.call(this,e-a,l?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Oc(fi(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,a=0;a!=e;++a){if(this.lens&&this.lens.indexOf(c)!==-1)return l=va(this,c),this.l=c+1,o=Yo.call(this,e-a,l?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Oc(va(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=va(this,this.l),this.l++,n;case 2:return n=(t==="i"?q4:fi)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?_s:K4)(this,this.l),this.l+=4,n):(i=en(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Mu(this,this.l):i=Mu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=Wy(this,this.l,e);break}}return this.l+=e,r}var J4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Q4=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Z4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function eN(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)Z4(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var l=t.charCodeAt(i);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,J4(this,t,this.l);break;case 8:if(n=8,r==="f"){G4(this,t,this.l);break}case 16:break;case-4:n=4,Q4(this,t,this.l);break}return this.l+=n,this}function Zy(e,t){var r=Wy(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function yr(e,t){e.l=t,e.read_shift=Yo,e.chk=Zy,e.write_shift=eN}function Dr(e,t){e.l+=t}function be(e){var t=rs(e);return yr(t,0),t}function Ei(e,t,r){if(e){var n,i,s;yr(e,e.l||0);for(var l=e.length,o=0,a=0;e.l<l;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=Bl[o]||Bl[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;a=e.l+s;var d=c.f&&c.f(e,s,r);if(e.l=a,t(d,c,o))return}}}function qr(){var e=[],t=it?256:2048,r=function(c){var d=be(c);return yr(d,0),d},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},l=function(){return i(),fr(e)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:l,_bufs:e}}function Ce(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=Bl[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var l=e.next(s);i<=127?l.write_shift(1,i):(l.write_shift(1,(i&127)+128),l.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&ap(r)&&e.push(r)}}function Go(e,t,r){var n=Tt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function qm(e,t,r){var n=Tt(e);return n.s=Go(n.s,t.s,r),n.e=Go(n.e,t.s,r),n}function qo(e,t){if(e.cRel&&e.c<0)for(e=Tt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Tt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Je(e);return!e.cRel&&e.cRel!=null&&(r=nN(r)),!e.rRel&&e.rRel!=null&&(r=tN(r)),r}function dh(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Dt(e.s.c)+":"+(e.e.cRel?"":"$")+Dt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Gt(e.s.r)+":"+(e.e.rRel?"":"$")+Gt(e.e.r):qo(e.s,t.biff)+":"+qo(e.e,t.biff)}function op(e){return parseInt(rN(e),10)-1}function Gt(e){return""+(e+1)}function tN(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function rN(e){return e.replace(/\$(\d+)$/,"$1")}function lp(e){for(var t=iN(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Dt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function nN(e){return e.replace(/^([A-Z])/,"$$$1")}function iN(e){return e.replace(/^\$([A-Z])/,"$1")}function sN(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Rt(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Je(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Kr(e){var t=e.indexOf(":");return t==-1?{s:Rt(e),e:Rt(e)}:{s:Rt(e.slice(0,t)),e:Rt(e.slice(t+1))}}function rt(e,t){return typeof t>"u"||typeof t=="number"?rt(e.s,e.e):(typeof e!="string"&&(e=Je(e)),typeof t!="string"&&(t=Je(t)),e==t?e:e+":"+t)}function ct(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function Km(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Tn(e.z,r?or(t):t)}catch{}try{return e.w=Tn((e.XF||{}).numFmtId||(r?14:0),r?or(t):t)}catch{return""+t}}function ki(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ni[e.v]||e.v:t==null?Km(e,e.v):Km(e,t))}function us(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function ew(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),l=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var a=typeof n.origin=="string"?Rt(n.origin):n.origin;l=a.r,o=a.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=ct(s["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),l==-1&&(c.e.r=l=d.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[h].length;++f)if(!(typeof t[h][f]>"u")){var u={v:t[h][f]},p=l+h,m=o+f;if(c.s.r>p&&(c.s.r=p),c.s.c>m&&(c.s.c=m),c.e.r<p&&(c.e.r=p),c.e.c<m&&(c.e.c=m),t[h][f]&&typeof t[h][f]=="object"&&!Array.isArray(t[h][f])&&!(t[h][f]instanceof Date))u=t[h][f];else if(Array.isArray(u.v)&&(u.f=t[h][f][1],u.v=u.v[0]),u.v===null)if(u.f)u.t="n";else if(n.nullError)u.t="e",u.v=0;else if(n.sheetStubs)u.t="z";else continue;else typeof u.v=="number"?u.t="n":typeof u.v=="boolean"?u.t="b":u.v instanceof Date?(u.z=n.dateNF||Ge[14],n.cellDates?(u.t="d",u.w=Tn(u.z,or(u.v))):(u.t="n",u.v=or(u.v),u.w=Tn(u.z,u.v))):u.t="s";if(i)s[p]||(s[p]=[]),s[p][m]&&s[p][m].z&&(u.z=s[p][m].z),s[p][m]=u;else{var g=Je({c:m,r:p});s[g]&&s[g].z&&(u.z=s[g].z),s[g]=u}}}return c.s.c<1e7&&(s["!ref"]=rt(c)),s}function co(e,t){return ew(null,e,t)}function aN(e){return e.read_shift(4,"i")}function Un(e,t){return t||(t=be(4)),t.write_shift(4,e),t}function jr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function hr(e,t){var r=!1;return t==null&&(r=!0,t=be(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function oN(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function lN(e,t){return t||(t=be(4)),t.write_shift(2,0),t.write_shift(2,0),t}function cp(e,t){var r=e.l,n=e.read_shift(1),i=jr(e),s=[],l={t:i,h:i};if(n&1){for(var o=e.read_shift(4),a=0;a!=o;++a)s.push(oN(e));l.r=s}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function cN(e,t){var r=!1;return t==null&&(r=!0,t=be(15+4*e.t.length)),t.write_shift(1,0),hr(e.t,t),r?t.slice(0,t.l):t}var uN=cp;function fN(e,t){var r=!1;return t==null&&(r=!0,t=be(23+4*e.t.length)),t.write_shift(1,1),hr(e.t,t),t.write_shift(4,1),lN({},t),r?t.slice(0,t.l):t}function En(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Js(e,t){return t==null&&(t=be(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Qs(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Zs(e,t){return t==null&&(t=be(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var hN=jr,tw=hr;function up(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Lu(e,t){var r=!1;return t==null&&(r=!0,t=be(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var dN=jr,Pd=up,fp=Lu;function hp(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?Mu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):_s(t,0)>>2;return r?i/100:i}function rw(e,t){t==null&&(t=be(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function nw(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function pN(e,t){return t||(t=be(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ea=nw,uo=pN;function Fr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Hs(e,t){return(t||be(8)).write_shift(8,e,"f")}function gN(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),a=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=Fs[i];c&&(t.rgb=Rl(c));break;case 2:t.rgb=Rl([l,o,a]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Bu(e,t){if(t||(t=be(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function mN(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function xN(e,t){t||(t=be(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function iw(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function vN(e){return iw(e,1)}function yN(e){return iw(e,2)}var dp=2,Hr=3,jc=11,Jm=12,Uu=19,Pc=64,wN=65,_N=71,bN=4108,kN=4126,cr=80,sw=81,SN=[cr,sw],Dd={1:{n:"CodePage",t:dp},2:{n:"Category",t:cr},3:{n:"PresentationFormat",t:cr},4:{n:"ByteCount",t:Hr},5:{n:"LineCount",t:Hr},6:{n:"ParagraphCount",t:Hr},7:{n:"SlideCount",t:Hr},8:{n:"NoteCount",t:Hr},9:{n:"HiddenCount",t:Hr},10:{n:"MultimediaClipCount",t:Hr},11:{n:"ScaleCrop",t:jc},12:{n:"HeadingPairs",t:bN},13:{n:"TitlesOfParts",t:kN},14:{n:"Manager",t:cr},15:{n:"Company",t:cr},16:{n:"LinksUpToDate",t:jc},17:{n:"CharacterCount",t:Hr},19:{n:"SharedDoc",t:jc},22:{n:"HyperlinksChanged",t:jc},23:{n:"AppVersion",t:Hr,p:"version"},24:{n:"DigSig",t:wN},26:{n:"ContentType",t:cr},27:{n:"ContentStatus",t:cr},28:{n:"Language",t:cr},29:{n:"Version",t:cr},255:{},2147483648:{n:"Locale",t:Uu},2147483651:{n:"Behavior",t:Uu},1919054434:{}},Rd={1:{n:"CodePage",t:dp},2:{n:"Title",t:cr},3:{n:"Subject",t:cr},4:{n:"Author",t:cr},5:{n:"Keywords",t:cr},6:{n:"Comments",t:cr},7:{n:"Template",t:cr},8:{n:"LastAuthor",t:cr},9:{n:"RevNumber",t:cr},10:{n:"EditTime",t:Pc},11:{n:"LastPrinted",t:Pc},12:{n:"CreatedDate",t:Pc},13:{n:"ModifiedDate",t:Pc},14:{n:"PageCount",t:Hr},15:{n:"WordCount",t:Hr},16:{n:"CharCount",t:Hr},17:{n:"Thumbnail",t:_N},18:{n:"Application",t:cr},19:{n:"DocSecurity",t:Hr},255:{},2147483648:{n:"Locale",t:Uu},2147483651:{n:"Behavior",t:Uu},1919054434:{}},Qm={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},CN=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function TN(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var EN=TN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Fs=Tt(EN),Ni={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},aw={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Id={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Dc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function pp(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function NN(e){var t=pp();if(!e||!e.match)return t;var r={};if((e.match(Rr)||[]).forEach(function(n){var i=Qe(n);switch(i[0].replace(L4,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[Id[i.ContentType]]!==void 0&&t[Id[i.ContentType]].push(i.PartName);break}}),t.xmlns!==sr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function ow(e,t){var r=N4(Id),n=[],i;n[n.length]=qt,n[n.length]=Re("Types",null,{xmlns:sr.CT,"xmlns:xsd":sr.xsd,"xmlns:xsi":sr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(a){return Re("Default",null,{Extension:a[0],ContentType:a[1]})}));var s=function(a){e[a]&&e[a].length>0&&(i=e[a][0],n[n.length]=Re("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Dc[a][t.bookType]||Dc[a].xlsx}))},l=function(a){(e[a]||[]).forEach(function(c){n[n.length]=Re("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Dc[a][t.bookType]||Dc[a].xlsx})})},o=function(a){(e[a]||[]).forEach(function(c){n[n.length]=Re("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[a][0]})})};return s("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var st={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Dl(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ko(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Rr)||[]).forEach(function(i){var s=Qe(i);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Do(s.Target,t);r[o]=l,n[s.Id]=l}}),r["!id"]=n,r}function Wa(e){var t=[qt,Re("Relationships",null,{xmlns:sr.RELS})];return zt(e["!id"]).forEach(function(r){t[t.length]=Re("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function pt(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[st.HLINK,st.XPATH,st.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var AN="application/vnd.oasis.opendocument.spreadsheet";function ON(e,t){for(var r=ip(e),n,i;n=Pl.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Qe(n[0],!1),i.path=="/"&&i.type!==AN)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function FN(e){var t=[qt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Zm(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function jN(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function PN(e){var t=[qt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Zm(e[r][0],e[r][1])),t.push(jN("",e[r][0]));return t.push(Zm("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function lw(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ju.version+"</meta:generator></office:meta></office:document-meta>"}var kn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],DN=function(){for(var e=new Array(kn.length),t=0;t<kn.length;++t){var r=kn[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function cw(e){var t={};e=xt(e);for(var r=0;r<kn.length;++r){var n=kn[r],i=e.match(DN[r]);i!=null&&i.length>0&&(t[n[1]]=lt(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Ct(t[n[1]]))}return t}function ph(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=gt(t),n[n.length]=r?Re(e,t,r):wr(e,t))}function uw(e,t){var r=t||{},n=[qt,Re("cp:coreProperties",null,{"xmlns:cp":sr.CORE_PROPS,"xmlns:dc":sr.dc,"xmlns:dcterms":sr.dcterms,"xmlns:dcmitype":sr.dcmitype,"xmlns:xsi":sr.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&ph("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:jd(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&ph("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:jd(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=kn.length;++s){var l=kn[s],o=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&ph(l[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var js=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],fw=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function hw(e,t,r,n){var i=[];if(typeof e=="string")i=Hm(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(d){return{v:d}}));var l=typeof t=="string"?Hm(t,n).map(function(d){return d.v}):t,o=0,a=0;if(l.length>0)for(var c=0;c!==i.length;c+=2){switch(a=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=a,r.SheetNames=l.slice(o,o+a);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=a,r.DefinedNames=l.slice(o,o+a);break;case"Charts":case"Diagramme":r.Chartsheets=a,r.ChartNames=l.slice(o,o+a);break}o+=a}}function RN(e,t,r){var n={};return t||(t={}),e=xt(e),js.forEach(function(i){var s=(e.match(Fl(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=lt(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var l=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));l&&l.length>0&&(n[i[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&hw(n.HeadingPairs,n.TitlesOfParts,t,r),t}function dw(e){var t=[],r=Re;return e||(e={}),e.Application="SheetJS",t[t.length]=qt,t[t.length]=Re("Properties",null,{xmlns:sr.EXT_PROPS,"xmlns:vt":sr.vt}),js.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=gt(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+gt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var IN=/<[^>]+>[^<]*/g;function MN(e,t){var r={},n="",i=e.match(IN);if(i)for(var s=0;s!=i.length;++s){var l=i[s],o=Qe(l);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=lt(o.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var a=l.split(">"),c=a[0].slice(4),d=a[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=lt(d);break;case"bool":r[n]=bt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Ct(d);break;case"cy":case"error":r[n]=lt(d);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,c,a)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function pw(e){var t=[qt,Re("Properties",null,{xmlns:sr.CUST_PROPS,"xmlns:vt":sr.vt})];if(!e)return t.join("");var r=1;return zt(e).forEach(function(i){++r,t[t.length]=Re("property",X4(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:gt(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Md={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},gh;function LN(e,t,r){gh||(gh=xf(Md)),t=gh[t]||t,e[t]=r}function BN(e,t){var r=[];return zt(Md).map(function(n){for(var i=0;i<kn.length;++i)if(kn[i][1]==n)return kn[i];for(i=0;i<js.length;++i)if(js[i][1]==n)return js[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(wr(Md[n[1]]||n[1],i))}}),Re("DocumentProperties",r.join(""),{xmlns:Zr.o})}function UN(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&zt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var l=0;l<kn.length;++l)if(s==kn[l][1])return;for(l=0;l<js.length;++l)if(s==js[l][1])return;for(l=0;l<r.length;++l)if(s==r[l])return;var o=e[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o=String(o),i.push(Re(Bm(s),o,{"dt:dt":a}))}}),t&&zt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var l=t[s],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),i.push(Re(Bm(s),l,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Zr.o+'">'+i.join("")+"</"+n+">"}function gp(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function WN(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var l=be(8);return l.write_shift(4,n),l.write_shift(4,i),l}function gw(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function mw(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function xw(e,t,r){return t===31?mw(e):gw(e,t,r)}function Ld(e,t,r){return xw(e,t,r===!1?0:4)}function zN(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return xw(e,t,0)}function HN(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Ur,""),e.l-i&2&&(e.l+=2)}return r}function $N(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Ur,"");return r}function VN(e){var t=e.l,r=Wu(e,sw);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Wu(e,Hr);return[r,n]}function XN(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(VN(e));return r}function ex(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),l=e.read_shift(4);n[s]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(Ur,"").replace(Po,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function vw(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function YN(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Wu(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==Jm&&n!==t&&SN.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Jm?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return gw(e,n,4).replace(Ur,"");case 31:return mw(e);case 64:return gp(e);case 65:return vw(e);case 71:return YN(e);case 80:return Ld(e,n,!s.raw).replace(Ur,"");case 81:return zN(e,n).replace(Ur,"");case 4108:return XN(e);case 4126:case 4127:return n==4127?HN(e):$N(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function tx(e,t){var r=be(4),n=be(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=be(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=WN(t);break;case 31:case 80:for(n=be(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return fr([r,n])}function rx(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],l=0,o=0,a=-1,c={};for(l=0;l!=i;++l){var d=e.read_shift(4),h=e.read_shift(4);s[l]=[d,h+r]}s.sort(function(y,w){return y[1]-w[1]});var f={};for(l=0;l!=i;++l){if(e.l!==s[l][1]){var u=!0;if(l>0&&t)switch(t[s[l-1][0]].t){case 2:e.l+2===s[l][1]&&(e.l+=2,u=!1);break;case 80:e.l<=s[l][1]&&(e.l=s[l][1],u=!1);break;case 4108:e.l<=s[l][1]&&(e.l=s[l][1],u=!1);break}if((!t||l==0)&&e.l<=s[l][1]&&(u=!1,e.l=s[l][1]),u)throw new Error("Read Error: Expected address "+s[l][1]+" at "+e.l+" :"+l)}if(t){var p=t[s[l][0]];if(f[p.n]=Wu(e,p.t,{raw:!0}),p.p==="version"&&(f[p.n]=String(f[p.n]>>16)+"."+("0000"+String(f[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(f[p.n]){case 0:f[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Rn(o=f[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[p.n])}}else if(s[l][0]===1){if(o=f.CodePage=Wu(e,dp),Rn(o),a!==-1){var m=e.l;e.l=s[a][1],c=ex(e,o),e.l=m}}else if(s[l][0]===0){if(o===0){a=l,e.l=s[l+1][1];continue}c=ex(e,o)}else{var g=c[s[l][0]],x;switch(e[e.l]){case 65:e.l+=4,x=vw(e);break;case 30:e.l+=4,x=Ld(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,x=Ld(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,x=e.read_shift(4,"i");break;case 19:e.l+=4,x=e.read_shift(4);break;case 5:e.l+=4,x=e.read_shift(8,"f");break;case 11:e.l+=4,x=$t(e,4);break;case 64:e.l+=4,x=Ct(gp(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[g]=x}}return e.l=r+n,f}var yw=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function GN(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function nx(e,t,r){var n=be(8),i=[],s=[],l=8,o=0,a=be(8),c=be(8);if(a.write_shift(4,2),a.write_shift(4,1200),c.write_shift(4,1),s.push(a),i.push(c),l+=8+a.length,!t){c=be(8),c.write_shift(4,0),i.unshift(c);var d=[be(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(a=be(8+2*(h.length+1)+(h.length%2?0:2)),a.write_shift(4,o+2),a.write_shift(4,h.length+1),a.write_shift(0,h,"dbcs");a.l!=a.length;)a.write_shift(1,0);d.push(a)}a=fr(d),s.unshift(a),l+=8+a.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(yw.indexOf(e[o][0])>-1||fw.indexOf(e[o][0])>-1)&&e[o][1]!=null){var f=e[o][1],u=0;if(t){u=+t[e[o][0]];var p=r[u];if(p.p=="version"&&typeof f=="string"){var m=f.split(".");f=(+m[0]<<16)+(+m[1]||0)}a=tx(p.t,f)}else{var g=GN(f);g==-1&&(g=31,f=String(f)),a=tx(g,f)}s.push(a),c=be(8),c.write_shift(4,t?u:2+o),i.push(c),l+=8+a.length}var x=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,x),x+=s[o].length;return n.write_shift(4,l),n.write_shift(4,s.length),fr([n].concat(i).concat(s))}function ix(e,t,r){var n=e.content;if(!n)return{};yr(n,0);var i,s,l,o,a=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),d=n.read_shift(16);if(d!==Xe.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(l=n.read_shift(16),a=n.read_shift(4));var h=rx(n,t),f={SystemIdentifier:c};for(var u in h)f[u]=h[u];if(f.FMTID=s,i===1)return f;if(a-n.l==2&&(n.l+=2),n.l!==a)throw new Error("Length mismatch 2: "+n.l+" !== "+a);var p;try{p=rx(n,null)}catch{}for(u in p)f[u]=p[u];return f.FMTID=[s,l],f}function sx(e,t,r,n,i,s){var l=be(i?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Xe.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,i?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,i?68:48);var a=nx(e,r,n);if(o.push(a),i){var c=nx(i,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+a.length),o.push(c)}return fr(o)}function Oi(e,t){return e.read_shift(t),null}function qN(e,t){t||(t=be(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function KN(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function $t(e,t){return e.read_shift(t)===1}function Lr(e,t){return t||(t=be(2)),t.write_shift(2,+!!e),t}function Zt(e){return e.read_shift(2,"u")}function xn(e,t){return t||(t=be(2)),t.write_shift(2,e),t}function ww(e,t){return KN(e,t,Zt)}function JN(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function _w(e,t,r){return r||(r=be(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Zl(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var l=n?e.read_shift(n,i):"";return l}function QN(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),l=0,o,a={};i&&(l=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,c);return i&&(e.l+=4*l),n&&(e.l+=o),a.t=d,i||(a.raw="<t>"+a.t+"</t>",a.r=a.t),a}function ZN(e){var t=e.t||"",r=be(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=be(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return fr(i)}function $s(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function ec(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):$s(e,n,r)}function ta(e,t,r){if(r.biff>5)return ec(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function bw(e,t,r){return r||(r=be(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function eA(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function tA(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Ur,"");return n&&(e.l+=24),i}function rA(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(s>>1,"utf16le").replace(Ur,"");return r+l}function nA(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return tA(e);case"0303000000000000c000000000000046":return rA(e);default:throw new Error("Unsupported Moniker "+r)}}function Rc(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Ur,""):"";return r}function ax(e,t){t||(t=be(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function iA(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,l,o,a,c="",d,h;i&16&&(s=Rc(e,r-e.l)),i&128&&(l=Rc(e,r-e.l)),(i&257)===257&&(o=Rc(e,r-e.l)),(i&257)===1&&(a=nA(e,r-e.l)),i&8&&(c=Rc(e,r-e.l)),i&32&&(d=e.read_shift(16)),i&64&&(h=gp(e)),e.l=r;var f=l||o||a||"";f&&c&&(f+="#"+c),f||(f="#"+c),i&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var u={Target:f};return d&&(u.guid=d),h&&(u.time=h),s&&(u.Tooltip=s),u}function sA(e){var t=be(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(s==28)n=n.slice(1),ax(n,t);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&ax(i>-1?n.slice(i+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var a=0;n.slice(a*3,a*3+3)=="../"||n.slice(a*3,a*3+3)=="..\\";)++a;for(t.write_shift(2,a),t.write_shift(4,n.length-3*a+1),r=0;r<n.length-3*a;++r)t.write_shift(1,n.charCodeAt(r+3*a)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function kw(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function Sw(e,t){var r=kw(e);return r[3]=0,r}function ii(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Vs(e,t,r,n){return n||(n=be(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function aA(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function oA(e,t,r){return t===0?"":ta(e,t,r)}function lA(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[i,s,l]}function Cw(e){var t=e.read_shift(2),r=hp(e);return[t,r]}function cA(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=Zl(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function wf(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function Tw(e,t){return t||(t=be(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Ew(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var uA=Ew;function Nw(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function fA(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function hA(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Tr(e){e.l+=2,e.l+=e.read_shift(2)}var dA={0:Tr,4:Tr,5:Tr,6:Tr,7:hA,8:Tr,9:Tr,10:Tr,11:Tr,12:Tr,13:fA,14:Tr,15:Tr,16:Tr,17:Tr,18:Tr,19:Tr,20:Tr,21:Nw};function pA(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(dA[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Ic(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function mp(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=be(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function gA(e,t){return t===0||e.read_shift(2),1200}function mA(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=ta(e,0,r);return e.read_shift(t+n-e.l),i}function xA(e,t){var r=!t||t.biff==8,n=be(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function vA(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function yA(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=Zl(e,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:i,dt:s,name:l}}function wA(e,t){var r=!t||t.biff>=8?2:1,n=be(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function _A(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],l=0;l!=i&&e.l<r;++l)s.push(QN(e));return s.Count=n,s.Unique=i,s}function bA(e,t){var r=be(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=ZN(e[i]);var s=fr([r].concat(n));return s.parts=[r.length].concat(n.map(function(l){return l.length})),s}function kA(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function SA(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function CA(e){var t=aA(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function TA(e){return e.read_shift(2),e.read_shift(4)}function ox(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function EA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),a=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:l,FirstTab:o,Selected:a,TabRatio:c}}function NA(){var e=be(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function AA(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function OA(e){var t=be(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function FA(){}function jA(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Zl(e,0,r),n}function PA(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=be(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function DA(e){var t=ii(e);return t.isst=e.read_shift(4),t}function RA(e,t,r,n){var i=be(10);return Vs(e,t,n,i),i.write_shift(4,r),i}function IA(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=ii(e);r.biff==2&&e.l++;var s=ec(e,n-e.l,r);return i.val=s,i}function MA(e,t,r,n,i){var s=!i||i.biff==8,l=be(8+ +s+(1+s)*r.length);return Vs(e,t,n,l),l.write_shift(2,r.length),s&&l.write_shift(1,1),l.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),l}function LA(e,t,r){var n=e.read_shift(2),i=ta(e,0,r);return[n,i]}function BA(e,t,r,n){var i=r&&r.biff==5;n||(n=be(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var UA=ta;function lx(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),l=e.read_shift(i),o=e.read_shift(2),a=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:l,c:a}}}function WA(e,t){var r=t.biff==8||!t.biff?4:2,n=be(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function zA(e){var t=e.read_shift(2),r=e.read_shift(2),n=Cw(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function HA(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(Cw(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(s.length!=l-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:l,rkrec:s}}function $A(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(s.length!=l-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:l,ixfe:s}}function VA(e,t,r,n){var i={},s=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(4),a=e.read_shift(2);return i.patternType=CN[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=l&15,i.dgRight=l>>4&15,i.dgTop=l>>8&15,i.dgBottom=l>>12&15,i.icvLeft=l>>16&127,i.icvRight=l>>23&127,i.grbitDiag=l>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=a&127,i.icvBack=a>>7&127,i.fsxButton=a>>14&1),i}function XA(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=VA(e,t,n.fStyle,r),n}function cx(e,t,r,n){var i=r&&r.biff==5;n||(n=be(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function YA(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function GA(e){var t=be(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function ux(e,t,r){var n=ii(e);(r.biff==2||t==9)&&++e.l;var i=JN(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function qA(e,t,r,n,i,s){var l=be(8);return Vs(e,t,n,l),_w(r,s,l),l}function KA(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ii(e),i=Fr(e);return n.val=i,n}function JA(e,t,r,n){var i=be(14);return Vs(e,t,n,i),Hs(r,i),i}var fx=oA;function QA(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=$s(e,s),o=[];n>e.l;)o.push(ec(e));return[s,i,l,o]}function hx(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=cA(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var ZA=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function dx(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),a=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),a=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=$s(e,l,r);i&32&&(c=ZA[c.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var h=n==e.l||o===0||!(d>0)?[]:pP(e,d,r,o);return{chKey:s,Name:c,itab:a,rgce:h}}function Aw(e,t,r){if(r.biff<8)return eO(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(lA(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function eO(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Zl(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function tO(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=$s(e,n,r),l=$s(e,i,r);return[s,l]}function rO(e,t,r){var n=Ew(e);e.l++;var i=e.read_shift(1);return t-=8,[gP(e,t,r),i,n]}function px(e,t,r){var n=uA(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,hP(e,t,r)]}function nO(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function iO(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=ta(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},o,l,s]}}function sO(e,t,r){return iO(e,t,r)}function aO(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(wf(e));return r}function oO(e){var t=be(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Tw(e[r],t);return t}function lO(e,t,r){if(r&&r.biff<8)return uO(e,t,r);var n=Nw(e),i=pA(e,t-22,n[1]);return{cmo:n,ft:i}}var cO={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function uO(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((cO[n]||Dr)(e,t,r)),{cmo:[i,n,s],ft:l}}function fO(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:l=eA(e,6,r);var o=e.read_shift(2);e.read_shift(2),Zt(e,2);var a=e.read_shift(2);e.l+=a;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var d=e[e.l],h=$s(e,e.lens[c+1]-e.lens[c]-1);if(i+=h,i.length>=(d?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function hO(e,t){var r=wf(e);e.l+=16;var n=iA(e,t-24);return[r,n]}function dO(e){var t=be(24),r=Rt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return fr([t,sA(e[1])])}function pO(e,t){e.read_shift(2);var r=wf(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Ur,""),[r,n]}function gO(e){var t=e[1].Tooltip,r=be(10+2*(t.length+1));r.write_shift(2,2048);var n=Rt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function mO(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Qm[r]||r,r=e.read_shift(2),t[1]=Qm[r]||r,t}function xO(e){return e||(e=be(4)),e.write_shift(2,1),e.write_shift(2,1),e}function vO(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Sw(e));return r}function yO(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Sw(e));return r}function wO(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Ow(e,t,r){if(!r.cellStyles)return Dr(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(n),a=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:s,w:l,ixfe:o,flags:a};return(r.biff>=5||!r.biff)&&(c.level=a>>8&7),c}function _O(e,t){var r=be(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function bO(e,t){var r={};return t<32||(e.l+=16,r.header=Fr(e),r.footer=Fr(e),e.l+=2),r}function kO(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}function SO(e){for(var t=be(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var CO=ii,TO=ww,EO=ec;function NO(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function AO(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ii(e);++e.l;var i=ta(e,t-7,r);return n.t="str",n.val=i,n}function OO(e){var t=ii(e);++e.l;var r=Fr(e);return t.t="n",t.val=r,t}function FO(e,t,r){var n=be(15);return ic(n,e,t),n.write_shift(8,r,"f"),n}function jO(e){var t=ii(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function PO(e,t,r){var n=be(9);return ic(n,e,t),n.write_shift(2,r),n}function DO(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function RO(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function IO(e,t,r){var n=e.l+t,i=ii(e),s=e.read_shift(2),l=$s(e,s,r);return e.l=n,i.t="str",i.val=l,i}var MO=[2,3,48,49,131,139,140,245],Bd=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=xf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,a){var c=[],d=rs(1);switch(a.type){case"base64":d=tn(ln(o));break;case"binary":d=tn(o);break;case"buffer":case"array":d=o;break}yr(d,0);var h=d.read_shift(1),f=!!(h&136),u=!1,p=!1;switch(h){case 2:break;case 3:break;case 48:u=!0,f=!0;break;case 49:u=!0,f=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,g=521;h==2&&(m=d.read_shift(2)),d.l+=3,h!=2&&(m=d.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(g=d.read_shift(2));var x=d.read_shift(2),y=a.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(y=e[d[d.l]]),d.l+=1,d.l+=2),p&&(d.l+=36);for(var w=[],_={},b=Math.min(d.length,h==2?521:g-10-(u?264:0)),k=p?32:11;d.l<b&&d[d.l]!=13;)switch(_={},_.name=Nl.utils.decode(y,d.slice(d.l,d.l+k)).replace(/[\u0000\r\n].*$/g,""),d.l+=k,_.type=String.fromCharCode(d.read_shift(1)),h!=2&&!p&&(_.offset=d.read_shift(4)),_.len=d.read_shift(1),h==2&&(_.offset=d.read_shift(2)),_.dec=d.read_shift(1),_.name.length&&w.push(_),h!=2&&(d.l+=p?13:14),_.type){case"B":(!u||_.len!=8)&&a.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":a.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var S=0,E=0;for(c[0]=[],E=0;E!=w.length;++E)c[0][E]=w[E].name;for(;m-- >0;){if(d[d.l]===42){d.l+=x;continue}for(++d.l,c[++S]=[],E=0,E=0;E!=w.length;++E){var F=d.slice(d.l,d.l+w[E].len);d.l+=w[E].len,yr(F,0);var P=Nl.utils.decode(y,F);switch(w[E].type){case"C":P.trim().length&&(c[S][E]=P.replace(/\s+$/,""));break;case"D":P.length===8?c[S][E]=new Date(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8)):c[S][E]=P;break;case"F":c[S][E]=parseFloat(P.trim());break;case"+":case"I":c[S][E]=p?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":c[S][E]=!0;break;case"N":case"F":c[S][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[S][E]="##MEMO##"+(p?parseInt(P.trim(),10):F.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(c[S][E]=+P||0);break;case"@":c[S][E]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":c[S][E]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":c[S][E]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[S][E]=-F.read_shift(-8,"f");break;case"B":if(u&&w[E].len==8){c[S][E]=F.read_shift(8,"f");break}case"G":case"P":F.l+=w[E].len;break;case"0":if(w[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[E].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return a&&a.sheetRows&&(c=c.slice(0,a.sheetRows)),a.DBF=w,c}function n(o,a){var c=a||{};c.dateNF||(c.dateNF="yyyymmdd");var d=co(r(o,c),c);return d["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,d}function i(o,a){try{return us(n(o,a),a)}catch(c){if(a&&a.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,a){var c=a||{};if(+c.codepage>=0&&Rn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var d=qr(),h=$u(o,{header:1,raw:!0,cellDates:!0}),f=h[0],u=h.slice(1),p=o["!cols"]||[],m=0,g=0,x=0,y=1;for(m=0;m<f.length;++m){if(((p[m]||{}).DBF||{}).name){f[m]=p[m].DBF.name,++x;continue}if(f[m]!=null){if(++x,typeof f[m]=="number"&&(f[m]=f[m].toString(10)),typeof f[m]!="string")throw new Error("DBF Invalid column name "+f[m]+" |"+typeof f[m]+"|");if(f.indexOf(f[m])!==m){for(g=0;g<1024;++g)if(f.indexOf(f[m]+"_"+g)==-1){f[m]+="_"+g;break}}}}var w=ct(o["!ref"]),_=[],b=[],k=[];for(m=0;m<=w.e.c-w.s.c;++m){var S="",E="",F=0,P=[];for(g=0;g<u.length;++g)u[g][m]!=null&&P.push(u[g][m]);if(P.length==0||f[m]==null){_[m]="?";continue}for(g=0;g<P.length;++g){switch(typeof P[g]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=P[g]instanceof Date?"D":"C";break;default:E="C"}F=Math.max(F,String(P[g]).length),S=S&&S!=E?"C":E}F>250&&(F=250),E=((p[m]||{}).DBF||{}).type,E=="C"&&p[m].DBF.len>F&&(F=p[m].DBF.len),S=="B"&&E=="N"&&(S="N",k[m]=p[m].DBF.dec,F=p[m].DBF.len),b[m]=S=="C"||E=="N"?F:s[S]||0,y+=b[m],_[m]=S}var D=d.next(32);for(D.write_shift(4,318902576),D.write_shift(4,u.length),D.write_shift(2,296+32*x),D.write_shift(2,y),m=0;m<4;++m)D.write_shift(4,0);for(D.write_shift(4,0|(+t[yy]||3)<<8),m=0,g=0;m<f.length;++m)if(f[m]!=null){var I=d.next(32),X=(f[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,X,"sbcs"),I.write_shift(1,_[m]=="?"?"C":_[m],"sbcs"),I.write_shift(4,g),I.write_shift(1,b[m]||s[_[m]]||0),I.write_shift(1,k[m]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),g+=b[m]||s[_[m]]||0}var z=d.next(264);for(z.write_shift(4,13),m=0;m<65;++m)z.write_shift(4,0);for(m=0;m<u.length;++m){var G=d.next(y);for(G.write_shift(1,0),g=0;g<f.length;++g)if(f[g]!=null)switch(_[g]){case"L":G.write_shift(1,u[m][g]==null?63:u[m][g]?84:70);break;case"B":G.write_shift(8,u[m][g]||0,"f");break;case"N":var ae="0";for(typeof u[m][g]=="number"&&(ae=u[m][g].toFixed(k[g]||0)),x=0;x<b[g]-ae.length;++x)G.write_shift(1,32);G.write_shift(1,ae,"sbcs");break;case"D":u[m][g]?(G.write_shift(4,("0000"+u[m][g].getFullYear()).slice(-4),"sbcs"),G.write_shift(2,("00"+(u[m][g].getMonth()+1)).slice(-2),"sbcs"),G.write_shift(2,("00"+u[m][g].getDate()).slice(-2),"sbcs")):G.write_shift(8,"00000000","sbcs");break;case"C":var le=String(u[m][g]!=null?u[m][g]:"").slice(0,b[g]);for(G.write_shift(1,le,"sbcs"),x=0;x<b[g]-le.length;++x)G.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:l}}(),Fw=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+zt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,u){var p=e[u];return typeof p=="number"?Cm(p):p},n=function(f,u,p){var m=u.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return m==59?f:Cm(m)};e["|"]=254;function i(f,u){switch(u.type){case"base64":return s(ln(f),u);case"binary":return s(f,u);case"buffer":return s(it&&Buffer.isBuffer(f)?f.toString("binary"):cs(f),u);case"array":return s(zs(f),u)}throw new Error("Unrecognized type "+u.type)}function s(f,u){var p=f.split(/[\n\r]+/),m=-1,g=-1,x=0,y=0,w=[],_=[],b=null,k={},S=[],E=[],F=[],P=0,D;for(+u.codepage>=0&&Rn(+u.codepage);x!==p.length;++x){P=0;var I=p[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),X=I.replace(/;;/g,"\0").split(";").map(function(T){return T.replace(/\u0000/g,";")}),z=X[0],G;if(I.length>0)switch(z){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":X[1].charAt(0)=="P"&&_.push(I.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,le=!1,Z=!1,C=!1,L=-1,B=-1;for(y=1;y<X.length;++y)switch(X[y].charAt(0)){case"A":break;case"X":g=parseInt(X[y].slice(1))-1,le=!0;break;case"Y":for(m=parseInt(X[y].slice(1))-1,le||(g=0),D=w.length;D<=m;++D)w[D]=[];break;case"K":G=X[y].slice(1),G.charAt(0)==='"'?G=G.slice(1,G.length-1):G==="TRUE"?G=!0:G==="FALSE"?G=!1:isNaN(Bn(G))?isNaN(Qa(G).getDate())||(G=Ct(G)):(G=Bn(G),b!==null&&oo(b)&&(G=yf(G))),ae=!0;break;case"E":C=!0;var N=za(X[y].slice(1),{r:m,c:g});w[m][g]=[w[m][g],N];break;case"S":Z=!0,w[m][g]=[w[m][g],"S5S"];break;case"G":break;case"R":L=parseInt(X[y].slice(1))-1;break;case"C":B=parseInt(X[y].slice(1))-1;break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+I)}if(ae&&(w[m][g]&&w[m][g].length==2?w[m][g][0]=G:w[m][g]=G,b=null),Z){if(C)throw new Error("SYLK shared formula cannot have own formula");var U=L>-1&&w[L][B];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");w[m][g][1]=qw(U[1],{r:m-L,c:g-B})}break;case"F":var A=0;for(y=1;y<X.length;++y)switch(X[y].charAt(0)){case"X":g=parseInt(X[y].slice(1))-1,++A;break;case"Y":for(m=parseInt(X[y].slice(1))-1,D=w.length;D<=m;++D)w[D]=[];break;case"M":P=parseInt(X[y].slice(1))/20;break;case"F":break;case"G":break;case"P":b=_[parseInt(X[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=X[y].slice(1).split(" "),D=parseInt(F[0],10);D<=parseInt(F[1],10);++D)P=parseInt(F[2],10),E[D-1]=P===0?{hidden:!0}:{wch:P},ns(E[D-1]);break;case"C":g=parseInt(X[y].slice(1))-1,E[g]||(E[g]={});break;case"R":m=parseInt(X[y].slice(1))-1,S[m]||(S[m]={}),P>0?(S[m].hpt=P,S[m].hpx=eo(P)):P===0&&(S[m].hidden=!0);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+I)}A<1&&(b=null);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+I)}}return S.length>0&&(k["!rows"]=S),E.length>0&&(k["!cols"]=E),u&&u.sheetRows&&(w=w.slice(0,u.sheetRows)),[w,k]}function l(f,u){var p=i(f,u),m=p[0],g=p[1],x=co(m,u);return zt(g).forEach(function(y){x[y]=g[y]}),x}function o(f,u){return us(l(f,u),u)}function a(f,u,p,m){var g="C;Y"+(p+1)+";X"+(m+1)+";K";switch(f.t){case"n":g+=f.v||0,f.f&&!f.F&&(g+=";E"+bp(f.f,{r:p,c:m}));break;case"b":g+=f.v?"TRUE":"FALSE";break;case"e":g+=f.w||f.v;break;case"d":g+='"'+(f.w||f.v)+'"';break;case"s":g+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(f,u){u.forEach(function(p,m){var g="F;W"+(m+1)+" "+(m+1)+" ";p.hidden?g+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Il(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Ml(p.wpx)),typeof p.wch=="number"&&(g+=Math.round(p.wch))),g.charAt(g.length-1)!=" "&&f.push(g)})}function d(f,u){u.forEach(function(p,m){var g="F;";p.hidden?g+="M0;":p.hpt?g+="M"+20*p.hpt+";":p.hpx&&(g+="M"+20*Ll(p.hpx)+";"),g.length>2&&f.push(g+"R"+(m+1))})}function h(f,u){var p=["ID;PWXL;N;E"],m=[],g=ct(f["!ref"]),x,y=Array.isArray(f),w=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),f["!cols"]&&c(p,f["!cols"]),f["!rows"]&&d(p,f["!rows"]),p.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var _=g.s.r;_<=g.e.r;++_)for(var b=g.s.c;b<=g.e.c;++b){var k=Je({r:_,c:b});x=y?(f[_]||[])[b]:f[k],!(!x||x.v==null&&(!x.f||x.F))&&m.push(a(x,f,_,b))}return p.join(w)+w+m.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:l,from_sheet:h}}(),jw=function(){function e(s,l){switch(l.type){case"base64":return t(ln(s),l);case"binary":return t(s,l);case"buffer":return t(it&&Buffer.isBuffer(s)?s.toString("binary"):cs(s),l);case"array":return t(zs(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){for(var o=s.split(`
`),a=-1,c=-1,d=0,h=[];d!==o.length;++d){if(o[d].trim()==="BOT"){h[++a]=[],c=0;continue}if(!(a<0)){var f=o[d].trim().split(","),u=f[0],p=f[1];++d;for(var m=o[d]||"";(m.match(/["]/g)||[]).length&1&&d<o.length-1;)m+=`
`+o[++d];switch(m=m.trim(),+u){case-1:if(m==="BOT"){h[++a]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[a][c]=!0:m==="FALSE"?h[a][c]=!1:isNaN(Bn(p))?isNaN(Qa(p).getDate())?h[a][c]=p:h[a][c]=Ct(p):h[a][c]=Bn(p),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[a][c++]=m!==""?m:null;break}if(m==="EOD")break}}return l&&l.sheetRows&&(h=h.slice(0,l.sheetRows)),h}function r(s,l){return co(e(s,l),l)}function n(s,l){return us(r(s,l),l)}var i=function(){var s=function(a,c,d,h,f){a.push(c),a.push(d+","+h),a.push('"'+f.replace(/"/g,'""')+'"')},l=function(a,c,d,h){a.push(c+","+d),a.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(a){var c=[],d=ct(a["!ref"]),h,f=Array.isArray(a);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,d.e.r-d.s.r+1,""),s(c,"TUPLES",0,d.e.c-d.s.c+1,""),s(c,"DATA",0,0,"");for(var u=d.s.r;u<=d.e.r;++u){l(c,-1,0,"BOT");for(var p=d.s.c;p<=d.e.c;++p){var m=Je({r:u,c:p});if(h=f?(a[u]||[])[p]:a[m],!h){l(c,1,0,"");continue}switch(h.t){case"n":var g=h.w;!g&&h.v!=null&&(g=h.v),g==null?h.f&&!h.F?l(c,1,0,"="+h.f):l(c,1,0,""):l(c,0,g,"V");break;case"b":l(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":l(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Tn(h.z||Ge[14],or(Ct(h.v)))),l(c,0,h.w,"V");break;default:l(c,1,0,"")}}}l(c,-1,0,"EOD");var x=`\r
`,y=c.join(x);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),Pw=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,f){for(var u=h.split(`
`),p=-1,m=-1,g=0,x=[];g!==u.length;++g){var y=u[g].trim().split(":");if(y[0]==="cell"){var w=Rt(y[1]);if(x.length<=w.r)for(p=x.length;p<=w.r;++p)x[p]||(x[p]=[]);switch(p=w.r,m=w.c,y[2]){case"t":x[p][m]=e(y[3]);break;case"v":x[p][m]=+y[3];break;case"vtf":var _=y[y.length-1];case"vtc":switch(y[3]){case"nl":x[p][m]=!!+y[4];break;default:x[p][m]=+y[4];break}y[2]=="vtf"&&(x[p][m]=[x[p][m],_])}}}return f&&f.sheetRows&&(x=x.slice(0,f.sheetRows)),x}function n(h,f){return co(r(h,f),f)}function i(h,f){return us(n(h,f),f)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),a="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var f=[],u=[],p,m="",g=Kr(h["!ref"]),x=Array.isArray(h),y=g.s.r;y<=g.e.r;++y)for(var w=g.s.c;w<=g.e.c;++w)if(m=Je({r:y,c:w}),p=x?(h[y]||[])[w]:h[m],!(!p||p.v==null||p.t==="z")){switch(u=["cell",m,"t"],p.t){case"s":case"str":u.push(t(p.v));break;case"n":p.f?(u[2]="vtf",u[3]="n",u[4]=p.v,u[5]=t(p.f)):(u[2]="v",u[3]=p.v);break;case"b":u[2]="vt"+(p.f?"f":"c"),u[3]="nl",u[4]=p.v?"1":"0",u[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var _=or(Ct(p.v));u[2]="vtc",u[3]="nd",u[4]=""+_,u[5]=p.w||Tn(p.z||Ge[14],_);break;case"e":continue}f.push(u.join(":"))}return f.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function d(h){return[s,l,o,l,c(h),a].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),Za=function(){function e(d,h,f,u,p){p.raw?h[f][u]=d:d===""||(d==="TRUE"?h[f][u]=!0:d==="FALSE"?h[f][u]=!1:isNaN(Bn(d))?isNaN(Qa(d).getDate())?h[f][u]=d:h[f][u]=Ct(d):h[f][u]=Bn(d))}function t(d,h){var f=h||{},u=[];if(!d||d.length===0)return u;for(var p=d.split(/[\r\n]/),m=p.length-1;m>=0&&p[m].length===0;)--m;for(var g=10,x=0,y=0;y<=m;++y)x=p[y].indexOf(" "),x==-1?x=p[y].length:x++,g=Math.max(g,x);for(y=0;y<=m;++y){u[y]=[];var w=0;for(e(p[y].slice(0,g).trim(),u,y,w,f),w=1;w<=(p[y].length-g)/10+1;++w)e(p[y].slice(g+(w-1)*10,g+w*10).trim(),u,y,w,f)}return f.sheetRows&&(u=u.slice(0,f.sheetRows)),u}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var h={},f=!1,u=0,p=0;u<d.length;++u)(p=d.charCodeAt(u))==34?f=!f:!f&&p in r&&(h[p]=(h[p]||0)+1);p=[];for(u in h)Object.prototype.hasOwnProperty.call(h,u)&&p.push([h[u],u]);if(!p.length){h=n;for(u in h)Object.prototype.hasOwnProperty.call(h,u)&&p.push([h[u],u])}return p.sort(function(m,g){return m[0]-g[0]||n[m[1]]-n[g[1]]}),r[p.pop()[1]]||44}function s(d,h){var f=h||{},u="",p=f.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(u=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(u=d.charAt(4),d=d.slice(6)):u=i(d.slice(0,1024)):f&&f.FS?u=f.FS:u=i(d.slice(0,1024));var g=0,x=0,y=0,w=0,_=0,b=u.charCodeAt(0),k=!1,S=0,E=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var F=f.dateNF!=null?k4(f.dateNF):null;function P(){var D=d.slice(w,_),I={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)I.t="z";else if(f.raw)I.t="s",I.v=D;else if(D.trim().length===0)I.t="s",I.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(I.t="s",I.v=D.slice(2,-1).replace(/""/g,'"')):QF(D)?(I.t="n",I.f=D.slice(1)):(I.t="s",I.v=D);else if(D=="TRUE")I.t="b",I.v=!0;else if(D=="FALSE")I.t="b",I.v=!1;else if(!isNaN(y=Bn(D)))I.t="n",f.cellText!==!1&&(I.w=D),I.v=y;else if(!isNaN(Qa(D).getDate())||F&&D.match(F)){I.z=f.dateNF||Ge[14];var X=0;F&&D.match(F)&&(D=S4(D,f.dateNF,D.match(F)||[]),X=1),f.cellDates?(I.t="d",I.v=Ct(D,X)):(I.t="n",I.v=or(Ct(D,X))),f.cellText!==!1&&(I.w=Tn(I.z,I.v instanceof Date?or(I.v):I.v)),f.cellNF||delete I.z}else I.t="s",I.v=D;if(I.t=="z"||(f.dense?(p[g]||(p[g]=[]),p[g][x]=I):p[Je({c:x,r:g})]=I),w=_+1,E=d.charCodeAt(w),m.e.c<x&&(m.e.c=x),m.e.r<g&&(m.e.r=g),S==b)++x;else if(x=0,++g,f.sheetRows&&f.sheetRows<=g)return!0}e:for(;_<d.length;++_)switch(S=d.charCodeAt(_)){case 34:E===34&&(k=!k);break;case b:case 10:case 13:if(!k&&P())break e;break}return _-w>0&&P(),p["!ref"]=rt(m),p}function l(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,h):co(t(d,h),h)}function o(d,h){var f="",u=h.type=="string"?[0,0,0,0]:Op(d,h);switch(h.type){case"base64":f=ln(d);break;case"binary":f=d;break;case"buffer":h.codepage==65001?f=d.toString("utf8"):h.codepage&&typeof Nl<"u"||(f=it&&Buffer.isBuffer(d)?d.toString("binary"):cs(d));break;case"array":f=zs(d);break;case"string":f=d;break;default:throw new Error("Unrecognized type "+h.type)}return u[0]==239&&u[1]==187&&u[2]==191?f=xt(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=xt(f):h.type=="binary"&&typeof Nl<"u",f.slice(0,19)=="socialcalc:version:"?Pw.to_sheet(h.type=="string"?f:xt(f),h):l(f,h)}function a(d,h){return us(o(d,h),h)}function c(d){for(var h=[],f=ct(d["!ref"]),u,p=Array.isArray(d),m=f.s.r;m<=f.e.r;++m){for(var g=[],x=f.s.c;x<=f.e.c;++x){var y=Je({r:m,c:x});if(u=p?(d[m]||[])[x]:d[y],!u||u.v==null){g.push("          ");continue}for(var w=(u.w||(ki(u),u.w)||"").slice(0,10);w.length<10;)w+=" ";g.push(w+(x===0?" ":""))}h.push(g.join(""))}return h.join(`
`)}return{to_workbook:a,to_sheet:o,from_sheet:c}}();function LO(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=Fw.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Za.to_workbook(e,t)}}var Ps=function(){function e(N,U,A){if(N){yr(N,N.l||0);for(var T=A.Enum||L;N.l<N.length;){var j=N.read_shift(2),M=T[j]||T[65535],Y=N.read_shift(2),H=N.l+Y,V=M.f&&M.f(N,Y,A);if(N.l=H,U(V,M,j))return}}}function t(N,U){switch(U.type){case"base64":return r(tn(ln(N)),U);case"binary":return r(tn(N),U);case"buffer":case"array":return r(N,U)}throw"Unsupported type "+U.type}function r(N,U){if(!N)return N;var A=U||{},T=A.dense?[]:{},j="Sheet1",M="",Y=0,H={},V=[],fe=[],O={s:{r:0,c:0},e:{r:0,c:0}},Q=A.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)A.Enum=L,e(N,function(R,ue,oe){switch(oe){case 0:A.vers=R,R>=4096&&(A.qpro=!0);break;case 6:O=R;break;case 204:R&&(M=R);break;case 222:M=R;break;case 15:case 51:A.qpro||(R[1].v=R[1].v.slice(1));case 13:case 14:case 16:oe==14&&(R[2]&112)==112&&(R[2]&15)>1&&(R[2]&15)<15&&(R[1].z=A.dateNF||Ge[14],A.cellDates&&(R[1].t="d",R[1].v=yf(R[1].v))),A.qpro&&R[3]>Y&&(T["!ref"]=rt(O),H[j]=T,V.push(j),T=A.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},Y=R[3],j=M||"Sheet"+(Y+1),M="");var he=A.dense?(T[R[0].r]||[])[R[0].c]:T[Je(R[0])];if(he){he.t=R[1].t,he.v=R[1].v,R[1].z!=null&&(he.z=R[1].z),R[1].f!=null&&(he.f=R[1].f);break}A.dense?(T[R[0].r]||(T[R[0].r]=[]),T[R[0].r][R[0].c]=R[1]):T[Je(R[0])]=R[1];break}},A);else if(N[2]==26||N[2]==14)A.Enum=B,N[2]==14&&(A.qpro=!0,N.l=0),e(N,function(R,ue,oe){switch(oe){case 204:j=R;break;case 22:R[1].v=R[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(R[3]>Y&&(T["!ref"]=rt(O),H[j]=T,V.push(j),T=A.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},Y=R[3],j="Sheet"+(Y+1)),Q>0&&R[0].r>=Q)break;A.dense?(T[R[0].r]||(T[R[0].r]=[]),T[R[0].r][R[0].c]=R[1]):T[Je(R[0])]=R[1],O.e.c<R[0].c&&(O.e.c=R[0].c),O.e.r<R[0].r&&(O.e.r=R[0].r);break;case 27:R[14e3]&&(fe[R[14e3][0]]=R[14e3][1]);break;case 1537:fe[R[0]]=R[1],R[0]==Y&&(j=R[1]);break}},A);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(T["!ref"]=rt(O),H[M||j]=T,V.push(M||j),!fe.length)return{SheetNames:V,Sheets:H};for(var K={},ce=[],te=0;te<fe.length;++te)H[V[te]]?(ce.push(fe[te]||V[te]),K[fe[te]]=H[fe[te]]||H[V[te]]):(ce.push(fe[te]),K[fe[te]]={"!ref":"A1"});return{SheetNames:ce,Sheets:K}}function n(N,U){var A=U||{};if(+A.codepage>=0&&Rn(+A.codepage),A.type=="string")throw new Error("Cannot write WK1 to JS string");var T=qr(),j=ct(N["!ref"]),M=Array.isArray(N),Y=[];Me(T,0,s(1030)),Me(T,6,a(j));for(var H=Math.min(j.e.r,8191),V=j.s.r;V<=H;++V)for(var fe=Gt(V),O=j.s.c;O<=j.e.c;++O){V===j.s.r&&(Y[O]=Dt(O));var Q=Y[O]+fe,K=M?(N[V]||[])[O]:N[Q];if(!(!K||K.t=="z"))if(K.t=="n")(K.v|0)==K.v&&K.v>=-32768&&K.v<=32767?Me(T,13,u(V,O,K.v)):Me(T,14,m(V,O,K.v));else{var ce=ki(K);Me(T,15,h(V,O,ce.slice(0,239)))}}return Me(T,1),T.end()}function i(N,U){var A=U||{};if(+A.codepage>=0&&Rn(+A.codepage),A.type=="string")throw new Error("Cannot write WK3 to JS string");var T=qr();Me(T,0,l(N));for(var j=0,M=0;j<N.SheetNames.length;++j)(N.Sheets[N.SheetNames[j]]||{})["!ref"]&&Me(T,27,C(N.SheetNames[j],M++));var Y=0;for(j=0;j<N.SheetNames.length;++j){var H=N.Sheets[N.SheetNames[j]];if(!(!H||!H["!ref"])){for(var V=ct(H["!ref"]),fe=Array.isArray(H),O=[],Q=Math.min(V.e.r,8191),K=V.s.r;K<=Q;++K)for(var ce=Gt(K),te=V.s.c;te<=V.e.c;++te){K===V.s.r&&(O[te]=Dt(te));var R=O[te]+ce,ue=fe?(H[K]||[])[te]:H[R];if(!(!ue||ue.t=="z"))if(ue.t=="n")Me(T,23,P(K,te,Y,ue.v));else{var oe=ki(ue);Me(T,22,S(K,te,Y,oe.slice(0,239)))}}++Y}}return Me(T,1),T.end()}function s(N){var U=be(2);return U.write_shift(2,N),U}function l(N){var U=be(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var A=0,T=0,j=0,M=0;M<N.SheetNames.length;++M){var Y=N.SheetNames[M],H=N.Sheets[Y];if(!(!H||!H["!ref"])){++j;var V=Kr(H["!ref"]);A<V.e.r&&(A=V.e.r),T<V.e.c&&(T=V.e.c)}}return A>8191&&(A=8191),U.write_shift(2,A),U.write_shift(1,j),U.write_shift(1,T),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function o(N,U,A){var T={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&A.qpro?(T.s.c=N.read_shift(1),N.l++,T.s.r=N.read_shift(2),T.e.c=N.read_shift(1),N.l++,T.e.r=N.read_shift(2),T):(T.s.c=N.read_shift(2),T.s.r=N.read_shift(2),U==12&&A.qpro&&(N.l+=2),T.e.c=N.read_shift(2),T.e.r=N.read_shift(2),U==12&&A.qpro&&(N.l+=2),T.s.c==65535&&(T.s.c=T.e.c=T.s.r=T.e.r=0),T)}function a(N){var U=be(8);return U.write_shift(2,N.s.c),U.write_shift(2,N.s.r),U.write_shift(2,N.e.c),U.write_shift(2,N.e.r),U}function c(N,U,A){var T=[{c:0,r:0},{t:"n",v:0},0,0];return A.qpro&&A.vers!=20768?(T[0].c=N.read_shift(1),T[3]=N.read_shift(1),T[0].r=N.read_shift(2),N.l+=2):(T[2]=N.read_shift(1),T[0].c=N.read_shift(2),T[0].r=N.read_shift(2)),T}function d(N,U,A){var T=N.l+U,j=c(N,U,A);if(j[1].t="s",A.vers==20768){N.l++;var M=N.read_shift(1);return j[1].v=N.read_shift(M,"utf8"),j}return A.qpro&&N.l++,j[1].v=N.read_shift(T-N.l,"cstr"),j}function h(N,U,A){var T=be(7+A.length);T.write_shift(1,255),T.write_shift(2,U),T.write_shift(2,N),T.write_shift(1,39);for(var j=0;j<T.length;++j){var M=A.charCodeAt(j);T.write_shift(1,M>=128?95:M)}return T.write_shift(1,0),T}function f(N,U,A){var T=c(N,U,A);return T[1].v=N.read_shift(2,"i"),T}function u(N,U,A){var T=be(7);return T.write_shift(1,255),T.write_shift(2,U),T.write_shift(2,N),T.write_shift(2,A,"i"),T}function p(N,U,A){var T=c(N,U,A);return T[1].v=N.read_shift(8,"f"),T}function m(N,U,A){var T=be(13);return T.write_shift(1,255),T.write_shift(2,U),T.write_shift(2,N),T.write_shift(8,A,"f"),T}function g(N,U,A){var T=N.l+U,j=c(N,U,A);if(j[1].v=N.read_shift(8,"f"),A.qpro)N.l=T;else{var M=N.read_shift(2);_(N.slice(N.l,N.l+M),j),N.l+=M}return j}function x(N,U,A){var T=U&32768;return U&=-32769,U=(T?N:0)+(U>=8192?U-16384:U),(T?"":"$")+(A?Dt(U):Gt(U))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(N,U){yr(N,0);for(var A=[],T=0,j="",M="",Y="",H="";N.l<N.length;){var V=N[N.l++];switch(V){case 0:A.push(N.read_shift(8,"f"));break;case 1:M=x(U[0].c,N.read_shift(2),!0),j=x(U[0].r,N.read_shift(2),!1),A.push(M+j);break;case 2:{var fe=x(U[0].c,N.read_shift(2),!0),O=x(U[0].r,N.read_shift(2),!1);M=x(U[0].c,N.read_shift(2),!0),j=x(U[0].r,N.read_shift(2),!1),A.push(fe+O+":"+M+j)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:A.push("("+A.pop()+")");break;case 5:A.push(N.read_shift(2));break;case 6:{for(var Q="";V=N[N.l++];)Q+=String.fromCharCode(V);A.push('"'+Q.replace(/"/g,'""')+'"')}break;case 8:A.push("-"+A.pop());break;case 23:A.push("+"+A.pop());break;case 22:A.push("NOT("+A.pop()+")");break;case 20:case 21:H=A.pop(),Y=A.pop(),A.push(["AND","OR"][V-20]+"("+Y+","+H+")");break;default:if(V<32&&w[V])H=A.pop(),Y=A.pop(),A.push(Y+w[V]+H);else if(y[V]){if(T=y[V][1],T==69&&(T=N[N.l++]),T>A.length){console.error("WK1 bad formula parse 0x"+V.toString(16)+":|"+A.join("|")+"|");return}var K=A.slice(-T);A.length-=T,A.push(y[V][0]+"("+K.join(",")+")")}else return V<=7?console.error("WK1 invalid opcode "+V.toString(16)):V<=24?console.error("WK1 unsupported op "+V.toString(16)):V<=30?console.error("WK1 invalid opcode "+V.toString(16)):V<=115?console.error("WK1 unsupported function opcode "+V.toString(16)):console.error("WK1 unrecognized opcode "+V.toString(16))}}A.length==1?U[1].f=""+A[0]:console.error("WK1 bad formula parse |"+A.join("|")+"|")}function b(N){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=N.read_shift(2),U[3]=N[N.l++],U[0].c=N[N.l++],U}function k(N,U){var A=b(N);return A[1].t="s",A[1].v=N.read_shift(U-4,"cstr"),A}function S(N,U,A,T){var j=be(6+T.length);j.write_shift(2,N),j.write_shift(1,A),j.write_shift(1,U),j.write_shift(1,39);for(var M=0;M<T.length;++M){var Y=T.charCodeAt(M);j.write_shift(1,Y>=128?95:Y)}return j.write_shift(1,0),j}function E(N,U){var A=b(N);A[1].v=N.read_shift(2);var T=A[1].v>>1;if(A[1].v&1)switch(T&7){case 0:T=(T>>3)*5e3;break;case 1:T=(T>>3)*500;break;case 2:T=(T>>3)/20;break;case 3:T=(T>>3)/200;break;case 4:T=(T>>3)/2e3;break;case 5:T=(T>>3)/2e4;break;case 6:T=(T>>3)/16;break;case 7:T=(T>>3)/64;break}return A[1].v=T,A}function F(N,U){var A=b(N),T=N.read_shift(4),j=N.read_shift(4),M=N.read_shift(2);if(M==65535)return T===0&&j===3221225472?(A[1].t="e",A[1].v=15):T===0&&j===3489660928?(A[1].t="e",A[1].v=42):A[1].v=0,A;var Y=M&32768;return M=(M&32767)-16446,A[1].v=(1-Y*2)*(j*Math.pow(2,M+32)+T*Math.pow(2,M)),A}function P(N,U,A,T){var j=be(14);if(j.write_shift(2,N),j.write_shift(1,A),j.write_shift(1,U),T==0)return j.write_shift(4,0),j.write_shift(4,0),j.write_shift(2,65535),j;var M=0,Y=0,H=0,V=0;return T<0&&(M=1,T=-T),Y=Math.log2(T)|0,T/=Math.pow(2,Y-31),V=T>>>0,V&2147483648||(T/=2,++Y,V=T>>>0),T-=V,V|=2147483648,V>>>=0,T*=Math.pow(2,32),H=T>>>0,j.write_shift(4,H),j.write_shift(4,V),Y+=16383+(M?32768:0),j.write_shift(2,Y),j}function D(N,U){var A=F(N);return N.l+=U-14,A}function I(N,U){var A=b(N),T=N.read_shift(4);return A[1].v=T>>6,A}function X(N,U){var A=b(N),T=N.read_shift(8,"f");return A[1].v=T,A}function z(N,U){var A=X(N);return N.l+=U-10,A}function G(N,U){return N[N.l+U-1]==0?N.read_shift(U,"cstr"):""}function ae(N,U){var A=N[N.l++];A>U-1&&(A=U-1);for(var T="";T.length<A;)T+=String.fromCharCode(N[N.l++]);return T}function le(N,U,A){if(!(!A.qpro||U<21)){var T=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var j=N.read_shift(U-21,"cstr");return[T,j]}}function Z(N,U){for(var A={},T=N.l+U;N.l<T;){var j=N.read_shift(2);if(j==14e3){for(A[j]=[0,""],A[j][0]=N.read_shift(2);N[N.l];)A[j][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return A}function C(N,U){var A=be(5+N.length);A.write_shift(2,14e3),A.write_shift(2,U);for(var T=0;T<N.length;++T){var j=N.charCodeAt(T);A[A.l++]=j>127?95:j}return A[A.l++]=0,A}var L={0:{n:"BOF",f:Zt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:G},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},B={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Z},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:X},40:{n:"FORMULA28",f:z},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:G},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function BO(e){var t={},r=e.match(Rr),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Qe(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Y0[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var UO=function(){var e=Fl("t"),t=Fl("rPr");function r(s){var l=s.match(e);if(!l)return{t:"s",v:""};var o={t:"s",v:lt(l[1])},a=s.match(t);return a&&(o.s=BO(a[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),WO=function(){var t=/(\r\n|\n)/g;function r(i,s,l){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),l.push("</b>")),i.i&&(s.push("<i>"),l.push("</i>")),i.strike&&(s.push("<s>"),l.push("</s>"));var a=i.valign||"";return a=="superscript"||a=="super"?a="sup":a=="subscript"&&(a="sub"),a!=""&&(s.push("<"+a+">"),l.push("</"+a+">")),l.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),zO=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,HO=/<(?:\w+:)?r>/,$O=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function xp(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=lt(xt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=xt(e),r&&(n.h=np(n.t))):e.match(HO)&&(n.r=xt(e),n.t=lt(xt((e.replace($O,"").match(zO)||[]).join("").replace(Rr,""))),r&&(n.h=WO(UO(n.r)))),n):{t:""}}var VO=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,XO=/<(?:\w+:)?(?:si|sstItem)>/g,YO=/<\/(?:\w+:)?(?:si|sstItem)>/;function GO(e,t){var r=[],n="";if(!e)return r;var i=e.match(VO);if(i){n=i[2].replace(XO,"").split(YO);for(var s=0;s!=n.length;++s){var l=xp(n[s].trim(),t);l!=null&&(r[r.length]=l)}i=Qe(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var qO=/^\s|\s$|[\t\n\r]/;function Dw(e,t){if(!t.bookSST)return"";var r=[qt];r[r.length]=Re("sst",null,{xmlns:Ks[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(qO)&&(s+=' xml:space="preserve"'),s+=">"+gt(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function KO(e){return[e.read_shift(4),e.read_shift(4)]}function JO(e,t){var r=[],n=!1;return Ei(e,function(s,l,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function QO(e,t){return t||(t=be(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var ZO=cN;function e3(e){var t=qr();Ce(t,159,QO(e));for(var r=0;r<e.length;++r)Ce(t,19,ZO(e[r]));return Ce(t,160),t.end()}function Rw(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function mi(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function t3(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=mi(e,4),t.U=mi(e,4),t.W=mi(e,4),t}function r3(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function n3(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(r3(e));return t}function i3(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function s3(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=mi(e,4),t.U=mi(e,4),t.W=mi(e,4),t}function a3(e){var t=s3(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Iw(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Mw(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function o3(e){var t=mi(e);switch(t.Minor){case 2:return[t.Minor,l3(e)];case 3:return[t.Minor,c3()];case 4:return[t.Minor,u3(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function l3(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Iw(e,r),i=Mw(e,e.length-e.l);return{t:"Std",h:n,v:i}}function c3(){throw new Error("File is password-protected: ECMA-376 Extensible")}function u3(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Rr,function(s){var l=Qe(s);switch(ni(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=l[o]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function f3(e,t){var r={},n=r.EncryptionVersionInfo=mi(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=Iw(e,i),t-=i,r.EncryptionVerifier=Mw(e,t),r}function h3(e){var t={},r=t.EncryptionVersionInfo=mi(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function vp(e){var t=0,r,n=Rw(e),i=n.length+1,s,l,o,a,c;for(r=rs(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)l=r[s],o=t&16384?1:0,a=t<<1&32767,c=o|a,t=c^l;return t^52811}var Lw=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},i=function(l,o){return n(l^o)},s=function(l){for(var o=t[l.length-1],a=104,c=l.length-1;c>=0;--c)for(var d=l[c],h=0;h!=7;++h)d&64&&(o^=r[a]),d*=2,--a;return o};return function(l){for(var o=Rw(l),a=s(o),c=o.length,d=rs(16),h=0;h!=16;++h)d[h]=0;var f,u,p;for((c&1)===1&&(f=a>>8,d[c]=i(e[0],f),--c,f=a&255,u=o[o.length-1],d[c]=i(u,f));c>0;)--c,f=a>>8,d[c]=i(o[c],f),--c,f=a&255,d[c]=i(o[c],f);for(c=15,p=15-o.length;p>0;)f=a>>8,d[c]=i(e[p],f),--c,--p,f=a&255,d[c]=i(o[c],f),--c,--p;return d}}(),d3=function(e,t,r,n,i){i||(i=t),n||(n=Lw(e));var s,l;for(s=0;s!=t.length;++s)l=t[s],l^=n[r],l=(l>>5|l<<3)&255,i[s]=l,++r;return[i,r,n]},p3=function(e){var t=0,r=Lw(e);return function(n){var i=d3("",n,t,r);return t=i[1],i[0]}};function g3(e,t,r,n){var i={key:Zt(e),verificationBytes:Zt(e)};return r.password&&(i.verifier=vp(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=p3(r.password)),i}function m3(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=h3(e):n.Data=f3(e,t),n}function x3(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?m3(e,t-2,n):g3(e,r.biff>=8?t:t-2,r,n),n}var Bw=function(){function e(i,s){switch(s.type){case"base64":return t(ln(i),s);case"binary":return t(i,s);case"buffer":return t(it&&Buffer.isBuffer(i)?i.toString("binary"):cs(i),s);case"array":return t(zs(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var l=s||{},o=l.dense?[]:{},a=i.match(/\\trowd.*?\\row\b/g);if(!a.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:a.length-1}};return a.forEach(function(d,h){Array.isArray(o)&&(o[h]=[]);for(var f=/\\\w+\b/g,u=0,p,m=-1;p=f.exec(d);){switch(p[0]){case"\\cell":var g=d.slice(u,f.lastIndex-p[0].length);if(g[0]==" "&&(g=g.slice(1)),++m,g.length){var x={v:g,t:"s"};Array.isArray(o)?o[h][m]=x:o[Je({r:h,c:m})]=x}break}u=f.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=rt(c),o}function r(i,s){return us(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],l=ct(i["!ref"]),o,a=Array.isArray(i),c=l.s.r;c<=l.e.r;++c){s.push("\\trowd\\trautofit1");for(var d=l.s.c;d<=l.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=l.s.c;d<=l.e.c;++d){var h=Je({r:c,c:d});o=a?(i[c]||[])[d]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(ki(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function v3(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Rl(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function y3(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),l=i-s;if(l===0)return[0,0,t];var o=0,a=0,c=i+s;switch(a=l/(c>1?2-c:c),i){case t:o=((r-n)/l+6)%6;break;case r:o=(n-t)/l+2;break;case n:o=(t-r)/l+4;break}return[o/6,a,c/2]}function w3(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,l=[s,s,s],o=6*t,a;if(r!==0)switch(o|0){case 0:case 6:a=i*o,l[0]+=i,l[1]+=a;break;case 1:a=i*(2-o),l[0]+=a,l[1]+=i;break;case 2:a=i*(o-2),l[1]+=i,l[2]+=a;break;case 3:a=i*(4-o),l[1]+=a,l[2]+=i;break;case 4:a=i*(o-4),l[2]+=i,l[0]+=a;break;case 5:a=i*(6-o),l[2]+=a,l[0]+=i;break}for(var c=0;c!=3;++c)l[c]=Math.round(l[c]*255);return l}function zu(e,t){if(t===0)return e;var r=y3(v3(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Rl(w3(r))}var Uw=6,_3=15,b3=1,Or=Uw;function Il(e){return Math.floor((e+Math.round(128/Or)/256)*Or)}function Ml(e){return Math.floor((e-5)/Or*100+.5)/100}function Hu(e){return Math.round((e*Or+5)/Or*256)/256}function mh(e){return Hu(Ml(Il(e)))}function yp(e){var t=Math.abs(e-mh(e)),r=Or;if(t>.005)for(Or=b3;Or<_3;++Or)Math.abs(e-mh(e))<=t&&(t=Math.abs(e-mh(e)),r=Or);Or=r}function ns(e){e.width?(e.wpx=Il(e.width),e.wch=Ml(e.wpx),e.MDW=Or):e.wpx?(e.wch=Ml(e.wpx),e.width=Hu(e.wch),e.MDW=Or):typeof e.wch=="number"&&(e.width=Hu(e.wch),e.wpx=Il(e.width),e.MDW=Or),e.customWidth&&delete e.customWidth}var k3=96,Ww=k3;function Ll(e){return e*96/Ww}function eo(e){return e*Ww/96}var S3={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function C3(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(Rr)||[]).forEach(function(l){var o=Qe(l);switch(ni(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=bt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=bt(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function T3(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(Rr)||[]).forEach(function(l){var o=Qe(l);switch(ni(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function E3(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(Rr)||[]).forEach(function(l){var o=Qe(l);switch(ni(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=xt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?bt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?bt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?bt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?bt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?bt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?bt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?bt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Y0[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=bt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var a=Fs[i.color.index];i.color.index==81&&(a=Fs[1]),a||(a=Fs[1]),i.color.rgb=a[0].toString(16)+a[1].toString(16)+a[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=zu(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function N3(e,t,r){t.NumberFmt=[];for(var n=zt(Ge),i=0;i<n.length;++i)t.NumberFmt[n[i]]=Ge[n[i]];var s=e[0].match(Rr);if(s)for(i=0;i<s.length;++i){var l=Qe(s[i]);switch(ni(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=lt(xt(l.formatCode)),a=parseInt(l.numFmtId,10);if(t.NumberFmt[a]=o,a>0){if(a>392){for(a=392;a>60&&t.NumberFmt[a]!=null;--a);t.NumberFmt[a]=o}gi(o,a)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function A3(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Re("numFmt",null,{numFmtId:n,formatCode:gt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Re("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Mc=["numFmtId","fillId","fontId","borderId","xfId"],Lc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function O3(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Rr)||[]).forEach(function(s){var l=Qe(s),o=0;switch(ni(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],o=0;o<Mc.length;++o)n[Mc[o]]&&(n[Mc[o]]=parseInt(n[Mc[o]],10));for(o=0;o<Lc.length;++o)n[Lc[o]]&&(n[Lc[o]]=bt(n[Lc[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var a={};l.vertical&&(a.vertical=l.vertical),l.horizontal&&(a.horizontal=l.horizontal),l.textRotation!=null&&(a.textRotation=l.textRotation),l.indent&&(a.indent=l.indent),l.wrapText&&(a.wrapText=bt(l.wrapText)),n.alignment=a;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function F3(e){var t=[];return t[t.length]=Re("cellXfs",null),e.forEach(function(r){t[t.length]=Re("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Re("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var j3=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,a,c){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(t))&&N3(h,d,c),(h=o.match(i))&&E3(h,d,a,c),(h=o.match(n))&&T3(h,d,a,c),(h=o.match(s))&&C3(h,d,a,c),(h=o.match(r))&&O3(h,d,c),d}}();function zw(e,t){var r=[qt,Re("styleSheet",null,{xmlns:Ks[0],"xmlns:vt":sr.vt})],n;return e.SSF&&(n=A3(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=F3(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function P3(e,t){var r=e.read_shift(2),n=jr(e);return[r,n]}function D3(e,t,r){r||(r=be(6+4*t.length)),r.write_shift(2,e),hr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function R3(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=mN(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var o=e.read_shift(1);o>0&&(n.family=o);var a=e.read_shift(1);switch(a>0&&(n.charset=a),e.l++,n.color=gN(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=jr(e),n}function I3(e,t){t||(t=be(25+4*32)),t.write_shift(2,e.sz*20),xN(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Bu(e.color,t);var n=0;return n=2,t.write_shift(1,n),hr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var M3=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],xh,L3=Dr;function gx(e,t){t||(t=be(4*3+8*7+16*1)),xh||(xh=xf(M3));var r=xh[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Bu({auto:1},t),Bu({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function B3(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function Hw(e,t,r){r||(r=be(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function So(e,t){return t||(t=be(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var U3=Dr;function W3(e,t){return t||(t=be(51)),t.write_shift(1,0),So(null,t),So(null,t),So(null,t),So(null,t),So(null,t),t.length>t.l?t.slice(0,t.l):t}function z3(e,t){return t||(t=be(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Lu(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function H3(e,t,r){var n=be(2052);return n.write_shift(4,e),Lu(t,n),Lu(r,n),n.length>n.l?n.slice(0,n.l):n}function $3(e,t,r){var n={};n.NumberFmt=[];for(var i in Ge)n.NumberFmt[i]=Ge[i];n.CellXf=[],n.Fonts=[];var s=[],l=!1;return Ei(e,function(a,c,d){switch(d){case 44:n.NumberFmt[a[0]]=a[1],gi(a[1],a[0]);break;case 43:n.Fonts.push(a),a.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=zu(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(a);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(d),l=!0;break;case 38:s.pop(),l=!1;break;default:if(c.T>0)s.push(d);else if(c.T<0)s.pop();else if(!l||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function V3(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(Ce(e,615,Un(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Ce(e,44,D3(i,t[i]))}),Ce(e,616))}}function X3(e){var t=1;Ce(e,611,Un(t)),Ce(e,43,I3({sz:12,color:{theme:1},name:"Calibri",family:2})),Ce(e,612)}function Y3(e){var t=2;Ce(e,603,Un(t)),Ce(e,45,gx({patternType:"none"})),Ce(e,45,gx({patternType:"gray125"})),Ce(e,604)}function G3(e){var t=1;Ce(e,613,Un(t)),Ce(e,46,W3()),Ce(e,614)}function q3(e){var t=1;Ce(e,626,Un(t)),Ce(e,47,Hw({numFmtId:0},65535)),Ce(e,627)}function K3(e,t){Ce(e,617,Un(t.length)),t.forEach(function(r){Ce(e,47,Hw(r,0))}),Ce(e,618)}function J3(e){var t=1;Ce(e,619,Un(t)),Ce(e,48,z3({xfId:0,name:"Normal"})),Ce(e,620)}function Q3(e){var t=0;Ce(e,505,Un(t)),Ce(e,506)}function Z3(e){var t=0;Ce(e,508,H3(t,"TableStyleMedium9","PivotStyleMedium4")),Ce(e,509)}function eF(e,t){var r=qr();return Ce(r,278),V3(r,e.SSF),X3(r),Y3(r),G3(r),q3(r),K3(r,t.cellXfs),J3(r),Q3(r),Z3(r),Ce(r,279),r.end()}var tF=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function rF(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Rr)||[]).forEach(function(i){var s=Qe(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[tF.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function nF(){}function iF(){}var sF=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,aF=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,oF=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function lF(e,t,r){t.themeElements={};var n;[["clrScheme",sF,rF],["fontScheme",aF,nF],["fmtScheme",oF,iF]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var cF=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function $w(e,t){(!e||e.length===0)&&(e=wp());var r,n={};if(!(r=e.match(cF)))throw new Error("themeElements not found in theme");return lF(r[0],n,t),n.raw=e,n}function wp(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[qt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function uF(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var l;try{l=Iy(s,{type:"array"})}catch{return}var o=rn(l,"theme/theme/theme1.xml",!0);if(o)return $w(o,r)}}function fF(e){return e.read_shift(4)}function hF(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=dF(e,4);break;case 2:t.xclrValue=kw(e);break;case 3:t.xclrValue=fF(e);break;case 4:e.l+=4;break}return e.l+=8,t}function dF(e,t){return Dr(e,t)}function pF(e,t){return Dr(e,t)}function gF(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=hF(e);break;case 6:n[1]=pF(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function mF(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(gF(e,r-e.l));return{ixfe:n,ext:s}}function xF(e,t){t.forEach(function(r){switch(r[0]){}})}function vF(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:jr(e)}}function yF(e){var t=be(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),hr(e.name,t),t.slice(0,t.l)}function wF(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function _F(e){var t=be(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function bF(e,t){var r=be(8+2*t.length);return r.write_shift(4,e),hr(t,r),r.slice(0,r.l)}function kF(e){return e.l+=4,e.read_shift(4)!=0}function SF(e,t){var r=be(8);return r.write_shift(4,e),r.write_shift(4,1),r}function CF(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],l=!1,o=2;return Ei(e,function(a,c,d){switch(d){case 335:n.Types.push({name:a.name});break;case 51:a.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=a?1:0;break;case 338:o=2;break;case 35:s.push(d),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!c.T){if(!l||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function TF(){var e=qr();return Ce(e,332),Ce(e,334,Un(1)),Ce(e,335,yF({name:"XLDAPR",version:12e4,flags:3496657072})),Ce(e,336),Ce(e,339,bF(1,"XLDAPR")),Ce(e,52),Ce(e,35,Un(514)),Ce(e,4096,Un(0)),Ce(e,4097,xn(1)),Ce(e,36),Ce(e,53),Ce(e,340),Ce(e,337,SF(1)),Ce(e,51,_F([[1,0]])),Ce(e,338),Ce(e,333),e.end()}function EF(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,l;return e.replace(Rr,function(o){var a=Qe(o);switch(ni(a[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:a.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==a.name&&(l=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[a.t-1].name,index:+a.v}):s==0&&n.Value.push({type:n.Types[a.t-1].name,index:+a.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+a.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+a[0]+" in metadata")}return o}),n}function Vw(){var e=[qt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function NF(e){var t=[];if(!e)return t;var r=1;return(e.match(Rr)||[]).forEach(function(n){var i=Qe(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function AF(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Je(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function OF(e,t,r){var n=[];return Ei(e,function(s,l,o){switch(o){case 63:n.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function FF(e,t,r,n){if(!e)return e;var i=n||{},s=!1;Ei(e,function(o,a,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!a.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function jF(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var ja=1024;function Xw(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Re("xml",null,{"xmlns:v":Zr.v,"xmlns:o":Zr.o,"xmlns:x":Zr.x,"xmlns:mv":Zr.mv}).replace(/\/>/,">"),Re("o:shapelayout",Re("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Re("v:shapetype",[Re("v:stroke",null,{joinstyle:"miter"}),Re("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];ja<e*1e3;)ja+=1e3;return t.forEach(function(s){var l=Rt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var a=o.type=="gradient"?Re("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Re("v:fill",a,o),d={on:"t",obscured:"t"};++ja,i=i.concat(["<v:shape"+jl({id:"_x0000_s"+ja,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Re("v:shadow",null,d),Re("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",wr("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),wr("x:AutoFill","False"),wr("x:Row",String(l.r)),wr("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function mx(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(l){var o=Rt(l.ref);if(i?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[l.ref],!s){s={t:"z"},i?e[o.r][o.c]=s:e[l.ref]=s;var a=ct(e["!ref"]||"BDWGO1000001:A1");a.s.r>o.r&&(a.s.r=o.r),a.e.r<o.r&&(a.e.r=o.r),a.s.c>o.c&&(a.s.c=o.c),a.e.c<o.c&&(a.e.c=o.c);var c=rt(a);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var d={a:l.author,t:l.t,r:l.r,T:r};l.h&&(d.h=l.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(d.a==n[h].id){d.a=n[h].name||d.a;break}}s.c.push(d)})}function PF(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?comment[^>]*>/);if(o){var a=Qe(o[0]),c={author:a.authorId&&r[a.authorId]||"sheetjsghost",ref:a.ref,guid:a.guid},d=Rt(a.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var h=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!h&&!!h[1]&&xp(h[1])||{r:"",t:"",h:""};c.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),c.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=f.h),n.push(c)}}}}),n}function Yw(e){var t=[qt,Re("comments",null,{xmlns:Ks[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=gt(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(a){a.a&&(i=r.indexOf(gt(a.a))),s.push(a.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(wr("t",gt(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)l+=`Reply:
    `+s[o]+`
`;t.push(wr("t",gt(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function DF(e,t){var r=[],n=!1,i={},s=0;return e.replace(Rr,function(o,a){var c=Qe(o);switch(ni(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=a+o.length;break;case"</text>":i.t=e.slice(s,a).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function RF(e,t,r){var n=[qt,Re("ThreadedComments",null,{xmlns:sr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var a={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=a.id:a.parentId=s,l.ID=a.id,l.a&&(a.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),n.push(Re("threadedComment",wr("text",l.t||""),a))})}),n.push("</ThreadedComments>"),n.join("")}function IF(e,t){var r=[],n=!1;return e.replace(Rr,function(s){var l=Qe(s);switch(ni(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),r}function MF(e){var t=[qt,Re("personList",null,{xmlns:sr.TCMNT,"xmlns:x":Ks[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Re("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function LF(e){var t={};t.iauthor=e.read_shift(4);var r=ea(e);return t.rfx=r.s,t.ref=Je(r.s),e.l+=16,t}function BF(e,t){return t==null&&(t=be(36)),t.write_shift(4,e[1].iauthor),uo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var UF=jr;function WF(e){return hr(e.slice(0,54))}function zF(e,t){var r=[],n=[],i={},s=!1;return Ei(e,function(o,a,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!a.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function HF(e){var t=qr(),r=[];return Ce(t,628),Ce(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Ce(t,632,WF(i.a)))})}),Ce(t,631),Ce(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Rt(n[0]),e:Rt(n[0])};Ce(t,635,BF([s,i])),i.t&&i.t.length>0&&Ce(t,637,fN(i)),Ce(t,636),delete i.iauthor})}),Ce(t,634),Ce(t,629),t.end()}var $F="application/vnd.ms-office.vbaProject";function VF(e){var t=Xe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Xe.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Xe.write(t)}function XF(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Xe.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var Gw=["xlsb","xlsm","xlam","biff8","xla"];function YF(){return{"!type":"dialog"}}function GF(){return{"!type":"dialog"}}function qF(){return{"!type":"macro"}}function KF(){return{"!type":"macro"}}var za=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,l){var o=!1,a=!1;s.length==0?a=!0:s.charAt(0)=="["&&(a=!0,s=s.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,d=l.length>0?parseInt(l,10)|0:0;return o?d+=t.c:--d,a?c+=t.r:--c,i+(o?"":"$")+Dt(d)+(a?"":"$")+Gt(c)}return function(i,s){return t=s,i.replace(e,r)}}(),_p=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,bp=function(){return function(t,r){return t.replace(_p,function(n,i,s,l,o,a){var c=lp(l)-(s?0:r.c),d=op(a)-(o?0:r.r),h=d==0?"":o?d+1:"["+d+"]",f=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+f})}}();function qw(e,t){return e.replace(_p,function(r,n,i,s,l,o){return n+(i=="$"?i+s:Dt(lp(s)+t.c))+(l=="$"?l+o:Gt(op(o)+t.r))})}function JF(e,t,r){var n=Kr(t),i=n.s,s=Rt(r),l={r:s.r-i.r,c:s.c-i.c};return qw(e,l)}function QF(e){return e.length!=1}function xx(e){return e.replace(/_xlfn\./g,"")}function Jt(e){e.l+=1}function is(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Kw(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Jw(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),l=is(e),o=is(e);return{s:{r:i,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Jw(e){var t=is(e),r=is(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function ZF(e,t,r){if(r.biff<8)return Jw(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=is(e),l=is(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function Qw(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return ej(e);var n=e.read_shift(r&&r.biff==12?4:2),i=is(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function ej(e){var t=is(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function tj(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function rj(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return nj(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),l=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:l,rRel:o}}function nj(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function ij(e,t,r){var n=(e[e.l++]&96)>>5,i=Kw(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function sj(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var l=Kw(e,s,r);return[n,i,l]}function aj(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function oj(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function lj(e,t,r){var n=(e[e.l++]&96)>>5,i=ZF(e,t-1,r);return[n,i]}function cj(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function vx(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function uj(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function fj(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function hj(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function dj(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function pj(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Zw(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function gj(e){return e.read_shift(2),Zw(e)}function mj(e){return e.read_shift(2),Zw(e)}function xj(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=Qw(e,0,r);return[n,i]}function vj(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=rj(e,0,r);return[n,i]}function yj(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=Qw(e,0,r);return[n,i,s]}function wj(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[kP[i],r_[i],n]}function _j(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:bj(e);return[i,(s[0]===0?r_:bP)[s[1]]]}function bj(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function kj(e,t,r){e.l+=r&&r.biff==2?3:4}function Sj(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Cj(e){return e.l++,Ni[e.read_shift(1)]}function Tj(e){return e.l++,e.read_shift(2)}function Ej(e){return e.l++,e.read_shift(1)!==0}function Nj(e){return e.l++,Fr(e)}function Aj(e,t,r){return e.l++,Zl(e,t-1,r)}function Oj(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=$t(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ni[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Fr(e);break;case 2:r[1]=ta(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Fj(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?ea:wf)(e));return i}function jj(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,l=[];s!=n&&(l[s]=[]);++s)for(var o=0;o!=i;++o)l[s][o]=Oj(e,r.biff);return l}function Pj(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function Dj(e,t,r){if(r.biff==5)return Rj(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function Rj(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Ij(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Mj(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Lj(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Bj(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var Uj=Dr,Wj=Dr,zj=Dr;function tc(e,t,r){return e.l+=2,[tj(e)]}function kp(e){return e.l+=6,[]}var Hj=tc,$j=kp,Vj=kp,Xj=tc;function e_(e){return e.l+=2,[Zt(e),e.read_shift(2)&1]}var Yj=tc,Gj=e_,qj=kp,Kj=tc,Jj=tc,Qj=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Zj(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),l=Qj[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:n,c:i,C:s}}function eP(e){return e.l+=2,[e.read_shift(4)]}function tP(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function rP(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function nP(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function iP(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function sP(e){return e.l+=4,[0,0]}var yx={1:{n:"PtgExp",f:Sj},2:{n:"PtgTbl",f:zj},3:{n:"PtgAdd",f:Jt},4:{n:"PtgSub",f:Jt},5:{n:"PtgMul",f:Jt},6:{n:"PtgDiv",f:Jt},7:{n:"PtgPower",f:Jt},8:{n:"PtgConcat",f:Jt},9:{n:"PtgLt",f:Jt},10:{n:"PtgLe",f:Jt},11:{n:"PtgEq",f:Jt},12:{n:"PtgGe",f:Jt},13:{n:"PtgGt",f:Jt},14:{n:"PtgNe",f:Jt},15:{n:"PtgIsect",f:Jt},16:{n:"PtgUnion",f:Jt},17:{n:"PtgRange",f:Jt},18:{n:"PtgUplus",f:Jt},19:{n:"PtgUminus",f:Jt},20:{n:"PtgPercent",f:Jt},21:{n:"PtgParen",f:Jt},22:{n:"PtgMissArg",f:Jt},23:{n:"PtgStr",f:Aj},26:{n:"PtgSheet",f:tP},27:{n:"PtgEndSheet",f:rP},28:{n:"PtgErr",f:Cj},29:{n:"PtgBool",f:Ej},30:{n:"PtgInt",f:Tj},31:{n:"PtgNum",f:Nj},32:{n:"PtgArray",f:cj},33:{n:"PtgFunc",f:wj},34:{n:"PtgFuncVar",f:_j},35:{n:"PtgName",f:Pj},36:{n:"PtgRef",f:xj},37:{n:"PtgArea",f:ij},38:{n:"PtgMemArea",f:Ij},39:{n:"PtgMemErr",f:Uj},40:{n:"PtgMemNoMem",f:Wj},41:{n:"PtgMemFunc",f:Mj},42:{n:"PtgRefErr",f:Lj},43:{n:"PtgAreaErr",f:aj},44:{n:"PtgRefN",f:vj},45:{n:"PtgAreaN",f:lj},46:{n:"PtgMemAreaN",f:nP},47:{n:"PtgMemNoMemN",f:iP},57:{n:"PtgNameX",f:Dj},58:{n:"PtgRef3d",f:yj},59:{n:"PtgArea3d",f:sj},60:{n:"PtgRefErr3d",f:Bj},61:{n:"PtgAreaErr3d",f:oj},255:{}},aP={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},oP={1:{n:"PtgElfLel",f:e_},2:{n:"PtgElfRw",f:Kj},3:{n:"PtgElfCol",f:Hj},6:{n:"PtgElfRwV",f:Jj},7:{n:"PtgElfColV",f:Xj},10:{n:"PtgElfRadical",f:Yj},11:{n:"PtgElfRadicalS",f:qj},13:{n:"PtgElfColS",f:$j},15:{n:"PtgElfColSV",f:Vj},16:{n:"PtgElfRadicalLel",f:Gj},25:{n:"PtgList",f:Zj},29:{n:"PtgSxName",f:eP},255:{}},lP={0:{n:"PtgAttrNoop",f:sP},1:{n:"PtgAttrSemi",f:pj},2:{n:"PtgAttrIf",f:hj},4:{n:"PtgAttrChoose",f:uj},8:{n:"PtgAttrGoto",f:fj},16:{n:"PtgAttrSum",f:kj},32:{n:"PtgAttrBaxcel",f:vx},33:{n:"PtgAttrBaxcel",f:vx},64:{n:"PtgAttrSpace",f:gj},65:{n:"PtgAttrSpaceSemi",f:mj},128:{n:"PtgAttrIfError",f:dj},255:{}};function rc(e,t,r,n){if(n.biff<8)return Dr(e,t);for(var i=e.l+t,s=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=jj(e,0,n),s.push(r[l][1]);break;case"PtgMemArea":r[l][2]=Fj(e,r[l][1],n),s.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=e.read_shift(4),s.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=i-e.l,t!==0&&s.push(Dr(e,t)),s}function nc(e,t,r){for(var n=e.l+t,i,s,l=[];n!=e.l;)t=n-e.l,s=e[e.l],i=yx[s]||yx[aP[s]],(s===24||s===25)&&(i=(s===24?oP:lP)[e[e.l+1]]),!i||!i.f?Dr(e,t):l.push([i.n,i.f(e,t,r)]);return l}function cP(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var l=n[s];if(l)switch(l[0]){case 2:i.push('"'+l[1].replace(/"/g,'""')+'"');break;default:i.push(l[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var uP={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function fP(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function t_(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function wx(e,t,r){var n=t_(e,t,r);return n=="#REF"?n:fP(n,r)}function Nr(e,t,r,n,i){var s=i&&i.biff||8,l={s:{c:0,r:0}},o=[],a,c,d,h=0,f=0,u,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",x=0,y=e[0].length;x<y;++x){var w=e[0][x];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(a=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=Ut(" ",e[0][m][1][1]);break;case 1:g=Ut("\r",e[0][m][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+g,m=-1}o.push(c+uP[w[0]]+a);break;case"PtgIsect":a=o.pop(),c=o.pop(),o.push(c+" "+a);break;case"PtgUnion":a=o.pop(),c=o.pop(),o.push(c+","+a);break;case"PtgRange":a=o.pop(),c=o.pop(),o.push(c+":"+a);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Go(w[1][1],l,i),o.push(qo(d,s));break;case"PtgRefN":d=r?Go(w[1][1],r,i):w[1][1],o.push(qo(d,s));break;case"PtgRef3d":h=w[1][1],d=Go(w[1][2],l,i),p=wx(n,h,i),o.push(p+"!"+qo(d,s));break;case"PtgFunc":case"PtgFuncVar":var _=w[1][0],b=w[1][1];_||(_=0),_&=127;var k=_==0?[]:o.slice(-_);o.length-=_,b==="User"&&(b=k.shift()),o.push(b+"("+k.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":u=qm(w[1][1],r?{s:r}:l,i),o.push(dh(u,i));break;case"PtgArea":u=qm(w[1][1],l,i),o.push(dh(u,i));break;case"PtgArea3d":h=w[1][1],u=w[1][2],p=wx(n,h,i),o.push(p+"!"+dh(u,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=w[1][2];var S=(n.names||[])[f-1]||(n[0]||[])[f],E=S?S.Name:"SH33TJSNAME"+String(f);E&&E.slice(0,6)=="_xlfn."&&!i.xlfn&&(E=E.slice(6)),o.push(E);break;case"PtgNameX":var F=w[1][1];f=w[1][2];var P;if(i.biff<=5)F<0&&(F=-F),n[F]&&(P=n[F][f]);else{var D="";if(((n[F]||[])[0]||[])[0]==14849||(((n[F]||[])[0]||[])[0]==1025?n[F][f]&&n[F][f].itab>0&&(D=n.SheetNames[n[F][f].itab-1]+"!"):D=n.SheetNames[f-1]+"!"),n[F]&&n[F][f])D+=n[F][f].Name;else if(n[0]&&n[0][f])D+=n[0][f].Name;else{var I=(t_(n,F,i)||"").split(";;");I[f-1]?D=I[f-1]:D+="SH33TJSERRX"}o.push(D);break}P||(P={Name:"SH33TJSERRY"}),o.push(P.Name);break;case"PtgParen":var X="(",z=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:X=Ut(" ",e[0][m][1][1])+X;break;case 3:X=Ut("\r",e[0][m][1][1])+X;break;case 4:z=Ut(" ",e[0][m][1][1])+z;break;case 5:z=Ut("\r",e[0][m][1][1])+z;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(X+o.pop()+z);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:w[1][1],r:w[1][0]};var G={c:r.c,r:r.r};if(n.sharedf[Je(d)]){var ae=n.sharedf[Je(d)];o.push(Nr(ae,l,G,n,i))}else{var le=!1;for(a=0;a!=n.arrayf.length;++a)if(c=n.arrayf[a],!(d.c<c[0].s.c||d.c>c[0].e.c)&&!(d.r<c[0].s.r||d.r>c[0].e.r)){o.push(Nr(c[1],l,G,n,i)),le=!0;break}le||o.push(w[1])}break;case"PtgArray":o.push("{"+cP(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var Z=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&Z.indexOf(e[0][x][0])==-1){w=e[0][m];var C=!0;switch(w[1][0]){case 4:C=!1;case 0:g=Ut(" ",w[1][1]);break;case 5:C=!1;case 1:g=Ut("\r",w[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((C?g:"")+o.pop()+(C?"":g)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function hP(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,l=e.read_shift(i);if(l==65535)return[[],Dr(e,t-2)];var o=nc(e,l,r);return t!==l+i&&(s=rc(e,t-l-i,o,r)),e.l=n,[o,s]}function dP(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,l=e.read_shift(i);if(l==65535)return[[],Dr(e,t-2)];var o=nc(e,l,r);return t!==l+i&&(s=rc(e,t-l-i,o,r)),e.l=n,[o,s]}function pP(e,t,r,n){var i=e.l+t,s=nc(e,n,r),l;return i!==e.l&&(l=rc(e,i-e.l,s,r)),[s,l]}function gP(e,t,r){var n=e.l+t,i,s=e.read_shift(2),l=nc(e,s,r);return s==65535?[[],Dr(e,t-2)]:(t!==s+2&&(i=rc(e,n-s-2,l,r)),[l,i])}function mP(e){var t;if(fi(e,e.l+6)!==65535)return[Fr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function xP(e){if(e==null){var t=be(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Hs(e);return Hs(0)}function vh(e,t,r){var n=e.l+t,i=ii(e);r.biff==2&&++e.l;var s=mP(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=dP(e,n-e.l,r);return{cell:i,val:s[0],formula:o,shared:l>>3&1,tt:s[1]}}function vP(e,t,r,n,i){var s=Vs(t,r,i),l=xP(e.v),o=be(6),a=33;o.write_shift(2,a),o.write_shift(4,0);for(var c=be(e.bf.length),d=0;d<e.bf.length;++d)c[d]=e.bf[d];var h=fr([s,l,o,c]);return h}function _f(e,t,r){var n=e.read_shift(4),i=nc(e,n,r),s=e.read_shift(4),l=s>0?rc(e,s,i,r):null;return[i,l]}var yP=_f,bf=_f,wP=_f,_P=_f,bP={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},r_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},kP={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function _x(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function SP(e){var t="of:="+e.replace(_p,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function yh(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function CP(e){return e.replace(/\./,"!")}var Jo={},Ha={},Qo=typeof Map<"u";function Sp(e,t,r){var n=0,i=e.length;if(r){if(Qo?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Qo?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(Qo?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function kf(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Or=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Ml(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Hu(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Ds(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function fs(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){gi(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function n_(e,t,r,n,i,s){try{n.cellNF&&(e.z=Ge[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Ct(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Ge[t]==null&&gi(b4[t]||"General",t),e.t==="e")e.w=e.w||Ni[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ol(e.v);else if(e.t==="d"){var l=or(e.v);(l|0)===l?e.w=l.toString(10):e.w=Ol(l)}else{if(e.v===void 0)return"";e.w=Ws(e.v,Ha)}else e.t==="d"?e.w=Tn(t,or(e.v),Ha):e.w=Tn(t,e.v,Ha)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=zu(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=zu(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function TP(e,t,r){if(e&&e["!ref"]){var n=ct(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function EP(e,t){var r=ct(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=rt(r))}var NP=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,AP=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,OP=/<(?:\w:)?hyperlink [^>]*>/mg,FP=/"(\w*:\w*)"/,jP=/<(?:\w:)?col\b[^>]*[\/]?>/g,PP=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,DP=/<(?:\w:)?pageMargins[^>]*\/>/g,i_=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,RP=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,IP=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function MP(e,t,r,n,i,s,l){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},a={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",h=e.match(AP);h?(c=e.slice(0,h.index),d=e.slice(h.index+h[0].length)):c=d=e;var f=c.match(i_);f?Cp(f[0],o,i,r):(f=c.match(RP))&&BP(f[0],f[1]||"",o,i,r);var u=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(u>0){var p=c.slice(u,u+50).match(FP);p&&EP(o,p[1])}var m=c.match(IP);m&&m[1]&&QP(m[1],i);var g=[];if(t.cellStyles){var x=c.match(jP);x&&YP(g,x)}h&&tD(h[1],o,t,a,s,l);var y=d.match(PP);y&&(o["!autofilter"]=qP(y[0]));var w=[],_=d.match(NP);if(_)for(u=0;u!=_.length;++u)w[u]=ct(_[u].slice(_[u].indexOf('"')+1));var b=d.match(OP);b&&$P(o,b,n);var k=d.match(DP);if(k&&(o["!margins"]=VP(Qe(k[0]))),!o["!ref"]&&a.e.c>=a.s.c&&a.e.r>=a.s.r&&(o["!ref"]=rt(a)),t.sheetRows>0&&o["!ref"]){var S=ct(o["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>a.e.r&&(S.e.r=a.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>a.e.c&&(S.e.c=a.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),o["!fullref"]=o["!ref"],o["!ref"]=rt(S))}return g.length>0&&(o["!cols"]=g),w.length>0&&(o["!merges"]=w),o}function LP(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+rt(e[r])+'"/>';return t+"</mergeCells>"}function Cp(e,t,r,n){var i=Qe(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=lt(xt(i.codeName)))}function BP(e,t,r,n,i){Cp(e.slice(0,e.indexOf(">")),r,n,i)}function UP(e,t,r,n,i){var s=!1,l={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var a=t.SheetNames[r];try{t.Workbook&&(a=t.Workbook.Sheets[r].CodeName||a)}catch{}s=!0,l.codeName=Qn(gt(a))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+Re("outlinePr",null,c)}!s&&!o||(i[i.length]=Re("sheetPr",o,l))}var WP=["objects","scenarios","selectLockedCells","selectUnlockedCells"],zP=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function HP(e){var t={sheet:1};return WP.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),zP.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=vp(e.password).toString(16).toUpperCase()),Re("sheetProtection",null,t)}function $P(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=Qe(xt(t[i]),!0);if(!s.ref)return;var l=((r||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+lt(s.location))):(s.Target="#"+lt(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=ct(s.ref),a=o.s.r;a<=o.e.r;++a)for(var c=o.s.c;c<=o.e.c;++c){var d=Je({c,r:a});n?(e[a]||(e[a]=[]),e[a][c]||(e[a][c]={t:"z",v:void 0}),e[a][c].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}function VP(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function XP(e){return Ds(e),Re("pageMargins",null,e)}function YP(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Qe(t[n],!0);i.hidden&&(i.hidden=bt(i.hidden));var s=parseInt(i.min,10)-1,l=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,yp(i.width)),ns(i);s<=l;)e[s++]=Tt(i)}}function GP(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=Re("col",null,kf(i,n)));return r[r.length]="</cols>",r.join("")}function qP(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function KP(e,t,r,n){var i=typeof e.ref=="string"?e.ref:rt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=Kr(i);l.s.r==l.e.r&&(l.e.r=Kr(t["!ref"]).e.r,i=rt(l));for(var o=0;o<s.length;++o){var a=s[o];if(a.Name=="_xlnm._FilterDatabase"&&a.Sheet==n){a.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Re("autoFilter",null,{ref:i})}var JP=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function QP(e,t){t.Views||(t.Views=[{}]),(e.match(JP)||[]).forEach(function(r,n){var i=Qe(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),bt(i.rightToLeft)&&(t.Views[n].RTL=!0)})}function ZP(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Re("sheetViews",Re("sheetView",null,i),{})}function eD(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Ni[e.v];break;case"d":n&&n.cellDates?i=Ct(e.v,-1).toISOString():(e=Tt(e),e.t="n",i=""+(e.v=or(Ct(e.v)))),typeof e.z>"u"&&(e.z=Ge[14]);break;default:i=e.v;break}var o=wr("v",gt(i)),a={r:t},c=fs(n.cellXfs,e,n);switch(c!==0&&(a.s=c),e.t){case"n":break;case"d":a.t="d";break;case"b":a.t="b";break;case"e":a.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=wr("v",""+Sp(n.Strings,e.v,n.revStrings)),a.t="s";break}a.t="str";break}if(e.t!=s&&(e.t=s,e.v=l),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Re("f",gt(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(a.cm=1),Re("c",o,a)}var tD=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=Fl("v"),l=Fl("f");return function(a,c,d,h,f,u){for(var p=0,m="",g=[],x=[],y=0,w=0,_=0,b="",k,S,E=0,F=0,P,D,I=0,X=0,z=Array.isArray(u.CellXf),G,ae=[],le=[],Z=Array.isArray(c),C=[],L={},B=!1,N=!!d.sheetStubs,U=a.split(t),A=0,T=U.length;A!=T;++A){m=U[A].trim();var j=m.length;if(j!==0){var M=0;e:for(p=0;p<j;++p)switch(m[p]){case">":if(m[p-1]!="/"){++p;break e}if(d&&d.cellStyles){if(S=Qe(m.slice(M,p),!0),E=S.r!=null?parseInt(S.r,10):E+1,F=-1,d.sheetRows&&d.sheetRows<E)continue;L={},B=!1,S.ht&&(B=!0,L.hpt=parseFloat(S.ht),L.hpx=eo(L.hpt)),S.hidden=="1"&&(B=!0,L.hidden=!0),S.outlineLevel!=null&&(B=!0,L.level=+S.outlineLevel),B&&(C[E-1]=L)}break;case"<":M=p;break}if(M>=p)break;if(S=Qe(m.slice(M,p),!0),E=S.r!=null?parseInt(S.r,10):E+1,F=-1,!(d.sheetRows&&d.sheetRows<E)){h.s.r>E-1&&(h.s.r=E-1),h.e.r<E-1&&(h.e.r=E-1),d&&d.cellStyles&&(L={},B=!1,S.ht&&(B=!0,L.hpt=parseFloat(S.ht),L.hpx=eo(L.hpt)),S.hidden=="1"&&(B=!0,L.hidden=!0),S.outlineLevel!=null&&(B=!0,L.level=+S.outlineLevel),B&&(C[E-1]=L)),g=m.slice(p).split(e);for(var Y=0;Y!=g.length&&g[Y].trim().charAt(0)=="<";++Y);for(g=g.slice(Y),p=0;p!=g.length;++p)if(m=g[p].trim(),m.length!==0){if(x=m.match(r),y=p,w=0,_=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,x!=null&&x.length===2){for(y=0,b=x[1],w=0;w!=b.length&&!((_=b.charCodeAt(w)-64)<1||_>26);++w)y=26*y+_;--y,F=y}else++F;for(w=0;w!=m.length&&m.charCodeAt(w)!==62;++w);if(++w,S=Qe(m.slice(0,w),!0),S.r||(S.r=Je({r:E-1,c:F})),b=m.slice(w),k={t:""},(x=b.match(s))!=null&&x[1]!==""&&(k.v=lt(x[1])),d.cellFormula){if((x=b.match(l))!=null&&x[1]!==""){if(k.f=lt(xt(x[1])).replace(/\r\n/g,`
`),d.xlfn||(k.f=xx(k.f)),x[0].indexOf('t="array"')>-1)k.F=(b.match(i)||[])[1],k.F.indexOf(":")>-1&&ae.push([ct(k.F),k.F]);else if(x[0].indexOf('t="shared"')>-1){D=Qe(x[0]);var H=lt(xt(x[1]));d.xlfn||(H=xx(H)),le[parseInt(D.si,10)]=[D,H,S.r]}}else(x=b.match(/<f[^>]*\/>/))&&(D=Qe(x[0]),le[D.si]&&(k.f=JF(le[D.si][1],le[D.si][2],S.r)));var V=Rt(S.r);for(w=0;w<ae.length;++w)V.r>=ae[w][0].s.r&&V.r<=ae[w][0].e.r&&V.c>=ae[w][0].s.c&&V.c<=ae[w][0].e.c&&(k.F=ae[w][1])}if(S.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(N)k.t="z";else continue;else k.t=S.t||"n";switch(h.s.c>F&&(h.s.c=F),h.e.c<F&&(h.e.c=F),k.t){case"n":if(k.v==""||k.v==null){if(!N)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!N)continue;k.t="z"}else P=Jo[parseInt(k.v,10)],k.v=P.t,k.r=P.r,d.cellHTML&&(k.h=P.h);break;case"str":k.t="s",k.v=k.v!=null?xt(k.v):"",d.cellHTML&&(k.h=np(k.v));break;case"inlineStr":x=b.match(n),k.t="s",x!=null&&(P=xp(x[1]))?(k.v=P.t,d.cellHTML&&(k.h=P.h)):k.v="";break;case"b":k.v=bt(k.v);break;case"d":d.cellDates?k.v=Ct(k.v,1):(k.v=or(Ct(k.v,1)),k.t="n");break;case"e":(!d||d.cellText!==!1)&&(k.w=k.v),k.v=aw[k.v];break}if(I=X=0,G=null,z&&S.s!==void 0&&(G=u.CellXf[S.s],G!=null&&(G.numFmtId!=null&&(I=G.numFmtId),d.cellStyles&&G.fillId!=null&&(X=G.fillId))),n_(k,I,X,d,f,u),d.cellDates&&z&&k.t=="n"&&oo(Ge[I])&&(k.t="d",k.v=yf(k.v)),S.cm&&d.xlmeta){var fe=(d.xlmeta.Cell||[])[+S.cm-1];fe&&fe.type=="XLDAPR"&&(k.D=!0)}if(Z){var O=Rt(S.r);c[O.r]||(c[O.r]=[]),c[O.r][O.c]=k}else c[S.r]=k}}}}C.length>0&&(c["!rows"]=C)}}();function rD(e,t,r,n){var i=[],s=[],l=ct(e["!ref"]),o="",a,c="",d=[],h=0,f=0,u=e["!rows"],p=Array.isArray(e),m={r:c},g,x=-1;for(f=l.s.c;f<=l.e.c;++f)d[f]=Dt(f);for(h=l.s.r;h<=l.e.r;++h){for(s=[],c=Gt(h),f=l.s.c;f<=l.e.c;++f){a=d[f]+c;var y=p?(e[h]||[])[f]:e[a];y!==void 0&&(o=eD(y,a,e,t))!=null&&s.push(o)}(s.length>0||u&&u[h])&&(m={r:c},u&&u[h]&&(g=u[h],g.hidden&&(m.hidden=1),x=-1,g.hpx?x=Ll(g.hpx):g.hpt&&(x=g.hpt),x>-1&&(m.ht=x,m.customHeight=1),g.level&&(m.outlineLevel=g.level)),i[i.length]=Re("row",s.join(""),m))}if(u)for(;h<u.length;++h)u&&u[h]&&(m={r:h+1},g=u[h],g.hidden&&(m.hidden=1),x=-1,g.hpx?x=Ll(g.hpx):g.hpt&&(x=g.hpt),x>-1&&(m.ht=x,m.customHeight=1),g.level&&(m.outlineLevel=g.level),i[i.length]=Re("row","",m));return i.join("")}function s_(e,t,r,n){var i=[qt,Re("worksheet",null,{xmlns:Ks[0],"xmlns:r":sr.r})],s=r.SheetNames[e],l=0,o="",a=r.Sheets[s];a==null&&(a={});var c=a["!ref"]||"A1",d=ct(c);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=rt(d)}n||(n={}),a["!comments"]=[];var h=[];UP(a,r,e,t,i),i[i.length]=Re("dimension",null,{ref:c}),i[i.length]=ZP(a,t,e,r),t.sheetFormat&&(i[i.length]=Re("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),a["!cols"]!=null&&a["!cols"].length>0&&(i[i.length]=GP(a,a["!cols"])),i[l=i.length]="<sheetData/>",a["!links"]=[],a["!ref"]!=null&&(o=rD(a,t),o.length>0&&(i[i.length]=o)),i.length>l+1&&(i[i.length]="</sheetData>",i[l]=i[l].replace("/>",">")),a["!protect"]&&(i[i.length]=HP(a["!protect"])),a["!autofilter"]!=null&&(i[i.length]=KP(a["!autofilter"],a,r,e)),a["!merges"]!=null&&a["!merges"].length>0&&(i[i.length]=LP(a["!merges"]));var f=-1,u,p=-1;return a["!links"].length>0&&(i[i.length]="<hyperlinks>",a["!links"].forEach(function(m){m[1].Target&&(u={ref:m[0]},m[1].Target.charAt(0)!="#"&&(p=pt(n,-1,gt(m[1].Target).replace(/#.*$/,""),st.HLINK),u["r:id"]="rId"+p),(f=m[1].Target.indexOf("#"))>-1&&(u.location=gt(m[1].Target.slice(f+1))),m[1].Tooltip&&(u.tooltip=gt(m[1].Tooltip)),i[i.length]=Re("hyperlink",null,u))}),i[i.length]="</hyperlinks>"),delete a["!links"],a["!margins"]!=null&&(i[i.length]=XP(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=wr("ignoredErrors",Re("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(p=pt(n,-1,"../drawings/drawing"+(e+1)+".xml",st.DRAW),i[i.length]=Re("drawing",null,{"r:id":"rId"+p}),a["!drawing"]=h),a["!comments"].length>0&&(p=pt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",st.VML),i[i.length]=Re("legacyDrawing",null,{"r:id":"rId"+p}),a["!legacy"]=p),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function nD(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function iD(e,t,r){var n=be(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=Ll(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var l=0;i.level&&(l|=i.level),i.hidden&&(l|=16),(i.hpx||i.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var o=0,a=n.l;n.l+=4;for(var c={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var h=-1,f=-1,u=d<<10;u<d+1<<10;++u){c.c=u;var p=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Je(c)];p&&(h<0&&(h=u),f=u)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,f))}var m=n.l;return n.l=a,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function sD(e,t,r,n){var i=iD(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&Ce(e,0,i)}var aD=ea,oD=uo;function lD(){}function cD(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=hN(e),r}function uD(e,t,r){r==null&&(r=be(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Bu({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),tw(e,r),r.slice(0,r.l)}function fD(e){var t=En(e);return[t]}function hD(e,t,r){return r==null&&(r=be(8)),Js(t,r)}function dD(e){var t=Qs(e);return[t]}function pD(e,t,r){return r==null&&(r=be(4)),Zs(t,r)}function gD(e){var t=En(e),r=e.read_shift(1);return[t,r,"b"]}function mD(e,t,r){return r==null&&(r=be(9)),Js(t,r),r.write_shift(1,e.v?1:0),r}function xD(e){var t=Qs(e),r=e.read_shift(1);return[t,r,"b"]}function vD(e,t,r){return r==null&&(r=be(5)),Zs(t,r),r.write_shift(1,e.v?1:0),r}function yD(e){var t=En(e),r=e.read_shift(1);return[t,r,"e"]}function wD(e,t,r){return r==null&&(r=be(9)),Js(t,r),r.write_shift(1,e.v),r}function _D(e){var t=Qs(e),r=e.read_shift(1);return[t,r,"e"]}function bD(e,t,r){return r==null&&(r=be(8)),Zs(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function kD(e){var t=En(e),r=e.read_shift(4);return[t,r,"s"]}function SD(e,t,r){return r==null&&(r=be(12)),Js(t,r),r.write_shift(4,t.v),r}function CD(e){var t=Qs(e),r=e.read_shift(4);return[t,r,"s"]}function TD(e,t,r){return r==null&&(r=be(8)),Zs(t,r),r.write_shift(4,t.v),r}function ED(e){var t=En(e),r=Fr(e);return[t,r,"n"]}function ND(e,t,r){return r==null&&(r=be(16)),Js(t,r),Hs(e.v,r),r}function a_(e){var t=Qs(e),r=Fr(e);return[t,r,"n"]}function AD(e,t,r){return r==null&&(r=be(12)),Zs(t,r),Hs(e.v,r),r}function OD(e){var t=En(e),r=hp(e);return[t,r,"n"]}function FD(e,t,r){return r==null&&(r=be(12)),Js(t,r),rw(e.v,r),r}function jD(e){var t=Qs(e),r=hp(e);return[t,r,"n"]}function PD(e,t,r){return r==null&&(r=be(8)),Zs(t,r),rw(e.v,r),r}function DD(e){var t=En(e),r=cp(e);return[t,r,"is"]}function RD(e){var t=En(e),r=jr(e);return[t,r,"str"]}function ID(e,t,r){return r==null&&(r=be(12+4*e.v.length)),Js(t,r),hr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function MD(e){var t=Qs(e),r=jr(e);return[t,r,"str"]}function LD(e,t,r){return r==null&&(r=be(8+4*e.v.length)),Zs(t,r),hr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function BD(e,t,r){var n=e.l+t,i=En(e);i.r=r["!row"];var s=e.read_shift(1),l=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=bf(e,n-e.l,r);l[3]=Nr(o,null,i,r.supbooks,r)}else e.l=n;return l}function UD(e,t,r){var n=e.l+t,i=En(e);i.r=r["!row"];var s=e.read_shift(1),l=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=bf(e,n-e.l,r);l[3]=Nr(o,null,i,r.supbooks,r)}else e.l=n;return l}function WD(e,t,r){var n=e.l+t,i=En(e);i.r=r["!row"];var s=Fr(e),l=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=bf(e,n-e.l,r);l[3]=Nr(o,null,i,r.supbooks,r)}else e.l=n;return l}function zD(e,t,r){var n=e.l+t,i=En(e);i.r=r["!row"];var s=jr(e),l=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=bf(e,n-e.l,r);l[3]=Nr(o,null,i,r.supbooks,r)}else e.l=n;return l}var HD=ea,$D=uo;function VD(e,t){return t==null&&(t=be(4)),t.write_shift(4,e),t}function XD(e,t){var r=e.l+t,n=ea(e),i=up(e),s=jr(e),l=jr(e),o=jr(e);e.l=r;var a={rfx:n,relId:i,loc:s,display:o};return l&&(a.Tooltip=l),a}function YD(e,t){var r=be(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));uo({s:Rt(e[0]),e:Rt(e[0])},r),fp("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return hr(i||"",r),hr(e[1].Tooltip||"",r),hr("",r),r.slice(0,r.l)}function GD(){}function qD(e,t,r){var n=e.l+t,i=nw(e),s=e.read_shift(1),l=[i];if(l[2]=s,r.cellFormula){var o=yP(e,n-e.l,r);l[1]=o}else e.l=n;return l}function KD(e,t,r){var n=e.l+t,i=ea(e),s=[i];if(r.cellFormula){var l=_P(e,n-e.l,r);s[1]=l,e.l=n}else e.l=n;return s}function JD(e,t,r){r==null&&(r=be(18));var n=kf(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var o_=["left","right","top","bottom","header","footer"];function QD(e){var t={};return o_.forEach(function(r){t[r]=Fr(e)}),t}function ZD(e,t){return t==null&&(t=be(6*8)),Ds(e),o_.forEach(function(r){Hs(e[r],t)}),t}function e5(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function t5(e,t,r){r==null&&(r=be(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function r5(e){var t=be(24);return t.write_shift(4,4),t.write_shift(4,1),uo(e,t),t}function n5(e,t){return t==null&&(t=be(16*4+2)),t.write_shift(2,e.password?vp(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function i5(){}function s5(){}function a5(e,t,r,n,i,s,l){if(!e)return e;var o=t||{};n||(n={"!id":{}});var a=o.dense?[]:{},c,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,f=!1,u,p,m,g,x,y,w,_,b,k=[];o.biff=12,o["!row"]=0;var S=0,E=!1,F=[],P={},D=o.supbooks||i.supbooks||[[]];if(D.sharedf=P,D.arrayf=F,D.SheetNames=i.SheetNames||i.Sheets.map(function(Z){return Z.name}),!o.supbooks&&(o.supbooks=D,i.Names))for(var I=0;I<i.Names.length;++I)D[0][I+1]=i.Names[I];var X=[],z=[],G=!1;Bl[16]={n:"BrtShortReal",f:a_};var ae;if(Ei(e,function(C,L,B){if(!f)switch(B){case 148:c=C;break;case 0:u=C,o.sheetRows&&o.sheetRows<=u.r&&(f=!0),_=Gt(g=u.r),o["!row"]=u.r,(C.hidden||C.hpt||C.level!=null)&&(C.hpt&&(C.hpx=eo(C.hpt)),z[C.r]=C);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:C[2]},C[2]){case"n":p.v=C[1];break;case"s":w=Jo[C[1]],p.v=w.t,p.r=w.r;break;case"b":p.v=!!C[1];break;case"e":p.v=C[1],o.cellText!==!1&&(p.w=Ni[p.v]);break;case"str":p.t="s",p.v=C[1];break;case"is":p.t="s",p.v=C[1].t;break}if((m=l.CellXf[C[0].iStyleRef])&&n_(p,m.numFmtId,null,o,s,l),x=C[0].c==-1?x+1:C[0].c,o.dense?(a[g]||(a[g]=[]),a[g][x]=p):a[Dt(x)+_]=p,o.cellFormula){for(E=!1,S=0;S<F.length;++S){var N=F[S];u.r>=N[0].s.r&&u.r<=N[0].e.r&&x>=N[0].s.c&&x<=N[0].e.c&&(p.F=rt(N[0]),E=!0)}!E&&C.length>3&&(p.f=C[3])}if(d.s.r>u.r&&(d.s.r=u.r),d.s.c>x&&(d.s.c=x),d.e.r<u.r&&(d.e.r=u.r),d.e.c<x&&(d.e.c=x),o.cellDates&&m&&p.t=="n"&&oo(Ge[m.numFmtId])){var U=Ts(p.v);U&&(p.t="d",p.v=new Date(U.y,U.m-1,U.d,U.H,U.M,U.S,U.u))}ae&&(ae.type=="XLDAPR"&&(p.D=!0),ae=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;p={t:"z",v:void 0},x=C[0].c==-1?x+1:C[0].c,o.dense?(a[g]||(a[g]=[]),a[g][x]=p):a[Dt(x)+_]=p,d.s.r>u.r&&(d.s.r=u.r),d.s.c>x&&(d.s.c=x),d.e.r<u.r&&(d.e.r=u.r),d.e.c<x&&(d.e.c=x),ae&&(ae.type=="XLDAPR"&&(p.D=!0),ae=void 0);break;case 176:k.push(C);break;case 49:ae=((o.xlmeta||{}).Cell||[])[C-1];break;case 494:var A=n["!id"][C.relId];for(A?(C.Target=A.Target,C.loc&&(C.Target+="#"+C.loc),C.Rel=A):C.relId==""&&(C.Target="#"+C.loc),g=C.rfx.s.r;g<=C.rfx.e.r;++g)for(x=C.rfx.s.c;x<=C.rfx.e.c;++x)o.dense?(a[g]||(a[g]=[]),a[g][x]||(a[g][x]={t:"z",v:void 0}),a[g][x].l=C):(y=Je({c:x,r:g}),a[y]||(a[y]={t:"z",v:void 0}),a[y].l=C);break;case 426:if(!o.cellFormula)break;F.push(C),b=o.dense?a[g][x]:a[Dt(x)+_],b.f=Nr(C[1],d,{r:u.r,c:x},D,o),b.F=rt(C[0]);break;case 427:if(!o.cellFormula)break;P[Je(C[0].s)]=C[1],b=o.dense?a[g][x]:a[Dt(x)+_],b.f=Nr(C[1],d,{r:u.r,c:x},D,o);break;case 60:if(!o.cellStyles)break;for(;C.e>=C.s;)X[C.e--]={width:C.w/256,hidden:!!(C.flags&1),level:C.level},G||(G=!0,yp(C.w/256)),ns(X[C.e+1]);break;case 161:a["!autofilter"]={ref:rt(C)};break;case 476:a["!margins"]=C;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),C.name&&(i.Sheets[r].CodeName=C.name),(C.above||C.left)&&(a["!outline"]={above:C.above,left:C.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),C.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!L.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+B.toString(16))}}},o),delete o.supbooks,delete o["!row"],!a["!ref"]&&(d.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(a["!ref"]=rt(c||d)),o.sheetRows&&a["!ref"]){var le=ct(a["!ref"]);o.sheetRows<=+le.e.r&&(le.e.r=o.sheetRows-1,le.e.r>d.e.r&&(le.e.r=d.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>d.e.c&&(le.e.c=d.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),a["!fullref"]=a["!ref"],a["!ref"]=rt(le))}return k.length>0&&(a["!merges"]=k),X.length>0&&(a["!cols"]=X),z.length>0&&(a["!rows"]=z),a}function o5(e,t,r,n,i,s,l){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Tt(t),t.z=t.z||Ge[14],t.v=or(Ct(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var a={r,c:n};switch(a.s=fs(i.cellXfs,t,i),t.l&&s["!links"].push([Je(a),t.l]),t.c&&s["!comments"].push([Je(a),t.c]),t.t){case"s":case"str":return i.bookSST?(o=Sp(i.Strings,t.v,i.revStrings),a.t="s",a.v=o,l?Ce(e,18,TD(t,a)):Ce(e,7,SD(t,a))):(a.t="str",l?Ce(e,17,LD(t,a)):Ce(e,6,ID(t,a))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?Ce(e,13,PD(t,a)):Ce(e,2,FD(t,a)):l?Ce(e,16,AD(t,a)):Ce(e,5,ND(t,a)),!0;case"b":return a.t="b",l?Ce(e,15,vD(t,a)):Ce(e,4,mD(t,a)),!0;case"e":return a.t="e",l?Ce(e,14,bD(t,a)):Ce(e,3,wD(t,a)),!0}return l?Ce(e,12,pD(t,a)):Ce(e,1,hD(t,a)),!0}function l5(e,t,r,n){var i=ct(t["!ref"]||"A1"),s,l="",o=[];Ce(e,145);var a=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var d=i.s.r;d<=c;++d){l=Gt(d),sD(e,t,i,d);var h=!1;if(d<=i.e.r)for(var f=i.s.c;f<=i.e.c;++f){d===i.s.r&&(o[f]=Dt(f)),s=o[f]+l;var u=a?(t[d]||[])[f]:t[s];if(!u){h=!1;continue}h=o5(e,u,d,f,n,t,h)}}Ce(e,146)}function c5(e,t){!t||!t["!merges"]||(Ce(e,177,VD(t["!merges"].length)),t["!merges"].forEach(function(r){Ce(e,176,$D(r))}),Ce(e,178))}function u5(e,t){!t||!t["!cols"]||(Ce(e,390),t["!cols"].forEach(function(r,n){r&&Ce(e,60,JD(n,r))}),Ce(e,391))}function f5(e,t){!t||!t["!ref"]||(Ce(e,648),Ce(e,649,r5(ct(t["!ref"]))),Ce(e,650))}function h5(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=pt(r,-1,n[1].Target.replace(/#.*$/,""),st.HLINK);Ce(e,494,YD(n,i))}}),delete t["!links"]}function d5(e,t,r,n){if(t["!comments"].length>0){var i=pt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",st.VML);Ce(e,551,fp("rId"+i)),t["!legacy"]=i}}function p5(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:rt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=Kr(s);o.s.r==o.e.r&&(o.e.r=Kr(t["!ref"]).e.r,s=rt(o));for(var a=0;a<l.length;++a){var c=l[a];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}a==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Ce(e,161,uo(ct(s))),Ce(e,162)}}function g5(e,t,r){Ce(e,133),Ce(e,137,t5(t,r)),Ce(e,138),Ce(e,134)}function m5(e,t){t["!protect"]&&Ce(e,535,n5(t["!protect"]))}function x5(e,t,r,n){var i=qr(),s=r.SheetNames[e],l=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var a=ct(l["!ref"]||"A1");if(a.e.c>16383||a.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");a.e.c=Math.min(a.e.c,16383),a.e.r=Math.min(a.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Ce(i,129),(r.vbaraw||l["!outline"])&&Ce(i,147,uD(o,l["!outline"])),Ce(i,148,oD(a)),g5(i,l,r.Workbook),u5(i,l),l5(i,l,e,t),m5(i,l),p5(i,l,r,e),c5(i,l),h5(i,l,n),l["!margins"]&&Ce(i,476,ZD(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&f5(i,l),d5(i,l,e,n),Ce(i,130),i.end()}function v5(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var i=lt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function y5(e,t,r,n,i,s){var l=s||{"!type":"chart"};if(!e)return s;var o=0,a=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var f=v5(h);d.s.r=d.s.c=0,d.e.c=o,c=Dt(o),f[0].forEach(function(u,p){l[c+Gt(p)]={t:"n",v:u,z:f[1]},a=p}),d.e.r<a&&(d.e.r=a),++o}),o>0&&(l["!ref"]=rt(d)),l}function w5(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,o=e.match(i_);return o&&Cp(o[0],s,i,r),(l=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function _5(e,t){e.l+=10;var r=jr(e);return{name:r}}function b5(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Ei(e,function(a,c,d){switch(d){case 550:s["!rel"]=a;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),a.name&&(i.Sheets[r].CodeName=a.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var Tp=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],k5=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],S5=[],C5=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function bx(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=bt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function kx(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=bt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function l_(e){kx(e.WBProps,Tp),kx(e.CalcPr,C5),bx(e.WBView,k5),bx(e.Sheets,S5),Ha.date1904=bt(e.WBProps.date1904)}function T5(e){return!e.Workbook||!e.Workbook.WBProps?"false":bt(e.Workbook.WBProps.date1904)?"true":"false"}var E5="][*?/\\".split("");function c_(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return E5.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function N5(e,t,r){e.forEach(function(n,i){c_(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=t&&t[i]&&t[i].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function A5(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];N5(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)TP(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var O5=/<\w+:workbook/;function F5(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},l=0;if(e.replace(Rr,function(a,c){var d=Qe(a);switch(ni(d[0])){case"<?xml":break;case"<workbook":a.match(O5)&&(i="xmlns"+a.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Tp.forEach(function(h){if(d[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=bt(d[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(d[h[0]],10);break;default:r.WBProps[h[0]]=d[h[0]]}}),d.codeName&&(r.WBProps.CodeName=xt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=lt(xt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=xt(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),bt(d.hidden||"0")&&(s.Hidden=!0),l=c+a.length;break;case"</definedName>":s.Ref=lt(xt(e.slice(l,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return a}),Ks.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return l_(r),r}function u_(e){var t=[qt];t[t.length]=Re("workbook",null,{xmlns:Ks[0],"xmlns:r":sr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Tp.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Re("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var l={name:gt(e.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Re("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var a={name:o.Name};o.Comment&&(a.comment=o.Comment),o.Sheet!=null&&(a.localSheetId=""+o.Sheet),o.Hidden&&(a.hidden="1"),o.Ref&&(t[t.length]=Re("definedName",gt(o.Ref),a))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function j5(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Pd(e),r.name=jr(e),r}function P5(e,t){return t||(t=be(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),fp(e.strRelID,t),hr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function D5(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?jr(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function R5(e,t){t||(t=be(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),tw(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function I5(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function M5(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=dN(e),l=wP(e,0,r),o=up(e);e.l=n;var a={Name:s,Ptg:l};return i<268435455&&(a.Sheet=i),o&&(a.Comment=o),a}function L5(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],Bl[16]={n:"BrtFRTArchID$",f:I5},Ei(e,function(a,c,d){switch(d){case 156:l.SheetNames.push(a.name),r.Sheets.push(a);break;case 153:r.WBProps=a;break;case 39:a.Sheet!=null&&(t.SID=a.Sheet),a.Ref=Nr(a.Ptg,null,null,l,t),delete t.SID,delete a.Ptg,s.push(a);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([d,a]):l[0]=[d,a],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(a),l.XTI=l.XTI.concat(a);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),l_(r),r.Names=s,r.supbooks=l,r}function B5(e,t){Ce(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Ce(e,156,P5(i))}Ce(e,144)}function U5(e,t){t||(t=be(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return hr("SheetJS",t),hr(ju.version,t),hr(ju.version,t),hr("7262",t),t.length>t.l?t.slice(0,t.l):t}function W5(e,t){t||(t=be(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function z5(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(Ce(e,135),Ce(e,158,W5(i)),Ce(e,136))}}function H5(e,t){var r=qr();return Ce(r,131),Ce(r,128,U5()),Ce(r,153,R5(e.Workbook&&e.Workbook.WBProps||null)),z5(r,e),B5(r,e),Ce(r,132),r.end()}function $5(e,t,r){return t.slice(-4)===".bin"?L5(e,r):F5(e,r)}function V5(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?a5(e,n,r,i,s,l,o):MP(e,n,r,i,s,l,o)}function X5(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?b5(e,n,r,i,s):w5(e,n,r,i,s)}function Y5(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?qF():KF()}function G5(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?YF():GF()}function q5(e,t,r,n){return t.slice(-4)===".bin"?$3(e,r,n):j3(e,r,n)}function K5(e,t,r){return $w(e,r)}function J5(e,t,r){return t.slice(-4)===".bin"?JO(e,r):GO(e,r)}function Q5(e,t,r){return t.slice(-4)===".bin"?zF(e,r):PF(e,r)}function Z5(e,t,r){return t.slice(-4)===".bin"?OF(e):NF(e)}function eR(e,t,r,n){return r.slice(-4)===".bin"?FF(e,t,r,n):void 0}function tR(e,t,r){return t.slice(-4)===".bin"?CF(e,t,r):EF(e,t,r)}function rR(e,t,r){return(t.slice(-4)===".bin"?H5:u_)(e)}function nR(e,t,r,n,i){return(t.slice(-4)===".bin"?x5:s_)(e,r,n,i)}function iR(e,t,r){return(t.slice(-4)===".bin"?eF:zw)(e,r)}function sR(e,t,r){return(t.slice(-4)===".bin"?e3:Dw)(e,r)}function aR(e,t,r){return(t.slice(-4)===".bin"?HF:Yw)(e)}function oR(e){return(e.slice(-4)===".bin"?TF:Vw)()}var f_=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,h_=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function An(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(f_),s,l,o,a;if(i)for(a=0;a!=i.length;++a)s=i[a].match(h_),(l=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(l+1),n[o]=s[2].slice(1,s[2].length-1));return n}function lR(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(f_),i,s,l,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(h_),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(s+1),r[l]=i[2].slice(1,i[2].length-1));return r}var Zo;function cR(e,t){var r=Zo[e]||lt(e);return r==="General"?Ws(t):Tn(r,t)}function uR(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=bt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Ct(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[lt(t)]=i}function fR(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ni[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ol(e.v):e.w=Ws(e.v):e.w=cR(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Zo[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&oo(n)){var i=Ts(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function hR(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=S3[n.Pattern]||n.Pattern)}e[t.ID]=t}function dR(e,t,r,n,i,s,l,o,a,c){var d="General",h=n.StyleID,f={};c=c||{};var u=[],p=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&l&&(h=l.StyleID);s[h]!==void 0&&(s[h].nf&&(d=s[h].nf),s[h].Interior&&u.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=bt(e);break;case"String":n.t="s",n.r=Um(lt(e)),n.v=e.indexOf("<")>-1?lt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Ct(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=lt(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=aw[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Um(t||e));break}if(fR(n,d,c),c.cellFormula!==!1)if(n.Formula){var m=lt(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=za(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=za("RC:RC",i):n.ArrayRange&&(n.F=za(n.ArrayRange,i),a.push([ct(n.F),n.F]))}else for(p=0;p<a.length;++p)i.r>=a[p][0].s.r&&i.r<=a[p][0].e.r&&i.c>=a[p][0].s.c&&i.c<=a[p][0].e.c&&(n.F=a[p][1]);c.cellStyles&&(u.forEach(function(g){!f.patternType&&g.patternType&&(f.patternType=g.patternType)}),n.s=f),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function pR(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function wh(e,t){var r=t||{};lo();var n=jo(ip(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=xt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var l=Tt(r);return l.type="string",Za.to_workbook(n,l)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ue){i.indexOf("<"+ue)>=0&&(s=!0)}),s)return ZR(n,r);Zo={"General Number":"General","General Date":Ge[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ge[15],"Short Date":Ge[14],"Long Time":Ge[19],"Medium Time":Ge[18],"Short Time":Ge[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ge[2],Standard:Ge[4],Percent:Ge[10],Scientific:Ge[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,a=[],c,d={},h=[],f=r.dense?[]:{},u="",p={},m={},g=An('<Data ss:Type="String">'),x=0,y=0,w=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}},b={},k={},S="",E=0,F=[],P={},D={},I=0,X=[],z=[],G={},ae=[],le,Z=!1,C=[],L=[],B={},N=0,U=0,A={Sheets:[],WBProps:{date1904:!1}},T={};Pl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var j="";o=Pl.exec(n);)switch(o[3]=(j=o[3]).toLowerCase()){case"data":if(j=="data"){if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&a.push([o[3],!0]);break}if(a[a.length-1][1])break;o[1]==="/"?dR(n.slice(x,o.index),S,g,a[a.length-1][0]=="comment"?G:p,{c:y,r:w},b,ae[y],m,C,r):(S="",g=An(o[0]),x=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(z.length>0&&(p.c=z),(!r.sheetRows||r.sheetRows>w)&&p.v!==void 0&&(r.dense?(f[w]||(f[w]=[]),f[w][y]=p):f[Dt(y)+Gt(w)]=p),p.HRef&&(p.l={Target:lt(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(N=y+(parseInt(p.MergeAcross,10)|0),U=w+(parseInt(p.MergeDown,10)|0),F.push({s:{c:y,r:w},e:{c:N,r:U}})),!r.sheetStubs)p.MergeAcross?y=N+1:++y;else if(p.MergeAcross||p.MergeDown){for(var M=y;M<=N;++M)for(var Y=w;Y<=U;++Y)(M>y||Y>w)&&(r.dense?(f[Y]||(f[Y]=[]),f[Y][M]={t:"z"}):f[Dt(M)+Gt(Y)]={t:"z"});y=N+1}else++y;else p=lR(o[0]),p.Index&&(y=+p.Index-1),y<_.s.c&&(_.s.c=y),y>_.e.c&&(_.e.c=y),o[0].slice(-2)==="/>"&&++y,z=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<_.s.r&&(_.s.r=w),w>_.e.r&&(_.e.r=w),o[0].slice(-2)==="/>"&&(m=An(o[0]),m.Index&&(w=+m.Index-1)),y=0,++w):(m=An(o[0]),m.Index&&(w=+m.Index-1),B={},(m.AutoFitHeight=="0"||m.Height)&&(B.hpx=parseInt(m.Height,10),B.hpt=Ll(B.hpx),L[w]=B),m.Hidden=="1"&&(B.hidden=!0,L[w]=B));break;case"worksheet":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(u),_.s.r<=_.e.r&&_.s.c<=_.e.c&&(f["!ref"]=rt(_),r.sheetRows&&r.sheetRows<=_.e.r&&(f["!fullref"]=f["!ref"],_.e.r=r.sheetRows-1,f["!ref"]=rt(_))),F.length&&(f["!merges"]=F),ae.length>0&&(f["!cols"]=ae),L.length>0&&(f["!rows"]=L),d[u]=f}else _={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=y=0,a.push([o[3],!1]),c=An(o[0]),u=lt(c.Name),f=r.dense?[]:{},F=[],C=[],L=[],T={name:u,Hidden:0},A.Sheets.push(T);break;case"table":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;a.push([o[3],!1]),ae=[],Z=!1}break;case"style":o[1]==="/"?hR(b,k,r):k=An(o[0]);break;case"numberformat":k.nf=lt(An(o[0]).Format||"General"),Zo[k.nf]&&(k.nf=Zo[k.nf]);for(var H=0;H!=392&&Ge[H]!=k.nf;++H);if(H==392){for(H=57;H!=392;++H)if(Ge[H]==null){gi(k.nf,H);break}}break;case"column":if(a[a.length-1][0]!=="table")break;if(le=An(o[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!Z&&le.wpx>10){Z=!0,Or=Uw;for(var V=0;V<ae.length;++V)ae[V]&&ns(ae[V])}Z&&ns(le),ae[le.Index-1||ae.length]=le;for(var fe=0;fe<+le.Span;++fe)ae[ae.length]=Tt(le);break;case"namedrange":if(o[1]==="/")break;A.Names||(A.Names=[]);var O=Qe(o[0]),Q={Name:O.Name,Ref:za(O.RefersTo.slice(1),{r:0,c:0})};A.Sheets.length>0&&(Q.Sheet=A.Sheets.length-1),A.Names.push(Q);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?S+=n.slice(E,o.index):E=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=An(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?LN(P,j,n.slice(I,o.index)):I=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else a.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));pR(G),z.push(G)}else a.push([o[3],!1]),c=An(o[0]),G={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var K=An(o[0]);f["!autofilter"]={ref:za(K.Range).replace(/\$/g,"")},a.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&a.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&a.push([o[3],!0]);break;case"null":break;default:if(a.length==0&&o[3]=="document"||a.length==0&&o[3]=="uof")return Nx(n,r);var ce=!0;switch(a[a.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ce=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ce=!1}break;case"excelworkbook":switch(o[3]){case"date1904":A.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ce=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:ce=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(I,o.index)){case"SheetHidden":T.Hidden=1;break;case"SheetVeryHidden":T.Hidden=2;break}else I=o.index+o[0].length;break;case"header":f["!margins"]||Ds(f["!margins"]={},"xlml"),isNaN(+Qe(o[0]).Margin)||(f["!margins"].header=+Qe(o[0]).Margin);break;case"footer":f["!margins"]||Ds(f["!margins"]={},"xlml"),isNaN(+Qe(o[0]).Margin)||(f["!margins"].footer=+Qe(o[0]).Margin);break;case"pagemargins":var te=Qe(o[0]);f["!margins"]||Ds(f["!margins"]={},"xlml"),isNaN(+te.Top)||(f["!margins"].top=+te.Top),isNaN(+te.Left)||(f["!margins"].left=+te.Left),isNaN(+te.Right)||(f["!margins"].right=+te.Right),isNaN(+te.Bottom)||(f["!margins"].bottom=+te.Bottom);break;case"displayrighttoleft":A.Views||(A.Views=[]),A.Views[0]||(A.Views[0]={}),A.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ce=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ce=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ce=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ce=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ce=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ce=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ce=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ce=!1}break;case"smarttags":break;default:ce=!1;break}if(ce||o[3].match(/!\[CDATA/))break;if(!a[a.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+a.join("|");if(a[a.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?uR(D,j,X,n.slice(I,o.index)):(X=o,I=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+a.join("|")}var R={};return!r.bookSheets&&!r.bookProps&&(R.Sheets=d),R.SheetNames=h,R.Workbook=A,R.SSF=Tt(Ge),R.Props=P,R.Custprops=D,R}function Ud(e,t){switch(Np(t=t||{}),t.type||"base64"){case"base64":return wh(ln(e),t);case"binary":case"buffer":case"file":return wh(e,t);case"array":return wh(cs(e),t)}}function gR(e,t){var r=[];return e.Props&&r.push(BN(e.Props,t)),e.Custprops&&r.push(UN(e.Props,e.Custprops)),r.join("")}function mR(){return""}function xR(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(Re("NumberFormat",null,{"ss:Format":gt(Ge[n.numFmtId])}));var l={"ss:ID":"s"+(21+i)};r.push(Re("Style",s.join(""),l))}),Re("Styles",r.join(""))}function d_(e){return Re("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+bp(e.Ref,{r:0,c:0})})}function vR(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(d_(i)))}return Re("Names",r.join(""))}function yR(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],l=0;l<i.length;++l){var o=i[l];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(d_(o)))}return s.join("")}function wR(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Re("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Re("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Re("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Re("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(wr("ProtectContents","True")),e["!protect"].objects&&i.push(wr("ProtectObjects","True")),e["!protect"].scenarios&&i.push(wr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(wr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(wr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&i.push("<"+l[1]+"/>")})),i.length==0?"":Re("WorksheetOptions",i.join(""),{xmlns:Zr.x})}function _R(e){return e.map(function(t){var r=z4(t.t||""),n=Re("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Re("Comment",n,{"ss:Author":t.a})}).join("")}function bR(e,t,r,n,i,s,l){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+gt(bp(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var a=Rt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(a.r==l.r?"":"["+(a.r-l.r)+"]")+"C"+(a.c==l.c?"":"["+(a.c-l.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=gt(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=gt(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],d=0;d!=c.length;++d)c[d].s.c!=l.c||c[d].s.r!=l.r||(c[d].e.c>c[d].s.c&&(o["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(o["ss:MergeDown"]=c[d].e.r-c[d].s.r));var h="",f="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",f=String(e.v);break;case"b":h="Boolean",f=e.v?"1":"0";break;case"e":h="Error",f=Ni[e.v];break;case"d":h="DateTime",f=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ge[14]);break;case"s":h="String",f=W4(e.v||"");break}var u=fs(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+u),o["ss:Index"]=l.c+1;var p=e.v!=null?f:"",m=e.t=="z"?"":'<Data ss:Type="'+h+'">'+p+"</Data>";return(e.c||[]).length>0&&(m+=_R(e.c)),Re("Cell",m,o)}function kR(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=eo(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function SR(e,t,r,n){if(!e["!ref"])return"";var i=ct(e["!ref"]),s=e["!merges"]||[],l=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,x){ns(g);var y=!!g.width,w=kf(x,g),_={"ss:Index":x+1};y&&(_["ss:Width"]=Il(w.width)),g.hidden&&(_["ss:Hidden"]="1"),o.push(Re("Column",null,_))});for(var a=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var d=[kR(c,(e["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var f=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>h)&&!(s[l].s.r>c)&&!(s[l].e.c<h)&&!(s[l].e.r<c)){(s[l].s.c!=h||s[l].s.r!=c)&&(f=!0);break}if(!f){var u={r:c,c:h},p=Je(u),m=a?(e[c]||[])[h]:e[p];d.push(bR(m,p,e,t,r,n,u))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function CR(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],l=s?yR(s,t,e,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=s?SR(s,t,e,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(wR(s,t,e,r)),n.join("")}function TR(e,t){t||(t={}),e.SSF||(e.SSF=Tt(Ge)),e.SSF&&(lo(),mf(e.SSF),t.revssf=vf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],fs(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(gR(e,t)),r.push(mR()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Re("Worksheet",CR(n,t,e),{"ss:Name":gt(e.SheetNames[n])}));return r[2]=xR(e,t),r[3]=vR(e),qt+Re("Workbook",r.join(""),{xmlns:Zr.ss,"xmlns:o":Zr.o,"xmlns:x":Zr.x,"xmlns:ss":Zr.ss,"xmlns:dt":Zr.dt,"xmlns:html":Zr.html})}function ER(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=vN(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=yN(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var NR=[60,1084,2066,2165,2175];function AR(e,t,r,n,i){var s=n,l=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}l.push(o),r.l+=s;for(var a=fi(r,r.l),c=Wd[a],d=0;c!=null&&NR.indexOf(a)>-1;)s=fi(r,r.l+2),d=r.l+4,a==2066?d+=4:(a==2165||a==2175)&&(d+=12),o=r.slice(d,r.l+4+s),l.push(o),r.l+=4+s,c=Wd[a=fi(r,r.l)];var h=fr(l);yr(h,0);var f=0;h.lens=[];for(var u=0;u<l.length;++u)h.lens.push(f),f+=l[u].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,i)}function Hn(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ge[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ni[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ol(e.v):e.w=Ws(e.v):e.w=Tn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&oo(Ge[n]||String(n))){var i=Ts(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Bc(e,t,r){return{v:e,ixfe:t,t:r}}function OR(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},l={},o=null,a=[],c="",d={},h,f="",u,p,m,g,x={},y=[],w,_,b=[],k=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},F=function(Ne){return Ne<8?Fs[Ne]:Ne<64&&k[Ne-8]||Fs[Ne]},P=function(Ne,Ie,We){var Te=Ie.XF.data;if(!(!Te||!Te.patternType||!We||!We.cellStyles)){Ie.s={},Ie.s.patternType=Te.patternType;var et;(et=Rl(F(Te.icvFore)))&&(Ie.s.fgColor={rgb:et}),(et=Rl(F(Te.icvBack)))&&(Ie.s.bgColor={rgb:et})}},D=function(Ne,Ie,We){if(!(B>1)&&!(We.sheetRows&&Ne.r>=We.sheetRows)){if(We.cellStyles&&Ie.XF&&Ie.XF.data&&P(Ne,Ie,We),delete Ie.ixfe,delete Ie.XF,h=Ne,f=Je(Ne),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Ne.r<l.s.r&&(l.s.r=Ne.r),Ne.c<l.s.c&&(l.s.c=Ne.c),Ne.r+1>l.e.r&&(l.e.r=Ne.r+1),Ne.c+1>l.e.c&&(l.e.c=Ne.c+1),We.cellFormula&&Ie.f){for(var Te=0;Te<y.length;++Te)if(!(y[Te][0].s.c>Ne.c||y[Te][0].s.r>Ne.r)&&!(y[Te][0].e.c<Ne.c||y[Te][0].e.r<Ne.r)){Ie.F=rt(y[Te][0]),(y[Te][0].s.c!=Ne.c||y[Te][0].s.r!=Ne.r)&&delete Ie.f,Ie.f&&(Ie.f=""+Nr(y[Te][1],l,Ne,C,I));break}}We.dense?(i[Ne.r]||(i[Ne.r]=[]),i[Ne.r][Ne.c]=Ie):i[f]=Ie}},I={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(I.password=t.password);var X,z=[],G=[],ae=[],le=[],Z=!1,C=[];C.SheetNames=I.snames,C.sharedf=I.sharedf,C.arrayf=I.arrayf,C.names=[],C.XTI=[];var L=0,B=0,N=0,U=[],A=[],T;I.codepage=1200,Rn(1200);for(var j=!1;e.l<e.length-1;){var M=e.l,Y=e.read_shift(2);if(Y===0&&L===10)break;var H=e.l===e.length?0:e.read_shift(2),V=Wd[Y];if(V&&V.f){if(t.bookSheets&&L===133&&Y!==133)break;if(L=Y,V.r===2||V.r==12){var fe=e.read_shift(2);if(H-=2,!I.enc&&fe!==Y&&((fe&255)<<8|fe>>8)!==Y)throw new Error("rt mismatch: "+fe+"!="+Y);V.r==12&&(e.l+=10,H-=10)}var O={};if(Y===10?O=V.f(e,H,I):O=AR(Y,V,e,H,I),B==0&&[9,521,1033,2057].indexOf(L)===-1)continue;switch(Y){case 34:r.opts.Date1904=S.WBProps.date1904=O;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(I.enc||(e.l=0),I.enc=O,!t.password)throw new Error("File is password-protected");if(O.valid==null)throw new Error("Encryption scheme unsupported");if(!O.valid)throw new Error("Password is incorrect");break;case 92:I.lastuser=O;break;case 66:var Q=Number(O);switch(Q){case 21010:Q=1200;break;case 32768:Q=1e4;break;case 32769:Q=1252;break}Rn(I.codepage=Q),j=!0;break;case 317:I.rrtabid=O;break;case 25:I.winlocked=O;break;case 439:r.opts.RefreshAll=O;break;case 12:r.opts.CalcCount=O;break;case 16:r.opts.CalcDelta=O;break;case 17:r.opts.CalcIter=O;break;case 13:r.opts.CalcMode=O;break;case 14:r.opts.CalcPrecision=O;break;case 95:r.opts.CalcSaveRecalc=O;break;case 15:I.CalcRefMode=O;break;case 2211:r.opts.FullCalc=O;break;case 129:O.fDialog&&(i["!type"]="dialog"),O.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),O.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:b.push(O);break;case 430:C.push([O]),C[C.length-1].XTI=[];break;case 35:case 547:C[C.length-1].push(O);break;case 24:case 536:T={Name:O.Name,Ref:Nr(O.rgce,l,null,C,I)},O.itab>0&&(T.Sheet=O.itab-1),C.names.push(T),C[0]||(C[0]=[],C[0].XTI=[]),C[C.length-1].push(O),O.Name=="_xlnm._FilterDatabase"&&O.itab>0&&O.rgce&&O.rgce[0]&&O.rgce[0][0]&&O.rgce[0][0][0]=="PtgArea3d"&&(A[O.itab-1]={ref:rt(O.rgce[0][0][1][2])});break;case 22:I.ExternCount=O;break;case 23:C.length==0&&(C[0]=[],C[0].XTI=[]),C[C.length-1].XTI=C[C.length-1].XTI.concat(O),C.XTI=C.XTI.concat(O);break;case 2196:if(I.biff<8)break;T!=null&&(T.Comment=O[1]);break;case 18:i["!protect"]=O;break;case 19:O!==0&&I.WTF&&console.error("Password verifier: "+O);break;case 133:s[O.pos]=O,I.snames.push(O.name);break;case 10:{if(--B)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,i["!ref"]=rt(l),t.sheetRows&&t.sheetRows<=l.e.r){var K=l.e.r;l.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=rt(l),l.e.r=K}l.e.r++,l.e.c++}z.length>0&&(i["!merges"]=z),G.length>0&&(i["!objects"]=G),ae.length>0&&(i["!cols"]=ae),le.length>0&&(i["!rows"]=le),S.Sheets.push(E)}c===""?d=i:n[c]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(I.biff===8&&(I.biff={9:2,521:3,1033:4}[Y]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[O.BIFFVer]||8),I.biffguess=O.BIFFVer==0,O.BIFFVer==0&&O.dt==4096&&(I.biff=5,j=!0,Rn(I.codepage=28591)),I.biff==8&&O.BIFFVer==0&&O.dt==16&&(I.biff=2),B++)break;if(i=t.dense?[]:{},I.biff<8&&!j&&(j=!0,Rn(I.codepage=t.codepage||1252)),I.biff<5||O.BIFFVer==0&&O.dt==4096){c===""&&(c="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var ce={pos:e.l-H,name:c};s[ce.pos]=ce,I.snames.push(c)}else c=(s[M]||{name:""}).name;O.dt==32&&(i["!type"]="chart"),O.dt==64&&(i["!type"]="macro"),z=[],G=[],I.arrayf=y=[],ae=[],le=[],Z=!1,E={Hidden:(s[M]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[O.r]||[])[O.c]:i[Je({c:O.c,r:O.r})])&&++O.c,w={ixfe:O.ixfe,XF:b[O.ixfe]||{},v:O.val,t:"n"},N>0&&(w.z=U[w.ixfe>>8&63]),Hn(w,t,r.opts.Date1904),D({c:O.c,r:O.r},w,t);break;case 5:case 517:w={ixfe:O.ixfe,XF:b[O.ixfe],v:O.val,t:O.t},N>0&&(w.z=U[w.ixfe>>8&63]),Hn(w,t,r.opts.Date1904),D({c:O.c,r:O.r},w,t);break;case 638:w={ixfe:O.ixfe,XF:b[O.ixfe],v:O.rknum,t:"n"},N>0&&(w.z=U[w.ixfe>>8&63]),Hn(w,t,r.opts.Date1904),D({c:O.c,r:O.r},w,t);break;case 189:for(var te=O.c;te<=O.C;++te){var R=O.rkrec[te-O.c][0];w={ixfe:R,XF:b[R],v:O.rkrec[te-O.c][1],t:"n"},N>0&&(w.z=U[w.ixfe>>8&63]),Hn(w,t,r.opts.Date1904),D({c:te,r:O.r},w,t)}break;case 6:case 518:case 1030:{if(O.val=="String"){o=O;break}if(w=Bc(O.val,O.cell.ixfe,O.tt),w.XF=b[w.ixfe],t.cellFormula){var ue=O.formula;if(ue&&ue[0]&&ue[0][0]&&ue[0][0][0]=="PtgExp"){var oe=ue[0][0][1][0],he=ue[0][0][1][1],de=Je({r:oe,c:he});x[de]?w.f=""+Nr(O.formula,l,O.cell,C,I):w.F=((t.dense?(i[oe]||[])[he]:i[de])||{}).F}else w.f=""+Nr(O.formula,l,O.cell,C,I)}N>0&&(w.z=U[w.ixfe>>8&63]),Hn(w,t,r.opts.Date1904),D(O.cell,w,t),o=O}break;case 7:case 519:if(o)o.val=O,w=Bc(O,o.cell.ixfe,"s"),w.XF=b[w.ixfe],t.cellFormula&&(w.f=""+Nr(o.formula,l,o.cell,C,I)),N>0&&(w.z=U[w.ixfe>>8&63]),Hn(w,t,r.opts.Date1904),D(o.cell,w,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(O);var ie=Je(O[0].s);if(u=t.dense?(i[O[0].s.r]||[])[O[0].s.c]:i[ie],t.cellFormula&&u){if(!o||!ie||!u)break;u.f=""+Nr(O[1],l,O[0],C,I),u.F=rt(O[0])}}break;case 1212:{if(!t.cellFormula)break;if(f){if(!o)break;x[Je(o.cell)]=O[0],u=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[Je(o.cell)],(u||{}).f=""+Nr(O[0],l,h,C,I)}}break;case 253:w=Bc(a[O.isst].t,O.ixfe,"s"),a[O.isst].h&&(w.h=a[O.isst].h),w.XF=b[w.ixfe],N>0&&(w.z=U[w.ixfe>>8&63]),Hn(w,t,r.opts.Date1904),D({c:O.c,r:O.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:O.ixfe,XF:b[O.ixfe],t:"z"},N>0&&(w.z=U[w.ixfe>>8&63]),Hn(w,t,r.opts.Date1904),D({c:O.c,r:O.r},w,t));break;case 190:if(t.sheetStubs)for(var pe=O.c;pe<=O.C;++pe){var Se=O.ixfe[pe-O.c];w={ixfe:Se,XF:b[Se],t:"z"},N>0&&(w.z=U[w.ixfe>>8&63]),Hn(w,t,r.opts.Date1904),D({c:pe,r:O.r},w,t)}break;case 214:case 516:case 4:w=Bc(O.val,O.ixfe,"s"),w.XF=b[w.ixfe],N>0&&(w.z=U[w.ixfe>>8&63]),Hn(w,t,r.opts.Date1904),D({c:O.c,r:O.r},w,t);break;case 0:case 512:B===1&&(l=O);break;case 252:a=O;break;case 1054:if(I.biff==4){U[N++]=O[1];for(var De=0;De<N+163&&Ge[De]!=O[1];++De);De>=163&&gi(O[1],N+163)}else gi(O[1],O[0]);break;case 30:{U[N++]=O;for(var we=0;we<N+163&&Ge[we]!=O;++we);we>=163&&gi(O,N+163)}break;case 229:z=z.concat(O);break;case 93:G[O.cmo[0]]=I.lastobj=O;break;case 438:I.lastobj.TxO=O;break;case 127:I.lastobj.ImData=O;break;case 440:for(g=O[0].s.r;g<=O[0].e.r;++g)for(m=O[0].s.c;m<=O[0].e.c;++m)u=t.dense?(i[g]||[])[m]:i[Je({c:m,r:g})],u&&(u.l=O[1]);break;case 2048:for(g=O[0].s.r;g<=O[0].e.r;++g)for(m=O[0].s.c;m<=O[0].e.c;++m)u=t.dense?(i[g]||[])[m]:i[Je({c:m,r:g})],u&&u.l&&(u.l.Tooltip=O[1]);break;case 28:{if(I.biff<=5&&I.biff>=2)break;u=t.dense?(i[O[0].r]||[])[O[0].c]:i[Je(O[0])];var ve=G[O[2]];u||(t.dense?(i[O[0].r]||(i[O[0].r]=[]),u=i[O[0].r][O[0].c]={t:"z"}):u=i[Je(O[0])]={t:"z"},l.e.r=Math.max(l.e.r,O[0].r),l.s.r=Math.min(l.s.r,O[0].r),l.e.c=Math.max(l.e.c,O[0].c),l.s.c=Math.min(l.s.c,O[0].c)),u.c||(u.c=[]),p={a:O[1],t:ve.TxO.t},u.c.push(p)}break;case 2173:xF(b[O.ixfe],O.ext);break;case 125:{if(!I.cellStyles)break;for(;O.e>=O.s;)ae[O.e--]={width:O.w/256,level:O.level||0,hidden:!!(O.flags&1)},Z||(Z=!0,yp(O.w/256)),ns(ae[O.e+1])}break;case 520:{var Ae={};O.level!=null&&(le[O.r]=Ae,Ae.level=O.level),O.hidden&&(le[O.r]=Ae,Ae.hidden=!0),O.hpt&&(le[O.r]=Ae,Ae.hpt=O.hpt,Ae.hpx=eo(O.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Ds(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Y]]=O;break;case 161:i["!margins"]||Ds(i["!margins"]={}),i["!margins"].header=O.header,i["!margins"].footer=O.footer;break;case 574:O.RTL&&(S.Views[0].RTL=!0);break;case 146:k=O;break;case 2198:X=O;break;case 140:_=O;break;case 442:c?E.CodeName=O||E.name:S.WBProps.CodeName=O||"ThisWorkbook";break}}else V||console.error("Missing Info for XLS Record 0x"+Y.toString(16)),e.l+=H}return r.SheetNames=zt(s).sort(function(Ee,Ne){return Number(Ee)-Number(Ne)}).map(function(Ee){return s[Ee].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&A.forEach(function(Ee,Ne){r.Sheets[r.SheetNames[Ne]]["!autofilter"]=Ee}),r.Strings=a,r.SSF=Tt(Ge),I.enc&&(r.Encryption=I.enc),X&&(r.Themes=X),r.Metadata={},_!==void 0&&(r.Metadata.Country=_),C.names.length>0&&(S.Names=C.names),r.Workbook=S,r}var el={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function FR(e,t,r){var n=Xe.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=ix(n,Dd,el.DSI);for(var s in i)t[s]=i[s]}catch(c){if(r.WTF)throw c}var l=Xe.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var o=ix(l,Rd,el.SI);for(var a in o)t[a]==null&&(t[a]=o[a])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(hw(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function jR(e,t){var r=[],n=[],i=[],s=0,l,o=Dm(Dd,"n"),a=Dm(Rd,"n");if(e.Props)for(l=zt(e.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(o,l[s])?r:Object.prototype.hasOwnProperty.call(a,l[s])?n:i).push([l[s],e.Props[l[s]]]);if(e.Custprops)for(l=zt(e.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(o,l[s])?r:Object.prototype.hasOwnProperty.call(a,l[s])?n:i).push([l[s],e.Custprops[l[s]]]);var c=[];for(s=0;s<i.length;++s)yw.indexOf(i[s][0])>-1||fw.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&Xe.utils.cfb_add(t,"/SummaryInformation",sx(n,el.SI,a,Rd)),(r.length||c.length)&&Xe.utils.cfb_add(t,"/DocumentSummaryInformation",sx(r,el.DSI,o,Dd,c.length?c:null,el.UDI))}function p_(e,t){t||(t={}),Np(t),q0(),t.codepage&&G0(t.codepage);var r,n;if(e.FullPaths){if(Xe.find(e,"/encryption"))throw new Error("File is password-protected");r=Xe.find(e,"!CompObj"),n=Xe.find(e,"/Workbook")||Xe.find(e,"/Book")}else{switch(t.type){case"base64":e=tn(ln(e));break;case"binary":e=tn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}yr(e,0),n={content:e}}var i,s;if(r&&ER(r),t.bookProps&&!t.bookSheets)i={};else{var l=it?"buffer":"array";if(n&&n.content)i=OR(n.content,t);else if((s=Xe.find(e,"PerfectOffice_MAIN"))&&s.content)i=Ps.to_workbook(s.content,(t.type=l,t));else if((s=Xe.find(e,"NativeContent_MAIN"))&&s.content)i=Ps.to_workbook(s.content,(t.type=l,t));else throw(s=Xe.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Xe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=VF(e))}var o={};return e.FullPaths&&FR(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}function PR(e,t){var r=t||{},n=Xe.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Xe.utils.cfb_add(n,i,g_(e,r)),r.biff==8&&(e.Props||e.Custprops)&&jR(e,n),r.biff==8&&e.vbaraw&&XF(n,Xe.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Bl={0:{f:nD},1:{f:fD},2:{f:OD},3:{f:yD},4:{f:gD},5:{f:ED},6:{f:RD},7:{f:kD},8:{f:zD},9:{f:WD},10:{f:BD},11:{f:UD},12:{f:dD},13:{f:jD},14:{f:_D},15:{f:xD},16:{f:a_},17:{f:MD},18:{f:CD},19:{f:cp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:M5},40:{},42:{},43:{f:R3},44:{f:P3},45:{f:L3},46:{f:U3},47:{f:B3},48:{},49:{f:aN},50:{},51:{f:wF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Ow},62:{f:DD},63:{f:AF},64:{f:i5},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Dr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:e5},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:cD},148:{f:aD,p:16},151:{f:GD},152:{},153:{f:D5},154:{},155:{},156:{f:j5},157:{},158:{},159:{T:1,f:KO},160:{T:-1},161:{T:1,f:ea},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:HD},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:vF},336:{T:-1},337:{f:kF,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Pd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Aw},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:qD},427:{f:KD},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:QD},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:lD},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:XD},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Pd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:UF},633:{T:1},634:{T:-1},635:{T:1,f:LF},636:{T:-1},637:{f:uN},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:_5},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:s5},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Wd={6:{f:vh},10:{f:Oi},12:{f:Zt},13:{f:Zt},14:{f:$t},15:{f:$t},16:{f:Fr},17:{f:$t},18:{f:$t},19:{f:Zt},20:{f:fx},21:{f:fx},23:{f:Aw},24:{f:dx},25:{f:$t},26:{},27:{},28:{f:sO},29:{},34:{f:$t},35:{f:hx},38:{f:Fr},39:{f:Fr},40:{f:Fr},41:{f:Fr},42:{f:$t},43:{f:$t},47:{f:x3},49:{f:jA},51:{f:Zt},60:{},61:{f:EA},64:{f:$t},65:{f:FA},66:{f:Zt},77:{},80:{},81:{},82:{},85:{f:Zt},89:{},90:{},91:{},92:{f:mA},93:{f:lO},94:{},95:{f:$t},96:{},97:{},99:{f:$t},125:{f:Ow},128:{f:YA},129:{f:vA},130:{f:Zt},131:{f:$t},132:{f:$t},133:{f:yA},134:{},140:{f:mO},141:{f:Zt},144:{},146:{f:yO},151:{},152:{},153:{},154:{},155:{},156:{f:Zt},157:{},158:{},160:{f:TO},161:{f:bO},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:HA},190:{f:$A},193:{f:Oi},197:{},198:{},199:{},200:{},201:{},202:{f:$t},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Zt},220:{},221:{f:$t},222:{},224:{f:XA},225:{f:gA},226:{f:Oi},227:{},229:{f:aO},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:_A},253:{f:DA},255:{f:kA},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:ww},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:$t},353:{f:Oi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:QA},431:{f:$t},432:{},433:{},434:{},437:{},438:{f:fO},439:{f:$t},440:{f:hO},441:{},442:{f:ec},443:{},444:{f:Zt},445:{},446:{},448:{f:Oi},449:{f:TA,r:2},450:{f:Oi},512:{f:lx},513:{f:CO},515:{f:KA},516:{f:IA},517:{f:ux},519:{f:EO},520:{f:SA},523:{},545:{f:px},549:{f:ox},566:{},574:{f:AA},638:{f:zA},659:{},1048:{},1054:{f:LA},1084:{},1212:{f:rO},2048:{f:pO},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ic},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Oi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:wO,r:12},2173:{f:mF,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:$t,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:tO,r:12},2197:{},2198:{f:uF,r:12},2199:{},2200:{},2201:{},2202:{f:nO,r:12},2203:{f:Oi},2204:{},2205:{},2206:{},2207:{},2211:{f:CA},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Zt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:kO},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:vO},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:lx},1:{},2:{f:jO},3:{f:OO},4:{f:AO},5:{f:ux},7:{f:DO},8:{},9:{f:Ic},11:{},22:{f:Zt},30:{f:UA},31:{},32:{},33:{f:px},36:{},37:{f:ox},50:{f:RO},62:{},52:{},67:{},68:{f:Zt},69:{},86:{},126:{},127:{f:NO},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:IO},223:{},234:{},354:{},421:{},518:{f:vh},521:{f:Ic},536:{f:dx},547:{f:hx},561:{},579:{},1030:{f:vh},1033:{f:Ic},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Me(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,l=e.next(4);l.write_shift(2,i),l.write_shift(2,s),s>0&&ap(r)&&e.push(r)}}function DR(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return Me(e,t,r,i);var s=t;if(!isNaN(s)){for(var l=r.parts||[],o=0,a=0,c=0;c+(l[o]||8224)<=8224;)c+=l[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,c),e.push(r.slice(a,a+c)),a+=c;a<i;){for(d=e.next(4),d.write_shift(2,60),c=0;c+(l[o]||8224)<=8224;)c+=l[o]||8224,o++;d.write_shift(2,c),e.push(r.slice(a,a+c)),a+=c}}}function ic(e,t,r){return e||(e=be(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function RR(e,t,r,n){var i=be(9);return ic(i,e,t),_w(r,n||"b",i),i}function IR(e,t,r){var n=be(8+2*r.length);return ic(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function MR(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?or(Ct(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Me(e,2,PO(r,n,i)):Me(e,3,FO(r,n,i));return;case"b":case"e":Me(e,5,RR(r,n,t.v,t.t));return;case"s":case"str":Me(e,4,IR(r,n,(t.v||"").slice(0,255)));return}Me(e,1,ic(null,r,n))}function LR(e,t,r,n){var i=Array.isArray(t),s=ct(t["!ref"]||"A1"),l,o="",a=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=rt(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Gt(c);for(var d=s.s.c;d<=s.e.c;++d){c===s.s.r&&(a[d]=Dt(d)),l=a[d]+o;var h=i?(t[c]||[])[d]:t[l];h&&MR(e,h,c,d)}}}function BR(e,t){for(var r=t||{},n=qr(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Me(n,r.biff==4?1033:r.biff==3?521:9,mp(e,16,r)),LR(n,e.Sheets[e.SheetNames[i]],i,r),Me(n,10),n.end()}function UR(e,t,r){Me(e,49,PA({sz:12,name:"Arial"},r))}function WR(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Me(e,1054,BA(i,t[i],r))})}function zR(e,t){var r=be(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Me(e,2151,r),r=be(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Tw(ct(t["!ref"]||"A1"),r),r.write_shift(4,4),Me(e,2152,r)}function HR(e,t){for(var r=0;r<16;++r)Me(e,224,cx({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Me(e,224,cx(n,0,t))})}function $R(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Me(e,440,dO(n)),n[1].Tooltip&&Me(e,2048,gO(n))}delete t["!links"]}function VR(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&Me(e,125,_O(kf(i,n),i))})}}function XR(e,t,r,n,i){var s=16+fs(i.cellXfs,t,i);if(t.v==null&&!t.bf){Me(e,513,Vs(r,n,s));return}if(t.bf)Me(e,6,vP(t,r,n,i,s));else switch(t.t){case"d":case"n":var l=t.t=="d"?or(Ct(t.v)):t.v;Me(e,515,JA(r,n,l,s));break;case"b":case"e":Me(e,517,qA(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var o=Sp(i.Strings,t.v,i.revStrings);Me(e,253,RA(r,n,o,s))}else Me(e,516,MA(r,n,(t.v||"").slice(0,255),s,i));break;default:Me(e,513,Vs(r,n,s))}}function YR(e,t,r){var n=qr(),i=r.SheetNames[e],s=r.Sheets[i]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[e]||{},a=Array.isArray(s),c=t.biff==8,d,h="",f=[],u=ct(s["!ref"]||"A1"),p=c?65536:16384;if(u.e.c>255||u.e.r>=p){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");u.e.c=Math.min(u.e.c,255),u.e.r=Math.min(u.e.c,p-1)}Me(n,2057,mp(r,16,t)),Me(n,13,xn(1)),Me(n,12,xn(100)),Me(n,15,Lr(!0)),Me(n,17,Lr(!1)),Me(n,16,Hs(.001)),Me(n,95,Lr(!0)),Me(n,42,Lr(!1)),Me(n,43,Lr(!1)),Me(n,130,xn(1)),Me(n,128,GA()),Me(n,131,Lr(!1)),Me(n,132,Lr(!1)),c&&VR(n,s["!cols"]),Me(n,512,WA(u,t)),c&&(s["!links"]=[]);for(var m=u.s.r;m<=u.e.r;++m){h=Gt(m);for(var g=u.s.c;g<=u.e.c;++g){m===u.s.r&&(f[g]=Dt(g)),d=f[g]+h;var x=a?(s[m]||[])[g]:s[d];x&&(XR(n,x,m,g,t),c&&x.l&&s["!links"].push([d,x.l]))}}var y=o.CodeName||o.name||i;return c&&Me(n,574,OA((l.Views||[])[0])),c&&(s["!merges"]||[]).length&&Me(n,229,oO(s["!merges"])),c&&$R(n,s),Me(n,442,bw(y)),c&&zR(n,s),Me(n,10),n.end()}function GR(e,t,r){var n=qr(),i=(e||{}).Workbook||{},s=i.Sheets||[],l=i.WBProps||{},o=r.biff==8,a=r.biff==5;if(Me(n,2057,mp(e,5,r)),r.bookType=="xla"&&Me(n,135),Me(n,225,o?xn(1200):null),Me(n,193,qN(2)),a&&Me(n,191),a&&Me(n,192),Me(n,226),Me(n,92,xA("SheetJS",r)),Me(n,66,xn(o?1200:1252)),o&&Me(n,353,xn(0)),o&&Me(n,448),Me(n,317,SO(e.SheetNames.length)),o&&e.vbaraw&&Me(n,211),o&&e.vbaraw){var c=l.CodeName||"ThisWorkbook";Me(n,442,bw(c))}Me(n,156,xn(17)),Me(n,25,Lr(!1)),Me(n,18,Lr(!1)),Me(n,19,xn(0)),o&&Me(n,431,Lr(!1)),o&&Me(n,444,xn(0)),Me(n,61,NA()),Me(n,64,Lr(!1)),Me(n,141,xn(0)),Me(n,34,Lr(T5(e)=="true")),Me(n,14,Lr(!0)),o&&Me(n,439,Lr(!1)),Me(n,218,xn(0)),UR(n,e,r),WR(n,e.SSF,r),HR(n,r),o&&Me(n,352,Lr(!1));var d=n.end(),h=qr();o&&Me(h,140,xO()),o&&r.Strings&&DR(h,252,bA(r.Strings)),Me(h,10);var f=h.end(),u=qr(),p=0,m=0;for(m=0;m<e.SheetNames.length;++m)p+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var g=d.length+p+f.length;for(m=0;m<e.SheetNames.length;++m){var x=s[m]||{};Me(u,133,wA({pos:g,hs:x.Hidden||0,dt:0,name:e.SheetNames[m]},r)),g+=t[m].length}var y=u.end();if(p!=y.length)throw new Error("BS8 "+p+" != "+y.length);var w=[];return d.length&&w.push(d),y.length&&w.push(y),f.length&&w.push(f),fr(w)}function qR(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Tt(Ge)),e&&e.SSF&&(lo(),mf(e.SSF),r.revssf=vf(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Ap(r),r.cellXfs=[],fs(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=YR(i,r,e);return n.unshift(GR(e,n,r)),fr(n)}function g_(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Kr(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return qR(e,t);case 4:case 3:case 2:return BR(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Sx(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),l=i.index,o=s&&s.index||e.length,a=P4(e.slice(l,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,h=0,f=0,u={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(l=0;l<a.length;++l){var m=a[l].trim(),g=m.slice(0,3).toLowerCase();if(g=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}d=0;continue}if(!(g!="<td"&&g!="<th")){var x=m.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var y=x[o].trim();if(y.match(/<t[dh]/i)){for(var w=y,_=0;w.charAt(0)=="<"&&(_=w.indexOf(">"))>-1;)w=w.slice(_+1);for(var b=0;b<p.length;++b){var k=p[b];k.s.c==d&&k.s.r<c&&c<=k.e.r&&(d=k.e.c+1,b=-1)}var S=Qe(y.slice(0,y.indexOf(">")));f=S.colspan?+S.colspan:1,((h=+S.rowspan)>1||f>1)&&p.push({s:{r:c,c:d},e:{r:c+(h||1)-1,c:d+f-1}});var E=S.t||S["data-t"]||"";if(!w.length){d+=f;continue}if(w=By(w),u.s.r>c&&(u.s.r=c),u.e.r<c&&(u.e.r=c),u.s.c>d&&(u.s.c=d),u.e.c<d&&(u.e.c=d),!w.length){d+=f;continue}var F={t:"s",v:w};r.raw||!w.trim().length||E=="s"||(w==="TRUE"?F={t:"b",v:!0}:w==="FALSE"?F={t:"b",v:!1}:isNaN(Bn(w))?isNaN(Qa(w).getDate())||(F={t:"d",v:Ct(w)},r.cellDates||(F={t:"n",v:or(F.v)}),F.z=r.dateNF||Ge[14]):F={t:"n",v:Bn(w)}),r.dense?(n[c]||(n[c]=[]),n[c][d]=F):n[Je({r:c,c:d})]=F,d+=f}}}}return n["!ref"]=rt(u),p.length&&(n["!merges"]=p),n}function KR(e,t,r,n){for(var i=e["!merges"]||[],s=[],l=t.s.c;l<=t.e.c;++l){for(var o=0,a=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>l)&&!(i[c].e.r<r||i[c].e.c<l)){if(i[c].s.r<r||i[c].s.c<l){o=-1;break}o=i[c].e.r-i[c].s.r+1,a=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var d=Je({r,c:l}),h=n.dense?(e[r]||[])[l]:e[d],f=h&&h.v!=null&&(h.h||np(h.w||(ki(h),h.w)||""))||"",u={};o>1&&(u.rowspan=o),a>1&&(u.colspan=a),n.editable?f='<span contenteditable="true">'+f+"</span>":h&&(u["data-t"]=h&&h.t||"z",h.v!=null&&(u["data-v"]=h.v),h.z!=null&&(u["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),u.id=(n.id||"sjs")+"-"+d,s.push(Re("td",f,u))}}var p="<tr>";return p+s.join("")+"</tr>"}var JR='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',QR="</body></html>";function ZR(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return us(Sx(r[0],t),t);var n=jp();return r.forEach(function(i,s){Pp(n,Sx(i,t),"Sheet"+(s+1))}),n}function eI(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function m_(e,t){var r=t||{},n=r.header!=null?r.header:JR,i=r.footer!=null?r.footer:QR,s=[n],l=Kr(e["!ref"]);r.dense=Array.isArray(e),s.push(eI(e,l,r));for(var o=l.s.r;o<=l.e.r;++o)s.push(KR(e,l,o,r));return s.push("</table>"+i),s.join("")}function x_(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Rt(n.origin):n.origin;i=l.r,s=l.c}var o=t.getElementsByTagName("tr"),a=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var d=Kr(e["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),i==-1&&(c.e.r=i=d.e.r+1)}var h=[],f=0,u=e["!rows"]||(e["!rows"]=[]),p=0,m=0,g=0,x=0,y=0,w=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&m<a;++p){var _=o[p];if(Cx(_)){if(n.display)continue;u[m]={hidden:!0}}var b=_.children;for(g=x=0;g<b.length;++g){var k=b[g];if(!(n.display&&Cx(k))){var S=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):By(k.innerHTML),E=k.getAttribute("data-z")||k.getAttribute("z");for(f=0;f<h.length;++f){var F=h[f];F.s.c==x+s&&F.s.r<m+i&&m+i<=F.e.r&&(x=F.e.c+1-s,f=-1)}w=+k.getAttribute("colspan")||1,((y=+k.getAttribute("rowspan")||1)>1||w>1)&&h.push({s:{r:m+i,c:x+s},e:{r:m+i+(y||1)-1,c:x+s+(w||1)-1}});var P={t:"s",v:S},D=k.getAttribute("data-t")||k.getAttribute("t")||"";S!=null&&(S.length==0?P.t=D||"z":n.raw||S.trim().length==0||D=="s"||(S==="TRUE"?P={t:"b",v:!0}:S==="FALSE"?P={t:"b",v:!1}:isNaN(Bn(S))?isNaN(Qa(S).getDate())||(P={t:"d",v:Ct(S)},n.cellDates||(P={t:"n",v:or(P.v)}),P.z=n.dateNF||Ge[14]):P={t:"n",v:Bn(S)})),P.z===void 0&&E!=null&&(P.z=E);var I="",X=k.getElementsByTagName("A");if(X&&X.length)for(var z=0;z<X.length&&!(X[z].hasAttribute("href")&&(I=X[z].getAttribute("href"),I.charAt(0)!="#"));++z);I&&I.charAt(0)!="#"&&(P.l={Target:I}),n.dense?(e[m+i]||(e[m+i]=[]),e[m+i][x+s]=P):e[Je({c:x+s,r:m+i})]=P,c.e.c<x+s&&(c.e.c=x+s),x+=w}}++m}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,m-1+i),e["!ref"]=rt(c),m>=a&&(e["!fullref"]=rt((c.e.r=o.length-p+m-1+i,c))),e}function v_(e,t){var r=t||{},n=r.dense?[]:{};return x_(n,e,t)}function tI(e,t){return us(v_(e,t),t)}function Cx(e){var t="",r=rI(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function rI(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function nI(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=lt(t.replace(/<[^>]*>/g,""));return[r]}var Tx={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function y_(e,t){var r=t||{},n=ip(e),i=[],s,l,o={name:""},a="",c=0,d,h,f={},u=[],p=r.dense?[]:{},m,g,x={value:""},y="",w=0,_=[],b=-1,k=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,F={},P=[],D={},I=0,X=0,z=[],G=1,ae=1,le=[],Z={Names:[]},C={},L=["",""],B=[],N={},U="",A=0,T=!1,j=!1,M=0;for(Pl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Pl.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?p["!ref"]=rt(S):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(p["!fullref"]=p["!ref"],S.e.r=r.sheetRows-1,p["!ref"]=rt(S)),P.length&&(p["!merges"]=P),z.length&&(p["!rows"]=z),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),u.push(d.name),f[d.name]=p,j=!1):m[0].charAt(m[0].length-2)!=="/"&&(d=Qe(m[0],!1),b=k=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,p=r.dense?[]:{},P=[],z=[],j=!0);break;case"table-row-group":m[1]==="/"?--E:++E;break;case"table-row":case"":if(m[1]==="/"){b+=G,G=1;break}if(h=Qe(m[0],!1),h.?b=h.-1:b==-1&&(b=0),G=+h["number-rows-repeated"]||1,G<10)for(M=0;M<G;++M)E>0&&(z[b+M]={level:E});k=-1;break;case"covered-table-cell":m[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(p[b]||(p[b]=[]),p[b][k]={t:"z"}):p[Je({r:b,c:k})]={t:"z"}),y="",_=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++k,x=Qe(m[0],!1),ae=parseInt(x["number-columns-repeated"]||"1",10),g={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(g.f=_x(lt(x.formula))),(x.||x["value-type"])=="string"&&(g.t="s",g.v=lt(x["string-value"]||""),r.dense?(p[b]||(p[b]=[]),p[b][k]=g):p[Je({r:b,c:k})]=g),k+=ae-1;else if(m[1]!=="/"){++k,y="",w=0,_=[],ae=1;var Y=G?b+G-1:b;if(k>S.e.c&&(S.e.c=k),k<S.s.c&&(S.s.c=k),b<S.s.r&&(S.s.r=b),Y>S.e.r&&(S.e.r=Y),x=Qe(m[0],!1),B=[],N={},g={t:x.||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=lt(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(I=parseInt(x["number-matrix-rows-spanned"],10)||0,X=parseInt(x["number-matrix-columns-spanned"],10)||0,D={s:{r:b,c:k},e:{r:b+I-1,c:k+X-1}},g.F=rt(D),le.push([D,g.F])),x.formula)g.f=_x(x.formula);else for(M=0;M<le.length;++M)b>=le[M][0].s.r&&b<=le[M][0].e.r&&k>=le[M][0].s.c&&k<=le[M][0].e.c&&(g.F=le[M][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(I=parseInt(x["number-rows-spanned"],10)||0,X=parseInt(x["number-columns-spanned"],10)||0,D={s:{r:b,c:k},e:{r:b+I-1,c:k+X-1}},P.push(D)),x["number-columns-repeated"]&&(ae=parseInt(x["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=bt(x["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(x.value);break;case"percentage":g.t="n",g.v=parseFloat(x.value);break;case"currency":g.t="n",g.v=parseFloat(x.value);break;case"date":g.t="d",g.v=Ct(x["date-value"]),r.cellDates||(g.t="n",g.v=or(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=O4(x["time-value"])/86400,r.cellDates&&(g.t="d",g.v=yf(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(x.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",x["string-value"]!=null&&(y=lt(x["string-value"]),_=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(T=!1,g.t==="s"&&(g.v=y||"",_.length&&(g.R=_),T=w==0),C.Target&&(g.l=C),B.length>0&&(g.c=B,B=[]),y&&r.cellText!==!1&&(g.w=y),T&&(g.t="z",delete g.v),(!T||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=b))for(var H=0;H<G;++H){if(ae=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(p[b+H]||(p[b+H]=[]),p[b+H][k]=H==0?g:Tt(g);--ae>0;)p[b+H][k+ae]=Tt(g);else for(p[Je({r:b+H,c:k})]=g;--ae>0;)p[Je({r:b+H,c:k+ae})]=Tt(g);S.e.c<=k&&(S.e.c=k)}ae=parseInt(x["number-columns-repeated"]||"1",10),k+=ae-1,ae=0,g={},y="",_=[]}C={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s;N.t=y,_.length&&(N.R=_),N.a=U,B.push(N)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);U="",A=0,y="",w=0,_=[];break;case"creator":m[1]==="/"?U=n.slice(A,m.index):A=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);y="",w=0,_=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(F[o.name]=a,(s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(a="",o=Qe(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":l=Qe(m[0],!1),a+=Tx[m[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":l=Qe(m[0],!1),a+=Tx[m[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":a+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":l=Qe(m[0],!1),L=yh(l["cell-range-address"]);var V={Name:l.name,Ref:L[0]+"!"+L[1]};j&&(V.Sheet=u.length),Z.Names.push(V);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!x||!x["string-value"])){var fe=nI(n.slice(w,m.index));y=(y.length>0?y+`
`:"")+fe[0]}else Qe(m[0],!1),w=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{L=yh(Qe(m[0])["target-range-address"]),f[L[0]]["!autofilter"]={ref:L[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(C=Qe(m[0],!1),!C.href)break;C.Target=lt(C.href),delete C.href,C.Target.charAt(0)=="#"&&C.Target.indexOf(".")>-1?(L=yh(C.Target.slice(1)),C.Target="#"+L[0]+"!"+L[1]):C.Target.match(/^\.\.[\\\/]/)&&(C.Target=C.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var O={Sheets:f,SheetNames:u,Workbook:Z};return r.bookSheets&&delete O.Sheets,O}function Ex(e,t){t=t||{},mn(e,"META-INF/manifest.xml")&&ON(Qt(e,"META-INF/manifest.xml"),t);var r=rn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=y_(xt(r),t);return mn(e,"meta.xml")&&(n.Props=cw(Qt(e,"meta.xml"))),n}function Nx(e,t){return y_(e,t)}var iI=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+jl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return qt+t}}(),Ax=function(){var e=function(s){return gt(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,l,o){var a=[];a.push('      <table:table table:name="'+gt(l.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,d=0,h=Kr(s["!ref"]||"A1"),f=s["!merges"]||[],u=0,p=Array.isArray(s);if(s["!cols"])for(d=0;d<=h.e.c;++d)a.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var m="",g=s["!rows"]||[];for(c=0;c<h.s.r;++c)m=g[c]?' table:style-name="ro'+g[c].ods+'"':"",a.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=h.e.r;++c){for(m=g[c]?' table:style-name="ro'+g[c].ods+'"':"",a.push("        <table:table-row"+m+`>
`),d=0;d<h.s.c;++d)a.push(t);for(;d<=h.e.c;++d){var x=!1,y={},w="";for(u=0;u!=f.length;++u)if(!(f[u].s.c>d)&&!(f[u].s.r>c)&&!(f[u].e.c<d)&&!(f[u].e.r<c)){(f[u].s.c!=d||f[u].s.r!=c)&&(x=!0),y["table:number-columns-spanned"]=f[u].e.c-f[u].s.c+1,y["table:number-rows-spanned"]=f[u].e.r-f[u].s.r+1;break}if(x){a.push(r);continue}var _=Je({r:c,c:d}),b=p?(s[c]||[])[d]:s[_];if(b&&b.f&&(y["table:formula"]=gt(SP(b.f)),b.F&&b.F.slice(0,_.length)==_)){var k=Kr(b.F);y["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,y["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!b){a.push(t);continue}switch(b.t){case"b":w=b.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=b.v?"true":"false";break;case"n":w=b.w||String(b.v||0),y["office:value-type"]="float",y["office:value"]=b.v||0;break;case"s":case"str":w=b.v==null?"":b.v,y["office:value-type"]="string";break;case"d":w=b.w||Ct(b.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=Ct(b.v).toISOString(),y["table:style-name"]="ce1";break;default:a.push(t);continue}var S=e(w);if(b.l&&b.l.Target){var E=b.l.Target;E=E.charAt(0)=="#"?"#"+CP(E.slice(1)):E,E.charAt(0)!="#"&&!E.match(/^\w+:/)&&(E="../"+E),S=Re("text:a",S,{"xlink:href":E.replace(/&/g,"&amp;")})}a.push("          "+Re("table:table-cell",Re("text:p",S,{}),y)+`
`)}a.push(`        </table:table-row>
`)}return a.push(`      </table:table>
`),a.join("")},i=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(c){return l.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var d=0;d<c["!cols"].length;++d)if(c["!cols"][d]){var h=c["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;ns(h),h.ods=o;var f=c["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),s.push(`  </style:style>
`),++o}}});var a=0;l.SheetNames.map(function(c){return l.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var d=0;d<c["!rows"].length;++d)if(c["!rows"][d]){c["!rows"][d].ods=a;var h=c["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+a+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++a}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,o){var a=[qt],c=jl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=jl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(a.push("<office:document"+c+d+`>
`),a.push(lw().replace(/office:document-meta/g,"office:meta"))):a.push("<office:document-content"+c+`>
`),i(a,l),a.push(`  <office:body>
`),a.push(`    <office:spreadsheet>
`);for(var h=0;h!=l.SheetNames.length;++h)a.push(n(l.Sheets[l.SheetNames[h]],l,h));return a.push(`    </office:spreadsheet>
`),a.push(`  </office:body>
`),o.bookType=="fods"?a.push("</office:document>"):a.push("</office:document-content>"),a.join("")}}();function w_(e,t){if(t.bookType=="fods")return Ax(e,t);var r=ep(),n="",i=[],s=[];return n="mimetype",nt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",nt(r,n,Ax(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",nt(r,n,iI(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",nt(r,n,qt+lw()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",nt(r,n,PN(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",nt(r,n,FN(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Xs(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function zd(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):xt(cs(e))}function sI(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):tn(Qn(e))}function aI(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function ss(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function Ox(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function oI(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function lI(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function Ul(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function ht(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Wt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ut(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=Ul(e,r),s=i&7;i=Math.floor(i/8);var l=0,o;if(i==0)break;switch(s){case 0:{for(var a=r[0];e[r[0]++]>=128;);o=e.slice(a,r[0])}break;case 5:l=4,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=Ul(e,r),o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function mr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(ht(n*8+i.type)),i.type==2&&t.push(ht(i.data.length)),t.push(i.data))})}),ss(t)}function Ep(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function pn(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=Ul(e,n),s=ut(e.slice(n[0],n[0]+i));n[0]+=i;var l={id:Wt(s[1][0].data),messages:[]};s[2].forEach(function(o){var a=ut(o.data),c=Wt(a[3][0].data);l.messages.push({meta:a,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(l.merge=Wt(s[3][0].data)>>>0>0),r.push(l)}return r}function ha(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:ht(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:ht(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(l){i.push(l.data),l.meta[3]=[{type:0,data:ht(l.data.length)}],n[2].push({data:mr(l.meta),type:2})});var s=mr(n);t.push(ht(s.length)),t.push(s),i.forEach(function(l){return t.push(l)})}),ss(t)}function cI(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Ul(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=t[r[0]],o>1&&(l|=t[r[0]+1]<<8),o>2&&(l|=t[r[0]+2]<<16),o>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}i.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var a=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,a=(t[r[0]++]&224)<<3,a|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(a=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(a=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[ss(i)],a==0)throw new Error("Invalid offset 0");if(a>i[0].length)throw new Error("Invalid offset beyond length");if(c>=a)for(i.push(i[0].slice(-a)),c-=a;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-a,-a+c))}}var d=ss(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function gn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(cI(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ss(t)}function da(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=ht(n),l=s.length;t.push(s),n<=60?(l++,t.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),l+=n,i[0]=0,i[1]=l&255,i[2]=l>>8&255,i[3]=l>>16&255,r+=n}return ss(t)}function uI(e,t,r,n){var i=Xs(e),s=i.getUint32(4,!0),l=(n>1?12:8)+Ox(s&(n>1?3470:398))*4,o=-1,a=-1,c=NaN,d=new Date(2001,0,1);s&512&&(o=i.getUint32(l,!0),l+=4),l+=Ox(s&(n>1?12288:4096))*4,s&16&&(a=i.getUint32(l,!0),l+=4),s&32&&(c=i.getFloat64(l,!0),l+=8),s&64&&(d.setTime(d.getTime()+i.getFloat64(l,!0)*1e3),l+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[a]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(a>-1)h={t:"s",v:t[a]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function fI(e,t,r){var n=Xs(e),i=n.getUint32(8,!0),s=12,l=-1,o=-1,a=NaN,c=NaN,d=new Date(2001,0,1);i&1&&(a=oI(e,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(l=n.getUint32(s,!0),s+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:a};break;case 3:h={t:"s",v:t[o]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(l>-1)h={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:a};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return h}function _h(e,t){var r=new Uint8Array(32),n=Xs(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,lI(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function bh(e,t){var r=new Uint8Array(32),n=Xs(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function hI(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return uI(e,t,r,e[0]);case 5:return fI(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Er(e){var t=ut(e);return Ul(t[1][0].data)}function Fx(e,t){var r=ut(t.data),n=Wt(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(l){var o=ut(l.data),a=Wt(o[1][0].data)>>>0;switch(n){case 1:s[a]=zd(o[3][0].data);break;case 8:{var c=e[Er(o[9][0].data)][0],d=ut(c.data),h=e[Er(d[1][0].data)][0],f=Wt(h.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var u=ut(h.data);s[a]=u[3].map(function(p){return zd(p.data)}).join("")}break}}),s}function dI(e,t){var r,n,i,s,l,o,a,c,d,h,f,u,p,m,g=ut(e),x=Wt(g[1][0].data)>>>0,y=Wt(g[2][0].data)>>>0,w=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&Wt(g[8][0].data)>0||!1,_,b;if((s=(i=g[7])==null?void 0:i[0])!=null&&s.data&&t!=0)_=(o=(l=g[7])==null?void 0:l[0])==null?void 0:o.data,b=(c=(a=g[6])==null?void 0:a[0])==null?void 0:c.data;else if((h=(d=g[4])==null?void 0:d[0])!=null&&h.data&&t!=1)_=(u=(f=g[4])==null?void 0:f[0])==null?void 0:u.data,b=(m=(p=g[3])==null?void 0:p[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=w?4:1,S=Xs(_),E=[],F=0;F<_.length/2;++F){var P=S.getUint16(F*2,!0);P<65535&&E.push([F,P])}if(E.length!=y)throw"Expected ".concat(y," cells, found ").concat(E.length);var D=[];for(F=0;F<E.length-1;++F)D[E[F][0]]=b.subarray(E[F][1]*k,E[F+1][1]*k);return E.length>=1&&(D[E[E.length-1][0]]=b.subarray(E[E.length-1][1]*k)),{R:x,cells:D}}function pI(e,t){var r,n=ut(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Wt(n[7][0].data)>>>0>0?1:0:-1,s=Ep(n[5],function(l){return dI(l,i)});return{nrows:Wt(n[4][0].data)>>>0,data:s.reduce(function(l,o){return l[o.R]||(l[o.R]=[]),o.cells.forEach(function(a,c){if(l[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));l[o.R][c]=a}),l},[])}}function gI(e,t,r){var n,i=ut(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Wt(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Wt(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=rt(s);var l=ut(i[4][0].data),o=Fx(e,e[Er(l[4][0].data)][0]),a=(n=l[17])!=null&&n[0]?Fx(e,e[Er(l[17][0].data)][0]):[],c=ut(l[3][0].data),d=0;c[1].forEach(function(h){var f=ut(h.data),u=e[Er(f[2][0].data)][0],p=Wt(u.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var m=pI(e,u);m.data.forEach(function(g,x){g.forEach(function(y,w){var _=Je({r:d+x,c:w}),b=hI(y,o,a);b&&(r[_]=b)})}),d+=m.nrows})}function mI(e,t){var r=ut(t.data),n={"!ref":"A1"},i=e[Er(r[2][0].data)],s=Wt(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return gI(e,i[0],n),n}function xI(e,t){var r,n=ut(t.data),i={name:(r=n[1])!=null&&r[0]?zd(n[1][0].data):"",sheets:[]},s=Ep(n[2],Er);return s.forEach(function(l){e[l].forEach(function(o){var a=Wt(o.meta[1][0].data);a==6e3&&i.sheets.push(mI(e,o))})}),i}function vI(e,t){var r=jp(),n=ut(t.data),i=Ep(n[1],Er);if(i.forEach(function(s){e[s].forEach(function(l){var o=Wt(l.meta[1][0].data);if(o==2){var a=xI(e,l);a.sheets.forEach(function(c,d){Pp(r,c,d==0?a.name:a.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function kh(e){var t,r,n,i,s={},l=[];if(e.FullPaths.forEach(function(a){if(a.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(a){if(a.name.match(/\.iwa$/)){var c;try{c=gn(a.content)}catch(h){return console.log("?? "+a.content.length+" "+(h.message||h))}var d;try{d=pn(c)}catch(h){return console.log("## "+(h.message||h))}d.forEach(function(h){s[h.id]=h.messages,l.push(h.id)})}}),!l.length)throw new Error("File has no messages");var o=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Wt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||l.forEach(function(a){s[a].forEach(function(c){var d=Wt(c.meta[1][0].data)>>>0;if(d==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return vI(s,o)}function yI(e,t,r){var n,i,s,l;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(s=e[8])==null?void 0:s[0])==null?void 0:l.data)&&Wt(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var a=0,c=Xs(e[7][0].data),d=0,h=[],f=Xs(e[4][0].data),u=0,p=[],m=0;m<t.length;++m){if(t[m]==null){c.setUint16(m*2,65535,!0),f.setUint16(m*2,65535);continue}c.setUint16(m*2,d,!0),f.setUint16(m*2,u,!0);var g,x;switch(typeof t[m]){case"string":g=_h({t:"s",v:t[m]},r),x=bh({t:"s",v:t[m]},r);break;case"number":g=_h({t:"n",v:t[m]},r),x=bh({t:"n",v:t[m]},r);break;case"boolean":g=_h({t:"b",v:t[m]},r),x=bh({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}h.push(g),d+=g.length,p.push(x),u+=x.length,++a}for(e[2][0].data=ht(a);m<e[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),f.setUint16(m*2,65535,!0);return e[6][0].data=ss(h),e[3][0].data=ss(p),a}function wI(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Kr(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(rt(n)));var s=$u(r,{range:n,header:1}),l=["~Sh33tJ5~"];s.forEach(function(U){return U.forEach(function(A){typeof A=="string"&&l.push(A)})});var o={},a=[],c=Xe.read(t.numbers,{type:"base64"});c.FileIndex.map(function(U,A){return[U,c.FullPaths[A]]}).forEach(function(U){var A=U[0],T=U[1];if(A.type==2&&A.name.match(/\.iwa/)){var j=A.content,M=gn(j),Y=pn(M);Y.forEach(function(H){a.push(H.id),o[H.id]={deps:[],location:T,type:Wt(H.messages[0].meta[1][0].data)}})}}),a.sort(function(U,A){return U-A});var d=a.filter(function(U){return U>1}).map(function(U){return[U,ht(U)]});c.FileIndex.map(function(U,A){return[U,c.FullPaths[A]]}).forEach(function(U){var A=U[0];if(U[1],!!A.name.match(/\.iwa/)){var T=pn(gn(A.content));T.forEach(function(j){j.messages.forEach(function(M){d.forEach(function(Y){j.messages.some(function(H){return Wt(H.meta[1][0].data)!=11006&&aI(H.data,Y[1])})&&o[Y[0]].deps.push(j.id)})})})}});for(var h=Xe.find(c,o[1].location),f=pn(gn(h.content)),u,p=0;p<f.length;++p){var m=f[p];m.id==1&&(u=m)}var g=Er(ut(u.messages[0].data)[1][0].data);for(h=Xe.find(c,o[g].location),f=pn(gn(h.content)),p=0;p<f.length;++p)m=f[p],m.id==g&&(u=m);for(g=Er(ut(u.messages[0].data)[2][0].data),h=Xe.find(c,o[g].location),f=pn(gn(h.content)),p=0;p<f.length;++p)m=f[p],m.id==g&&(u=m);for(g=Er(ut(u.messages[0].data)[2][0].data),h=Xe.find(c,o[g].location),f=pn(gn(h.content)),p=0;p<f.length;++p)m=f[p],m.id==g&&(u=m);var x=ut(u.messages[0].data);{x[6][0].data=ht(n.e.r+1),x[7][0].data=ht(n.e.c+1);var y=Er(x[46][0].data),w=Xe.find(c,o[y].location),_=pn(gn(w.content));{for(var b=0;b<_.length&&_[b].id!=y;++b);if(_[b].id!=y)throw"Bad ColumnRowUIDMapArchive";var k=ut(_[b].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var S=0;S<=n.e.c;++S){var E=[];E[1]=E[2]=[{type:0,data:ht(S+420690)}],k[1].push({type:2,data:mr(E)}),k[2].push({type:0,data:ht(S)}),k[3].push({type:0,data:ht(S)})}k[4]=[],k[5]=[],k[6]=[];for(var F=0;F<=n.e.r;++F)E=[],E[1]=E[2]=[{type:0,data:ht(F+726270)}],k[4].push({type:2,data:mr(E)}),k[5].push({type:0,data:ht(F)}),k[6].push({type:0,data:ht(F)});_[b].messages[0].data=mr(k)}w.content=da(ha(_)),w.size=w.content.length,delete x[46];var P=ut(x[4][0].data);{P[7][0].data=ht(n.e.r+1);var D=ut(P[1][0].data),I=Er(D[2][0].data);w=Xe.find(c,o[I].location),_=pn(gn(w.content));{if(_[0].id!=I)throw"Bad HeaderStorageBucket";var X=ut(_[0].messages[0].data);for(F=0;F<s.length;++F){var z=ut(X[2][0].data);z[1][0].data=ht(F),z[4][0].data=ht(s[F].length),X[2][F]={type:X[2][0].type,data:mr(z)}}_[0].messages[0].data=mr(X)}w.content=da(ha(_)),w.size=w.content.length;var G=Er(P[2][0].data);w=Xe.find(c,o[G].location),_=pn(gn(w.content));{if(_[0].id!=G)throw"Bad HeaderStorageBucket";for(X=ut(_[0].messages[0].data),S=0;S<=n.e.c;++S)z=ut(X[2][0].data),z[1][0].data=ht(S),z[4][0].data=ht(n.e.r+1),X[2][S]={type:X[2][0].type,data:mr(z)};_[0].messages[0].data=mr(X)}w.content=da(ha(_)),w.size=w.content.length;var ae=Er(P[4][0].data);(function(){for(var U=Xe.find(c,o[ae].location),A=pn(gn(U.content)),T,j=0;j<A.length;++j){var M=A[j];M.id==ae&&(T=M)}var Y=ut(T.messages[0].data);{Y[3]=[];var H=[];l.forEach(function(O,Q){H[1]=[{type:0,data:ht(Q)}],H[2]=[{type:0,data:ht(1)}],H[3]=[{type:2,data:sI(O)}],Y[3].push({type:2,data:mr(H)})})}T.messages[0].data=mr(Y);var V=ha(A),fe=da(V);U.content=fe,U.size=U.content.length})();var le=ut(P[3][0].data);{var Z=le[1][0];delete le[2];var C=ut(Z.data);{var L=Er(C[2][0].data);(function(){for(var U=Xe.find(c,o[L].location),A=pn(gn(U.content)),T,j=0;j<A.length;++j){var M=A[j];M.id==L&&(T=M)}var Y=ut(T.messages[0].data);{delete Y[6],delete le[7];var H=new Uint8Array(Y[5][0].data);Y[5]=[];for(var V=0,fe=0;fe<=n.e.r;++fe){var O=ut(H);V+=yI(O,s[fe],l),O[1][0].data=ht(fe),Y[5].push({data:mr(O),type:2})}Y[1]=[{type:0,data:ht(n.e.c+1)}],Y[2]=[{type:0,data:ht(n.e.r+1)}],Y[3]=[{type:0,data:ht(V)}],Y[4]=[{type:0,data:ht(n.e.r+1)}]}T.messages[0].data=mr(Y);var Q=ha(A),K=da(Q);U.content=K,U.size=U.content.length})()}Z.data=mr(C)}P[3][0].data=mr(le)}x[4][0].data=mr(P)}u.messages[0].data=mr(x);var B=ha(f),N=da(B);return h.content=N,h.size=h.content.length,c}function __(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Np(e){__([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Ap(e){__([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function _I(e){return st.WS.indexOf(e)>-1?"sheet":e==st.CS?"chart":e==st.DS?"dialog":e==st.MS?"macro":e&&e.length?e:"sheet"}function bI(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,_I(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function kI(e,t,r,n,i,s,l,o,a,c,d,h){try{s[n]=Ko(rn(e,r,!0),t);var f=Qt(e,t),u;switch(o){case"sheet":u=V5(f,t,i,a,s[n],c,d,h);break;case"chart":if(u=X5(f,t,i,a,s[n],c,d,h),!u||!u["!drawel"])break;var p=Do(u["!drawel"].Target,t),m=Dl(p),g=jF(rn(e,p,!0),Ko(rn(e,m,!0),p)),x=Do(g,p),y=Dl(x);u=y5(rn(e,x,!0),x,a,Ko(rn(e,y,!0),x),c,u);break;case"macro":u=Y5(f,t,i,a,s[n],c,d,h);break;case"dialog":u=G5(f,t,i,a,s[n],c,d,h);break;default:throw new Error("Unrecognized sheet type "+o)}l[n]=u;var w=[];s&&s[n]&&zt(s[n]).forEach(function(_){var b="";if(s[n][_].Type==st.CMNT){b=Do(s[n][_].Target,t);var k=Q5(Qt(e,b,!0),b,a);if(!k||!k.length)return;mx(u,k,!1)}s[n][_].Type==st.TCMNT&&(b=Do(s[n][_].Target,t),w=w.concat(DF(Qt(e,b,!0),a)))}),w&&w.length&&mx(u,w,!0,a.people||[])}catch(_){if(a.WTF)throw _}}function hn(e){return e.charAt(0)=="/"?e.slice(1):e}function SI(e,t){if(lo(),t=t||{},Np(t),mn(e,"META-INF/manifest.xml")||mn(e,"objectdata.xml"))return Ex(e,t);if(mn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof kh<"u"){if(e.FileIndex)return kh(e);var r=Xe.utils.cfb_new();return Mm(e).forEach(function(z){nt(r,z,R4(e,z))}),kh(r)}throw new Error("Unsupported NUMBERS file")}if(!mn(e,"[Content_Types].xml"))throw mn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):mn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Mm(e),i=NN(rn(e,"[Content_Types].xml")),s=!1,l,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Qt(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Qt(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var a={},c={};if(!t.bookSheets&&!t.bookProps){if(Jo=[],i.sst)try{Jo=J5(Qt(e,hn(i.sst)),i.sst,t)}catch(z){if(t.WTF)throw z}t.cellStyles&&i.themes.length&&(a=K5(rn(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=q5(Qt(e,hn(i.style)),i.style,a,t))}i.links.map(function(z){try{var G=Ko(rn(e,Dl(hn(z))),z);return eR(Qt(e,hn(z)),G,z,t)}catch{}});var d=$5(Qt(e,hn(i.workbooks[0])),i.workbooks[0],t),h={},f="";i.coreprops.length&&(f=Qt(e,hn(i.coreprops[0]),!0),f&&(h=cw(f)),i.extprops.length!==0&&(f=Qt(e,hn(i.extprops[0]),!0),f&&RN(f,h,t)));var u={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(f=rn(e,hn(i.custprops[0]),!0),f&&(u=MN(f,t)));var p={};if((t.bookSheets||t.bookProps)&&(d.Sheets?l=d.Sheets.map(function(G){return G.name}):h.Worksheets&&h.SheetNames.length>0&&(l=h.SheetNames),t.bookProps&&(p.Props=h,p.Custprops=u),t.bookSheets&&typeof l<"u"&&(p.SheetNames=l),t.bookSheets?p.SheetNames:t.bookProps))return p;l={};var m={};t.bookDeps&&i.calcchain&&(m=Z5(Qt(e,hn(i.calcchain)),i.calcchain));var g=0,x={},y,w;{var _=d.Sheets;h.Worksheets=_.length,h.SheetNames=[];for(var b=0;b!=_.length;++b)h.SheetNames[b]=_[b].name}var k=s?"bin":"xml",S=i.workbooks[0].lastIndexOf("/"),E=(i.workbooks[0].slice(0,S+1)+"_rels/"+i.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");mn(e,E)||(E="xl/_rels/workbook."+k+".rels");var F=Ko(rn(e,E,!0),E.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=tR(Qt(e,hn(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=IF(Qt(e,hn(i.people[0])),t)),F&&(F=bI(F,d.Sheets));var P=Qt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=h.Worksheets;++g){var D="sheet";if(F&&F[g]?(y="xl/"+F[g][1].replace(/[\/]?xl\//,""),mn(e,y)||(y=F[g][1]),mn(e,y)||(y=E.replace(/_rels\/.*$/,"")+F[g][1]),D=F[g][2]):(y="xl/worksheets/sheet"+(g+1-P)+"."+k,y=y.replace(/sheet0\./,"sheet.")),w=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(h.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var I=!1,X=0;X!=t.sheets.length;++X)typeof t.sheets[X]=="number"&&t.sheets[X]==g&&(I=1),typeof t.sheets[X]=="string"&&t.sheets[X].toLowerCase()==h.SheetNames[g].toLowerCase()&&(I=1);if(!I)continue e}}kI(e,y,w,h.SheetNames[g],g,x,l,D,t,d,a,c)}return p={Directory:i,Workbook:d,Props:h,Custprops:u,Deps:m,Sheets:l,SheetNames:h.SheetNames,Strings:Jo,Styles:c,Themes:a,SSF:Tt(Ge)},t&&t.bookFiles&&(e.files?(p.keys=n,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(z,G){z=z.replace(/^Root Entry[\/]/,""),p.keys.push(z),p.files[z]=e.FileIndex[G]}))),t&&t.bookVBA&&(i.vba.length>0?p.vbaraw=Qt(e,hn(i.vba[0]),!0):i.defaults&&i.defaults.bin===$F&&(p.vbaraw=Qt(e,"xl/vbaProject.bin",!0))),p}function CI(e,t){var r=t||{},n="Workbook",i=Xe.find(e,n);try{if(n="/!DataSpaces/Version",i=Xe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(t3(i.content),n="/!DataSpaces/DataSpaceMap",i=Xe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=n3(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Xe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=i3(i.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Xe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);a3(i.content)}catch{}if(n="/EncryptionInfo",i=Xe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=o3(i.content);if(n="/EncryptedPackage",i=Xe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function TI(e,t){return t.bookType=="ods"?w_(e,t):t.bookType=="numbers"?wI(e,t):t.bookType=="xlsb"?EI(e,t):NI(e,t)}function EI(e,t){ja=1024,e&&!e.SSF&&(e.SSF=Tt(Ge)),e&&e.SSF&&(lo(),mf(e.SSF),t.revssf=vf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Qo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=Gw.indexOf(t.bookType)>-1,i=pp();Ap(t=t||{});var s=ep(),l="",o=0;if(t.cellXfs=[],fs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",nt(s,l,uw(e.Props,t)),i.coreprops.push(l),pt(t.rels,2,l,st.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var a=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&a.push(e.SheetNames[c]);e.Props.SheetNames=a}for(e.Props.Worksheets=e.Props.SheetNames.length,nt(s,l,dw(e.Props)),i.extprops.push(l),pt(t.rels,3,l,st.EXT_PROPS),e.Custprops!==e.Props&&zt(e.Custprops||{}).length>0&&(l="docProps/custom.xml",nt(s,l,pw(e.Custprops)),i.custprops.push(l),pt(t.rels,4,l,st.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,nt(s,l,nR(o-1,l,t,e,d)),i.sheets.push(l),pt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,st.WS[0])}if(h){var u=h["!comments"],p=!1,m="";u&&u.length>0&&(m="xl/comments"+o+"."+r,nt(s,m,aR(u,m)),i.comments.push(m),pt(d,-1,"../comments"+o+"."+r,st.CMNT),p=!0),h["!legacy"]&&p&&nt(s,"xl/drawings/vmlDrawing"+o+".vml",Xw(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&nt(s,Dl(l),Wa(d))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,nt(s,l,sR(t.Strings,l,t)),i.strs.push(l),pt(t.wbrels,-1,"sharedStrings."+r,st.SST)),l="xl/workbook."+r,nt(s,l,rR(e,l)),i.workbooks.push(l),pt(t.rels,1,l,st.WB),l="xl/theme/theme1.xml",nt(s,l,wp(e.Themes,t)),i.themes.push(l),pt(t.wbrels,-1,"theme/theme1.xml",st.THEME),l="xl/styles."+r,nt(s,l,iR(e,l,t)),i.styles.push(l),pt(t.wbrels,-1,"styles."+r,st.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",nt(s,l,e.vbaraw),i.vba.push(l),pt(t.wbrels,-1,"vbaProject.bin",st.VBA)),l="xl/metadata."+r,nt(s,l,oR(l)),i.metadata.push(l),pt(t.wbrels,-1,"metadata."+r,st.XLMETA),nt(s,"[Content_Types].xml",ow(i,t)),nt(s,"_rels/.rels",Wa(t.rels)),nt(s,"xl/_rels/workbook."+r+".rels",Wa(t.wbrels)),delete t.revssf,delete t.ssf,s}function NI(e,t){ja=1024,e&&!e.SSF&&(e.SSF=Tt(Ge)),e&&e.SSF&&(lo(),mf(e.SSF),t.revssf=vf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Qo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Gw.indexOf(t.bookType)>-1,i=pp();Ap(t=t||{});var s=ep(),l="",o=0;if(t.cellXfs=[],fs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",nt(s,l,uw(e.Props,t)),i.coreprops.push(l),pt(t.rels,2,l,st.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var a=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&a.push(e.SheetNames[c]);e.Props.SheetNames=a}e.Props.Worksheets=e.Props.SheetNames.length,nt(s,l,dw(e.Props)),i.extprops.push(l),pt(t.rels,3,l,st.EXT_PROPS),e.Custprops!==e.Props&&zt(e.Custprops||{}).length>0&&(l="docProps/custom.xml",nt(s,l,pw(e.Custprops)),i.custprops.push(l),pt(t.rels,4,l,st.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],u=(f||{})["!type"]||"sheet";switch(u){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,nt(s,l,s_(o-1,t,e,h)),i.sheets.push(l),pt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,st.WS[0])}if(f){var p=f["!comments"],m=!1,g="";if(p&&p.length>0){var x=!1;p.forEach(function(y){y[1].forEach(function(w){w.T==!0&&(x=!0)})}),x&&(g="xl/threadedComments/threadedComment"+o+"."+r,nt(s,g,RF(p,d,t)),i.threadedcomments.push(g),pt(h,-1,"../threadedComments/threadedComment"+o+"."+r,st.TCMNT)),g="xl/comments"+o+"."+r,nt(s,g,Yw(p)),i.comments.push(g),pt(h,-1,"../comments"+o+"."+r,st.CMNT),m=!0}f["!legacy"]&&m&&nt(s,"xl/drawings/vmlDrawing"+o+".vml",Xw(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&nt(s,Dl(l),Wa(h))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,nt(s,l,Dw(t.Strings,t)),i.strs.push(l),pt(t.wbrels,-1,"sharedStrings."+r,st.SST)),l="xl/workbook."+r,nt(s,l,u_(e)),i.workbooks.push(l),pt(t.rels,1,l,st.WB),l="xl/theme/theme1.xml",nt(s,l,wp(e.Themes,t)),i.themes.push(l),pt(t.wbrels,-1,"theme/theme1.xml",st.THEME),l="xl/styles."+r,nt(s,l,zw(e,t)),i.styles.push(l),pt(t.wbrels,-1,"styles."+r,st.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",nt(s,l,e.vbaraw),i.vba.push(l),pt(t.wbrels,-1,"vbaProject.bin",st.VBA)),l="xl/metadata."+r,nt(s,l,Vw()),i.metadata.push(l),pt(t.wbrels,-1,"metadata."+r,st.XLMETA),d.length>1&&(l="xl/persons/person.xml",nt(s,l,MF(d)),i.people.push(l),pt(t.wbrels,-1,"persons/person.xml",st.PEOPLE)),nt(s,"[Content_Types].xml",ow(i,t)),nt(s,"_rels/.rels",Wa(t.rels)),nt(s,"xl/_rels/workbook."+r+".rels",Wa(t.wbrels)),delete t.revssf,delete t.ssf,s}function Op(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ln(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function AI(e,t){return Xe.find(e,"EncryptedPackage")?CI(e,t):p_(e,t)}function OI(e,t){var r,n=e,i=t||{};return i.type||(i.type=it&&Buffer.isBuffer(e)?"buffer":"base64"),r=Iy(n,i),SI(r,i)}function b_(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Ud(e.slice(r),t);default:break e}return Za.to_workbook(e,t)}function FI(e,t){var r="",n=Op(e,t);switch(t.type){case"base64":r=ln(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=zs(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=xt(r)),t.type="binary",b_(r,t)}function jI(e,t){var r=e;return t.type=="base64"&&(r=ln(r)),r=Nl.utils.decode(1200,r.slice(2),"str"),t.type="binary",b_(r,t)}function PI(e){return e.match(/[^\x00-\x7F]/)?Qn(e):e}function Sh(e,t,r,n){return n?(r.type="string",Za.to_workbook(e,r)):Za.to_workbook(t,r)}function Hd(e,t){q0();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Hd(new Uint8Array(e),(r=Tt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Ha={},r.dateNF&&(Ha.dateNF=r.dateNF),r.type||(r.type=it&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=it?"buffer":"binary",n=E4(e),typeof Uint8Array<"u"&&!it&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=PI(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),o=new Uint8Array(l);if(o.foo="bar",!o.foo)return r=Tt(r),r.type="array",Hd(K0(n),r)}switch((i=Op(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return AI(Xe.read(n,r),r);break;case 9:if(i[1]<=8)return p_(n,r);break;case 60:return Ud(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return LO(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return jw.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?OI(n,r):Sh(e,n,r,s);case 239:return i[3]===60?Ud(n,r):Sh(e,n,r,s);case 255:if(i[1]===254)return jI(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Ps.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Ps.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Bd.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return Bw.to_workbook(n,r);break;case 10:case 13:case 32:return FI(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return MO.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Bd.to_workbook(n,r):Sh(e,n,r,s)}function k_(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Jl(t.file,Xe.write(e,{type:it?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Xe.write(e,t)}function DI(e,t){var r=Tt(t||{}),n=TI(e,r);return RI(n,r)}function RI(e,t){var r={},n=it?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Xe.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(gf(i))}return t.password&&typeof encrypt_agile<"u"?k_(encrypt_agile(i,t.password),t):t.type==="file"?Jl(t.file,i):t.type=="string"?xt(i):i}function II(e,t){var r=t||{},n=PR(e,r);return k_(n,r)}function Vn(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Al(Qn(n));case"binary":return Qn(n);case"string":return e;case"file":return Jl(t.file,n,"utf8");case"buffer":return it?Ti(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Vn(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function MI(e,t){switch(t.type){case"base64":return Al(e);case"binary":return e;case"string":return e;case"file":return Jl(t.file,e,"binary");case"buffer":return it?Ti(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Uc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Al(r):t.type=="string"?xt(r):r;case"file":return Jl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function S_(e,t){q0(),A5(e);var r=Tt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=S_(e,r);return r.type="array",gf(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Vn(TR(e,r),r);case"slk":case"sylk":return Vn(Fw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return Vn(m_(e.Sheets[e.SheetNames[i]],r),r);case"txt":return MI(T_(e.Sheets[e.SheetNames[i]],r),r);case"csv":return Vn(Fp(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return Vn(jw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return Uc(Bd.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return Vn(Za.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return Vn(Bw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return Vn(Pw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return Vn(w_(e,r),r);case"wk1":return Uc(Ps.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return Uc(Ps.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Uc(g_(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),II(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return DI(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function LI(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function C_(e,t,r){var n={};return n.type="file",n.file=t,LI(n),S_(e,n)}function BI(e,t,r,n,i,s,l,o){var a=Gt(r),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,f=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!l||e[r])for(var u=t.s.c;u<=t.e.c;++u){var p=l?e[r][u]:e[n[u]+a];if(p===void 0||p.t===void 0){if(c===void 0)continue;s[u]!=null&&(f[s[u]]=c);continue}var m=p.v;switch(p.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(s[u]!=null){if(m==null)if(p.t=="e"&&m===null)f[s[u]]=null;else if(c!==void 0)f[s[u]]=c;else if(d&&m===null)f[s[u]]=null;else continue;else f[s[u]]=d&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?m:ki(p,m,o);m!=null&&(h=!1)}}return{row:f,isempty:h}}function $u(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],l=0,o="",a={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},d=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof d){case"string":a=ct(d);break;case"number":a=ct(e["!ref"]),a.s.r=d;break;default:a=d}n>0&&(i=0);var h=Gt(a.s.r),f=[],u=[],p=0,m=0,g=Array.isArray(e),x=a.s.r,y=0,w={};g&&!e[x]&&(e[x]=[]);var _=c.skipHidden&&e["!cols"]||[],b=c.skipHidden&&e["!rows"]||[];for(y=a.s.c;y<=a.e.c;++y)if(!(_[y]||{}).hidden)switch(f[y]=Dt(y),r=g?e[x][y]:e[f[y]+h],n){case 1:s[y]=y-a.s.c;break;case 2:s[y]=f[y];break;case 3:s[y]=c.header[y-a.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=ki(r,null,c),m=w[l]||0,!m)w[l]=1;else{do o=l+"_"+m++;while(w[o]);w[l]=m,w[o]=1}s[y]=o}for(x=a.s.r+i;x<=a.e.r;++x)if(!(b[x]||{}).hidden){var k=BI(e,a,x,f,n,s,g,c);(k.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(u[p++]=k.row)}return u.length=p,u}var jx=/"/g;function UI(e,t,r,n,i,s,l,o){for(var a=!0,c=[],d="",h=Gt(r),f=t.s.c;f<=t.e.c;++f)if(n[f]){var u=o.dense?(e[r]||[])[f]:e[n[f]+h];if(u==null)d="";else if(u.v!=null){a=!1,d=""+(o.rawNumbers&&u.t=="n"?u.v:ki(u,null,o));for(var p=0,m=0;p!==d.length;++p)if((m=d.charCodeAt(p))===i||m===s||m===34||o.forceQuotes){d='"'+d.replace(jx,'""')+'"';break}d=="ID"&&(d='"ID"')}else u.f!=null&&!u.F?(a=!1,d="="+u.f,d.indexOf(",")>=0&&(d='"'+d.replace(jx,'""')+'"')):d="";c.push(d)}return o.blankrows===!1&&a?null:c.join(l)}function Fp(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=ct(e["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,a=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),d="",h=[];n.dense=Array.isArray(e);for(var f=n.skipHidden&&e["!cols"]||[],u=n.skipHidden&&e["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(f[p]||{}).hidden||(h[p]=Dt(p));for(var m=0,g=i.s.r;g<=i.e.r;++g)(u[g]||{}).hidden||(d=UI(e,i,g,h,l,a,s,n),d!=null&&(n.strip&&(d=d.replace(c,"")),(d||n.blankrows!==!1)&&r.push((m++?o:"")+d)));return delete n.dense,r.join("")}function T_(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Fp(e,t);return r}function WI(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=ct(e["!ref"]),s="",l=[],o,a=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)l[o]=Dt(o);for(var d=i.s.r;d<=i.e.r;++d)for(s=Gt(d),o=i.s.c;o<=i.e.c;++o)if(t=l[o]+s,r=c?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}a[a.length]=t+"="+n}return a}function E_(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},l=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var a=typeof n.origin=="string"?Rt(n.origin):n.origin;l=a.r,o=a.c}var c,d={s:{c:0,r:0},e:{c:o,r:l+t.length-1+i}};if(s["!ref"]){var h=ct(s["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),l==-1&&(l=h.e.r+1,d.e.r=l+t.length-1+i)}else l==-1&&(l=0,d.e.r=t.length-1+i);var f=n.header||[],u=0;t.forEach(function(m,g){zt(m).forEach(function(x){(u=f.indexOf(x))==-1&&(f[u=f.length]=x);var y=m[x],w="z",_="",b=Je({c:o+u,r:l+g+i});c=Wl(s,b),y&&typeof y=="object"&&!(y instanceof Date)?s[b]=y:(typeof y=="number"?w="n":typeof y=="boolean"?w="b":typeof y=="string"?w="s":y instanceof Date?(w="d",n.cellDates||(w="n",y=or(y)),_=n.dateNF||Ge[14]):y===null&&n.nullError&&(w="e",y=0),c?(c.t=w,c.v=y,delete c.w,delete c.R,_&&(c.z=_)):s[b]=c={t:w,v:y},_&&(c.z=_))})}),d.e.c=Math.max(d.e.c,o+f.length-1);var p=Gt(l);if(i)for(u=0;u<f.length;++u)s[Dt(u+o)+p]={t:"s",v:f[u]};return s["!ref"]=rt(d),s}function zI(e,t){return E_(null,e,t)}function Wl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Rt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Wl(e,Je(t)):Wl(e,Je({r:t,c:r||0}))}function HI(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function jp(){return{SheetNames:[],Sheets:{}}}function Pp(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var l=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=l+i)!=-1;++i);}if(c_(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function $I(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=HI(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function VI(e,t){return e.z=t,e}function N_(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function XI(e,t,r){return N_(e,"#"+t,r)}function YI(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function GI(e,t,r,n){for(var i=typeof t!="string"?t:ct(t),s=typeof t=="string"?t:rt(t),l=i.s.r;l<=i.e.r;++l)for(var o=i.s.c;o<=i.e.c;++o){var a=Wl(e,l,o);a.t="n",a.F=s,delete a.v,l==i.s.r&&o==i.s.c&&(a.f=r,n&&(a.D=!0))}return e}var Es={encode_col:Dt,encode_row:Gt,encode_cell:Je,encode_range:rt,decode_col:lp,decode_row:op,split_cell:sN,decode_cell:Rt,decode_range:Kr,format_cell:ki,sheet_add_aoa:ew,sheet_add_json:E_,sheet_add_dom:x_,aoa_to_sheet:co,json_to_sheet:zI,table_to_sheet:v_,table_to_book:tI,sheet_to_csv:Fp,sheet_to_txt:T_,sheet_to_json:$u,sheet_to_html:m_,sheet_to_formulae:WI,sheet_to_row_object_array:$u,sheet_get_cell:Wl,book_new:jp,book_append_sheet:Pp,book_set_sheet_visibility:$I,cell_set_number_format:VI,cell_set_hyperlink:N_,cell_set_internal_link:XI,cell_add_comment:YI,sheet_set_array_formula:GI,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const A_=({isMobileView:e=!1,externalZoneId:t=null,externalDate:r=null,externalSessionId:n=null})=>{const i=ne.useRef(null),s=ne.useRef(null),[l,o]=ne.useState([]),[a,c]=ne.useState(null),[d,h]=ne.useState(new Date().toISOString().split("T")[0]),[f,u]=ne.useState(null),[p,m]=ne.useState([]),[g,x]=ne.useState(!1),[y,w]=ne.useState({present:0,absent:0,total:0}),[_,b]=ne.useState(!1);ne.useEffect(()=>{k()},[]),ne.useEffect(()=>{t&&c(t)},[t]),ne.useEffect(()=>{r&&h(r)},[r]),ne.useEffect(()=>{n&&u(n)},[n]);const k=async()=>{x(!0);const{data:z}=await _e.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});z&&z.length>0&&(o(z),c(z[0].id))};ne.useEffect(()=>{a&&S(a)},[a]);const S=async z=>{const{data:G}=await _e.from("sessions").select("*").eq("zone_id",z).order("start_time",{ascending:!0});if(G){m(G);const ae=new Date().toISOString().split("T")[0];if(d===ae){const le=new Date,Z=le.getHours().toString().padStart(2,"0")+":"+le.getMinutes().toString().padStart(2,"0")+":00",C=G.find(L=>Z>=L.start_time&&Z<=L.end_time);C?u(C.id):G.length>0&&u(G[0].id)}else G.length>0&&u(G[0].id)}};ne.useEffect(()=>{const z=new Date().toISOString().split("T")[0];if(d===z&&p.length>0){const G=new Date,ae=G.getHours().toString().padStart(2,"0")+":"+G.getMinutes().toString().padStart(2,"0")+":00",le=p.find(Z=>ae>=Z.start_time&&ae<=Z.end_time);le&&u(le.id)}},[d]),ne.useEffect(()=>{if(!i.current||!a||!f)return;s.current&&s.current.dispose(),i.current.innerHTML="";const z=document.createElement("canvas");i.current.appendChild(z);const G=new Ke.fabric.Canvas(z,{backgroundColor:"transparent",selection:!1,allowTouchScrolling:!0});s.current=G,(async()=>{await E(p)})();let le=!1,Z,C,L,B;G.on("mouse:down",U=>{var H,V,fe;const A=U.e,T=U.target;if((H=U.subTargets)==null?void 0:H.find(O=>O.name==="actionButton"||O.name==="actionLabel")){I(T);return}le=!0;const M=A.type==="touchstart"?A.touches[0]:A;Z=M.clientX,C=M.clientY;const Y=((V=i.current)==null?void 0:V.closest(".mobile-seatmap-container"))||((fe=i.current)==null?void 0:fe.parentElement);Y&&(L=Y.scrollLeft,B=Y.scrollTop)}),G.on("mouse:move",U=>{var H,V;if(!le)return;const A=U.e,T=A.type==="touchmove"?A.touches[0]:A,j=T.clientX-Z,M=T.clientY-C,Y=((H=i.current)==null?void 0:H.closest(".mobile-seatmap-container"))||((V=i.current)==null?void 0:V.parentElement);Y&&(Y.scrollLeft=L-j,Y.scrollTop=B-M)}),G.on("mouse:up",()=>{le=!1}),G.on("mouse:out",()=>{});const N=_e.channel("attendance_changes").on("postgres_changes",{event:"*",schema:"public",table:"attendance"},()=>{E(p)}).subscribe(U=>{b(U==="SUBSCRIBED")});return()=>{_e.removeChannel(N),G.dispose(),s.current=null}},[f,a,d,n,t,r,p]);const E=async z=>{if(!s.current||!a||!f)return;x(!0);const{data:G}=await _e.from("seats").select("*").eq("zone_id",a).order("global_number",{ascending:!0}),ae=d,le=D().split("T")[0],Z=ae===le,{data:C}=await _e.from("bookings").select(`
          *,
          profiles(full_name, username),
          attendance(id, status, timestamp_in, timestamp_out)
        `).eq("date",ae);if(C&&C.length>0){const ue=new Date(new Date().getTime()+324e5).toISOString().split("T")[1].substring(0,8),oe=[];if(C.forEach(he=>{const de=z.find(pe=>pe.id===he.session_id);if(!de)return;const ie=Array.isArray(he.attendance)?he.attendance[0]:he.attendance;if(ie&&(ie.status==="present"||ie.status==="late")&&!ie.timestamp_out){const pe=de.end_time.length===5?de.end_time+":00":de.end_time;(ae<le||Z&&pe<ue)&&oe.push({id:ie.id,timestamp_out:`${ae}T${pe}+09:00`,updated_at:new Date().toISOString()})}}),oe.length>0){const{error:he}=await _e.from("attendance").upsert(oe);he||oe.forEach(de=>{const ie=C.find(pe=>{var De,we;return(Array.isArray(pe.attendance)?(De=pe.attendance[0])==null?void 0:De.id:(we=pe.attendance)==null?void 0:we.id)===de.id});ie&&(Array.isArray(ie.attendance)?ie.attendance[0].timestamp_out=de.timestamp_out:ie.attendance.timestamp_out=de.timestamp_out)})}}s.current&&s.current.clear();const L=G||[];if(L.length===0){x(!1);return}const B=L.map(R=>R.pos_x).filter(R=>typeof R=="number"&&!isNaN(R)),N=L.map(R=>R.pos_y).filter(R=>typeof R=="number"&&!isNaN(R));if(B.length===0||N.length===0){x(!1);return}const U=Math.min(...B),A=Math.max(...L.map(R=>R.pos_x+(R.width||72)).filter(R=>!isNaN(R))),T=Math.min(...N),j=Math.max(...L.map(R=>R.pos_y+(R.height||72)).filter(R=>!isNaN(R))),M=A-U,Y=j-T,H=M+40,V=Y+40,fe=20-U,O=20-T;s.current&&(s.current.setDimensions({width:H,height:V}),i.current&&(i.current.style.width=`${H}px`,i.current.style.height=`${V}px`));let Q=z==null?void 0:z.find(R=>R.id===f);if(!Q&&Z){const R=new Date,ue=R.getHours().toString().padStart(2,"0")+":"+R.getMinutes().toString().padStart(2,"0")+":00";Q=z==null?void 0:z.find(oe=>ue>=oe.start_time&&ue<=oe.end_time)}let K=0;const te=((C==null?void 0:C.filter(R=>R.session_id===f))||[]).length;G.forEach(R=>{if(R.type==="structure"){F({...R,pos_x:R.pos_x+fe,pos_y:R.pos_y+O},null,null,[],null,z,!1);return}const ue=(C==null?void 0:C.filter(pe=>pe.seat_id===R.id))||[],oe=ue.find(pe=>pe.session_id===f),he=Array.isArray(oe==null?void 0:oe.attendance)?oe.attendance[0]:(oe==null?void 0:oe.attendance)||null;let de=(he==null?void 0:he.status)||"absent";if(Z&&oe&&!he&&f&&z){const pe=z.find(Se=>Se.id===f);if(pe){const Se=new Date,De=Se.getHours().toString().padStart(2,"0")+":"+Se.getMinutes().toString().padStart(2,"0")+":00";pe.end_time<De&&(de="absent")}}const ie=ue.length>0;oe&&de==="present"&&K++,F({...R,pos_x:R.pos_x+fe,pos_y:R.pos_y+O},oe,de,ue,Q,z,ie)}),w({present:K,absent:te-K,total:te,rate:te>0?Math.round(K/te*100):0}),x(!1)},F=(z,G,ae,le,Z,C,L,B)=>{if(z.type==="structure"){const O=new Ke.fabric.Rect({fill:"#E5E5EA",width:z.width||72,height:z.height||72,rx:12,ry:12,stroke:"#D1D1D6",strokeWidth:1}),Q=new Ke.fabric.IText(z.label||"",{fontSize:10,originX:"center",originY:"center",left:(z.width||72)/2,top:(z.height||72)/2,fill:"#AEAEB2",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),K=new Ke.fabric.Group([O,Q],{left:z.pos_x,top:z.pos_y,angle:z.rotation,selectable:!1,evented:!1,data:{...z}});s.current.add(K);return}const N=!!G,U=L,A=z.zone_color||"#5E5CE6",T=new Ke.fabric.Rect({fill:"#FFFFFF",width:71,height:71,rx:12,ry:12,stroke:"#E5E5EA",strokeWidth:1,left:.5,top:.5,originX:"left",originY:"top",selectable:!1}),j="M 0 12 Q 0 0 12 0 L 60 0 Q 72 0 72 12 L 72 18 L 0 18 z",M=new Ke.fabric.Path(j,{fill:A,strokeWidth:0,left:0,top:0,originX:"left",originY:"top",selectable:!1});let Y=[T,M];if(N){const O=Array.isArray(G==null?void 0:G.attendance)?G.attendance[0]:(G==null?void 0:G.attendance)||null,K=(ae==="present"||ae==="late")&&!(O!=null&&O.timestamp_out)?"#00FF00":"#FF3B30",ce=new Ke.fabric.Circle({radius:3,fill:K,left:58,top:9,originX:"center",originY:"center",selectable:!1,stroke:"rgba(255,255,255,0.8)",strokeWidth:1.5});Y.push(ce)}const H=new Ke.fabric.IText(z.display_number||z.seat_number,{fontSize:10,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"900",fill:"#ffffff",left:36,top:9,originX:"center",originY:"center",selectable:!1});if(Y.push(H),N){const O=G==null?void 0:G.profiles,Q=O?`${O.username?O.username+" ":""}${O.full_name}`:"  ",K=new Ke.fabric.IText(Q,{fontSize:10,textAlign:"center",originX:"center",originY:"center",left:36,top:34,fill:"#1C1C1E",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1});Y.push(K);const ce=Array.isArray(G==null?void 0:G.attendance)?G.attendance[0]:(G==null?void 0:G.attendance)||null,te=!!(ce!=null&&ce.timestamp_out),R=(ae==="present"||ae==="late")&&!te;let ue="",oe="",he="#8E8E93",de="#F2F2F7",ie=A,pe="#FFFFFF",Se=!1;R?(ue="",oe="",he="#FFFFFF",de=A,ie="#FFFFFF",pe=A,Se=!0):te&&(ue="",oe="",he="#1C1C1E",de="#F2F2F7",ie=A,pe="#FFFFFF");const De="M 0 50 L 36 50 L 36 72 L 6 72 Q 0 72 0 66 Z",we=new Ke.fabric.Path(De,{fill:de,selectable:!1}),ve=new Ke.fabric.IText(ue,{fontSize:8,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",fill:he,originX:"center",originY:"center",left:18,top:61,selectable:!1}),Ae="M 36 50 L 72 50 L 72 66 Q 72 72 66 72 L 36 72 Z",Ee=new Ke.fabric.Path(Ae,{fill:ie,stroke:Se?A:null,strokeWidth:Se?1:0,selectable:!1,hoverCursor:"pointer",name:"actionButton"}),Ne=new Ke.fabric.IText(oe,{fontSize:8,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",fill:pe,originX:"center",originY:"center",left:54,top:61,selectable:!1,name:"actionLabel"});Y.push(we,ve,Ee,Ne)}else{const O=new Ke.fabric.IText("",{fontSize:12,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",fill:"#E5E5EA",left:36,top:34,originX:"center",originY:"center",selectable:!1}),Q="M 0 50 L 72 50 L 72 60 Q 72 72 60 72 L 12 72 Q 0 72 0 60 Z",K=new Ke.fabric.Path(Q,{fill:"#F2F2F7",opacity:.3,selectable:!1}),ce=new Ke.fabric.IText("-",{fontSize:10,fill:"#AEAEB2",left:36,top:61,originX:"center",originY:"center",selectable:!1});Y.push(O,K,ce)}let V=1;N||(V=U?.4:.15);const fe=new Ke.fabric.Group(Y,{left:z.pos_x,top:z.pos_y,opacity:V,angle:z.rotation,data:{...z,booking:G,status:ae},selectable:!1,hoverCursor:N?"pointer":"default",subTargetCheck:!0});s.current.add(fe)},P=z=>{const G=new Date(d);G.setDate(G.getDate()+z),h(G.toISOString().split("T")[0])},D=()=>{const z=new Date,G=9*60*60*1e3;return new Date(z.getTime()+G).toISOString().replace("Z","+09:00")},I=async z=>{const{booking:G,status:ae}=z.data;if(!G)return;const le=p.find(B=>B.id===G.session_id);if(!le)return;const Z=Array.isArray(G.attendance)?G.attendance[0]:G.attendance||null,C=!!(Z!=null&&Z.timestamp_out);if((ae==="present"||ae==="late")&&!C){const{error:B}=await _e.from("attendance").update({timestamp_out:D(),updated_at:new Date().toISOString()}).eq("id",Z.id);B&&console.error("Error during check-out:",B),B||await E(p)}else if(C){const{error:B}=await _e.from("attendance").update({status:"absent",timestamp_in:null,timestamp_out:null,updated_at:new Date().toISOString()}).eq("id",Z.id);B&&console.error("Error during reset to absent:",B),B||await E(p)}else{const B=(le==null?void 0:le.start_time)||"00:00:00",N={booking_id:G.id,status:"present",timestamp_in:`${d}T${B}${B.length===5?":00":""}+09:00`,timestamp_out:null,updated_at:new Date().toISOString()};Z!=null&&Z.id&&(N.id=Z.id);const{error:U}=await _e.from("attendance").upsert(N,{onConflict:"booking_id"});U?console.error("Error during attendance upsert:",U):await E(p)}},X=()=>{const z=s.current.getObjects().map(le=>{var Z,C;return{ID:le.data.global_number,:le.data.display_number,:((C=(Z=le.data.booking)==null?void 0:Z.profiles)==null?void 0:C.full_name)||"",:le.data.status==="present"?"":"",:le.data.zone_name,:d}}),G=Es.json_to_sheet(z),ae=Es.book_new();Es.book_append_sheet(ae,G,""),C_(ae,`_${d}.xlsx`)};return v.jsxs("div",{className:`flex flex-col gap-4 w-full ${e?"min-h-fit":"h-full"} pt-[10px]`,children:[!e&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between px-2",children:[v.jsxs("div",{className:"flex items-center gap-4 ml-[10px] mt-[10px]",children:[v.jsx("div",{className:"flex gap-[10px] p-1 bg-gray-200/20 rounded-apple-md border border-white/40",children:l.map(z=>v.jsx("button",{onClick:()=>c(z.id),className:`h-7 px-4 rounded-apple-md text-[11px] font-black transition-all ios-tap flex items-center justify-center border-none ${a===z.id?"bg-white text-[#1C1C1E] shadow-sm":"text-ios-gray hover:text-[#1C1C1E] hover:bg-white/40"}`,children:z.name},z.id))}),v.jsxs("div",{className:"flex items-center bg-gray-200/20 p-1 rounded-apple-md border border-white/40 backdrop-blur-xl h-9",children:[v.jsx("button",{onClick:()=>P(-1),className:"h-7 px-2.5 rounded-apple-md hover:bg-white text-ios-gray hover:text-[#1C1C1E] transition-all text-[11px] font-black",children:"<"}),v.jsxs("span",{className:"px-3 text-[12px] font-black min-w-[100px] text-center text-[#1C1C1E]",children:[d.substring(5)," (",["","","","","","",""][new Date(d).getDay()],")"]}),v.jsx("button",{onClick:()=>P(1),className:"h-7 px-2.5 rounded-apple-md hover:bg-white text-ios-gray hover:text-[#1C1C1E] transition-all text-[11px] font-black",children:">"})]}),v.jsx("div",{className:"flex bg-gray-200/20 p-1 rounded-apple-md border border-white/40 h-9 box-border",children:p.map(z=>v.jsx("button",{onClick:()=>u(z.id),className:`h-7 px-5 rounded-apple-md text-[10.5px] font-black transition-all duration-300 ios-tap flex items-center justify-center ${f===z.id?"bg-white text-[#1C1C1E] shadow-sm":"text-ios-gray hover:text-[#1C1C1E] hover:bg-white/40"}`,children:z.name.toUpperCase()},z.id))})]}),v.jsxs("div",{className:"flex items-center gap-2 mr-[10px] mt-[10px]",children:[v.jsxs("button",{onClick:X,className:"flex items-center gap-2 bg-gray-50 hover:bg-gray-100 text-[#1C1C1E] h-8 px-4 rounded-[8px] text-[11px] font-black transition-all border border-gray-100 ios-tap",children:[v.jsx(ty,{className:"w-3.5 h-3.5 text-ios-blue"})," "]}),v.jsx("div",{className:"bg-white h-8 px-3 rounded-[8px] shadow-sm border border-gray-100 flex items-center justify-center",title:_?"    .":"   ...",children:v.jsx("div",{className:`w-2 h-2 rounded-full shrink-0 border border-white shadow-sm transition-all duration-500 ${_?"bg-emerald-500 animate-pulse shadow-emerald-500/50":"bg-rose-500 opacity-80"}`})})]})]}),v.jsxs("div",{className:"flex items-center gap-2 px-2 ml-[10px] mt-2",children:[v.jsxs("div",{className:"flex items-center gap-1.5 bg-white shadow-sm border border-gray-100 px-4 py-2 rounded-apple-md",children:[v.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 shadow-sm shadow-emerald-500/30"}),v.jsxs("span",{className:"text-[10px] font-black text-[#1C1C1E]",children:[" ",v.jsx("span",{className:"text-emerald-500",children:y.present})]})]}),v.jsxs("div",{className:"flex items-center gap-1.5 bg-white shadow-sm border border-gray-100 px-4 py-2 rounded-apple-md",children:[v.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-rose-500 shadow-sm shadow-rose-500/30"}),v.jsxs("span",{className:"text-[10px] font-black text-[#1C1C1E]",children:[" ",v.jsx("span",{className:"text-rose-500",children:y.absent})]})]}),v.jsxs("div",{className:"flex items-center gap-1.5 bg-white shadow-sm border border-gray-100 px-4 py-2 rounded-apple-md",children:[v.jsx(ql,{className:"w-3.5 h-3.5 text-ios-gray opacity-60"}),v.jsxs("span",{className:"text-[10px] font-black text-ios-gray",children:[" ",y.total]})]}),v.jsx("div",{className:"flex items-center gap-1.5 bg-white shadow-sm border border-gray-100 px-4 py-2 rounded-apple-md",children:v.jsxs("span",{className:"text-[10px] font-black text-ios-indigo",children:[" ",y.rate,"%"]})})]})]}),v.jsxs("div",{className:`${e?"w-full":"flex-1 flex flex-col w-full"} overflow-hidden relative`,children:[g&&v.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-30 flex items-center justify-center pointer-events-none",children:v.jsx("div",{className:"w-8 h-8 border-3 border-ios-indigo border-t-transparent rounded-full animate-spin"})}),v.jsx("div",{className:`${e?"w-full":"flex-1 w-full"} bg-white rounded-t-[6px] rounded-b-none border-0 overflow-hidden p-2.5 pb-0`,children:v.jsx("div",{ref:i,className:`relative overflow-hidden cursor-grab active:cursor-grabbing select-none scrollbar-hide ${e?"w-full min-h-[600px] h-auto touch-action-none":"flex-1 h-full"}`,style:e?{touchAction:"none"}:{}})})]})]})};function Ze(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function kt(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function ri(e,t){const r=Ze(e);return isNaN(t)?kt(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function sc(e,t){const r=Ze(e);if(isNaN(t))return kt(e,NaN);if(!t)return r;const n=r.getDate(),i=kt(e,r.getTime());i.setMonth(r.getMonth()+t+1,0);const s=i.getDate();return n>=s?i:(r.setFullYear(i.getFullYear(),i.getMonth(),n),r)}function qI(e,t){const r=+Ze(e);return kt(e,r+t)}const O_=6048e5,KI=864e5,Sf=6e4,Dp=36e5,JI=1e3;let QI={};function ra(){return QI}function rr(e,t){var o,a,c,d;const r=ra(),n=(t==null?void 0:t.weekStartsOn)??((a=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:a.weekStartsOn)??r.weekStartsOn??((d=(c=r.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??0,i=Ze(e),s=i.getDay(),l=(s<n?7:0)+s-n;return i.setDate(i.getDate()-l),i.setHours(0,0,0,0),i}function to(e){return rr(e,{weekStartsOn:1})}function F_(e){const t=Ze(e),r=t.getFullYear(),n=kt(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const i=to(n),s=kt(e,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);const l=to(s);return t.getTime()>=i.getTime()?r+1:t.getTime()>=l.getTime()?r:r-1}function hi(e){const t=Ze(e);return t.setHours(0,0,0,0),t}function Vu(e){const t=Ze(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function ZI(e,t){const r=hi(e),n=hi(t),i=+r-Vu(r),s=+n-Vu(n);return Math.round((i-s)/KI)}function eM(e){const t=F_(e),r=kt(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),to(r)}function Ro(e,t){return qI(e,t*Sf)}function Cf(e,t){const r=t*7;return ri(e,r)}function tM(e){return kt(e,Date.now())}function Ji(e,t){const r=hi(e),n=hi(t);return+r==+n}function rM(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function eu(e){if(!rM(e)&&typeof e!="number")return!1;const t=Ze(e);return!isNaN(Number(t))}function zl(e){const t=Ze(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function na(e,t){const r=Ze(e.start),n=Ze(e.end);let i=+r>+n;const s=i?+r:+n,l=i?n:r;l.setHours(0,0,0,0);let o=1;const a=[];for(;+l<=s;)a.push(Ze(l)),l.setDate(l.getDate()+o),l.setHours(0,0,0,0);return i?a.reverse():a}function nM(e,t){const r=Ze(e.start),n=Ze(e.end);let i=+r>+n;const s=i?+r:+n,l=i?n:r;l.setHours(0,0,0,0),l.setDate(1);let o=1;const a=[];for(;+l<=s;)a.push(Ze(l)),l.setMonth(l.getMonth()+o);return i?a.reverse():a}function iM(e){const t=Ze(e),r=t.getMonth(),n=r-r%3;return t.setMonth(n,1),t.setHours(0,0,0,0),t}function sM(e,t){const r=Ze(e.start),n=Ze(e.end);let i=+r>+n;const s=rr(i?n:r,t),l=rr(i?r:n,t);s.setHours(15),l.setHours(15);const o=+l.getTime();let a=s,c=(t==null?void 0:t.step)??1;if(!c)return[];c<0&&(c=-c,i=!i);const d=[];for(;+a<=o;)a.setHours(0),d.push(Ze(a)),a=Cf(a,c),a.setHours(15);return i?d.reverse():d}function ro(e){const t=Ze(e);return t.setDate(1),t.setHours(0,0,0,0),t}function aM(e){const t=Ze(e),r=kt(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function xi(e,t){var o,a,c,d;const r=ra(),n=(t==null?void 0:t.weekStartsOn)??((a=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:a.weekStartsOn)??r.weekStartsOn??((d=(c=r.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??0,i=Ze(e),s=i.getDay(),l=(s<n?-7:0)+6-(s-n);return i.setDate(i.getDate()+l),i.setHours(23,59,59,999),i}function oM(e){const t=Ze(e),r=t.getMonth(),n=r-r%3+3;return t.setMonth(n,0),t.setHours(23,59,59,999),t}const lM={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},cM=(e,t,r)=>{let n;const i=lM[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function $a(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const uM={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},fM={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},hM={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},dM={date:$a({formats:uM,defaultWidth:"full"}),time:$a({formats:fM,defaultWidth:"full"}),dateTime:$a({formats:hM,defaultWidth:"full"})},pM={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},gM=(e,t,r,n)=>pM[e];function Gn(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let i;if(n==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):l;i=e.formattingValues[o]||e.formattingValues[l]}else{const l=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;i=e.values[o]||e.values[l]}const s=e.argumentCallback?e.argumentCallback(t):t;return i[s]}}const mM={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},xM={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},vM={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},yM={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},wM={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},_M={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},bM=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},kM={ordinalNumber:bM,era:Gn({values:mM,defaultWidth:"wide"}),quarter:Gn({values:xM,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Gn({values:vM,defaultWidth:"wide"}),day:Gn({values:yM,defaultWidth:"wide"}),dayPeriod:Gn({values:wM,defaultWidth:"wide",formattingValues:_M,defaultFormattingWidth:"wide"})};function qn(e){return(t,r={})=>{const n=r.width,i=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(i);if(!s)return null;const l=s[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],a=Array.isArray(o)?CM(o,h=>h.test(l)):SM(o,h=>h.test(l));let c;c=e.valueCallback?e.valueCallback(a):a,c=r.valueCallback?r.valueCallback(c):c;const d=t.slice(l.length);return{value:c,rest:d}}}function SM(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function CM(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function j_(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const i=n[0],s=t.match(e.parsePattern);if(!s)return null;let l=e.valueCallback?e.valueCallback(s[0]):s[0];l=r.valueCallback?r.valueCallback(l):l;const o=t.slice(i.length);return{value:l,rest:o}}}const TM=/^(\d+)(th|st|nd|rd)?/i,EM=/\d+/i,NM={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},AM={any:[/^b/i,/^(a|c)/i]},OM={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},FM={any:[/1/i,/2/i,/3/i,/4/i]},jM={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},PM={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},DM={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},RM={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},IM={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},MM={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},LM={ordinalNumber:j_({matchPattern:TM,parsePattern:EM,valueCallback:e=>parseInt(e,10)}),era:qn({matchPatterns:NM,defaultMatchWidth:"wide",parsePatterns:AM,defaultParseWidth:"any"}),quarter:qn({matchPatterns:OM,defaultMatchWidth:"wide",parsePatterns:FM,defaultParseWidth:"any",valueCallback:e=>e+1}),month:qn({matchPatterns:jM,defaultMatchWidth:"wide",parsePatterns:PM,defaultParseWidth:"any"}),day:qn({matchPatterns:DM,defaultMatchWidth:"wide",parsePatterns:RM,defaultParseWidth:"any"}),dayPeriod:qn({matchPatterns:IM,defaultMatchWidth:"any",parsePatterns:MM,defaultParseWidth:"any"})},P_={code:"en-US",formatDistance:cM,formatLong:dM,formatRelative:gM,localize:kM,match:LM,options:{weekStartsOn:0,firstWeekContainsDate:1}};function BM(e){const t=Ze(e);return ZI(t,aM(t))+1}function D_(e){const t=Ze(e),r=+to(t)-+eM(t);return Math.round(r/O_)+1}function Rp(e,t){var d,h,f,u;const r=Ze(e),n=r.getFullYear(),i=ra(),s=(t==null?void 0:t.firstWeekContainsDate)??((h=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??i.firstWeekContainsDate??((u=(f=i.locale)==null?void 0:f.options)==null?void 0:u.firstWeekContainsDate)??1,l=kt(e,0);l.setFullYear(n+1,0,s),l.setHours(0,0,0,0);const o=rr(l,t),a=kt(e,0);a.setFullYear(n,0,s),a.setHours(0,0,0,0);const c=rr(a,t);return r.getTime()>=o.getTime()?n+1:r.getTime()>=c.getTime()?n:n-1}function UM(e,t){var o,a,c,d;const r=ra(),n=(t==null?void 0:t.firstWeekContainsDate)??((a=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:a.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(c=r.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??1,i=Rp(e,t),s=kt(e,0);return s.setFullYear(i,0,n),s.setHours(0,0,0,0),rr(s,t)}function R_(e,t){const r=Ze(e),n=+rr(r,t)-+UM(r,t);return Math.round(n/O_)+1}function dt(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Fi={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return dt(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):dt(r+1,2)},d(e,t){return dt(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return dt(e.getHours()%12||12,t.length)},H(e,t){return dt(e.getHours(),t.length)},m(e,t){return dt(e.getMinutes(),t.length)},s(e,t){return dt(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),i=Math.trunc(n*Math.pow(10,r-3));return dt(i,t.length)}},pa={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Px={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),i=n>0?n:1-n;return r.ordinalNumber(i,{unit:"year"})}return Fi.y(e,t)},Y:function(e,t,r,n){const i=Rp(e,n),s=i>0?i:1-i;if(t==="YY"){const l=s%100;return dt(l,2)}return t==="Yo"?r.ordinalNumber(s,{unit:"year"}):dt(s,t.length)},R:function(e,t){const r=F_(e);return dt(r,t.length)},u:function(e,t){const r=e.getFullYear();return dt(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return dt(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return dt(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Fi.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return dt(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const i=R_(e,n);return t==="wo"?r.ordinalNumber(i,{unit:"week"}):dt(i,t.length)},I:function(e,t,r){const n=D_(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):dt(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Fi.d(e,t)},D:function(e,t,r){const n=BM(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):dt(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return dt(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});case"eeee":default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return dt(s,t.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});case"cccc":default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),i=n===0?7:n;switch(t){case"i":return String(i);case"ii":return dt(i,t.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let i;switch(n===12?i=pa.noon:n===0?i=pa.midnight:i=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let i;switch(n>=17?i=pa.evening:n>=12?i=pa.afternoon:n>=4?i=pa.morning:i=pa.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Fi.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Fi.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):dt(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):dt(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Fi.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Fi.s(e,t)},S:function(e,t){return Fi.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return Rx(n);case"XXXX":case"XX":return vs(n);case"XXXXX":case"XXX":default:return vs(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return Rx(n);case"xxxx":case"xx":return vs(n);case"xxxxx":case"xxx":default:return vs(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Dx(n,":");case"OOOO":default:return"GMT"+vs(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Dx(n,":");case"zzzz":default:return"GMT"+vs(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return dt(n,t.length)},T:function(e,t,r){const n=e.getTime();return dt(n,t.length)}};function Dx(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=Math.trunc(n/60),s=n%60;return s===0?r+String(i):r+String(i)+t+dt(s,2)}function Rx(e,t){return e%60===0?(e>0?"-":"+")+dt(Math.abs(e)/60,2):vs(e,t)}function vs(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=dt(Math.trunc(n/60),2),s=dt(n%60,2);return r+i+t+s}const Ix=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},I_=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},WM=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return Ix(e,t);let s;switch(n){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",Ix(n,t)).replace("{{time}}",I_(i,t))},$d={p:I_,P:WM},zM=/^D+$/,HM=/^Y+$/,$M=["D","DD","YY","YYYY"];function M_(e){return zM.test(e)}function L_(e){return HM.test(e)}function Vd(e,t,r){const n=VM(e,t,r);if(console.warn(n),$M.includes(e))throw new RangeError(n)}function VM(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const XM=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,YM=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,GM=/^'([^]*?)'?$/,qM=/''/g,KM=/[a-zA-Z]/;function je(e,t,r){var d,h,f,u,p,m,g,x;const n=ra(),i=(r==null?void 0:r.locale)??n.locale??P_,s=(r==null?void 0:r.firstWeekContainsDate)??((h=(d=r==null?void 0:r.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(f=n.locale)==null?void 0:f.options)==null?void 0:u.firstWeekContainsDate)??1,l=(r==null?void 0:r.weekStartsOn)??((m=(p=r==null?void 0:r.locale)==null?void 0:p.options)==null?void 0:m.weekStartsOn)??n.weekStartsOn??((x=(g=n.locale)==null?void 0:g.options)==null?void 0:x.weekStartsOn)??0,o=Ze(e);if(!eu(o))throw new RangeError("Invalid time value");let a=t.match(YM).map(y=>{const w=y[0];if(w==="p"||w==="P"){const _=$d[w];return _(y,i.formatLong)}return y}).join("").match(XM).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const w=y[0];if(w==="'")return{isToken:!1,value:JM(y)};if(Px[w])return{isToken:!0,value:y};if(w.match(KM))throw new RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");return{isToken:!1,value:y}});i.localize.preprocessor&&(a=i.localize.preprocessor(o,a));const c={firstWeekContainsDate:s,weekStartsOn:l,locale:i};return a.map(y=>{if(!y.isToken)return y.value;const w=y.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&L_(w)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&M_(w))&&Vd(w,t,String(e));const _=Px[w[0]];return _(o,w,i.localize,c)}).join("")}function JM(e){const t=e.match(GM);return t?t[1].replace(qM,"'"):e}function QM(){return Object.assign({},ra())}function ZM(e){let r=Ze(e).getDay();return r===0&&(r=7),r}function Xd(e,t){const r=Ze(e),n=Ze(t);return r.getTime()>n.getTime()}function tl(e,t){const r=Ze(e),n=Ze(t);return+r<+n}function e8(e,t){const r=t instanceof Date?kt(t,0):new t(0);return r.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),r.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),r}const t8=10;class B_{constructor(){Ue(this,"subPriority",0)}validate(t,r){return!0}}class r8 extends B_{constructor(t,r,n,i,s){super(),this.value=t,this.validateValue=r,this.setValue=n,this.priority=i,s&&(this.subPriority=s)}validate(t,r){return this.validateValue(t,this.value,r)}set(t,r,n){return this.setValue(t,r,this.value,n)}}class n8 extends B_{constructor(){super(...arguments);Ue(this,"priority",t8);Ue(this,"subPriority",-1)}set(r,n){return n.timestampIsSet?r:kt(r,e8(r,Date))}}class ft{run(t,r,n,i){const s=this.parse(t,r,n,i);return s?{setter:new r8(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(t,r,n){return!0}}class i8 extends ft{constructor(){super(...arguments);Ue(this,"priority",140);Ue(this,"incompatibleTokens",["R","u","t","T"])}parse(r,n,i){switch(n){case"G":case"GG":case"GGG":return i.era(r,{width:"abbreviated"})||i.era(r,{width:"narrow"});case"GGGGG":return i.era(r,{width:"narrow"});case"GGGG":default:return i.era(r,{width:"wide"})||i.era(r,{width:"abbreviated"})||i.era(r,{width:"narrow"})}}set(r,n,i){return n.era=i,r.setFullYear(i,0,1),r.setHours(0,0,0,0),r}}const Xt={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Kn={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Yt(e,t){return e&&{value:t(e.value),rest:e.rest}}function Pt(e,t){const r=t.match(e);return r?{value:parseInt(r[0],10),rest:t.slice(r[0].length)}:null}function Jn(e,t){const r=t.match(e);if(!r)return null;if(r[0]==="Z")return{value:0,rest:t.slice(1)};const n=r[1]==="+"?1:-1,i=r[2]?parseInt(r[2],10):0,s=r[3]?parseInt(r[3],10):0,l=r[5]?parseInt(r[5],10):0;return{value:n*(i*Dp+s*Sf+l*JI),rest:t.slice(r[0].length)}}function U_(e){return Pt(Xt.anyDigitsSigned,e)}function Ht(e,t){switch(e){case 1:return Pt(Xt.singleDigit,t);case 2:return Pt(Xt.twoDigits,t);case 3:return Pt(Xt.threeDigits,t);case 4:return Pt(Xt.fourDigits,t);default:return Pt(new RegExp("^\\d{1,"+e+"}"),t)}}function Xu(e,t){switch(e){case 1:return Pt(Xt.singleDigitSigned,t);case 2:return Pt(Xt.twoDigitsSigned,t);case 3:return Pt(Xt.threeDigitsSigned,t);case 4:return Pt(Xt.fourDigitsSigned,t);default:return Pt(new RegExp("^-?\\d{1,"+e+"}"),t)}}function Ip(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function W_(e,t){const r=t>0,n=r?t:1-t;let i;if(n<=50)i=e||100;else{const s=n+50,l=Math.trunc(s/100)*100,o=e>=s%100;i=e+l-(o?100:0)}return r?i:1-i}function z_(e){return e%400===0||e%4===0&&e%100!==0}class s8 extends ft{constructor(){super(...arguments);Ue(this,"priority",130);Ue(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(r,n,i){const s=l=>({year:l,isTwoDigitYear:n==="yy"});switch(n){case"y":return Yt(Ht(4,r),s);case"yo":return Yt(i.ordinalNumber(r,{unit:"year"}),s);default:return Yt(Ht(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,i){const s=r.getFullYear();if(i.isTwoDigitYear){const o=W_(i.year,s);return r.setFullYear(o,0,1),r.setHours(0,0,0,0),r}const l=!("era"in n)||n.era===1?i.year:1-i.year;return r.setFullYear(l,0,1),r.setHours(0,0,0,0),r}}class a8 extends ft{constructor(){super(...arguments);Ue(this,"priority",130);Ue(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(r,n,i){const s=l=>({year:l,isTwoDigitYear:n==="YY"});switch(n){case"Y":return Yt(Ht(4,r),s);case"Yo":return Yt(i.ordinalNumber(r,{unit:"year"}),s);default:return Yt(Ht(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,i,s){const l=Rp(r,s);if(i.isTwoDigitYear){const a=W_(i.year,l);return r.setFullYear(a,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),rr(r,s)}const o=!("era"in n)||n.era===1?i.year:1-i.year;return r.setFullYear(o,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),rr(r,s)}}class o8 extends ft{constructor(){super(...arguments);Ue(this,"priority",130);Ue(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(r,n){return Xu(n==="R"?4:n.length,r)}set(r,n,i){const s=kt(r,0);return s.setFullYear(i,0,4),s.setHours(0,0,0,0),to(s)}}class l8 extends ft{constructor(){super(...arguments);Ue(this,"priority",130);Ue(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(r,n){return Xu(n==="u"?4:n.length,r)}set(r,n,i){return r.setFullYear(i,0,1),r.setHours(0,0,0,0),r}}class c8 extends ft{constructor(){super(...arguments);Ue(this,"priority",120);Ue(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,i){switch(n){case"Q":case"QQ":return Ht(n.length,r);case"Qo":return i.ordinalNumber(r,{unit:"quarter"});case"QQQ":return i.quarter(r,{width:"abbreviated",context:"formatting"})||i.quarter(r,{width:"narrow",context:"formatting"});case"QQQQQ":return i.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return i.quarter(r,{width:"wide",context:"formatting"})||i.quarter(r,{width:"abbreviated",context:"formatting"})||i.quarter(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=1&&n<=4}set(r,n,i){return r.setMonth((i-1)*3,1),r.setHours(0,0,0,0),r}}class u8 extends ft{constructor(){super(...arguments);Ue(this,"priority",120);Ue(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,i){switch(n){case"q":case"qq":return Ht(n.length,r);case"qo":return i.ordinalNumber(r,{unit:"quarter"});case"qqq":return i.quarter(r,{width:"abbreviated",context:"standalone"})||i.quarter(r,{width:"narrow",context:"standalone"});case"qqqqq":return i.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return i.quarter(r,{width:"wide",context:"standalone"})||i.quarter(r,{width:"abbreviated",context:"standalone"})||i.quarter(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=1&&n<=4}set(r,n,i){return r.setMonth((i-1)*3,1),r.setHours(0,0,0,0),r}}class f8 extends ft{constructor(){super(...arguments);Ue(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);Ue(this,"priority",110)}parse(r,n,i){const s=l=>l-1;switch(n){case"M":return Yt(Pt(Xt.month,r),s);case"MM":return Yt(Ht(2,r),s);case"Mo":return Yt(i.ordinalNumber(r,{unit:"month"}),s);case"MMM":return i.month(r,{width:"abbreviated",context:"formatting"})||i.month(r,{width:"narrow",context:"formatting"});case"MMMMM":return i.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(r,{width:"wide",context:"formatting"})||i.month(r,{width:"abbreviated",context:"formatting"})||i.month(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=11}set(r,n,i){return r.setMonth(i,1),r.setHours(0,0,0,0),r}}class h8 extends ft{constructor(){super(...arguments);Ue(this,"priority",110);Ue(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(r,n,i){const s=l=>l-1;switch(n){case"L":return Yt(Pt(Xt.month,r),s);case"LL":return Yt(Ht(2,r),s);case"Lo":return Yt(i.ordinalNumber(r,{unit:"month"}),s);case"LLL":return i.month(r,{width:"abbreviated",context:"standalone"})||i.month(r,{width:"narrow",context:"standalone"});case"LLLLL":return i.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(r,{width:"wide",context:"standalone"})||i.month(r,{width:"abbreviated",context:"standalone"})||i.month(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=11}set(r,n,i){return r.setMonth(i,1),r.setHours(0,0,0,0),r}}function d8(e,t,r){const n=Ze(e),i=R_(n,r)-t;return n.setDate(n.getDate()-i*7),n}class p8 extends ft{constructor(){super(...arguments);Ue(this,"priority",100);Ue(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(r,n,i){switch(n){case"w":return Pt(Xt.week,r);case"wo":return i.ordinalNumber(r,{unit:"week"});default:return Ht(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,i,s){return rr(d8(r,i,s),s)}}function g8(e,t){const r=Ze(e),n=D_(r)-t;return r.setDate(r.getDate()-n*7),r}class m8 extends ft{constructor(){super(...arguments);Ue(this,"priority",100);Ue(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(r,n,i){switch(n){case"I":return Pt(Xt.week,r);case"Io":return i.ordinalNumber(r,{unit:"week"});default:return Ht(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,i){return to(g8(r,i))}}const x8=[31,28,31,30,31,30,31,31,30,31,30,31],v8=[31,29,31,30,31,30,31,31,30,31,30,31];class y8 extends ft{constructor(){super(...arguments);Ue(this,"priority",90);Ue(this,"subPriority",1);Ue(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(r,n,i){switch(n){case"d":return Pt(Xt.date,r);case"do":return i.ordinalNumber(r,{unit:"date"});default:return Ht(n.length,r)}}validate(r,n){const i=r.getFullYear(),s=z_(i),l=r.getMonth();return s?n>=1&&n<=v8[l]:n>=1&&n<=x8[l]}set(r,n,i){return r.setDate(i),r.setHours(0,0,0,0),r}}class w8 extends ft{constructor(){super(...arguments);Ue(this,"priority",90);Ue(this,"subpriority",1);Ue(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(r,n,i){switch(n){case"D":case"DD":return Pt(Xt.dayOfYear,r);case"Do":return i.ordinalNumber(r,{unit:"date"});default:return Ht(n.length,r)}}validate(r,n){const i=r.getFullYear();return z_(i)?n>=1&&n<=366:n>=1&&n<=365}set(r,n,i){return r.setMonth(0,i),r.setHours(0,0,0,0),r}}function Mp(e,t,r){var h,f,u,p;const n=ra(),i=(r==null?void 0:r.weekStartsOn)??((f=(h=r==null?void 0:r.locale)==null?void 0:h.options)==null?void 0:f.weekStartsOn)??n.weekStartsOn??((p=(u=n.locale)==null?void 0:u.options)==null?void 0:p.weekStartsOn)??0,s=Ze(e),l=s.getDay(),a=(t%7+7)%7,c=7-i,d=t<0||t>6?t-(l+c)%7:(a+c)%7-(l+c)%7;return ri(s,d)}class _8 extends ft{constructor(){super(...arguments);Ue(this,"priority",90);Ue(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(r,n,i){switch(n){case"E":case"EE":case"EEE":return i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"});case"EEEEE":return i.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"});case"EEEE":default:return i.day(r,{width:"wide",context:"formatting"})||i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,i,s){return r=Mp(r,i,s),r.setHours(0,0,0,0),r}}class b8 extends ft{constructor(){super(...arguments);Ue(this,"priority",90);Ue(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(r,n,i,s){const l=o=>{const a=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+a};switch(n){case"e":case"ee":return Yt(Ht(n.length,r),l);case"eo":return Yt(i.ordinalNumber(r,{unit:"day"}),l);case"eee":return i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"});case"eeeee":return i.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"});case"eeee":default:return i.day(r,{width:"wide",context:"formatting"})||i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,i,s){return r=Mp(r,i,s),r.setHours(0,0,0,0),r}}class k8 extends ft{constructor(){super(...arguments);Ue(this,"priority",90);Ue(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(r,n,i,s){const l=o=>{const a=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+a};switch(n){case"c":case"cc":return Yt(Ht(n.length,r),l);case"co":return Yt(i.ordinalNumber(r,{unit:"day"}),l);case"ccc":return i.day(r,{width:"abbreviated",context:"standalone"})||i.day(r,{width:"short",context:"standalone"})||i.day(r,{width:"narrow",context:"standalone"});case"ccccc":return i.day(r,{width:"narrow",context:"standalone"});case"cccccc":return i.day(r,{width:"short",context:"standalone"})||i.day(r,{width:"narrow",context:"standalone"});case"cccc":default:return i.day(r,{width:"wide",context:"standalone"})||i.day(r,{width:"abbreviated",context:"standalone"})||i.day(r,{width:"short",context:"standalone"})||i.day(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=6}set(r,n,i,s){return r=Mp(r,i,s),r.setHours(0,0,0,0),r}}function S8(e,t){const r=Ze(e),n=ZM(r),i=t-n;return ri(r,i)}class C8 extends ft{constructor(){super(...arguments);Ue(this,"priority",90);Ue(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(r,n,i){const s=l=>l===0?7:l;switch(n){case"i":case"ii":return Ht(n.length,r);case"io":return i.ordinalNumber(r,{unit:"day"});case"iii":return Yt(i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"}),s);case"iiiii":return Yt(i.day(r,{width:"narrow",context:"formatting"}),s);case"iiiiii":return Yt(i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"}),s);case"iiii":default:return Yt(i.day(r,{width:"wide",context:"formatting"})||i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"}),s)}}validate(r,n){return n>=1&&n<=7}set(r,n,i){return r=S8(r,i),r.setHours(0,0,0,0),r}}class T8 extends ft{constructor(){super(...arguments);Ue(this,"priority",80);Ue(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(r,n,i){switch(n){case"a":case"aa":case"aaa":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaaa":return i.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return i.dayPeriod(r,{width:"wide",context:"formatting"})||i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,i){return r.setHours(Ip(i),0,0,0),r}}class E8 extends ft{constructor(){super(...arguments);Ue(this,"priority",80);Ue(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(r,n,i){switch(n){case"b":case"bb":case"bbb":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbbb":return i.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return i.dayPeriod(r,{width:"wide",context:"formatting"})||i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,i){return r.setHours(Ip(i),0,0,0),r}}class N8 extends ft{constructor(){super(...arguments);Ue(this,"priority",80);Ue(this,"incompatibleTokens",["a","b","t","T"])}parse(r,n,i){switch(n){case"B":case"BB":case"BBB":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBBB":return i.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return i.dayPeriod(r,{width:"wide",context:"formatting"})||i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,i){return r.setHours(Ip(i),0,0,0),r}}class A8 extends ft{constructor(){super(...arguments);Ue(this,"priority",70);Ue(this,"incompatibleTokens",["H","K","k","t","T"])}parse(r,n,i){switch(n){case"h":return Pt(Xt.hour12h,r);case"ho":return i.ordinalNumber(r,{unit:"hour"});default:return Ht(n.length,r)}}validate(r,n){return n>=1&&n<=12}set(r,n,i){const s=r.getHours()>=12;return s&&i<12?r.setHours(i+12,0,0,0):!s&&i===12?r.setHours(0,0,0,0):r.setHours(i,0,0,0),r}}class O8 extends ft{constructor(){super(...arguments);Ue(this,"priority",70);Ue(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(r,n,i){switch(n){case"H":return Pt(Xt.hour23h,r);case"Ho":return i.ordinalNumber(r,{unit:"hour"});default:return Ht(n.length,r)}}validate(r,n){return n>=0&&n<=23}set(r,n,i){return r.setHours(i,0,0,0),r}}class F8 extends ft{constructor(){super(...arguments);Ue(this,"priority",70);Ue(this,"incompatibleTokens",["h","H","k","t","T"])}parse(r,n,i){switch(n){case"K":return Pt(Xt.hour11h,r);case"Ko":return i.ordinalNumber(r,{unit:"hour"});default:return Ht(n.length,r)}}validate(r,n){return n>=0&&n<=11}set(r,n,i){return r.getHours()>=12&&i<12?r.setHours(i+12,0,0,0):r.setHours(i,0,0,0),r}}class j8 extends ft{constructor(){super(...arguments);Ue(this,"priority",70);Ue(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(r,n,i){switch(n){case"k":return Pt(Xt.hour24h,r);case"ko":return i.ordinalNumber(r,{unit:"hour"});default:return Ht(n.length,r)}}validate(r,n){return n>=1&&n<=24}set(r,n,i){const s=i<=24?i%24:i;return r.setHours(s,0,0,0),r}}class P8 extends ft{constructor(){super(...arguments);Ue(this,"priority",60);Ue(this,"incompatibleTokens",["t","T"])}parse(r,n,i){switch(n){case"m":return Pt(Xt.minute,r);case"mo":return i.ordinalNumber(r,{unit:"minute"});default:return Ht(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,i){return r.setMinutes(i,0,0),r}}class D8 extends ft{constructor(){super(...arguments);Ue(this,"priority",50);Ue(this,"incompatibleTokens",["t","T"])}parse(r,n,i){switch(n){case"s":return Pt(Xt.second,r);case"so":return i.ordinalNumber(r,{unit:"second"});default:return Ht(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,i){return r.setSeconds(i,0),r}}class R8 extends ft{constructor(){super(...arguments);Ue(this,"priority",30);Ue(this,"incompatibleTokens",["t","T"])}parse(r,n){const i=s=>Math.trunc(s*Math.pow(10,-n.length+3));return Yt(Ht(n.length,r),i)}set(r,n,i){return r.setMilliseconds(i),r}}class I8 extends ft{constructor(){super(...arguments);Ue(this,"priority",10);Ue(this,"incompatibleTokens",["t","T","x"])}parse(r,n){switch(n){case"X":return Jn(Kn.basicOptionalMinutes,r);case"XX":return Jn(Kn.basic,r);case"XXXX":return Jn(Kn.basicOptionalSeconds,r);case"XXXXX":return Jn(Kn.extendedOptionalSeconds,r);case"XXX":default:return Jn(Kn.extended,r)}}set(r,n,i){return n.timestampIsSet?r:kt(r,r.getTime()-Vu(r)-i)}}class M8 extends ft{constructor(){super(...arguments);Ue(this,"priority",10);Ue(this,"incompatibleTokens",["t","T","X"])}parse(r,n){switch(n){case"x":return Jn(Kn.basicOptionalMinutes,r);case"xx":return Jn(Kn.basic,r);case"xxxx":return Jn(Kn.basicOptionalSeconds,r);case"xxxxx":return Jn(Kn.extendedOptionalSeconds,r);case"xxx":default:return Jn(Kn.extended,r)}}set(r,n,i){return n.timestampIsSet?r:kt(r,r.getTime()-Vu(r)-i)}}class L8 extends ft{constructor(){super(...arguments);Ue(this,"priority",40);Ue(this,"incompatibleTokens","*")}parse(r){return U_(r)}set(r,n,i){return[kt(r,i*1e3),{timestampIsSet:!0}]}}class B8 extends ft{constructor(){super(...arguments);Ue(this,"priority",20);Ue(this,"incompatibleTokens","*")}parse(r){return U_(r)}set(r,n,i){return[kt(r,i),{timestampIsSet:!0}]}}const U8={G:new i8,y:new s8,Y:new a8,R:new o8,u:new l8,Q:new c8,q:new u8,M:new f8,L:new h8,w:new p8,I:new m8,d:new y8,D:new w8,E:new _8,e:new b8,c:new k8,i:new C8,a:new T8,b:new E8,B:new N8,h:new A8,H:new O8,K:new F8,k:new j8,m:new P8,s:new D8,S:new R8,X:new I8,x:new M8,t:new L8,T:new B8},W8=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,z8=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,H8=/^'([^]*?)'?$/,$8=/''/g,V8=/\S/,X8=/[a-zA-Z]/;function Co(e,t,r,n){var m,g,x,y;const i=QM(),s=i.locale??P_,l=i.firstWeekContainsDate??((g=(m=i.locale)==null?void 0:m.options)==null?void 0:g.firstWeekContainsDate)??1,o=i.weekStartsOn??((y=(x=i.locale)==null?void 0:x.options)==null?void 0:y.weekStartsOn)??0,a={firstWeekContainsDate:l,weekStartsOn:o,locale:s},c=[new n8],d=t.match(z8).map(w=>{const _=w[0];if(_ in $d){const b=$d[_];return b(w,s.formatLong)}return w}).join("").match(W8),h=[];for(let w of d){L_(w)&&Vd(w,t,e),M_(w)&&Vd(w,t,e);const _=w[0],b=U8[_];if(b){const{incompatibleTokens:k}=b;if(Array.isArray(k)){const E=h.find(F=>k.includes(F.token)||F.token===_);if(E)throw new RangeError(`The format string mustn't contain \`${E.fullToken}\` and \`${w}\` at the same time`)}else if(b.incompatibleTokens==="*"&&h.length>0)throw new RangeError(`The format string mustn't contain \`${w}\` and any other token at the same time`);h.push({token:_,fullToken:w});const S=b.run(e,w,s.match,a);if(!S)return kt(r,NaN);c.push(S.setter),e=S.rest}else{if(_.match(X8))throw new RangeError("Format string contains an unescaped latin alphabet character `"+_+"`");if(w==="''"?w="'":_==="'"&&(w=Y8(w)),e.indexOf(w)===0)e=e.slice(w.length);else return kt(r,NaN)}}if(e.length>0&&V8.test(e))return kt(r,NaN);const f=c.map(w=>w.priority).sort((w,_)=>_-w).filter((w,_,b)=>b.indexOf(w)===_).map(w=>c.filter(_=>_.priority===w).sort((_,b)=>b.subPriority-_.subPriority)).map(w=>w[0]);let u=Ze(r);if(isNaN(u.getTime()))return kt(r,NaN);const p={};for(const w of f){if(!w.validate(u,a))return kt(r,NaN);const _=w.set(u,p,a);Array.isArray(_)?(u=_[0],Object.assign(p,_[1])):u=_}return kt(r,u)}function Y8(e){return e.match(H8)[1].replace($8,"'")}function G8(e){return+Ze(e)<Date.now()}function Yd(e,t){const r=Ze(e),n=Ze(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function Lp(e){return Ji(e,tM(e))}function Hl(e,t){const r=+Ze(e),[n,i]=[+Ze(t.start),+Ze(t.end)].sort((s,l)=>s-l);return r>=n&&r<=i}function Gd(e,t){return ri(e,-t)}function jt(e,t){const n=Q8(e);let i;if(n.date){const a=Z8(n.date,2);i=e6(a.restDateString,a.year)}if(!i||isNaN(i.getTime()))return new Date(NaN);const s=i.getTime();let l=0,o;if(n.time&&(l=t6(n.time),isNaN(l)))return new Date(NaN);if(n.timezone){if(o=r6(n.timezone),isNaN(o))return new Date(NaN)}else{const a=new Date(s+l),c=new Date(0);return c.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),c.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),c}return new Date(s+l+o)}const Wc={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},q8=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,K8=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,J8=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Q8(e){const t={},r=e.split(Wc.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],Wc.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Wc.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const i=Wc.timezone.exec(n);i?(t.time=n.replace(i[1],""),t.timezone=i[1]):t.time=n}return t}function Z8(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const i=n[1]?parseInt(n[1]):null,s=n[2]?parseInt(n[2]):null;return{year:s===null?i:s*100,restDateString:e.slice((n[1]||n[2]).length)}}function e6(e,t){if(t===null)return new Date(NaN);const r=e.match(q8);if(!r)return new Date(NaN);const n=!!r[4],i=To(r[1]),s=To(r[2])-1,l=To(r[3]),o=To(r[4]),a=To(r[5])-1;if(n)return o6(t,o,a)?n6(t,o,a):new Date(NaN);{const c=new Date(0);return!s6(t,s,l)||!a6(t,i)?new Date(NaN):(c.setUTCFullYear(t,s,Math.max(i,l)),c)}}function To(e){return e?parseInt(e):1}function t6(e){const t=e.match(K8);if(!t)return NaN;const r=Ch(t[1]),n=Ch(t[2]),i=Ch(t[3]);return l6(r,n,i)?r*Dp+n*Sf+i*1e3:NaN}function Ch(e){return e&&parseFloat(e.replace(",","."))||0}function r6(e){if(e==="Z")return 0;const t=e.match(J8);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;return c6(n,i)?r*(n*Dp+i*Sf):NaN}function n6(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const i=n.getUTCDay()||7,s=(t-1)*7+r+1-i;return n.setUTCDate(n.getUTCDate()+s),n}const i6=[31,null,31,30,31,30,31,31,30,31,30,31];function H_(e){return e%400===0||e%4===0&&e%100!==0}function s6(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(i6[t]||(H_(e)?29:28))}function a6(e,t){return t>=1&&t<=(H_(e)?366:365)}function o6(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function l6(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function c6(e,t){return t>=0&&t<=59}function u6(e,t){const r=Ze(e);return r.setDate(t),r}function Tf(e,t){return sc(e,-1)}function Mx(e,t){return Ro(e,-5)}function $_(e,t){return Cf(e,-1)}const f6={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},h6=(e,t,r)=>{let n;const i=f6[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?n+" ":n+" ":n},d6={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},p6={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},g6={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},m6={date:$a({formats:d6,defaultWidth:"full"}),time:$a({formats:p6,defaultWidth:"full"}),dateTime:$a({formats:g6,defaultWidth:"full"})},x6={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},v6=(e,t,r,n)=>x6[e],y6={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},w6={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},_6={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},b6={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},k6={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},S6={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},C6=(e,t)=>{const r=Number(e);switch(String(t==null?void 0:t.unit)){case"minute":case"second":return String(r);case"date":return r+"";default:return r+""}},T6={ordinalNumber:C6,era:Gn({values:y6,defaultWidth:"wide"}),quarter:Gn({values:w6,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Gn({values:_6,defaultWidth:"wide"}),day:Gn({values:b6,defaultWidth:"wide"}),dayPeriod:Gn({values:k6,defaultWidth:"wide",formattingValues:S6,defaultFormattingWidth:"wide"})},E6=/^(\d+)(|)?/i,N6=/\d+/i,A6={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},O6={any:[/^(bc|)/i,/^(ad|)/i]},F6={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},j6={any:[/1/i,/2/i,/3/i,/4/i]},P6={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},D6={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},R6={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},I6={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},M6={any:/^(am|pm|||||||)/i},L6={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},B6={ordinalNumber:j_({matchPattern:E6,parsePattern:N6,valueCallback:e=>parseInt(e,10)}),era:qn({matchPatterns:A6,defaultMatchWidth:"wide",parsePatterns:O6,defaultParseWidth:"any"}),quarter:qn({matchPatterns:F6,defaultMatchWidth:"wide",parsePatterns:j6,defaultParseWidth:"any",valueCallback:e=>e+1}),month:qn({matchPatterns:P6,defaultMatchWidth:"wide",parsePatterns:D6,defaultParseWidth:"any"}),day:qn({matchPatterns:R6,defaultMatchWidth:"wide",parsePatterns:I6,defaultParseWidth:"any"}),dayPeriod:qn({matchPatterns:M6,defaultMatchWidth:"any",parsePatterns:L6,defaultParseWidth:"any"})},vr={code:"ko",formatDistance:h6,formatLong:m6,formatRelative:v6,localize:T6,match:B6,options:{weekStartsOn:0,firstWeekContainsDate:1}},U6=({onSave:e,onCancel:t})=>{const r=ne.useRef(null),[n,i]=ne.useState(!1),[s,l]=ne.useState(!1);ne.useEffect(()=>{const u=r.current;if(!u)return;const p=u.getContext("2d"),m=window.devicePixelRatio||1,g=u.getBoundingClientRect();u.width=g.width*m,u.height=g.height*m,p.scale(m,m),p.strokeStyle="black",p.lineWidth=10,p.lineCap="round"},[]);const o=u=>{const m=r.current.getBoundingClientRect(),g=u.touches?u.touches[0].clientX:u.clientX,x=u.touches?u.touches[0].clientY:u.clientY;return{x:g-m.left,y:x-m.top}},a=u=>{i(!0);const{x:p,y:m}=o(u),g=r.current.getContext("2d");g.strokeStyle="black",g.lineWidth=10,g.lineCap="round",g.beginPath(),g.moveTo(p,m)},c=u=>{if(!n)return;const{x:p,y:m}=o(u),g=r.current.getContext("2d");g.lineTo(p,m),g.stroke(),l(!0)},d=()=>{i(!1)},h=()=>{const u=r.current;u.getContext("2d").clearRect(0,0,u.width,u.height),l(!1)},f=()=>{if(!s){alert("  .");return}r.current.toBlob(p=>{e(p)},"image/png")};return v.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-fade-in",onClick:t,children:v.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden animate-spring-up",onClick:u=>u.stopPropagation(),children:[v.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[v.jsxs("h4",{className:"text-sm font-black text-[#1C1C1E] flex items-center gap-2",children:[v.jsx(H0,{className:"w-4 h-4 text-ios-indigo"}),"  "]}),v.jsx("button",{onClick:t,className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:v.jsx(Os,{className:"w-5 h-5"})})]}),v.jsxs("div",{className:"p-6 bg-white flex flex-col items-center gap-4",children:[v.jsx("p",{className:"text-xs text-ios-gray mb-2",children:"    ."}),v.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-xl bg-gray-50 touch-none overflow-hidden relative w-full h-[200px]",children:v.jsx("canvas",{ref:r,style:{width:"100%",height:"100%"},onMouseDown:a,onMouseMove:c,onMouseUp:d,onMouseLeave:d,onTouchStart:a,onTouchMove:c,onTouchEnd:d})})]}),v.jsxs("div",{className:"p-4 border-t border-gray-100 flex gap-3 bg-gray-50",children:[v.jsx("button",{onClick:h,className:"flex-1 py-3 bg-white border border-gray-200 text-[#1C1C1E] rounded-xl text-xs font-bold hover:bg-gray-50 transition-all",children:""}),v.jsxs("button",{onClick:f,className:"flex-[2] py-3 bg-[#1C1C1E] text-white rounded-xl text-xs font-bold hover:bg-gray-800 shadow-lg transition-all flex items-center justify-center gap-2",children:[v.jsx(bn,{className:"w-4 h-4"}),"  "]})]})]})})},W6=()=>{const[e,t]=ne.useState(new Date),[r,n]=ne.useState([]),[i,s]=ne.useState([]),[l,o]=ne.useState(null),[a,c]=ne.useState(!1),[d,h]=ne.useState(null),[f,u]=ne.useState([]),[p,m]=ne.useState([]),[g,x]=ne.useState([]),w=e.getMonth()+1<3?e.getFullYear()-1:e.getFullYear(),[_,b]=ne.useState(null),[k,S]=ne.useState(null),[E,F]=ne.useState(null),[P,D]=ne.useState(!1),[I,X]=ne.useState(null),[z,G]=ne.useState(""),[ae,le]=ne.useState(!1);ne.useEffect(()=>{L(),Z()},[]),ne.useEffect(()=>{l&&C()},[w,l]),ne.useEffect(()=>{l&&B()},[e,l]);const Z=async()=>{const{data:O}=await _e.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});O&&O.length>0&&(s(O),o(O[0].id))},C=async()=>{const[O,Q,K]=await Promise.all([_e.from("operation_quarters").select("*").eq("academic_year",w).order("quarter",{ascending:!0}),_e.from("operation_exceptions").select("*"),_e.from("sessions").select("*").eq("zone_id",l).order("start_time",{ascending:!0})]);O.data&&u(O.data),Q.data&&x(Q.data);const{data:ce}=await _e.from("session_operating_days").select("session_id, day_of_week").in("session_id",(K.data||[]).map(te=>te.id)).eq("is_active",!0);m(ce||[])},L=async()=>{const{data:{user:O}}=await _e.auth.getUser();if(O){const{data:Q}=await _e.from("profiles").select("*").eq("id",O.id).single();h({...O,profile:Q})}},B=async()=>{if(!l)return;c(!0);const O=ro(e).toISOString(),Q=zl(e).toISOString(),{data:K,error:ce}=await _e.from("supervision_assignments").select("*").eq("zone_id",l).gte("date",O).lte("date",Q).order("created_at",{ascending:!0});K&&n(K),c(!1)},N=async()=>{if(!z.trim()||!_||!l)return;const O=je(_.date,"yyyy-MM-dd"),{error:Q}=await _e.from("supervision_assignments").insert([{date:O,supervisor_name:z.trim(),teacher_id:null,zone_id:l}]);Q?alert("  : "+Q.message):(G(""),b(null),B())},U=async()=>{if(!z.trim()||!k)return;const{error:O}=await _e.from("supervision_assignments").update({supervisor_name:z.trim()}).eq("id",k.id);O?alert(" : "+O.message):(G(""),S(null),B())},A=O=>{if(!O)return null;const Q=O.split("/signatures/");return Q.length>1?Q[1]:null},T=async(O,Q)=>{if(Q.stopPropagation(),!confirm(" ?   ."))return;const K=r.find(te=>te.id===O);if(K!=null&&K.signature_url){const te=A(K.signature_url);te&&await _e.storage.from("signatures").remove([te])}const{error:ce}=await _e.from("supervision_assignments").delete().eq("id",O);ce||B()},j=async O=>{if(!E)return;const Q=r.find(oe=>oe.id===E.assignmentId);if(Q!=null&&Q.signature_url){const oe=A(Q.signature_url);oe&&await _e.storage.from("signatures").remove([oe])}const K=`sig_${E.assignmentId}_${Date.now()}.png`,{data:ce,error:te}=await _e.storage.from("signatures").upload(K,O,{contentType:"image/png",upsert:!0});if(te){alert("  : "+te.message);return}const{data:{publicUrl:R}}=_e.storage.from("signatures").getPublicUrl(K),{error:ue}=await _e.from("supervision_assignments").update({signature_url:R}).eq("id",E.assignmentId);ue?alert("  : "+ue.message):(F(null),B())},M=()=>{D(!0)},Y=async O=>{if(!l)return;c(!0);const{data:Q,error:K}=await _e.from("supervision_assignments").select("*").eq("zone_id",l).gte("date",O.start_date).lte("date",O.end_date).order("date",{ascending:!0});if(K){alert("  : "+K.message),c(!1);return}X({quarter:O,assignments:Q||[],operatingRules:p,exceptions:g}),D(!1),c(!1),setTimeout(()=>{window.print()},500)},H=()=>v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsxs("div",{className:"flex items-center gap-6",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("h3",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:je(e,"yyyy M")}),v.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-xl border border-gray-200",children:[v.jsx("button",{onClick:()=>t(Tf(e)),className:"p-1.5 hover:bg-white rounded-lg text-ios-gray hover:text-[#1C1C1E] transition-all ios-tap shadow-sm hover:shadow",children:v.jsx(bi,{className:"w-4 h-4"})}),v.jsx("button",{onClick:()=>t(sc(e,1)),className:"p-1.5 hover:bg-white rounded-lg text-ios-gray hover:text-[#1C1C1E] transition-all ios-tap shadow-sm hover:shadow",children:v.jsx(an,{className:"w-4 h-4"})})]})]}),v.jsx("div",{className:"flex bg-gray-100 p-1 rounded-xl border border-gray-200",children:i.map(O=>v.jsx("button",{onClick:()=>o(O.id),className:`px-4 py-1.5 rounded-lg text-xs font-black transition-all ios-tap ${l===O.id?"bg-white text-[#1C1C1E] shadow-sm":"text-ios-gray hover:text-[#1C1C1E]"}`,children:O.name},O.id))})]}),v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group select-none",children:[v.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${ae?"bg-[#1C1C1E] border-[#1C1C1E]":"bg-white border-gray-300 group-hover:border-gray-400"}`,children:ae&&v.jsx(bn,{className:"w-3 h-3 text-white"})}),v.jsx("input",{type:"checkbox",checked:ae,onChange:O=>le(O.target.checked),className:"hidden"}),v.jsx("span",{className:"text-xs font-bold text-ios-gray group-hover:text-[#1C1C1E] transition-colors",children:" "})]}),v.jsxs("button",{onClick:M,className:"flex items-center gap-2 bg-[#1C1C1E] text-white px-4 py-2 rounded-lg font-bold text-xs transition-all shadow-lg hover:bg-gray-800 hover:shadow-xl ios-tap",children:[v.jsx(Nu,{className:"w-3.5 h-3.5"}),"  "]})]})]}),V=()=>{const O=["","","","","","",""],Q=ae?O:O.filter((K,ce)=>ce!==0&&ce!==6);return v.jsx("div",{className:`grid ${ae?"grid-cols-7":"grid-cols-5"} mb-2 border-b border-gray-100`,children:Q.map((K,ce)=>v.jsx("div",{className:`py-3 text-[10px] font-black uppercase text-center tracking-widest ${ae&&ce===0?"text-ios-rose":ae&&ce===6?"text-ios-indigo":"text-ios-gray"}`,children:K},ce))})},fe=()=>{const O=ro(e),Q=zl(O),K=rr(O),ce=xi(Q),te=na({start:K,end:ce});return v.jsx("div",{className:`grid ${ae?"grid-cols-7":"grid-cols-5"} gap-px bg-gray-100 border border-gray-100 rounded-[12px] overflow-hidden shadow-sm`,children:te.filter(R=>ae||R.getDay()!==0&&R.getDay()!==6).map((R,ue)=>{var We;const oe=Lp(R),he=Yd(R,O),de=R.getDay(),ie=je(R,"yyyy-MM-dd"),pe=r.filter(Te=>Te.date===ie),Se=g.find(Te=>Te.exception_date===ie),De=f.find(Te=>Te.start_date&&Te.end_date&&Hl(R,{start:jt(Te.start_date),end:jt(Te.end_date)})),we=p.filter(Te=>Te.day_of_week===de),ve=De&&!Se&&we.length>0,Ae=we.length<=2,Ee=ve?Ae?1:2:0,Ne=((We=d==null?void 0:d.profile)==null?void 0:We.role)==="admin",Ie=Ne||oe;return v.jsxs("div",{className:`h-[200px] p-2 flex flex-col gap-2 transition-colors border-b border-r border-gray-100 ${he?ve?"bg-white":"bg-gray-50":"bg-gray-50/50 opacity-40"}`,children:[v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsx("span",{className:`text-[12px] font-black ${oe?"w-6 h-6 text-ios-indigo border-2 border-ios-indigo rounded-full flex items-center justify-center -mt-1 -ml-1 bg-white":de===0?"text-ios-rose":de===6?"text-ios-indigo":"text-[#1C1C1E]"}`,children:je(R,"d")}),Ne&&ve&&pe.length<Ee&&v.jsx("button",{onClick:()=>b({date:R}),className:"w-5 h-5 flex items-center justify-center rounded-full bg-[#1C1C1E] text-white hover:bg-gray-800 transition-all ios-tap shadow-sm",title:" ",children:v.jsx(yl,{className:"w-3 h-3"})})]}),v.jsx("div",{className:"flex-1 flex flex-col gap-1.5 overflow-y-auto scrollbar-hide",children:pe.map(Te=>{var et;return v.jsxs("div",{className:"relative group bg-gray-50 rounded-[8px] p-2 border border-dashed border-gray-200 hover:border-ios-indigo/30 transition-all",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("span",{className:"text-[11px] font-bold text-[#1C1C1E]",children:Te.supervisor_name}),Ne&&v.jsxs("div",{className:"opacity-0 group-hover:opacity-100 flex items-center transition-opacity",children:[v.jsx("button",{onClick:vt=>{vt.stopPropagation(),G(Te.supervisor_name),S({id:Te.id,name:Te.supervisor_name,date:R})},className:"p-1 text-gray-400 hover:text-ios-indigo transition-colors",title:" ",children:v.jsx(BS,{className:"w-3 h-3"})}),v.jsx("button",{onClick:vt=>T(Te.id,vt),className:"p-1 text-gray-400 hover:text-ios-rose transition-colors",title:"",children:v.jsx(ts,{className:"w-3 h-3"})})]})]}),Te.signature_url?v.jsxs("div",{className:"relative h-8 flex items-center",children:[v.jsx("img",{src:Te.signature_url,alt:"",className:"h-full object-contain opacity-80"}),Ne&&v.jsx("button",{onClick:()=>F({assignmentId:Te.id}),className:"absolute inset-0 bg-black/5 opacity-0 hover:opacity-100 flex items-center justify-center text-[9px] text-[#1C1C1E] font-black rounded backdrop-blur-[1px]",children:""})]}):v.jsx("div",{className:"h-8 flex items-center justify-center",children:Ne||((et=d==null?void 0:d.profile)==null?void 0:et.full_name)===Te.supervisor_name&&Ie?v.jsxs("button",{onClick:()=>F({assignmentId:Te.id}),className:"w-full h-full border border-dashed border-ios-indigo/30 rounded flex items-center justify-center gap-1 text-[9px] text-ios-indigo font-bold hover:bg-ios-indigo/5 transition-colors",children:[v.jsx(H0,{className:"w-3 h-3"})," "]}):!oe&&G8(R)?v.jsx("span",{className:"text-[9px] text-red-500 font-bold",children:""}):v.jsx("span",{className:"text-[9px] text-gray-300 font-medium",children:" "})})]},Te.id)})})]},ue)})})};return v.jsxs("div",{className:"h-full flex flex-col p-6 animate-spring-up overflow-hidden relative print:hidden",children:[v.jsxs("div",{className:"flex-none",children:[H(),V()]}),v.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide -mr-2 pr-2",children:fe()}),_&&v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm p-4 animate-fade-in",onClick:()=>b(null),children:v.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-xs overflow-hidden animate-spring-up",onClick:O=>O.stopPropagation(),children:[v.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[v.jsxs("h4",{className:"text-sm font-black text-[#1C1C1E]",children:[je(_.date,"M d"),"  "]}),v.jsx("button",{onClick:()=>b(null),className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:v.jsx(Os,{className:"w-4 h-4"})})]}),v.jsxs("div",{className:"p-4 space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-[10px] font-bold text-ios-gray uppercase tracking-wider mb-2",children:"  "}),v.jsx("input",{type:"text",value:z,onChange:O=>G(O.target.value),placeholder:" ",className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 text-sm font-bold text-[#1C1C1E] focus:outline-none focus:ring-2 focus:ring-ios-indigo/50 transition-all",onKeyDown:O=>O.key==="Enter"&&N(),autoFocus:!0})]}),v.jsx("button",{onClick:N,className:"w-full py-3 bg-[#1C1C1E] text-white rounded-xl text-xs font-bold hover:bg-gray-800 shadow-lg transition-all",children:""})]})]})}),k&&v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm p-4 animate-fade-in",onClick:()=>S(null),children:v.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-xs overflow-hidden animate-spring-up",onClick:O=>O.stopPropagation(),children:[v.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[v.jsx("h4",{className:"text-sm font-black text-[#1C1C1E]",children:"  "}),v.jsx("button",{onClick:()=>S(null),className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:v.jsx(Os,{className:"w-4 h-4"})})]}),v.jsxs("div",{className:"p-4 space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-[10px] font-bold text-ios-gray uppercase tracking-wider mb-2",children:" "}),v.jsx("input",{type:"text",value:z,onChange:O=>G(O.target.value),placeholder:" ",className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 text-sm font-bold text-[#1C1C1E] focus:outline-none focus:ring-2 focus:ring-ios-indigo/50 transition-all",onKeyDown:O=>O.key==="Enter"&&U(),autoFocus:!0})]}),v.jsx("button",{onClick:U,className:"w-full py-3 bg-[#1C1C1E] text-white rounded-xl text-xs font-bold hover:bg-gray-800 shadow-lg transition-all",children:" "})]})]})}),E&&v.jsx(U6,{onSave:j,onCancel:()=>F(null)}),P&&v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm p-4 animate-fade-in",onClick:()=>D(!1),children:v.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm overflow-hidden animate-spring-up",onClick:O=>O.stopPropagation(),children:[v.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[v.jsxs("h4",{className:"text-sm font-black text-[#1C1C1E] flex items-center gap-2",children:[v.jsx(Nu,{className:"w-4 h-4 text-ios-indigo"}),"  "]}),v.jsx("button",{onClick:()=>D(!1),className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:v.jsx(Os,{className:"w-5 h-5"})})]}),v.jsxs("div",{className:"p-4 max-h-[60vh] overflow-y-auto",children:[v.jsx("p",{className:"text-xs text-ios-gray mb-4",children:" /  ."}),v.jsxs("div",{className:"grid gap-2",children:[f.map(O=>v.jsx("button",{onClick:()=>Y(O),className:"w-full p-3 rounded-xl border border-gray-100 hover:border-ios-indigo/50 hover:bg-ios-indigo/5 transition-all text-left group",children:v.jsxs("span",{className:"text-sm font-bold text-[#1C1C1E] group-hover:text-ios-indigo",children:[O.quarter_name?`${O.quarter_name}: `:"",O.start_date," ~ ",O.end_date]})},O.id)),f.length===0&&v.jsx("div",{className:"text-center py-6 text-gray-300 text-xs",children:"   ."})]})]})]})}),I&&Jv.createPortal(v.jsxs("div",{id:"print-root",className:"bg-white text-black hidden print:block",children:[v.jsx("style",{children:`
                            @media print {
                                @page { size: A4 portrait; margin: 0; }
                                body { 
                                    margin: 0 !important;
                                    padding: 0 !important;
                                    background-color: white !important;
                                    font-family: 'Malgun Gothic', 'Dotum', 'Apple SD Gothic Neo', sans-serif !important;
                                    -webkit-print-color-adjust: exact !important;
                                    print-color-adjust: exact !important;
                                    color: #000000 !important;
                                }
                                body > #root {
                                    display: none !important;
                                }
                                body > #print-root {
                                    display: block !important;
                                    width: 210mm !important;
                                    min-height: 297mm !important;
                                    padding: 10mm !important;
                                    box-sizing: border-box !important;
                                    background-color: white !important;
                                    font-family: 'Malgun Gothic', 'Dotum', 'Apple SD Gothic Neo', sans-serif !important;
                                }
                                /* Force solid borders */
                                * {
                                    border-color: #000000 !important;
                                    border-style: solid !important;
                                }
                                /* Ensure text is strictly black */
                                .print-text-black {
                                    color: #000000 !important;
                                }
                            }
                            #print-root {
                                display: none;
                            }
                        `}),v.jsxs("div",{className:"flex flex-col w-full h-full bg-white relative",children:[v.jsxs("div",{className:"flex-none mb-2 text-center",children:[v.jsx("h1",{className:"text-[20pt] font-black tracking-widest mb-1 underline decoration-2 underline-offset-4 text-black",children:"  "}),v.jsxs("div",{className:"flex justify-between items-end border-b-2 border-black pb-1 mb-1 relative",children:[v.jsxs("span",{className:"text-[9pt] font-bold text-black absolute left-0 bottom-1",children:[I.quarter.quarter_name," (",I.quarter.start_date," ~ ",I.quarter.end_date,")"]}),v.jsx("span",{className:"w-full text-center text-[8pt] text-transparent",children:"."}),v.jsxs("span",{className:"text-[8pt] text-black absolute right-0 bottom-1",children:[": ",je(new Date,"yyyy. MM. dd.")]})]})]}),v.jsx("div",{className:"flex-1 flex gap-2 items-start justify-center w-full",children:(()=>{try{const O=jt(I.quarter.start_date),Q=jt(I.quarter.end_date);return!eu(O)||!eu(Q)?v.jsx("div",{className:"w-full text-center p-10 text-red-500 font-bold",children:"   ."}):nM({start:O,end:Q}).map((K,ce)=>{const te=Array.from({length:31},(R,ue)=>{const oe=ue+1;try{const he=u6(K,oe);return!eu(he)||!Yd(he,K)?null:he}catch{return null}});return v.jsx("div",{className:"flex-1 h-full flex flex-col min-w-0",children:v.jsxs("table",{className:"w-full border-collapse table-fixed border border-black",children:[v.jsxs("colgroup",{children:[v.jsx("col",{style:{width:"12%"}}),v.jsx("col",{style:{width:"22%"}}),v.jsx("col",{style:{width:"22%"}}),v.jsx("col",{style:{width:"22%"}}),v.jsx("col",{style:{width:"22%"}})]}),v.jsxs("thead",{children:[v.jsx("tr",{className:"bg-[#E5E7EB]",children:v.jsx("th",{colSpan:5,className:"border border-black text-center font-bold py-1 text-[10pt] text-black",children:je(K,"M")})}),v.jsxs("tr",{className:"bg-[#F3F4F6] text-[7pt] text-black font-bold h-[8mm]",children:[v.jsx("th",{rowSpan:2,className:"border border-black text-center align-middle",children:""}),v.jsx("th",{colSpan:2,className:"border border-black text-center align-middle h-[4mm]",children:" 1"}),v.jsx("th",{colSpan:2,className:"border border-black text-center align-middle h-[4mm]",children:" 2"})]}),v.jsxs("tr",{className:"bg-[#F3F4F6] text-[7pt] text-black font-bold h-[4mm]",children:[v.jsx("th",{className:"border border-black text-center align-middle",children:""}),v.jsx("th",{className:"border border-black text-center align-middle",children:""}),v.jsx("th",{className:"border border-black text-center align-middle",children:""}),v.jsx("th",{className:"border border-black text-center align-middle",children:""})]})]}),v.jsx("tbody",{children:te.map((R,ue)=>{if(!R)return v.jsxs("tr",{className:"h-[7mm] bg-gray-100/30",children:[v.jsx("td",{className:"border border-black"}),v.jsx("td",{className:"border border-black"}),v.jsx("td",{className:"border border-black"}),v.jsx("td",{className:"border border-black"}),v.jsx("td",{className:"border border-black"})]},ue);const oe=je(R,"yyyy-MM-dd"),he=je(R,"E",{locale:vr}),de=I.assignments.filter(ve=>ve.date===oe),ie=de[0],pe=de[1],Se=I.exceptions.find(ve=>ve.exception_date===oe),we=Hl(R,{start:jt(I.quarter.start_date),end:jt(I.quarter.end_date)})&&!Se&&I.operatingRules.some(ve=>ve.day_of_week===R.getDay());return v.jsxs("tr",{className:"h-[7mm] text-[7pt] text-black",children:[v.jsxs("td",{className:`border border-black text-center font-bold tracking-tighter align-middle p-0 ${he===""?"text-blue-700":he===""?"text-red-600":"text-black"}`,children:[je(R,"d"),"(",he,")"]}),v.jsx("td",{className:"border border-black text-center break-all align-middle p-0.5",children:we?(ie==null?void 0:ie.supervisor_name)||"":"-"}),v.jsx("td",{className:"border border-black text-center align-middle p-0.5",children:we&&(ie==null?void 0:ie.signature_url)&&v.jsx("img",{src:ie.signature_url,className:"max-h-[18px] w-auto mx-auto object-contain",alt:""})}),v.jsx("td",{className:"border border-black text-center break-all align-middle p-0.5",children:we&&(pe==null?void 0:pe.supervisor_name)||""}),v.jsx("td",{className:"border border-black text-center align-middle p-0.5",children:we&&(pe==null?void 0:pe.signature_url)&&v.jsx("img",{src:pe.signature_url,className:"max-h-[18px] w-auto mx-auto object-contain",alt:""})})]},ue)})})]})},ce)})}catch{return v.jsx("div",{className:"w-full text-center text-red-500",children:"  "})}})()}),v.jsx("div",{className:"mt-2 text-center text-[9pt] font-bold flex-none text-black",children:"      .  "})]})]}),document.body)]})},z6=({onSave:e,onCancel:t,teacherName:r})=>{const n=ne.useRef(null),[i,s]=ne.useState(!1),[l,o]=ne.useState(!1);ne.useEffect(()=>{const u=n.current;if(!u)return;const p=u.getContext("2d"),m=window.devicePixelRatio||1,g=u.getBoundingClientRect();u.width=g.width*m,u.height=g.height*m,p.scale(m,m),p.strokeStyle="#1C1C1E",p.lineWidth=10,p.lineCap="round",p.lineJoin="round"},[]);const a=u=>{const m=n.current.getBoundingClientRect(),g=u.touches?u.touches[0].clientX:u.clientX,x=u.touches?u.touches[0].clientY:u.clientY;return{x:g-m.left,y:x-m.top}},c=u=>{s(!0);const{x:p,y:m}=a(u),g=n.current.getContext("2d");g.beginPath(),g.moveTo(p,m)},d=u=>{if(!i)return;const{x:p,y:m}=a(u),g=n.current.getContext("2d");g.lineTo(p,m),g.stroke(),o(!0)},h=()=>s(!1),f=()=>{if(!l)return alert("  .");n.current.toBlob(p=>e(p),"image/png")};return v.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-md flex flex-col justify-end",children:v.jsxs("div",{className:"bg-white/90 backdrop-blur-2xl rounded-t-[32px] p-6 mobile-slide-up h-[70vh] border-t border-white/20",children:[v.jsxs("div",{className:"flex justify-between items-center mb-8",children:[v.jsxs("div",{children:[v.jsxs("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:[r,""]}),v.jsx("p",{className:"text-ios-gray text-sm font-bold opacity-70",children:"     ."})]}),v.jsx("button",{onClick:t,className:"p-2.5 bg-gray-100/50 rounded-apple-md ios-tap",children:v.jsx(Os,{className:"w-5 h-5 text-ios-gray"})})]}),v.jsx("div",{className:"mobile-signature-pad mb-8",children:v.jsx("canvas",{ref:n,style:{width:"100%",height:"100%"},onMouseDown:c,onMouseMove:d,onMouseUp:h,onMouseLeave:h,onTouchStart:c,onTouchMove:d,onTouchEnd:h})}),v.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[v.jsx("button",{onClick:()=>{n.current.getContext("2d").clearRect(0,0,n.current.width,n.current.height),o(!1)},className:"py-4 bg-gray-100/80 text-[#1C1C1E] rounded-apple-md font-black ios-tap",children:" "}),v.jsx("button",{onClick:f,className:"py-4 bg-[#007AFF] text-white rounded-apple-md font-black ios-tap shadow-lg shadow-blue-500/20",children:" "})]})]})})},H6=({onLogout:e,currentUser:t})=>{const r=ne.useRef(null),[n,i]=ne.useState("menu"),[s,l]=ne.useState(!0),[o,a]=ne.useState([]),[c,d]=ne.useState(null),[h,f]=ne.useState(!1),[u,p]=ne.useState([]),m={A:ne.useRef(null),B:ne.useRef(null),C:ne.useRef(null)},[g,x]=ne.useState([]),[y,w]=ne.useState(null),[_,b]=ne.useState([]),[k,S]=ne.useState(null),[E,F]=ne.useState(je(new Date,"yyyy-MM-dd")),P=je(new Date,"yyyy-MM-dd");ne.useEffect(()=>{D()},[]),ne.useEffect(()=>{I()},[E]),ne.useEffect(()=>{k&&X()},[k]),ne.useEffect(()=>{y&&(n==="attendance"||n==="seatmap")&&z()},[y,n,E,k]);const D=async()=>{l(!0);const{data:T}=await _e.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});T&&T.length>0&&(b(T),S(T[0].id)),I()},I=async()=>{const{data:T,error:j}=await _e.from("supervision_assignments").select("*").eq("date",E);T&&a(T),l(!1)},X=async()=>{var j;if(!k)return;const{data:T}=await _e.from("sessions").select("*").eq("zone_id",k).order("start_time",{ascending:!0});if(T){x(T);const M=je(new Date,"HH:mm:ss"),Y=T.find(H=>M>=H.start_time&&M<=H.end_time);w(Y?Y.id:(j=T[0])==null?void 0:j.id)}},z=async()=>{l(!0);const{data:T,error:j}=await _e.from("seats").select("*, zone_color").order("seat_number",{ascending:!0});if(j){console.error("Error fetching seats:",j),l(!1);return}const{data:M,error:Y}=await _e.from("bookings").select(`
                id, seat_id, session_id,
                profiles (full_name, username, grade),
                attendance (id, status, timestamp_in, timestamp_out)
            `).eq("date",E);if(T){const H=T.map(V=>{var K,ce,te,R;const fe=(M||[]).find(ue=>ue.seat_id===V.id&&ue.session_id===y),O=(M||[]).some(ue=>ue.seat_id===V.id),Q=(K=fe==null?void 0:fe.attendance)==null?void 0:K[0];return{seat_id:V.id,seat_number:V.seat_number,display_number:V.display_number,zone_name:V.zone_name,zone_color:V.zone_color,booking_id:fe==null?void 0:fe.id,full_name:(ce=fe==null?void 0:fe.profiles)==null?void 0:ce.full_name,username:(te=fe==null?void 0:fe.profiles)==null?void 0:te.username,grade:(R=fe==null?void 0:fe.profiles)==null?void 0:R.grade,attendance_id:Q==null?void 0:Q.id,status:(Q==null?void 0:Q.status)||"absent",timestamp_in:Q==null?void 0:Q.timestamp_in,timestamp_out:Q==null?void 0:Q.timestamp_out,is_active:!!fe,is_booked_today:O}});H.sort((V,fe)=>(V.seat_number||"").localeCompare(fe.seat_number||"",void 0,{numeric:!0,sensitivity:"base"})),p(H)}l(!1)},G=async T=>{const j=`sig_duty_${c.id}_${Date.now()}.png`,{error:M}=await _e.storage.from("signatures").upload(j,T,{contentType:"image/png"});if(M)return alert("  ");const{data:{publicUrl:Y}}=_e.storage.from("signatures").getPublicUrl(j),{error:H}=await _e.from("supervision_assignments").update({signature_url:Y}).eq("id",c.id);H||(f(!1),I())},ae=()=>{const T=new Date,j=9*60*60*1e3;return new Date(T.getTime()+j).toISOString().replace("Z","+09:00")},le=async T=>{if(T.status!=="absent")return;const M={id:T.attendance_id,booking_id:T.booking_id,status:"present",updated_at:new Date().toISOString()};if(!T.timestamp_in){const V=g.find(fe=>fe.id===y);V?(M.timestamp_in=`${P}T${V.start_time}+09:00`,M.status="present"):M.timestamp_in=ae()}const{data:Y,error:H}=await _e.from("attendance").upsert(M,{onConflict:"booking_id"}).select().single();!H&&Y?p(V=>V.map(fe=>fe.booking_id===T.booking_id?{...fe,status:Y.status,attendance_id:Y.id,timestamp_in:Y.timestamp_in}:fe)):z()},Z=async T=>{if(T.attendance_id)try{const{error:j}=await _e.from("attendance").delete().eq("id",T.attendance_id);if(j)throw j;z()}catch(j){console.error("Error resetting attendance:",j)}},C=()=>{e&&e()},L=T=>{const j=new Date(E);j.setDate(j.getDate()+T),F(je(j,"yyyy-MM-dd"))};ne.useEffect(()=>{},[n]);const B=()=>{const T=_.find(O=>O.id===k),j=(T==null?void 0:T.name)||"";je(new Date,"yyyy M d"),["","","","","","",""][new Date().getDay()];const M=(T==null?void 0:T.code)||"A",Y=(T==null?void 0:T.name)||"A ZONE",H=u.filter(O=>O.zone_name===Y||O.zone_name===M||O.seat_number&&O.seat_number.startsWith(M)),V=H.filter(O=>O.status==="present").length,fe=H.filter(O=>O.is_active&&(O.status==="absent"||!O.status)).length;return v.jsxs("header",{className:"flex-none glass-header px-6 pt-10 pb-4 flex flex-col gap-5 z-50",children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsxs("div",{className:"flex flex-col",children:[v.jsx("h1",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:" "}),v.jsx("p",{className:"text-[10px] font-black text-ios-indigo tracking-[0.2em] uppercase opacity-70",children:"Study Cafe Manager"})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[n==="attendance"&&v.jsx("button",{onClick:()=>i("seatmap"),className:"p-2.5 bg-ios-indigo/10 text-ios-indigo rounded-apple-md ios-tap border border-ios-indigo/10",children:v.jsx(Tu,{className:"w-5 h-5"})}),n!=="menu"?v.jsx("button",{onClick:()=>i(n==="seatmap"?"attendance":"menu"),className:"px-4 py-2.5 bg-gray-200/20 text-ios-gray rounded-apple-md ios-tap border border-white/40 text-[13px] font-black",children:n==="seatmap"?"":""}):v.jsx("button",{onClick:C,className:"p-2.5 bg-ios-rose/10 text-ios-rose rounded-apple-md ios-tap border border-ios-rose/10",children:v.jsx(uf,{className:"w-5 h-5"})})]})]}),(n==="attendance"||n==="seatmap"||n==="supervision")&&v.jsxs("div",{className:"flex flex-col gap-5 animate-in fade-in slide-in-from-top-4 duration-300",children:[v.jsxs("div",{className:"flex gap-2 items-stretch",children:[v.jsx("div",{className:"flex-1 bg-gray-200/20 p-1 rounded-apple-md border border-white/40 flex items-center justify-center min-h-[38px] backdrop-blur-xl",children:v.jsx("span",{className:"text-[12px] font-black text-[#1C1C1E] px-2",children:j})}),v.jsxs("div",{className:"flex-[2] flex items-center justify-between bg-gray-200/20 px-2 rounded-apple-md border border-white/40 backdrop-blur-xl min-h-[38px]",children:[v.jsx("button",{onClick:()=>L(-1),className:"w-8 h-8 flex items-center justify-center text-ios-gray ios-tap",children:v.jsx(bi,{className:"w-4 h-4"})}),v.jsxs("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:[E.substring(5)," (",["","","","","","",""][new Date(E).getDay()],")"]}),v.jsx("button",{onClick:()=>L(1),className:"w-8 h-8 flex items-center justify-center text-ios-gray ios-tap",children:v.jsx(an,{className:"w-4 h-4"})})]})]}),(n==="attendance"||n==="seatmap")&&v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"flex bg-gray-200/20 p-1 rounded-apple-md border border-white/40 overflow-x-auto scrollbar-hide",children:g.map(O=>v.jsx("button",{onClick:()=>w(O.id),className:`flex-1 px-3 py-2.5 rounded-apple-md text-xs font-black whitespace-nowrap transition-all ios-tap ${y===O.id?"bg-white text-[#1C1C1E] shadow-sm":"text-ios-gray"}`,children:O.name},O.id))}),v.jsxs("div",{className:"flex gap-3 h-20",children:[v.jsxs("div",{className:"flex-1 bg-white shadow-sm border border-gray-100 rounded-apple p-3 flex flex-col justify-center items-center font-black",children:[v.jsx("span",{className:"text-[10px] text-ios-blue uppercase tracking-wider mb-1",children:" "}),v.jsxs("span",{className:"text-2xl text-[#1C1C1E]",children:[V,""]})]}),v.jsxs("div",{className:"flex-1 bg-white shadow-sm border border-gray-100 rounded-apple p-3 flex flex-col justify-center items-center font-black",children:[v.jsx("span",{className:"text-[10px] text-ios-rose uppercase tracking-wider mb-1",children:"/"}),v.jsxs("span",{className:"text-2xl text-[#1C1C1E]",children:[fe,""]})]})]})]})]})]})},N=()=>v.jsxs("div",{className:"mobile-menu-container",children:[v.jsxs("div",{className:"mobile-menu-grid",children:[v.jsxs("button",{onClick:()=>i("supervision"),className:"mobile-menu-btn",children:[v.jsx("div",{className:"mobile-menu-btn-icon bg-blue-50",children:v.jsx(H0,{className:"w-8 h-8 text-[#007AFF]"})}),v.jsx("span",{className:"mobile-menu-btn-text",children:" "})]}),v.jsxs("button",{onClick:()=>i("attendance"),className:"mobile-menu-btn",children:[v.jsx("div",{className:"mobile-menu-btn-icon bg-rose-50",children:v.jsx(bn,{className:"w-8 h-8 text-[#FF3B30]"})}),v.jsx("span",{className:"mobile-menu-btn-text",children:" "})]})]}),P&&v.jsx("div",{className:"text-center",children:v.jsxs("p",{className:"text-sm font-bold text-gray-400",children:[" ",je(new Date,"yyyy M d")," ."]})})]}),U=()=>{const T=new Date,j=je(T,"HH:mm:ss"),M=g.length>0?g.reduce((O,Q)=>Q.end_time>O?Q.end_time:O,"00:00:00"):"23:59:59",Y=je(T,"yyyy-MM-dd"),H=E<Y,V=E===Y,fe=(t==null?void 0:t.role)!=="admin"&&(H||V&&j>M);return v.jsx("main",{className:"flex-1 flex flex-col h-full overflow-hidden",style:{padding:"0 1rem 1rem 1rem"},children:v.jsxs("div",{className:"flex-1 flex flex-col gap-4 h-full overflow-y-auto pb-6 pt-2",children:[o.map((O,Q)=>v.jsx("div",{className:"flex-1 min-h-[300px] bg-white rounded-[32px] p-6 border border-gray-100 shadow-sm flex flex-col items-center justify-center",children:v.jsxs("div",{className:"flex flex-col items-center gap-4 w-full",children:[v.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center shadow-inner",children:v.jsx(_l,{className:"w-8 h-8 text-[#8E8E93]"})}),v.jsxs("div",{className:"text-center",children:[v.jsxs("h3",{className:"text-lg font-black text-[#1C1C1E]",children:[O.supervisor_name," "]}),O.signature_url?v.jsxs("p",{className:"mt-1.5 text-xs font-bold text-emerald-500 flex items-center justify-center gap-1.5",children:[v.jsx(bn,{className:"w-4 h-4"}),"   "]}):v.jsx("p",{className:"mt-1.5 text-xs font-bold text-[#FF9500]",children:"   "})]}),!O.signature_url&&(fe?v.jsx("div",{className:"w-full py-5 bg-gray-50 text-gray-400 rounded-2xl text-center border border-gray-100",children:v.jsx("p",{className:"text-sm font-bold",children:"     ."})}):v.jsx("button",{onClick:()=>{d(O),f(!0)},className:"w-full py-5 bg-[#007AFF] text-white rounded-2xl text-base font-black mobile-tap-feedback shadow-lg shadow-blue-100",children:""})),O.signature_url&&v.jsx("div",{className:"w-full bg-gray-50 rounded-2xl p-4 flex items-center justify-center border border-dashed border-gray-200 min-h-[100px]",children:v.jsx("img",{src:O.signature_url,alt:"Signature",className:"max-h-16 opacity-60 object-contain"})})]})},O.id)),o.length===1&&v.jsx("div",{className:"flex-1 min-h-0 p-6 border border-transparent opacity-0 pointer-events-none"}),o.length===0&&v.jsx("div",{className:"flex-1 bg-white rounded-[32px] border border-dashed border-gray-200 text-gray-400 text-center flex items-center justify-center p-6",children:v.jsx("p",{className:"text-base font-bold",children:"    ."})})]})})},A=()=>v.jsxs("main",{className:"mobile-attendance-list",children:[v.jsx("div",{className:"mobile-zone-grid",children:["A","B","C"].map(T=>{var H;const j=`${T} zone`,M=u.filter(V=>V.zone_name===j||V.zone_name===T||V.seat_number&&V.seat_number.startsWith(T)),Y=T==="A"?"#34C759":T==="B"?"#FF9500":"#FF3B30";return v.jsxs("div",{className:"zone-column",ref:m[T],children:[v.jsxs("div",{className:"zone-title-bar",style:{backgroundColor:((H=M[0])==null?void 0:H.zone_color)||Y},children:[T," ZONE"]}),v.jsx("div",{className:"zone-divider"}),v.jsx("div",{className:"zone-seats-list",children:M.map(V=>{const fe=V.is_active?"tier-active":V.is_booked_today?"tier-reserved":"tier-empty",O=V.zone_color||Y,Q=V.status==="present"?"green":"red";return v.jsxs("div",{className:`mobile-grid-card ${fe}`,children:[v.jsxs("div",{className:"grid-card-header",style:{backgroundColor:O},children:[V.display_number||V.seat_number.replace(`${T}-`,""),V.is_active&&v.jsx("div",{className:`status-dot ${Q}`})]}),v.jsx("div",{className:"grid-card-body",children:V.full_name?v.jsxs(v.Fragment,{children:[v.jsx("span",{className:"grid-card-student",children:V.full_name}),v.jsx("span",{className:"grid-card-id",children:V.username||" "})]}):v.jsx("span",{className:"grid-card-info text-gray-300",children:""})}),v.jsx("div",{className:"grid-card-footer",children:V.full_name?V.status==="absent"?v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"grid-status-btn status-absent-btn",children:""}),v.jsx("button",{className:"grid-action-btn",onClick:()=>le(V),style:{backgroundColor:O},children:""})]}):v.jsxs(v.Fragment,{children:[v.jsx("div",{className:`grid-status-btn ${V.status==="present"?"status-present-active":V.status==="late"?"status-late-active":"status-early-active"}`,style:{backgroundColor:V.status==="present"?O:void 0},children:(()=>{const K=g.find(te=>te.id===y),ce=je(new Date,"HH:mm:ss");return V.status==="present"?K&&ce>K.end_time?"":"":V.status==="late"?"":""})()}),v.jsx("button",{className:"grid-action-btn subtle",onClick:()=>Z(V),children:""})]}):v.jsx("div",{className:"grid-status-btn status-absent-btn opacity-20",children:"-"})})]},V.seat_id)})})]},T)})}),u.length===0&&!s&&v.jsxs("div",{className:"text-center py-12",children:[v.jsx(es,{className:"w-8 h-8 text-gray-200 mx-auto mb-2"}),v.jsx("p",{className:"text-xs text-gray-300 font-bold",children:"   ."})]})]});return v.jsxs("div",{className:"mobile-dashboard-container h-[100dvh] overflow-hidden flex flex-col",children:[B(),s&&v.jsx("div",{className:"flex-1 flex items-center justify-center",children:v.jsx("p",{className:"text-sm font-bold text-gray-400",children:" ..."})}),!s&&n==="menu"&&N(),!s&&n==="supervision"&&U(),!s&&n==="attendance"&&A(),!s&&n==="seatmap"&&v.jsx("div",{ref:r,className:"mobile-seatmap-container flex-1 scrollbar-hide bg-[#F2F2F7] relative overflow-auto",children:v.jsx("div",{className:"mobile-seatmap-content bg-white shadow-xl",children:v.jsx(A_,{isMobileView:!0,externalZoneId:k,externalDate:E,externalSessionId:y})})}),h&&v.jsx(z6,{teacherName:c==null?void 0:c.supervisor_name,onSave:G,onCancel:()=>f(!1)})]})},V_=({onSelectSeat:e,selectedProxyUser:t,viewDate:r,onDateChange:n,selectedZoneId:i,onZoneChange:s,minimal:l=!1})=>{const o=ne.useRef(null),a=ne.useRef(null),[c,d]=ne.useState(null),[h,f]=ne.useState([]),[u,p]=ne.useState(!1),[m,g]=ne.useState(null),[x,y]=ne.useState([]),[w,_]=ne.useState({quarters:[],exceptions:[],operatingRules:[]});ne.useEffect(()=>{b()},[]);const b=async()=>{const{data:{user:D}}=await _e.auth.getUser();if(D){const{data:X}=await _e.from("profiles").select("*").eq("id",D.id).single();g(X)}const{data:I}=await _e.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});I&&I.length>0&&(f(I),i||s(I[0].id))};ne.useEffect(()=>{if(!i)return;let D=!0;return(async()=>{const[X,z,G]=await Promise.all([_e.from("operation_quarters").select("*"),_e.from("operation_exceptions").select("*").eq("zone_id",i),_e.from("sessions").select("*").eq("zone_id",i).order("start_time",{ascending:!0})]);if(D){const{data:C}=await _e.from("session_operating_days").select("session_id, day_of_week").in("session_id",(G.data||[]).map(L=>L.id)).eq("is_active",!0);_({quarters:X.data||[],exceptions:z.data||[],operatingRules:C||[]})}const ae=G.data||[];if(!D||(y(ae),!o.current))return;a.current&&a.current.dispose(),o.current.innerHTML="";const le=document.createElement("canvas");o.current.appendChild(le);const Z=new Ke.fabric.Canvas(le,{backgroundColor:"transparent",selection:!1,hoverCursor:"pointer",moveCursor:"grab"});a.current=Z,await F(Z,ae),D&&(Z.on("mouse:down",C=>{var L,B,N,U;if(!C.target)Z.isDragging=!0,Z.selection=!1,Z.lastPosX=C.e.clientX||((B=(L=C.e.touches)==null?void 0:L[0])==null?void 0:B.clientX),Z.lastPosY=C.e.clientY||((U=(N=C.e.touches)==null?void 0:N[0])==null?void 0:U.clientY);else if(C.target.data){const A=C.target.data;d(A),e&&e(A),Z.getObjects().forEach(j=>{if(j.type==="group"){const M=j.getObjects().find(Y=>Y.name==="selectionBorder");M&&M.set({strokeWidth:0}),j.set("dirty",!0)}});const T=C.target.getObjects().find(j=>j.name==="selectionBorder");T&&T.set({strokeWidth:2}),C.target.set({dirty:!0,objectCaching:!1}),Z.renderAll()}else d(null),e&&e(null)}),Z.on("mouse:move",C=>{var L,B,N,U;if(Z.isDragging){const A=C.e,T=A.clientX||((B=(L=A.touches)==null?void 0:L[0])==null?void 0:B.clientX),j=A.clientY||((U=(N=A.touches)==null?void 0:N[0])==null?void 0:U.clientY),M=Z.viewportTransform;M[4]+=T-Z.lastPosX,M[5]+=j-Z.lastPosY,Z.requestRenderAll(),Z.lastPosX=T,Z.lastPosY=j}}),Z.on("mouse:wheel",C=>{var A;const L=C.e.deltaY,B=Z.viewportTransform;B[5]-=L;const N=Z.getHeight(),U=((A=o.current)==null?void 0:A.clientHeight)||0;B[5]>0&&(B[5]=0),U>0&&B[5]<-(N-U)&&(B[5]=-(N-U)),Z.requestRenderAll(),C.e.preventDefault(),C.e.stopPropagation()}),Z.on("mouse:up",()=>{Z.setViewportTransform(Z.viewportTransform),Z.isDragging=!1,Z.selection=!1}))})(),()=>{D=!1,a.current&&(a.current.dispose(),a.current=null)}},[i,m,r]);const k=D=>{const I=jt(D);if(!w.quarters.some(le=>le.start_date&&le.end_date&&Hl(I,{start:jt(le.start_date),end:jt(le.end_date)}))||w.exceptions.find(le=>le.exception_date===D))return!1;const G=I.getDay();return!!w.operatingRules.some(le=>le.day_of_week===G)},S=()=>{let D=ri(jt(r),1),I=!1,X=0;const z=180;for(;!I&&X<z;){const G=je(D,"yyyy-MM-dd");k(G)?(n(G),I=!0):(D=ri(D,1),X++)}},E=()=>{let D=Gd(jt(r),1),I=!1,X=0;const z=180;for(;!I&&X<z;){const G=je(D,"yyyy-MM-dd");k(G)?(n(G),I=!0):(D=Gd(D,1),X++)}},F=async(D,I,X)=>{var ae,le;p(!0);const{data:z}=await _e.from("seats").select("*").eq("zone_id",i).order("global_number",{ascending:!0}),{data:G}=await _e.from("bookings").select("*, profiles(username, full_name), sessions!inner(*)").eq("date",r).eq("sessions.zone_id",i);if(z&&z.length>0){if(!D||D.isDisposed||!D.getContext())return;D.clear();const Z=Math.min(...z.map(Q=>Q.pos_x)),L=Math.max(...z.map(Q=>Q.pos_x+(Q.width||72)))-Z,B=((ae=o.current)==null?void 0:ae.clientWidth)||L,N=Math.max(L,B),U=Math.round((N-L)/2-Z),A=Math.min(...z.map(Q=>Q.pos_y)),j=Math.max(...z.map(Q=>Q.pos_y+(Q.height||72)))-A,M=Math.round(-A),Y=((le=o.current)==null?void 0:le.clientHeight)||0,H=Math.max(j,Y);if(D.isDisposed||!D.getContext())return;D.setDimensions({width:N,height:H});const V=new Date,fe=V.getHours().toString().padStart(2,"0")+":"+V.getMinutes().toString().padStart(2,"0")+":00",O=I==null?void 0:I.find(Q=>fe>=Q.start_time&&fe<=Q.end_time);z.forEach(Q=>{const K=(G==null?void 0:G.filter(ce=>ce.seat_id===Q.id))||[];P(D,{...Q,pos_x:Q.pos_x+U,pos_y:Q.pos_y+M},K,O,I)})}p(!1)},P=(D,I,X,z,G)=>{if(I.type==="structure"){const O=new Ke.fabric.Rect({fill:I.bg_color||"#E5E5EA",width:I.width||72,height:I.height||72,rx:12,ry:12,stroke:I.stroke_color||"#D1D1D6",strokeWidth:1}),Q=new Ke.fabric.IText(I.label||"",{fontSize:I.font_size||10,originX:"center",originY:"center",left:(I.width||72)/2,top:(I.height||72)/2,fill:I.text_color||"#AEAEB2",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),K=new Ke.fabric.Group([O,Q],{left:I.pos_x,top:I.pos_y,originX:"left",originY:"top",angle:I.rotation,selectable:!1,evented:!1,data:{...I}});D.add(K);return}const le=!!X.find(O=>O.session_id===(z==null?void 0:z.id)),Z=X.length>0,C=O=>m?!!(["admin","teacher"].includes(m.role)||O.user_id===m.id):!1,L=I.zone_color||"#5E5CE6",B=new Ke.fabric.Rect({fill:L,opacity:le?.8:Z?.12:.03,width:72,height:72,rx:12,ry:12,strokeWidth:0,left:0,top:0,originX:"left",originY:"top",selectable:!1}),N="M 0 12 Q 0 0 12 0 L 60 0 Q 72 0 72 12 L 72 18 L 0 18 z",U=new Ke.fabric.Path(N,{fill:L,opacity:le?1:Z?.45:.18,strokeWidth:0,left:0,top:0,originX:"left",originY:"top",selectable:!1}),A=new Ke.fabric.IText(I.display_number||I.seat_number,{fontSize:11,left:6,top:4,originX:"left",originY:"top",fill:le?"#ffffff":L,fontFamily:"Inter, -apple-system",fontWeight:"900",selectable:!1}),T={Morning:"",Dinner:"","1st Period":"1 ","2nd Period":"2 ",period1:"1 ",period2:"2 "},j=O=>{if(T[O])return T[O];const Q=O.match(/(\d+)/);return Q?`${Q[1]} `:O.substring(0,2)},M=[...G||[]].sort((O,Q)=>O.id-Q.id),Y=M.length>4;let H=[];if(Y){const O=Math.ceil(M.length/2),Q=M.slice(0,O),K=M.slice(O),ce=ue=>ue.map(oe=>{const he=X.find(ie=>ie.session_id===oe.id),de=j(oe.name);return he?C(he)?`${de}:${he.profiles.full_name.substring(0,4)}`:`${de}:()`:`${de}:`}).join(`
`),te=new Ke.fabric.Text(ce(Q),{fontSize:5.5,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:le?"#ffffff":"#000000",left:4,top:20,lineHeight:1.35,selectable:!1}),R=new Ke.fabric.Text(ce(K),{fontSize:5.5,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:le?"#ffffff":"#000000",left:38,top:20,lineHeight:1.35,selectable:!1});H=[te,R]}else M.forEach((O,Q)=>{const K=X.find(de=>de.session_id===O.id),ce=j(O.name),te=21+Q*13,R=new Ke.fabric.Text(ce,{fontSize:8,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:le?"#ffffff":"#000000",left:4,top:te+.5,originX:"left",originY:"top",selectable:!1});H.push(R);const ue=new Ke.fabric.Line([17,te,17,te+10],{stroke:le?"rgba(255,255,255,0.3)":"rgba(0,0,0,0.1)",strokeWidth:.5,originX:"left",originY:"top",selectable:!1});H.push(ue);let oe="";if(K)if(C(K)){const de=K.profiles.username||"",ie=K.profiles.full_name||"";oe=de?`${de} ${ie}`:ie}else oe="()";const he=new Ke.fabric.Text(oe,{fontSize:8,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:le?"#ffffff":"#000000",left:23,top:te,originX:"left",originY:"top",selectable:!1});if(H.push(he),Q<M.length-1){const de=new Ke.fabric.Line([4,te+11.5,68,te+11.5],{stroke:le?"rgba(255,255,255,0.2)":"rgba(0,0,0,0.08)",strokeWidth:.5,originX:"left",originY:"top",selectable:!1});H.push(de)}});const V=new Ke.fabric.Rect({width:76,height:76,rx:14,ry:14,fill:"transparent",stroke:L,strokeWidth:0,left:-2,top:-2,originX:"left",originY:"top",selectable:!1,name:"selectionBorder",strokeUniform:!0}),fe=new Ke.fabric.Group([B,U,A,...H,V],{left:I.pos_x,top:I.pos_y,originX:"left",originY:"top",angle:I.rotation,data:{...I,seatBookings:X,activeSession:z},selectable:!1,hoverCursor:"pointer"});D.add(fe)};return v.jsxs("div",{className:"flex flex-col gap-4 w-full h-full relative overflow-hidden",children:[!l&&v.jsxs("div",{className:"flex items-center gap-4 px-1",children:[v.jsx("div",{className:"flex gap-[10px] m-[10px] mb-0 border-none shrink-0 p-1 bg-gray-200/20 rounded-apple-md backdrop-blur-xl border border-white/40",children:h.map(D=>v.jsx("button",{onClick:()=>s(D.id),className:`px-6 py-2 rounded-apple-md text-xs font-black transition-all ios-tap border-none ${i===D.id?"bg-white text-[#1C1C1E] shadow-sm":"text-ios-gray hover:text-[#1C1C1E] hover:bg-white/40"}`,children:D.name},D.id))}),v.jsxs("div",{className:"flex items-center gap-2 text-ios-gray",children:[v.jsx(ny,{className:"w-3.5 h-3.5"}),v.jsx("span",{className:"text-[10px] font-bold",children:"     ."})]}),v.jsxs("div",{className:"flex bg-gray-200/20 p-1 rounded-apple-md border border-white/40 backdrop-blur-xl items-center gap-1 ml-auto",children:[v.jsx("button",{onClick:E,className:"p-1.5 hover:bg-white rounded-apple-md transition-all text-ios-gray hover:text-[#1C1C1E] ios-tap",children:v.jsx(bi,{className:"w-4 h-4"})}),v.jsxs("div",{className:"relative group px-3 flex items-center gap-2 cursor-pointer",children:[v.jsx(qs,{className:"w-3.5 h-3.5 text-ios-indigo"}),v.jsx("span",{className:"text-[13px] font-black text-[#1C1C1E] whitespace-nowrap",children:je(jt(r),"MM.dd (EEE)",{locale:vr})}),v.jsx("input",{type:"date",value:r,onChange:D=>n(D.target.value),className:"absolute inset-0 opacity-0 cursor-pointer"})]}),v.jsx("button",{onClick:S,className:"p-1.5 hover:bg-white rounded-apple-md transition-all text-ios-gray hover:text-[#1C1C1E] ios-tap",children:v.jsx(an,{className:"w-4 h-4"})})]})]}),u&&v.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-30 flex items-center justify-center",children:v.jsx("div",{className:"w-8 h-8 border-3 border-ios-indigo border-t-transparent rounded-full animate-spin"})}),v.jsx("div",{ref:o,className:"flex-1 h-full relative overflow-hidden cursor-grab active:cursor-grabbing touch-none select-none scrollbar-hide"})]})},$6=({isOpen:e,onClose:t,zoneId:r,onSelect:n,selectedDate:i})=>{if(!e)return null;const s=je(i||new Date,"yyyy-MM-dd");return v.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:v.jsxs("div",{className:"bg-white w-full h-[80vh] rounded-3xl overflow-hidden flex flex-col shadow-2xl relative",children:[v.jsx("button",{onClick:t,className:"absolute top-4 right-4 z-50 p-2 bg-white/90 backdrop-blur rounded-full shadow-lg text-black hover:bg-gray-100 transition-all border border-gray-100",children:v.jsx(Os,{className:"w-6 h-6"})}),v.jsx("div",{className:"flex-1 bg-gray-50 relative overflow-hidden",children:v.jsx(V_,{viewDate:s,selectedZoneId:r,onDateChange:()=>{},onZoneChange:()=>{},isReadOnly:!0,minimal:!0,onSelectSeat:n})})]})})},V6=({onCancel:e,onSuccess:t,currentUser:r})=>{const[n,i]=ne.useState(0),[s,l]=ne.useState(!1),[o,a]=ne.useState([]),[c,d]=ne.useState([]),[h,f]=ne.useState([]),[u,p]=ne.useState({}),[m,g]=ne.useState(null),[x,y]=ne.useState([]),[w,_]=ne.useState(null),[b,k]=ne.useState(""),[S,E]=ne.useState("A"),[F,P]=ne.useState(""),D=ce=>{if(!ce)return"";const te=ce.seat_number.toString(),R=ce.zone_name||"";return R&&te.startsWith(`${R}-`)?te.replace(`${R}-`,""):R&&te.startsWith(R)?te.replace(R,""):te},[I,X]=ne.useState([]),[z,G]=ne.useState([]),[ae,le]=ne.useState([]),[Z,C]=ne.useState(!1);ne.useEffect(()=>{(async()=>{l(!0);try{const{data:te}=await _e.from("operation_quarters").select("*").order("start_date");a(te||[]);const{data:R}=await _e.from("zones").select("*").order("created_at");f(R||[]);let ue=null;R&&R.length>0&&(ue=R[0].id,_(ue))}catch(te){console.error("Error fetching wizard configs:",te)}finally{l(!1)}})()},[]),ne.useEffect(()=>{if(!w)return;(async()=>{l(!0);try{const[te,R,ue,oe]=await Promise.all([_e.from("sessions").select("*").eq("zone_id",w).order("start_time"),_e.from("operation_defaults").select("*").eq("zone_id",w),_e.from("operation_exceptions").select("*").eq("zone_id",w),_e.from("seats").select("*").eq("zone_id",w).order("global_number")]);d(te.data||[]),G(ue.data||[]),le(oe.data||[]);const{data:he}=await _e.from("session_operating_days").select("session_id, day_of_week").in("session_id",(te.data||[]).map(ie=>ie.id)).eq("is_active",!0);X(he||[]);const de=oe.data||[];if(de.length>0){const ie=de[0].zone_name||"";E(ie)}y([]),k("")}catch(te){console.error("Error fetching zone data:",te)}finally{l(!1)}})()},[w]),ne.useEffect(()=>{if(!r)return;(async()=>{try{const{data:te}=await _e.from("bookings").select(`
                    date,
                    attendance (
                        status
                    )
                `).eq("user_id",r.id);if(te){const R={},ue=je(new Date,"yyyy-MM-dd");te.forEach(oe=>{const he=oe.date,de=oe.attendance&&oe.attendance[0];let ie="reserved";he<ue?de?de.status==="present"?ie="present":de.status==="late"?ie="late":ie="absent":ie="absent":he===ue&&de&&(de.status==="present"?ie="present":de.status==="late"&&(ie="late")),(!R[he]||ie==="present"&&R[he]!=="present"||ie==="late"&&R[he]==="absent")&&(R[he]=ie)}),p(R)}}catch(te){console.error("Error fetching user activities:",te)}})()},[r]);const L=ce=>{const te=hi(new Date),R=hi(ce),ue=ri(te,2);if(tl(R,ue))return!1;const oe=o.find(we=>{const ve=jt(we.start_date),Ae=jt(we.end_date);return(Ji(R,ve)||Xd(R,ve))&&(Ji(R,Ae)||tl(R,Ae))});if(!oe)return!1;const he=jt(oe.start_date),de=Gd(he,7);if(tl(te,de))return!1;const ie=je(R,"yyyy-MM-dd"),pe=z.find(we=>we.exception_date===ie);if(pe&&pe.is_closed)return!1;const Se=R.getDay();return!!I.some(we=>we.day_of_week===Se)},[B,N]=ne.useState(new Date),U=()=>N(ce=>Tf(ce)),A=()=>N(ce=>sc(ce,1)),T=()=>{const ce=hi(new Date(B.getFullYear(),B.getMonth(),1)),te=new Date(B.getFullYear(),B.getMonth()+1,0),ue=hi(ce).getDay(),oe=Array(ue).fill(null),he=[];for(let ie=1;ie<=te.getDate();ie++)he.push(new Date(B.getFullYear(),B.getMonth(),ie));const de=[...oe,...he];return v.jsxs("div",{className:"space-y-4 animate-fade-in",children:[v.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:" "}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"  ."}),v.jsxs("div",{className:"flex items-center justify-between bg-white rounded-2xl p-2 shadow-sm border border-gray-100 mb-4",children:[v.jsx("button",{onClick:U,className:"p-2 hover:bg-gray-100 rounded-full text-ios-gray hover:text-black transition-colors",children:v.jsx(bi,{className:"w-5 h-5"})}),v.jsx("span",{className:"text-base font-black text-[#1C1C1E]",children:je(B,"yyyy M")}),v.jsx("button",{onClick:A,className:"p-2 hover:bg-gray-100 rounded-full text-ios-gray hover:text-black transition-colors",children:v.jsx(an,{className:"w-5 h-5"})})]}),v.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["","","","","","",""].map(ie=>v.jsx("div",{className:"text-center text-xs font-bold text-gray-400 py-2",children:ie},ie)),de.map((ie,pe)=>{if(!ie)return v.jsx("div",{},`empty-${pe}`);const Se=L(ie),De=m&&Ji(ie,m),we=je(ie,"yyyy-MM-dd"),ve=u[we];return v.jsxs("button",{disabled:!Se,onClick:()=>g(ie),className:`
                                aspect-square rounded-xl flex flex-col items-center justify-center text-sm font-bold transition-all relative
                                ${De?"bg-[#1C1C1E] text-white shadow-xl scale-105 z-10":ve==="present"?"bg-ios-emerald/10 text-ios-emerald":ve==="late"?"bg-ios-amber/10 text-ios-amber":ve==="absent"?"bg-ios-rose/10 text-ios-rose":ve==="reserved"?"bg-ios-indigo/10 text-ios-indigo":Se?"bg-white text-[#1C1C1E] border border-gray-100 hover:border-gray-300":"bg-transparent text-gray-400 cursor-not-allowed"}
                            `,children:[v.jsx("span",{className:!Se&&!ve?"opacity-50":"",children:je(ie,"d")}),ve&&v.jsx("span",{className:`w-1.5 h-1.5 rounded-full absolute bottom-2 ${De?"bg-white":ve==="present"?"bg-ios-emerald":ve==="late"?"bg-ios-amber":ve==="absent"?"bg-ios-rose":"bg-ios-indigo"}`})]},pe)})]}),v.jsx("div",{className:"mt-6 pt-4 border-t border-gray-100",children:v.jsxs("div",{className:"flex flex-col gap-3",children:[v.jsx("span",{className:"text-[11px] font-black text-ios-gray uppercase tracking-[0.2em]",children:" "}),v.jsx("div",{className:"flex flex-wrap gap-4",children:[{label:"",color:"bg-ios-emerald"},{label:"",color:"bg-ios-amber"},{label:"",color:"bg-ios-rose"},{label:"",color:"bg-ios-indigo"}].map(ie=>v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:`w-2 h-2 rounded-full ${ie.color}`}),v.jsx("span",{className:"text-[10px] font-bold text-gray-400",children:ie.label})]},ie.label))})]})})]})},j=()=>{const ce=te=>{x.includes(te)?y(x.filter(R=>R!==te)):y([...x,te])};return v.jsxs("div",{className:"space-y-4 animate-fade-in",children:[v.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:" "}),v.jsxs("p",{className:"text-sm font-bold text-ios-gray",children:["   .",v.jsx("br",{}),"(  )"]}),v.jsx("div",{className:"space-y-3 mt-4",children:c.filter(te=>{if(!m)return!1;const R=m.getDay();return I.some(ue=>ue.session_id===te.id&&ue.day_of_week===R)}).map(te=>{const R=x.includes(te.id);return v.jsxs("button",{onClick:()=>ce(te.id),className:`w-full p-4 rounded-2xl border-2 transition-all flex items-center justify-between group text-left ios-tap
                                ${R?"border-ios-indigo bg-ios-indigo/5":"border-white bg-white shadow-sm"}
                            `,children:[v.jsxs("div",{children:[v.jsx("h4",{className:`text-base font-black ${R?"text-ios-indigo":"text-[#1C1C1E]"}`,children:te.name}),v.jsxs("p",{className:"text-xs font-bold text-ios-gray mt-1",children:[te.start_time.slice(0,5)," ~ ",te.end_time.slice(0,5)]})]}),v.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors
                                ${R?"border-ios-indigo bg-ios-indigo text-white":"border-gray-200 bg-gray-50"}
                            `,children:R&&v.jsx(Ki,{className:"w-4 h-4"})})]},te.id)})})]})},M=()=>v.jsxs("div",{className:"space-y-4 animate-fade-in",children:[v.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:"  "}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:" (Zone) ."}),v.jsx("div",{className:"space-y-3 mt-4",children:h.map(ce=>{const te=w===ce.id;return v.jsxs("button",{onClick:()=>_(ce.id),className:`w-full p-5 rounded-2xl border-2 transition-all flex items-center justify-between text-left ios-tap
                                ${te?"border-ios-indigo bg-ios-indigo/5":"border-white bg-white shadow-sm"}
                            `,children:[v.jsx("span",{className:`text-lg font-black ${te?"text-ios-indigo":"text-[#1C1C1E]"}`,children:ce.name}),te&&v.jsx("div",{className:"text-xs font-bold text-ios-indigo bg-ios-indigo/10 px-2 py-1 rounded",children:""})]},ce.id)})})]}),Y=()=>{var he,de;const te=(()=>{if(!ae||ae.length===0)return[];const ie=new Set;return ae.forEach(pe=>{ie.add(pe.zone_name||"")}),Array.from(ie).sort()})(),R=ie=>{if(te.length===0)return;let pe=te.indexOf(S);pe===-1&&(pe=0);let Se;ie==="up"?Se=(pe+1)%te.length:Se=(pe-1+te.length)%te.length;const De=te[Se];E(De);const we=ae.find(ve=>(ve.zone_name||"")===De);k(we?D(we):"")},ue=ie=>{if(!ae||ae.length===0)return;const pe=S||te[0],Se=ae.filter(Ee=>(Ee.zone_name||"")===pe);if(Se.length===0)return;const De=[...Se].sort((Ee,Ne)=>{const Ie=parseInt(Ee.seat_number.toString().replace(/\D/g,""))||0,We=parseInt(Ne.seat_number.toString().replace(/\D/g,""))||0;return Ie-We}),we=De.find(Ee=>D(Ee)===b.toString());let ve=0;if(we){const Ee=De.indexOf(we);ie==="up"?ve=(Ee+1)%De.length:ve=(Ee-1+De.length)%De.length}else ve=0;const Ae=De[ve];k(D(Ae))},oe=S||(te.length>0?te[0]:"-");return v.jsxs("div",{className:"space-y-4 animate-fade-in",children:[v.jsxs("h3",{className:"text-xl font-black text-[#1C1C1E]",children:[(he=h.find(ie=>ie.id===w))==null?void 0:he.name,"  "]}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"(Section)    ."}),v.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-gray-100 mt-4",children:[v.jsxs("div",{className:"flex gap-4",children:[v.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2",children:[v.jsx("label",{className:"text-xs font-black text-ios-gray uppercase tracking-widest",children:" (Section)"}),v.jsx("button",{onClick:()=>R("up"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:v.jsx(Zg,{className:"w-6 h-6"})}),v.jsx("div",{className:"h-16 flex items-center justify-center",children:v.jsx("span",{className:"text-5xl font-black text-[#1C1C1E] text-center leading-tight",children:oe})}),v.jsx("button",{onClick:()=>R("down"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:v.jsx(Qg,{className:"w-6 h-6"})})]}),v.jsx("div",{className:"w-px bg-gray-100 my-4"}),v.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2",children:[v.jsx("label",{className:"text-xs font-black text-ios-gray uppercase tracking-widest",children:" (No.)"}),v.jsx("button",{onClick:()=>ue("up"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:v.jsx(Zg,{className:"w-6 h-6"})}),v.jsx("div",{className:"h-16 flex items-center justify-center w-full",children:v.jsx("input",{type:"text",value:b,onChange:ie=>k(ie.target.value),placeholder:"-",className:"w-full text-5xl font-black text-center border-none focus:ring-0 outline-none bg-transparent text-[#1C1C1E] p-0"})}),v.jsx("button",{onClick:()=>ue("down"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:v.jsx(Qg,{className:"w-6 h-6"})})]})]}),v.jsx("div",{className:"border-t border-gray-100 pt-6 mt-2",children:v.jsxs("button",{onClick:()=>C(!0),className:"w-full py-4 rounded-xl bg-gray-50 hover:bg-gray-100 text-[#1C1C1E] font-bold text-sm flex items-center justify-center gap-2 transition-all border border-gray-200",children:[v.jsx(Us,{className:"w-4 h-4"}),"  "]})})]}),b&&v.jsxs("div",{className:"flex items-center gap-2 justify-center text-ios-indigo text-xs font-bold animate-fade-in",children:[v.jsx(Ki,{className:"w-3 h-3"}),(de=h.find(ie=>ie.id===w))==null?void 0:de.name," ",oe!==""?`${oe}`:""," - ",b,""]})]})},H=()=>v.jsxs("div",{className:"space-y-4 animate-fade-in",children:[v.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:" "}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"       ."}),v.jsx("textarea",{value:F,onChange:ce=>P(ce.target.value),placeholder:":   2 ,   50  ",className:"w-full h-48 bg-white border border-gray-200 rounded-2xl p-5 text-base font-medium resize-none focus:ring-2 focus:ring-ios-indigo/20 outline-none transition-all shadow-sm"})]}),V=()=>{var ue;const ce=m?je(m,"M d (EEE)",{locale:vr}):"",te=(ue=h.find(oe=>oe.id===w))==null?void 0:ue.name,R=c.filter(oe=>x.includes(oe.id)).map(oe=>oe.name).join(", ");return v.jsxs("div",{className:"space-y-6 animate-fade-in",children:[v.jsx("h3",{className:"text-xl font-black text-[#1C1C1E] text-center",children:"  "}),v.jsx("div",{className:"bg-white rounded-3xl shadow-[0_4px_20px_rgba(0,0,0,0.03)] border border-gray-100 overflow-hidden",children:v.jsxs("div",{className:"p-6 space-y-6",children:[v.jsxs("div",{className:"flex items-start gap-4",children:[v.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-indigo/10 flex items-center justify-center shrink-0",children:v.jsx(qs,{className:"w-5 h-5 text-ios-indigo"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-xs font-bold text-ios-gray",children:""}),v.jsx("p",{className:"text-lg font-black text-[#1C1C1E]",children:ce})]})]}),v.jsxs("div",{className:"flex items-start gap-4",children:[v.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-rose/10 flex items-center justify-center shrink-0",children:v.jsx(es,{className:"w-5 h-5 text-ios-rose"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-xs font-bold text-ios-gray",children:""}),v.jsx("p",{className:"text-lg font-black text-[#1C1C1E]",children:R})]})]}),v.jsxs("div",{className:"flex items-start gap-4",children:[v.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-emerald/10 flex items-center justify-center shrink-0",children:v.jsx(Us,{className:"w-5 h-5 text-ios-emerald"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-xs font-bold text-ios-gray",children:""}),v.jsx("p",{className:"text-lg font-black text-[#1C1C1E]",children:te}),v.jsxs("p",{className:"text-base font-bold text-ios-indigo mt-0.5",children:[b," "]})]})]}),v.jsxs("div",{className:"flex items-start gap-4 border-t border-gray-50 pt-4",children:[v.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-amber/10 flex items-center justify-center shrink-0",children:v.jsx(Zv,{className:"w-5 h-5 text-ios-amber"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-xs font-bold text-ios-gray",children:" "}),v.jsx("p",{className:"text-sm font-medium text-[#1C1C1E] leading-relaxed line-clamp-3",children:F||" "})]})]})]})}),v.jsx("div",{className:"text-center",children:v.jsx("p",{className:"text-xs text-red-400 font-bold mb-2",children:"*      ."})})]})},fe=()=>{switch(n){case 0:return!!m;case 1:return!!w;case 2:return!!b;case 3:return x.length>0;case 4:return!!F.trim();default:return!0}},O=()=>{n<5&&fe()&&i(ce=>ce+1)},Q=()=>{n>0?i(ce=>ce-1):e()},K=async()=>{if(!s){l(!0);try{const ce=je(m,"yyyy-MM-dd");let te=null;if(ae&&ae.length>0){const de=ae.find(ie=>{const pe=ie.zone_name||"",Se=D(ie);return pe===S&&Se===b.toString()});de&&(te=de.id)}if(!te){alert("    .   ."),l(!1);return}const R=x.map(de=>({user_id:r.id,seat_id:te,date:ce,session_id:de,booking_type:"regular"})),{error:ue}=await _e.from("bookings").insert(R);if(ue)throw ue;const oe=x.map(de=>({user_id:r.id,date:ce,session_id:de,content:F})),{error:he}=await _e.from("study_plans").insert(oe);alert("  !"),t()}catch(ce){console.error("Booking failed:",ce),alert(`  .    .
`+ce.message)}finally{l(!1)}}};return v.jsxs("div",{className:"flex flex-col h-full bg-[#F2F2F7]",children:[v.jsxs("div",{className:"flex-none px-6 py-4 flex items-center justify-between bg-white/80 backdrop-blur border-b border-gray-200",children:[v.jsx("button",{onClick:Q,className:"p-2 -ml-2 rounded-full hover:bg-gray-100 text-ios-gray hover:text-[#1C1C1E] transition-colors",children:v.jsx(bi,{className:"w-6 h-6"})}),v.jsxs("span",{className:"text-base font-black text-[#1C1C1E]",children:[" (",n+1,"/6)"]}),v.jsx("div",{className:"w-10"})," "]}),v.jsx("div",{className:"flex-1 overflow-y-auto p-6 pb-32",children:v.jsxs("div",{className:"max-w-md mx-auto",children:[n===0&&T(),n===1&&M(),n===2&&Y(),n===3&&j(),n===4&&H(),n===5&&V()]})}),v.jsx("div",{className:"flex-none p-6 bg-white border-t border-gray-100 pb-[max(1.5rem,env(safe-area-inset-bottom))]",children:v.jsx("button",{onClick:n===5?K:O,disabled:!fe()||s,className:`w-full py-4 rounded-2xl font-black text-base flex items-center justify-center gap-2 transition-all shadow-lg ios-tap
                    ${fe()&&!s?"bg-[#1C1C1E] text-white hover:bg-gray-800":"bg-gray-200 text-gray-400 cursor-not-allowed shadow-none"}
                `,children:s?v.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):n===5?v.jsxs(v.Fragment,{children:[v.jsx(Ki,{className:"w-5 h-5"}),"  "]}):v.jsxs(v.Fragment,{children:["  ",v.jsx(an,{className:"w-5 h-5"})]})})}),v.jsx($6,{isOpen:Z,zoneId:w,selectedDate:m,onClose:()=>C(!1),onSelect:ce=>{if(ce){const te=ce.zone_name||"";E(te);const R=D(ce);k(R),C(!1)}}})]})},X_=({user:e})=>{const[t,r]=ne.useState("idle"),[n,i]=ne.useState(""),[s,l]=ne.useState(null),[o,a]=ne.useState(!0),[c,d]=ne.useState(new Date),h=()=>{const g=new Date,x=9*60*60*1e3;return new Date(g.getTime()+x).toISOString().replace("Z","+09:00")},f=ne.useCallback(g=>{const x=new Date,y=je(x,"yyyy-MM-dd");return g.find(w=>{const _=Co(`${y} ${w.start_time}`,"yyyy-MM-dd HH:mm:ss",new Date),b=Mx(_),k=Ro(_,30);return Xd(x,b)&&tl(x,k)})},[]);ne.useEffect(()=>{const g=async()=>{a(!0);const{data:y}=await _e.from("sessions").select("*");if(y){const w=f(y);l(w)}a(!1)};g();const x=setInterval(()=>{d(new Date),g()},3e4);return()=>clearInterval(x)},[f]);const u=async()=>{if(s){if(r("locating"),i("  ..."),!navigator.geolocation){r("error"),i("     .");return}navigator.geolocation.getCurrentPosition(async g=>{const{latitude:x,longitude:y,accuracy:w}=g.coords,{data:_}=await _e.from("configs").select("value").eq("key","gps_settings").single(),b=(_==null?void 0:_.value)||{},k=b.points||[{lat:b.lat||37.5665,lng:b.lng||126.978,name:" "}],S=b.radius||100;let E=!1,F=1/0;const P=6371e3;if(k.forEach(D=>{const I=x*Math.PI/180,X=D.lat*Math.PI/180,z=(D.lat-x)*Math.PI/180,G=(D.lng-y)*Math.PI/180,ae=Math.sin(z/2)*Math.sin(z/2)+Math.cos(I)*Math.cos(X)*Math.sin(G/2)*Math.sin(G/2),le=2*Math.atan2(Math.sqrt(ae),Math.sqrt(1-ae)),Z=P*le;Z<F&&(F=Z),Z<=S&&(E=!0)}),E){r("verified");try{const D=je(new Date,"yyyy-MM-dd"),{data:I,error:X}=await _e.from("bookings").select("id").eq("user_id",e.id).eq("date",D).eq("session_id",s.id).maybeSingle();if(X||!I){i(` '${s.name}'   .`),r("error");return}const z=Co(`${D} ${s.start_time}`,"yyyy-MM-dd HH:mm:ss",new Date),G=Ro(z,10),le=Xd(new Date,G)?"late":"present",Z=h(),{error:C}=await _e.from("attendance").upsert({booking_id:I.id,status:le,timestamp_in:Z,updated_at:new Date().toISOString()},{onConflict:"booking_id"});if(C)throw C;i(`'${s.name}'   ! (${le==="late"?"":""})`),setTimeout(()=>r("done"),1500)}catch(D){console.error(D),i("    ."),r("error")}}else r("error"),w>1e3?i("  .  GPS ."):i(`  . (${Math.round(F)}m )`)},g=>{r("error"),i("    .")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}},p=je(new Date,"yyyy-MM-dd"),m=s?{start:je(Mx(Co(`${p} ${s.start_time}`,"yyyy-MM-dd HH:mm:ss",new Date)),"HH:mm"),end:je(Ro(Co(`${p} ${s.start_time}`,"yyyy-MM-dd HH:mm:ss",new Date),30),"HH:mm"),lateLimit:je(Ro(Co(`${p} ${s.start_time}`,"yyyy-MM-dd HH:mm:ss",new Date),10),"HH:mm")}:null;return v.jsxs("div",{className:"bg-white p-8 max-w-[360px] w-full text-center space-y-6 relative overflow-hidden rounded-[32px] shadow-2xl border border-gray-50 animate-spring-up",children:[v.jsx("div",{className:"absolute top-0 left-0 w-32 h-32 bg-ios-indigo/5 blur-3xl -z-10"}),v.jsx("div",{className:`w-16 h-16 rounded-[1.2rem] mx-auto flex items-center justify-center transition-all duration-700 shadow-sm border ${t==="verified"||t==="done"?"bg-ios-emerald/10 text-ios-emerald border-ios-emerald/20":t==="error"?"bg-ios-rose/10 text-ios-rose border-ios-rose/20":t==="locating"?"bg-ios-indigo/10 text-ios-indigo animate-pulse border-ios-indigo/20":"bg-white text-gray-200 border-gray-100"}`,children:t==="done"?v.jsx(Ki,{className:"w-8 h-8"}):t==="error"?v.jsx(ti,{className:"w-8 h-8"}):t==="locating"?v.jsx(Us,{className:"w-8 h-8"}):v.jsx($0,{className:"w-8 h-8"})}),v.jsx("div",{className:"space-y-4",children:s?v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-ios-indigo/5 text-ios-indigo rounded-full text-[11px] font-black border border-ios-indigo/10",children:[v.jsx(es,{className:"w-3.5 h-3.5"})," '",s.name,"'   "]}),v.jsx("h3",{className:"text-[26px] font-black tracking-tight text-[#1C1C1E] leading-tight",children:t==="done"?" ":t==="locating"?"  ":"  "}),v.jsxs("div",{className:"bg-white rounded-2xl p-4 space-y-1.5 border border-gray-100 shadow-sm",children:[v.jsxs("p",{className:"text-[13px] font-bold text-ios-gray",children:["  : ",m.start," ~ ",m.end]}),v.jsxs("p",{className:"text-[11px] font-black text-ios-rose/80",children:[" ",m.lateLimit,"     ."]})]})]}):v.jsxs(v.Fragment,{children:[v.jsx("h3",{className:"text-2xl font-black tracking-tight text-[#1C1C1E]",children:"   "}),v.jsx("p",{className:"text-sm font-bold text-ios-gray leading-relaxed px-4",children:o?"   ...":"     .  5  30  ."})]})}),v.jsxs("div",{className:"space-y-4 pt-2",children:[n&&v.jsx("p",{className:`text-[12px] font-black p-3.5 rounded-apple-md ${t==="error"?"bg-ios-rose/5 text-ios-rose border border-ios-rose/10":"bg-ios-emerald/5 text-ios-emerald border border-ios-emerald/10"}`,children:n}),t!=="done"&&v.jsx("button",{onClick:u,disabled:t==="locating"||!s,className:`w-full py-[24px] rounded-3xl font-black text-[18px] transition-all shadow-xl ios-tap border ${t==="locating"||!s?"bg-white text-gray-300 border-gray-100 shadow-none":t==="error"?"bg-[#1C1C1E] text-white border-transparent":"bg-ios-blue text-white border-transparent shadow-blue-500/20"}`,children:t==="locating"?"  ...":s?`${s.name}  `:" "})]})]})},Y_=({user:e})=>{const[t,r]=ne.useState([]),[n,i]=ne.useState(!1),[s,l]=ne.useState({cumulativeDays:0,cumulativeTime:0,attendanceRate:0,lateCount:0}),[o,a]=ne.useState([]),[c,d]=ne.useState(!1),[h,f]=ne.useState([]);ne.useEffect(()=>{if(!e)return;(async()=>{const g="2025-03-01",y=je(new Date,"yyyy-MM-dd"),{data:w}=await _e.from("bookings").select(`
                *,
                sessions (
                    start_time,
                    end_time
                ),
                attendance (
                    status,
                    timestamp_in
                )
            `).eq("user_id",e.id).gte("date",g);if(w){f(w);let _=0,b=0,k=0,S=0;const E=new Set;w.forEach(F=>{if(F.date>y)return;_++;const D=F.attendance&&F.attendance[0];if(D&&(D.status==="present"||D.status==="late")&&(b++,E.add(F.date),D.status==="late"&&k++,F.sessions)){const I=new Date(`${F.date}T${F.sessions.start_time}`),z=(new Date(`${F.date}T${F.sessions.end_time}`)-I)/(1e3*60);let G=0;if(D.timestamp_in){const ae=new Date(D.timestamp_in),le=new Date(`${F.date}T${F.sessions.start_time}+09:00`);ae>le&&(G=(ae-le)/(1e3*60))}S+=Math.max(0,z-Math.max(0,G))}}),l({cumulativeDays:E.size,cumulativeTime:Math.round(S),attendanceRate:_>0?Math.round(b/_*100):0,lateCount:k})}a([])})()},[e]);const u=na({start:ro(new Date),end:zl(new Date)}),p=m=>{const g=Math.floor(m/60),x=m%60;return`${g} ${x}`};return v.jsxs("div",{className:"flex flex-col gap-4 md:gap-6",children:[v.jsx("div",{className:"animate-spring-up",children:v.jsxs("div",{className:"bg-white rounded-[32px] p-10 border border-gray-100 shadow-sm",children:[v.jsx("div",{className:"flex items-center justify-between mb-10",children:v.jsxs("h3",{className:"text-xl font-black flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 rounded-ios bg-ios-indigo/20 flex items-center justify-center",children:v.jsx(qs,{className:"w-5 h-5 text-ios-indigo"})}),"  "]})}),v.jsx("div",{className:"grid grid-cols-7 gap-3 text-center mb-6",children:["","","","","","",""].map((m,g)=>v.jsx("span",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest",children:m},g))}),v.jsx("div",{className:"grid grid-cols-7 gap-3",children:u.map((m,g)=>{const x=je(m,"yyyy-MM-dd"),y=h.find(b=>b.date===x);let w=null;if(y){const b=je(new Date,"yyyy-MM-dd");if(x>b)w="booking";else{const k=y.attendance&&y.attendance[0];k?w=k.status:w="absent"}}const _=Lp(m);return v.jsxs("div",{className:`aspect-square rounded-ios flex items-center justify-center text-[12px] font-black transition-all duration-500 ios-tap relative group ${_?"bg-[#1C1C1E] text-white shadow-xl scale-[1.15] z-10":w==="present"?"bg-ios-emerald/10 text-ios-emerald":w==="late"?"bg-ios-amber/10 text-ios-amber":w==="absent"?"bg-ios-rose/10 text-ios-rose":w==="booking"?"bg-ios-indigo/10 text-ios-indigo":"bg-gray-50 text-gray-300 hover:bg-gray-100 hover:text-gray-500"}`,children:[je(m,"d"),w&&!_&&w!=="booking"&&v.jsx("div",{className:`absolute bottom-1 w-1 h-1 rounded-full ${w==="present"?"bg-ios-emerald":w==="late"?"bg-ios-amber":"bg-ios-rose"}`}),w==="booking"&&!_&&v.jsx("div",{className:"absolute bottom-1 w-1 h-1 rounded-full bg-ios-indigo"})]},g)})}),v.jsx("div",{className:"mt-10 pt-8 border-t border-gray-100",children:v.jsxs("div",{className:"flex flex-col gap-4",children:[v.jsx("span",{className:"text-[11px] font-black text-ios-gray uppercase tracking-[0.2em]",children:" "}),v.jsx("div",{className:"flex flex-wrap gap-4",children:[{label:"",color:"bg-ios-emerald"},{label:"",color:"bg-ios-amber"},{label:"",color:"bg-ios-rose"},{label:"",color:"bg-ios-indigo"}].map(m=>v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:`w-2 h-2 rounded-full ${m.color}`}),v.jsx("span",{className:"text-[10px] font-bold text-gray-400",children:m.label})]},m.label))})]})})]})}),v.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4 md:gap-6 overflow-visible",children:[v.jsx("div",{className:"xl:col-span-2 flex flex-col gap-4 md:gap-6 animate-spring-up",style:{animationDelay:"100ms"},children:v.jsxs("div",{className:"grid grid-cols-2 gap-4 md:gap-6",children:[v.jsxs("div",{className:"col-span-2 bg-white rounded-[32px] p-8 flex flex-col items-center text-center gap-2 group transition-all duration-500 ios-tap border border-gray-100 shadow-sm relative overflow-hidden",children:[v.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-ios-amber/10 blur-3xl -z-10"}),v.jsx("div",{className:"w-16 h-16 rounded-ios bg-ios-amber/10 text-ios-amber flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform mb-2",children:v.jsx(th,{className:"w-8 h-8"})}),v.jsx("p",{className:"text-[11px] uppercase font-black text-ios-gray tracking-widest",children:"   "}),v.jsxs("div",{className:"flex flex-col items-center",children:[v.jsxs("p",{className:"text-4xl font-black text-[#1C1C1E]",children:[s.cumulativeDays,""]}),v.jsx("p",{className:"text-sm font-bold text-gray-400 mt-1",children:p(s.cumulativeTime)})]})]}),v.jsxs("div",{className:"bg-white rounded-[32px] p-8 flex flex-col items-center text-center gap-4 group transition-all duration-500 ios-tap border border-gray-100 shadow-sm",children:[v.jsx("div",{className:"w-12 h-12 rounded-ios bg-ios-emerald/10 text-ios-emerald flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform",children:v.jsx(Ki,{className:"w-6 h-6"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-[10px] uppercase font-black text-ios-gray tracking-widest mb-1",children:""}),v.jsxs("p",{className:"text-2xl font-black text-[#1C1C1E]",children:[s.attendanceRate,"%"]})]})]}),v.jsxs("div",{className:"bg-white rounded-[32px] p-8 flex flex-col items-center text-center gap-4 group transition-all duration-500 ios-tap border border-gray-100 shadow-sm",children:[v.jsx("div",{className:"w-12 h-12 rounded-ios bg-ios-rose/10 text-ios-rose flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform",children:v.jsx(sC,{className:"w-6 h-6"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-[10px] uppercase font-black text-ios-gray tracking-widest mb-1",children:" "}),v.jsxs("p",{className:"text-2xl font-black text-[#1C1C1E]",children:[s.lateCount,""]})]})]})]})}),v.jsx("div",{className:"animate-spring-up",style:{animationDelay:"200ms"},children:v.jsxs("div",{className:"bg-gradient-to-br from-ios-indigo via-[#7D7AFF] to-[#9B99FF] rounded-[32px] p-10 text-white shadow-2xl shadow-ios-indigo/30 relative overflow-hidden group ios-tap",children:[v.jsxs("div",{className:"relative z-10",children:[v.jsx("div",{className:"w-14 h-14 rounded-2xl bg-white/20 backdrop-blur-md flex items-center justify-center mb-6 shadow-inner-white",children:v.jsx(th,{className:"w-8 h-8 text-white"})}),v.jsx("h4",{className:"text-2xl font-black tracking-tight mb-2",children:" "}),v.jsxs("p",{className:"text-[15px] text-white/80 font-medium mb-8 leading-relaxed",children:[" 5%  .",v.jsx("br",{}),"   ."]}),v.jsx("button",{onClick:()=>d(!0),className:"w-full py-4 bg-black hover:bg-gray-900 rounded-2xl text-xs font-black uppercase tracking-widest transition-all backdrop-blur-sm border border-white/10",children:" "})]}),v.jsx("div",{className:"absolute -right-16 -top-16 w-64 h-64 bg-white/10 rounded-full blur-3xl group-hover:scale-150 transition-transform duration-[2000ms]"}),v.jsx("div",{className:"absolute left-[-10%] bottom-[-10%] w-40 h-40 bg-white/5 rounded-full blur-2xl group-hover:translate-x-10 transition-transform duration-[2000ms]"})]})})]}),c&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 animate-in fade-in duration-200",children:[v.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>d(!1)}),v.jsxs("div",{className:"bg-white rounded-ios p-8 w-full max-w-md relative z-10 shadow-2xl animate-spring-up",children:[v.jsxs("div",{className:"flex items-center justify-between mb-8",children:[v.jsxs("h3",{className:"text-xl font-black flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 rounded-ios bg-ios-amber/20 flex items-center justify-center",children:v.jsx(th,{className:"w-5 h-5 text-ios-amber"})})," "]}),v.jsx("div",{className:"bg-gray-100 rounded-full px-3 py-1",children:v.jsx("span",{className:"text-[10px] font-bold text-gray-500",children:"TOP 10"})})]}),v.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2",children:o.length>0?o.map((m,g)=>v.jsxs("div",{className:"flex items-center justify-between p-4 rounded-ios bg-gray-50 border border-gray-100/50",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:`w-8 h-8 flex items-center justify-center font-black rounded-full shadow-sm ${g===0?"bg-yellow-400 text-white":g===1?"bg-gray-400 text-white":g===2?"bg-orange-400 text-white":"bg-white text-gray-400 border border-gray-200"}`,children:m.rank}),v.jsx("div",{className:"flex flex-col",children:v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"text-sm font-black text-[#1C1C1E]",children:m.name}),v.jsx("span",{className:"text-[10px] font-bold text-gray-500 bg-white px-1.5 py-0.5 rounded border border-gray-200",children:m.info})]})})]}),v.jsx("p",{className:"text-xs font-bold text-ios-indigo bg-ios-indigo/5 px-2 py-1 rounded-lg",children:p(m.score)})]},g)):v.jsx("div",{className:"text-center py-12 text-gray-400 font-medium text-sm bg-gray-50 rounded-ios",children:"  ,   ."})}),v.jsx("button",{onClick:()=>d(!1),className:"w-full mt-6 py-4 bg-[#1C1C1E] text-white rounded-ios font-black text-sm hover:scale-[1.02] active:scale-[0.98] transition-all shadow-lg",children:""})]})]})]})},X6=({onLogout:e,currentUser:t})=>{const[r,n]=ne.useState("home"),[i,s]=ne.useState(null),[l,o]=ne.useState("GOE STUDY CAFE"),[a,c]=ne.useState(""),[d,h]=ne.useState({}),[f,u]=ne.useState(new Date);ne.useEffect(()=>{const y=async()=>{const{data:k}=await _e.from("sessions").select("*");if(k){const S=new Date,E=S.getHours().toString().padStart(2,"0")+":"+S.getMinutes().toString().padStart(2,"0")+":00",F=k.find(P=>E>=P.start_time&&E<=P.end_time);s(F)}},w=async()=>{var S;const{data:k}=await _e.from("configs").select("value").eq("key","school_info").single();(S=k==null?void 0:k.value)!=null&&S.name&&o(k.value.name)},_=async()=>{if(!t)return;const k=je(new Date,"yyyy-MM-dd"),S=rr(f,{weekStartsOn:1}),E=xi(f,{weekStartsOn:1}),{data:F}=await _e.from("study_plans").select("content").eq("user_id",t.id).eq("date",k);if(F&&F.length>0){const D=F.map(I=>I.content).filter(Boolean).join(`
`);c(D)}else c("");const{data:P}=await _e.from("bookings").select(`
                *,
                sessions (
                    id,
                    start_time,
                    end_time
                ),
                attendance (
                    id,
                    booking_id,
                    status,
                    timestamp_in,
                    timestamp_out
                )
            `).eq("user_id",t.id).gte("date",je(S,"yyyy-MM-dd")).lte("date",je(E,"yyyy-MM-dd"));if(P){const D={};P.forEach(I=>{const X=I.date;D[X]||(D[X]={bookings:[],attendance:[]}),D[X].bookings.push(I),I.attendance&&I.attendance.length>0&&D[X].attendance.push(...I.attendance)}),h(D)}};y(),w(),_();const b=setInterval(()=>{y(),_()},6e4);return()=>clearInterval(b)},[t,f]);const p=()=>u(y=>$_(y)),m=()=>u(y=>Cf(y,1)),g=(y,w)=>{var X,z;if(!w||!w.bookings.length)return null;const _=new Date,b=je(_,"yyyy-MM-dd"),{bookings:k,attendance:S}=w;if(y>b)return{label:"",color:"text-ios-indigo bg-ios-indigo/10"};if(y<b)return S.length?S.some(ae=>ae.status==="late")?{label:"",color:"text-ios-amber bg-ios-amber/10"}:{label:"",color:"text-ios-emerald bg-ios-emerald/10"}:{label:"",color:"text-ios-rose bg-ios-rose/10"};const E=je(_,"HH:mm:ss"),F=[...k].sort((G,ae)=>{var le,Z;return(((le=G.sessions)==null?void 0:le.start_time)||"").localeCompare(((Z=ae.sessions)==null?void 0:Z.start_time)||"")});if(!F.length)return null;const P=(X=F[0].sessions)==null?void 0:X.start_time,D=(z=F[F.length-1].sessions)==null?void 0:z.end_time;if(D&&E>D)return{label:"",color:"text-gray-500 bg-gray-100"};if(P&&E<P)return{label:"",color:"text-ios-indigo bg-ios-indigo/10"};const I=F.find(G=>{const ae=G.sessions;return ae&&E>=ae.start_time&&E<=ae.end_time});return I?S.find(ae=>ae.booking_id===I.id)?{label:"",color:"text-white bg-ios-emerald"}:{label:"",color:"text-ios-rose bg-ios-rose/10"}:{label:"",color:"text-ios-amber bg-ios-amber/10"}},x=()=>{switch(r){case"home":return v.jsxs("div",{className:"flex-1 flex flex-col gap-4 p-4 animate-fade-in relative overflow-y-auto scrollbar-hide",children:[v.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-ios-indigo/5 blur-3xl -z-10"}),v.jsx("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-ios-blue/5 blur-3xl -z-10"}),v.jsxs("div",{className:"flex-[2] glass-card p-7 relative overflow-hidden flex flex-col",children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-ios-amber/10 flex items-center justify-center",children:v.jsx(Zv,{className:"w-4 h-4 text-ios-amber"})}),v.jsx("h2",{className:"text-lg font-black text-[#1C1C1E] tracking-tight",children:" "})]}),v.jsxs("span",{className:"text-[10px] font-bold text-ios-gray bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100 max-sm:hidden",children:[je(new Date,"M d")," "]})]}),v.jsx("div",{className:"flex-1 flex items-center justify-center text-center",children:a?v.jsx("p",{className:"text-[15px] text-[#1C1C1E] font-bold leading-relaxed whitespace-pre-line line-clamp-3",children:a}):v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-sm text-gray-400 font-bold leading-relaxed mb-1",children:"    ."}),v.jsx("span",{className:"text-xs font-medium text-gray-300",children:"   ."})]})}),v.jsxs("div",{className:"bg-gray-200/20 rounded-apple-md p-4 border border-white/40 mt-auto relative backdrop-blur-xl",children:[v.jsx("button",{onClick:p,className:"absolute left-1 top-1/2 -translate-y-1/2 w-8 h-8 flex items-center justify-center text-ios-gray hover:text-[#1C1C1E] transition-colors ios-tap",children:v.jsx(bi,{className:"w-5 h-5"})}),v.jsx("button",{onClick:m,className:"absolute right-1 top-1/2 -translate-y-1/2 w-8 h-8 flex items-center justify-center text-ios-gray hover:text-[#1C1C1E] transition-colors ios-tap",children:v.jsx(an,{className:"w-5 h-5"})}),v.jsx("div",{className:"flex justify-between items-center px-6",children:na({start:rr(f,{weekStartsOn:1}),end:xi(f,{weekStartsOn:1})}).map((y,w)=>{const _=je(y,"yyyy-MM-dd"),b=d[_],k=g(_,b),S=Ji(y,new Date);return v.jsxs("div",{className:"flex flex-col items-center gap-2",children:[v.jsx("span",{className:`text-[9px] font-black ${S?"text-[#1C1C1E]":"text-gray-300"}`,children:["","","","","","",""][w]}),v.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-[10px] font-black transition-all ${S?"bg-[#1C1C1E] text-white shadow-lg ring-4 ring-white z-10":"bg-white/50 border border-white/40 text-gray-300"}`,children:je(y,"d")}),v.jsx("div",{className:"h-4 flex items-center justify-center",children:k?v.jsx("span",{className:`text-[8px] font-bold px-1.5 py-0.5 rounded-full whitespace-nowrap ${k.color}`,children:k.label}):v.jsx("div",{className:"w-1 h-1 rounded-full bg-transparent"})})]},w)})})]})]}),v.jsxs("button",{onClick:()=>n("map"),className:"flex-1 bg-white rounded-apple border border-gray-100 shadow-sm p-4 flex items-center justify-center gap-6 group transition-all active:scale-[0.98] relative overflow-hidden ios-tap",children:[v.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-ios-indigo/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),v.jsx("div",{className:"w-14 h-14 rounded-full bg-ios-indigo/10 flex items-center justify-center group-hover:scale-110 transition-transform duration-500",children:v.jsx(Tu,{className:"w-7 h-7 text-ios-indigo"})}),v.jsxs("div",{className:"text-left space-y-1 relative z-10 flex-1",children:[v.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:""}),v.jsx("p",{className:"text-xs font-bold text-ios-gray",children:"  "})]}),v.jsx(an,{className:"w-5 h-5 text-gray-300"})]}),v.jsxs("button",{onClick:()=>n("attendance"),className:"flex-1 bg-white rounded-apple border border-gray-100 shadow-sm p-4 flex items-center justify-center gap-6 group transition-all active:scale-[0.98] relative overflow-hidden ios-tap",children:[v.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-ios-emerald/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),v.jsx("div",{className:"w-14 h-14 rounded-full bg-ios-emerald/10 flex items-center justify-center group-hover:scale-110 transition-transform duration-500",children:v.jsx(Us,{className:"w-7 h-7 text-ios-emerald"})}),v.jsxs("div",{className:"text-left space-y-1 relative z-10 flex-1",children:[v.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:""}),v.jsx("p",{className:"text-xs font-bold text-ios-gray",children:"GPS  "})]}),v.jsx(an,{className:"w-5 h-5 text-gray-300"})]})]});case"map":return v.jsx("div",{className:"flex-1 bg-white relative overflow-hidden flex flex-col",children:v.jsx(V6,{onCancel:()=>n("home"),onSuccess:()=>n("profile"),currentUser:t})});case"attendance":return v.jsx("div",{className:"flex-1 bg-white flex flex-col items-center justify-center overflow-y-auto scrollbar-hide px-6",children:v.jsx("div",{className:"w-full max-w-lg py-8 flex flex-col items-center justify-center",children:v.jsx(X_,{user:t})})});case"profile":return v.jsx("div",{className:"flex-1 bg-[#F2F2F7] overflow-y-auto scrollbar-hide p-6",children:v.jsx(Y_,{user:t})});default:return null}};return v.jsxs("div",{className:"mobile-container flex flex-col bg-[#F2F2F7] h-screen overflow-hidden font-sans pb-[safe-area-inset-bottom]",children:[v.jsxs("header",{className:"flex-none glass-header px-6 pt-10 pb-4 flex items-center justify-between shadow-sm z-50",children:[v.jsxs("div",{className:"flex flex-col",children:[v.jsx("h1",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:l.split(" ")[0]}),v.jsx("p",{className:"text-[10px] font-black text-ios-indigo tracking-[0.2em] uppercase opacity-70",children:"Study Cafe Manager"})]}),v.jsx("div",{className:"flex items-center gap-4",children:v.jsx("button",{onClick:e,className:"p-3 bg-gray-200/20 text-ios-gray hover:text-ios-rose hover:bg-ios-rose/10 rounded-apple-md transition-all ios-tap border border-white/40 backdrop-blur-xl",children:v.jsx(uf,{className:"w-5 h-5"})})})]}),v.jsx("main",{className:"flex-1 flex flex-col overflow-hidden relative",children:x()}),r!=="map"&&v.jsx("nav",{className:"flex-none glass-material pb-[calc(1rem+env(safe-area-inset-bottom))] pt-3 px-6 flex justify-between items-center z-50 shadow-[0_-4px_40px_rgba(0,0,0,0.03)] border-t border-white/40",children:[{id:"home",icon:ry,label:""},{id:"map",icon:Tu,label:""},{id:"attendance",icon:Us,label:""},{id:"profile",icon:_l,label:"MY"}].map(y=>v.jsxs("button",{onClick:()=>n(y.id),className:`flex flex-col items-center justify-center p-2 rounded-apple-md transition-all duration-300 w-16 group ios-tap ${r===y.id?"text-[#1C1C1E]":"text-gray-300 hover:text-gray-500"}`,children:[v.jsx("div",{className:"relative transition-transform duration-300",children:v.jsx(y.icon,{className:`w-7 h-7 stroke-[2.5px] ${r===y.id?"fill-ios-indigo/10":"fill-transparent"}`})}),v.jsx("span",{className:"text-[9px] font-black mt-1",children:y.label})]},y.id))})]})},Y6=({selectedSeat:e,onComplete:t,targetUser:r,loggedInUser:n,initialDate:i,onDateChange:s,currentZoneId:l})=>{const[o,a]=ne.useState(1),[c,d]=ne.useState(i||je(ri(new Date,2),"yyyy-MM-dd")),[h,f]=ne.useState(je(ri(new Date,2),"yyyy-MM-dd")),[u,p]=ne.useState([]),[m,g]=ne.useState([]),[x,y]=ne.useState(null),[w,_]=ne.useState(null),[b,k]=ne.useState({quarters:[],exceptions:[],operatingRules:[]}),[S,E]=ne.useState([]),[F,P]=ne.useState([]),[D,I]=ne.useState(!1),[X,z]=ne.useState("");ne.useEffect(()=>{i&&d(i)},[i]);const G={Morning:" ",Dinner:" ","1st Period":"1","2nd Period":"2"},ae=M=>G[M]||M;ne.useEffect(()=>{(async()=>{const{data:{user:Y}}=await _e.auth.getUser();if(Y){const{data:V}=await _e.from("profiles").select("*").eq("id",Y.id).single();y(r||V),_(V)}const H=(e==null?void 0:e.zone_id)||l;if(H){I(!0);const[V,fe,O,Q,K]=await Promise.all([_e.from("sessions").select("*").eq("zone_id",H).order("start_time",{ascending:!0}),_e.from("operation_quarters").select("*"),_e.from("operation_defaults").select("*").eq("zone_id",H),_e.from("operation_exceptions").select("*").eq("zone_id",H),_e.from("configs").select("*").eq("key",`zone_op_config_${H}`).single()]);V.data&&p(V.data);const{data:ce}=await _e.from("session_operating_days").select("session_id, day_of_week").in("session_id",(V.data||[]).map(te=>te.id)).eq("is_active",!0);k({quarters:fe.data||[],exceptions:Q.data||[],operatingRules:ce||[]}),I(!1)}else{const{data:V}=await _e.from("operation_quarters").select("*");k(fe=>({...fe,quarters:V||[]}))}})()},[e,l,r]),ne.useEffect(()=>{y(r||w)},[r,w]),ne.useEffect(()=>{x&&c&&e&&(le(),Z()),g([])},[x,c,e,l]);const le=async()=>{const{data:M}=await _e.from("bookings").select("*").eq("user_id",x.id).eq("date",c);E(M||[])},Z=async()=>{if(!e)return;const{data:M}=await _e.from("bookings").select("*, profiles(username, full_name)").eq("seat_id",e.id).eq("date",c);P(M||[])},C=M=>{const Y=jt(M),H=n||w,V=H&&["admin","teacher"].includes(H.role),fe=hi(ri(new Date,V?0:2));if(tl(Y,fe))return{ok:!1,msg:`   ${V?"0":"2"}  .`};if(b.quarters.length>0&&!b.quarters.some(K=>K.start_date&&K.end_date&&Hl(Y,{start:jt(K.start_date),end:jt(K.end_date)})))return{ok:!1,msg:"    ."};const O=b.exceptions.find(Q=>Q.exception_date===M);if(O)return{ok:!1,msg:`: ${O.reason}`};if(b.operatingRules.length>0){const Q=Y.getDay();if(!b.operatingRules.some(ce=>ce.day_of_week===Q))return{ok:!1,msg:"   ."}}return{ok:!0}},L=()=>{if(o===1){const M=n||w;if(M&&["admin","teacher"].includes(M.role)&&!r){z("/     .     .");return}const Y=C(c);if(!Y.ok){z(Y.msg);return}if(S.length>0&&e&&S[0].seat_id!==e.id){z(`  ${S[0].seat_number}  .`);return}}z(""),a(M=>M+1)},B=M=>{g(Y=>Y.find(V=>V.id===M.id)?Y.filter(V=>V.id!==M.id):[...Y,M].sort((V,fe)=>V.id-fe.id))};async function N(M,Y){if(M.stopPropagation(),!!window.confirm("   ?"))try{I(!0);const{error:H}=await _e.from("bookings").delete().eq("seat_id",e.id).eq("date",c).eq("session_id",Y);if(H)throw H;P(V=>V.filter(fe=>fe.session_id!==Y)),E(V=>V.filter(fe=>fe.session_id!==Y)),alert(" .")}catch(H){console.error("Cancel Error:",H),z(`    : ${H.message}`)}finally{I(!1)}}async function U(){if(m.length===0||D)return;const M=n||w;if(M&&["admin","teacher"].includes(M.role)&&!r){z("/     ."),a(1);return}const Y=()=>{const H=new Date,V=9*60*60*1e3;return new Date(H.getTime()+V).toISOString().replace("Z","+09:00")};I(!0);try{const{data:H}=await _e.from("bookings").select("session_id, user_id, seat_id").eq("date",c).in("session_id",m.map(O=>O.id));if(H&&H.length>0){const O=H.some(K=>K.seat_id===e.id),Q=H.some(K=>K.user_id===x.id);if(O||Q){z(O?"   .":"      ."),a(2),I(!1),le(),Z();return}}const V=m.map(O=>({user_id:x.id,seat_id:e.id,session_id:O.id,date:c,created_at:Y()})),{error:fe}=await _e.from("bookings").insert(V);fe?(z(` : ${fe.message}`),a(2)):(alert(" ."),t(),window.location.reload())}catch{z("   ")}finally{I(!1)}}const[A,T]=ne.useState(new Date),j=()=>{const M=ro(A),Y=zl(M),H=rr(M),V=xi(Y),fe=na({start:H,end:V});return v.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-4 shadow-sm",children:[v.jsxs("div",{className:"flex items-center justify-between mb-4 px-1",children:[v.jsx("h4",{className:"text-sm font-black text-[#1C1C1E]",children:je(A,"yyyy M",{locale:vr})}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>T(Tf(A)),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",children:v.jsx(bi,{className:"w-4 h-4 text-ios-gray"})}),v.jsx("button",{onClick:()=>T(sc(A,1)),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",children:v.jsx(an,{className:"w-4 h-4 text-ios-gray"})})]})]}),v.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[["","","","","","",""].map(O=>v.jsx("div",{className:"text-center text-[10px] font-bold text-ios-gray/50 py-1",children:O},O)),fe.map((O,Q)=>{const K=je(O,"yyyy-MM-dd"),ce=C(K),te=c===K,R=Ji(ro(O),M),ue=Lp(O);return v.jsx("button",{disabled:!ce.ok,onClick:()=>{d(K),s&&s(K)},className:`
                  h-9 w-full rounded-lg flex flex-col items-center justify-center transition-all relative
                  ${te?"bg-[#1C1C1E] text-white shadow-md z-10":""}
                  ${!te&&R&&ce.ok?"hover:bg-gray-100 text-[#1C1C1E] font-black":""}
                  ${!te&&ce.ok&&!R?"text-ios-gray/40 font-black":""}
                  ${ce.ok?"":"opacity-20 cursor-not-allowed text-ios-gray grayscale"}
                  ${!te&&ue?"border border-ios-indigo text-ios-indigo font-black":""}
                `,children:v.jsx("span",{className:"text-xs",children:je(O,"d")})},Q)})]}),v.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-50 flex items-center gap-4 px-1",children:[v.jsxs("div",{className:"flex items-center gap-1.5",children:[v.jsx("div",{className:"w-2 h-2 rounded-full bg-[#1C1C1E]/10"}),v.jsx("span",{className:"text-[10px] font-bold text-ios-gray/70",children:""})]}),v.jsxs("div",{className:"flex items-center gap-1.5",children:[v.jsx("div",{className:"w-2 h-2 rounded-full bg-ios-indigo/20"}),v.jsx("span",{className:"text-[10px] font-bold text-ios-indigo/70",children:""})]})]})]})};return v.jsxs("div",{className:"bg-white border border-gray-100 border-b-0 rounded-t-[6px] rounded-b-none pt-[10px] px-6 pb-6 lg:px-8 lg:pb-8 space-y-5 animate-spring-up overflow-hidden relative h-full",children:[v.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-ios-indigo/5 blur-2xl -z-10"}),v.jsxs("div",{className:"bg-gray-50/50 rounded-[6px] mt-[10px] pt-4 px-4 pb-4 flex items-center gap-4 border border-gray-100",children:[v.jsx("div",{className:"w-12 h-12 rounded-[6px] bg-white text-[#000000] flex items-center justify-center font-black text-sm border border-gray-200 shadow-sm",children:e?e.display_number||e.seat_number:"?"}),v.jsxs("div",{children:[v.jsx("p",{className:"text-[9px] font-black text-[#000000] uppercase tracking-[0.2em] mb-0.5 opacity-50",children:"  "}),v.jsx("p",{className:"text-base font-black text-[#1C1C1E]",children:e?`Zone ${e.zone_name}`:"  "})]})]}),v.jsx("div",{className:"flex items-center gap-2",children:[1,2,3].map(M=>v.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-all duration-700 ${o>=M?"bg-[#1C1C1E]":"bg-gray-100"}`},M))}),o===1&&v.jsxs("div",{className:"space-y-6",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center",children:v.jsx(qs,{className:"w-5 h-5 text-ios-indigo"})}),v.jsx("h3",{className:"text-xl font-black tracking-tight text-[#1C1C1E]",children:"  "})]}),v.jsxs("div",{className:"space-y-4",children:[j(),!C(c).ok&&v.jsxs("div",{className:"p-4 bg-ios-rose/5 border border-ios-rose/10 rounded-xl flex items-center gap-2 animate-shake",children:[v.jsx(ti,{className:"w-4 h-4 text-ios-rose"}),v.jsx("p",{className:"text-[11px] font-black text-ios-rose italic",children:C(c).msg})]}),v.jsxs("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-100 text-center",children:[v.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:" "}),v.jsx("p",{className:"text-lg font-black text-[#1C1C1E]",children:je(jt(c),"yyyy M d (EEEE)",{locale:vr})})]})]}),X&&v.jsxs("div",{className:"p-4 bg-ios-rose/5 border border-ios-rose/10 rounded-[6px] flex items-center gap-2 animate-shake",children:[v.jsx(ti,{className:"w-4 h-4 text-ios-rose"}),v.jsx("p",{className:"text-[11px] font-black text-ios-rose",children:X})]}),v.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-50 flex gap-3",children:[v.jsx("button",{onClick:t,className:"flex-1 py-3.5 rounded-xl text-sm font-black text-ios-gray bg-gray-50 hover:bg-gray-100 transition-all ios-tap",children:""}),v.jsx("button",{disabled:!C(c).ok||!e,onClick:L,className:`flex-[1.5] py-3.5 rounded-xl text-sm font-black text-white transition-all shadow-lg ios-tap ${C(c).ok&&e?"bg-[#1C1C1E] shadow-black/10 hover:bg-gray-800":"bg-gray-200 cursor-not-allowed shadow-none"}`,children:" "})]})]}),o===2&&v.jsxs("div",{className:"space-y-6",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center",children:v.jsx(es,{className:"w-5 h-5 text-ios-indigo"})}),v.jsx("h3",{className:"text-xl font-black tracking-tight text-[#1C1C1E]",children:"  "})]}),v.jsx("p",{className:"text-[11px] font-black text-ios-gray px-1",children:"      . (  )"}),v.jsx("div",{className:"grid grid-cols-1 gap-3",children:u.map(M=>{var Q;const Y=jt(c).getDay(),H=b.operatingRules.some(K=>K.session_id===M.id&&K.day_of_week===Y),V=S.some(K=>K.session_id===M.id),fe=F.some(K=>K.session_id===M.id),O=m.some(K=>K.id===M.id);return H?v.jsxs("button",{disabled:V||fe,onClick:()=>B(M),className:`p-4 rounded-[6px] border transition-all duration-300 flex items-center justify-between group ios-tap text-left ${O?"border-[#1C1C1E] bg-[#1C1C1E]/5 shadow-sm":V||fe?["admin","teacher"].includes(x==null?void 0:x.role)?"border-red-100 bg-red-50/30":"opacity-30 bg-gray-100 cursor-not-allowed":"border-gray-100 bg-gray-50/50 hover:bg-gray-100/80"}`,children:[v.jsxs("div",{className:"flex-1 flex flex-col items-start",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("p",{className:"font-black text-base text-[#1C1C1E]",children:ae(M.name)}),V&&v.jsx("span",{className:"text-[9px] font-black text-ios-gray bg-gray-200 px-1.5 py-0.5 rounded-full uppercase",children:" "}),!V&&fe&&v.jsxs("div",{className:"flex flex-col items-start gap-1",children:[v.jsx("span",{className:"text-[9px] font-black text-ios-rose bg-ios-rose/10 px-1.5 py-0.5 rounded-full uppercase",children:" "}),["admin","teacher"].includes(w==null?void 0:w.role)&&((Q=F.find(K=>K.session_id===M.id))==null?void 0:Q.profiles)&&v.jsxs("span",{className:"text-[9px] font-bold text-ios-rose/70",children:[F.find(K=>K.session_id===M.id).profiles.username," ",F.find(K=>K.session_id===M.id).profiles.full_name]})]})]}),v.jsxs("p",{className:"text-[10px] font-black text-ios-gray/70 uppercase tracking-tight mt-0.5",children:[M.start_time.slice(0,5)," ~ ",M.end_time.slice(0,5)]})]}),O?v.jsx("div",{className:"w-5 h-5 rounded-full bg-[#1C1C1E] flex items-center justify-center shadow-sm",children:v.jsx(bn,{className:"w-3 h-3 text-white stroke-[3px]"})}):(V||fe)&&["admin","teacher"].includes(x.role)?v.jsx("button",{onClick:K=>N(K,M.id),className:"w-8 h-8 rounded-full bg-red-50 hover:bg-red-100 flex items-center justify-center transition-all group/btn border border-red-200",title:" ",children:v.jsx(ts,{className:"w-4 h-4 text-red-500 group-hover/btn:scale-110 transition-transform"})}):v.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-gray-300 bg-white"})]},M.id):null})}),X&&v.jsxs("div",{className:"p-4 bg-ios-rose/5 border border-ios-rose/10 rounded-[6px] flex items-center gap-2 animate-shake",children:[v.jsx(ti,{className:"w-4 h-4 text-ios-rose"}),v.jsx("p",{className:"text-[11px] font-black text-ios-rose",children:X})]}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>t(),className:"flex-1 bg-gray-100 text-[#1C1C1E] py-4 rounded-[6px] font-black text-xs transition-all hover:bg-gray-200 ios-tap",children:""}),v.jsx("button",{onClick:()=>a(1),className:"flex-1 py-4 bg-gray-100 text-ios-gray rounded-[6px] font-black text-xs ios-tap",children:""}),v.jsxs("button",{disabled:m.length===0,onClick:L,className:"flex-[2] bg-[#1C1C1E] text-white py-4 rounded-[6px] font-black text-xs transition-all shadow-md disabled:opacity-20 ios-tap flex flex-col items-center justify-center leading-tight",children:[v.jsxs("span",{children:[m.length," "]}),v.jsx("span",{className:"opacity-60 text-[10px] mt-0.5",children:""})]})]})]}),o===3&&v.jsxs("div",{className:"space-y-8",children:[v.jsxs("div",{className:"text-center space-y-3",children:[v.jsx("div",{className:"w-12 h-12 rounded-[6px] bg-emerald-50 text-ios-emerald flex items-center justify-center mx-auto border border-emerald-100",children:v.jsx(bn,{className:"w-6 h-6"})}),v.jsxs("div",{className:"space-y-1.5",children:[v.jsx("h3",{className:"text-2xl font-black tracking-tight text-[#1C1C1E]",children:" "}),v.jsx("p",{className:"text-xs text-ios-gray font-medium",children:"    ."})]})]}),v.jsx("div",{className:"space-y-1.5",children:[{label:" ",value:je(jt(c),"yyyy M d (EEEE)",{locale:vr}),color:"text-[#1C1C1E]"},{label:" ",value:m.map(M=>ae(M.name)).join(", "),color:"text-[#1C1C1E]"},{label:" ",value:e.zone_name,color:"text-[#1C1C1E]"},{label:" ",value:`${e.seat_number}`,color:"text-[#1C1C1E]"}].map((M,Y)=>v.jsxs("div",{className:"flex justify-between items-center p-4 rounded-[6px] bg-gray-50 border border-gray-100",children:[v.jsx("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest leading-none",children:M.label}),v.jsx("span",{className:`text-sm font-black text-right max-w-[200px] ${M.color}`,children:M.value})]},Y))}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>t(),className:"flex-1 bg-gray-100 text-[#1C1C1E] py-5 rounded-[6px] font-black text-base transition-all hover:bg-gray-200 ios-tap",children:""}),v.jsxs("button",{disabled:D,onClick:U,className:"flex-[2] bg-[#1C1C1E] text-white py-5 rounded-[6px] font-black text-base transition-all shadow-lg shadow-black/20 flex items-center justify-center gap-3 ios-tap overflow-hidden relative group disabled:opacity-50",children:[D?" ...":" "," ",v.jsx(an,{className:"w-5 h-5"})]})]})]})]})},G6=()=>{const[e,t]=ne.useState([]),[r,n]=ne.useState(!1),[i,s]=ne.useState(""),[l,o]=ne.useState("all"),[a,c]=ne.useState(""),[d,h]=ne.useState(null),[f,u]=ne.useState("id-asc");ne.useEffect(()=>{p()},[]);const p=async()=>{n(!0);const{data:_,error:b}=await _e.from("applicant_pool").select("*").order("name",{ascending:!0});b?console.error("Error fetching applicants:",b):t(_||[]),n(!1)},m=()=>{const _=Es.json_to_sheet([{:"",:""}]);_["!cols"]=[{wch:15},{wch:15}];const b=Es.book_new();Es.book_append_sheet(b,_,""),C_(b,"__.xlsx")},g=async _=>{const b=_.target.files[0];if(!b)return;n(!0);const k=new FileReader;k.onload=async S=>{const E=S.target.result,F=Hd(E,{type:"binary"}),P=F.SheetNames[0],D=F.Sheets[P],X=Es.sheet_to_json(D).map(G=>({name:G.,student_id:String(G.).padStart(5,"0"),role:G.===""?"parent":G.===""?"teacher":G.===""?"admin":"student",status:"applied"})).filter(G=>G.name&&G.student_id),{error:z}=await _e.from("applicant_pool").upsert(X,{onConflict:"name,student_id"});z?alert("  : "+z.message):(alert(`${X.length}   .`),p()),n(!1)},k.readAsBinaryString(b)},x=_=>{if(!_)return null;const b=_.split("/");return b[b.length-1]},y=async(_,b,k="",S=_.role)=>{n(!0);try{if(b==="applied"){const E=[];if(_.student_signature){const P=x(_.student_signature);P&&E.push(_e.storage.from("student-signatures").remove([P]))}if(_.parent_signature){const P=x(_.parent_signature);P&&E.push(_e.storage.from("parent-signatures").remove([P]))}E.length>0&&await Promise.all(E);const{error:F}=await _e.from("applicant_pool").update({status:"applied",rejection_reason:null,phone_number:null,pledge_accepted:!1,privacy_accepted:!1,student_signature:null,parent_signature:null,pledged_at:null}).eq("id",_.id);if(F)throw F}else{const{error:E}=await _e.from("applicant_pool").update({status:b,rejection_reason:k,role:S}).eq("id",_.id);if(E)throw E}p(),h(null),c("")}catch(E){alert(" : "+(E.message||"   "))}finally{n(!1)}},w=e.filter(_=>{const b=_.name.includes(i)||_.student_id.includes(i),k=l==="all"||_.status===l,S=f==="grade-1"?_.student_id.startsWith("1"):f==="grade-2"?_.student_id.startsWith("2"):f==="grade-3"?_.student_id.startsWith("3"):!0;return b&&k&&S}).sort((_,b)=>f==="name-asc"?_.name.localeCompare(b.name):f==="name-desc"?b.name.localeCompare(_.name):f==="id-asc"||f.startsWith("grade")?_.student_id.localeCompare(b.student_id):f==="id-desc"?b.student_id.localeCompare(_.student_id):0);return v.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 flex flex-col h-full overflow-hidden shadow-sm animate-spring-up",children:[v.jsxs("div",{className:"p-6 border-b border-gray-50 flex flex-col md:flex-row md:items-center justify-between gap-4 shrink-0",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center",children:v.jsx(ql,{className:"w-5 h-5 text-ios-indigo"})}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-[14px] font-black text-[#1C1C1E]",children:"    "}),v.jsx("p",{className:"text-[10px] text-ios-gray font-black uppercase tracking-widest mt-0.5",children:"Applicant Pool Management"})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("button",{onClick:m,className:"flex items-center gap-2 bg-white hover:bg-gray-50 text-[#1C1C1E] px-4 py-2.5 rounded-[6px] text-xs font-black transition-all border border-gray-200 ios-tap",children:[v.jsx(dS,{className:"w-4 h-4 text-ios-indigo"})," "]}),v.jsxs("label",{className:"flex items-center gap-2 bg-[#1C1C1E] hover:bg-[#2C2C2E] text-white px-4 py-2.5 rounded-[6px] text-xs font-black transition-all border border-transparent cursor-pointer ios-tap shadow-sm",children:[v.jsx(oC,{className:"w-4 h-4 text-white"})," ",v.jsx("input",{type:"file",className:"hidden",accept:".xlsx,.xls",onChange:g})]})]})]}),v.jsxs("div",{className:"px-6 py-4 bg-gray-50/50 border-b border-gray-50 flex flex-col md:flex-row gap-4 shrink-0",children:[v.jsxs("div",{className:"flex-1 relative",children:[v.jsx(wd,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{type:"text",placeholder:"   ...",value:i,onChange:_=>s(_.target.value),className:"flex-1 bg-white border border-gray-200 rounded-[6px] pl-10 pr-4 py-2 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all"}),v.jsxs("select",{value:f,onChange:_=>u(_.target.value),className:"bg-white border border-gray-200 rounded-[6px] px-3 py-2 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all outline-none cursor-pointer min-w-[140px]",children:[v.jsx("option",{value:"id-asc",children:" ()"}),v.jsx("option",{value:"id-desc",children:" ()"}),v.jsx("option",{value:"name-asc",children:" ()"}),v.jsx("option",{value:"name-desc",children:" ()"}),v.jsx("option",{value:"grade-1",children:"1 ()"}),v.jsx("option",{value:"grade-2",children:"2 ()"}),v.jsx("option",{value:"grade-3",children:"3 ()"})]})]})]}),v.jsx("div",{className:"flex gap-2",children:["all","applied","pending","approved","rejected"].map(_=>v.jsx("button",{onClick:()=>o(_),className:`px-4 py-2 rounded-[6px] text-[10px] font-black uppercase tracking-widest transition-all ${l===_?"bg-[#1C1C1E] text-white shadow-md":"bg-white text-ios-gray border border-gray-200 hover:border-ios-indigo"}`,children:_==="all"?"":_==="applied"?"":_==="pending"?"":_==="approved"?"":""},_))})]}),v.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-hide",children:[v.jsxs("table",{className:"w-full text-left border-collapse",children:[v.jsx("thead",{className:"sticky top-0 bg-gray-50/90 backdrop-blur-sm z-10",children:v.jsxs("tr",{children:[v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100 text-right",children:""})]})}),v.jsx("tbody",{children:w.map(_=>v.jsxs("tr",{className:"hover:bg-gray-50 transition-colors group",children:[v.jsx("td",{className:"px-6 py-4 align-middle text-xs font-mono font-black text-ios-indigo",children:_.student_id}),v.jsx("td",{className:"px-6 py-4 align-middle text-xs font-bold text-[#1C1C1E]",children:_.name}),v.jsx("td",{className:"px-6 py-4 align-middle",children:v.jsx("span",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest",children:"Student"})}),v.jsx("td",{className:"px-6 py-4 align-middle",children:v.jsx("div",{className:"flex items-center gap-1.5 text-xs font-medium text-ios-gray",children:_.phone_number?v.jsxs(v.Fragment,{children:[v.jsx(yd,{className:"w-3 h-3 text-ios-emerald"}),_.phone_number]}):"-"})}),v.jsx("td",{className:"px-6 py-4 align-middle",children:_.pledge_accepted?v.jsxs("div",{className:"flex flex-col gap-0.5",children:[v.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-black text-ios-indigo",children:[v.jsx(aS,{className:"w-3 h-3"})," "]}),v.jsx("span",{className:"text-[9px] text-ios-gray opacity-50 font-mono",children:new Date(_.pledged_at).toLocaleDateString()})]}):v.jsx("span",{className:"text-[10px] font-black text-ios-gray opacity-30",children:""})}),v.jsx("td",{className:"px-6 py-4 align-middle",children:_.status==="applied"?v.jsx("span",{className:"px-2 py-1 rounded-full text-[9px] font-black uppercase tracking-wider bg-gray-100 text-ios-gray",children:" "}):v.jsxs("select",{value:_.status,onChange:b=>y(_,b.target.value),className:`px-2 py-1 rounded-full text-[9px] font-black uppercase tracking-wider border-none focus:ring-1 transition-all cursor-pointer ${_.status==="approved"?"bg-[#ECFDF5] text-[#065F46] focus:ring-emerald-500/20":_.status==="pending"?"bg-[#FFFBEB] text-[#92400E] focus:ring-amber-500/20":_.status==="rejected"?"bg-[#FFF1F2] text-[#9F1239] focus:ring-rose-500/20":"bg-[#F3F4F6] text-[#4B5563] focus:ring-gray-300/20"}`,children:[v.jsx("option",{value:"pending",children:" "}),v.jsx("option",{value:"approved",children:""}),v.jsx("option",{value:"rejected",children:""}),v.jsx("option",{value:"applied",children:"  ()"})]})}),v.jsx("td",{className:"px-6 py-4 align-middle text-right",children:v.jsxs("div",{className:"flex items-center justify-end gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[_.status==="pending"&&v.jsxs(v.Fragment,{children:[v.jsx("button",{onClick:()=>y(_,"approved"),className:"p-1.5 rounded-[4px] bg-ios-emerald/10 text-ios-emerald hover:bg-[#1C1C1E] text-white transition-all ios-tap",title:"",children:v.jsx(bn,{className:"w-3.5 h-3.5"})}),v.jsx("button",{onClick:()=>h(_),className:"p-1.5 rounded-[4px] bg-ios-rose/10 text-ios-rose hover:bg-[#1C1C1E] text-white transition-all ios-tap",title:"",children:v.jsx(Os,{className:"w-3.5 h-3.5"})})]}),v.jsx("button",{className:"p-1.5 rounded-[4px] bg-gray-100 text-ios-gray hover:bg-gray-200 transition-all ios-tap",children:v.jsx(uS,{className:"w-3.5 h-3.5"})})]})})]},_.id))})]}),w.length===0&&v.jsxs("div",{className:"py-20 flex flex-col items-center justify-center text-ios-gray space-y-3",children:[v.jsx(ti,{className:"w-10 h-10 opacity-20"}),v.jsx("p",{className:"text-xs font-black",children:"  ."})]})]}),d&&v.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-50 flex items-center justify-center p-6",children:v.jsx("div",{className:"bg-white rounded-ios w-full max-w-sm shadow-2xl animate-spring-up overflow-hidden",children:v.jsxs("div",{className:"p-6 space-y-4",children:[v.jsxs("h4",{className:"text-[14px] font-black text-[#1C1C1E]",children:[d.name,"   "]}),v.jsx("textarea",{value:a,onChange:_=>c(_.target.value),placeholder:"  ... (:   )",className:"w-full h-32 bg-gray-50 border border-gray-200 rounded-[6px] p-3 text-xs font-bold focus:ring-1 focus:ring-ios-rose transition-all resize-none"}),v.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[v.jsx("button",{onClick:()=>h(null),className:"w-full py-3 bg-gray-100 text-ios-gray rounded-[6px] text-xs font-black ios-tap",children:""}),v.jsx("button",{onClick:()=>y(d,"rejected",a),className:"w-full py-3 bg-[#1C1C1E] text-white rounded-[6px] text-xs font-black shadow-lg shadow-black/20 ios-tap",children:" "})]})]})})}),v.jsx("div",{className:"px-6 py-3 bg-gray-50/50 border-t border-gray-50 flex items-center justify-between shrink-0",children:v.jsxs("div",{className:"flex gap-6",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-ios-indigo"}),v.jsxs("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:[": ",e.length,""]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-ios-amber"}),v.jsxs("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:[": ",e.filter(_=>_.status==="pending").length,""]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-ios-emerald"}),v.jsxs("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:[": ",e.filter(_=>_.status==="approved").length,""]})]})]})})]})},Lx=ne.forwardRef(({penColor:e="#1C1C1E"},t)=>{const r=ne.useRef(null),[n,i]=ne.useState(!1),[s,l]=ne.useState(null);ne.useEffect(()=>{const d=r.current;if(!d)return;const h=d.getContext("2d"),f=window.devicePixelRatio||1,u=d.getBoundingClientRect();d.width=u.width*f,d.height=u.height*f,h.scale(f,f),h.strokeStyle=e,h.lineWidth=10,h.lineCap="round"},[e]),ne.useImperativeHandle(t,()=>({clear:()=>{const d=r.current;d.getContext("2d").clearRect(0,0,d.width,d.height)},getCanvas:()=>r.current,isEmpty:()=>{const d=r.current,h=d.getContext("2d");return!new Uint32Array(h.getImageData(0,0,d.width,d.height).data.buffer).some(u=>u!==0)}}));const o=d=>{const f=r.current.getBoundingClientRect(),u=d.touches?d.touches[0].clientX:d.clientX,p=d.touches?d.touches[0].clientY:d.clientY;return{x:u-f.left,y:p-f.top}},a=d=>{i(!0);const{x:h,y:f}=o(d),u=r.current.getContext("2d");u.strokeStyle=e,u.lineWidth=10,u.lineCap="round",u.beginPath(),u.moveTo(h,f)},c=d=>{const h=o(d);if(d.touches||l(h),!n)return;const f=r.current.getContext("2d");f.lineTo(h.x,h.y),f.stroke()};return v.jsxs("div",{className:"w-full h-full relative cursor-none group",onMouseEnter:()=>!n&&l(null),onMouseLeave:()=>l(null),children:[v.jsx("canvas",{ref:r,onMouseDown:a,onMouseMove:c,onMouseUp:()=>i(!1),onTouchStart:a,onTouchMove:c,onTouchEnd:()=>i(!1),className:"w-full h-full touch-none"}),s&&v.jsx("div",{className:"absolute pointer-events-none rounded-full border border-white/50 shadow-sm",style:{left:s.x,top:s.y,width:"10px",height:"10px",backgroundColor:e,transform:"translate(-50%, -50%)"}})]})}),q6=({onLoginSuccess:e})=>{const[t,r]=ne.useState("student"),[n,i]=ne.useState("login"),[s,l]=ne.useState({name:"",studentId:"",phone:"",password:"",pledgeAccepted:!1,privacyAccepted:!1}),[o,a]=ne.useState(!1),[c,d]=ne.useState(""),[h,f]=ne.useState(""),[u,p]=ne.useState(null),m=tu.useRef(null),g=tu.useRef(null),[x,y]=ne.useState(()=>localStorage.getItem("schoolName")||"GOE");ne.useEffect(()=>{(async()=>{const{data:I}=await _e.from("configs").select("value").eq("key","school_info").single();if(I&&I.value.name){const X=I.value.name.split(" ")[0];y(X),localStorage.setItem("schoolName",I.value.name)}})()},[]);const w=()=>d(""),_=D=>D.replace(/[^0-9]/g,"").replace(/^(\d{0,3})(\d{0,4})(\d{0,4})$/g,"$1-$2-$3").replace(/(-{1,2})$/g,""),b=D=>{r(D),i("login"),l({...s,name:"",studentId:"",phone:"",password:""}),w()},k=async D=>{D.preventDefault(),a(!0),d(""),t==="teacher"?await S():await E(),a(!1)},S=async()=>{const D=`${s.name}@goe.edu`,{data:I,error:X}=await _e.auth.signInWithPassword({email:D,password:s.password});if(X){d("    .");return}const{data:z}=await _e.from("profiles").select("*").eq("id",I.user.id).single();z?e({...z,full_name:z.full_name||s.name}):d("    .")},E=async()=>{const{data:D,error:I}=await _e.from("applicant_pool").select("*").eq("name",s.name).eq("student_id",s.studentId).maybeSingle();if(I||!D){d("   /  .");return}if(p(D),t==="parent"&&(!D.phone_number||!D.pledge_accepted)){d("     .");return}D.status==="applied"?(l(X=>({...X,phone:"",pledgeAccepted:!1,privacyAccepted:!1})),i("pledge")):D.status==="pending"?i("pending"):D.status==="rejected"?(f(D.rejection_reason||"  ,   ."),i("rejected")):D.status==="approved"&&i("challenge")},F=async D=>{var I,X;if(D.preventDefault(),!s.pledgeAccepted||!s.privacyAccepted){d("    .");return}if(s.phone.length<10){d("   .");return}if((I=m.current)!=null&&I.isEmpty()||(X=g.current)!=null&&X.isEmpty()){d("     .");return}a(!0),d("");try{const z=async(Z,C)=>{const L=Z.getCanvas();return new Promise((B,N)=>{L.toBlob(async U=>{if(!U){N(new Error("    ."));return}const A=`${u.student_id}_${Date.now()}.png`,{data:T,error:j}=await _e.storage.from(C).upload(A,U,{contentType:"image/png",upsert:!0});if(j)N(j);else{const{data:{publicUrl:M}}=_e.storage.from(C).getPublicUrl(A);B(M)}},"image/png")})},G=await z(m.current,"student-signatures"),ae=await z(g.current,"parent-signatures"),{error:le}=await _e.from("applicant_pool").update({phone_number:s.phone,pledge_accepted:!0,privacy_accepted:!0,student_signature:G,parent_signature:ae,pledged_at:new Date().toISOString(),status:"pending"}).eq("id",u.id);if(le)throw le;i("pending")}catch(z){d("    : "+(z.message||"   "))}finally{a(!1)}},P=async D=>{D.preventDefault(),s.phone===u.phone_number?e({...u,full_name:u.name,role:t}):d("     .")};return v.jsx("div",{className:"min-h-screen bg-[#F2F2F7] flex items-center justify-center p-6 font-sans",children:v.jsxs("div",{className:"w-full max-w-md bg-white rounded-[2rem] shadow-2xl shadow-ios-indigo/10 overflow-hidden animate-spring-up border border-gray-100",children:[v.jsxs("div",{className:"bg-white p-10 text-[#1C1C1E] relative overflow-hidden border-b border-gray-100",children:[v.jsxs("div",{className:"relative z-10 space-y-2",children:[v.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gray-50 flex items-center justify-center mb-6 border border-gray-100 shadow-sm overflow-hidden",children:v.jsx(Eu,{className:"w-7 h-7 text-ios-indigo"})}),v.jsx("h1",{className:"text-3xl font-black tracking-tighter leading-none",children:x}),v.jsx("p",{className:"text-[10px] font-black tracking-[0.3em] uppercase text-ios-indigo",children:"Study Cafe System"})]}),v.jsx("div",{className:"absolute -right-10 -top-10 w-40 h-40 bg-ios-indigo/5 rounded-full blur-3xl"})]}),v.jsxs("div",{className:"p-8 space-y-8",children:[n==="login"&&v.jsx("div",{className:"flex bg-gray-50 p-1.5 rounded-2xl gap-1",children:[{id:"student",label:"",icon:xS},{id:"parent",label:"",icon:ql},{id:"teacher",label:"",icon:Yk}].map(D=>v.jsxs("button",{onClick:()=>b(D.id),className:`flex-1 flex items-center justify-center gap-2 py-3 rounded-xl text-xs font-black transition-all ${t===D.id?"bg-white text-ios-indigo shadow-md":"text-ios-gray hover:text-[#1C1C1E]"}`,children:[v.jsx(D.icon,{className:`w-3.5 h-3.5 ${t===D.id?"text-ios-indigo":"text-ios-gray"}`}),D.label]},D.id))}),n==="login"&&v.jsxs("form",{onSubmit:k,className:"space-y-6",children:[v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"relative group",children:[v.jsx(_l,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),v.jsx("input",{required:!0,type:"text",placeholder:t==="teacher"?" (ID)":" (ID)",value:s.name,onChange:D=>l({...s,name:D.target.value}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none caret-ios-indigo"})]}),v.jsxs("div",{className:"relative group",children:[v.jsx(NS,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),v.jsx("input",{required:!0,type:t==="teacher"?"password":"text",placeholder:t==="teacher"?" (PW)":" 5 (PW)",maxLength:t==="teacher"?void 0:5,value:t==="teacher"?s.password:s.studentId,onChange:D=>l(t==="teacher"?{...s,password:D.target.value}:{...s,studentId:D.target.value}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none caret-ios-indigo"})]})]}),c&&v.jsxs("div",{className:"flex items-center gap-2 text-ios-rose bg-ios-rose/5 p-4 rounded-xl animate-shake",children:[v.jsx(ti,{className:"w-4 h-4 shrink-0"}),v.jsx("p",{className:"text-[11px] font-black",children:c})]}),v.jsx("button",{type:"submit",disabled:o,className:"w-full py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-sm flex items-center justify-center gap-2 hover:scale-[1.02] active:scale-[0.98] transition-all shadow-xl shadow-gray-200/50 ios-tap disabled:opacity-50",children:o?v.jsx(rh,{className:"w-4 h-4 animate-spin"}):v.jsxs(v.Fragment,{children:[" ",v.jsx(zk,{className:"w-4 h-4"})]})})]}),n==="pledge"&&v.jsxs("form",{onSubmit:F,className:"space-y-6 animate-spring-up",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight text-center",children:"  "}),v.jsx("p",{className:"text-[11px] text-ios-gray text-center font-bold",children:"         ,           ."})]}),v.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 max-h-48 overflow-y-auto space-y-4 text-[11px] font-bold text-ios-gray leading-relaxed border border-gray-100",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[    ]"}),v.jsx("p",{children:"1.     ,       ."}),v.jsx("p",{children:"2.        ."}),v.jsx("p",{children:"3.       , ,      ."}),v.jsx("p",{children:"4.      ,         ."}),v.jsx("p",{children:"5.       ,       ."})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[    ]"}),v.jsx("p",{children:"1.    ,        ."}),v.jsx("p",{children:"2.         ."}),v.jsx("p",{children:"3.          ."})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[   ]"}),v.jsx("p",{children:"1.             ."}),v.jsx("p",{children:"2.          ."})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[   ]"}),v.jsx("p",{children:"1.        ."}),v.jsx("p",{children:"2.         ,    ."}),v.jsx("p",{children:"3.   ,  ."})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[    ]"}),v.jsx("p",{children:"1.             ."}),v.jsx("p",{children:"2.          ."})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[  ]"}),v.jsx("p",{children:"1.            ."}),v.jsx("p",{children:"2.        ,        ."})]})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"relative group",children:[v.jsx(yd,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),v.jsx("input",{required:!0,type:"tel",autoComplete:"off",placeholder:"   ( )",value:s.phone,onChange:D=>l({...s,phone:_(D.target.value)}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none caret-ios-indigo"})]}),v.jsxs("label",{className:"flex items-start gap-3 p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100 transition-all border border-transparent hover:border-gray-200",children:[v.jsx("input",{type:"checkbox",checked:s.pledgeAccepted,onChange:D=>l({...s,pledgeAccepted:D.target.checked}),className:"mt-0.5"}),v.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:"      . ()"})]}),v.jsxs("label",{className:"flex items-start gap-3 p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100 transition-all border border-transparent hover:border-gray-200",children:[v.jsx("input",{type:"checkbox",checked:s.privacyAccepted,onChange:D=>l({...s,privacyAccepted:D.target.checked}),className:"mt-0.5"}),v.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:"    . ()"})]}),v.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-100",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:" "}),v.jsxs("button",{type:"button",onClick:()=>{var D;return(D=m.current)==null?void 0:D.clear()},className:"text-[10px] text-ios-gray font-bold flex items-center gap-1 hover:text-ios-rose transition-colors",children:[v.jsx(em,{className:"w-3 h-3"})," "]})]}),v.jsx("div",{className:"bg-gray-50 rounded-2xl border border-gray-100 overflow-hidden h-32 relative",children:v.jsx(Lx,{ref:m,penColor:"#1C1C1E"})})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:" "}),v.jsxs("button",{type:"button",onClick:()=>{var D;return(D=g.current)==null?void 0:D.clear()},className:"text-[10px] text-ios-gray font-bold flex items-center gap-1 hover:text-ios-rose transition-colors",children:[v.jsx(em,{className:"w-3 h-3"})," "]})]}),v.jsx("div",{className:"bg-gray-50 rounded-2xl border border-gray-100 overflow-hidden h-32 relative",children:v.jsx(Lx,{ref:g,penColor:"#1C1C1E"})}),v.jsx("p",{className:"text-[10px] text-ios-rose font-black text-center pt-1 animate-pulse",children:".     ."})]})]})]}),c&&v.jsx("div",{className:"text-ios-rose text-[11px] font-black text-center",children:c}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{type:"button",onClick:()=>i("login"),className:"flex-1 py-4 bg-gray-100 text-ios-gray rounded-2xl font-black text-sm ios-tap",children:""}),v.jsx("button",{type:"submit",disabled:o,className:"flex-[2] py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-sm shadow-xl shadow-gray-200/50 ios-tap",children:o?v.jsx(rh,{className:"w-4 h-4 animate-spin mx-auto"}):"   "})]})]}),n==="pending"&&v.jsxs("div",{className:"text-center space-y-6 py-4 animate-spring-up",children:[v.jsx("div",{className:"w-20 h-20 rounded-[2rem] bg-ios-amber/10 flex items-center justify-center mx-auto mb-2 border border-ios-amber/20 shadow-inner",children:v.jsx(rh,{className:"w-10 h-10 text-ios-amber animate-spin"})}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:"  "}),v.jsx("p",{className:"text-xs text-ios-gray font-medium leading-relaxed px-4",children:"   .      ."})]}),v.jsx("button",{onClick:()=>i("login"),className:"text-xs font-black text-ios-indigo uppercase tracking-widest",children:""})]}),n==="rejected"&&v.jsxs("div",{className:"text-center space-y-6 py-4 animate-spring-up",children:[v.jsx("div",{className:"w-20 h-20 rounded-[2rem] bg-ios-rose/10 flex items-center justify-center mx-auto mb-2 border border-ios-rose/20 shadow-inner",children:v.jsx(ti,{className:"w-10 h-10 text-ios-rose"})}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:" "}),v.jsxs("div",{className:"bg-ios-rose/5 p-4 rounded-xl mt-4 max-w-[280px] mx-auto text-left",children:[v.jsx("p",{className:"text-[9px] font-black text-ios-rose/70 uppercase mb-1 tracking-widest",children:""}),v.jsx("p",{className:"text-[11px] font-bold text-ios-rose leading-relaxed",children:h})]})]}),v.jsx("button",{onClick:()=>i("login"),className:"w-full py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-xs shadow-xl shadow-gray-200/50 ios-tap uppercase tracking-widest",children:" "})]}),n==="challenge"&&v.jsxs("form",{onSubmit:P,className:"space-y-6 animate-spring-up",children:[v.jsxs("div",{className:"text-center space-y-4",children:[v.jsx("div",{className:"w-20 h-20 rounded-[2rem] bg-ios-emerald/10 flex items-center justify-center mx-auto border border-ios-emerald/20 shadow-inner",children:v.jsx($0,{className:"w-10 h-10 text-ios-emerald"})}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:t==="parent"?" ":" "}),v.jsx("p",{className:"text-[11px] text-ios-gray font-bold",children:t==="parent"?"   .":"   ."})]})]}),v.jsxs("div",{className:"relative group",children:[v.jsx(yd,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),v.jsx("input",{required:!0,type:"tel",placeholder:t==="parent"?"  ":"  ",value:s.phone,onChange:D=>l({...s,phone:_(D.target.value)}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none caret-ios-indigo"})]}),c&&v.jsx("div",{className:"text-ios-rose text-[11px] font-black text-center animate-shake",children:c}),v.jsx("button",{type:"submit",className:"w-full py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-sm shadow-xl shadow-gray-200/50 ios-tap",children:t==="parent"?"  ":"  "})]})]})]})})},K6=({onLogout:e,currentUser:t})=>{const[r,n]=ne.useState("home"),[i,s]=ne.useState("GOE STUDY CAFE"),[l,o]=ne.useState({bookings:[],attendance:[],currentSession:null,nextSession:null}),[a,c]=ne.useState({}),[d,h]=ne.useState(new Date),[f,u]=ne.useState({present:0,late:0,absent:0,history:[]}),[p,m]=ne.useState(!0),g=()=>h(S=>$_(S)),x=()=>h(S=>Cf(S,1)),y=(S,E)=>{var Z,C;if(!E||!E.bookings.length)return null;const F=new Date,P=je(F,"yyyy-MM-dd"),{bookings:D,attendance:I}=E;if(S>P)return{label:"",color:"text-ios-indigo bg-ios-indigo/10"};if(S<P)return I.length?I.some(B=>B.status==="late")?{label:"",color:"text-ios-amber bg-ios-amber/10"}:{label:"",color:"text-ios-emerald bg-ios-emerald/10"}:{label:"",color:"text-ios-rose bg-ios-rose/10"};const X=je(F,"HH:mm:ss"),z=[...D].sort((L,B)=>{var N,U;return(((N=L.sessions)==null?void 0:N.start_time)||"").localeCompare(((U=B.sessions)==null?void 0:U.start_time)||"")});if(!z.length)return null;const G=(Z=z[0].sessions)==null?void 0:Z.start_time,ae=(C=z[z.length-1].sessions)==null?void 0:C.end_time;if(ae&&X>ae)return{label:"",color:"text-gray-500 bg-gray-100"};if(G&&X<G)return{label:"",color:"text-ios-indigo bg-ios-indigo/10"};const le=z.find(L=>{const B=L.sessions;return B&&X>=B.start_time&&X<=B.end_time});return le?I.find(B=>B.booking_id===le.id)?{label:"",color:"text-white bg-ios-emerald"}:{label:"",color:"text-ios-rose bg-ios-rose/10"}:{label:"",color:"text-ios-amber bg-ios-amber/10"}},w=()=>{const{bookings:S,attendance:E,currentSession:F}=l;if(S.length===0)return{label:"  ",color:"bg-gray-100 text-gray-400",sub:"   ."};const P=S.find(I=>I.session_id===(F==null?void 0:F.id)),D=E.length>0;if(P)return E.find(X=>X.booking_id===P.id)?{label:" ",color:"bg-ios-emerald text-white",sub:`${P.sessions.name}  `}:{label:"",color:"bg-ios-rose text-white",sub:"    ."};if(D){const I=[...E].sort((X,z)=>(z.timestamp_in||"").localeCompare(X.timestamp_in||""))[0];return I.timestamp_out?{label:" ",color:"bg-gray-800 text-white",sub:`${je(new Date(I.timestamp_out),"HH:mm")}  `}:{label:" ",color:"bg-ios-amber text-white",sub:"    ."}}return{label:" ",color:"bg-ios-indigo text-white",sub:"   ."}},_=()=>{var F,P;const{bookings:S}=l;if(S.length===0)return"-";const E=[...S].sort((D,I)=>{var X,z;return(((X=D.sessions)==null?void 0:X.end_time)||"").localeCompare(((z=I.sessions)==null?void 0:z.end_time)||"")}).pop();return((P=(F=E==null?void 0:E.sessions)==null?void 0:F.end_time)==null?void 0:P.substring(0,5))||"-"};ne.useEffect(()=>{const S=async()=>{if(!t)return;const P=je(new Date,"yyyy-MM-dd"),{data:D}=await _e.from("bookings").select("*, sessions (*), attendance (*)").eq("user_id",t.id).eq("date",P).order("session_id",{ascending:!0}),I=rr(d,{weekStartsOn:1}),X=xi(d,{weekStartsOn:1}),{data:z}=await _e.from("bookings").select(`
          *,
          sessions (id, start_time, end_time),
          attendance (id, booking_id, status, timestamp_in, timestamp_out)
        `).eq("user_id",t.id).gte("date",je(I,"yyyy-MM-dd")).lte("date",je(X,"yyyy-MM-dd"));if(z){const ae={};z.forEach(le=>{const Z=le.date;ae[Z]||(ae[Z]={bookings:[],attendance:[]}),ae[Z].bookings.push(le),le.attendance&&le.attendance.length>0&&ae[Z].attendance.push(...le.attendance)}),c(ae)}const{data:G}=await _e.from("sessions").select("*").order("start_time");if(G){const le=je(new Date,"HH:mm:ss"),Z=G.find(L=>le>=L.start_time&&le<=L.end_time),C=G.find(L=>L.start_time>le);o({bookings:D||[],attendance:(D==null?void 0:D.flatMap(L=>L.attendance))||[],currentSession:Z,nextSession:C})}if(r==="stats"||p){const ae=je(iM(new Date),"yyyy-MM-dd"),le=je(oM(new Date),"yyyy-MM-dd"),{data:Z}=await _e.from("bookings").select("id, date, attendance (status, timestamp_in)").eq("user_id",t.id).gte("date",ae).lte("date",le);if(Z){const C={present:0,late:0,absent:0},L=[];Z.forEach(B=>{var U;const N=(U=B.attendance)==null?void 0:U[0];N&&(N.status==="present"?C.present++:N.status==="late"?C.late++:N.status==="absent"&&C.absent++,L.push({date:B.date,status:N.status,time:N.timestamp_in?je(new Date(N.timestamp_in),"HH:mm"):"-"}))}),u({...C,history:L.sort((B,N)=>N.date.localeCompare(B.date)).slice(0,15)})}}m(!1)},E=async()=>{var D;const{data:P}=await _e.from("configs").select("value").eq("key","school_info").single();(D=P==null?void 0:P.value)!=null&&D.name&&s(P.value.name)};S(),E();const F=setInterval(S,6e4);return()=>clearInterval(F)},[t,d,r,p]);const b=()=>{var P,D;const S=w(),E=_(),F=(P=l.attendance.find(I=>I.timestamp_out))==null?void 0:P.timestamp_out;return v.jsxs("div",{className:"h-full p-4 flex flex-col gap-2 animate-fade-in relative scrollbar-hide",children:[v.jsxs("div",{className:"flex-[2] glass-card pt-8 pb-5 px-5 flex flex-col items-center text-center relative overflow-hidden",children:[v.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-ios-indigo/10 blur-3xl -z-10"}),v.jsx("div",{className:`px-6 py-2 rounded-full text-[13px] font-black uppercase tracking-widest ${S.color} shadow-lg shadow-current/10`,children:S.label}),v.jsx("div",{className:"flex-1 flex flex-col items-center justify-center space-y-3",children:v.jsx("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:t==null?void 0:t.full_name})}),v.jsxs("div",{className:"w-full grid grid-cols-3 gap-2 pt-4 border-t border-gray-50",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("p",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:" "}),v.jsx("p",{className:"text-xl font-black text-[#1C1C1E]",children:((D=l.bookings[0])==null?void 0:D.seat_number)||"-"})]}),v.jsxs("div",{className:"space-y-1 border-l border-gray-50",children:[v.jsx("p",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:" "}),v.jsx("p",{className:"text-xl font-black text-[#1C1C1E] underline decoration-ios-indigo/30 underline-offset-4",children:E})]}),v.jsxs("div",{className:"space-y-1 border-l border-gray-50",children:[v.jsx("p",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:" "}),v.jsx("p",{className:"text-xl font-black text-ios-indigo",children:F?je(new Date(F),"HH:mm"):"--:--"})]})]})]}),v.jsxs("div",{className:"flex-1 glass-card p-5 flex flex-col justify-center space-y-2",children:[v.jsxs("div",{className:"flex items-center justify-between mb-1",children:[v.jsx("h3",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest",children:"  "}),v.jsxs("div",{className:"flex items-center gap-1",children:[v.jsx("div",{className:"w-1 h-1 rounded-full bg-ios-emerald shadow-[0_0_8px_rgba(52,199,89,0.5)]"}),v.jsx("span",{className:"text-[8px] font-black text-ios-emerald uppercase",children:"Live"})]})]}),v.jsx("div",{className:"space-y-2 overflow-y-auto max-h-[120px] pr-1 scrollbar-hide",children:l.bookings.length>0?l.bookings.map((I,X)=>{var ae,le,Z,C;const z=(ae=I.attendance)==null?void 0:ae[0],G=z?z.status==="present"?{label:"",color:"text-ios-emerald bg-ios-emerald/10"}:z.status==="late"?{label:"",color:"text-ios-amber bg-ios-amber/10"}:{label:"",color:"text-ios-rose bg-ios-rose/10"}:{label:"",color:"text-gray-400 bg-gray-50"};return v.jsxs("div",{className:`flex items-center justify-between py-2 ${X!==l.bookings.length-1?"border-b border-gray-50":""}`,children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${(z==null?void 0:z.status)==="present"?"bg-ios-emerald":(z==null?void 0:z.status)==="late"?"bg-ios-amber":"bg-gray-200"}`}),v.jsxs("div",{children:[v.jsx("p",{className:"text-[11px] font-black text-[#1C1C1E] leading-none mb-1",children:(le=I.sessions)==null?void 0:le.name}),v.jsxs("p",{className:"text-[9px] font-bold text-ios-gray leading-none",children:[(Z=I.sessions)==null?void 0:Z.start_time.substring(0,5)," - ",(C=I.sessions)==null?void 0:C.end_time.substring(0,5)]})]})]}),v.jsx("span",{className:`text-[9px] font-black px-2 py-0.5 rounded-full ${G.color}`,children:G.label})]},I.id)}):v.jsx("div",{className:"flex flex-col items-center justify-center py-4 bg-gray-50 rounded-2xl",children:v.jsx("p",{className:"text-[10px] font-black text-ios-gray",children:"   ."})})})]}),v.jsxs("div",{className:"flex-1 glass-card p-5 flex flex-col justify-center items-center",children:[v.jsxs("div",{className:"w-full flex items-center justify-between mb-3 px-1",children:[v.jsx("h3",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest",children:"   "}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("span",{className:"text-[10px] font-black text-[#1C1C1E]",children:[je(rr(new Date,{weekStartsOn:1}),"MM.dd")," - ",je(xi(new Date,{weekStartsOn:1}),"MM.dd")]}),v.jsx("button",{onClick:g,className:"p-1 hover:text-black text-gray-400 ios-tap",children:v.jsx(bi,{className:"w-3 h-3"})}),v.jsx("button",{onClick:x,className:"p-1 hover:text-black text-gray-400 ios-tap",children:v.jsx(an,{className:"w-3 h-3"})})]})]}),v.jsx("div",{className:"flex justify-between items-center w-full",children:na({start:rr(d,{weekStartsOn:1}),end:xi(d,{weekStartsOn:1})}).map((I,X)=>{const z=je(I,"yyyy-MM-dd"),G=a[z],ae=y(z,G),le=Ji(I,new Date);return v.jsxs("div",{className:"flex flex-col items-center gap-1.5",children:[v.jsx("span",{className:`text-[8px] font-black ${le?"text-[#1C1C1E]":"text-gray-300"}`,children:["","","","","","",""][X]}),v.jsx("div",{className:`w-7 h-7 rounded-full flex items-center justify-center text-[9px] font-black transition-all ${le?"bg-[#1C1C1E] text-white shadow-md":"bg-white border border-gray-100 text-gray-300"}`,children:je(I,"d")}),v.jsx("div",{className:"h-3 flex items-center justify-center",children:ae?v.jsx("span",{className:`text-[7px] font-bold px-1 py-0.5 rounded-full whitespace-nowrap ${ae.color}`,children:ae.label}):v.jsx("div",{className:"w-1 h-1 rounded-full bg-transparent"})})]},X)})})]})]})},k=()=>v.jsxs("div",{className:"p-5 space-y-6 animate-fade-in scrollbar-hide",children:[v.jsxs("div",{className:"glass-card p-8 relative overflow-hidden",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-6 text-ios-indigo",children:[v.jsx(Jg,{className:"w-4 h-4"}),v.jsx("h3",{className:"text-xs font-black uppercase tracking-widest",children:"   "})]}),v.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[v.jsxs("div",{className:"flex flex-col items-center p-4 bg-ios-emerald/5 rounded-apple",children:[v.jsx("span",{className:"text-[10px] font-black text-ios-emerald uppercase opacity-60 mb-1",children:""}),v.jsx("span",{className:"text-2xl font-black text-ios-emerald",children:f.present})]}),v.jsxs("div",{className:"flex flex-col items-center p-4 bg-ios-amber/5 rounded-apple",children:[v.jsx("span",{className:"text-[10px] font-black text-ios-amber uppercase opacity-60 mb-1",children:""}),v.jsx("span",{className:"text-2xl font-black text-ios-amber",children:f.late})]}),v.jsxs("div",{className:"flex flex-col items-center p-4 bg-ios-rose/5 rounded-apple",children:[v.jsx("span",{className:"text-[10px] font-black text-ios-rose uppercase opacity-60 mb-1",children:""}),v.jsx("span",{className:"text-2xl font-black text-ios-rose",children:f.absent})]})]})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-center justify-between px-2",children:[v.jsx("h3",{className:"text-xs font-black text-[#1C1C1E] uppercase tracking-widest",children:"  "}),v.jsx("span",{className:"text-[10px] font-bold text-ios-gray",children:"TOP 15"})]}),v.jsx("div",{className:"space-y-2",children:f.history.length>0?f.history.map((S,E)=>v.jsxs("div",{className:"bg-white p-4 rounded-apple border border-gray-100 shadow-sm flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:`w-2 h-2 rounded-full ${S.status==="present"?"bg-ios-emerald":S.status==="late"?"bg-ios-amber":"bg-ios-rose"}`}),v.jsxs("div",{className:"space-y-0.5",children:[v.jsx("p",{className:"text-xs font-black text-[#1C1C1E]",children:je(new Date(S.date),"M d (EEE)",{locale:vr})}),v.jsx("p",{className:"text-[10px] font-bold text-ios-gray uppercase tracking-widest",children:S.status==="present"?" ":S.status==="late"?"":""})]})]}),v.jsxs("div",{className:"text-right",children:[v.jsx("p",{className:"text-xs font-black text-ios-gray",children:S.time!=="-"?S.time:"--:--"}),v.jsx("p",{className:"text-[9px] font-bold text-ios-gray/40 uppercase tracking-tighter",children:"Entry Time"})]})]},E)):v.jsxs("div",{className:"py-20 text-center space-y-2",children:[v.jsx(qs,{className:"w-10 h-10 text-gray-200 mx-auto"}),v.jsx("p",{className:"text-xs font-black text-ios-gray",children:"  ."})]})})]})]});return v.jsxs("div",{className:"mobile-container flex flex-col bg-[#F2F2F7] h-screen overflow-hidden font-sans pb-[safe-area-inset-bottom]",children:[v.jsxs("header",{className:"flex-none glass-header px-6 pt-10 pb-4 flex items-center justify-between shadow-sm",children:[v.jsxs("div",{className:"flex flex-col",children:[v.jsx("h1",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:i.split(" ")[0]}),v.jsx("p",{className:"text-[10px] font-black text-ios-indigo tracking-[0.2em] uppercase opacity-70",children:"PARENT VIEW"})]}),v.jsx("button",{onClick:e,className:"p-3 bg-gray-200/20 text-ios-gray hover:text-ios-rose hover:bg-ios-rose/10 rounded-apple-md transition-all ios-tap border border-white/40 backdrop-blur-xl",children:v.jsx(uf,{className:"w-5 h-5"})})]}),v.jsx("main",{className:"flex-1 overflow-hidden relative",children:p?v.jsxs("div",{className:"h-full flex flex-col items-center justify-center space-y-4 animate-pulse",children:[v.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-[2rem]"}),v.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded-full"})]}):v.jsx("div",{className:"h-full overflow-y-auto scrollbar-hide",children:r==="home"?b():k()})}),v.jsx("nav",{className:"flex-none glass-material pb-[calc(1rem+env(safe-area-inset-bottom))] pt-3 px-16 flex justify-around items-center z-50 shadow-[0_-4px_40px_rgba(0,0,0,0.03)] border-t border-white/40",children:[{id:"home",icon:ry,label:""},{id:"stats",icon:Jg,label:""}].map(S=>v.jsxs("button",{onClick:()=>n(S.id),className:`flex flex-col items-center justify-center p-2 rounded-apple-md transition-all duration-300 w-20 group ios-tap ${r===S.id?"text-[#1C1C1E]":"text-gray-300 hover:text-gray-500"}`,children:[v.jsx(S.icon,{className:`w-7 h-7 stroke-[2.5px] ${r===S.id?"fill-ios-indigo/10":"fill-transparent"}`}),v.jsx("span",{className:"text-[9px] font-black mt-1",children:S.label})]},S.id))})]})},J6=()=>{const[e,t]=ne.useState(new Date),[r,n]=ne.useState([]),[i,s]=ne.useState(null),[l,o]=ne.useState([]),[a,c]=ne.useState([]),[d,h]=ne.useState([]),[f,u]=ne.useState([]),[p,m]=ne.useState(!0),[g,x]=ne.useState(!1),[y,w]=ne.useState(!1),[_,b]=ne.useState(!1),[k,S]=ne.useState({date:je(new Date,"yyyy-MM-dd"),reason:"",is_closed:!0}),[E,F]=ne.useState(new Date().getFullYear()),[P,D]=ne.useState(new Date().getFullYear());ne.useEffect(()=>{I()},[]);const I=async()=>{const{data:j}=await _e.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});j&&j.length>0&&(n(j),s(j[0].id))};ne.useEffect(()=>{i&&X(E,i)},[E,i]);const X=async(j,M)=>{m(!0);const[Y,H,V,fe]=await Promise.all([_e.from("operation_quarters").select("*").eq("academic_year",j).order("quarter",{ascending:!0}),_e.from("operation_defaults").select("*").eq("zone_id",M).order("day_of_week",{ascending:!0}),_e.from("operation_exceptions").select("*").eq("zone_id",M).order("exception_date",{ascending:!0}),_e.from("sessions").select("*").eq("zone_id",M).order("start_time",{ascending:!0})]),O=fe.data||[];u(O);const Q=Y.data||[],ce=[1,2,3,4].map(he=>Q.find(ie=>ie.quarter===he)||{quarter:he,start_date:null,end_date:null,academic_year:j}),te=Q.filter(he=>he.quarter>4);o([...ce,...te].sort((he,de)=>he.quarter-de.quarter));const{data:R}=await _e.from("session_operating_days").select("session_id, day_of_week").in("session_id",O.map(he=>he.id)).eq("is_active",!0),ue=R||[],oe=[0,1,2,3,4,5,6].map(he=>{const de=ue.filter(ie=>ie.day_of_week===he).map(ie=>ie.session_id);return{day_of_week:he,active_session_ids:de}});c(oe),V.data&&h(V.data),m(!1)},z=()=>{F(P)},G=(j,M,Y)=>{const H=l.map(V=>V.quarter===j?{...V,[M]:Y}:V);o(H)},ae=async()=>{x(!0);const j=l.filter(Y=>Y.start_date||Y.end_date).map(({id:Y,quarter:H,start_date:V,end_date:fe,quarter_name:O})=>({quarter:H,start_date:V||null,end_date:fe||null,quarter_name:O||`${H}`,academic_year:E})),{error:M}=await _e.from("operation_quarters").upsert(j,{onConflict:"academic_year, quarter"});M?alert("     : "+M.message):(alert("   ."),X(E)),x(!1)},le=async j=>{const M=l.find(Y=>Y.quarter===j);if(M){if(M.start_date&&M.end_date){const{count:Y,error:H}=await _e.from("bookings").select("*",{count:"exact",head:!0}).gte("date",M.start_date).lte("date",M.end_date);if(H)console.error("Error checking bookings:",H);else if(Y>0){if(!window.confirm(` (${M.start_date} ~ ${M.end_date})  ${Y}  .    ?
(    ,    .)`))return}else if(!window.confirm(`${j}   ?`))return}else if(!window.confirm(`${j}  ?`))return;try{const{error:Y}=await _e.from("operation_quarters").delete().eq("academic_year",E).eq("quarter",j);if(Y)throw Y;j<=4?o(H=>H.map(V=>V.quarter===j?{...V,start_date:null,end_date:null,quarter_name:null}:V)):o(H=>H.filter(V=>V.quarter!==j)),alert(`${j}   .`)}catch(Y){console.error("Error deleting quarter:",Y),alert("   .")}}},Z=()=>{const j=l.length>0?Math.max(...l.map(M=>M.quarter)):0;o([...l,{quarter:j+1,start_date:null,end_date:null,academic_year:E}])},C=(j,M)=>{c(Y=>Y.map(H=>{if(H.day_of_week!==j)return H;const V=H.active_session_ids.includes(M)?H.active_session_ids.filter(fe=>fe!==M):[...H.active_session_ids,M];return{...H,active_session_ids:V}}))},L=async()=>{w(!0);try{const j=[];a.forEach(Y=>{f.forEach(H=>{j.push({session_id:H.id,day_of_week:Y.day_of_week,is_active:Y.active_session_ids.includes(H.id)})})});const{error:M}=await _e.from("session_operating_days").upsert(j,{onConflict:"session_id, day_of_week"});if(M)throw M;alert("    ."),X(E,i)}catch(j){alert("      : "+j.message)}finally{w(!1)}},B=async j=>{if(j.preventDefault(),!i)return;const{error:M}=await _e.from("operation_exceptions").insert([{exception_date:k.date,reason:k.reason,is_closed:!0,zone_id:i}]);M||(S({...k,reason:""}),X(E,i))},N=async j=>{await _e.from("operation_exceptions").delete().eq("id",j),X(E)},U=()=>v.jsxs("div",{className:"flex items-center justify-between mb-6 px-2",children:[v.jsxs("div",{className:"flex items-center gap-6",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:je(e,"yyyy MMMM",{locale:vr})}),v.jsx("p",{className:"text-[10px] font-black text-ios-indigo uppercase tracking-widest mt-1",children:"Operating Calendar"})]}),v.jsx("div",{className:"flex bg-gray-100 p-1 rounded-xl border border-gray-200",children:r.map(j=>v.jsx("button",{onClick:()=>s(j.id),className:`px-4 py-1.5 rounded-lg text-xs font-black transition-all ios-tap ${i===j.id?"bg-white text-[#1C1C1E] shadow-sm":"text-ios-gray hover:text-[#1C1C1E]"}`,children:j.name},j.id))})]}),v.jsxs("div",{className:"flex gap-4 items-center",children:[v.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[v.jsxs("div",{className:"relative",children:[v.jsx("input",{type:"checkbox",className:"sr-only peer",checked:_,onChange:j=>b(j.target.checked)}),v.jsx("div",{className:"w-10 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-ios-indigo"})]}),v.jsx("span",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest peer-checked:text-[#1C1C1E] transition-colors",children:"/ "})]}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>t(Tf(e)),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",children:v.jsx(bi,{className:"w-5 h-5 text-ios-gray"})}),v.jsx("button",{onClick:()=>t(sc(e,1)),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",children:v.jsx(an,{className:"w-5 h-5 text-ios-gray"})})]})]})]}),A=()=>{const j=["","","","","","",""],M=_?j:j.slice(1,6);return v.jsx("div",{className:`grid ${_?"grid-cols-7":"grid-cols-5"} mb-2 border-b border-gray-100`,children:M.map((Y,H)=>{const V=_?H:H+1;return v.jsx("div",{className:`py-3 text-[10px] font-black uppercase text-center tracking-widest ${V===0?"text-ios-rose":V===6?"text-ios-indigo":"text-ios-gray"}`,children:Y},V)})})},T=()=>{const j=ro(e),M=zl(j),Y=rr(j,{weekStartsOn:_?0:1}),H=xi(M,{weekStartsOn:_?0:1});let V=na({start:Y,end:H});return _||(V=V.filter(fe=>fe.getDay()!==0&&fe.getDay()!==6)),v.jsx("div",{className:`grid ${_?"grid-cols-7":"grid-cols-5"} gap-px bg-gray-100 border border-gray-100 rounded-[12px] overflow-hidden shadow-sm`,children:V.map((fe,O)=>{var de;const Q=Ji(fe,new Date),K=Yd(fe,j),ce=fe.getDay(),te=je(fe,"yyyy-MM-dd"),R=d.find(ie=>ie.exception_date===te),ue=l.find(ie=>ie.start_date&&ie.end_date&&Hl(fe,{start:jt(ie.start_date),end:jt(ie.end_date)})),oe=a.find(ie=>ie.day_of_week===ce),he=ue&&!R&&((de=oe==null?void 0:oe.active_session_ids)==null?void 0:de.length)>0;return v.jsxs("div",{className:`min-h-[100px] p-2 flex flex-col gap-1 transition-colors border-b border-r border-gray-100 ${K?R?"bg-red-50/30":he?"bg-[#f0f9ff]":"bg-white":"opacity-30 bg-gray-50"}`,children:[v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsx("span",{className:`text-[11px] font-black ${Q?"w-6 h-6 text-ios-indigo border-2 border-ios-indigo rounded-full flex items-center justify-center -mt-1 -ml-1 bg-white":ce===0?"text-ios-rose":ce===6?"text-ios-indigo":"text-[#1C1C1E]"}`,children:je(fe,"d")}),ue&&v.jsxs("span",{className:"text-[8px] font-black bg-white/50 text-ios-indigo px-1.5 py-0.5 rounded-full uppercase tracking-tighter border border-ios-indigo/10",children:["Q",ue.quarter]})]}),R?v.jsxs("div",{className:"mt-1 flex flex-col gap-1",children:[v.jsx("span",{className:"text-[10px] font-black text-red-600 uppercase tracking-widest",children:"CLOSED"}),v.jsx("span",{className:"text-[9px] font-bold text-ios-gray leading-tight",children:R.reason})]}):he?v.jsx("div",{className:"mt-1 flex flex-col gap-0.5",children:f.map(ie=>{var Se;const pe=(Se=oe==null?void 0:oe.active_session_ids)==null?void 0:Se.includes(ie.id);return v.jsxs("div",{className:"flex justify-between items-center bg-white/40 rounded-[2px] px-1 py-0.5",children:[v.jsx("span",{className:"text-[8px] font-bold text-ios-gray truncate max-w-[40px]",children:ie.name}),v.jsx("span",{className:`text-[8px] font-black uppercase tracking-wider ${pe?"text-ios-indigo":"text-red-400 opacity-30"}`,children:pe?"ON":"OFF"})]},ie.id)})}):null]},O)})})};return p?v.jsx("div",{className:"h-full flex items-center justify-center",children:v.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-ios-indigo"})}):v.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 h-full overflow-hidden",children:[v.jsxs("div",{className:"flex-1 bg-white rounded-[6px] border border-gray-100 flex flex-col p-6 shadow-sm overflow-y-auto scrollbar-hide",children:[U(),A(),T()]}),v.jsxs("div",{className:"lg:w-96 flex flex-col gap-6 overflow-y-auto scrollbar-hide pb-6",children:[v.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 p-6 shadow-sm",children:[v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(es,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h4",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"  "})]}),v.jsx("div",{className:"flex gap-2",children:v.jsxs("button",{onClick:ae,disabled:g,className:"bg-[#1C1C1E] text-white px-5 py-2.5 rounded-[8px] text-[11px] font-black uppercase tracking-widest flex items-center gap-2 hover:bg-gray-800 shadow-md transition-all active:scale-95",children:[v.jsx(wl,{className:"w-3.5 h-3.5"})," "]})})]}),v.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-[8px] border border-gray-100",children:[v.jsx("label",{className:"block text-[10px] font-black text-ios-gray uppercase tracking-widest mb-2",children:" "}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("select",{value:P,onChange:j=>D(Number(j.target.value)),className:"flex-1 bg-white border border-gray-200 rounded-[6px] px-3 py-2 text-xs font-bold text-[#1C1C1E] focus:outline-none focus:ring-1 focus:ring-ios-indigo",children:[E-2,E-1,E,E+1,E+2].sort().map(j=>v.jsxs("option",{value:j,children:[j,""]},j))}),v.jsx("button",{onClick:z,className:"bg-[#1C1C1E] text-white px-3 py-2 rounded-[6px] text-[10px] font-black uppercase whitespace-nowrap hover:bg-gray-800 transition-colors",children:""})]})]}),v.jsxs("div",{className:"space-y-6",children:[l.map(j=>v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("p",{className:"text-[11px] font-black text-ios-indigo",children:[j.quarter,""]}),(j.start_date||j.end_date||j.quarter>4)&&v.jsx("button",{onClick:()=>le(j.quarter),className:"p-1 text-ios-gray hover:text-ios-rose transition-colors",title:" ",children:v.jsx(ts,{className:"w-3 h-3"})})]}),v.jsxs("span",{className:"text-[8px] font-bold text-ios-gray bg-gray-50 px-2 py-0.5 rounded-full uppercase tracking-widest",children:["Year ",E," - Q",j.quarter]})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[v.jsx("input",{type:"date",value:j.start_date||"",onChange:M=>G(j.quarter,"start_date",M.target.value),className:"bg-gray-50 border-none rounded-[6px] px-3 py-2 text-[11px] font-bold focus:ring-1 focus:ring-ios-indigo transition-all"}),v.jsx("input",{type:"date",value:j.end_date||"",onChange:M=>G(j.quarter,"end_date",M.target.value),className:"bg-gray-50 border-none rounded-[6px] px-3 py-2 text-[11px] font-bold focus:ring-1 focus:ring-ios-indigo transition-all"})]})]},j.quarter)),v.jsxs("button",{onClick:Z,className:"w-full py-3 bg-gray-50 text-ios-gray border border-dashed border-gray-200 rounded-[6px] text-[10px] font-black uppercase tracking-wider flex items-center justify-center gap-1.5 hover:bg-gray-100 hover:text-[#1C1C1E] hover:border-gray-300 transition-all active:scale-95",children:[v.jsx(yl,{className:"w-3.5 h-3.5"}),"  "]})]})]}),v.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 p-6 shadow-sm",children:[v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(es,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h4",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"   "})]}),v.jsxs("button",{onClick:L,disabled:y,className:"bg-[#1C1C1E] text-white px-5 py-2.5 rounded-[8px] text-[11px] font-black uppercase tracking-widest flex items-center gap-2 hover:bg-gray-800 shadow-md transition-all active:scale-95",children:[v.jsx(wl,{className:"w-3.5 h-3.5"})," "]})]}),v.jsxs("div",{className:"space-y-1 overflow-x-auto min-w-0",children:[v.jsxs("div",{className:"grid gap-2 pb-2 border-b border-gray-100 mb-2",style:{gridTemplateColumns:`40px repeat(${f.length}, minmax(40px, 1fr))`},children:[v.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest",children:""}),f.map(j=>v.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest text-center truncate px-1",title:j.name,children:j.name},j.id))]}),[1,2,3,4,5,6,0].map(j=>{const M=a.find(Y=>Y.day_of_week===j)||{active_session_ids:[]};return v.jsxs("div",{className:"grid gap-2 items-center py-2 hover:bg-gray-50 rounded-[4px] transition-colors",style:{gridTemplateColumns:`40px repeat(${f.length}, minmax(40px, 1fr))`},children:[v.jsx("span",{className:`text-[10px] font-black ${j===0?"text-ios-rose":j===6?"text-ios-indigo":"text-[#1C1C1E]"}`,children:["","","","","","",""][j]}),f.map(Y=>{var H;return v.jsx("div",{className:"flex justify-center",children:v.jsx("input",{type:"checkbox",checked:(H=M.active_session_ids)==null?void 0:H.includes(Y.id),onChange:()=>C(j,Y.id),className:"w-4 h-4 rounded-full border-gray-200 text-ios-indigo focus:ring-ios-indigo/20 transition-all cursor-pointer"})},Y.id)})]},j)})]})]}),v.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 p-6 shadow-sm flex-1",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[v.jsx(ti,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h4",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"()  "})]}),v.jsxs("form",{onSubmit:B,className:"space-y-4 mb-8",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("p",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest px-1",children:" "}),v.jsx("input",{type:"date",value:k.date,onChange:j=>S({...k,date:j.target.value}),className:"w-full bg-gray-50 border-none rounded-[6px] px-3 py-3 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all outline-none"})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("p",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest px-1",children:" "}),v.jsx("input",{type:"text",placeholder:": ,   ",value:k.reason,onChange:j=>S({...k,reason:j.target.value}),className:"w-full bg-gray-50 border-none rounded-[6px] px-3 py-3 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all outline-none"})]}),v.jsxs("button",{type:"submit",disabled:!k.reason,className:"w-full py-3 bg-[#1C1C1E] text-white rounded-[6px] font-black text-[11px] uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-gray-800 transition-all disabled:opacity-30 disabled:hover:bg-[#1C1C1E]",children:[v.jsx(yl,{className:"w-3 h-3"})," "]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest px-1 border-b border-gray-50 pb-2 mb-4",children:"  "}),v.jsxs("div",{className:"space-y-3 max-h-60 overflow-y-auto pr-2 scrollbar-hide",children:[d.length===0&&v.jsx("p",{className:"text-[10px] text-ios-gray italic text-center py-4",children:"  ."}),d.map(j=>v.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-[6px] hover:bg-ios-rose/5 transition-all group border border-transparent hover:border-ios-rose/10",children:[v.jsxs("div",{className:"flex-1",children:[v.jsx("p",{className:"text-[11px] font-black text-[#1C1C1E]",children:j.exception_date}),v.jsx("p",{className:"text-[9px] font-bold text-ios-gray truncate",children:j.reason})]}),v.jsx("button",{onClick:()=>N(j.id),className:"p-1.5 text-ios-gray hover:text-ios-rose transition-colors opacity-0 group-hover:opacity-100",children:v.jsx(ts,{className:"w-3.5 h-3.5"})})]},j.id))]})]})]})]})]})},Q6=()=>{var x,y;const[e,t]=ne.useState(!0),[r,n]=ne.useState(!1),[i,s]=ne.useState(null),[l,o]=ne.useState(!1),[a,c]=ne.useState("GOE STUDY CAFE"),[d,h]=ne.useState(""),[f,u]=ne.useState({points:[{lat:37.5665,lng:126.978,name:" "}],radius:100}),p=w=>{u(w)};ne.useEffect(()=>{m()},[]);const m=async()=>{t(!0);try{const{data:w}=await _e.from("configs").select("*").eq("key","school_info").single();w&&(c(w.value.name||"POGOK STUDY CAFE"),h(w.value.address||""));const{data:_}=await _e.from("configs").select("*").eq("key","gps_settings").single();_!=null&&_.value&&(_.value.points?u(_.value):_.value.lat&&u({points:[{lat:_.value.lat,lng:_.value.lng,name:" "}],radius:_.value.radius||100}))}catch(w){console.error("Error fetching initial data:",w),s("    .")}finally{t(!1)}},g=async()=>{n(!0),s(null),o(!1);try{await _e.from("configs").upsert({key:"school_info",value:{name:a,address:d}});const{error:w}=await _e.from("configs").upsert({key:"gps_settings",value:f});if(w)throw w;o(!0),setTimeout(()=>o(!1),2e3)}catch(w){console.error("Save error:",w),s("   : "+w.message)}finally{n(!1)}};return e?v.jsxs("div",{className:"h-full flex flex-col items-center justify-center bg-white rounded-t-[6px]",children:[v.jsx("div",{className:"w-10 h-10 border-4 border-ios-indigo/20 border-t-ios-indigo rounded-full animate-spin mb-4"}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"   ..."})]}):v.jsxs("div",{className:"bg-white rounded-t-[6px] h-full flex flex-col overflow-hidden animate-spring-up",children:[v.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide p-8 pb-32",children:v.jsxs("div",{className:"max-w-4xl mx-auto space-y-12",children:[v.jsxs("div",{className:"flex items-center justify-between bg-gray-50/50 p-6 rounded-2xl border border-gray-100",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:"w-12 h-12 rounded-xl bg-[#1C1C1E] flex items-center justify-center shadow-lg",children:v.jsx(_d,{className:"w-6 h-6 text-white"})}),v.jsxs("div",{children:[v.jsx("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:" "}),v.jsx("p",{className:"text-sm text-ios-gray font-bold",children:"        ."})]})]}),i&&v.jsxs("div",{className:"flex items-center gap-2 bg-ios-rose/10 px-4 py-2 rounded-lg border border-ios-rose/20 text-ios-rose font-bold text-xs animate-shake",children:[v.jsx(ti,{className:"w-4 h-4"})," ",i]})]}),v.jsxs("section",{className:"space-y-6",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[v.jsx(JS,{className:"w-5 h-5 text-ios-indigo"}),v.jsx("h3",{className:"text-lg font-black text-[#1C1C1E]",children:"  "})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest ml-1",children:" "}),v.jsx("input",{type:"text",value:a,onChange:w=>c(w.target.value),className:"w-full bg-gray-50 border border-transparent focus:bg-white focus:border-ios-indigo/20 rounded-xl px-5 py-4 text-base font-bold text-[#1C1C1E] transition-all outline-none"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest ml-1",children:" "}),v.jsx("input",{type:"text",value:d,onChange:w=>h(w.target.value),className:"w-full bg-gray-50 border border-transparent focus:bg-white focus:border-ios-indigo/20 rounded-xl px-5 py-4 text-base font-bold text-[#1C1C1E] transition-all outline-none",placeholder:"     "})]})]})]}),v.jsx("hr",{className:"border-gray-100"}),v.jsxs("section",{className:"space-y-6 animate-fade-in",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[v.jsx(PS,{className:"w-5 h-5 text-ios-rose"}),v.jsx("h3",{className:"text-lg font-black text-[#1C1C1E]",children:"   "})]}),v.jsxs("div",{className:"bg-gray-50/50 p-6 rounded-2xl border border-gray-100 space-y-8",children:[v.jsxs("div",{className:"flex items-start gap-3 p-4 bg-ios-amber/5 border border-ios-amber/10 rounded-xl",children:[v.jsx(ny,{className:"w-4 h-4 text-ios-amber mt-0.5"}),v.jsxs("p",{className:"text-xs text-ios-amber font-bold leading-relaxed",children:["     GPS     .",v.jsx("br",{}),"     (Zone)  ."]})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsx("div",{className:"flex items-center justify-between",children:v.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest flex items-center gap-1.5 ml-1",children:"  "})}),v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx($S,{className:"w-5 h-5 text-ios-indigo"}),v.jsx("div",{className:"flex-1",children:v.jsx("input",{type:"number",value:f.radius||100,onChange:w=>p({...f,radius:parseInt(w.target.value)}),className:"w-full bg-white border border-gray-100 rounded-xl px-4 py-3 text-sm font-bold text-[#1C1C1E] outline-none focus:ring-1 focus:ring-ios-indigo transition-all",placeholder:"  (m)"})}),v.jsx("span",{className:"text-xs font-bold text-ios-gray",children:"(m)"})]})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest flex items-center gap-1.5 ml-1",children:["   (",((x=f.points)==null?void 0:x.length)||0,")"]}),(!f.points||f.points.length<10)&&v.jsx("button",{onClick:()=>{const w=[...f.points||[]];w.push({lat:37.5665,lng:126.978,name:` ${w.length+1}`}),p({...f,points:w})},className:"text-[10px] font-bold text-ios-indigo hover:bg-ios-indigo/10 px-2 py-1 rounded transition-colors",children:"+  "})]}),v.jsx("div",{className:"space-y-3",children:(y=f.points)==null?void 0:y.map((w,_)=>v.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm relative group",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[v.jsx(Us,{className:"w-4 h-4 text-ios-rose"}),v.jsx("input",{type:"text",value:w.name||` ${_+1}`,onChange:b=>{const k=[...f.points];k[_].name=b.target.value,p({...f,points:k})},className:"text-sm font-black text-[#1C1C1E] border-none p-0 focus:ring-0 w-32 bg-transparent",placeholder:" "}),f.points.length>1&&v.jsx("button",{onClick:()=>{const b=f.points.filter((k,S)=>S!==_);p({...f,points:b})},className:"ml-auto p-1.5 text-gray-300 hover:text-ios-rose hover:bg-red-50 rounded-lg transition-colors",children:v.jsx(ts,{className:"w-3.5 h-3.5"})})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[v.jsxs("div",{children:[v.jsx("label",{className:"text-[9px] text-gray-400 font-bold mb-1 block",children:" (Latitude)"}),v.jsx("input",{type:"number",step:"0.000001",value:w.lat,onChange:b=>{const k=[...f.points];k[_].lat=parseFloat(b.target.value),p({...f,points:k})},className:"w-full bg-gray-50/50 border border-gray-100 rounded-lg px-3 py-2 text-xs font-bold font-mono text-[#1C1C1E] focus:bg-white focus:border-ios-indigo transition-all"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"text-[9px] text-gray-400 font-bold mb-1 block",children:" (Longitude)"}),v.jsx("input",{type:"number",step:"0.000001",value:w.lng,onChange:b=>{const k=[...f.points];k[_].lng=parseFloat(b.target.value),p({...f,points:k})},className:"w-full bg-gray-50/50 border border-gray-100 rounded-lg px-3 py-2 text-xs font-bold font-mono text-[#1C1C1E] focus:bg-white focus:border-ios-indigo transition-all"})]})]})]},_))})]})]})]})]})}),v.jsx("div",{className:"flex-none p-6 border-t border-gray-100 bg-white/80 backdrop-blur-xl z-20",children:v.jsxs("div",{className:"max-w-4xl mx-auto flex items-center gap-4",children:[v.jsx("button",{onClick:g,disabled:r,className:`flex-1 py-5 rounded-2xl font-black text-base flex items-center justify-center gap-3 transition-all ios-tap shadow-lg ${l?"bg-[#1C1C1E] text-white":"bg-[#1C1C1E] text-white hover:bg-gray-800"}`,children:r?v.jsx("div",{className:"w-5 h-5 border-2 border-white/20 border-t-white rounded-full animate-spin"}):l?v.jsxs(v.Fragment,{children:[v.jsx(Ki,{className:"w-5 h-5"}),"    "]}):v.jsxs(v.Fragment,{children:[v.jsx(wl,{className:"w-5 h-5"}),"    "]})}),l&&v.jsxs("div",{className:"bg-ios-emerald/10 text-ios-emerald px-6 py-5 rounded-2xl font-black text-sm animate-fade-in flex items-center gap-2",children:[v.jsx(bn,{className:"w-4 h-4"})," !"]})]})})]})},Z6=()=>{const[e,t]=ne.useState(!0),[r,n]=ne.useState([]),[i,s]=ne.useState(null),[l,o]=ne.useState([]),[a,c]=ne.useState([]),[d,h]=ne.useState([]),[f,u]=ne.useState([]),[p,m]=ne.useState([1,2,3]),[g,x]=ne.useState(!1),[y,w]=ne.useState([]);ne.useEffect(()=>{_()},[]);const _=async()=>{t(!0);const{data:P}=await _e.from("operation_quarters").select("*").order("academic_year",{ascending:!0}).order("quarter",{ascending:!0});if(P&&P.length>0){n(P);const I=je(new Date,"yyyy-MM-dd");let X=P.find(z=>I>=z.start_date&&I<=z.end_date);if(!X){const z=new Date;X=P.reduce((G,ae)=>{const le=Math.abs(new Date(G.start_date)-z);return Math.abs(new Date(ae.start_date)-z)<le?ae:G})}X&&b(X)}const{data:D}=await _e.from("zones").select("id").limit(1);if(D&&D.length>0){const{data:I}=await _e.from("sessions").select("*").eq("zone_id",D[0].id).order("start_time",{ascending:!0});I&&(h(I),u(I.map(X=>X.id)))}t(!1)},b=P=>{s(P);const D=new Date(P.start_date),I=new Date(P.end_date),z=sM({start:D,end:I},{weekStartsOn:1}).map((G,ae)=>{let le=xi(G,{weekStartsOn:1});const Z=G<D?D:G,C=le>I?I:le;return{id:ae+1,start:Z,end:C,label:`${ae+1} (${je(Z,"MM/dd(eee)",{locale:vr})} - ${je(C,"MM/dd(eee)",{locale:vr})})`}});o(z),c(z.map(G=>G.id))},k=P=>{c(D=>D.includes(P)?D.filter(I=>I!==P):[...D,P])},S=P=>{m(D=>D.includes(P)?D.filter(I=>I!==P):[...D,P])},E=P=>{u(D=>D.includes(P)?D.filter(I=>I!==P):[...D,P])},F=async()=>{if(a.length===0||p.length===0||f.length===0){alert(" , ,    .");return}x(!0);try{const{data:P}=await _e.from("profiles").select("*").in("grade",p).eq("role","student").order("grade",{ascending:!0}).order("class_number",{ascending:!0}).order("student_number",{ascending:!0});if(!P||P.length===0){alert("   ."),x(!1);return}const D=[];for(const I of a){const X=l.find(L=>L.id===I),z=je(X.start,"yyyy-MM-dd"),G=je(X.end,"yyyy-MM-dd"),{data:ae}=await _e.from("bookings").select(`
                        *,
                        attendance(*)
                    `).gte("date",z).lte("date",G).in("session_id",f),le=na({start:X.start,end:X.end}),Z=new Set((ae||[]).map(L=>L.date)),C=le.filter(L=>{const B=[0,6].includes(L.getDay()),N=je(L,"yyyy-MM-dd");return!B||Z.has(N)});for(const L of p.sort()){const B=P.filter(A=>A.grade===L);if(B.length===0)continue;const N=B.map(A=>A.id),U=(ae||[]).filter(A=>N.includes(A.user_id));D.push({weekInfo:X,grade:L,students:B,bookings:U,businessDays:C,sessions:d.filter(A=>f.includes(A.id))})}}w(D),setTimeout(()=>{window.print(),x(!1)},1e3)}catch(P){console.error("Print error:",P),alert("     ."),x(!1)}};return e?v.jsxs("div",{className:"h-full flex flex-col items-center justify-center gap-4 bg-white/50 backdrop-blur-sm",children:[v.jsx("div",{className:"w-10 h-10 border-4 border-ios-indigo border-t-transparent rounded-full animate-spin"}),v.jsx("p",{className:"text-[13px] font-black text-ios-gray animate-pulse",children:"   ..."})]}):v.jsxs("div",{className:"h-full flex flex-col bg-[#F2F2F7]",children:[v.jsx("div",{className:"flex-1 overflow-y-auto p-8 pt-6 hide-on-print",children:v.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:"w-12 h-12 rounded-2xl bg-[#1C1C1E] flex items-center justify-center shadow-lg shadow-black/10",children:v.jsx(Nu,{className:"w-6 h-6 text-white"})}),v.jsxs("div",{children:[v.jsx("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:"  "}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"     PDF  ."})]})]}),v.jsx("button",{onClick:F,disabled:g,className:"bg-ios-indigo text-white px-8 py-4 rounded-2xl font-black text-[15px] shadow-lg shadow-ios-indigo/20 hover:scale-[1.02] active:scale-95 transition-all flex items-center gap-3 disabled:opacity-50",children:g?v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"  "]}):v.jsxs(v.Fragment,{children:[v.jsx(ty,{className:"w-5 h-5"}),"PDF   "]})})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[v.jsxs("div",{className:"bg-white rounded-[24px] p-6 shadow-sm border border-gray-100 flex flex-col",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[v.jsx(qs,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h3",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:" "})]}),v.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto pr-2 custom-scrollbar",children:r.map(P=>v.jsxs("button",{onClick:()=>b(P),className:`w-full text-left p-4 rounded-xl border-2 transition-all flex items-center justify-between group ${(i==null?void 0:i.id)===P.id?"bg-ios-indigo/5 border-ios-indigo text-ios-indigo":"bg-white border-gray-50 text-ios-gray hover:border-gray-200"}`,children:[v.jsxs("div",{children:[v.jsxs("p",{className:"text-[13px] font-black",children:[P.quarter_name," (",P.academic_year,")"]}),v.jsxs("p",{className:"text-[11px] opacity-70 mt-0.5",children:[je(new Date(P.start_date),"yyyy-MM-dd(eee)",{locale:vr})," ~ ",je(new Date(P.end_date),"yyyy-MM-dd(eee)",{locale:vr})]})]}),(i==null?void 0:i.id)===P.id&&v.jsx(Ki,{className:"w-5 h-5"})]},P.id))})]}),v.jsxs("div",{className:"space-y-6",children:[v.jsxs("div",{className:"bg-white rounded-[24px] p-6 shadow-sm border border-gray-100",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[v.jsx(ql,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h3",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:" "})]}),v.jsx("div",{className:"flex gap-3",children:[1,2,3].map(P=>v.jsxs("button",{onClick:()=>S(P),className:`flex-1 py-3 px-4 rounded-xl font-black text-[13px] transition-all border-2 flex items-center justify-between gap-2 ${p.includes(P)?"bg-ios-indigo text-white border-ios-indigo shadow-md shadow-ios-indigo/20":"bg-white text-ios-gray border-gray-100"}`,children:[v.jsxs("span",{className:"flex-1 text-center",children:[P,""]}),p.includes(P)&&v.jsx(bn,{className:"w-4 h-4",strokeWidth:3})]},P))})]}),v.jsxs("div",{className:"bg-white rounded-[24px] p-6 shadow-sm border border-gray-100",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[v.jsx(es,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h3",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:" "})]}),v.jsx("div",{className:"grid grid-cols-2 gap-3",children:d.map(P=>v.jsxs("button",{onClick:()=>E(P.id),className:`py-3 px-4 rounded-xl font-black text-[12px] transition-all border-2 flex items-center justify-between ${f.includes(P.id)?"bg-ios-indigo/5 border-ios-indigo text-ios-indigo":"bg-white text-ios-gray border-gray-100"}`,children:[v.jsx("span",{children:P.name}),f.includes(P.id)&&v.jsx(bn,{className:"w-4 h-4"})]},P.id))})]})]})]}),v.jsxs("div",{className:"bg-white rounded-[24px] p-6 shadow-sm border border-gray-100",children:[v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(gS,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h3",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"   (A4 1/)"})]}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>c(l.map(P=>P.id)),className:"text-[11px] font-black text-ios-indigo hover:underline",children:" "}),v.jsx("span",{className:"text-gray-200",children:"|"}),v.jsx("button",{onClick:()=>c([]),className:"text-[11px] font-black text-ios-rose hover:underline",children:""})]})]}),v.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-3",children:l.map(P=>v.jsxs("button",{onClick:()=>k(P.id),className:`relative p-4 rounded-2xl border-2 transition-all group ${a.includes(P.id)?"bg-ios-indigo/5 border-ios-indigo":"bg-white border-gray-100 hover:border-gray-200"}`,children:[v.jsxs("p",{className:`text-[13px] font-black ${a.includes(P.id)?"text-ios-indigo":"text-[#1C1C1E]"}`,children:[P.id,""]}),v.jsxs("p",{className:"text-[10px] text-ios-gray font-bold mt-1",children:[je(P.start,"MM/dd(eee)",{locale:vr})," - ",je(P.end,"MM/dd(eee)",{locale:vr})]}),a.includes(P.id)&&v.jsx("div",{className:"absolute top-2 right-2 flex items-center justify-center w-5 h-5 rounded-full bg-ios-indigo text-white shadow-sm scale-110",children:v.jsx(bn,{className:"w-3 h-3",strokeWidth:4})})]},P.id))})]})]})}),v.jsxs("div",{className:`print-area ${g?"block opacity-0 pointer-events-none":"hidden"} fixed inset-0 z-[-1]`,children:[v.jsx("style",{children:`
                    @media print {
                        @page { 
                            size: A4 portrait; 
                            margin: 20mm 10mm 10mm 10mm; 
                        }
                        
                        /* Reset EVERYTHING to non-scrolling block layout */
                        html, body, #root, #root > div, main, main > div, 
                        .flex-1.flex, .admin-content-view, 
                        div[class*="rounded-2xl"], div[class*="bg-white"],
                        .flex-1.bg-\\[\\#F2F2F7\\] { 
                            height: auto !important;
                            overflow: visible !important;
                            display: block !important;
                            position: static !important;
                            margin: 0 !important;
                            padding: 0 !important;
                            border: none !important;
                            box-shadow: none !important;
                            flex: none !important;
                            width: 100% !important;
                        }

                        /* Hide app UI */
                        header, aside, .sidebar, .header, .nav-tabs, .selection-ui, .hide-on-print { 
                            display: none !important;
                        }

                        /* Force the printable content back to visible and opacity-1 */
                        .print-area { 
                            display: block !important; 
                            visibility: visible !important;
                            opacity: 1 !important;
                            position: static !important;
                            z-index: auto !important;
                        }

                        .print-area * {
                            visibility: visible !important;
                        }

                        /* Use standard flow for reliable pagination */
                        .print-area {
                            display: block !important;
                            position: static !important;
                            width: 100% !important;
                            margin: 0 !important;
                            padding: 0 !important;
                        }

                        .page-break { 
                            display: block !important;
                            page-break-after: always !important;
                            break-after: page !important;
                            width: 100% !important;
                            margin: 0 !important;
                            padding: 0 !important;
                            position: relative !important;
                        }

                        /* Ensure no top margin on the first page beyond the @page margin */
                        .page-break:first-child {
                            margin-top: 0 !important;
                        }

                        .header-row { 
                            display: flex; 
                            justify-content: space-between; 
                            align-items: flex-end; 
                            margin: 0 0 10px 0 !important; 
                            padding: 0 0 5px 0 !important;
                            border-bottom: 2px solid #000 !important; 
                        }
                        
                        .school-title { 
                            font-size: 20px !important; 
                            font-weight: 900 !important;
                            margin: 0 !important;
                            padding: 0 !important;
                            line-height: 1 !important;
                        }

                        .doc-title {
                            font-size: 10px !important;
                            margin: 0 !important;
                            padding: 0 !important;
                        }

                        .attendance-table { 
                            width: 100% !important; 
                            border-collapse: collapse !important; 
                            margin: 10px 0 0 0 !important;
                            font-size: 10px !important; 
                            table-layout: fixed !important;
                        }

                        .attendance-table th, .attendance-table td { 
                            border: 1px solid #000 !important; 
                            padding: 4px !important; 
                            text-align: center !important; 
                        }

                        .attendance-table th { 
                            background-color: #eee !important; 
                            -webkit-print-color-adjust: exact !important;
                        }
                    }
                `}),v.jsx("div",{className:"print-root",children:y.map((P,D)=>v.jsxs("div",{className:"page-break",children:[v.jsxs("div",{className:"header-row",children:[v.jsxs("h1",{className:"school-title",children:["   (",i==null?void 0:i.quarter_name,", ",P.weekInfo.id,")"]}),v.jsxs("div",{className:"doc-title",children:[je(P.weekInfo.start,"yyyy-MM-dd(eee)",{locale:vr})," ~ ",je(P.weekInfo.end,"yyyy-MM-dd(eee)",{locale:vr})]})]}),v.jsx("div",{className:"flex justify-between items-center mb-2 px-1 text-[10px] font-bold",children:v.jsxs("div",{className:"flex gap-4",children:[v.jsxs("span",{children:[": ",i==null?void 0:i.academic_year]}),v.jsxs("span",{children:[": ",P.grade,""]})]})}),v.jsxs("table",{className:"attendance-table",children:[v.jsxs("thead",{children:[v.jsxs("tr",{children:[v.jsx("th",{style:{width:"40px"},children:"No"}),v.jsx("th",{style:{width:"100px"},children:"//"}),v.jsx("th",{style:{width:"100px"},children:""}),P.businessDays.map(I=>v.jsxs("th",{colSpan:P.sessions.length,children:[je(I,"MM/dd")," (",je(I,"E",{locale:vr})[0],")"]},I.toString()))]}),v.jsxs("tr",{children:[v.jsx("th",{colSpan:3,children:""}),P.businessDays.map(I=>P.sessions.map(X=>v.jsx("th",{style:{fontSize:"8px",padding:"2px 0"},children:X.name},`${I}-${X.id}`)))]})]}),v.jsx("tbody",{children:P.students.map((I,X)=>v.jsxs("tr",{children:[v.jsx("td",{children:X+1}),v.jsxs("td",{children:[I.grade,String(I.class_number).padStart(2,"0"),String(I.student_number).padStart(2,"0")]}),v.jsx("td",{style:{fontWeight:"bold"},children:I.full_name}),P.businessDays.map(z=>{const G=je(z,"yyyy-MM-dd");return P.sessions.map(ae=>{var L,B;const le=P.bookings.find(N=>N.user_id===I.id&&N.date===G&&N.session_id===ae.id),Z=(B=(L=le==null?void 0:le.attendance)==null?void 0:L[0])==null?void 0:B.status,C=Z==="present"?"O":Z==="late"?"":Z==="early"?"":le?"":"-";return v.jsx("td",{style:{fontSize:"9px",color:Z==="absent"?"#ff3b30":"inherit"},children:C},`${I.id}-${G}-${ae.id}`)})})]},I.id))})]})]},D))})]})]})},eL=()=>{var S;const[e,t]=ne.useState(!0),[r,n]=ne.useState(!1),[i,s]=ne.useState(null),[l,o]=ne.useState(!1),[a,c]=ne.useState([]),[d,h]=ne.useState(null),[f,u]=ne.useState([]);ne.useEffect(()=>{p()},[]),ne.useEffect(()=>{d&&m(d)},[d]);const p=async()=>{t(!0);try{const{data:E,error:F}=await _e.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});if(F)throw F;c(E||[]),E&&E.length>0&&h(E[0].id)}catch(E){console.error("Error fetching zones:",E),s("     .")}finally{t(!1)}},m=async E=>{try{const{data:F,error:P}=await _e.from("sessions").select("*").eq("zone_id",E).order("start_time",{ascending:!0});if(P)throw P;u(F||[])}catch(F){console.error("Error fetching sessions:",F),s("     .")}},g=async()=>{const E=prompt("     (: 2):");if(E){n(!0);try{const{data:F,error:P}=await _e.from("zones").insert([{name:E,settings:{points:[{lat:37.5665,lng:126.978,name:" "}],radius:100}}]).select().single();if(P)throw P;c([...a,F]),h(F.id)}catch(F){alert("  : "+F.message)}finally{n(!1)}}},x=async(E,F)=>{const P=prompt("   :",F);if(!(!P||P===F)){n(!0);try{const{error:D}=await _e.from("zones").update({name:P}).eq("id",E);if(D)throw D;c(a.map(I=>I.id===E?{...I,name:P}:I))}catch(D){alert("  : "+D.message)}finally{n(!1)}}},y=async E=>{if(confirm("   ?       !")){n(!0);try{const{error:F}=await _e.from("zones").delete().eq("id",E);if(F)throw F;const P=a.filter(D=>D.id!==E);c(P),P.length>0?h(P[0].id):h(null)}catch(F){alert("  : "+F.message)}finally{n(!1)}}},w=async()=>{if(!d)return;const E=prompt("   (: 3):");if(E)try{const{data:F,error:P}=await _e.from("sessions").insert([{zone_id:d,name:E,start_time:"09:00:00",end_time:"12:00:00"}]).select().single();if(P)throw P;u([...f,F])}catch{alert("  ")}},_=async E=>{if(!confirm(" ?"))return;const{error:F}=await _e.from("sessions").delete().eq("id",E);F?alert(" "):u(f.filter(P=>P.id!==E))},b=(E,F,P)=>{u(f.map(D=>D.id===E?{...D,[F]:P}:D))},k=async()=>{if(d){n(!0),o(!1);try{if(f.length>0){const{error:E}=await _e.from("sessions").upsert(f.map(F=>({id:F.id,zone_id:d,name:F.name,start_time:F.start_time,end_time:F.end_time})));if(E)throw E}o(!0),setTimeout(()=>o(!1),2e3)}catch(E){console.error("Save error:",E),s("   : "+E.message),setTimeout(()=>s(null),3e3)}finally{n(!1)}}};return e?v.jsxs("div",{className:"h-full flex flex-col items-center justify-center bg-white rounded-t-[6px]",children:[v.jsx("div",{className:"w-10 h-10 border-4 border-ios-indigo/20 border-t-ios-indigo rounded-full animate-spin mb-4"}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"   ..."})]}):v.jsxs("div",{className:"bg-white rounded-t-[6px] h-full flex flex-col overflow-hidden animate-spring-up",children:[v.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide p-8 pb-32",children:v.jsxs("div",{className:"max-w-4xl mx-auto space-y-12",children:[v.jsxs("div",{className:"flex items-center justify-between bg-gray-50/50 p-6 rounded-2xl border border-gray-100",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:"w-12 h-12 rounded-xl bg-[#1C1C1E] flex items-center justify-center shadow-lg",children:v.jsx(ey,{className:"w-6 h-6 text-white"})}),v.jsxs("div",{children:[v.jsx("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:"  "}),v.jsx("p",{className:"text-sm text-ios-gray font-bold",children:"  (Zone)    ."})]})]}),i&&v.jsxs("div",{className:"flex items-center gap-2 bg-ios-rose/10 px-4 py-2 rounded-lg border border-ios-rose/20 text-ios-rose font-bold text-xs animate-shake",children:[v.jsx(ti,{className:"w-4 h-4"})," ",i]})]}),v.jsxs("section",{className:"space-y-6",children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Eu,{className:"w-5 h-5 text-ios-amber"}),v.jsx("h3",{className:"text-lg font-black text-[#1C1C1E]",children:" (Zone) "})]}),v.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-4 py-2 bg-[#1C1C1E] text-white rounded-lg text-xs font-bold shadow-lg hover:shadow-xl transition-all ios-tap",children:[v.jsx(yl,{className:"w-4 h-4"}),"  "]})]}),v.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(E=>v.jsx("div",{onClick:()=>h(E.id),className:`relative p-5 rounded-2xl border-2 transition-all cursor-pointer group ${d===E.id?"bg-ios-indigo/5 border-ios-indigo shadow-md":"bg-white border-gray-100 hover:border-gray-200"}`,children:v.jsxs("div",{className:"flex flex-col gap-1",children:[v.jsxs("div",{className:"flex items-start justify-between",children:[v.jsxs("span",{className:`text-[10px] font-black uppercase tracking-widest ${d===E.id?"text-ios-indigo":"text-ios-gray"}`,children:["ZONE #",E.id]}),v.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[v.jsx("button",{onClick:F=>{F.stopPropagation(),x(E.id,E.name)},className:"p-1.5 hover:bg-white rounded-md text-ios-gray hover:text-[#1C1C1E] shadow-sm",children:v.jsx(rC,{className:"w-3 h-3"})}),v.jsx("button",{onClick:F=>{F.stopPropagation(),y(E.id)},className:"p-1.5 hover:bg-white rounded-md text-ios-gray hover:text-ios-rose shadow-sm",children:v.jsx(ts,{className:"w-3 h-3"})})]})]}),v.jsx("h4",{className:"text-lg font-black text-[#1C1C1E]",children:E.name}),v.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[v.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${d===E.id?"bg-ios-indigo animate-pulse":"bg-gray-300"}`}),v.jsx("span",{className:"text-[11px] font-bold text-ios-gray",children:d===E.id?" ":" "})]})]})},E.id))})]}),d&&v.jsxs(v.Fragment,{children:[v.jsx("hr",{className:"border-gray-100"}),v.jsxs("section",{className:"space-y-6 animate-fade-in",children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(es,{className:"w-5 h-5 text-ios-emerald"}),v.jsxs("h3",{className:"text-lg font-black text-[#1C1C1E]",children:["[",(S=a.find(E=>E.id===d))==null?void 0:S.name,"]   "]})]}),v.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-4 py-2 bg-[#1C1C1E] text-white rounded-lg text-xs font-bold shadow-lg hover:shadow-xl transition-all ios-tap",children:[v.jsx(iS,{className:"w-4 h-4"}),"  "]})]}),v.jsx("div",{className:"grid grid-cols-1 gap-3",children:f.length===0?v.jsx("div",{className:"p-12 text-center bg-gray-50 border border-dashed border-gray-200 rounded-2xl",children:v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"  . ' ' ."})}):f.map((E,F)=>v.jsxs("div",{className:"group flex items-center justify-between bg-white border border-gray-100 p-5 rounded-2xl hover:shadow-md transition-all",children:[v.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-50 flex items-center justify-center text-[11px] font-black text-ios-gray border border-gray-100",children:F+1}),v.jsxs("div",{className:"w-40",children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest mb-1 block",children:" "}),v.jsx("input",{type:"text",value:E.name||"",onChange:P=>b(E.id,"name",P.target.value),className:"text-sm font-black text-[#1C1C1E] bg-transparent border-none p-0 focus:ring-0 w-full"})]}),v.jsxs("div",{className:"flex items-center gap-8",children:[v.jsxs("div",{children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest mb-1 block",children:""}),v.jsx("input",{type:"time",value:E.start_time||"",onChange:P=>b(E.id,"start_time",P.target.value),className:"text-sm font-black text-[#1C1C1E] border-none p-0 bg-transparent focus:ring-0 w-32 pr-2"})]}),v.jsx(an,{className:"w-4 h-4 text-gray-200 mt-4"}),v.jsxs("div",{children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest mb-1 block",children:""}),v.jsx("input",{type:"time",value:E.end_time||"",onChange:P=>b(E.id,"end_time",P.target.value),className:"text-sm font-black text-[#1C1C1E] border-none p-0 bg-transparent focus:ring-0 w-32 pr-2"})]})]})]}),v.jsx("button",{onClick:()=>_(E.id),className:"p-2.5 text-ios-gray hover:text-ios-rose hover:bg-ios-rose/5 rounded-xl transition-all opacity-0 group-hover:opacity-100",children:v.jsx(ts,{className:"w-4 h-4"})})]},E.id))})]})]})]})}),v.jsx("div",{className:"flex-none p-6 border-t border-gray-100 bg-white/80 backdrop-blur-xl z-20",children:v.jsxs("div",{className:"max-w-4xl mx-auto flex items-center gap-4",children:[v.jsx("button",{onClick:k,disabled:r,className:`flex-1 py-5 rounded-2xl font-black text-base flex items-center justify-center gap-3 transition-all ios-tap shadow-lg ${l?"bg-ios-emerald text-white":"bg-[#1C1C1E] text-white hover:bg-gray-800"}`,children:r?v.jsx("div",{className:"w-5 h-5 border-2 border-white/20 border-t-white rounded-full animate-spin"}):l?v.jsxs(v.Fragment,{children:[v.jsx(Ki,{className:"w-5 h-5"}),"    "]}):v.jsxs(v.Fragment,{children:[v.jsx(wl,{className:"w-5 h-5"}),"    "]})}),l&&v.jsxs("div",{className:"bg-ios-emerald/10 text-ios-emerald px-6 py-5 rounded-2xl font-black text-sm animate-fade-in flex items-center gap-2",children:[v.jsx(bn,{className:"w-4 h-4"}),"  ."]})]})})]})};function tL(){const[e,t]=ne.useState(()=>{const X=localStorage.getItem("activeTab");if(X)return X;const z=localStorage.getItem("currentUser");if(z)try{const G=JSON.parse(z);if(["admin","teacher"].includes(G.role))return"admin"}catch(G){console.error("Failed to parse saved user",G)}return"map"}),[r,n]=ne.useState(()=>localStorage.getItem("adminSubTab")||"attendance"),[i,s]=ne.useState(null),[l,o]=ne.useState(()=>{const X=localStorage.getItem("currentUser");return X?JSON.parse(X):null}),[a,c]=ne.useState(je(new Date,"yyyy-MM-dd")),[d,h]=ne.useState(null),[f,u]=ne.useState(()=>localStorage.getItem("schoolName")||"GOE STUDY CAFE"),[p,m]=ne.useState(""),[g,x]=ne.useState([]),[y,w]=ne.useState(null),[_,b]=ne.useState(!1),[k,S]=ne.useState(()=>window.innerWidth<768&&window.innerHeight>window.innerWidth);ne.useEffect(()=>{const X=()=>{S(window.innerWidth<768&&window.innerHeight>window.innerWidth)};return window.addEventListener("resize",X),()=>window.removeEventListener("resize",X)},[]);const E=async X=>{const z=X.trim();if(!z)return;b(!0);let G=[];try{let ae=_e.from("profiles").select("*").eq("role","student").limit(50);/^\d{3}$/.test(z)?ae=ae.or(`username.like.${z}%,full_name.ilike.%${z}%,username.ilike.%${z}%`):ae=ae.or(`full_name.ilike.%${z}%,username.ilike.%${z}%`);const{data:le,error:Z}=await ae;Z?console.error("[Search Error]",Z):G=le.map(C=>({id:C.id,full_name:C.full_name,username:C.username,grade:C.grade||0,class_number:C.class_number||0,student_number:C.student_number||0,role:"student"})),x(G)}catch(ae){console.error("Search Error:",ae),x([])}finally{b(!1)}};ne.useEffect(()=>{(async()=>{const{data:z}=await _e.from("configs").select("value").eq("key","school_info").single();z&&(u(z.value.name),localStorage.setItem("schoolName",z.value.name))})()},[]),ne.useEffect(()=>{l?localStorage.setItem("currentUser",JSON.stringify(l)):localStorage.removeItem("currentUser")},[l]),ne.useEffect(()=>{localStorage.setItem("activeTab",e)},[e]),ne.useEffect(()=>{localStorage.setItem("adminSubTab",r)},[r]);const F=()=>{o(null),localStorage.removeItem("currentUser"),localStorage.removeItem("activeTab"),localStorage.removeItem("adminSubTab"),t("map")};if(!l)return v.jsx(q6,{onLoginSuccess:X=>{o(X),["admin","teacher"].includes(X.role)&&t("admin")}});const P=[{id:"admin",icon:_d,label:"/ ",roles:["admin","teacher"]},{id:"map",icon:Eu,label:"",roles:["admin","student","parent","teacher"]},{id:"attendance",icon:Us,label:" ",roles:["student"]},{id:"profile",icon:_l,label:"  ",roles:["student","parent"]}].filter(X=>!X.roles||X.roles.includes(l.role)),D=[{group:" ",items:[{id:"attendance",label:"  ",icon:wd,roles:["admin","teacher"]},{id:"attendance_print",label:" ",icon:Nu,roles:["admin","teacher"]},{id:"safety",label:" /",icon:$0,roles:["admin","teacher"]}]},{group:"   ",items:[{id:"zones",label:"  ",icon:ey,roles:["admin"]},{id:"layout",label:"  ",icon:Tu,roles:["admin"]},{id:"students",label:"  ",icon:ql,roles:["admin"]},{id:"schedule",label:"  ",icon:qs,roles:["admin"]}]},{group:" ",items:[{id:"settings",label:" ",icon:_d,roles:["admin"]}]}].map(X=>({...X,items:X.items.filter(z=>z.roles.includes(l.role))})).filter(X=>X.items.length>0);return["admin","teacher"].includes(l.role),l.role==="teacher"||l.role==="admin"&&k?v.jsx(H6,{onLogout:F,currentUser:l}):l.role==="student"?v.jsx(X6,{onLogout:F,currentUser:l}):l.role==="parent"?v.jsx(K6,{onLogout:F,currentUser:l}):v.jsxs("div",{className:"flex flex-col h-screen bg-[#F2F2F7] text-[#1C1C1E] overflow-hidden font-sans selection:bg-ios-indigo/10",children:[v.jsxs("header",{className:"glass-header px-4 py-2.5 lg:px-8 flex items-center justify-between shadow-sm",children:[v.jsxs("div",{className:"flex items-center gap-6",children:[v.jsxs("div",{className:"flex items-center gap-3 group cursor-default",children:[v.jsx("div",{className:"w-9 h-9 rounded-apple-md bg-[#1C1C1E] flex items-center justify-center shadow-lg shadow-black/5 group-hover:scale-105 transition-transform",children:v.jsx(Eu,{className:"w-5 h-5 text-white"})}),v.jsxs("div",{children:[v.jsx("h1",{className:"text-lg font-black tracking-tighter leading-none text-[#1C1C1E]",children:f.split(" ")[0]}),v.jsx("p",{className:"text-[9px] font-black text-ios-indigo tracking-widest uppercase opacity-60 mt-1",children:f.split(" ").slice(1).join(" ")||"Study Cafe"})]})]}),v.jsx("nav",{className:"flex items-center gap-1 bg-gray-200/20 backdrop-blur-2xl p-1 rounded-apple-md border border-white/40 ml-4",children:P.map(X=>v.jsxs("button",{onClick:()=>t(X.id),className:`flex items-center gap-2 px-5 py-2 rounded-apple-md transition-all duration-300 ios-tap group relative ${e===X.id?"bg-white shadow-sm text-[#1C1C1E]":"text-[#1C1C1E]/50 hover:text-[#1C1C1E] hover:bg-white/40"}`,children:[v.jsx(X.icon,{className:`w-4 h-4 transition-all duration-300 ${e===X.id?"text-ios-indigo":"group-hover:scale-110"}`}),v.jsx("span",{className:"font-black text-[13px]",children:X.label})]},X.id))}),e==="map"&&["admin","teacher"].includes(l.role)&&v.jsxs("div",{className:"relative ml-4 z-50",children:[y?v.jsxs("div",{className:"flex items-center gap-3 bg-white px-3 py-1.5 rounded-[12px] border-2 border-ios-indigo/20 shadow-sm animate-fade-in-scale",children:[v.jsxs("div",{className:"flex items-center gap-2 pr-2 border-r border-gray-100",children:[v.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-100 text-gray-700 flex items-center justify-center text-[10px] font-black shadow-sm border border-gray-200",children:y.full_name[0]}),v.jsxs("div",{className:"flex flex-col gap-0.5",children:[v.jsx("span",{className:"text-[12px] font-black text-[#1C1C1E]",children:y.full_name}),v.jsxs("span",{className:"text-[9px] text-gray-500 font-medium",children:["   (",y.username,")"]})]})]}),v.jsxs("button",{onClick:()=>{m(""),x([]),w(null)},className:"flex items-center gap-1.5 bg-gray-50 hover:bg-ios-rose/10 text-gray-500 hover:text-ios-rose px-2 py-1.5 rounded-[8px] transition-all group",children:[v.jsx(XS,{className:"w-3 h-3 group-hover:rotate-180 transition-transform duration-500"}),v.jsx("span",{className:"text-[10px] font-bold",children:"  "})]})]}):v.jsxs("div",{className:"group flex items-center gap-2 bg-gray-50/80 px-3 py-1.5 rounded-[10px] border border-gray-100 backdrop-blur-md transition-all focus-within:bg-white focus-within:shadow-md focus-within:w-72 w-56 focus-within:border-ios-indigo/50",children:[v.jsx(wd,{className:"w-3.5 h-3.5 text-gray-400 group-focus-within:text-ios-indigo transition-colors"}),v.jsx("input",{type:"text",value:p,onChange:X=>{m(X.target.value),X.target.value.length>=1?E(X.target.value):x([])},placeholder:"  (  )",className:"bg-transparent border-none outline-none text-[12px] font-bold placeholder:text-gray-400 w-full text-gray-700"})]}),g.length>0&&!y&&v.jsx("div",{className:"absolute top-full left-0 mt-2 w-72 bg-white/90 backdrop-blur-xl rounded-[12px] shadow-xl border border-gray-100 overflow-hidden animate-spring-up p-1 z-50",children:g.map(X=>v.jsxs("button",{onClick:()=>{w(X),m(""),x([])},className:"w-full text-left px-3 py-2.5 hover:bg-ios-indigo/5 rounded-[8px] transition-colors flex items-center justify-between group border-b border-gray-50 last:border-0",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-8 h-8 rounded-[8px] bg-gray-100 group-hover:bg-white group-hover:shadow-sm flex items-center justify-center text-[10px] font-bold text-gray-500 group-hover:text-ios-indigo transition-all",children:X.full_name[0]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-[13px] font-bold text-[#1C1C1E] group-hover:text-ios-indigo transition-colors",children:X.full_name}),v.jsxs("div",{className:"text-[10px] text-gray-400 font-mono flex items-center gap-1",children:[v.jsxs("span",{children:["ID: ",X.username]}),X.grade>0&&v.jsx("span",{className:"text-gray-300",children:"|"}),X.grade>0&&v.jsxs("span",{children:[X.grade," ",X.class_number," ",X.student_number,""]})]})]})]}),v.jsx("div",{className:"text-[10px] bg-gray-50 text-gray-400 px-2 py-1 rounded-[6px] group-hover:bg-ios-indigo group-hover:text-white transition-colors font-bold",children:""})]},X.id))})]})]}),v.jsxs("div",{className:"flex items-center gap-7",children:[v.jsxs("div",{className:"flex items-center gap-3 bg-gray-200/20 p-1 px-4 py-2 rounded-apple-md border border-white/40 backdrop-blur-lg",children:[v.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-white/50 border border-white flex items-center justify-center shadow-sm",children:v.jsx(_l,{className:"w-4 h-4 text-ios-indigo"})}),v.jsxs("div",{className:"text-left",children:[v.jsx("p",{className:"text-[13px] font-black leading-none text-[#1C1C1E] uppercase",children:l==null?void 0:l.full_name}),v.jsx("p",{className:"text-[9px] font-black text-ios-indigo tracking-widest mt-1 uppercase opacity-60 italic",children:l==null?void 0:l.role})]})]}),v.jsxs("button",{onClick:F,className:"flex items-center gap-2 p-2 px-5 rounded-apple-md text-ios-gray hover:text-ios-rose hover:bg-ios-rose/5 transition-all ios-tap border border-transparent hover:border-ios-rose/10 group",children:[v.jsx(uf,{className:"w-4 h-4 group-hover:-translate-x-0.5 transition-transform"}),v.jsx("span",{className:"font-bold text-[13px]",children:""})]})]})]}),v.jsx("main",{className:"flex-1 h-full flex overflow-hidden relative",children:e==="admin"?v.jsxs("div",{className:"flex-1 flex overflow-hidden w-full",children:[v.jsxs("aside",{className:"w-64 glass-material flex flex-col p-6 shrink-0 z-30 shadow-[4px_0_40px_rgba(0,0,0,0.02)] translate-x-0",children:[v.jsx("div",{className:"flex-1 space-y-9",children:D.map((X,z)=>v.jsxs("div",{className:"space-y-4",children:[v.jsx("h5",{className:"text-[10px] font-black text-ios-gray/60 uppercase tracking-[0.25em] px-3",children:X.group}),v.jsx("div",{className:"space-y-1.5",children:X.items.map(G=>v.jsxs("button",{onClick:()=>n(G.id),className:`w-full flex items-center gap-3.5 px-3 py-3 rounded-apple-md text-[13.5px] font-bold transition-all ios-tap group ${r===G.id?"bg-white shadow-sm text-[#1C1C1E]":"text-ios-gray hover:text-[#1C1C1E] hover:bg-white/40"}`,children:[v.jsx(G.icon,{className:`w-4 h-4 ${r===G.id?"text-ios-indigo":"text-ios-gray/50 group-hover:text-ios-indigo transition-colors"}`}),G.label]},G.id))})]},z))}),v.jsx("div",{className:"pt-6 border-t border-gray-50",children:v.jsx("p",{className:"text-[8px] font-bold text-gray-300 tracking-tighter uppercase italic",children:"Copyright murmurgene 2026. All rights reserved."})})]}),v.jsx("div",{className:"flex-1 bg-[#F2F2F7] p-6 overflow-hidden",children:v.jsx("div",{className:"h-full w-full rounded-2xl overflow-hidden shadow-sm border border-black/5 bg-white",children:r==="zones"?v.jsx(eL,{}):r==="layout"?v.jsx(GE,{}):r==="attendance"?v.jsx(A_,{}):r==="attendance_print"?v.jsx(Z6,{}):r==="students"?v.jsx(G6,{}):r==="schedule"?v.jsx(J6,{}):r==="settings"?v.jsx(Q6,{}):v.jsx(W6,{})})})]}):v.jsx("div",{className:"flex-1 h-full flex flex-col overflow-hidden p-6",children:e==="attendance"?v.jsx("div",{className:"h-full flex flex-col items-center justify-center",children:v.jsx(X_,{})}):e==="profile"?v.jsx("div",{className:"h-full overflow-y-auto scrollbar-hide",children:v.jsx(Y_,{})}):v.jsx("div",{className:"flex-1 flex flex-col overflow-hidden pt-2",children:v.jsxs("section",{className:"flex-1 flex flex-col xl:flex-row gap-6 leading-normal overflow-hidden h-full",children:[v.jsx("div",{className:"flex-1 flex flex-col overflow-hidden h-full",children:v.jsx("div",{className:"flex-1 w-full glass-card overflow-hidden p-2 shadow-sm h-full",children:v.jsx(V_,{onSelectSeat:s,selectedProxyUser:y,viewDate:a,onDateChange:c,selectedZoneId:d,onZoneChange:h})})}),v.jsx("div",{className:"xl:w-[340px] h-full overflow-y-auto scrollbar-hide glass-card shadow-sm",children:v.jsx(Y6,{selectedSeat:i,onComplete:()=>s(null),targetUser:y,loggedInUser:l,initialDate:a,onDateChange:c,currentZoneId:d})})]})})})})]})}class rL extends tu.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){this.setState({error:t,errorInfo:r}),console.error("Uncaught error:",t,r)}render(){return this.state.hasError?v.jsxs("div",{className:"p-8 bg-white h-screen w-full flex flex-col items-center justify-center text-[#1C1C1E]",children:[v.jsx("h1",{className:"text-2xl font-black mb-4 text-ios-rose",children:"Application Crash"}),v.jsxs("pre",{className:"bg-gray-100 p-4 rounded text-xs overflow-auto max-w-full",children:[this.state.error&&this.state.error.toString(),v.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]}),v.jsx("button",{onClick:()=>window.location.reload(),className:"mt-6 px-6 py-3 bg-[#1C1C1E] text-white rounded-[6px] font-black",children:"Reload Application"})]}):this.props.children}}Th.createRoot(document.getElementById("root")).render(v.jsx(tu.StrictMode,{children:v.jsx(rL,{children:v.jsx(tL,{})})}));
