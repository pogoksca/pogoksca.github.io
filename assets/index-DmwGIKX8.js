(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function j_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function P_(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var gx={exports:{}},ju={},mx={exports:{}},rt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nl=Symbol.for("react.element"),D_=Symbol.for("react.portal"),R_=Symbol.for("react.fragment"),I_=Symbol.for("react.strict_mode"),M_=Symbol.for("react.profiler"),L_=Symbol.for("react.provider"),B_=Symbol.for("react.context"),U_=Symbol.for("react.forward_ref"),W_=Symbol.for("react.suspense"),z_=Symbol.for("react.memo"),H_=Symbol.for("react.lazy"),yp=Symbol.iterator;function $_(e){return e===null||typeof e!="object"?null:(e=yp&&e[yp]||e["@@iterator"],typeof e=="function"?e:null)}var xx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},vx=Object.assign,yx={};function Va(e,t,r){this.props=e,this.context=t,this.refs=yx,this.updater=r||xx}Va.prototype.isReactComponent={};Va.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Va.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function wx(){}wx.prototype=Va.prototype;function Od(e,t,r){this.props=e,this.context=t,this.refs=yx,this.updater=r||xx}var Fd=Od.prototype=new wx;Fd.constructor=Od;vx(Fd,Va.prototype);Fd.isPureReactComponent=!0;var wp=Array.isArray,_x=Object.prototype.hasOwnProperty,jd={current:null},bx={key:!0,ref:!0,__self:!0,__source:!0};function Sx(e,t,r){var n,i={},s=null,l=null;if(t!=null)for(n in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(s=""+t.key),t)_x.call(t,n)&&!bx.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var a=Array(o),c=0;c<o;c++)a[c]=arguments[c+2];i.children=a}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Nl,type:e,key:s,ref:l,props:i,_owner:jd.current}}function V_(e,t){return{$$typeof:Nl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Pd(e){return typeof e=="object"&&e!==null&&e.$$typeof===Nl}function X_(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var _p=/\/+/g;function df(e,t){return typeof e=="object"&&e!==null&&e.key!=null?X_(""+e.key):t.toString(36)}function Nc(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Nl:case D_:l=!0}}if(l)return l=e,i=i(l),e=n===""?"."+df(l,0):n,wp(i)?(r="",e!=null&&(r=e.replace(_p,"$&/")+"/"),Nc(i,t,r,"",function(c){return c})):i!=null&&(Pd(i)&&(i=V_(i,r+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(_p,"$&/")+"/")+e)),t.push(i)),1;if(l=0,n=n===""?".":n+":",wp(e))for(var o=0;o<e.length;o++){s=e[o];var a=n+df(s,o);l+=Nc(s,t,r,a,i)}else if(a=$_(e),typeof a=="function")for(e=a.call(e),o=0;!(s=e.next()).done;)s=s.value,a=n+df(s,o++),l+=Nc(s,t,r,a,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Yl(e,t,r){if(e==null)return e;var n=[],i=0;return Nc(e,n,"","",function(s){return t.call(r,s,i++)}),n}function Y_(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Or={current:null},Ac={transition:null},G_={ReactCurrentDispatcher:Or,ReactCurrentBatchConfig:Ac,ReactCurrentOwner:jd};function kx(){throw Error("act(...) is not supported in production builds of React.")}rt.Children={map:Yl,forEach:function(e,t,r){Yl(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Yl(e,function(){t++}),t},toArray:function(e){return Yl(e,function(t){return t})||[]},only:function(e){if(!Pd(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};rt.Component=Va;rt.Fragment=R_;rt.Profiler=M_;rt.PureComponent=Od;rt.StrictMode=I_;rt.Suspense=W_;rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=G_;rt.act=kx;rt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=vx({},e.props),i=e.key,s=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,l=jd.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(a in t)_x.call(t,a)&&!bx.hasOwnProperty(a)&&(n[a]=t[a]===void 0&&o!==void 0?o[a]:t[a])}var a=arguments.length-2;if(a===1)n.children=r;else if(1<a){o=Array(a);for(var c=0;c<a;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Nl,type:e.type,key:i,ref:s,props:n,_owner:l}};rt.createContext=function(e){return e={$$typeof:B_,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:L_,_context:e},e.Consumer=e};rt.createElement=Sx;rt.createFactory=function(e){var t=Sx.bind(null,e);return t.type=e,t};rt.createRef=function(){return{current:null}};rt.forwardRef=function(e){return{$$typeof:U_,render:e}};rt.isValidElement=Pd;rt.lazy=function(e){return{$$typeof:H_,_payload:{_status:-1,_result:e},_init:Y_}};rt.memo=function(e,t){return{$$typeof:z_,type:e,compare:t===void 0?null:t}};rt.startTransition=function(e){var t=Ac.transition;Ac.transition={};try{e()}finally{Ac.transition=t}};rt.unstable_act=kx;rt.useCallback=function(e,t){return Or.current.useCallback(e,t)};rt.useContext=function(e){return Or.current.useContext(e)};rt.useDebugValue=function(){};rt.useDeferredValue=function(e){return Or.current.useDeferredValue(e)};rt.useEffect=function(e,t){return Or.current.useEffect(e,t)};rt.useId=function(){return Or.current.useId()};rt.useImperativeHandle=function(e,t,r){return Or.current.useImperativeHandle(e,t,r)};rt.useInsertionEffect=function(e,t){return Or.current.useInsertionEffect(e,t)};rt.useLayoutEffect=function(e,t){return Or.current.useLayoutEffect(e,t)};rt.useMemo=function(e,t){return Or.current.useMemo(e,t)};rt.useReducer=function(e,t,r){return Or.current.useReducer(e,t,r)};rt.useRef=function(e){return Or.current.useRef(e)};rt.useState=function(e){return Or.current.useState(e)};rt.useSyncExternalStore=function(e,t,r){return Or.current.useSyncExternalStore(e,t,r)};rt.useTransition=function(){return Or.current.useTransition()};rt.version="18.3.1";mx.exports=rt;var le=mx.exports;const Cx=j_(le);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q_=le,K_=Symbol.for("react.element"),J_=Symbol.for("react.fragment"),Q_=Object.prototype.hasOwnProperty,Z_=q_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,e2={key:!0,ref:!0,__self:!0,__source:!0};function Tx(e,t,r){var n,i={},s=null,l=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)Q_.call(t,n)&&!e2.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:K_,type:e,key:s,ref:l,props:i,_owner:Z_.current}}ju.Fragment=J_;ju.jsx=Tx;ju.jsxs=Tx;gx.exports=ju;var y=gx.exports,uh={},Ex={exports:{}},Qr={},Nx={exports:{}},Ax={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(J,T){var j=J.length;J.push(T);e:for(;0<j;){var B=j-1>>>1,E=J[B];if(0<i(E,T))J[B]=T,J[j]=E,j=B;else break e}}function r(J){return J.length===0?null:J[0]}function n(J){if(J.length===0)return null;var T=J[0],j=J.pop();if(j!==T){J[0]=j;e:for(var B=0,E=J.length,R=E>>>1;B<R;){var N=2*(B+1)-1,C=J[N],P=N+1,I=J[P];if(0>i(C,j))P<E&&0>i(I,C)?(J[B]=I,J[P]=j,B=P):(J[B]=C,J[N]=j,B=N);else if(P<E&&0>i(I,j))J[B]=I,J[P]=j,B=P;else break e}}return T}function i(J,T){var j=J.sortIndex-T.sortIndex;return j!==0?j:J.id-T.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var a=[],c=[],d=1,f=null,h=3,u=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(J){for(var T=r(c);T!==null;){if(T.callback===null)n(c);else if(T.startTime<=J)n(c),T.sortIndex=T.expirationTime,t(a,T);else break;T=r(c)}}function _(J){if(m=!1,w(J),!p)if(r(a)!==null)p=!0,K(b);else{var T=r(c);T!==null&&ne(_,T.startTime-J)}}function b(J,T){p=!1,m&&(m=!1,x(O),O=-1),u=!0;var j=h;try{for(w(T),f=r(a);f!==null&&(!(f.expirationTime>T)||J&&!U());){var B=f.callback;if(typeof B=="function"){f.callback=null,h=f.priorityLevel;var E=B(f.expirationTime<=T);T=e.unstable_now(),typeof E=="function"?f.callback=E:f===r(a)&&n(a),w(T)}else n(a);f=r(a)}if(f!==null)var R=!0;else{var N=r(c);N!==null&&ne(_,N.startTime-T),R=!1}return R}finally{f=null,h=j,u=!1}}var k=!1,S=null,O=-1,F=5,D=-1;function U(){return!(e.unstable_now()-D<F)}function M(){if(S!==null){var J=e.unstable_now();D=J;var T=!0;try{T=S(!0,J)}finally{T?q():(k=!1,S=null)}}else k=!1}var q;if(typeof v=="function")q=function(){v(M)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,Q=G.port2;G.port1.onmessage=M,q=function(){Q.postMessage(null)}}else q=function(){g(M,0)};function K(J){S=J,k||(k=!0,q())}function ne(J,T){O=g(function(){J(e.unstable_now())},T)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(J){J.callback=null},e.unstable_continueExecution=function(){p||u||(p=!0,K(b))},e.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<J?Math.floor(1e3/J):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(a)},e.unstable_next=function(J){switch(h){case 1:case 2:case 3:var T=3;break;default:T=h}var j=h;h=T;try{return J()}finally{h=j}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(J,T){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var j=h;h=J;try{return T()}finally{h=j}},e.unstable_scheduleCallback=function(J,T,j){var B=e.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?B+j:B):j=B,J){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=j+E,J={id:d++,callback:T,priorityLevel:J,startTime:j,expirationTime:E,sortIndex:-1},j>B?(J.sortIndex=j,t(c,J),r(a)===null&&J===r(c)&&(m?(x(O),O=-1):m=!0,ne(_,j-B))):(J.sortIndex=E,t(a,J),p||u||(p=!0,K(b))),J},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(J){var T=h;return function(){var j=h;h=T;try{return J.apply(this,arguments)}finally{h=j}}}})(Ax);Nx.exports=Ax;var t2=Nx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r2=le,Kr=t2;function ke(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ox=new Set,Wo={};function Is(e,t){Pa(e,t),Pa(e+"Capture",t)}function Pa(e,t){for(Wo[e]=t,e=0;e<t.length;e++)Ox.add(t[e])}var si=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fh=Object.prototype.hasOwnProperty,n2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,bp={},Sp={};function i2(e){return fh.call(Sp,e)?!0:fh.call(bp,e)?!1:n2.test(e)?Sp[e]=!0:(bp[e]=!0,!1)}function s2(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function a2(e,t,r,n){if(t===null||typeof t>"u"||s2(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Fr(e,t,r,n,i,s,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=l}var fr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){fr[e]=new Fr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];fr[t]=new Fr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){fr[e]=new Fr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){fr[e]=new Fr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){fr[e]=new Fr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){fr[e]=new Fr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){fr[e]=new Fr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){fr[e]=new Fr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){fr[e]=new Fr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Dd=/[\-:]([a-z])/g;function Rd(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Dd,Rd);fr[t]=new Fr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Dd,Rd);fr[t]=new Fr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Dd,Rd);fr[t]=new Fr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){fr[e]=new Fr(e,1,!1,e.toLowerCase(),null,!1,!1)});fr.xlinkHref=new Fr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){fr[e]=new Fr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Id(e,t,r,n){var i=fr.hasOwnProperty(t)?fr[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(a2(t,r,i,n)&&(r=null),n||i===null?i2(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var fi=r2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Gl=Symbol.for("react.element"),aa=Symbol.for("react.portal"),oa=Symbol.for("react.fragment"),Md=Symbol.for("react.strict_mode"),hh=Symbol.for("react.profiler"),Fx=Symbol.for("react.provider"),jx=Symbol.for("react.context"),Ld=Symbol.for("react.forward_ref"),dh=Symbol.for("react.suspense"),ph=Symbol.for("react.suspense_list"),Bd=Symbol.for("react.memo"),wi=Symbol.for("react.lazy"),Px=Symbol.for("react.offscreen"),kp=Symbol.iterator;function ro(e){return e===null||typeof e!="object"?null:(e=kp&&e[kp]||e["@@iterator"],typeof e=="function"?e:null)}var Ft=Object.assign,pf;function po(e){if(pf===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);pf=t&&t[1]||""}return`
`+pf+e}var gf=!1;function mf(e,t){if(!e||gf)return"";gf=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),l=i.length-1,o=s.length-1;1<=l&&0<=o&&i[l]!==s[o];)o--;for(;1<=l&&0<=o;l--,o--)if(i[l]!==s[o]){if(l!==1||o!==1)do if(l--,o--,0>o||i[l]!==s[o]){var a=`
`+i[l].replace(" at new "," at ");return e.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",e.displayName)),a}while(1<=l&&0<=o);break}}}finally{gf=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?po(e):""}function o2(e){switch(e.tag){case 5:return po(e.type);case 16:return po("Lazy");case 13:return po("Suspense");case 19:return po("SuspenseList");case 0:case 2:case 15:return e=mf(e.type,!1),e;case 11:return e=mf(e.type.render,!1),e;case 1:return e=mf(e.type,!0),e;default:return""}}function gh(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case oa:return"Fragment";case aa:return"Portal";case hh:return"Profiler";case Md:return"StrictMode";case dh:return"Suspense";case ph:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case jx:return(e.displayName||"Context")+".Consumer";case Fx:return(e._context.displayName||"Context")+".Provider";case Ld:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Bd:return t=e.displayName||null,t!==null?t:gh(e.type)||"Memo";case wi:t=e._payload,e=e._init;try{return gh(e(t))}catch{}}return null}function l2(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return gh(t);case 8:return t===Md?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Wi(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Dx(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function c2(e){var t=Dx(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(l){n=""+l,s.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ql(e){e._valueTracker||(e._valueTracker=c2(e))}function Rx(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Dx(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function zc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function mh(e,t){var r=t.checked;return Ft({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Cp(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Wi(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Ix(e,t){t=t.checked,t!=null&&Id(e,"checked",t,!1)}function xh(e,t){Ix(e,t);var r=Wi(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?vh(e,t.type,r):t.hasOwnProperty("defaultValue")&&vh(e,t.type,Wi(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Tp(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function vh(e,t,r){(t!=="number"||zc(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var go=Array.isArray;function wa(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Wi(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function yh(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ke(91));return Ft({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ep(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ke(92));if(go(r)){if(1<r.length)throw Error(ke(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Wi(r)}}function Mx(e,t){var r=Wi(t.value),n=Wi(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Np(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Lx(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function wh(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Lx(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Kl,Bx=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Kl=Kl||document.createElement("div"),Kl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Kl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function zo(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var bo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},u2=["Webkit","ms","Moz","O"];Object.keys(bo).forEach(function(e){u2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),bo[t]=bo[e]})});function Ux(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||bo.hasOwnProperty(e)&&bo[e]?(""+t).trim():t+"px"}function Wx(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Ux(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var f2=Ft({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _h(e,t){if(t){if(f2[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ke(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ke(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ke(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ke(62))}}function bh(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sh=null;function Ud(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var kh=null,_a=null,ba=null;function Ap(e){if(e=Fl(e)){if(typeof kh!="function")throw Error(ke(280));var t=e.stateNode;t&&(t=Mu(t),kh(e.stateNode,e.type,t))}}function zx(e){_a?ba?ba.push(e):ba=[e]:_a=e}function Hx(){if(_a){var e=_a,t=ba;if(ba=_a=null,Ap(e),t)for(e=0;e<t.length;e++)Ap(t[e])}}function $x(e,t){return e(t)}function Vx(){}var xf=!1;function Xx(e,t,r){if(xf)return e(t,r);xf=!0;try{return $x(e,t,r)}finally{xf=!1,(_a!==null||ba!==null)&&(Vx(),Hx())}}function Ho(e,t){var r=e.stateNode;if(r===null)return null;var n=Mu(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ke(231,t,typeof r));return r}var Ch=!1;if(si)try{var no={};Object.defineProperty(no,"passive",{get:function(){Ch=!0}}),window.addEventListener("test",no,no),window.removeEventListener("test",no,no)}catch{Ch=!1}function h2(e,t,r,n,i,s,l,o,a){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var So=!1,Hc=null,$c=!1,Th=null,d2={onError:function(e){So=!0,Hc=e}};function p2(e,t,r,n,i,s,l,o,a){So=!1,Hc=null,h2.apply(d2,arguments)}function g2(e,t,r,n,i,s,l,o,a){if(p2.apply(this,arguments),So){if(So){var c=Hc;So=!1,Hc=null}else throw Error(ke(198));$c||($c=!0,Th=c)}}function Ms(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Yx(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Op(e){if(Ms(e)!==e)throw Error(ke(188))}function m2(e){var t=e.alternate;if(!t){if(t=Ms(e),t===null)throw Error(ke(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Op(i),e;if(s===n)return Op(i),t;s=s.sibling}throw Error(ke(188))}if(r.return!==n.return)r=i,n=s;else{for(var l=!1,o=i.child;o;){if(o===r){l=!0,r=i,n=s;break}if(o===n){l=!0,n=i,r=s;break}o=o.sibling}if(!l){for(o=s.child;o;){if(o===r){l=!0,r=s,n=i;break}if(o===n){l=!0,n=s,r=i;break}o=o.sibling}if(!l)throw Error(ke(189))}}if(r.alternate!==n)throw Error(ke(190))}if(r.tag!==3)throw Error(ke(188));return r.stateNode.current===r?e:t}function Gx(e){return e=m2(e),e!==null?qx(e):null}function qx(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=qx(e);if(t!==null)return t;e=e.sibling}return null}var Kx=Kr.unstable_scheduleCallback,Fp=Kr.unstable_cancelCallback,x2=Kr.unstable_shouldYield,v2=Kr.unstable_requestPaint,Lt=Kr.unstable_now,y2=Kr.unstable_getCurrentPriorityLevel,Wd=Kr.unstable_ImmediatePriority,Jx=Kr.unstable_UserBlockingPriority,Vc=Kr.unstable_NormalPriority,w2=Kr.unstable_LowPriority,Qx=Kr.unstable_IdlePriority,Pu=null,Wn=null;function _2(e){if(Wn&&typeof Wn.onCommitFiberRoot=="function")try{Wn.onCommitFiberRoot(Pu,e,void 0,(e.current.flags&128)===128)}catch{}}var Cn=Math.clz32?Math.clz32:k2,b2=Math.log,S2=Math.LN2;function k2(e){return e>>>=0,e===0?32:31-(b2(e)/S2|0)|0}var Jl=64,Ql=4194304;function mo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Xc(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~i;o!==0?n=mo(o):(s&=l,s!==0&&(n=mo(s)))}else l=r&~i,l!==0?n=mo(l):s!==0&&(n=mo(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Cn(t),i=1<<r,n|=e[r],t&=~i;return n}function C2(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function T2(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var l=31-Cn(s),o=1<<l,a=i[l];a===-1?(!(o&r)||o&n)&&(i[l]=C2(o,t)):a<=t&&(e.expiredLanes|=o),s&=~o}}function Eh(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Zx(){var e=Jl;return Jl<<=1,!(Jl&4194240)&&(Jl=64),e}function vf(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Al(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Cn(t),e[t]=r}function E2(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Cn(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function zd(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Cn(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var ht=0;function e1(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var t1,Hd,r1,n1,i1,Nh=!1,Zl=[],Oi=null,Fi=null,ji=null,$o=new Map,Vo=new Map,Si=[],N2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jp(e,t){switch(e){case"focusin":case"focusout":Oi=null;break;case"dragenter":case"dragleave":Fi=null;break;case"mouseover":case"mouseout":ji=null;break;case"pointerover":case"pointerout":$o.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vo.delete(t.pointerId)}}function io(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=Fl(t),t!==null&&Hd(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function A2(e,t,r,n,i){switch(t){case"focusin":return Oi=io(Oi,e,t,r,n,i),!0;case"dragenter":return Fi=io(Fi,e,t,r,n,i),!0;case"mouseover":return ji=io(ji,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return $o.set(s,io($o.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Vo.set(s,io(Vo.get(s)||null,e,t,r,n,i)),!0}return!1}function s1(e){var t=fs(e.target);if(t!==null){var r=Ms(t);if(r!==null){if(t=r.tag,t===13){if(t=Yx(r),t!==null){e.blockedOn=t,i1(e.priority,function(){r1(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Oc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Ah(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Sh=n,r.target.dispatchEvent(n),Sh=null}else return t=Fl(r),t!==null&&Hd(t),e.blockedOn=r,!1;t.shift()}return!0}function Pp(e,t,r){Oc(e)&&r.delete(t)}function O2(){Nh=!1,Oi!==null&&Oc(Oi)&&(Oi=null),Fi!==null&&Oc(Fi)&&(Fi=null),ji!==null&&Oc(ji)&&(ji=null),$o.forEach(Pp),Vo.forEach(Pp)}function so(e,t){e.blockedOn===t&&(e.blockedOn=null,Nh||(Nh=!0,Kr.unstable_scheduleCallback(Kr.unstable_NormalPriority,O2)))}function Xo(e){function t(i){return so(i,e)}if(0<Zl.length){so(Zl[0],e);for(var r=1;r<Zl.length;r++){var n=Zl[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Oi!==null&&so(Oi,e),Fi!==null&&so(Fi,e),ji!==null&&so(ji,e),$o.forEach(t),Vo.forEach(t),r=0;r<Si.length;r++)n=Si[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Si.length&&(r=Si[0],r.blockedOn===null);)s1(r),r.blockedOn===null&&Si.shift()}var Sa=fi.ReactCurrentBatchConfig,Yc=!0;function F2(e,t,r,n){var i=ht,s=Sa.transition;Sa.transition=null;try{ht=1,$d(e,t,r,n)}finally{ht=i,Sa.transition=s}}function j2(e,t,r,n){var i=ht,s=Sa.transition;Sa.transition=null;try{ht=4,$d(e,t,r,n)}finally{ht=i,Sa.transition=s}}function $d(e,t,r,n){if(Yc){var i=Ah(e,t,r,n);if(i===null)Nf(e,t,n,Gc,r),jp(e,n);else if(A2(i,e,t,r,n))n.stopPropagation();else if(jp(e,n),t&4&&-1<N2.indexOf(e)){for(;i!==null;){var s=Fl(i);if(s!==null&&t1(s),s=Ah(e,t,r,n),s===null&&Nf(e,t,n,Gc,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Nf(e,t,n,null,r)}}var Gc=null;function Ah(e,t,r,n){if(Gc=null,e=Ud(n),e=fs(e),e!==null)if(t=Ms(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Yx(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gc=e,null}function a1(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(y2()){case Wd:return 1;case Jx:return 4;case Vc:case w2:return 16;case Qx:return 536870912;default:return 16}default:return 16}}var Ti=null,Vd=null,Fc=null;function o1(){if(Fc)return Fc;var e,t=Vd,r=t.length,n,i="value"in Ti?Ti.value:Ti.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var l=r-e;for(n=1;n<=l&&t[r-n]===i[s-n];n++);return Fc=i.slice(e,1<n?1-n:void 0)}function jc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ec(){return!0}function Dp(){return!1}function Zr(e){function t(r,n,i,s,l){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ec:Dp,this.isPropagationStopped=Dp,this}return Ft(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ec)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ec)},persist:function(){},isPersistent:ec}),t}var Xa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xd=Zr(Xa),Ol=Ft({},Xa,{view:0,detail:0}),P2=Zr(Ol),yf,wf,ao,Du=Ft({},Ol,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ao&&(ao&&e.type==="mousemove"?(yf=e.screenX-ao.screenX,wf=e.screenY-ao.screenY):wf=yf=0,ao=e),yf)},movementY:function(e){return"movementY"in e?e.movementY:wf}}),Rp=Zr(Du),D2=Ft({},Du,{dataTransfer:0}),R2=Zr(D2),I2=Ft({},Ol,{relatedTarget:0}),_f=Zr(I2),M2=Ft({},Xa,{animationName:0,elapsedTime:0,pseudoElement:0}),L2=Zr(M2),B2=Ft({},Xa,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),U2=Zr(B2),W2=Ft({},Xa,{data:0}),Ip=Zr(W2),z2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},H2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function V2(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=$2[e])?!!t[e]:!1}function Yd(){return V2}var X2=Ft({},Ol,{key:function(e){if(e.key){var t=z2[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=jc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?H2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yd,charCode:function(e){return e.type==="keypress"?jc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?jc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Y2=Zr(X2),G2=Ft({},Du,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Mp=Zr(G2),q2=Ft({},Ol,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yd}),K2=Zr(q2),J2=Ft({},Xa,{propertyName:0,elapsedTime:0,pseudoElement:0}),Q2=Zr(J2),Z2=Ft({},Du,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),eb=Zr(Z2),tb=[9,13,27,32],Gd=si&&"CompositionEvent"in window,ko=null;si&&"documentMode"in document&&(ko=document.documentMode);var rb=si&&"TextEvent"in window&&!ko,l1=si&&(!Gd||ko&&8<ko&&11>=ko),Lp=" ",Bp=!1;function c1(e,t){switch(e){case"keyup":return tb.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function u1(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var la=!1;function nb(e,t){switch(e){case"compositionend":return u1(t);case"keypress":return t.which!==32?null:(Bp=!0,Lp);case"textInput":return e=t.data,e===Lp&&Bp?null:e;default:return null}}function ib(e,t){if(la)return e==="compositionend"||!Gd&&c1(e,t)?(e=o1(),Fc=Vd=Ti=null,la=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return l1&&t.locale!=="ko"?null:t.data;default:return null}}var sb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Up(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!sb[e.type]:t==="textarea"}function f1(e,t,r,n){zx(n),t=qc(t,"onChange"),0<t.length&&(r=new Xd("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Co=null,Yo=null;function ab(e){b1(e,0)}function Ru(e){var t=fa(e);if(Rx(t))return e}function ob(e,t){if(e==="change")return t}var h1=!1;if(si){var bf;if(si){var Sf="oninput"in document;if(!Sf){var Wp=document.createElement("div");Wp.setAttribute("oninput","return;"),Sf=typeof Wp.oninput=="function"}bf=Sf}else bf=!1;h1=bf&&(!document.documentMode||9<document.documentMode)}function zp(){Co&&(Co.detachEvent("onpropertychange",d1),Yo=Co=null)}function d1(e){if(e.propertyName==="value"&&Ru(Yo)){var t=[];f1(t,Yo,e,Ud(e)),Xx(ab,t)}}function lb(e,t,r){e==="focusin"?(zp(),Co=t,Yo=r,Co.attachEvent("onpropertychange",d1)):e==="focusout"&&zp()}function cb(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ru(Yo)}function ub(e,t){if(e==="click")return Ru(t)}function fb(e,t){if(e==="input"||e==="change")return Ru(t)}function hb(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var On=typeof Object.is=="function"?Object.is:hb;function Go(e,t){if(On(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!fh.call(t,i)||!On(e[i],t[i]))return!1}return!0}function Hp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function $p(e,t){var r=Hp(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Hp(r)}}function p1(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?p1(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function g1(){for(var e=window,t=zc();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=zc(e.document)}return t}function qd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function db(e){var t=g1(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&p1(r.ownerDocument.documentElement,r)){if(n!==null&&qd(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=$p(r,s);var l=$p(r,n);i&&l&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pb=si&&"documentMode"in document&&11>=document.documentMode,ca=null,Oh=null,To=null,Fh=!1;function Vp(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Fh||ca==null||ca!==zc(n)||(n=ca,"selectionStart"in n&&qd(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),To&&Go(To,n)||(To=n,n=qc(Oh,"onSelect"),0<n.length&&(t=new Xd("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=ca)))}function tc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var ua={animationend:tc("Animation","AnimationEnd"),animationiteration:tc("Animation","AnimationIteration"),animationstart:tc("Animation","AnimationStart"),transitionend:tc("Transition","TransitionEnd")},kf={},m1={};si&&(m1=document.createElement("div").style,"AnimationEvent"in window||(delete ua.animationend.animation,delete ua.animationiteration.animation,delete ua.animationstart.animation),"TransitionEvent"in window||delete ua.transitionend.transition);function Iu(e){if(kf[e])return kf[e];if(!ua[e])return e;var t=ua[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in m1)return kf[e]=t[r];return e}var x1=Iu("animationend"),v1=Iu("animationiteration"),y1=Iu("animationstart"),w1=Iu("transitionend"),_1=new Map,Xp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qi(e,t){_1.set(e,t),Is(t,[e])}for(var Cf=0;Cf<Xp.length;Cf++){var Tf=Xp[Cf],gb=Tf.toLowerCase(),mb=Tf[0].toUpperCase()+Tf.slice(1);qi(gb,"on"+mb)}qi(x1,"onAnimationEnd");qi(v1,"onAnimationIteration");qi(y1,"onAnimationStart");qi("dblclick","onDoubleClick");qi("focusin","onFocus");qi("focusout","onBlur");qi(w1,"onTransitionEnd");Pa("onMouseEnter",["mouseout","mouseover"]);Pa("onMouseLeave",["mouseout","mouseover"]);Pa("onPointerEnter",["pointerout","pointerover"]);Pa("onPointerLeave",["pointerout","pointerover"]);Is("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Is("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Is("onBeforeInput",["compositionend","keypress","textInput","paste"]);Is("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Is("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Is("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xb=new Set("cancel close invalid load scroll toggle".split(" ").concat(xo));function Yp(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,g2(n,t,void 0,e),e.currentTarget=null}function b1(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var l=n.length-1;0<=l;l--){var o=n[l],a=o.instance,c=o.currentTarget;if(o=o.listener,a!==s&&i.isPropagationStopped())break e;Yp(i,o,c),s=a}else for(l=0;l<n.length;l++){if(o=n[l],a=o.instance,c=o.currentTarget,o=o.listener,a!==s&&i.isPropagationStopped())break e;Yp(i,o,c),s=a}}}if($c)throw e=Th,$c=!1,Th=null,e}function xt(e,t){var r=t[Ih];r===void 0&&(r=t[Ih]=new Set);var n=e+"__bubble";r.has(n)||(S1(t,e,2,!1),r.add(n))}function Ef(e,t,r){var n=0;t&&(n|=4),S1(r,e,n,t)}var rc="_reactListening"+Math.random().toString(36).slice(2);function qo(e){if(!e[rc]){e[rc]=!0,Ox.forEach(function(r){r!=="selectionchange"&&(xb.has(r)||Ef(r,!1,e),Ef(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[rc]||(t[rc]=!0,Ef("selectionchange",!1,t))}}function S1(e,t,r,n){switch(a1(t)){case 1:var i=F2;break;case 4:i=j2;break;default:i=$d}r=i.bind(null,t,r,e),i=void 0,!Ch||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Nf(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(l===4)for(l=n.return;l!==null;){var a=l.tag;if((a===3||a===4)&&(a=l.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;l=l.return}for(;o!==null;){if(l=fs(o),l===null)return;if(a=l.tag,a===5||a===6){n=s=l;continue e}o=o.parentNode}}n=n.return}Xx(function(){var c=s,d=Ud(r),f=[];e:{var h=_1.get(e);if(h!==void 0){var u=Xd,p=e;switch(e){case"keypress":if(jc(r)===0)break e;case"keydown":case"keyup":u=Y2;break;case"focusin":p="focus",u=_f;break;case"focusout":p="blur",u=_f;break;case"beforeblur":case"afterblur":u=_f;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=Rp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=R2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=K2;break;case x1:case v1:case y1:u=L2;break;case w1:u=Q2;break;case"scroll":u=P2;break;case"wheel":u=eb;break;case"copy":case"cut":case"paste":u=U2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=Mp}var m=(t&4)!==0,g=!m&&e==="scroll",x=m?h!==null?h+"Capture":null:h;m=[];for(var v=c,w;v!==null;){w=v;var _=w.stateNode;if(w.tag===5&&_!==null&&(w=_,x!==null&&(_=Ho(v,x),_!=null&&m.push(Ko(v,_,w)))),g)break;v=v.return}0<m.length&&(h=new u(h,p,null,r,d),f.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",u=e==="mouseout"||e==="pointerout",h&&r!==Sh&&(p=r.relatedTarget||r.fromElement)&&(fs(p)||p[ai]))break e;if((u||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,u?(p=r.relatedTarget||r.toElement,u=c,p=p?fs(p):null,p!==null&&(g=Ms(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(u=null,p=c),u!==p)){if(m=Rp,_="onMouseLeave",x="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(m=Mp,_="onPointerLeave",x="onPointerEnter",v="pointer"),g=u==null?h:fa(u),w=p==null?h:fa(p),h=new m(_,v+"leave",u,r,d),h.target=g,h.relatedTarget=w,_=null,fs(d)===c&&(m=new m(x,v+"enter",p,r,d),m.target=w,m.relatedTarget=g,_=m),g=_,u&&p)t:{for(m=u,x=p,v=0,w=m;w;w=Vs(w))v++;for(w=0,_=x;_;_=Vs(_))w++;for(;0<v-w;)m=Vs(m),v--;for(;0<w-v;)x=Vs(x),w--;for(;v--;){if(m===x||x!==null&&m===x.alternate)break t;m=Vs(m),x=Vs(x)}m=null}else m=null;u!==null&&Gp(f,h,u,m,!1),p!==null&&g!==null&&Gp(f,g,p,m,!0)}}e:{if(h=c?fa(c):window,u=h.nodeName&&h.nodeName.toLowerCase(),u==="select"||u==="input"&&h.type==="file")var b=ob;else if(Up(h))if(h1)b=fb;else{b=cb;var k=lb}else(u=h.nodeName)&&u.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(b=ub);if(b&&(b=b(e,c))){f1(f,b,r,d);break e}k&&k(e,h,c),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&vh(h,"number",h.value)}switch(k=c?fa(c):window,e){case"focusin":(Up(k)||k.contentEditable==="true")&&(ca=k,Oh=c,To=null);break;case"focusout":To=Oh=ca=null;break;case"mousedown":Fh=!0;break;case"contextmenu":case"mouseup":case"dragend":Fh=!1,Vp(f,r,d);break;case"selectionchange":if(pb)break;case"keydown":case"keyup":Vp(f,r,d)}var S;if(Gd)e:{switch(e){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else la?c1(e,r)&&(O="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(O="onCompositionStart");O&&(l1&&r.locale!=="ko"&&(la||O!=="onCompositionStart"?O==="onCompositionEnd"&&la&&(S=o1()):(Ti=d,Vd="value"in Ti?Ti.value:Ti.textContent,la=!0)),k=qc(c,O),0<k.length&&(O=new Ip(O,e,null,r,d),f.push({event:O,listeners:k}),S?O.data=S:(S=u1(r),S!==null&&(O.data=S)))),(S=rb?nb(e,r):ib(e,r))&&(c=qc(c,"onBeforeInput"),0<c.length&&(d=new Ip("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:c}),d.data=S))}b1(f,t)})}function Ko(e,t,r){return{instance:e,listener:t,currentTarget:r}}function qc(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Ho(e,r),s!=null&&n.unshift(Ko(e,s,i)),s=Ho(e,t),s!=null&&n.push(Ko(e,s,i))),e=e.return}return n}function Vs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Gp(e,t,r,n,i){for(var s=t._reactName,l=[];r!==null&&r!==n;){var o=r,a=o.alternate,c=o.stateNode;if(a!==null&&a===n)break;o.tag===5&&c!==null&&(o=c,i?(a=Ho(r,s),a!=null&&l.unshift(Ko(r,a,o))):i||(a=Ho(r,s),a!=null&&l.push(Ko(r,a,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var vb=/\r\n?/g,yb=/\u0000|\uFFFD/g;function qp(e){return(typeof e=="string"?e:""+e).replace(vb,`
`).replace(yb,"")}function nc(e,t,r){if(t=qp(t),qp(e)!==t&&r)throw Error(ke(425))}function Kc(){}var jh=null,Ph=null;function Dh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Rh=typeof setTimeout=="function"?setTimeout:void 0,wb=typeof clearTimeout=="function"?clearTimeout:void 0,Kp=typeof Promise=="function"?Promise:void 0,_b=typeof queueMicrotask=="function"?queueMicrotask:typeof Kp<"u"?function(e){return Kp.resolve(null).then(e).catch(bb)}:Rh;function bb(e){setTimeout(function(){throw e})}function Af(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Xo(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Xo(t)}function Pi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Jp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ya=Math.random().toString(36).slice(2),Mn="__reactFiber$"+Ya,Jo="__reactProps$"+Ya,ai="__reactContainer$"+Ya,Ih="__reactEvents$"+Ya,Sb="__reactListeners$"+Ya,kb="__reactHandles$"+Ya;function fs(e){var t=e[Mn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ai]||r[Mn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Jp(e);e!==null;){if(r=e[Mn])return r;e=Jp(e)}return t}e=r,r=e.parentNode}return null}function Fl(e){return e=e[Mn]||e[ai],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function fa(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ke(33))}function Mu(e){return e[Jo]||null}var Mh=[],ha=-1;function Ki(e){return{current:e}}function yt(e){0>ha||(e.current=Mh[ha],Mh[ha]=null,ha--)}function mt(e,t){ha++,Mh[ha]=e.current,e.current=t}var zi={},br=Ki(zi),Rr=Ki(!1),ks=zi;function Da(e,t){var r=e.type.contextTypes;if(!r)return zi;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ir(e){return e=e.childContextTypes,e!=null}function Jc(){yt(Rr),yt(br)}function Qp(e,t,r){if(br.current!==zi)throw Error(ke(168));mt(br,t),mt(Rr,r)}function k1(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(ke(108,l2(e)||"Unknown",i));return Ft({},r,n)}function Qc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||zi,ks=br.current,mt(br,e),mt(Rr,Rr.current),!0}function Zp(e,t,r){var n=e.stateNode;if(!n)throw Error(ke(169));r?(e=k1(e,t,ks),n.__reactInternalMemoizedMergedChildContext=e,yt(Rr),yt(br),mt(br,e)):yt(Rr),mt(Rr,r)}var Gn=null,Lu=!1,Of=!1;function C1(e){Gn===null?Gn=[e]:Gn.push(e)}function Cb(e){Lu=!0,C1(e)}function Ji(){if(!Of&&Gn!==null){Of=!0;var e=0,t=ht;try{var r=Gn;for(ht=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Gn=null,Lu=!1}catch(i){throw Gn!==null&&(Gn=Gn.slice(e+1)),Kx(Wd,Ji),i}finally{ht=t,Of=!1}}return null}var da=[],pa=0,Zc=null,eu=0,on=[],ln=0,Cs=null,qn=1,Kn="";function is(e,t){da[pa++]=eu,da[pa++]=Zc,Zc=e,eu=t}function T1(e,t,r){on[ln++]=qn,on[ln++]=Kn,on[ln++]=Cs,Cs=e;var n=qn;e=Kn;var i=32-Cn(n)-1;n&=~(1<<i),r+=1;var s=32-Cn(t)+i;if(30<s){var l=i-i%5;s=(n&(1<<l)-1).toString(32),n>>=l,i-=l,qn=1<<32-Cn(t)+i|r<<i|n,Kn=s+e}else qn=1<<s|r<<i|n,Kn=e}function Kd(e){e.return!==null&&(is(e,1),T1(e,1,0))}function Jd(e){for(;e===Zc;)Zc=da[--pa],da[pa]=null,eu=da[--pa],da[pa]=null;for(;e===Cs;)Cs=on[--ln],on[ln]=null,Kn=on[--ln],on[ln]=null,qn=on[--ln],on[ln]=null}var Gr=null,Yr=null,St=!1,bn=null;function E1(e,t){var r=cn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function eg(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Gr=e,Yr=Pi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Gr=e,Yr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Cs!==null?{id:qn,overflow:Kn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=cn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Gr=e,Yr=null,!0):!1;default:return!1}}function Lh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Bh(e){if(St){var t=Yr;if(t){var r=t;if(!eg(e,t)){if(Lh(e))throw Error(ke(418));t=Pi(r.nextSibling);var n=Gr;t&&eg(e,t)?E1(n,r):(e.flags=e.flags&-4097|2,St=!1,Gr=e)}}else{if(Lh(e))throw Error(ke(418));e.flags=e.flags&-4097|2,St=!1,Gr=e}}}function tg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Gr=e}function ic(e){if(e!==Gr)return!1;if(!St)return tg(e),St=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Dh(e.type,e.memoizedProps)),t&&(t=Yr)){if(Lh(e))throw N1(),Error(ke(418));for(;t;)E1(e,t),t=Pi(t.nextSibling)}if(tg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ke(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Yr=Pi(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Yr=null}}else Yr=Gr?Pi(e.stateNode.nextSibling):null;return!0}function N1(){for(var e=Yr;e;)e=Pi(e.nextSibling)}function Ra(){Yr=Gr=null,St=!1}function Qd(e){bn===null?bn=[e]:bn.push(e)}var Tb=fi.ReactCurrentBatchConfig;function oo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ke(309));var n=r.stateNode}if(!n)throw Error(ke(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(l){var o=i.refs;l===null?delete o[s]:o[s]=l},t._stringRef=s,t)}if(typeof e!="string")throw Error(ke(284));if(!r._owner)throw Error(ke(290,e))}return e}function sc(e,t){throw e=Object.prototype.toString.call(t),Error(ke(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function rg(e){var t=e._init;return t(e._payload)}function A1(e){function t(x,v){if(e){var w=x.deletions;w===null?(x.deletions=[v],x.flags|=16):w.push(v)}}function r(x,v){if(!e)return null;for(;v!==null;)t(x,v),v=v.sibling;return null}function n(x,v){for(x=new Map;v!==null;)v.key!==null?x.set(v.key,v):x.set(v.index,v),v=v.sibling;return x}function i(x,v){return x=Mi(x,v),x.index=0,x.sibling=null,x}function s(x,v,w){return x.index=w,e?(w=x.alternate,w!==null?(w=w.index,w<v?(x.flags|=2,v):w):(x.flags|=2,v)):(x.flags|=1048576,v)}function l(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,v,w,_){return v===null||v.tag!==6?(v=Mf(w,x.mode,_),v.return=x,v):(v=i(v,w),v.return=x,v)}function a(x,v,w,_){var b=w.type;return b===oa?d(x,v,w.props.children,_,w.key):v!==null&&(v.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===wi&&rg(b)===v.type)?(_=i(v,w.props),_.ref=oo(x,v,w),_.return=x,_):(_=Bc(w.type,w.key,w.props,null,x.mode,_),_.ref=oo(x,v,w),_.return=x,_)}function c(x,v,w,_){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=Lf(w,x.mode,_),v.return=x,v):(v=i(v,w.children||[]),v.return=x,v)}function d(x,v,w,_,b){return v===null||v.tag!==7?(v=vs(w,x.mode,_,b),v.return=x,v):(v=i(v,w),v.return=x,v)}function f(x,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Mf(""+v,x.mode,w),v.return=x,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Gl:return w=Bc(v.type,v.key,v.props,null,x.mode,w),w.ref=oo(x,null,v),w.return=x,w;case aa:return v=Lf(v,x.mode,w),v.return=x,v;case wi:var _=v._init;return f(x,_(v._payload),w)}if(go(v)||ro(v))return v=vs(v,x.mode,w,null),v.return=x,v;sc(x,v)}return null}function h(x,v,w,_){var b=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return b!==null?null:o(x,v,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Gl:return w.key===b?a(x,v,w,_):null;case aa:return w.key===b?c(x,v,w,_):null;case wi:return b=w._init,h(x,v,b(w._payload),_)}if(go(w)||ro(w))return b!==null?null:d(x,v,w,_,null);sc(x,w)}return null}function u(x,v,w,_,b){if(typeof _=="string"&&_!==""||typeof _=="number")return x=x.get(w)||null,o(v,x,""+_,b);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Gl:return x=x.get(_.key===null?w:_.key)||null,a(v,x,_,b);case aa:return x=x.get(_.key===null?w:_.key)||null,c(v,x,_,b);case wi:var k=_._init;return u(x,v,w,k(_._payload),b)}if(go(_)||ro(_))return x=x.get(w)||null,d(v,x,_,b,null);sc(v,_)}return null}function p(x,v,w,_){for(var b=null,k=null,S=v,O=v=0,F=null;S!==null&&O<w.length;O++){S.index>O?(F=S,S=null):F=S.sibling;var D=h(x,S,w[O],_);if(D===null){S===null&&(S=F);break}e&&S&&D.alternate===null&&t(x,S),v=s(D,v,O),k===null?b=D:k.sibling=D,k=D,S=F}if(O===w.length)return r(x,S),St&&is(x,O),b;if(S===null){for(;O<w.length;O++)S=f(x,w[O],_),S!==null&&(v=s(S,v,O),k===null?b=S:k.sibling=S,k=S);return St&&is(x,O),b}for(S=n(x,S);O<w.length;O++)F=u(S,x,O,w[O],_),F!==null&&(e&&F.alternate!==null&&S.delete(F.key===null?O:F.key),v=s(F,v,O),k===null?b=F:k.sibling=F,k=F);return e&&S.forEach(function(U){return t(x,U)}),St&&is(x,O),b}function m(x,v,w,_){var b=ro(w);if(typeof b!="function")throw Error(ke(150));if(w=b.call(w),w==null)throw Error(ke(151));for(var k=b=null,S=v,O=v=0,F=null,D=w.next();S!==null&&!D.done;O++,D=w.next()){S.index>O?(F=S,S=null):F=S.sibling;var U=h(x,S,D.value,_);if(U===null){S===null&&(S=F);break}e&&S&&U.alternate===null&&t(x,S),v=s(U,v,O),k===null?b=U:k.sibling=U,k=U,S=F}if(D.done)return r(x,S),St&&is(x,O),b;if(S===null){for(;!D.done;O++,D=w.next())D=f(x,D.value,_),D!==null&&(v=s(D,v,O),k===null?b=D:k.sibling=D,k=D);return St&&is(x,O),b}for(S=n(x,S);!D.done;O++,D=w.next())D=u(S,x,O,D.value,_),D!==null&&(e&&D.alternate!==null&&S.delete(D.key===null?O:D.key),v=s(D,v,O),k===null?b=D:k.sibling=D,k=D);return e&&S.forEach(function(M){return t(x,M)}),St&&is(x,O),b}function g(x,v,w,_){if(typeof w=="object"&&w!==null&&w.type===oa&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Gl:e:{for(var b=w.key,k=v;k!==null;){if(k.key===b){if(b=w.type,b===oa){if(k.tag===7){r(x,k.sibling),v=i(k,w.props.children),v.return=x,x=v;break e}}else if(k.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===wi&&rg(b)===k.type){r(x,k.sibling),v=i(k,w.props),v.ref=oo(x,k,w),v.return=x,x=v;break e}r(x,k);break}else t(x,k);k=k.sibling}w.type===oa?(v=vs(w.props.children,x.mode,_,w.key),v.return=x,x=v):(_=Bc(w.type,w.key,w.props,null,x.mode,_),_.ref=oo(x,v,w),_.return=x,x=_)}return l(x);case aa:e:{for(k=w.key;v!==null;){if(v.key===k)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){r(x,v.sibling),v=i(v,w.children||[]),v.return=x,x=v;break e}else{r(x,v);break}else t(x,v);v=v.sibling}v=Lf(w,x.mode,_),v.return=x,x=v}return l(x);case wi:return k=w._init,g(x,v,k(w._payload),_)}if(go(w))return p(x,v,w,_);if(ro(w))return m(x,v,w,_);sc(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(r(x,v.sibling),v=i(v,w),v.return=x,x=v):(r(x,v),v=Mf(w,x.mode,_),v.return=x,x=v),l(x)):r(x,v)}return g}var Ia=A1(!0),O1=A1(!1),tu=Ki(null),ru=null,ga=null,Zd=null;function e0(){Zd=ga=ru=null}function t0(e){var t=tu.current;yt(tu),e._currentValue=t}function Uh(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ka(e,t){ru=e,Zd=ga=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Dr=!0),e.firstContext=null)}function hn(e){var t=e._currentValue;if(Zd!==e)if(e={context:e,memoizedValue:t,next:null},ga===null){if(ru===null)throw Error(ke(308));ga=e,ru.dependencies={lanes:0,firstContext:e}}else ga=ga.next=e;return t}var hs=null;function r0(e){hs===null?hs=[e]:hs.push(e)}function F1(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,r0(t)):(r.next=i.next,i.next=r),t.interleaved=r,oi(e,n)}function oi(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var _i=!1;function n0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function j1(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Zn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Di(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,nt&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,oi(e,r)}return i=n.interleaved,i===null?(t.next=t,r0(n)):(t.next=i.next,i.next=t),n.interleaved=t,oi(e,r)}function Pc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,zd(e,r)}}function ng(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=l:s=s.next=l,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function nu(e,t,r,n){var i=e.updateQueue;_i=!1;var s=i.firstBaseUpdate,l=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var a=o,c=a.next;a.next=null,l===null?s=c:l.next=c,l=a;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==l&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=a))}if(s!==null){var f=i.baseState;l=0,d=c=a=null,o=s;do{var h=o.lane,u=o.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:u,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,m=o;switch(h=t,u=r,m.tag){case 1:if(p=m.payload,typeof p=="function"){f=p.call(u,f,h);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(u,f,h):p,h==null)break e;f=Ft({},f,h);break e;case 2:_i=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else u={eventTime:u,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=u,a=f):d=d.next=u,l|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(d===null&&(a=f),i.baseState=a,i.firstBaseUpdate=c,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do l|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Es|=l,e.lanes=l,e.memoizedState=f}}function ig(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(ke(191,i));i.call(n)}}}var jl={},zn=Ki(jl),Qo=Ki(jl),Zo=Ki(jl);function ds(e){if(e===jl)throw Error(ke(174));return e}function i0(e,t){switch(mt(Zo,t),mt(Qo,e),mt(zn,jl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:wh(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=wh(t,e)}yt(zn),mt(zn,t)}function Ma(){yt(zn),yt(Qo),yt(Zo)}function P1(e){ds(Zo.current);var t=ds(zn.current),r=wh(t,e.type);t!==r&&(mt(Qo,e),mt(zn,r))}function s0(e){Qo.current===e&&(yt(zn),yt(Qo))}var Tt=Ki(0);function iu(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ff=[];function a0(){for(var e=0;e<Ff.length;e++)Ff[e]._workInProgressVersionPrimary=null;Ff.length=0}var Dc=fi.ReactCurrentDispatcher,jf=fi.ReactCurrentBatchConfig,Ts=0,Ot=null,Gt=null,Zt=null,su=!1,Eo=!1,el=0,Eb=0;function dr(){throw Error(ke(321))}function o0(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!On(e[r],t[r]))return!1;return!0}function l0(e,t,r,n,i,s){if(Ts=s,Ot=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Dc.current=e===null||e.memoizedState===null?Fb:jb,e=r(n,i),Eo){s=0;do{if(Eo=!1,el=0,25<=s)throw Error(ke(301));s+=1,Zt=Gt=null,t.updateQueue=null,Dc.current=Pb,e=r(n,i)}while(Eo)}if(Dc.current=au,t=Gt!==null&&Gt.next!==null,Ts=0,Zt=Gt=Ot=null,su=!1,t)throw Error(ke(300));return e}function c0(){var e=el!==0;return el=0,e}function In(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zt===null?Ot.memoizedState=Zt=e:Zt=Zt.next=e,Zt}function dn(){if(Gt===null){var e=Ot.alternate;e=e!==null?e.memoizedState:null}else e=Gt.next;var t=Zt===null?Ot.memoizedState:Zt.next;if(t!==null)Zt=t,Gt=e;else{if(e===null)throw Error(ke(310));Gt=e,e={memoizedState:Gt.memoizedState,baseState:Gt.baseState,baseQueue:Gt.baseQueue,queue:Gt.queue,next:null},Zt===null?Ot.memoizedState=Zt=e:Zt=Zt.next=e}return Zt}function tl(e,t){return typeof t=="function"?t(e):t}function Pf(e){var t=dn(),r=t.queue;if(r===null)throw Error(ke(311));r.lastRenderedReducer=e;var n=Gt,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var l=i.next;i.next=s.next,s.next=l}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=l=null,a=null,c=s;do{var d=c.lane;if((Ts&d)===d)a!==null&&(a=a.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var f={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};a===null?(o=a=f,l=n):a=a.next=f,Ot.lanes|=d,Es|=d}c=c.next}while(c!==null&&c!==s);a===null?l=n:a.next=o,On(n,t.memoizedState)||(Dr=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=a,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,Ot.lanes|=s,Es|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Df(e){var t=dn(),r=t.queue;if(r===null)throw Error(ke(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var l=i=i.next;do s=e(s,l.action),l=l.next;while(l!==i);On(s,t.memoizedState)||(Dr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function D1(){}function R1(e,t){var r=Ot,n=dn(),i=t(),s=!On(n.memoizedState,i);if(s&&(n.memoizedState=i,Dr=!0),n=n.queue,u0(L1.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Zt!==null&&Zt.memoizedState.tag&1){if(r.flags|=2048,rl(9,M1.bind(null,r,n,i,t),void 0,null),rr===null)throw Error(ke(349));Ts&30||I1(r,t,i)}return i}function I1(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ot.updateQueue,t===null?(t={lastEffect:null,stores:null},Ot.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function M1(e,t,r,n){t.value=r,t.getSnapshot=n,B1(t)&&U1(e)}function L1(e,t,r){return r(function(){B1(t)&&U1(e)})}function B1(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!On(e,r)}catch{return!0}}function U1(e){var t=oi(e,1);t!==null&&Tn(t,e,1,-1)}function sg(e){var t=In();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:tl,lastRenderedState:e},t.queue=e,e=e.dispatch=Ob.bind(null,Ot,e),[t.memoizedState,e]}function rl(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ot.updateQueue,t===null?(t={lastEffect:null,stores:null},Ot.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function W1(){return dn().memoizedState}function Rc(e,t,r,n){var i=In();Ot.flags|=e,i.memoizedState=rl(1|t,r,void 0,n===void 0?null:n)}function Bu(e,t,r,n){var i=dn();n=n===void 0?null:n;var s=void 0;if(Gt!==null){var l=Gt.memoizedState;if(s=l.destroy,n!==null&&o0(n,l.deps)){i.memoizedState=rl(t,r,s,n);return}}Ot.flags|=e,i.memoizedState=rl(1|t,r,s,n)}function ag(e,t){return Rc(8390656,8,e,t)}function u0(e,t){return Bu(2048,8,e,t)}function z1(e,t){return Bu(4,2,e,t)}function H1(e,t){return Bu(4,4,e,t)}function $1(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function V1(e,t,r){return r=r!=null?r.concat([e]):null,Bu(4,4,$1.bind(null,t,e),r)}function f0(){}function X1(e,t){var r=dn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&o0(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Y1(e,t){var r=dn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&o0(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function G1(e,t,r){return Ts&21?(On(r,t)||(r=Zx(),Ot.lanes|=r,Es|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Dr=!0),e.memoizedState=r)}function Nb(e,t){var r=ht;ht=r!==0&&4>r?r:4,e(!0);var n=jf.transition;jf.transition={};try{e(!1),t()}finally{ht=r,jf.transition=n}}function q1(){return dn().memoizedState}function Ab(e,t,r){var n=Ii(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},K1(e))J1(t,r);else if(r=F1(e,t,r,n),r!==null){var i=Nr();Tn(r,e,n,i),Q1(r,t,n)}}function Ob(e,t,r){var n=Ii(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(K1(e))J1(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var l=t.lastRenderedState,o=s(l,r);if(i.hasEagerState=!0,i.eagerState=o,On(o,l)){var a=t.interleaved;a===null?(i.next=i,r0(t)):(i.next=a.next,a.next=i),t.interleaved=i;return}}catch{}finally{}r=F1(e,t,i,n),r!==null&&(i=Nr(),Tn(r,e,n,i),Q1(r,t,n))}}function K1(e){var t=e.alternate;return e===Ot||t!==null&&t===Ot}function J1(e,t){Eo=su=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Q1(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,zd(e,r)}}var au={readContext:hn,useCallback:dr,useContext:dr,useEffect:dr,useImperativeHandle:dr,useInsertionEffect:dr,useLayoutEffect:dr,useMemo:dr,useReducer:dr,useRef:dr,useState:dr,useDebugValue:dr,useDeferredValue:dr,useTransition:dr,useMutableSource:dr,useSyncExternalStore:dr,useId:dr,unstable_isNewReconciler:!1},Fb={readContext:hn,useCallback:function(e,t){return In().memoizedState=[e,t===void 0?null:t],e},useContext:hn,useEffect:ag,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Rc(4194308,4,$1.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Rc(4194308,4,e,t)},useInsertionEffect:function(e,t){return Rc(4,2,e,t)},useMemo:function(e,t){var r=In();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=In();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Ab.bind(null,Ot,e),[n.memoizedState,e]},useRef:function(e){var t=In();return e={current:e},t.memoizedState=e},useState:sg,useDebugValue:f0,useDeferredValue:function(e){return In().memoizedState=e},useTransition:function(){var e=sg(!1),t=e[0];return e=Nb.bind(null,e[1]),In().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ot,i=In();if(St){if(r===void 0)throw Error(ke(407));r=r()}else{if(r=t(),rr===null)throw Error(ke(349));Ts&30||I1(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,ag(L1.bind(null,n,s,e),[e]),n.flags|=2048,rl(9,M1.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=In(),t=rr.identifierPrefix;if(St){var r=Kn,n=qn;r=(n&~(1<<32-Cn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=el++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Eb++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},jb={readContext:hn,useCallback:X1,useContext:hn,useEffect:u0,useImperativeHandle:V1,useInsertionEffect:z1,useLayoutEffect:H1,useMemo:Y1,useReducer:Pf,useRef:W1,useState:function(){return Pf(tl)},useDebugValue:f0,useDeferredValue:function(e){var t=dn();return G1(t,Gt.memoizedState,e)},useTransition:function(){var e=Pf(tl)[0],t=dn().memoizedState;return[e,t]},useMutableSource:D1,useSyncExternalStore:R1,useId:q1,unstable_isNewReconciler:!1},Pb={readContext:hn,useCallback:X1,useContext:hn,useEffect:u0,useImperativeHandle:V1,useInsertionEffect:z1,useLayoutEffect:H1,useMemo:Y1,useReducer:Df,useRef:W1,useState:function(){return Df(tl)},useDebugValue:f0,useDeferredValue:function(e){var t=dn();return Gt===null?t.memoizedState=e:G1(t,Gt.memoizedState,e)},useTransition:function(){var e=Df(tl)[0],t=dn().memoizedState;return[e,t]},useMutableSource:D1,useSyncExternalStore:R1,useId:q1,unstable_isNewReconciler:!1};function yn(e,t){if(e&&e.defaultProps){t=Ft({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Wh(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ft({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Uu={isMounted:function(e){return(e=e._reactInternals)?Ms(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Nr(),i=Ii(e),s=Zn(n,i);s.payload=t,r!=null&&(s.callback=r),t=Di(e,s,i),t!==null&&(Tn(t,e,i,n),Pc(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Nr(),i=Ii(e),s=Zn(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Di(e,s,i),t!==null&&(Tn(t,e,i,n),Pc(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Nr(),n=Ii(e),i=Zn(r,n);i.tag=2,t!=null&&(i.callback=t),t=Di(e,i,n),t!==null&&(Tn(t,e,n,r),Pc(t,e,n))}};function og(e,t,r,n,i,s,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,l):t.prototype&&t.prototype.isPureReactComponent?!Go(r,n)||!Go(i,s):!0}function Z1(e,t,r){var n=!1,i=zi,s=t.contextType;return typeof s=="object"&&s!==null?s=hn(s):(i=Ir(t)?ks:br.current,n=t.contextTypes,s=(n=n!=null)?Da(e,i):zi),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Uu,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function lg(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Uu.enqueueReplaceState(t,t.state,null)}function zh(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},n0(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=hn(s):(s=Ir(t)?ks:br.current,i.context=Da(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Wh(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Uu.enqueueReplaceState(i,i.state,null),nu(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function La(e,t){try{var r="",n=t;do r+=o2(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Rf(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Hh(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Db=typeof WeakMap=="function"?WeakMap:Map;function ev(e,t,r){r=Zn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){lu||(lu=!0,Zh=n),Hh(e,t)},r}function tv(e,t,r){r=Zn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Hh(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Hh(e,t),typeof n!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function cg(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Db;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=Gb.bind(null,e,t,r),t.then(e,e))}function ug(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function fg(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Zn(-1,1),t.tag=2,Di(r,t,1))),r.lanes|=1),e)}var Rb=fi.ReactCurrentOwner,Dr=!1;function Cr(e,t,r,n){t.child=e===null?O1(t,null,r,n):Ia(t,e.child,r,n)}function hg(e,t,r,n,i){r=r.render;var s=t.ref;return ka(t,i),n=l0(e,t,r,n,s,i),r=c0(),e!==null&&!Dr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,li(e,t,i)):(St&&r&&Kd(t),t.flags|=1,Cr(e,t,n,i),t.child)}function dg(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!y0(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,rv(e,t,s,n,i)):(e=Bc(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var l=s.memoizedProps;if(r=r.compare,r=r!==null?r:Go,r(l,n)&&e.ref===t.ref)return li(e,t,i)}return t.flags|=1,e=Mi(s,n),e.ref=t.ref,e.return=t,t.child=e}function rv(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(Go(s,n)&&e.ref===t.ref)if(Dr=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(Dr=!0);else return t.lanes=e.lanes,li(e,t,i)}return $h(e,t,r,n,i)}function nv(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},mt(xa,zr),zr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,mt(xa,zr),zr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,mt(xa,zr),zr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,mt(xa,zr),zr|=n;return Cr(e,t,i,r),t.child}function iv(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function $h(e,t,r,n,i){var s=Ir(r)?ks:br.current;return s=Da(t,s),ka(t,i),r=l0(e,t,r,n,s,i),n=c0(),e!==null&&!Dr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,li(e,t,i)):(St&&n&&Kd(t),t.flags|=1,Cr(e,t,r,i),t.child)}function pg(e,t,r,n,i){if(Ir(r)){var s=!0;Qc(t)}else s=!1;if(ka(t,i),t.stateNode===null)Ic(e,t),Z1(t,r,n),zh(t,r,n,i),n=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var a=l.context,c=r.contextType;typeof c=="object"&&c!==null?c=hn(c):(c=Ir(r)?ks:br.current,c=Da(t,c));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof l.getSnapshotBeforeUpdate=="function";f||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||a!==c)&&lg(t,l,n,c),_i=!1;var h=t.memoizedState;l.state=h,nu(t,n,l,i),a=t.memoizedState,o!==n||h!==a||Rr.current||_i?(typeof d=="function"&&(Wh(t,r,d,n),a=t.memoizedState),(o=_i||og(t,r,o,n,h,a,c))?(f||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=a),l.props=n,l.state=a,l.context=c,n=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,j1(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:yn(t.type,o),l.props=c,f=t.pendingProps,h=l.context,a=r.contextType,typeof a=="object"&&a!==null?a=hn(a):(a=Ir(r)?ks:br.current,a=Da(t,a));var u=r.getDerivedStateFromProps;(d=typeof u=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==f||h!==a)&&lg(t,l,n,a),_i=!1,h=t.memoizedState,l.state=h,nu(t,n,l,i);var p=t.memoizedState;o!==f||h!==p||Rr.current||_i?(typeof u=="function"&&(Wh(t,r,u,n),p=t.memoizedState),(c=_i||og(t,r,c,n,h,p,a)||!1)?(d||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,p,a),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,p,a)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),l.props=n,l.state=p,l.context=a,n=c):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Vh(e,t,r,n,s,i)}function Vh(e,t,r,n,i,s){iv(e,t);var l=(t.flags&128)!==0;if(!n&&!l)return i&&Zp(t,r,!1),li(e,t,s);n=t.stateNode,Rb.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&l?(t.child=Ia(t,e.child,null,s),t.child=Ia(t,null,o,s)):Cr(e,t,o,s),t.memoizedState=n.state,i&&Zp(t,r,!0),t.child}function sv(e){var t=e.stateNode;t.pendingContext?Qp(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Qp(e,t.context,!1),i0(e,t.containerInfo)}function gg(e,t,r,n,i){return Ra(),Qd(i),t.flags|=256,Cr(e,t,r,n),t.child}var Xh={dehydrated:null,treeContext:null,retryLane:0};function Yh(e){return{baseLanes:e,cachePool:null,transitions:null}}function av(e,t,r){var n=t.pendingProps,i=Tt.current,s=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),mt(Tt,i&1),e===null)return Bh(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=n.children,e=n.fallback,s?(n=t.mode,s=t.child,l={mode:"hidden",children:l},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=l):s=Hu(l,n,0,null),e=vs(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Yh(r),t.memoizedState=Xh,e):h0(t,l));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return Ib(e,t,l,n,o,i,r);if(s){s=n.fallback,l=t.mode,i=e.child,o=i.sibling;var a={mode:"hidden",children:n.children};return!(l&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=a,t.deletions=null):(n=Mi(i,a),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Mi(o,s):(s=vs(s,l,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,l=e.child.memoizedState,l=l===null?Yh(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~r,t.memoizedState=Xh,n}return s=e.child,e=s.sibling,n=Mi(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function h0(e,t){return t=Hu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ac(e,t,r,n){return n!==null&&Qd(n),Ia(t,e.child,null,r),e=h0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Ib(e,t,r,n,i,s,l){if(r)return t.flags&256?(t.flags&=-257,n=Rf(Error(ke(422))),ac(e,t,l,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=Hu({mode:"visible",children:n.children},i,0,null),s=vs(s,i,l,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Ia(t,e.child,null,l),t.child.memoizedState=Yh(l),t.memoizedState=Xh,s);if(!(t.mode&1))return ac(e,t,l,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(ke(419)),n=Rf(s,n,void 0),ac(e,t,l,n)}if(o=(l&e.childLanes)!==0,Dr||o){if(n=rr,n!==null){switch(l&-l){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|l)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,oi(e,i),Tn(n,e,i,-1))}return v0(),n=Rf(Error(ke(421))),ac(e,t,l,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=qb.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,Yr=Pi(i.nextSibling),Gr=t,St=!0,bn=null,e!==null&&(on[ln++]=qn,on[ln++]=Kn,on[ln++]=Cs,qn=e.id,Kn=e.overflow,Cs=t),t=h0(t,n.children),t.flags|=4096,t)}function mg(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Uh(e.return,t,r)}function If(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function ov(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Cr(e,t,n.children,r),n=Tt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&mg(e,r,t);else if(e.tag===19)mg(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(mt(Tt,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&iu(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),If(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&iu(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}If(t,!0,r,null,s);break;case"together":If(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ic(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function li(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Es|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ke(153));if(t.child!==null){for(e=t.child,r=Mi(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Mi(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Mb(e,t,r){switch(t.tag){case 3:sv(t),Ra();break;case 5:P1(t);break;case 1:Ir(t.type)&&Qc(t);break;case 4:i0(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;mt(tu,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(mt(Tt,Tt.current&1),t.flags|=128,null):r&t.child.childLanes?av(e,t,r):(mt(Tt,Tt.current&1),e=li(e,t,r),e!==null?e.sibling:null);mt(Tt,Tt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return ov(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),mt(Tt,Tt.current),n)break;return null;case 22:case 23:return t.lanes=0,nv(e,t,r)}return li(e,t,r)}var lv,Gh,cv,uv;lv=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Gh=function(){};cv=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,ds(zn.current);var s=null;switch(r){case"input":i=mh(e,i),n=mh(e,n),s=[];break;case"select":i=Ft({},i,{value:void 0}),n=Ft({},n,{value:void 0}),s=[];break;case"textarea":i=yh(e,i),n=yh(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Kc)}_h(r,n);var l;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Wo.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var a=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&a!==o&&(a!=null||o!=null))if(c==="style")if(o){for(l in o)!o.hasOwnProperty(l)||a&&a.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in a)a.hasOwnProperty(l)&&o[l]!==a[l]&&(r||(r={}),r[l]=a[l])}else r||(s||(s=[]),s.push(c,r)),r=a;else c==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,o=o?o.__html:void 0,a!=null&&o!==a&&(s=s||[]).push(c,a)):c==="children"?typeof a!="string"&&typeof a!="number"||(s=s||[]).push(c,""+a):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Wo.hasOwnProperty(c)?(a!=null&&c==="onScroll"&&xt("scroll",e),s||o===a||(s=[])):(s=s||[]).push(c,a))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};uv=function(e,t,r,n){r!==n&&(t.flags|=4)};function lo(e,t){if(!St)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function pr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Lb(e,t,r){var n=t.pendingProps;switch(Jd(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pr(t),null;case 1:return Ir(t.type)&&Jc(),pr(t),null;case 3:return n=t.stateNode,Ma(),yt(Rr),yt(br),a0(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(ic(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,bn!==null&&(rd(bn),bn=null))),Gh(e,t),pr(t),null;case 5:s0(t);var i=ds(Zo.current);if(r=t.type,e!==null&&t.stateNode!=null)cv(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ke(166));return pr(t),null}if(e=ds(zn.current),ic(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Mn]=t,n[Jo]=s,e=(t.mode&1)!==0,r){case"dialog":xt("cancel",n),xt("close",n);break;case"iframe":case"object":case"embed":xt("load",n);break;case"video":case"audio":for(i=0;i<xo.length;i++)xt(xo[i],n);break;case"source":xt("error",n);break;case"img":case"image":case"link":xt("error",n),xt("load",n);break;case"details":xt("toggle",n);break;case"input":Cp(n,s),xt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},xt("invalid",n);break;case"textarea":Ep(n,s),xt("invalid",n)}_h(r,s),i=null;for(var l in s)if(s.hasOwnProperty(l)){var o=s[l];l==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&nc(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&nc(n.textContent,o,e),i=["children",""+o]):Wo.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&xt("scroll",n)}switch(r){case"input":ql(n),Tp(n,s,!0);break;case"textarea":ql(n),Np(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Kc)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{l=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Lx(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),r==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[Mn]=t,e[Jo]=n,lv(e,t,!1,!1),t.stateNode=e;e:{switch(l=bh(r,n),r){case"dialog":xt("cancel",e),xt("close",e),i=n;break;case"iframe":case"object":case"embed":xt("load",e),i=n;break;case"video":case"audio":for(i=0;i<xo.length;i++)xt(xo[i],e);i=n;break;case"source":xt("error",e),i=n;break;case"img":case"image":case"link":xt("error",e),xt("load",e),i=n;break;case"details":xt("toggle",e),i=n;break;case"input":Cp(e,n),i=mh(e,n),xt("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Ft({},n,{value:void 0}),xt("invalid",e);break;case"textarea":Ep(e,n),i=yh(e,n),xt("invalid",e);break;default:i=n}_h(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="style"?Wx(e,a):s==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&Bx(e,a)):s==="children"?typeof a=="string"?(r!=="textarea"||a!=="")&&zo(e,a):typeof a=="number"&&zo(e,""+a):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Wo.hasOwnProperty(s)?a!=null&&s==="onScroll"&&xt("scroll",e):a!=null&&Id(e,s,a,l))}switch(r){case"input":ql(e),Tp(e,n,!1);break;case"textarea":ql(e),Np(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Wi(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?wa(e,!!n.multiple,s,!1):n.defaultValue!=null&&wa(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Kc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return pr(t),null;case 6:if(e&&t.stateNode!=null)uv(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ke(166));if(r=ds(Zo.current),ds(zn.current),ic(t)){if(n=t.stateNode,r=t.memoizedProps,n[Mn]=t,(s=n.nodeValue!==r)&&(e=Gr,e!==null))switch(e.tag){case 3:nc(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&nc(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Mn]=t,t.stateNode=n}return pr(t),null;case 13:if(yt(Tt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(St&&Yr!==null&&t.mode&1&&!(t.flags&128))N1(),Ra(),t.flags|=98560,s=!1;else if(s=ic(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(ke(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ke(317));s[Mn]=t}else Ra(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;pr(t),s=!1}else bn!==null&&(rd(bn),bn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Tt.current&1?Kt===0&&(Kt=3):v0())),t.updateQueue!==null&&(t.flags|=4),pr(t),null);case 4:return Ma(),Gh(e,t),e===null&&qo(t.stateNode.containerInfo),pr(t),null;case 10:return t0(t.type._context),pr(t),null;case 17:return Ir(t.type)&&Jc(),pr(t),null;case 19:if(yt(Tt),s=t.memoizedState,s===null)return pr(t),null;if(n=(t.flags&128)!==0,l=s.rendering,l===null)if(n)lo(s,!1);else{if(Kt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=iu(e),l!==null){for(t.flags|=128,lo(s,!1),n=l.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,l=s.alternate,l===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return mt(Tt,Tt.current&1|2),t.child}e=e.sibling}s.tail!==null&&Lt()>Ba&&(t.flags|=128,n=!0,lo(s,!1),t.lanes=4194304)}else{if(!n)if(e=iu(l),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),lo(s,!0),s.tail===null&&s.tailMode==="hidden"&&!l.alternate&&!St)return pr(t),null}else 2*Lt()-s.renderingStartTime>Ba&&r!==1073741824&&(t.flags|=128,n=!0,lo(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(r=s.last,r!==null?r.sibling=l:t.child=l,s.last=l)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Lt(),t.sibling=null,r=Tt.current,mt(Tt,n?r&1|2:r&1),t):(pr(t),null);case 22:case 23:return x0(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?zr&1073741824&&(pr(t),t.subtreeFlags&6&&(t.flags|=8192)):pr(t),null;case 24:return null;case 25:return null}throw Error(ke(156,t.tag))}function Bb(e,t){switch(Jd(t),t.tag){case 1:return Ir(t.type)&&Jc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ma(),yt(Rr),yt(br),a0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return s0(t),null;case 13:if(yt(Tt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ke(340));Ra()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return yt(Tt),null;case 4:return Ma(),null;case 10:return t0(t.type._context),null;case 22:case 23:return x0(),null;case 24:return null;default:return null}}var oc=!1,vr=!1,Ub=typeof WeakSet=="function"?WeakSet:Set,Pe=null;function ma(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Pt(e,t,n)}else r.current=null}function qh(e,t,r){try{r()}catch(n){Pt(e,t,n)}}var xg=!1;function Wb(e,t){if(jh=Yc,e=g1(),qd(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var l=0,o=-1,a=-1,c=0,d=0,f=e,h=null;t:for(;;){for(var u;f!==r||i!==0&&f.nodeType!==3||(o=l+i),f!==s||n!==0&&f.nodeType!==3||(a=l+n),f.nodeType===3&&(l+=f.nodeValue.length),(u=f.firstChild)!==null;)h=f,f=u;for(;;){if(f===e)break t;if(h===r&&++c===i&&(o=l),h===s&&++d===n&&(a=l),(u=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=u}r=o===-1||a===-1?null:{start:o,end:a}}else r=null}r=r||{start:0,end:0}}else r=null;for(Ph={focusedElem:e,selectionRange:r},Yc=!1,Pe=t;Pe!==null;)if(t=Pe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Pe=e;else for(;Pe!==null;){t=Pe;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,x=t.stateNode,v=x.getSnapshotBeforeUpdate(t.elementType===t.type?m:yn(t.type,m),g);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ke(163))}}catch(_){Pt(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,Pe=e;break}Pe=t.return}return p=xg,xg=!1,p}function No(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&qh(t,r,s)}i=i.next}while(i!==n)}}function Wu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Kh(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function fv(e){var t=e.alternate;t!==null&&(e.alternate=null,fv(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Mn],delete t[Jo],delete t[Ih],delete t[Sb],delete t[kb])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function hv(e){return e.tag===5||e.tag===3||e.tag===4}function vg(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||hv(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Jh(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Kc));else if(n!==4&&(e=e.child,e!==null))for(Jh(e,t,r),e=e.sibling;e!==null;)Jh(e,t,r),e=e.sibling}function Qh(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Qh(e,t,r),e=e.sibling;e!==null;)Qh(e,t,r),e=e.sibling}var ar=null,wn=!1;function xi(e,t,r){for(r=r.child;r!==null;)dv(e,t,r),r=r.sibling}function dv(e,t,r){if(Wn&&typeof Wn.onCommitFiberUnmount=="function")try{Wn.onCommitFiberUnmount(Pu,r)}catch{}switch(r.tag){case 5:vr||ma(r,t);case 6:var n=ar,i=wn;ar=null,xi(e,t,r),ar=n,wn=i,ar!==null&&(wn?(e=ar,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ar.removeChild(r.stateNode));break;case 18:ar!==null&&(wn?(e=ar,r=r.stateNode,e.nodeType===8?Af(e.parentNode,r):e.nodeType===1&&Af(e,r),Xo(e)):Af(ar,r.stateNode));break;case 4:n=ar,i=wn,ar=r.stateNode.containerInfo,wn=!0,xi(e,t,r),ar=n,wn=i;break;case 0:case 11:case 14:case 15:if(!vr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,l=s.destroy;s=s.tag,l!==void 0&&(s&2||s&4)&&qh(r,t,l),i=i.next}while(i!==n)}xi(e,t,r);break;case 1:if(!vr&&(ma(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Pt(r,t,o)}xi(e,t,r);break;case 21:xi(e,t,r);break;case 22:r.mode&1?(vr=(n=vr)||r.memoizedState!==null,xi(e,t,r),vr=n):xi(e,t,r);break;default:xi(e,t,r)}}function yg(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Ub),t.forEach(function(n){var i=Kb.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function mn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:ar=o.stateNode,wn=!1;break e;case 3:ar=o.stateNode.containerInfo,wn=!0;break e;case 4:ar=o.stateNode.containerInfo,wn=!0;break e}o=o.return}if(ar===null)throw Error(ke(160));dv(s,l,i),ar=null,wn=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(c){Pt(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)pv(t,e),t=t.sibling}function pv(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mn(t,e),jn(e),n&4){try{No(3,e,e.return),Wu(3,e)}catch(m){Pt(e,e.return,m)}try{No(5,e,e.return)}catch(m){Pt(e,e.return,m)}}break;case 1:mn(t,e),jn(e),n&512&&r!==null&&ma(r,r.return);break;case 5:if(mn(t,e),jn(e),n&512&&r!==null&&ma(r,r.return),e.flags&32){var i=e.stateNode;try{zo(i,"")}catch(m){Pt(e,e.return,m)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,l=r!==null?r.memoizedProps:s,o=e.type,a=e.updateQueue;if(e.updateQueue=null,a!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Ix(i,s),bh(o,l);var c=bh(o,s);for(l=0;l<a.length;l+=2){var d=a[l],f=a[l+1];d==="style"?Wx(i,f):d==="dangerouslySetInnerHTML"?Bx(i,f):d==="children"?zo(i,f):Id(i,d,f,c)}switch(o){case"input":xh(i,s);break;case"textarea":Mx(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var u=s.value;u!=null?wa(i,!!s.multiple,u,!1):h!==!!s.multiple&&(s.defaultValue!=null?wa(i,!!s.multiple,s.defaultValue,!0):wa(i,!!s.multiple,s.multiple?[]:"",!1))}i[Jo]=s}catch(m){Pt(e,e.return,m)}}break;case 6:if(mn(t,e),jn(e),n&4){if(e.stateNode===null)throw Error(ke(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(m){Pt(e,e.return,m)}}break;case 3:if(mn(t,e),jn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Xo(t.containerInfo)}catch(m){Pt(e,e.return,m)}break;case 4:mn(t,e),jn(e);break;case 13:mn(t,e),jn(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(g0=Lt())),n&4&&yg(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(vr=(c=vr)||d,mn(t,e),vr=c):mn(t,e),jn(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!d&&e.mode&1)for(Pe=e,d=e.child;d!==null;){for(f=Pe=d;Pe!==null;){switch(h=Pe,u=h.child,h.tag){case 0:case 11:case 14:case 15:No(4,h,h.return);break;case 1:ma(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){Pt(n,r,m)}}break;case 5:ma(h,h.return);break;case 22:if(h.memoizedState!==null){_g(f);continue}}u!==null?(u.return=h,Pe=u):_g(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=f.stateNode,a=f.memoizedProps.style,l=a!=null&&a.hasOwnProperty("display")?a.display:null,o.style.display=Ux("display",l))}catch(m){Pt(e,e.return,m)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(m){Pt(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:mn(t,e),jn(e),n&4&&yg(e);break;case 21:break;default:mn(t,e),jn(e)}}function jn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(hv(r)){var n=r;break e}r=r.return}throw Error(ke(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(zo(i,""),n.flags&=-33);var s=vg(e);Qh(e,s,i);break;case 3:case 4:var l=n.stateNode.containerInfo,o=vg(e);Jh(e,o,l);break;default:throw Error(ke(161))}}catch(a){Pt(e,e.return,a)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function zb(e,t,r){Pe=e,gv(e)}function gv(e,t,r){for(var n=(e.mode&1)!==0;Pe!==null;){var i=Pe,s=i.child;if(i.tag===22&&n){var l=i.memoizedState!==null||oc;if(!l){var o=i.alternate,a=o!==null&&o.memoizedState!==null||vr;o=oc;var c=vr;if(oc=l,(vr=a)&&!c)for(Pe=i;Pe!==null;)l=Pe,a=l.child,l.tag===22&&l.memoizedState!==null?bg(i):a!==null?(a.return=l,Pe=a):bg(i);for(;s!==null;)Pe=s,gv(s),s=s.sibling;Pe=i,oc=o,vr=c}wg(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Pe=s):wg(e)}}function wg(e){for(;Pe!==null;){var t=Pe;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:vr||Wu(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!vr)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:yn(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&ig(t,s,n);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}ig(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var a=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&r.focus();break;case"img":a.src&&(r.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Xo(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ke(163))}vr||t.flags&512&&Kh(t)}catch(h){Pt(t,t.return,h)}}if(t===e){Pe=null;break}if(r=t.sibling,r!==null){r.return=t.return,Pe=r;break}Pe=t.return}}function _g(e){for(;Pe!==null;){var t=Pe;if(t===e){Pe=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Pe=r;break}Pe=t.return}}function bg(e){for(;Pe!==null;){var t=Pe;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Wu(4,t)}catch(a){Pt(t,r,a)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(a){Pt(t,i,a)}}var s=t.return;try{Kh(t)}catch(a){Pt(t,s,a)}break;case 5:var l=t.return;try{Kh(t)}catch(a){Pt(t,l,a)}}}catch(a){Pt(t,t.return,a)}if(t===e){Pe=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Pe=o;break}Pe=t.return}}var Hb=Math.ceil,ou=fi.ReactCurrentDispatcher,d0=fi.ReactCurrentOwner,un=fi.ReactCurrentBatchConfig,nt=0,rr=null,Vt=null,ur=0,zr=0,xa=Ki(0),Kt=0,nl=null,Es=0,zu=0,p0=0,Ao=null,Pr=null,g0=0,Ba=1/0,Xn=null,lu=!1,Zh=null,Ri=null,lc=!1,Ei=null,cu=0,Oo=0,ed=null,Mc=-1,Lc=0;function Nr(){return nt&6?Lt():Mc!==-1?Mc:Mc=Lt()}function Ii(e){return e.mode&1?nt&2&&ur!==0?ur&-ur:Tb.transition!==null?(Lc===0&&(Lc=Zx()),Lc):(e=ht,e!==0||(e=window.event,e=e===void 0?16:a1(e.type)),e):1}function Tn(e,t,r,n){if(50<Oo)throw Oo=0,ed=null,Error(ke(185));Al(e,r,n),(!(nt&2)||e!==rr)&&(e===rr&&(!(nt&2)&&(zu|=r),Kt===4&&ki(e,ur)),Mr(e,n),r===1&&nt===0&&!(t.mode&1)&&(Ba=Lt()+500,Lu&&Ji()))}function Mr(e,t){var r=e.callbackNode;T2(e,t);var n=Xc(e,e===rr?ur:0);if(n===0)r!==null&&Fp(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Fp(r),t===1)e.tag===0?Cb(Sg.bind(null,e)):C1(Sg.bind(null,e)),_b(function(){!(nt&6)&&Ji()}),r=null;else{switch(e1(n)){case 1:r=Wd;break;case 4:r=Jx;break;case 16:r=Vc;break;case 536870912:r=Qx;break;default:r=Vc}r=Sv(r,mv.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function mv(e,t){if(Mc=-1,Lc=0,nt&6)throw Error(ke(327));var r=e.callbackNode;if(Ca()&&e.callbackNode!==r)return null;var n=Xc(e,e===rr?ur:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=uu(e,n);else{t=n;var i=nt;nt|=2;var s=vv();(rr!==e||ur!==t)&&(Xn=null,Ba=Lt()+500,xs(e,t));do try{Xb();break}catch(o){xv(e,o)}while(!0);e0(),ou.current=s,nt=i,Vt!==null?t=0:(rr=null,ur=0,t=Kt)}if(t!==0){if(t===2&&(i=Eh(e),i!==0&&(n=i,t=td(e,i))),t===1)throw r=nl,xs(e,0),ki(e,n),Mr(e,Lt()),r;if(t===6)ki(e,n);else{if(i=e.current.alternate,!(n&30)&&!$b(i)&&(t=uu(e,n),t===2&&(s=Eh(e),s!==0&&(n=s,t=td(e,s))),t===1))throw r=nl,xs(e,0),ki(e,n),Mr(e,Lt()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(ke(345));case 2:ss(e,Pr,Xn);break;case 3:if(ki(e,n),(n&130023424)===n&&(t=g0+500-Lt(),10<t)){if(Xc(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Nr(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Rh(ss.bind(null,e,Pr,Xn),t);break}ss(e,Pr,Xn);break;case 4:if(ki(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var l=31-Cn(n);s=1<<l,l=t[l],l>i&&(i=l),n&=~s}if(n=i,n=Lt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Hb(n/1960))-n,10<n){e.timeoutHandle=Rh(ss.bind(null,e,Pr,Xn),n);break}ss(e,Pr,Xn);break;case 5:ss(e,Pr,Xn);break;default:throw Error(ke(329))}}}return Mr(e,Lt()),e.callbackNode===r?mv.bind(null,e):null}function td(e,t){var r=Ao;return e.current.memoizedState.isDehydrated&&(xs(e,t).flags|=256),e=uu(e,t),e!==2&&(t=Pr,Pr=r,t!==null&&rd(t)),e}function rd(e){Pr===null?Pr=e:Pr.push.apply(Pr,e)}function $b(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!On(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ki(e,t){for(t&=~p0,t&=~zu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Cn(t),n=1<<r;e[r]=-1,t&=~n}}function Sg(e){if(nt&6)throw Error(ke(327));Ca();var t=Xc(e,0);if(!(t&1))return Mr(e,Lt()),null;var r=uu(e,t);if(e.tag!==0&&r===2){var n=Eh(e);n!==0&&(t=n,r=td(e,n))}if(r===1)throw r=nl,xs(e,0),ki(e,t),Mr(e,Lt()),r;if(r===6)throw Error(ke(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ss(e,Pr,Xn),Mr(e,Lt()),null}function m0(e,t){var r=nt;nt|=1;try{return e(t)}finally{nt=r,nt===0&&(Ba=Lt()+500,Lu&&Ji())}}function Ns(e){Ei!==null&&Ei.tag===0&&!(nt&6)&&Ca();var t=nt;nt|=1;var r=un.transition,n=ht;try{if(un.transition=null,ht=1,e)return e()}finally{ht=n,un.transition=r,nt=t,!(nt&6)&&Ji()}}function x0(){zr=xa.current,yt(xa)}function xs(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,wb(r)),Vt!==null)for(r=Vt.return;r!==null;){var n=r;switch(Jd(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Jc();break;case 3:Ma(),yt(Rr),yt(br),a0();break;case 5:s0(n);break;case 4:Ma();break;case 13:yt(Tt);break;case 19:yt(Tt);break;case 10:t0(n.type._context);break;case 22:case 23:x0()}r=r.return}if(rr=e,Vt=e=Mi(e.current,null),ur=zr=t,Kt=0,nl=null,p0=zu=Es=0,Pr=Ao=null,hs!==null){for(t=0;t<hs.length;t++)if(r=hs[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var l=s.next;s.next=i,n.next=l}r.pending=n}hs=null}return e}function xv(e,t){do{var r=Vt;try{if(e0(),Dc.current=au,su){for(var n=Ot.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}su=!1}if(Ts=0,Zt=Gt=Ot=null,Eo=!1,el=0,d0.current=null,r===null||r.return===null){Kt=1,nl=t,Vt=null;break}e:{var s=e,l=r.return,o=r,a=t;if(t=ur,o.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var c=a,d=o,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var u=ug(l);if(u!==null){u.flags&=-257,fg(u,l,o,s,t),u.mode&1&&cg(s,c,t),t=u,a=c;var p=t.updateQueue;if(p===null){var m=new Set;m.add(a),t.updateQueue=m}else p.add(a);break e}else{if(!(t&1)){cg(s,c,t),v0();break e}a=Error(ke(426))}}else if(St&&o.mode&1){var g=ug(l);if(g!==null){!(g.flags&65536)&&(g.flags|=256),fg(g,l,o,s,t),Qd(La(a,o));break e}}s=a=La(a,o),Kt!==4&&(Kt=2),Ao===null?Ao=[s]:Ao.push(s),s=l;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var x=ev(s,a,t);ng(s,x);break e;case 1:o=a;var v=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ri===null||!Ri.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var _=tv(s,o,t);ng(s,_);break e}}s=s.return}while(s!==null)}wv(r)}catch(b){t=b,Vt===r&&r!==null&&(Vt=r=r.return);continue}break}while(!0)}function vv(){var e=ou.current;return ou.current=au,e===null?au:e}function v0(){(Kt===0||Kt===3||Kt===2)&&(Kt=4),rr===null||!(Es&268435455)&&!(zu&268435455)||ki(rr,ur)}function uu(e,t){var r=nt;nt|=2;var n=vv();(rr!==e||ur!==t)&&(Xn=null,xs(e,t));do try{Vb();break}catch(i){xv(e,i)}while(!0);if(e0(),nt=r,ou.current=n,Vt!==null)throw Error(ke(261));return rr=null,ur=0,Kt}function Vb(){for(;Vt!==null;)yv(Vt)}function Xb(){for(;Vt!==null&&!x2();)yv(Vt)}function yv(e){var t=bv(e.alternate,e,zr);e.memoizedProps=e.pendingProps,t===null?wv(e):Vt=t,d0.current=null}function wv(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Bb(r,t),r!==null){r.flags&=32767,Vt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Kt=6,Vt=null;return}}else if(r=Lb(r,t,zr),r!==null){Vt=r;return}if(t=t.sibling,t!==null){Vt=t;return}Vt=t=e}while(t!==null);Kt===0&&(Kt=5)}function ss(e,t,r){var n=ht,i=un.transition;try{un.transition=null,ht=1,Yb(e,t,r,n)}finally{un.transition=i,ht=n}return null}function Yb(e,t,r,n){do Ca();while(Ei!==null);if(nt&6)throw Error(ke(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ke(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(E2(e,s),e===rr&&(Vt=rr=null,ur=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||lc||(lc=!0,Sv(Vc,function(){return Ca(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=un.transition,un.transition=null;var l=ht;ht=1;var o=nt;nt|=4,d0.current=null,Wb(e,r),pv(r,e),db(Ph),Yc=!!jh,Ph=jh=null,e.current=r,zb(r),v2(),nt=o,ht=l,un.transition=s}else e.current=r;if(lc&&(lc=!1,Ei=e,cu=i),s=e.pendingLanes,s===0&&(Ri=null),_2(r.stateNode),Mr(e,Lt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(lu)throw lu=!1,e=Zh,Zh=null,e;return cu&1&&e.tag!==0&&Ca(),s=e.pendingLanes,s&1?e===ed?Oo++:(Oo=0,ed=e):Oo=0,Ji(),null}function Ca(){if(Ei!==null){var e=e1(cu),t=un.transition,r=ht;try{if(un.transition=null,ht=16>e?16:e,Ei===null)var n=!1;else{if(e=Ei,Ei=null,cu=0,nt&6)throw Error(ke(331));var i=nt;for(nt|=4,Pe=e.current;Pe!==null;){var s=Pe,l=s.child;if(Pe.flags&16){var o=s.deletions;if(o!==null){for(var a=0;a<o.length;a++){var c=o[a];for(Pe=c;Pe!==null;){var d=Pe;switch(d.tag){case 0:case 11:case 15:No(8,d,s)}var f=d.child;if(f!==null)f.return=d,Pe=f;else for(;Pe!==null;){d=Pe;var h=d.sibling,u=d.return;if(fv(d),d===c){Pe=null;break}if(h!==null){h.return=u,Pe=h;break}Pe=u}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}Pe=s}}if(s.subtreeFlags&2064&&l!==null)l.return=s,Pe=l;else e:for(;Pe!==null;){if(s=Pe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:No(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,Pe=x;break e}Pe=s.return}}var v=e.current;for(Pe=v;Pe!==null;){l=Pe;var w=l.child;if(l.subtreeFlags&2064&&w!==null)w.return=l,Pe=w;else e:for(l=v;Pe!==null;){if(o=Pe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Wu(9,o)}}catch(b){Pt(o,o.return,b)}if(o===l){Pe=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,Pe=_;break e}Pe=o.return}}if(nt=i,Ji(),Wn&&typeof Wn.onPostCommitFiberRoot=="function")try{Wn.onPostCommitFiberRoot(Pu,e)}catch{}n=!0}return n}finally{ht=r,un.transition=t}}return!1}function kg(e,t,r){t=La(r,t),t=ev(e,t,1),e=Di(e,t,1),t=Nr(),e!==null&&(Al(e,1,t),Mr(e,t))}function Pt(e,t,r){if(e.tag===3)kg(e,e,r);else for(;t!==null;){if(t.tag===3){kg(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ri===null||!Ri.has(n))){e=La(r,e),e=tv(t,e,1),t=Di(t,e,1),e=Nr(),t!==null&&(Al(t,1,e),Mr(t,e));break}}t=t.return}}function Gb(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Nr(),e.pingedLanes|=e.suspendedLanes&r,rr===e&&(ur&r)===r&&(Kt===4||Kt===3&&(ur&130023424)===ur&&500>Lt()-g0?xs(e,0):p0|=r),Mr(e,t)}function _v(e,t){t===0&&(e.mode&1?(t=Ql,Ql<<=1,!(Ql&130023424)&&(Ql=4194304)):t=1);var r=Nr();e=oi(e,t),e!==null&&(Al(e,t,r),Mr(e,r))}function qb(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),_v(e,r)}function Kb(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ke(314))}n!==null&&n.delete(t),_v(e,r)}var bv;bv=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Rr.current)Dr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Dr=!1,Mb(e,t,r);Dr=!!(e.flags&131072)}else Dr=!1,St&&t.flags&1048576&&T1(t,eu,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Ic(e,t),e=t.pendingProps;var i=Da(t,br.current);ka(t,r),i=l0(null,t,n,e,i,r);var s=c0();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ir(n)?(s=!0,Qc(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,n0(t),i.updater=Uu,t.stateNode=i,i._reactInternals=t,zh(t,n,e,r),t=Vh(null,t,n,!0,s,r)):(t.tag=0,St&&s&&Kd(t),Cr(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Ic(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=Qb(n),e=yn(n,e),i){case 0:t=$h(null,t,n,e,r);break e;case 1:t=pg(null,t,n,e,r);break e;case 11:t=hg(null,t,n,e,r);break e;case 14:t=dg(null,t,n,yn(n.type,e),r);break e}throw Error(ke(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:yn(n,i),$h(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:yn(n,i),pg(e,t,n,i,r);case 3:e:{if(sv(t),e===null)throw Error(ke(387));n=t.pendingProps,s=t.memoizedState,i=s.element,j1(e,t),nu(t,n,null,r);var l=t.memoizedState;if(n=l.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=La(Error(ke(423)),t),t=gg(e,t,n,r,i);break e}else if(n!==i){i=La(Error(ke(424)),t),t=gg(e,t,n,r,i);break e}else for(Yr=Pi(t.stateNode.containerInfo.firstChild),Gr=t,St=!0,bn=null,r=O1(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ra(),n===i){t=li(e,t,r);break e}Cr(e,t,n,r)}t=t.child}return t;case 5:return P1(t),e===null&&Bh(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,l=i.children,Dh(n,i)?l=null:s!==null&&Dh(n,s)&&(t.flags|=32),iv(e,t),Cr(e,t,l,r),t.child;case 6:return e===null&&Bh(t),null;case 13:return av(e,t,r);case 4:return i0(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Ia(t,null,n,r):Cr(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:yn(n,i),hg(e,t,n,i,r);case 7:return Cr(e,t,t.pendingProps,r),t.child;case 8:return Cr(e,t,t.pendingProps.children,r),t.child;case 12:return Cr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,l=i.value,mt(tu,n._currentValue),n._currentValue=l,s!==null)if(On(s.value,l)){if(s.children===i.children&&!Rr.current){t=li(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){l=s.child;for(var a=o.firstContext;a!==null;){if(a.context===n){if(s.tag===1){a=Zn(-1,r&-r),a.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?a.next=a:(a.next=d.next,d.next=a),c.pending=a}}s.lanes|=r,a=s.alternate,a!==null&&(a.lanes|=r),Uh(s.return,r,t),o.lanes|=r;break}a=a.next}}else if(s.tag===10)l=s.type===t.type?null:s.child;else if(s.tag===18){if(l=s.return,l===null)throw Error(ke(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),Uh(l,r,t),l=s.sibling}else l=s.child;if(l!==null)l.return=s;else for(l=s;l!==null;){if(l===t){l=null;break}if(s=l.sibling,s!==null){s.return=l.return,l=s;break}l=l.return}s=l}Cr(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,ka(t,r),i=hn(i),n=n(i),t.flags|=1,Cr(e,t,n,r),t.child;case 14:return n=t.type,i=yn(n,t.pendingProps),i=yn(n.type,i),dg(e,t,n,i,r);case 15:return rv(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:yn(n,i),Ic(e,t),t.tag=1,Ir(n)?(e=!0,Qc(t)):e=!1,ka(t,r),Z1(t,n,i),zh(t,n,i,r),Vh(null,t,n,!0,e,r);case 19:return ov(e,t,r);case 22:return nv(e,t,r)}throw Error(ke(156,t.tag))};function Sv(e,t){return Kx(e,t)}function Jb(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cn(e,t,r,n){return new Jb(e,t,r,n)}function y0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Qb(e){if(typeof e=="function")return y0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ld)return 11;if(e===Bd)return 14}return 2}function Mi(e,t){var r=e.alternate;return r===null?(r=cn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Bc(e,t,r,n,i,s){var l=2;if(n=e,typeof e=="function")y0(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case oa:return vs(r.children,i,s,t);case Md:l=8,i|=8;break;case hh:return e=cn(12,r,t,i|2),e.elementType=hh,e.lanes=s,e;case dh:return e=cn(13,r,t,i),e.elementType=dh,e.lanes=s,e;case ph:return e=cn(19,r,t,i),e.elementType=ph,e.lanes=s,e;case Px:return Hu(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Fx:l=10;break e;case jx:l=9;break e;case Ld:l=11;break e;case Bd:l=14;break e;case wi:l=16,n=null;break e}throw Error(ke(130,e==null?e:typeof e,""))}return t=cn(l,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function vs(e,t,r,n){return e=cn(7,e,n,t),e.lanes=r,e}function Hu(e,t,r,n){return e=cn(22,e,n,t),e.elementType=Px,e.lanes=r,e.stateNode={isHidden:!1},e}function Mf(e,t,r){return e=cn(6,e,null,t),e.lanes=r,e}function Lf(e,t,r){return t=cn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Zb(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vf(0),this.expirationTimes=vf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vf(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function w0(e,t,r,n,i,s,l,o,a){return e=new Zb(e,t,r,o,a),t===1?(t=1,s===!0&&(t|=8)):t=0,s=cn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},n0(s),e}function eS(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:aa,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function kv(e){if(!e)return zi;e=e._reactInternals;e:{if(Ms(e)!==e||e.tag!==1)throw Error(ke(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ir(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ke(171))}if(e.tag===1){var r=e.type;if(Ir(r))return k1(e,r,t)}return t}function Cv(e,t,r,n,i,s,l,o,a){return e=w0(r,n,!0,e,i,s,l,o,a),e.context=kv(null),r=e.current,n=Nr(),i=Ii(r),s=Zn(n,i),s.callback=t??null,Di(r,s,i),e.current.lanes=i,Al(e,i,n),Mr(e,n),e}function $u(e,t,r,n){var i=t.current,s=Nr(),l=Ii(i);return r=kv(r),t.context===null?t.context=r:t.pendingContext=r,t=Zn(s,l),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Di(i,t,l),e!==null&&(Tn(e,i,l,s),Pc(e,i,l)),l}function fu(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Cg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function _0(e,t){Cg(e,t),(e=e.alternate)&&Cg(e,t)}function tS(){return null}var Tv=typeof reportError=="function"?reportError:function(e){console.error(e)};function b0(e){this._internalRoot=e}Vu.prototype.render=b0.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ke(409));$u(e,t,null,null)};Vu.prototype.unmount=b0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ns(function(){$u(null,e,null,null)}),t[ai]=null}};function Vu(e){this._internalRoot=e}Vu.prototype.unstable_scheduleHydration=function(e){if(e){var t=n1();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Si.length&&t!==0&&t<Si[r].priority;r++);Si.splice(r,0,e),r===0&&s1(e)}};function S0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Xu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Tg(){}function rS(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=fu(l);s.call(c)}}var l=Cv(t,n,e,0,null,!1,!1,"",Tg);return e._reactRootContainer=l,e[ai]=l.current,qo(e.nodeType===8?e.parentNode:e),Ns(),l}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=fu(a);o.call(c)}}var a=w0(e,0,!1,null,null,!1,!1,"",Tg);return e._reactRootContainer=a,e[ai]=a.current,qo(e.nodeType===8?e.parentNode:e),Ns(function(){$u(t,a,r,n)}),a}function Yu(e,t,r,n,i){var s=r._reactRootContainer;if(s){var l=s;if(typeof i=="function"){var o=i;i=function(){var a=fu(l);o.call(a)}}$u(t,l,e,i)}else l=rS(r,t,e,i,n);return fu(l)}t1=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=mo(t.pendingLanes);r!==0&&(zd(t,r|1),Mr(t,Lt()),!(nt&6)&&(Ba=Lt()+500,Ji()))}break;case 13:Ns(function(){var n=oi(e,1);if(n!==null){var i=Nr();Tn(n,e,1,i)}}),_0(e,1)}};Hd=function(e){if(e.tag===13){var t=oi(e,134217728);if(t!==null){var r=Nr();Tn(t,e,134217728,r)}_0(e,134217728)}};r1=function(e){if(e.tag===13){var t=Ii(e),r=oi(e,t);if(r!==null){var n=Nr();Tn(r,e,t,n)}_0(e,t)}};n1=function(){return ht};i1=function(e,t){var r=ht;try{return ht=e,t()}finally{ht=r}};kh=function(e,t,r){switch(t){case"input":if(xh(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Mu(n);if(!i)throw Error(ke(90));Rx(n),xh(n,i)}}}break;case"textarea":Mx(e,r);break;case"select":t=r.value,t!=null&&wa(e,!!r.multiple,t,!1)}};$x=m0;Vx=Ns;var nS={usingClientEntryPoint:!1,Events:[Fl,fa,Mu,zx,Hx,m0]},co={findFiberByHostInstance:fs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iS={bundleType:co.bundleType,version:co.version,rendererPackageName:co.rendererPackageName,rendererConfig:co.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fi.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Gx(e),e===null?null:e.stateNode},findFiberByHostInstance:co.findFiberByHostInstance||tS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cc.isDisabled&&cc.supportsFiber)try{Pu=cc.inject(iS),Wn=cc}catch{}}Qr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nS;Qr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!S0(t))throw Error(ke(200));return eS(e,t,null,r)};Qr.createRoot=function(e,t){if(!S0(e))throw Error(ke(299));var r=!1,n="",i=Tv;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=w0(e,1,!1,null,null,r,!1,n,i),e[ai]=t.current,qo(e.nodeType===8?e.parentNode:e),new b0(t)};Qr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ke(188)):(e=Object.keys(e).join(","),Error(ke(268,e)));return e=Gx(t),e=e===null?null:e.stateNode,e};Qr.flushSync=function(e){return Ns(e)};Qr.hydrate=function(e,t,r){if(!Xu(t))throw Error(ke(200));return Yu(null,e,t,!0,r)};Qr.hydrateRoot=function(e,t,r){if(!S0(e))throw Error(ke(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",l=Tv;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=Cv(t,null,e,1,r??null,i,!1,s,l),e[ai]=t.current,qo(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Vu(t)};Qr.render=function(e,t,r){if(!Xu(t))throw Error(ke(200));return Yu(null,e,t,!1,r)};Qr.unmountComponentAtNode=function(e){if(!Xu(e))throw Error(ke(40));return e._reactRootContainer?(Ns(function(){Yu(null,null,e,!1,function(){e._reactRootContainer=null,e[ai]=null})}),!0):!1};Qr.unstable_batchedUpdates=m0;Qr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Xu(r))throw Error(ke(200));if(e==null||e._reactInternals===void 0)throw Error(ke(38));return Yu(e,t,r,!1,n)};Qr.version="18.3.1-next-f1338f8080-20240426";function Ev(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ev)}catch(e){console.error(e)}}Ev(),Ex.exports=Qr;var Nv=Ex.exports,Eg=Nv;uh.createRoot=Eg.createRoot,uh.hydrateRoot=Eg.hydrateRoot;/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Av=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sS=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aS=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ng=e=>{const t=aS(e);return t.charAt(0).toUpperCase()+t.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var oS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lS=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cS=le.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:l,...o},a)=>le.createElement("svg",{ref:a,...oS,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:Av("lucide",i),...!s&&!lS(o)&&{"aria-hidden":"true"},...o},[...l.map(([c,d])=>le.createElement(c,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=(e,t)=>{const r=le.forwardRef(({className:n,...i},s)=>le.createElement(cS,{ref:s,iconNode:t,className:Av(`lucide-${sS(Ng(e))}`,`lucide-${e}`,n),...i}));return r.displayName=Ng(e),r};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uS=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],fS=Be("arrow-right",uS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hS=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],Bf=Be("award",hS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dS=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Ov=Be("book-open",dS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pS=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],gS=Be("briefcase",pS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mS=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Hi=Be("calendar",mS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xS=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Ag=Be("chart-column",xS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],En=Be("check",vS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yS=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Og=Be("chevron-down",yS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wS=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],ci=Be("chevron-left",wS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _S=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],qr=Be("chevron-right",_S);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bS=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Fg=Be("chevron-up",bS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ei=Be("circle-alert",SS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ys=Be("circle-check",kS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],TS=Be("circle-plus",CS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ES=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],NS=Be("clipboard-check",ES);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AS=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],$i=Be("clock",AS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OS=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Fv=Be("download",OS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FS=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],jS=Be("ellipsis",FS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],DS=Be("file-down",PS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],IS=Be("file-text",RS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MS=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],LS=Be("graduation-cap",MS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BS=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],US=Be("grid-3x3",BS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WS=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],zS=Be("hash",WS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HS=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],jv=Be("house",HS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $S=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Pv=Be("info",$S);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VS=[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]],XS=Be("layout-template",VS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YS=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Uf=Be("loader-circle",YS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GS=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],qS=Be("lock",GS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KS=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Pl=Be("log-out",KS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JS=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],As=Be("map-pin",JS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QS=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],hu=Be("map",QS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZS=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],ek=Be("menu",ZS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tk=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],rk=Be("navigation",tk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nk=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],ik=Be("palette",nk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sk=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],Ua=Be("panels-top-left",sk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ak=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],k0=Be("pen-tool",ak);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ok=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],lk=Be("pen",ok);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ck=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],nd=Be("phone",ck);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uk=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],il=Be("plus",uk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fk=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],du=Be("printer",fk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hk=[["path",{d:"M20.34 17.52a10 10 0 1 0-2.82 2.82",key:"fydyku"}],["circle",{cx:"19",cy:"19",r:"2",key:"17f5cg"}],["path",{d:"m13.41 13.41 4.18 4.18",key:"1gqbwc"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],dk=Be("radius",hk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pk=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],gk=Be("refresh-cw",pk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mk=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],xk=Be("rotate-cw",mk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vk=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],pu=Be("save",vk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yk=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],wk=Be("school",yk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _k=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],id=Be("search",_k);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bk=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],sd=Be("settings",bk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sk=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],C0=Be("shield-check",Sk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kk=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Ck=Be("square-pen",kk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tk=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Li=Be("trash-2",Tk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ek=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Nk=Be("triangle-alert",Ek);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ak=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Ok=Be("upload",Ak);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fk=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],sl=Be("user",Fk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jk=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Dl=Be("users",jk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pk=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ta=Be("x",Pk);var $e={};const Dk={},Rk=Object.freeze(Object.defineProperty({__proto__:null,default:Dk},Symbol.toStringTag,{value:"Module"})),Wf=P_(Rk);(function(e){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var t=t||{version:"5.5.2"};if(e.fabric=t,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?t.document=document:t.document=document.implementation.createHTMLDocument(""),t.window=window;else{var r=Wf,n=new r.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;t.document=n.document,t.jsdomImplForWrapper=Wf.implForWrapper,t.nodeCanvas=Wf.Canvas,t.window=n,DOMParser=t.window.DOMParser}t.isTouchSupported="ontouchstart"in t.window||"ontouchstart"in t.document||t.window&&t.window.navigator&&t.window.navigator.maxTouchPoints>0,t.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",t.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],t.DPI=96,t.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",t.commaWsp="(?:\\s+,?\\s*|,\\s*)",t.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,t.reNonWord=/[ \n\.,;!\?\-]/,t.fontPaths={},t.iMatrix=[1,0,0,1,0,0],t.svgNS="http://www.w3.org/2000/svg",t.perfLimitSizeTotal=2097152,t.maxCacheSideLimit=4096,t.minCacheSideLimit=256,t.charWidthsCache={},t.textureSize=2048,t.disableStyleCopyPaste=!1,t.enableGLFiltering=!0,t.devicePixelRatio=t.window.devicePixelRatio||t.window.webkitDevicePixelRatio||t.window.mozDevicePixelRatio||1,t.browserShadowBlurConstant=1,t.arcToSegmentsCache={},t.boundsOfCurveCache={},t.cachesBoundsOfCurve=!0,t.forceGLPutImageData=!1,t.initFilterBackend=function(){if(t.enableGLFiltering&&t.isWebglSupported&&t.isWebglSupported(t.textureSize))return console.log("max texture size: "+t.maxTextureSize),new t.WebglFilterBackend({tileSize:t.textureSize});if(t.Canvas2dFilterBackend)return new t.Canvas2dFilterBackend},typeof document<"u"&&typeof window<"u"&&(window.fabric=t),function(){function o(u,p){if(this.__eventListeners[u]){var m=this.__eventListeners[u];p?m[m.indexOf(p)]=!1:t.util.array.fill(m,!1)}}function a(u,p){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var m in u)this.on(m,u[m]);else this.__eventListeners[u]||(this.__eventListeners[u]=[]),this.__eventListeners[u].push(p);return this}function c(u,p){var m=(function(){p.apply(this,arguments),this.off(u,m)}).bind(this);this.on(u,m)}function d(u,p){if(arguments.length===1)for(var m in u)c.call(this,m,u[m]);else c.call(this,u,p);return this}function f(u,p){if(!this.__eventListeners)return this;if(arguments.length===0)for(u in this.__eventListeners)o.call(this,u);else if(arguments.length===1&&typeof arguments[0]=="object")for(var m in u)o.call(this,m,u[m]);else o.call(this,u,p);return this}function h(u,p){if(!this.__eventListeners)return this;var m=this.__eventListeners[u];if(!m)return this;for(var g=0,x=m.length;g<x;g++)m[g]&&m[g].call(this,p||{});return this.__eventListeners[u]=m.filter(function(v){return v!==!1}),this}t.Observable={fire:h,on:a,once:d,off:f}}(),t.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var o=0,a=arguments.length;o<a;o++)this._onObjectAdded(arguments[o]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(o,a,c){var d=this._objects;return c?d[a]=o:d.splice(a,0,o),this._onObjectAdded&&this._onObjectAdded(o),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var o=this._objects,a,c=!1,d=0,f=arguments.length;d<f;d++)a=o.indexOf(arguments[d]),a!==-1&&(c=!0,o.splice(a,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[d]));return this.renderOnAddRemove&&c&&this.requestRenderAll(),this},forEachObject:function(o,a){for(var c=this.getObjects(),d=0,f=c.length;d<f;d++)o.call(a,c[d],d,c);return this},getObjects:function(o){return typeof o>"u"?this._objects.concat():this._objects.filter(function(a){return a.type===o})},item:function(o){return this._objects[o]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(o,a){return this._objects.indexOf(o)>-1?!0:a?this._objects.some(function(c){return typeof c.contains=="function"&&c.contains(o,!0)}):!1},complexity:function(){return this._objects.reduce(function(o,a){return o+=a.complexity?a.complexity():0,o},0)}},t.CommonMethods={_setOptions:function(o){for(var a in o)this.set(a,o[a])},_initGradient:function(o,a){o&&o.colorStops&&!(o instanceof t.Gradient)&&this.set(a,new t.Gradient(o))},_initPattern:function(o,a,c){o&&o.source&&!(o instanceof t.Pattern)?this.set(a,new t.Pattern(o,c)):c&&c()},_setObject:function(o){for(var a in o)this._set(a,o[a])},set:function(o,a){return typeof o=="object"?this._setObject(o):this._set(o,a),this},_set:function(o,a){this[o]=a},toggle:function(o){var a=this.get(o);return typeof a=="boolean"&&this.set(o,!a),this},get:function(o){return this[o]}},function(o){var a=Math.sqrt,c=Math.atan2,d=Math.pow,f=Math.PI/180,h=Math.PI/2;t.util={cos:function(u){if(u===0)return 1;u<0&&(u=-u);var p=u/h;switch(p){case 1:case 3:return 0;case 2:return-1}return Math.cos(u)},sin:function(u){if(u===0)return 0;var p=u/h,m=1;switch(u<0&&(m=-1),p){case 1:return m;case 2:return 0;case 3:return-m}return Math.sin(u)},removeFromArray:function(u,p){var m=u.indexOf(p);return m!==-1&&u.splice(m,1),u},getRandomInt:function(u,p){return Math.floor(Math.random()*(p-u+1))+u},degreesToRadians:function(u){return u*f},radiansToDegrees:function(u){return u/f},rotatePoint:function(u,p,m){var g=new t.Point(u.x-p.x,u.y-p.y),x=t.util.rotateVector(g,m);return new t.Point(x.x,x.y).addEquals(p)},rotateVector:function(u,p){var m=t.util.sin(p),g=t.util.cos(p),x=u.x*g-u.y*m,v=u.x*m+u.y*g;return{x,y:v}},createVector:function(u,p){return new t.Point(p.x-u.x,p.y-u.y)},calcAngleBetweenVectors:function(u,p){return Math.acos((u.x*p.x+u.y*p.y)/(Math.hypot(u.x,u.y)*Math.hypot(p.x,p.y)))},getHatVector:function(u){return new t.Point(u.x,u.y).multiply(1/Math.hypot(u.x,u.y))},getBisector:function(u,p,m){var g=t.util.createVector(u,p),x=t.util.createVector(u,m),v=t.util.calcAngleBetweenVectors(g,x),w=t.util.calcAngleBetweenVectors(t.util.rotateVector(g,v),x),_=v*(w===0?1:-1)/2;return{vector:t.util.getHatVector(t.util.rotateVector(g,_)),angle:v}},projectStrokeOnPoints:function(u,p,m){var g=[],x=p.strokeWidth/2,v=p.strokeUniform?new t.Point(1/p.scaleX,1/p.scaleY):new t.Point(1,1),w=function(_){var b=x/Math.hypot(_.x,_.y);return new t.Point(_.x*b*v.x,_.y*b*v.y)};return u.length<=1||u.forEach(function(_,b){var k=new t.Point(_.x,_.y),S,O;b===0?(O=u[b+1],S=m?w(t.util.createVector(O,k)).addEquals(k):u[u.length-1]):b===u.length-1?(S=u[b-1],O=m?w(t.util.createVector(S,k)).addEquals(k):u[0]):(S=u[b-1],O=u[b+1]);var F=t.util.getBisector(k,S,O),D=F.vector,U=F.angle,M,q;if(p.strokeLineJoin==="miter"&&(M=-x/Math.sin(U/2),q=new t.Point(D.x*M*v.x,D.y*M*v.y),Math.hypot(q.x,q.y)/x<=p.strokeMiterLimit)){g.push(k.add(q)),g.push(k.subtract(q));return}M=-x*Math.SQRT2,q=new t.Point(D.x*M*v.x,D.y*M*v.y),g.push(k.add(q)),g.push(k.subtract(q))}),g},transformPoint:function(u,p,m){return m?new t.Point(p[0]*u.x+p[2]*u.y,p[1]*u.x+p[3]*u.y):new t.Point(p[0]*u.x+p[2]*u.y+p[4],p[1]*u.x+p[3]*u.y+p[5])},makeBoundingBoxFromPoints:function(u,p){if(p)for(var m=0;m<u.length;m++)u[m]=t.util.transformPoint(u[m],p);var g=[u[0].x,u[1].x,u[2].x,u[3].x],x=t.util.array.min(g),v=t.util.array.max(g),w=v-x,_=[u[0].y,u[1].y,u[2].y,u[3].y],b=t.util.array.min(_),k=t.util.array.max(_),S=k-b;return{left:x,top:b,width:w,height:S}},invertTransform:function(u){var p=1/(u[0]*u[3]-u[1]*u[2]),m=[p*u[3],-p*u[1],-p*u[2],p*u[0]],g=t.util.transformPoint({x:u[4],y:u[5]},m,!0);return m[4]=-g.x,m[5]=-g.y,m},toFixed:function(u,p){return parseFloat(Number(u).toFixed(p))},parseUnit:function(u,p){var m=/\D{0,2}$/.exec(u),g=parseFloat(u);switch(p||(p=t.Text.DEFAULT_SVG_FONT_SIZE),m[0]){case"mm":return g*t.DPI/25.4;case"cm":return g*t.DPI/2.54;case"in":return g*t.DPI;case"pt":return g*t.DPI/72;case"pc":return g*t.DPI/72*12;case"em":return g*p;default:return g}},falseFunction:function(){return!1},getKlass:function(u,p){return u=t.util.string.camelize(u.charAt(0).toUpperCase()+u.slice(1)),t.util.resolveNamespace(p)[u]},getSvgAttributes:function(u){var p=["instantiated_by_use","style","id","class"];switch(u){case"linearGradient":p=p.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":p=p.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":p=p.concat(["offset","stop-color","stop-opacity"]);break}return p},resolveNamespace:function(u){if(!u)return t;var p=u.split("."),m=p.length,g,x=o||t.window;for(g=0;g<m;++g)x=x[p[g]];return x},loadImage:function(u,p,m,g){if(!u){p&&p.call(m,u);return}var x=t.util.createImage(),v=function(){p&&p.call(m,x,!1),x=x.onload=x.onerror=null};x.onload=v,x.onerror=function(){t.log("Error loading "+x.src),p&&p.call(m,null,!0),x=x.onload=x.onerror=null},u.indexOf("data")!==0&&g!==void 0&&g!==null&&(x.crossOrigin=g),u.substring(0,14)==="data:image/svg"&&(x.onload=null,t.util.loadImageInDom(x,v)),x.src=u},loadImageInDom:function(u,p){var m=t.document.createElement("div");m.style.width=m.style.height="1px",m.style.left=m.style.top="-100%",m.style.position="absolute",m.appendChild(u),t.document.querySelector("body").appendChild(m),u.onload=function(){p(),m.parentNode.removeChild(m),m=null}},enlivenObjects:function(u,p,m,g){u=u||[];var x=[],v=0,w=u.length;function _(){++v===w&&p&&p(x.filter(function(b){return b}))}if(!w){p&&p(x);return}u.forEach(function(b,k){if(!b||!b.type){_();return}var S=t.util.getKlass(b.type,m);S.fromObject(b,function(O,F){F||(x[k]=O),g&&g(b,O,F),_()})})},enlivenObjectEnlivables:function(u,p,m){var g=t.Object.ENLIVEN_PROPS.filter(function(x){return!!u[x]});t.util.enlivenObjects(g.map(function(x){return u[x]}),function(x){var v={};g.forEach(function(w,_){v[w]=x[_],p&&(p[w]=x[_])}),m&&m(v)})},enlivenPatterns:function(u,p){u=u||[];function m(){++x===v&&p&&p(g)}var g=[],x=0,v=u.length;if(!v){p&&p(g);return}u.forEach(function(w,_){w&&w.source?new t.Pattern(w,function(b){g[_]=b,m()}):(g[_]=w,m())})},groupSVGElements:function(u,p,m){var g;return u&&u.length===1?(typeof m<"u"&&(u[0].sourcePath=m),u[0]):(p&&(p.width&&p.height?p.centerPoint={x:p.width/2,y:p.height/2}:(delete p.width,delete p.height)),g=new t.Group(u,p),typeof m<"u"&&(g.sourcePath=m),g)},populateWithProperties:function(u,p,m){if(m&&Array.isArray(m))for(var g=0,x=m.length;g<x;g++)m[g]in u&&(p[m[g]]=u[m[g]])},createCanvasElement:function(){return t.document.createElement("canvas")},copyCanvasElement:function(u){var p=t.util.createCanvasElement();return p.width=u.width,p.height=u.height,p.getContext("2d").drawImage(u,0,0),p},toDataURL:function(u,p,m){return u.toDataURL("image/"+p,m)},createImage:function(){return t.document.createElement("img")},multiplyTransformMatrices:function(u,p,m){return[u[0]*p[0]+u[2]*p[1],u[1]*p[0]+u[3]*p[1],u[0]*p[2]+u[2]*p[3],u[1]*p[2]+u[3]*p[3],m?0:u[0]*p[4]+u[2]*p[5]+u[4],m?0:u[1]*p[4]+u[3]*p[5]+u[5]]},qrDecompose:function(u){var p=c(u[1],u[0]),m=d(u[0],2)+d(u[1],2),g=a(m),x=(u[0]*u[3]-u[2]*u[1])/g,v=c(u[0]*u[2]+u[1]*u[3],m);return{angle:p/f,scaleX:g,scaleY:x,skewX:v/f,skewY:0,translateX:u[4],translateY:u[5]}},calcRotateMatrix:function(u){if(!u.angle)return t.iMatrix.concat();var p=t.util.degreesToRadians(u.angle),m=t.util.cos(p),g=t.util.sin(p);return[m,g,-g,m,0,0]},calcDimensionsMatrix:function(u){var p=typeof u.scaleX>"u"?1:u.scaleX,m=typeof u.scaleY>"u"?1:u.scaleY,g=[u.flipX?-p:p,0,0,u.flipY?-m:m,0,0],x=t.util.multiplyTransformMatrices,v=t.util.degreesToRadians;return u.skewX&&(g=x(g,[1,0,Math.tan(v(u.skewX)),1],!0)),u.skewY&&(g=x(g,[1,Math.tan(v(u.skewY)),0,1],!0)),g},composeMatrix:function(u){var p=[1,0,0,1,u.translateX||0,u.translateY||0],m=t.util.multiplyTransformMatrices;return u.angle&&(p=m(p,t.util.calcRotateMatrix(u))),(u.scaleX!==1||u.scaleY!==1||u.skewX||u.skewY||u.flipX||u.flipY)&&(p=m(p,t.util.calcDimensionsMatrix(u))),p},resetObjectTransform:function(u){u.scaleX=1,u.scaleY=1,u.skewX=0,u.skewY=0,u.flipX=!1,u.flipY=!1,u.rotate(0)},saveObjectTransform:function(u){return{scaleX:u.scaleX,scaleY:u.scaleY,skewX:u.skewX,skewY:u.skewY,angle:u.angle,left:u.left,flipX:u.flipX,flipY:u.flipY,top:u.top}},isTransparent:function(u,p,m,g){g>0&&(p>g?p-=g:p=0,m>g?m-=g:m=0);var x=!0,v,w,_=u.getImageData(p,m,g*2||1,g*2||1),b=_.data.length;for(v=3;v<b&&(w=_.data[v],x=w<=0,x!==!1);v+=4);return _=null,x},parsePreserveAspectRatioAttribute:function(u){var p="meet",m="Mid",g="Mid",x=u.split(" "),v;return x&&x.length&&(p=x.pop(),p!=="meet"&&p!=="slice"?(v=p,p="meet"):x.length&&(v=x.pop())),m=v!=="none"?v.slice(1,4):"none",g=v!=="none"?v.slice(5,8):"none",{meetOrSlice:p,alignX:m,alignY:g}},clearFabricFontCache:function(u){u=(u||"").toLowerCase(),u?t.charWidthsCache[u]&&delete t.charWidthsCache[u]:t.charWidthsCache={}},limitDimsByArea:function(u,p){var m=Math.sqrt(p*u),g=Math.floor(p/m);return{x:Math.floor(m),y:g}},capValue:function(u,p,m){return Math.max(u,Math.min(p,m))},findScaleToFit:function(u,p){return Math.min(p.width/u.width,p.height/u.height)},findScaleToCover:function(u,p){return Math.max(p.width/u.width,p.height/u.height)},matrixToSVG:function(u){return"matrix("+u.map(function(p){return t.util.toFixed(p,t.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(u,p){var m=t.util.invertTransform(p),g=t.util.multiplyTransformMatrices(m,u.calcOwnMatrix());t.util.applyTransformToObject(u,g)},addTransformToObject:function(u,p){t.util.applyTransformToObject(u,t.util.multiplyTransformMatrices(p,u.calcOwnMatrix()))},applyTransformToObject:function(u,p){var m=t.util.qrDecompose(p),g=new t.Point(m.translateX,m.translateY);u.flipX=!1,u.flipY=!1,u.set("scaleX",m.scaleX),u.set("scaleY",m.scaleY),u.skewX=m.skewX,u.skewY=m.skewY,u.angle=m.angle,u.setPositionByOrigin(g,"center","center")},sizeAfterTransform:function(u,p,m){var g=u/2,x=p/2,v=[{x:-g,y:-x},{x:g,y:-x},{x:-g,y:x},{x:g,y:x}],w=t.util.calcDimensionsMatrix(m),_=t.util.makeBoundingBoxFromPoints(v,w);return{x:_.width,y:_.height}},mergeClipPaths:function(u,p){var m=u,g=p;m.inverted&&!g.inverted&&(m=p,g=u),t.util.applyTransformToObject(g,t.util.multiplyTransformMatrices(t.util.invertTransform(m.calcTransformMatrix()),g.calcTransformMatrix()));var x=m.inverted&&g.inverted;return x&&(m.inverted=g.inverted=!1),new t.Group([m],{clipPath:g,inverted:x})},hasStyleChanged:function(u,p,m){return m=m||!1,u.fill!==p.fill||u.stroke!==p.stroke||u.strokeWidth!==p.strokeWidth||u.fontSize!==p.fontSize||u.fontFamily!==p.fontFamily||u.fontWeight!==p.fontWeight||u.fontStyle!==p.fontStyle||u.textBackgroundColor!==p.textBackgroundColor||u.deltaY!==p.deltaY||m&&(u.overline!==p.overline||u.underline!==p.underline||u.linethrough!==p.linethrough)},stylesToArray:function(m,p){for(var m=t.util.object.clone(m,!0),g=p.split(`
`),x=-1,v={},w=[],_=0;_<g.length;_++){if(!m[_]){x+=g[_].length;continue}for(var b=0;b<g[_].length;b++){x++;var k=m[_][b];if(k&&Object.keys(k).length>0){var S=t.util.hasStyleChanged(v,k,!0);S?w.push({start:x,end:x+1,style:k}):w[w.length-1].end++}v=k||{}}}return w},stylesFromArray:function(u,p){if(!Array.isArray(u))return u;for(var m=p.split(`
`),g=-1,x=0,v={},w=0;w<m.length;w++)for(var _=0;_<m[w].length;_++)g++,u[x]&&u[x].start<=g&&g<u[x].end&&(v[w]=v[w]||{},v[w][_]=Object.assign({},u[x].style),g===u[x].end-1&&x++);return v}}}(e),function(){var o=Array.prototype.join,a={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},c={m:"l",M:"L"};function d(T,j,B,E,R,N,C,P,I,H,L){var z=t.util.cos(T),ee=t.util.sin(T),A=t.util.cos(j),V=t.util.sin(j),W=B*R*A-E*N*V+C,te=E*R*A+B*N*V+P,ae=H+I*(-B*R*ee-E*N*z),Y=L+I*(-E*R*ee+B*N*z),ce=W+I*(B*R*V+E*N*A),ue=te+I*(E*R*V-B*N*A);return["C",ae,Y,ce,ue,W,te]}function f(T,j,B,E,R,N,C){var P=Math.PI,I=C*P/180,H=t.util.sin(I),L=t.util.cos(I),z=0,ee=0;B=Math.abs(B),E=Math.abs(E);var A=-L*T*.5-H*j*.5,V=-L*j*.5+H*T*.5,W=B*B,te=E*E,ae=V*V,Y=A*A,ce=W*te-W*ae-te*Y,ue=0;if(ce<0){var xe=Math.sqrt(1-ce/(W*te));B*=xe,E*=xe}else ue=(R===N?-1:1)*Math.sqrt(ce/(W*ae+te*Y));var _e=ue*B*V/E,fe=-ue*E*A/B,ve=L*_e-H*fe+T*.5,Ce=H*_e+L*fe+j*.5,De=h(1,0,(A-_e)/B,(V-fe)/E),Re=h((A-_e)/B,(V-fe)/E,(-A-_e)/B,(-V-fe)/E);N===0&&Re>0?Re-=2*P:N===1&&Re<0&&(Re+=2*P);for(var Me=Math.ceil(Math.abs(Re/P*2)),Ye=[],tt=Re/Me,Ue=8/3*Math.sin(tt/4)*Math.sin(tt/4)/Math.sin(tt/2),ot=De+tt,pt=0;pt<Me;pt++)Ye[pt]=d(De,ot,L,H,B,E,ve,Ce,Ue,z,ee),z=Ye[pt][5],ee=Ye[pt][6],De=ot,ot+=tt;return Ye}function h(T,j,B,E){var R=Math.atan2(j,T),N=Math.atan2(E,B);return N>=R?N-R:2*Math.PI-(R-N)}function u(T,j,B,E,R,N,C,P){var I;if(t.cachesBoundsOfCurve&&(I=o.call(arguments),t.boundsOfCurveCache[I]))return t.boundsOfCurveCache[I];var H=Math.sqrt,L=Math.min,z=Math.max,ee=Math.abs,A=[],V=[[],[]],W,te,ae,Y,ce,ue,xe,_e;te=6*T-12*B+6*R,W=-3*T+9*B-9*R+3*C,ae=3*B-3*T;for(var fe=0;fe<2;++fe){if(fe>0&&(te=6*j-12*E+6*N,W=-3*j+9*E-9*N+3*P,ae=3*E-3*j),ee(W)<1e-12){if(ee(te)<1e-12)continue;Y=-ae/te,0<Y&&Y<1&&A.push(Y);continue}xe=te*te-4*ae*W,!(xe<0)&&(_e=H(xe),ce=(-te+_e)/(2*W),0<ce&&ce<1&&A.push(ce),ue=(-te-_e)/(2*W),0<ue&&ue<1&&A.push(ue))}for(var ve,Ce,De=A.length,Re=De,Me;De--;)Y=A[De],Me=1-Y,ve=Me*Me*Me*T+3*Me*Me*Y*B+3*Me*Y*Y*R+Y*Y*Y*C,V[0][De]=ve,Ce=Me*Me*Me*j+3*Me*Me*Y*E+3*Me*Y*Y*N+Y*Y*Y*P,V[1][De]=Ce;V[0][Re]=T,V[1][Re]=j,V[0][Re+1]=C,V[1][Re+1]=P;var Ye=[{x:L.apply(null,V[0]),y:L.apply(null,V[1])},{x:z.apply(null,V[0]),y:z.apply(null,V[1])}];return t.cachesBoundsOfCurve&&(t.boundsOfCurveCache[I]=Ye),Ye}function p(T,j,B){for(var E=B[1],R=B[2],N=B[3],C=B[4],P=B[5],I=B[6],H=B[7],L=f(I-T,H-j,E,R,C,P,N),z=0,ee=L.length;z<ee;z++)L[z][1]+=T,L[z][2]+=j,L[z][3]+=T,L[z][4]+=j,L[z][5]+=T,L[z][6]+=j;return L}function m(T){var j=0,B=0,E=T.length,R=0,N=0,C,P,I,H=[],L,z,ee;for(P=0;P<E;++P){switch(I=!1,C=T[P].slice(0),C[0]){case"l":C[0]="L",C[1]+=j,C[2]+=B;case"L":j=C[1],B=C[2];break;case"h":C[1]+=j;case"H":C[0]="L",C[2]=B,j=C[1];break;case"v":C[1]+=B;case"V":C[0]="L",B=C[1],C[1]=j,C[2]=B;break;case"m":C[0]="M",C[1]+=j,C[2]+=B;case"M":j=C[1],B=C[2],R=C[1],N=C[2];break;case"c":C[0]="C",C[1]+=j,C[2]+=B,C[3]+=j,C[4]+=B,C[5]+=j,C[6]+=B;case"C":z=C[3],ee=C[4],j=C[5],B=C[6];break;case"s":C[0]="S",C[1]+=j,C[2]+=B,C[3]+=j,C[4]+=B;case"S":L==="C"?(z=2*j-z,ee=2*B-ee):(z=j,ee=B),j=C[3],B=C[4],C[0]="C",C[5]=C[3],C[6]=C[4],C[3]=C[1],C[4]=C[2],C[1]=z,C[2]=ee,z=C[3],ee=C[4];break;case"q":C[0]="Q",C[1]+=j,C[2]+=B,C[3]+=j,C[4]+=B;case"Q":z=C[1],ee=C[2],j=C[3],B=C[4];break;case"t":C[0]="T",C[1]+=j,C[2]+=B;case"T":L==="Q"?(z=2*j-z,ee=2*B-ee):(z=j,ee=B),C[0]="Q",j=C[1],B=C[2],C[1]=z,C[2]=ee,C[3]=j,C[4]=B;break;case"a":C[0]="A",C[6]+=j,C[7]+=B;case"A":I=!0,H=H.concat(p(j,B,C)),j=C[6],B=C[7];break;case"z":case"Z":j=R,B=N;break}I||H.push(C),L=C[0]}return H}function g(T,j,B,E){return Math.sqrt((B-T)*(B-T)+(E-j)*(E-j))}function x(T){return T*T*T}function v(T){return 3*T*T*(1-T)}function w(T){return 3*T*(1-T)*(1-T)}function _(T){return(1-T)*(1-T)*(1-T)}function b(T,j,B,E,R,N,C,P){return function(I){var H=x(I),L=v(I),z=w(I),ee=_(I);return{x:C*H+R*L+B*z+T*ee,y:P*H+N*L+E*z+j*ee}}}function k(T,j,B,E,R,N,C,P){return function(I){var H=1-I,L=3*H*H*(B-T)+6*H*I*(R-B)+3*I*I*(C-R),z=3*H*H*(E-j)+6*H*I*(N-E)+3*I*I*(P-N);return Math.atan2(z,L)}}function S(T){return T*T}function O(T){return 2*T*(1-T)}function F(T){return(1-T)*(1-T)}function D(T,j,B,E,R,N){return function(C){var P=S(C),I=O(C),H=F(C);return{x:R*P+B*I+T*H,y:N*P+E*I+j*H}}}function U(T,j,B,E,R,N){return function(C){var P=1-C,I=2*P*(B-T)+2*C*(R-B),H=2*P*(E-j)+2*C*(N-E);return Math.atan2(H,I)}}function M(T,j,B){var E={x:j,y:B},R,N=0,C;for(C=1;C<=100;C+=1)R=T(C/100),N+=g(E.x,E.y,R.x,R.y),E=R;return N}function q(T,j){for(var B=0,E=0,R=T.iterator,N={x:T.x,y:T.y},C,P,I=.01,H=T.angleFinder,L;E<j&&I>1e-4;)C=R(B),L=B,P=g(N.x,N.y,C.x,C.y),P+E>j?(B-=I,I/=2):(N=C,B+=I,E+=P);return C.angle=H(L),C}function G(T){for(var j=0,B=T.length,E,R=0,N=0,C=0,P=0,I=[],H,L,z,ee=0;ee<B;ee++){switch(E=T[ee],L={x:R,y:N,command:E[0]},E[0]){case"M":L.length=0,C=R=E[1],P=N=E[2];break;case"L":L.length=g(R,N,E[1],E[2]),R=E[1],N=E[2];break;case"C":H=b(R,N,E[1],E[2],E[3],E[4],E[5],E[6]),z=k(R,N,E[1],E[2],E[3],E[4],E[5],E[6]),L.iterator=H,L.angleFinder=z,L.length=M(H,R,N),R=E[5],N=E[6];break;case"Q":H=D(R,N,E[1],E[2],E[3],E[4]),z=U(R,N,E[1],E[2],E[3],E[4]),L.iterator=H,L.angleFinder=z,L.length=M(H,R,N),R=E[3],N=E[4];break;case"Z":case"z":L.destX=C,L.destY=P,L.length=g(R,N,C,P),R=C,N=P;break}j+=L.length,I.push(L)}return I.push({length:j,x:R,y:N}),I}function Q(T,j,B){B||(B=G(T));for(var E=0;j-B[E].length>0&&E<B.length-2;)j-=B[E].length,E++;var R=B[E],N=j/R.length,C=R.command,P=T[E],I;switch(C){case"M":return{x:R.x,y:R.y,angle:0};case"Z":case"z":return I=new t.Point(R.x,R.y).lerp(new t.Point(R.destX,R.destY),N),I.angle=Math.atan2(R.destY-R.y,R.destX-R.x),I;case"L":return I=new t.Point(R.x,R.y).lerp(new t.Point(P[1],P[2]),N),I.angle=Math.atan2(P[2]-R.y,P[1]-R.x),I;case"C":return q(R,j);case"Q":return q(R,j)}}function K(T){var j=[],B=[],E,R,N=t.rePathCommand,C="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",P="("+C+")"+t.commaWsp,I="([01])"+t.commaWsp+"?",H=P+"?"+P+"?"+P+I+I+P+"?("+C+")",L=new RegExp(H,"g"),z,ee,A;if(!T||!T.match)return j;A=T.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var V=0,W,te=A.length;V<te;V++){E=A[V],ee=E.slice(1).trim(),B.length=0;var ae=E.charAt(0);if(W=[ae],ae.toLowerCase()==="a")for(var Y;Y=L.exec(ee);)for(var ce=1;ce<Y.length;ce++)B.push(Y[ce]);else for(;z=N.exec(ee);)B.push(z[0]);for(var ce=0,ue=B.length;ce<ue;ce++)R=parseFloat(B[ce]),isNaN(R)||W.push(R);var xe=a[ae.toLowerCase()],_e=c[ae]||ae;if(W.length-1>xe)for(var fe=1,ve=W.length;fe<ve;fe+=xe)j.push([ae].concat(W.slice(fe,fe+xe))),ae=_e;else j.push(W)}return j}function ne(T,j){var B=[],E,R=new t.Point(T[0].x,T[0].y),N=new t.Point(T[1].x,T[1].y),C=T.length,P=1,I=0,H=C>2;for(j=j||0,H&&(P=T[2].x<N.x?-1:T[2].x===N.x?0:1,I=T[2].y<N.y?-1:T[2].y===N.y?0:1),B.push(["M",R.x-P*j,R.y-I*j]),E=1;E<C;E++){if(!R.eq(N)){var L=R.midPointFrom(N);B.push(["Q",R.x,R.y,L.x,L.y])}R=T[E],E+1<T.length&&(N=T[E+1])}return H&&(P=R.x>T[E-2].x?1:R.x===T[E-2].x?0:-1,I=R.y>T[E-2].y?1:R.y===T[E-2].y?0:-1),B.push(["L",R.x+P*j,R.y+I*j]),B}function J(T,j,B){return B&&(j=t.util.multiplyTransformMatrices(j,[1,0,0,1,-B.x,-B.y])),T.map(function(E){for(var R=E.slice(0),N={},C=1;C<E.length-1;C+=2)N.x=E[C],N.y=E[C+1],N=t.util.transformPoint(N,j),R[C]=N.x,R[C+1]=N.y;return R})}t.util.joinPath=function(T){return T.map(function(j){return j.join(" ")}).join(" ")},t.util.parsePath=K,t.util.makePathSimpler=m,t.util.getSmoothPathFromPoints=ne,t.util.getPathSegmentsInfo=G,t.util.getBoundsOfCurve=u,t.util.getPointOnPath=Q,t.util.transformPath=J}(),function(){var o=Array.prototype.slice;function a(u,p){for(var m=o.call(arguments,2),g=[],x=0,v=u.length;x<v;x++)g[x]=m.length?u[x][p].apply(u[x],m):u[x][p].call(u[x]);return g}function c(u,p){return h(u,p,function(m,g){return m>=g})}function d(u,p){return h(u,p,function(m,g){return m<g})}function f(u,p){for(var m=u.length;m--;)u[m]=p;return u}function h(u,p,m){if(!(!u||u.length===0)){var g=u.length-1,x=p?u[g][p]:u[g];if(p)for(;g--;)m(u[g][p],x)&&(x=u[g][p]);else for(;g--;)m(u[g],x)&&(x=u[g]);return x}}t.util.array={fill:f,invoke:a,min:d,max:c}}(),function(){function o(c,d,f){if(f)if(!t.isLikelyNode&&d instanceof Element)c=d;else if(d instanceof Array){c=[];for(var h=0,u=d.length;h<u;h++)c[h]=o({},d[h],f)}else if(d&&typeof d=="object")for(var p in d)p==="canvas"||p==="group"?c[p]=null:d.hasOwnProperty(p)&&(c[p]=o({},d[p],f));else c=d;else for(var p in d)c[p]=d[p];return c}function a(c,d){return o({},c,d)}t.util.object={extend:o,clone:a},t.util.object.extend(t.util,t.Observable)}(),function(){function o(h){return h.replace(/-+(.)?/g,function(u,p){return p?p.toUpperCase():""})}function a(h,u){return h.charAt(0).toUpperCase()+(u?h.slice(1):h.slice(1).toLowerCase())}function c(h){return h.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function d(h){var u=0,p,m=[];for(u=0,p;u<h.length;u++)(p=f(h,u))!==!1&&m.push(p);return m}function f(h,u){var p=h.charCodeAt(u);if(isNaN(p))return"";if(p<55296||p>57343)return h.charAt(u);if(55296<=p&&p<=56319){if(h.length<=u+1)throw"High surrogate without following low surrogate";var m=h.charCodeAt(u+1);if(56320>m||m>57343)throw"High surrogate without following low surrogate";return h.charAt(u)+h.charAt(u+1)}if(u===0)throw"Low surrogate without preceding high surrogate";var g=h.charCodeAt(u-1);if(55296>g||g>56319)throw"Low surrogate without preceding high surrogate";return!1}t.util.string={camelize:o,capitalize:a,escapeXml:c,graphemeSplit:d}}(),function(){var o=Array.prototype.slice,a=function(){},c=function(){for(var p in{toString:1})if(p==="toString")return!1;return!0}(),d=function(p,m,g){for(var x in m)x in p.prototype&&typeof p.prototype[x]=="function"&&(m[x]+"").indexOf("callSuper")>-1?p.prototype[x]=function(v){return function(){var w=this.constructor.superclass;this.constructor.superclass=g;var _=m[v].apply(this,arguments);if(this.constructor.superclass=w,v!=="initialize")return _}}(x):p.prototype[x]=m[x],c&&(m.toString!==Object.prototype.toString&&(p.prototype.toString=m.toString),m.valueOf!==Object.prototype.valueOf&&(p.prototype.valueOf=m.valueOf))};function f(){}function h(p){for(var m=null,g=this;g.constructor.superclass;){var x=g.constructor.superclass.prototype[p];if(g[p]!==x){m=x;break}g=g.constructor.superclass.prototype}return m?arguments.length>1?m.apply(this,o.call(arguments,1)):m.call(this):console.log("tried to callSuper "+p+", method not found in prototype chain",this)}function u(){var p=null,m=o.call(arguments,0);typeof m[0]=="function"&&(p=m.shift());function g(){this.initialize.apply(this,arguments)}g.superclass=p,g.subclasses=[],p&&(f.prototype=p.prototype,g.prototype=new f,p.subclasses.push(g));for(var x=0,v=m.length;x<v;x++)d(g,m[x],p);return g.prototype.initialize||(g.prototype.initialize=a),g.prototype.constructor=g,g.prototype.callSuper=h,g}t.util.createClass=u}(),function(){var o=!!t.document.createElement("div").attachEvent,a=["touchstart","touchmove","touchend"];t.util.addListener=function(d,f,h,u){d&&d.addEventListener(f,h,o?!1:u)},t.util.removeListener=function(d,f,h,u){d&&d.removeEventListener(f,h,o?!1:u)};function c(d){var f=d.changedTouches;return f&&f[0]?f[0]:d}t.util.getPointer=function(d){var f=d.target,h=t.util.getScrollLeftTop(f),u=c(d);return{x:u.clientX+h.left,y:u.clientY+h.top}},t.util.isTouchEvent=function(d){return a.indexOf(d.type)>-1||d.pointerType==="touch"}}(),function(){function o(u,p){var m=u.style;if(!m)return u;if(typeof p=="string")return u.style.cssText+=";"+p,p.indexOf("opacity")>-1?h(u,p.match(/opacity:\s*(\d?\.?\d*)/)[1]):u;for(var g in p)if(g==="opacity")h(u,p[g]);else{var x=g==="float"||g==="cssFloat"?typeof m.styleFloat>"u"?"cssFloat":"styleFloat":g;m.setProperty(x,p[g])}return u}var a=t.document.createElement("div"),c=typeof a.style.opacity=="string",d=typeof a.style.filter=="string",f=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,h=function(u){return u};c?h=function(u,p){return u.style.opacity=p,u}:d&&(h=function(u,p){var m=u.style;return u.currentStyle&&!u.currentStyle.hasLayout&&(m.zoom=1),f.test(m.filter)?(p=p>=.9999?"":"alpha(opacity="+p*100+")",m.filter=m.filter.replace(f,p)):m.filter+=" alpha(opacity="+p*100+")",u}),t.util.setStyle=o}(),function(){var o=Array.prototype.slice;function a(_){return typeof _=="string"?t.document.getElementById(_):_}var c,d=function(_){return o.call(_,0)};try{c=d(t.document.childNodes)instanceof Array}catch{}c||(d=function(_){for(var b=new Array(_.length),k=_.length;k--;)b[k]=_[k];return b});function f(_,b){var k=t.document.createElement(_);for(var S in b)S==="class"?k.className=b[S]:S==="for"?k.htmlFor=b[S]:k.setAttribute(S,b[S]);return k}function h(_,b){_&&(" "+_.className+" ").indexOf(" "+b+" ")===-1&&(_.className+=(_.className?" ":"")+b)}function u(_,b,k){return typeof b=="string"&&(b=f(b,k)),_.parentNode&&_.parentNode.replaceChild(b,_),b.appendChild(_),b}function p(_){for(var b=0,k=0,S=t.document.documentElement,O=t.document.body||{scrollLeft:0,scrollTop:0};_&&(_.parentNode||_.host)&&(_=_.parentNode||_.host,_===t.document?(b=O.scrollLeft||S.scrollLeft||0,k=O.scrollTop||S.scrollTop||0):(b+=_.scrollLeft||0,k+=_.scrollTop||0),!(_.nodeType===1&&_.style.position==="fixed")););return{left:b,top:k}}function m(_){var b,k=_&&_.ownerDocument,S={left:0,top:0},O={left:0,top:0},F,D={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!k)return O;for(var U in D)O[D[U]]+=parseInt(g(_,U),10)||0;return b=k.documentElement,typeof _.getBoundingClientRect<"u"&&(S=_.getBoundingClientRect()),F=p(_),{left:S.left+F.left-(b.clientLeft||0)+O.left,top:S.top+F.top-(b.clientTop||0)+O.top}}var g;t.document.defaultView&&t.document.defaultView.getComputedStyle?g=function(_,b){var k=t.document.defaultView.getComputedStyle(_,null);return k?k[b]:void 0}:g=function(_,b){var k=_.style[b];return!k&&_.currentStyle&&(k=_.currentStyle[b]),k},function(){var _=t.document.documentElement.style,b="userSelect"in _?"userSelect":"MozUserSelect"in _?"MozUserSelect":"WebkitUserSelect"in _?"WebkitUserSelect":"KhtmlUserSelect"in _?"KhtmlUserSelect":"";function k(O){return typeof O.onselectstart<"u"&&(O.onselectstart=t.util.falseFunction),b?O.style[b]="none":typeof O.unselectable=="string"&&(O.unselectable="on"),O}function S(O){return typeof O.onselectstart<"u"&&(O.onselectstart=null),b?O.style[b]="":typeof O.unselectable=="string"&&(O.unselectable=""),O}t.util.makeElementUnselectable=k,t.util.makeElementSelectable=S}();function x(_){var b=t.jsdomImplForWrapper(_);return b._canvas||b._image}function v(_){if(t.isLikelyNode){var b=t.jsdomImplForWrapper(_);b&&(b._image=null,b._canvas=null,b._currentSrc=null,b._attributes=null,b._classList=null)}}function w(_,b){_.imageSmoothingEnabled=_.imageSmoothingEnabled||_.webkitImageSmoothingEnabled||_.mozImageSmoothingEnabled||_.msImageSmoothingEnabled||_.oImageSmoothingEnabled,_.imageSmoothingEnabled=b}t.util.setImageSmoothing=w,t.util.getById=a,t.util.toArray=d,t.util.addClass=h,t.util.makeElement=f,t.util.wrapElement=u,t.util.getScrollLeftTop=p,t.util.getElementOffset=m,t.util.getNodeCanvas=x,t.util.cleanUpJsdomNode=v}(),function(){function o(d,f){return d+(/\?/.test(d)?"&":"?")+f}function a(){}function c(d,f){f||(f={});var h=f.method?f.method.toUpperCase():"GET",u=f.onComplete||function(){},p=new t.window.XMLHttpRequest,m=f.body||f.parameters;return p.onreadystatechange=function(){p.readyState===4&&(u(p),p.onreadystatechange=a)},h==="GET"&&(m=null,typeof f.parameters=="string"&&(d=o(d,f.parameters))),p.open(h,d,!0),(h==="POST"||h==="PUT")&&p.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),p.send(m),p}t.util.request=c}(),t.log=console.log,t.warn=console.warn,function(){var o=t.util.object.extend,a=t.util.object.clone,c=[];t.util.object.extend(c,{cancelAll:function(){var x=this.splice(0);return x.forEach(function(v){v.cancel()}),x},cancelByCanvas:function(x){if(!x)return[];var v=this.filter(function(w){return typeof w.target=="object"&&w.target.canvas===x});return v.forEach(function(w){w.cancel()}),v},cancelByTarget:function(x){var v=this.findAnimationsByTarget(x);return v.forEach(function(w){w.cancel()}),v},findAnimationIndex:function(x){return this.indexOf(this.findAnimation(x))},findAnimation:function(x){return this.find(function(v){return v.cancel===x})},findAnimationsByTarget:function(x){return x?this.filter(function(v){return v.target===x}):[]}});function d(){return!1}function f(x,v,w,_){return-w*Math.cos(x/_*(Math.PI/2))+w+v}function h(x){x||(x={});var v=!1,w,_=function(){var b=t.runningAnimations.indexOf(w);return b>-1&&t.runningAnimations.splice(b,1)[0]};return w=o(a(x),{cancel:function(){return v=!0,_()},currentValue:"startValue"in x?x.startValue:0,completionRate:0,durationRate:0}),t.runningAnimations.push(w),m(function(b){var k=b||+new Date,S=x.duration||500,O=k+S,F,D=x.onChange||d,U=x.abort||d,M=x.onComplete||d,q=x.easing||f,G="startValue"in x?x.startValue.length>0:!1,Q="startValue"in x?x.startValue:0,K="endValue"in x?x.endValue:100,ne=x.byValue||(G?Q.map(function(J,T){return K[T]-Q[T]}):K-Q);x.onStart&&x.onStart(),function J(T){F=T||+new Date;var j=F>O?S:F-k,B=j/S,E=G?Q.map(function(N,C){return q(j,Q[C],ne[C],S)}):q(j,Q,ne,S),R=Math.abs(G?(E[0]-Q[0])/ne[0]:(E-Q)/ne);if(w.currentValue=G?E.slice():E,w.completionRate=R,w.durationRate=B,!v){if(U(E,R,B)){_();return}if(F>O){w.currentValue=G?K.slice():K,w.completionRate=1,w.durationRate=1,D(G?K.slice():K,1,1),M(K,1,1),_();return}else D(E,R,B),m(J)}}(k)}),w.cancel}var u=t.window.requestAnimationFrame||t.window.webkitRequestAnimationFrame||t.window.mozRequestAnimationFrame||t.window.oRequestAnimationFrame||t.window.msRequestAnimationFrame||function(x){return t.window.setTimeout(x,1e3/60)},p=t.window.cancelAnimationFrame||t.window.clearTimeout;function m(){return u.apply(t.window,arguments)}function g(){return p.apply(t.window,arguments)}t.util.animate=h,t.util.requestAnimFrame=m,t.util.cancelAnimFrame=g,t.runningAnimations=c}(),function(){function o(c,d,f){var h="rgba("+parseInt(c[0]+f*(d[0]-c[0]),10)+","+parseInt(c[1]+f*(d[1]-c[1]),10)+","+parseInt(c[2]+f*(d[2]-c[2]),10);return h+=","+(c&&d?parseFloat(c[3]+f*(d[3]-c[3])):1),h+=")",h}function a(c,d,f,h){var u=new t.Color(c).getSource(),p=new t.Color(d).getSource(),m=h.onComplete,g=h.onChange;return h=h||{},t.util.animate(t.util.object.extend(h,{duration:f||500,startValue:u,endValue:p,byValue:p,easing:function(x,v,w,_){var b=h.colorEasing?h.colorEasing(x,_):1-Math.cos(x/_*(Math.PI/2));return o(v,w,b)},onComplete:function(x,v,w){if(m)return m(o(p,p,0),v,w)},onChange:function(x,v,w){if(g){if(Array.isArray(x))return g(o(x,x,0),v,w);g(x,v,w)}}}))}t.util.animateColor=a}(),function(){function o(T,j,B,E){return T<Math.abs(j)?(T=j,E=B/4):j===0&&T===0?E=B/(2*Math.PI)*Math.asin(1):E=B/(2*Math.PI)*Math.asin(j/T),{a:T,c:j,p:B,s:E}}function a(T,j,B){return T.a*Math.pow(2,10*(j-=1))*Math.sin((j*B-T.s)*(2*Math.PI)/T.p)}function c(T,j,B,E){return B*((T=T/E-1)*T*T+1)+j}function d(T,j,B,E){return T/=E/2,T<1?B/2*T*T*T+j:B/2*((T-=2)*T*T+2)+j}function f(T,j,B,E){return B*(T/=E)*T*T*T+j}function h(T,j,B,E){return-B*((T=T/E-1)*T*T*T-1)+j}function u(T,j,B,E){return T/=E/2,T<1?B/2*T*T*T*T+j:-B/2*((T-=2)*T*T*T-2)+j}function p(T,j,B,E){return B*(T/=E)*T*T*T*T+j}function m(T,j,B,E){return B*((T=T/E-1)*T*T*T*T+1)+j}function g(T,j,B,E){return T/=E/2,T<1?B/2*T*T*T*T*T+j:B/2*((T-=2)*T*T*T*T+2)+j}function x(T,j,B,E){return-B*Math.cos(T/E*(Math.PI/2))+B+j}function v(T,j,B,E){return B*Math.sin(T/E*(Math.PI/2))+j}function w(T,j,B,E){return-B/2*(Math.cos(Math.PI*T/E)-1)+j}function _(T,j,B,E){return T===0?j:B*Math.pow(2,10*(T/E-1))+j}function b(T,j,B,E){return T===E?j+B:B*(-Math.pow(2,-10*T/E)+1)+j}function k(T,j,B,E){return T===0?j:T===E?j+B:(T/=E/2,T<1?B/2*Math.pow(2,10*(T-1))+j:B/2*(-Math.pow(2,-10*--T)+2)+j)}function S(T,j,B,E){return-B*(Math.sqrt(1-(T/=E)*T)-1)+j}function O(T,j,B,E){return B*Math.sqrt(1-(T=T/E-1)*T)+j}function F(T,j,B,E){return T/=E/2,T<1?-B/2*(Math.sqrt(1-T*T)-1)+j:B/2*(Math.sqrt(1-(T-=2)*T)+1)+j}function D(T,j,B,E){var R=1.70158,N=0,C=B;if(T===0)return j;if(T/=E,T===1)return j+B;N||(N=E*.3);var P=o(C,B,N,R);return-a(P,T,E)+j}function U(T,j,B,E){var R=1.70158,N=0,C=B;if(T===0)return j;if(T/=E,T===1)return j+B;N||(N=E*.3);var P=o(C,B,N,R);return P.a*Math.pow(2,-10*T)*Math.sin((T*E-P.s)*(2*Math.PI)/P.p)+P.c+j}function M(T,j,B,E){var R=1.70158,N=0,C=B;if(T===0)return j;if(T/=E/2,T===2)return j+B;N||(N=E*(.3*1.5));var P=o(C,B,N,R);return T<1?-.5*a(P,T,E)+j:P.a*Math.pow(2,-10*(T-=1))*Math.sin((T*E-P.s)*(2*Math.PI)/P.p)*.5+P.c+j}function q(T,j,B,E,R){return R===void 0&&(R=1.70158),B*(T/=E)*T*((R+1)*T-R)+j}function G(T,j,B,E,R){return R===void 0&&(R=1.70158),B*((T=T/E-1)*T*((R+1)*T+R)+1)+j}function Q(T,j,B,E,R){return R===void 0&&(R=1.70158),T/=E/2,T<1?B/2*(T*T*(((R*=1.525)+1)*T-R))+j:B/2*((T-=2)*T*(((R*=1.525)+1)*T+R)+2)+j}function K(T,j,B,E){return B-ne(E-T,0,B,E)+j}function ne(T,j,B,E){return(T/=E)<1/2.75?B*(7.5625*T*T)+j:T<2/2.75?B*(7.5625*(T-=1.5/2.75)*T+.75)+j:T<2.5/2.75?B*(7.5625*(T-=2.25/2.75)*T+.9375)+j:B*(7.5625*(T-=2.625/2.75)*T+.984375)+j}function J(T,j,B,E){return T<E/2?K(T*2,0,B,E)*.5+j:ne(T*2-E,0,B,E)*.5+B*.5+j}t.util.ease={easeInQuad:function(T,j,B,E){return B*(T/=E)*T+j},easeOutQuad:function(T,j,B,E){return-B*(T/=E)*(T-2)+j},easeInOutQuad:function(T,j,B,E){return T/=E/2,T<1?B/2*T*T+j:-B/2*(--T*(T-2)-1)+j},easeInCubic:function(T,j,B,E){return B*(T/=E)*T*T+j},easeOutCubic:c,easeInOutCubic:d,easeInQuart:f,easeOutQuart:h,easeInOutQuart:u,easeInQuint:p,easeOutQuint:m,easeInOutQuint:g,easeInSine:x,easeOutSine:v,easeInOutSine:w,easeInExpo:_,easeOutExpo:b,easeInOutExpo:k,easeInCirc:S,easeOutCirc:O,easeInOutCirc:F,easeInElastic:D,easeOutElastic:U,easeInOutElastic:M,easeInBack:q,easeOutBack:G,easeInOutBack:Q,easeInBounce:K,easeOutBounce:ne,easeInOutBounce:J}}(),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.util.object.clone,f=a.util.toFixed,h=a.util.parseUnit,u=a.util.multiplyTransformMatrices,p=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],m=["symbol","image","marker","pattern","view","svg"],g=["pattern","defs","symbol","metadata","clipPath","mask","desc"],x=["symbol","g","a","svg","clipPath","defs"],v={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},w={stroke:"strokeOpacity",fill:"fillOpacity"},_="font-size",b="clip-path";a.svgValidTagNamesRegEx=O(p),a.svgViewBoxElementsRegEx=O(m),a.svgInvalidAncestorsRegEx=O(g),a.svgValidParentsRegEx=O(x),a.cssRules={},a.gradientDefs={},a.clipPaths={};function k(N){return N in v?v[N]:N}function S(N,C,P,I){var H=Array.isArray(C),L;if((N==="fill"||N==="stroke")&&C==="none")C="";else{if(N==="strokeUniform")return C==="non-scaling-stroke";if(N==="strokeDashArray")C==="none"?C=null:C=C.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(N==="transformMatrix")P&&P.transformMatrix?C=u(P.transformMatrix,a.parseTransformAttribute(C)):C=a.parseTransformAttribute(C);else if(N==="visible")C=C!=="none"&&C!=="hidden",P&&P.visible===!1&&(C=!1);else if(N==="opacity")C=parseFloat(C),P&&typeof P.opacity<"u"&&(C*=P.opacity);else if(N==="textAnchor")C=C==="start"?"left":C==="end"?"right":"center";else if(N==="charSpacing")L=h(C,I)/I*1e3;else if(N==="paintFirst"){var z=C.indexOf("fill"),ee=C.indexOf("stroke"),C="fill";(z>-1&&ee>-1&&ee<z||z===-1&&ee>-1)&&(C="stroke")}else{if(N==="href"||N==="xlink:href"||N==="font")return C;if(N==="imageSmoothing")return C==="optimizeQuality";L=H?C.map(h):h(C,I)}}return!H&&isNaN(L)?C:L}function O(N){return new RegExp("^("+N.join("|")+")\\b","i")}function F(N){for(var C in w)if(!(typeof N[w[C]]>"u"||N[C]==="")){if(typeof N[C]>"u"){if(!a.Object.prototype[C])continue;N[C]=a.Object.prototype[C]}if(N[C].indexOf("url(")!==0){var P=new a.Color(N[C]);N[C]=P.setAlpha(f(P.getAlpha()*N[w[C]],2)).toRgba()}}return N}function D(N,C){var P,I=[],H,L,z;for(L=0,z=C.length;L<z;L++)P=C[L],H=N.getElementsByTagName(P),I=I.concat(Array.prototype.slice.call(H));return I}a.parseTransformAttribute=function(){function N(fe,ve){var Ce=a.util.cos(ve[0]),De=a.util.sin(ve[0]),Re=0,Me=0;ve.length===3&&(Re=ve[1],Me=ve[2]),fe[0]=Ce,fe[1]=De,fe[2]=-De,fe[3]=Ce,fe[4]=Re-(Ce*Re-De*Me),fe[5]=Me-(De*Re+Ce*Me)}function C(fe,ve){var Ce=ve[0],De=ve.length===2?ve[1]:ve[0];fe[0]=Ce,fe[3]=De}function P(fe,ve,Ce){fe[Ce]=Math.tan(a.util.degreesToRadians(ve[0]))}function I(fe,ve){fe[4]=ve[0],ve.length===2&&(fe[5]=ve[1])}var H=a.iMatrix,L=a.reNum,z=a.commaWsp,ee="(?:(skewX)\\s*\\(\\s*("+L+")\\s*\\))",A="(?:(skewY)\\s*\\(\\s*("+L+")\\s*\\))",V="(?:(rotate)\\s*\\(\\s*("+L+")(?:"+z+"("+L+")"+z+"("+L+"))?\\s*\\))",W="(?:(scale)\\s*\\(\\s*("+L+")(?:"+z+"("+L+"))?\\s*\\))",te="(?:(translate)\\s*\\(\\s*("+L+")(?:"+z+"("+L+"))?\\s*\\))",ae="(?:(matrix)\\s*\\(\\s*("+L+")"+z+"("+L+")"+z+"("+L+")"+z+"("+L+")"+z+"("+L+")"+z+"("+L+")\\s*\\))",Y="(?:"+ae+"|"+te+"|"+W+"|"+V+"|"+ee+"|"+A+")",ce="(?:"+Y+"(?:"+z+"*"+Y+")*)",ue="^\\s*(?:"+ce+"?)\\s*$",xe=new RegExp(ue),_e=new RegExp(Y,"g");return function(fe){var ve=H.concat(),Ce=[];if(!fe||fe&&!xe.test(fe))return ve;fe.replace(_e,function(Re){var Me=new RegExp(Y).exec(Re).filter(function(Ue){return!!Ue}),Ye=Me[1],tt=Me.slice(2).map(parseFloat);switch(Ye){case"translate":I(ve,tt);break;case"rotate":tt[0]=a.util.degreesToRadians(tt[0]),N(ve,tt);break;case"scale":C(ve,tt);break;case"skewX":P(ve,tt,2);break;case"skewY":P(ve,tt,1);break;case"matrix":ve=tt;break}Ce.push(ve.concat()),ve=H.concat()});for(var De=Ce[0];Ce.length>1;)Ce.shift(),De=a.util.multiplyTransformMatrices(De,Ce[0]);return De}}();function U(N,C){var P,I;N.replace(/;\s*$/,"").split(";").forEach(function(H){var L=H.split(":");P=L[0].trim().toLowerCase(),I=L[1].trim(),C[P]=I})}function M(N,C){var P,I;for(var H in N)typeof N[H]>"u"||(P=H.toLowerCase(),I=N[H],C[P]=I)}function q(N,C){var P={};for(var I in a.cssRules[C])if(G(N,I.split(" ")))for(var H in a.cssRules[C][I])P[H]=a.cssRules[C][I][H];return P}function G(N,C){var P,I=!0;return P=K(N,C.pop()),P&&C.length&&(I=Q(N,C)),P&&I&&C.length===0}function Q(N,C){for(var P,I=!0;N.parentNode&&N.parentNode.nodeType===1&&C.length;)I&&(P=C.pop()),N=N.parentNode,I=K(N,P);return C.length===0}function K(N,C){var P=N.nodeName,I=N.getAttribute("class"),H=N.getAttribute("id"),L,z;if(L=new RegExp("^"+P,"i"),C=C.replace(L,""),H&&C.length&&(L=new RegExp("#"+H+"(?![a-zA-Z\\-]+)","i"),C=C.replace(L,"")),I&&C.length)for(I=I.split(" "),z=I.length;z--;)L=new RegExp("\\."+I[z]+"(?![a-zA-Z\\-]+)","i"),C=C.replace(L,"");return C.length===0}function ne(N,C){var P;if(N.getElementById&&(P=N.getElementById(C)),P)return P;var I,H,L,z=N.getElementsByTagName("*");for(H=0,L=z.length;H<L;H++)if(I=z[H],C===I.getAttribute("id"))return I}function J(N){for(var C=D(N,["use","svg:use"]),P=0;C.length&&P<C.length;){var I=C[P],H=I.getAttribute("xlink:href")||I.getAttribute("href");if(H===null)return;var L=H.slice(1),z=I.getAttribute("x")||0,ee=I.getAttribute("y")||0,A=ne(N,L).cloneNode(!0),V=(A.getAttribute("transform")||"")+" translate("+z+", "+ee+")",W,te=C.length,ae,Y,ce,ue,xe=a.svgNS;if(j(A),/^svg$/i.test(A.nodeName)){var _e=A.ownerDocument.createElementNS(xe,"g");for(Y=0,ce=A.attributes,ue=ce.length;Y<ue;Y++)ae=ce.item(Y),_e.setAttributeNS(xe,ae.nodeName,ae.nodeValue);for(;A.firstChild;)_e.appendChild(A.firstChild);A=_e}for(Y=0,ce=I.attributes,ue=ce.length;Y<ue;Y++)ae=ce.item(Y),!(ae.nodeName==="x"||ae.nodeName==="y"||ae.nodeName==="xlink:href"||ae.nodeName==="href")&&(ae.nodeName==="transform"?V=ae.nodeValue+" "+V:A.setAttribute(ae.nodeName,ae.nodeValue));A.setAttribute("transform",V),A.setAttribute("instantiated_by_use","1"),A.removeAttribute("id"),W=I.parentNode,W.replaceChild(A,I),C.length===te&&P++}}var T=new RegExp("^\\s*("+a.reNum+"+)\\s*,?\\s*("+a.reNum+"+)\\s*,?\\s*("+a.reNum+"+)\\s*,?\\s*("+a.reNum+"+)\\s*$");function j(N){if(!a.svgViewBoxElementsRegEx.test(N.nodeName))return{};var C=N.getAttribute("viewBox"),P=1,I=1,H=0,L=0,z,ee,A,V,W=N.getAttribute("width"),te=N.getAttribute("height"),ae=N.getAttribute("x")||0,Y=N.getAttribute("y")||0,ce=N.getAttribute("preserveAspectRatio")||"",ue=!C||!(C=C.match(T)),xe=!W||!te||W==="100%"||te==="100%",_e=ue&&xe,fe={},ve="",Ce=0,De=0;if(fe.width=0,fe.height=0,fe.toBeParsed=_e,ue&&(ae||Y)&&N.parentNode&&N.parentNode.nodeName!=="#document"&&(ve=" translate("+h(ae)+" "+h(Y)+") ",A=(N.getAttribute("transform")||"")+ve,N.setAttribute("transform",A),N.removeAttribute("x"),N.removeAttribute("y")),_e)return fe;if(ue)return fe.width=h(W),fe.height=h(te),fe;if(H=-parseFloat(C[1]),L=-parseFloat(C[2]),z=parseFloat(C[3]),ee=parseFloat(C[4]),fe.minX=H,fe.minY=L,fe.viewBoxWidth=z,fe.viewBoxHeight=ee,xe?(fe.width=z,fe.height=ee):(fe.width=h(W),fe.height=h(te),P=fe.width/z,I=fe.height/ee),ce=a.util.parsePreserveAspectRatioAttribute(ce),ce.alignX!=="none"&&(ce.meetOrSlice==="meet"&&(I=P=P>I?I:P),ce.meetOrSlice==="slice"&&(I=P=P>I?P:I),Ce=fe.width-z*P,De=fe.height-ee*P,ce.alignX==="Mid"&&(Ce/=2),ce.alignY==="Mid"&&(De/=2),ce.alignX==="Min"&&(Ce=0),ce.alignY==="Min"&&(De=0)),P===1&&I===1&&H===0&&L===0&&ae===0&&Y===0)return fe;if((ae||Y)&&N.parentNode.nodeName!=="#document"&&(ve=" translate("+h(ae)+" "+h(Y)+") "),A=ve+" matrix("+P+" 0 0 "+I+" "+(H*P+Ce)+" "+(L*I+De)+") ",N.nodeName==="svg"){for(V=N.ownerDocument.createElementNS(a.svgNS,"g");N.firstChild;)V.appendChild(N.firstChild);N.appendChild(V)}else V=N,V.removeAttribute("x"),V.removeAttribute("y"),A=V.getAttribute("transform")+A;return V.setAttribute("transform",A),fe}function B(N,C){for(;N&&(N=N.parentNode);)if(N.nodeName&&C.test(N.nodeName.replace("svg:",""))&&!N.getAttribute("instantiated_by_use"))return!0;return!1}a.parseSVGDocument=function(N,C,P,I){if(N){J(N);var H=a.Object.__uid++,L,z,ee=j(N),A=a.util.toArray(N.getElementsByTagName("*"));if(ee.crossOrigin=I&&I.crossOrigin,ee.svgUid=H,A.length===0&&a.isLikelyNode){A=N.selectNodes('//*[name(.)!="svg"]');var V=[];for(L=0,z=A.length;L<z;L++)V[L]=A[L];A=V}var W=A.filter(function(ae){return j(ae),a.svgValidTagNamesRegEx.test(ae.nodeName.replace("svg:",""))&&!B(ae,a.svgInvalidAncestorsRegEx)});if(!W||W&&!W.length){C&&C([],{});return}var te={};A.filter(function(ae){return ae.nodeName.replace("svg:","")==="clipPath"}).forEach(function(ae){var Y=ae.getAttribute("id");te[Y]=a.util.toArray(ae.getElementsByTagName("*")).filter(function(ce){return a.svgValidTagNamesRegEx.test(ce.nodeName.replace("svg:",""))})}),a.gradientDefs[H]=a.getGradientDefs(N),a.cssRules[H]=a.getCSSRules(N),a.clipPaths[H]=te,a.parseElements(W,function(ae,Y){C&&(C(ae,ee,Y,A),delete a.gradientDefs[H],delete a.cssRules[H],delete a.clipPaths[H])},d(ee),P,I)}};function E(N,C){var P=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],I="xlink:href",H=C.getAttribute(I).slice(1),L=ne(N,H);if(L&&L.getAttribute(I)&&E(N,L),P.forEach(function(ee){L&&!C.hasAttribute(ee)&&L.hasAttribute(ee)&&C.setAttribute(ee,L.getAttribute(ee))}),!C.children.length)for(var z=L.cloneNode(!0);z.firstChild;)C.appendChild(z.firstChild);C.removeAttribute(I)}var R=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+a.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+a.reNum+"))?\\s+(.*)");c(a,{parseFontDeclaration:function(N,C){var P=N.match(R);if(P){var I=P[1],H=P[3],L=P[4],z=P[5],ee=P[6];I&&(C.fontStyle=I),H&&(C.fontWeight=isNaN(parseFloat(H))?H:parseFloat(H)),L&&(C.fontSize=h(L)),ee&&(C.fontFamily=ee),z&&(C.lineHeight=z==="normal"?1:z)}},getGradientDefs:function(N){var C=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],P=D(N,C),I,H=0,L={};for(H=P.length;H--;)I=P[H],I.getAttribute("xlink:href")&&E(N,I),L[I.getAttribute("id")]=I;return L},parseAttributes:function(N,C,P){if(N){var I,H={},L,z;typeof P>"u"&&(P=N.getAttribute("svgUid")),N.parentNode&&a.svgValidParentsRegEx.test(N.parentNode.nodeName)&&(H=a.parseAttributes(N.parentNode,C,P));var ee=C.reduce(function(ce,ue){return I=N.getAttribute(ue),I&&(ce[ue]=I),ce},{}),A=c(q(N,P),a.parseStyleAttribute(N));ee=c(ee,A),A[b]&&N.setAttribute(b,A[b]),L=z=H.fontSize||a.Text.DEFAULT_SVG_FONT_SIZE,ee[_]&&(ee[_]=L=h(ee[_],z));var V,W,te={};for(var ae in ee)V=k(ae),W=S(V,ee[ae],H,L),te[V]=W;te&&te.font&&a.parseFontDeclaration(te.font,te);var Y=c(H,te);return a.svgValidParentsRegEx.test(N.nodeName)?Y:F(Y)}},parseElements:function(N,C,P,I,H){new a.ElementsParser(N,C,P,I,H).parse()},parseStyleAttribute:function(N){var C={},P=N.getAttribute("style");return P&&(typeof P=="string"?U(P,C):M(P,C)),C},parsePointsAttribute:function(N){if(!N)return null;N=N.replace(/,/g," ").trim(),N=N.split(/\s+/);var C=[],P,I;for(P=0,I=N.length;P<I;P+=2)C.push({x:parseFloat(N[P]),y:parseFloat(N[P+1])});return C},getCSSRules:function(N){var C=N.getElementsByTagName("style"),P,I,H={},L;for(P=0,I=C.length;P<I;P++){var z=C[P].textContent;z=z.replace(/\/\*[\s\S]*?\*\//g,""),z.trim()!==""&&(L=z.split("}"),L=L.filter(function(ee){return ee.trim()}),L.forEach(function(ee){var A=ee.split("{"),V={},W=A[1].trim(),te=W.split(";").filter(function(ue){return ue.trim()});for(P=0,I=te.length;P<I;P++){var ae=te[P].split(":"),Y=ae[0].trim(),ce=ae[1].trim();V[Y]=ce}ee=A[0].trim(),ee.split(",").forEach(function(ue){ue=ue.replace(/^svg/i,"").trim(),ue!==""&&(H[ue]?a.util.object.extend(H[ue],V):H[ue]=a.util.object.clone(V))})}))}return H},loadSVGFromURL:function(N,C,P,I){N=N.replace(/^\n\s*/,"").trim(),new a.util.request(N,{method:"get",onComplete:H});function H(L){var z=L.responseXML;if(!z||!z.documentElement)return C&&C(null),!1;a.parseSVGDocument(z.documentElement,function(ee,A,V,W){C&&C(ee,A,V,W)},P,I)}},loadSVGFromString:function(N,C,P,I){var H=new a.window.DOMParser,L=H.parseFromString(N.trim(),"text/xml");a.parseSVGDocument(L.documentElement,function(z,ee,A,V){C(z,ee,A,V)},P,I)}})}(e),t.ElementsParser=function(o,a,c,d,f,h){this.elements=o,this.callback=a,this.options=c,this.reviver=d,this.svgUid=c&&c.svgUid||0,this.parsingOptions=f,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=h},function(o){o.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},o.createObjects=function(){var a=this;this.elements.forEach(function(c,d){c.setAttribute("svgUid",a.svgUid),a.createObject(c,d)})},o.findTag=function(a){return t[t.util.string.capitalize(a.tagName.replace("svg:",""))]},o.createObject=function(a,c){var d=this.findTag(a);if(d&&d.fromElement)try{d.fromElement(a,this.createCallback(c,a),this.options)}catch(f){t.log(f)}else this.checkIfDone()},o.createCallback=function(a,c){var d=this;return function(f){var h;d.resolveGradient(f,c,"fill"),d.resolveGradient(f,c,"stroke"),f instanceof t.Image&&f._originalElement&&(h=f.parsePreserveAspectRatioAttribute(c)),f._removeTransformMatrix(h),d.resolveClipPath(f,c),d.reviver&&d.reviver(c,f),d.instances[a]=f,d.checkIfDone()}},o.extractPropertyDefinition=function(a,c,d){var f=a[c],h=this.regexUrl;if(h.test(f)){h.lastIndex=0;var u=h.exec(f)[1];return h.lastIndex=0,t[d][this.svgUid][u]}},o.resolveGradient=function(a,c,d){var f=this.extractPropertyDefinition(a,d,"gradientDefs");if(f){var h=c.getAttribute(d+"-opacity"),u=t.Gradient.fromElement(f,a,h,this.options);a.set(d,u)}},o.createClipPathCallback=function(a,c){return function(d){d._removeTransformMatrix(),d.fillRule=d.clipRule,c.push(d)}},o.resolveClipPath=function(a,c){var d=this.extractPropertyDefinition(a,"clipPath","clipPaths"),f,h,u,p,m,g;if(d){p=[],u=t.util.invertTransform(a.calcTransformMatrix());for(var x=d[0].parentNode,v=c;v.parentNode&&v.getAttribute("clip-path")!==a.clipPath;)v=v.parentNode;v.parentNode.appendChild(x);for(var w=0;w<d.length;w++)f=d[w],h=this.findTag(f),h.fromElement(f,this.createClipPathCallback(a,p),this.options);p.length===1?d=p[0]:d=new t.Group(p),m=t.util.multiplyTransformMatrices(u,d.calcTransformMatrix()),d.clipPath&&this.resolveClipPath(d,v);var g=t.util.qrDecompose(m);d.flipX=!1,d.flipY=!1,d.set("scaleX",g.scaleX),d.set("scaleY",g.scaleY),d.angle=g.angle,d.skewX=g.skewX,d.skewY=0,d.setPositionByOrigin({x:g.translateX,y:g.translateY},"center","center"),a.clipPath=d}else delete a.clipPath},o.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(a){return a!=null}),this.callback(this.instances,this.elements))}}(t.ElementsParser.prototype),function(o){var a=o.fabric||(o.fabric={});if(a.Point){a.warn("fabric.Point is already defined");return}a.Point=c;function c(d,f){this.x=d,this.y=f}c.prototype={type:"point",constructor:c,add:function(d){return new c(this.x+d.x,this.y+d.y)},addEquals:function(d){return this.x+=d.x,this.y+=d.y,this},scalarAdd:function(d){return new c(this.x+d,this.y+d)},scalarAddEquals:function(d){return this.x+=d,this.y+=d,this},subtract:function(d){return new c(this.x-d.x,this.y-d.y)},subtractEquals:function(d){return this.x-=d.x,this.y-=d.y,this},scalarSubtract:function(d){return new c(this.x-d,this.y-d)},scalarSubtractEquals:function(d){return this.x-=d,this.y-=d,this},multiply:function(d){return new c(this.x*d,this.y*d)},multiplyEquals:function(d){return this.x*=d,this.y*=d,this},divide:function(d){return new c(this.x/d,this.y/d)},divideEquals:function(d){return this.x/=d,this.y/=d,this},eq:function(d){return this.x===d.x&&this.y===d.y},lt:function(d){return this.x<d.x&&this.y<d.y},lte:function(d){return this.x<=d.x&&this.y<=d.y},gt:function(d){return this.x>d.x&&this.y>d.y},gte:function(d){return this.x>=d.x&&this.y>=d.y},lerp:function(d,f){return typeof f>"u"&&(f=.5),f=Math.max(Math.min(1,f),0),new c(this.x+(d.x-this.x)*f,this.y+(d.y-this.y)*f)},distanceFrom:function(d){var f=this.x-d.x,h=this.y-d.y;return Math.sqrt(f*f+h*h)},midPointFrom:function(d){return this.lerp(d)},min:function(d){return new c(Math.min(this.x,d.x),Math.min(this.y,d.y))},max:function(d){return new c(Math.max(this.x,d.x),Math.max(this.y,d.y))},toString:function(){return this.x+","+this.y},setXY:function(d,f){return this.x=d,this.y=f,this},setX:function(d){return this.x=d,this},setY:function(d){return this.y=d,this},setFromPoint:function(d){return this.x=d.x,this.y=d.y,this},swap:function(d){var f=this.x,h=this.y;this.x=d.x,this.y=d.y,d.x=f,d.y=h},clone:function(){return new c(this.x,this.y)}}}(e),function(o){var a=o.fabric||(o.fabric={});if(a.Intersection){a.warn("fabric.Intersection is already defined");return}function c(d){this.status=d,this.points=[]}a.Intersection=c,a.Intersection.prototype={constructor:c,appendPoint:function(d){return this.points.push(d),this},appendPoints:function(d){return this.points=this.points.concat(d),this}},a.Intersection.intersectLineLine=function(d,f,h,u){var p,m=(u.x-h.x)*(d.y-h.y)-(u.y-h.y)*(d.x-h.x),g=(f.x-d.x)*(d.y-h.y)-(f.y-d.y)*(d.x-h.x),x=(u.y-h.y)*(f.x-d.x)-(u.x-h.x)*(f.y-d.y);if(x!==0){var v=m/x,w=g/x;0<=v&&v<=1&&0<=w&&w<=1?(p=new c("Intersection"),p.appendPoint(new a.Point(d.x+v*(f.x-d.x),d.y+v*(f.y-d.y)))):p=new c}else m===0||g===0?p=new c("Coincident"):p=new c("Parallel");return p},a.Intersection.intersectLinePolygon=function(d,f,h){var u=new c,p=h.length,m,g,x,v;for(v=0;v<p;v++)m=h[v],g=h[(v+1)%p],x=c.intersectLineLine(d,f,m,g),u.appendPoints(x.points);return u.points.length>0&&(u.status="Intersection"),u},a.Intersection.intersectPolygonPolygon=function(d,f){var h=new c,u=d.length,p;for(p=0;p<u;p++){var m=d[p],g=d[(p+1)%u],x=c.intersectLinePolygon(m,g,f);h.appendPoints(x.points)}return h.points.length>0&&(h.status="Intersection"),h},a.Intersection.intersectPolygonRectangle=function(d,f,h){var u=f.min(h),p=f.max(h),m=new a.Point(p.x,u.y),g=new a.Point(u.x,p.y),x=c.intersectLinePolygon(u,m,d),v=c.intersectLinePolygon(m,p,d),w=c.intersectLinePolygon(p,g,d),_=c.intersectLinePolygon(g,u,d),b=new c;return b.appendPoints(x.points),b.appendPoints(v.points),b.appendPoints(w.points),b.appendPoints(_.points),b.points.length>0&&(b.status="Intersection"),b}}(e),function(o){var a=o.fabric||(o.fabric={});if(a.Color){a.warn("fabric.Color is already defined.");return}function c(f){f?this._tryParsingColor(f):this.setSource([0,0,0,1])}a.Color=c,a.Color.prototype={_tryParsingColor:function(f){var h;f in c.colorNameMap&&(f=c.colorNameMap[f]),f==="transparent"&&(h=[255,255,255,0]),h||(h=c.sourceFromHex(f)),h||(h=c.sourceFromRgb(f)),h||(h=c.sourceFromHsl(f)),h||(h=[0,0,0,1]),h&&this.setSource(h)},_rgbToHsl:function(f,h,u){f/=255,h/=255,u/=255;var p,m,g,x=a.util.array.max([f,h,u]),v=a.util.array.min([f,h,u]);if(g=(x+v)/2,x===v)p=m=0;else{var w=x-v;switch(m=g>.5?w/(2-x-v):w/(x+v),x){case f:p=(h-u)/w+(h<u?6:0);break;case h:p=(u-f)/w+2;break;case u:p=(f-h)/w+4;break}p/=6}return[Math.round(p*360),Math.round(m*100),Math.round(g*100)]},getSource:function(){return this._source},setSource:function(f){this._source=f},toRgb:function(){var f=this.getSource();return"rgb("+f[0]+","+f[1]+","+f[2]+")"},toRgba:function(){var f=this.getSource();return"rgba("+f[0]+","+f[1]+","+f[2]+","+f[3]+")"},toHsl:function(){var f=this.getSource(),h=this._rgbToHsl(f[0],f[1],f[2]);return"hsl("+h[0]+","+h[1]+"%,"+h[2]+"%)"},toHsla:function(){var f=this.getSource(),h=this._rgbToHsl(f[0],f[1],f[2]);return"hsla("+h[0]+","+h[1]+"%,"+h[2]+"%,"+f[3]+")"},toHex:function(){var f=this.getSource(),h,u,p;return h=f[0].toString(16),h=h.length===1?"0"+h:h,u=f[1].toString(16),u=u.length===1?"0"+u:u,p=f[2].toString(16),p=p.length===1?"0"+p:p,h.toUpperCase()+u.toUpperCase()+p.toUpperCase()},toHexa:function(){var f=this.getSource(),h;return h=Math.round(f[3]*255),h=h.toString(16),h=h.length===1?"0"+h:h,this.toHex()+h.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(f){var h=this.getSource();return h[3]=f,this.setSource(h),this},toGrayscale:function(){var f=this.getSource(),h=parseInt((f[0]*.3+f[1]*.59+f[2]*.11).toFixed(0),10),u=f[3];return this.setSource([h,h,h,u]),this},toBlackWhite:function(f){var h=this.getSource(),u=(h[0]*.3+h[1]*.59+h[2]*.11).toFixed(0),p=h[3];return f=f||127,u=Number(u)<Number(f)?0:255,this.setSource([u,u,u,p]),this},overlayWith:function(f){f instanceof c||(f=new c(f));var h=[],u=this.getAlpha(),p=.5,m=this.getSource(),g=f.getSource(),x;for(x=0;x<3;x++)h.push(Math.round(m[x]*(1-p)+g[x]*p));return h[3]=u,this.setSource(h),this}},a.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,a.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,a.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,a.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function d(f,h,u){return u<0&&(u+=1),u>1&&(u-=1),u<1/6?f+(h-f)*6*u:u<1/2?h:u<2/3?f+(h-f)*(2/3-u)*6:f}a.Color.fromRgb=function(f){return c.fromSource(c.sourceFromRgb(f))},a.Color.sourceFromRgb=function(f){var h=f.match(c.reRGBa);if(h){var u=parseInt(h[1],10)/(/%$/.test(h[1])?100:1)*(/%$/.test(h[1])?255:1),p=parseInt(h[2],10)/(/%$/.test(h[2])?100:1)*(/%$/.test(h[2])?255:1),m=parseInt(h[3],10)/(/%$/.test(h[3])?100:1)*(/%$/.test(h[3])?255:1);return[parseInt(u,10),parseInt(p,10),parseInt(m,10),h[4]?parseFloat(h[4]):1]}},a.Color.fromRgba=c.fromRgb,a.Color.fromHsl=function(f){return c.fromSource(c.sourceFromHsl(f))},a.Color.sourceFromHsl=function(f){var h=f.match(c.reHSLa);if(h){var u=(parseFloat(h[1])%360+360)%360/360,p=parseFloat(h[2])/(/%$/.test(h[2])?100:1),m=parseFloat(h[3])/(/%$/.test(h[3])?100:1),g,x,v;if(p===0)g=x=v=m;else{var w=m<=.5?m*(p+1):m+p-m*p,_=m*2-w;g=d(_,w,u+1/3),x=d(_,w,u),v=d(_,w,u-1/3)}return[Math.round(g*255),Math.round(x*255),Math.round(v*255),h[4]?parseFloat(h[4]):1]}},a.Color.fromHsla=c.fromHsl,a.Color.fromHex=function(f){return c.fromSource(c.sourceFromHex(f))},a.Color.sourceFromHex=function(f){if(f.match(c.reHex)){var h=f.slice(f.indexOf("#")+1),u=h.length===3||h.length===4,p=h.length===8||h.length===4,m=u?h.charAt(0)+h.charAt(0):h.substring(0,2),g=u?h.charAt(1)+h.charAt(1):h.substring(2,4),x=u?h.charAt(2)+h.charAt(2):h.substring(4,6),v=p?u?h.charAt(3)+h.charAt(3):h.substring(6,8):"FF";return[parseInt(m,16),parseInt(g,16),parseInt(x,16),parseFloat((parseInt(v,16)/255).toFixed(2))]}},a.Color.fromSource=function(f){var h=new c;return h.setSource(f),h}}(e),function(o){var a=o.fabric||(o.fabric={}),c=["e","se","s","sw","w","nw","n","ne","e"],d=["ns","nesw","ew","nwse"],f={},h="left",u="top",p="right",m="bottom",g="center",x={top:m,bottom:u,left:p,right:h,center:g},v=a.util.radiansToDegrees,w=Math.sign||function(V){return(V>0)-(V<0)||+V};function _(V,W){var te=V.angle+v(Math.atan2(W.y,W.x))+360;return Math.round(te%360/45)}function b(V,W){var te=W.transform.target,ae=te.canvas,Y=a.util.object.clone(W);Y.target=te,ae&&ae.fire("object:"+V,Y),te.fire(V,W)}function k(V,W){var te=W.canvas,ae=te.uniScaleKey,Y=V[ae];return te.uniformScaling&&!Y||!te.uniformScaling&&Y}function S(V){return V.originX===g&&V.originY===g}function O(V,W,te){var ae=V.lockScalingX,Y=V.lockScalingY;return!!(ae&&Y||!W&&(ae||Y)&&te||ae&&W==="x"||Y&&W==="y")}function F(V,W,te){var ae="not-allowed",Y=k(V,te),ce="";if(W.x!==0&&W.y===0?ce="x":W.x===0&&W.y!==0&&(ce="y"),O(te,ce,Y))return ae;var ue=_(te,W);return c[ue]+"-resize"}function D(V,W,te){var ae="not-allowed";if(W.x!==0&&te.lockSkewingY||W.y!==0&&te.lockSkewingX)return ae;var Y=_(te,W)%4;return d[Y]+"-resize"}function U(V,W,te){return V[te.canvas.altActionKey]?f.skewCursorStyleHandler(V,W,te):f.scaleCursorStyleHandler(V,W,te)}function M(V,W,te){var ae=V[te.canvas.altActionKey];if(W.x===0)return ae?"skewX":"scaleY";if(W.y===0)return ae?"skewY":"scaleX"}function q(V,W,te){return te.lockRotation?"not-allowed":W.cursorStyle}function G(V,W,te,ae){return{e:V,transform:W,pointer:{x:te,y:ae}}}function Q(V){return function(W,te,ae,Y){var ce=te.target,ue=ce.getCenterPoint(),xe=ce.translateToOriginPoint(ue,te.originX,te.originY),_e=V(W,te,ae,Y);return ce.setPositionByOrigin(xe,te.originX,te.originY),_e}}function K(V,W){return function(te,ae,Y,ce){var ue=W(te,ae,Y,ce);return ue&&b(V,G(te,ae,Y,ce)),ue}}function ne(V,W,te,ae,Y){var ce=V.target,ue=ce.controls[V.corner],xe=ce.canvas.getZoom(),_e=ce.padding/xe,fe=ce.toLocalPoint(new a.Point(ae,Y),W,te);return fe.x>=_e&&(fe.x-=_e),fe.x<=-_e&&(fe.x+=_e),fe.y>=_e&&(fe.y-=_e),fe.y<=_e&&(fe.y+=_e),fe.x-=ue.offsetX,fe.y-=ue.offsetY,fe}function J(V){return V.flipX!==V.flipY}function T(V,W,te,ae,Y){if(V[W]!==0){var ce=V._getTransformedDimensions()[ae],ue=Y/ce*V[te];V.set(te,ue)}}function j(V,W,te,ae){var Y=W.target,ce=Y._getTransformedDimensions(0,Y.skewY),ue=ne(W,W.originX,W.originY,te,ae),xe=Math.abs(ue.x*2)-ce.x,_e=Y.skewX,fe;xe<2?fe=0:(fe=v(Math.atan2(xe/Y.scaleX,ce.y/Y.scaleY)),W.originX===h&&W.originY===m&&(fe=-fe),W.originX===p&&W.originY===u&&(fe=-fe),J(Y)&&(fe=-fe));var ve=_e!==fe;if(ve){var Ce=Y._getTransformedDimensions().y;Y.set("skewX",fe),T(Y,"skewY","scaleY","y",Ce)}return ve}function B(V,W,te,ae){var Y=W.target,ce=Y._getTransformedDimensions(Y.skewX,0),ue=ne(W,W.originX,W.originY,te,ae),xe=Math.abs(ue.y*2)-ce.y,_e=Y.skewY,fe;xe<2?fe=0:(fe=v(Math.atan2(xe/Y.scaleY,ce.x/Y.scaleX)),W.originX===h&&W.originY===m&&(fe=-fe),W.originX===p&&W.originY===u&&(fe=-fe),J(Y)&&(fe=-fe));var ve=_e!==fe;if(ve){var Ce=Y._getTransformedDimensions().x;Y.set("skewY",fe),T(Y,"skewX","scaleX","x",Ce)}return ve}function E(V,W,te,ae){var Y=W.target,ce=Y.skewX,ue,xe=W.originY;if(Y.lockSkewingX)return!1;if(ce===0){var _e=ne(W,g,g,te,ae);_e.x>0?ue=h:ue=p}else ce>0&&(ue=xe===u?h:p),ce<0&&(ue=xe===u?p:h),J(Y)&&(ue=ue===h?p:h);W.originX=ue;var fe=K("skewing",Q(j));return fe(V,W,te,ae)}function R(V,W,te,ae){var Y=W.target,ce=Y.skewY,ue,xe=W.originX;if(Y.lockSkewingY)return!1;if(ce===0){var _e=ne(W,g,g,te,ae);_e.y>0?ue=u:ue=m}else ce>0&&(ue=xe===h?u:m),ce<0&&(ue=xe===h?m:u),J(Y)&&(ue=ue===u?m:u);W.originY=ue;var fe=K("skewing",Q(B));return fe(V,W,te,ae)}function N(V,W,te,ae){var Y=W,ce=Y.target,ue=ce.translateToOriginPoint(ce.getCenterPoint(),Y.originX,Y.originY);if(ce.lockRotation)return!1;var xe=Math.atan2(Y.ey-ue.y,Y.ex-ue.x),_e=Math.atan2(ae-ue.y,te-ue.x),fe=v(_e-xe+Y.theta),ve=!0;if(ce.snapAngle>0){var Ce=ce.snapAngle,De=ce.snapThreshold||Ce,Re=Math.ceil(fe/Ce)*Ce,Me=Math.floor(fe/Ce)*Ce;Math.abs(fe-Me)<De?fe=Me:Math.abs(fe-Re)<De&&(fe=Re)}return fe<0&&(fe=360+fe),fe%=360,ve=ce.angle!==fe,ce.angle=fe,ve}function C(V,W,te,ae,Y){Y=Y||{};var ce=W.target,ue=ce.lockScalingX,xe=ce.lockScalingY,_e=Y.by,fe,ve,Ce,De,Re=k(V,ce),Me=O(ce,_e,Re),Ye,tt,Ue=W.gestureScale;if(Me)return!1;if(Ue)ve=W.scaleX*Ue,Ce=W.scaleY*Ue;else{if(fe=ne(W,W.originX,W.originY,te,ae),Ye=_e!=="y"?w(fe.x):1,tt=_e!=="x"?w(fe.y):1,W.signX||(W.signX=Ye),W.signY||(W.signY=tt),ce.lockScalingFlip&&(W.signX!==Ye||W.signY!==tt))return!1;if(De=ce._getTransformedDimensions(),Re&&!_e){var ot=Math.abs(fe.x)+Math.abs(fe.y),pt=W.original,Ge=Math.abs(De.x*pt.scaleX/ce.scaleX)+Math.abs(De.y*pt.scaleY/ce.scaleY),Ur=ot/Ge;ve=pt.scaleX*Ur,Ce=pt.scaleY*Ur}else ve=Math.abs(fe.x*ce.scaleX/De.x),Ce=Math.abs(fe.y*ce.scaleY/De.y);S(W)&&(ve*=2,Ce*=2),W.signX!==Ye&&_e!=="y"&&(W.originX=x[W.originX],ve*=-1,W.signX=Ye),W.signY!==tt&&_e!=="x"&&(W.originY=x[W.originY],Ce*=-1,W.signY=tt)}var mi=ce.scaleX,uf=ce.scaleY;return _e?(_e==="x"&&ce.set("scaleX",ve),_e==="y"&&ce.set("scaleY",Ce)):(!ue&&ce.set("scaleX",ve),!xe&&ce.set("scaleY",Ce)),mi!==ce.scaleX||uf!==ce.scaleY}function P(V,W,te,ae){return C(V,W,te,ae)}function I(V,W,te,ae){return C(V,W,te,ae,{by:"x"})}function H(V,W,te,ae){return C(V,W,te,ae,{by:"y"})}function L(V,W,te,ae){return V[W.target.canvas.altActionKey]?f.skewHandlerX(V,W,te,ae):f.scalingY(V,W,te,ae)}function z(V,W,te,ae){return V[W.target.canvas.altActionKey]?f.skewHandlerY(V,W,te,ae):f.scalingX(V,W,te,ae)}function ee(V,W,te,ae){var Y=W.target,ce=ne(W,W.originX,W.originY,te,ae),ue=Y.strokeWidth/(Y.strokeUniform?Y.scaleX:1),xe=S(W)?2:1,_e=Y.width,fe=Math.abs(ce.x*xe/Y.scaleX)-ue;return Y.set("width",Math.max(fe,0)),_e!==fe}function A(V,W,te,ae){var Y=W.target,ce=te-W.offsetX,ue=ae-W.offsetY,xe=!Y.get("lockMovementX")&&Y.left!==ce,_e=!Y.get("lockMovementY")&&Y.top!==ue;return xe&&Y.set("left",ce),_e&&Y.set("top",ue),(xe||_e)&&b("moving",G(V,W,te,ae)),xe||_e}f.scaleCursorStyleHandler=F,f.skewCursorStyleHandler=D,f.scaleSkewCursorStyleHandler=U,f.rotationWithSnapping=K("rotating",Q(N)),f.scalingEqually=K("scaling",Q(P)),f.scalingX=K("scaling",Q(I)),f.scalingY=K("scaling",Q(H)),f.scalingYOrSkewingX=L,f.scalingXOrSkewingY=z,f.changeWidth=K("resizing",Q(ee)),f.skewHandlerX=E,f.skewHandlerY=R,f.dragHandler=A,f.scaleOrSkewActionName=M,f.rotationStyleHandler=q,f.fireEvent=b,f.wrapWithFixedAnchor=Q,f.wrapWithFireEvent=K,f.getLocalPoint=ne,a.controlsUtils=f}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.degreesToRadians,d=a.controlsUtils;function f(u,p,m,g,x){g=g||{};var v=this.sizeX||g.cornerSize||x.cornerSize,w=this.sizeY||g.cornerSize||x.cornerSize,_=typeof g.transparentCorners<"u"?g.transparentCorners:x.transparentCorners,b=_?"stroke":"fill",k=!_&&(g.cornerStrokeColor||x.cornerStrokeColor),S=p,O=m,F;u.save(),u.fillStyle=g.cornerColor||x.cornerColor,u.strokeStyle=g.cornerStrokeColor||x.cornerStrokeColor,v>w?(F=v,u.scale(1,w/v),O=m*v/w):w>v?(F=w,u.scale(v/w,1),S=p*w/v):F=v,u.lineWidth=1,u.beginPath(),u.arc(S,O,F/2,0,2*Math.PI,!1),u[b](),k&&u.stroke(),u.restore()}function h(u,p,m,g,x){g=g||{};var v=this.sizeX||g.cornerSize||x.cornerSize,w=this.sizeY||g.cornerSize||x.cornerSize,_=typeof g.transparentCorners<"u"?g.transparentCorners:x.transparentCorners,b=_?"stroke":"fill",k=!_&&(g.cornerStrokeColor||x.cornerStrokeColor),S=v/2,O=w/2;u.save(),u.fillStyle=g.cornerColor||x.cornerColor,u.strokeStyle=g.cornerStrokeColor||x.cornerStrokeColor,u.lineWidth=1,u.translate(p,m),u.rotate(c(x.angle)),u[b+"Rect"](-S,-O,v,w),k&&u.strokeRect(-S,-O,v,w),u.restore()}d.renderCircleControl=f,d.renderSquareControl=h}(e),function(o){var a=o.fabric||(o.fabric={});function c(d){for(var f in d)this[f]=d[f]}a.Control=c,a.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(d,f){return f.cursorStyle},getActionName:function(d,f){return f.actionName},getVisibility:function(d,f){var h=d._controlsVisibility;return h&&typeof h[f]<"u"?h[f]:this.visible},setVisibility:function(d){this.visible=d},positionHandler:function(d,f){var h=a.util.transformPoint({x:this.x*d.x+this.offsetX,y:this.y*d.y+this.offsetY},f);return h},calcCornerCoords:function(d,f,h,u,p){var m,g,x,v,w=p?this.touchSizeX:this.sizeX,_=p?this.touchSizeY:this.sizeY;if(w&&_&&w!==_){var b=Math.atan2(_,w),k=Math.sqrt(w*w+_*_)/2,S=b-a.util.degreesToRadians(d),O=Math.PI/2-b-a.util.degreesToRadians(d);m=k*a.util.cos(S),g=k*a.util.sin(S),x=k*a.util.cos(O),v=k*a.util.sin(O)}else{var F=w&&_?w:f;k=F*.7071067812;var S=a.util.degreesToRadians(45-d);m=x=k*a.util.cos(S),g=v=k*a.util.sin(S)}return{tl:{x:h-v,y:u-x},tr:{x:h+m,y:u-g},bl:{x:h-m,y:u+g},br:{x:h+v,y:u+x}}},render:function(d,f,h,u,p){switch(u=u||{},u.cornerStyle||p.cornerStyle){case"circle":a.controlsUtils.renderCircleControl.call(this,d,f,h,u,p);break;default:a.controlsUtils.renderSquareControl.call(this,d,f,h,u,p)}}}}(e),function(){function o(h,u){var p=h.getAttribute("style"),m=h.getAttribute("offset")||0,g,x,v,w;if(m=parseFloat(m)/(/%$/.test(m)?100:1),m=m<0?0:m>1?1:m,p){var _=p.split(/\s*;\s*/);for(_[_.length-1]===""&&_.pop(),w=_.length;w--;){var b=_[w].split(/\s*:\s*/),k=b[0].trim(),S=b[1].trim();k==="stop-color"?g=S:k==="stop-opacity"&&(v=S)}}return g||(g=h.getAttribute("stop-color")||"rgb(0,0,0)"),v||(v=h.getAttribute("stop-opacity")),g=new t.Color(g),x=g.getAlpha(),v=isNaN(parseFloat(v))?1:parseFloat(v),v*=x*u,{offset:m,color:g.toRgb(),opacity:v}}function a(h){return{x1:h.getAttribute("x1")||0,y1:h.getAttribute("y1")||0,x2:h.getAttribute("x2")||"100%",y2:h.getAttribute("y2")||0}}function c(h){return{x1:h.getAttribute("fx")||h.getAttribute("cx")||"50%",y1:h.getAttribute("fy")||h.getAttribute("cy")||"50%",r1:0,x2:h.getAttribute("cx")||"50%",y2:h.getAttribute("cy")||"50%",r2:h.getAttribute("r")||"50%"}}var d=t.util.object.clone;t.Gradient=t.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(h){h||(h={}),h.coords||(h.coords={});var u,p=this;Object.keys(h).forEach(function(m){p[m]=h[m]}),this.id?this.id+="_"+t.Object.__uid++:this.id=t.Object.__uid++,u={x1:h.coords.x1||0,y1:h.coords.y1||0,x2:h.coords.x2||0,y2:h.coords.y2||0},this.type==="radial"&&(u.r1=h.coords.r1||0,u.r2=h.coords.r2||0),this.coords=u,this.colorStops=h.colorStops.slice()},addColorStop:function(h){for(var u in h){var p=new t.Color(h[u]);this.colorStops.push({offset:parseFloat(u),color:p.toRgb(),opacity:p.getAlpha()})}return this},toObject:function(h){var u={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return t.util.populateWithProperties(this,u,h),u},toSVG:function(h,x){var p=d(this.coords,!0),m,g,x=x||{},v,w,_=d(this.colorStops,!0),b=p.r1>p.r2,k=this.gradientTransform?this.gradientTransform.concat():t.iMatrix.concat(),S=-this.offsetX,O=-this.offsetY,F=!!x.additionalTransform,D=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(_.sort(function(Q,K){return Q.offset-K.offset}),D==="objectBoundingBox"?(S/=h.width,O/=h.height):(S+=h.width/2,O+=h.height/2),h.type==="path"&&this.gradientUnits!=="percentage"&&(S-=h.pathOffset.x,O-=h.pathOffset.y),k[4]-=S,k[5]-=O,w='id="SVGID_'+this.id+'" gradientUnits="'+D+'"',w+=' gradientTransform="'+(F?x.additionalTransform+" ":"")+t.util.matrixToSVG(k)+'" ',this.type==="linear"?v=["<linearGradient ",w,' x1="',p.x1,'" y1="',p.y1,'" x2="',p.x2,'" y2="',p.y2,`">
`]:this.type==="radial"&&(v=["<radialGradient ",w,' cx="',b?p.x1:p.x2,'" cy="',b?p.y1:p.y2,'" r="',b?p.r1:p.r2,'" fx="',b?p.x2:p.x1,'" fy="',b?p.y2:p.y1,`">
`]),this.type==="radial"){if(b)for(_=_.concat(),_.reverse(),m=0,g=_.length;m<g;m++)_[m].offset=1-_[m].offset;var U=Math.min(p.r1,p.r2);if(U>0){var M=Math.max(p.r1,p.r2),q=U/M;for(m=0,g=_.length;m<g;m++)_[m].offset+=q*(1-_[m].offset)}}for(m=0,g=_.length;m<g;m++){var G=_[m];v.push("<stop ",'offset="',G.offset*100+"%",'" style="stop-color:',G.color,typeof G.opacity<"u"?";stop-opacity: "+G.opacity:";",`"/>
`)}return v.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),v.join("")},toLive:function(h){var u,p=t.util.object.clone(this.coords),m,g;if(this.type){for(this.type==="linear"?u=h.createLinearGradient(p.x1,p.y1,p.x2,p.y2):this.type==="radial"&&(u=h.createRadialGradient(p.x1,p.y1,p.r1,p.x2,p.y2,p.r2)),m=0,g=this.colorStops.length;m<g;m++){var x=this.colorStops[m].color,v=this.colorStops[m].opacity,w=this.colorStops[m].offset;typeof v<"u"&&(x=new t.Color(x).setAlpha(v).toRgba()),u.addColorStop(w,x)}return u}}}),t.util.object.extend(t.Gradient,{fromElement:function(h,u,p,m){var g=parseFloat(p)/(/%$/.test(p)?100:1);g=g<0?0:g>1?1:g,isNaN(g)&&(g=1);var x=h.getElementsByTagName("stop"),v,w=h.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",_=h.getAttribute("gradientTransform")||"",b=[],k,S,O=0,F=0,D;for(h.nodeName==="linearGradient"||h.nodeName==="LINEARGRADIENT"?(v="linear",k=a(h)):(v="radial",k=c(h)),S=x.length;S--;)b.push(o(x[S],g));D=t.parseTransformAttribute(_),f(u,k,m,w),w==="pixels"&&(O=-u.left,F=-u.top);var U=new t.Gradient({id:h.getAttribute("id"),type:v,coords:k,colorStops:b,gradientUnits:w,gradientTransform:D,offsetX:O,offsetY:F});return U}});function f(h,u,p,m){var g,x;Object.keys(u).forEach(function(v){g=u[v],g==="Infinity"?x=1:g==="-Infinity"?x=0:(x=parseFloat(u[v],10),typeof g=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(g)&&(x*=.01,m==="pixels"&&((v==="x1"||v==="x2"||v==="r2")&&(x*=p.viewBoxWidth||p.width),(v==="y1"||v==="y2")&&(x*=p.viewBoxHeight||p.height)))),u[v]=x})}}(),function(){var o=t.util.toFixed;t.Pattern=t.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(a,c){if(a||(a={}),this.id=t.Object.__uid++,this.setOptions(a),!a.source||a.source&&typeof a.source!="string"){c&&c(this);return}else{var d=this;this.source=t.util.createImage(),t.util.loadImage(a.source,function(f,h){d.source=f,c&&c(d,h)},null,this.crossOrigin)}},toObject:function(a){var c=t.Object.NUM_FRACTION_DIGITS,d,f;return typeof this.source.src=="string"?d=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(d=this.source.toDataURL()),f={type:"pattern",source:d,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:o(this.offsetX,c),offsetY:o(this.offsetY,c),patternTransform:this.patternTransform?this.patternTransform.concat():null},t.util.populateWithProperties(this,f,a),f},toSVG:function(a){var c=typeof this.source=="function"?this.source():this.source,d=c.width/a.width,f=c.height/a.height,h=this.offsetX/a.width,u=this.offsetY/a.height,p="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(f=1,u&&(f+=Math.abs(u))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(d=1,h&&(d+=Math.abs(h))),c.src?p=c.src:c.toDataURL&&(p=c.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+h+'" y="'+u+'" width="'+d+'" height="'+f+`">
<image x="0" y="0" width="`+c.width+'" height="'+c.height+'" xlink:href="'+p+`"></image>
</pattern>
`},setOptions:function(a){for(var c in a)this[c]=a[c]},toLive:function(a){var c=this.source;return!c||typeof c.src<"u"&&(!c.complete||c.naturalWidth===0||c.naturalHeight===0)?"":a.createPattern(c,this.repeat)}})}(),function(o){var a=o.fabric||(o.fabric={}),c=a.util.toFixed;if(a.Shadow){a.warn("fabric.Shadow is already defined.");return}a.Shadow=a.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(d){typeof d=="string"&&(d=this._parseShadow(d));for(var f in d)this[f]=d[f];this.id=a.Object.__uid++},_parseShadow:function(d){var f=d.trim(),h=a.Shadow.reOffsetsAndBlur.exec(f)||[],u=f.replace(a.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:u.trim(),offsetX:parseFloat(h[1],10)||0,offsetY:parseFloat(h[2],10)||0,blur:parseFloat(h[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(d){var f=40,h=40,u=a.Object.NUM_FRACTION_DIGITS,p=a.util.rotateVector({x:this.offsetX,y:this.offsetY},a.util.degreesToRadians(-d.angle)),m=20,g=new a.Color(this.color);return d.width&&d.height&&(f=c((Math.abs(p.x)+this.blur)/d.width,u)*100+m,h=c((Math.abs(p.y)+this.blur)/d.height,u)*100+m),d.flipX&&(p.x*=-1),d.flipY&&(p.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+h+'%" height="'+(100+2*h)+'%" x="-'+f+'%" width="'+(100+2*f)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+c(this.blur?this.blur/2:0,u)+`"></feGaussianBlur>
	<feOffset dx="`+c(p.x,u)+'" dy="'+c(p.y,u)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+g.toRgb()+'" flood-opacity="'+g.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var d={},f=a.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(h){this[h]!==f[h]&&(d[h]=this[h])},this),d}}),a.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(e),function(){if(t.StaticCanvas){t.warn("fabric.StaticCanvas is already defined.");return}var o=t.util.object.extend,a=t.util.getElementOffset,c=t.util.removeFromArray,d=t.util.toFixed,f=t.util.transformPoint,h=t.util.invertTransform,u=t.util.getNodeCanvas,p=t.util.createCanvasElement,m=new Error("Could not initialize `canvas` element");t.StaticCanvas=t.util.createClass(t.CommonMethods,{initialize:function(g,x){x||(x={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(g,x)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:t.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(g,x){var v=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(g),this._initOptions(x),this.interactive||this._initRetinaScaling(),x.overlayImage&&this.setOverlayImage(x.overlayImage,v),x.backgroundImage&&this.setBackgroundImage(x.backgroundImage,v),x.backgroundColor&&this.setBackgroundColor(x.backgroundColor,v),x.overlayColor&&this.setOverlayColor(x.overlayColor,v),this.calcOffset()},_isRetinaScaling:function(){return t.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,t.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var g=t.devicePixelRatio;this.__initRetinaScaling(g,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(g,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(g,x,v){x.setAttribute("width",this.width*g),x.setAttribute("height",this.height*g),v.scale(g,g)},calcOffset:function(){return this._offset=a(this.lowerCanvasEl),this},setOverlayImage:function(g,x,v){return this.__setBgOverlayImage("overlayImage",g,x,v)},setBackgroundImage:function(g,x,v){return this.__setBgOverlayImage("backgroundImage",g,x,v)},setOverlayColor:function(g,x){return this.__setBgOverlayColor("overlayColor",g,x)},setBackgroundColor:function(g,x){return this.__setBgOverlayColor("backgroundColor",g,x)},__setBgOverlayImage:function(g,x,v,w){return typeof x=="string"?t.util.loadImage(x,function(_,b){if(_){var k=new t.Image(_,w);this[g]=k,k.canvas=this}v&&v(_,b)},this,w&&w.crossOrigin):(w&&x.setOptions(w),this[g]=x,x&&(x.canvas=this),v&&v(x,!1)),this},__setBgOverlayColor:function(g,x,v){return this[g]=x,this._initGradient(x,g),this._initPattern(x,g,v),this},_createCanvasElement:function(){var g=p();if(!g||(g.style||(g.style={}),typeof g.getContext>"u"))throw m;return g},_initOptions:function(g){var x=this.lowerCanvasEl;this._setOptions(g),this.width=this.width||parseInt(x.width,10)||0,this.height=this.height||parseInt(x.height,10)||0,this.lowerCanvasEl.style&&(x.width=this.width,x.height=this.height,x.style.width=this.width+"px",x.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(g){g&&g.getContext?this.lowerCanvasEl=g:this.lowerCanvasEl=t.util.getById(g)||this._createCanvasElement(),t.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(g,x){return this.setDimensions({width:g},x)},setHeight:function(g,x){return this.setDimensions({height:g},x)},setDimensions:function(g,x){var v;x=x||{};for(var w in g)v=g[w],x.cssOnly||(this._setBackstoreDimension(w,g[w]),v+="px",this.hasLostContext=!0),x.backstoreOnly||this._setCssDimension(w,v);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),x.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(g,x){return this.lowerCanvasEl[g]=x,this.upperCanvasEl&&(this.upperCanvasEl[g]=x),this.cacheCanvasEl&&(this.cacheCanvasEl[g]=x),this[g]=x,this},_setCssDimension:function(g,x){return this.lowerCanvasEl.style[g]=x,this.upperCanvasEl&&(this.upperCanvasEl.style[g]=x),this.wrapperEl&&(this.wrapperEl.style[g]=x),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(g){var x=this._activeObject,v=this.backgroundImage,w=this.overlayImage,_,b,k;for(this.viewportTransform=g,b=0,k=this._objects.length;b<k;b++)_=this._objects[b],_.group||_.setCoords(!0);return x&&x.setCoords(),v&&v.setCoords(!0),w&&w.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(g,x){var v=g,w=this.viewportTransform.slice(0);g=f(g,h(this.viewportTransform)),w[0]=x,w[3]=x;var _=f(g,w);return w[4]+=v.x-_.x,w[5]+=v.y-_.y,this.setViewportTransform(w)},setZoom:function(g){return this.zoomToPoint(new t.Point(0,0),g),this},absolutePan:function(g){var x=this.viewportTransform.slice(0);return x[4]=-g.x,x[5]=-g.y,this.setViewportTransform(x)},relativePan:function(g){return this.absolutePan(new t.Point(-g.x-this.viewportTransform[4],-g.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(g){this.stateful&&g.setupState(),g._set("canvas",this),g.setCoords(),this.fire("object:added",{target:g}),g.fire("added")},_onObjectRemoved:function(g){this.fire("object:removed",{target:g}),g.fire("removed"),delete g.canvas},clearContext:function(g){return g.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var g=this.contextContainer;return this.renderCanvas(g,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=t.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var g={},x=this.width,v=this.height,w=h(this.viewportTransform);return g.tl=f({x:0,y:0},w),g.br=f({x,y:v},w),g.tr=new t.Point(g.br.x,g.tl.y),g.bl=new t.Point(g.tl.x,g.br.y),this.vptCoords=g,g},cancelRequestedRender:function(){this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(g,x){var v=this.viewportTransform,w=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(g),t.util.setImageSmoothing(g,this.imageSmoothingEnabled),this.fire("before:render",{ctx:g}),this._renderBackground(g),g.save(),g.transform(v[0],v[1],v[2],v[3],v[4],v[5]),this._renderObjects(g,x),g.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(g),w&&(w.canvas=this,w.shouldCache(),w._transformDone=!0,w.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(g)),this._renderOverlay(g),this.controlsAboveOverlay&&this.interactive&&this.drawControls(g),this.fire("after:render",{ctx:g})},drawClipPathOnCanvas:function(g){var x=this.viewportTransform,v=this.clipPath;g.save(),g.transform(x[0],x[1],x[2],x[3],x[4],x[5]),g.globalCompositeOperation="destination-in",v.transform(g),g.scale(1/v.zoomX,1/v.zoomY),g.drawImage(v._cacheCanvas,-v.cacheTranslationX,-v.cacheTranslationY),g.restore()},_renderObjects:function(g,x){var v,w;for(v=0,w=x.length;v<w;++v)x[v]&&x[v].render(g)},_renderBackgroundOrOverlay:function(g,x){var v=this[x+"Color"],w=this[x+"Image"],_=this.viewportTransform,b=this[x+"Vpt"];if(!(!v&&!w)){if(v){g.save(),g.beginPath(),g.moveTo(0,0),g.lineTo(this.width,0),g.lineTo(this.width,this.height),g.lineTo(0,this.height),g.closePath(),g.fillStyle=v.toLive?v.toLive(g,this):v,b&&g.transform(_[0],_[1],_[2],_[3],_[4],_[5]),g.transform(1,0,0,1,v.offsetX||0,v.offsetY||0);var k=v.gradientTransform||v.patternTransform;k&&g.transform(k[0],k[1],k[2],k[3],k[4],k[5]),g.fill(),g.restore()}if(w){g.save();var S=this.skipOffscreen;this.skipOffscreen=b,b&&g.transform(_[0],_[1],_[2],_[3],_[4],_[5]),w.render(g),this.skipOffscreen=S,g.restore()}}},_renderBackground:function(g){this._renderBackgroundOrOverlay(g,"background")},_renderOverlay:function(g){this._renderBackgroundOrOverlay(g,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new t.Point(this.width/2,this.height/2)},centerObjectH:function(g){return this._centerObject(g,new t.Point(this.getCenterPoint().x,g.getCenterPoint().y))},centerObjectV:function(g){return this._centerObject(g,new t.Point(g.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(g){var x=this.getCenterPoint();return this._centerObject(g,x)},viewportCenterObject:function(g){var x=this.getVpCenter();return this._centerObject(g,x)},viewportCenterObjectH:function(g){var x=this.getVpCenter();return this._centerObject(g,new t.Point(x.x,g.getCenterPoint().y)),this},viewportCenterObjectV:function(g){var x=this.getVpCenter();return this._centerObject(g,new t.Point(g.getCenterPoint().x,x.y))},getVpCenter:function(){var g=this.getCenterPoint(),x=h(this.viewportTransform);return f(g,x)},_centerObject:function(g,x){return g.setPositionByOrigin(x,"center","center"),g.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(g){return this.toDatalessObject(g)},toObject:function(g){return this._toObjectMethod("toObject",g)},toDatalessObject:function(g){return this._toObjectMethod("toDatalessObject",g)},_toObjectMethod:function(g,x){var v=this.clipPath,w={version:t.version,objects:this._toObjects(g,x)};return v&&!v.excludeFromExport&&(w.clipPath=this._toObject(this.clipPath,g,x)),o(w,this.__serializeBgOverlay(g,x)),t.util.populateWithProperties(this,w,x),w},_toObjects:function(g,x){return this._objects.filter(function(v){return!v.excludeFromExport}).map(function(v){return this._toObject(v,g,x)},this)},_toObject:function(g,x,v){var w;this.includeDefaultValues||(w=g.includeDefaultValues,g.includeDefaultValues=!1);var _=g[x](v);return this.includeDefaultValues||(g.includeDefaultValues=w),_},__serializeBgOverlay:function(g,x){var v={},w=this.backgroundImage,_=this.overlayImage,b=this.backgroundColor,k=this.overlayColor;return b&&b.toObject?b.excludeFromExport||(v.background=b.toObject(x)):b&&(v.background=b),k&&k.toObject?k.excludeFromExport||(v.overlay=k.toObject(x)):k&&(v.overlay=k),w&&!w.excludeFromExport&&(v.backgroundImage=this._toObject(w,g,x)),_&&!_.excludeFromExport&&(v.overlayImage=this._toObject(_,g,x)),v},svgViewportTransformation:!0,toSVG:function(g,x){g||(g={}),g.reviver=x;var v=[];return this._setSVGPreamble(v,g),this._setSVGHeader(v,g),this.clipPath&&v.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(v,"background"),this._setSVGBgOverlayImage(v,"backgroundImage",x),this._setSVGObjects(v,x),this.clipPath&&v.push(`</g>
`),this._setSVGBgOverlayColor(v,"overlay"),this._setSVGBgOverlayImage(v,"overlayImage",x),v.push("</svg>"),v.join("")},_setSVGPreamble:function(g,x){x.suppressPreamble||g.push('<?xml version="1.0" encoding="',x.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(g,x){var v=x.width||this.width,w=x.height||this.height,_,b='viewBox="0 0 '+this.width+" "+this.height+'" ',k=t.Object.NUM_FRACTION_DIGITS;x.viewBox?b='viewBox="'+x.viewBox.x+" "+x.viewBox.y+" "+x.viewBox.width+" "+x.viewBox.height+'" ':this.svgViewportTransformation&&(_=this.viewportTransform,b='viewBox="'+d(-_[4]/_[0],k)+" "+d(-_[5]/_[3],k)+" "+d(this.width/_[0],k)+" "+d(this.height/_[3],k)+'" '),g.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',v,'" ','height="',w,'" ',b,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",t.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(x),`</defs>
`)},createSVGClipPathMarkup:function(g){var x=this.clipPath;return x?(x.clipPathId="CLIPPATH_"+t.Object.__uid++,'<clipPath id="'+x.clipPathId+`" >
`+this.clipPath.toClipPathSVG(g.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var g=this,x=["background","overlay"].map(function(v){var w=g[v+"Color"];if(w&&w.toLive){var _=g[v+"Vpt"],b=g.viewportTransform,k={width:g.width/(_?b[0]:1),height:g.height/(_?b[3]:1)};return w.toSVG(k,{additionalTransform:_?t.util.matrixToSVG(b):""})}});return x.join("")},createSVGFontFacesMarkup:function(){var g="",x={},v,w,_,b,k,S,O,F,D,U=t.fontPaths,M=[];for(this._objects.forEach(function G(Q){M.push(Q),Q._objects&&Q._objects.forEach(G)}),F=0,D=M.length;F<D;F++)if(v=M[F],w=v.fontFamily,!(v.type.indexOf("text")===-1||x[w]||!U[w])&&(x[w]=!0,!!v.styles)){_=v.styles;for(k in _){b=_[k];for(O in b)S=b[O],w=S.fontFamily,!x[w]&&U[w]&&(x[w]=!0)}}for(var q in x)g+=[`		@font-face {
`,"			font-family: '",q,`';
`,"			src: url('",U[q],`');
`,`		}
`].join("");return g&&(g=['	<style type="text/css">',`<![CDATA[
`,g,"]]>",`</style>
`].join("")),g},_setSVGObjects:function(g,x){var v,w,_,b=this._objects;for(w=0,_=b.length;w<_;w++)v=b[w],!v.excludeFromExport&&this._setSVGObject(g,v,x)},_setSVGObject:function(g,x,v){g.push(x.toSVG(v))},_setSVGBgOverlayImage:function(g,x,v){this[x]&&!this[x].excludeFromExport&&this[x].toSVG&&g.push(this[x].toSVG(v))},_setSVGBgOverlayColor:function(g,x){var v=this[x+"Color"],w=this.viewportTransform,_=this.width,b=this.height;if(v)if(v.toLive){var k=v.repeat,S=t.util.invertTransform(w),O=this[x+"Vpt"],F=O?t.util.matrixToSVG(S):"";g.push('<rect transform="'+F+" translate(",_/2,",",b/2,')"',' x="',v.offsetX-_/2,'" y="',v.offsetY-b/2,'" ','width="',k==="repeat-y"||k==="no-repeat"?v.source.width:_,'" height="',k==="repeat-x"||k==="no-repeat"?v.source.height:b,'" fill="url(#SVGID_'+v.id+')"',`></rect>
`)}else g.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',v,'"',`></rect>
`)},sendToBack:function(g){if(!g)return this;var x=this._activeObject,v,w,_;if(g===x&&g.type==="activeSelection")for(_=x._objects,v=_.length;v--;)w=_[v],c(this._objects,w),this._objects.unshift(w);else c(this._objects,g),this._objects.unshift(g);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(g){if(!g)return this;var x=this._activeObject,v,w,_;if(g===x&&g.type==="activeSelection")for(_=x._objects,v=0;v<_.length;v++)w=_[v],c(this._objects,w),this._objects.push(w);else c(this._objects,g),this._objects.push(g);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(g,x){if(!g)return this;var v=this._activeObject,w,_,b,k,S,O=0;if(g===v&&g.type==="activeSelection")for(S=v._objects,w=0;w<S.length;w++)_=S[w],b=this._objects.indexOf(_),b>0+O&&(k=b-1,c(this._objects,_),this._objects.splice(k,0,_)),O++;else b=this._objects.indexOf(g),b!==0&&(k=this._findNewLowerIndex(g,b,x),c(this._objects,g),this._objects.splice(k,0,g));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(g,x,v){var w,_;if(v)for(w=x,_=x-1;_>=0;--_){var b=g.intersectsWithObject(this._objects[_])||g.isContainedWithinObject(this._objects[_])||this._objects[_].isContainedWithinObject(g);if(b){w=_;break}}else w=x-1;return w},bringForward:function(g,x){if(!g)return this;var v=this._activeObject,w,_,b,k,S,O=0;if(g===v&&g.type==="activeSelection")for(S=v._objects,w=S.length;w--;)_=S[w],b=this._objects.indexOf(_),b<this._objects.length-1-O&&(k=b+1,c(this._objects,_),this._objects.splice(k,0,_)),O++;else b=this._objects.indexOf(g),b!==this._objects.length-1&&(k=this._findNewUpperIndex(g,b,x),c(this._objects,g),this._objects.splice(k,0,g));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(g,x,v){var w,_,b;if(v)for(w=x,_=x+1,b=this._objects.length;_<b;++_){var k=g.intersectsWithObject(this._objects[_])||g.isContainedWithinObject(this._objects[_])||this._objects[_].isContainedWithinObject(g);if(k){w=_;break}}else w=x+1;return w},moveTo:function(g,x){return c(this._objects,g),this._objects.splice(x,0,g),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(g){g.dispose&&g.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),t.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),t.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),o(t.StaticCanvas.prototype,t.Observable),o(t.StaticCanvas.prototype,t.Collection),o(t.StaticCanvas.prototype,t.DataURLExporter),o(t.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(g){var x=p();if(!x||!x.getContext)return null;var v=x.getContext("2d");if(!v)return null;switch(g){case"setLineDash":return typeof v.setLineDash<"u";default:return null}}}),t.StaticCanvas.prototype.toJSON=t.StaticCanvas.prototype.toObject,t.isLikelyNode&&(t.StaticCanvas.prototype.createPNGStream=function(){var g=u(this.lowerCanvasEl);return g&&g.createPNGStream()},t.StaticCanvas.prototype.createJPEGStream=function(g){var x=u(this.lowerCanvasEl);return x&&x.createJPEGStream(g)})}(),t.BaseBrush=t.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(o){o.strokeStyle=this.color,o.lineWidth=this.width,o.lineCap=this.strokeLineCap,o.miterLimit=this.strokeMiterLimit,o.lineJoin=this.strokeLineJoin,o.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(o){var a=this.canvas.viewportTransform;o.save(),o.transform(a[0],a[1],a[2],a[3],a[4],a[5])},_setShadow:function(){if(this.shadow){var o=this.canvas,a=this.shadow,c=o.contextTop,d=o.getZoom();o&&o._isRetinaScaling()&&(d*=t.devicePixelRatio),c.shadowColor=a.color,c.shadowBlur=a.blur*d,c.shadowOffsetX=a.offsetX*d,c.shadowOffsetY=a.offsetY*d}},needsFullRender:function(){var o=new t.Color(this.color);return o.getAlpha()<1||!!this.shadow},_resetShadow:function(){var o=this.canvas.contextTop;o.shadowColor="",o.shadowBlur=o.shadowOffsetX=o.shadowOffsetY=0},_isOutSideCanvas:function(o){return o.x<0||o.x>this.canvas.getWidth()||o.y<0||o.y>this.canvas.getHeight()}}),function(){t.PencilBrush=t.util.createClass(t.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(o){this.canvas=o,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(o,a,c){var d=a.midPointFrom(c);return o.quadraticCurveTo(a.x,a.y,d.x,d.y),d},onMouseDown:function(o,a){this.canvas._isMainEvent(a.e)&&(this.drawStraightLine=a.e[this.straightLineKey],this._prepareForDrawing(o),this._captureDrawingPath(o),this._render())},onMouseMove:function(o,a){if(this.canvas._isMainEvent(a.e)&&(this.drawStraightLine=a.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o))&&this._captureDrawingPath(o)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var c=this._points,d=c.length,f=this.canvas.contextTop;this._saveAndTransform(f),this.oldEnd&&(f.beginPath(),f.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(f,c[d-2],c[d-1],!0),f.stroke(),f.restore()}},onMouseUp:function(o){return this.canvas._isMainEvent(o.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(o){var a=new t.Point(o.x,o.y);this._reset(),this._addPoint(a),this.canvas.contextTop.moveTo(a.x,a.y)},_addPoint:function(o){return this._points.length>1&&o.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(o),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(o){var a=new t.Point(o.x,o.y);return this._addPoint(a)},_render:function(o){var a,c,d=this._points[0],f=this._points[1];if(o=o||this.canvas.contextTop,this._saveAndTransform(o),o.beginPath(),this._points.length===2&&d.x===f.x&&d.y===f.y){var h=this.width/1e3;d=new t.Point(d.x,d.y),f=new t.Point(f.x,f.y),d.x-=h,f.x+=h}for(o.moveTo(d.x,d.y),a=1,c=this._points.length;a<c;a++)this._drawSegment(o,d,f),d=this._points[a],f=this._points[a+1];o.lineTo(d.x,d.y),o.stroke(),o.restore()},convertPointsToSVGPath:function(o){var a=this.width/1e3;return t.util.getSmoothPathFromPoints(o,a)},_isEmptySVGPath:function(o){var a=t.util.joinPath(o);return a==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(o){var a=new t.Path(o,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,a.shadow=new t.Shadow(this.shadow)),a},decimatePoints:function(o,a){if(o.length<=2)return o;var c=this.canvas.getZoom(),d=Math.pow(a/c,2),f,h=o.length-1,u=o[0],p=[u],m;for(f=1;f<h-1;f++)m=Math.pow(u.x-o[f].x,2)+Math.pow(u.y-o[f].y,2),m>=d&&(u=o[f],p.push(u));return p.push(o[h]),p},_finalizeAndAddPath:function(){var o=this.canvas.contextTop;o.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var a=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(a)){this.canvas.requestRenderAll();return}var c=this.createPath(a);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:c}),this.canvas.add(c),this.canvas.requestRenderAll(),c.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:c})}})}(),t.CircleBrush=t.util.createClass(t.BaseBrush,{width:10,initialize:function(o){this.canvas=o,this.points=[]},drawDot:function(o){var a=this.addPoint(o),c=this.canvas.contextTop;this._saveAndTransform(c),this.dot(c,a),c.restore()},dot:function(o,a){o.fillStyle=a.fill,o.beginPath(),o.arc(a.x,a.y,a.radius,0,Math.PI*2,!1),o.closePath(),o.fill()},onMouseDown:function(o){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(o)},_render:function(){var o=this.canvas.contextTop,a,c,d=this.points;for(this._saveAndTransform(o),a=0,c=d.length;a<c;a++)this.dot(o,d[a]);o.restore()},onMouseMove:function(o){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(o),this._render()):this.drawDot(o))},onMouseUp:function(){var o=this.canvas.renderOnAddRemove,a,c;this.canvas.renderOnAddRemove=!1;var d=[];for(a=0,c=this.points.length;a<c;a++){var f=this.points[a],h=new t.Circle({radius:f.radius,left:f.x,top:f.y,originX:"center",originY:"center",fill:f.fill});this.shadow&&(h.shadow=new t.Shadow(this.shadow)),d.push(h)}var u=new t.Group(d);u.canvas=this.canvas,this.canvas.fire("before:path:created",{path:u}),this.canvas.add(u),this.canvas.fire("path:created",{path:u}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=o,this.canvas.requestRenderAll()},addPoint:function(o){var a=new t.Point(o.x,o.y),c=t.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,d=new t.Color(this.color).setAlpha(t.util.getRandomInt(0,100)/100).toRgba();return a.radius=c,a.fill=d,this.points.push(a),a}}),t.SprayBrush=t.util.createClass(t.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(o){this.canvas=o,this.sprayChunks=[]},onMouseDown:function(o){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(o),this.render(this.sprayChunkPoints)},onMouseMove:function(o){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o)||(this.addSprayChunk(o),this.render(this.sprayChunkPoints))},onMouseUp:function(){var o=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var a=[],c=0,d=this.sprayChunks.length;c<d;c++)for(var f=this.sprayChunks[c],h=0,u=f.length;h<u;h++){var p=new t.Rect({width:f[h].width,height:f[h].width,left:f[h].x+1,top:f[h].y+1,originX:"center",originY:"center",fill:this.color});a.push(p)}this.optimizeOverlapping&&(a=this._getOptimizedRects(a));var m=new t.Group(a);this.shadow&&m.set("shadow",new t.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:m}),this.canvas.add(m),this.canvas.fire("path:created",{path:m}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=o,this.canvas.requestRenderAll()},_getOptimizedRects:function(o){var a={},c,d,f;for(d=0,f=o.length;d<f;d++)c=o[d].left+""+o[d].top,a[c]||(a[c]=o[d]);var h=[];for(c in a)h.push(a[c]);return h},render:function(o){var a=this.canvas.contextTop,c,d;for(a.fillStyle=this.color,this._saveAndTransform(a),c=0,d=o.length;c<d;c++){var f=o[c];typeof f.opacity<"u"&&(a.globalAlpha=f.opacity),a.fillRect(f.x,f.y,f.width,f.width)}a.restore()},_render:function(){var o=this.canvas.contextTop,a,c;for(o.fillStyle=this.color,this._saveAndTransform(o),a=0,c=this.sprayChunks.length;a<c;a++)this.render(this.sprayChunks[a]);o.restore()},addSprayChunk:function(o){this.sprayChunkPoints=[];var a,c,d,f=this.width/2,h;for(h=0;h<this.density;h++){a=t.util.getRandomInt(o.x-f,o.x+f),c=t.util.getRandomInt(o.y-f,o.y+f),this.dotWidthVariance?d=t.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):d=this.dotWidth;var u=new t.Point(a,c);u.width=d,this.randomOpacity&&(u.opacity=t.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(u)}this.sprayChunks.push(this.sprayChunkPoints)}}),t.PatternBrush=t.util.createClass(t.PencilBrush,{getPatternSrc:function(){var o=20,a=5,c=t.util.createCanvasElement(),d=c.getContext("2d");return c.width=c.height=o+a,d.fillStyle=this.color,d.beginPath(),d.arc(o/2,o/2,o/2,0,Math.PI*2,!1),d.closePath(),d.fill(),c},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(o){return o.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(o){this.callSuper("_setBrushStyles",o),o.strokeStyle=this.getPattern(o)},createPath:function(o){var a=this.callSuper("createPath",o),c=a._getLeftTopCoords().scalarAdd(a.strokeWidth/2);return a.stroke=new t.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-c.x,offsetY:-c.y}),a}}),function(){var o=t.util.getPointer,a=t.util.degreesToRadians,c=t.util.isTouchEvent;t.Canvas=t.util.createClass(t.StaticCanvas,{initialize:function(f,h){h||(h={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(f,h),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=t.PencilBrush&&new t.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var f=this.getActiveObjects(),h,u,p;if(f.length>0&&!this.preserveObjectStacking){u=[],p=[];for(var m=0,g=this._objects.length;m<g;m++)h=this._objects[m],f.indexOf(h)===-1?u.push(h):p.push(h);f.length>1&&(this._activeObject._objects=p),u.push.apply(u,p)}else u=this._objects;return u},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var f=this.contextContainer;return this.renderCanvas(f,this._chooseObjectsToRender()),this},renderTopLayer:function(f){f.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(f),this.contextTopDirty=!0),f.restore()},renderTop:function(){var f=this.contextTop;return this.clearContext(f),this.renderTopLayer(f),this.fire("after:render"),this},_normalizePointer:function(f,h){var u=f.calcTransformMatrix(),p=t.util.invertTransform(u),m=this.restorePointerVpt(h);return t.util.transformPoint(m,p)},isTargetTransparent:function(f,h,u){if(f.shouldCache()&&f._cacheCanvas&&f!==this._activeObject){var p=this._normalizePointer(f,{x:h,y:u}),m=Math.max(f.cacheTranslationX+p.x*f.zoomX,0),g=Math.max(f.cacheTranslationY+p.y*f.zoomY,0),_=t.util.isTransparent(f._cacheContext,Math.round(m),Math.round(g),this.targetFindTolerance);return _}var x=this.contextCache,v=f.selectionBackgroundColor,w=this.viewportTransform;f.selectionBackgroundColor="",this.clearContext(x),x.save(),x.transform(w[0],w[1],w[2],w[3],w[4],w[5]),f.render(x),x.restore(),f.selectionBackgroundColor=v;var _=t.util.isTransparent(x,h,u,this.targetFindTolerance);return _},_isSelectionKeyPressed:function(f){var h=!1;return Array.isArray(this.selectionKey)?h=!!this.selectionKey.find(function(u){return f[u]===!0}):h=f[this.selectionKey],h},_shouldClearSelection:function(f,h){var u=this.getActiveObjects(),p=this._activeObject;return!h||h&&p&&u.length>1&&u.indexOf(h)===-1&&p!==h&&!this._isSelectionKeyPressed(f)||h&&!h.evented||h&&!h.selectable&&p&&p!==h},_shouldCenterTransform:function(f,h,u){if(f){var p;return h==="scale"||h==="scaleX"||h==="scaleY"||h==="resizing"?p=this.centeredScaling||f.centeredScaling:h==="rotate"&&(p=this.centeredRotation||f.centeredRotation),p?!u:u}},_getOriginFromCorner:function(f,h){var u={x:f.originX,y:f.originY};return h==="ml"||h==="tl"||h==="bl"?u.x="right":(h==="mr"||h==="tr"||h==="br")&&(u.x="left"),h==="tl"||h==="mt"||h==="tr"?u.y="bottom":(h==="bl"||h==="mb"||h==="br")&&(u.y="top"),u},_getActionFromCorner:function(f,h,u,p){if(!h||!f)return"drag";var m=p.controls[h];return m.getActionName(u,m,p)},_setupCurrentTransform:function(f,h,u){if(h){var p=this.getPointer(f),m=h.__corner,g=h.controls[m],x=u&&m?g.getActionHandler(f,h,g):t.controlsUtils.dragHandler,v=this._getActionFromCorner(u,m,f,h),w=this._getOriginFromCorner(h,m),_=f[this.centeredKey],b={target:h,action:v,actionHandler:x,corner:m,scaleX:h.scaleX,scaleY:h.scaleY,skewX:h.skewX,skewY:h.skewY,offsetX:p.x-h.left,offsetY:p.y-h.top,originX:w.x,originY:w.y,ex:p.x,ey:p.y,lastX:p.x,lastY:p.y,theta:a(h.angle),width:h.width*h.scaleX,shiftKey:f.shiftKey,altKey:_,original:t.util.saveObjectTransform(h)};this._shouldCenterTransform(h,v,_)&&(b.originX="center",b.originY="center"),b.original.originX=w.x,b.original.originY=w.y,this._currentTransform=b,this._beforeTransform(f)}},setCursor:function(f){this.upperCanvasEl.style.cursor=f},_drawSelection:function(f){var h=this._groupSelector,u=new t.Point(h.ex,h.ey),p=t.util.transformPoint(u,this.viewportTransform),m=new t.Point(h.ex+h.left,h.ey+h.top),g=t.util.transformPoint(m,this.viewportTransform),x=Math.min(p.x,g.x),v=Math.min(p.y,g.y),w=Math.max(p.x,g.x),_=Math.max(p.y,g.y),b=this.selectionLineWidth/2;this.selectionColor&&(f.fillStyle=this.selectionColor,f.fillRect(x,v,w-x,_-v)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(f.lineWidth=this.selectionLineWidth,f.strokeStyle=this.selectionBorderColor,x+=b,v+=b,w-=b,_-=b,t.Object.prototype._setLineDash.call(this,f,this.selectionDashArray),f.strokeRect(x,v,w-x,_-v))},findTarget:function(f,h){if(!this.skipTargetFind){var u=!0,p=this.getPointer(f,u),m=this._activeObject,g=this.getActiveObjects(),x,v,w=c(f),_=g.length>1&&!h||g.length===1;if(this.targets=[],_&&m._findTargetCorner(p,w)||g.length>1&&!h&&m===this._searchPossibleTargets([m],p))return m;if(g.length===1&&m===this._searchPossibleTargets([m],p))if(this.preserveObjectStacking)x=m,v=this.targets,this.targets=[];else return m;var b=this._searchPossibleTargets(this._objects,p);return f[this.altSelectionKey]&&b&&x&&b!==x&&(b=x,this.targets=v),b}},_checkTarget:function(f,h,u){if(h&&h.visible&&h.evented&&h.containsPoint(f))if((this.perPixelTargetFind||h.perPixelTargetFind)&&!h.isEditing){var p=this.isTargetTransparent(h,u.x,u.y);if(!p)return!0}else return!0},_searchPossibleTargets:function(f,h){for(var u,p=f.length,m;p--;){var g=f[p],x=g.group?this._normalizePointer(g.group,h):h;if(this._checkTarget(x,g,h)){u=f[p],u.subTargetCheck&&u instanceof t.Group&&(m=this._searchPossibleTargets(u._objects,h),m&&this.targets.push(m));break}}return u},restorePointerVpt:function(f){return t.util.transformPoint(f,t.util.invertTransform(this.viewportTransform))},getPointer:function(f,h){if(this._absolutePointer&&!h)return this._absolutePointer;if(this._pointer&&h)return this._pointer;var u=o(f),p=this.upperCanvasEl,m=p.getBoundingClientRect(),g=m.width||0,x=m.height||0,v;(!g||!x)&&("top"in m&&"bottom"in m&&(x=Math.abs(m.top-m.bottom)),"right"in m&&"left"in m&&(g=Math.abs(m.right-m.left))),this.calcOffset(),u.x=u.x-this._offset.left,u.y=u.y-this._offset.top,h||(u=this.restorePointerVpt(u));var w=this.getRetinaScaling();return w!==1&&(u.x/=w,u.y/=w),g===0||x===0?v={width:1,height:1}:v={width:p.width/g,height:p.height/x},{x:u.x*v.width,y:u.y*v.height}},_createUpperCanvas:function(){var f=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),h=this.lowerCanvasEl,u=this.upperCanvasEl;u?u.className="":(u=this._createCanvasElement(),this.upperCanvasEl=u),t.util.addClass(u,"upper-canvas "+f),this.wrapperEl.appendChild(u),this._copyCanvasStyle(h,u),this._applyCanvasStyle(u),this.contextTop=u.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=t.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),t.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),t.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(f){var h=this.width||f.width,u=this.height||f.height;t.util.setStyle(f,{position:"absolute",width:h+"px",height:u+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),f.width=h,f.height=u,t.util.makeElementUnselectable(f)},_copyCanvasStyle:function(f,h){h.style.cssText=f.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var f=this._activeObject;return f?f.type==="activeSelection"&&f._objects?f._objects.slice(0):[f]:[]},_onObjectRemoved:function(f){f===this._activeObject&&(this.fire("before:selection:cleared",{target:f}),this._discardActiveObject(),this.fire("selection:cleared",{target:f}),f.fire("deselected")),f===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",f)},_fireSelectionEvents:function(f,h){var u=!1,p=this.getActiveObjects(),m=[],g=[];f.forEach(function(x){p.indexOf(x)===-1&&(u=!0,x.fire("deselected",{e:h,target:x}),g.push(x))}),p.forEach(function(x){f.indexOf(x)===-1&&(u=!0,x.fire("selected",{e:h,target:x}),m.push(x))}),f.length>0&&p.length>0?u&&this.fire("selection:updated",{e:h,selected:m,deselected:g}):p.length>0?this.fire("selection:created",{e:h,selected:m}):f.length>0&&this.fire("selection:cleared",{e:h,deselected:g})},setActiveObject:function(f,h){var u=this.getActiveObjects();return this._setActiveObject(f,h),this._fireSelectionEvents(u,h),this},_setActiveObject:function(f,h){return this._activeObject===f||!this._discardActiveObject(h,f)||f.onSelect({e:h})?!1:(this._activeObject=f,!0)},_discardActiveObject:function(f,h){var u=this._activeObject;if(u){if(u.onDeselect({e:f,object:h}))return!1;this._activeObject=null}return!0},discardActiveObject:function(f){var h=this.getActiveObjects(),u=this.getActiveObject();return h.length&&this.fire("before:selection:cleared",{target:u,e:f}),this._discardActiveObject(f),this._fireSelectionEvents(h,f),this},dispose:function(){var f=this.wrapperEl;return this.removeListeners(),f.removeChild(this.upperCanvasEl),f.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach((function(h){t.util.cleanUpJsdomNode(this[h]),this[h]=void 0}).bind(this)),f.parentNode&&f.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,t.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(f){var h=this._activeObject;h&&h._renderControls(f)},_toObject:function(f,h,u){var p=this._realizeGroupTransformOnObject(f),m=this.callSuper("_toObject",f,h,u);return this._unwindGroupTransformOnObject(f,p),m},_realizeGroupTransformOnObject:function(f){if(f.group&&f.group.type==="activeSelection"&&this._activeObject===f.group){var h=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],u={};return h.forEach(function(p){u[p]=f[p]}),t.util.addTransformToObject(f,this._activeObject.calcOwnMatrix()),u}else return null},_unwindGroupTransformOnObject:function(f,h){h&&f.set(h)},_setSVGObject:function(f,h,u){var p=this._realizeGroupTransformOnObject(h);this.callSuper("_setSVGObject",f,h,u),this._unwindGroupTransformOnObject(h,p)},setViewportTransform:function(f){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),t.StaticCanvas.prototype.setViewportTransform.call(this,f)}});for(var d in t.StaticCanvas)d!=="prototype"&&(t.Canvas[d]=t.StaticCanvas[d])}(),function(){var o=t.util.addListener,a=t.util.removeListener,c=3,d=2,f=1,h={passive:!1};function u(p,m){return p.button&&p.button===m-1}t.util.object.extend(t.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(o,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(p,m){var g=this.upperCanvasEl,x=this._getEventPrefix();p(t.window,"resize",this._onResize),p(g,x+"down",this._onMouseDown),p(g,x+"move",this._onMouseMove,h),p(g,x+"out",this._onMouseOut),p(g,x+"enter",this._onMouseEnter),p(g,"wheel",this._onMouseWheel),p(g,"contextmenu",this._onContextMenu),p(g,"dblclick",this._onDoubleClick),p(g,"dragover",this._onDragOver),p(g,"dragenter",this._onDragEnter),p(g,"dragleave",this._onDragLeave),p(g,"drop",this._onDrop),this.enablePointerEvents||p(g,"touchstart",this._onTouchStart,h),typeof eventjs<"u"&&m in eventjs&&(eventjs[m](g,"gesture",this._onGesture),eventjs[m](g,"drag",this._onDrag),eventjs[m](g,"orientation",this._onOrientationChange),eventjs[m](g,"shake",this._onShake),eventjs[m](g,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(a,"remove");var p=this._getEventPrefix();a(t.document,p+"up",this._onMouseUp),a(t.document,"touchend",this._onTouchEnd,h),a(t.document,p+"move",this._onMouseMove,h),a(t.document,"touchmove",this._onMouseMove,h)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(p,m){this.__onTransformGesture&&this.__onTransformGesture(p,m)},_onDrag:function(p,m){this.__onDrag&&this.__onDrag(p,m)},_onMouseWheel:function(p){this.__onMouseWheel(p)},_onMouseOut:function(p){var m=this._hoveredTarget;this.fire("mouse:out",{target:m,e:p}),this._hoveredTarget=null,m&&m.fire("mouseout",{e:p});var g=this;this._hoveredTargets.forEach(function(x){g.fire("mouse:out",{target:x,e:p}),x&&x.fire("mouseout",{e:p})}),this._hoveredTargets=[]},_onMouseEnter:function(p){!this._currentTransform&&!this.findTarget(p)&&(this.fire("mouse:over",{target:null,e:p}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(p,m){this.__onOrientationChange&&this.__onOrientationChange(p,m)},_onShake:function(p,m){this.__onShake&&this.__onShake(p,m)},_onLongPress:function(p,m){this.__onLongPress&&this.__onLongPress(p,m)},_onDragOver:function(p){p.preventDefault();var m=this._simpleEventHandler("dragover",p);this._fireEnterLeaveEvents(m,p)},_onDrop:function(p){return this._simpleEventHandler("drop:before",p),this._simpleEventHandler("drop",p)},_onContextMenu:function(p){return this.stopContextMenu&&(p.stopPropagation(),p.preventDefault()),!1},_onDoubleClick:function(p){this._cacheTransformEventData(p),this._handleEvent(p,"dblclick"),this._resetTransformEventData(p)},getPointerId:function(p){var m=p.changedTouches;return m?m[0]&&m[0].identifier:this.enablePointerEvents?p.pointerId:-1},_isMainEvent:function(p){return p.isPrimary===!0?!0:p.isPrimary===!1?!1:p.type==="touchend"&&p.touches.length===0?!0:p.changedTouches?p.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(p){p.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(p)),this.__onMouseDown(p),this._resetTransformEventData();var m=this.upperCanvasEl,g=this._getEventPrefix();o(t.document,"touchend",this._onTouchEnd,h),o(t.document,"touchmove",this._onMouseMove,h),a(m,g+"down",this._onMouseDown)},_onMouseDown:function(p){this.__onMouseDown(p),this._resetTransformEventData();var m=this.upperCanvasEl,g=this._getEventPrefix();a(m,g+"move",this._onMouseMove,h),o(t.document,g+"up",this._onMouseUp),o(t.document,g+"move",this._onMouseMove,h)},_onTouchEnd:function(p){if(!(p.touches.length>0)){this.__onMouseUp(p),this._resetTransformEventData(),this.mainTouchId=null;var m=this._getEventPrefix();a(t.document,"touchend",this._onTouchEnd,h),a(t.document,"touchmove",this._onMouseMove,h);var g=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){o(g.upperCanvasEl,m+"down",g._onMouseDown),g._willAddMouseDown=0},400)}},_onMouseUp:function(p){this.__onMouseUp(p),this._resetTransformEventData();var m=this.upperCanvasEl,g=this._getEventPrefix();this._isMainEvent(p)&&(a(t.document,g+"up",this._onMouseUp),a(t.document,g+"move",this._onMouseMove,h),o(m,g+"move",this._onMouseMove,h))},_onMouseMove:function(p){!this.allowTouchScrolling&&p.preventDefault&&p.preventDefault(),this.__onMouseMove(p)},_onResize:function(){this.calcOffset()},_shouldRender:function(p){var m=this._activeObject;return!!m!=!!p||m&&p&&m!==p?!0:(m&&m.isEditing,!1)},__onMouseUp:function(p){var m,g=this._currentTransform,x=this._groupSelector,v=!1,w=!x||x.left===0&&x.top===0;if(this._cacheTransformEventData(p),m=this._target,this._handleEvent(p,"up:before"),u(p,c)){this.fireRightClick&&this._handleEvent(p,"up",c,w);return}if(u(p,d)){this.fireMiddleClick&&this._handleEvent(p,"up",d,w),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(p);return}if(this._isMainEvent(p)){if(g&&(this._finalizeCurrentTransform(p),v=g.actionPerformed),!w){var _=m===this._activeObject;this._maybeGroupObjects(p),v||(v=this._shouldRender(m)||!_&&m===this._activeObject)}var b,k;if(m){if(b=m._findTargetCorner(this.getPointer(p,!0),t.util.isTouchEvent(p)),m.selectable&&m!==this._activeObject&&m.activeOn==="up")this.setActiveObject(m,p),v=!0;else{var S=m.controls[b],O=S&&S.getMouseUpHandler(p,m,S);O&&(k=this.getPointer(p),O(p,g,k.x,k.y))}m.isMoving=!1}if(g&&(g.target!==m||g.corner!==b)){var F=g.target&&g.target.controls[g.corner],D=F&&F.getMouseUpHandler(p,m,S);k=k||this.getPointer(p),D&&D(p,g,k.x,k.y)}this._setCursorFromEvent(p,m),this._handleEvent(p,"up",f,w),this._groupSelector=null,this._currentTransform=null,m&&(m.__corner=0),v?this.requestRenderAll():w||this.renderTop()}},_simpleEventHandler:function(p,m){var g=this.findTarget(m),x=this.targets,v={e:m,target:g,subTargets:x};if(this.fire(p,v),g&&g.fire(p,v),!x)return g;for(var w=0;w<x.length;w++)x[w].fire(p,v);return g},_handleEvent:function(p,m,g,x){var v=this._target,w=this.targets||[],_={e:p,target:v,subTargets:w,button:g||f,isClick:x||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};m==="up"&&(_.currentTarget=this.findTarget(p),_.currentSubTargets=this.targets),this.fire("mouse:"+m,_),v&&v.fire("mouse"+m,_);for(var b=0;b<w.length;b++)w[b].fire("mouse"+m,_)},_finalizeCurrentTransform:function(p){var m=this._currentTransform,g=m.target,x={e:p,target:g,transform:m,action:m.action};g._scaling&&(g._scaling=!1),g.setCoords(),(m.actionPerformed||this.stateful&&g.hasStateChanged())&&this._fire("modified",x)},_onMouseDownInDrawingMode:function(p){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(p).requestRenderAll();var m=this.getPointer(p);this.freeDrawingBrush.onMouseDown(m,{e:p,pointer:m}),this._handleEvent(p,"down")},_onMouseMoveInDrawingMode:function(p){if(this._isCurrentlyDrawing){var m=this.getPointer(p);this.freeDrawingBrush.onMouseMove(m,{e:p,pointer:m})}this.setCursor(this.freeDrawingCursor),this._handleEvent(p,"move")},_onMouseUpInDrawingMode:function(p){var m=this.getPointer(p);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:p,pointer:m}),this._handleEvent(p,"up")},__onMouseDown:function(p){this._cacheTransformEventData(p),this._handleEvent(p,"down:before");var m=this._target;if(u(p,c)){this.fireRightClick&&this._handleEvent(p,"down",c);return}if(u(p,d)){this.fireMiddleClick&&this._handleEvent(p,"down",d);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(p);return}if(this._isMainEvent(p)&&!this._currentTransform){var g=this._pointer;this._previousPointer=g;var x=this._shouldRender(m),v=this._shouldGroup(p,m);if(this._shouldClearSelection(p,m)?this.discardActiveObject(p):v&&(this._handleGrouping(p,m),m=this._activeObject),this.selection&&(!m||!m.selectable&&!m.isEditing&&m!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),m){var w=m===this._activeObject;m.selectable&&m.activeOn==="down"&&this.setActiveObject(m,p);var _=m._findTargetCorner(this.getPointer(p,!0),t.util.isTouchEvent(p));if(m.__corner=_,m===this._activeObject&&(_||!v)){this._setupCurrentTransform(p,m,w);var b=m.controls[_],g=this.getPointer(p),k=b&&b.getMouseDownHandler(p,m,b);k&&k(p,this._currentTransform,g.x,g.y)}}this._handleEvent(p,"down"),(x||v)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(p){this._resetTransformEventData(),this._pointer=this.getPointer(p,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(p)||null},_beforeTransform:function(p){var m=this._currentTransform;this.stateful&&m.target.saveState(),this.fire("before:transform",{e:p,transform:m})},__onMouseMove:function(p){this._handleEvent(p,"move:before"),this._cacheTransformEventData(p);var m,g;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(p);return}if(this._isMainEvent(p)){var x=this._groupSelector;x?(g=this._absolutePointer,x.left=g.x-x.ex,x.top=g.y-x.ey,this.renderTop()):this._currentTransform?this._transformObject(p):(m=this.findTarget(p)||null,this._setCursorFromEvent(p,m),this._fireOverOutEvents(m,p)),this._handleEvent(p,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(p,m){var g=this._hoveredTarget,x=this._hoveredTargets,v=this.targets,w=Math.max(x.length,v.length);this.fireSyntheticInOutEvents(p,m,{oldTarget:g,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var _=0;_<w;_++)this.fireSyntheticInOutEvents(v[_],m,{oldTarget:x[_],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=p,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(p,m){var g=this._draggedoverTarget,x=this._hoveredTargets,v=this.targets,w=Math.max(x.length,v.length);this.fireSyntheticInOutEvents(p,m,{oldTarget:g,evtOut:"dragleave",evtIn:"dragenter"});for(var _=0;_<w;_++)this.fireSyntheticInOutEvents(v[_],m,{oldTarget:x[_],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=p},fireSyntheticInOutEvents:function(p,m,g){var x,v,w=g.oldTarget,_,b,k=w!==p,S=g.canvasEvtIn,O=g.canvasEvtOut;k&&(x={e:m,target:p,previousTarget:w},v={e:m,target:w,nextTarget:p}),b=p&&k,_=w&&k,_&&(O&&this.fire(O,v),w.fire(g.evtOut,v)),b&&(S&&this.fire(S,x),p.fire(g.evtIn,x))},__onMouseWheel:function(p){this._cacheTransformEventData(p),this._handleEvent(p,"wheel"),this._resetTransformEventData()},_transformObject:function(p){var m=this.getPointer(p),g=this._currentTransform;g.reset=!1,g.shiftKey=p.shiftKey,g.altKey=p[this.centeredKey],this._performTransformAction(p,g,m),g.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(p,m,g){var x=g.x,v=g.y,w=m.action,_=!1,b=m.actionHandler;b&&(_=b(p,m,x,v)),w==="drag"&&_&&(m.target.isMoving=!0,this.setCursor(m.target.moveCursor||this.moveCursor)),m.actionPerformed=m.actionPerformed||_},_fire:t.controlsUtils.fireEvent,_setCursorFromEvent:function(p,m){if(!m)return this.setCursor(this.defaultCursor),!1;var g=m.hoverCursor||this.hoverCursor,x=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,v=(!x||!x.contains(m))&&m._findTargetCorner(this.getPointer(p,!0));v?this.setCursor(this.getCornerCursor(v,m,p)):(m.subTargetCheck&&this.targets.concat().reverse().map(function(w){g=w.hoverCursor||g}),this.setCursor(g))},getCornerCursor:function(p,m,g){var x=m.controls[p];return x.cursorStyleHandler(g,x,m)}})}(),function(){var o=Math.min,a=Math.max;t.util.object.extend(t.Canvas.prototype,{_shouldGroup:function(c,d){var f=this._activeObject;return f&&this._isSelectionKeyPressed(c)&&d&&d.selectable&&this.selection&&(f!==d||f.type==="activeSelection")&&!d.onSelect({e:c})},_handleGrouping:function(c,d){var f=this._activeObject;f.__corner||d===f&&(d=this.findTarget(c,!0),!d||!d.selectable)||(f&&f.type==="activeSelection"?this._updateActiveSelection(d,c):this._createActiveSelection(d,c))},_updateActiveSelection:function(c,d){var f=this._activeObject,h=f._objects.slice(0);f.contains(c)?(f.removeWithUpdate(c),this._hoveredTarget=c,this._hoveredTargets=this.targets.concat(),f.size()===1&&this._setActiveObject(f.item(0),d)):(f.addWithUpdate(c),this._hoveredTarget=f,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(h,d)},_createActiveSelection:function(c,d){var f=this.getActiveObjects(),h=this._createGroup(c);this._hoveredTarget=h,this._setActiveObject(h,d),this._fireSelectionEvents(f,d)},_createGroup:function(c){var d=this._objects,f=d.indexOf(this._activeObject)<d.indexOf(c),h=f?[this._activeObject,c]:[c,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new t.ActiveSelection(h,{canvas:this})},_groupSelectedObjects:function(c){var d=this._collectObjects(c),f;d.length===1?this.setActiveObject(d[0],c):d.length>1&&(f=new t.ActiveSelection(d.reverse(),{canvas:this}),this.setActiveObject(f,c))},_collectObjects:function(c){for(var d=[],f,h=this._groupSelector.ex,u=this._groupSelector.ey,p=h+this._groupSelector.left,m=u+this._groupSelector.top,g=new t.Point(o(h,p),o(u,m)),x=new t.Point(a(h,p),a(u,m)),v=!this.selectionFullyContained,w=h===p&&u===m,_=this._objects.length;_--&&(f=this._objects[_],!(!(!f||!f.selectable||!f.visible)&&(v&&f.intersectsWithRect(g,x,!0)||f.isContainedWithinRect(g,x,!0)||v&&f.containsPoint(g,null,!0)||v&&f.containsPoint(x,null,!0))&&(d.push(f),w))););return d.length>1&&(d=d.filter(function(b){return!b.onSelect({e:c})})),d},_maybeGroupObjects:function(c){this.selection&&this._groupSelector&&this._groupSelectedObjects(c),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){t.util.object.extend(t.StaticCanvas.prototype,{toDataURL:function(o){o||(o={});var a=o.format||"png",c=o.quality||1,d=(o.multiplier||1)*(o.enableRetinaScaling?this.getRetinaScaling():1),f=this.toCanvasElement(d,o);return t.util.toDataURL(f,a,c)},toCanvasElement:function(o,a){o=o||1,a=a||{};var c=(a.width||this.width)*o,d=(a.height||this.height)*o,f=this.getZoom(),h=this.width,u=this.height,p=f*o,m=this.viewportTransform,g=(m[4]-(a.left||0))*o,x=(m[5]-(a.top||0))*o,v=this.interactive,w=[p,0,0,p,g,x],_=this.enableRetinaScaling,b=t.util.createCanvasElement(),k=this.contextTop;return b.width=c,b.height=d,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=w,this.width=c,this.height=d,this.calcViewportBoundaries(),this.renderCanvas(b.getContext("2d"),this._objects),this.viewportTransform=m,this.width=h,this.height=u,this.calcViewportBoundaries(),this.interactive=v,this.enableRetinaScaling=_,this.contextTop=k,b}})}(),t.util.object.extend(t.StaticCanvas.prototype,{loadFromJSON:function(o,a,c){if(o){var d=typeof o=="string"?JSON.parse(o):t.util.object.clone(o),f=this,h=d.clipPath,u=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete d.clipPath,this._enlivenObjects(d.objects,function(p){f.clear(),f._setBgOverlay(d,function(){h?f._enlivenObjects([h],function(m){f.clipPath=m[0],f.__setupCanvas.call(f,d,p,u,a)}):f.__setupCanvas.call(f,d,p,u,a)})},c),this}},__setupCanvas:function(o,a,c,d){var f=this;a.forEach(function(h,u){f.insertAt(h,u)}),this.renderOnAddRemove=c,delete o.objects,delete o.backgroundImage,delete o.overlayImage,delete o.background,delete o.overlay,this._setOptions(o),this.renderAll(),d&&d()},_setBgOverlay:function(o,a){var c={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!o.backgroundImage&&!o.overlayImage&&!o.background&&!o.overlay){a&&a();return}var d=function(){c.backgroundImage&&c.overlayImage&&c.backgroundColor&&c.overlayColor&&a&&a()};this.__setBgOverlay("backgroundImage",o.backgroundImage,c,d),this.__setBgOverlay("overlayImage",o.overlayImage,c,d),this.__setBgOverlay("backgroundColor",o.background,c,d),this.__setBgOverlay("overlayColor",o.overlay,c,d)},__setBgOverlay:function(o,a,c,d){var f=this;if(!a){c[o]=!0,d&&d();return}o==="backgroundImage"||o==="overlayImage"?t.util.enlivenObjects([a],function(h){f[o]=h[0],c[o]=!0,d&&d()}):this["set"+t.util.string.capitalize(o,!0)](a,function(){c[o]=!0,d&&d()})},_enlivenObjects:function(o,a,c){if(!o||o.length===0){a&&a([]);return}t.util.enlivenObjects(o,function(d){a&&a(d)},null,c)},_toDataURL:function(o,a){this.clone(function(c){a(c.toDataURL(o))})},_toDataURLWithMultiplier:function(o,a,c){this.clone(function(d){c(d.toDataURLWithMultiplier(o,a))})},clone:function(o,a){var c=JSON.stringify(this.toJSON(a));this.cloneWithoutData(function(d){d.loadFromJSON(c,function(){o&&o(d)})})},cloneWithoutData:function(o){var a=t.util.createCanvasElement();a.width=this.width,a.height=this.height;var c=new t.Canvas(a);this.backgroundImage?(c.setBackgroundImage(this.backgroundImage.src,function(){c.renderAll(),o&&o(c)}),c.backgroundImageOpacity=this.backgroundImageOpacity,c.backgroundImageStretch=this.backgroundImageStretch):o&&o(c)}}),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.util.object.clone,f=a.util.toFixed,h=a.util.string.capitalize,u=a.util.degreesToRadians,p=!a.isLikelyNode,m=2;a.Object||(a.Object=a.util.createClass(a.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:p,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(g){g&&this.setOptions(g)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=a.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(g){var x=a.perfLimitSizeTotal,v=g.width,w=g.height,_=a.maxCacheSideLimit,b=a.minCacheSideLimit;if(v<=_&&w<=_&&v*w<=x)return v<b&&(g.width=b),w<b&&(g.height=b),g;var k=v/w,S=a.util.limitDimsByArea(k,x),O=a.util.capValue,F=O(b,S.x,_),D=O(b,S.y,_);return v>F&&(g.zoomX/=v/F,g.width=F,g.capped=!0),w>D&&(g.zoomY/=w/D,g.height=D,g.capped=!0),g},_getCacheCanvasDimensions:function(){var g=this.getTotalObjectScaling(),x=this._getTransformedDimensions(0,0),v=x.x*g.scaleX/this.scaleX,w=x.y*g.scaleY/this.scaleY;return{width:Math.ceil(v+m),height:Math.ceil(w+m),zoomX:g.scaleX,zoomY:g.scaleY,x:v,y:w}},_updateCacheCanvas:function(){var g=this.canvas;if(this.noScaleCache&&g&&g._currentTransform){var x=g._currentTransform.target,v=g._currentTransform.action;if(this===x&&v.slice&&v.slice(0,5)==="scale")return!1}var w=this._cacheCanvas,_=this._limitCacheSize(this._getCacheCanvasDimensions()),b=_.width,k=_.height,S,O,F=_.zoomX,D=_.zoomY,U=b!==this.cacheWidth||k!==this.cacheHeight,M=this.zoomX!==F||this.zoomY!==D,q=U||M;return q?(U?(w.width=b,w.height=k):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,w.width,w.height)),S=_.x/2,O=_.y/2,this.cacheTranslationX=Math.round(w.width/2-S)+S,this.cacheTranslationY=Math.round(w.height/2-O)+O,this.cacheWidth=b,this.cacheHeight=k,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(F,D),this.zoomX=F,this.zoomY=D,!0):!1},setOptions:function(g){this._setOptions(g),this._initGradient(g.fill,"fill"),this._initGradient(g.stroke,"stroke"),this._initPattern(g.fill,"fill"),this._initPattern(g.stroke,"stroke")},transform:function(g){var x=this.group&&!this.group._transformDone||this.group&&this.canvas&&g===this.canvas.contextTop,v=this.calcTransformMatrix(!x);g.transform(v[0],v[1],v[2],v[3],v[4],v[5])},toObject:function(g){var x=a.Object.NUM_FRACTION_DIGITS,v={type:this.type,version:a.version,originX:this.originX,originY:this.originY,left:f(this.left,x),top:f(this.top,x),width:f(this.width,x),height:f(this.height,x),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:f(this.strokeWidth,x),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:f(this.strokeMiterLimit,x),scaleX:f(this.scaleX,x),scaleY:f(this.scaleY,x),angle:f(this.angle,x),flipX:this.flipX,flipY:this.flipY,opacity:f(this.opacity,x),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:f(this.skewX,x),skewY:f(this.skewY,x)};return this.clipPath&&!this.clipPath.excludeFromExport&&(v.clipPath=this.clipPath.toObject(g),v.clipPath.inverted=this.clipPath.inverted,v.clipPath.absolutePositioned=this.clipPath.absolutePositioned),a.util.populateWithProperties(this,v,g),this.includeDefaultValues||(v=this._removeDefaultValues(v)),v},toDatalessObject:function(g){return this.toObject(g)},_removeDefaultValues:function(g){var x=a.util.getKlass(g.type).prototype,v=x.stateProperties;return v.forEach(function(w){w==="left"||w==="top"||(g[w]===x[w]&&delete g[w],Array.isArray(g[w])&&Array.isArray(x[w])&&g[w].length===0&&x[w].length===0&&delete g[w])}),g},toString:function(){return"#<fabric."+h(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var g=a.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(g.scaleX),scaleY:Math.abs(g.scaleY)}},getTotalObjectScaling:function(){var g=this.getObjectScaling(),x=g.scaleX,v=g.scaleY;if(this.canvas){var w=this.canvas.getZoom(),_=this.canvas.getRetinaScaling();x*=w*_,v*=w*_}return{scaleX:x,scaleY:v}},getObjectOpacity:function(){var g=this.opacity;return this.group&&(g*=this.group.getObjectOpacity()),g},_set:function(g,x){var v=g==="scaleX"||g==="scaleY",w=this[g]!==x,_=!1;return v&&(x=this._constrainScale(x)),g==="scaleX"&&x<0?(this.flipX=!this.flipX,x*=-1):g==="scaleY"&&x<0?(this.flipY=!this.flipY,x*=-1):g==="shadow"&&x&&!(x instanceof a.Shadow)?x=new a.Shadow(x):g==="dirty"&&this.group&&this.group.set("dirty",x),this[g]=x,w&&(_=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(g)>-1?(this.dirty=!0,_&&this.group.set("dirty",!0)):_&&this.stateProperties.indexOf(g)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:a.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(g){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(g.save(),this._setupCompositeOperation(g),this.drawSelectionBackground(g),this.transform(g),this._setOpacity(g),this._setShadow(g,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(g)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(g),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),g.restore())},renderCache:function(g){g=g||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,g.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(g,x){if(g.save(),x.inverted?g.globalCompositeOperation="destination-out":g.globalCompositeOperation="destination-in",x.absolutePositioned){var v=a.util.invertTransform(this.calcTransformMatrix());g.transform(v[0],v[1],v[2],v[3],v[4],v[5])}x.transform(g),g.scale(1/x.zoomX,1/x.zoomY),g.drawImage(x._cacheCanvas,-x.cacheTranslationX,-x.cacheTranslationY),g.restore()},drawObject:function(g,x){var v=this.fill,w=this.stroke;x?(this.fill="black",this.stroke="",this._setClippingProperties(g)):this._renderBackground(g),this._render(g),this._drawClipPath(g,this.clipPath),this.fill=v,this.stroke=w},_drawClipPath:function(g,x){x&&(x.canvas=this.canvas,x.shouldCache(),x._transformDone=!0,x.renderCache({forClipping:!0}),this.drawClipPathOnCache(g,x))},drawCacheOnCanvas:function(g){g.scale(1/this.zoomX,1/this.zoomY),g.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(g){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!g&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!g){var x=this.cacheWidth/this.zoomX,v=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-x/2,-v/2,x,v)}return!0}return!1},_renderBackground:function(g){if(this.backgroundColor){var x=this._getNonTransformedDimensions();g.fillStyle=this.backgroundColor,g.fillRect(-x.x/2,-x.y/2,x.x,x.y),this._removeShadow(g)}},_setOpacity:function(g){this.group&&!this.group._transformDone?g.globalAlpha=this.getObjectOpacity():g.globalAlpha*=this.opacity},_setStrokeStyles:function(g,x){var v=x.stroke;v&&(g.lineWidth=x.strokeWidth,g.lineCap=x.strokeLineCap,g.lineDashOffset=x.strokeDashOffset,g.lineJoin=x.strokeLineJoin,g.miterLimit=x.strokeMiterLimit,v.toLive?v.gradientUnits==="percentage"||v.gradientTransform||v.patternTransform?this._applyPatternForTransformedGradient(g,v):(g.strokeStyle=v.toLive(g,this),this._applyPatternGradientTransform(g,v)):g.strokeStyle=x.stroke)},_setFillStyles:function(g,x){var v=x.fill;v&&(v.toLive?(g.fillStyle=v.toLive(g,this),this._applyPatternGradientTransform(g,x.fill)):g.fillStyle=v)},_setClippingProperties:function(g){g.globalAlpha=1,g.strokeStyle="transparent",g.fillStyle="#000000"},_setLineDash:function(g,x){!x||x.length===0||(1&x.length&&x.push.apply(x,x),g.setLineDash(x))},_renderControls:function(g,x){var v=this.getViewportTransform(),w=this.calcTransformMatrix(),_,b,k;x=x||{},b=typeof x.hasBorders<"u"?x.hasBorders:this.hasBorders,k=typeof x.hasControls<"u"?x.hasControls:this.hasControls,w=a.util.multiplyTransformMatrices(v,w),_=a.util.qrDecompose(w),g.save(),g.translate(_.translateX,_.translateY),g.lineWidth=1*this.borderScaleFactor,this.group||(g.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(_.angle-=180),g.rotate(u(this.group?_.angle:this.angle)),x.forActiveSelection||this.group?b&&this.drawBordersInGroup(g,_,x):b&&this.drawBorders(g,x),k&&this.drawControls(g,x),g.restore()},_setShadow:function(g){if(this.shadow){var x=this.shadow,v=this.canvas,w,_=v&&v.viewportTransform[0]||1,b=v&&v.viewportTransform[3]||1;x.nonScaling?w={scaleX:1,scaleY:1}:w=this.getObjectScaling(),v&&v._isRetinaScaling()&&(_*=a.devicePixelRatio,b*=a.devicePixelRatio),g.shadowColor=x.color,g.shadowBlur=x.blur*a.browserShadowBlurConstant*(_+b)*(w.scaleX+w.scaleY)/4,g.shadowOffsetX=x.offsetX*_*w.scaleX,g.shadowOffsetY=x.offsetY*b*w.scaleY}},_removeShadow:function(g){this.shadow&&(g.shadowColor="",g.shadowBlur=g.shadowOffsetX=g.shadowOffsetY=0)},_applyPatternGradientTransform:function(g,x){if(!x||!x.toLive)return{offsetX:0,offsetY:0};var v=x.gradientTransform||x.patternTransform,w=-this.width/2+x.offsetX||0,_=-this.height/2+x.offsetY||0;return x.gradientUnits==="percentage"?g.transform(this.width,0,0,this.height,w,_):g.transform(1,0,0,1,w,_),v&&g.transform(v[0],v[1],v[2],v[3],v[4],v[5]),{offsetX:w,offsetY:_}},_renderPaintInOrder:function(g){this.paintFirst==="stroke"?(this._renderStroke(g),this._renderFill(g)):(this._renderFill(g),this._renderStroke(g))},_render:function(){},_renderFill:function(g){this.fill&&(g.save(),this._setFillStyles(g,this),this.fillRule==="evenodd"?g.fill("evenodd"):g.fill(),g.restore())},_renderStroke:function(g){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(g),g.save(),this.strokeUniform&&this.group){var x=this.getObjectScaling();g.scale(1/x.scaleX,1/x.scaleY)}else this.strokeUniform&&g.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(g,this.strokeDashArray),this._setStrokeStyles(g,this),g.stroke(),g.restore()}},_applyPatternForTransformedGradient:function(g,x){var v=this._limitCacheSize(this._getCacheCanvasDimensions()),w=a.util.createCanvasElement(),_,b=this.canvas.getRetinaScaling(),k=v.x/this.scaleX/b,S=v.y/this.scaleY/b;w.width=Math.ceil(k),w.height=Math.ceil(S),_=w.getContext("2d"),_.beginPath(),_.moveTo(0,0),_.lineTo(k,0),_.lineTo(k,S),_.lineTo(0,S),_.closePath(),_.translate(k/2,S/2),_.scale(v.zoomX/this.scaleX/b,v.zoomY/this.scaleY/b),this._applyPatternGradientTransform(_,x),_.fillStyle=x.toLive(g),_.fill(),g.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),g.scale(b*this.scaleX/v.zoomX,b*this.scaleY/v.zoomY),g.strokeStyle=_.createPattern(w,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var g=a.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",g.scaleX),this.set("scaleY",g.scaleY),this.angle=g.angle,this.skewX=g.skewX,this.skewY=0}},_removeTransformMatrix:function(g){var x=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),x=a.util.transformPoint(x,this.transformMatrix)),this.transformMatrix=null,g&&(this.scaleX*=g.scaleX,this.scaleY*=g.scaleY,this.cropX=g.cropX,this.cropY=g.cropY,x.x+=g.offsetLeft,x.y+=g.offsetTop,this.width=g.width,this.height=g.height),this.setPositionByOrigin(x,"center","center")},clone:function(g,x){var v=this.toObject(x);this.constructor.fromObject?this.constructor.fromObject(v,g):a.Object._fromObject("Object",v,g)},cloneAsImage:function(g,x){var v=this.toCanvasElement(x);return g&&g(new a.Image(v)),this},toCanvasElement:function(g){g||(g={});var x=a.util,v=x.saveObjectTransform(this),w=this.group,_=this.shadow,b=Math.abs,k=(g.multiplier||1)*(g.enableRetinaScaling?a.devicePixelRatio:1);delete this.group,g.withoutTransform&&x.resetObjectTransform(this),g.withoutShadow&&(this.shadow=null);var S=a.util.createCanvasElement(),O=this.getBoundingRect(!0,!0),F=this.shadow,D,U={x:0,y:0},M,q,G;F&&(M=F.blur,F.nonScaling?D={scaleX:1,scaleY:1}:D=this.getObjectScaling(),U.x=2*Math.round(b(F.offsetX)+M)*b(D.scaleX),U.y=2*Math.round(b(F.offsetY)+M)*b(D.scaleY)),q=O.width+U.x,G=O.height+U.y,S.width=Math.ceil(q),S.height=Math.ceil(G);var Q=new a.StaticCanvas(S,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});g.format==="jpeg"&&(Q.backgroundColor="#fff"),this.setPositionByOrigin(new a.Point(Q.width/2,Q.height/2),"center","center");var K=this.canvas;Q.add(this);var ne=Q.toCanvasElement(k||1,g);return this.shadow=_,this.set("canvas",K),w&&(this.group=w),this.set(v).setCoords(),Q._objects=[],Q.dispose(),Q=null,ne},toDataURL:function(g){return g||(g={}),a.util.toDataURL(this.toCanvasElement(g),g.format||"png",g.quality||1)},isType:function(g){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===g},complexity:function(){return 1},toJSON:function(g){return this.toObject(g)},rotate:function(g){var x=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return x&&this._setOriginToCenter(),this.set("angle",g),x&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(g,x){x=x||this.canvas.getPointer(g);var v=new a.Point(x.x,x.y),w=this._getLeftTopCoords();return this.angle&&(v=a.util.rotatePoint(v,w,u(-this.angle))),{x:v.x-w.x,y:v.y-w.y}},_setupCompositeOperation:function(g){this.globalCompositeOperation&&(g.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){a.runningAnimations&&a.runningAnimations.cancelByTarget(this)}}),a.util.createAccessors&&a.util.createAccessors(a.Object),c(a.Object.prototype,a.Observable),a.Object.NUM_FRACTION_DIGITS=2,a.Object.ENLIVEN_PROPS=["clipPath"],a.Object._fromObject=function(g,x,v,w){var _=a[g];x=d(x,!0),a.util.enlivenPatterns([x.fill,x.stroke],function(b){typeof b[0]<"u"&&(x.fill=b[0]),typeof b[1]<"u"&&(x.stroke=b[1]),a.util.enlivenObjectEnlivables(x,x,function(){var k=w?new _(x[w],x):new _(x);v&&v(k)})})},a.Object.__uid=0)}(e),function(){var o=t.util.degreesToRadians,a={left:-.5,center:0,right:.5},c={top:-.5,center:0,bottom:.5};t.util.object.extend(t.Object.prototype,{translateToGivenOrigin:function(d,f,h,u,p){var m=d.x,g=d.y,x,v,w;return typeof f=="string"?f=a[f]:f-=.5,typeof u=="string"?u=a[u]:u-=.5,x=u-f,typeof h=="string"?h=c[h]:h-=.5,typeof p=="string"?p=c[p]:p-=.5,v=p-h,(x||v)&&(w=this._getTransformedDimensions(),m=d.x+x*w.x,g=d.y+v*w.y),new t.Point(m,g)},translateToCenterPoint:function(d,f,h){var u=this.translateToGivenOrigin(d,f,h,"center","center");return this.angle?t.util.rotatePoint(u,d,o(this.angle)):u},translateToOriginPoint:function(d,f,h){var u=this.translateToGivenOrigin(d,"center","center",f,h);return this.angle?t.util.rotatePoint(u,d,o(this.angle)):u},getCenterPoint:function(){var d=new t.Point(this.left,this.top);return this.translateToCenterPoint(d,this.originX,this.originY)},getPointByOrigin:function(d,f){var h=this.getCenterPoint();return this.translateToOriginPoint(h,d,f)},toLocalPoint:function(d,f,h){var u=this.getCenterPoint(),p,m;return typeof f<"u"&&typeof h<"u"?p=this.translateToGivenOrigin(u,"center","center",f,h):p=new t.Point(this.left,this.top),m=new t.Point(d.x,d.y),this.angle&&(m=t.util.rotatePoint(m,u,-o(this.angle))),m.subtractEquals(p)},setPositionByOrigin:function(d,f,h){var u=this.translateToCenterPoint(d,f,h),p=this.translateToOriginPoint(u,this.originX,this.originY);this.set("left",p.x),this.set("top",p.y)},adjustPosition:function(d){var f=o(this.angle),h=this.getScaledWidth(),u=t.util.cos(f)*h,p=t.util.sin(f)*h,m,g;typeof this.originX=="string"?m=a[this.originX]:m=this.originX-.5,typeof d=="string"?g=a[d]:g=d-.5,this.left+=u*(g-m),this.top+=p*(g-m),this.setCoords(),this.originX=d},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var d=this.getCenterPoint();this.originX="center",this.originY="center",this.left=d.x,this.top=d.y},_resetOrigin:function(){var d=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=d.x,this.top=d.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function o(h){return[new t.Point(h.tl.x,h.tl.y),new t.Point(h.tr.x,h.tr.y),new t.Point(h.br.x,h.br.y),new t.Point(h.bl.x,h.bl.y)]}var a=t.util,c=a.degreesToRadians,d=a.multiplyTransformMatrices,f=a.transformPoint;a.object.extend(t.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(h,u){return u?h?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),h?this.aCoords:this.lineCoords)},getCoords:function(h,u){return o(this._getCoords(h,u))},intersectsWithRect:function(h,u,p,m){var g=this.getCoords(p,m),x=t.Intersection.intersectPolygonRectangle(g,h,u);return x.status==="Intersection"},intersectsWithObject:function(h,u,p){var m=t.Intersection.intersectPolygonPolygon(this.getCoords(u,p),h.getCoords(u,p));return m.status==="Intersection"||h.isContainedWithinObject(this,u,p)||this.isContainedWithinObject(h,u,p)},isContainedWithinObject:function(h,u,p){for(var m=this.getCoords(u,p),g=u?h.aCoords:h.lineCoords,x=0,v=h._getImageLines(g);x<4;x++)if(!h.containsPoint(m[x],v))return!1;return!0},isContainedWithinRect:function(h,u,p,m){var g=this.getBoundingRect(p,m);return g.left>=h.x&&g.left+g.width<=u.x&&g.top>=h.y&&g.top+g.height<=u.y},containsPoint:function(h,x,p,m){var g=this._getCoords(p,m),x=x||this._getImageLines(g),v=this._findCrossPoints(h,x);return v!==0&&v%2===1},isOnScreen:function(h){if(!this.canvas)return!1;var u=this.canvas.vptCoords.tl,p=this.canvas.vptCoords.br,m=this.getCoords(!0,h);return m.some(function(g){return g.x<=p.x&&g.x>=u.x&&g.y<=p.y&&g.y>=u.y})||this.intersectsWithRect(u,p,!0,h)?!0:this._containsCenterOfCanvas(u,p,h)},_containsCenterOfCanvas:function(h,u,p){var m={x:(h.x+u.x)/2,y:(h.y+u.y)/2};return!!this.containsPoint(m,null,!0,p)},isPartiallyOnScreen:function(h){if(!this.canvas)return!1;var u=this.canvas.vptCoords.tl,p=this.canvas.vptCoords.br;if(this.intersectsWithRect(u,p,!0,h))return!0;var m=this.getCoords(!0,h).every(function(g){return(g.x>=p.x||g.x<=u.x)&&(g.y>=p.y||g.y<=u.y)});return m&&this._containsCenterOfCanvas(u,p,h)},_getImageLines:function(h){var u={topline:{o:h.tl,d:h.tr},rightline:{o:h.tr,d:h.br},bottomline:{o:h.br,d:h.bl},leftline:{o:h.bl,d:h.tl}};return u},_findCrossPoints:function(h,u){var p,m,g,x,v,w=0,_;for(var b in u)if(_=u[b],!(_.o.y<h.y&&_.d.y<h.y)&&!(_.o.y>=h.y&&_.d.y>=h.y)&&(_.o.x===_.d.x&&_.o.x>=h.x?v=_.o.x:(p=0,m=(_.d.y-_.o.y)/(_.d.x-_.o.x),g=h.y-p*h.x,x=_.o.y-m*_.o.x,v=-(g-x)/(p-m)),v>=h.x&&(w+=1),w===2))break;return w},getBoundingRect:function(h,u){var p=this.getCoords(h,u);return a.makeBoundingBoxFromPoints(p)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(h){return Math.abs(h)<this.minScaleLimit?h<0?-this.minScaleLimit:this.minScaleLimit:h===0?1e-4:h},scale:function(h){return this._set("scaleX",h),this._set("scaleY",h),this.setCoords()},scaleToWidth:function(h,u){var p=this.getBoundingRect(u).width/this.getScaledWidth();return this.scale(h/this.width/p)},scaleToHeight:function(h,u){var p=this.getBoundingRect(u).height/this.getScaledHeight();return this.scale(h/this.height/p)},calcLineCoords:function(){var h=this.getViewportTransform(),u=this.padding,p=c(this.angle),m=a.cos(p),g=a.sin(p),x=m*u,v=g*u,w=x+v,_=x-v,b=this.calcACoords(),k={tl:f(b.tl,h),tr:f(b.tr,h),bl:f(b.bl,h),br:f(b.br,h)};return u&&(k.tl.x-=_,k.tl.y-=w,k.tr.x+=w,k.tr.y-=_,k.bl.x-=w,k.bl.y+=_,k.br.x+=_,k.br.y+=w),k},calcOCoords:function(){var h=this._calcRotateMatrix(),u=this._calcTranslateMatrix(),p=this.getViewportTransform(),m=d(p,u),g=d(m,h),g=d(g,[1/p[0],0,0,1/p[3],0,0]),x=this._calculateCurrentDimensions(),v={};return this.forEachControl(function(w,_,b){v[_]=w.positionHandler(x,g,b)}),v},calcACoords:function(){var h=this._calcRotateMatrix(),u=this._calcTranslateMatrix(),p=d(u,h),m=this._getTransformedDimensions(),g=m.x/2,x=m.y/2;return{tl:f({x:-g,y:-x},p),tr:f({x:g,y:-x},p),bl:f({x:-g,y:x},p),br:f({x:g,y:x},p)}},setCoords:function(h){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),h?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return a.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var h=this.getCenterPoint();return[1,0,0,1,h.x,h.y]},transformMatrixKey:function(h){var u="_",p="";return!h&&this.group&&(p=this.group.transformMatrixKey(h)+u),p+this.top+u+this.left+u+this.scaleX+u+this.scaleY+u+this.skewX+u+this.skewY+u+this.angle+u+this.originX+u+this.originY+u+this.width+u+this.height+u+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(h){var u=this.calcOwnMatrix();if(h||!this.group)return u;var p=this.transformMatrixKey(h),m=this.matrixCache||(this.matrixCache={});return m.key===p?m.value:(this.group&&(u=d(this.group.calcTransformMatrix(!1),u)),m.key=p,m.value=u,u)},calcOwnMatrix:function(){var h=this.transformMatrixKey(!0),u=this.ownMatrixCache||(this.ownMatrixCache={});if(u.key===h)return u.value;var p=this._calcTranslateMatrix(),m={angle:this.angle,translateX:p[4],translateY:p[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return u.key=h,u.value=a.composeMatrix(m),u.value},_getNonTransformedDimensions:function(){var h=this.strokeWidth,u=this.width+h,p=this.height+h;return{x:u,y:p}},_getTransformedDimensions:function(h,u){typeof h>"u"&&(h=this.skewX),typeof u>"u"&&(u=this.skewY);var p,m,g,x=h===0&&u===0;if(this.strokeUniform?(m=this.width,g=this.height):(p=this._getNonTransformedDimensions(),m=p.x,g=p.y),x)return this._finalizeDimensions(m*this.scaleX,g*this.scaleY);var v=a.sizeAfterTransform(m,g,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:h,skewY:u});return this._finalizeDimensions(v.x,v.y)},_finalizeDimensions:function(h,u){return this.strokeUniform?{x:h+this.strokeWidth,y:u+this.strokeWidth}:{x:h,y:u}},_calculateCurrentDimensions:function(){var h=this.getViewportTransform(),u=this._getTransformedDimensions(),p=f(u,h,!0);return p.scalarAdd(2*this.padding)}})}(),t.util.object.extend(t.Object.prototype,{sendToBack:function(){return this.group?t.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?t.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(o){return this.group?t.StaticCanvas.prototype.sendBackwards.call(this.group,this,o):this.canvas&&this.canvas.sendBackwards(this,o),this},bringForward:function(o){return this.group?t.StaticCanvas.prototype.bringForward.call(this.group,this,o):this.canvas&&this.canvas.bringForward(this,o),this},moveTo:function(o){return this.group&&this.group.type!=="activeSelection"?t.StaticCanvas.prototype.moveTo.call(this.group,this,o):this.canvas&&this.canvas.moveTo(this,o),this}}),function(){function o(c,d){if(d){if(d.toLive)return c+": url(#SVGID_"+d.id+"); ";var f=new t.Color(d),h=c+": "+f.toRgb()+"; ",u=f.getAlpha();return u!==1&&(h+=c+"-opacity: "+u.toString()+"; "),h}else return c+": none; "}var a=t.util.toFixed;t.util.object.extend(t.Object.prototype,{getSvgStyles:function(c){var d=this.fillRule?this.fillRule:"nonzero",f=this.strokeWidth?this.strokeWidth:"0",h=this.strokeDashArray?this.strokeDashArray.join(" "):"none",u=this.strokeDashOffset?this.strokeDashOffset:"0",p=this.strokeLineCap?this.strokeLineCap:"butt",m=this.strokeLineJoin?this.strokeLineJoin:"miter",g=this.strokeMiterLimit?this.strokeMiterLimit:"4",x=typeof this.opacity<"u"?this.opacity:"1",v=this.visible?"":" visibility: hidden;",w=c?"":this.getSvgFilter(),_=o("fill",this.fill),b=o("stroke",this.stroke);return[b,"stroke-width: ",f,"; ","stroke-dasharray: ",h,"; ","stroke-linecap: ",p,"; ","stroke-dashoffset: ",u,"; ","stroke-linejoin: ",m,"; ","stroke-miterlimit: ",g,"; ",_,"fill-rule: ",d,"; ","opacity: ",x,";",w,v].join("")},getSvgSpanStyles:function(c,d){var f="; ",u=c.fontFamily?"font-family: "+(c.fontFamily.indexOf("'")===-1&&c.fontFamily.indexOf('"')===-1?"'"+c.fontFamily+"'":c.fontFamily)+f:"",h=c.strokeWidth?"stroke-width: "+c.strokeWidth+f:"",u=u,p=c.fontSize?"font-size: "+c.fontSize+"px"+f:"",m=c.fontStyle?"font-style: "+c.fontStyle+f:"",g=c.fontWeight?"font-weight: "+c.fontWeight+f:"",x=c.fill?o("fill",c.fill):"",v=c.stroke?o("stroke",c.stroke):"",w=this.getSvgTextDecoration(c),_=c.deltaY?"baseline-shift: "+-c.deltaY+"; ":"";return w&&(w="text-decoration: "+w+f),[v,h,u,p,m,g,w,x,_,d?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(c){return["overline","underline","line-through"].filter(function(d){return c[d.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(c,d){var f=c?this.calcTransformMatrix():this.calcOwnMatrix(),h='transform="'+t.util.matrixToSVG(f);return h+(d||"")+'" '},_setSVGBg:function(c){if(this.backgroundColor){var d=t.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',a(-this.width/2,d),'" y="',a(-this.height/2,d),'" width="',a(this.width,d),'" height="',a(this.height,d),`"></rect>
`)}},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(c),{reviver:c})},toClipPathSVG:function(c){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(c),{reviver:c})},_createBaseClipPathSVGMarkup:function(c,d){d=d||{};var f=d.reviver,h=d.additionalTransform||"",u=[this.getSvgTransform(!0,h),this.getSvgCommons()].join(""),p=c.indexOf("COMMON_PARTS");return c[p]=u,f?f(c.join("")):c.join("")},_createBaseSVGMarkup:function(c,d){d=d||{};var f=d.noStyle,h=d.reviver,u=f?"":'style="'+this.getSvgStyles()+'" ',p=d.withShadow?'style="'+this.getSvgFilter()+'" ':"",m=this.clipPath,g=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",x=m&&m.absolutePositioned,v=this.stroke,w=this.fill,_=this.shadow,b,k=[],S,O=c.indexOf("COMMON_PARTS"),F=d.additionalTransform;return m&&(m.clipPathId="CLIPPATH_"+t.Object.__uid++,S='<clipPath id="'+m.clipPathId+`" >
`+m.toClipPathSVG(h)+`</clipPath>
`),x&&k.push("<g ",p,this.getSvgCommons(),` >
`),k.push("<g ",this.getSvgTransform(!1),x?"":p+this.getSvgCommons(),` >
`),b=[u,g,f?"":this.addPaintOrder()," ",F?'transform="'+F+'" ':""].join(""),c[O]=b,w&&w.toLive&&k.push(w.toSVG(this)),v&&v.toLive&&k.push(v.toSVG(this)),_&&k.push(_.toSVG(this)),m&&k.push(S),k.push(c.join("")),k.push(`</g>
`),x&&k.push(`</g>
`),h?h(k.join("")):k.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var o=t.util.object.extend,a="stateProperties";function c(f,h,u){var p={},m=!0;u.forEach(function(g){p[g]=f[g]}),o(f[h],p,m)}function d(f,h,u){if(f===h)return!0;if(Array.isArray(f)){if(!Array.isArray(h)||f.length!==h.length)return!1;for(var p=0,m=f.length;p<m;p++)if(!d(f[p],h[p]))return!1;return!0}else if(f&&typeof f=="object"){var g=Object.keys(f),x;if(!h||typeof h!="object"||!u&&g.length!==Object.keys(h).length)return!1;for(var p=0,m=g.length;p<m;p++)if(x=g[p],!(x==="canvas"||x==="group")&&!d(f[x],h[x]))return!1;return!0}}t.util.object.extend(t.Object.prototype,{hasStateChanged:function(f){f=f||a;var h="_"+f;return Object.keys(this[h]).length<this[f].length?!0:!d(this[h],this,!0)},saveState:function(f){var h=f&&f.propertySet||a,u="_"+h;return this[u]?(c(this,u,this[h]),f&&f.stateProperties&&c(this,u,f.stateProperties),this):this.setupState(f)},setupState:function(f){f=f||{};var h=f.propertySet||a;return f.propertySet=h,this["_"+h]={},this.saveState(f),this}})}(),function(){var o=t.util.degreesToRadians;t.util.object.extend(t.Object.prototype,{_findTargetCorner:function(a,c){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var d=a.x,f=a.y,h,u,p=Object.keys(this.oCoords),m=p.length-1,g;for(this.__corner=0;m>=0;m--)if(g=p[m],!!this.isControlVisible(g)&&(u=this._getImageLines(c?this.oCoords[g].touchCorner:this.oCoords[g].corner),h=this._findCrossPoints({x:d,y:f},u),h!==0&&h%2===1))return this.__corner=g,g;return!1},forEachControl:function(a){for(var c in this.controls)a(this.controls[c],c,this)},_setCornerCoords:function(){var a=this.oCoords;for(var c in a){var d=this.controls[c];a[c].corner=d.calcCornerCoords(this.angle,this.cornerSize,a[c].x,a[c].y,!1),a[c].touchCorner=d.calcCornerCoords(this.angle,this.touchCornerSize,a[c].x,a[c].y,!0)}},drawSelectionBackground:function(a){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;a.save();var c=this.getCenterPoint(),d=this._calculateCurrentDimensions(),f=this.canvas.viewportTransform;return a.translate(c.x,c.y),a.scale(1/f[0],1/f[3]),a.rotate(o(this.angle)),a.fillStyle=this.selectionBackgroundColor,a.fillRect(-d.x/2,-d.y/2,d.x,d.y),a.restore(),this},drawBorders:function(a,c){c=c||{};var d=this._calculateCurrentDimensions(),f=this.borderScaleFactor,h=d.x+f,u=d.y+f,p=typeof c.hasControls<"u"?c.hasControls:this.hasControls,m=!1;return a.save(),a.strokeStyle=c.borderColor||this.borderColor,this._setLineDash(a,c.borderDashArray||this.borderDashArray),a.strokeRect(-h/2,-u/2,h,u),p&&(a.beginPath(),this.forEachControl(function(g,x,v){g.withConnection&&g.getVisibility(v,x)&&(m=!0,a.moveTo(g.x*h,g.y*u),a.lineTo(g.x*h+g.offsetX,g.y*u+g.offsetY))}),m&&a.stroke()),a.restore(),this},drawBordersInGroup:function(a,c,d){d=d||{};var f=t.util.sizeAfterTransform(this.width,this.height,c),h=this.strokeWidth,u=this.strokeUniform,p=this.borderScaleFactor,m=f.x+h*(u?this.canvas.getZoom():c.scaleX)+p,g=f.y+h*(u?this.canvas.getZoom():c.scaleY)+p;return a.save(),this._setLineDash(a,d.borderDashArray||this.borderDashArray),a.strokeStyle=d.borderColor||this.borderColor,a.strokeRect(-m/2,-g/2,m,g),a.restore(),this},drawControls:function(a,c){c=c||{},a.save();var d=1,f,h;return this.canvas&&(d=this.canvas.getRetinaScaling()),a.setTransform(d,0,0,d,0,0),a.strokeStyle=a.fillStyle=c.cornerColor||this.cornerColor,this.transparentCorners||(a.strokeStyle=c.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(a,c.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(f=this.group.calcTransformMatrix()),this.forEachControl(function(u,p,m){h=m.oCoords[p],u.getVisibility(m,p)&&(f&&(h=t.util.transformPoint(h,f)),u.render(a,h.x,h.y,c,m))}),a.restore(),this},isControlVisible:function(a){return this.controls[a]&&this.controls[a].getVisibility(this,a)},setControlVisible:function(a,c){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[a]=c,this},setControlsVisibility:function(a){a||(a={});for(var c in a)this.setControlVisible(c,a[c]);return this},onDeselect:function(){},onSelect:function(){}})}(),t.util.object.extend(t.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(o,a){a=a||{};var c=function(){},d=a.onComplete||c,f=a.onChange||c,h=this;return t.util.animate({target:this,startValue:o.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(u){o.set("left",u),h.requestRenderAll(),f()},onComplete:function(){o.setCoords(),d()}})},fxCenterObjectV:function(o,a){a=a||{};var c=function(){},d=a.onComplete||c,f=a.onChange||c,h=this;return t.util.animate({target:this,startValue:o.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(u){o.set("top",u),h.requestRenderAll(),f()},onComplete:function(){o.setCoords(),d()}})},fxRemove:function(o,a){a=a||{};var c=function(){},d=a.onComplete||c,f=a.onChange||c,h=this;return t.util.animate({target:this,startValue:o.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(u){o.set("opacity",u),h.requestRenderAll(),f()},onComplete:function(){h.remove(o),d()}})}}),t.util.object.extend(t.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var o=[],a,c,d=[];for(a in arguments[0])o.push(a);for(var f=0,h=o.length;f<h;f++)a=o[f],c=f!==h-1,d.push(this._animate(a,arguments[0][a],arguments[1],c));return d}else return this._animate.apply(this,arguments)},_animate:function(o,a,c,d){var f=this,h;a=a.toString(),c?c=t.util.object.clone(c):c={},~o.indexOf(".")&&(h=o.split("."));var u=f.colorProperties.indexOf(o)>-1||h&&f.colorProperties.indexOf(h[1])>-1,p=h?this.get(h[0])[h[1]]:this.get(o);"from"in c||(c.from=p),u||(~a.indexOf("=")?a=p+parseFloat(a.replace("=","")):a=parseFloat(a));var m={target:this,startValue:c.from,endValue:a,byValue:c.by,easing:c.easing,duration:c.duration,abort:c.abort&&function(g,x,v){return c.abort.call(f,g,x,v)},onChange:function(g,x,v){h?f[h[0]][h[1]]=g:f.set(o,g),!d&&c.onChange&&c.onChange(g,x,v)},onComplete:function(g,x,v){d||(f.setCoords(),c.onComplete&&c.onComplete(g,x,v))}};return u?t.util.animateColor(m.startValue,m.endValue,m.duration,m):t.util.animate(m)}}),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.util.object.clone,f={x1:1,x2:1,y1:1,y2:1};if(a.Line){a.warn("fabric.Line is already defined");return}a.Line=a.util.createClass(a.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:a.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(u,p){u||(u=[0,0,0,0]),this.callSuper("initialize",p),this.set("x1",u[0]),this.set("y1",u[1]),this.set("x2",u[2]),this.set("y2",u[3]),this._setWidthHeight(p)},_setWidthHeight:function(u){u||(u={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in u?u.left:this._getLeftToOriginX(),this.top="top"in u?u.top:this._getTopToOriginY()},_set:function(u,p){return this.callSuper("_set",u,p),typeof f[u]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:h({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:h({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(u){u.beginPath();var p=this.calcLinePoints();u.moveTo(p.x1,p.y1),u.lineTo(p.x2,p.y2),u.lineWidth=this.strokeWidth;var m=u.strokeStyle;u.strokeStyle=this.stroke||u.fillStyle,this.stroke&&this._renderStroke(u),u.strokeStyle=m},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(u){return c(this.callSuper("toObject",u),this.calcLinePoints())},_getNonTransformedDimensions:function(){var u=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(u.y-=this.strokeWidth),this.height===0&&(u.x-=this.strokeWidth)),u},calcLinePoints:function(){var u=this.x1<=this.x2?-1:1,p=this.y1<=this.y2?-1:1,m=u*this.width*.5,g=p*this.height*.5,x=u*this.width*-.5,v=p*this.height*-.5;return{x1:m,x2:x,y1:g,y2:v}},_toSVG:function(){var u=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',u.x1,'" y1="',u.y1,'" x2="',u.x2,'" y2="',u.y2,`" />
`]}}),a.Line.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),a.Line.fromElement=function(u,p,m){m=m||{};var g=a.parseAttributes(u,a.Line.ATTRIBUTE_NAMES),x=[g.x1||0,g.y1||0,g.x2||0,g.y2||0];p(new a.Line(x,c(g,m)))},a.Line.fromObject=function(u,p){function m(x){delete x.points,p&&p(x)}var g=d(u,!0);g.points=[u.x1,u.y1,u.x2,u.y2],a.Object._fromObject("Line",g,m,"points")};function h(u,p){var m=u.origin,g=u.axis1,x=u.axis2,v=u.dimension,w=p.nearest,_=p.center,b=p.farthest;return function(){switch(this.get(m)){case w:return Math.min(this.get(g),this.get(x));case _:return Math.min(this.get(g),this.get(x))+.5*this.get(v);case b:return Math.max(this.get(g),this.get(x))}}}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.degreesToRadians;if(a.Circle){a.warn("fabric.Circle is already defined.");return}a.Circle=a.util.createClass(a.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:a.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(f,h){return this.callSuper("_set",f,h),f==="radius"&&this.setRadius(h),this},toObject:function(f){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(f))},_toSVG:function(){var f,h=0,u=0,p=(this.endAngle-this.startAngle)%360;if(p===0)f=["<circle ","COMMON_PARTS",'cx="'+h+'" cy="'+u+'" ','r="',this.radius,`" />
`];else{var m=c(this.startAngle),g=c(this.endAngle),x=this.radius,v=a.util.cos(m)*x,w=a.util.sin(m)*x,_=a.util.cos(g)*x,b=a.util.sin(g)*x,k=p>180?"1":"0";f=['<path d="M '+v+" "+w," A "+x+" "+x," 0 ",+k+" 1"," "+_+" "+b,'" ',"COMMON_PARTS",` />
`]}return f},_render:function(f){f.beginPath(),f.arc(0,0,this.radius,c(this.startAngle),c(this.endAngle),!1),this._renderPaintInOrder(f)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(f){return this.radius=f,this.set("width",f*2).set("height",f*2)}}),a.Circle.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),a.Circle.fromElement=function(f,h){var u=a.parseAttributes(f,a.Circle.ATTRIBUTE_NAMES);if(!d(u))throw new Error("value of `r` attribute is required and can not be negative");u.left=(u.left||0)-u.radius,u.top=(u.top||0)-u.radius,h(new a.Circle(u))};function d(f){return"radius"in f&&f.radius>=0}a.Circle.fromObject=function(f,h){a.Object._fromObject("Circle",f,h)}}(e),function(o){var a=o.fabric||(o.fabric={});if(a.Triangle){a.warn("fabric.Triangle is already defined");return}a.Triangle=a.util.createClass(a.Object,{type:"triangle",width:100,height:100,_render:function(c){var d=this.width/2,f=this.height/2;c.beginPath(),c.moveTo(-d,f),c.lineTo(0,-f),c.lineTo(d,f),c.closePath(),this._renderPaintInOrder(c)},_toSVG:function(){var c=this.width/2,d=this.height/2,f=[-c+" "+d,"0 "+-d,c+" "+d].join(",");return["<polygon ","COMMON_PARTS",'points="',f,'" />']}}),a.Triangle.fromObject=function(c,d){return a.Object._fromObject("Triangle",c,d)}}(e),function(o){var a=o.fabric||(o.fabric={}),c=Math.PI*2;if(a.Ellipse){a.warn("fabric.Ellipse is already defined.");return}a.Ellipse=a.util.createClass(a.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:a.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(d){this.callSuper("initialize",d),this.set("rx",d&&d.rx||0),this.set("ry",d&&d.ry||0)},_set:function(d,f){switch(this.callSuper("_set",d,f),d){case"rx":this.rx=f,this.set("width",f*2);break;case"ry":this.ry=f,this.set("height",f*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(d){return this.callSuper("toObject",["rx","ry"].concat(d))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(d){d.beginPath(),d.save(),d.transform(1,0,0,this.ry/this.rx,0,0),d.arc(0,0,this.rx,0,c,!1),d.restore(),this._renderPaintInOrder(d)}}),a.Ellipse.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),a.Ellipse.fromElement=function(d,f){var h=a.parseAttributes(d,a.Ellipse.ATTRIBUTE_NAMES);h.left=(h.left||0)-h.rx,h.top=(h.top||0)-h.ry,f(new a.Ellipse(h))},a.Ellipse.fromObject=function(d,f){a.Object._fromObject("Ellipse",d,f)}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend;if(a.Rect){a.warn("fabric.Rect is already defined");return}a.Rect=a.util.createClass(a.Object,{stateProperties:a.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:a.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(d){this.callSuper("initialize",d),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(d){var f=this.rx?Math.min(this.rx,this.width/2):0,h=this.ry?Math.min(this.ry,this.height/2):0,u=this.width,p=this.height,m=-this.width/2,g=-this.height/2,x=f!==0||h!==0,v=1-.5522847498;d.beginPath(),d.moveTo(m+f,g),d.lineTo(m+u-f,g),x&&d.bezierCurveTo(m+u-v*f,g,m+u,g+v*h,m+u,g+h),d.lineTo(m+u,g+p-h),x&&d.bezierCurveTo(m+u,g+p-v*h,m+u-v*f,g+p,m+u-f,g+p),d.lineTo(m+f,g+p),x&&d.bezierCurveTo(m+v*f,g+p,m,g+p-v*h,m,g+p-h),d.lineTo(m,g+h),x&&d.bezierCurveTo(m,g+v*h,m+v*f,g,m+f,g),d.closePath(),this._renderPaintInOrder(d)},toObject:function(d){return this.callSuper("toObject",["rx","ry"].concat(d))},_toSVG:function(){var d=-this.width/2,f=-this.height/2;return["<rect ","COMMON_PARTS",'x="',d,'" y="',f,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),a.Rect.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),a.Rect.fromElement=function(d,f,h){if(!d)return f(null);h=h||{};var u=a.parseAttributes(d,a.Rect.ATTRIBUTE_NAMES);u.left=u.left||0,u.top=u.top||0,u.height=u.height||0,u.width=u.width||0;var p=new a.Rect(c(h?a.util.object.clone(h):{},u));p.visible=p.visible&&p.width>0&&p.height>0,f(p)},a.Rect.fromObject=function(d,f){return a.Object._fromObject("Rect",d,f)}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.util.array.min,f=a.util.array.max,h=a.util.toFixed,u=a.util.projectStrokeOnPoints;if(a.Polyline){a.warn("fabric.Polyline is already defined");return}a.Polyline=a.util.createClass(a.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:a.Object.prototype.cacheProperties.concat("points"),initialize:function(p,m){m=m||{},this.points=p||[],this.callSuper("initialize",m),this._setPositionDimensions(m)},_projectStrokeOnPoints:function(){return u(this.points,this,!0)},_setPositionDimensions:function(p){var m=this._calcDimensions(p),g,x=this.exactBoundingBox?this.strokeWidth:0;this.width=m.width-x,this.height=m.height-x,p.fromSVG||(g=this.translateToGivenOrigin({x:m.left-this.strokeWidth/2+x/2,y:m.top-this.strokeWidth/2+x/2},"left","top",this.originX,this.originY)),typeof p.left>"u"&&(this.left=p.fromSVG?m.left:g.x),typeof p.top>"u"&&(this.top=p.fromSVG?m.top:g.y),this.pathOffset={x:m.left+this.width/2+x/2,y:m.top+this.height/2+x/2}},_calcDimensions:function(){var p=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,m=d(p,"x")||0,g=d(p,"y")||0,x=f(p,"x")||0,v=f(p,"y")||0,w=x-m,_=v-g;return{left:m,top:g,width:w,height:_}},toObject:function(p){return c(this.callSuper("toObject",p),{points:this.points.concat()})},_toSVG:function(){for(var p=[],m=this.pathOffset.x,g=this.pathOffset.y,x=a.Object.NUM_FRACTION_DIGITS,v=0,w=this.points.length;v<w;v++)p.push(h(this.points[v].x-m,x),",",h(this.points[v].y-g,x)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',p.join(""),`" />
`]},commonRender:function(p){var m,g=this.points.length,x=this.pathOffset.x,v=this.pathOffset.y;if(!g||isNaN(this.points[g-1].y))return!1;p.beginPath(),p.moveTo(this.points[0].x-x,this.points[0].y-v);for(var w=0;w<g;w++)m=this.points[w],p.lineTo(m.x-x,m.y-v);return!0},_render:function(p){this.commonRender(p)&&this._renderPaintInOrder(p)},complexity:function(){return this.get("points").length}}),a.Polyline.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat(),a.Polyline.fromElementGenerator=function(p){return function(m,g,x){if(!m)return g(null);x||(x={});var v=a.parsePointsAttribute(m.getAttribute("points")),w=a.parseAttributes(m,a[p].ATTRIBUTE_NAMES);w.fromSVG=!0,g(new a[p](v,c(w,x)))}},a.Polyline.fromElement=a.Polyline.fromElementGenerator("Polyline"),a.Polyline.fromObject=function(p,m){return a.Object._fromObject("Polyline",p,m,"points")}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.projectStrokeOnPoints;if(a.Polygon){a.warn("fabric.Polygon is already defined");return}a.Polygon=a.util.createClass(a.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return c(this.points,this)},_render:function(d){this.commonRender(d)&&(d.closePath(),this._renderPaintInOrder(d))}}),a.Polygon.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat(),a.Polygon.fromElement=a.Polyline.fromElementGenerator("Polygon"),a.Polygon.fromObject=function(d,f){a.Object._fromObject("Polygon",d,f,"points")}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.array.min,d=a.util.array.max,f=a.util.object.extend,h=a.util.object.clone,u=a.util.toFixed;if(a.Path){a.warn("fabric.Path is already defined");return}a.Path=a.util.createClass(a.Object,{type:"path",path:null,cacheProperties:a.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:a.Object.prototype.stateProperties.concat("path"),initialize:function(p,m){m=h(m||{}),delete m.path,this.callSuper("initialize",m),this._setPath(p||[],m)},_setPath:function(p,m){this.path=a.util.makePathSimpler(Array.isArray(p)?p:a.util.parsePath(p)),a.Polyline.prototype._setPositionDimensions.call(this,m||{})},_renderPathCommands:function(p){var m,g=0,x=0,v=0,w=0,_=0,b=0,k=-this.pathOffset.x,S=-this.pathOffset.y;p.beginPath();for(var O=0,F=this.path.length;O<F;++O)switch(m=this.path[O],m[0]){case"L":v=m[1],w=m[2],p.lineTo(v+k,w+S);break;case"M":v=m[1],w=m[2],g=v,x=w,p.moveTo(v+k,w+S);break;case"C":v=m[5],w=m[6],_=m[3],b=m[4],p.bezierCurveTo(m[1]+k,m[2]+S,_+k,b+S,v+k,w+S);break;case"Q":p.quadraticCurveTo(m[1]+k,m[2]+S,m[3]+k,m[4]+S),v=m[3],w=m[4],_=m[1],b=m[2];break;case"z":case"Z":v=g,w=x,p.closePath();break}},_render:function(p){this._renderPathCommands(p),this._renderPaintInOrder(p)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(p){return f(this.callSuper("toObject",p),{path:this.path.map(function(m){return m.slice()})})},toDatalessObject:function(p){var m=this.toObject(["sourcePath"].concat(p));return m.sourcePath&&delete m.path,m},_toSVG:function(){var p=a.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',p,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var p=a.Object.NUM_FRACTION_DIGITS;return" translate("+u(-this.pathOffset.x,p)+", "+u(-this.pathOffset.y,p)+")"},toClipPathSVG:function(p){var m=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:p,additionalTransform:m})},toSVG:function(p){var m=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:p,additionalTransform:m})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var p=[],m=[],g,x=0,v=0,w=0,_=0,b,k=0,S=this.path.length;k<S;++k){switch(g=this.path[k],g[0]){case"L":w=g[1],_=g[2],b=[];break;case"M":w=g[1],_=g[2],x=w,v=_,b=[];break;case"C":b=a.util.getBoundsOfCurve(w,_,g[1],g[2],g[3],g[4],g[5],g[6]),w=g[5],_=g[6];break;case"Q":b=a.util.getBoundsOfCurve(w,_,g[1],g[2],g[1],g[2],g[3],g[4]),w=g[3],_=g[4];break;case"z":case"Z":w=x,_=v;break}b.forEach(function(G){p.push(G.x),m.push(G.y)}),p.push(w),m.push(_)}var O=c(p)||0,F=c(m)||0,D=d(p)||0,U=d(m)||0,M=D-O,q=U-F;return{left:O,top:F,width:M,height:q}}}),a.Path.fromObject=function(p,m){if(typeof p.sourcePath=="string"){var g=p.sourcePath;a.loadSVGFromURL(g,function(x){var v=x[0];v.setOptions(p),p.clipPath?a.util.enlivenObjects([p.clipPath],function(w){v.clipPath=w[0],m&&m(v)}):m&&m(v)})}else a.Object._fromObject("Path",p,m,"path")},a.Path.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat(["d"]),a.Path.fromElement=function(p,m,g){var x=a.parseAttributes(p,a.Path.ATTRIBUTE_NAMES);x.fromSVG=!0,m(new a.Path(x.d,f(x,g)))}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.array.min,d=a.util.array.max;a.Group||(a.Group=a.util.createClass(a.Object,a.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(f,h,u){h=h||{},this._objects=[],u&&this.callSuper("initialize",h),this._objects=f||[];for(var p=this._objects.length;p--;)this._objects[p].group=this;if(u)this._updateObjectsACoords();else{var m=h&&h.centerPoint;h.originX!==void 0&&(this.originX=h.originX),h.originY!==void 0&&(this.originY=h.originY),m||this._calcBounds(),this._updateObjectsCoords(m),delete h.centerPoint,this.callSuper("initialize",h)}this.setCoords()},_updateObjectsACoords:function(){for(var f=!0,h=this._objects.length;h--;)this._objects[h].setCoords(f)},_updateObjectsCoords:function(h){for(var h=h||this.getCenterPoint(),u=this._objects.length;u--;)this._updateObjectCoords(this._objects[u],h)},_updateObjectCoords:function(f,h){var u=f.left,p=f.top,m=!0;f.set({left:u-h.x,top:p-h.y}),f.group=this,f.setCoords(m)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(f){var h=!!this.group;return this._restoreObjectsState(),a.util.resetObjectTransform(this),f&&(h&&a.util.removeTransformFromObject(f,this.group.calcTransformMatrix()),this._objects.push(f),f.group=this,f._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,h?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(f){return this._restoreObjectsState(),a.util.resetObjectTransform(this),this.remove(f),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(f){this.dirty=!0,f.group=this,f._set("canvas",this.canvas)},_onObjectRemoved:function(f){this.dirty=!0,delete f.group},_set:function(f,h){var u=this._objects.length;if(this.useSetOnGroup)for(;u--;)this._objects[u].setOnGroup(f,h);if(f==="canvas")for(;u--;)this._objects[u]._set(f,h);a.Object.prototype._set.call(this,f,h)},toObject:function(f){var h=this.includeDefaultValues,u=this._objects.filter(function(m){return!m.excludeFromExport}).map(function(m){var g=m.includeDefaultValues;m.includeDefaultValues=h;var x=m.toObject(f);return m.includeDefaultValues=g,x}),p=a.Object.prototype.toObject.call(this,f);return p.objects=u,p},toDatalessObject:function(f){var h,u=this.sourcePath;if(u)h=u;else{var p=this.includeDefaultValues;h=this._objects.map(function(g){var x=g.includeDefaultValues;g.includeDefaultValues=p;var v=g.toDatalessObject(f);return g.includeDefaultValues=x,v})}var m=a.Object.prototype.toDatalessObject.call(this,f);return m.objects=h,m},render:function(f){this._transformDone=!0,this.callSuper("render",f),this._transformDone=!1},shouldCache:function(){var f=a.Object.prototype.shouldCache.call(this);if(f){for(var h=0,u=this._objects.length;h<u;h++)if(this._objects[h].willDrawShadow())return this.ownCaching=!1,!1}return f},willDrawShadow:function(){if(a.Object.prototype.willDrawShadow.call(this))return!0;for(var f=0,h=this._objects.length;f<h;f++)if(this._objects[f].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(f){for(var h=0,u=this._objects.length;h<u;h++)this._objects[h].render(f);this._drawClipPath(f,this.clipPath)},isCacheDirty:function(f){if(this.callSuper("isCacheDirty",f))return!0;if(!this.statefullCache)return!1;for(var h=0,u=this._objects.length;h<u;h++)if(this._objects[h].isCacheDirty(!0)){if(this._cacheCanvas){var p=this.cacheWidth/this.zoomX,m=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-p/2,-m/2,p,m)}return!0}return!1},_restoreObjectsState:function(){var f=this.calcOwnMatrix();return this._objects.forEach(function(h){a.util.addTransformToObject(h,f),delete h.group,h.setCoords()}),this},destroy:function(){return this._objects.forEach(function(f){f.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(f){f.dispose&&f.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var f=this._objects,h=this.canvas;this._objects=[];var u=this.toObject();delete u.objects;var p=new a.ActiveSelection([]);return p.set(u),p.type="activeSelection",h.remove(this),f.forEach(function(m){m.group=p,m.dirty=!0,h.add(m)}),p.canvas=h,p._objects=f,h._activeObject=p,p.setCoords(),p}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var f=!0;return this.forEachObject(function(h){h.setCoords(f)}),this},_calcBounds:function(f){for(var h=[],u=[],p,m,g,x=["tr","br","bl","tl"],v=0,w=this._objects.length,_,b=x.length;v<w;++v){for(p=this._objects[v],g=p.calcACoords(),_=0;_<b;_++)m=x[_],h.push(g[m].x),u.push(g[m].y);p.aCoords=g}this._getBounds(h,u,f)},_getBounds:function(f,h,u){var p=new a.Point(c(f),c(h)),m=new a.Point(d(f),d(h)),g=p.y||0,x=p.x||0,v=m.x-p.x||0,w=m.y-p.y||0;this.width=v,this.height=w,u||this.setPositionByOrigin({x,y:g},"left","top")},_toSVG:function(f){for(var h=["<g ","COMMON_PARTS",` >
`],u=0,p=this._objects.length;u<p;u++)h.push("		",this._objects[u].toSVG(f));return h.push(`</g>
`),h},getSvgStyles:function(){var f=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",h=this.visible?"":" visibility: hidden;";return[f,this.getSvgFilter(),h].join("")},toClipPathSVG:function(f){for(var h=[],u=0,p=this._objects.length;u<p;u++)h.push("	",this._objects[u].toClipPathSVG(f));return this._createBaseClipPathSVGMarkup(h,{reviver:f})}}),a.Group.fromObject=function(f,h){var u=f.objects,p=a.util.object.clone(f,!0);if(delete p.objects,typeof u=="string"){a.loadSVGFromURL(u,function(m){var g=a.util.groupSVGElements(m,f,u),x=p.clipPath;delete p.clipPath,g.set(p),x?a.util.enlivenObjects([x],function(v){g.clipPath=v[0],h&&h(g)}):h&&h(g)});return}a.util.enlivenObjects(u,function(m){a.util.enlivenObjectEnlivables(f,p,function(){h&&h(new a.Group(m,p,!0))})})})}(e),function(o){var a=o.fabric||(o.fabric={});a.ActiveSelection||(a.ActiveSelection=a.util.createClass(a.Group,{type:"activeSelection",initialize:function(c,d){d=d||{},this._objects=c||[];for(var f=this._objects.length;f--;)this._objects[f].group=this;d.originX&&(this.originX=d.originX),d.originY&&(this.originY=d.originY),this._calcBounds(),this._updateObjectsCoords(),a.Object.prototype.initialize.call(this,d),this.setCoords()},toGroup:function(){var c=this._objects.concat();this._objects=[];var d=a.Object.prototype.toObject.call(this),f=new a.Group([]);if(delete d.type,f.set(d),c.forEach(function(u){u.canvas.remove(u),u.group=f}),f._objects=c,!this.canvas)return f;var h=this.canvas;return h.add(f),h._activeObject=f,f.setCoords(),f},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(c,d,f){c.save(),c.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,f=f||{},typeof f.hasControls>"u"&&(f.hasControls=!1),f.forActiveSelection=!0;for(var h=0,u=this._objects.length;h<u;h++)this._objects[h]._renderControls(c,f);this.callSuper("_renderControls",c,d),c.restore()}}),a.ActiveSelection.fromObject=function(c,d){a.util.enlivenObjects(c.objects,function(f){delete c.objects,d&&d(new a.ActiveSelection(f,c,!0))})})}(e),function(o){var a=t.util.object.extend;if(o.fabric||(o.fabric={}),o.fabric.Image){t.warn("fabric.Image is already defined.");return}t.Image=t.util.createClass(t.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:t.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:t.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(c,d){d||(d={}),this.filters=[],this.cacheKey="texture"+t.Object.__uid++,this.callSuper("initialize",d),this._initElement(c,d)},getElement:function(){return this._element||{}},setElement:function(c,d){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=c,this._originalElement=c,this._initConfig(d),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(c){var d=t.filterBackend;d&&d.evictCachesForKey&&d.evictCachesForKey(c)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((function(c){t.util.cleanUpJsdomNode(this[c]),this[c]=void 0}).bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var c=this.getElement();return{width:c.naturalWidth||c.width,height:c.naturalHeight||c.height}},_stroke:function(c){if(!(!this.stroke||this.strokeWidth===0)){var d=this.width/2,f=this.height/2;c.beginPath(),c.moveTo(-d,-f),c.lineTo(d,-f),c.lineTo(d,f),c.lineTo(-d,f),c.lineTo(-d,-f),c.closePath()}},toObject:function(c){var d=[];this.filters.forEach(function(h){h&&d.push(h.toObject())});var f=a(this.callSuper("toObject",["cropX","cropY"].concat(c)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:d});return this.resizeFilter&&(f.resizeFilter=this.resizeFilter.toObject()),f},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var c=[],d=[],f,h=this._element,u=-this.width/2,p=-this.height/2,m="",g="";if(!h)return[];if(this.hasCrop()){var x=t.Object.__uid++;c.push('<clipPath id="imageCrop_'+x+`">
`,'	<rect x="'+u+'" y="'+p+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),m=' clip-path="url(#imageCrop_'+x+')" '}if(this.imageSmoothing||(g='" image-rendering="optimizeSpeed'),d.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',u-this.cropX,'" y="',p-this.cropY,'" width="',h.width||h.naturalWidth,'" height="',h.height||h.height,g,'"',m,`></image>
`),this.stroke||this.strokeDashArray){var v=this.fill;this.fill=null,f=["	<rect ",'x="',u,'" y="',p,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=v}return this.paintFirst!=="fill"?c=c.concat(f,d):c=c.concat(d,f),c},getSrc:function(c){var d=c?this._element:this._originalElement;return d?d.toDataURL?d.toDataURL():this.srcFromAttribute?d.getAttribute("src"):d.src:this.src||""},setSrc:function(c,d,f){return t.util.loadImage(c,function(h,u){this.setElement(h,f),this._setWidthHeight(),d&&d(this,u)},this,f&&f.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var c=this.resizeFilter,d=this.minimumScaleTrigger,f=this.getTotalObjectScaling(),h=f.scaleX,u=f.scaleY,p=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!c||h>d&&u>d){this._element=p,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=h,this._lastScaleY=u;return}t.filterBackend||(t.filterBackend=t.initFilterBackend());var m=t.util.createCanvasElement(),g=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,x=p.width,v=p.height;m.width=x,m.height=v,this._element=m,this._lastScaleX=c.scaleX=h,this._lastScaleY=c.scaleY=u,t.filterBackend.applyFilters([c],p,x,v,this._element,g),this._filterScalingX=m.width/this._originalElement.width,this._filterScalingY=m.height/this._originalElement.height},applyFilters:function(c){if(c=c||this.filters||[],c=c.filter(function(p){return p&&!p.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),c.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var d=this._originalElement,f=d.naturalWidth||d.width,h=d.naturalHeight||d.height;if(this._element===this._originalElement){var u=t.util.createCanvasElement();u.width=f,u.height=h,this._element=u,this._filteredEl=u}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,f,h),this._lastScaleX=1,this._lastScaleY=1;return t.filterBackend||(t.filterBackend=t.initFilterBackend()),t.filterBackend.applyFilters(c,this._originalElement,f,h,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(c){t.util.setImageSmoothing(c,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(c),this._renderPaintInOrder(c)},drawCacheOnCanvas:function(c){t.util.setImageSmoothing(c,this.imageSmoothing),t.Object.prototype.drawCacheOnCanvas.call(this,c)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(c){var d=this._element;if(d){var f=this._filterScalingX,h=this._filterScalingY,u=this.width,p=this.height,m=Math.min,g=Math.max,x=g(this.cropX,0),v=g(this.cropY,0),w=d.naturalWidth||d.width,_=d.naturalHeight||d.height,b=x*f,k=v*h,S=m(u*f,w-b),O=m(p*h,_-k),F=-u/2,D=-p/2,U=m(u,w/f-x),M=m(p,_/h-v);d&&c.drawImage(d,b,k,S,O,F,D,U,M)}},_needsResize:function(){var c=this.getTotalObjectScaling();return c.scaleX!==this._lastScaleX||c.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(c,d){this.setElement(t.util.getById(c),d),t.util.addClass(this.getElement(),t.Image.CSS_CANVAS)},_initConfig:function(c){c||(c={}),this.setOptions(c),this._setWidthHeight(c)},_initFilters:function(c,d){c&&c.length?t.util.enlivenObjects(c,function(f){d&&d(f)},"fabric.Image.filters"):d&&d()},_setWidthHeight:function(c){c||(c={});var d=this.getElement();this.width=c.width||d.naturalWidth||d.width||0,this.height=c.height||d.naturalHeight||d.height||0},parsePreserveAspectRatioAttribute:function(){var c=t.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),d=this._element.width,f=this._element.height,h=1,u=1,p=0,m=0,g=0,x=0,v,w=this.width,_=this.height,b={width:w,height:_};return c&&(c.alignX!=="none"||c.alignY!=="none")?(c.meetOrSlice==="meet"&&(h=u=t.util.findScaleToFit(this._element,b),v=(w-d*h)/2,c.alignX==="Min"&&(p=-v),c.alignX==="Max"&&(p=v),v=(_-f*u)/2,c.alignY==="Min"&&(m=-v),c.alignY==="Max"&&(m=v)),c.meetOrSlice==="slice"&&(h=u=t.util.findScaleToCover(this._element,b),v=d-w/h,c.alignX==="Mid"&&(g=v/2),c.alignX==="Max"&&(g=v),v=f-_/u,c.alignY==="Mid"&&(x=v/2),c.alignY==="Max"&&(x=v),d=w/h,f=_/u)):(h=w/d,u=_/f),{width:d,height:f,scaleX:h,scaleY:u,offsetLeft:p,offsetTop:m,cropX:g,cropY:x}}}),t.Image.CSS_CANVAS="canvas-img",t.Image.prototype.getSvgSrc=t.Image.prototype.getSrc,t.Image.fromObject=function(c,d){var f=t.util.object.clone(c);t.util.loadImage(f.src,function(h,u){if(u){d&&d(null,!0);return}t.Image.prototype._initFilters.call(f,f.filters,function(p){f.filters=p||[],t.Image.prototype._initFilters.call(f,[f.resizeFilter],function(m){f.resizeFilter=m[0],t.util.enlivenObjectEnlivables(f,f,function(){var g=new t.Image(h,f);d(g,!1)})})})},null,f.crossOrigin)},t.Image.fromURL=function(c,d,f){t.util.loadImage(c,function(h,u){d&&d(new t.Image(h,f),u)},null,f&&f.crossOrigin)},t.Image.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),t.Image.fromElement=function(c,d,f){var h=t.parseAttributes(c,t.Image.ATTRIBUTE_NAMES);t.Image.fromURL(h["xlink:href"],d,a(f?t.util.object.clone(f):{},h))}}(e),t.util.object.extend(t.Object.prototype,{_getAngleValueForStraighten:function(){var o=this.angle%360;return o>0?Math.round((o-1)/90)*90:Math.round(o/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(o){o=o||{};var a=function(){},c=o.onComplete||a,d=o.onChange||a,f=this;return t.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(h){f.rotate(h),d()},onComplete:function(){f.setCoords(),c()}})}}),t.util.object.extend(t.StaticCanvas.prototype,{straightenObject:function(o){return o.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(o){return o.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function o(c,d){var f="precision "+d+` float;
void main(){}`,h=c.createShader(c.FRAGMENT_SHADER);return c.shaderSource(h,f),c.compileShader(h),!!c.getShaderParameter(h,c.COMPILE_STATUS)}t.isWebglSupported=function(c){if(t.isLikelyNode)return!1;c=c||t.WebglFilterBackend.prototype.tileSize;var d=document.createElement("canvas"),f=d.getContext("webgl")||d.getContext("experimental-webgl"),h=!1;if(f){t.maxTextureSize=f.getParameter(f.MAX_TEXTURE_SIZE),h=t.maxTextureSize>=c;for(var u=["highp","mediump","lowp"],p=0;p<3;p++)if(o(f,u[p])){t.webGlPrecision=u[p];break}}return this.isSupported=h,h},t.WebglFilterBackend=a;function a(c){c&&c.tileSize&&(this.tileSize=c.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}a.prototype={tileSize:2048,resources:{},setupGLContext:function(c,d){this.dispose(),this.createWebGLCanvas(c,d),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(c,d)},chooseFastestCopyGLTo2DMethod:function(c,d){var f=typeof window.performance<"u",h;try{new ImageData(1,1),h=!0}catch{h=!1}var u=typeof ArrayBuffer<"u",p=typeof Uint8ClampedArray<"u";if(f&&h&&u&&p){var m=t.util.createCanvasElement(),g=new ArrayBuffer(c*d*4);if(t.forceGLPutImageData){this.imageBuffer=g,this.copyGLTo2D=l;return}var x={imageBuffer:g,destinationWidth:c,destinationHeight:d,targetCanvas:m},v,w,_;m.width=c,m.height=d,v=window.performance.now(),s.call(x,this.gl,x),w=window.performance.now()-v,v=window.performance.now(),l.call(x,this.gl,x),_=window.performance.now()-v,w>_?(this.imageBuffer=g,this.copyGLTo2D=l):this.copyGLTo2D=s}},createWebGLCanvas:function(c,d){var f=t.util.createCanvasElement();f.width=c,f.height=d;var h={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},u=f.getContext("webgl",h);u||(u=f.getContext("experimental-webgl",h)),u&&(u.clearColor(0,0,0,0),this.canvas=f,this.gl=u)},applyFilters:function(c,d,f,h,u,p){var m=this.gl,g;p&&(g=this.getCachedTexture(p,d));var x={originalWidth:d.width||d.originalWidth,originalHeight:d.height||d.originalHeight,sourceWidth:f,sourceHeight:h,destinationWidth:f,destinationHeight:h,context:m,sourceTexture:this.createTexture(m,f,h,!g&&d),targetTexture:this.createTexture(m,f,h),originalTexture:g||this.createTexture(m,f,h,!g&&d),passes:c.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:u},v=m.createFramebuffer();return m.bindFramebuffer(m.FRAMEBUFFER,v),c.forEach(function(w){w&&w.applyTo(x)}),i(x),this.copyGLTo2D(m,x),m.bindTexture(m.TEXTURE_2D,null),m.deleteTexture(x.sourceTexture),m.deleteTexture(x.targetTexture),m.deleteFramebuffer(v),u.getContext("2d").setTransform(1,0,0,1,0,0),x},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(c,d,f,h,u){var p=c.createTexture();return c.bindTexture(c.TEXTURE_2D,p),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,u||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,u||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),h?c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,h):c.texImage2D(c.TEXTURE_2D,0,c.RGBA,d,f,0,c.RGBA,c.UNSIGNED_BYTE,null),p},getCachedTexture:function(c,d){if(this.textureCache[c])return this.textureCache[c];var f=this.createTexture(this.gl,d.width,d.height,d);return this.textureCache[c]=f,f},evictCachesForKey:function(c){this.textureCache[c]&&(this.gl.deleteTexture(this.textureCache[c]),delete this.textureCache[c])},copyGLTo2D:s,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var c=this.gl,d={renderer:"",vendor:""};if(!c)return d;var f=c.getExtension("WEBGL_debug_renderer_info");if(f){var h=c.getParameter(f.UNMASKED_RENDERER_WEBGL),u=c.getParameter(f.UNMASKED_VENDOR_WEBGL);h&&(d.renderer=h.toLowerCase()),u&&(d.vendor=u.toLowerCase())}return this.gpuInfo=d,d}}}();function i(o){var a=o.targetCanvas,c=a.width,d=a.height,f=o.destinationWidth,h=o.destinationHeight;(c!==f||d!==h)&&(a.width=f,a.height=h)}function s(o,a){var c=o.canvas,d=a.targetCanvas,f=d.getContext("2d");f.translate(0,d.height),f.scale(1,-1);var h=c.height-d.height;f.drawImage(c,0,h,d.width,d.height,0,0,d.width,d.height)}function l(o,a){var c=a.targetCanvas,d=c.getContext("2d"),f=a.destinationWidth,h=a.destinationHeight,u=f*h*4,p=new Uint8Array(this.imageBuffer,0,u),m=new Uint8ClampedArray(this.imageBuffer,0,u);o.readPixels(0,0,f,h,o.RGBA,o.UNSIGNED_BYTE,p);var g=new ImageData(m,f,h);d.putImageData(g,0,0)}(function(){var o=function(){};t.Canvas2dFilterBackend=a;function a(){}a.prototype={evictCachesForKey:o,dispose:o,clearWebGLCaches:o,resources:{},applyFilters:function(c,d,f,h,u){var p=u.getContext("2d");p.drawImage(d,0,0,f,h);var m=p.getImageData(0,0,f,h),g=p.getImageData(0,0,f,h),x={sourceWidth:f,sourceHeight:h,imageData:m,originalEl:d,originalImageData:g,canvasEl:u,ctx:p,filterBackend:this};return c.forEach(function(v){v.applyTo(x)}),(x.imageData.width!==f||x.imageData.height!==h)&&(u.width=x.imageData.width,u.height=x.imageData.height),p.putImageData(x.imageData,0,0),x}}})(),t.Image=t.Image||{},t.Image.filters=t.Image.filters||{},t.Image.filters.BaseFilter=t.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(o){o&&this.setOptions(o)},setOptions:function(o){for(var a in o)this[a]=o[a]},createProgram:function(o,a,c){a=a||this.fragmentSource,c=c||this.vertexSource,t.webGlPrecision!=="highp"&&(a=a.replace(/precision highp float/g,"precision "+t.webGlPrecision+" float"));var d=o.createShader(o.VERTEX_SHADER);if(o.shaderSource(d,c),o.compileShader(d),!o.getShaderParameter(d,o.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+o.getShaderInfoLog(d));var f=o.createShader(o.FRAGMENT_SHADER);if(o.shaderSource(f,a),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+o.getShaderInfoLog(f));var h=o.createProgram();if(o.attachShader(h,d),o.attachShader(h,f),o.linkProgram(h),!o.getProgramParameter(h,o.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+o.getProgramInfoLog(h));var u=this.getAttributeLocations(o,h),p=this.getUniformLocations(o,h)||{};return p.uStepW=o.getUniformLocation(h,"uStepW"),p.uStepH=o.getUniformLocation(h,"uStepH"),{program:h,attributeLocations:u,uniformLocations:p}},getAttributeLocations:function(o,a){return{aPosition:o.getAttribLocation(a,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(o,a,c){var d=a.aPosition,f=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,f),o.enableVertexAttribArray(d),o.vertexAttribPointer(d,2,o.FLOAT,!1,0,0),o.bufferData(o.ARRAY_BUFFER,c,o.STATIC_DRAW)},_setupFrameBuffer:function(o){var a=o.context,c,d;o.passes>1?(c=o.destinationWidth,d=o.destinationHeight,(o.sourceWidth!==c||o.sourceHeight!==d)&&(a.deleteTexture(o.targetTexture),o.targetTexture=o.filterBackend.createTexture(a,c,d)),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,o.targetTexture,0)):(a.bindFramebuffer(a.FRAMEBUFFER,null),a.finish())},_swapTextures:function(o){o.passes--,o.pass++;var a=o.targetTexture;o.targetTexture=o.sourceTexture,o.sourceTexture=a},isNeutralState:function(){var o=this.mainParameter,a=t.Image.filters[this.type].prototype;if(o)if(Array.isArray(a[o])){for(var c=a[o].length;c--;)if(this[o][c]!==a[o][c])return!1;return!0}else return a[o]===this[o];else return!1},applyTo:function(o){o.webgl?(this._setupFrameBuffer(o),this.applyToWebGL(o),this._swapTextures(o)):this.applyTo2d(o)},retrieveShader:function(o){return o.programCache.hasOwnProperty(this.type)||(o.programCache[this.type]=this.createProgram(o.context)),o.programCache[this.type]},applyToWebGL:function(o){var a=o.context,c=this.retrieveShader(o);o.pass===0&&o.originalTexture?a.bindTexture(a.TEXTURE_2D,o.originalTexture):a.bindTexture(a.TEXTURE_2D,o.sourceTexture),a.useProgram(c.program),this.sendAttributeData(a,c.attributeLocations,o.aPosition),a.uniform1f(c.uniformLocations.uStepW,1/o.sourceWidth),a.uniform1f(c.uniformLocations.uStepH,1/o.sourceHeight),this.sendUniformData(a,c.uniformLocations),a.viewport(0,0,o.destinationWidth,o.destinationHeight),a.drawArrays(a.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(o,a,c){o.activeTexture(c),o.bindTexture(o.TEXTURE_2D,a),o.activeTexture(o.TEXTURE0)},unbindAdditionalTexture:function(o,a){o.activeTexture(a),o.bindTexture(o.TEXTURE_2D,null),o.activeTexture(o.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(o){this[this.mainParameter]=o},sendUniformData:function(){},createHelpLayer:function(o){if(!o.helpLayer){var a=document.createElement("canvas");a.width=o.sourceWidth,a.height=o.sourceHeight,o.helpLayer=a}},toObject:function(){var o={type:this.type},a=this.mainParameter;return a&&(o[a]=this[a]),o},toJSON:function(){return this.toObject()}}),t.Image.filters.BaseFilter.fromObject=function(o,a){var c=new t.Image.filters[o.type](o);return a&&a(c),c},function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.ColorMatrix=d(c.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(f){this.callSuper("initialize",f),this.matrix=this.matrix.slice(0)},applyTo2d:function(f){var h=f.imageData,u=h.data,p=u.length,m=this.matrix,g,x,v,w,_,b=this.colorsOnly;for(_=0;_<p;_+=4)g=u[_],x=u[_+1],v=u[_+2],b?(u[_]=g*m[0]+x*m[1]+v*m[2]+m[4]*255,u[_+1]=g*m[5]+x*m[6]+v*m[7]+m[9]*255,u[_+2]=g*m[10]+x*m[11]+v*m[12]+m[14]*255):(w=u[_+3],u[_]=g*m[0]+x*m[1]+v*m[2]+w*m[3]+m[4]*255,u[_+1]=g*m[5]+x*m[6]+v*m[7]+w*m[8]+m[9]*255,u[_+2]=g*m[10]+x*m[11]+v*m[12]+w*m[13]+m[14]*255,u[_+3]=g*m[15]+x*m[16]+v*m[17]+w*m[18]+m[19]*255)},getUniformLocations:function(f,h){return{uColorMatrix:f.getUniformLocation(h,"uColorMatrix"),uConstants:f.getUniformLocation(h,"uConstants")}},sendUniformData:function(f,h){var u=this.matrix,p=[u[0],u[1],u[2],u[3],u[5],u[6],u[7],u[8],u[10],u[11],u[12],u[13],u[15],u[16],u[17],u[18]],m=[u[4],u[9],u[14],u[19]];f.uniformMatrix4fv(h.uColorMatrix,!1,p),f.uniform4fv(h.uConstants,m)}}),a.Image.filters.ColorMatrix.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Brightness=d(c.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(f){if(this.brightness!==0){var h=f.imageData,u=h.data,p,m=u.length,g=Math.round(this.brightness*255);for(p=0;p<m;p+=4)u[p]=u[p]+g,u[p+1]=u[p+1]+g,u[p+2]=u[p+2]+g}},getUniformLocations:function(f,h){return{uBrightness:f.getUniformLocation(h,"uBrightness")}},sendUniformData:function(f,h){f.uniform1f(h.uBrightness,this.brightness)}}),a.Image.filters.Brightness.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.Image.filters,f=a.util.createClass;d.Convolute=f(d.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(h){var u=Math.sqrt(this.matrix.length),p=this.type+"_"+u+"_"+(this.opaque?1:0),m=this.fragmentSource[p];return h.programCache.hasOwnProperty(p)||(h.programCache[p]=this.createProgram(h.context,m)),h.programCache[p]},applyTo2d:function(h){var u=h.imageData,p=u.data,m=this.matrix,g=Math.round(Math.sqrt(m.length)),x=Math.floor(g/2),v=u.width,w=u.height,_=h.ctx.createImageData(v,w),b=_.data,k=this.opaque?1:0,S,O,F,D,U,M,q,G,Q,K,ne,J,T;for(ne=0;ne<w;ne++)for(K=0;K<v;K++){for(U=(ne*v+K)*4,S=0,O=0,F=0,D=0,T=0;T<g;T++)for(J=0;J<g;J++)q=ne+T-x,M=K+J-x,!(q<0||q>=w||M<0||M>=v)&&(G=(q*v+M)*4,Q=m[T*g+J],S+=p[G]*Q,O+=p[G+1]*Q,F+=p[G+2]*Q,k||(D+=p[G+3]*Q));b[U]=S,b[U+1]=O,b[U+2]=F,k?b[U+3]=p[U+3]:b[U+3]=D}h.imageData=_},getUniformLocations:function(h,u){return{uMatrix:h.getUniformLocation(u,"uMatrix"),uOpaque:h.getUniformLocation(u,"uOpaque"),uHalfSize:h.getUniformLocation(u,"uHalfSize"),uSize:h.getUniformLocation(u,"uSize")}},sendUniformData:function(h,u){h.uniform1fv(u.uMatrix,this.matrix)},toObject:function(){return c(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),a.Image.filters.Convolute.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Grayscale=d(c.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(f){var h=f.imageData,u=h.data,p,m=u.length,g,x=this.mode;for(p=0;p<m;p+=4)x==="average"?g=(u[p]+u[p+1]+u[p+2])/3:x==="lightness"?g=(Math.min(u[p],u[p+1],u[p+2])+Math.max(u[p],u[p+1],u[p+2]))/2:x==="luminosity"&&(g=.21*u[p]+.72*u[p+1]+.07*u[p+2]),u[p]=g,u[p+1]=g,u[p+2]=g},retrieveShader:function(f){var h=this.type+"_"+this.mode;if(!f.programCache.hasOwnProperty(h)){var u=this.fragmentSource[this.mode];f.programCache[h]=this.createProgram(f.context,u)}return f.programCache[h]},getUniformLocations:function(f,h){return{uMode:f.getUniformLocation(h,"uMode")}},sendUniformData:function(f,h){var u=1;f.uniform1i(h.uMode,u)},isNeutralState:function(){return!1}}),a.Image.filters.Grayscale.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Invert=d(c.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(f){var h=f.imageData,u=h.data,p,m=u.length;for(p=0;p<m;p+=4)u[p]=255-u[p],u[p+1]=255-u[p+1],u[p+2]=255-u[p+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(f,h){return{uInvert:f.getUniformLocation(h,"uInvert")}},sendUniformData:function(f,h){f.uniform1i(h.uInvert,this.invert)}}),a.Image.filters.Invert.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.Image.filters,f=a.util.createClass;d.Noise=f(d.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(h){if(this.noise!==0){var u=h.imageData,p=u.data,m,g=p.length,x=this.noise,v;for(m=0,g=p.length;m<g;m+=4)v=(.5-Math.random())*x,p[m]+=v,p[m+1]+=v,p[m+2]+=v}},getUniformLocations:function(h,u){return{uNoise:h.getUniformLocation(u,"uNoise"),uSeed:h.getUniformLocation(u,"uSeed")}},sendUniformData:function(h,u){h.uniform1f(u.uNoise,this.noise/255),h.uniform1f(u.uSeed,Math.random())},toObject:function(){return c(this.callSuper("toObject"),{noise:this.noise})}}),a.Image.filters.Noise.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Pixelate=d(c.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(f){var h=f.imageData,u=h.data,p=h.height,m=h.width,g,x,v,w,_,b,k,S,O,F,D;for(x=0;x<p;x+=this.blocksize)for(v=0;v<m;v+=this.blocksize)for(g=x*4*m+v*4,w=u[g],_=u[g+1],b=u[g+2],k=u[g+3],F=Math.min(x+this.blocksize,p),D=Math.min(v+this.blocksize,m),S=x;S<F;S++)for(O=v;O<D;O++)g=S*4*m+O*4,u[g]=w,u[g+1]=_,u[g+2]=b,u[g+3]=k},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(f,h){return{uBlocksize:f.getUniformLocation(h,"uBlocksize"),uStepW:f.getUniformLocation(h,"uStepW"),uStepH:f.getUniformLocation(h,"uStepH")}},sendUniformData:function(f,h){f.uniform1f(h.uBlocksize,this.blocksize)}}),a.Image.filters.Pixelate.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.Image.filters,f=a.util.createClass;d.RemoveColor=f(d.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(h){var u=h.imageData,p=u.data,m,g=this.distance*255,x,v,w,_=new a.Color(this.color).getSource(),b=[_[0]-g,_[1]-g,_[2]-g],k=[_[0]+g,_[1]+g,_[2]+g];for(m=0;m<p.length;m+=4)x=p[m],v=p[m+1],w=p[m+2],x>b[0]&&v>b[1]&&w>b[2]&&x<k[0]&&v<k[1]&&w<k[2]&&(p[m+3]=0)},getUniformLocations:function(h,u){return{uLow:h.getUniformLocation(u,"uLow"),uHigh:h.getUniformLocation(u,"uHigh")}},sendUniformData:function(h,u){var p=new a.Color(this.color).getSource(),m=parseFloat(this.distance),g=[0+p[0]/255-m,0+p[1]/255-m,0+p[2]/255-m,1],x=[p[0]/255+m,p[1]/255+m,p[2]/255+m,1];h.uniform4fv(u.uLow,g),h.uniform4fv(u.uHigh,x)},toObject:function(){return c(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),a.Image.filters.RemoveColor.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass,f={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var h in f)c[h]=d(c.ColorMatrix,{type:h,matrix:f[h],mainParameter:!1,colorsOnly:!0}),a.Image.filters[h].fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric,c=a.Image.filters,d=a.util.createClass;c.BlendColor=d(c.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(f){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[f]+`}
}`},retrieveShader:function(f){var h=this.type+"_"+this.mode,u;return f.programCache.hasOwnProperty(h)||(u=this.buildSource(this.mode),f.programCache[h]=this.createProgram(f.context,u)),f.programCache[h]},applyTo2d:function(f){var h=f.imageData,u=h.data,p=u.length,m,g,x,v,w,_,b,k=1-this.alpha;b=new a.Color(this.color).getSource(),m=b[0]*this.alpha,g=b[1]*this.alpha,x=b[2]*this.alpha;for(var S=0;S<p;S+=4)switch(v=u[S],w=u[S+1],_=u[S+2],this.mode){case"multiply":u[S]=v*m/255,u[S+1]=w*g/255,u[S+2]=_*x/255;break;case"screen":u[S]=255-(255-v)*(255-m)/255,u[S+1]=255-(255-w)*(255-g)/255,u[S+2]=255-(255-_)*(255-x)/255;break;case"add":u[S]=v+m,u[S+1]=w+g,u[S+2]=_+x;break;case"diff":case"difference":u[S]=Math.abs(v-m),u[S+1]=Math.abs(w-g),u[S+2]=Math.abs(_-x);break;case"subtract":u[S]=v-m,u[S+1]=w-g,u[S+2]=_-x;break;case"darken":u[S]=Math.min(v,m),u[S+1]=Math.min(w,g),u[S+2]=Math.min(_,x);break;case"lighten":u[S]=Math.max(v,m),u[S+1]=Math.max(w,g),u[S+2]=Math.max(_,x);break;case"overlay":u[S]=m<128?2*v*m/255:255-2*(255-v)*(255-m)/255,u[S+1]=g<128?2*w*g/255:255-2*(255-w)*(255-g)/255,u[S+2]=x<128?2*_*x/255:255-2*(255-_)*(255-x)/255;break;case"exclusion":u[S]=m+v-2*m*v/255,u[S+1]=g+w-2*g*w/255,u[S+2]=x+_-2*x*_/255;break;case"tint":u[S]=m+v*k,u[S+1]=g+w*k,u[S+2]=x+_*k}},getUniformLocations:function(f,h){return{uColor:f.getUniformLocation(h,"uColor")}},sendUniformData:function(f,h){var u=new a.Color(this.color).getSource();u[0]=this.alpha*u[0]/255,u[1]=this.alpha*u[1]/255,u[2]=this.alpha*u[2]/255,u[3]=this.alpha,f.uniform4fv(h.uColor,u)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),a.Image.filters.BlendColor.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric,c=a.Image.filters,d=a.util.createClass;c.BlendImage=d(c.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(f){var h=this.type+"_"+this.mode,u=this.fragmentSource[this.mode];return f.programCache.hasOwnProperty(h)||(f.programCache[h]=this.createProgram(f.context,u)),f.programCache[h]},applyToWebGL:function(f){var h=f.context,u=this.createTexture(f.filterBackend,this.image);this.bindAdditionalTexture(h,u,h.TEXTURE1),this.callSuper("applyToWebGL",f),this.unbindAdditionalTexture(h,h.TEXTURE1)},createTexture:function(f,h){return f.getCachedTexture(h.cacheKey,h._element)},calculateMatrix:function(){var f=this.image,h=f._element.width,u=f._element.height;return[1/f.scaleX,0,0,0,1/f.scaleY,0,-f.left/h,-f.top/u,1]},applyTo2d:function(f){var h=f.imageData,u=f.filterBackend.resources,p=h.data,m=p.length,g=h.width,x=h.height,v,w,_,b,k,S,O,F,D,U,M=this.image,q;u.blendImage||(u.blendImage=a.util.createCanvasElement()),D=u.blendImage,U=D.getContext("2d"),D.width!==g||D.height!==x?(D.width=g,D.height=x):U.clearRect(0,0,g,x),U.setTransform(M.scaleX,0,0,M.scaleY,M.left,M.top),U.drawImage(M._element,0,0,g,x),q=U.getImageData(0,0,g,x).data;for(var G=0;G<m;G+=4)switch(k=p[G],S=p[G+1],O=p[G+2],F=p[G+3],v=q[G],w=q[G+1],_=q[G+2],b=q[G+3],this.mode){case"multiply":p[G]=k*v/255,p[G+1]=S*w/255,p[G+2]=O*_/255,p[G+3]=F*b/255;break;case"mask":p[G+3]=b;break}},getUniformLocations:function(f,h){return{uTransformMatrix:f.getUniformLocation(h,"uTransformMatrix"),uImage:f.getUniformLocation(h,"uImage")}},sendUniformData:function(f,h){var u=this.calculateMatrix();f.uniform1i(h.uImage,1),f.uniformMatrix3fv(h.uTransformMatrix,!1,u)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),a.Image.filters.BlendImage.fromObject=function(f,h){a.Image.fromObject(f.image,function(u){var p=a.util.object.clone(f);p.image=u,h(new a.Image.filters.BlendImage(p))})}}(e),function(o){var a=o.fabric||(o.fabric={}),c=Math.pow,d=Math.floor,f=Math.sqrt,h=Math.abs,u=Math.round,p=Math.sin,m=Math.ceil,g=a.Image.filters,x=a.util.createClass;g.Resize=x(g.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(v,w){return{uDelta:v.getUniformLocation(w,"uDelta"),uTaps:v.getUniformLocation(w,"uTaps")}},sendUniformData:function(v,w){v.uniform2fv(w.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),v.uniform1fv(w.uTaps,this.taps)},retrieveShader:function(v){var w=this.getFilterWindow(),_=this.type+"_"+w;if(!v.programCache.hasOwnProperty(_)){var b=this.generateShader(w);v.programCache[_]=this.createProgram(v.context,b)}return v.programCache[_]},getFilterWindow:function(){var v=this.tempScale;return Math.ceil(this.lanczosLobes/v)},getTaps:function(){for(var v=this.lanczosCreate(this.lanczosLobes),w=this.tempScale,_=this.getFilterWindow(),b=new Array(_),k=1;k<=_;k++)b[k-1]=v(k*w);return b},generateShader:function(b){for(var w=new Array(b),_=this.fragmentSourceTOP,b,k=1;k<=b;k++)w[k-1]=k+".0 * uDelta";return _+="uniform float uTaps["+b+`];
`,_+=`void main() {
`,_+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,_+=`  float sum = 1.0;
`,w.forEach(function(S,O){_+="  color += texture2D(uTexture, vTexCoord + "+S+") * uTaps["+O+`];
`,_+="  color += texture2D(uTexture, vTexCoord - "+S+") * uTaps["+O+`];
`,_+="  sum += 2.0 * uTaps["+O+`];
`}),_+=`  gl_FragColor = color / sum;
`,_+="}",_},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(v){v.webgl?(v.passes++,this.width=v.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=v.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),v.destinationWidth=this.dW,this._setupFrameBuffer(v),this.applyToWebGL(v),this._swapTextures(v),v.sourceWidth=v.destinationWidth,this.height=v.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),v.destinationHeight=this.dH,this._setupFrameBuffer(v),this.applyToWebGL(v),this._swapTextures(v),v.sourceHeight=v.destinationHeight):this.applyTo2d(v)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(v){return function(w){if(w>=v||w<=-v)return 0;if(w<11920929e-14&&w>-11920929e-14)return 1;w*=Math.PI;var _=w/v;return p(w)/w*p(_)/_}},applyTo2d:function(v){var w=v.imageData,_=this.scaleX,b=this.scaleY;this.rcpScaleX=1/_,this.rcpScaleY=1/b;var k=w.width,S=w.height,O=u(k*_),F=u(S*b),D;this.resizeType==="sliceHack"?D=this.sliceByTwo(v,k,S,O,F):this.resizeType==="hermite"?D=this.hermiteFastResize(v,k,S,O,F):this.resizeType==="bilinear"?D=this.bilinearFiltering(v,k,S,O,F):this.resizeType==="lanczos"&&(D=this.lanczosResize(v,k,S,O,F)),v.imageData=D},sliceByTwo:function(v,w,_,b,k){var S=v.imageData,O=.5,F=!1,D=!1,U=w*O,M=_*O,q=a.filterBackend.resources,G,Q,K=0,ne=0,J=w,T=0;for(q.sliceByTwo||(q.sliceByTwo=document.createElement("canvas")),G=q.sliceByTwo,(G.width<w*1.5||G.height<_)&&(G.width=w*1.5,G.height=_),Q=G.getContext("2d"),Q.clearRect(0,0,w*1.5,_),Q.putImageData(S,0,0),b=d(b),k=d(k);!F||!D;)w=U,_=M,b<d(U*O)?U=d(U*O):(U=b,F=!0),k<d(M*O)?M=d(M*O):(M=k,D=!0),Q.drawImage(G,K,ne,w,_,J,T,U,M),K=J,ne=T,T+=M;return Q.getImageData(K,ne,b,k)},lanczosResize:function(v,w,_,b,k){function S(B){var E,R,N,C,P,I,H,L,z,ee,A;for(T.x=(B+.5)*M,j.x=d(T.x),E=0;E<k;E++){for(T.y=(E+.5)*q,j.y=d(T.y),P=0,I=0,H=0,L=0,z=0,R=j.x-K;R<=j.x+K;R++)if(!(R<0||R>=w)){ee=d(1e3*h(R-T.x)),J[ee]||(J[ee]={});for(var V=j.y-ne;V<=j.y+ne;V++)V<0||V>=_||(A=d(1e3*h(V-T.y)),J[ee][A]||(J[ee][A]=U(f(c(ee*G,2)+c(A*Q,2))/1e3)),N=J[ee][A],N>0&&(C=(V*w+R)*4,P+=N,I+=N*O[C],H+=N*O[C+1],L+=N*O[C+2],z+=N*O[C+3]))}C=(E*b+B)*4,D[C]=I/P,D[C+1]=H/P,D[C+2]=L/P,D[C+3]=z/P}return++B<b?S(B):F}var O=v.imageData.data,F=v.ctx.createImageData(b,k),D=F.data,U=this.lanczosCreate(this.lanczosLobes),M=this.rcpScaleX,q=this.rcpScaleY,G=2/this.rcpScaleX,Q=2/this.rcpScaleY,K=m(M*this.lanczosLobes/2),ne=m(q*this.lanczosLobes/2),J={},T={},j={};return S(0)},bilinearFiltering:function(v,w,_,b,k){var S,O,F,D,U,M,q,G,Q,K,ne,J,T=0,j,B=this.rcpScaleX,E=this.rcpScaleY,R=4*(w-1),N=v.imageData,C=N.data,P=v.ctx.createImageData(b,k),I=P.data;for(q=0;q<k;q++)for(G=0;G<b;G++)for(U=d(B*G),M=d(E*q),Q=B*G-U,K=E*q-M,j=4*(M*w+U),ne=0;ne<4;ne++)S=C[j+ne],O=C[j+4+ne],F=C[j+R+ne],D=C[j+R+4+ne],J=S*(1-Q)*(1-K)+O*Q*(1-K)+F*K*(1-Q)+D*Q*K,I[T++]=J;return P},hermiteFastResize:function(v,w,_,b,k){for(var S=this.rcpScaleX,O=this.rcpScaleY,F=m(S/2),D=m(O/2),U=v.imageData,M=U.data,q=v.ctx.createImageData(b,k),G=q.data,Q=0;Q<k;Q++)for(var K=0;K<b;K++){for(var ne=(K+Q*b)*4,J=0,T=0,j=0,B=0,E=0,R=0,N=0,C=(Q+.5)*O,P=d(Q*O);P<(Q+1)*O;P++)for(var I=h(C-(P+.5))/D,H=(K+.5)*S,L=I*I,z=d(K*S);z<(K+1)*S;z++){var ee=h(H-(z+.5))/F,A=f(L+ee*ee);A>1&&A<-1||(J=2*A*A*A-3*A*A+1,J>0&&(ee=4*(z+P*w),N+=J*M[ee+3],j+=J,M[ee+3]<255&&(J=J*M[ee+3]/250),B+=J*M[ee],E+=J*M[ee+1],R+=J*M[ee+2],T+=J))}G[ne]=B/T,G[ne+1]=E/T,G[ne+2]=R/T,G[ne+3]=N/j}return q},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),a.Image.filters.Resize.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Contrast=d(c.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(f){if(this.contrast!==0){var h=f.imageData,u,m,p=h.data,m=p.length,g=Math.floor(this.contrast*255),x=259*(g+255)/(255*(259-g));for(u=0;u<m;u+=4)p[u]=x*(p[u]-128)+128,p[u+1]=x*(p[u+1]-128)+128,p[u+2]=x*(p[u+2]-128)+128}},getUniformLocations:function(f,h){return{uContrast:f.getUniformLocation(h,"uContrast")}},sendUniformData:function(f,h){f.uniform1f(h.uContrast,this.contrast)}}),a.Image.filters.Contrast.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Saturation=d(c.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(f){if(this.saturation!==0){var h=f.imageData,u=h.data,p=u.length,m=-this.saturation,g,x;for(g=0;g<p;g+=4)x=Math.max(u[g],u[g+1],u[g+2]),u[g]+=x!==u[g]?(x-u[g])*m:0,u[g+1]+=x!==u[g+1]?(x-u[g+1])*m:0,u[g+2]+=x!==u[g+2]?(x-u[g+2])*m:0}},getUniformLocations:function(f,h){return{uSaturation:f.getUniformLocation(h,"uSaturation")}},sendUniformData:function(f,h){f.uniform1f(h.uSaturation,-this.saturation)}}),a.Image.filters.Saturation.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Vibrance=d(c.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(f){if(this.vibrance!==0){var h=f.imageData,u=h.data,p=u.length,m=-this.vibrance,g,x,v,w;for(g=0;g<p;g+=4)x=Math.max(u[g],u[g+1],u[g+2]),v=(u[g]+u[g+1]+u[g+2])/3,w=Math.abs(x-v)*2/255*m,u[g]+=x!==u[g]?(x-u[g])*w:0,u[g+1]+=x!==u[g+1]?(x-u[g+1])*w:0,u[g+2]+=x!==u[g+2]?(x-u[g+2])*w:0}},getUniformLocations:function(f,h){return{uVibrance:f.getUniformLocation(h,"uVibrance")}},sendUniformData:function(f,h){f.uniform1f(h.uVibrance,-this.vibrance)}}),a.Image.filters.Vibrance.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Blur=d(c.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(f){f.webgl?(this.aspectRatio=f.sourceWidth/f.sourceHeight,f.passes++,this._setupFrameBuffer(f),this.horizontal=!0,this.applyToWebGL(f),this._swapTextures(f),this._setupFrameBuffer(f),this.horizontal=!1,this.applyToWebGL(f),this._swapTextures(f)):this.applyTo2d(f)},applyTo2d:function(f){f.imageData=this.simpleBlur(f)},simpleBlur:function(f){var h=f.filterBackend.resources,u,p,m=f.imageData.width,g=f.imageData.height;h.blurLayer1||(h.blurLayer1=a.util.createCanvasElement(),h.blurLayer2=a.util.createCanvasElement()),u=h.blurLayer1,p=h.blurLayer2,(u.width!==m||u.height!==g)&&(p.width=u.width=m,p.height=u.height=g);var x=u.getContext("2d"),v=p.getContext("2d"),w=15,_,b,k,S,O=this.blur*.06*.5;for(x.putImageData(f.imageData,0,0),v.clearRect(0,0,m,g),S=-w;S<=w;S++)_=(Math.random()-.5)/4,b=S/w,k=O*b*m+_,v.globalAlpha=1-Math.abs(b),v.drawImage(u,k,_),x.drawImage(p,0,0),v.globalAlpha=1,v.clearRect(0,0,p.width,p.height);for(S=-w;S<=w;S++)_=(Math.random()-.5)/4,b=S/w,k=O*b*g+_,v.globalAlpha=1-Math.abs(b),v.drawImage(u,_,k),x.drawImage(p,0,0),v.globalAlpha=1,v.clearRect(0,0,p.width,p.height);f.ctx.drawImage(u,0,0);var F=f.ctx.getImageData(0,0,u.width,u.height);return x.globalAlpha=1,x.clearRect(0,0,u.width,u.height),F},getUniformLocations:function(f,h){return{delta:f.getUniformLocation(h,"uDelta")}},sendUniformData:function(f,h){var u=this.chooseRightDelta();f.uniform2fv(h.delta,u)},chooseRightDelta:function(){var f=1,h=[0,0],u;return this.horizontal?this.aspectRatio>1&&(f=1/this.aspectRatio):this.aspectRatio<1&&(f=this.aspectRatio),u=f*this.blur*.12,this.horizontal?h[0]=u:h[1]=u,h}}),c.Blur.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Gamma=d(c.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(f){this.gamma=[1,1,1],c.BaseFilter.prototype.initialize.call(this,f)},applyTo2d:function(f){var h=f.imageData,u=h.data,p=this.gamma,m=u.length,g=1/p[0],x=1/p[1],v=1/p[2],w;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),w=0,m=256;w<m;w++)this.rVals[w]=Math.pow(w/255,g)*255,this.gVals[w]=Math.pow(w/255,x)*255,this.bVals[w]=Math.pow(w/255,v)*255;for(w=0,m=u.length;w<m;w+=4)u[w]=this.rVals[u[w]],u[w+1]=this.gVals[u[w+1]],u[w+2]=this.bVals[u[w+2]]},getUniformLocations:function(f,h){return{uGamma:f.getUniformLocation(h,"uGamma")}},sendUniformData:function(f,h){f.uniform3fv(h.uGamma,this.gamma)}}),a.Image.filters.Gamma.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Composed=d(c.BaseFilter,{type:"Composed",subFilters:[],initialize:function(f){this.callSuper("initialize",f),this.subFilters=this.subFilters.slice(0)},applyTo:function(f){f.passes+=this.subFilters.length-1,this.subFilters.forEach(function(h){h.applyTo(f)})},toObject:function(){return a.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(f){return f.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(f){return!f.isNeutralState()})}}),a.Image.filters.Composed.fromObject=function(f,h){var u=f.subFilters||[],p=u.map(function(g){return new a.Image.filters[g.type](g)}),m=new a.Image.filters.Composed({subFilters:p});return h&&h(m),m}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.HueRotation=d(c.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var f=this.rotation*Math.PI,h=a.util.cos(f),u=a.util.sin(f),p=1/3,m=Math.sqrt(p)*u,g=1-h;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=h+g/3,this.matrix[1]=p*g-m,this.matrix[2]=p*g+m,this.matrix[5]=p*g+m,this.matrix[6]=h+p*g,this.matrix[7]=p*g-m,this.matrix[10]=p*g-m,this.matrix[11]=p*g+m,this.matrix[12]=h+p*g},isNeutralState:function(f){return this.calculateMatrix(),c.BaseFilter.prototype.isNeutralState.call(this,f)},applyTo:function(f){this.calculateMatrix(),c.BaseFilter.prototype.applyTo.call(this,f)}}),a.Image.filters.HueRotation.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.clone;if(a.Text){a.warn("fabric.Text is already defined");return}var d="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");a.Text=a.util.createClass(a.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:a.Object.prototype.stateProperties.concat(d),cacheProperties:a.Object.prototype.cacheProperties.concat(d),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(f,h){this.styles=h?h.styles||{}:{},this.text=f,this.__skipDimension=!0,this.callSuper("initialize",h),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var f=this.path;f&&(f.segmentsInfo=a.util.getPathSegmentsInfo(f.path))},getMeasuringContext:function(){return a._measuringContext||(a._measuringContext=this.canvas&&this.canvas.contextCache||a.util.createCanvasElement().getContext("2d")),a._measuringContext},_splitText:function(){var f=this._splitTextIntoLines(this.text);return this.textLines=f.lines,this._textLines=f.graphemeLines,this._unwrappedTextLines=f._unwrappedLines,this._text=f.graphemeText,f},initDimensions:function(){if(!this.__skipDimension){if(this._splitText(),this._clearCache(),this.path){var f=this.getHeightOfLine(0)*1.1;this.width=this.path.width+f,this.height=this.path.height+f}else this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight();this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"})}},enlargeSpaces:function(){for(var f,h,u,p,m,g,x,v=0,w=this._textLines.length;v<w;v++)if(!(this.textAlign!=="justify"&&(v===w-1||this.isEndOfWrapping(v)))&&(p=0,m=this._textLines[v],h=this.getLineWidth(v),h<this.width&&(x=this.textLines[v].match(this._reSpacesAndTabs)))){u=x.length,f=(this.width-h)/u;for(var _=0,b=m.length;_<=b;_++)g=this.__charBounds[v][_],this._reSpaceAndTab.test(m[_])?(g.width+=f,g.kernedWidth+=f,g.left+=p,p+=f):g.left+=p}},isEndOfWrapping:function(f){return f===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var f=this.callSuper("_getCacheCanvasDimensions"),h=this.fontSize;return f.width+=h*f.zoomX,f.height+=h*f.zoomY,f},_render:function(f){var h=this.path;h&&!h.isNotVisible()&&h._render(f),this._setTextStyles(f),this._renderTextLinesBackground(f),this._renderTextDecoration(f,"underline"),this._renderText(f),this._renderTextDecoration(f,"overline"),this._renderTextDecoration(f,"linethrough")},_renderText:function(f){this.paintFirst==="stroke"?(this._renderTextStroke(f),this._renderTextFill(f)):(this._renderTextFill(f),this._renderTextStroke(f))},_setTextStyles:function(f,h,u){if(f.textBaseline="alphabetic",this.path)switch(this.pathAlign){case"center":f.textBaseline="middle";break;case"ascender":f.textBaseline="top";break;case"descender":f.textBaseline="bottom";break}f.font=this._getFontDeclaration(h,u)},calcTextWidth:function(){for(var f=this.getLineWidth(0),h=1,u=this._textLines.length;h<u;h++){var p=this.getLineWidth(h);p>f&&(f=p)}return f},_renderTextLine:function(f,h,u,p,m,g){this._renderChars(f,h,u,p,m,g)},_renderTextLinesBackground:function(f){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var h,u,p=f.fillStyle,m,g,x=this._getLeftOffset(),v=this._getTopOffset(),w=0,_=0,b,k,S=this.path,O,F=0,D=this._textLines.length;F<D;F++){if(h=this.getHeightOfLine(F),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",F)){v+=h;continue}m=this._textLines[F],u=this._getLineLeftOffset(F),_=0,w=0,g=this.getValueOfPropertyAt(F,0,"textBackgroundColor");for(var U=0,M=m.length;U<M;U++)b=this.__charBounds[F][U],k=this.getValueOfPropertyAt(F,U,"textBackgroundColor"),S?(f.save(),f.translate(b.renderLeft,b.renderTop),f.rotate(b.angle),f.fillStyle=k,k&&f.fillRect(-b.width/2,-h/this.lineHeight*(1-this._fontSizeFraction),b.width,h/this.lineHeight),f.restore()):k!==g?(O=x+u+w,this.direction==="rtl"&&(O=this.width-O-_),f.fillStyle=g,g&&f.fillRect(O,v,_,h/this.lineHeight),w=b.left,_=b.width,g=k):_+=b.kernedWidth;k&&!S&&(O=x+u+w,this.direction==="rtl"&&(O=this.width-O-_),f.fillStyle=k,f.fillRect(O,v,_,h/this.lineHeight)),v+=h}f.fillStyle=p,this._removeShadow(f)}},getFontCache:function(f){var h=f.fontFamily.toLowerCase();a.charWidthsCache[h]||(a.charWidthsCache[h]={});var u=a.charWidthsCache[h],p=f.fontStyle.toLowerCase()+"_"+(f.fontWeight+"").toLowerCase();return u[p]||(u[p]={}),u[p]},_measureChar:function(f,h,u,p){var m=this.getFontCache(h),g=this._getFontDeclaration(h),x=this._getFontDeclaration(p),v=u+f,w=g===x,_,b,k,S=h.fontSize/this.CACHE_FONT_SIZE,O;if(u&&m[u]!==void 0&&(k=m[u]),m[f]!==void 0&&(O=_=m[f]),w&&m[v]!==void 0&&(b=m[v],O=b-k),_===void 0||k===void 0||b===void 0){var F=this.getMeasuringContext();this._setTextStyles(F,h,!0)}return _===void 0&&(O=_=F.measureText(f).width,m[f]=_),k===void 0&&w&&u&&(k=F.measureText(u).width,m[u]=k),w&&b===void 0&&(b=F.measureText(v).width,m[v]=b,O=b-k),{width:_*S,kernedWidth:O*S}},getHeightOfChar:function(f,h){return this.getValueOfPropertyAt(f,h,"fontSize")},measureLine:function(f){var h=this._measureLine(f);return this.charSpacing!==0&&(h.width-=this._getWidthOfCharSpacing()),h.width<0&&(h.width=0),h},_measureLine:function(f){var h=0,u,p,m=this._textLines[f],g,x,v=0,w=new Array(m.length),_=0,b,k,S=this.path,O=this.pathSide==="right";for(this.__charBounds[f]=w,u=0;u<m.length;u++)p=m[u],x=this._getGraphemeBox(p,f,u,g),w[u]=x,h+=x.kernedWidth,g=p;if(w[u]={left:x?x.left+x.width:0,width:0,kernedWidth:0,height:this.fontSize},S){switch(k=S.segmentsInfo[S.segmentsInfo.length-1].length,b=a.util.getPointOnPath(S.path,0,S.segmentsInfo),b.x+=S.pathOffset.x,b.y+=S.pathOffset.y,this.textAlign){case"left":_=O?k-h:0;break;case"center":_=(k-h)/2;break;case"right":_=O?0:k-h;break}for(_+=this.pathStartOffset*(O?-1:1),u=O?m.length-1:0;O?u>=0:u<m.length;O?u--:u++)x=w[u],_>k?_%=k:_<0&&(_+=k),this._setGraphemeOnPath(_,x,b),_+=x.kernedWidth}return{width:h,numOfSpaces:v}},_setGraphemeOnPath:function(f,h,u){var p=f+h.kernedWidth/2,m=this.path,g=a.util.getPointOnPath(m.path,p,m.segmentsInfo);h.renderLeft=g.x-u.x,h.renderTop=g.y-u.y,h.angle=g.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(f,h,u,p,m){var g=this.getCompleteStyleDeclaration(h,u),x=p?this.getCompleteStyleDeclaration(h,u-1):{},v=this._measureChar(f,g,p,x),w=v.kernedWidth,_=v.width,b;this.charSpacing!==0&&(b=this._getWidthOfCharSpacing(),_+=b,w+=b);var k={width:_,left:0,height:g.fontSize,kernedWidth:w,deltaY:g.deltaY};if(u>0&&!m){var S=this.__charBounds[h][u-1];k.left=S.left+S.width+v.kernedWidth-v.width}return k},getHeightOfLine:function(f){if(this.__lineHeights[f])return this.__lineHeights[f];for(var h=this._textLines[f],u=this.getHeightOfChar(f,0),p=1,m=h.length;p<m;p++)u=Math.max(this.getHeightOfChar(f,p),u);return this.__lineHeights[f]=u*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var f,h=0,u=0,p=this._textLines.length;u<p;u++)f=this.getHeightOfLine(u),h+=u===p-1?f/this.lineHeight:f;return h},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(f,h){f.save();for(var u=0,p=this._getLeftOffset(),m=this._getTopOffset(),g=0,x=this._textLines.length;g<x;g++){var v=this.getHeightOfLine(g),w=v/this.lineHeight,_=this._getLineLeftOffset(g);this._renderTextLine(h,f,this._textLines[g],p+_,m+u+w,g),u+=v}f.restore()},_renderTextFill:function(f){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(f,"fillText")},_renderTextStroke:function(f){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(f),f.save(),this._setLineDash(f,this.strokeDashArray),f.beginPath(),this._renderTextCommon(f,"strokeText"),f.closePath(),f.restore())},_renderChars:function(f,h,u,p,m,g){var x=this.getHeightOfLine(g),v=this.textAlign.indexOf("justify")!==-1,w,_,b="",k,S=0,O,F=this.path,D=!v&&this.charSpacing===0&&this.isEmptyStyles(g)&&!F,U=this.direction==="ltr",M=this.direction==="ltr"?1:-1,q,G=h.canvas.getAttribute("dir");if(h.save(),G!==this.direction&&(h.canvas.setAttribute("dir",U?"ltr":"rtl"),h.direction=U?"ltr":"rtl",h.textAlign=U?"left":"right"),m-=x*this._fontSizeFraction/this.lineHeight,D){this._renderChar(f,h,g,0,u.join(""),p,m,x),h.restore();return}for(var Q=0,K=u.length-1;Q<=K;Q++)O=Q===K||this.charSpacing||F,b+=u[Q],k=this.__charBounds[g][Q],S===0?(p+=M*(k.kernedWidth-k.width),S+=k.width):S+=k.kernedWidth,v&&!O&&this._reSpaceAndTab.test(u[Q])&&(O=!0),O||(w=w||this.getCompleteStyleDeclaration(g,Q),_=this.getCompleteStyleDeclaration(g,Q+1),O=a.util.hasStyleChanged(w,_,!1)),O&&(F?(h.save(),h.translate(k.renderLeft,k.renderTop),h.rotate(k.angle),this._renderChar(f,h,g,Q,b,-S/2,0,x),h.restore()):(q=p,this._renderChar(f,h,g,Q,b,q,m,x)),b="",w=_,p+=M*S,S=0);h.restore()},_applyPatternGradientTransformText:function(f){var h=a.util.createCanvasElement(),u,p=this.width+this.strokeWidth,m=this.height+this.strokeWidth;return h.width=p,h.height=m,u=h.getContext("2d"),u.beginPath(),u.moveTo(0,0),u.lineTo(p,0),u.lineTo(p,m),u.lineTo(0,m),u.closePath(),u.translate(p/2,m/2),u.fillStyle=f.toLive(u),this._applyPatternGradientTransform(u,f),u.fill(),u.createPattern(h,"no-repeat")},handleFiller:function(f,h,u){var p,m;return u.toLive?u.gradientUnits==="percentage"||u.gradientTransform||u.patternTransform?(p=-this.width/2,m=-this.height/2,f.translate(p,m),f[h]=this._applyPatternGradientTransformText(u),{offsetX:p,offsetY:m}):(f[h]=u.toLive(f,this),this._applyPatternGradientTransform(f,u)):(f[h]=u,{offsetX:0,offsetY:0})},_setStrokeStyles:function(f,h){return f.lineWidth=h.strokeWidth,f.lineCap=this.strokeLineCap,f.lineDashOffset=this.strokeDashOffset,f.lineJoin=this.strokeLineJoin,f.miterLimit=this.strokeMiterLimit,this.handleFiller(f,"strokeStyle",h.stroke)},_setFillStyles:function(f,h){return this.handleFiller(f,"fillStyle",h.fill)},_renderChar:function(f,h,u,p,m,g,x){var v=this._getStyleDeclaration(u,p),w=this.getCompleteStyleDeclaration(u,p),_=f==="fillText"&&w.fill,b=f==="strokeText"&&w.stroke&&w.strokeWidth,k,S;!b&&!_||(h.save(),_&&(k=this._setFillStyles(h,w)),b&&(S=this._setStrokeStyles(h,w)),h.font=this._getFontDeclaration(w),v&&v.textBackgroundColor&&this._removeShadow(h),v&&v.deltaY&&(x+=v.deltaY),_&&h.fillText(m,g-k.offsetX,x-k.offsetY),b&&h.strokeText(m,g-S.offsetX,x-S.offsetY),h.restore())},setSuperscript:function(f,h){return this._setScript(f,h,this.superscript)},setSubscript:function(f,h){return this._setScript(f,h,this.subscript)},_setScript:function(f,h,u){var p=this.get2DCursorLocation(f,!0),m=this.getValueOfPropertyAt(p.lineIndex,p.charIndex,"fontSize"),g=this.getValueOfPropertyAt(p.lineIndex,p.charIndex,"deltaY"),x={fontSize:m*u.size,deltaY:g+m*u.baseline};return this.setSelectionStyles(x,f,h),this},_getLineLeftOffset:function(f){var h=this.getLineWidth(f),u=this.width-h,p=this.textAlign,m=this.direction,x,g=0,x=this.isEndOfWrapping(f);return p==="justify"||p==="justify-center"&&!x||p==="justify-right"&&!x||p==="justify-left"&&!x?0:(p==="center"&&(g=u/2),p==="right"&&(g=u),p==="justify-center"&&(g=u/2),p==="justify-right"&&(g=u),m==="rtl"&&(g-=u),g)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var f=this._forceClearCache;return f||(f=this.hasStateChanged("_dimensionAffectingProps")),f&&(this.dirty=!0,this._forceClearCache=!1),f},getLineWidth:function(f){if(this.__lineWidths[f]!==void 0)return this.__lineWidths[f];var h=this.measureLine(f),u=h.width;return this.__lineWidths[f]=u,u},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(f,h,u){var p=this._getStyleDeclaration(f,h);return p&&typeof p[u]<"u"?p[u]:this[u]},_renderTextDecoration:function(f,h){if(!(!this[h]&&!this.styleHas(h))){f.save(),(h==="overline"||h==="linethrough")&&this._removeShadow(f);for(var u,p,m,g,x,v,w,_,b=this._getLeftOffset(),k=this._getTopOffset(),S,O,F,D,U,M,q,G,Q=this.path,K=this._getWidthOfCharSpacing(),ne=this.offsets[h],J=0,T=this._textLines.length;J<T;J++){if(u=this.getHeightOfLine(J),!this[h]&&!this.styleHas(h,J)){k+=u;continue}w=this._textLines[J],M=u/this.lineHeight,g=this._getLineLeftOffset(J),O=0,F=0,_=this.getValueOfPropertyAt(J,0,h),G=this.getValueOfPropertyAt(J,0,"fill"),S=k+M*(1-this._fontSizeFraction),p=this.getHeightOfChar(J,0),x=this.getValueOfPropertyAt(J,0,"deltaY");for(var j=0,B=w.length;j<B;j++)if(D=this.__charBounds[J][j],U=this.getValueOfPropertyAt(J,j,h),q=this.getValueOfPropertyAt(J,j,"fill"),m=this.getHeightOfChar(J,j),v=this.getValueOfPropertyAt(J,j,"deltaY"),Q&&U&&q)f.save(),f.fillStyle=G,f.translate(D.renderLeft,D.renderTop),f.rotate(D.angle),f.fillRect(-D.kernedWidth/2,ne*m+v,D.kernedWidth,this.fontSize/15),f.restore();else if((U!==_||q!==G||m!==p||v!==x)&&F>0){var E=b+g+O;this.direction==="rtl"&&(E=this.width-E-F),_&&G&&(f.fillStyle=G,f.fillRect(E,S+ne*p+x,F,this.fontSize/15)),O=D.left,F=D.width,_=U,G=q,p=m,x=v}else F+=D.kernedWidth;var E=b+g+O;this.direction==="rtl"&&(E=this.width-E-F),f.fillStyle=q,U&&q&&f.fillRect(E,S+ne*p+x,F-K,this.fontSize/15),k+=u}f.restore()}},_getFontDeclaration:function(f,h){var u=f||this,p=this.fontFamily,m=a.Text.genericFonts.indexOf(p.toLowerCase())>-1,g=p===void 0||p.indexOf("'")>-1||p.indexOf(",")>-1||p.indexOf('"')>-1||m?u.fontFamily:'"'+u.fontFamily+'"';return[a.isLikelyNode?u.fontWeight:u.fontStyle,a.isLikelyNode?u.fontStyle:u.fontWeight,h?this.CACHE_FONT_SIZE+"px":u.fontSize+"px",g].join(" ")},render:function(f){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",f)))},_splitTextIntoLines:function(f){for(var h=f.split(this._reNewline),u=new Array(h.length),p=[`
`],m=[],g=0;g<h.length;g++)u[g]=a.util.string.graphemeSplit(h[g]),m=m.concat(u[g],p);return m.pop(),{_unwrappedLines:u,lines:h,graphemeText:m,graphemeLines:u}},toObject:function(f){var h=d.concat(f),u=this.callSuper("toObject",h);return u.styles=a.util.stylesToArray(this.styles,this.text),u.path&&(u.path=this.path.toObject()),u},set:function(f,h){this.callSuper("set",f,h);var u=!1,p=!1;if(typeof f=="object")for(var m in f)m==="path"&&this.setPathInfo(),u=u||this._dimensionAffectingProps.indexOf(m)!==-1,p=p||m==="path";else u=this._dimensionAffectingProps.indexOf(f)!==-1,p=f==="path";return p&&this.setPathInfo(),u&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),a.Text.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),a.Text.DEFAULT_SVG_FONT_SIZE=16,a.Text.fromElement=function(f,h,u){if(!f)return h(null);var p=a.parseAttributes(f,a.Text.ATTRIBUTE_NAMES),m=p.textAnchor||"left";if(u=a.util.object.extend(u?c(u):{},p),u.top=u.top||0,u.left=u.left||0,p.textDecoration){var g=p.textDecoration;g.indexOf("underline")!==-1&&(u.underline=!0),g.indexOf("overline")!==-1&&(u.overline=!0),g.indexOf("line-through")!==-1&&(u.linethrough=!0),delete u.textDecoration}"dx"in p&&(u.left+=p.dx),"dy"in p&&(u.top+=p.dy),"fontSize"in u||(u.fontSize=a.Text.DEFAULT_SVG_FONT_SIZE);var x="";"textContent"in f?x=f.textContent:"firstChild"in f&&f.firstChild!==null&&"data"in f.firstChild&&f.firstChild.data!==null&&(x=f.firstChild.data),x=x.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var v=u.strokeWidth;u.strokeWidth=0;var w=new a.Text(x,u),_=w.getScaledHeight()/w.height,b=(w.height+w.strokeWidth)*w.lineHeight-w.height,k=b*_,S=w.getScaledHeight()+k,O=0;m==="center"&&(O=w.getScaledWidth()/2),m==="right"&&(O=w.getScaledWidth()),w.set({left:w.left-O,top:w.top-(S-w.fontSize*(.07+w._fontSizeFraction))/w.lineHeight,strokeWidth:typeof v<"u"?v:1}),h(w)},a.Text.fromObject=function(f,h){var u=c(f),p=f.path;return delete u.path,a.Object._fromObject("Text",u,function(m){m.styles=a.util.stylesFromArray(f.styles,f.text),p?a.Object._fromObject("Path",p,function(g){m.set("path",g),h(m)},"path"):h(m)},"text")},a.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],a.util.createAccessors&&a.util.createAccessors(a.Text)}(e),function(){t.util.object.extend(t.Text.prototype,{isEmptyStyles:function(o){if(!this.styles||typeof o<"u"&&!this.styles[o])return!0;var a=typeof o>"u"?this.styles:{line:this.styles[o]};for(var c in a)for(var d in a[c])for(var f in a[c][d])return!1;return!0},styleHas:function(o,a){if(!this.styles||!o||o===""||typeof a<"u"&&!this.styles[a])return!1;var c=typeof a>"u"?this.styles:{0:this.styles[a]};for(var d in c)for(var f in c[d])if(typeof c[d][f][o]<"u")return!0;return!1},cleanStyle:function(o){if(!this.styles||!o||o==="")return!1;var a=this.styles,c=0,d,f,h=!0,u=0,p;for(var m in a){d=0;for(var g in a[m]){var p=a[m][g],x=p.hasOwnProperty(o);c++,x?(f?p[o]!==f&&(h=!1):f=p[o],p[o]===this[o]&&delete p[o]):h=!1,Object.keys(p).length!==0?d++:delete a[m][g]}d===0&&delete a[m]}for(var v=0;v<this._textLines.length;v++)u+=this._textLines[v].length;h&&c===u&&(this[o]=f,this.removeStyle(o))},removeStyle:function(o){if(!(!this.styles||!o||o==="")){var a=this.styles,c,d,f;for(d in a){c=a[d];for(f in c)delete c[f][o],Object.keys(c[f]).length===0&&delete c[f];Object.keys(c).length===0&&delete a[d]}}},_extendStyles:function(o,a){var c=this.get2DCursorLocation(o);this._getLineStyle(c.lineIndex)||this._setLineStyle(c.lineIndex),this._getStyleDeclaration(c.lineIndex,c.charIndex)||this._setStyleDeclaration(c.lineIndex,c.charIndex,{}),t.util.object.extend(this._getStyleDeclaration(c.lineIndex,c.charIndex),a)},get2DCursorLocation:function(o,a){typeof o>"u"&&(o=this.selectionStart);for(var c=a?this._unwrappedTextLines:this._textLines,d=c.length,f=0;f<d;f++){if(o<=c[f].length)return{lineIndex:f,charIndex:o};o-=c[f].length+this.missingNewlineOffset(f,a)}return{lineIndex:f-1,charIndex:c[f-1].length<o?c[f-1].length:o}},getSelectionStyles:function(o,a,c){typeof o>"u"&&(o=this.selectionStart||0),typeof a>"u"&&(a=this.selectionEnd||o);for(var d=[],f=o;f<a;f++)d.push(this.getStyleAtPosition(f,c));return d},getStyleAtPosition:function(o,a){var c=this.get2DCursorLocation(o),d=a?this.getCompleteStyleDeclaration(c.lineIndex,c.charIndex):this._getStyleDeclaration(c.lineIndex,c.charIndex);return d||{}},setSelectionStyles:function(o,a,c){typeof a>"u"&&(a=this.selectionStart||0),typeof c>"u"&&(c=this.selectionEnd||a);for(var d=a;d<c;d++)this._extendStyles(d,o);return this._forceClearCache=!0,this},_getStyleDeclaration:function(o,a){var c=this.styles&&this.styles[o];return c?c[a]:null},getCompleteStyleDeclaration:function(o,a){for(var c=this._getStyleDeclaration(o,a)||{},d={},f,h=0;h<this._styleProperties.length;h++)f=this._styleProperties[h],d[f]=typeof c[f]>"u"?this[f]:c[f];return d},_setStyleDeclaration:function(o,a,c){this.styles[o][a]=c},_deleteStyleDeclaration:function(o,a){delete this.styles[o][a]},_getLineStyle:function(o){return!!this.styles[o]},_setLineStyle:function(o){this.styles[o]={}},_deleteLineStyle:function(o){delete this.styles[o]}})}(),function(){function o(a){a.textDecoration&&(a.textDecoration.indexOf("underline")>-1&&(a.underline=!0),a.textDecoration.indexOf("line-through")>-1&&(a.linethrough=!0),a.textDecoration.indexOf("overline")>-1&&(a.overline=!0),delete a.textDecoration)}t.IText=t.util.createClass(t.Text,t.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(a,c){this.callSuper("initialize",a,c),this.initBehavior()},setSelectionStart:function(a){a=Math.max(a,0),this._updateAndFire("selectionStart",a)},setSelectionEnd:function(a){a=Math.min(a,this.text.length),this._updateAndFire("selectionEnd",a)},_updateAndFire:function(a,c){this[a]!==c&&(this._fireSelectionChanged(),this[a]=c),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(a){this.clearContextTop(),this.callSuper("render",a),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(a){this.callSuper("_render",a)},clearContextTop:function(a){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var c=this.canvas.contextTop,d=this.canvas.viewportTransform;c.save(),c.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this.transform(c),this._clearTextArea(c),a||c.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var a=this._getCursorBoundaries(),c=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(a,c):this.renderSelection(a,c),c.restore()}},_clearTextArea:function(a){var c=this.width+4,d=this.height+4;a.clearRect(-c/2,-d/2,c,d)},_getCursorBoundaries:function(a){typeof a>"u"&&(a=this.selectionStart);var c=this._getLeftOffset(),d=this._getTopOffset(),f=this._getCursorBoundariesOffsets(a);return{left:c,top:d,leftOffset:f.left,topOffset:f.top}},_getCursorBoundariesOffsets:function(a){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var c,d,f,h=0,u=0,p,m=this.get2DCursorLocation(a);f=m.charIndex,d=m.lineIndex;for(var g=0;g<d;g++)h+=this.getHeightOfLine(g);c=this._getLineLeftOffset(d);var x=this.__charBounds[d][f];return x&&(u=x.left),this.charSpacing!==0&&f===this._textLines[d].length&&(u-=this._getWidthOfCharSpacing()),p={top:h,left:c+(u>0?u:0)},this.direction==="rtl"&&(p.left*=-1),this.cursorOffsetCache=p,this.cursorOffsetCache},renderCursor:function(a,c){var d=this.get2DCursorLocation(),f=d.lineIndex,h=d.charIndex>0?d.charIndex-1:0,u=this.getValueOfPropertyAt(f,h,"fontSize"),p=this.scaleX*this.canvas.getZoom(),m=this.cursorWidth/p,g=a.topOffset,x=this.getValueOfPropertyAt(f,h,"deltaY");g+=(1-this._fontSizeFraction)*this.getHeightOfLine(f)/this.lineHeight-u*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(a,c),c.fillStyle=this.cursorColor||this.getValueOfPropertyAt(f,h,"fill"),c.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,c.fillRect(a.left+a.leftOffset-m/2,g+a.top+x,m,u)},renderSelection:function(a,c){for(var d=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,f=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,h=this.textAlign.indexOf("justify")!==-1,u=this.get2DCursorLocation(d),p=this.get2DCursorLocation(f),m=u.lineIndex,g=p.lineIndex,x=u.charIndex<0?0:u.charIndex,v=p.charIndex<0?0:p.charIndex,w=m;w<=g;w++){var _=this._getLineLeftOffset(w)||0,b=this.getHeightOfLine(w),k=0,S=0,O=0;if(w===m&&(S=this.__charBounds[m][x].left),w>=m&&w<g)O=h&&!this.isEndOfWrapping(w)?this.width:this.getLineWidth(w)||5;else if(w===g)if(v===0)O=this.__charBounds[g][v].left;else{var F=this._getWidthOfCharSpacing();O=this.__charBounds[g][v-1].left+this.__charBounds[g][v-1].width-F}k=b,(this.lineHeight<1||w===g&&this.lineHeight>1)&&(b/=this.lineHeight);var D=a.left+_+S,U=O-S,M=b,q=0;this.inCompositionMode?(c.fillStyle=this.compositionColor||"black",M=1,q=b):c.fillStyle=this.selectionColor,this.direction==="rtl"&&(D=this.width-D-U),c.fillRect(D,a.top+a.topOffset+q,U,M),a.topOffset+=k}},getCurrentCharFontSize:function(){var a=this._getCurrentCharIndex();return this.getValueOfPropertyAt(a.l,a.c,"fontSize")},getCurrentCharColor:function(){var a=this._getCurrentCharIndex();return this.getValueOfPropertyAt(a.l,a.c,"fill")},_getCurrentCharIndex:function(){var a=this.get2DCursorLocation(this.selectionStart,!0),c=a.charIndex>0?a.charIndex-1:0;return{l:a.lineIndex,c}}}),t.IText.fromObject=function(a,c){var d=t.util.stylesFromArray(a.styles,a.text),f=Object.assign({},a,{styles:d});if(delete f.path,o(f),f.styles)for(var h in f.styles)for(var u in f.styles[h])o(f.styles[h][u]);t.Object._fromObject("IText",f,function(p){a.path?t.Object._fromObject("Path",a.path,function(m){p.set("path",m),c(p)},"path"):c(p)},"text")}}(),function(){var o=t.util.object.clone;t.util.object.extend(t.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var a=this;this.on("added",function(){var c=a.canvas;c&&(c._hasITextHandlers||(c._hasITextHandlers=!0,a._initCanvasHandlers(c)),c._iTextInstances=c._iTextInstances||[],c._iTextInstances.push(a))})},initRemovedHandler:function(){var a=this;this.on("removed",function(){var c=a.canvas;c&&(c._iTextInstances=c._iTextInstances||[],t.util.removeFromArray(c._iTextInstances,a),c._iTextInstances.length===0&&(c._hasITextHandlers=!1,a._removeCanvasHandlers(c)))})},_initCanvasHandlers:function(a){a._mouseUpITextHandler=function(){a._iTextInstances&&a._iTextInstances.forEach(function(c){c.__isMousedown=!1})},a.on("mouse:up",a._mouseUpITextHandler)},_removeCanvasHandlers:function(a){a.off("mouse:up",a._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(a,c,d,f){var h;return h={isAborted:!1,abort:function(){this.isAborted=!0}},a.animate("_currentCursorOpacity",c,{duration:d,onComplete:function(){h.isAborted||a[f]()},onChange:function(){a.canvas&&a.selectionStart===a.selectionEnd&&a.renderCursorOrSelection()},abort:function(){return h.isAborted}}),h},_onTickComplete:function(){var a=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){a._currentTickCompleteState=a._animateCursor(a,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(a){var c=this,d=a?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){c._tick()},d)},abortCursorAnimation:function(){var a=this._currentTickState||this._currentTickCompleteState,c=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,a&&c&&c.clearContext(c.contextTop||c.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(a){var c=0,d=a-1;if(this._reSpace.test(this._text[d]))for(;this._reSpace.test(this._text[d]);)c++,d--;for(;/\S/.test(this._text[d])&&d>-1;)c++,d--;return a-c},findWordBoundaryRight:function(a){var c=0,d=a;if(this._reSpace.test(this._text[d]))for(;this._reSpace.test(this._text[d]);)c++,d++;for(;/\S/.test(this._text[d])&&d<this._text.length;)c++,d++;return a+c},findLineBoundaryLeft:function(a){for(var c=0,d=a-1;!/\n/.test(this._text[d])&&d>-1;)c++,d--;return a-c},findLineBoundaryRight:function(a){for(var c=0,d=a;!/\n/.test(this._text[d])&&d<this._text.length;)c++,d++;return a+c},searchWordBoundary:function(a,c){for(var d=this._text,f=this._reSpace.test(d[a])?a-1:a,h=d[f],u=t.reNonWord;!u.test(h)&&f>0&&f<d.length;)f+=c,h=d[f];return u.test(h)&&(f+=c===1?0:1),f},selectWord:function(a){a=a||this.selectionStart;var c=this.searchWordBoundary(a,-1),d=this.searchWordBoundary(a,1);this.selectionStart=c,this.selectionEnd=d,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(a){a=a||this.selectionStart;var c=this.findLineBoundaryLeft(a),d=this.findLineBoundaryRight(a);return this.selectionStart=c,this.selectionEnd=d,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(a){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(a),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(a){a._iTextInstances&&a._iTextInstances.forEach(function(c){c.selected=!1,c.isEditing&&c.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(a){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var c=this.getSelectionStartFromPointer(a.e),d=this.selectionStart,f=this.selectionEnd;(c!==this.__selectionStartOnMouseDown||d===f)&&(d===c||f===c)||(c>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=c):(this.selectionStart=c,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==d||this.selectionEnd!==f)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(a,c,d){var f=d.slice(0,a),h=t.util.string.graphemeSplit(f).length;if(a===c)return{selectionStart:h,selectionEnd:h};var u=d.slice(a,c),p=t.util.string.graphemeSplit(u).length;return{selectionStart:h,selectionEnd:h+p}},fromGraphemeToStringSelection:function(a,c,d){var f=d.slice(0,a),h=f.join("").length;if(a===c)return{selectionStart:h,selectionEnd:h};var u=d.slice(a,c),p=u.join("").length;return{selectionStart:h,selectionEnd:h+p}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var a=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=a.selectionStart,this.hiddenTextarea.selectionEnd=a.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var a=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=a.selectionEnd,this.inCompositionMode||(this.selectionStart=a.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var a=this._calcTextareaPosition();this.hiddenTextarea.style.left=a.left,this.hiddenTextarea.style.top=a.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var a=this.inCompositionMode?this.compositionStart:this.selectionStart,c=this._getCursorBoundaries(a),d=this.get2DCursorLocation(a),f=d.lineIndex,h=d.charIndex,u=this.getValueOfPropertyAt(f,h,"fontSize")*this.lineHeight,p=c.leftOffset,m=this.calcTransformMatrix(),g={x:c.left+p,y:c.top+c.topOffset+u},x=this.canvas.getRetinaScaling(),v=this.canvas.upperCanvasEl,w=v.width/x,_=v.height/x,b=w-u,k=_-u,S=v.clientWidth/w,O=v.clientHeight/_;return g=t.util.transformPoint(g,m),g=t.util.transformPoint(g,this.canvas.viewportTransform),g.x*=S,g.y*=O,g.x<0&&(g.x=0),g.x>b&&(g.x=b),g.y<0&&(g.y=0),g.y>k&&(g.y=k),g.x+=this.canvas._offset.left,g.y+=this.canvas._offset.top,{left:g.x+"px",top:g.y+"px",fontSize:u+"px",charHeight:u}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var a=this._textBeforeEdit!==this.text,c=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,c&&(c.blur&&c.blur(),c.parentNode&&c.parentNode.removeChild(c)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),a&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),a&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var a in this.styles)this._textLines[a]||delete this.styles[a]},removeStyleFromTo:function(a,c){var d=this.get2DCursorLocation(a,!0),f=this.get2DCursorLocation(c,!0),h=d.lineIndex,u=d.charIndex,p=f.lineIndex,m=f.charIndex,g,x;if(h!==p){if(this.styles[h])for(g=u;g<this._unwrappedTextLines[h].length;g++)delete this.styles[h][g];if(this.styles[p])for(g=m;g<this._unwrappedTextLines[p].length;g++)x=this.styles[p][g],x&&(this.styles[h]||(this.styles[h]={}),this.styles[h][u+g-m]=x);for(g=h+1;g<=p;g++)delete this.styles[g];this.shiftLineStyles(p,h-p)}else if(this.styles[h]){x=this.styles[h];var v=m-u,w,_;for(g=u;g<m;g++)delete x[g];for(_ in this.styles[h])w=parseInt(_,10),w>=m&&(x[w-v]=x[_],delete x[_])}},shiftLineStyles:function(a,c){var d=o(this.styles);for(var f in this.styles){var h=parseInt(f,10);h>a&&(this.styles[h+c]=d[h],d[h-c]||delete this.styles[h])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(a,c,d,f){var h,u={},p=!1,m=this._unwrappedTextLines[a].length,g=m===c;d||(d=1),this.shiftLineStyles(a,d),this.styles[a]&&(h=this.styles[a][c===0?c:c-1]);for(var x in this.styles[a]){var v=parseInt(x,10);v>=c&&(p=!0,u[v-c]=this.styles[a][x],g&&c===0||delete this.styles[a][x])}var w=!1;for(p&&!g&&(this.styles[a+d]=u,w=!0),(w||m>c)&&d--;d>0;)f&&f[d-1]?this.styles[a+d]={0:o(f[d-1])}:h?this.styles[a+d]={0:o(h)}:delete this.styles[a+d],d--;this._forceClearCache=!0},insertCharStyleObject:function(a,c,d,f){this.styles||(this.styles={});var h=this.styles[a],u=h?o(h):{};d||(d=1);for(var p in u){var m=parseInt(p,10);m>=c&&(h[m+d]=u[m],u[m-d]||delete h[m])}if(this._forceClearCache=!0,f){for(;d--;)Object.keys(f[d]).length&&(this.styles[a]||(this.styles[a]={}),this.styles[a][c+d]=o(f[d]));return}if(h)for(var g=h[c?c-1:1];g&&d--;)this.styles[a][c+d]=o(g)},insertNewStyleBlock:function(a,c,d){for(var f=this.get2DCursorLocation(c,!0),h=[0],u=0,p=0;p<a.length;p++)a[p]===`
`?(u++,h[u]=0):h[u]++;h[0]>0&&(this.insertCharStyleObject(f.lineIndex,f.charIndex,h[0],d),d=d&&d.slice(h[0]+1)),u&&this.insertNewlineStyleObject(f.lineIndex,f.charIndex+h[0],u);for(var p=1;p<u;p++)h[p]>0?this.insertCharStyleObject(f.lineIndex+p,0,h[p],d):d&&this.styles[f.lineIndex+p]&&d[0]&&(this.styles[f.lineIndex+p][0]=d[0]),d=d&&d.slice(h[p]+1);h[p]>0&&this.insertCharStyleObject(f.lineIndex+p,0,h[p],d)},setSelectionStartEndWithShift:function(a,c,d){d<=a?(c===a?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=a),this.selectionStart=d):d>a&&d<c?this._selectionDirection==="right"?this.selectionEnd=d:this.selectionStart=d:(c===a?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=c),this.selectionEnd=d)},setSelectionInBoundaries:function(){var a=this.text.length;this.selectionStart>a?this.selectionStart=a:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>a?this.selectionEnd=a:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),t.util.object.extend(t.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(o){if(this.canvas){this.__newClickTime=+new Date;var a=o.pointer;this.isTripleClick(a)&&(this.fire("tripleclick",o),this._stopEvent(o.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=a,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(o){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===o.x&&this.__lastPointer.y===o.y},_stopEvent:function(o){o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(o){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(o.e))},tripleClickHandler:function(o){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(o.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(o){!this.canvas||!this.editable||o.e.button&&o.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(o.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(o){!this.canvas||!this.editable||o.e.button&&o.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(o){if(this.__isMousedown=!1,!(!this.editable||this.group||o.transform&&o.transform.actionPerformed||o.e.button&&o.e.button!==1)){if(this.canvas){var a=this.canvas._activeObject;if(a&&a!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(o.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(o){var a=this.getSelectionStartFromPointer(o),c=this.selectionStart,d=this.selectionEnd;o.shiftKey?this.setSelectionStartEndWithShift(c,d,a):(this.selectionStart=a,this.selectionEnd=a),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(o){for(var a=this.getLocalPointer(o),c=0,d=0,f=0,h=0,u=0,p,m,g=0,x=this._textLines.length;g<x&&f<=a.y;g++)f+=this.getHeightOfLine(g)*this.scaleY,u=g,g>0&&(h+=this._textLines[g-1].length+this.missingNewlineOffset(g-1));p=this._getLineLeftOffset(u),d=p*this.scaleX,m=this._textLines[u],this.direction==="rtl"&&(a.x=this.width*this.scaleX-a.x+d);for(var v=0,w=m.length;v<w&&(c=d,d+=this.__charBounds[u][v].kernedWidth*this.scaleX,d<=a.x);v++)h++;return this._getNewSelectionStartFromOffset(a,c,d,h,w)},_getNewSelectionStartFromOffset:function(o,a,c,d,f){var h=o.x-a,u=c-o.x,p=u>h||u<0?0:1,m=d+p;return this.flipX&&(m=f-m),m>this._text.length&&(m=this._text.length),m}}),t.util.object.extend(t.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=t.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var o=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+o.top+"; left: "+o.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+o.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):t.document.body.appendChild(this.hiddenTextarea),t.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),t.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),t.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),t.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(t.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(o){if(this.isEditing){var a=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(o.keyCode in a)this[a[o.keyCode]](o);else if(o.keyCode in this.ctrlKeysMapDown&&(o.ctrlKey||o.metaKey))this[this.ctrlKeysMapDown[o.keyCode]](o);else return;o.stopImmediatePropagation(),o.preventDefault(),o.keyCode>=33&&o.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(o){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(o.keyCode in this.ctrlKeysMapUp&&(o.ctrlKey||o.metaKey))this[this.ctrlKeysMapUp[o.keyCode]](o);else return;o.stopImmediatePropagation(),o.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(o){var a=this.fromPaste;if(this.fromPaste=!1,o&&o.stopPropagation(),!!this.isEditing){var c=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,d=this._text.length,f=c.length,h,u,p=f-d,m=this.selectionStart,g=this.selectionEnd,x=m!==g,v,w,_;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var b=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),k=m>b.selectionStart;x?(h=this._text.slice(m,g),p+=g-m):f<d&&(k?h=this._text.slice(g+p,g):h=this._text.slice(m,m-p)),u=c.slice(b.selectionEnd-p,b.selectionEnd),h&&h.length&&(u.length&&(v=this.getSelectionStyles(m,m+1,!1),v=u.map(function(){return v[0]})),x?(w=m,_=g):k?(w=g-h.length,_=g):(w=g,_=g+h.length),this.removeStyleFromTo(w,_)),u.length&&(a&&u.join("")===t.copiedText&&!t.disableStyleCopyPaste&&(v=t.copiedTextStyle),this.insertNewStyleBlock(u,m,v)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(o){this.compositionStart=o.target.selectionStart,this.compositionEnd=o.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(t.copiedText=this.getSelectedText(),t.disableStyleCopyPaste?t.copiedTextStyle=null:t.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(o){return o&&o.clipboardData||t.window.clipboardData},_getWidthBeforeCursor:function(o,a){var c=this._getLineLeftOffset(o),d;return a>0&&(d=this.__charBounds[o][a-1],c+=d.left+d.width),c},getDownCursorOffset:function(o,a){var c=this._getSelectionForOffset(o,a),d=this.get2DCursorLocation(c),f=d.lineIndex;if(f===this._textLines.length-1||o.metaKey||o.keyCode===34)return this._text.length-c;var h=d.charIndex,u=this._getWidthBeforeCursor(f,h),p=this._getIndexOnLine(f+1,u),m=this._textLines[f].slice(h);return m.length+p+1+this.missingNewlineOffset(f)},_getSelectionForOffset:function(o,a){return o.shiftKey&&this.selectionStart!==this.selectionEnd&&a?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(o,a){var c=this._getSelectionForOffset(o,a),d=this.get2DCursorLocation(c),f=d.lineIndex;if(f===0||o.metaKey||o.keyCode===33)return-c;var h=d.charIndex,u=this._getWidthBeforeCursor(f,h),p=this._getIndexOnLine(f-1,u),m=this._textLines[f].slice(0,h),g=this.missingNewlineOffset(f-1);return-this._textLines[f-1].length+p-m.length+(1-g)},_getIndexOnLine:function(o,a){for(var c=this._textLines[o],d=this._getLineLeftOffset(o),f=d,h=0,u,p,m=0,g=c.length;m<g;m++)if(u=this.__charBounds[o][m].width,f+=u,f>a){p=!0;var x=f-u,v=f,w=Math.abs(x-a),_=Math.abs(v-a);h=_<w?m:m-1;break}return p||(h=c.length-1),h},moveCursorDown:function(o){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",o)},moveCursorUp:function(o){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",o)},_moveCursorUpOrDown:function(o,a){var c="get"+o+"CursorOffset",d=this[c](a,this._selectionDirection==="right");a.shiftKey?this.moveCursorWithShift(d):this.moveCursorWithoutShift(d),d!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(o){var a=this._selectionDirection==="left"?this.selectionStart+o:this.selectionEnd+o;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,a),o!==0},moveCursorWithoutShift:function(o){return o<0?(this.selectionStart+=o,this.selectionEnd=this.selectionStart):(this.selectionEnd+=o,this.selectionStart=this.selectionEnd),o!==0},moveCursorLeft:function(o){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",o)},_move:function(o,a,c){var d;if(o.altKey)d=this["findWordBoundary"+c](this[a]);else if(o.metaKey||o.keyCode===35||o.keyCode===36)d=this["findLineBoundary"+c](this[a]);else return this[a]+=c==="Left"?-1:1,!0;if(typeof d<"u"&&this[a]!==d)return this[a]=d,!0},_moveLeft:function(o,a){return this._move(o,a,"Left")},_moveRight:function(o,a){return this._move(o,a,"Right")},moveCursorLeftWithoutShift:function(o){var a=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(a=this._moveLeft(o,"selectionStart")),this.selectionEnd=this.selectionStart,a},moveCursorLeftWithShift:function(o){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(o,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(o,"selectionStart")},moveCursorRight:function(o){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",o)},_moveCursorLeftOrRight:function(o,a){var c="moveCursor"+o+"With";this._currentCursorOpacity=1,a.shiftKey?c+="Shift":c+="outShift",this[c](a)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(o){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(o,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(o,"selectionEnd")},moveCursorRightWithoutShift:function(o){var a=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(a=this._moveRight(o,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,a},removeChars:function(o,a){typeof a>"u"&&(a=o+1),this.removeStyleFromTo(o,a),this._text.splice(o,a-o),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(o,a,c,d){typeof d>"u"&&(d=c),d>c&&this.removeStyleFromTo(c,d);var f=t.util.string.graphemeSplit(o);this.insertNewStyleBlock(f,c,a),this._text=[].concat(this._text.slice(0,c),f,this._text.slice(d)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var o=t.util.toFixed,a=t.util.radiansToDegrees,c=t.util.calcRotateMatrix,d=t.util.transformPoint,f=/  +/g;t.util.object.extend(t.Text.prototype,{_toSVG:function(){var h=this._getSVGLeftTopOffsets(),u=this._getSVGTextAndBg(h.textTop,h.textLeft);return this._wrapSVGTextAndBg(u)},toSVG:function(h){var u=this._createBaseSVGMarkup(this._toSVG(),{reviver:h,noStyle:!0,withShadow:!0}),p=this.path;return p?u+p._createBaseSVGMarkup(p._toSVG(),{reviver:h,withShadow:!0}):u},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(h){var u=!0,p=this.getSvgTextDecoration(this);return[h.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",p?'text-decoration="'+p+'" ':"",'style="',this.getSvgStyles(u),'"',this.addPaintOrder()," >",h.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(h,u){var p=[],m=[],g=h,x;this._setSVGBg(m);for(var v=0,w=this._textLines.length;v<w;v++)x=this._getLineLeftOffset(v),(this.textBackgroundColor||this.styleHas("textBackgroundColor",v))&&this._setSVGTextLineBg(m,v,u+x,g),this._setSVGTextLineText(p,v,u+x,g),g+=this.getHeightOfLine(v);return{textSpans:p,textBgRects:m}},_createTextCharSpan:function(h,u,p,m,g){var x=h!==h.trim()||h.match(f),v=this.getSvgSpanStyles(u,x),w=v?'style="'+v+'"':"",_=u.deltaY,b="",k=t.Object.NUM_FRACTION_DIGITS,S="";if(_&&(b=' dy="'+o(_,k)+'" '),g.renderLeft!==void 0){var O=g.angle;S=' rotate="'+o(a(O),t.Object.NUM_FRACTION_DIGITS)+'" ';var F=g.width/2,D=c({angle:a(O)});D[4]=g.renderLeft,D[5]=g.renderTop;var U=d({x:-F,y:0},D);p=U.x,m=U.y}return['<tspan x="',o(p,k),'" y="',o(m,k),'" ',b,w,S,">",t.util.string.escapeXml(h),"</tspan>"].join("")},_setSVGTextLineText:function(h,u,p,m){var g=this.getHeightOfLine(u),x=this.textAlign.indexOf("justify")!==-1,v,w,_="",b,k,S=0,O=this._textLines[u],F;m+=g*(1-this._fontSizeFraction)/this.lineHeight;for(var D=0,U=O.length-1;D<=U;D++)F=D===U||this.charSpacing||this.path,_+=O[D],b=this.__charBounds[u][D],S===0?(p+=b.kernedWidth-b.width,S+=b.width):S+=b.kernedWidth,x&&!F&&this._reSpaceAndTab.test(O[D])&&(F=!0),F||(v=v||this.getCompleteStyleDeclaration(u,D),w=this.getCompleteStyleDeclaration(u,D+1),F=t.util.hasStyleChanged(v,w,!0)),F&&(k=this._getStyleDeclaration(u,D)||{},h.push(this._createTextCharSpan(_,k,p,m,b)),_="",v=w,p+=S,S=0)},_pushTextBgRect:function(h,u,p,m,g,x){var v=t.Object.NUM_FRACTION_DIGITS;h.push("		<rect ",this._getFillAttributes(u),' x="',o(p,v),'" y="',o(m,v),'" width="',o(g,v),'" height="',o(x,v),`"></rect>
`)},_setSVGTextLineBg:function(h,u,p,m){for(var g=this._textLines[u],x=this.getHeightOfLine(u)/this.lineHeight,v=0,w=0,_,b,k=this.getValueOfPropertyAt(u,0,"textBackgroundColor"),S=0,O=g.length;S<O;S++)_=this.__charBounds[u][S],b=this.getValueOfPropertyAt(u,S,"textBackgroundColor"),b!==k?(k&&this._pushTextBgRect(h,k,p+w,m,v,x),w=_.left,v=_.width,k=b):v+=_.kernedWidth;b&&this._pushTextBgRect(h,b,p+w,m,v,x)},_getFillAttributes:function(h){var u=h&&typeof h=="string"?new t.Color(h):"";return!u||!u.getSource()||u.getAlpha()===1?'fill="'+h+'"':'opacity="'+u.getAlpha()+'" fill="'+u.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(h){for(var u=0,p=0,m=0;m<h;m++)u+=this.getHeightOfLine(m);return p=this.getHeightOfLine(m),{lineTop:u,offset:(this._fontSizeMult-this._fontSizeFraction)*p/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(h){var u=t.Object.prototype.getSvgStyles.call(this,h);return u+" white-space: pre;"}})}(),function(o){var a=o.fabric||(o.fabric={});a.Textbox=a.util.createClass(a.IText,a.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:a.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(c){for(var d=0,f=0,h=0,u={},p=0;p<c.graphemeLines.length;p++)c.graphemeText[h]===`
`&&p>0?(f=0,h++,d++):!this.splitByGrapheme&&this._reSpaceAndTab.test(c.graphemeText[h])&&p>0&&(f++,h++),u[p]={line:d,offset:f},h+=c.graphemeLines[p].length,f+=c.graphemeLines[p].length;return u},styleHas:function(c,d){if(this._styleMap&&!this.isWrapping){var f=this._styleMap[d];f&&(d=f.line)}return a.Text.prototype.styleHas.call(this,c,d)},isEmptyStyles:function(c){if(!this.styles)return!0;var d=0,f=c+1,h,u,p=!1,m=this._styleMap[c],g=this._styleMap[c+1];m&&(c=m.line,d=m.offset),g&&(f=g.line,p=f===c,h=g.offset),u=typeof c>"u"?this.styles:{line:this.styles[c]};for(var x in u)for(var v in u[x])if(v>=d&&(!p||v<h))for(var w in u[x][v])return!1;return!0},_getStyleDeclaration:function(c,d){if(this._styleMap&&!this.isWrapping){var f=this._styleMap[c];if(!f)return null;c=f.line,d=f.offset+d}return this.callSuper("_getStyleDeclaration",c,d)},_setStyleDeclaration:function(c,d,f){var h=this._styleMap[c];c=h.line,d=h.offset+d,this.styles[c][d]=f},_deleteStyleDeclaration:function(c,d){var f=this._styleMap[c];c=f.line,d=f.offset+d,delete this.styles[c][d]},_getLineStyle:function(c){var d=this._styleMap[c];return!!this.styles[d.line]},_setLineStyle:function(c){var d=this._styleMap[c];this.styles[d.line]={}},_wrapText:function(c,d){var f=[],h;for(this.isWrapping=!0,h=0;h<c.length;h++)f=f.concat(this._wrapLine(c[h],h,d));return this.isWrapping=!1,f},_measureWord:function(c,d,f){var h=0,u,p=!0;f=f||0;for(var m=0,g=c.length;m<g;m++){var x=this._getGraphemeBox(c[m],d,m+f,u,p);h+=x.kernedWidth,u=c[m]}return h},_wrapLine:function(c,d,f,D){var u=0,p=this.splitByGrapheme,m=[],g=[],x=p?a.util.string.graphemeSplit(c):c.split(this._wordJoiners),v="",w=0,_=p?"":" ",b=0,k=0,S=0,O=!0,F=this._getWidthOfCharSpacing(),D=D||0;x.length===0&&x.push([]),f-=D;for(var U=0;U<x.length;U++)v=p?x[U]:a.util.string.graphemeSplit(x[U]),b=this._measureWord(v,d,w),w+=v.length,u+=k+b-F,u>f&&!O?(m.push(g),g=[],u=b,O=!0):u+=F,!O&&!p&&g.push(_),g=g.concat(v),k=p?0:this._measureWord([_],d,w),w++,O=!1,b>S&&(S=b);return U&&m.push(g),S+D>this.dynamicMinWidth&&(this.dynamicMinWidth=S-F+D),m},isEndOfWrapping:function(c){return!this._styleMap[c+1]||this._styleMap[c+1].line!==this._styleMap[c].line},missingNewlineOffset:function(c,d){return this.splitByGrapheme&&!d?this.isEndOfWrapping(c)?1:0:1},_splitTextIntoLines:function(c){for(var d=a.Text.prototype._splitTextIntoLines.call(this,c),f=this._wrapText(d.lines,this.width),h=new Array(f.length),u=0;u<f.length;u++)h[u]=f[u].join("");return d.lines=h,d.graphemeLines=f,d},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var c={};for(var d in this._styleMap)this._textLines[d]&&(c[this._styleMap[d].line]=1);for(var d in this.styles)c[d]||delete this.styles[d]},toObject:function(c){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(c))}}),a.Textbox.fromObject=function(c,d){var f=a.util.stylesFromArray(c.styles,c.text),h=Object.assign({},c,{styles:f});return delete h.path,a.Object._fromObject("Textbox",h,function(u){c.path?a.Object._fromObject("Path",c.path,function(p){u.set("path",p),d(u)},"path"):d(u)},"text")}}(e),function(){var o=t.controlsUtils,a=o.scaleSkewCursorStyleHandler,c=o.scaleCursorStyleHandler,d=o.scalingEqually,f=o.scalingYOrSkewingX,h=o.scalingXOrSkewingY,u=o.scaleOrSkewActionName,p=t.Object.prototype.controls;if(p.ml=new t.Control({x:-.5,y:0,cursorStyleHandler:a,actionHandler:h,getActionName:u}),p.mr=new t.Control({x:.5,y:0,cursorStyleHandler:a,actionHandler:h,getActionName:u}),p.mb=new t.Control({x:0,y:.5,cursorStyleHandler:a,actionHandler:f,getActionName:u}),p.mt=new t.Control({x:0,y:-.5,cursorStyleHandler:a,actionHandler:f,getActionName:u}),p.tl=new t.Control({x:-.5,y:-.5,cursorStyleHandler:c,actionHandler:d}),p.tr=new t.Control({x:.5,y:-.5,cursorStyleHandler:c,actionHandler:d}),p.bl=new t.Control({x:-.5,y:.5,cursorStyleHandler:c,actionHandler:d}),p.br=new t.Control({x:.5,y:.5,cursorStyleHandler:c,actionHandler:d}),p.mtr=new t.Control({x:0,y:-.5,actionHandler:o.rotationWithSnapping,cursorStyleHandler:o.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),t.Textbox){var m=t.Textbox.prototype.controls={};m.mtr=p.mtr,m.tr=p.tr,m.br=p.br,m.tl=p.tl,m.bl=p.bl,m.mt=p.mt,m.mb=p.mb,m.mr=new t.Control({x:.5,y:0,actionHandler:o.changeWidth,cursorStyleHandler:a,actionName:"resizing"}),m.ml=new t.Control({x:-.5,y:0,actionHandler:o.changeWidth,cursorStyleHandler:a,actionName:"resizing"})}}()})($e);function Gu(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Ik(e,t,r,n){function i(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function o(d){try{c(n.next(d))}catch(f){l(f)}}function a(d){try{c(n.throw(d))}catch(f){l(f)}}function c(d){d.done?s(d.value):i(d.value).then(o,a)}c((n=n.apply(e,t||[])).next())})}const Mk=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class T0 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Lk extends T0{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class jg extends T0{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Pg extends T0{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var ad;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(ad||(ad={}));class Bk{constructor(t,{headers:r={},customFetch:n,region:i=ad.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=Mk(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Ik(this,arguments,void 0,function*(r,n={}){var i;let s,l;try{const{headers:o,method:a,body:c,signal:d,timeout:f}=n;let h={},{region:u}=n;u||(u=this.region);const p=new URL(`${this.url}/${r}`);u&&u!=="any"&&(h["x-region"]=u,p.searchParams.set("forceFunctionRegion",u));let m;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",m=c):typeof c=="string"?(h["Content-Type"]="text/plain",m=c):typeof FormData<"u"&&c instanceof FormData?m=c:(h["Content-Type"]="application/json",m=JSON.stringify(c)):c&&typeof c!="string"&&!(typeof Blob<"u"&&c instanceof Blob)&&!(c instanceof ArrayBuffer)&&!(typeof FormData<"u"&&c instanceof FormData)?m=JSON.stringify(c):m=c;let g=d;f&&(l=new AbortController,s=setTimeout(()=>l.abort(),f),d?(g=l.signal,d.addEventListener("abort",()=>l.abort())):g=l.signal);const x=yield this.fetch(p.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),o),body:m,signal:g}).catch(b=>{throw new Lk(b)}),v=x.headers.get("x-relay-error");if(v&&v==="true")throw new jg(x);if(!x.ok)throw new Pg(x);let w=((i=x.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),_;return w==="application/json"?_=yield x.json():w==="application/octet-stream"||w==="application/pdf"?_=yield x.blob():w==="text/event-stream"?_=x:w==="multipart/form-data"?_=yield x.formData():_=yield x.text(),{data:_,error:null,response:x}}catch(o){return{data:null,error:o,response:o instanceof Pg||o instanceof jg?o.context:void 0}}finally{s&&clearTimeout(s)}})}}var Uk=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},Wk=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{let l=null,o=null,a=null,c=s.status,d=s.statusText;if(s.ok){var f,h;if(r.method!=="HEAD"){var u;const x=await s.text();x===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((u=r.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?o=x:o=JSON.parse(x))}const m=(f=r.headers.get("Prefer"))===null||f===void 0?void 0:f.match(/count=(exact|planned|estimated)/),g=(h=s.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");m&&g&&g.length>1&&(a=parseInt(g[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(o)&&(o.length>1?(l={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,a=null,c=406,d="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var p;const m=await s.text();try{l=JSON.parse(m),Array.isArray(l)&&s.status===404&&(o=[],l=null,c=200,d="OK")}catch{s.status===404&&m===""?(c=204,d="No Content"):l={message:m}}if(l&&r.isMaybeSingle&&(!(l==null||(p=l.details)===null||p===void 0)&&p.includes("0 rows"))&&(l=null,c=200,d="OK"),l&&r.shouldThrowOnError)throw new Uk(l)}return{error:l,data:o,count:a,status:c,statusText:d}});return this.shouldThrowOnError||(i=i.catch(s=>{var l;let o="";const a=s==null?void 0:s.cause;if(a){var c,d,f,h;const p=(c=a==null?void 0:a.message)!==null&&c!==void 0?c:"",m=(d=a==null?void 0:a.code)!==null&&d!==void 0?d:"";o=`${(f=s==null?void 0:s.name)!==null&&f!==void 0?f:"FetchError"}: ${s==null?void 0:s.message}`,o+=`

Caused by: ${(h=a==null?void 0:a.name)!==null&&h!==void 0?h:"Error"}: ${p}`,m&&(o+=` (${m})`),a!=null&&a.stack&&(o+=`
${a.stack}`)}else{var u;o=(u=s==null?void 0:s.stack)!==null&&u!==void 0?u:""}return{error:{message:`${(l=s==null?void 0:s.name)!==null&&l!==void 0?l:"FetchError"}: ${s==null?void 0:s.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}},zk=class extends Wk{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const s=i?`${i}.order`:"order",l=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"offset":`${n}.offset`,s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(s,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:s="text"}={}){var l;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),a=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${s}; for="${a}"; options=${o};`),s==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const Dg=new RegExp("[,()]");var ra=class extends zk{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Dg.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Dg.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const s=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${s}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},Hk=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:n}=t??{},i=r?"HEAD":"GET";let s=!1;const l=(e??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join(""),{url:o,headers:a}=this.cloneRequestState();return o.searchParams.set("select",l),n&&a.append("Prefer",`count=${n}`),new ra({method:i,url:o,headers:a,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const i="POST",{url:s,headers:l}=this.cloneRequestState();if(t&&l.append("Prefer",`count=${t}`),r||l.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((a,c)=>a.concat(Object.keys(c)),[]);if(o.length>0){const a=[...new Set(o)].map(c=>`"${c}"`);s.searchParams.set("columns",a.join(","))}}return new ra({method:i,url:s,headers:l,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){var s;const l="POST",{url:o,headers:a}=this.cloneRequestState();if(a.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&o.searchParams.set("on_conflict",t),n&&a.append("Prefer",`count=${n}`),i||a.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(c.length>0){const d=[...new Set(c)].map(f=>`"${f}"`);o.searchParams.set("columns",d.join(","))}}return new ra({method:l,url:o,headers:a,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}update(e,{count:t}={}){var r;const n="PATCH",{url:i,headers:s}=this.cloneRequestState();return t&&s.append("Prefer",`count=${t}`),new ra({method:n,url:i,headers:s,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:n,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new ra({method:r,url:n,headers:i,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},$k=class Dv{constructor(t,{headers:r={},schema:n,fetch:i}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=i}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new Hk(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Dv(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:i=!1,count:s}={}){var l;let o;const a=new URL(`${this.url}/rpc/${t}`);let c;const d=u=>u!==null&&typeof u=="object"&&(!Array.isArray(u)||u.some(d)),f=n&&Object.values(r).some(d);f?(o="POST",c=r):n||i?(o=n?"HEAD":"GET",Object.entries(r).filter(([u,p])=>p!==void 0).map(([u,p])=>[u,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([u,p])=>{a.searchParams.append(u,p)})):(o="POST",c=r);const h=new Headers(this.headers);return f?h.set("Prefer",s?`count=${s},return=minimal`:"return=minimal"):s&&h.set("Prefer",`count=${s}`),new ra({method:o,url:a,headers:h,schema:this.schemaName,body:c,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}};class Vk{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const n=r.versions;if(n&&n.node){const i=n.node,s=parseInt(i.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const Xk="2.93.1",Yk=`realtime-js/${Xk}`,Gk="1.0.0",Rv="2.0.0",Rg=Rv,od=1e4,qk=1e3,Kk=100;var bi;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(bi||(bi={}));var Xt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Xt||(Xt={}));var _n;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(_n||(_n={}));var ld;(function(e){e.websocket="websocket"})(ld||(ld={}));var ls;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(ls||(ls={}));class Jk{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},l=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(t,r,n){var i,s;const l=t.topic,o=(i=t.ref)!==null&&i!==void 0?i:"",a=(s=t.join_ref)!==null&&s!==void 0?s:"",c=t.payload.event,d=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},f=Object.keys(d).length===0?"":JSON.stringify(d);if(a.length>255)throw new Error(`joinRef length ${a.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`metadata length ${f.length} exceeds maximum of 255`);const h=this.USER_BROADCAST_PUSH_META_LENGTH+a.length+o.length+l.length+c.length+f.length,u=new ArrayBuffer(this.HEADER_LENGTH+h);let p=new DataView(u),m=0;p.setUint8(m++,this.KINDS.userBroadcastPush),p.setUint8(m++,a.length),p.setUint8(m++,o.length),p.setUint8(m++,l.length),p.setUint8(m++,c.length),p.setUint8(m++,f.length),p.setUint8(m++,r),Array.from(a,x=>p.setUint8(m++,x.charCodeAt(0))),Array.from(o,x=>p.setUint8(m++,x.charCodeAt(0))),Array.from(l,x=>p.setUint8(m++,x.charCodeAt(0))),Array.from(c,x=>p.setUint8(m++,x.charCodeAt(0))),Array.from(f,x=>p.setUint8(m++,x.charCodeAt(0)));var g=new Uint8Array(u.byteLength+n.byteLength);return g.set(new Uint8Array(u),0),g.set(new Uint8Array(n),u.byteLength),g.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[i,s,l,o,a]=n;return r({join_ref:i,ref:s,topic:l,event:o,payload:a})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,i)}}_decodeUserBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2),l=r.getUint8(3),o=r.getUint8(4);let a=this.HEADER_LENGTH+4;const c=n.decode(t.slice(a,a+i));a=a+i;const d=n.decode(t.slice(a,a+s));a=a+s;const f=n.decode(t.slice(a,a+l));a=a+l;const h=t.slice(a,t.byteLength),u=o===this.JSON_ENCODING?JSON.parse(n.decode(h)):h,p={type:this.BROADCAST_EVENT,event:d,payload:u};return l>0&&(p.meta=JSON.parse(f)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class Iv{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var gt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(gt||(gt={}));const Ig=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((s,l)=>(s[l]=Qk(l,e,t,i),s),{}):{}},Qk=(e,t,r,n)=>{const i=t.find(o=>o.name===e),s=i==null?void 0:i.type,l=r[e];return s&&!n.includes(s)?Mv(s,l):cd(l)},Mv=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return rC(t,r)}switch(e){case gt.bool:return Zk(t);case gt.float4:case gt.float8:case gt.int2:case gt.int4:case gt.int8:case gt.numeric:case gt.oid:return eC(t);case gt.json:case gt.jsonb:return tC(t);case gt.timestamp:return nC(t);case gt.abstime:case gt.date:case gt.daterange:case gt.int4range:case gt.int8range:case gt.money:case gt.reltime:case gt.text:case gt.time:case gt.timestamptz:case gt.timetz:case gt.tsrange:case gt.tstzrange:return cd(t);default:return cd(t)}},cd=e=>e,Zk=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},eC=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},tC=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},rC=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const l=e.slice(1,r);try{s=JSON.parse("["+l+"]")}catch{s=l?l.split(","):[]}return s.map(o=>Mv(t,o))}return e},nC=e=>typeof e=="string"?e.replace(" ","T"):e,Lv=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class zf{constructor(t,r,n={},i=od){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Mg;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Mg||(Mg={}));class Fo{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:l,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Fo.syncState(this.state,i,s,l),this.pendingDiffs.forEach(a=>{this.state=Fo.syncDiff(this.state,a,s,l)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:l,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Fo.syncDiff(this.state,i,s,l),o())}),this.onJoin((i,s,l)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:l})}),this.onLeave((i,s,l)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const s=this.cloneDeep(t),l=this.transformState(r),o={},a={};return this.map(s,(c,d)=>{l[c]||(a[c]=d)}),this.map(l,(c,d)=>{const f=s[c];if(f){const h=d.map(g=>g.presence_ref),u=f.map(g=>g.presence_ref),p=d.filter(g=>u.indexOf(g.presence_ref)<0),m=f.filter(g=>h.indexOf(g.presence_ref)<0);p.length>0&&(o[c]=p),m.length>0&&(a[c]=m)}else o[c]=d}),this.syncDiff(s,{joins:o,leaves:a},n,i)}static syncDiff(t,r,n,i){const{joins:s,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(o,a)=>{var c;const d=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(a),d.length>0){const f=t[o].map(u=>u.presence_ref),h=d.filter(u=>f.indexOf(u.presence_ref)<0);t[o].unshift(...h)}n(o,d,a)}),this.map(l,(o,a)=>{let c=t[o];if(!c)return;const d=a.map(f=>f.presence_ref);c=c.filter(f=>d.indexOf(f.presence_ref)<0),t[o]=c,i(o,c,a),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Lg;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Lg||(Lg={}));var jo;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(jo||(jo={}));var Yn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Yn||(Yn={}));class va{constructor(t,r={config:{}},n){var i,s;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Xt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new zf(this,_n.join,this.params,this.timeout),this.rejoinTimer=new Iv(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Xt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Xt.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Xt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Xt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Xt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(_n.reply,{},(l,o)=>{this._trigger(this._replyEventName(o),l)}),this.presence=new Fo(this),this.broadcastEndpointURL=Lv(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Xt.closed){const{config:{broadcast:l,presence:o,private:a}}=this.params,c=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&i!==void 0?i:[],d=!!this.bindings[jo.PRESENCE]&&this.bindings[jo.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,f={},h={broadcast:l,presence:Object.assign(Object.assign({},o),{enabled:d}),postgres_changes:c,private:a};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(u=>t==null?void 0:t(Yn.CHANNEL_ERROR,u)),this._onClose(()=>t==null?void 0:t(Yn.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var p;if(this.socket._isManualToken()||this.socket.setAuth(),u===void 0){t==null||t(Yn.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,g=(p=m==null?void 0:m.length)!==null&&p!==void 0?p:0,x=[];for(let v=0;v<g;v++){const w=m[v],{filter:{event:_,schema:b,table:k,filter:S}}=w,O=u&&u[v];if(O&&O.event===_&&va.isFilterValueEqual(O.schema,b)&&va.isFilterValueEqual(O.table,k)&&va.isFilterValueEqual(O.filter,S))x.push(Object.assign(Object.assign({},w),{id:O.id}));else{this.unsubscribe(),this.state=Xt.errored,t==null||t(Yn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(Yn.SUBSCRIBED);return}}).receive("error",u=>{this.state=Xt.errored,t==null||t(Yn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Yn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Xt.joined&&t===jo.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var i;if(r==null)return Promise.reject("Payload is required for httpSend()");const s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(o.status===202)return{success:!0};let a=o.statusText;try{const c=await o.json();a=c.error||c.message||a}catch{}return Promise.reject(new Error(a))}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:l}=t,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:l,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var l,o,a;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((a=(o=(l=this.params)===null||l===void 0?void 0:l.config)===null||o===void 0?void 0:o.broadcast)===null||a===void 0)&&a.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Xt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(_n.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new zf(this,_n.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Xt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),l}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new zf(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Kk){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,s;const l=t.toLocaleLowerCase(),{close:o,error:a,leave:c,join:d}=_n;if(n&&[o,a,c,d].indexOf(l)>=0&&n!==this._joinRef())return;let h=this._onMessage(l,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(u=>{var p,m,g;return((p=u.filter)===null||p===void 0?void 0:p.event)==="*"||((g=(m=u.filter)===null||m===void 0?void 0:m.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===l}).map(u=>u.callback(h,n)):(s=this.bindings[l])===null||s===void 0||s.filter(u=>{var p,m,g,x,v,w;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in u){const _=u.id,b=(p=u.filter)===null||p===void 0?void 0:p.event;return _&&((m=r.ids)===null||m===void 0?void 0:m.includes(_))&&(b==="*"||(b==null?void 0:b.toLocaleLowerCase())===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const _=(v=(x=u==null?void 0:u.filter)===null||x===void 0?void 0:x.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return _==="*"||_===((w=r==null?void 0:r.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return u.type.toLocaleLowerCase()===l}).map(u=>{if(typeof h=="object"&&"ids"in h){const p=h.data,{schema:m,table:g,commit_timestamp:x,type:v,errors:w}=p;h=Object.assign(Object.assign({},{schema:m,table:g,commit_timestamp:x,eventType:v,new:{},old:{},errors:w}),this._getPayloadRecords(p))}u.callback(h,n)})}_isClosed(){return this.state===Xt.closed}_isJoined(){return this.state===Xt.joined}_isJoining(){return this.state===Xt.joining}_isLeaving(){return this.state===Xt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&va.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(_n.close,{},t)}_onError(t){this._on(_n.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Xt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Ig(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Ig(t.columns,t.old_record)),r}}const Hf=()=>{},uc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},iC=[1e3,2e3,5e3,1e4],sC=1e4,aC=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class oC{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=od,this.transport=null,this.heartbeatIntervalMs=uc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Hf,this.ref=0,this.reconnectTimer=null,this.vsn=Rg,this.logger=Hf,this.conn=null,this.sendBuffer=[],this.serializer=new Jk,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=i=>i?(...s)=>i(...s):(...s)=>fetch(...s),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${ld.websocket}`,this.httpEndpoint=Lv(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Vk.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case bi.connecting:return ls.Connecting;case bi.open:return ls.Open;case bi.closing:return ls.Closing;default:return ls.Closed}}isConnected(){return this.connectionState()===ls.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new va(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:i,ref:s}=t,l=()=>{this.encode(t,o=>{var a;(a=this.conn)===null||a===void 0||a.send(o)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(qk,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},uc.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const c=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",c)}catch(d){this.log("error","error in heartbeat callback",d)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:i,payload:s,ref:l}=r,o=l?`(${l})`:"",a=s.status||"";this.log("receive",`${a} ${n} ${i} ${o}`.trim(),s),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(i,s,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===bi.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===bi.open||this.conn.readyState===bi.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t);try{this.heartbeatCallback("error")}catch(r){this.log("error","error in heartbeat callback",r)}}_triggerChanError(){this.channels.forEach(t=>t._trigger(_n.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([aC],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(i=>{const s={access_token:r,version:Yk};r&&i.updateJoinPayload(s),i.joinedOnce&&i._isJoined()&&i._push(_n.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Iv(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},uc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,s,l,o,a,c,d,f,h,u;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:od,this.heartbeatIntervalMs=(i=t==null?void 0:t.heartbeatIntervalMs)!==null&&i!==void 0?i:uc.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(l=t==null?void 0:t.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:Hf,this.vsn=(a=t==null?void 0:t.vsn)!==null&&a!==void 0?a:Rg,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:p=>iC[p-1]||sC,this.vsn){case Gk:this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(p,m)=>m(JSON.stringify(p)),this.decode=(f=t==null?void 0:t.decode)!==null&&f!==void 0?f:(p,m)=>m(JSON.parse(p));break;case Rv:this.encode=(h=t==null?void 0:t.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var al=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function lC(e,t,r){const n=new URL(t,e);if(r)for(const[i,s]of Object.entries(r))s!==void 0&&n.searchParams.set(i,s);return n.toString()}async function cC(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function uC(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:i,body:s,headers:l}){const o=lC(e.baseUrl,n,i),a=await cC(e.auth),c=await t(o,{method:r,headers:{...s?{"Content-Type":"application/json"}:{},...a,...l},body:s?JSON.stringify(s):void 0}),d=await c.text(),f=(c.headers.get("content-type")||"").includes("application/json"),h=f&&d?JSON.parse(d):d;if(!c.ok){const u=f?h:void 0,p=u==null?void 0:u.error;throw new al((p==null?void 0:p.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:p==null?void 0:p.type,icebergCode:p==null?void 0:p.code,details:u})}return{status:c.status,headers:c.headers,data:h}}}}function fc(e){return e.join("")}var fC=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:fc(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${fc(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${fc(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${fc(e.namespace)}`}),!0}catch(t){if(t instanceof al&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof al&&r.status===409)return;throw r}}};function Xs(e){return e.join("")}var hC=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Xs(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Xs(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Xs(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Xs(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Xs(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Xs(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof al&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof al&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},dC=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=uC({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new fC(this.client,t),this.tableOps=new hC(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},qu=class extends Error{constructor(e,t="storage",r,n){super(e),this.__isStorageError=!0,this.namespace=t,this.name=t==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=n}};function Ku(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var hc=class extends qu{constructor(e,t,r,n="storage"){super(e,n,t,r),this.name=n==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Bv=class extends qu{constructor(e,t,r="storage"){super(e,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const pC=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),gC=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},ud=e=>{if(Array.isArray(e))return e.map(r=>ud(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=ud(n)}),t},mC=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function ol(e){"@babel/helpers - typeof";return ol=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ol(e)}function xC(e,t){if(ol(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ol(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vC(e){var t=xC(e,"string");return ol(t)=="symbol"?t:t+""}function yC(e,t,r){return(t=vC(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function He(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Bg(Object(r),!0).forEach(function(n){yC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bg(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const Ug=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},wC=async(e,t,r,n)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const i=e,s=i.status||500;if(typeof i.json=="function")i.json().then(l=>{const o=(l==null?void 0:l.statusCode)||(l==null?void 0:l.code)||s+"";t(new hc(Ug(l),s,o,n))}).catch(()=>{if(n==="vectors"){const l=s+"";t(new hc(i.statusText||`HTTP ${s} error`,s,l,n))}else{const l=s+"";t(new hc(i.statusText||`HTTP ${s} error`,s,l,n))}});else{const l=s+"";t(new hc(i.statusText||`HTTP ${s} error`,s,l,n))}}else t(new Bv(Ug(e),e,n))},_C=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||e==="HEAD"||!n?He(He({},i),r):(gC(n)?(i.headers=He({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,t!=null&&t.duplex&&(i.duplex=t.duplex),He(He({},i),r))};async function uo(e,t,r,n,i,s,l){return new Promise((o,a)=>{e(r,_C(t,n,i,s)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;if(l==="vectors"){const d=c.headers.get("content-type");if(!d||!d.includes("application/json"))return{}}return c.json()}).then(c=>o(c)).catch(c=>wC(c,a,n,l))})}function bC(e="storage"){return{get:async(t,r,n,i)=>uo(t,"GET",r,n,i,void 0,e),post:async(t,r,n,i,s)=>uo(t,"POST",r,i,s,n,e),put:async(t,r,n,i,s)=>uo(t,"PUT",r,i,s,n,e),head:async(t,r,n,i)=>uo(t,"HEAD",r,He(He({},n),{},{noResolveJson:!0}),i,void 0,e),remove:async(t,r,n,i,s)=>uo(t,"DELETE",r,i,s,n,e)}}const SC=bC("storage"),{get:ll,post:bt,put:fd,head:kC,remove:E0}=SC;var Ga=class{constructor(e,t={},r,n="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=pC(r),this.namespace=n}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){var t=this;try{return{data:await e(),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ku(r))return{data:null,error:r};throw r}}},CC=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ku(t))return{data:null,error:t};throw t}}};let Uv;Uv=Symbol.toStringTag;var TC=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Uv]="BlobDownloadBuilder",this.promise=null}asStream(){return new CC(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ku(t))return{data:null,error:t};throw t}}};const EC={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Wg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var NC=class extends Ga{constructor(e,t={},r,n){super(e,t,n,"storage"),this.bucketId=r}async uploadOrUpdate(e,t,r,n){var i=this;return i.handleOperation(async()=>{let s;const l=He(He({},Wg),n);let o=He(He({},i.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const a=l.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",l.cacheControl),a&&s.append("metadata",i.encodeMetadata(a)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.has("cacheControl")||s.append("cacheControl",l.cacheControl),a&&!s.has("metadata")&&s.append("metadata",i.encodeMetadata(a))):(s=r,o["cache-control"]=`max-age=${l.cacheControl}`,o["content-type"]=l.contentType,a&&(o["x-metadata"]=i.toBase64(i.encodeMetadata(a))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!l.duplex&&(l.duplex="half")),n!=null&&n.headers&&(o=He(He({},o),n.headers));const c=i._removeEmptyFolders(t),d=i._getFinalPath(c),f=await(e=="PUT"?fd:bt)(i.fetch,`${i.url}/object/${d}`,s,He({headers:o},l!=null&&l.duplex?{duplex:l.duplex}:{}));return{path:c,id:f.Id,fullPath:f.Key}})}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var i=this;const s=i._removeEmptyFolders(e),l=i._getFinalPath(s),o=new URL(i.url+`/object/upload/sign/${l}`);return o.searchParams.set("token",t),i.handleOperation(async()=>{let a;const c=He({upsert:Wg.upsert},n),d=He(He({},i.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",c.cacheControl),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.append("cacheControl",c.cacheControl)):(a=r,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType),{path:s,fullPath:(await fd(i.fetch,o.toString(),a,{headers:d})).Key}})}async createSignedUploadUrl(e,t){var r=this;return r.handleOperation(async()=>{let n=r._getFinalPath(e);const i=He({},r.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const s=await bt(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:i}),l=new URL(r.url+s.url),o=l.searchParams.get("token");if(!o)throw new qu("No token returned by API");return{signedUrl:l.toString(),path:e,token:o}})}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;return n.handleOperation(async()=>await bt(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}))}async copy(e,t,r){var n=this;return n.handleOperation(async()=>({path:(await bt(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key}))}async createSignedUrl(e,t,r){var n=this;return n.handleOperation(async()=>{let i=n._getFinalPath(e),s=await bt(n.fetch,`${n.url}/object/sign/${i}`,He({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${n.url}${s.signedURL}${l}`)}})}async createSignedUrls(e,t,r){var n=this;return n.handleOperation(async()=>{const i=await bt(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i.map(l=>He(He({},l),{},{signedUrl:l.signedURL?encodeURI(`${n.url}${l.signedURL}${s}`):null}))})}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=n?`?${n}`:"",s=this._getFinalPath(e),l=()=>ll(this.fetch,`${this.url}/${r}/${s}${i}`,{headers:this.headers,noResolveJson:!0});return new TC(l,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);return t.handleOperation(async()=>ud(await ll(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})))}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await kC(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Ku(n)&&n instanceof Bv){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const s=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&n.push(l);let o=n.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${r}${o}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await E0(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,r){var n=this;return n.handleOperation(async()=>{const i=He(He(He({},EC),t),{},{prefix:e||""});return await bt(n.fetch,`${n.url}/object/list/${n.bucketId}`,i,{headers:n.headers},r)})}async listV2(e,t){var r=this;return r.handleOperation(async()=>{const n=He({},e);return await bt(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const AC="2.93.1",Rl={"X-Client-Info":`storage-js/${AC}`};var OC=class extends Ga{constructor(e,t={},r,n){const i=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase."));const s=i.href.replace(/\/$/,""),l=He(He({},Rl),t);super(s,l,r,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=t.listBucketOptionsToQueryString(e);return await ll(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await ll(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var r=this;return r.handleOperation(async()=>await bt(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async updateBucket(e,t){var r=this;return r.handleOperation(async()=>await fd(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await E0(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},FC=class extends Ga{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=He(He({},Rl),t);super(n,i,r,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),i=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return await ll(t.fetch,i,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await E0(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!mC(e))throw new qu("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new dC({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(i,s){const l=i[s];return typeof l!="function"?l:async(...o)=>{try{return{data:await l.apply(i,o),error:null}}catch(a){if(n)throw a;return{data:null,error:a}}}}})}},jC=class extends Ga{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=He(He({},Rl),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var r=this;return r.handleOperation(async()=>await bt(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var r=this;return r.handleOperation(async()=>await bt(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{})}},PC=class extends Ga{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=He(He({},Rl),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},DC=class extends Ga{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=He(He({},Rl),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},RC=class extends DC{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new IC(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},IC=class extends jC{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,He(He({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,He(He({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new MC(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},MC=class extends PC{constructor(e,t,r,n,i){super(e,t,i),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,He(He({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,He(He({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,He(He({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,He(He({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,He(He({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},LC=class extends OC{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new NC(this.url,this.headers,e,this.fetch)}get vectors(){return new RC(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new FC(this.url+"/iceberg",this.headers,this.fetch)}};const Wv="2.93.1",na=30*1e3,hd=3,$f=hd*na,BC="http://localhost:9999",UC="supabase.auth.token",WC={"X-Client-Info":`gotrue-js/${Wv}`},dd="X-Supabase-Api-Version",zv={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},zC=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,HC=10*60*1e3;class cl extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Ie(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class $C extends cl{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function VC(e){return Ie(e)&&e.name==="AuthApiError"}class cs extends cl{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class hi extends cl{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class Wr extends hi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Vf(e){return Ie(e)&&e.name==="AuthSessionMissingError"}class Ys extends hi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class dc extends hi{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class pc extends hi{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function XC(e){return Ie(e)&&e.name==="AuthImplicitGrantRedirectError"}class zg extends hi{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class YC extends hi{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class pd extends hi{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Xf(e){return Ie(e)&&e.name==="AuthRetryableFetchError"}class Hg extends hi{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class gd extends hi{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const gu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),$g=` 	
\r=`.split(""),GC=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<$g.length;t+=1)e[$g[t].charCodeAt(0)]=-2;for(let t=0;t<gu.length;t+=1)e[gu[t].charCodeAt(0)]=t;return e})();function Vg(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(gu[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(gu[n]),t.queuedBits-=6}}function Hv(e,t,r){const n=GC[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Xg(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=l=>{JC(l,n,r)};for(let l=0;l<e.length;l+=1)Hv(e.charCodeAt(l),i,s);return t.join("")}function qC(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function KC(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}qC(n,t)}}function JC(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Ea(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)Hv(e.charCodeAt(i),r,n);return new Uint8Array(t)}function QC(e){const t=[];return KC(e,r=>t.push(r)),new Uint8Array(t)}function ps(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>Vg(i,r,n)),Vg(null,r,n),t.join("")}function ZC(e){return Math.round(Date.now()/1e3)+e}function eT(){return Symbol("auth-callback")}const ir=()=>typeof window<"u"&&typeof document<"u",rs={tested:!1,writable:!1},$v=()=>{if(!ir())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(rs.tested)return rs.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),rs.tested=!0,rs.writable=!0}catch{rs.tested=!0,rs.writable=!1}return rs.writable};function tT(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const Vv=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),rT=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",ia=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ns=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},nr=async(e,t)=>{await e.removeItem(t)};class Ju{constructor(){this.promise=new Ju.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Ju.promiseConstructor=Promise;function gc(e){const t=e.split(".");if(t.length!==3)throw new gd("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!zC.test(t[n]))throw new gd("JWT not in base64url format");return{header:JSON.parse(Xg(t[0])),payload:JSON.parse(Xg(t[1])),signature:Ea(t[2]),raw:{header:t[0],payload:t[1]}}}async function nT(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function iT(e,t){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const l=await e(s);if(!t(s,null,l)){n(l);return}}catch(l){if(!t(s,l)){i(l);return}}})()})}function sT(e){return("0"+e.toString(16)).substr(-2)}function aT(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,sT).join("")}async function oT(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function lT(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await oT(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Gs(e,t,r=!1){const n=aT();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await ia(e,`${t}-code-verifier`,i);const s=await lT(n);return[s,n===s?"plain":"s256"]}const cT=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function uT(e){const t=e.headers.get(dd);if(!t||!t.match(cT))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function fT(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function hT(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const dT=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function qs(e){if(!dT.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Yf(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function pT(e,t){return new Proxy(e,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,i)}})}function Yg(e){return JSON.parse(JSON.stringify(e))}const as=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),gT=[502,503,504];async function Gg(e){var t;if(!rT(e))throw new pd(as(e),0);if(gT.includes(e.status))throw new pd(as(e),e.status);let r;try{r=await e.json()}catch(s){throw new cs(as(s),s)}let n;const i=uT(e);if(i&&i.getTime()>=zv["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Hg(as(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Wr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0))throw new Hg(as(r),e.status,r.weak_password.reasons);throw new $C(as(r),e.status||500,n)}const mT=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function We(e,t,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[dd]||(s[dd]=zv["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const l=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(l.redirect_to=n.redirectTo);const o=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",a=await xT(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(a):{data:Object.assign({},a),error:null}}async function xT(e,t,r,n,i,s){const l=mT(t,n,i,s);let o;try{o=await e(r,Object.assign({},l))}catch(a){throw console.error(a),new pd(as(a),0)}if(o.ok||await Gg(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(a){await Gg(a)}}function vn(e){var t;let r=null;wT(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=ZC(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function qg(e){const t=vn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Ci(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function vT(e){return{data:e,error:null}}function yT(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,l=Gu(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},a=Object.assign({},l);return{data:{properties:o,user:a},error:null}}function Kg(e){return e}function wT(e){return e.access_token&&e.refresh_token&&e.expires_in}const Gf=["global","local","others"];class _T{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Vv(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Gf[0]){if(Gf.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Gf.join(", ")}`);try{return await We(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ie(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await We(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ci})}catch(n){if(Ie(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Gu(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await We(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:yT,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Ie(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await We(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ci})}catch(r){if(Ie(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,s,l,o,a;try{const c={nextPage:null,lastPage:0,total:0},d=await We(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:Kg});if(d.error)throw d.error;const f=await d.json(),h=(l=d.headers.get("x-total-count"))!==null&&l!==void 0?l:0,u=(a=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&a!==void 0?a:[];return u.length>0&&(u.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(p.split(";")[1].split("=")[1]);c[`${g}Page`]=m}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(Ie(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){qs(t);try{return await We(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ci})}catch(r){if(Ie(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){qs(t);try{return await We(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Ci})}catch(n){if(Ie(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){qs(t);try{return await We(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ci})}catch(n){if(Ie(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){qs(t.userId);try{const{data:r,error:n}=await We(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(Ie(r))return{data:null,error:r};throw r}}async _deleteFactor(t){qs(t.userId),qs(t.id);try{return{data:await We(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ie(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,i,s,l,o,a;try{const c={nextPage:null,lastPage:0,total:0},d=await We(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:Kg});if(d.error)throw d.error;const f=await d.json(),h=(l=d.headers.get("x-total-count"))!==null&&l!==void 0?l:0,u=(a=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&a!==void 0?a:[];return u.length>0&&(u.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(p.split(";")[1].split("=")[1]);c[`${g}Page`]=m}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(Ie(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(t){try{return await We(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ie(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await We(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ie(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await We(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ie(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await We(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ie(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await We(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ie(r))return{data:null,error:r};throw r}}}function Jg(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Ks={debug:!!(globalThis&&$v()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Xv extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class bT extends Xv{}async function ST(e,t,r){Ks.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Ks.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){Ks.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{Ks.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw Ks.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new bT(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Ks.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function kT(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Yv(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function CT(e){return parseInt(e,16)}function TT(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function ET(e){var t;const{chainId:r,domain:n,expirationTime:i,issuedAt:s=new Date,nonce:l,notBefore:o,requestId:a,resources:c,scheme:d,uri:f,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const u=Yv(e.address),p=d?`${d}://${n}`:n,m=e.statement?`${e.statement}
`:"",g=`${p} wants you to sign in with your Ethereum account:
${u}

${m}`;let x=`URI: ${f}
Version: ${h}
Chain ID: ${r}${l?`
Nonce: ${l}`:""}
Issued At: ${s.toISOString()}`;if(i&&(x+=`
Expiration Time: ${i.toISOString()}`),o&&(x+=`
Not Before: ${o.toISOString()}`),a&&(x+=`
Request ID: ${a}`),c){let v=`
Resources:`;for(const w of c){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);v+=`
- ${w}`}x+=v}return`${g}
${x}`}class $t extends Error{constructor({message:t,code:r,cause:n,name:i}){var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=i??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class mu extends $t{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function NT({error:e,options:t}){var r,n,i;const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new $t({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new $t({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new $t({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=s.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new $t({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new $t({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new $t({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new $t({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new $t({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const l=window.location.hostname;if(Gv(l)){if(s.rp.id!==l)return new $t({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new $t({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new $t({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new $t({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new $t({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function AT({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new $t({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new $t({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(Gv(n)){if(r.rpId!==n)return new $t({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new $t({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new $t({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new $t({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class OT{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const FT=new OT;function jT(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,i=Gu(e,["challenge","user","excludeCredentials"]),s=Ea(t).buffer,l=Object.assign(Object.assign({},r),{id:Ea(r.id).buffer}),o=Object.assign(Object.assign({},i),{challenge:s,user:l});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let a=0;a<n.length;a++){const c=n[a];o.excludeCredentials[a]=Object.assign(Object.assign({},c),{id:Ea(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function PT(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Gu(e,["challenge","allowCredentials"]),i=Ea(t).buffer,s=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const o=r[l];s.allowCredentials[l]=Object.assign(Object.assign({},o),{id:Ea(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return s}function DT(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:ps(new Uint8Array(e.response.attestationObject)),clientDataJSON:ps(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function RT(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:ps(new Uint8Array(i.authenticatorData)),clientDataJSON:ps(new Uint8Array(i.clientDataJSON)),signature:ps(new Uint8Array(i.signature)),userHandle:i.userHandle?ps(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Gv(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function Qg(){var e,t;return!!(ir()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function IT(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new mu("Browser returned unexpected credential type",t)}:{data:null,error:new mu("Empty credential response",t)}}catch(t){return{data:null,error:NT({error:t,options:e})}}}async function MT(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new mu("Browser returned unexpected credential type",t)}:{data:null,error:new mu("Empty credential response",t)}}catch(t){return{data:null,error:AT({error:t,options:e})}}}const LT={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},BT={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function xu(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of e)if(i)for(const s in i){const l=i[s];if(l!==void 0)if(Array.isArray(l))n[s]=l;else if(r(l))n[s]=l;else if(t(l)){const o=n[s];t(o)?n[s]=xu(o,l):n[s]=xu(l)}else n[s]=l}return n}function UT(e,t){return xu(LT,e,t||{})}function WT(e,t){return xu(BT,e,t||{})}class zT{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:i},s){try{const{data:l,error:o}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!l)return{data:null,error:o};const a=i??FT.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:c}=l.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${n}`),c.displayName||(c.displayName=c.name)}switch(l.webauthn.type){case"create":{const c=UT(l.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:d,error:f}=await IT({publicKey:c,signal:a});return d?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}case"request":{const c=WT(l.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:d,error:f}=await MT(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:c,signal:a}));return d?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}}}catch(l){return Ie(l)?{data:null,error:l}:{data:null,error:new cs("Unexpected error in challenge",l)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new cl("rpId is required for WebAuthn authentication")};try{if(!Qg())return{data:null,error:new cs("Browser does not support WebAuthn",null)};const{data:l,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:s});if(!l)return{data:null,error:o};const{webauthn:a}=l;return this._verify({factorId:t,challengeId:l.challengeId,webauthn:{type:a.type,rpId:r,rpOrigins:n,credential_response:a.credential_response}})}catch(l){return Ie(l)?{data:null,error:l}:{data:null,error:new cs("Unexpected error in authenticate",l)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new cl("rpId is required for WebAuthn registration")};try{if(!Qg())return{data:null,error:new cs("Browser does not support WebAuthn",null)};const{data:l,error:o}=await this._enroll({friendlyName:t});if(!l)return await this.client.mfa.listFactors().then(d=>{var f;return(f=d.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:o};const{data:a,error:c}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:s});return a?this._verify({factorId:l.id,challengeId:a.challengeId,webauthn:{rpId:r,rpOrigins:n,type:a.webauthn.type,credential_response:a.webauthn.credential_response}}):{data:null,error:c}}catch(l){return Ie(l)?{data:null,error:l}:{data:null,error:new cs("Unexpected error in register",l)}}}}kT();const HT={url:BC,storageKey:UC,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:WC,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function Zg(e,t,r){return await r()}const Js={};class ul{get jwks(){var t,r;return(r=(t=Js[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Js[this.storageKey]=Object.assign(Object.assign({},Js[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Js[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Js[this.storageKey]=Object.assign(Object.assign({},Js[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},HT),t);if(this.storageKey=s.storageKey,this.instanceID=(r=ul.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,ul.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&ir()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new _T({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Vv(s.fetch),this.lock=s.lock||Zg,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,this.lockAcquireTimeout=s.lockAcquireTimeout,s.lock?this.lock=s.lock:this.persistSession&&ir()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=ST:this.lock=Zg,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new zT(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:$v()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Jg(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=Jg(this.memoryStorage)),ir()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l);try{await this._notifyAllSubscribers(l.data.event,l.data.session,!1)}catch(o){this._debug("#broadcastChannel","error",o)}})}this.initialize().catch(l=>{this._debug("#initialize()","error",l)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Wv}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(ir()&&(r=tT(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),ir()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),XC(s)){const a=(t=s.details)===null||t===void 0?void 0:t.code;if(a==="identity_already_exists"||a==="identity_not_found"||a==="single_identity_not_deletable")return{error:s}}return{error:s}}const{session:l,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",l,"redirect type",o),await this._saveSession(l),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ie(r)?this._returnResult({error:r}):this._returnResult({error:new cs("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const s=await We(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:vn}),{data:l,error:o}=s;if(o||!l)return this._returnResult({data:{user:null,session:null},error:o});const a=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",a)),this._returnResult({data:{user:c,session:a},error:null})}catch(s){if(Ie(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(t){var r,n,i;try{let s;if("email"in t){const{email:d,password:f,options:h}=t;let u=null,p=null;this.flowType==="pkce"&&([u,p]=await Gs(this.storage,this.storageKey)),s=await We(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:d,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:u,code_challenge_method:p},xform:vn})}else if("phone"in t){const{phone:d,password:f,options:h}=t;s=await We(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(i=h==null?void 0:h.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:vn})}else throw new dc("You must provide either an email or phone number and a password");const{data:l,error:o}=s;if(o||!l)return await nr(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const a=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",a)),this._returnResult({data:{user:c,session:a},error:null})}catch(s){if(await nr(this.storage,`${this.storageKey}-code-verifier`),Ie(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:l,options:o}=t;r=await We(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:qg})}else if("phone"in t){const{phone:s,password:l,options:o}=t;r=await We(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:qg})}else throw new dc("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const s=new Ys;return this._returnResult({data:{user:null,session:null},error:s})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(Ie(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,i,s,l,o,a,c,d,f,h;let u,p;if("message"in t)u=t.message,p=t.signature;else{const{chain:m,wallet:g,statement:x,options:v}=t;let w;if(ir())if(typeof g=="object")w=g;else{const F=window;if("ethereum"in F&&typeof F.ethereum=="object"&&"request"in F.ethereum&&typeof F.ethereum.request=="function")w=F.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=g}const _=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href),b=await w.request({method:"eth_requestAccounts"}).then(F=>F).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!b||b.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const k=Yv(b[0]);let S=(n=v==null?void 0:v.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!S){const F=await w.request({method:"eth_chainId"});S=CT(F)}const O={domain:_.host,address:k,statement:x,uri:_.href,version:"1",chainId:S,nonce:(i=v==null?void 0:v.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(l=(s=v==null?void 0:v.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(o=v==null?void 0:v.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(a=v==null?void 0:v.signInWithEthereum)===null||a===void 0?void 0:a.notBefore,requestId:(c=v==null?void 0:v.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(d=v==null?void 0:v.signInWithEthereum)===null||d===void 0?void 0:d.resources};u=ET(O),p=await w.request({method:"personal_sign",params:[TT(u),k]})}try{const{data:m,error:g}=await We(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:u,signature:p},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:vn});if(g)throw g;if(!m||!m.session||!m.user){const x=new Ys;return this._returnResult({data:{user:null,session:null},error:x})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:g})}catch(m){if(Ie(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(t){var r,n,i,s,l,o,a,c,d,f,h,u;let p,m;if("message"in t)p=t.message,m=t.signature;else{const{chain:g,wallet:x,statement:v,options:w}=t;let _;if(ir())if(typeof x=="object")_=x;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))_=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=x}const b=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in _&&_.signIn){const k=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:b.host,uri:b.href}),v?{statement:v}:null));let S;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")S=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)S=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)p=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),m=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${b.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${b.href}`,`Issued At: ${(i=(n=w==null?void 0:w.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=w==null?void 0:w.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((f=(d=w==null?void 0:w.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",...w.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const k=await _.signMessage(new TextEncoder().encode(p),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=k}}try{const{data:g,error:x}=await We(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:ps(m)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(u=t.options)===null||u===void 0?void 0:u.captchaToken}}:null),xform:vn});if(x)throw x;if(!g||!g.session||!g.user){const v=new Ys;return this._returnResult({data:{user:null,session:null},error:v})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:x})}catch(g){if(Ie(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(t){const r=await ns(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new YC;const{data:s,error:l}=await We(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:vn});if(await nr(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!s||!s.session||!s.user){const o=new Ys;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:l})}catch(s){if(await nr(this.storage,`${this.storageKey}-code-verifier`),Ie(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:s,nonce:l}=t,o=await We(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:l,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:vn}),{data:a,error:c}=o;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!a||!a.session||!a.user){const d=new Ys;return this._returnResult({data:{user:null,session:null},error:d})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:a,error:c})}catch(r){if(Ie(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,i,s,l;try{if("email"in t){const{email:o,options:a}=t;let c=null,d=null;this.flowType==="pkce"&&([c,d]=await Gs(this.storage,this.storageKey));const{error:f}=await We(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=a==null?void 0:a.data)!==null&&r!==void 0?r:{},create_user:(n=a==null?void 0:a.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in t){const{phone:o,options:a}=t,{data:c,error:d}=await We(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=a==null?void 0:a.data)!==null&&i!==void 0?i:{},create_user:(s=a==null?void 0:a.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},channel:(l=a==null?void 0:a.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d})}throw new dc("You must provide either an email or phone number.")}catch(o){if(await nr(this.storage,`${this.storageKey}-code-verifier`),Ie(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var r,n;try{let i,s;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:o}=await We(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:vn});if(o)throw o;if(!l)throw new Error("An error occurred on token verification.");const a=l.session,c=l.user;return a!=null&&a.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",a)),this._returnResult({data:{user:c,session:a},error:null})}catch(i){if(Ie(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,n,i,s,l;try{let o=null,a=null;this.flowType==="pkce"&&([o,a]=await Gs(this.storage,this.storageKey));const c=await We(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:a}),headers:this.headers,xform:vT});return!((s=c.data)===null||s===void 0)&&s.url&&ir()&&!(!((l=t.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(o){if(await nr(this.storage,`${this.storageKey}-code-verifier`),Ie(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Wr;const{error:i}=await We(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(Ie(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:s}=t,{error:l}=await We(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in t){const{phone:n,type:i,options:s}=t,{data:l,error:o}=await We(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:o})}throw new dc("You must provide either an email or phone number and a type")}catch(r){if(Ie(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ns(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<$f:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const l=await ns(this.userStorage,this.storageKey+"-user");l!=null&&l.user?t.user=l.user:t.user=Yf()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};t.user=pT(t.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await We(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ci}):await this._useSession(async r=>{var n,i,s;const{data:l,error:o}=r;if(o)throw o;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Wr}:await We(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:Ci})})}catch(r){if(Ie(r))return Vf(r)&&(await this._removeSession(),await nr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new Wr;const l=i.session;let o=null,a=null;this.flowType==="pkce"&&t.email!=null&&([o,a]=await Gs(this.storage,this.storageKey));const{data:c,error:d}=await We(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:a}),jwt:l.access_token,xform:Ci});if(d)throw d;return l.user=c.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(n){if(await nr(this.storage,`${this.storageKey}-code-verifier`),Ie(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Wr;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:l}=gc(t.access_token);if(l.exp&&(n=l.exp,i=n<=r),i){const{data:o,error:a}=await this._callRefreshToken(t.refresh_token);if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:a}=await this._getUser(t.access_token);if(a)return this._returnResult({data:{user:null,session:null},error:a});s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(Ie(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:l,error:o}=r;if(o)throw o;t=(n=l.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Wr;const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Ie(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!ir())throw new pc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new pc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new zg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new pc("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new zg("No code detected.");const{data:v,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:l,expires_in:o,expires_at:a,token_type:c}=t;if(!s||!o||!l||!c)throw new pc("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(o);let h=d+f;a&&(h=parseInt(a));const u=h-d;u*1e3<=na&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${u}s, should have been closer to ${f}s`);const p=h-f;d-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,d):d-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,h,d);const{data:m,error:g}=await this._getUser(s);if(g)throw g;const x={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:f,expires_at:h,refresh_token:l,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:t.type},error:null})}catch(n){if(Ie(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ns(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s&&!Vf(s))return this._returnResult({error:s});const l=(n=i.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:o}=await this.admin.signOut(l,t);if(o&&!(VC(o)&&(o.status===404||o.status===401||o.status===403)||Vf(o)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await nr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=eT(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:l}=r;if(l)throw l;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await Gs(this.storage,this.storageKey,!0));try{return await We(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(await nr(this.storage,`${this.storageKey}-code-verifier`),Ie(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Ie(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var l,o,a,c,d;const{data:f,error:h}=s;if(h)throw h;const u=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:!0});return await We(this.fetch,"GET",u,{headers:this.headers,jwt:(d=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(i)throw i;return ir()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(Ie(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:s}}=r;if(i)throw i;const{options:l,provider:o,token:a,access_token:c,nonce:d}=t,f=await We(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s==null?void 0:s.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:a,access_token:c,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:vn}),{data:h,error:u}=f;return u?this._returnResult({data:{user:null,session:null},error:u}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new Ys}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:u}))}catch(i){if(await nr(this.storage,`${this.storageKey}-code-verifier`),Ie(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:l}=r;if(l)throw l;return await We(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(Ie(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await iT(async i=>(i>0&&await nT(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await We(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:vn})),(i,s)=>{const l=200*Math.pow(2,i);return s&&Xf(s)&&Date.now()+l-n<na})}catch(n){if(this._debug(r,"error",n),Ie(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),ir()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await ns(this.storage,this.storageKey);if(i&&this.userStorage){let l=await ns(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:i.user},await ia(this.userStorage,this.storageKey+"-user",l)),i.user=(t=l==null?void 0:l.user)!==null&&t!==void 0?t:Yf()}else if(i&&!i.user&&!i.user){const l=await ns(this.storage,this.storageKey+"-user");l&&(l!=null&&l.user)?(i.user=l.user,await nr(this.storage,this.storageKey+"-user"),await ia(this.storage,this.storageKey,i)):i.user=Yf()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<$f;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${$f}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:l}=await this._callRefreshToken(i.refresh_token);l&&(console.error(l),Xf(l)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:o}=await this._getUser(i.access_token);!o&&(l!=null&&l.user)?(i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(n,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Wr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Ju;const{data:s,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!s.session)throw new Wr;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={data:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),Ie(s)){const l={data:null,error:s};return Xf(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],l=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(a){s.push(a)}});if(await Promise.all(l),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await nr(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await ia(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=Yg(i);await ia(this.storage,this.storageKey,s)}else{const i=Yg(r);await ia(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await nr(this.storage,this.storageKey),await nr(this.storage,this.storageKey+"-code-verifier"),await nr(this.storage,this.storageKey+"-user"),this.userStorage&&await nr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ir()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),na);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/na);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${na}ms, refresh threshold is ${hd} ticks`),i<=hd&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Xv)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ir()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(t){this._debug("#visibilityChangedCallback","error",t)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,l]=await Gs(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(l)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?this._returnResult({data:null,error:s}):await We(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ie(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:l}=r;if(l)return this._returnResult({data:null,error:l});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:a,error:c}=await We(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(t.factorType==="totp"&&a.type==="totp"&&(!((i=a==null?void 0:a.totp)===null||i===void 0)&&i.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),this._returnResult({data:a,error:null}))})}catch(r){if(Ie(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const l=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?DT(t.webauthn.credential_response):RT(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:a}=await We(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return a?this._returnResult({data:null,error:a}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:a}))})}catch(r){if(Ie(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const l=await We(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(l.error)return l;const{data:o}=l;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:jT(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:PT(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Ie(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const s of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])i.all.push(s),s.status==="verified"&&i[s.factor_type].push(s);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(t){var r,n,i,s;if(t)try{const{payload:u}=gc(t);let p=null;u.aal&&(p=u.aal);let m=p;const{data:{user:g},error:x}=await this.getUser(t);if(x)return this._returnResult({data:null,error:x});((n=(r=g==null?void 0:g.factors)===null||r===void 0?void 0:r.filter(_=>_.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(m="aal2");const w=u.amr||[];return{data:{currentLevel:p,nextLevel:m,currentAuthenticationMethods:w},error:null}}catch(u){if(Ie(u))return this._returnResult({data:null,error:u});throw u}const{data:{session:l},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=gc(l.access_token);let c=null;a.aal&&(c=a.aal);let d=c;((s=(i=l.user.factors)===null||i===void 0?void 0:i.filter(u=>u.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(d="aal2");const h=a.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:h},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await We(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Wr})})}catch(r){if(Ie(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Wr});const l=await We(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return l.data&&l.data.redirect_url&&ir()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(Ie(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Wr});const l=await We(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return l.data&&l.data.redirect_url&&ir()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(Ie(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await We(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Wr})})}catch(t){if(Ie(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?(await We(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Wr})})}catch(r){if(Ie(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+HC>i)return n;const{data:s,error:l}=await We(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:u,error:p}=await this.getSession();if(p||!u.session)return this._returnResult({data:null,error:p});n=u.session.access_token}const{header:i,payload:s,signature:l,raw:{header:o,payload:a}}=gc(n);r!=null&&r.allowExpired||fT(s.exp);const c=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:u}=await this.getUser(n);if(u)throw u;return{data:{claims:s,header:i,signature:l},error:null}}const d=hT(i.alg),f=await crypto.subtle.importKey("jwk",c,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,l,QC(`${o}.${a}`)))throw new gd("Invalid JWT signature");return{data:{claims:s,header:i,signature:l},error:null}}catch(n){if(Ie(n))return this._returnResult({data:null,error:n});throw n}}}ul.nextInstanceID={};const $T=ul,VT="2.93.1";let vo="";typeof Deno<"u"?vo="deno":typeof document<"u"?vo="web":typeof navigator<"u"&&navigator.product==="ReactNative"?vo="react-native":vo="node";function XT(){const e=globalThis.process;if(e&&e.platform){const t=e.platform;if(t==="darwin")return"macOS";if(t==="win32")return"Windows";if(t==="linux")return"Linux";if(t==="android")return"Android"}if(typeof navigator<"u"&&navigator.userAgentData&&navigator.userAgentData.platform){const t=navigator.userAgentData.platform;if(t==="macOS")return"macOS";if(t==="Windows")return"Windows";if(t==="Linux")return"Linux";if(t==="Android")return"Android";if(t==="iOS")return"iOS"}return null}function YT(){const e=globalThis.process;if(e){const t=e.versions;if(t&&t.node&&typeof window>"u")try{const r=globalThis.require;if(r)return r("os").release()}catch{return null}}if(typeof Deno<"u"&&Deno.osRelease)try{return Deno.osRelease()}catch{return null}return typeof navigator<"u"&&navigator.userAgentData&&navigator.userAgentData.platformVersion?navigator.userAgentData.platformVersion:null}function GT(){if(typeof Deno<"u")return"deno";if(typeof Bun<"u")return"bun";const e=globalThis.process;if(e){const t=e.versions;if(t&&t.node)return"node"}return null}function qT(){if(typeof Deno<"u"&&Deno.version)return Deno.version.deno;if(typeof Bun<"u"&&Bun.version)return Bun.version;const e=globalThis.process;if(e){const t=e.versions;if(t&&t.node)return t.node}return null}function KT(){const e={"X-Client-Info":`supabase-js-${vo}/${VT}`},t=XT();t&&(e["X-Supabase-Client-Platform"]=t);const r=YT();r&&(e["X-Supabase-Client-Platform-Version"]=r);const n=GT();n&&(e["X-Supabase-Client-Runtime"]=n);const i=qT();return i&&(e["X-Supabase-Client-Runtime-Version"]=i),e}const JT=KT(),QT={headers:JT},ZT={schema:"public"},eE={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},tE={};function fl(e){"@babel/helpers - typeof";return fl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fl(e)}function rE(e,t){if(fl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(fl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nE(e){var t=rE(e,"string");return fl(t)=="symbol"?t:t+""}function iE(e,t,r){return(t=nE(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function em(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function jt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?em(Object(r),!0).forEach(function(n){iE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):em(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const sE=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),aE=()=>Headers,oE=(e,t,r)=>{const n=sE(r),i=aE();return async(s,l)=>{var o;const a=(o=await t())!==null&&o!==void 0?o:e;let c=new i(l==null?void 0:l.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${a}`),n(s,jt(jt({},l),{},{headers:c}))}};function lE(e){return e.endsWith("/")?e:e+"/"}function cE(e,t){var r,n;const{db:i,auth:s,realtime:l,global:o}=e,{db:a,auth:c,realtime:d,global:f}=t,h={db:jt(jt({},a),i),auth:jt(jt({},c),s),realtime:jt(jt({},d),l),storage:{},global:jt(jt(jt({},f),o),{},{headers:jt(jt({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function uE(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(lE(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var fE=class extends $T{constructor(e){super(e)}},hE=class{constructor(e,t,r){var n,i;this.supabaseUrl=e,this.supabaseKey=t;const s=uE(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",s),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",s),this.storageUrl=new URL("storage/v1",s),this.functionsUrl=new URL("functions/v1",s);const l=`sb-${s.hostname.split(".")[0]}-auth-token`,o={db:ZT,realtime:tE,auth:jt(jt({},eE),{},{storageKey:l}),global:QT},a=cE(r??{},o);if(this.storageKey=(n=a.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=a.global.headers)!==null&&i!==void 0?i:{},a.accessToken)this.accessToken=a.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=a.auth)!==null&&c!==void 0?c:{},this.headers,a.global.fetch)}this.fetch=oE(t,this._getAccessToken.bind(this),a.global.fetch),this.realtime=this._initRealtimeClient(jt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},a.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new $k(new URL("rest/v1",s).href,{headers:this.headers,schema:a.db.schema,fetch:this.fetch}),this.storage=new LC(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),a.accessToken||this._listenForAuthEvents()}get functions(){return new Bk(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,storageKey:s,flowType:l,lock:o,debug:a,throwOnError:c},d,f){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new fE({url:this.authUrl.href,headers:jt(jt({},h),d),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,flowType:l,lock:o,debug:a,throwOnError:c,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(u=>u.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new oC(this.realtimeUrl.href,jt(jt({},e),{},{params:jt(jt({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const dE=(e,t,r)=>new hE(e,t,r);function pE(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}pE()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const gE="https://kglshjhuofkouiodmkgs.supabase.co",mE="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtnbHNoamh1b2Zrb3Vpb2Rta2dzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk0NDE3ODgsImV4cCI6MjA4NTAxNzc4OH0.kqoUY-stIdwOw3vtpowcbzV_AvjgGtzXN6i9bjQCW-Y",we=dE(gE,mE),xE=()=>{var J,T;const e=le.useRef(null),t=le.useRef(null),[r,n]=le.useState(null),[i,s]=le.useState(""),[l,o]=le.useState(""),[a,c]=le.useState("A"),[d,f]=le.useState("#5E5CE6"),[h,u]=le.useState([]),[p,m]=le.useState(null),[g,x]=le.useState(!1),[v,w]=le.useState(null),_=le.useRef(null),b=le.useRef(null),k=le.useRef(null),S=le.useRef(null);le.useEffect(()=>{_.current=v},[v]),le.useEffect(()=>{O()},[]);const O=async()=>{const{data:j}=await we.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});j&&j.length>0&&(u(j),m(j[0].id))};le.useEffect(()=>{if(!e.current||!p)return;let j=!0;t.current&&t.current.dispose(),e.current.innerHTML="";const B=document.createElement("canvas");e.current.appendChild(B);const E=new $e.fabric.Canvas(B,{width:1e3,height:600,backgroundColor:"transparent",selection:!0});t.current=E,(async()=>{var z;x(!0);const{data:H,error:L}=await we.from("seats").select("*").eq("zone_id",p).order("global_number",{ascending:!0});if(j){if(L)console.error("Error loading seats:",L);else if(H&&H.length>0){t.current&&t.current.clear();const ee=H.filter(ae=>typeof ae.pos_x=="number"&&typeof ae.pos_y=="number");let A=0,V=0,W=1e3,te=600;if(ee.length>0){const ae=Math.min(...ee.map(ve=>ve.pos_x)),ce=Math.max(...ee.map(ve=>ve.pos_x+(ve.width||72)))-ae,ue=((z=e.current)==null?void 0:z.clientWidth)||ce;W=Math.max(ce+100,ue),A=(W-ce)/2-ae;const xe=Math.min(...ee.map(ve=>ve.pos_y)),fe=Math.max(...ee.map(ve=>ve.pos_y+(ve.height||72)))-xe;V=20-xe,te=Math.max(fe+100,600)}t.current.setDimensions({width:W,height:te}),ee.forEach(ae=>{D({...ae,pos_x:ae.pos_x+A,pos_y:ae.pos_y+V});const Y=t.current.getObjects().find(ce=>ce.data.id===ae.id);Y&&delete Y.data.isDirty}),t.current.renderAll()}else t.current&&(t.current.clear(),t.current.setDimensions({width:1e3,height:600}));x(!1)}})(),E.on("mouse:down",H=>{var L,z,ee,A;if(_.current==="structure"){E.selection=!1;const V=E.getPointer(H.e);setDrawStart({x:V.x,y:V.y});const W=new $e.fabric.Rect({left:V.x,top:V.y,width:0,height:0,fill:"#E5E5EA",rx:6,ry:6,stroke:"#C7C7CC",strokeWidth:1,opacity:.7});E.add(W),setTempRect(W);return}H.target?saveToHistory():(E.isDragging=!0,E.selection=!0,E.lastPosX=H.e.clientX||((z=(L=H.e.touches)==null?void 0:L[0])==null?void 0:z.clientX),E.lastPosY=H.e.clientY||((A=(ee=H.e.touches)==null?void 0:ee[0])==null?void 0:A.clientY))});const N=async()=>{if(history.length===0)return;const H=history[history.length-1],L=history.slice(0,-1);setHistory(L),t.current.clear(),H.forEach(z=>{D({id:z.id,seat_number:z.seatNumber,display_number:z.displayNumber,zone_name:z.zoneName,zone_color:z.zoneColor,pos_x:z.pos_x,pos_y:z.pos_y,width:z.width,height:z.height,label:z.label,type:z.type,rotation:z.rotation,global_number:z.globalNumber})})},C=()=>{const H=E.getActiveObject();H&&H.clone(L=>{S.current=L},["data"])},P=()=>{if(!S.current||!t.current)return;const H=t.current;saveToHistory();try{S.current.clone(L=>{var z,ee,A;if(!(!H.getElement()||!H.contextContainer)){if(H.discardActiveObject(),L.set({left:L.left+20,top:L.top+20,evented:!0}),L.type==="activeSelection"){const V=[];L.forEachObject(te=>{var ue,xe;const ae=crypto.randomUUID();let Y=((ue=te.data)==null?void 0:ue.type)==="structure";!Y&&((xe=te.data)!=null&&xe.label)&&(Y=!0);const ce=te.data||{};Y&&(delete ce.zoneName,delete ce.zoneColor,delete ce.displayNumber),te.set("data",{...ce,id:ae,isDirty:!0,type:Y?"structure":"seat",seatNumber:ce.seatNumber||(Y?`STR_${ae.slice(-8)}`:"0")}),H.add(te),V.push(te)});const W=new $e.fabric.ActiveSelection(V,{canvas:H});H.setActiveObject(W),W.setCoords()}else{const V=crypto.randomUUID();let W=((z=L.data)==null?void 0:z.type)==="structure";if(!W&&((ee=L.data)!=null&&ee.label)&&(W=!0),W){const ae=((A=L.data)==null?void 0:A.label)||"",Y=prompt("  ",ae);if(Y){L.data={...L.data,label:Y,type:"structure"};const ce=L.getObjects().find(ue=>ue.type==="i-text");ce&&ce.set("text",Y)}}const te=L.data||{};W&&(delete te.zoneName,delete te.zoneColor,delete te.displayNumber),L.set("data",{...te,id:V,isDirty:!0,type:W?"structure":"seat",seatNumber:W?`STR_${V.slice(-8)}`:te.seatNumber||"0"}),H.add(L),H.setActiveObject(L)}H.requestRenderAll()}},["data"])}catch(L){console.error("Error pasting objects:",L)}},I=H=>{(H.ctrlKey||H.metaKey)&&H.key==="z"&&(H.preventDefault(),N()),(H.ctrlKey||H.metaKey)&&H.key==="c"&&document.activeElement.tagName!=="INPUT"&&document.activeElement.tagName!=="TEXTAREA"&&(H.preventDefault(),C()),(H.ctrlKey||H.metaKey)&&H.key==="v"&&document.activeElement.tagName!=="INPUT"&&document.activeElement.tagName!=="TEXTAREA"&&(H.preventDefault(),P())};return window.addEventListener("keydown",I),E.on("mouse:move",H=>{var L,z,ee,A;if(_.current==="structure"&&b.current&&k.current){const V=E.getPointer(H.e),W=b.current,te=k.current,ae=Math.abs(V.x-W.x),Y=Math.abs(V.y-W.y),ce=Math.min(V.x,W.x),ue=Math.min(V.y,W.y);te.set({width:ae,height:Y,left:ce,top:ue}),E.requestRenderAll();return}if(E.isDragging){const V=H.e,W=V.clientX||((z=(L=V.touches)==null?void 0:L[0])==null?void 0:z.clientX),te=V.clientY||((A=(ee=V.touches)==null?void 0:ee[0])==null?void 0:A.clientY),ae=E.viewportTransform;ae[4]+=W-E.lastPosX,ae[5]+=te-E.lastPosY,E.requestRenderAll(),E.lastPosX=W,E.lastPosY=te}}),E.on("mouse:wheel",H=>{var V;const L=H.e.deltaY,z=E.viewportTransform;z[5]-=L;const ee=((V=e.current)==null?void 0:V.clientHeight)||0,A=E.getHeight();ee>0&&z[5]<-(A-ee)&&(z[5]=-(A-ee)),E.requestRenderAll(),H.e.preventDefault(),H.e.stopPropagation()}),E.on("object:scaling",H=>{const L=H.target;if(L&&L.data){const z=L.getObjects().find(ee=>ee.type==="i-text");z&&z.set({scaleX:1/L.scaleX,scaleY:1/L.scaleY})}}),E.on("mouse:dblclick",H=>{const L=H.target;if(!L||!L.data)return;const z=L.data.type;if(z!=="seat"&&z!=="structure")return;const ee=L.getObjects().find(ae=>ae.type==="i-text");if(!ee)return;saveToHistory();const A={...L.data},V=L.left,W=L.top,te=L.angle;L._restoreObjectsState(),E.remove(L),L.getObjects().forEach(ae=>{E.add(ae),ae===ee&&(E.setActiveObject(ae),ae.enterEditing(),ae.selectAll())}),E.requestRenderAll(),ee.on("editing:exited",()=>{const ae=ee.text;z==="structure"&&(A.label=ae),z==="seat"&&(A.displayNumber=ae);const ce=[L.getObjects().find(xe=>xe.type==="rect"),ee];ce.forEach(xe=>E.remove(xe));const ue=new $e.fabric.Group(ce,{left:V,top:W,angle:te,hasControls:!0,lockRotation:!1,subTargetCheck:!0});ue.data=A,ue.data.isDirty=!0,z==="seat"?ue.set({borderColor:A.zoneColor||"#5E5CE6",cornerColor:"white",cornerStrokeColor:"#5E5CE6",transparentCorners:!1}):ue.set({borderColor:"#007AFF",cornerColor:"white",cornerStrokeColor:"#007AFF",transparentCorners:!1}),E.add(ue),E.setActiveObject(ue),E.requestRenderAll(),ee.off("editing:exited")})}),E.on("mouse:up",()=>{if(_.current==="structure"&&k.current){const H=k.current,L=H.width,z=H.height,ee=H.left,A=H.top;E.remove(H),setTempRect(null),setDrawStart(null),w(null),L>20&&z>20&&setTimeout(()=>{const V=prompt("  (: , , )","");V&&(saveToHistory(),F(ee,A,L,z,V))},50);return}E.isDragging&&(E.setViewportTransform(E.viewportTransform),E.isDragging=!1)}),E.on("selection:created",H=>{var z,ee,A,V,W;const L=H.selected;if(L.length===1){const te=L[0];n(te),((z=te.data)==null?void 0:z.type)!=="structure"&&(s(((ee=te.data)==null?void 0:ee.seatNumber)||""),o(((A=te.data)==null?void 0:A.displayNumber)||""),c(((V=te.data)==null?void 0:V.zoneName)||"A"),f(((W=te.data)==null?void 0:W.zoneColor)||"#5E5CE6"))}else n(null)}),E.on("selection:updated",H=>{var z,ee,A,V,W;const L=H.selected;if(L.length===1){const te=L[0];n(te),((z=te.data)==null?void 0:z.type)!=="structure"&&(s(((ee=te.data)==null?void 0:ee.seatNumber)||""),o(((A=te.data)==null?void 0:A.displayNumber)||""),c(((V=te.data)==null?void 0:V.zoneName)||"A"),f(((W=te.data)==null?void 0:W.zoneColor)||"#5E5CE6"))}else n(null)}),E.on("selection:cleared",()=>{n(null),s(""),o("")}),E.on("object:modified",async H=>{const L=H.target;if(!L)return;(L.type==="activeSelection"?L.getObjects():[L]).forEach(ee=>{var A;if(ee.data){const V=ee.width*ee.scaleX,W=ee.height*ee.scaleY;ee.set({width:V,height:W,scaleX:1,scaleY:1});const te=ee.getObjects().find(ae=>ae.type==="i-text");if(te){te.set({scaleX:1,scaleY:1}),((A=ee.data)==null?void 0:A.type)==="structure"?te.set({left:0,top:0,originX:"center",originY:"center"}):te.set({left:-V/2+6,top:-W/2+6,originX:"left",originY:"top"});const ae=ee.getObjects().find(Y=>Y.type==="rect");ae&&(ae.set({width:V,height:W}),ae.set({left:-V/2,top:-W/2})),ee.addWithUpdate()}}ee.data&&(ee.data.isDirty=!0)})}),()=>{j=!1,window.removeEventListener("keydown",I),E.dispose(),t.current=null}},[p]);const F=(j,B,E,R,N)=>{const C=new $e.fabric.Rect({fill:"#E5E5EA",width:E,height:R,rx:6,ry:6,stroke:"#D1D1D6",strokeWidth:1}),P=new $e.fabric.IText(N,{fontSize:12,originX:"center",originY:"center",left:E/2,top:R/2,fill:"#8E8E93",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),I=crypto.randomUUID(),H=new $e.fabric.Group([C,P],{left:j,top:B,data:{id:I,type:"structure",label:N,width:E,height:R,isDirty:!0,seatNumber:`STR_${I.slice(-8)}`}});t.current.add(H),t.current.setActiveObject(H)},D=j=>{if(j.type==="structure"){const N=new $e.fabric.Rect({fill:"#E5E5EA",width:j.width||72,height:j.height||72,rx:6,ry:6,stroke:"#D1D1D6",strokeWidth:1}),C=new $e.fabric.IText(j.label||"",{fontSize:12,originX:"center",originY:"center",left:(j.width||72)/2,top:(j.height||72)/2,fill:"#8E8E93",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),P=new $e.fabric.Group([N,C],{id:j.id,left:j.pos_x,top:j.pos_y,angle:j.rotation,data:{id:j.id,type:"structure",label:j.label,width:j.width,height:j.height}});t.current.add(P);return}const B=new $e.fabric.Rect({fill:j.zone_color||"#5E5CE6",width:72,height:72,rx:6,ry:6,stroke:"rgba(255,255,255,0.1)",strokeWidth:2}),E=new $e.fabric.IText(j.display_number||j.seat_number,{fontSize:12,left:6,top:6,fill:"#ffffff",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"900",selectable:!1}),R=new $e.fabric.Group([B,E],{left:j.pos_x,top:j.pos_y,angle:j.rotation,data:{id:j.id,type:"seat",seatNumber:j.seat_number,displayNumber:j.display_number,zoneName:j.zone_name,zoneColor:j.zone_color,globalNumber:j.global_number}});t.current.add(R)},U=()=>{var j;if(r&&((j=r.data)==null?void 0:j.type)!=="structure"){saveToHistory(),r.set("data",{...r.data,seatNumber:i,displayNumber:l,zoneName:a,zoneColor:d});const B=r.getObjects().find(R=>R.type==="i-text");B&&B.set("text",l);const E=r.getObjects().find(R=>R.type==="rect");E&&E.set("fill",d),t.current.renderAll()}},M=()=>{saveToHistory();const B=`${t.current.getObjects().filter(C=>{var P;return((P=C.data)==null?void 0:P.type)!=="structure"}).length+1}`,E=new $e.fabric.Rect({fill:d,width:72,height:72,rx:6,ry:6,stroke:"rgba(255,255,255,0.1)",strokeWidth:2}),R=new $e.fabric.IText(B,{fontSize:18,originX:"center",originY:"center",left:36,top:36,fill:"#ffffff",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"900",selectable:!1}),N=new $e.fabric.Group([E,R],{left:150,top:150,data:{id:crypto.randomUUID(),type:"seat",seatNumber:B,zoneName:a,zoneColor:d,isDirty:!0}});t.current.add(N),t.current.setActiveObject(N)},q=async()=>{const j=t.current;if(!j)return;const B=j.getActiveObject();if(B){saveToHistory();const E=B.type==="activeSelection"?B.getObjects():[B],R=[];E.forEach(N=>{var P;const C=(P=N.data)==null?void 0:P.id;C&&C.length>20&&R.push(C)}),setDeletedIds(N=>[...N,...R]),j.discardActiveObject(),E.forEach(N=>j.remove(N)),j.requestRenderAll(),n(null)}},G=()=>{saveToHistory();const j=t.current.getObjects(),B=["A","B","C"];let E=1;B.forEach(R=>{j.filter(C=>{var P,I;return((P=C.data)==null?void 0:P.zoneName)===R&&((I=C.data)==null?void 0:I.type)!=="structure"}).sort((C,P)=>Math.abs(C.top-P.top)<20?C.left-P.left:C.top-P.top).forEach((C,P)=>{const I=P+1,H=`${R}-${I.toString().padStart(2,"0")}`;C.set("data",{...C.data,seatNumber:I.toString(),displayNumber:H,globalNumber:E++});const L=C.getObjects().find(z=>z.type==="i-text");L&&L.set("text",H)})}),t.current.renderAll()},Q=()=>{const j=t.current.getActiveObject();j&&(saveToHistory(),j.rotate(((j.angle||0)+90)%360),t.current.renderAll())},K=async()=>{x(!0);try{if(deletedIds.length>0){const{error:R}=await we.from("seats").delete().in("id",deletedIds);if(R)throw console.error("Error deleting items:",R),R}const j=t.current.getObjects(),B=[],E=[];if(j.forEach(R=>{var L,z,ee,A,V,W,te,ae,Y;const N=Math.round(R.getScaledWidth()),C=Math.round(R.getScaledHeight()),P=((L=R.data)==null?void 0:L.type)==="structure",I=((z=R.data)==null?void 0:z.seatNumber)||(P?`STR_${R.data.id.slice(-8)}`:"0"),H={zone_id:p,pos_x:Math.round(R.left),pos_y:Math.round(R.top),rotation:Math.round(R.angle||0),type:((ee=R.data)==null?void 0:ee.type)||"seat",width:N,height:C,label:((A=R.data)==null?void 0:A.label)||null,seat_number:I,display_number:((V=R.data)==null?void 0:V.displayNumber)||null,zone_name:((W=R.data)==null?void 0:W.zoneName)||null,zone_color:((te=R.data)==null?void 0:te.zoneColor)||null,global_number:((ae=R.data)==null?void 0:ae.globalNumber)||null};(Y=R.data)!=null&&Y.id&&R.data.id.length>20?(H.id=R.data.id,B.push(H)):E.push(H)}),B.length>0){const{error:R}=await we.from("seats").upsert(B);if(R)throw R}if(E.length>0){const{error:R}=await we.from("seats").insert(E);if(R)throw R}alert("."),setDeletedIds([]),t.current.getObjects().forEach(R=>{R.data&&delete R.data.isDirty}),window.location.reload()}catch(j){console.error("Error saving layout:",j),alert(" : "+(j.message||j.details||JSON.stringify(j)))}finally{x(!1)}},ne=()=>{saveToHistory();const j=t.current.getObjects(),B=30,E=j.filter(P=>{var I;return(I=P.data)==null?void 0:I.isDirty}),R=j.filter(P=>{var I;return!((I=P.data)!=null&&I.isDirty)}),N=R.map(P=>Math.round(P.left)),C=R.map(P=>Math.round(P.top));E.forEach(P=>{let I=P.left,H=P.top,L=I,z=1/0;N.forEach(V=>{const W=Math.abs(I-V);W<B&&W<z&&(z=W,L=V)}),z<B&&P.set("left",L);let ee=H,A=1/0;C.forEach(V=>{const W=Math.abs(H-V);W<B&&W<A&&(A=W,ee=V)}),A<B&&P.set("top",ee),P.setCoords()}),t.current.renderAll()};return y.jsxs("div",{className:"flex flex-col xl:flex-row gap-6 items-stretch w-full h-full mx-auto leading-normal overflow-hidden relative",children:[g&&y.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-30 flex items-center justify-center pointer-events-none",children:y.jsx("div",{className:"w-8 h-8 border-3 border-ios-indigo border-t-transparent rounded-full animate-spin"})}),y.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[y.jsx("div",{className:"flex gap-[10px] m-[10px] mb-4 inline-flex self-start",children:h.map(j=>y.jsx("button",{onClick:()=>m(j.id),className:`px-6 py-2 rounded-lg text-xs font-black transition-all ios-tap border-none outline-none ring-0 ${p===j.id?"bg-[#1C1C1E] text-white shadow-md":"bg-gray-100 text-ios-gray hover:bg-gray-200"}`,children:j.name},j.id))}),y.jsx("div",{className:"flex-1 w-full bg-white rounded-t-[6px] rounded-b-none border-0 overflow-hidden p-2.5 pb-0",children:y.jsx("div",{ref:e,className:"flex-1 h-full relative overflow-hidden cursor-grab active:cursor-grabbing touch-none select-none scrollbar-hide"})})]}),y.jsx("div",{className:"w-full xl:w-80 h-full overflow-y-auto scrollbar-hide space-y-6 animate-spring-up",children:y.jsxs("div",{className:"bg-white border border-gray-100 rounded-[6px] p-6 space-y-8 shadow-sm",children:[y.jsxs("div",{className:"space-y-3",children:[y.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-ios-gray",children:" "}),v==="structure"&&y.jsx("div",{className:"bg-ios-indigo/10 text-ios-indigo text-xs font-bold p-3 rounded-[6px] text-center animate-pulse mb-2",children:"    "}),y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsxs("button",{onClick:M,className:"flex flex-col items-center justify-center gap-2 bg-gray-50 hover:bg-gray-100 p-4 rounded-[6px] transition-all border border-gray-100 ios-tap group",children:[y.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center group-hover:scale-110 transition-transform",children:y.jsx(il,{className:"w-5 h-5 text-ios-indigo"})}),y.jsx("span",{className:"font-black text-[10px] text-[#1C1C1E]",children:" "})]}),y.jsxs("button",{onClick:()=>w(j=>j==="structure"?null:"structure"),className:`flex flex-col items-center justify-center gap-2 p-4 rounded-[6px] transition-all border ios-tap group ${v==="structure"?"bg-gray-100 border-ios-indigo ring-1 ring-ios-indigo":"bg-gray-50 hover:bg-gray-100 border-gray-100"}`,children:[y.jsx("div",{className:"w-10 h-10 rounded-[6px] flex items-center justify-center group-hover:scale-110 transition-transform bg-ios-indigo/10",children:y.jsx(XS,{className:"w-5 h-5 text-ios-indigo"})}),y.jsx("span",{className:"font-black text-[10px] text-[#1C1C1E]",children:" "})]})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsxs("button",{onClick:G,className:"w-full flex items-center justify-center gap-2 bg-gray-50 hover:bg-gray-100 p-4 rounded-[6px] transition-all border border-gray-100 ios-tap",children:[y.jsx(zS,{className:"w-4 h-4 text-ios-amber"}),y.jsx("span",{className:"font-black text-[10px] text-[#1C1C1E]",children:" "})]}),y.jsxs("button",{onClick:ne,className:"w-full flex items-center justify-center gap-2 bg-gray-50 hover:bg-gray-100 p-4 rounded-[6px] transition-all border border-gray-100 ios-tap",children:[y.jsx(US,{className:"w-4 h-4 text-ios-emerald"}),y.jsx("span",{className:"font-black text-[10px] text-[#1C1C1E]",children:" "})]})]}),y.jsxs("button",{onClick:K,disabled:g,className:"w-full flex items-center justify-center gap-2 bg-gray-50 hover:bg-gray-100 p-4 rounded-[6px] transition-all border border-gray-100 ios-tap disabled:opacity-50 group mt-2",children:[y.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center group-hover:scale-110 transition-transform",children:y.jsx(pu,{className:`w-5 h-5 text-ios-indigo ${g?"animate-spin":""}`})}),y.jsx("span",{className:"font-black text-[10px] text-[#1C1C1E]",children:" "})]})]}),y.jsxs("div",{className:`space-y-6 transition-all duration-300 ${r?"opacity-100 translate-y-0":"opacity-20 translate-y-2 pointer-events-none filter blur-[2px]"}`,children:[y.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-ios-gray",children:" "}),((J=r==null?void 0:r.data)==null?void 0:J.type)!=="structure"&&y.jsx(y.Fragment,{children:y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:"Display No"}),y.jsx("input",{type:"text",value:l,onChange:j=>o(j.target.value),className:"w-full bg-white border border-gray-200 rounded-[6px] p-3 text-sm font-black text-[#1C1C1E] focus:ring-1 focus:ring-ios-indigo transition-all",placeholder:": A-01"})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:"Zone"}),y.jsxs("select",{value:a,onChange:j=>c(j.target.value),className:"w-full bg-white border border-gray-200 rounded-[6px] p-3 text-sm font-black text-[#1C1C1E] focus:ring-1 focus:ring-ios-indigo appearance-none",children:[y.jsx("option",{value:"A",children:"Zone A"}),y.jsx("option",{value:"B",children:"Zone B"}),y.jsx("option",{value:"C",children:"Zone C"})]})]})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsxs("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1 flex items-center gap-1.5",children:[y.jsx(ik,{className:"w-2.5 h-2.5"})," Zone Color"]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("input",{type:"color",value:d,onChange:j=>f(j.target.value),className:"w-12 h-12 bg-transparent border-0 rounded-[6px] cursor-pointer overflow-hidden p-0 shadow-sm"}),y.jsx("input",{type:"text",value:d.toUpperCase(),onChange:j=>f(j.target.value),className:"flex-1 bg-white border border-gray-200 rounded-[6px] p-3 text-sm font-black text-[#1C1C1E] focus:ring-1 focus:ring-ios-indigo"})]})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsx("button",{onClick:()=>n(null),className:"w-full bg-gray-100 text-gray-500 py-4 rounded-[6px] font-black text-xs hover:bg-gray-200 ios-tap",children:"/"}),y.jsx("button",{onClick:U,className:"w-full bg-[#1C1C1E] text-white py-4 rounded-[6px] font-black text-xs shadow-sm shadow-black/10 ios-tap",children:" "})]})]})}),((T=r==null?void 0:r.data)==null?void 0:T.type)==="structure"&&y.jsx("div",{className:"py-4 text-center",children:y.jsx("p",{className:"text-xs text-ios-gray",children:" //  ."})}),y.jsxs("div",{className:"grid grid-cols-2 gap-3 pb-2",children:[y.jsxs("button",{onClick:Q,className:"flex items-center justify-center gap-2 bg-gray-50 hover:bg-gray-100 p-4 rounded-[6px] transition-all border border-gray-100 ios-tap",children:[y.jsx(xk,{className:"w-4 h-4 text-ios-blue"}),y.jsx("span",{className:"font-black text-[10px] text-[#1C1C1E]",children:""})]}),y.jsxs("button",{onClick:q,className:"flex items-center justify-center gap-2 bg-ios-rose/5 hover:bg-ios-rose/10 text-ios-rose p-4 rounded-[6px] transition-all border border-ios-rose/10 ios-tap",children:[y.jsx(Li,{className:"w-4 h-4"}),y.jsx("span",{className:"font-black text-[10px]",children:""})]})]})]})]})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var vu={};vu.version="0.18.5";var qv=1252,vE=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],N0={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},A0=function(e){vE.indexOf(e)!=-1&&(qv=N0[0]=e)};function yE(){A0(1252)}var Sn=function(e){A0(e)};function O0(){Sn(1200),yE()}function tm(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function wE(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Kv(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var yo=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?wE(e.slice(2)):t==254&&r==255?Kv(e.slice(2)):t==65279?e.slice(1):e},mc=function(t){return String.fromCharCode(t)},rm=function(t){return String.fromCharCode(t)},hl,Ni="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function dl(e){for(var t="",r=0,n=0,i=0,s=0,l=0,o=0,a=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),l=(r&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,a=i&63,isNaN(n)?o=a=64:isNaN(i)&&(a=64),t+=Ni.charAt(s)+Ni.charAt(l)+Ni.charAt(o)+Ni.charAt(a);return t}function Jr(e){var t="",r=0,n=0,i=0,s=0,l=0,o=0,a=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=Ni.indexOf(e.charAt(c++)),l=Ni.indexOf(e.charAt(c++)),r=s<<2|l>>4,t+=String.fromCharCode(r),o=Ni.indexOf(e.charAt(c++)),n=(l&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),a=Ni.indexOf(e.charAt(c++)),i=(o&3)<<6|a,a!==64&&(t+=String.fromCharCode(i));return t}var Qe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),di=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Vi(e){return Qe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function nm(e){return Qe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Vr=function(t){return Qe?di(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Qu(e){if(typeof ArrayBuffer>"u")return Vr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Qi(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function _E(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function F0(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return F0(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var er=Qe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:di(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function bE(e){for(var t=[],r=0,n=e.length+250,i=Vi(e.length+255),s=0;s<e.length;++s){var l=e.charCodeAt(s);if(l<128)i[r++]=l;else if(l<2048)i[r++]=192|l>>6&31,i[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|l>>8&7,i[r++]=128|l>>2&63,i[r++]=128|o>>6&15|(l&3)<<4,i[r++]=128|o&63}else i[r++]=224|l>>12&15,i[r++]=128|l>>6&63,i[r++]=128|l&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Vi(65535),n=65530)}return t.push(i.slice(0,r)),er(t)}var Ar=/\u0000/g,wo=/[\u0001-\u0006]/g;function Na(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function kn(e,t){var r=""+e;return r.length>=t?r:Dt("0",t-r.length)+r}function j0(e,t){var r=""+e;return r.length>=t?r:Dt(" ",t-r.length)+r}function yu(e,t){var r=""+e;return r.length>=t?r:r+Dt(" ",t-r.length)}function SE(e,t){var r=""+Math.round(e);return r.length>=t?r:Dt("0",t-r.length)+r}function kE(e,t){var r=""+e;return r.length>=t?r:Dt("0",t-r.length)+r}var im=Math.pow(2,32);function Qs(e,t){if(e>im||e<-im)return SE(e,t);var r=Math.round(e);return kE(r,t)}function wu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var sm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],qf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function CE(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},am={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},TE={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function _u(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,l=1,o=0,a=1,c=0,d=0,f=Math.floor(i);c<t&&(f=Math.floor(i),o=f*l+s,d=f*c+a,!(i-f<5e-8));)i=1/(i-f),s=l,l=o,a=c,c=d;if(d>t&&(c>t?(d=a,o=s):(d=c,o=l)),!r)return[0,n*o,d];var h=Math.floor(n*o/d);return[h,n*o-h*d,d]}function gs(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,l=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)l=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var a=new Date(1900,0,1);a.setDate(a.getDate()+n-1),l=[a.getFullYear(),a.getMonth()+1,a.getDate()],s=a.getDay(),n<60&&(s=(s+6)%7),r&&(s=jE(a,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var Jv=new Date(1899,11,31,0,0,0),EE=Jv.getTime(),NE=new Date(1900,2,1,0,0,0);function Qv(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=NE&&(r+=24*60*60*1e3),(r-(EE+(e.getTimezoneOffset()-Jv.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function P0(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function AE(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function OE(e){var t=e<0?12:11,r=P0(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function FE(e){var t=P0(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function pl(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=OE(e):t===10?r=e.toFixed(10).substr(0,12):r=FE(e),P0(AE(r.toUpperCase()))}function Os(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):pl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return pn(14,Qv(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function jE(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function PE(e,t,r,n){var i="",s=0,l=0,o=r.y,a,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:a=o%100,c=2;break;default:a=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:a=r.m,c=t.length;break;case 3:return qf[r.m-1][1];case 5:return qf[r.m-1][0];default:return qf[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=r.d,c=t.length;break;case 3:return sm[r.q][0];default:return sm[r.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?kn(r.S,t.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,s=Math.round(l*(r.S+r.u)),s>=60*l&&(s=0),t==="s"?s===0?"0":""+s/l:(i=kn(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":a=r.D*24+r.H;break;case"[m]":case"[mm]":a=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":a=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:a=o,c=1;break}var d=c>0?kn(a,c):"";return d}function Ai(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Zv=/%/g;function DE(e,t,r){var n=t.replace(Zv,""),i=t.length-n.length;return ti(e,n,r*Math.pow(10,2*i))+Dt("%",i)}function RE(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ti(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function ey(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+ey(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,a,c,d){return a+c+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var ty=/# (\?+)( ?)\/( ?)(\d+)/;function IE(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),l=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(l===0?Dt(" ",e[1].length+1+e[4].length):j0(l,e[1].length)+e[2]+"/"+e[3]+kn(o,e[4].length))}function ME(e,t,r){return r+(t===0?"":""+t)+Dt(" ",e[1].length+2+e[4].length)}var ry=/^#*0*\.([0#]+)/,ny=/\).*[0#]/,iy=/\(###\) ###\\?-####/;function Tr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function om(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function lm(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function LE(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function BE(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function tn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ny)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?tn("n",n,r):"("+tn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return RE(e,t,r);if(t.indexOf("%")!==-1)return DE(e,t,r);if(t.indexOf("E")!==-1)return ey(t,r);if(t.charCodeAt(0)===36)return"$"+tn(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,l,o,a=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Qs(a,t.length);if(t.match(/^[#?]+$/))return i=Qs(r,0),i==="0"&&(i=""),i.length>t.length?i:Tr(t.substr(0,t.length-i.length))+i;if(s=t.match(ty))return IE(s,a,c);if(t.match(/^#+0+$/))return c+Qs(a,t.length-t.indexOf("0"));if(s=t.match(ry))return i=om(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Tr(s[1])).replace(/\.$/,"."+Tr(s[1])).replace(/\.(\d*)$/,function(p,m){return"."+m+Dt("0",Tr(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+om(a,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Ai(Qs(a,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+tn(e,t,-r):Ai(""+(Math.floor(r)+LE(r,s[1].length)))+"."+kn(lm(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return tn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Na(tn(e,t.replace(/[\\-]/g,""),r)),l=0,Na(Na(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<i.length?i.charAt(l++):p==="0"?"0":""}));if(t.match(iy))return i=tn(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),o=_u(a,Math.pow(10,l)-1,!1),i=""+c,d=ti("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=yu(o[2],l),d.length<s[4].length&&(d=Tr(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),o=_u(a,Math.pow(10,l)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?j0(o[1],l)+s[2]+"/"+s[3]+yu(o[2],l):Dt(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=Qs(r,0),t.length<=i.length?i:Tr(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=i.indexOf(".");var f=t.indexOf(".")-l,h=t.length-i.length-f;return Tr(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return l=lm(r,s[1].length),r<0?"-"+tn(e,t,-r):Ai(BE(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?kn(0,3-p.length):"")+p})+"."+kn(l,s[1].length);switch(t){case"###,##0.00":return tn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var u=Ai(Qs(a,0));return u!=="0"?c+u:"";case"###,###.00":return tn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return tn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function UE(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ti(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function WE(e,t,r){var n=t.replace(Zv,""),i=t.length-n.length;return ti(e,n,r*Math.pow(10,2*i))+Dt("%",i)}function sy(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+sy(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,a,c,d){return a+c+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Dn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ny)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Dn("n",n,r):"("+Dn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return UE(e,t,r);if(t.indexOf("%")!==-1)return WE(e,t,r);if(t.indexOf("E")!==-1)return sy(t,r);if(t.charCodeAt(0)===36)return"$"+Dn(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,l,o,a=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+kn(a,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Tr(t.substr(0,t.length-i.length))+i;if(s=t.match(ty))return ME(s,a,c);if(t.match(/^#+0+$/))return c+kn(a,t.length-t.indexOf("0"));if(s=t.match(ry))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Tr(s[1])).replace(/\.$/,"."+Tr(s[1])),i=i.replace(/\.(\d*)$/,function(p,m){return"."+m+Dt("0",Tr(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+a).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Ai(""+a);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Dn(e,t,-r):Ai(""+r)+"."+Dt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Dn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Na(Dn(e,t.replace(/[\\-]/g,""),r)),l=0,Na(Na(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<i.length?i.charAt(l++):p==="0"?"0":""}));if(t.match(iy))return i=Dn(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),o=_u(a,Math.pow(10,l)-1,!1),i=""+c,d=ti("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=yu(o[2],l),d.length<s[4].length&&(d=Tr(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),o=_u(a,Math.pow(10,l)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?j0(o[1],l)+s[2]+"/"+s[3]+yu(o[2],l):Dt(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Tr(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=i.indexOf(".");var f=t.indexOf(".")-l,h=t.length-i.length-f;return Tr(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Dn(e,t,-r):Ai(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?kn(0,3-p.length):"")+p})+"."+kn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var u=Ai(""+a);return u!=="0"?c+u:"";default:if(t.match(/\.[0#?]*$/))return Dn(e,t.slice(0,t.lastIndexOf(".")),r)+Tr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ti(e,t,r){return(r|0)===r?Dn(e,t,r):tn(e,t,r)}function zE(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var ay=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function qa(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":wu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(ay))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function HE(e,t,r,n){for(var i=[],s="",l=0,o="",a="t",c,d,f,h="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!wu(e,l))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(f=e.charCodeAt(++l))!==34&&l<e.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++l;break;case"\\":var u=e.charAt(++l),p=u==="("||u===")"?u:"t";i[i.length]={t:p,v:u},++l;break;case"_":i[i.length]={t:"t",v:" "},l+=2;break;case"@":i[i.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(c==null&&(c=gs(t,r,e.charAt(l+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(l,2)},a=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=gs(t,r),c==null))return"";for(s=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)s+=o;o==="m"&&a.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),i[i.length]={t:o,v:s},a=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=gs(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",h="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",l+=5,h="h"):e.substr(l,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",l+=5,h="h"):(m.t="t",++l),c==null&&m.t==="T")return"";i[i.length]=m,a=o;break;case"[":for(s=o;e.charAt(l++)!=="]"&&l<e.length;)s+=e.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(ay)){if(c==null&&(c=gs(t,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},a=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",qa(e)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++l<e.length&&(o=e.charAt(l))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++l)===o;)s+=o;i[i.length]={t:o,v:s},a=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)s+=e.charAt(l);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++l;break;case"$":i[i.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++l;break}var g=0,x=0,v;for(l=i.length-1,a="t";l>=0;--l)switch(i[l].t){case"h":case"H":i[l].t=h,a="h",g<1&&(g=1);break;case"s":(v=i[l].v.match(/\.0+$/))&&(x=Math.max(x,v[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":a=i[l].t;break;case"m":a==="s"&&(i[l].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&i[l].v.match(/[Hh]/)&&(g=1),g<2&&i[l].v.match(/[Mm]/)&&(g=2),g<3&&i[l].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var w="",_;for(l=0;l<i.length;++l)switch(i[l].t){case"t":case"T":case" ":case"D":break;case"X":i[l].v="",i[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[l].v=PE(i[l].t.charCodeAt(0),i[l].v,c,x),i[l].t="t";break;case"n":case"?":for(_=l+1;i[_]!=null&&((o=i[_].t)==="?"||o==="D"||(o===" "||o==="t")&&i[_+1]!=null&&(i[_+1].t==="?"||i[_+1].t==="t"&&i[_+1].v==="/")||i[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[_].v==="/"||i[_].v===" "&&i[_+1]!=null&&i[_+1].t=="?"));)i[l].v+=i[_].v,i[_]={v:"",t:";"},++_;w+=i[l].v,l=_-1;break;case"G":i[l].t="t",i[l].v=Os(t,r);break}var b="",k,S;if(w.length>0){w.charCodeAt(0)==40?(k=t<0&&w.charCodeAt(0)===45?-t:t,S=ti("n",w,k)):(k=t<0&&n>1?-t:t,S=ti("n",w,k),k<0&&i[0]&&i[0].t=="t"&&(S=S.substr(1),i[0].v="-"+i[0].v)),_=S.length-1;var O=i.length;for(l=0;l<i.length;++l)if(i[l]!=null&&i[l].t!="t"&&i[l].v.indexOf(".")>-1){O=l;break}var F=i.length;if(O===i.length&&S.indexOf("E")===-1){for(l=i.length-1;l>=0;--l)i[l]==null||"n?".indexOf(i[l].t)===-1||(_>=i[l].v.length-1?(_-=i[l].v.length,i[l].v=S.substr(_+1,i[l].v.length)):_<0?i[l].v="":(i[l].v=S.substr(0,_+1),_=-1),i[l].t="t",F=l);_>=0&&F<i.length&&(i[F].v=S.substr(0,_+1)+i[F].v)}else if(O!==i.length&&S.indexOf("E")===-1){for(_=S.indexOf(".")-1,l=O;l>=0;--l)if(!(i[l]==null||"n?".indexOf(i[l].t)===-1)){for(d=i[l].v.indexOf(".")>-1&&l===O?i[l].v.indexOf(".")-1:i[l].v.length-1,b=i[l].v.substr(d+1);d>=0;--d)_>=0&&(i[l].v.charAt(d)==="0"||i[l].v.charAt(d)==="#")&&(b=S.charAt(_--)+b);i[l].v=b,i[l].t="t",F=l}for(_>=0&&F<i.length&&(i[F].v=S.substr(0,_+1)+i[F].v),_=S.indexOf(".")+1,l=O;l<i.length;++l)if(!(i[l]==null||"n?(".indexOf(i[l].t)===-1&&l!==O)){for(d=i[l].v.indexOf(".")>-1&&l===O?i[l].v.indexOf(".")+1:0,b=i[l].v.substr(0,d);d<i[l].v.length;++d)_<S.length&&(b+=S.charAt(_++));i[l].v=b,i[l].t="t",F=l}}}for(l=0;l<i.length;++l)i[l]!=null&&"n?".indexOf(i[l].t)>-1&&(k=n>1&&t<0&&l>0&&i[l-1].v==="-"?-t:t,i[l].v=ti(i[l].t,i[l].v,k),i[l].t="t");var D="";for(l=0;l!==i.length;++l)i[l]!=null&&(D+=i[l].v);return D}var cm=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function um(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function $E(e,t){var r=zE(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(cm),o=r[1].match(cm);return um(t,l)?[n,r[0]]:um(t,o)?[n,r[1]]:[n,r[l!=null&&o!=null?2:1]]}return[n,s]}function pn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ze)[e],n==null&&(n=r.table&&r.table[am[e]]||ze[am[e]]),n==null&&(n=TE[e]||"General");break}if(wu(n,0))return Os(t,r);t instanceof Date&&(t=Qv(t,r.date1904));var i=$E(n,t);if(wu(i[1]))return Os(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return HE(i[1],t,r,i[0])}function ri(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ze[r]==null){t<0&&(t=r);continue}if(ze[r]==e){t=r;break}}t<0&&(t=391)}return ze[t]=e,t}function Zu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&ri(e[t],t)}function Ka(){ze=CE()}var VE={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},oy=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function XE(e){var t=typeof e=="number"?ze[e]:e;return t=t.replace(oy,"(\\d+)"),new RegExp("^"+t+"$")}function YE(e,t,r){var n=-1,i=-1,s=-1,l=-1,o=-1,a=-1;(t.match(oy)||[]).forEach(function(f,h){var u=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=u;break;case"d":s=u;break;case"h":l=u;break;case"s":a=u;break;case"m":l>=0?o=u:i=u;break}}),a>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var d=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2);return l==-1&&o==-1&&a==-1?c:n==-1&&i==-1&&s==-1?d:c+"T"+d}var GE=function(){var e={};e.version="1.2.0";function t(){for(var S=0,O=new Array(256),F=0;F!=256;++F)S=F,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,O[F]=S;return typeof Int32Array<"u"?new Int32Array(O):O}var r=t();function n(S){var O=0,F=0,D=0,U=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(D=0;D!=256;++D)U[D]=S[D];for(D=0;D!=256;++D)for(F=S[D],O=256+D;O<4096;O+=256)F=U[O]=F>>>8^S[F&255];var M=[];for(D=1;D!=16;++D)M[D-1]=typeof Int32Array<"u"?U.subarray(D*256,D*256+256):U.slice(D*256,D*256+256);return M}var i=n(r),s=i[0],l=i[1],o=i[2],a=i[3],c=i[4],d=i[5],f=i[6],h=i[7],u=i[8],p=i[9],m=i[10],g=i[11],x=i[12],v=i[13],w=i[14];function _(S,O){for(var F=O^-1,D=0,U=S.length;D<U;)F=F>>>8^r[(F^S.charCodeAt(D++))&255];return~F}function b(S,O){for(var F=O^-1,D=S.length-15,U=0;U<D;)F=w[S[U++]^F&255]^v[S[U++]^F>>8&255]^x[S[U++]^F>>16&255]^g[S[U++]^F>>>24]^m[S[U++]]^p[S[U++]]^u[S[U++]]^h[S[U++]]^f[S[U++]]^d[S[U++]]^c[S[U++]]^a[S[U++]]^o[S[U++]]^l[S[U++]]^s[S[U++]]^r[S[U++]];for(D+=15;U<D;)F=F>>>8^r[(F^S[U++])&255];return~F}function k(S,O){for(var F=O^-1,D=0,U=S.length,M=0,q=0;D<U;)M=S.charCodeAt(D++),M<128?F=F>>>8^r[(F^M)&255]:M<2048?(F=F>>>8^r[(F^(192|M>>6&31))&255],F=F>>>8^r[(F^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,q=S.charCodeAt(D++)&1023,F=F>>>8^r[(F^(240|M>>8&7))&255],F=F>>>8^r[(F^(128|M>>2&63))&255],F=F>>>8^r[(F^(128|q>>6&15|(M&3)<<4))&255],F=F>>>8^r[(F^(128|q&63))&255]):(F=F>>>8^r[(F^(224|M>>12&15))&255],F=F>>>8^r[(F^(128|M>>6&63))&255],F=F>>>8^r[(F^(128|M&63))&255]);return~F}return e.table=r,e.bstr=_,e.buf=b,e.str=k,e}(),Le=function(){var t={};t.version="1.2.1";function r(X,ie){for(var Z=X.split("/"),re=ie.split("/"),se=0,oe=0,de=Math.min(Z.length,re.length);se<de;++se){if(oe=Z[se].length-re[se].length)return oe;if(Z[se]!=re[se])return Z[se]<re[se]?-1:1}return Z.length-re.length}function n(X){if(X.charAt(X.length-1)=="/")return X.slice(0,-1).indexOf("/")===-1?X:n(X.slice(0,-1));var ie=X.lastIndexOf("/");return ie===-1?X:X.slice(0,ie+1)}function i(X){if(X.charAt(X.length-1)=="/")return i(X.slice(0,-1));var ie=X.lastIndexOf("/");return ie===-1?X:X.slice(ie+1)}function s(X,ie){typeof ie=="string"&&(ie=new Date(ie));var Z=ie.getHours();Z=Z<<6|ie.getMinutes(),Z=Z<<5|ie.getSeconds()>>>1,X.write_shift(2,Z);var re=ie.getFullYear()-1980;re=re<<4|ie.getMonth()+1,re=re<<5|ie.getDate(),X.write_shift(2,re)}function l(X){var ie=X.read_shift(2)&65535,Z=X.read_shift(2)&65535,re=new Date,se=Z&31;Z>>>=5;var oe=Z&15;Z>>>=4,re.setMilliseconds(0),re.setFullYear(Z+1980),re.setMonth(oe-1),re.setDate(se);var de=ie&31;ie>>>=5;var ye=ie&63;return ie>>>=6,re.setHours(ie),re.setMinutes(ye),re.setSeconds(de<<1),re}function o(X){or(X,0);for(var ie={},Z=0;X.l<=X.length-4;){var re=X.read_shift(2),se=X.read_shift(2),oe=X.l+se,de={};switch(re){case 21589:Z=X.read_shift(1),Z&1&&(de.mtime=X.read_shift(4)),se>5&&(Z&2&&(de.atime=X.read_shift(4)),Z&4&&(de.ctime=X.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}X.l=oe,ie[re]=de}return ie}var a;function c(){return a||(a={})}function d(X,ie){if(X[0]==80&&X[1]==75)return vp(X,ie);if((X[0]|32)==109&&(X[1]|32)==105)return T_(X,ie);if(X.length<512)throw new Error("CFB file size "+X.length+" < 512");var Z=3,re=512,se=0,oe=0,de=0,ye=0,he=0,pe=[],ge=X.slice(0,512);or(ge,0);var Se=f(ge);switch(Z=Se[0],Z){case 3:re=512;break;case 4:re=4096;break;case 0:if(Se[1]==0)return vp(X,ie);default:throw new Error("Major Version: Expected 3 or 4 saw "+Z)}re!==512&&(ge=X.slice(0,re),or(ge,28));var Oe=X.slice(0,re);h(ge,Z);var je=ge.read_shift(4,"i");if(Z===3&&je!==0)throw new Error("# Directory Sectors: Expected 0 saw "+je);ge.l+=4,de=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),ye=ge.read_shift(4,"i"),se=ge.read_shift(4,"i"),he=ge.read_shift(4,"i"),oe=ge.read_shift(4,"i");for(var Te=-1,Fe=0;Fe<109&&(Te=ge.read_shift(4,"i"),!(Te<0));++Fe)pe[Fe]=Te;var qe=u(X,re);g(he,oe,qe,re,pe);var kt=v(qe,de,pe,re);kt[de].name="!Directory",se>0&&ye!==q&&(kt[ye].name="!MiniFAT"),kt[pe[0]].name="!FAT",kt.fat_addrs=pe,kt.ssz=re;var Ct={},hr=[],Za=[],eo=[];w(de,kt,qe,hr,se,Ct,Za,ye),p(Za,eo,hr),hr.shift();var to={FileIndex:Za,FullPaths:eo};return ie&&ie.raw&&(to.raw={header:Oe,sectors:qe}),to}function f(X){if(X[X.l]==80&&X[X.l+1]==75)return[0,0];X.chk(G,"Header Signature: "),X.l+=16;var ie=X.read_shift(2,"u");return[X.read_shift(2,"u"),ie]}function h(X,ie){var Z=9;switch(X.l+=2,Z=X.read_shift(2)){case 9:if(ie!=3)throw new Error("Sector Shift: Expected 9 saw "+Z);break;case 12:if(ie!=4)throw new Error("Sector Shift: Expected 12 saw "+Z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Z)}X.chk("0600","Mini Sector Shift: "),X.chk("000000000000","Reserved: ")}function u(X,ie){for(var Z=Math.ceil(X.length/ie)-1,re=[],se=1;se<Z;++se)re[se-1]=X.slice(se*ie,(se+1)*ie);return re[Z-1]=X.slice(Z*ie),re}function p(X,ie,Z){for(var re=0,se=0,oe=0,de=0,ye=0,he=Z.length,pe=[],ge=[];re<he;++re)pe[re]=ge[re]=re,ie[re]=Z[re];for(;ye<ge.length;++ye)re=ge[ye],se=X[re].L,oe=X[re].R,de=X[re].C,pe[re]===re&&(se!==-1&&pe[se]!==se&&(pe[re]=pe[se]),oe!==-1&&pe[oe]!==oe&&(pe[re]=pe[oe])),de!==-1&&(pe[de]=re),se!==-1&&re!=pe[re]&&(pe[se]=pe[re],ge.lastIndexOf(se)<ye&&ge.push(se)),oe!==-1&&re!=pe[re]&&(pe[oe]=pe[re],ge.lastIndexOf(oe)<ye&&ge.push(oe));for(re=1;re<he;++re)pe[re]===re&&(oe!==-1&&pe[oe]!==oe?pe[re]=pe[oe]:se!==-1&&pe[se]!==se&&(pe[re]=pe[se]));for(re=1;re<he;++re)if(X[re].type!==0){if(ye=re,ye!=pe[ye])do ye=pe[ye],ie[re]=ie[ye]+"/"+ie[re];while(ye!==0&&pe[ye]!==-1&&ye!=pe[ye]);pe[re]=-1}for(ie[0]+="/",re=1;re<he;++re)X[re].type!==2&&(ie[re]+="/")}function m(X,ie,Z){for(var re=X.start,se=X.size,oe=[],de=re;Z&&se>0&&de>=0;)oe.push(ie.slice(de*M,de*M+M)),se-=M,de=us(Z,de*4);return oe.length===0?me(0):er(oe).slice(0,X.size)}function g(X,ie,Z,re,se){var oe=q;if(X===q){if(ie!==0)throw new Error("DIFAT chain shorter than expected")}else if(X!==-1){var de=Z[X],ye=(re>>>2)-1;if(!de)return;for(var he=0;he<ye&&(oe=us(de,he*4))!==q;++he)se.push(oe);g(us(de,re-4),ie-1,Z,re,se)}}function x(X,ie,Z,re,se){var oe=[],de=[];se||(se=[]);var ye=re-1,he=0,pe=0;for(he=ie;he>=0;){se[he]=!0,oe[oe.length]=he,de.push(X[he]);var ge=Z[Math.floor(he*4/re)];if(pe=he*4&ye,re<4+pe)throw new Error("FAT boundary crossed: "+he+" 4 "+re);if(!X[ge])break;he=us(X[ge],pe)}return{nodes:oe,data:bm([de])}}function v(X,ie,Z,re){var se=X.length,oe=[],de=[],ye=[],he=[],pe=re-1,ge=0,Se=0,Oe=0,je=0;for(ge=0;ge<se;++ge)if(ye=[],Oe=ge+ie,Oe>=se&&(Oe-=se),!de[Oe]){he=[];var Te=[];for(Se=Oe;Se>=0;){Te[Se]=!0,de[Se]=!0,ye[ye.length]=Se,he.push(X[Se]);var Fe=Z[Math.floor(Se*4/re)];if(je=Se*4&pe,re<4+je)throw new Error("FAT boundary crossed: "+Se+" 4 "+re);if(!X[Fe]||(Se=us(X[Fe],je),Te[Se]))break}oe[Oe]={nodes:ye,data:bm([he])}}return oe}function w(X,ie,Z,re,se,oe,de,ye){for(var he=0,pe=re.length?2:0,ge=ie[X].data,Se=0,Oe=0,je;Se<ge.length;Se+=128){var Te=ge.slice(Se,Se+128);or(Te,64),Oe=Te.read_shift(2),je=U0(Te,0,Oe-pe),re.push(je);var Fe={name:je,type:Te.read_shift(1),color:Te.read_shift(1),L:Te.read_shift(4,"i"),R:Te.read_shift(4,"i"),C:Te.read_shift(4,"i"),clsid:Te.read_shift(16),state:Te.read_shift(4,"i"),start:0,size:0},qe=Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2);qe!==0&&(Fe.ct=_(Te,Te.l-8));var kt=Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2);kt!==0&&(Fe.mt=_(Te,Te.l-8)),Fe.start=Te.read_shift(4,"i"),Fe.size=Te.read_shift(4,"i"),Fe.size<0&&Fe.start<0&&(Fe.size=Fe.type=0,Fe.start=q,Fe.name=""),Fe.type===5?(he=Fe.start,se>0&&he!==q&&(ie[he].name="!StreamData")):Fe.size>=4096?(Fe.storage="fat",ie[Fe.start]===void 0&&(ie[Fe.start]=x(Z,Fe.start,ie.fat_addrs,ie.ssz)),ie[Fe.start].name=Fe.name,Fe.content=ie[Fe.start].data.slice(0,Fe.size)):(Fe.storage="minifat",Fe.size<0?Fe.size=0:he!==q&&Fe.start!==q&&ie[he]&&(Fe.content=m(Fe,ie[he].data,(ie[ye]||{}).data))),Fe.content&&or(Fe.content,0),oe[je]=Fe,de.push(Fe)}}function _(X,ie){return new Date(($r(X,ie+4)/1e7*Math.pow(2,32)+$r(X,ie)/1e7-11644473600)*1e3)}function b(X,ie){return c(),d(a.readFileSync(X),ie)}function k(X,ie){var Z=ie&&ie.type;switch(Z||Qe&&Buffer.isBuffer(X)&&(Z="buffer"),Z||"base64"){case"file":return b(X,ie);case"base64":return d(Vr(Jr(X)),ie);case"binary":return d(Vr(X),ie)}return d(X,ie)}function S(X,ie){var Z=ie||{},re=Z.root||"Root Entry";if(X.FullPaths||(X.FullPaths=[]),X.FileIndex||(X.FileIndex=[]),X.FullPaths.length!==X.FileIndex.length)throw new Error("inconsistent CFB structure");X.FullPaths.length===0&&(X.FullPaths[0]=re+"/",X.FileIndex[0]={name:re,type:5}),Z.CLSID&&(X.FileIndex[0].clsid=Z.CLSID),O(X)}function O(X){var ie="Sh33tJ5";if(!Le.find(X,"/"+ie)){var Z=me(4);Z[0]=55,Z[1]=Z[3]=50,Z[2]=54,X.FileIndex.push({name:ie,type:2,content:Z,size:4,L:69,R:69,C:69}),X.FullPaths.push(X.FullPaths[0]+ie),F(X)}}function F(X,ie){S(X);for(var Z=!1,re=!1,se=X.FullPaths.length-1;se>=0;--se){var oe=X.FileIndex[se];switch(oe.type){case 0:re?Z=!0:(X.FileIndex.pop(),X.FullPaths.pop());break;case 1:case 2:case 5:re=!0,isNaN(oe.R*oe.L*oe.C)&&(Z=!0),oe.R>-1&&oe.L>-1&&oe.R==oe.L&&(Z=!0);break;default:Z=!0;break}}if(!(!Z&&!ie)){var de=new Date(1987,1,19),ye=0,he=Object.create?Object.create(null):{},pe=[];for(se=0;se<X.FullPaths.length;++se)he[X.FullPaths[se]]=!0,X.FileIndex[se].type!==0&&pe.push([X.FullPaths[se],X.FileIndex[se]]);for(se=0;se<pe.length;++se){var ge=n(pe[se][0]);re=he[ge],re||(pe.push([ge,{name:i(ge).replace("/",""),type:1,clsid:K,ct:de,mt:de,content:null}]),he[ge]=!0)}for(pe.sort(function(je,Te){return r(je[0],Te[0])}),X.FullPaths=[],X.FileIndex=[],se=0;se<pe.length;++se)X.FullPaths[se]=pe[se][0],X.FileIndex[se]=pe[se][1];for(se=0;se<pe.length;++se){var Se=X.FileIndex[se],Oe=X.FullPaths[se];if(Se.name=i(Oe).replace("/",""),Se.L=Se.R=Se.C=-(Se.color=1),Se.size=Se.content?Se.content.length:0,Se.start=0,Se.clsid=Se.clsid||K,se===0)Se.C=pe.length>1?1:-1,Se.size=0,Se.type=5;else if(Oe.slice(-1)=="/"){for(ye=se+1;ye<pe.length&&n(X.FullPaths[ye])!=Oe;++ye);for(Se.C=ye>=pe.length?-1:ye,ye=se+1;ye<pe.length&&n(X.FullPaths[ye])!=n(Oe);++ye);Se.R=ye>=pe.length?-1:ye,Se.type=1}else n(X.FullPaths[se+1]||"")==n(Oe)&&(Se.R=se+1),Se.type=2}}}function D(X,ie){var Z=ie||{};if(Z.fileType=="mad")return E_(X,Z);switch(F(X),Z.fileType){case"zip":return w_(X,Z)}var re=function(je){for(var Te=0,Fe=0,qe=0;qe<je.FileIndex.length;++qe){var kt=je.FileIndex[qe];if(kt.content){var Ct=kt.content.length;Ct>0&&(Ct<4096?Te+=Ct+63>>6:Fe+=Ct+511>>9)}}for(var hr=je.FullPaths.length+3>>2,Za=Te+7>>3,eo=Te+127>>7,to=Za+Fe+hr+eo,ts=to+127>>7,hf=ts<=109?0:Math.ceil((ts-109)/127);to+ts+hf+127>>7>ts;)hf=++ts<=109?0:Math.ceil((ts-109)/127);var Vn=[1,hf,ts,eo,hr,Fe,Te,0];return je.FileIndex[0].size=Te<<6,Vn[7]=(je.FileIndex[0].start=Vn[0]+Vn[1]+Vn[2]+Vn[3]+Vn[4]+Vn[5])+(Vn[6]+7>>3),Vn}(X),se=me(re[7]<<9),oe=0,de=0;{for(oe=0;oe<8;++oe)se.write_shift(1,Q[oe]);for(oe=0;oe<8;++oe)se.write_shift(2,0);for(se.write_shift(2,62),se.write_shift(2,3),se.write_shift(2,65534),se.write_shift(2,9),se.write_shift(2,6),oe=0;oe<3;++oe)se.write_shift(2,0);for(se.write_shift(4,0),se.write_shift(4,re[2]),se.write_shift(4,re[0]+re[1]+re[2]+re[3]-1),se.write_shift(4,0),se.write_shift(4,4096),se.write_shift(4,re[3]?re[0]+re[1]+re[2]-1:q),se.write_shift(4,re[3]),se.write_shift(-4,re[1]?re[0]-1:q),se.write_shift(4,re[1]),oe=0;oe<109;++oe)se.write_shift(-4,oe<re[2]?re[1]+oe:-1)}if(re[1])for(de=0;de<re[1];++de){for(;oe<236+de*127;++oe)se.write_shift(-4,oe<re[2]?re[1]+oe:-1);se.write_shift(-4,de===re[1]-1?q:de+1)}var ye=function(je){for(de+=je;oe<de-1;++oe)se.write_shift(-4,oe+1);je&&(++oe,se.write_shift(-4,q))};for(de=oe=0,de+=re[1];oe<de;++oe)se.write_shift(-4,ne.DIFSECT);for(de+=re[2];oe<de;++oe)se.write_shift(-4,ne.FATSECT);ye(re[3]),ye(re[4]);for(var he=0,pe=0,ge=X.FileIndex[0];he<X.FileIndex.length;++he)ge=X.FileIndex[he],ge.content&&(pe=ge.content.length,!(pe<4096)&&(ge.start=de,ye(pe+511>>9)));for(ye(re[6]+7>>3);se.l&511;)se.write_shift(-4,ne.ENDOFCHAIN);for(de=oe=0,he=0;he<X.FileIndex.length;++he)ge=X.FileIndex[he],ge.content&&(pe=ge.content.length,!(!pe||pe>=4096)&&(ge.start=de,ye(pe+63>>6)));for(;se.l&511;)se.write_shift(-4,ne.ENDOFCHAIN);for(oe=0;oe<re[4]<<2;++oe){var Se=X.FullPaths[oe];if(!Se||Se.length===0){for(he=0;he<17;++he)se.write_shift(4,0);for(he=0;he<3;++he)se.write_shift(4,-1);for(he=0;he<12;++he)se.write_shift(4,0);continue}ge=X.FileIndex[oe],oe===0&&(ge.start=ge.size?ge.start-1:q);var Oe=oe===0&&Z.root||ge.name;if(pe=2*(Oe.length+1),se.write_shift(64,Oe,"utf16le"),se.write_shift(2,pe),se.write_shift(1,ge.type),se.write_shift(1,ge.color),se.write_shift(-4,ge.L),se.write_shift(-4,ge.R),se.write_shift(-4,ge.C),ge.clsid)se.write_shift(16,ge.clsid,"hex");else for(he=0;he<4;++he)se.write_shift(4,0);se.write_shift(4,ge.state||0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,ge.start),se.write_shift(4,ge.size),se.write_shift(4,0)}for(oe=1;oe<X.FileIndex.length;++oe)if(ge=X.FileIndex[oe],ge.size>=4096)if(se.l=ge.start+1<<9,Qe&&Buffer.isBuffer(ge.content))ge.content.copy(se,se.l,0,ge.size),se.l+=ge.size+511&-512;else{for(he=0;he<ge.size;++he)se.write_shift(1,ge.content[he]);for(;he&511;++he)se.write_shift(1,0)}for(oe=1;oe<X.FileIndex.length;++oe)if(ge=X.FileIndex[oe],ge.size>0&&ge.size<4096)if(Qe&&Buffer.isBuffer(ge.content))ge.content.copy(se,se.l,0,ge.size),se.l+=ge.size+63&-64;else{for(he=0;he<ge.size;++he)se.write_shift(1,ge.content[he]);for(;he&63;++he)se.write_shift(1,0)}if(Qe)se.l=se.length;else for(;se.l<se.length;)se.write_shift(1,0);return se}function U(X,ie){var Z=X.FullPaths.map(function(he){return he.toUpperCase()}),re=Z.map(function(he){var pe=he.split("/");return pe[pe.length-(he.slice(-1)=="/"?2:1)]}),se=!1;ie.charCodeAt(0)===47?(se=!0,ie=Z[0].slice(0,-1)+ie):se=ie.indexOf("/")!==-1;var oe=ie.toUpperCase(),de=se===!0?Z.indexOf(oe):re.indexOf(oe);if(de!==-1)return X.FileIndex[de];var ye=!oe.match(wo);for(oe=oe.replace(Ar,""),ye&&(oe=oe.replace(wo,"!")),de=0;de<Z.length;++de)if((ye?Z[de].replace(wo,"!"):Z[de]).replace(Ar,"")==oe||(ye?re[de].replace(wo,"!"):re[de]).replace(Ar,"")==oe)return X.FileIndex[de];return null}var M=64,q=-2,G="d0cf11e0a1b11ae1",Q=[208,207,17,224,161,177,26,225],K="00000000000000000000000000000000",ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:K,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function J(X,ie,Z){c();var re=D(X,Z);a.writeFileSync(ie,re)}function T(X){for(var ie=new Array(X.length),Z=0;Z<X.length;++Z)ie[Z]=String.fromCharCode(X[Z]);return ie.join("")}function j(X,ie){var Z=D(X,ie);switch(ie&&ie.type||"buffer"){case"file":return c(),a.writeFileSync(ie.filename,Z),Z;case"binary":return typeof Z=="string"?Z:T(Z);case"base64":return dl(typeof Z=="string"?Z:T(Z));case"buffer":if(Qe)return Buffer.isBuffer(Z)?Z:di(Z);case"array":return typeof Z=="string"?Vr(Z):Z}return Z}var B;function E(X){try{var ie=X.InflateRaw,Z=new ie;if(Z._processChunk(new Uint8Array([3,0]),Z._finishFlushFlag),Z.bytesRead)B=X;else throw new Error("zlib does not expose bytesRead")}catch(re){console.error("cannot use native zlib: "+(re.message||re))}}function R(X,ie){if(!B)return mp(X,ie);var Z=B.InflateRaw,re=new Z,se=re._processChunk(X.slice(X.l),re._finishFlushFlag);return X.l+=re.bytesRead,se}function N(X){return B?B.deflateRawSync(X):Ue(X)}var C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],I=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function H(X){var ie=(X<<1|X<<11)&139536|(X<<5|X<<15)&558144;return(ie>>16|ie>>8|ie)&255}for(var L=typeof Uint8Array<"u",z=L?new Uint8Array(256):[],ee=0;ee<256;++ee)z[ee]=H(ee);function A(X,ie){var Z=z[X&255];return ie<=8?Z>>>8-ie:(Z=Z<<8|z[X>>8&255],ie<=16?Z>>>16-ie:(Z=Z<<8|z[X>>16&255],Z>>>24-ie))}function V(X,ie){var Z=ie&7,re=ie>>>3;return(X[re]|(Z<=6?0:X[re+1]<<8))>>>Z&3}function W(X,ie){var Z=ie&7,re=ie>>>3;return(X[re]|(Z<=5?0:X[re+1]<<8))>>>Z&7}function te(X,ie){var Z=ie&7,re=ie>>>3;return(X[re]|(Z<=4?0:X[re+1]<<8))>>>Z&15}function ae(X,ie){var Z=ie&7,re=ie>>>3;return(X[re]|(Z<=3?0:X[re+1]<<8))>>>Z&31}function Y(X,ie){var Z=ie&7,re=ie>>>3;return(X[re]|(Z<=1?0:X[re+1]<<8))>>>Z&127}function ce(X,ie,Z){var re=ie&7,se=ie>>>3,oe=(1<<Z)-1,de=X[se]>>>re;return Z<8-re||(de|=X[se+1]<<8-re,Z<16-re)||(de|=X[se+2]<<16-re,Z<24-re)||(de|=X[se+3]<<24-re),de&oe}function ue(X,ie,Z){var re=ie&7,se=ie>>>3;return re<=5?X[se]|=(Z&7)<<re:(X[se]|=Z<<re&255,X[se+1]=(Z&7)>>8-re),ie+3}function xe(X,ie,Z){var re=ie&7,se=ie>>>3;return Z=(Z&1)<<re,X[se]|=Z,ie+1}function _e(X,ie,Z){var re=ie&7,se=ie>>>3;return Z<<=re,X[se]|=Z&255,Z>>>=8,X[se+1]=Z,ie+8}function fe(X,ie,Z){var re=ie&7,se=ie>>>3;return Z<<=re,X[se]|=Z&255,Z>>>=8,X[se+1]=Z&255,X[se+2]=Z>>>8,ie+16}function ve(X,ie){var Z=X.length,re=2*Z>ie?2*Z:ie+5,se=0;if(Z>=ie)return X;if(Qe){var oe=nm(re);if(X.copy)X.copy(oe);else for(;se<X.length;++se)oe[se]=X[se];return oe}else if(L){var de=new Uint8Array(re);if(de.set)de.set(X);else for(;se<Z;++se)de[se]=X[se];return de}return X.length=re,X}function Ce(X){for(var ie=new Array(X),Z=0;Z<X;++Z)ie[Z]=0;return ie}function De(X,ie,Z){var re=1,se=0,oe=0,de=0,ye=0,he=X.length,pe=L?new Uint16Array(32):Ce(32);for(oe=0;oe<32;++oe)pe[oe]=0;for(oe=he;oe<Z;++oe)X[oe]=0;he=X.length;var ge=L?new Uint16Array(he):Ce(he);for(oe=0;oe<he;++oe)pe[se=X[oe]]++,re<se&&(re=se),ge[oe]=0;for(pe[0]=0,oe=1;oe<=re;++oe)pe[oe+16]=ye=ye+pe[oe-1]<<1;for(oe=0;oe<he;++oe)ye=X[oe],ye!=0&&(ge[oe]=pe[ye+16]++);var Se=0;for(oe=0;oe<he;++oe)if(Se=X[oe],Se!=0)for(ye=A(ge[oe],re)>>re-Se,de=(1<<re+4-Se)-1;de>=0;--de)ie[ye|de<<Se]=Se&15|oe<<4;return re}var Re=L?new Uint16Array(512):Ce(512),Me=L?new Uint16Array(32):Ce(32);if(!L){for(var Ye=0;Ye<512;++Ye)Re[Ye]=0;for(Ye=0;Ye<32;++Ye)Me[Ye]=0}(function(){for(var X=[],ie=0;ie<32;ie++)X.push(5);De(X,Me,32);var Z=[];for(ie=0;ie<=143;ie++)Z.push(8);for(;ie<=255;ie++)Z.push(9);for(;ie<=279;ie++)Z.push(7);for(;ie<=287;ie++)Z.push(8);De(Z,Re,288)})();var tt=function(){for(var ie=L?new Uint8Array(32768):[],Z=0,re=0;Z<I.length-1;++Z)for(;re<I[Z+1];++re)ie[re]=Z;for(;re<32768;++re)ie[re]=29;var se=L?new Uint8Array(259):[];for(Z=0,re=0;Z<P.length-1;++Z)for(;re<P[Z+1];++re)se[re]=Z;function oe(ye,he){for(var pe=0;pe<ye.length;){var ge=Math.min(65535,ye.length-pe),Se=pe+ge==ye.length;for(he.write_shift(1,+Se),he.write_shift(2,ge),he.write_shift(2,~ge&65535);ge-- >0;)he[he.l++]=ye[pe++]}return he.l}function de(ye,he){for(var pe=0,ge=0,Se=L?new Uint16Array(32768):[];ge<ye.length;){var Oe=Math.min(65535,ye.length-ge);if(Oe<10){for(pe=ue(he,pe,+(ge+Oe==ye.length)),pe&7&&(pe+=8-(pe&7)),he.l=pe/8|0,he.write_shift(2,Oe),he.write_shift(2,~Oe&65535);Oe-- >0;)he[he.l++]=ye[ge++];pe=he.l*8;continue}pe=ue(he,pe,+(ge+Oe==ye.length)+2);for(var je=0;Oe-- >0;){var Te=ye[ge];je=(je<<5^Te)&32767;var Fe=-1,qe=0;if((Fe=Se[je])&&(Fe|=ge&-32768,Fe>ge&&(Fe-=32768),Fe<ge))for(;ye[Fe+qe]==ye[ge+qe]&&qe<250;)++qe;if(qe>2){Te=se[qe],Te<=22?pe=_e(he,pe,z[Te+1]>>1)-1:(_e(he,pe,3),pe+=5,_e(he,pe,z[Te-23]>>5),pe+=3);var kt=Te<8?0:Te-4>>2;kt>0&&(fe(he,pe,qe-P[Te]),pe+=kt),Te=ie[ge-Fe],pe=_e(he,pe,z[Te]>>3),pe-=3;var Ct=Te<4?0:Te-2>>1;Ct>0&&(fe(he,pe,ge-Fe-I[Te]),pe+=Ct);for(var hr=0;hr<qe;++hr)Se[je]=ge&32767,je=(je<<5^ye[ge])&32767,++ge;Oe-=qe-1}else Te<=143?Te=Te+48:pe=xe(he,pe,1),pe=_e(he,pe,z[Te]),Se[je]=ge&32767,++ge}pe=_e(he,pe,0)-1}return he.l=(pe+7)/8|0,he.l}return function(he,pe){return he.length<8?oe(he,pe):de(he,pe)}}();function Ue(X){var ie=me(50+Math.floor(X.length*1.1)),Z=tt(X,ie);return ie.slice(0,Z)}var ot=L?new Uint16Array(32768):Ce(32768),pt=L?new Uint16Array(32768):Ce(32768),Ge=L?new Uint16Array(128):Ce(128),Ur=1,mi=1;function uf(X,ie){var Z=ae(X,ie)+257;ie+=5;var re=ae(X,ie)+1;ie+=5;var se=te(X,ie)+4;ie+=4;for(var oe=0,de=L?new Uint8Array(19):Ce(19),ye=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],he=1,pe=L?new Uint8Array(8):Ce(8),ge=L?new Uint8Array(8):Ce(8),Se=de.length,Oe=0;Oe<se;++Oe)de[C[Oe]]=oe=W(X,ie),he<oe&&(he=oe),pe[oe]++,ie+=3;var je=0;for(pe[0]=0,Oe=1;Oe<=he;++Oe)ge[Oe]=je=je+pe[Oe-1]<<1;for(Oe=0;Oe<Se;++Oe)(je=de[Oe])!=0&&(ye[Oe]=ge[je]++);var Te=0;for(Oe=0;Oe<Se;++Oe)if(Te=de[Oe],Te!=0){je=z[ye[Oe]]>>8-Te;for(var Fe=(1<<7-Te)-1;Fe>=0;--Fe)Ge[je|Fe<<Te]=Te&7|Oe<<3}var qe=[];for(he=1;qe.length<Z+re;)switch(je=Ge[Y(X,ie)],ie+=je&7,je>>>=3){case 16:for(oe=3+V(X,ie),ie+=2,je=qe[qe.length-1];oe-- >0;)qe.push(je);break;case 17:for(oe=3+W(X,ie),ie+=3;oe-- >0;)qe.push(0);break;case 18:for(oe=11+Y(X,ie),ie+=7;oe-- >0;)qe.push(0);break;default:qe.push(je),he<je&&(he=je);break}var kt=qe.slice(0,Z),Ct=qe.slice(Z);for(Oe=Z;Oe<286;++Oe)kt[Oe]=0;for(Oe=re;Oe<30;++Oe)Ct[Oe]=0;return Ur=De(kt,ot,286),mi=De(Ct,pt,30),ie}function v_(X,ie){if(X[0]==3&&!(X[1]&3))return[Vi(ie),2];for(var Z=0,re=0,se=nm(ie||1<<18),oe=0,de=se.length>>>0,ye=0,he=0;!(re&1);){if(re=W(X,Z),Z+=3,re>>>1)re>>1==1?(ye=9,he=5):(Z=uf(X,Z),ye=Ur,he=mi);else{Z&7&&(Z+=8-(Z&7));var pe=X[Z>>>3]|X[(Z>>>3)+1]<<8;if(Z+=32,pe>0)for(!ie&&de<oe+pe&&(se=ve(se,oe+pe),de=se.length);pe-- >0;)se[oe++]=X[Z>>>3],Z+=8;continue}for(;;){!ie&&de<oe+32767&&(se=ve(se,oe+32767),de=se.length);var ge=ce(X,Z,ye),Se=re>>>1==1?Re[ge]:ot[ge];if(Z+=Se&15,Se>>>=4,!(Se>>>8&255))se[oe++]=Se;else{if(Se==256)break;Se-=257;var Oe=Se<8?0:Se-4>>2;Oe>5&&(Oe=0);var je=oe+P[Se];Oe>0&&(je+=ce(X,Z,Oe),Z+=Oe),ge=ce(X,Z,he),Se=re>>>1==1?Me[ge]:pt[ge],Z+=Se&15,Se>>>=4;var Te=Se<4?0:Se-2>>1,Fe=I[Se];for(Te>0&&(Fe+=ce(X,Z,Te),Z+=Te),!ie&&de<je&&(se=ve(se,je+100),de=se.length);oe<je;)se[oe]=se[oe-Fe],++oe}}}return ie?[se,Z+7>>>3]:[se.slice(0,oe),Z+7>>>3]}function mp(X,ie){var Z=X.slice(X.l||0),re=v_(Z,ie);return X.l+=re[1],re[0]}function xp(X,ie){if(X)typeof console<"u"&&console.error(ie);else throw new Error(ie)}function vp(X,ie){var Z=X;or(Z,0);var re=[],se=[],oe={FileIndex:re,FullPaths:se};S(oe,{root:ie.root});for(var de=Z.length-4;(Z[de]!=80||Z[de+1]!=75||Z[de+2]!=5||Z[de+3]!=6)&&de>=0;)--de;Z.l=de+4,Z.l+=4;var ye=Z.read_shift(2);Z.l+=6;var he=Z.read_shift(4);for(Z.l=he,de=0;de<ye;++de){Z.l+=20;var pe=Z.read_shift(4),ge=Z.read_shift(4),Se=Z.read_shift(2),Oe=Z.read_shift(2),je=Z.read_shift(2);Z.l+=8;var Te=Z.read_shift(4),Fe=o(Z.slice(Z.l+Se,Z.l+Se+Oe));Z.l+=Se+Oe+je;var qe=Z.l;Z.l=Te+4,y_(Z,pe,ge,oe,Fe),Z.l=qe}return oe}function y_(X,ie,Z,re,se){X.l+=2;var oe=X.read_shift(2),de=X.read_shift(2),ye=l(X);if(oe&8257)throw new Error("Unsupported ZIP encryption");for(var he=X.read_shift(4),pe=X.read_shift(4),ge=X.read_shift(4),Se=X.read_shift(2),Oe=X.read_shift(2),je="",Te=0;Te<Se;++Te)je+=String.fromCharCode(X[X.l++]);if(Oe){var Fe=o(X.slice(X.l,X.l+Oe));(Fe[21589]||{}).mt&&(ye=Fe[21589].mt),((se||{})[21589]||{}).mt&&(ye=se[21589].mt)}X.l+=Oe;var qe=X.slice(X.l,X.l+pe);switch(de){case 8:qe=R(X,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var kt=!1;oe&8&&(he=X.read_shift(4),he==134695760&&(he=X.read_shift(4),kt=!0),pe=X.read_shift(4),ge=X.read_shift(4)),pe!=ie&&xp(kt,"Bad compressed size: "+ie+" != "+pe),ge!=Z&&xp(kt,"Bad uncompressed size: "+Z+" != "+ge),ff(re,je,qe,{unsafe:!0,mt:ye})}function w_(X,ie){var Z=ie||{},re=[],se=[],oe=me(1),de=Z.compression?8:0,ye=0,he=0,pe=0,ge=0,Se=0,Oe=X.FullPaths[0],je=Oe,Te=X.FileIndex[0],Fe=[],qe=0;for(he=1;he<X.FullPaths.length;++he)if(je=X.FullPaths[he].slice(Oe.length),Te=X.FileIndex[he],!(!Te.size||!Te.content||je=="Sh33tJ5")){var kt=ge,Ct=me(je.length);for(pe=0;pe<je.length;++pe)Ct.write_shift(1,je.charCodeAt(pe)&127);Ct=Ct.slice(0,Ct.l),Fe[Se]=GE.buf(Te.content,0);var hr=Te.content;de==8&&(hr=N(hr)),oe=me(30),oe.write_shift(4,67324752),oe.write_shift(2,20),oe.write_shift(2,ye),oe.write_shift(2,de),Te.mt?s(oe,Te.mt):oe.write_shift(4,0),oe.write_shift(-4,Fe[Se]),oe.write_shift(4,hr.length),oe.write_shift(4,Te.content.length),oe.write_shift(2,Ct.length),oe.write_shift(2,0),ge+=oe.length,re.push(oe),ge+=Ct.length,re.push(Ct),ge+=hr.length,re.push(hr),oe=me(46),oe.write_shift(4,33639248),oe.write_shift(2,0),oe.write_shift(2,20),oe.write_shift(2,ye),oe.write_shift(2,de),oe.write_shift(4,0),oe.write_shift(-4,Fe[Se]),oe.write_shift(4,hr.length),oe.write_shift(4,Te.content.length),oe.write_shift(2,Ct.length),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(4,0),oe.write_shift(4,kt),qe+=oe.l,se.push(oe),qe+=Ct.length,se.push(Ct),++Se}return oe=me(22),oe.write_shift(4,101010256),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,Se),oe.write_shift(2,Se),oe.write_shift(4,qe),oe.write_shift(4,ge),oe.write_shift(2,0),er([er(re),er(se),oe])}var Xl={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function __(X,ie){if(X.ctype)return X.ctype;var Z=X.name||"",re=Z.match(/\.([^\.]+)$/);return re&&Xl[re[1]]||ie&&(re=(Z=ie).match(/[\.\\]([^\.\\])+$/),re&&Xl[re[1]])?Xl[re[1]]:"application/octet-stream"}function b_(X){for(var ie=dl(X),Z=[],re=0;re<ie.length;re+=76)Z.push(ie.slice(re,re+76));return Z.join(`\r
`)+`\r
`}function S_(X){var ie=X.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(pe){var ge=pe.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});ie=ie.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ie.charAt(0)==`
`&&(ie="=0D"+ie.slice(1)),ie=ie.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Z=[],re=ie.split(`\r
`),se=0;se<re.length;++se){var oe=re[se];if(oe.length==0){Z.push("");continue}for(var de=0;de<oe.length;){var ye=76,he=oe.slice(de,de+ye);he.charAt(ye-1)=="="?ye--:he.charAt(ye-2)=="="?ye-=2:he.charAt(ye-3)=="="&&(ye-=3),he=oe.slice(de,de+ye),de+=ye,de<oe.length&&(he+="="),Z.push(he)}}return Z.join(`\r
`)}function k_(X){for(var ie=[],Z=0;Z<X.length;++Z){for(var re=X[Z];Z<=X.length&&re.charAt(re.length-1)=="=";)re=re.slice(0,re.length-1)+X[++Z];ie.push(re)}for(var se=0;se<ie.length;++se)ie[se]=ie[se].replace(/[=][0-9A-Fa-f]{2}/g,function(oe){return String.fromCharCode(parseInt(oe.slice(1),16))});return Vr(ie.join(`\r
`))}function C_(X,ie,Z){for(var re="",se="",oe="",de,ye=0;ye<10;++ye){var he=ie[ye];if(!he||he.match(/^\s*$/))break;var pe=he.match(/^(.*?):\s*([^\s].*)$/);if(pe)switch(pe[1].toLowerCase()){case"content-location":re=pe[2].trim();break;case"content-type":oe=pe[2].trim();break;case"content-transfer-encoding":se=pe[2].trim();break}}switch(++ye,se.toLowerCase()){case"base64":de=Vr(Jr(ie.slice(ye).join("")));break;case"quoted-printable":de=k_(ie.slice(ye));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+se)}var ge=ff(X,re.slice(Z.length),de,{unsafe:!0});oe&&(ge.ctype=oe)}function T_(X,ie){if(T(X.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Z=ie&&ie.root||"",re=(Qe&&Buffer.isBuffer(X)?X.toString("binary"):T(X)).split(`\r
`),se=0,oe="";for(se=0;se<re.length;++se)if(oe=re[se],!!/^Content-Location:/i.test(oe)&&(oe=oe.slice(oe.indexOf("file")),Z||(Z=oe.slice(0,oe.lastIndexOf("/")+1)),oe.slice(0,Z.length)!=Z))for(;Z.length>0&&(Z=Z.slice(0,Z.length-1),Z=Z.slice(0,Z.lastIndexOf("/")+1),oe.slice(0,Z.length)!=Z););var de=(re[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var ye="--"+(de[1]||""),he=[],pe=[],ge={FileIndex:he,FullPaths:pe};S(ge);var Se,Oe=0;for(se=0;se<re.length;++se){var je=re[se];je!==ye&&je!==ye+"--"||(Oe++&&C_(ge,re.slice(Se,se),Z),Se=se)}return ge}function E_(X,ie){var Z=ie||{},re=Z.boundary||"SheetJS";re="------="+re;for(var se=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+re.slice(2)+'"',"","",""],oe=X.FullPaths[0],de=oe,ye=X.FileIndex[0],he=1;he<X.FullPaths.length;++he)if(de=X.FullPaths[he].slice(oe.length),ye=X.FileIndex[he],!(!ye.size||!ye.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(qe){return"_x"+qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(qe){return"_u"+qe.charCodeAt(0).toString(16)+"_"});for(var pe=ye.content,ge=Qe&&Buffer.isBuffer(pe)?pe.toString("binary"):T(pe),Se=0,Oe=Math.min(1024,ge.length),je=0,Te=0;Te<=Oe;++Te)(je=ge.charCodeAt(Te))>=32&&je<128&&++Se;var Fe=Se>=Oe*4/5;se.push(re),se.push("Content-Location: "+(Z.root||"file:///C:/SheetJS/")+de),se.push("Content-Transfer-Encoding: "+(Fe?"quoted-printable":"base64")),se.push("Content-Type: "+__(ye,de)),se.push(""),se.push(Fe?S_(ge):b_(ge))}return se.push(re+`--\r
`),se.join(`\r
`)}function N_(X){var ie={};return S(ie,X),ie}function ff(X,ie,Z,re){var se=re&&re.unsafe;se||S(X);var oe=!se&&Le.find(X,ie);if(!oe){var de=X.FullPaths[0];ie.slice(0,de.length)==de?de=ie:(de.slice(-1)!="/"&&(de+="/"),de=(de+ie).replace("//","/")),oe={name:i(ie),type:2},X.FileIndex.push(oe),X.FullPaths.push(de),se||Le.utils.cfb_gc(X)}return oe.content=Z,oe.size=Z?Z.length:0,re&&(re.CLSID&&(oe.clsid=re.CLSID),re.mt&&(oe.mt=re.mt),re.ct&&(oe.ct=re.ct)),oe}function A_(X,ie){S(X);var Z=Le.find(X,ie);if(Z){for(var re=0;re<X.FileIndex.length;++re)if(X.FileIndex[re]==Z)return X.FileIndex.splice(re,1),X.FullPaths.splice(re,1),!0}return!1}function O_(X,ie,Z){S(X);var re=Le.find(X,ie);if(re){for(var se=0;se<X.FileIndex.length;++se)if(X.FileIndex[se]==re)return X.FileIndex[se].name=i(Z),X.FullPaths[se]=Z,!0}return!1}function F_(X){F(X,!0)}return t.find=U,t.read=k,t.parse=d,t.write=j,t.writeFile=J,t.utils={cfb_new:N_,cfb_add:ff,cfb_del:A_,cfb_mov:O_,cfb_gc:F_,ReadShift:Po,CheckField:Ay,prep_blob:or,bconcat:er,use_zlib:E,_deflateRaw:Ue,_inflateRaw:mp,consts:ne},t}();function qE(e){return typeof e=="string"?Qu(e):Array.isArray(e)?_E(e):e}function Il(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Qu(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Un(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([qE(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Qi(t)),o.write(t),o.close(),t}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("cannot save file "+e)}function KE(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function It(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function fm(e,t){for(var r=[],n=It(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function ef(e){for(var t=[],r=It(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function tf(e){for(var t=[],r=It(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function JE(e){for(var t=[],r=It(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var bu=new Date(1899,11,30,0,0,0);function Jt(e,t){var r=e.getTime(),n=bu.getTime()+(e.getTimezoneOffset()-bu.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var ly=new Date,QE=bu.getTime()+(ly.getTimezoneOffset()-bu.getTimezoneOffset())*6e4,hm=ly.getTimezoneOffset();function rf(e){var t=new Date;return t.setTime(e*24*60*60*1e3+QE),t.getTimezoneOffset()!==hm&&t.setTime(t.getTime()+(t.getTimezoneOffset()-hm)*6e4),t}function ZE(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var dm=new Date("2017-02-19T19:06:09.000Z"),cy=isNaN(dm.getFullYear())?new Date("2/19/17"):dm,e4=cy.getFullYear()==2017;function wt(e,t){var r=new Date(e);if(e4)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(cy.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Fs(e,t){if(Qe&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Un(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Un(Kv(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Un(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Un(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function _t(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=_t(e[r]));return t}function Dt(e,t){for(var r="";r.length<t;)r+=e;return r}function Nn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var t4=["january","february","march","april","may","june","july","august","september","october","november","december"];function Wa(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&t4.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var r4=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),l=[s[0]],o=1;o<s.length;++o)l.push(i),l.push(s[o]);return l}}();function uy(e){return e?e.content&&e.type?Fs(e.content,!0):e.data?yo(e.data):e.asNodeBuffer&&Qe?yo(e.asNodeBuffer().toString("binary")):e.asBinary?yo(e.asBinary()):e._data&&e._data.getContent?yo(Fs(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function fy(e){if(!e)return null;if(e.data)return tm(e.data);if(e.asNodeBuffer&&Qe)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?tm(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function n4(e){return e&&e.name.slice(-4)===".bin"?fy(e):uy(e)}function sn(e,t){for(var r=e.FullPaths||It(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var l=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||i==l)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function D0(e,t){var r=sn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function zt(e,t,r){if(!r)return n4(D0(e,t));if(!t)return null;try{return zt(e,t)}catch{return null}}function Xr(e,t,r){if(!r)return uy(D0(e,t));if(!t)return null;try{return Xr(e,t)}catch{return null}}function i4(e,t,r){return fy(D0(e,t))}function pm(e){for(var t=e.FullPaths||It(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Je(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Qe?n=di(r):n=bE(r),Le.utils.cfb_add(e,t,n)}Le.utils.cfb_add(e,t,r)}else e.file(t,r)}function R0(){return Le.utils.cfb_new()}function hy(e,t){switch(t.type){case"base64":return Le.read(e,{type:"base64"});case"binary":return Le.read(e,{type:"binary"});case"buffer":case"array":return Le.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function _o(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Ut=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,s4=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,gm=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,a4=/<[^>]*>/g,kr=Ut.match(gm)?gm:a4,o4=/<\w*:/,l4=/<(\/?)\w+:/;function Xe(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var l=e.match(s4),o=0,a="",c=0,d="",f="",h=1;if(l)for(c=0;c!=l.length;++c){for(f=l[c],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(d=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(h=(i=f.charCodeAt(s+1))==34||i==39?1:0,a=f.slice(s+1+h,f.length-h),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=a,n[d.toLowerCase()]=a;else{var u=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[u]&&d.slice(o-3,o)=="ext")continue;n[u]=a,n[u.toLowerCase()]=a}}return n}function Hn(e){return e.replace(l4,"<$1")}var dy={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},I0=ef(dy),it=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(o,a){return dy[o]||String.fromCharCode(parseInt(a,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,a){return String.fromCharCode(parseInt(a,16))});var l=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,l)+r(i.slice(l+3))}}(),M0=/[&<>'"]/g,c4=/[\u0000-\u0008\u000b-\u001f]/g;function ft(e){var t=e+"";return t.replace(M0,function(r){return I0[r]}).replace(c4,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function mm(e){return ft(e).replace(/ /g,"_x0020_")}var py=/[\u0000-\u001f]/g;function L0(e){var t=e+"";return t.replace(M0,function(r){return I0[r]}).replace(/\n/g,"<br/>").replace(py,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function u4(e){var t=e+"";return t.replace(M0,function(r){return I0[r]}).replace(py,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var xm=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function f4(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function vt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Kf(e){for(var t="",r=0,n=0,i=0,s=0,l=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=i&63,t+=String.fromCharCode(l);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}l=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function vm(e){var t=Vi(2*e.length),r,n,i=1,s=0,l=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[s++]=l&255,t[s++]=l>>>8,l=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function ym(e){return di(e,"binary").toString("utf8")}var xc="foo bar baz",dt=Qe&&(ym(xc)==Kf(xc)&&ym||vm(xc)==Kf(xc)&&vm)||Kf,Un=Qe?function(e){return di(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},gl=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),gy=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),h4=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),d4=/<\/?(?:vt:)?variant>/g,p4=/<(?:vt:)([^>]*)>([\s\S]*)</;function wm(e,t){var r=Xe(e),n=e.match(h4(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var l=s.replace(d4,"").match(p4);l&&i.push({v:dt(l[2]),t:l[1]})}),i}var my=/(^\s|\s$|\n)/;function lr(e,t){return"<"+e+(t.match(my)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function ml(e){return It(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ne(e,t,r){return"<"+e+(r!=null?ml(r):"")+(t!=null?(t.match(my)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function md(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function g4(e,t){switch(typeof e){case"string":var r=Ne("vt:lpwstr",ft(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ne((e|0)==e?"vt:i4":"vt:r8",ft(String(e)));case"boolean":return Ne("vt:bool",e?"true":"false")}if(e instanceof Date)return Ne("vt:filetime",md(e));throw new Error("Unable to serialize "+e)}function B0(e){if(Qe&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return dt(Qi(F0(e)));throw new Error("Bad input format: expected Buffer or string")}var xl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,qt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ls=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Hr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function m4(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function x4(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,l=n?-t:t;isFinite(l)?l==0?i=s=0:(i=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var _m=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},bm=Qe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:di(t)})):_m(e)}:_m,Sm=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Jn(e,i)));return n.join("").replace(Ar,"")},U0=Qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ar,""):Sm(e,t,r)}:Sm,km=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},xy=Qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):km(e,t,r)}:km,Cm=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(sa(e,i)));return n.join("")},Ml=Qe?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Cm(t,r,n)}:Cm,vy=function(e,t){var r=$r(e,t);return r>0?Ml(e,t+4,t+4+r-1):""},yy=vy,wy=function(e,t){var r=$r(e,t);return r>0?Ml(e,t+4,t+4+r-1):""},_y=wy,by=function(e,t){var r=2*$r(e,t);return r>0?Ml(e,t+4,t+4+r-1):""},Sy=by,ky=function(t,r){var n=$r(t,r);return n>0?U0(t,r+4,r+4+n):""},Cy=ky,Ty=function(e,t){var r=$r(e,t);return r>0?Ml(e,t+4,t+4+r):""},Ey=Ty,Ny=function(e,t){return m4(e,t)},Su=Ny,W0=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Qe&&(yy=function(t,r){if(!Buffer.isBuffer(t))return vy(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},_y=function(t,r){if(!Buffer.isBuffer(t))return wy(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Sy=function(t,r){if(!Buffer.isBuffer(t))return by(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Cy=function(t,r){if(!Buffer.isBuffer(t))return ky(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Ey=function(t,r){if(!Buffer.isBuffer(t))return Ty(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Su=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Ny(t,r)},W0=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var sa=function(e,t){return e[t]},Jn=function(e,t){return e[t+1]*256+e[t]},v4=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},$r=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},us=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},y4=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Po(e,t){var r="",n,i,s=[],l,o,a,c;switch(t){case"dbcs":if(c=this.l,Qe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(a=0;a<e;++a)r+=String.fromCharCode(Jn(this,c)),c+=2;e*=2;break;case"utf8":r=Ml(this,this.l,this.l+e);break;case"utf16le":e*=2,r=U0(this,this.l,this.l+e);break;case"wstr":return Po.call(this,e,"dbcs");case"lpstr-ansi":r=yy(this,this.l),e=4+$r(this,this.l);break;case"lpstr-cp":r=_y(this,this.l),e=4+$r(this,this.l);break;case"lpwstr":r=Sy(this,this.l),e=4+2*$r(this,this.l);break;case"lpp4":e=4+$r(this,this.l),r=Cy(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+$r(this,this.l),r=Ey(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=sa(this,this.l+e++))!==0;)s.push(mc(l));r=s.join("");break;case"_wstr":for(e=0,r="";(l=Jn(this,this.l+e))!==0;)s.push(mc(l)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,a=0;a<e;++a){if(this.lens&&this.lens.indexOf(c)!==-1)return l=sa(this,c),this.l=c+1,o=Po.call(this,e-a,l?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(mc(Jn(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,a=0;a!=e;++a){if(this.lens&&this.lens.indexOf(c)!==-1)return l=sa(this,c),this.l=c+1,o=Po.call(this,e-a,l?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(mc(sa(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=sa(this,this.l),this.l++,n;case 2:return n=(t==="i"?v4:Jn)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?us:y4)(this,this.l),this.l+=4,n):(i=$r(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Su(this,this.l):i=Su([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=xy(this,this.l,e);break}}return this.l+=e,r}var w4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},_4=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},b4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function S4(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)b4(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var l=t.charCodeAt(i);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,w4(this,t,this.l);break;case 8:if(n=8,r==="f"){x4(this,t,this.l);break}case 16:break;case-4:n=4,_4(this,t,this.l);break}return this.l+=n,this}function Ay(e,t){var r=xy(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function or(e,t){e.l=t,e.read_shift=Po,e.chk=Ay,e.write_shift=S4}function Sr(e,t){e.l+=t}function me(e){var t=Vi(e);return or(t,0),t}function pi(e,t,r){if(e){var n,i,s;or(e,e.l||0);for(var l=e.length,o=0,a=0;e.l<l;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=Sl[o]||Sl[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;a=e.l+s;var d=c.f&&c.f(e,s,r);if(e.l=a,t(d,c,o))return}}}function Lr(){var e=[],t=Qe?256:2048,r=function(c){var d=me(c);return or(d,0),d},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},l=function(){return i(),er(e)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:l,_bufs:e}}function be(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=Sl[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var l=e.next(s);i<=127?l.write_shift(1,i):(l.write_shift(1,(i&127)+128),l.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&W0(r)&&e.push(r)}}function Do(e,t,r){var n=_t(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Tm(e,t,r){var n=_t(e);return n.s=Do(n.s,t.s,r),n.e=Do(n.e,t.s,r),n}function Ro(e,t){if(e.cRel&&e.c<0)for(e=_t(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=_t(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ve(e);return!e.cRel&&e.cRel!=null&&(r=T4(r)),!e.rRel&&e.rRel!=null&&(r=k4(r)),r}function Jf(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Nt(e.s.c)+":"+(e.e.cRel?"":"$")+Nt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Bt(e.s.r)+":"+(e.e.rRel?"":"$")+Bt(e.e.r):Ro(e.s,t.biff)+":"+Ro(e.e,t.biff)}function z0(e){return parseInt(C4(e),10)-1}function Bt(e){return""+(e+1)}function k4(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function C4(e){return e.replace(/\$(\d+)$/,"$1")}function H0(e){for(var t=E4(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Nt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function T4(e){return e.replace(/^([A-Z])/,"$$$1")}function E4(e){return e.replace(/^\$([A-Z])/,"$1")}function N4(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function At(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Ve(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Br(e){var t=e.indexOf(":");return t==-1?{s:At(e),e:At(e)}:{s:At(e.slice(0,t)),e:At(e.slice(t+1))}}function Ke(e,t){return typeof t>"u"||typeof t=="number"?Ke(e.s,e.e):(typeof e!="string"&&(e=Ve(e)),typeof t!="string"&&(t=Ve(t)),e==t?e:e+":"+t)}function st(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function Em(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=pn(e.z,r?Jt(t):t)}catch{}try{return e.w=pn((e.XF||{}).numFmtId||(r?14:0),r?Jt(t):t)}catch{return""+t}}function ui(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?gi[e.v]||e.v:t==null?Em(e,e.v):Em(e,t))}function Zi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Oy(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),l=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var a=typeof n.origin=="string"?At(n.origin):n.origin;l=a.r,o=a.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=st(s["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),l==-1&&(c.e.r=l=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var u={v:t[f][h]},p=l+f,m=o+h;if(c.s.r>p&&(c.s.r=p),c.s.c>m&&(c.s.c=m),c.e.r<p&&(c.e.r=p),c.e.c<m&&(c.e.c=m),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))u=t[f][h];else if(Array.isArray(u.v)&&(u.f=t[f][h][1],u.v=u.v[0]),u.v===null)if(u.f)u.t="n";else if(n.nullError)u.t="e",u.v=0;else if(n.sheetStubs)u.t="z";else continue;else typeof u.v=="number"?u.t="n":typeof u.v=="boolean"?u.t="b":u.v instanceof Date?(u.z=n.dateNF||ze[14],n.cellDates?(u.t="d",u.w=pn(u.z,Jt(u.v))):(u.t="n",u.v=Jt(u.v),u.w=pn(u.z,u.v))):u.t="s";if(i)s[p]||(s[p]=[]),s[p][m]&&s[p][m].z&&(u.z=s[p][m].z),s[p][m]=u;else{var g=Ve({c:m,r:p});s[g]&&s[g].z&&(u.z=s[g].z),s[g]=u}}}return c.s.c<1e7&&(s["!ref"]=Ke(c)),s}function Ja(e,t){return Oy(null,e,t)}function A4(e){return e.read_shift(4,"i")}function An(e,t){return t||(t=me(4)),t.write_shift(4,e),t}function _r(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function tr(e,t){var r=!1;return t==null&&(r=!0,t=me(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function O4(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function F4(e,t){return t||(t=me(4)),t.write_shift(2,0),t.write_shift(2,0),t}function $0(e,t){var r=e.l,n=e.read_shift(1),i=_r(e),s=[],l={t:i,h:i};if(n&1){for(var o=e.read_shift(4),a=0;a!=o;++a)s.push(O4(e));l.r=s}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function j4(e,t){var r=!1;return t==null&&(r=!0,t=me(15+4*e.t.length)),t.write_shift(1,0),tr(e.t,t),r?t.slice(0,t.l):t}var P4=$0;function D4(e,t){var r=!1;return t==null&&(r=!0,t=me(23+4*e.t.length)),t.write_shift(1,1),tr(e.t,t),t.write_shift(4,1),F4({},t),r?t.slice(0,t.l):t}function gn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Bs(e,t){return t==null&&(t=me(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Us(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ws(e,t){return t==null&&(t=me(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var R4=_r,Fy=tr;function V0(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function ku(e,t){var r=!1;return t==null&&(r=!0,t=me(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var I4=_r,xd=V0,X0=ku;function Y0(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?Su([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):us(t,0)>>2;return r?i/100:i}function jy(e,t){t==null&&(t=me(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Py(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function M4(e,t){return t||(t=me(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var zs=Py,Qa=M4;function wr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function js(e,t){return(t||me(8)).write_shift(8,e,"f")}function L4(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),a=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=ws[i];c&&(t.rgb=yl(c));break;case 2:t.rgb=yl([l,o,a]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Cu(e,t){if(t||(t=me(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function B4(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function U4(e,t){t||(t=me(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function Dy(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function W4(e){return Dy(e,1)}function z4(e){return Dy(e,2)}var G0=2,jr=3,vc=11,Nm=12,Tu=19,yc=64,H4=65,$4=71,V4=4108,X4=4126,Qt=80,Ry=81,Y4=[Qt,Ry],vd={1:{n:"CodePage",t:G0},2:{n:"Category",t:Qt},3:{n:"PresentationFormat",t:Qt},4:{n:"ByteCount",t:jr},5:{n:"LineCount",t:jr},6:{n:"ParagraphCount",t:jr},7:{n:"SlideCount",t:jr},8:{n:"NoteCount",t:jr},9:{n:"HiddenCount",t:jr},10:{n:"MultimediaClipCount",t:jr},11:{n:"ScaleCrop",t:vc},12:{n:"HeadingPairs",t:V4},13:{n:"TitlesOfParts",t:X4},14:{n:"Manager",t:Qt},15:{n:"Company",t:Qt},16:{n:"LinksUpToDate",t:vc},17:{n:"CharacterCount",t:jr},19:{n:"SharedDoc",t:vc},22:{n:"HyperlinksChanged",t:vc},23:{n:"AppVersion",t:jr,p:"version"},24:{n:"DigSig",t:H4},26:{n:"ContentType",t:Qt},27:{n:"ContentStatus",t:Qt},28:{n:"Language",t:Qt},29:{n:"Version",t:Qt},255:{},2147483648:{n:"Locale",t:Tu},2147483651:{n:"Behavior",t:Tu},1919054434:{}},yd={1:{n:"CodePage",t:G0},2:{n:"Title",t:Qt},3:{n:"Subject",t:Qt},4:{n:"Author",t:Qt},5:{n:"Keywords",t:Qt},6:{n:"Comments",t:Qt},7:{n:"Template",t:Qt},8:{n:"LastAuthor",t:Qt},9:{n:"RevNumber",t:Qt},10:{n:"EditTime",t:yc},11:{n:"LastPrinted",t:yc},12:{n:"CreatedDate",t:yc},13:{n:"ModifiedDate",t:yc},14:{n:"PageCount",t:jr},15:{n:"WordCount",t:jr},16:{n:"CharCount",t:jr},17:{n:"Thumbnail",t:$4},18:{n:"Application",t:Qt},19:{n:"DocSecurity",t:jr},255:{},2147483648:{n:"Locale",t:Tu},2147483651:{n:"Behavior",t:Tu},1919054434:{}},Am={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},G4=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function q4(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var K4=q4([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ws=_t(K4),gi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Iy={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},wd={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},wc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function q0(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function J4(e){var t=q0();if(!e||!e.match)return t;var r={};if((e.match(kr)||[]).forEach(function(n){var i=Xe(n);switch(i[0].replace(o4,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[wd[i.ContentType]]!==void 0&&t[wd[i.ContentType]].push(i.PartName);break}}),t.xmlns!==qt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function My(e,t){var r=JE(wd),n=[],i;n[n.length]=Ut,n[n.length]=Ne("Types",null,{xmlns:qt.CT,"xmlns:xsd":qt.xsd,"xmlns:xsi":qt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(a){return Ne("Default",null,{Extension:a[0],ContentType:a[1]})}));var s=function(a){e[a]&&e[a].length>0&&(i=e[a][0],n[n.length]=Ne("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:wc[a][t.bookType]||wc[a].xlsx}))},l=function(a){(e[a]||[]).forEach(function(c){n[n.length]=Ne("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:wc[a][t.bookType]||wc[a].xlsx})})},o=function(a){(e[a]||[]).forEach(function(c){n[n.length]=Ne("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[a][0]})})};return s("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ze={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function vl(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Io(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(kr)||[]).forEach(function(i){var s=Xe(i);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:_o(s.Target,t);r[o]=l,n[s.Id]=l}}),r["!id"]=n,r}function Aa(e){var t=[Ut,Ne("Relationships",null,{xmlns:qt.RELS})];return It(e["!id"]).forEach(function(r){t[t.length]=Ne("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ut(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[Ze.HLINK,Ze.XPATH,Ze.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var Q4="application/vnd.oasis.opendocument.spreadsheet";function Z4(e,t){for(var r=B0(e),n,i;n=xl.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Xe(n[0],!1),i.path=="/"&&i.type!==Q4)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function eN(e){var t=[Ut];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Om(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function tN(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function rN(e){var t=[Ut];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Om(e[r][0],e[r][1])),t.push(tN("",e[r][0]));return t.push(Om("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Ly(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+vu.version+"</meta:generator></office:meta></office:document-meta>"}var fn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],nN=function(){for(var e=new Array(fn.length),t=0;t<fn.length;++t){var r=fn[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function By(e){var t={};e=dt(e);for(var r=0;r<fn.length;++r){var n=fn[r],i=e.match(nN[r]);i!=null&&i.length>0&&(t[n[1]]=it(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=wt(t[n[1]]))}return t}function Qf(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=ft(t),n[n.length]=r?Ne(e,t,r):lr(e,t))}function Uy(e,t){var r=t||{},n=[Ut,Ne("cp:coreProperties",null,{"xmlns:cp":qt.CORE_PROPS,"xmlns:dc":qt.dc,"xmlns:dcterms":qt.dcterms,"xmlns:dcmitype":qt.dcmitype,"xmlns:xsi":qt.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Qf("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:md(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&Qf("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:md(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=fn.length;++s){var l=fn[s],o=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Qf(l[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var _s=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Wy=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function zy(e,t,r,n){var i=[];if(typeof e=="string")i=wm(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(d){return{v:d}}));var l=typeof t=="string"?wm(t,n).map(function(d){return d.v}):t,o=0,a=0;if(l.length>0)for(var c=0;c!==i.length;c+=2){switch(a=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=a,r.SheetNames=l.slice(o,o+a);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=a,r.DefinedNames=l.slice(o,o+a);break;case"Charts":case"Diagramme":r.Chartsheets=a,r.ChartNames=l.slice(o,o+a);break}o+=a}}function iN(e,t,r){var n={};return t||(t={}),e=dt(e),_s.forEach(function(i){var s=(e.match(gl(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=it(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var l=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));l&&l.length>0&&(n[i[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&zy(n.HeadingPairs,n.TitlesOfParts,t,r),t}function Hy(e){var t=[],r=Ne;return e||(e={}),e.Application="SheetJS",t[t.length]=Ut,t[t.length]=Ne("Properties",null,{xmlns:qt.EXT_PROPS,"xmlns:vt":qt.vt}),_s.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=ft(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+ft(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var sN=/<[^>]+>[^<]*/g;function aN(e,t){var r={},n="",i=e.match(sN);if(i)for(var s=0;s!=i.length;++s){var l=i[s],o=Xe(l);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=it(o.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var a=l.split(">"),c=a[0].slice(4),d=a[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=it(d);break;case"bool":r[n]=vt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=wt(d);break;case"cy":case"error":r[n]=it(d);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,c,a)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function $y(e){var t=[Ut,Ne("Properties",null,{xmlns:qt.CUST_PROPS,"xmlns:vt":qt.vt})];if(!e)return t.join("");var r=1;return It(e).forEach(function(i){++r,t[t.length]=Ne("property",g4(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ft(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var _d={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Zf;function oN(e,t,r){Zf||(Zf=ef(_d)),t=Zf[t]||t,e[t]=r}function lN(e,t){var r=[];return It(_d).map(function(n){for(var i=0;i<fn.length;++i)if(fn[i][1]==n)return fn[i];for(i=0;i<_s.length;++i)if(_s[i][1]==n)return _s[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(lr(_d[n[1]]||n[1],i))}}),Ne("DocumentProperties",r.join(""),{xmlns:Hr.o})}function cN(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&It(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var l=0;l<fn.length;++l)if(s==fn[l][1])return;for(l=0;l<_s.length;++l)if(s==_s[l][1])return;for(l=0;l<r.length;++l)if(s==r[l])return;var o=e[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o=String(o),i.push(Ne(mm(s),o,{"dt:dt":a}))}}),t&&It(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var l=t[s],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),i.push(Ne(mm(s),l,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Hr.o+'">'+i.join("")+"</"+n+">"}function K0(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function uN(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var l=me(8);return l.write_shift(4,n),l.write_shift(4,i),l}function Vy(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function Xy(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Yy(e,t,r){return t===31?Xy(e):Vy(e,t,r)}function bd(e,t,r){return Yy(e,t,r===!1?0:4)}function fN(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Yy(e,t,0)}function hN(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Ar,""),e.l-i&2&&(e.l+=2)}return r}function dN(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Ar,"");return r}function pN(e){var t=e.l,r=Eu(e,Ry);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Eu(e,jr);return[r,n]}function gN(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(pN(e));return r}function Fm(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),l=e.read_shift(4);n[s]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(Ar,"").replace(wo,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Gy(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function mN(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Eu(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==Nm&&n!==t&&Y4.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Nm?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return Vy(e,n,4).replace(Ar,"");case 31:return Xy(e);case 64:return K0(e);case 65:return Gy(e);case 71:return mN(e);case 80:return bd(e,n,!s.raw).replace(Ar,"");case 81:return fN(e,n).replace(Ar,"");case 4108:return gN(e);case 4126:case 4127:return n==4127?hN(e):dN(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function jm(e,t){var r=me(4),n=me(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=me(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=uN(t);break;case 31:case 80:for(n=me(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return er([r,n])}function Pm(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],l=0,o=0,a=-1,c={};for(l=0;l!=i;++l){var d=e.read_shift(4),f=e.read_shift(4);s[l]=[d,f+r]}s.sort(function(v,w){return v[1]-w[1]});var h={};for(l=0;l!=i;++l){if(e.l!==s[l][1]){var u=!0;if(l>0&&t)switch(t[s[l-1][0]].t){case 2:e.l+2===s[l][1]&&(e.l+=2,u=!1);break;case 80:e.l<=s[l][1]&&(e.l=s[l][1],u=!1);break;case 4108:e.l<=s[l][1]&&(e.l=s[l][1],u=!1);break}if((!t||l==0)&&e.l<=s[l][1]&&(u=!1,e.l=s[l][1]),u)throw new Error("Read Error: Expected address "+s[l][1]+" at "+e.l+" :"+l)}if(t){var p=t[s[l][0]];if(h[p.n]=Eu(e,p.t,{raw:!0}),p.p==="version"&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(h[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Sn(o=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(s[l][0]===1){if(o=h.CodePage=Eu(e,G0),Sn(o),a!==-1){var m=e.l;e.l=s[a][1],c=Fm(e,o),e.l=m}}else if(s[l][0]===0){if(o===0){a=l,e.l=s[l+1][1];continue}c=Fm(e,o)}else{var g=c[s[l][0]],x;switch(e[e.l]){case 65:e.l+=4,x=Gy(e);break;case 30:e.l+=4,x=bd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,x=bd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,x=e.read_shift(4,"i");break;case 19:e.l+=4,x=e.read_shift(4);break;case 5:e.l+=4,x=e.read_shift(8,"f");break;case 11:e.l+=4,x=Mt(e,4);break;case 64:e.l+=4,x=wt(K0(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=x}}return e.l=r+n,h}var qy=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function xN(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Dm(e,t,r){var n=me(8),i=[],s=[],l=8,o=0,a=me(8),c=me(8);if(a.write_shift(4,2),a.write_shift(4,1200),c.write_shift(4,1),s.push(a),i.push(c),l+=8+a.length,!t){c=me(8),c.write_shift(4,0),i.unshift(c);var d=[me(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(a=me(8+2*(f.length+1)+(f.length%2?0:2)),a.write_shift(4,o+2),a.write_shift(4,f.length+1),a.write_shift(0,f,"dbcs");a.l!=a.length;)a.write_shift(1,0);d.push(a)}a=er(d),s.unshift(a),l+=8+a.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(qy.indexOf(e[o][0])>-1||Wy.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],u=0;if(t){u=+t[e[o][0]];var p=r[u];if(p.p=="version"&&typeof h=="string"){var m=h.split(".");h=(+m[0]<<16)+(+m[1]||0)}a=jm(p.t,h)}else{var g=xN(h);g==-1&&(g=31,h=String(h)),a=jm(g,h)}s.push(a),c=me(8),c.write_shift(4,t?u:2+o),i.push(c),l+=8+a.length}var x=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,x),x+=s[o].length;return n.write_shift(4,l),n.write_shift(4,s.length),er([n].concat(i).concat(s))}function Rm(e,t,r){var n=e.content;if(!n)return{};or(n,0);var i,s,l,o,a=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),d=n.read_shift(16);if(d!==Le.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(l=n.read_shift(16),a=n.read_shift(4));var f=Pm(n,t),h={SystemIdentifier:c};for(var u in f)h[u]=f[u];if(h.FMTID=s,i===1)return h;if(a-n.l==2&&(n.l+=2),n.l!==a)throw new Error("Length mismatch 2: "+n.l+" !== "+a);var p;try{p=Pm(n,null)}catch{}for(u in p)h[u]=p[u];return h.FMTID=[s,l],h}function Im(e,t,r,n,i,s){var l=me(i?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Le.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,i?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,i?68:48);var a=Dm(e,r,n);if(o.push(a),i){var c=Dm(i,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+a.length),o.push(c)}return er(o)}function vi(e,t){return e.read_shift(t),null}function vN(e,t){t||(t=me(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function yN(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Mt(e,t){return e.read_shift(t)===1}function Er(e,t){return t||(t=me(2)),t.write_shift(2,+!!e),t}function Ht(e){return e.read_shift(2,"u")}function an(e,t){return t||(t=me(2)),t.write_shift(2,e),t}function Ky(e,t){return yN(e,t,Ht)}function wN(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Jy(e,t,r){return r||(r=me(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Ll(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var l=n?e.read_shift(n,i):"";return l}function _N(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),l=0,o,a={};i&&(l=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,c);return i&&(e.l+=4*l),n&&(e.l+=o),a.t=d,i||(a.raw="<t>"+a.t+"</t>",a.r=a.t),a}function bN(e){var t=e.t||"",r=me(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=me(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return er(i)}function Ps(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Bl(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Ps(e,n,r)}function Hs(e,t,r){if(r.biff>5)return Bl(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Qy(e,t,r){return r||(r=me(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function SN(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function kN(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Ar,"");return n&&(e.l+=24),i}function CN(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(s>>1,"utf16le").replace(Ar,"");return r+l}function TN(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return kN(e);case"0303000000000000c000000000000046":return CN(e);default:throw new Error("Unsupported Moniker "+r)}}function _c(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Ar,""):"";return r}function Mm(e,t){t||(t=me(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function EN(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,l,o,a,c="",d,f;i&16&&(s=_c(e,r-e.l)),i&128&&(l=_c(e,r-e.l)),(i&257)===257&&(o=_c(e,r-e.l)),(i&257)===1&&(a=TN(e,r-e.l)),i&8&&(c=_c(e,r-e.l)),i&32&&(d=e.read_shift(16)),i&64&&(f=K0(e)),e.l=r;var h=l||o||a||"";h&&c&&(h+="#"+c),h||(h="#"+c),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var u={Target:h};return d&&(u.guid=d),f&&(u.time=f),s&&(u.Tooltip=s),u}function NN(e){var t=me(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(s==28)n=n.slice(1),Mm(n,t);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&Mm(i>-1?n.slice(i+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var a=0;n.slice(a*3,a*3+3)=="../"||n.slice(a*3,a*3+3)=="..\\";)++a;for(t.write_shift(2,a),t.write_shift(4,n.length-3*a+1),r=0;r<n.length-3*a;++r)t.write_shift(1,n.charCodeAt(r+3*a)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Zy(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function ew(e,t){var r=Zy(e);return r[3]=0,r}function $n(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Ds(e,t,r,n){return n||(n=me(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function AN(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function ON(e,t,r){return t===0?"":Hs(e,t,r)}function FN(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[i,s,l]}function tw(e){var t=e.read_shift(2),r=Y0(e);return[t,r]}function jN(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=Ll(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function nf(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function rw(e,t){return t||(t=me(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function nw(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var PN=nw;function iw(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function DN(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function RN(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function gr(e){e.l+=2,e.l+=e.read_shift(2)}var IN={0:gr,4:gr,5:gr,6:gr,7:RN,8:gr,9:gr,10:gr,11:gr,12:gr,13:DN,14:gr,15:gr,16:gr,17:gr,18:gr,19:gr,20:gr,21:iw};function MN(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(IN[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function bc(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function J0(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=me(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function LN(e,t){return t===0||e.read_shift(2),1200}function BN(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=Hs(e,0,r);return e.read_shift(t+n-e.l),i}function UN(e,t){var r=!t||t.biff==8,n=me(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function WN(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function zN(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=Ll(e,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:i,dt:s,name:l}}function HN(e,t){var r=!t||t.biff>=8?2:1,n=me(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function $N(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],l=0;l!=i&&e.l<r;++l)s.push(_N(e));return s.Count=n,s.Unique=i,s}function VN(e,t){var r=me(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=bN(e[i]);var s=er([r].concat(n));return s.parts=[r.length].concat(n.map(function(l){return l.length})),s}function XN(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function YN(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function GN(e){var t=AN(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function qN(e){return e.read_shift(2),e.read_shift(4)}function Lm(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function KN(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),a=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:l,FirstTab:o,Selected:a,TabRatio:c}}function JN(){var e=me(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function QN(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function ZN(e){var t=me(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function eA(){}function tA(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Ll(e,0,r),n}function rA(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=me(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function nA(e){var t=$n(e);return t.isst=e.read_shift(4),t}function iA(e,t,r,n){var i=me(10);return Ds(e,t,n,i),i.write_shift(4,r),i}function sA(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=$n(e);r.biff==2&&e.l++;var s=Bl(e,n-e.l,r);return i.val=s,i}function aA(e,t,r,n,i){var s=!i||i.biff==8,l=me(8+ +s+(1+s)*r.length);return Ds(e,t,n,l),l.write_shift(2,r.length),s&&l.write_shift(1,1),l.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),l}function oA(e,t,r){var n=e.read_shift(2),i=Hs(e,0,r);return[n,i]}function lA(e,t,r,n){var i=r&&r.biff==5;n||(n=me(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var cA=Hs;function Bm(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),l=e.read_shift(i),o=e.read_shift(2),a=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:l,c:a}}}function uA(e,t){var r=t.biff==8||!t.biff?4:2,n=me(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function fA(e){var t=e.read_shift(2),r=e.read_shift(2),n=tw(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function hA(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(tw(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(s.length!=l-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:l,rkrec:s}}function dA(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(s.length!=l-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:l,ixfe:s}}function pA(e,t,r,n){var i={},s=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(4),a=e.read_shift(2);return i.patternType=G4[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=l&15,i.dgRight=l>>4&15,i.dgTop=l>>8&15,i.dgBottom=l>>12&15,i.icvLeft=l>>16&127,i.icvRight=l>>23&127,i.grbitDiag=l>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=a&127,i.icvBack=a>>7&127,i.fsxButton=a>>14&1),i}function gA(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=pA(e,t,n.fStyle,r),n}function Um(e,t,r,n){var i=r&&r.biff==5;n||(n=me(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function mA(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function xA(e){var t=me(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Wm(e,t,r){var n=$n(e);(r.biff==2||t==9)&&++e.l;var i=wN(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function vA(e,t,r,n,i,s){var l=me(8);return Ds(e,t,n,l),Jy(r,s,l),l}function yA(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=$n(e),i=wr(e);return n.val=i,n}function wA(e,t,r,n){var i=me(14);return Ds(e,t,n,i),js(r,i),i}var zm=ON;function _A(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=Ps(e,s),o=[];n>e.l;)o.push(Bl(e));return[s,i,l,o]}function Hm(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=jN(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var bA=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function $m(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),a=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),a=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=Ps(e,l,r);i&32&&(c=bA[c.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||o===0||!(d>0)?[]:Mj(e,d,r,o);return{chKey:s,Name:c,itab:a,rgce:f}}function sw(e,t,r){if(r.biff<8)return SA(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(FN(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function SA(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Ll(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function kA(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=Ps(e,n,r),l=Ps(e,i,r);return[s,l]}function CA(e,t,r){var n=nw(e);e.l++;var i=e.read_shift(1);return t-=8,[Lj(e,t,r),i,n]}function Vm(e,t,r){var n=PN(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Rj(e,t,r)]}function TA(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function EA(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=Hs(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},o,l,s]}}function NA(e,t,r){return EA(e,t,r)}function AA(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(nf(e));return r}function OA(e){var t=me(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)rw(e[r],t);return t}function FA(e,t,r){if(r&&r.biff<8)return PA(e,t,r);var n=iw(e),i=MN(e,t-22,n[1]);return{cmo:n,ft:i}}var jA={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function PA(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((jA[n]||Sr)(e,t,r)),{cmo:[i,n,s],ft:l}}function DA(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:l=SN(e,6,r);var o=e.read_shift(2);e.read_shift(2),Ht(e,2);var a=e.read_shift(2);e.l+=a;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var d=e[e.l],f=Ps(e,e.lens[c+1]-e.lens[c]-1);if(i+=f,i.length>=(d?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function RA(e,t){var r=nf(e);e.l+=16;var n=EN(e,t-24);return[r,n]}function IA(e){var t=me(24),r=At(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return er([t,NN(e[1])])}function MA(e,t){e.read_shift(2);var r=nf(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Ar,""),[r,n]}function LA(e){var t=e[1].Tooltip,r=me(10+2*(t.length+1));r.write_shift(2,2048);var n=At(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function BA(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Am[r]||r,r=e.read_shift(2),t[1]=Am[r]||r,t}function UA(e){return e||(e=me(4)),e.write_shift(2,1),e.write_shift(2,1),e}function WA(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(ew(e));return r}function zA(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(ew(e));return r}function HA(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function aw(e,t,r){if(!r.cellStyles)return Sr(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(n),a=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:s,w:l,ixfe:o,flags:a};return(r.biff>=5||!r.biff)&&(c.level=a>>8&7),c}function $A(e,t){var r=me(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function VA(e,t){var r={};return t<32||(e.l+=16,r.header=wr(e),r.footer=wr(e),e.l+=2),r}function XA(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}function YA(e){for(var t=me(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var GA=$n,qA=Ky,KA=Bl;function JA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function QA(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=$n(e);++e.l;var i=Hs(e,t-7,r);return n.t="str",n.val=i,n}function ZA(e){var t=$n(e);++e.l;var r=wr(e);return t.t="n",t.val=r,t}function eO(e,t,r){var n=me(15);return Hl(n,e,t),n.write_shift(8,r,"f"),n}function tO(e){var t=$n(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function rO(e,t,r){var n=me(9);return Hl(n,e,t),n.write_shift(2,r),n}function nO(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function iO(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function sO(e,t,r){var n=e.l+t,i=$n(e),s=e.read_shift(2),l=Ps(e,s,r);return e.l=n,i.t="str",i.val=l,i}var aO=[2,3,48,49,131,139,140,245],Sd=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=ef({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,a){var c=[],d=Vi(1);switch(a.type){case"base64":d=Vr(Jr(o));break;case"binary":d=Vr(o);break;case"buffer":case"array":d=o;break}or(d,0);var f=d.read_shift(1),h=!!(f&136),u=!1,p=!1;switch(f){case 2:break;case 3:break;case 48:u=!0,h=!0;break;case 49:u=!0,h=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,g=521;f==2&&(m=d.read_shift(2)),d.l+=3,f!=2&&(m=d.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(g=d.read_shift(2));var x=d.read_shift(2),v=a.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(v=e[d[d.l]]),d.l+=1,d.l+=2),p&&(d.l+=36);for(var w=[],_={},b=Math.min(d.length,f==2?521:g-10-(u?264:0)),k=p?32:11;d.l<b&&d[d.l]!=13;)switch(_={},_.name=hl.utils.decode(v,d.slice(d.l,d.l+k)).replace(/[\u0000\r\n].*$/g,""),d.l+=k,_.type=String.fromCharCode(d.read_shift(1)),f!=2&&!p&&(_.offset=d.read_shift(4)),_.len=d.read_shift(1),f==2&&(_.offset=d.read_shift(2)),_.dec=d.read_shift(1),_.name.length&&w.push(_),f!=2&&(d.l+=p?13:14),_.type){case"B":(!u||_.len!=8)&&a.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":a.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var S=0,O=0;for(c[0]=[],O=0;O!=w.length;++O)c[0][O]=w[O].name;for(;m-- >0;){if(d[d.l]===42){d.l+=x;continue}for(++d.l,c[++S]=[],O=0,O=0;O!=w.length;++O){var F=d.slice(d.l,d.l+w[O].len);d.l+=w[O].len,or(F,0);var D=hl.utils.decode(v,F);switch(w[O].type){case"C":D.trim().length&&(c[S][O]=D.replace(/\s+$/,""));break;case"D":D.length===8?c[S][O]=new Date(+D.slice(0,4),+D.slice(4,6)-1,+D.slice(6,8)):c[S][O]=D;break;case"F":c[S][O]=parseFloat(D.trim());break;case"+":case"I":c[S][O]=p?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(D.trim().toUpperCase()){case"Y":case"T":c[S][O]=!0;break;case"N":case"F":c[S][O]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+D+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[S][O]="##MEMO##"+(p?parseInt(D.trim(),10):F.read_shift(4));break;case"N":D=D.replace(/\u0000/g,"").trim(),D&&D!="."&&(c[S][O]=+D||0);break;case"@":c[S][O]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":c[S][O]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":c[S][O]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[S][O]=-F.read_shift(-8,"f");break;case"B":if(u&&w[O].len==8){c[S][O]=F.read_shift(8,"f");break}case"G":case"P":F.l+=w[O].len;break;case"0":if(w[O].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[O].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return a&&a.sheetRows&&(c=c.slice(0,a.sheetRows)),a.DBF=w,c}function n(o,a){var c=a||{};c.dateNF||(c.dateNF="yyyymmdd");var d=Ja(r(o,c),c);return d["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,d}function i(o,a){try{return Zi(n(o,a),a)}catch(c){if(a&&a.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,a){var c=a||{};if(+c.codepage>=0&&Sn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var d=Lr(),f=Ou(o,{header:1,raw:!0,cellDates:!0}),h=f[0],u=f.slice(1),p=o["!cols"]||[],m=0,g=0,x=0,v=1;for(m=0;m<h.length;++m){if(((p[m]||{}).DBF||{}).name){h[m]=p[m].DBF.name,++x;continue}if(h[m]!=null){if(++x,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(g=0;g<1024;++g)if(h.indexOf(h[m]+"_"+g)==-1){h[m]+="_"+g;break}}}}var w=st(o["!ref"]),_=[],b=[],k=[];for(m=0;m<=w.e.c-w.s.c;++m){var S="",O="",F=0,D=[];for(g=0;g<u.length;++g)u[g][m]!=null&&D.push(u[g][m]);if(D.length==0||h[m]==null){_[m]="?";continue}for(g=0;g<D.length;++g){switch(typeof D[g]){case"number":O="B";break;case"string":O="C";break;case"boolean":O="L";break;case"object":O=D[g]instanceof Date?"D":"C";break;default:O="C"}F=Math.max(F,String(D[g]).length),S=S&&S!=O?"C":O}F>250&&(F=250),O=((p[m]||{}).DBF||{}).type,O=="C"&&p[m].DBF.len>F&&(F=p[m].DBF.len),S=="B"&&O=="N"&&(S="N",k[m]=p[m].DBF.dec,F=p[m].DBF.len),b[m]=S=="C"||O=="N"?F:s[S]||0,v+=b[m],_[m]=S}var U=d.next(32);for(U.write_shift(4,318902576),U.write_shift(4,u.length),U.write_shift(2,296+32*x),U.write_shift(2,v),m=0;m<4;++m)U.write_shift(4,0);for(U.write_shift(4,0|(+t[qv]||3)<<8),m=0,g=0;m<h.length;++m)if(h[m]!=null){var M=d.next(32),q=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,q,"sbcs"),M.write_shift(1,_[m]=="?"?"C":_[m],"sbcs"),M.write_shift(4,g),M.write_shift(1,b[m]||s[_[m]]||0),M.write_shift(1,k[m]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),g+=b[m]||s[_[m]]||0}var G=d.next(264);for(G.write_shift(4,13),m=0;m<65;++m)G.write_shift(4,0);for(m=0;m<u.length;++m){var Q=d.next(v);for(Q.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(_[g]){case"L":Q.write_shift(1,u[m][g]==null?63:u[m][g]?84:70);break;case"B":Q.write_shift(8,u[m][g]||0,"f");break;case"N":var K="0";for(typeof u[m][g]=="number"&&(K=u[m][g].toFixed(k[g]||0)),x=0;x<b[g]-K.length;++x)Q.write_shift(1,32);Q.write_shift(1,K,"sbcs");break;case"D":u[m][g]?(Q.write_shift(4,("0000"+u[m][g].getFullYear()).slice(-4),"sbcs"),Q.write_shift(2,("00"+(u[m][g].getMonth()+1)).slice(-2),"sbcs"),Q.write_shift(2,("00"+u[m][g].getDate()).slice(-2),"sbcs")):Q.write_shift(8,"00000000","sbcs");break;case"C":var ne=String(u[m][g]!=null?u[m][g]:"").slice(0,b[g]);for(Q.write_shift(1,ne,"sbcs"),x=0;x<b[g]-ne.length;++x)Q.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:l}}(),ow=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+It(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,u){var p=e[u];return typeof p=="number"?rm(p):p},n=function(h,u,p){var m=u.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return m==59?h:rm(m)};e["|"]=254;function i(h,u){switch(u.type){case"base64":return s(Jr(h),u);case"binary":return s(h,u);case"buffer":return s(Qe&&Buffer.isBuffer(h)?h.toString("binary"):Qi(h),u);case"array":return s(Fs(h),u)}throw new Error("Unrecognized type "+u.type)}function s(h,u){var p=h.split(/[\n\r]+/),m=-1,g=-1,x=0,v=0,w=[],_=[],b=null,k={},S=[],O=[],F=[],D=0,U;for(+u.codepage>=0&&Sn(+u.codepage);x!==p.length;++x){D=0;var M=p[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),q=M.replace(/;;/g,"\0").split(";").map(function(C){return C.replace(/\u0000/g,";")}),G=q[0],Q;if(M.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&_.push(M.slice(3).replace(/;;/g,";"));break;case"C":var K=!1,ne=!1,J=!1,T=!1,j=-1,B=-1;for(v=1;v<q.length;++v)switch(q[v].charAt(0)){case"A":break;case"X":g=parseInt(q[v].slice(1))-1,ne=!0;break;case"Y":for(m=parseInt(q[v].slice(1))-1,ne||(g=0),U=w.length;U<=m;++U)w[U]=[];break;case"K":Q=q[v].slice(1),Q.charAt(0)==='"'?Q=Q.slice(1,Q.length-1):Q==="TRUE"?Q=!0:Q==="FALSE"?Q=!1:isNaN(Nn(Q))?isNaN(Wa(Q).getDate())||(Q=wt(Q)):(Q=Nn(Q),b!==null&&qa(b)&&(Q=rf(Q))),K=!0;break;case"E":T=!0;var E=Oa(q[v].slice(1),{r:m,c:g});w[m][g]=[w[m][g],E];break;case"S":J=!0,w[m][g]=[w[m][g],"S5S"];break;case"G":break;case"R":j=parseInt(q[v].slice(1))-1;break;case"C":B=parseInt(q[v].slice(1))-1;break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+M)}if(K&&(w[m][g]&&w[m][g].length==2?w[m][g][0]=Q:w[m][g]=Q,b=null),J){if(T)throw new Error("SYLK shared formula cannot have own formula");var R=j>-1&&w[j][B];if(!R||!R[1])throw new Error("SYLK shared formula cannot find base");w[m][g][1]=Cw(R[1],{r:m-j,c:g-B})}break;case"F":var N=0;for(v=1;v<q.length;++v)switch(q[v].charAt(0)){case"X":g=parseInt(q[v].slice(1))-1,++N;break;case"Y":for(m=parseInt(q[v].slice(1))-1,U=w.length;U<=m;++U)w[U]=[];break;case"M":D=parseInt(q[v].slice(1))/20;break;case"F":break;case"G":break;case"P":b=_[parseInt(q[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=q[v].slice(1).split(" "),U=parseInt(F[0],10);U<=parseInt(F[1],10);++U)D=parseInt(F[2],10),O[U-1]=D===0?{hidden:!0}:{wch:D},Xi(O[U-1]);break;case"C":g=parseInt(q[v].slice(1))-1,O[g]||(O[g]={});break;case"R":m=parseInt(q[v].slice(1))-1,S[m]||(S[m]={}),D>0?(S[m].hpt=D,S[m].hpx=Ha(D)):D===0&&(S[m].hidden=!0);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+M)}N<1&&(b=null);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+M)}}return S.length>0&&(k["!rows"]=S),O.length>0&&(k["!cols"]=O),u&&u.sheetRows&&(w=w.slice(0,u.sheetRows)),[w,k]}function l(h,u){var p=i(h,u),m=p[0],g=p[1],x=Ja(m,u);return It(g).forEach(function(v){x[v]=g[v]}),x}function o(h,u){return Zi(l(h,u),u)}function a(h,u,p,m){var g="C;Y"+(p+1)+";X"+(m+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+np(h.f,{r:p,c:m}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(h,u){u.forEach(function(p,m){var g="F;W"+(m+1)+" "+(m+1)+" ";p.hidden?g+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=wl(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=_l(p.wpx)),typeof p.wch=="number"&&(g+=Math.round(p.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function d(h,u){u.forEach(function(p,m){var g="F;";p.hidden?g+="M0;":p.hpt?g+="M"+20*p.hpt+";":p.hpx&&(g+="M"+20*bl(p.hpx)+";"),g.length>2&&h.push(g+"R"+(m+1))})}function f(h,u){var p=["ID;PWXL;N;E"],m=[],g=st(h["!ref"]),x,v=Array.isArray(h),w=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),h["!cols"]&&c(p,h["!cols"]),h["!rows"]&&d(p,h["!rows"]),p.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var _=g.s.r;_<=g.e.r;++_)for(var b=g.s.c;b<=g.e.c;++b){var k=Ve({r:_,c:b});x=v?(h[_]||[])[b]:h[k],!(!x||x.v==null&&(!x.f||x.F))&&m.push(a(x,h,_,b))}return p.join(w)+w+m.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:l,from_sheet:f}}(),lw=function(){function e(s,l){switch(l.type){case"base64":return t(Jr(s),l);case"binary":return t(s,l);case"buffer":return t(Qe&&Buffer.isBuffer(s)?s.toString("binary"):Qi(s),l);case"array":return t(Fs(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){for(var o=s.split(`
`),a=-1,c=-1,d=0,f=[];d!==o.length;++d){if(o[d].trim()==="BOT"){f[++a]=[],c=0;continue}if(!(a<0)){var h=o[d].trim().split(","),u=h[0],p=h[1];++d;for(var m=o[d]||"";(m.match(/["]/g)||[]).length&1&&d<o.length-1;)m+=`
`+o[++d];switch(m=m.trim(),+u){case-1:if(m==="BOT"){f[++a]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[a][c]=!0:m==="FALSE"?f[a][c]=!1:isNaN(Nn(p))?isNaN(Wa(p).getDate())?f[a][c]=p:f[a][c]=wt(p):f[a][c]=Nn(p),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[a][c++]=m!==""?m:null;break}if(m==="EOD")break}}return l&&l.sheetRows&&(f=f.slice(0,l.sheetRows)),f}function r(s,l){return Ja(e(s,l),l)}function n(s,l){return Zi(r(s,l),l)}var i=function(){var s=function(a,c,d,f,h){a.push(c),a.push(d+","+f),a.push('"'+h.replace(/"/g,'""')+'"')},l=function(a,c,d,f){a.push(c+","+d),a.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(a){var c=[],d=st(a["!ref"]),f,h=Array.isArray(a);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,d.e.r-d.s.r+1,""),s(c,"TUPLES",0,d.e.c-d.s.c+1,""),s(c,"DATA",0,0,"");for(var u=d.s.r;u<=d.e.r;++u){l(c,-1,0,"BOT");for(var p=d.s.c;p<=d.e.c;++p){var m=Ve({r:u,c:p});if(f=h?(a[u]||[])[p]:a[m],!f){l(c,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?l(c,1,0,"="+f.f):l(c,1,0,""):l(c,0,g,"V");break;case"b":l(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":l(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=pn(f.z||ze[14],Jt(wt(f.v)))),l(c,0,f.w,"V");break;default:l(c,1,0,"")}}}l(c,-1,0,"EOD");var x=`\r
`,v=c.join(x);return v}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),cw=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var u=f.split(`
`),p=-1,m=-1,g=0,x=[];g!==u.length;++g){var v=u[g].trim().split(":");if(v[0]==="cell"){var w=At(v[1]);if(x.length<=w.r)for(p=x.length;p<=w.r;++p)x[p]||(x[p]=[]);switch(p=w.r,m=w.c,v[2]){case"t":x[p][m]=e(v[3]);break;case"v":x[p][m]=+v[3];break;case"vtf":var _=v[v.length-1];case"vtc":switch(v[3]){case"nl":x[p][m]=!!+v[4];break;default:x[p][m]=+v[4];break}v[2]=="vtf"&&(x[p][m]=[x[p][m],_])}}}return h&&h.sheetRows&&(x=x.slice(0,h.sheetRows)),x}function n(f,h){return Ja(r(f,h),h)}function i(f,h){return Zi(n(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),a="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var h=[],u=[],p,m="",g=Br(f["!ref"]),x=Array.isArray(f),v=g.s.r;v<=g.e.r;++v)for(var w=g.s.c;w<=g.e.c;++w)if(m=Ve({r:v,c:w}),p=x?(f[v]||[])[w]:f[m],!(!p||p.v==null||p.t==="z")){switch(u=["cell",m,"t"],p.t){case"s":case"str":u.push(t(p.v));break;case"n":p.f?(u[2]="vtf",u[3]="n",u[4]=p.v,u[5]=t(p.f)):(u[2]="v",u[3]=p.v);break;case"b":u[2]="vt"+(p.f?"f":"c"),u[3]="nl",u[4]=p.v?"1":"0",u[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var _=Jt(wt(p.v));u[2]="vtc",u[3]="nd",u[4]=""+_,u[5]=p.w||pn(p.z||ze[14],_);break;case"e":continue}h.push(u.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[s,l,o,l,c(f),a].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),za=function(){function e(d,f,h,u,p){p.raw?f[h][u]=d:d===""||(d==="TRUE"?f[h][u]=!0:d==="FALSE"?f[h][u]=!1:isNaN(Nn(d))?isNaN(Wa(d).getDate())?f[h][u]=d:f[h][u]=wt(d):f[h][u]=Nn(d))}function t(d,f){var h=f||{},u=[];if(!d||d.length===0)return u;for(var p=d.split(/[\r\n]/),m=p.length-1;m>=0&&p[m].length===0;)--m;for(var g=10,x=0,v=0;v<=m;++v)x=p[v].indexOf(" "),x==-1?x=p[v].length:x++,g=Math.max(g,x);for(v=0;v<=m;++v){u[v]=[];var w=0;for(e(p[v].slice(0,g).trim(),u,v,w,h),w=1;w<=(p[v].length-g)/10+1;++w)e(p[v].slice(g+(w-1)*10,g+w*10).trim(),u,v,w,h)}return h.sheetRows&&(u=u.slice(0,h.sheetRows)),u}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var f={},h=!1,u=0,p=0;u<d.length;++u)(p=d.charCodeAt(u))==34?h=!h:!h&&p in r&&(f[p]=(f[p]||0)+1);p=[];for(u in f)Object.prototype.hasOwnProperty.call(f,u)&&p.push([f[u],u]);if(!p.length){f=n;for(u in f)Object.prototype.hasOwnProperty.call(f,u)&&p.push([f[u],u])}return p.sort(function(m,g){return m[0]-g[0]||n[m[1]]-n[g[1]]}),r[p.pop()[1]]||44}function s(d,f){var h=f||{},u="",p=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(u=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(u=d.charAt(4),d=d.slice(6)):u=i(d.slice(0,1024)):h&&h.FS?u=h.FS:u=i(d.slice(0,1024));var g=0,x=0,v=0,w=0,_=0,b=u.charCodeAt(0),k=!1,S=0,O=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var F=h.dateNF!=null?XE(h.dateNF):null;function D(){var U=d.slice(w,_),M={};if(U.charAt(0)=='"'&&U.charAt(U.length-1)=='"'&&(U=U.slice(1,-1).replace(/""/g,'"')),U.length===0)M.t="z";else if(h.raw)M.t="s",M.v=U;else if(U.trim().length===0)M.t="s",M.v=U;else if(U.charCodeAt(0)==61)U.charCodeAt(1)==34&&U.charCodeAt(U.length-1)==34?(M.t="s",M.v=U.slice(2,-1).replace(/""/g,'"')):_F(U)?(M.t="n",M.f=U.slice(1)):(M.t="s",M.v=U);else if(U=="TRUE")M.t="b",M.v=!0;else if(U=="FALSE")M.t="b",M.v=!1;else if(!isNaN(v=Nn(U)))M.t="n",h.cellText!==!1&&(M.w=U),M.v=v;else if(!isNaN(Wa(U).getDate())||F&&U.match(F)){M.z=h.dateNF||ze[14];var q=0;F&&U.match(F)&&(U=YE(U,h.dateNF,U.match(F)||[]),q=1),h.cellDates?(M.t="d",M.v=wt(U,q)):(M.t="n",M.v=Jt(wt(U,q))),h.cellText!==!1&&(M.w=pn(M.z,M.v instanceof Date?Jt(M.v):M.v)),h.cellNF||delete M.z}else M.t="s",M.v=U;if(M.t=="z"||(h.dense?(p[g]||(p[g]=[]),p[g][x]=M):p[Ve({c:x,r:g})]=M),w=_+1,O=d.charCodeAt(w),m.e.c<x&&(m.e.c=x),m.e.r<g&&(m.e.r=g),S==b)++x;else if(x=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;_<d.length;++_)switch(S=d.charCodeAt(_)){case 34:O===34&&(k=!k);break;case b:case 10:case 13:if(!k&&D())break e;break}return _-w>0&&D(),p["!ref"]=Ke(m),p}function l(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):Ja(t(d,f),f)}function o(d,f){var h="",u=f.type=="string"?[0,0,0,0]:fp(d,f);switch(f.type){case"base64":h=Jr(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof hl<"u"||(h=Qe&&Buffer.isBuffer(d)?d.toString("binary"):Qi(d));break;case"array":h=Fs(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return u[0]==239&&u[1]==187&&u[2]==191?h=dt(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=dt(h):f.type=="binary"&&typeof hl<"u",h.slice(0,19)=="socialcalc:version:"?cw.to_sheet(f.type=="string"?h:dt(h),f):l(h,f)}function a(d,f){return Zi(o(d,f),f)}function c(d){for(var f=[],h=st(d["!ref"]),u,p=Array.isArray(d),m=h.s.r;m<=h.e.r;++m){for(var g=[],x=h.s.c;x<=h.e.c;++x){var v=Ve({r:m,c:x});if(u=p?(d[m]||[])[x]:d[v],!u||u.v==null){g.push("          ");continue}for(var w=(u.w||(ui(u),u.w)||"").slice(0,10);w.length<10;)w+=" ";g.push(w+(x===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:a,to_sheet:o,from_sheet:c}}();function oO(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=ow.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return za.to_workbook(e,t)}}var bs=function(){function e(E,R,N){if(E){or(E,E.l||0);for(var C=N.Enum||j;E.l<E.length;){var P=E.read_shift(2),I=C[P]||C[65535],H=E.read_shift(2),L=E.l+H,z=I.f&&I.f(E,H,N);if(E.l=L,R(z,I,P))return}}}function t(E,R){switch(R.type){case"base64":return r(Vr(Jr(E)),R);case"binary":return r(Vr(E),R);case"buffer":case"array":return r(E,R)}throw"Unsupported type "+R.type}function r(E,R){if(!E)return E;var N=R||{},C=N.dense?[]:{},P="Sheet1",I="",H=0,L={},z=[],ee=[],A={s:{r:0,c:0},e:{r:0,c:0}},V=N.sheetRows||0;if(E[2]==0&&(E[3]==8||E[3]==9)&&E.length>=16&&E[14]==5&&E[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(E[2]==2)N.Enum=j,e(E,function(Y,ce,ue){switch(ue){case 0:N.vers=Y,Y>=4096&&(N.qpro=!0);break;case 6:A=Y;break;case 204:Y&&(I=Y);break;case 222:I=Y;break;case 15:case 51:N.qpro||(Y[1].v=Y[1].v.slice(1));case 13:case 14:case 16:ue==14&&(Y[2]&112)==112&&(Y[2]&15)>1&&(Y[2]&15)<15&&(Y[1].z=N.dateNF||ze[14],N.cellDates&&(Y[1].t="d",Y[1].v=rf(Y[1].v))),N.qpro&&Y[3]>H&&(C["!ref"]=Ke(A),L[P]=C,z.push(P),C=N.dense?[]:{},A={s:{r:0,c:0},e:{r:0,c:0}},H=Y[3],P=I||"Sheet"+(H+1),I="");var xe=N.dense?(C[Y[0].r]||[])[Y[0].c]:C[Ve(Y[0])];if(xe){xe.t=Y[1].t,xe.v=Y[1].v,Y[1].z!=null&&(xe.z=Y[1].z),Y[1].f!=null&&(xe.f=Y[1].f);break}N.dense?(C[Y[0].r]||(C[Y[0].r]=[]),C[Y[0].r][Y[0].c]=Y[1]):C[Ve(Y[0])]=Y[1];break}},N);else if(E[2]==26||E[2]==14)N.Enum=B,E[2]==14&&(N.qpro=!0,E.l=0),e(E,function(Y,ce,ue){switch(ue){case 204:P=Y;break;case 22:Y[1].v=Y[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Y[3]>H&&(C["!ref"]=Ke(A),L[P]=C,z.push(P),C=N.dense?[]:{},A={s:{r:0,c:0},e:{r:0,c:0}},H=Y[3],P="Sheet"+(H+1)),V>0&&Y[0].r>=V)break;N.dense?(C[Y[0].r]||(C[Y[0].r]=[]),C[Y[0].r][Y[0].c]=Y[1]):C[Ve(Y[0])]=Y[1],A.e.c<Y[0].c&&(A.e.c=Y[0].c),A.e.r<Y[0].r&&(A.e.r=Y[0].r);break;case 27:Y[14e3]&&(ee[Y[14e3][0]]=Y[14e3][1]);break;case 1537:ee[Y[0]]=Y[1],Y[0]==H&&(P=Y[1]);break}},N);else throw new Error("Unrecognized LOTUS BOF "+E[2]);if(C["!ref"]=Ke(A),L[I||P]=C,z.push(I||P),!ee.length)return{SheetNames:z,Sheets:L};for(var W={},te=[],ae=0;ae<ee.length;++ae)L[z[ae]]?(te.push(ee[ae]||z[ae]),W[ee[ae]]=L[ee[ae]]||L[z[ae]]):(te.push(ee[ae]),W[ee[ae]]={"!ref":"A1"});return{SheetNames:te,Sheets:W}}function n(E,R){var N=R||{};if(+N.codepage>=0&&Sn(+N.codepage),N.type=="string")throw new Error("Cannot write WK1 to JS string");var C=Lr(),P=st(E["!ref"]),I=Array.isArray(E),H=[];Ae(C,0,s(1030)),Ae(C,6,a(P));for(var L=Math.min(P.e.r,8191),z=P.s.r;z<=L;++z)for(var ee=Bt(z),A=P.s.c;A<=P.e.c;++A){z===P.s.r&&(H[A]=Nt(A));var V=H[A]+ee,W=I?(E[z]||[])[A]:E[V];if(!(!W||W.t=="z"))if(W.t=="n")(W.v|0)==W.v&&W.v>=-32768&&W.v<=32767?Ae(C,13,u(z,A,W.v)):Ae(C,14,m(z,A,W.v));else{var te=ui(W);Ae(C,15,f(z,A,te.slice(0,239)))}}return Ae(C,1),C.end()}function i(E,R){var N=R||{};if(+N.codepage>=0&&Sn(+N.codepage),N.type=="string")throw new Error("Cannot write WK3 to JS string");var C=Lr();Ae(C,0,l(E));for(var P=0,I=0;P<E.SheetNames.length;++P)(E.Sheets[E.SheetNames[P]]||{})["!ref"]&&Ae(C,27,T(E.SheetNames[P],I++));var H=0;for(P=0;P<E.SheetNames.length;++P){var L=E.Sheets[E.SheetNames[P]];if(!(!L||!L["!ref"])){for(var z=st(L["!ref"]),ee=Array.isArray(L),A=[],V=Math.min(z.e.r,8191),W=z.s.r;W<=V;++W)for(var te=Bt(W),ae=z.s.c;ae<=z.e.c;++ae){W===z.s.r&&(A[ae]=Nt(ae));var Y=A[ae]+te,ce=ee?(L[W]||[])[ae]:L[Y];if(!(!ce||ce.t=="z"))if(ce.t=="n")Ae(C,23,D(W,ae,H,ce.v));else{var ue=ui(ce);Ae(C,22,S(W,ae,H,ue.slice(0,239)))}}++H}}return Ae(C,1),C.end()}function s(E){var R=me(2);return R.write_shift(2,E),R}function l(E){var R=me(26);R.write_shift(2,4096),R.write_shift(2,4),R.write_shift(4,0);for(var N=0,C=0,P=0,I=0;I<E.SheetNames.length;++I){var H=E.SheetNames[I],L=E.Sheets[H];if(!(!L||!L["!ref"])){++P;var z=Br(L["!ref"]);N<z.e.r&&(N=z.e.r),C<z.e.c&&(C=z.e.c)}}return N>8191&&(N=8191),R.write_shift(2,N),R.write_shift(1,P),R.write_shift(1,C),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(1,1),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(4,0),R}function o(E,R,N){var C={s:{c:0,r:0},e:{c:0,r:0}};return R==8&&N.qpro?(C.s.c=E.read_shift(1),E.l++,C.s.r=E.read_shift(2),C.e.c=E.read_shift(1),E.l++,C.e.r=E.read_shift(2),C):(C.s.c=E.read_shift(2),C.s.r=E.read_shift(2),R==12&&N.qpro&&(E.l+=2),C.e.c=E.read_shift(2),C.e.r=E.read_shift(2),R==12&&N.qpro&&(E.l+=2),C.s.c==65535&&(C.s.c=C.e.c=C.s.r=C.e.r=0),C)}function a(E){var R=me(8);return R.write_shift(2,E.s.c),R.write_shift(2,E.s.r),R.write_shift(2,E.e.c),R.write_shift(2,E.e.r),R}function c(E,R,N){var C=[{c:0,r:0},{t:"n",v:0},0,0];return N.qpro&&N.vers!=20768?(C[0].c=E.read_shift(1),C[3]=E.read_shift(1),C[0].r=E.read_shift(2),E.l+=2):(C[2]=E.read_shift(1),C[0].c=E.read_shift(2),C[0].r=E.read_shift(2)),C}function d(E,R,N){var C=E.l+R,P=c(E,R,N);if(P[1].t="s",N.vers==20768){E.l++;var I=E.read_shift(1);return P[1].v=E.read_shift(I,"utf8"),P}return N.qpro&&E.l++,P[1].v=E.read_shift(C-E.l,"cstr"),P}function f(E,R,N){var C=me(7+N.length);C.write_shift(1,255),C.write_shift(2,R),C.write_shift(2,E),C.write_shift(1,39);for(var P=0;P<C.length;++P){var I=N.charCodeAt(P);C.write_shift(1,I>=128?95:I)}return C.write_shift(1,0),C}function h(E,R,N){var C=c(E,R,N);return C[1].v=E.read_shift(2,"i"),C}function u(E,R,N){var C=me(7);return C.write_shift(1,255),C.write_shift(2,R),C.write_shift(2,E),C.write_shift(2,N,"i"),C}function p(E,R,N){var C=c(E,R,N);return C[1].v=E.read_shift(8,"f"),C}function m(E,R,N){var C=me(13);return C.write_shift(1,255),C.write_shift(2,R),C.write_shift(2,E),C.write_shift(8,N,"f"),C}function g(E,R,N){var C=E.l+R,P=c(E,R,N);if(P[1].v=E.read_shift(8,"f"),N.qpro)E.l=C;else{var I=E.read_shift(2);_(E.slice(E.l,E.l+I),P),E.l+=I}return P}function x(E,R,N){var C=R&32768;return R&=-32769,R=(C?E:0)+(R>=8192?R-16384:R),(C?"":"$")+(N?Nt(R):Bt(R))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(E,R){or(E,0);for(var N=[],C=0,P="",I="",H="",L="";E.l<E.length;){var z=E[E.l++];switch(z){case 0:N.push(E.read_shift(8,"f"));break;case 1:I=x(R[0].c,E.read_shift(2),!0),P=x(R[0].r,E.read_shift(2),!1),N.push(I+P);break;case 2:{var ee=x(R[0].c,E.read_shift(2),!0),A=x(R[0].r,E.read_shift(2),!1);I=x(R[0].c,E.read_shift(2),!0),P=x(R[0].r,E.read_shift(2),!1),N.push(ee+A+":"+I+P)}break;case 3:if(E.l<E.length){console.error("WK1 premature formula end");return}break;case 4:N.push("("+N.pop()+")");break;case 5:N.push(E.read_shift(2));break;case 6:{for(var V="";z=E[E.l++];)V+=String.fromCharCode(z);N.push('"'+V.replace(/"/g,'""')+'"')}break;case 8:N.push("-"+N.pop());break;case 23:N.push("+"+N.pop());break;case 22:N.push("NOT("+N.pop()+")");break;case 20:case 21:L=N.pop(),H=N.pop(),N.push(["AND","OR"][z-20]+"("+H+","+L+")");break;default:if(z<32&&w[z])L=N.pop(),H=N.pop(),N.push(H+w[z]+L);else if(v[z]){if(C=v[z][1],C==69&&(C=E[E.l++]),C>N.length){console.error("WK1 bad formula parse 0x"+z.toString(16)+":|"+N.join("|")+"|");return}var W=N.slice(-C);N.length-=C,N.push(v[z][0]+"("+W.join(",")+")")}else return z<=7?console.error("WK1 invalid opcode "+z.toString(16)):z<=24?console.error("WK1 unsupported op "+z.toString(16)):z<=30?console.error("WK1 invalid opcode "+z.toString(16)):z<=115?console.error("WK1 unsupported function opcode "+z.toString(16)):console.error("WK1 unrecognized opcode "+z.toString(16))}}N.length==1?R[1].f=""+N[0]:console.error("WK1 bad formula parse |"+N.join("|")+"|")}function b(E){var R=[{c:0,r:0},{t:"n",v:0},0];return R[0].r=E.read_shift(2),R[3]=E[E.l++],R[0].c=E[E.l++],R}function k(E,R){var N=b(E);return N[1].t="s",N[1].v=E.read_shift(R-4,"cstr"),N}function S(E,R,N,C){var P=me(6+C.length);P.write_shift(2,E),P.write_shift(1,N),P.write_shift(1,R),P.write_shift(1,39);for(var I=0;I<C.length;++I){var H=C.charCodeAt(I);P.write_shift(1,H>=128?95:H)}return P.write_shift(1,0),P}function O(E,R){var N=b(E);N[1].v=E.read_shift(2);var C=N[1].v>>1;if(N[1].v&1)switch(C&7){case 0:C=(C>>3)*5e3;break;case 1:C=(C>>3)*500;break;case 2:C=(C>>3)/20;break;case 3:C=(C>>3)/200;break;case 4:C=(C>>3)/2e3;break;case 5:C=(C>>3)/2e4;break;case 6:C=(C>>3)/16;break;case 7:C=(C>>3)/64;break}return N[1].v=C,N}function F(E,R){var N=b(E),C=E.read_shift(4),P=E.read_shift(4),I=E.read_shift(2);if(I==65535)return C===0&&P===3221225472?(N[1].t="e",N[1].v=15):C===0&&P===3489660928?(N[1].t="e",N[1].v=42):N[1].v=0,N;var H=I&32768;return I=(I&32767)-16446,N[1].v=(1-H*2)*(P*Math.pow(2,I+32)+C*Math.pow(2,I)),N}function D(E,R,N,C){var P=me(14);if(P.write_shift(2,E),P.write_shift(1,N),P.write_shift(1,R),C==0)return P.write_shift(4,0),P.write_shift(4,0),P.write_shift(2,65535),P;var I=0,H=0,L=0,z=0;return C<0&&(I=1,C=-C),H=Math.log2(C)|0,C/=Math.pow(2,H-31),z=C>>>0,z&2147483648||(C/=2,++H,z=C>>>0),C-=z,z|=2147483648,z>>>=0,C*=Math.pow(2,32),L=C>>>0,P.write_shift(4,L),P.write_shift(4,z),H+=16383+(I?32768:0),P.write_shift(2,H),P}function U(E,R){var N=F(E);return E.l+=R-14,N}function M(E,R){var N=b(E),C=E.read_shift(4);return N[1].v=C>>6,N}function q(E,R){var N=b(E),C=E.read_shift(8,"f");return N[1].v=C,N}function G(E,R){var N=q(E);return E.l+=R-10,N}function Q(E,R){return E[E.l+R-1]==0?E.read_shift(R,"cstr"):""}function K(E,R){var N=E[E.l++];N>R-1&&(N=R-1);for(var C="";C.length<N;)C+=String.fromCharCode(E[E.l++]);return C}function ne(E,R,N){if(!(!N.qpro||R<21)){var C=E.read_shift(1);E.l+=17,E.l+=1,E.l+=2;var P=E.read_shift(R-21,"cstr");return[C,P]}}function J(E,R){for(var N={},C=E.l+R;E.l<C;){var P=E.read_shift(2);if(P==14e3){for(N[P]=[0,""],N[P][0]=E.read_shift(2);E[E.l];)N[P][1]+=String.fromCharCode(E[E.l]),E.l++;E.l++}}return N}function T(E,R){var N=me(5+E.length);N.write_shift(2,14e3),N.write_shift(2,R);for(var C=0;C<E.length;++C){var P=E.charCodeAt(C);N[N.l++]=P>127?95:P}return N[N.l++]=0,N}var j={0:{n:"BOF",f:Ht},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Q},222:{n:"SHEETNAMELP",f:K},65535:{n:""}},B={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:O},25:{n:"FORMULA19",f:U},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:J},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function lO(e){var t={},r=e.match(kr),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Xe(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=N0[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var cO=function(){var e=gl("t"),t=gl("rPr");function r(s){var l=s.match(e);if(!l)return{t:"s",v:""};var o={t:"s",v:it(l[1])},a=s.match(t);return a&&(o.s=lO(a[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),uO=function(){var t=/(\r\n|\n)/g;function r(i,s,l){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),l.push("</b>")),i.i&&(s.push("<i>"),l.push("</i>")),i.strike&&(s.push("<s>"),l.push("</s>"));var a=i.valign||"";return a=="superscript"||a=="super"?a="sup":a=="subscript"&&(a="sub"),a!=""&&(s.push("<"+a+">"),l.push("</"+a+">")),l.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),fO=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,hO=/<(?:\w+:)?r>/,dO=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Q0(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=it(dt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=dt(e),r&&(n.h=L0(n.t))):e.match(hO)&&(n.r=dt(e),n.t=it(dt((e.replace(dO,"").match(fO)||[]).join("").replace(kr,""))),r&&(n.h=uO(cO(n.r)))),n):{t:""}}var pO=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,gO=/<(?:\w+:)?(?:si|sstItem)>/g,mO=/<\/(?:\w+:)?(?:si|sstItem)>/;function xO(e,t){var r=[],n="";if(!e)return r;var i=e.match(pO);if(i){n=i[2].replace(gO,"").split(mO);for(var s=0;s!=n.length;++s){var l=Q0(n[s].trim(),t);l!=null&&(r[r.length]=l)}i=Xe(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var vO=/^\s|\s$|[\t\n\r]/;function uw(e,t){if(!t.bookSST)return"";var r=[Ut];r[r.length]=Ne("sst",null,{xmlns:Ls[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(vO)&&(s+=' xml:space="preserve"'),s+=">"+ft(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function yO(e){return[e.read_shift(4),e.read_shift(4)]}function wO(e,t){var r=[],n=!1;return pi(e,function(s,l,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function _O(e,t){return t||(t=me(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var bO=j4;function SO(e){var t=Lr();be(t,159,_O(e));for(var r=0;r<e.length;++r)be(t,19,bO(e[r]));return be(t,160),t.end()}function fw(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ni(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function kO(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ni(e,4),t.U=ni(e,4),t.W=ni(e,4),t}function CO(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function TO(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(CO(e));return t}function EO(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function NO(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ni(e,4),t.U=ni(e,4),t.W=ni(e,4),t}function AO(e){var t=NO(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function hw(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function dw(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function OO(e){var t=ni(e);switch(t.Minor){case 2:return[t.Minor,FO(e)];case 3:return[t.Minor,jO()];case 4:return[t.Minor,PO(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function FO(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=hw(e,r),i=dw(e,e.length-e.l);return{t:"Std",h:n,v:i}}function jO(){throw new Error("File is password-protected: ECMA-376 Extensible")}function PO(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(kr,function(s){var l=Xe(s);switch(Hn(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=l[o]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function DO(e,t){var r={},n=r.EncryptionVersionInfo=ni(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=hw(e,i),t-=i,r.EncryptionVerifier=dw(e,t),r}function RO(e){var t={},r=t.EncryptionVersionInfo=ni(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Z0(e){var t=0,r,n=fw(e),i=n.length+1,s,l,o,a,c;for(r=Vi(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)l=r[s],o=t&16384?1:0,a=t<<1&32767,c=o|a,t=c^l;return t^52811}var pw=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},i=function(l,o){return n(l^o)},s=function(l){for(var o=t[l.length-1],a=104,c=l.length-1;c>=0;--c)for(var d=l[c],f=0;f!=7;++f)d&64&&(o^=r[a]),d*=2,--a;return o};return function(l){for(var o=fw(l),a=s(o),c=o.length,d=Vi(16),f=0;f!=16;++f)d[f]=0;var h,u,p;for((c&1)===1&&(h=a>>8,d[c]=i(e[0],h),--c,h=a&255,u=o[o.length-1],d[c]=i(u,h));c>0;)--c,h=a>>8,d[c]=i(o[c],h),--c,h=a&255,d[c]=i(o[c],h);for(c=15,p=15-o.length;p>0;)h=a>>8,d[c]=i(e[p],h),--c,--p,h=a&255,d[c]=i(o[c],h),--c,--p;return d}}(),IO=function(e,t,r,n,i){i||(i=t),n||(n=pw(e));var s,l;for(s=0;s!=t.length;++s)l=t[s],l^=n[r],l=(l>>5|l<<3)&255,i[s]=l,++r;return[i,r,n]},MO=function(e){var t=0,r=pw(e);return function(n){var i=IO("",n,t,r);return t=i[1],i[0]}};function LO(e,t,r,n){var i={key:Ht(e),verificationBytes:Ht(e)};return r.password&&(i.verifier=Z0(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=MO(r.password)),i}function BO(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=RO(e):n.Data=DO(e,t),n}function UO(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?BO(e,t-2,n):LO(e,r.biff>=8?t:t-2,r,n),n}var gw=function(){function e(i,s){switch(s.type){case"base64":return t(Jr(i),s);case"binary":return t(i,s);case"buffer":return t(Qe&&Buffer.isBuffer(i)?i.toString("binary"):Qi(i),s);case"array":return t(Fs(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var l=s||{},o=l.dense?[]:{},a=i.match(/\\trowd.*?\\row\b/g);if(!a.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:a.length-1}};return a.forEach(function(d,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,u=0,p,m=-1;p=h.exec(d);){switch(p[0]){case"\\cell":var g=d.slice(u,h.lastIndex-p[0].length);if(g[0]==" "&&(g=g.slice(1)),++m,g.length){var x={v:g,t:"s"};Array.isArray(o)?o[f][m]=x:o[Ve({r:f,c:m})]=x}break}u=h.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=Ke(c),o}function r(i,s){return Zi(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],l=st(i["!ref"]),o,a=Array.isArray(i),c=l.s.r;c<=l.e.r;++c){s.push("\\trowd\\trautofit1");for(var d=l.s.c;d<=l.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=l.s.c;d<=l.e.c;++d){var f=Ve({r:c,c:d});o=a?(i[c]||[])[d]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(ui(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function WO(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function yl(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function zO(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),l=i-s;if(l===0)return[0,0,t];var o=0,a=0,c=i+s;switch(a=l/(c>1?2-c:c),i){case t:o=((r-n)/l+6)%6;break;case r:o=(n-t)/l+2;break;case n:o=(t-r)/l+4;break}return[o/6,a,c/2]}function HO(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,l=[s,s,s],o=6*t,a;if(r!==0)switch(o|0){case 0:case 6:a=i*o,l[0]+=i,l[1]+=a;break;case 1:a=i*(2-o),l[0]+=a,l[1]+=i;break;case 2:a=i*(o-2),l[1]+=i,l[2]+=a;break;case 3:a=i*(4-o),l[1]+=a,l[2]+=i;break;case 4:a=i*(o-4),l[2]+=i,l[0]+=a;break;case 5:a=i*(6-o),l[2]+=a,l[0]+=i;break}for(var c=0;c!=3;++c)l[c]=Math.round(l[c]*255);return l}function Nu(e,t){if(t===0)return e;var r=zO(WO(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),yl(HO(r))}var mw=6,$O=15,VO=1,yr=mw;function wl(e){return Math.floor((e+Math.round(128/yr)/256)*yr)}function _l(e){return Math.floor((e-5)/yr*100+.5)/100}function Au(e){return Math.round((e*yr+5)/yr*256)/256}function eh(e){return Au(_l(wl(e)))}function ep(e){var t=Math.abs(e-eh(e)),r=yr;if(t>.005)for(yr=VO;yr<$O;++yr)Math.abs(e-eh(e))<=t&&(t=Math.abs(e-eh(e)),r=yr);yr=r}function Xi(e){e.width?(e.wpx=wl(e.width),e.wch=_l(e.wpx),e.MDW=yr):e.wpx?(e.wch=_l(e.wpx),e.width=Au(e.wch),e.MDW=yr):typeof e.wch=="number"&&(e.width=Au(e.wch),e.wpx=wl(e.width),e.MDW=yr),e.customWidth&&delete e.customWidth}var XO=96,xw=XO;function bl(e){return e*96/xw}function Ha(e){return e*xw/96}var YO={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function GO(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(kr)||[]).forEach(function(l){var o=Xe(l);switch(Hn(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=vt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=vt(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function qO(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(kr)||[]).forEach(function(l){var o=Xe(l);switch(Hn(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function KO(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(kr)||[]).forEach(function(l){var o=Xe(l);switch(Hn(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=dt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?vt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?vt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?vt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?vt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?vt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?vt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?vt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=N0[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=vt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var a=ws[i.color.index];i.color.index==81&&(a=ws[1]),a||(a=ws[1]),i.color.rgb=a[0].toString(16)+a[1].toString(16)+a[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Nu(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function JO(e,t,r){t.NumberFmt=[];for(var n=It(ze),i=0;i<n.length;++i)t.NumberFmt[n[i]]=ze[n[i]];var s=e[0].match(kr);if(s)for(i=0;i<s.length;++i){var l=Xe(s[i]);switch(Hn(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=it(dt(l.formatCode)),a=parseInt(l.numFmtId,10);if(t.NumberFmt[a]=o,a>0){if(a>392){for(a=392;a>60&&t.NumberFmt[a]!=null;--a);t.NumberFmt[a]=o}ri(o,a)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function QO(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ne("numFmt",null,{numFmtId:n,formatCode:ft(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ne("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Sc=["numFmtId","fillId","fontId","borderId","xfId"],kc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function ZO(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(kr)||[]).forEach(function(s){var l=Xe(s),o=0;switch(Hn(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],o=0;o<Sc.length;++o)n[Sc[o]]&&(n[Sc[o]]=parseInt(n[Sc[o]],10));for(o=0;o<kc.length;++o)n[kc[o]]&&(n[kc[o]]=vt(n[kc[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var a={};l.vertical&&(a.vertical=l.vertical),l.horizontal&&(a.horizontal=l.horizontal),l.textRotation!=null&&(a.textRotation=l.textRotation),l.indent&&(a.indent=l.indent),l.wrapText&&(a.wrapText=vt(l.wrapText)),n.alignment=a;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function e3(e){var t=[];return t[t.length]=Ne("cellXfs",null),e.forEach(function(r){t[t.length]=Ne("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ne("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var t3=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,a,c){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&JO(f,d,c),(f=o.match(i))&&KO(f,d,a,c),(f=o.match(n))&&qO(f,d,a,c),(f=o.match(s))&&GO(f,d,a,c),(f=o.match(r))&&ZO(f,d,c),d}}();function vw(e,t){var r=[Ut,Ne("styleSheet",null,{xmlns:Ls[0],"xmlns:vt":qt.vt})],n;return e.SSF&&(n=QO(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=e3(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function r3(e,t){var r=e.read_shift(2),n=_r(e);return[r,n]}function n3(e,t,r){r||(r=me(6+4*t.length)),r.write_shift(2,e),tr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function i3(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=B4(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var o=e.read_shift(1);o>0&&(n.family=o);var a=e.read_shift(1);switch(a>0&&(n.charset=a),e.l++,n.color=L4(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=_r(e),n}function s3(e,t){t||(t=me(25+4*32)),t.write_shift(2,e.sz*20),U4(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Cu(e.color,t);var n=0;return n=2,t.write_shift(1,n),tr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var a3=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],th,o3=Sr;function Xm(e,t){t||(t=me(4*3+8*7+16*1)),th||(th=ef(a3));var r=th[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Cu({auto:1},t),Cu({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function l3(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function yw(e,t,r){r||(r=me(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function fo(e,t){return t||(t=me(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var c3=Sr;function u3(e,t){return t||(t=me(51)),t.write_shift(1,0),fo(null,t),fo(null,t),fo(null,t),fo(null,t),fo(null,t),t.length>t.l?t.slice(0,t.l):t}function f3(e,t){return t||(t=me(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),ku(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function h3(e,t,r){var n=me(2052);return n.write_shift(4,e),ku(t,n),ku(r,n),n.length>n.l?n.slice(0,n.l):n}function d3(e,t,r){var n={};n.NumberFmt=[];for(var i in ze)n.NumberFmt[i]=ze[i];n.CellXf=[],n.Fonts=[];var s=[],l=!1;return pi(e,function(a,c,d){switch(d){case 44:n.NumberFmt[a[0]]=a[1],ri(a[1],a[0]);break;case 43:n.Fonts.push(a),a.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=Nu(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(a);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(d),l=!0;break;case 38:s.pop(),l=!1;break;default:if(c.T>0)s.push(d);else if(c.T<0)s.pop();else if(!l||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function p3(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(be(e,615,An(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&be(e,44,n3(i,t[i]))}),be(e,616))}}function g3(e){var t=1;be(e,611,An(t)),be(e,43,s3({sz:12,color:{theme:1},name:"Calibri",family:2})),be(e,612)}function m3(e){var t=2;be(e,603,An(t)),be(e,45,Xm({patternType:"none"})),be(e,45,Xm({patternType:"gray125"})),be(e,604)}function x3(e){var t=1;be(e,613,An(t)),be(e,46,u3()),be(e,614)}function v3(e){var t=1;be(e,626,An(t)),be(e,47,yw({numFmtId:0},65535)),be(e,627)}function y3(e,t){be(e,617,An(t.length)),t.forEach(function(r){be(e,47,yw(r,0))}),be(e,618)}function w3(e){var t=1;be(e,619,An(t)),be(e,48,f3({xfId:0,name:"Normal"})),be(e,620)}function _3(e){var t=0;be(e,505,An(t)),be(e,506)}function b3(e){var t=0;be(e,508,h3(t,"TableStyleMedium9","PivotStyleMedium4")),be(e,509)}function S3(e,t){var r=Lr();return be(r,278),p3(r,e.SSF),g3(r),m3(r),x3(r),v3(r),y3(r,t.cellXfs),w3(r),_3(r),b3(r),be(r,279),r.end()}var k3=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function C3(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(kr)||[]).forEach(function(i){var s=Xe(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[k3.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function T3(){}function E3(){}var N3=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,A3=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,O3=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function F3(e,t,r){t.themeElements={};var n;[["clrScheme",N3,C3],["fontScheme",A3,T3],["fmtScheme",O3,E3]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var j3=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ww(e,t){(!e||e.length===0)&&(e=tp());var r,n={};if(!(r=e.match(j3)))throw new Error("themeElements not found in theme");return F3(r[0],n,t),n.raw=e,n}function tp(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Ut];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function P3(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var l;try{l=hy(s,{type:"array"})}catch{return}var o=Xr(l,"theme/theme/theme1.xml",!0);if(o)return ww(o,r)}}function D3(e){return e.read_shift(4)}function R3(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=I3(e,4);break;case 2:t.xclrValue=Zy(e);break;case 3:t.xclrValue=D3(e);break;case 4:e.l+=4;break}return e.l+=8,t}function I3(e,t){return Sr(e,t)}function M3(e,t){return Sr(e,t)}function L3(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=R3(e);break;case 6:n[1]=M3(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function B3(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(L3(e,r-e.l));return{ixfe:n,ext:s}}function U3(e,t){t.forEach(function(r){switch(r[0]){}})}function W3(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:_r(e)}}function z3(e){var t=me(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),tr(e.name,t),t.slice(0,t.l)}function H3(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function $3(e){var t=me(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function V3(e,t){var r=me(8+2*t.length);return r.write_shift(4,e),tr(t,r),r.slice(0,r.l)}function X3(e){return e.l+=4,e.read_shift(4)!=0}function Y3(e,t){var r=me(8);return r.write_shift(4,e),r.write_shift(4,1),r}function G3(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],l=!1,o=2;return pi(e,function(a,c,d){switch(d){case 335:n.Types.push({name:a.name});break;case 51:a.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=a?1:0;break;case 338:o=2;break;case 35:s.push(d),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!c.T){if(!l||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function q3(){var e=Lr();return be(e,332),be(e,334,An(1)),be(e,335,z3({name:"XLDAPR",version:12e4,flags:3496657072})),be(e,336),be(e,339,V3(1,"XLDAPR")),be(e,52),be(e,35,An(514)),be(e,4096,An(0)),be(e,4097,an(1)),be(e,36),be(e,53),be(e,340),be(e,337,Y3(1)),be(e,51,$3([[1,0]])),be(e,338),be(e,333),e.end()}function K3(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,l;return e.replace(kr,function(o){var a=Xe(o);switch(Hn(a[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:a.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==a.name&&(l=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[a.t-1].name,index:+a.v}):s==0&&n.Value.push({type:n.Types[a.t-1].name,index:+a.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+a.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+a[0]+" in metadata")}return o}),n}function _w(){var e=[Ut];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function J3(e){var t=[];if(!e)return t;var r=1;return(e.match(kr)||[]).forEach(function(n){var i=Xe(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function Q3(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ve(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Z3(e,t,r){var n=[];return pi(e,function(s,l,o){switch(o){case 63:n.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function eF(e,t,r,n){if(!e)return e;var i=n||{},s=!1;pi(e,function(o,a,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!a.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function tF(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var ya=1024;function bw(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Ne("xml",null,{"xmlns:v":Hr.v,"xmlns:o":Hr.o,"xmlns:x":Hr.x,"xmlns:mv":Hr.mv}).replace(/\/>/,">"),Ne("o:shapelayout",Ne("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ne("v:shapetype",[Ne("v:stroke",null,{joinstyle:"miter"}),Ne("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];ya<e*1e3;)ya+=1e3;return t.forEach(function(s){var l=At(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var a=o.type=="gradient"?Ne("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Ne("v:fill",a,o),d={on:"t",obscured:"t"};++ya,i=i.concat(["<v:shape"+ml({id:"_x0000_s"+ya,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Ne("v:shadow",null,d),Ne("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",lr("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),lr("x:AutoFill","False"),lr("x:Row",String(l.r)),lr("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Ym(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(l){var o=At(l.ref);if(i?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[l.ref],!s){s={t:"z"},i?e[o.r][o.c]=s:e[l.ref]=s;var a=st(e["!ref"]||"BDWGO1000001:A1");a.s.r>o.r&&(a.s.r=o.r),a.e.r<o.r&&(a.e.r=o.r),a.s.c>o.c&&(a.s.c=o.c),a.e.c<o.c&&(a.e.c=o.c);var c=Ke(a);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var d={a:l.author,t:l.t,r:l.r,T:r};l.h&&(d.h=l.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}s.c.push(d)})}function rF(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?comment[^>]*>/);if(o){var a=Xe(o[0]),c={author:a.authorId&&r[a.authorId]||"sheetjsghost",ref:a.ref,guid:a.guid},d=At(a.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&Q0(f[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function Sw(e){var t=[Ut,Ne("comments",null,{xmlns:Ls[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=ft(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(a){a.a&&(i=r.indexOf(ft(a.a))),s.push(a.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(lr("t",ft(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)l+=`Reply:
    `+s[o]+`
`;t.push(lr("t",ft(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function nF(e,t){var r=[],n=!1,i={},s=0;return e.replace(kr,function(o,a){var c=Xe(o);switch(Hn(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=a+o.length;break;case"</text>":i.t=e.slice(s,a).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function iF(e,t,r){var n=[Ut,Ne("ThreadedComments",null,{xmlns:qt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var a={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=a.id:a.parentId=s,l.ID=a.id,l.a&&(a.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),n.push(Ne("threadedComment",lr("text",l.t||""),a))})}),n.push("</ThreadedComments>"),n.join("")}function sF(e,t){var r=[],n=!1;return e.replace(kr,function(s){var l=Xe(s);switch(Hn(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),r}function aF(e){var t=[Ut,Ne("personList",null,{xmlns:qt.TCMNT,"xmlns:x":Ls[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ne("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function oF(e){var t={};t.iauthor=e.read_shift(4);var r=zs(e);return t.rfx=r.s,t.ref=Ve(r.s),e.l+=16,t}function lF(e,t){return t==null&&(t=me(36)),t.write_shift(4,e[1].iauthor),Qa(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var cF=_r;function uF(e){return tr(e.slice(0,54))}function fF(e,t){var r=[],n=[],i={},s=!1;return pi(e,function(o,a,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!a.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function hF(e){var t=Lr(),r=[];return be(t,628),be(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),be(t,632,uF(i.a)))})}),be(t,631),be(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:At(n[0]),e:At(n[0])};be(t,635,lF([s,i])),i.t&&i.t.length>0&&be(t,637,D4(i)),be(t,636),delete i.iauthor})}),be(t,634),be(t,629),t.end()}var dF="application/vnd.ms-office.vbaProject";function pF(e){var t=Le.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Le.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Le.write(t)}function gF(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Le.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var kw=["xlsb","xlsm","xlam","biff8","xla"];function mF(){return{"!type":"dialog"}}function xF(){return{"!type":"dialog"}}function vF(){return{"!type":"macro"}}function yF(){return{"!type":"macro"}}var Oa=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,l){var o=!1,a=!1;s.length==0?a=!0:s.charAt(0)=="["&&(a=!0,s=s.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,d=l.length>0?parseInt(l,10)|0:0;return o?d+=t.c:--d,a?c+=t.r:--c,i+(o?"":"$")+Nt(d)+(a?"":"$")+Bt(c)}return function(i,s){return t=s,i.replace(e,r)}}(),rp=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,np=function(){return function(t,r){return t.replace(rp,function(n,i,s,l,o,a){var c=H0(l)-(s?0:r.c),d=z0(a)-(o?0:r.r),f=d==0?"":o?d+1:"["+d+"]",h=c==0?"":s?c+1:"["+c+"]";return i+"R"+f+"C"+h})}}();function Cw(e,t){return e.replace(rp,function(r,n,i,s,l,o){return n+(i=="$"?i+s:Nt(H0(s)+t.c))+(l=="$"?l+o:Bt(z0(o)+t.r))})}function wF(e,t,r){var n=Br(t),i=n.s,s=At(r),l={r:s.r-i.r,c:s.c-i.c};return Cw(e,l)}function _F(e){return e.length!=1}function Gm(e){return e.replace(/_xlfn\./g,"")}function Wt(e){e.l+=1}function Yi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Tw(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Ew(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),l=Yi(e),o=Yi(e);return{s:{r:i,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Ew(e){var t=Yi(e),r=Yi(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function bF(e,t,r){if(r.biff<8)return Ew(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=Yi(e),l=Yi(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function Nw(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return SF(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Yi(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function SF(e){var t=Yi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function kF(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function CF(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return TF(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),l=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:l,rRel:o}}function TF(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function EF(e,t,r){var n=(e[e.l++]&96)>>5,i=Tw(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function NF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var l=Tw(e,s,r);return[n,i,l]}function AF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function OF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function FF(e,t,r){var n=(e[e.l++]&96)>>5,i=bF(e,t-1,r);return[n,i]}function jF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function qm(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function PF(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function DF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function RF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function IF(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function MF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Aw(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function LF(e){return e.read_shift(2),Aw(e)}function BF(e){return e.read_shift(2),Aw(e)}function UF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=Nw(e,0,r);return[n,i]}function WF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=CF(e,0,r);return[n,i]}function zF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=Nw(e,0,r);return[n,i,s]}function HF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[Xj[i],jw[i],n]}function $F(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:VF(e);return[i,(s[0]===0?jw:Vj)[s[1]]]}function VF(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function XF(e,t,r){e.l+=r&&r.biff==2?3:4}function YF(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function GF(e){return e.l++,gi[e.read_shift(1)]}function qF(e){return e.l++,e.read_shift(2)}function KF(e){return e.l++,e.read_shift(1)!==0}function JF(e){return e.l++,wr(e)}function QF(e,t,r){return e.l++,Ll(e,t-1,r)}function ZF(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Mt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=gi[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=wr(e);break;case 2:r[1]=Hs(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function ej(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?zs:nf)(e));return i}function tj(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,l=[];s!=n&&(l[s]=[]);++s)for(var o=0;o!=i;++o)l[s][o]=ZF(e,r.biff);return l}function rj(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function nj(e,t,r){if(r.biff==5)return ij(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function ij(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function sj(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function aj(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function oj(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function lj(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var cj=Sr,uj=Sr,fj=Sr;function Ul(e,t,r){return e.l+=2,[kF(e)]}function ip(e){return e.l+=6,[]}var hj=Ul,dj=ip,pj=ip,gj=Ul;function Ow(e){return e.l+=2,[Ht(e),e.read_shift(2)&1]}var mj=Ul,xj=Ow,vj=ip,yj=Ul,wj=Ul,_j=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function bj(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),l=_j[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:n,c:i,C:s}}function Sj(e){return e.l+=2,[e.read_shift(4)]}function kj(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Cj(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Tj(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Ej(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Nj(e){return e.l+=4,[0,0]}var Km={1:{n:"PtgExp",f:YF},2:{n:"PtgTbl",f:fj},3:{n:"PtgAdd",f:Wt},4:{n:"PtgSub",f:Wt},5:{n:"PtgMul",f:Wt},6:{n:"PtgDiv",f:Wt},7:{n:"PtgPower",f:Wt},8:{n:"PtgConcat",f:Wt},9:{n:"PtgLt",f:Wt},10:{n:"PtgLe",f:Wt},11:{n:"PtgEq",f:Wt},12:{n:"PtgGe",f:Wt},13:{n:"PtgGt",f:Wt},14:{n:"PtgNe",f:Wt},15:{n:"PtgIsect",f:Wt},16:{n:"PtgUnion",f:Wt},17:{n:"PtgRange",f:Wt},18:{n:"PtgUplus",f:Wt},19:{n:"PtgUminus",f:Wt},20:{n:"PtgPercent",f:Wt},21:{n:"PtgParen",f:Wt},22:{n:"PtgMissArg",f:Wt},23:{n:"PtgStr",f:QF},26:{n:"PtgSheet",f:kj},27:{n:"PtgEndSheet",f:Cj},28:{n:"PtgErr",f:GF},29:{n:"PtgBool",f:KF},30:{n:"PtgInt",f:qF},31:{n:"PtgNum",f:JF},32:{n:"PtgArray",f:jF},33:{n:"PtgFunc",f:HF},34:{n:"PtgFuncVar",f:$F},35:{n:"PtgName",f:rj},36:{n:"PtgRef",f:UF},37:{n:"PtgArea",f:EF},38:{n:"PtgMemArea",f:sj},39:{n:"PtgMemErr",f:cj},40:{n:"PtgMemNoMem",f:uj},41:{n:"PtgMemFunc",f:aj},42:{n:"PtgRefErr",f:oj},43:{n:"PtgAreaErr",f:AF},44:{n:"PtgRefN",f:WF},45:{n:"PtgAreaN",f:FF},46:{n:"PtgMemAreaN",f:Tj},47:{n:"PtgMemNoMemN",f:Ej},57:{n:"PtgNameX",f:nj},58:{n:"PtgRef3d",f:zF},59:{n:"PtgArea3d",f:NF},60:{n:"PtgRefErr3d",f:lj},61:{n:"PtgAreaErr3d",f:OF},255:{}},Aj={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Oj={1:{n:"PtgElfLel",f:Ow},2:{n:"PtgElfRw",f:yj},3:{n:"PtgElfCol",f:hj},6:{n:"PtgElfRwV",f:wj},7:{n:"PtgElfColV",f:gj},10:{n:"PtgElfRadical",f:mj},11:{n:"PtgElfRadicalS",f:vj},13:{n:"PtgElfColS",f:dj},15:{n:"PtgElfColSV",f:pj},16:{n:"PtgElfRadicalLel",f:xj},25:{n:"PtgList",f:bj},29:{n:"PtgSxName",f:Sj},255:{}},Fj={0:{n:"PtgAttrNoop",f:Nj},1:{n:"PtgAttrSemi",f:MF},2:{n:"PtgAttrIf",f:RF},4:{n:"PtgAttrChoose",f:PF},8:{n:"PtgAttrGoto",f:DF},16:{n:"PtgAttrSum",f:XF},32:{n:"PtgAttrBaxcel",f:qm},33:{n:"PtgAttrBaxcel",f:qm},64:{n:"PtgAttrSpace",f:LF},65:{n:"PtgAttrSpaceSemi",f:BF},128:{n:"PtgAttrIfError",f:IF},255:{}};function Wl(e,t,r,n){if(n.biff<8)return Sr(e,t);for(var i=e.l+t,s=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=tj(e,0,n),s.push(r[l][1]);break;case"PtgMemArea":r[l][2]=ej(e,r[l][1],n),s.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=e.read_shift(4),s.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=i-e.l,t!==0&&s.push(Sr(e,t)),s}function zl(e,t,r){for(var n=e.l+t,i,s,l=[];n!=e.l;)t=n-e.l,s=e[e.l],i=Km[s]||Km[Aj[s]],(s===24||s===25)&&(i=(s===24?Oj:Fj)[e[e.l+1]]),!i||!i.f?Sr(e,t):l.push([i.n,i.f(e,t,r)]);return l}function jj(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var l=n[s];if(l)switch(l[0]){case 2:i.push('"'+l[1].replace(/"/g,'""')+'"');break;default:i.push(l[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var Pj={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Dj(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Fw(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Jm(e,t,r){var n=Fw(e,t,r);return n=="#REF"?n:Dj(n,r)}function xr(e,t,r,n,i){var s=i&&i.biff||8,l={s:{c:0,r:0}},o=[],a,c,d,f=0,h=0,u,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",x=0,v=e[0].length;x<v;++x){var w=e[0][x];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(a=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=Dt(" ",e[0][m][1][1]);break;case 1:g=Dt("\r",e[0][m][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+g,m=-1}o.push(c+Pj[w[0]]+a);break;case"PtgIsect":a=o.pop(),c=o.pop(),o.push(c+" "+a);break;case"PtgUnion":a=o.pop(),c=o.pop(),o.push(c+","+a);break;case"PtgRange":a=o.pop(),c=o.pop(),o.push(c+":"+a);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Do(w[1][1],l,i),o.push(Ro(d,s));break;case"PtgRefN":d=r?Do(w[1][1],r,i):w[1][1],o.push(Ro(d,s));break;case"PtgRef3d":f=w[1][1],d=Do(w[1][2],l,i),p=Jm(n,f,i),o.push(p+"!"+Ro(d,s));break;case"PtgFunc":case"PtgFuncVar":var _=w[1][0],b=w[1][1];_||(_=0),_&=127;var k=_==0?[]:o.slice(-_);o.length-=_,b==="User"&&(b=k.shift()),o.push(b+"("+k.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":u=Tm(w[1][1],r?{s:r}:l,i),o.push(Jf(u,i));break;case"PtgArea":u=Tm(w[1][1],l,i),o.push(Jf(u,i));break;case"PtgArea3d":f=w[1][1],u=w[1][2],p=Jm(n,f,i),o.push(p+"!"+Jf(u,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=w[1][2];var S=(n.names||[])[h-1]||(n[0]||[])[h],O=S?S.Name:"SH33TJSNAME"+String(h);O&&O.slice(0,6)=="_xlfn."&&!i.xlfn&&(O=O.slice(6)),o.push(O);break;case"PtgNameX":var F=w[1][1];h=w[1][2];var D;if(i.biff<=5)F<0&&(F=-F),n[F]&&(D=n[F][h]);else{var U="";if(((n[F]||[])[0]||[])[0]==14849||(((n[F]||[])[0]||[])[0]==1025?n[F][h]&&n[F][h].itab>0&&(U=n.SheetNames[n[F][h].itab-1]+"!"):U=n.SheetNames[h-1]+"!"),n[F]&&n[F][h])U+=n[F][h].Name;else if(n[0]&&n[0][h])U+=n[0][h].Name;else{var M=(Fw(n,F,i)||"").split(";;");M[h-1]?U=M[h-1]:U+="SH33TJSERRX"}o.push(U);break}D||(D={Name:"SH33TJSERRY"}),o.push(D.Name);break;case"PtgParen":var q="(",G=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:q=Dt(" ",e[0][m][1][1])+q;break;case 3:q=Dt("\r",e[0][m][1][1])+q;break;case 4:G=Dt(" ",e[0][m][1][1])+G;break;case 5:G=Dt("\r",e[0][m][1][1])+G;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(q+o.pop()+G);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:w[1][1],r:w[1][0]};var Q={c:r.c,r:r.r};if(n.sharedf[Ve(d)]){var K=n.sharedf[Ve(d)];o.push(xr(K,l,Q,n,i))}else{var ne=!1;for(a=0;a!=n.arrayf.length;++a)if(c=n.arrayf[a],!(d.c<c[0].s.c||d.c>c[0].e.c)&&!(d.r<c[0].s.r||d.r>c[0].e.r)){o.push(xr(c[1],l,Q,n,i)),ne=!0;break}ne||o.push(w[1])}break;case"PtgArray":o.push("{"+jj(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var J=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&J.indexOf(e[0][x][0])==-1){w=e[0][m];var T=!0;switch(w[1][0]){case 4:T=!1;case 0:g=Dt(" ",w[1][1]);break;case 5:T=!1;case 1:g=Dt("\r",w[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((T?g:"")+o.pop()+(T?"":g)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function Rj(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,l=e.read_shift(i);if(l==65535)return[[],Sr(e,t-2)];var o=zl(e,l,r);return t!==l+i&&(s=Wl(e,t-l-i,o,r)),e.l=n,[o,s]}function Ij(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,l=e.read_shift(i);if(l==65535)return[[],Sr(e,t-2)];var o=zl(e,l,r);return t!==l+i&&(s=Wl(e,t-l-i,o,r)),e.l=n,[o,s]}function Mj(e,t,r,n){var i=e.l+t,s=zl(e,n,r),l;return i!==e.l&&(l=Wl(e,i-e.l,s,r)),[s,l]}function Lj(e,t,r){var n=e.l+t,i,s=e.read_shift(2),l=zl(e,s,r);return s==65535?[[],Sr(e,t-2)]:(t!==s+2&&(i=Wl(e,n-s-2,l,r)),[l,i])}function Bj(e){var t;if(Jn(e,e.l+6)!==65535)return[wr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Uj(e){if(e==null){var t=me(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return js(e);return js(0)}function rh(e,t,r){var n=e.l+t,i=$n(e);r.biff==2&&++e.l;var s=Bj(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Ij(e,n-e.l,r);return{cell:i,val:s[0],formula:o,shared:l>>3&1,tt:s[1]}}function Wj(e,t,r,n,i){var s=Ds(t,r,i),l=Uj(e.v),o=me(6),a=33;o.write_shift(2,a),o.write_shift(4,0);for(var c=me(e.bf.length),d=0;d<e.bf.length;++d)c[d]=e.bf[d];var f=er([s,l,o,c]);return f}function sf(e,t,r){var n=e.read_shift(4),i=zl(e,n,r),s=e.read_shift(4),l=s>0?Wl(e,s,i,r):null;return[i,l]}var zj=sf,af=sf,Hj=sf,$j=sf,Vj={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},jw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Xj={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Qm(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Yj(e){var t="of:="+e.replace(rp,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function nh(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Gj(e){return e.replace(/\./,"!")}var Mo={},Fa={},Lo=typeof Map<"u";function sp(e,t,r){var n=0,i=e.length;if(r){if(Lo?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Lo?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(Lo?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function of(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(yr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=_l(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Au(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Ss(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function es(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){ri(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Pw(e,t,r,n,i,s){try{n.cellNF&&(e.z=ze[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=wt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(ze[t]==null&&ri(VE[t]||"General",t),e.t==="e")e.w=e.w||gi[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=pl(e.v);else if(e.t==="d"){var l=Jt(e.v);(l|0)===l?e.w=l.toString(10):e.w=pl(l)}else{if(e.v===void 0)return"";e.w=Os(e.v,Fa)}else e.t==="d"?e.w=pn(t,Jt(e.v),Fa):e.w=pn(t,e.v,Fa)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Nu(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Nu(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function qj(e,t,r){if(e&&e["!ref"]){var n=st(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Kj(e,t){var r=st(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ke(r))}var Jj=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Qj=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Zj=/<(?:\w:)?hyperlink [^>]*>/mg,eP=/"(\w*:\w*)"/,tP=/<(?:\w:)?col\b[^>]*[\/]?>/g,rP=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,nP=/<(?:\w:)?pageMargins[^>]*\/>/g,Dw=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,iP=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,sP=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function aP(e,t,r,n,i,s,l){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},a={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",f=e.match(Qj);f?(c=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):c=d=e;var h=c.match(Dw);h?ap(h[0],o,i,r):(h=c.match(iP))&&lP(h[0],h[1]||"",o,i,r);var u=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(u>0){var p=c.slice(u,u+50).match(eP);p&&Kj(o,p[1])}var m=c.match(sP);m&&m[1]&&_P(m[1],i);var g=[];if(t.cellStyles){var x=c.match(tP);x&&mP(g,x)}f&&kP(f[1],o,t,a,s,l);var v=d.match(rP);v&&(o["!autofilter"]=vP(v[0]));var w=[],_=d.match(Jj);if(_)for(u=0;u!=_.length;++u)w[u]=st(_[u].slice(_[u].indexOf('"')+1));var b=d.match(Zj);b&&dP(o,b,n);var k=d.match(nP);if(k&&(o["!margins"]=pP(Xe(k[0]))),!o["!ref"]&&a.e.c>=a.s.c&&a.e.r>=a.s.r&&(o["!ref"]=Ke(a)),t.sheetRows>0&&o["!ref"]){var S=st(o["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>a.e.r&&(S.e.r=a.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>a.e.c&&(S.e.c=a.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ke(S))}return g.length>0&&(o["!cols"]=g),w.length>0&&(o["!merges"]=w),o}function oP(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ke(e[r])+'"/>';return t+"</mergeCells>"}function ap(e,t,r,n){var i=Xe(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=it(dt(i.codeName)))}function lP(e,t,r,n,i){ap(e.slice(0,e.indexOf(">")),r,n,i)}function cP(e,t,r,n,i){var s=!1,l={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var a=t.SheetNames[r];try{t.Workbook&&(a=t.Workbook.Sheets[r].CodeName||a)}catch{}s=!0,l.codeName=Un(ft(a))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+Ne("outlinePr",null,c)}!s&&!o||(i[i.length]=Ne("sheetPr",o,l))}var uP=["objects","scenarios","selectLockedCells","selectUnlockedCells"],fP=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function hP(e){var t={sheet:1};return uP.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),fP.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Z0(e.password).toString(16).toUpperCase()),Ne("sheetProtection",null,t)}function dP(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=Xe(dt(t[i]),!0);if(!s.ref)return;var l=((r||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+it(s.location))):(s.Target="#"+it(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=st(s.ref),a=o.s.r;a<=o.e.r;++a)for(var c=o.s.c;c<=o.e.c;++c){var d=Ve({c,r:a});n?(e[a]||(e[a]=[]),e[a][c]||(e[a][c]={t:"z",v:void 0}),e[a][c].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}function pP(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function gP(e){return Ss(e),Ne("pageMargins",null,e)}function mP(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Xe(t[n],!0);i.hidden&&(i.hidden=vt(i.hidden));var s=parseInt(i.min,10)-1,l=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,ep(i.width)),Xi(i);s<=l;)e[s++]=_t(i)}}function xP(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=Ne("col",null,of(i,n)));return r[r.length]="</cols>",r.join("")}function vP(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function yP(e,t,r,n){var i=typeof e.ref=="string"?e.ref:Ke(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=Br(i);l.s.r==l.e.r&&(l.e.r=Br(t["!ref"]).e.r,i=Ke(l));for(var o=0;o<s.length;++o){var a=s[o];if(a.Name=="_xlnm._FilterDatabase"&&a.Sheet==n){a.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ne("autoFilter",null,{ref:i})}var wP=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function _P(e,t){t.Views||(t.Views=[{}]),(e.match(wP)||[]).forEach(function(r,n){var i=Xe(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),vt(i.rightToLeft)&&(t.Views[n].RTL=!0)})}function bP(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ne("sheetViews",Ne("sheetView",null,i),{})}function SP(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=gi[e.v];break;case"d":n&&n.cellDates?i=wt(e.v,-1).toISOString():(e=_t(e),e.t="n",i=""+(e.v=Jt(wt(e.v)))),typeof e.z>"u"&&(e.z=ze[14]);break;default:i=e.v;break}var o=lr("v",ft(i)),a={r:t},c=es(n.cellXfs,e,n);switch(c!==0&&(a.s=c),e.t){case"n":break;case"d":a.t="d";break;case"b":a.t="b";break;case"e":a.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=lr("v",""+sp(n.Strings,e.v,n.revStrings)),a.t="s";break}a.t="str";break}if(e.t!=s&&(e.t=s,e.v=l),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Ne("f",ft(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(a.cm=1),Ne("c",o,a)}var kP=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=gl("v"),l=gl("f");return function(a,c,d,f,h,u){for(var p=0,m="",g=[],x=[],v=0,w=0,_=0,b="",k,S,O=0,F=0,D,U,M=0,q=0,G=Array.isArray(u.CellXf),Q,K=[],ne=[],J=Array.isArray(c),T=[],j={},B=!1,E=!!d.sheetStubs,R=a.split(t),N=0,C=R.length;N!=C;++N){m=R[N].trim();var P=m.length;if(P!==0){var I=0;e:for(p=0;p<P;++p)switch(m[p]){case">":if(m[p-1]!="/"){++p;break e}if(d&&d.cellStyles){if(S=Xe(m.slice(I,p),!0),O=S.r!=null?parseInt(S.r,10):O+1,F=-1,d.sheetRows&&d.sheetRows<O)continue;j={},B=!1,S.ht&&(B=!0,j.hpt=parseFloat(S.ht),j.hpx=Ha(j.hpt)),S.hidden=="1"&&(B=!0,j.hidden=!0),S.outlineLevel!=null&&(B=!0,j.level=+S.outlineLevel),B&&(T[O-1]=j)}break;case"<":I=p;break}if(I>=p)break;if(S=Xe(m.slice(I,p),!0),O=S.r!=null?parseInt(S.r,10):O+1,F=-1,!(d.sheetRows&&d.sheetRows<O)){f.s.r>O-1&&(f.s.r=O-1),f.e.r<O-1&&(f.e.r=O-1),d&&d.cellStyles&&(j={},B=!1,S.ht&&(B=!0,j.hpt=parseFloat(S.ht),j.hpx=Ha(j.hpt)),S.hidden=="1"&&(B=!0,j.hidden=!0),S.outlineLevel!=null&&(B=!0,j.level=+S.outlineLevel),B&&(T[O-1]=j)),g=m.slice(p).split(e);for(var H=0;H!=g.length&&g[H].trim().charAt(0)=="<";++H);for(g=g.slice(H),p=0;p!=g.length;++p)if(m=g[p].trim(),m.length!==0){if(x=m.match(r),v=p,w=0,_=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,x!=null&&x.length===2){for(v=0,b=x[1],w=0;w!=b.length&&!((_=b.charCodeAt(w)-64)<1||_>26);++w)v=26*v+_;--v,F=v}else++F;for(w=0;w!=m.length&&m.charCodeAt(w)!==62;++w);if(++w,S=Xe(m.slice(0,w),!0),S.r||(S.r=Ve({r:O-1,c:F})),b=m.slice(w),k={t:""},(x=b.match(s))!=null&&x[1]!==""&&(k.v=it(x[1])),d.cellFormula){if((x=b.match(l))!=null&&x[1]!==""){if(k.f=it(dt(x[1])).replace(/\r\n/g,`
`),d.xlfn||(k.f=Gm(k.f)),x[0].indexOf('t="array"')>-1)k.F=(b.match(i)||[])[1],k.F.indexOf(":")>-1&&K.push([st(k.F),k.F]);else if(x[0].indexOf('t="shared"')>-1){U=Xe(x[0]);var L=it(dt(x[1]));d.xlfn||(L=Gm(L)),ne[parseInt(U.si,10)]=[U,L,S.r]}}else(x=b.match(/<f[^>]*\/>/))&&(U=Xe(x[0]),ne[U.si]&&(k.f=wF(ne[U.si][1],ne[U.si][2],S.r)));var z=At(S.r);for(w=0;w<K.length;++w)z.r>=K[w][0].s.r&&z.r<=K[w][0].e.r&&z.c>=K[w][0].s.c&&z.c<=K[w][0].e.c&&(k.F=K[w][1])}if(S.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(E)k.t="z";else continue;else k.t=S.t||"n";switch(f.s.c>F&&(f.s.c=F),f.e.c<F&&(f.e.c=F),k.t){case"n":if(k.v==""||k.v==null){if(!E)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!E)continue;k.t="z"}else D=Mo[parseInt(k.v,10)],k.v=D.t,k.r=D.r,d.cellHTML&&(k.h=D.h);break;case"str":k.t="s",k.v=k.v!=null?dt(k.v):"",d.cellHTML&&(k.h=L0(k.v));break;case"inlineStr":x=b.match(n),k.t="s",x!=null&&(D=Q0(x[1]))?(k.v=D.t,d.cellHTML&&(k.h=D.h)):k.v="";break;case"b":k.v=vt(k.v);break;case"d":d.cellDates?k.v=wt(k.v,1):(k.v=Jt(wt(k.v,1)),k.t="n");break;case"e":(!d||d.cellText!==!1)&&(k.w=k.v),k.v=Iy[k.v];break}if(M=q=0,Q=null,G&&S.s!==void 0&&(Q=u.CellXf[S.s],Q!=null&&(Q.numFmtId!=null&&(M=Q.numFmtId),d.cellStyles&&Q.fillId!=null&&(q=Q.fillId))),Pw(k,M,q,d,h,u),d.cellDates&&G&&k.t=="n"&&qa(ze[M])&&(k.t="d",k.v=rf(k.v)),S.cm&&d.xlmeta){var ee=(d.xlmeta.Cell||[])[+S.cm-1];ee&&ee.type=="XLDAPR"&&(k.D=!0)}if(J){var A=At(S.r);c[A.r]||(c[A.r]=[]),c[A.r][A.c]=k}else c[S.r]=k}}}}T.length>0&&(c["!rows"]=T)}}();function CP(e,t,r,n){var i=[],s=[],l=st(e["!ref"]),o="",a,c="",d=[],f=0,h=0,u=e["!rows"],p=Array.isArray(e),m={r:c},g,x=-1;for(h=l.s.c;h<=l.e.c;++h)d[h]=Nt(h);for(f=l.s.r;f<=l.e.r;++f){for(s=[],c=Bt(f),h=l.s.c;h<=l.e.c;++h){a=d[h]+c;var v=p?(e[f]||[])[h]:e[a];v!==void 0&&(o=SP(v,a,e,t))!=null&&s.push(o)}(s.length>0||u&&u[f])&&(m={r:c},u&&u[f]&&(g=u[f],g.hidden&&(m.hidden=1),x=-1,g.hpx?x=bl(g.hpx):g.hpt&&(x=g.hpt),x>-1&&(m.ht=x,m.customHeight=1),g.level&&(m.outlineLevel=g.level)),i[i.length]=Ne("row",s.join(""),m))}if(u)for(;f<u.length;++f)u&&u[f]&&(m={r:f+1},g=u[f],g.hidden&&(m.hidden=1),x=-1,g.hpx?x=bl(g.hpx):g.hpt&&(x=g.hpt),x>-1&&(m.ht=x,m.customHeight=1),g.level&&(m.outlineLevel=g.level),i[i.length]=Ne("row","",m));return i.join("")}function Rw(e,t,r,n){var i=[Ut,Ne("worksheet",null,{xmlns:Ls[0],"xmlns:r":qt.r})],s=r.SheetNames[e],l=0,o="",a=r.Sheets[s];a==null&&(a={});var c=a["!ref"]||"A1",d=st(c);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=Ke(d)}n||(n={}),a["!comments"]=[];var f=[];cP(a,r,e,t,i),i[i.length]=Ne("dimension",null,{ref:c}),i[i.length]=bP(a,t,e,r),t.sheetFormat&&(i[i.length]=Ne("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),a["!cols"]!=null&&a["!cols"].length>0&&(i[i.length]=xP(a,a["!cols"])),i[l=i.length]="<sheetData/>",a["!links"]=[],a["!ref"]!=null&&(o=CP(a,t),o.length>0&&(i[i.length]=o)),i.length>l+1&&(i[i.length]="</sheetData>",i[l]=i[l].replace("/>",">")),a["!protect"]&&(i[i.length]=hP(a["!protect"])),a["!autofilter"]!=null&&(i[i.length]=yP(a["!autofilter"],a,r,e)),a["!merges"]!=null&&a["!merges"].length>0&&(i[i.length]=oP(a["!merges"]));var h=-1,u,p=-1;return a["!links"].length>0&&(i[i.length]="<hyperlinks>",a["!links"].forEach(function(m){m[1].Target&&(u={ref:m[0]},m[1].Target.charAt(0)!="#"&&(p=ut(n,-1,ft(m[1].Target).replace(/#.*$/,""),Ze.HLINK),u["r:id"]="rId"+p),(h=m[1].Target.indexOf("#"))>-1&&(u.location=ft(m[1].Target.slice(h+1))),m[1].Tooltip&&(u.tooltip=ft(m[1].Tooltip)),i[i.length]=Ne("hyperlink",null,u))}),i[i.length]="</hyperlinks>"),delete a["!links"],a["!margins"]!=null&&(i[i.length]=gP(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=lr("ignoredErrors",Ne("ignoredError",null,{numberStoredAsText:1,sqref:c}))),f.length>0&&(p=ut(n,-1,"../drawings/drawing"+(e+1)+".xml",Ze.DRAW),i[i.length]=Ne("drawing",null,{"r:id":"rId"+p}),a["!drawing"]=f),a["!comments"].length>0&&(p=ut(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ze.VML),i[i.length]=Ne("legacyDrawing",null,{"r:id":"rId"+p}),a["!legacy"]=p),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function TP(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function EP(e,t,r){var n=me(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=bl(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var l=0;i.level&&(l|=i.level),i.hidden&&(l|=16),(i.hpx||i.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var o=0,a=n.l;n.l+=4;for(var c={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,u=d<<10;u<d+1<<10;++u){c.c=u;var p=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Ve(c)];p&&(f<0&&(f=u),h=u)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,h))}var m=n.l;return n.l=a,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function NP(e,t,r,n){var i=EP(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&be(e,0,i)}var AP=zs,OP=Qa;function FP(){}function jP(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=R4(e),r}function PP(e,t,r){r==null&&(r=me(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Cu({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Fy(e,r),r.slice(0,r.l)}function DP(e){var t=gn(e);return[t]}function RP(e,t,r){return r==null&&(r=me(8)),Bs(t,r)}function IP(e){var t=Us(e);return[t]}function MP(e,t,r){return r==null&&(r=me(4)),Ws(t,r)}function LP(e){var t=gn(e),r=e.read_shift(1);return[t,r,"b"]}function BP(e,t,r){return r==null&&(r=me(9)),Bs(t,r),r.write_shift(1,e.v?1:0),r}function UP(e){var t=Us(e),r=e.read_shift(1);return[t,r,"b"]}function WP(e,t,r){return r==null&&(r=me(5)),Ws(t,r),r.write_shift(1,e.v?1:0),r}function zP(e){var t=gn(e),r=e.read_shift(1);return[t,r,"e"]}function HP(e,t,r){return r==null&&(r=me(9)),Bs(t,r),r.write_shift(1,e.v),r}function $P(e){var t=Us(e),r=e.read_shift(1);return[t,r,"e"]}function VP(e,t,r){return r==null&&(r=me(8)),Ws(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function XP(e){var t=gn(e),r=e.read_shift(4);return[t,r,"s"]}function YP(e,t,r){return r==null&&(r=me(12)),Bs(t,r),r.write_shift(4,t.v),r}function GP(e){var t=Us(e),r=e.read_shift(4);return[t,r,"s"]}function qP(e,t,r){return r==null&&(r=me(8)),Ws(t,r),r.write_shift(4,t.v),r}function KP(e){var t=gn(e),r=wr(e);return[t,r,"n"]}function JP(e,t,r){return r==null&&(r=me(16)),Bs(t,r),js(e.v,r),r}function Iw(e){var t=Us(e),r=wr(e);return[t,r,"n"]}function QP(e,t,r){return r==null&&(r=me(12)),Ws(t,r),js(e.v,r),r}function ZP(e){var t=gn(e),r=Y0(e);return[t,r,"n"]}function eD(e,t,r){return r==null&&(r=me(12)),Bs(t,r),jy(e.v,r),r}function tD(e){var t=Us(e),r=Y0(e);return[t,r,"n"]}function rD(e,t,r){return r==null&&(r=me(8)),Ws(t,r),jy(e.v,r),r}function nD(e){var t=gn(e),r=$0(e);return[t,r,"is"]}function iD(e){var t=gn(e),r=_r(e);return[t,r,"str"]}function sD(e,t,r){return r==null&&(r=me(12+4*e.v.length)),Bs(t,r),tr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function aD(e){var t=Us(e),r=_r(e);return[t,r,"str"]}function oD(e,t,r){return r==null&&(r=me(8+4*e.v.length)),Ws(t,r),tr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function lD(e,t,r){var n=e.l+t,i=gn(e);i.r=r["!row"];var s=e.read_shift(1),l=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=af(e,n-e.l,r);l[3]=xr(o,null,i,r.supbooks,r)}else e.l=n;return l}function cD(e,t,r){var n=e.l+t,i=gn(e);i.r=r["!row"];var s=e.read_shift(1),l=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=af(e,n-e.l,r);l[3]=xr(o,null,i,r.supbooks,r)}else e.l=n;return l}function uD(e,t,r){var n=e.l+t,i=gn(e);i.r=r["!row"];var s=wr(e),l=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=af(e,n-e.l,r);l[3]=xr(o,null,i,r.supbooks,r)}else e.l=n;return l}function fD(e,t,r){var n=e.l+t,i=gn(e);i.r=r["!row"];var s=_r(e),l=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=af(e,n-e.l,r);l[3]=xr(o,null,i,r.supbooks,r)}else e.l=n;return l}var hD=zs,dD=Qa;function pD(e,t){return t==null&&(t=me(4)),t.write_shift(4,e),t}function gD(e,t){var r=e.l+t,n=zs(e),i=V0(e),s=_r(e),l=_r(e),o=_r(e);e.l=r;var a={rfx:n,relId:i,loc:s,display:o};return l&&(a.Tooltip=l),a}function mD(e,t){var r=me(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Qa({s:At(e[0]),e:At(e[0])},r),X0("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return tr(i||"",r),tr(e[1].Tooltip||"",r),tr("",r),r.slice(0,r.l)}function xD(){}function vD(e,t,r){var n=e.l+t,i=Py(e),s=e.read_shift(1),l=[i];if(l[2]=s,r.cellFormula){var o=zj(e,n-e.l,r);l[1]=o}else e.l=n;return l}function yD(e,t,r){var n=e.l+t,i=zs(e),s=[i];if(r.cellFormula){var l=$j(e,n-e.l,r);s[1]=l,e.l=n}else e.l=n;return s}function wD(e,t,r){r==null&&(r=me(18));var n=of(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var Mw=["left","right","top","bottom","header","footer"];function _D(e){var t={};return Mw.forEach(function(r){t[r]=wr(e)}),t}function bD(e,t){return t==null&&(t=me(6*8)),Ss(e),Mw.forEach(function(r){js(e[r],t)}),t}function SD(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function kD(e,t,r){r==null&&(r=me(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function CD(e){var t=me(24);return t.write_shift(4,4),t.write_shift(4,1),Qa(e,t),t}function TD(e,t){return t==null&&(t=me(16*4+2)),t.write_shift(2,e.password?Z0(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function ED(){}function ND(){}function AD(e,t,r,n,i,s,l){if(!e)return e;var o=t||{};n||(n={"!id":{}});var a=o.dense?[]:{},c,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,u,p,m,g,x,v,w,_,b,k=[];o.biff=12,o["!row"]=0;var S=0,O=!1,F=[],D={},U=o.supbooks||i.supbooks||[[]];if(U.sharedf=D,U.arrayf=F,U.SheetNames=i.SheetNames||i.Sheets.map(function(J){return J.name}),!o.supbooks&&(o.supbooks=U,i.Names))for(var M=0;M<i.Names.length;++M)U[0][M+1]=i.Names[M];var q=[],G=[],Q=!1;Sl[16]={n:"BrtShortReal",f:Iw};var K;if(pi(e,function(T,j,B){if(!h)switch(B){case 148:c=T;break;case 0:u=T,o.sheetRows&&o.sheetRows<=u.r&&(h=!0),_=Bt(g=u.r),o["!row"]=u.r,(T.hidden||T.hpt||T.level!=null)&&(T.hpt&&(T.hpx=Ha(T.hpt)),G[T.r]=T);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:T[2]},T[2]){case"n":p.v=T[1];break;case"s":w=Mo[T[1]],p.v=w.t,p.r=w.r;break;case"b":p.v=!!T[1];break;case"e":p.v=T[1],o.cellText!==!1&&(p.w=gi[p.v]);break;case"str":p.t="s",p.v=T[1];break;case"is":p.t="s",p.v=T[1].t;break}if((m=l.CellXf[T[0].iStyleRef])&&Pw(p,m.numFmtId,null,o,s,l),x=T[0].c==-1?x+1:T[0].c,o.dense?(a[g]||(a[g]=[]),a[g][x]=p):a[Nt(x)+_]=p,o.cellFormula){for(O=!1,S=0;S<F.length;++S){var E=F[S];u.r>=E[0].s.r&&u.r<=E[0].e.r&&x>=E[0].s.c&&x<=E[0].e.c&&(p.F=Ke(E[0]),O=!0)}!O&&T.length>3&&(p.f=T[3])}if(d.s.r>u.r&&(d.s.r=u.r),d.s.c>x&&(d.s.c=x),d.e.r<u.r&&(d.e.r=u.r),d.e.c<x&&(d.e.c=x),o.cellDates&&m&&p.t=="n"&&qa(ze[m.numFmtId])){var R=gs(p.v);R&&(p.t="d",p.v=new Date(R.y,R.m-1,R.d,R.H,R.M,R.S,R.u))}K&&(K.type=="XLDAPR"&&(p.D=!0),K=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;p={t:"z",v:void 0},x=T[0].c==-1?x+1:T[0].c,o.dense?(a[g]||(a[g]=[]),a[g][x]=p):a[Nt(x)+_]=p,d.s.r>u.r&&(d.s.r=u.r),d.s.c>x&&(d.s.c=x),d.e.r<u.r&&(d.e.r=u.r),d.e.c<x&&(d.e.c=x),K&&(K.type=="XLDAPR"&&(p.D=!0),K=void 0);break;case 176:k.push(T);break;case 49:K=((o.xlmeta||{}).Cell||[])[T-1];break;case 494:var N=n["!id"][T.relId];for(N?(T.Target=N.Target,T.loc&&(T.Target+="#"+T.loc),T.Rel=N):T.relId==""&&(T.Target="#"+T.loc),g=T.rfx.s.r;g<=T.rfx.e.r;++g)for(x=T.rfx.s.c;x<=T.rfx.e.c;++x)o.dense?(a[g]||(a[g]=[]),a[g][x]||(a[g][x]={t:"z",v:void 0}),a[g][x].l=T):(v=Ve({c:x,r:g}),a[v]||(a[v]={t:"z",v:void 0}),a[v].l=T);break;case 426:if(!o.cellFormula)break;F.push(T),b=o.dense?a[g][x]:a[Nt(x)+_],b.f=xr(T[1],d,{r:u.r,c:x},U,o),b.F=Ke(T[0]);break;case 427:if(!o.cellFormula)break;D[Ve(T[0].s)]=T[1],b=o.dense?a[g][x]:a[Nt(x)+_],b.f=xr(T[1],d,{r:u.r,c:x},U,o);break;case 60:if(!o.cellStyles)break;for(;T.e>=T.s;)q[T.e--]={width:T.w/256,hidden:!!(T.flags&1),level:T.level},Q||(Q=!0,ep(T.w/256)),Xi(q[T.e+1]);break;case 161:a["!autofilter"]={ref:Ke(T)};break;case 476:a["!margins"]=T;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),T.name&&(i.Sheets[r].CodeName=T.name),(T.above||T.left)&&(a["!outline"]={above:T.above,left:T.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),T.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!j.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+B.toString(16))}}},o),delete o.supbooks,delete o["!row"],!a["!ref"]&&(d.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(a["!ref"]=Ke(c||d)),o.sheetRows&&a["!ref"]){var ne=st(a["!ref"]);o.sheetRows<=+ne.e.r&&(ne.e.r=o.sheetRows-1,ne.e.r>d.e.r&&(ne.e.r=d.e.r),ne.e.r<ne.s.r&&(ne.s.r=ne.e.r),ne.e.c>d.e.c&&(ne.e.c=d.e.c),ne.e.c<ne.s.c&&(ne.s.c=ne.e.c),a["!fullref"]=a["!ref"],a["!ref"]=Ke(ne))}return k.length>0&&(a["!merges"]=k),q.length>0&&(a["!cols"]=q),G.length>0&&(a["!rows"]=G),a}function OD(e,t,r,n,i,s,l){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=_t(t),t.z=t.z||ze[14],t.v=Jt(wt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var a={r,c:n};switch(a.s=es(i.cellXfs,t,i),t.l&&s["!links"].push([Ve(a),t.l]),t.c&&s["!comments"].push([Ve(a),t.c]),t.t){case"s":case"str":return i.bookSST?(o=sp(i.Strings,t.v,i.revStrings),a.t="s",a.v=o,l?be(e,18,qP(t,a)):be(e,7,YP(t,a))):(a.t="str",l?be(e,17,oD(t,a)):be(e,6,sD(t,a))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?be(e,13,rD(t,a)):be(e,2,eD(t,a)):l?be(e,16,QP(t,a)):be(e,5,JP(t,a)),!0;case"b":return a.t="b",l?be(e,15,WP(t,a)):be(e,4,BP(t,a)),!0;case"e":return a.t="e",l?be(e,14,VP(t,a)):be(e,3,HP(t,a)),!0}return l?be(e,12,MP(t,a)):be(e,1,RP(t,a)),!0}function FD(e,t,r,n){var i=st(t["!ref"]||"A1"),s,l="",o=[];be(e,145);var a=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var d=i.s.r;d<=c;++d){l=Bt(d),NP(e,t,i,d);var f=!1;if(d<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){d===i.s.r&&(o[h]=Nt(h)),s=o[h]+l;var u=a?(t[d]||[])[h]:t[s];if(!u){f=!1;continue}f=OD(e,u,d,h,n,t,f)}}be(e,146)}function jD(e,t){!t||!t["!merges"]||(be(e,177,pD(t["!merges"].length)),t["!merges"].forEach(function(r){be(e,176,dD(r))}),be(e,178))}function PD(e,t){!t||!t["!cols"]||(be(e,390),t["!cols"].forEach(function(r,n){r&&be(e,60,wD(n,r))}),be(e,391))}function DD(e,t){!t||!t["!ref"]||(be(e,648),be(e,649,CD(st(t["!ref"]))),be(e,650))}function RD(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=ut(r,-1,n[1].Target.replace(/#.*$/,""),Ze.HLINK);be(e,494,mD(n,i))}}),delete t["!links"]}function ID(e,t,r,n){if(t["!comments"].length>0){var i=ut(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ze.VML);be(e,551,X0("rId"+i)),t["!legacy"]=i}}function MD(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:Ke(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=Br(s);o.s.r==o.e.r&&(o.e.r=Br(t["!ref"]).e.r,s=Ke(o));for(var a=0;a<l.length;++a){var c=l[a];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}a==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),be(e,161,Qa(st(s))),be(e,162)}}function LD(e,t,r){be(e,133),be(e,137,kD(t,r)),be(e,138),be(e,134)}function BD(e,t){t["!protect"]&&be(e,535,TD(t["!protect"]))}function UD(e,t,r,n){var i=Lr(),s=r.SheetNames[e],l=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var a=st(l["!ref"]||"A1");if(a.e.c>16383||a.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");a.e.c=Math.min(a.e.c,16383),a.e.r=Math.min(a.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],be(i,129),(r.vbaraw||l["!outline"])&&be(i,147,PP(o,l["!outline"])),be(i,148,OP(a)),LD(i,l,r.Workbook),PD(i,l),FD(i,l,e,t),BD(i,l),MD(i,l,r,e),jD(i,l),RD(i,l,n),l["!margins"]&&be(i,476,bD(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&DD(i,l),ID(i,l,e,n),be(i,130),i.end()}function WD(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var i=it((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function zD(e,t,r,n,i,s){var l=s||{"!type":"chart"};if(!e)return s;var o=0,a=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=WD(f);d.s.r=d.s.c=0,d.e.c=o,c=Nt(o),h[0].forEach(function(u,p){l[c+Bt(p)]={t:"n",v:u,z:h[1]},a=p}),d.e.r<a&&(d.e.r=a),++o}),o>0&&(l["!ref"]=Ke(d)),l}function HD(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,o=e.match(Dw);return o&&ap(o[0],s,i,r),(l=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function $D(e,t){e.l+=10;var r=_r(e);return{name:r}}function VD(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return pi(e,function(a,c,d){switch(d){case 550:s["!rel"]=a;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),a.name&&(i.Sheets[r].CodeName=a.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var op=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],XD=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],YD=[],GD=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Zm(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=vt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function ex(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=vt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Lw(e){ex(e.WBProps,op),ex(e.CalcPr,GD),Zm(e.WBView,XD),Zm(e.Sheets,YD),Fa.date1904=vt(e.WBProps.date1904)}function qD(e){return!e.Workbook||!e.Workbook.WBProps?"false":vt(e.Workbook.WBProps.date1904)?"true":"false"}var KD="][*?/\\".split("");function Bw(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return KD.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function JD(e,t,r){e.forEach(function(n,i){Bw(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=t&&t[i]&&t[i].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function QD(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];JD(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)qj(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var ZD=/<\w+:workbook/;function e5(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},l=0;if(e.replace(kr,function(a,c){var d=Xe(a);switch(Hn(d[0])){case"<?xml":break;case"<workbook":a.match(ZD)&&(i="xmlns"+a.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":op.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=vt(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=dt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=it(dt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=dt(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),vt(d.hidden||"0")&&(s.Hidden=!0),l=c+a.length;break;case"</definedName>":s.Ref=it(dt(e.slice(l,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return a}),Ls.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Lw(r),r}function Uw(e){var t=[Ut];t[t.length]=Ne("workbook",null,{xmlns:Ls[0],"xmlns:r":qt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(op.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ne("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var l={name:ft(e.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Ne("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var a={name:o.Name};o.Comment&&(a.comment=o.Comment),o.Sheet!=null&&(a.localSheetId=""+o.Sheet),o.Hidden&&(a.hidden="1"),o.Ref&&(t[t.length]=Ne("definedName",ft(o.Ref),a))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function t5(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=xd(e),r.name=_r(e),r}function r5(e,t){return t||(t=me(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),X0(e.strRelID,t),tr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function n5(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?_r(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function i5(e,t){t||(t=me(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Fy(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function s5(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function a5(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=I4(e),l=Hj(e,0,r),o=V0(e);e.l=n;var a={Name:s,Ptg:l};return i<268435455&&(a.Sheet=i),o&&(a.Comment=o),a}function o5(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],Sl[16]={n:"BrtFRTArchID$",f:s5},pi(e,function(a,c,d){switch(d){case 156:l.SheetNames.push(a.name),r.Sheets.push(a);break;case 153:r.WBProps=a;break;case 39:a.Sheet!=null&&(t.SID=a.Sheet),a.Ref=xr(a.Ptg,null,null,l,t),delete t.SID,delete a.Ptg,s.push(a);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([d,a]):l[0]=[d,a],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(a),l.XTI=l.XTI.concat(a);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),Lw(r),r.Names=s,r.supbooks=l,r}function l5(e,t){be(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};be(e,156,r5(i))}be(e,144)}function c5(e,t){t||(t=me(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return tr("SheetJS",t),tr(vu.version,t),tr(vu.version,t),tr("7262",t),t.length>t.l?t.slice(0,t.l):t}function u5(e,t){t||(t=me(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function f5(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(be(e,135),be(e,158,u5(i)),be(e,136))}}function h5(e,t){var r=Lr();return be(r,131),be(r,128,c5()),be(r,153,i5(e.Workbook&&e.Workbook.WBProps||null)),f5(r,e),l5(r,e),be(r,132),r.end()}function d5(e,t,r){return t.slice(-4)===".bin"?o5(e,r):e5(e,r)}function p5(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?AD(e,n,r,i,s,l,o):aP(e,n,r,i,s,l,o)}function g5(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?VD(e,n,r,i,s):HD(e,n,r,i,s)}function m5(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?vF():yF()}function x5(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?mF():xF()}function v5(e,t,r,n){return t.slice(-4)===".bin"?d3(e,r,n):t3(e,r,n)}function y5(e,t,r){return ww(e,r)}function w5(e,t,r){return t.slice(-4)===".bin"?wO(e,r):xO(e,r)}function _5(e,t,r){return t.slice(-4)===".bin"?fF(e,r):rF(e,r)}function b5(e,t,r){return t.slice(-4)===".bin"?Z3(e):J3(e)}function S5(e,t,r,n){return r.slice(-4)===".bin"?eF(e,t,r,n):void 0}function k5(e,t,r){return t.slice(-4)===".bin"?G3(e,t,r):K3(e,t,r)}function C5(e,t,r){return(t.slice(-4)===".bin"?h5:Uw)(e)}function T5(e,t,r,n,i){return(t.slice(-4)===".bin"?UD:Rw)(e,r,n,i)}function E5(e,t,r){return(t.slice(-4)===".bin"?S3:vw)(e,r)}function N5(e,t,r){return(t.slice(-4)===".bin"?SO:uw)(e,r)}function A5(e,t,r){return(t.slice(-4)===".bin"?hF:Sw)(e)}function O5(e){return(e.slice(-4)===".bin"?q3:_w)()}var Ww=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,zw=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function xn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(Ww),s,l,o,a;if(i)for(a=0;a!=i.length;++a)s=i[a].match(zw),(l=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(l+1),n[o]=s[2].slice(1,s[2].length-1));return n}function F5(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(Ww),i,s,l,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(zw),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(s+1),r[l]=i[2].slice(1,i[2].length-1));return r}var Bo;function j5(e,t){var r=Bo[e]||it(e);return r==="General"?Os(t):pn(r,t)}function P5(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=vt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=wt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[it(t)]=i}function D5(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||gi[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=pl(e.v):e.w=Os(e.v):e.w=j5(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Bo[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&qa(n)){var i=gs(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function R5(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=YO[n.Pattern]||n.Pattern)}e[t.ID]=t}function I5(e,t,r,n,i,s,l,o,a,c){var d="General",f=n.StyleID,h={};c=c||{};var u=[],p=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&l&&(f=l.StyleID);s[f]!==void 0&&(s[f].nf&&(d=s[f].nf),s[f].Interior&&u.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=vt(e);break;case"String":n.t="s",n.r=xm(it(e)),n.v=e.indexOf("<")>-1?it(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(wt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=it(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Iy[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=xm(t||e));break}if(D5(n,d,c),c.cellFormula!==!1)if(n.Formula){var m=it(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=Oa(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Oa("RC:RC",i):n.ArrayRange&&(n.F=Oa(n.ArrayRange,i),a.push([st(n.F),n.F]))}else for(p=0;p<a.length;++p)i.r>=a[p][0].s.r&&i.r<=a[p][0].e.r&&i.c>=a[p][0].s.c&&i.c<=a[p][0].e.c&&(n.F=a[p][1]);c.cellStyles&&(u.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function M5(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ih(e,t){var r=t||{};Ka();var n=yo(B0(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=dt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var l=_t(r);return l.type="string",za.to_workbook(n,l)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ce){i.indexOf("<"+ce)>=0&&(s=!0)}),s)return bR(n,r);Bo={"General Number":"General","General Date":ze[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ze[15],"Short Date":ze[14],"Long Time":ze[19],"Medium Time":ze[18],"Short Time":ze[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ze[2],Standard:ze[4],Percent:ze[10],Scientific:ze[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,a=[],c,d={},f=[],h=r.dense?[]:{},u="",p={},m={},g=xn('<Data ss:Type="String">'),x=0,v=0,w=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}},b={},k={},S="",O=0,F=[],D={},U={},M=0,q=[],G=[],Q={},K=[],ne,J=!1,T=[],j=[],B={},E=0,R=0,N={Sheets:[],WBProps:{date1904:!1}},C={};xl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var P="";o=xl.exec(n);)switch(o[3]=(P=o[3]).toLowerCase()){case"data":if(P=="data"){if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&a.push([o[3],!0]);break}if(a[a.length-1][1])break;o[1]==="/"?I5(n.slice(x,o.index),S,g,a[a.length-1][0]=="comment"?Q:p,{c:v,r:w},b,K[v],m,T,r):(S="",g=xn(o[0]),x=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(G.length>0&&(p.c=G),(!r.sheetRows||r.sheetRows>w)&&p.v!==void 0&&(r.dense?(h[w]||(h[w]=[]),h[w][v]=p):h[Nt(v)+Bt(w)]=p),p.HRef&&(p.l={Target:it(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(E=v+(parseInt(p.MergeAcross,10)|0),R=w+(parseInt(p.MergeDown,10)|0),F.push({s:{c:v,r:w},e:{c:E,r:R}})),!r.sheetStubs)p.MergeAcross?v=E+1:++v;else if(p.MergeAcross||p.MergeDown){for(var I=v;I<=E;++I)for(var H=w;H<=R;++H)(I>v||H>w)&&(r.dense?(h[H]||(h[H]=[]),h[H][I]={t:"z"}):h[Nt(I)+Bt(H)]={t:"z"});v=E+1}else++v;else p=F5(o[0]),p.Index&&(v=+p.Index-1),v<_.s.c&&(_.s.c=v),v>_.e.c&&(_.e.c=v),o[0].slice(-2)==="/>"&&++v,G=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<_.s.r&&(_.s.r=w),w>_.e.r&&(_.e.r=w),o[0].slice(-2)==="/>"&&(m=xn(o[0]),m.Index&&(w=+m.Index-1)),v=0,++w):(m=xn(o[0]),m.Index&&(w=+m.Index-1),B={},(m.AutoFitHeight=="0"||m.Height)&&(B.hpx=parseInt(m.Height,10),B.hpt=bl(B.hpx),j[w]=B),m.Hidden=="1"&&(B.hidden=!0,j[w]=B));break;case"worksheet":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(u),_.s.r<=_.e.r&&_.s.c<=_.e.c&&(h["!ref"]=Ke(_),r.sheetRows&&r.sheetRows<=_.e.r&&(h["!fullref"]=h["!ref"],_.e.r=r.sheetRows-1,h["!ref"]=Ke(_))),F.length&&(h["!merges"]=F),K.length>0&&(h["!cols"]=K),j.length>0&&(h["!rows"]=j),d[u]=h}else _={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=v=0,a.push([o[3],!1]),c=xn(o[0]),u=it(c.Name),h=r.dense?[]:{},F=[],T=[],j=[],C={name:u,Hidden:0},N.Sheets.push(C);break;case"table":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;a.push([o[3],!1]),K=[],J=!1}break;case"style":o[1]==="/"?R5(b,k,r):k=xn(o[0]);break;case"numberformat":k.nf=it(xn(o[0]).Format||"General"),Bo[k.nf]&&(k.nf=Bo[k.nf]);for(var L=0;L!=392&&ze[L]!=k.nf;++L);if(L==392){for(L=57;L!=392;++L)if(ze[L]==null){ri(k.nf,L);break}}break;case"column":if(a[a.length-1][0]!=="table")break;if(ne=xn(o[0]),ne.Hidden&&(ne.hidden=!0,delete ne.Hidden),ne.Width&&(ne.wpx=parseInt(ne.Width,10)),!J&&ne.wpx>10){J=!0,yr=mw;for(var z=0;z<K.length;++z)K[z]&&Xi(K[z])}J&&Xi(ne),K[ne.Index-1||K.length]=ne;for(var ee=0;ee<+ne.Span;++ee)K[K.length]=_t(ne);break;case"namedrange":if(o[1]==="/")break;N.Names||(N.Names=[]);var A=Xe(o[0]),V={Name:A.Name,Ref:Oa(A.RefersTo.slice(1),{r:0,c:0})};N.Sheets.length>0&&(V.Sheet=N.Sheets.length-1),N.Names.push(V);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?S+=n.slice(O,o.index):O=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=xn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?oN(D,P,n.slice(M,o.index)):M=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else a.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));M5(Q),G.push(Q)}else a.push([o[3],!1]),c=xn(o[0]),Q={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var W=xn(o[0]);h["!autofilter"]={ref:Oa(W.Range).replace(/\$/g,"")},a.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&a.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&a.push([o[3],!0]);break;case"null":break;default:if(a.length==0&&o[3]=="document"||a.length==0&&o[3]=="uof")return sx(n,r);var te=!0;switch(a[a.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:te=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:te=!1}break;case"excelworkbook":switch(o[3]){case"date1904":N.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:te=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:te=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(M,o.index)){case"SheetHidden":C.Hidden=1;break;case"SheetVeryHidden":C.Hidden=2;break}else M=o.index+o[0].length;break;case"header":h["!margins"]||Ss(h["!margins"]={},"xlml"),isNaN(+Xe(o[0]).Margin)||(h["!margins"].header=+Xe(o[0]).Margin);break;case"footer":h["!margins"]||Ss(h["!margins"]={},"xlml"),isNaN(+Xe(o[0]).Margin)||(h["!margins"].footer=+Xe(o[0]).Margin);break;case"pagemargins":var ae=Xe(o[0]);h["!margins"]||Ss(h["!margins"]={},"xlml"),isNaN(+ae.Top)||(h["!margins"].top=+ae.Top),isNaN(+ae.Left)||(h["!margins"].left=+ae.Left),isNaN(+ae.Right)||(h["!margins"].right=+ae.Right),isNaN(+ae.Bottom)||(h["!margins"].bottom=+ae.Bottom);break;case"displayrighttoleft":N.Views||(N.Views=[]),N.Views[0]||(N.Views[0]={}),N.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:te=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:te=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:te=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:te=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:te=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:te=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:te=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:te=!1}break;case"smarttags":break;default:te=!1;break}if(te||o[3].match(/!\[CDATA/))break;if(!a[a.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+a.join("|");if(a[a.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?P5(U,P,q,n.slice(M,o.index)):(q=o,M=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+a.join("|")}var Y={};return!r.bookSheets&&!r.bookProps&&(Y.Sheets=d),Y.SheetNames=f,Y.Workbook=N,Y.SSF=_t(ze),Y.Props=D,Y.Custprops=U,Y}function kd(e,t){switch(cp(t=t||{}),t.type||"base64"){case"base64":return ih(Jr(e),t);case"binary":case"buffer":case"file":return ih(e,t);case"array":return ih(Qi(e),t)}}function L5(e,t){var r=[];return e.Props&&r.push(lN(e.Props,t)),e.Custprops&&r.push(cN(e.Props,e.Custprops)),r.join("")}function B5(){return""}function U5(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(Ne("NumberFormat",null,{"ss:Format":ft(ze[n.numFmtId])}));var l={"ss:ID":"s"+(21+i)};r.push(Ne("Style",s.join(""),l))}),Ne("Styles",r.join(""))}function Hw(e){return Ne("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+np(e.Ref,{r:0,c:0})})}function W5(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(Hw(i)))}return Ne("Names",r.join(""))}function z5(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],l=0;l<i.length;++l){var o=i[l];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(Hw(o)))}return s.join("")}function H5(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Ne("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Ne("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Ne("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Ne("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(lr("ProtectContents","True")),e["!protect"].objects&&i.push(lr("ProtectObjects","True")),e["!protect"].scenarios&&i.push(lr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(lr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(lr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&i.push("<"+l[1]+"/>")})),i.length==0?"":Ne("WorksheetOptions",i.join(""),{xmlns:Hr.x})}function $5(e){return e.map(function(t){var r=f4(t.t||""),n=Ne("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ne("Comment",n,{"ss:Author":t.a})}).join("")}function V5(e,t,r,n,i,s,l){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+ft(np(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var a=At(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(a.r==l.r?"":"["+(a.r-l.r)+"]")+"C"+(a.c==l.c?"":"["+(a.c-l.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=ft(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=ft(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],d=0;d!=c.length;++d)c[d].s.c!=l.c||c[d].s.r!=l.r||(c[d].e.c>c[d].s.c&&(o["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(o["ss:MergeDown"]=c[d].e.r-c[d].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=gi[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ze[14]);break;case"s":f="String",h=u4(e.v||"");break}var u=es(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+u),o["ss:Index"]=l.c+1;var p=e.v!=null?h:"",m=e.t=="z"?"":'<Data ss:Type="'+f+'">'+p+"</Data>";return(e.c||[]).length>0&&(m+=$5(e.c)),Ne("Cell",m,o)}function X5(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Ha(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Y5(e,t,r,n){if(!e["!ref"])return"";var i=st(e["!ref"]),s=e["!merges"]||[],l=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,x){Xi(g);var v=!!g.width,w=of(x,g),_={"ss:Index":x+1};v&&(_["ss:Width"]=wl(w.width)),g.hidden&&(_["ss:Hidden"]="1"),o.push(Ne("Column",null,_))});for(var a=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var d=[X5(c,(e["!rows"]||[])[c])],f=i.s.c;f<=i.e.c;++f){var h=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>f)&&!(s[l].s.r>c)&&!(s[l].e.c<f)&&!(s[l].e.r<c)){(s[l].s.c!=f||s[l].s.r!=c)&&(h=!0);break}if(!h){var u={r:c,c:f},p=Ve(u),m=a?(e[c]||[])[f]:e[p];d.push(V5(m,p,e,t,r,n,u))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function G5(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],l=s?z5(s,t,e,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=s?Y5(s,t,e,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(H5(s,t,e,r)),n.join("")}function q5(e,t){t||(t={}),e.SSF||(e.SSF=_t(ze)),e.SSF&&(Ka(),Zu(e.SSF),t.revssf=tf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],es(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(L5(e,t)),r.push(B5()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Ne("Worksheet",G5(n,t,e),{"ss:Name":ft(e.SheetNames[n])}));return r[2]=U5(e,t),r[3]=W5(e),Ut+Ne("Workbook",r.join(""),{xmlns:Hr.ss,"xmlns:o":Hr.o,"xmlns:x":Hr.x,"xmlns:ss":Hr.ss,"xmlns:dt":Hr.dt,"xmlns:html":Hr.html})}function K5(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=W4(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=z4(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var J5=[60,1084,2066,2165,2175];function Q5(e,t,r,n,i){var s=n,l=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}l.push(o),r.l+=s;for(var a=Jn(r,r.l),c=Cd[a],d=0;c!=null&&J5.indexOf(a)>-1;)s=Jn(r,r.l+2),d=r.l+4,a==2066?d+=4:(a==2165||a==2175)&&(d+=12),o=r.slice(d,r.l+4+s),l.push(o),r.l+=4+s,c=Cd[a=Jn(r,r.l)];var f=er(l);or(f,0);var h=0;f.lens=[];for(var u=0;u<l.length;++u)f.lens.push(h),h+=l[u].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,i)}function Pn(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ze[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||gi[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=pl(e.v):e.w=Os(e.v):e.w=pn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&qa(ze[n]||String(n))){var i=gs(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Cc(e,t,r){return{v:e,ixfe:t,t:r}}function Z5(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},l={},o=null,a=[],c="",d={},f,h="",u,p,m,g,x={},v=[],w,_,b=[],k=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},O={},F=function(Ue){return Ue<8?ws[Ue]:Ue<64&&k[Ue-8]||ws[Ue]},D=function(Ue,ot,pt){var Ge=ot.XF.data;if(!(!Ge||!Ge.patternType||!pt||!pt.cellStyles)){ot.s={},ot.s.patternType=Ge.patternType;var Ur;(Ur=yl(F(Ge.icvFore)))&&(ot.s.fgColor={rgb:Ur}),(Ur=yl(F(Ge.icvBack)))&&(ot.s.bgColor={rgb:Ur})}},U=function(Ue,ot,pt){if(!(B>1)&&!(pt.sheetRows&&Ue.r>=pt.sheetRows)){if(pt.cellStyles&&ot.XF&&ot.XF.data&&D(Ue,ot,pt),delete ot.ixfe,delete ot.XF,f=Ue,h=Ve(Ue),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Ue.r<l.s.r&&(l.s.r=Ue.r),Ue.c<l.s.c&&(l.s.c=Ue.c),Ue.r+1>l.e.r&&(l.e.r=Ue.r+1),Ue.c+1>l.e.c&&(l.e.c=Ue.c+1),pt.cellFormula&&ot.f){for(var Ge=0;Ge<v.length;++Ge)if(!(v[Ge][0].s.c>Ue.c||v[Ge][0].s.r>Ue.r)&&!(v[Ge][0].e.c<Ue.c||v[Ge][0].e.r<Ue.r)){ot.F=Ke(v[Ge][0]),(v[Ge][0].s.c!=Ue.c||v[Ge][0].s.r!=Ue.r)&&delete ot.f,ot.f&&(ot.f=""+xr(v[Ge][1],l,Ue,T,M));break}}pt.dense?(i[Ue.r]||(i[Ue.r]=[]),i[Ue.r][Ue.c]=ot):i[h]=ot}},M={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:v,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(M.password=t.password);var q,G=[],Q=[],K=[],ne=[],J=!1,T=[];T.SheetNames=M.snames,T.sharedf=M.sharedf,T.arrayf=M.arrayf,T.names=[],T.XTI=[];var j=0,B=0,E=0,R=[],N=[],C;M.codepage=1200,Sn(1200);for(var P=!1;e.l<e.length-1;){var I=e.l,H=e.read_shift(2);if(H===0&&j===10)break;var L=e.l===e.length?0:e.read_shift(2),z=Cd[H];if(z&&z.f){if(t.bookSheets&&j===133&&H!==133)break;if(j=H,z.r===2||z.r==12){var ee=e.read_shift(2);if(L-=2,!M.enc&&ee!==H&&((ee&255)<<8|ee>>8)!==H)throw new Error("rt mismatch: "+ee+"!="+H);z.r==12&&(e.l+=10,L-=10)}var A={};if(H===10?A=z.f(e,L,M):A=Q5(H,z,e,L,M),B==0&&[9,521,1033,2057].indexOf(j)===-1)continue;switch(H){case 34:r.opts.Date1904=S.WBProps.date1904=A;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(M.enc||(e.l=0),M.enc=A,!t.password)throw new Error("File is password-protected");if(A.valid==null)throw new Error("Encryption scheme unsupported");if(!A.valid)throw new Error("Password is incorrect");break;case 92:M.lastuser=A;break;case 66:var V=Number(A);switch(V){case 21010:V=1200;break;case 32768:V=1e4;break;case 32769:V=1252;break}Sn(M.codepage=V),P=!0;break;case 317:M.rrtabid=A;break;case 25:M.winlocked=A;break;case 439:r.opts.RefreshAll=A;break;case 12:r.opts.CalcCount=A;break;case 16:r.opts.CalcDelta=A;break;case 17:r.opts.CalcIter=A;break;case 13:r.opts.CalcMode=A;break;case 14:r.opts.CalcPrecision=A;break;case 95:r.opts.CalcSaveRecalc=A;break;case 15:M.CalcRefMode=A;break;case 2211:r.opts.FullCalc=A;break;case 129:A.fDialog&&(i["!type"]="dialog"),A.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),A.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:b.push(A);break;case 430:T.push([A]),T[T.length-1].XTI=[];break;case 35:case 547:T[T.length-1].push(A);break;case 24:case 536:C={Name:A.Name,Ref:xr(A.rgce,l,null,T,M)},A.itab>0&&(C.Sheet=A.itab-1),T.names.push(C),T[0]||(T[0]=[],T[0].XTI=[]),T[T.length-1].push(A),A.Name=="_xlnm._FilterDatabase"&&A.itab>0&&A.rgce&&A.rgce[0]&&A.rgce[0][0]&&A.rgce[0][0][0]=="PtgArea3d"&&(N[A.itab-1]={ref:Ke(A.rgce[0][0][1][2])});break;case 22:M.ExternCount=A;break;case 23:T.length==0&&(T[0]=[],T[0].XTI=[]),T[T.length-1].XTI=T[T.length-1].XTI.concat(A),T.XTI=T.XTI.concat(A);break;case 2196:if(M.biff<8)break;C!=null&&(C.Comment=A[1]);break;case 18:i["!protect"]=A;break;case 19:A!==0&&M.WTF&&console.error("Password verifier: "+A);break;case 133:s[A.pos]=A,M.snames.push(A.name);break;case 10:{if(--B)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,i["!ref"]=Ke(l),t.sheetRows&&t.sheetRows<=l.e.r){var W=l.e.r;l.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Ke(l),l.e.r=W}l.e.r++,l.e.c++}G.length>0&&(i["!merges"]=G),Q.length>0&&(i["!objects"]=Q),K.length>0&&(i["!cols"]=K),ne.length>0&&(i["!rows"]=ne),S.Sheets.push(O)}c===""?d=i:n[c]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(M.biff===8&&(M.biff={9:2,521:3,1033:4}[H]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[A.BIFFVer]||8),M.biffguess=A.BIFFVer==0,A.BIFFVer==0&&A.dt==4096&&(M.biff=5,P=!0,Sn(M.codepage=28591)),M.biff==8&&A.BIFFVer==0&&A.dt==16&&(M.biff=2),B++)break;if(i=t.dense?[]:{},M.biff<8&&!P&&(P=!0,Sn(M.codepage=t.codepage||1252)),M.biff<5||A.BIFFVer==0&&A.dt==4096){c===""&&(c="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var te={pos:e.l-L,name:c};s[te.pos]=te,M.snames.push(c)}else c=(s[I]||{name:""}).name;A.dt==32&&(i["!type"]="chart"),A.dt==64&&(i["!type"]="macro"),G=[],Q=[],M.arrayf=v=[],K=[],ne=[],J=!1,O={Hidden:(s[I]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[A.r]||[])[A.c]:i[Ve({c:A.c,r:A.r})])&&++A.c,w={ixfe:A.ixfe,XF:b[A.ixfe]||{},v:A.val,t:"n"},E>0&&(w.z=R[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),U({c:A.c,r:A.r},w,t);break;case 5:case 517:w={ixfe:A.ixfe,XF:b[A.ixfe],v:A.val,t:A.t},E>0&&(w.z=R[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),U({c:A.c,r:A.r},w,t);break;case 638:w={ixfe:A.ixfe,XF:b[A.ixfe],v:A.rknum,t:"n"},E>0&&(w.z=R[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),U({c:A.c,r:A.r},w,t);break;case 189:for(var ae=A.c;ae<=A.C;++ae){var Y=A.rkrec[ae-A.c][0];w={ixfe:Y,XF:b[Y],v:A.rkrec[ae-A.c][1],t:"n"},E>0&&(w.z=R[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),U({c:ae,r:A.r},w,t)}break;case 6:case 518:case 1030:{if(A.val=="String"){o=A;break}if(w=Cc(A.val,A.cell.ixfe,A.tt),w.XF=b[w.ixfe],t.cellFormula){var ce=A.formula;if(ce&&ce[0]&&ce[0][0]&&ce[0][0][0]=="PtgExp"){var ue=ce[0][0][1][0],xe=ce[0][0][1][1],_e=Ve({r:ue,c:xe});x[_e]?w.f=""+xr(A.formula,l,A.cell,T,M):w.F=((t.dense?(i[ue]||[])[xe]:i[_e])||{}).F}else w.f=""+xr(A.formula,l,A.cell,T,M)}E>0&&(w.z=R[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),U(A.cell,w,t),o=A}break;case 7:case 519:if(o)o.val=A,w=Cc(A,o.cell.ixfe,"s"),w.XF=b[w.ixfe],t.cellFormula&&(w.f=""+xr(o.formula,l,o.cell,T,M)),E>0&&(w.z=R[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),U(o.cell,w,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{v.push(A);var fe=Ve(A[0].s);if(u=t.dense?(i[A[0].s.r]||[])[A[0].s.c]:i[fe],t.cellFormula&&u){if(!o||!fe||!u)break;u.f=""+xr(A[1],l,A[0],T,M),u.F=Ke(A[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;x[Ve(o.cell)]=A[0],u=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[Ve(o.cell)],(u||{}).f=""+xr(A[0],l,f,T,M)}}break;case 253:w=Cc(a[A.isst].t,A.ixfe,"s"),a[A.isst].h&&(w.h=a[A.isst].h),w.XF=b[w.ixfe],E>0&&(w.z=R[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),U({c:A.c,r:A.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:A.ixfe,XF:b[A.ixfe],t:"z"},E>0&&(w.z=R[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),U({c:A.c,r:A.r},w,t));break;case 190:if(t.sheetStubs)for(var ve=A.c;ve<=A.C;++ve){var Ce=A.ixfe[ve-A.c];w={ixfe:Ce,XF:b[Ce],t:"z"},E>0&&(w.z=R[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),U({c:ve,r:A.r},w,t)}break;case 214:case 516:case 4:w=Cc(A.val,A.ixfe,"s"),w.XF=b[w.ixfe],E>0&&(w.z=R[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),U({c:A.c,r:A.r},w,t);break;case 0:case 512:B===1&&(l=A);break;case 252:a=A;break;case 1054:if(M.biff==4){R[E++]=A[1];for(var De=0;De<E+163&&ze[De]!=A[1];++De);De>=163&&ri(A[1],E+163)}else ri(A[1],A[0]);break;case 30:{R[E++]=A;for(var Re=0;Re<E+163&&ze[Re]!=A;++Re);Re>=163&&ri(A,E+163)}break;case 229:G=G.concat(A);break;case 93:Q[A.cmo[0]]=M.lastobj=A;break;case 438:M.lastobj.TxO=A;break;case 127:M.lastobj.ImData=A;break;case 440:for(g=A[0].s.r;g<=A[0].e.r;++g)for(m=A[0].s.c;m<=A[0].e.c;++m)u=t.dense?(i[g]||[])[m]:i[Ve({c:m,r:g})],u&&(u.l=A[1]);break;case 2048:for(g=A[0].s.r;g<=A[0].e.r;++g)for(m=A[0].s.c;m<=A[0].e.c;++m)u=t.dense?(i[g]||[])[m]:i[Ve({c:m,r:g})],u&&u.l&&(u.l.Tooltip=A[1]);break;case 28:{if(M.biff<=5&&M.biff>=2)break;u=t.dense?(i[A[0].r]||[])[A[0].c]:i[Ve(A[0])];var Me=Q[A[2]];u||(t.dense?(i[A[0].r]||(i[A[0].r]=[]),u=i[A[0].r][A[0].c]={t:"z"}):u=i[Ve(A[0])]={t:"z"},l.e.r=Math.max(l.e.r,A[0].r),l.s.r=Math.min(l.s.r,A[0].r),l.e.c=Math.max(l.e.c,A[0].c),l.s.c=Math.min(l.s.c,A[0].c)),u.c||(u.c=[]),p={a:A[1],t:Me.TxO.t},u.c.push(p)}break;case 2173:U3(b[A.ixfe],A.ext);break;case 125:{if(!M.cellStyles)break;for(;A.e>=A.s;)K[A.e--]={width:A.w/256,level:A.level||0,hidden:!!(A.flags&1)},J||(J=!0,ep(A.w/256)),Xi(K[A.e+1])}break;case 520:{var Ye={};A.level!=null&&(ne[A.r]=Ye,Ye.level=A.level),A.hidden&&(ne[A.r]=Ye,Ye.hidden=!0),A.hpt&&(ne[A.r]=Ye,Ye.hpt=A.hpt,Ye.hpx=Ha(A.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Ss(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[H]]=A;break;case 161:i["!margins"]||Ss(i["!margins"]={}),i["!margins"].header=A.header,i["!margins"].footer=A.footer;break;case 574:A.RTL&&(S.Views[0].RTL=!0);break;case 146:k=A;break;case 2198:q=A;break;case 140:_=A;break;case 442:c?O.CodeName=A||O.name:S.WBProps.CodeName=A||"ThisWorkbook";break}}else z||console.error("Missing Info for XLS Record 0x"+H.toString(16)),e.l+=L}return r.SheetNames=It(s).sort(function(tt,Ue){return Number(tt)-Number(Ue)}).map(function(tt){return s[tt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&N.forEach(function(tt,Ue){r.Sheets[r.SheetNames[Ue]]["!autofilter"]=tt}),r.Strings=a,r.SSF=_t(ze),M.enc&&(r.Encryption=M.enc),q&&(r.Themes=q),r.Metadata={},_!==void 0&&(r.Metadata.Country=_),T.names.length>0&&(S.Names=T.names),r.Workbook=S,r}var Uo={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function eR(e,t,r){var n=Le.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=Rm(n,vd,Uo.DSI);for(var s in i)t[s]=i[s]}catch(c){if(r.WTF)throw c}var l=Le.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var o=Rm(l,yd,Uo.SI);for(var a in o)t[a]==null&&(t[a]=o[a])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(zy(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function tR(e,t){var r=[],n=[],i=[],s=0,l,o=fm(vd,"n"),a=fm(yd,"n");if(e.Props)for(l=It(e.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(o,l[s])?r:Object.prototype.hasOwnProperty.call(a,l[s])?n:i).push([l[s],e.Props[l[s]]]);if(e.Custprops)for(l=It(e.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(o,l[s])?r:Object.prototype.hasOwnProperty.call(a,l[s])?n:i).push([l[s],e.Custprops[l[s]]]);var c=[];for(s=0;s<i.length;++s)qy.indexOf(i[s][0])>-1||Wy.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&Le.utils.cfb_add(t,"/SummaryInformation",Im(n,Uo.SI,a,yd)),(r.length||c.length)&&Le.utils.cfb_add(t,"/DocumentSummaryInformation",Im(r,Uo.DSI,o,vd,c.length?c:null,Uo.UDI))}function $w(e,t){t||(t={}),cp(t),O0(),t.codepage&&A0(t.codepage);var r,n;if(e.FullPaths){if(Le.find(e,"/encryption"))throw new Error("File is password-protected");r=Le.find(e,"!CompObj"),n=Le.find(e,"/Workbook")||Le.find(e,"/Book")}else{switch(t.type){case"base64":e=Vr(Jr(e));break;case"binary":e=Vr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}or(e,0),n={content:e}}var i,s;if(r&&K5(r),t.bookProps&&!t.bookSheets)i={};else{var l=Qe?"buffer":"array";if(n&&n.content)i=Z5(n.content,t);else if((s=Le.find(e,"PerfectOffice_MAIN"))&&s.content)i=bs.to_workbook(s.content,(t.type=l,t));else if((s=Le.find(e,"NativeContent_MAIN"))&&s.content)i=bs.to_workbook(s.content,(t.type=l,t));else throw(s=Le.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Le.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=pF(e))}var o={};return e.FullPaths&&eR(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}function rR(e,t){var r=t||{},n=Le.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Le.utils.cfb_add(n,i,Vw(e,r)),r.biff==8&&(e.Props||e.Custprops)&&tR(e,n),r.biff==8&&e.vbaraw&&gF(n,Le.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Sl={0:{f:TP},1:{f:DP},2:{f:ZP},3:{f:zP},4:{f:LP},5:{f:KP},6:{f:iD},7:{f:XP},8:{f:fD},9:{f:uD},10:{f:lD},11:{f:cD},12:{f:IP},13:{f:tD},14:{f:$P},15:{f:UP},16:{f:Iw},17:{f:aD},18:{f:GP},19:{f:$0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:a5},40:{},42:{},43:{f:i3},44:{f:r3},45:{f:o3},46:{f:c3},47:{f:l3},48:{},49:{f:A4},50:{},51:{f:H3},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:aw},62:{f:nD},63:{f:Q3},64:{f:ED},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Sr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:SD},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:jP},148:{f:AP,p:16},151:{f:xD},152:{},153:{f:n5},154:{},155:{},156:{f:t5},157:{},158:{},159:{T:1,f:yO},160:{T:-1},161:{T:1,f:zs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:hD},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:W3},336:{T:-1},337:{f:X3,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:xd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:sw},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:vD},427:{f:yD},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:_D},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:FP},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:gD},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:xd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:cF},633:{T:1},634:{T:-1},635:{T:1,f:oF},636:{T:-1},637:{f:P4},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:$D},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:ND},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Cd={6:{f:rh},10:{f:vi},12:{f:Ht},13:{f:Ht},14:{f:Mt},15:{f:Mt},16:{f:wr},17:{f:Mt},18:{f:Mt},19:{f:Ht},20:{f:zm},21:{f:zm},23:{f:sw},24:{f:$m},25:{f:Mt},26:{},27:{},28:{f:NA},29:{},34:{f:Mt},35:{f:Hm},38:{f:wr},39:{f:wr},40:{f:wr},41:{f:wr},42:{f:Mt},43:{f:Mt},47:{f:UO},49:{f:tA},51:{f:Ht},60:{},61:{f:KN},64:{f:Mt},65:{f:eA},66:{f:Ht},77:{},80:{},81:{},82:{},85:{f:Ht},89:{},90:{},91:{},92:{f:BN},93:{f:FA},94:{},95:{f:Mt},96:{},97:{},99:{f:Mt},125:{f:aw},128:{f:mA},129:{f:WN},130:{f:Ht},131:{f:Mt},132:{f:Mt},133:{f:zN},134:{},140:{f:BA},141:{f:Ht},144:{},146:{f:zA},151:{},152:{},153:{},154:{},155:{},156:{f:Ht},157:{},158:{},160:{f:qA},161:{f:VA},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:hA},190:{f:dA},193:{f:vi},197:{},198:{},199:{},200:{},201:{},202:{f:Mt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ht},220:{},221:{f:Mt},222:{},224:{f:gA},225:{f:LN},226:{f:vi},227:{},229:{f:AA},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:$N},253:{f:nA},255:{f:XN},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Ky},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Mt},353:{f:vi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:_A},431:{f:Mt},432:{},433:{},434:{},437:{},438:{f:DA},439:{f:Mt},440:{f:RA},441:{},442:{f:Bl},443:{},444:{f:Ht},445:{},446:{},448:{f:vi},449:{f:qN,r:2},450:{f:vi},512:{f:Bm},513:{f:GA},515:{f:yA},516:{f:sA},517:{f:Wm},519:{f:KA},520:{f:YN},523:{},545:{f:Vm},549:{f:Lm},566:{},574:{f:QN},638:{f:fA},659:{},1048:{},1054:{f:oA},1084:{},1212:{f:CA},2048:{f:MA},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:bc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:vi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:HA,r:12},2173:{f:B3,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Mt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:kA,r:12},2197:{},2198:{f:P3,r:12},2199:{},2200:{},2201:{},2202:{f:TA,r:12},2203:{f:vi},2204:{},2205:{},2206:{},2207:{},2211:{f:GN},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ht},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:XA},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:WA},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Bm},1:{},2:{f:tO},3:{f:ZA},4:{f:QA},5:{f:Wm},7:{f:nO},8:{},9:{f:bc},11:{},22:{f:Ht},30:{f:cA},31:{},32:{},33:{f:Vm},36:{},37:{f:Lm},50:{f:iO},62:{},52:{},67:{},68:{f:Ht},69:{},86:{},126:{},127:{f:JA},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:sO},223:{},234:{},354:{},421:{},518:{f:rh},521:{f:bc},536:{f:$m},547:{f:Hm},561:{},579:{},1030:{f:rh},1033:{f:bc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ae(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,l=e.next(4);l.write_shift(2,i),l.write_shift(2,s),s>0&&W0(r)&&e.push(r)}}function nR(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return Ae(e,t,r,i);var s=t;if(!isNaN(s)){for(var l=r.parts||[],o=0,a=0,c=0;c+(l[o]||8224)<=8224;)c+=l[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,c),e.push(r.slice(a,a+c)),a+=c;a<i;){for(d=e.next(4),d.write_shift(2,60),c=0;c+(l[o]||8224)<=8224;)c+=l[o]||8224,o++;d.write_shift(2,c),e.push(r.slice(a,a+c)),a+=c}}}function Hl(e,t,r){return e||(e=me(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function iR(e,t,r,n){var i=me(9);return Hl(i,e,t),Jy(r,n||"b",i),i}function sR(e,t,r){var n=me(8+2*r.length);return Hl(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function aR(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Jt(wt(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Ae(e,2,rO(r,n,i)):Ae(e,3,eO(r,n,i));return;case"b":case"e":Ae(e,5,iR(r,n,t.v,t.t));return;case"s":case"str":Ae(e,4,sR(r,n,(t.v||"").slice(0,255)));return}Ae(e,1,Hl(null,r,n))}function oR(e,t,r,n){var i=Array.isArray(t),s=st(t["!ref"]||"A1"),l,o="",a=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=Ke(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Bt(c);for(var d=s.s.c;d<=s.e.c;++d){c===s.s.r&&(a[d]=Nt(d)),l=a[d]+o;var f=i?(t[c]||[])[d]:t[l];f&&aR(e,f,c,d)}}}function lR(e,t){for(var r=t||{},n=Lr(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ae(n,r.biff==4?1033:r.biff==3?521:9,J0(e,16,r)),oR(n,e.Sheets[e.SheetNames[i]],i,r),Ae(n,10),n.end()}function cR(e,t,r){Ae(e,49,rA({sz:12,name:"Arial"},r))}function uR(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Ae(e,1054,lA(i,t[i],r))})}function fR(e,t){var r=me(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ae(e,2151,r),r=me(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),rw(st(t["!ref"]||"A1"),r),r.write_shift(4,4),Ae(e,2152,r)}function hR(e,t){for(var r=0;r<16;++r)Ae(e,224,Um({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ae(e,224,Um(n,0,t))})}function dR(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ae(e,440,IA(n)),n[1].Tooltip&&Ae(e,2048,LA(n))}delete t["!links"]}function pR(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&Ae(e,125,$A(of(i,n),i))})}}function gR(e,t,r,n,i){var s=16+es(i.cellXfs,t,i);if(t.v==null&&!t.bf){Ae(e,513,Ds(r,n,s));return}if(t.bf)Ae(e,6,Wj(t,r,n,i,s));else switch(t.t){case"d":case"n":var l=t.t=="d"?Jt(wt(t.v)):t.v;Ae(e,515,wA(r,n,l,s));break;case"b":case"e":Ae(e,517,vA(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var o=sp(i.Strings,t.v,i.revStrings);Ae(e,253,iA(r,n,o,s))}else Ae(e,516,aA(r,n,(t.v||"").slice(0,255),s,i));break;default:Ae(e,513,Ds(r,n,s))}}function mR(e,t,r){var n=Lr(),i=r.SheetNames[e],s=r.Sheets[i]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[e]||{},a=Array.isArray(s),c=t.biff==8,d,f="",h=[],u=st(s["!ref"]||"A1"),p=c?65536:16384;if(u.e.c>255||u.e.r>=p){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");u.e.c=Math.min(u.e.c,255),u.e.r=Math.min(u.e.c,p-1)}Ae(n,2057,J0(r,16,t)),Ae(n,13,an(1)),Ae(n,12,an(100)),Ae(n,15,Er(!0)),Ae(n,17,Er(!1)),Ae(n,16,js(.001)),Ae(n,95,Er(!0)),Ae(n,42,Er(!1)),Ae(n,43,Er(!1)),Ae(n,130,an(1)),Ae(n,128,xA()),Ae(n,131,Er(!1)),Ae(n,132,Er(!1)),c&&pR(n,s["!cols"]),Ae(n,512,uA(u,t)),c&&(s["!links"]=[]);for(var m=u.s.r;m<=u.e.r;++m){f=Bt(m);for(var g=u.s.c;g<=u.e.c;++g){m===u.s.r&&(h[g]=Nt(g)),d=h[g]+f;var x=a?(s[m]||[])[g]:s[d];x&&(gR(n,x,m,g,t),c&&x.l&&s["!links"].push([d,x.l]))}}var v=o.CodeName||o.name||i;return c&&Ae(n,574,ZN((l.Views||[])[0])),c&&(s["!merges"]||[]).length&&Ae(n,229,OA(s["!merges"])),c&&dR(n,s),Ae(n,442,Qy(v)),c&&fR(n,s),Ae(n,10),n.end()}function xR(e,t,r){var n=Lr(),i=(e||{}).Workbook||{},s=i.Sheets||[],l=i.WBProps||{},o=r.biff==8,a=r.biff==5;if(Ae(n,2057,J0(e,5,r)),r.bookType=="xla"&&Ae(n,135),Ae(n,225,o?an(1200):null),Ae(n,193,vN(2)),a&&Ae(n,191),a&&Ae(n,192),Ae(n,226),Ae(n,92,UN("SheetJS",r)),Ae(n,66,an(o?1200:1252)),o&&Ae(n,353,an(0)),o&&Ae(n,448),Ae(n,317,YA(e.SheetNames.length)),o&&e.vbaraw&&Ae(n,211),o&&e.vbaraw){var c=l.CodeName||"ThisWorkbook";Ae(n,442,Qy(c))}Ae(n,156,an(17)),Ae(n,25,Er(!1)),Ae(n,18,Er(!1)),Ae(n,19,an(0)),o&&Ae(n,431,Er(!1)),o&&Ae(n,444,an(0)),Ae(n,61,JN()),Ae(n,64,Er(!1)),Ae(n,141,an(0)),Ae(n,34,Er(qD(e)=="true")),Ae(n,14,Er(!0)),o&&Ae(n,439,Er(!1)),Ae(n,218,an(0)),cR(n,e,r),uR(n,e.SSF,r),hR(n,r),o&&Ae(n,352,Er(!1));var d=n.end(),f=Lr();o&&Ae(f,140,UA()),o&&r.Strings&&nR(f,252,VN(r.Strings)),Ae(f,10);var h=f.end(),u=Lr(),p=0,m=0;for(m=0;m<e.SheetNames.length;++m)p+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var g=d.length+p+h.length;for(m=0;m<e.SheetNames.length;++m){var x=s[m]||{};Ae(u,133,HN({pos:g,hs:x.Hidden||0,dt:0,name:e.SheetNames[m]},r)),g+=t[m].length}var v=u.end();if(p!=v.length)throw new Error("BS8 "+p+" != "+v.length);var w=[];return d.length&&w.push(d),v.length&&w.push(v),h.length&&w.push(h),er(w)}function vR(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=_t(ze)),e&&e.SSF&&(Ka(),Zu(e.SSF),r.revssf=tf(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,up(r),r.cellXfs=[],es(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=mR(i,r,e);return n.unshift(xR(e,n,r)),er(n)}function Vw(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Br(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return vR(e,t);case 4:case 3:case 2:return lR(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function tx(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),l=i.index,o=s&&s.index||e.length,a=r4(e.slice(l,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,f=0,h=0,u={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(l=0;l<a.length;++l){var m=a[l].trim(),g=m.slice(0,3).toLowerCase();if(g=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}d=0;continue}if(!(g!="<td"&&g!="<th")){var x=m.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var v=x[o].trim();if(v.match(/<t[dh]/i)){for(var w=v,_=0;w.charAt(0)=="<"&&(_=w.indexOf(">"))>-1;)w=w.slice(_+1);for(var b=0;b<p.length;++b){var k=p[b];k.s.c==d&&k.s.r<c&&c<=k.e.r&&(d=k.e.c+1,b=-1)}var S=Xe(v.slice(0,v.indexOf(">")));h=S.colspan?+S.colspan:1,((f=+S.rowspan)>1||h>1)&&p.push({s:{r:c,c:d},e:{r:c+(f||1)-1,c:d+h-1}});var O=S.t||S["data-t"]||"";if(!w.length){d+=h;continue}if(w=gy(w),u.s.r>c&&(u.s.r=c),u.e.r<c&&(u.e.r=c),u.s.c>d&&(u.s.c=d),u.e.c<d&&(u.e.c=d),!w.length){d+=h;continue}var F={t:"s",v:w};r.raw||!w.trim().length||O=="s"||(w==="TRUE"?F={t:"b",v:!0}:w==="FALSE"?F={t:"b",v:!1}:isNaN(Nn(w))?isNaN(Wa(w).getDate())||(F={t:"d",v:wt(w)},r.cellDates||(F={t:"n",v:Jt(F.v)}),F.z=r.dateNF||ze[14]):F={t:"n",v:Nn(w)}),r.dense?(n[c]||(n[c]=[]),n[c][d]=F):n[Ve({r:c,c:d})]=F,d+=h}}}}return n["!ref"]=Ke(u),p.length&&(n["!merges"]=p),n}function yR(e,t,r,n){for(var i=e["!merges"]||[],s=[],l=t.s.c;l<=t.e.c;++l){for(var o=0,a=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>l)&&!(i[c].e.r<r||i[c].e.c<l)){if(i[c].s.r<r||i[c].s.c<l){o=-1;break}o=i[c].e.r-i[c].s.r+1,a=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var d=Ve({r,c:l}),f=n.dense?(e[r]||[])[l]:e[d],h=f&&f.v!=null&&(f.h||L0(f.w||(ui(f),f.w)||""))||"",u={};o>1&&(u.rowspan=o),a>1&&(u.colspan=a),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(u["data-t"]=f&&f.t||"z",f.v!=null&&(u["data-v"]=f.v),f.z!=null&&(u["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),u.id=(n.id||"sjs")+"-"+d,s.push(Ne("td",h,u))}}var p="<tr>";return p+s.join("")+"</tr>"}var wR='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',_R="</body></html>";function bR(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Zi(tx(r[0],t),t);var n=dp();return r.forEach(function(i,s){pp(n,tx(i,t),"Sheet"+(s+1))}),n}function SR(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Xw(e,t){var r=t||{},n=r.header!=null?r.header:wR,i=r.footer!=null?r.footer:_R,s=[n],l=Br(e["!ref"]);r.dense=Array.isArray(e),s.push(SR(e,l,r));for(var o=l.s.r;o<=l.e.r;++o)s.push(yR(e,l,o,r));return s.push("</table>"+i),s.join("")}function Yw(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?At(n.origin):n.origin;i=l.r,s=l.c}var o=t.getElementsByTagName("tr"),a=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var d=Br(e["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),i==-1&&(c.e.r=i=d.e.r+1)}var f=[],h=0,u=e["!rows"]||(e["!rows"]=[]),p=0,m=0,g=0,x=0,v=0,w=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&m<a;++p){var _=o[p];if(rx(_)){if(n.display)continue;u[m]={hidden:!0}}var b=_.children;for(g=x=0;g<b.length;++g){var k=b[g];if(!(n.display&&rx(k))){var S=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):gy(k.innerHTML),O=k.getAttribute("data-z")||k.getAttribute("z");for(h=0;h<f.length;++h){var F=f[h];F.s.c==x+s&&F.s.r<m+i&&m+i<=F.e.r&&(x=F.e.c+1-s,h=-1)}w=+k.getAttribute("colspan")||1,((v=+k.getAttribute("rowspan")||1)>1||w>1)&&f.push({s:{r:m+i,c:x+s},e:{r:m+i+(v||1)-1,c:x+s+(w||1)-1}});var D={t:"s",v:S},U=k.getAttribute("data-t")||k.getAttribute("t")||"";S!=null&&(S.length==0?D.t=U||"z":n.raw||S.trim().length==0||U=="s"||(S==="TRUE"?D={t:"b",v:!0}:S==="FALSE"?D={t:"b",v:!1}:isNaN(Nn(S))?isNaN(Wa(S).getDate())||(D={t:"d",v:wt(S)},n.cellDates||(D={t:"n",v:Jt(D.v)}),D.z=n.dateNF||ze[14]):D={t:"n",v:Nn(S)})),D.z===void 0&&O!=null&&(D.z=O);var M="",q=k.getElementsByTagName("A");if(q&&q.length)for(var G=0;G<q.length&&!(q[G].hasAttribute("href")&&(M=q[G].getAttribute("href"),M.charAt(0)!="#"));++G);M&&M.charAt(0)!="#"&&(D.l={Target:M}),n.dense?(e[m+i]||(e[m+i]=[]),e[m+i][x+s]=D):e[Ve({c:x+s,r:m+i})]=D,c.e.c<x+s&&(c.e.c=x+s),x+=w}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,m-1+i),e["!ref"]=Ke(c),m>=a&&(e["!fullref"]=Ke((c.e.r=o.length-p+m-1+i,c))),e}function Gw(e,t){var r=t||{},n=r.dense?[]:{};return Yw(n,e,t)}function kR(e,t){return Zi(Gw(e,t),t)}function rx(e){var t="",r=CR(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function CR(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function TR(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=it(t.replace(/<[^>]*>/g,""));return[r]}var nx={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function qw(e,t){var r=t||{},n=B0(e),i=[],s,l,o={name:""},a="",c=0,d,f,h={},u=[],p=r.dense?[]:{},m,g,x={value:""},v="",w=0,_=[],b=-1,k=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},O=0,F={},D=[],U={},M=0,q=0,G=[],Q=1,K=1,ne=[],J={Names:[]},T={},j=["",""],B=[],E={},R="",N=0,C=!1,P=!1,I=0;for(xl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=xl.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?p["!ref"]=Ke(S):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(p["!fullref"]=p["!ref"],S.e.r=r.sheetRows-1,p["!ref"]=Ke(S)),D.length&&(p["!merges"]=D),G.length&&(p["!rows"]=G),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),u.push(d.name),h[d.name]=p,P=!1):m[0].charAt(m[0].length-2)!=="/"&&(d=Xe(m[0],!1),b=k=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,p=r.dense?[]:{},D=[],G=[],P=!0);break;case"table-row-group":m[1]==="/"?--O:++O;break;case"table-row":case"":if(m[1]==="/"){b+=Q,Q=1;break}if(f=Xe(m[0],!1),f.?b=f.-1:b==-1&&(b=0),Q=+f["number-rows-repeated"]||1,Q<10)for(I=0;I<Q;++I)O>0&&(G[b+I]={level:O});k=-1;break;case"covered-table-cell":m[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(p[b]||(p[b]=[]),p[b][k]={t:"z"}):p[Ve({r:b,c:k})]={t:"z"}),v="",_=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++k,x=Xe(m[0],!1),K=parseInt(x["number-columns-repeated"]||"1",10),g={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(g.f=Qm(it(x.formula))),(x.||x["value-type"])=="string"&&(g.t="s",g.v=it(x["string-value"]||""),r.dense?(p[b]||(p[b]=[]),p[b][k]=g):p[Ve({r:b,c:k})]=g),k+=K-1;else if(m[1]!=="/"){++k,v="",w=0,_=[],K=1;var H=Q?b+Q-1:b;if(k>S.e.c&&(S.e.c=k),k<S.s.c&&(S.s.c=k),b<S.s.r&&(S.s.r=b),H>S.e.r&&(S.e.r=H),x=Xe(m[0],!1),B=[],E={},g={t:x.||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=it(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(M=parseInt(x["number-matrix-rows-spanned"],10)||0,q=parseInt(x["number-matrix-columns-spanned"],10)||0,U={s:{r:b,c:k},e:{r:b+M-1,c:k+q-1}},g.F=Ke(U),ne.push([U,g.F])),x.formula)g.f=Qm(x.formula);else for(I=0;I<ne.length;++I)b>=ne[I][0].s.r&&b<=ne[I][0].e.r&&k>=ne[I][0].s.c&&k<=ne[I][0].e.c&&(g.F=ne[I][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(M=parseInt(x["number-rows-spanned"],10)||0,q=parseInt(x["number-columns-spanned"],10)||0,U={s:{r:b,c:k},e:{r:b+M-1,c:k+q-1}},D.push(U)),x["number-columns-repeated"]&&(K=parseInt(x["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=vt(x["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(x.value);break;case"percentage":g.t="n",g.v=parseFloat(x.value);break;case"currency":g.t="n",g.v=parseFloat(x.value);break;case"date":g.t="d",g.v=wt(x["date-value"]),r.cellDates||(g.t="n",g.v=Jt(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=ZE(x["time-value"])/86400,r.cellDates&&(g.t="d",g.v=rf(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(x.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",x["string-value"]!=null&&(v=it(x["string-value"]),_=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(C=!1,g.t==="s"&&(g.v=v||"",_.length&&(g.R=_),C=w==0),T.Target&&(g.l=T),B.length>0&&(g.c=B,B=[]),v&&r.cellText!==!1&&(g.w=v),C&&(g.t="z",delete g.v),(!C||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=b))for(var L=0;L<Q;++L){if(K=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(p[b+L]||(p[b+L]=[]),p[b+L][k]=L==0?g:_t(g);--K>0;)p[b+L][k+K]=_t(g);else for(p[Ve({r:b+L,c:k})]=g;--K>0;)p[Ve({r:b+L,c:k+K})]=_t(g);S.e.c<=k&&(S.e.c=k)}K=parseInt(x["number-columns-repeated"]||"1",10),k+=K-1,K=0,g={},v="",_=[]}T={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s;E.t=v,_.length&&(E.R=_),E.a=R,B.push(E)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);R="",N=0,v="",w=0,_=[];break;case"creator":m[1]==="/"?R=n.slice(N,m.index):N=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);v="",w=0,_=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(F[o.name]=a,(s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(a="",o=Xe(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":l=Xe(m[0],!1),a+=nx[m[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":l=Xe(m[0],!1),a+=nx[m[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":a+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":l=Xe(m[0],!1),j=nh(l["cell-range-address"]);var z={Name:l.name,Ref:j[0]+"!"+j[1]};P&&(z.Sheet=u.length),J.Names.push(z);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!x||!x["string-value"])){var ee=TR(n.slice(w,m.index));v=(v.length>0?v+`
`:"")+ee[0]}else Xe(m[0],!1),w=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{j=nh(Xe(m[0])["target-range-address"]),h[j[0]]["!autofilter"]={ref:j[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(T=Xe(m[0],!1),!T.href)break;T.Target=it(T.href),delete T.href,T.Target.charAt(0)=="#"&&T.Target.indexOf(".")>-1?(j=nh(T.Target.slice(1)),T.Target="#"+j[0]+"!"+j[1]):T.Target.match(/^\.\.[\\\/]/)&&(T.Target=T.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var A={Sheets:h,SheetNames:u,Workbook:J};return r.bookSheets&&delete A.Sheets,A}function ix(e,t){t=t||{},sn(e,"META-INF/manifest.xml")&&Z4(zt(e,"META-INF/manifest.xml"),t);var r=Xr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=qw(dt(r),t);return sn(e,"meta.xml")&&(n.Props=By(zt(e,"meta.xml"))),n}function sx(e,t){return qw(e,t)}var ER=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+ml({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Ut+t}}(),ax=function(){var e=function(s){return ft(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,l,o){var a=[];a.push('      <table:table table:name="'+ft(l.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,d=0,f=Br(s["!ref"]||"A1"),h=s["!merges"]||[],u=0,p=Array.isArray(s);if(s["!cols"])for(d=0;d<=f.e.c;++d)a.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var m="",g=s["!rows"]||[];for(c=0;c<f.s.r;++c)m=g[c]?' table:style-name="ro'+g[c].ods+'"':"",a.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=f.e.r;++c){for(m=g[c]?' table:style-name="ro'+g[c].ods+'"':"",a.push("        <table:table-row"+m+`>
`),d=0;d<f.s.c;++d)a.push(t);for(;d<=f.e.c;++d){var x=!1,v={},w="";for(u=0;u!=h.length;++u)if(!(h[u].s.c>d)&&!(h[u].s.r>c)&&!(h[u].e.c<d)&&!(h[u].e.r<c)){(h[u].s.c!=d||h[u].s.r!=c)&&(x=!0),v["table:number-columns-spanned"]=h[u].e.c-h[u].s.c+1,v["table:number-rows-spanned"]=h[u].e.r-h[u].s.r+1;break}if(x){a.push(r);continue}var _=Ve({r:c,c:d}),b=p?(s[c]||[])[d]:s[_];if(b&&b.f&&(v["table:formula"]=ft(Yj(b.f)),b.F&&b.F.slice(0,_.length)==_)){var k=Br(b.F);v["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,v["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!b){a.push(t);continue}switch(b.t){case"b":w=b.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=b.v?"true":"false";break;case"n":w=b.w||String(b.v||0),v["office:value-type"]="float",v["office:value"]=b.v||0;break;case"s":case"str":w=b.v==null?"":b.v,v["office:value-type"]="string";break;case"d":w=b.w||wt(b.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=wt(b.v).toISOString(),v["table:style-name"]="ce1";break;default:a.push(t);continue}var S=e(w);if(b.l&&b.l.Target){var O=b.l.Target;O=O.charAt(0)=="#"?"#"+Gj(O.slice(1)):O,O.charAt(0)!="#"&&!O.match(/^\w+:/)&&(O="../"+O),S=Ne("text:a",S,{"xlink:href":O.replace(/&/g,"&amp;")})}a.push("          "+Ne("table:table-cell",Ne("text:p",S,{}),v)+`
`)}a.push(`        </table:table-row>
`)}return a.push(`      </table:table>
`),a.join("")},i=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(c){return l.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var d=0;d<c["!cols"].length;++d)if(c["!cols"][d]){var f=c["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Xi(f),f.ods=o;var h=c["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++o}}});var a=0;l.SheetNames.map(function(c){return l.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var d=0;d<c["!rows"].length;++d)if(c["!rows"][d]){c["!rows"][d].ods=a;var f=c["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+a+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++a}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,o){var a=[Ut],c=ml({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=ml({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(a.push("<office:document"+c+d+`>
`),a.push(Ly().replace(/office:document-meta/g,"office:meta"))):a.push("<office:document-content"+c+`>
`),i(a,l),a.push(`  <office:body>
`),a.push(`    <office:spreadsheet>
`);for(var f=0;f!=l.SheetNames.length;++f)a.push(n(l.Sheets[l.SheetNames[f]],l,f));return a.push(`    </office:spreadsheet>
`),a.push(`  </office:body>
`),o.bookType=="fods"?a.push("</office:document>"):a.push("</office:document-content>"),a.join("")}}();function Kw(e,t){if(t.bookType=="fods")return ax(e,t);var r=R0(),n="",i=[],s=[];return n="mimetype",Je(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Je(r,n,ax(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Je(r,n,ER(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Je(r,n,Ut+Ly()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Je(r,n,rN(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Je(r,n,eN(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Rs(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Td(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):dt(Qi(e))}function NR(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Vr(Un(e))}function AR(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Gi(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function ox(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function OR(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function FR(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function kl(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function lt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Rt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function at(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=kl(e,r),s=i&7;i=Math.floor(i/8);var l=0,o;if(i==0)break;switch(s){case 0:{for(var a=r[0];e[r[0]++]>=128;);o=e.slice(a,r[0])}break;case 5:l=4,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=kl(e,r),o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function sr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(lt(n*8+i.type)),i.type==2&&t.push(lt(i.data.length)),t.push(i.data))})}),Gi(t)}function lp(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function rn(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=kl(e,n),s=at(e.slice(n[0],n[0]+i));n[0]+=i;var l={id:Rt(s[1][0].data),messages:[]};s[2].forEach(function(o){var a=at(o.data),c=Rt(a[3][0].data);l.messages.push({meta:a,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(l.merge=Rt(s[3][0].data)>>>0>0),r.push(l)}return r}function Zs(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:lt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:lt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(l){i.push(l.data),l.meta[3]=[{type:0,data:lt(l.data.length)}],n[2].push({data:sr(l.meta),type:2})});var s=sr(n);t.push(lt(s.length)),t.push(s),i.forEach(function(l){return t.push(l)})}),Gi(t)}function jR(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=kl(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=t[r[0]],o>1&&(l|=t[r[0]+1]<<8),o>2&&(l|=t[r[0]+2]<<16),o>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}i.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var a=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,a=(t[r[0]++]&224)<<3,a|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(a=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(a=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Gi(i)],a==0)throw new Error("Invalid offset 0");if(a>i[0].length)throw new Error("Invalid offset beyond length");if(c>=a)for(i.push(i[0].slice(-a)),c-=a;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-a,-a+c))}}var d=Gi(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function nn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(jR(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Gi(t)}function ea(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=lt(n),l=s.length;t.push(s),n<=60?(l++,t.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),l+=n,i[0]=0,i[1]=l&255,i[2]=l>>8&255,i[3]=l>>16&255,r+=n}return Gi(t)}function PR(e,t,r,n){var i=Rs(e),s=i.getUint32(4,!0),l=(n>1?12:8)+ox(s&(n>1?3470:398))*4,o=-1,a=-1,c=NaN,d=new Date(2001,0,1);s&512&&(o=i.getUint32(l,!0),l+=4),l+=ox(s&(n>1?12288:4096))*4,s&16&&(a=i.getUint32(l,!0),l+=4),s&32&&(c=i.getFloat64(l,!0),l+=8),s&64&&(d.setTime(d.getTime()+i.getFloat64(l,!0)*1e3),l+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[a]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(a>-1)f={t:"s",v:t[a]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function DR(e,t,r){var n=Rs(e),i=n.getUint32(8,!0),s=12,l=-1,o=-1,a=NaN,c=NaN,d=new Date(2001,0,1);i&1&&(a=OR(e,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(l=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:a};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:a};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return f}function sh(e,t){var r=new Uint8Array(32),n=Rs(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,FR(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function ah(e,t){var r=new Uint8Array(32),n=Rs(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function RR(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return PR(e,t,r,e[0]);case 5:return DR(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function mr(e){var t=at(e);return kl(t[1][0].data)}function lx(e,t){var r=at(t.data),n=Rt(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(l){var o=at(l.data),a=Rt(o[1][0].data)>>>0;switch(n){case 1:s[a]=Td(o[3][0].data);break;case 8:{var c=e[mr(o[9][0].data)][0],d=at(c.data),f=e[mr(d[1][0].data)][0],h=Rt(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var u=at(f.data);s[a]=u[3].map(function(p){return Td(p.data)}).join("")}break}}),s}function IR(e,t){var r,n,i,s,l,o,a,c,d,f,h,u,p,m,g=at(e),x=Rt(g[1][0].data)>>>0,v=Rt(g[2][0].data)>>>0,w=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&Rt(g[8][0].data)>0||!1,_,b;if((s=(i=g[7])==null?void 0:i[0])!=null&&s.data&&t!=0)_=(o=(l=g[7])==null?void 0:l[0])==null?void 0:o.data,b=(c=(a=g[6])==null?void 0:a[0])==null?void 0:c.data;else if((f=(d=g[4])==null?void 0:d[0])!=null&&f.data&&t!=1)_=(u=(h=g[4])==null?void 0:h[0])==null?void 0:u.data,b=(m=(p=g[3])==null?void 0:p[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=w?4:1,S=Rs(_),O=[],F=0;F<_.length/2;++F){var D=S.getUint16(F*2,!0);D<65535&&O.push([F,D])}if(O.length!=v)throw"Expected ".concat(v," cells, found ").concat(O.length);var U=[];for(F=0;F<O.length-1;++F)U[O[F][0]]=b.subarray(O[F][1]*k,O[F+1][1]*k);return O.length>=1&&(U[O[O.length-1][0]]=b.subarray(O[O.length-1][1]*k)),{R:x,cells:U}}function MR(e,t){var r,n=at(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Rt(n[7][0].data)>>>0>0?1:0:-1,s=lp(n[5],function(l){return IR(l,i)});return{nrows:Rt(n[4][0].data)>>>0,data:s.reduce(function(l,o){return l[o.R]||(l[o.R]=[]),o.cells.forEach(function(a,c){if(l[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));l[o.R][c]=a}),l},[])}}function LR(e,t,r){var n,i=at(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Rt(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Rt(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Ke(s);var l=at(i[4][0].data),o=lx(e,e[mr(l[4][0].data)][0]),a=(n=l[17])!=null&&n[0]?lx(e,e[mr(l[17][0].data)][0]):[],c=at(l[3][0].data),d=0;c[1].forEach(function(f){var h=at(f.data),u=e[mr(h[2][0].data)][0],p=Rt(u.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var m=MR(e,u);m.data.forEach(function(g,x){g.forEach(function(v,w){var _=Ve({r:d+x,c:w}),b=RR(v,o,a);b&&(r[_]=b)})}),d+=m.nrows})}function BR(e,t){var r=at(t.data),n={"!ref":"A1"},i=e[mr(r[2][0].data)],s=Rt(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return LR(e,i[0],n),n}function UR(e,t){var r,n=at(t.data),i={name:(r=n[1])!=null&&r[0]?Td(n[1][0].data):"",sheets:[]},s=lp(n[2],mr);return s.forEach(function(l){e[l].forEach(function(o){var a=Rt(o.meta[1][0].data);a==6e3&&i.sheets.push(BR(e,o))})}),i}function WR(e,t){var r=dp(),n=at(t.data),i=lp(n[1],mr);if(i.forEach(function(s){e[s].forEach(function(l){var o=Rt(l.meta[1][0].data);if(o==2){var a=UR(e,l);a.sheets.forEach(function(c,d){pp(r,c,d==0?a.name:a.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function oh(e){var t,r,n,i,s={},l=[];if(e.FullPaths.forEach(function(a){if(a.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(a){if(a.name.match(/\.iwa$/)){var c;try{c=nn(a.content)}catch(f){return console.log("?? "+a.content.length+" "+(f.message||f))}var d;try{d=rn(c)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){s[f.id]=f.messages,l.push(f.id)})}}),!l.length)throw new Error("File has no messages");var o=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Rt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||l.forEach(function(a){s[a].forEach(function(c){var d=Rt(c.meta[1][0].data)>>>0;if(d==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return WR(s,o)}function zR(e,t,r){var n,i,s,l;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(s=e[8])==null?void 0:s[0])==null?void 0:l.data)&&Rt(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var a=0,c=Rs(e[7][0].data),d=0,f=[],h=Rs(e[4][0].data),u=0,p=[],m=0;m<t.length;++m){if(t[m]==null){c.setUint16(m*2,65535,!0),h.setUint16(m*2,65535);continue}c.setUint16(m*2,d,!0),h.setUint16(m*2,u,!0);var g,x;switch(typeof t[m]){case"string":g=sh({t:"s",v:t[m]},r),x=ah({t:"s",v:t[m]},r);break;case"number":g=sh({t:"n",v:t[m]},r),x=ah({t:"n",v:t[m]},r);break;case"boolean":g=sh({t:"b",v:t[m]},r),x=ah({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}f.push(g),d+=g.length,p.push(x),u+=x.length,++a}for(e[2][0].data=lt(a);m<e[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),h.setUint16(m*2,65535,!0);return e[6][0].data=Gi(f),e[3][0].data=Gi(p),a}function HR(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Br(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Ke(n)));var s=Ou(r,{range:n,header:1}),l=["~Sh33tJ5~"];s.forEach(function(R){return R.forEach(function(N){typeof N=="string"&&l.push(N)})});var o={},a=[],c=Le.read(t.numbers,{type:"base64"});c.FileIndex.map(function(R,N){return[R,c.FullPaths[N]]}).forEach(function(R){var N=R[0],C=R[1];if(N.type==2&&N.name.match(/\.iwa/)){var P=N.content,I=nn(P),H=rn(I);H.forEach(function(L){a.push(L.id),o[L.id]={deps:[],location:C,type:Rt(L.messages[0].meta[1][0].data)}})}}),a.sort(function(R,N){return R-N});var d=a.filter(function(R){return R>1}).map(function(R){return[R,lt(R)]});c.FileIndex.map(function(R,N){return[R,c.FullPaths[N]]}).forEach(function(R){var N=R[0];if(R[1],!!N.name.match(/\.iwa/)){var C=rn(nn(N.content));C.forEach(function(P){P.messages.forEach(function(I){d.forEach(function(H){P.messages.some(function(L){return Rt(L.meta[1][0].data)!=11006&&AR(L.data,H[1])})&&o[H[0]].deps.push(P.id)})})})}});for(var f=Le.find(c,o[1].location),h=rn(nn(f.content)),u,p=0;p<h.length;++p){var m=h[p];m.id==1&&(u=m)}var g=mr(at(u.messages[0].data)[1][0].data);for(f=Le.find(c,o[g].location),h=rn(nn(f.content)),p=0;p<h.length;++p)m=h[p],m.id==g&&(u=m);for(g=mr(at(u.messages[0].data)[2][0].data),f=Le.find(c,o[g].location),h=rn(nn(f.content)),p=0;p<h.length;++p)m=h[p],m.id==g&&(u=m);for(g=mr(at(u.messages[0].data)[2][0].data),f=Le.find(c,o[g].location),h=rn(nn(f.content)),p=0;p<h.length;++p)m=h[p],m.id==g&&(u=m);var x=at(u.messages[0].data);{x[6][0].data=lt(n.e.r+1),x[7][0].data=lt(n.e.c+1);var v=mr(x[46][0].data),w=Le.find(c,o[v].location),_=rn(nn(w.content));{for(var b=0;b<_.length&&_[b].id!=v;++b);if(_[b].id!=v)throw"Bad ColumnRowUIDMapArchive";var k=at(_[b].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var S=0;S<=n.e.c;++S){var O=[];O[1]=O[2]=[{type:0,data:lt(S+420690)}],k[1].push({type:2,data:sr(O)}),k[2].push({type:0,data:lt(S)}),k[3].push({type:0,data:lt(S)})}k[4]=[],k[5]=[],k[6]=[];for(var F=0;F<=n.e.r;++F)O=[],O[1]=O[2]=[{type:0,data:lt(F+726270)}],k[4].push({type:2,data:sr(O)}),k[5].push({type:0,data:lt(F)}),k[6].push({type:0,data:lt(F)});_[b].messages[0].data=sr(k)}w.content=ea(Zs(_)),w.size=w.content.length,delete x[46];var D=at(x[4][0].data);{D[7][0].data=lt(n.e.r+1);var U=at(D[1][0].data),M=mr(U[2][0].data);w=Le.find(c,o[M].location),_=rn(nn(w.content));{if(_[0].id!=M)throw"Bad HeaderStorageBucket";var q=at(_[0].messages[0].data);for(F=0;F<s.length;++F){var G=at(q[2][0].data);G[1][0].data=lt(F),G[4][0].data=lt(s[F].length),q[2][F]={type:q[2][0].type,data:sr(G)}}_[0].messages[0].data=sr(q)}w.content=ea(Zs(_)),w.size=w.content.length;var Q=mr(D[2][0].data);w=Le.find(c,o[Q].location),_=rn(nn(w.content));{if(_[0].id!=Q)throw"Bad HeaderStorageBucket";for(q=at(_[0].messages[0].data),S=0;S<=n.e.c;++S)G=at(q[2][0].data),G[1][0].data=lt(S),G[4][0].data=lt(n.e.r+1),q[2][S]={type:q[2][0].type,data:sr(G)};_[0].messages[0].data=sr(q)}w.content=ea(Zs(_)),w.size=w.content.length;var K=mr(D[4][0].data);(function(){for(var R=Le.find(c,o[K].location),N=rn(nn(R.content)),C,P=0;P<N.length;++P){var I=N[P];I.id==K&&(C=I)}var H=at(C.messages[0].data);{H[3]=[];var L=[];l.forEach(function(A,V){L[1]=[{type:0,data:lt(V)}],L[2]=[{type:0,data:lt(1)}],L[3]=[{type:2,data:NR(A)}],H[3].push({type:2,data:sr(L)})})}C.messages[0].data=sr(H);var z=Zs(N),ee=ea(z);R.content=ee,R.size=R.content.length})();var ne=at(D[3][0].data);{var J=ne[1][0];delete ne[2];var T=at(J.data);{var j=mr(T[2][0].data);(function(){for(var R=Le.find(c,o[j].location),N=rn(nn(R.content)),C,P=0;P<N.length;++P){var I=N[P];I.id==j&&(C=I)}var H=at(C.messages[0].data);{delete H[6],delete ne[7];var L=new Uint8Array(H[5][0].data);H[5]=[];for(var z=0,ee=0;ee<=n.e.r;++ee){var A=at(L);z+=zR(A,s[ee],l),A[1][0].data=lt(ee),H[5].push({data:sr(A),type:2})}H[1]=[{type:0,data:lt(n.e.c+1)}],H[2]=[{type:0,data:lt(n.e.r+1)}],H[3]=[{type:0,data:lt(z)}],H[4]=[{type:0,data:lt(n.e.r+1)}]}C.messages[0].data=sr(H);var V=Zs(N),W=ea(V);R.content=W,R.size=R.content.length})()}J.data=sr(T)}D[3][0].data=sr(ne)}x[4][0].data=sr(D)}u.messages[0].data=sr(x);var B=Zs(h),E=ea(B);return f.content=E,f.size=f.content.length,c}function Jw(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function cp(e){Jw([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function up(e){Jw([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function $R(e){return Ze.WS.indexOf(e)>-1?"sheet":e==Ze.CS?"chart":e==Ze.DS?"dialog":e==Ze.MS?"macro":e&&e.length?e:"sheet"}function VR(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,$R(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function XR(e,t,r,n,i,s,l,o,a,c,d,f){try{s[n]=Io(Xr(e,r,!0),t);var h=zt(e,t),u;switch(o){case"sheet":u=p5(h,t,i,a,s[n],c,d,f);break;case"chart":if(u=g5(h,t,i,a,s[n],c,d,f),!u||!u["!drawel"])break;var p=_o(u["!drawel"].Target,t),m=vl(p),g=tF(Xr(e,p,!0),Io(Xr(e,m,!0),p)),x=_o(g,p),v=vl(x);u=zD(Xr(e,x,!0),x,a,Io(Xr(e,v,!0),x),c,u);break;case"macro":u=m5(h,t,i,a,s[n],c,d,f);break;case"dialog":u=x5(h,t,i,a,s[n],c,d,f);break;default:throw new Error("Unrecognized sheet type "+o)}l[n]=u;var w=[];s&&s[n]&&It(s[n]).forEach(function(_){var b="";if(s[n][_].Type==Ze.CMNT){b=_o(s[n][_].Target,t);var k=_5(zt(e,b,!0),b,a);if(!k||!k.length)return;Ym(u,k,!1)}s[n][_].Type==Ze.TCMNT&&(b=_o(s[n][_].Target,t),w=w.concat(nF(zt(e,b,!0),a)))}),w&&w.length&&Ym(u,w,!0,a.people||[])}catch(_){if(a.WTF)throw _}}function en(e){return e.charAt(0)=="/"?e.slice(1):e}function YR(e,t){if(Ka(),t=t||{},cp(t),sn(e,"META-INF/manifest.xml")||sn(e,"objectdata.xml"))return ix(e,t);if(sn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof oh<"u"){if(e.FileIndex)return oh(e);var r=Le.utils.cfb_new();return pm(e).forEach(function(G){Je(r,G,i4(e,G))}),oh(r)}throw new Error("Unsupported NUMBERS file")}if(!sn(e,"[Content_Types].xml"))throw sn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):sn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=pm(e),i=J4(Xr(e,"[Content_Types].xml")),s=!1,l,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",zt(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!zt(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var a={},c={};if(!t.bookSheets&&!t.bookProps){if(Mo=[],i.sst)try{Mo=w5(zt(e,en(i.sst)),i.sst,t)}catch(G){if(t.WTF)throw G}t.cellStyles&&i.themes.length&&(a=y5(Xr(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=v5(zt(e,en(i.style)),i.style,a,t))}i.links.map(function(G){try{var Q=Io(Xr(e,vl(en(G))),G);return S5(zt(e,en(G)),Q,G,t)}catch{}});var d=d5(zt(e,en(i.workbooks[0])),i.workbooks[0],t),f={},h="";i.coreprops.length&&(h=zt(e,en(i.coreprops[0]),!0),h&&(f=By(h)),i.extprops.length!==0&&(h=zt(e,en(i.extprops[0]),!0),h&&iN(h,f,t)));var u={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(h=Xr(e,en(i.custprops[0]),!0),h&&(u=aN(h,t)));var p={};if((t.bookSheets||t.bookProps)&&(d.Sheets?l=d.Sheets.map(function(Q){return Q.name}):f.Worksheets&&f.SheetNames.length>0&&(l=f.SheetNames),t.bookProps&&(p.Props=f,p.Custprops=u),t.bookSheets&&typeof l<"u"&&(p.SheetNames=l),t.bookSheets?p.SheetNames:t.bookProps))return p;l={};var m={};t.bookDeps&&i.calcchain&&(m=b5(zt(e,en(i.calcchain)),i.calcchain));var g=0,x={},v,w;{var _=d.Sheets;f.Worksheets=_.length,f.SheetNames=[];for(var b=0;b!=_.length;++b)f.SheetNames[b]=_[b].name}var k=s?"bin":"xml",S=i.workbooks[0].lastIndexOf("/"),O=(i.workbooks[0].slice(0,S+1)+"_rels/"+i.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");sn(e,O)||(O="xl/_rels/workbook."+k+".rels");var F=Io(Xr(e,O,!0),O.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=k5(zt(e,en(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=sF(zt(e,en(i.people[0])),t)),F&&(F=VR(F,d.Sheets));var D=zt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var U="sheet";if(F&&F[g]?(v="xl/"+F[g][1].replace(/[\/]?xl\//,""),sn(e,v)||(v=F[g][1]),sn(e,v)||(v=O.replace(/_rels\/.*$/,"")+F[g][1]),U=F[g][2]):(v="xl/worksheets/sheet"+(g+1-D)+"."+k,v=v.replace(/sheet0\./,"sheet.")),w=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var M=!1,q=0;q!=t.sheets.length;++q)typeof t.sheets[q]=="number"&&t.sheets[q]==g&&(M=1),typeof t.sheets[q]=="string"&&t.sheets[q].toLowerCase()==f.SheetNames[g].toLowerCase()&&(M=1);if(!M)continue e}}XR(e,v,w,f.SheetNames[g],g,x,l,U,t,d,a,c)}return p={Directory:i,Workbook:d,Props:f,Custprops:u,Deps:m,Sheets:l,SheetNames:f.SheetNames,Strings:Mo,Styles:c,Themes:a,SSF:_t(ze)},t&&t.bookFiles&&(e.files?(p.keys=n,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(G,Q){G=G.replace(/^Root Entry[\/]/,""),p.keys.push(G),p.files[G]=e.FileIndex[Q]}))),t&&t.bookVBA&&(i.vba.length>0?p.vbaraw=zt(e,en(i.vba[0]),!0):i.defaults&&i.defaults.bin===dF&&(p.vbaraw=zt(e,"xl/vbaProject.bin",!0))),p}function GR(e,t){var r=t||{},n="Workbook",i=Le.find(e,n);try{if(n="/!DataSpaces/Version",i=Le.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(kO(i.content),n="/!DataSpaces/DataSpaceMap",i=Le.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=TO(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Le.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=EO(i.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Le.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);AO(i.content)}catch{}if(n="/EncryptionInfo",i=Le.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=OO(i.content);if(n="/EncryptedPackage",i=Le.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function qR(e,t){return t.bookType=="ods"?Kw(e,t):t.bookType=="numbers"?HR(e,t):t.bookType=="xlsb"?KR(e,t):JR(e,t)}function KR(e,t){ya=1024,e&&!e.SSF&&(e.SSF=_t(ze)),e&&e.SSF&&(Ka(),Zu(e.SSF),t.revssf=tf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Lo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=kw.indexOf(t.bookType)>-1,i=q0();up(t=t||{});var s=R0(),l="",o=0;if(t.cellXfs=[],es(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Je(s,l,Uy(e.Props,t)),i.coreprops.push(l),ut(t.rels,2,l,Ze.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var a=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&a.push(e.SheetNames[c]);e.Props.SheetNames=a}for(e.Props.Worksheets=e.Props.SheetNames.length,Je(s,l,Hy(e.Props)),i.extprops.push(l),ut(t.rels,3,l,Ze.EXT_PROPS),e.Custprops!==e.Props&&It(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Je(s,l,$y(e.Custprops)),i.custprops.push(l),ut(t.rels,4,l,Ze.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,Je(s,l,T5(o-1,l,t,e,d)),i.sheets.push(l),ut(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ze.WS[0])}if(f){var u=f["!comments"],p=!1,m="";u&&u.length>0&&(m="xl/comments"+o+"."+r,Je(s,m,A5(u,m)),i.comments.push(m),ut(d,-1,"../comments"+o+"."+r,Ze.CMNT),p=!0),f["!legacy"]&&p&&Je(s,"xl/drawings/vmlDrawing"+o+".vml",bw(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Je(s,vl(l),Aa(d))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Je(s,l,N5(t.Strings,l,t)),i.strs.push(l),ut(t.wbrels,-1,"sharedStrings."+r,Ze.SST)),l="xl/workbook."+r,Je(s,l,C5(e,l)),i.workbooks.push(l),ut(t.rels,1,l,Ze.WB),l="xl/theme/theme1.xml",Je(s,l,tp(e.Themes,t)),i.themes.push(l),ut(t.wbrels,-1,"theme/theme1.xml",Ze.THEME),l="xl/styles."+r,Je(s,l,E5(e,l,t)),i.styles.push(l),ut(t.wbrels,-1,"styles."+r,Ze.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Je(s,l,e.vbaraw),i.vba.push(l),ut(t.wbrels,-1,"vbaProject.bin",Ze.VBA)),l="xl/metadata."+r,Je(s,l,O5(l)),i.metadata.push(l),ut(t.wbrels,-1,"metadata."+r,Ze.XLMETA),Je(s,"[Content_Types].xml",My(i,t)),Je(s,"_rels/.rels",Aa(t.rels)),Je(s,"xl/_rels/workbook."+r+".rels",Aa(t.wbrels)),delete t.revssf,delete t.ssf,s}function JR(e,t){ya=1024,e&&!e.SSF&&(e.SSF=_t(ze)),e&&e.SSF&&(Ka(),Zu(e.SSF),t.revssf=tf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Lo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=kw.indexOf(t.bookType)>-1,i=q0();up(t=t||{});var s=R0(),l="",o=0;if(t.cellXfs=[],es(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Je(s,l,Uy(e.Props,t)),i.coreprops.push(l),ut(t.rels,2,l,Ze.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var a=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&a.push(e.SheetNames[c]);e.Props.SheetNames=a}e.Props.Worksheets=e.Props.SheetNames.length,Je(s,l,Hy(e.Props)),i.extprops.push(l),ut(t.rels,3,l,Ze.EXT_PROPS),e.Custprops!==e.Props&&It(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Je(s,l,$y(e.Custprops)),i.custprops.push(l),ut(t.rels,4,l,Ze.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],u=(h||{})["!type"]||"sheet";switch(u){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,Je(s,l,Rw(o-1,t,e,f)),i.sheets.push(l),ut(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ze.WS[0])}if(h){var p=h["!comments"],m=!1,g="";if(p&&p.length>0){var x=!1;p.forEach(function(v){v[1].forEach(function(w){w.T==!0&&(x=!0)})}),x&&(g="xl/threadedComments/threadedComment"+o+"."+r,Je(s,g,iF(p,d,t)),i.threadedcomments.push(g),ut(f,-1,"../threadedComments/threadedComment"+o+"."+r,Ze.TCMNT)),g="xl/comments"+o+"."+r,Je(s,g,Sw(p)),i.comments.push(g),ut(f,-1,"../comments"+o+"."+r,Ze.CMNT),m=!0}h["!legacy"]&&m&&Je(s,"xl/drawings/vmlDrawing"+o+".vml",bw(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Je(s,vl(l),Aa(f))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Je(s,l,uw(t.Strings,t)),i.strs.push(l),ut(t.wbrels,-1,"sharedStrings."+r,Ze.SST)),l="xl/workbook."+r,Je(s,l,Uw(e)),i.workbooks.push(l),ut(t.rels,1,l,Ze.WB),l="xl/theme/theme1.xml",Je(s,l,tp(e.Themes,t)),i.themes.push(l),ut(t.wbrels,-1,"theme/theme1.xml",Ze.THEME),l="xl/styles."+r,Je(s,l,vw(e,t)),i.styles.push(l),ut(t.wbrels,-1,"styles."+r,Ze.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Je(s,l,e.vbaraw),i.vba.push(l),ut(t.wbrels,-1,"vbaProject.bin",Ze.VBA)),l="xl/metadata."+r,Je(s,l,_w()),i.metadata.push(l),ut(t.wbrels,-1,"metadata."+r,Ze.XLMETA),d.length>1&&(l="xl/persons/person.xml",Je(s,l,aF(d)),i.people.push(l),ut(t.wbrels,-1,"persons/person.xml",Ze.PEOPLE)),Je(s,"[Content_Types].xml",My(i,t)),Je(s,"_rels/.rels",Aa(t.rels)),Je(s,"xl/_rels/workbook."+r+".rels",Aa(t.wbrels)),delete t.revssf,delete t.ssf,s}function fp(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Jr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function QR(e,t){return Le.find(e,"EncryptedPackage")?GR(e,t):$w(e,t)}function ZR(e,t){var r,n=e,i=t||{};return i.type||(i.type=Qe&&Buffer.isBuffer(e)?"buffer":"base64"),r=hy(n,i),YR(r,i)}function Qw(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return kd(e.slice(r),t);default:break e}return za.to_workbook(e,t)}function eI(e,t){var r="",n=fp(e,t);switch(t.type){case"base64":r=Jr(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Fs(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=dt(r)),t.type="binary",Qw(r,t)}function tI(e,t){var r=e;return t.type=="base64"&&(r=Jr(r)),r=hl.utils.decode(1200,r.slice(2),"str"),t.type="binary",Qw(r,t)}function rI(e){return e.match(/[^\x00-\x7F]/)?Un(e):e}function lh(e,t,r,n){return n?(r.type="string",za.to_workbook(e,r)):za.to_workbook(t,r)}function Ed(e,t){O0();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Ed(new Uint8Array(e),(r=_t(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Fa={},r.dateNF&&(Fa.dateNF=r.dateNF),r.type||(r.type=Qe&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Qe?"buffer":"binary",n=KE(e),typeof Uint8Array<"u"&&!Qe&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=rI(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),o=new Uint8Array(l);if(o.foo="bar",!o.foo)return r=_t(r),r.type="array",Ed(F0(n),r)}switch((i=fp(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return QR(Le.read(n,r),r);break;case 9:if(i[1]<=8)return $w(n,r);break;case 60:return kd(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return oO(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return lw.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?ZR(n,r):lh(e,n,r,s);case 239:return i[3]===60?kd(n,r):lh(e,n,r,s);case 255:if(i[1]===254)return tI(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return bs.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return bs.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Sd.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return gw.to_workbook(n,r);break;case 10:case 13:case 32:return eI(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return aO.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Sd.to_workbook(n,r):lh(e,n,r,s)}function Zw(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Il(t.file,Le.write(e,{type:Qe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Le.write(e,t)}function nI(e,t){var r=_t(t||{}),n=qR(e,r);return iI(n,r)}function iI(e,t){var r={},n=Qe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Le.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Qu(i))}return t.password&&typeof encrypt_agile<"u"?Zw(encrypt_agile(i,t.password),t):t.type==="file"?Il(t.file,i):t.type=="string"?dt(i):i}function sI(e,t){var r=t||{},n=rR(e,r);return Zw(n,r)}function Rn(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return dl(Un(n));case"binary":return Un(n);case"string":return e;case"file":return Il(t.file,n,"utf8");case"buffer":return Qe?di(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Rn(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function aI(e,t){switch(t.type){case"base64":return dl(e);case"binary":return e;case"string":return e;case"file":return Il(t.file,e,"binary");case"buffer":return Qe?di(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Tc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?dl(r):t.type=="string"?dt(r):r;case"file":return Il(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function e_(e,t){O0(),QD(e);var r=_t(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=e_(e,r);return r.type="array",Qu(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Rn(q5(e,r),r);case"slk":case"sylk":return Rn(ow.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return Rn(Xw(e.Sheets[e.SheetNames[i]],r),r);case"txt":return aI(r_(e.Sheets[e.SheetNames[i]],r),r);case"csv":return Rn(hp(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return Rn(lw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return Tc(Sd.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return Rn(za.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return Rn(gw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return Rn(cw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return Rn(Kw(e,r),r);case"wk1":return Tc(bs.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return Tc(bs.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Tc(Vw(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),sI(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return nI(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function oI(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function t_(e,t,r){var n={};return n.type="file",n.file=t,oI(n),e_(e,n)}function lI(e,t,r,n,i,s,l,o){var a=Bt(r),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!l||e[r])for(var u=t.s.c;u<=t.e.c;++u){var p=l?e[r][u]:e[n[u]+a];if(p===void 0||p.t===void 0){if(c===void 0)continue;s[u]!=null&&(h[s[u]]=c);continue}var m=p.v;switch(p.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(s[u]!=null){if(m==null)if(p.t=="e"&&m===null)h[s[u]]=null;else if(c!==void 0)h[s[u]]=c;else if(d&&m===null)h[s[u]]=null;else continue;else h[s[u]]=d&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?m:ui(p,m,o);m!=null&&(f=!1)}}return{row:h,isempty:f}}function Ou(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],l=0,o="",a={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},d=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof d){case"string":a=st(d);break;case"number":a=st(e["!ref"]),a.s.r=d;break;default:a=d}n>0&&(i=0);var f=Bt(a.s.r),h=[],u=[],p=0,m=0,g=Array.isArray(e),x=a.s.r,v=0,w={};g&&!e[x]&&(e[x]=[]);var _=c.skipHidden&&e["!cols"]||[],b=c.skipHidden&&e["!rows"]||[];for(v=a.s.c;v<=a.e.c;++v)if(!(_[v]||{}).hidden)switch(h[v]=Nt(v),r=g?e[x][v]:e[h[v]+f],n){case 1:s[v]=v-a.s.c;break;case 2:s[v]=h[v];break;case 3:s[v]=c.header[v-a.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=ui(r,null,c),m=w[l]||0,!m)w[l]=1;else{do o=l+"_"+m++;while(w[o]);w[l]=m,w[o]=1}s[v]=o}for(x=a.s.r+i;x<=a.e.r;++x)if(!(b[x]||{}).hidden){var k=lI(e,a,x,h,n,s,g,c);(k.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(u[p++]=k.row)}return u.length=p,u}var cx=/"/g;function cI(e,t,r,n,i,s,l,o){for(var a=!0,c=[],d="",f=Bt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var u=o.dense?(e[r]||[])[h]:e[n[h]+f];if(u==null)d="";else if(u.v!=null){a=!1,d=""+(o.rawNumbers&&u.t=="n"?u.v:ui(u,null,o));for(var p=0,m=0;p!==d.length;++p)if((m=d.charCodeAt(p))===i||m===s||m===34||o.forceQuotes){d='"'+d.replace(cx,'""')+'"';break}d=="ID"&&(d='"ID"')}else u.f!=null&&!u.F?(a=!1,d="="+u.f,d.indexOf(",")>=0&&(d='"'+d.replace(cx,'""')+'"')):d="";c.push(d)}return o.blankrows===!1&&a?null:c.join(l)}function hp(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=st(e["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,a=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],u=n.skipHidden&&e["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(h[p]||{}).hidden||(f[p]=Nt(p));for(var m=0,g=i.s.r;g<=i.e.r;++g)(u[g]||{}).hidden||(d=cI(e,i,g,f,l,a,s,n),d!=null&&(n.strip&&(d=d.replace(c,"")),(d||n.blankrows!==!1)&&r.push((m++?o:"")+d)));return delete n.dense,r.join("")}function r_(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=hp(e,t);return r}function uI(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=st(e["!ref"]),s="",l=[],o,a=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)l[o]=Nt(o);for(var d=i.s.r;d<=i.e.r;++d)for(s=Bt(d),o=i.s.c;o<=i.e.c;++o)if(t=l[o]+s,r=c?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}a[a.length]=t+"="+n}return a}function n_(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},l=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var a=typeof n.origin=="string"?At(n.origin):n.origin;l=a.r,o=a.c}var c,d={s:{c:0,r:0},e:{c:o,r:l+t.length-1+i}};if(s["!ref"]){var f=st(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),l==-1&&(l=f.e.r+1,d.e.r=l+t.length-1+i)}else l==-1&&(l=0,d.e.r=t.length-1+i);var h=n.header||[],u=0;t.forEach(function(m,g){It(m).forEach(function(x){(u=h.indexOf(x))==-1&&(h[u=h.length]=x);var v=m[x],w="z",_="",b=Ve({c:o+u,r:l+g+i});c=Cl(s,b),v&&typeof v=="object"&&!(v instanceof Date)?s[b]=v:(typeof v=="number"?w="n":typeof v=="boolean"?w="b":typeof v=="string"?w="s":v instanceof Date?(w="d",n.cellDates||(w="n",v=Jt(v)),_=n.dateNF||ze[14]):v===null&&n.nullError&&(w="e",v=0),c?(c.t=w,c.v=v,delete c.w,delete c.R,_&&(c.z=_)):s[b]=c={t:w,v},_&&(c.z=_))})}),d.e.c=Math.max(d.e.c,o+h.length-1);var p=Bt(l);if(i)for(u=0;u<h.length;++u)s[Nt(u+o)+p]={t:"s",v:h[u]};return s["!ref"]=Ke(d),s}function fI(e,t){return n_(null,e,t)}function Cl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=At(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Cl(e,Ve(t)):Cl(e,Ve({r:t,c:r||0}))}function hI(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function dp(){return{SheetNames:[],Sheets:{}}}function pp(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var l=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=l+i)!=-1;++i);}if(Bw(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function dI(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=hI(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function pI(e,t){return e.z=t,e}function i_(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function gI(e,t,r){return i_(e,"#"+t,r)}function mI(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function xI(e,t,r,n){for(var i=typeof t!="string"?t:st(t),s=typeof t=="string"?t:Ke(t),l=i.s.r;l<=i.e.r;++l)for(var o=i.s.c;o<=i.e.c;++o){var a=Cl(e,l,o);a.t="n",a.F=s,delete a.v,l==i.s.r&&o==i.s.c&&(a.f=r,n&&(a.D=!0))}return e}var ms={encode_col:Nt,encode_row:Bt,encode_cell:Ve,encode_range:Ke,decode_col:H0,decode_row:z0,split_cell:N4,decode_cell:At,decode_range:Br,format_cell:ui,sheet_add_aoa:Oy,sheet_add_json:n_,sheet_add_dom:Yw,aoa_to_sheet:Ja,json_to_sheet:fI,table_to_sheet:Gw,table_to_book:kR,sheet_to_csv:hp,sheet_to_txt:r_,sheet_to_json:Ou,sheet_to_html:Xw,sheet_to_formulae:uI,sheet_to_row_object_array:Ou,sheet_get_cell:Cl,book_new:dp,book_append_sheet:pp,book_set_sheet_visibility:dI,cell_set_number_format:pI,cell_set_hyperlink:i_,cell_set_internal_link:gI,cell_add_comment:mI,sheet_set_array_formula:xI,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const s_=({isMobileView:e=!1,externalZoneId:t=null,externalDate:r=null,externalSessionId:n=null})=>{const i=le.useRef(null),s=le.useRef(null),[l,o]=le.useState([]),[a,c]=le.useState(null),[d,f]=le.useState(new Date().toISOString().split("T")[0]),[h,u]=le.useState(null),[p,m]=le.useState([]),[g,x]=le.useState(!1),[v,w]=le.useState({present:0,absent:0,total:0}),[_,b]=le.useState(!1);le.useEffect(()=>{k()},[]),le.useEffect(()=>{t&&c(t)},[t]),le.useEffect(()=>{r&&f(r)},[r]),le.useEffect(()=>{n&&u(n)},[n]);const k=async()=>{x(!0);const{data:G}=await we.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});G&&G.length>0&&(o(G),c(G[0].id))};le.useEffect(()=>{a&&S(a)},[a]);const S=async G=>{const{data:Q}=await we.from("sessions").select("*").eq("zone_id",G).order("start_time",{ascending:!0});if(Q){m(Q);const K=new Date().toISOString().split("T")[0];if(d===K){const ne=new Date,J=ne.getHours().toString().padStart(2,"0")+":"+ne.getMinutes().toString().padStart(2,"0")+":00",T=Q.find(j=>J>=j.start_time&&J<=j.end_time);T?u(T.id):Q.length>0&&u(Q[0].id)}else Q.length>0&&u(Q[0].id)}};le.useEffect(()=>{const G=new Date().toISOString().split("T")[0];if(d===G&&p.length>0){const Q=new Date,K=Q.getHours().toString().padStart(2,"0")+":"+Q.getMinutes().toString().padStart(2,"0")+":00",ne=p.find(J=>K>=J.start_time&&K<=J.end_time);ne&&u(ne.id)}},[d]),le.useEffect(()=>{if(!i.current||!a||!h)return;s.current&&s.current.dispose(),i.current.innerHTML="";const G=document.createElement("canvas");i.current.appendChild(G);const Q=new $e.fabric.Canvas(G,{backgroundColor:"transparent",selection:!1,allowTouchScrolling:!0});s.current=Q,(async()=>{await O(p)})();let ne=!1,J,T,j,B;Q.on("mouse:down",R=>{var L,z,ee;const N=R.e,C=R.target;if((L=R.subTargets)==null?void 0:L.find(A=>A.name==="actionButton"||A.name==="actionLabel")){M(C);return}ne=!0;const I=N.type==="touchstart"?N.touches[0]:N;J=I.clientX,T=I.clientY;const H=((z=i.current)==null?void 0:z.closest(".mobile-seatmap-container"))||((ee=i.current)==null?void 0:ee.parentElement);H&&(j=H.scrollLeft,B=H.scrollTop)}),Q.on("mouse:move",R=>{var L,z;if(!ne)return;const N=R.e,C=N.type==="touchmove"?N.touches[0]:N,P=C.clientX-J,I=C.clientY-T,H=((L=i.current)==null?void 0:L.closest(".mobile-seatmap-container"))||((z=i.current)==null?void 0:z.parentElement);H&&(H.scrollLeft=j-P,H.scrollTop=B-I)}),Q.on("mouse:up",()=>{ne=!1}),Q.on("mouse:out",()=>{});const E=we.channel("attendance_changes").on("postgres_changes",{event:"*",schema:"public",table:"attendance"},()=>{O(p)}).subscribe(R=>{b(R==="SUBSCRIBED")});return()=>{we.removeChannel(E),Q.dispose(),s.current=null}},[h,a,d,n,t,r,p]);const O=async G=>{if(!s.current||!a||!h)return;x(!0);const{data:Q}=await we.from("seats").select("*").eq("zone_id",a).order("global_number",{ascending:!0}),K=d,ne=U().split("T")[0],J=K===ne,{data:T}=await we.from("bookings").select(`
          *,
          profiles(full_name, username),
          attendance(id, status, timestamp_in, timestamp_out)
        `).eq("date",K);if(T&&T.length>0){const ce=new Date(new Date().getTime()+324e5).toISOString().split("T")[1].substring(0,8),ue=[];if(T.forEach(xe=>{const _e=G.find(ve=>ve.id===xe.session_id);if(!_e)return;const fe=Array.isArray(xe.attendance)?xe.attendance[0]:xe.attendance;if(fe&&(fe.status==="present"||fe.status==="late")&&!fe.timestamp_out){const ve=_e.end_time.length===5?_e.end_time+":00":_e.end_time;(K<ne||J&&ve<ce)&&ue.push({id:fe.id,timestamp_out:`${K}T${ve}+09:00`,updated_at:new Date().toISOString()})}}),ue.length>0){const{error:xe}=await we.from("attendance").upsert(ue);xe||ue.forEach(_e=>{const fe=T.find(ve=>{var De,Re;return(Array.isArray(ve.attendance)?(De=ve.attendance[0])==null?void 0:De.id:(Re=ve.attendance)==null?void 0:Re.id)===_e.id});fe&&(Array.isArray(fe.attendance)?fe.attendance[0].timestamp_out=_e.timestamp_out:fe.attendance.timestamp_out=_e.timestamp_out)})}}s.current&&s.current.clear();const j=Q||[];if(j.length===0){x(!1);return}const B=j.map(Y=>Y.pos_x).filter(Y=>typeof Y=="number"&&!isNaN(Y)),E=j.map(Y=>Y.pos_y).filter(Y=>typeof Y=="number"&&!isNaN(Y));if(B.length===0||E.length===0){x(!1);return}const R=Math.min(...B),N=Math.max(...j.map(Y=>Y.pos_x+(Y.width||72)).filter(Y=>!isNaN(Y))),C=Math.min(...E),P=Math.max(...j.map(Y=>Y.pos_y+(Y.height||72)).filter(Y=>!isNaN(Y))),I=N-R,H=P-C,L=I+40,z=H+40,ee=20-R,A=20-C;s.current&&(s.current.setDimensions({width:L,height:z}),i.current&&(i.current.style.width=`${L}px`,i.current.style.height=`${z}px`));let V=G==null?void 0:G.find(Y=>Y.id===h);if(!V&&J){const Y=new Date,ce=Y.getHours().toString().padStart(2,"0")+":"+Y.getMinutes().toString().padStart(2,"0")+":00";V=G==null?void 0:G.find(ue=>ce>=ue.start_time&&ce<=ue.end_time)}let W=0;const ae=((T==null?void 0:T.filter(Y=>Y.session_id===h))||[]).length;Q.forEach(Y=>{if(Y.type==="structure"){F({...Y,pos_x:Y.pos_x+ee,pos_y:Y.pos_y+A},null,null,[],null,G,!1);return}const ce=(T==null?void 0:T.filter(ve=>ve.seat_id===Y.id))||[],ue=ce.find(ve=>ve.session_id===h),xe=Array.isArray(ue==null?void 0:ue.attendance)?ue.attendance[0]:(ue==null?void 0:ue.attendance)||null;let _e=(xe==null?void 0:xe.status)||"absent";if(J&&ue&&!xe&&h&&G){const ve=G.find(Ce=>Ce.id===h);if(ve){const Ce=new Date,De=Ce.getHours().toString().padStart(2,"0")+":"+Ce.getMinutes().toString().padStart(2,"0")+":00";ve.end_time<De&&(_e="absent")}}const fe=ce.length>0;ue&&_e==="present"&&W++,F({...Y,pos_x:Y.pos_x+ee,pos_y:Y.pos_y+A},ue,_e,ce,V,G,fe)}),w({present:W,absent:ae-W,total:ae,rate:ae>0?Math.round(W/ae*100):0}),x(!1)},F=(G,Q,K,ne,J,T,j,B)=>{if(G.type==="structure"){const ee=new $e.fabric.Rect({fill:"#E5E5EA",width:G.width||72,height:G.height||72,rx:6,ry:6,stroke:"#D1D1D6",strokeWidth:1}),A=new $e.fabric.IText(G.label||"",{fontSize:10,originX:"center",originY:"center",left:(G.width||72)/2,top:(G.height||72)/2,fill:"#AEAEB2",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),V=new $e.fabric.Group([ee,A],{left:G.pos_x,top:G.pos_y,angle:G.rotation,selectable:!1,evented:!1,data:{...G}});s.current.add(V);return}const E=!!Q,R=j,N=G.zone_color||"#5E5CE6",C=new $e.fabric.Rect({fill:"#FFFFFF",width:71,height:71,rx:6,ry:6,stroke:"#E5E5EA",strokeWidth:1,left:.5,top:.5,originX:"left",originY:"top",selectable:!1}),P=new $e.fabric.Path("M 0 6 Q 0 0 6 0 L 66 0 Q 72 0 72 6 L 72 18 L 0 18 z",{fill:N,strokeWidth:0,left:0,top:0,originX:"left",originY:"top",selectable:!1});let I=[C,P];if(E){const ee=Array.isArray(Q==null?void 0:Q.attendance)?Q.attendance[0]:(Q==null?void 0:Q.attendance)||null,V=(K==="present"||K==="late")&&!(ee!=null&&ee.timestamp_out)?"#00FF00":"#FF3B30",W=new $e.fabric.Circle({radius:3,fill:V,left:58,top:9,originX:"center",originY:"center",selectable:!1,stroke:"rgba(255,255,255,0.8)",strokeWidth:1.5});I.push(W)}const H=new $e.fabric.IText(G.display_number||G.seat_number,{fontSize:10,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"900",fill:"#ffffff",left:36,top:9,originX:"center",originY:"center",selectable:!1});if(I.push(H),E){const ee=Q==null?void 0:Q.profiles,A=ee?`${ee.username?ee.username+" ":""}${ee.full_name}`:"  ",V=new $e.fabric.IText(A,{fontSize:10,textAlign:"center",originX:"center",originY:"center",left:36,top:34,fill:"#1C1C1E",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1});I.push(V);const W=Array.isArray(Q==null?void 0:Q.attendance)?Q.attendance[0]:(Q==null?void 0:Q.attendance)||null,te=!!(W!=null&&W.timestamp_out),ae=(K==="present"||K==="late")&&!te;let Y="",ce="",ue="#8E8E93",xe="#F2F2F7",_e=N,fe="#FFFFFF",ve=!1;ae?(Y="",ce="",ue="#FFFFFF",xe=N,_e="#FFFFFF",fe=N,ve=!0):te&&(Y="",ce="",ue="#1C1C1E",xe="#F2F2F7",_e=N,fe="#FFFFFF");const Ce="M 0 50 L 36 50 L 36 72 L 6 72 Q 0 72 0 66 Z",De=new $e.fabric.Path(Ce,{fill:xe,selectable:!1}),Re=new $e.fabric.IText(Y,{fontSize:8,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",fill:ue,originX:"center",originY:"center",left:18,top:61,selectable:!1}),Me="M 36 50 L 72 50 L 72 66 Q 72 72 66 72 L 36 72 Z",Ye=new $e.fabric.Path(Me,{fill:_e,stroke:ve?N:null,strokeWidth:ve?1:0,selectable:!1,hoverCursor:"pointer",name:"actionButton"}),tt=new $e.fabric.IText(ce,{fontSize:8,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",fill:fe,originX:"center",originY:"center",left:54,top:61,selectable:!1,name:"actionLabel"});I.push(De,Re,Ye,tt)}else{const ee=new $e.fabric.IText("",{fontSize:12,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",fill:"#E5E5EA",left:36,top:34,originX:"center",originY:"center",selectable:!1}),A="M 0 50 L 72 50 L 72 66 Q 72 72 66 72 L 6 72 Q 0 72 0 66 Z",V=new $e.fabric.Path(A,{fill:"#F2F2F7",opacity:.3,selectable:!1}),W=new $e.fabric.IText("-",{fontSize:10,fill:"#AEAEB2",left:36,top:61,originX:"center",originY:"center",selectable:!1});I.push(ee,V,W)}let L=1;E||(L=R?.4:.15);const z=new $e.fabric.Group(I,{left:G.pos_x,top:G.pos_y,opacity:L,angle:G.rotation,data:{...G,booking:Q,status:K},selectable:!1,hoverCursor:E?"pointer":"default",subTargetCheck:!0});s.current.add(z)},D=G=>{const Q=new Date(d);Q.setDate(Q.getDate()+G),f(Q.toISOString().split("T")[0])},U=()=>{const G=new Date,Q=9*60*60*1e3;return new Date(G.getTime()+Q).toISOString().replace("Z","+09:00")},M=async G=>{const{booking:Q,status:K}=G.data;if(!Q)return;const ne=p.find(B=>B.id===Q.session_id);if(!ne)return;const J=Array.isArray(Q.attendance)?Q.attendance[0]:Q.attendance||null,T=!!(J!=null&&J.timestamp_out);if((K==="present"||K==="late")&&!T){const{error:B}=await we.from("attendance").update({timestamp_out:U(),updated_at:new Date().toISOString()}).eq("id",J.id);B&&console.error("Error during check-out:",B),B||await O(p)}else if(T){const{error:B}=await we.from("attendance").update({status:"absent",timestamp_in:null,timestamp_out:null,updated_at:new Date().toISOString()}).eq("id",J.id);B&&console.error("Error during reset to absent:",B),B||await O(p)}else{const B=(ne==null?void 0:ne.start_time)||"00:00:00",E={booking_id:Q.id,status:"present",timestamp_in:`${d}T${B}${B.length===5?":00":""}+09:00`,timestamp_out:null,updated_at:new Date().toISOString()};J!=null&&J.id&&(E.id=J.id);const{error:R}=await we.from("attendance").upsert(E,{onConflict:"booking_id"});R?console.error("Error during attendance upsert:",R):await O(p)}},q=()=>{const G=s.current.getObjects().map(ne=>{var J,T;return{ID:ne.data.global_number,:ne.data.display_number,:((T=(J=ne.data.booking)==null?void 0:J.profiles)==null?void 0:T.full_name)||"",:ne.data.status==="present"?"":"",:ne.data.zone_name,:d}}),Q=ms.json_to_sheet(G),K=ms.book_new();ms.book_append_sheet(K,Q,""),t_(K,`_${d}.xlsx`)};return y.jsxs("div",{className:`flex flex-col gap-4 w-full ${e?"min-h-fit":"h-full"} pt-[10px]`,children:[!e&&y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between px-2",children:[y.jsxs("div",{className:"flex items-center gap-4 ml-[10px] mt-[10px]",children:[y.jsx("div",{className:"flex gap-[10px]",children:l.map(G=>y.jsx("button",{onClick:()=>c(G.id),className:`h-8 px-4 rounded-[8px] text-[11px] font-black transition-all ios-tap flex items-center justify-center border-none outline-none ring-0 ${a===G.id?"bg-[#1C1C1E] text-white shadow-md":"bg-gray-100 text-ios-gray hover:bg-gray-200"}`,children:G.name},G.id))}),y.jsxs("div",{className:"flex items-center bg-gray-100 p-0.5 rounded-[8px] border border-gray-200 h-8",children:[y.jsx("button",{onClick:()=>D(-1),className:"h-7 px-2.5 rounded-[6px] hover:bg-white text-ios-gray transition-all text-[12px] flex items-center justify-center",children:"<"}),y.jsxs("span",{className:"h-7 px-3 text-[11px] font-black min-w-[90px] text-center flex items-center justify-center",children:[d," (",["","","","","","",""][new Date(d).getDay()],")"]}),y.jsx("button",{onClick:()=>D(1),className:"h-7 px-2.5 rounded-[6px] hover:bg-white text-ios-gray transition-all text-[12px] flex items-center justify-center",children:">"})]}),y.jsx("div",{className:"flex bg-gray-100 pt-[3px] pb-[4px] px-0.5 rounded-[8px] border border-gray-200 h-8",children:p.map(G=>y.jsx("button",{onClick:()=>u(G.id),className:`h-[25px] px-5 rounded-[6px] text-[10px] font-black transition-all duration-300 ios-tap flex items-center justify-center ${h===G.id?"bg-[#1C1C1E] text-white shadow-md":"text-ios-gray hover:text-[#1C1C1E] hover:bg-gray-200/50"}`,children:G.name.toUpperCase()},G.id))})]}),y.jsxs("div",{className:"flex items-center gap-2 mr-[10px] mt-[10px]",children:[y.jsxs("button",{onClick:q,className:"flex items-center gap-2 bg-gray-50 hover:bg-gray-100 text-[#1C1C1E] h-8 px-4 rounded-[8px] text-[11px] font-black transition-all border border-gray-100 ios-tap",children:[y.jsx(Fv,{className:"w-3.5 h-3.5 text-ios-blue"})," "]}),y.jsx("div",{className:"bg-white h-8 px-3 rounded-[8px] shadow-sm border border-gray-100 flex items-center justify-center",title:_?"    .":"   ...",children:y.jsx("div",{className:`w-2 h-2 rounded-full shrink-0 border border-white shadow-sm transition-all duration-500 ${_?"bg-emerald-500 animate-pulse shadow-emerald-500/50":"bg-rose-500 opacity-80"}`})})]})]}),y.jsxs("div",{className:"flex items-center gap-2 px-2 ml-[10px]",children:[y.jsxs("div",{className:"flex items-center gap-1.5 bg-emerald-50 border border-emerald-100 px-3 py-1.5 rounded-[8px]",children:[y.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500"}),y.jsxs("span",{className:"text-[10px] font-black text-emerald-700",children:[" ",v.present]})]}),y.jsxs("div",{className:"flex items-center gap-1.5 bg-rose-50 border border-rose-100 px-3 py-1.5 rounded-[8px]",children:[y.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-rose-500"}),y.jsxs("span",{className:"text-[10px] font-black text-rose-700",children:[" ",v.absent]})]}),y.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-50 border border-gray-100 px-3 py-1.5 rounded-[8px]",children:[y.jsx(Dl,{className:"w-3 h-3 text-ios-gray"}),y.jsxs("span",{className:"text-[10px] font-black text-ios-gray",children:[" ",v.total]})]}),y.jsx("div",{className:"flex items-center gap-1.5 bg-ios-indigo/5 border border-ios-indigo/10 px-3 py-1.5 rounded-[8px]",children:y.jsxs("span",{className:"text-[10px] font-black text-ios-indigo",children:[" ",v.rate,"%"]})})]})]}),y.jsxs("div",{className:`${e?"w-full":"flex-1 flex flex-col w-full"} overflow-hidden relative`,children:[g&&y.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-30 flex items-center justify-center pointer-events-none",children:y.jsx("div",{className:"w-8 h-8 border-3 border-ios-indigo border-t-transparent rounded-full animate-spin"})}),y.jsx("div",{className:`${e?"w-full":"flex-1 w-full"} bg-white rounded-t-[6px] rounded-b-none border-0 overflow-hidden p-2.5 pb-0`,children:y.jsx("div",{ref:i,className:`relative overflow-hidden cursor-grab active:cursor-grabbing select-none scrollbar-hide ${e?"w-full min-h-[600px] h-auto touch-action-none":"flex-1 h-full"}`,style:e?{touchAction:"none"}:{}})})]})]})};function et(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Fn(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function Bi(e,t){const r=et(e);return isNaN(t)?Fn(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function $l(e,t){const r=et(e);if(isNaN(t))return Fn(e,NaN);if(!t)return r;const n=r.getDate(),i=Fn(e,r.getTime());i.setMonth(r.getMonth()+t+1,0);const s=i.getDate();return n>=s?i:(r.setFullYear(i.getFullYear(),i.getMonth(),n),r)}const a_=6048e5,vI=864e5,o_=6e4,l_=36e5;let yI={};function Vl(){return yI}function cr(e,t){var o,a,c,d;const r=Vl(),n=(t==null?void 0:t.weekStartsOn)??((a=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:a.weekStartsOn)??r.weekStartsOn??((d=(c=r.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??0,i=et(e),s=i.getDay(),l=(s<n?7:0)+s-n;return i.setDate(i.getDate()-l),i.setHours(0,0,0,0),i}function Fu(e){return cr(e,{weekStartsOn:1})}function c_(e){const t=et(e),r=t.getFullYear(),n=Fn(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const i=Fu(n),s=Fn(e,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);const l=Fu(s);return t.getTime()>=i.getTime()?r+1:t.getTime()>=l.getTime()?r:r-1}function Qn(e){const t=et(e);return t.setHours(0,0,0,0),t}function ux(e){const t=et(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function wI(e,t){const r=Qn(e),n=Qn(t),i=+r-ux(r),s=+n-ux(n);return Math.round((i-s)/vI)}function _I(e){const t=c_(e),r=Fn(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Fu(r)}function lf(e,t){const r=t*7;return Bi(e,r)}function bI(e){return Fn(e,Date.now())}function Ui(e,t){const r=Qn(e),n=Qn(t);return+r==+n}function SI(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Uc(e){if(!SI(e)&&typeof e!="number")return!1;const t=et(e);return!isNaN(Number(t))}function Tl(e){const t=et(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function $s(e,t){const r=et(e.start),n=et(e.end);let i=+r>+n;const s=i?+r:+n,l=i?n:r;l.setHours(0,0,0,0);let o=1;const a=[];for(;+l<=s;)a.push(et(l)),l.setDate(l.getDate()+o),l.setHours(0,0,0,0);return i?a.reverse():a}function kI(e,t){const r=et(e.start),n=et(e.end);let i=+r>+n;const s=i?+r:+n,l=i?n:r;l.setHours(0,0,0,0),l.setDate(1);let o=1;const a=[];for(;+l<=s;)a.push(et(l)),l.setMonth(l.getMonth()+o);return i?a.reverse():a}function CI(e){const t=et(e),r=t.getMonth(),n=r-r%3;return t.setMonth(n,1),t.setHours(0,0,0,0),t}function TI(e,t){const r=et(e.start),n=et(e.end);let i=+r>+n;const s=cr(i?n:r,t),l=cr(i?r:n,t);s.setHours(15),l.setHours(15);const o=+l.getTime();let a=s,c=(t==null?void 0:t.step)??1;if(!c)return[];c<0&&(c=-c,i=!i);const d=[];for(;+a<=o;)a.setHours(0),d.push(et(a)),a=lf(a,c),a.setHours(15);return i?d.reverse():d}function $a(e){const t=et(e);return t.setDate(1),t.setHours(0,0,0,0),t}function EI(e){const t=et(e),r=Fn(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function ii(e,t){var o,a,c,d;const r=Vl(),n=(t==null?void 0:t.weekStartsOn)??((a=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:a.weekStartsOn)??r.weekStartsOn??((d=(c=r.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??0,i=et(e),s=i.getDay(),l=(s<n?-7:0)+6-(s-n);return i.setDate(i.getDate()+l),i.setHours(23,59,59,999),i}function NI(e){const t=et(e),r=t.getMonth(),n=r-r%3+3;return t.setMonth(n,0),t.setHours(23,59,59,999),t}const AI={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},OI=(e,t,r)=>{let n;const i=AI[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function ja(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const FI={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},jI={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},PI={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},DI={date:ja({formats:FI,defaultWidth:"full"}),time:ja({formats:jI,defaultWidth:"full"}),dateTime:ja({formats:PI,defaultWidth:"full"})},RI={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},II=(e,t,r,n)=>RI[e];function Ln(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let i;if(n==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):l;i=e.formattingValues[o]||e.formattingValues[l]}else{const l=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;i=e.values[o]||e.values[l]}const s=e.argumentCallback?e.argumentCallback(t):t;return i[s]}}const MI={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},LI={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},BI={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},UI={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},WI={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},zI={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},HI=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},$I={ordinalNumber:HI,era:Ln({values:MI,defaultWidth:"wide"}),quarter:Ln({values:LI,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Ln({values:BI,defaultWidth:"wide"}),day:Ln({values:UI,defaultWidth:"wide"}),dayPeriod:Ln({values:WI,defaultWidth:"wide",formattingValues:zI,defaultFormattingWidth:"wide"})};function Bn(e){return(t,r={})=>{const n=r.width,i=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(i);if(!s)return null;const l=s[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],a=Array.isArray(o)?XI(o,f=>f.test(l)):VI(o,f=>f.test(l));let c;c=e.valueCallback?e.valueCallback(a):a,c=r.valueCallback?r.valueCallback(c):c;const d=t.slice(l.length);return{value:c,rest:d}}}function VI(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function XI(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function u_(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const i=n[0],s=t.match(e.parsePattern);if(!s)return null;let l=e.valueCallback?e.valueCallback(s[0]):s[0];l=r.valueCallback?r.valueCallback(l):l;const o=t.slice(i.length);return{value:l,rest:o}}}const YI=/^(\d+)(th|st|nd|rd)?/i,GI=/\d+/i,qI={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},KI={any:[/^b/i,/^(a|c)/i]},JI={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},QI={any:[/1/i,/2/i,/3/i,/4/i]},ZI={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},e6={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},t6={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},r6={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},n6={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},i6={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},s6={ordinalNumber:u_({matchPattern:YI,parsePattern:GI,valueCallback:e=>parseInt(e,10)}),era:Bn({matchPatterns:qI,defaultMatchWidth:"wide",parsePatterns:KI,defaultParseWidth:"any"}),quarter:Bn({matchPatterns:JI,defaultMatchWidth:"wide",parsePatterns:QI,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Bn({matchPatterns:ZI,defaultMatchWidth:"wide",parsePatterns:e6,defaultParseWidth:"any"}),day:Bn({matchPatterns:t6,defaultMatchWidth:"wide",parsePatterns:r6,defaultParseWidth:"any"}),dayPeriod:Bn({matchPatterns:n6,defaultMatchWidth:"any",parsePatterns:i6,defaultParseWidth:"any"})},a6={code:"en-US",formatDistance:OI,formatLong:DI,formatRelative:II,localize:$I,match:s6,options:{weekStartsOn:0,firstWeekContainsDate:1}};function o6(e){const t=et(e);return wI(t,EI(t))+1}function l6(e){const t=et(e),r=+Fu(t)-+_I(t);return Math.round(r/a_)+1}function f_(e,t){var d,f,h,u;const r=et(e),n=r.getFullYear(),i=Vl(),s=(t==null?void 0:t.firstWeekContainsDate)??((f=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??i.firstWeekContainsDate??((u=(h=i.locale)==null?void 0:h.options)==null?void 0:u.firstWeekContainsDate)??1,l=Fn(e,0);l.setFullYear(n+1,0,s),l.setHours(0,0,0,0);const o=cr(l,t),a=Fn(e,0);a.setFullYear(n,0,s),a.setHours(0,0,0,0);const c=cr(a,t);return r.getTime()>=o.getTime()?n+1:r.getTime()>=c.getTime()?n:n-1}function c6(e,t){var o,a,c,d;const r=Vl(),n=(t==null?void 0:t.firstWeekContainsDate)??((a=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:a.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(c=r.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??1,i=f_(e,t),s=Fn(e,0);return s.setFullYear(i,0,n),s.setHours(0,0,0,0),cr(s,t)}function u6(e,t){const r=et(e),n=+cr(r,t)-+c6(r,t);return Math.round(n/a_)+1}function ct(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const yi={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return ct(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):ct(r+1,2)},d(e,t){return ct(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return ct(e.getHours()%12||12,t.length)},H(e,t){return ct(e.getHours(),t.length)},m(e,t){return ct(e.getMinutes(),t.length)},s(e,t){return ct(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),i=Math.trunc(n*Math.pow(10,r-3));return ct(i,t.length)}},ta={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},fx={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),i=n>0?n:1-n;return r.ordinalNumber(i,{unit:"year"})}return yi.y(e,t)},Y:function(e,t,r,n){const i=f_(e,n),s=i>0?i:1-i;if(t==="YY"){const l=s%100;return ct(l,2)}return t==="Yo"?r.ordinalNumber(s,{unit:"year"}):ct(s,t.length)},R:function(e,t){const r=c_(e);return ct(r,t.length)},u:function(e,t){const r=e.getFullYear();return ct(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return ct(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return ct(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return yi.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return ct(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const i=u6(e,n);return t==="wo"?r.ordinalNumber(i,{unit:"week"}):ct(i,t.length)},I:function(e,t,r){const n=l6(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):ct(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):yi.d(e,t)},D:function(e,t,r){const n=o6(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):ct(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return ct(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});case"eeee":default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return ct(s,t.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});case"cccc":default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),i=n===0?7:n;switch(t){case"i":return String(i);case"ii":return ct(i,t.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let i;switch(n===12?i=ta.noon:n===0?i=ta.midnight:i=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let i;switch(n>=17?i=ta.evening:n>=12?i=ta.afternoon:n>=4?i=ta.morning:i=ta.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return yi.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):yi.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):ct(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):ct(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):yi.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):yi.s(e,t)},S:function(e,t){return yi.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return dx(n);case"XXXX":case"XX":return os(n);case"XXXXX":case"XXX":default:return os(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return dx(n);case"xxxx":case"xx":return os(n);case"xxxxx":case"xxx":default:return os(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+hx(n,":");case"OOOO":default:return"GMT"+os(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+hx(n,":");case"zzzz":default:return"GMT"+os(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return ct(n,t.length)},T:function(e,t,r){const n=e.getTime();return ct(n,t.length)}};function hx(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=Math.trunc(n/60),s=n%60;return s===0?r+String(i):r+String(i)+t+ct(s,2)}function dx(e,t){return e%60===0?(e>0?"-":"+")+ct(Math.abs(e)/60,2):os(e,t)}function os(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=ct(Math.trunc(n/60),2),s=ct(n%60,2);return r+i+t+s}const px=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},h_=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},f6=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return px(e,t);let s;switch(n){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",px(n,t)).replace("{{time}}",h_(i,t))},h6={p:h_,P:f6},d6=/^D+$/,p6=/^Y+$/,g6=["D","DD","YY","YYYY"];function m6(e){return d6.test(e)}function x6(e){return p6.test(e)}function v6(e,t,r){const n=y6(e,t,r);if(console.warn(n),g6.includes(e))throw new RangeError(n)}function y6(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const w6=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,_6=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,b6=/^'([^]*?)'?$/,S6=/''/g,k6=/[a-zA-Z]/;function Ee(e,t,r){var d,f,h,u,p,m,g,x;const n=Vl(),i=(r==null?void 0:r.locale)??n.locale??a6,s=(r==null?void 0:r.firstWeekContainsDate)??((f=(d=r==null?void 0:r.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(h=n.locale)==null?void 0:h.options)==null?void 0:u.firstWeekContainsDate)??1,l=(r==null?void 0:r.weekStartsOn)??((m=(p=r==null?void 0:r.locale)==null?void 0:p.options)==null?void 0:m.weekStartsOn)??n.weekStartsOn??((x=(g=n.locale)==null?void 0:g.options)==null?void 0:x.weekStartsOn)??0,o=et(e);if(!Uc(o))throw new RangeError("Invalid time value");let a=t.match(_6).map(v=>{const w=v[0];if(w==="p"||w==="P"){const _=h6[w];return _(v,i.formatLong)}return v}).join("").match(w6).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const w=v[0];if(w==="'")return{isToken:!1,value:C6(v)};if(fx[w])return{isToken:!0,value:v};if(w.match(k6))throw new RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");return{isToken:!1,value:v}});i.localize.preprocessor&&(a=i.localize.preprocessor(o,a));const c={firstWeekContainsDate:s,weekStartsOn:l,locale:i};return a.map(v=>{if(!v.isToken)return v.value;const w=v.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&x6(w)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&m6(w))&&v6(w,t,String(e));const _=fx[w[0]];return _(o,w,i.localize,c)}).join("")}function C6(e){const t=e.match(b6);return t?t[1].replace(S6,"'"):e}function T6(e,t){const r=et(e),n=et(t);return r.getTime()>n.getTime()}function Wc(e,t){const r=et(e),n=et(t);return+r<+n}function E6(e){return+et(e)<Date.now()}function Nd(e,t){const r=et(e),n=et(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function gp(e){return Ui(e,bI(e))}function El(e,t){const r=+et(e),[n,i]=[+et(t.start),+et(t.end)].sort((s,l)=>s-l);return r>=n&&r<=i}function Ad(e,t){return Bi(e,-t)}function Et(e,t){const n=F6(e);let i;if(n.date){const a=j6(n.date,2);i=P6(a.restDateString,a.year)}if(!i||isNaN(i.getTime()))return new Date(NaN);const s=i.getTime();let l=0,o;if(n.time&&(l=D6(n.time),isNaN(l)))return new Date(NaN);if(n.timezone){if(o=R6(n.timezone),isNaN(o))return new Date(NaN)}else{const a=new Date(s+l),c=new Date(0);return c.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),c.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),c}return new Date(s+l+o)}const Ec={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},N6=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,A6=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,O6=/^([+-])(\d{2})(?::?(\d{2}))?$/;function F6(e){const t={},r=e.split(Ec.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],Ec.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Ec.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const i=Ec.timezone.exec(n);i?(t.time=n.replace(i[1],""),t.timezone=i[1]):t.time=n}return t}function j6(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const i=n[1]?parseInt(n[1]):null,s=n[2]?parseInt(n[2]):null;return{year:s===null?i:s*100,restDateString:e.slice((n[1]||n[2]).length)}}function P6(e,t){if(t===null)return new Date(NaN);const r=e.match(N6);if(!r)return new Date(NaN);const n=!!r[4],i=ho(r[1]),s=ho(r[2])-1,l=ho(r[3]),o=ho(r[4]),a=ho(r[5])-1;if(n)return U6(t,o,a)?I6(t,o,a):new Date(NaN);{const c=new Date(0);return!L6(t,s,l)||!B6(t,i)?new Date(NaN):(c.setUTCFullYear(t,s,Math.max(i,l)),c)}}function ho(e){return e?parseInt(e):1}function D6(e){const t=e.match(A6);if(!t)return NaN;const r=ch(t[1]),n=ch(t[2]),i=ch(t[3]);return W6(r,n,i)?r*l_+n*o_+i*1e3:NaN}function ch(e){return e&&parseFloat(e.replace(",","."))||0}function R6(e){if(e==="Z")return 0;const t=e.match(O6);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;return z6(n,i)?r*(n*l_+i*o_):NaN}function I6(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const i=n.getUTCDay()||7,s=(t-1)*7+r+1-i;return n.setUTCDate(n.getUTCDate()+s),n}const M6=[31,null,31,30,31,30,31,31,30,31,30,31];function d_(e){return e%400===0||e%4===0&&e%100!==0}function L6(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(M6[t]||(d_(e)?29:28))}function B6(e,t){return t>=1&&t<=(d_(e)?366:365)}function U6(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function W6(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function z6(e,t){return t>=0&&t<=59}function H6(e,t){const r=et(e);return r.setDate(t),r}function cf(e,t){return $l(e,-1)}function p_(e,t){return lf(e,-1)}const $6={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},V6=(e,t,r)=>{let n;const i=$6[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?n+" ":n+" ":n},X6={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},Y6={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},G6={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},q6={date:ja({formats:X6,defaultWidth:"full"}),time:ja({formats:Y6,defaultWidth:"full"}),dateTime:ja({formats:G6,defaultWidth:"full"})},K6={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},J6=(e,t,r,n)=>K6[e],Q6={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},Z6={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},e8={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},t8={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},r8={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},n8={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},i8=(e,t)=>{const r=Number(e);switch(String(t==null?void 0:t.unit)){case"minute":case"second":return String(r);case"date":return r+"";default:return r+""}},s8={ordinalNumber:i8,era:Ln({values:Q6,defaultWidth:"wide"}),quarter:Ln({values:Z6,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Ln({values:e8,defaultWidth:"wide"}),day:Ln({values:t8,defaultWidth:"wide"}),dayPeriod:Ln({values:r8,defaultWidth:"wide",formattingValues:n8,defaultFormattingWidth:"wide"})},a8=/^(\d+)(|)?/i,o8=/\d+/i,l8={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},c8={any:[/^(bc|)/i,/^(ad|)/i]},u8={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},f8={any:[/1/i,/2/i,/3/i,/4/i]},h8={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},d8={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},p8={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},g8={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},m8={any:/^(am|pm|||||||)/i},x8={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},v8={ordinalNumber:u_({matchPattern:a8,parsePattern:o8,valueCallback:e=>parseInt(e,10)}),era:Bn({matchPatterns:l8,defaultMatchWidth:"wide",parsePatterns:c8,defaultParseWidth:"any"}),quarter:Bn({matchPatterns:u8,defaultMatchWidth:"wide",parsePatterns:f8,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Bn({matchPatterns:h8,defaultMatchWidth:"wide",parsePatterns:d8,defaultParseWidth:"any"}),day:Bn({matchPatterns:p8,defaultMatchWidth:"wide",parsePatterns:g8,defaultParseWidth:"any"}),dayPeriod:Bn({matchPatterns:m8,defaultMatchWidth:"any",parsePatterns:x8,defaultParseWidth:"any"})},Yt={code:"ko",formatDistance:V6,formatLong:q6,formatRelative:J6,localize:s8,match:v8,options:{weekStartsOn:0,firstWeekContainsDate:1}},y8=({onSave:e,onCancel:t})=>{const r=le.useRef(null),[n,i]=le.useState(!1),[s,l]=le.useState(!1);le.useEffect(()=>{const u=r.current;if(!u)return;const p=u.getContext("2d"),m=window.devicePixelRatio||1,g=u.getBoundingClientRect();u.width=g.width*m,u.height=g.height*m,p.scale(m,m),p.strokeStyle="black",p.lineWidth=10,p.lineCap="round"},[]);const o=u=>{const m=r.current.getBoundingClientRect(),g=u.touches?u.touches[0].clientX:u.clientX,x=u.touches?u.touches[0].clientY:u.clientY;return{x:g-m.left,y:x-m.top}},a=u=>{i(!0);const{x:p,y:m}=o(u),g=r.current.getContext("2d");g.strokeStyle="black",g.lineWidth=10,g.lineCap="round",g.beginPath(),g.moveTo(p,m)},c=u=>{if(!n)return;const{x:p,y:m}=o(u),g=r.current.getContext("2d");g.lineTo(p,m),g.stroke(),l(!0)},d=()=>{i(!1)},f=()=>{const u=r.current;u.getContext("2d").clearRect(0,0,u.width,u.height),l(!1)},h=()=>{if(!s){alert("  .");return}r.current.toBlob(p=>{e(p)},"image/png")};return y.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-fade-in",onClick:t,children:y.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden animate-spring-up",onClick:u=>u.stopPropagation(),children:[y.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[y.jsxs("h4",{className:"text-sm font-black text-[#1C1C1E] flex items-center gap-2",children:[y.jsx(k0,{className:"w-4 h-4 text-ios-indigo"}),"  "]}),y.jsx("button",{onClick:t,className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:y.jsx(Ta,{className:"w-5 h-5"})})]}),y.jsxs("div",{className:"p-6 bg-white flex flex-col items-center gap-4",children:[y.jsx("p",{className:"text-xs text-ios-gray mb-2",children:"    ."}),y.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-xl bg-gray-50 touch-none overflow-hidden relative w-full h-[200px]",children:y.jsx("canvas",{ref:r,style:{width:"100%",height:"100%"},onMouseDown:a,onMouseMove:c,onMouseUp:d,onMouseLeave:d,onTouchStart:a,onTouchMove:c,onTouchEnd:d})})]}),y.jsxs("div",{className:"p-4 border-t border-gray-100 flex gap-3 bg-gray-50",children:[y.jsx("button",{onClick:f,className:"flex-1 py-3 bg-white border border-gray-200 text-[#1C1C1E] rounded-xl text-xs font-bold hover:bg-gray-50 transition-all",children:""}),y.jsxs("button",{onClick:h,className:"flex-[2] py-3 bg-[#1C1C1E] text-white rounded-xl text-xs font-bold hover:bg-gray-800 shadow-lg transition-all flex items-center justify-center gap-2",children:[y.jsx(En,{className:"w-4 h-4"}),"  "]})]})]})})},w8=()=>{const[e,t]=le.useState(new Date),[r,n]=le.useState([]),[i,s]=le.useState([]),[l,o]=le.useState(null),[a,c]=le.useState(!1),[d,f]=le.useState(null),[h,u]=le.useState([]),[p,m]=le.useState([]),[g,x]=le.useState([]),w=e.getMonth()+1<3?e.getFullYear()-1:e.getFullYear(),[_,b]=le.useState(null),[k,S]=le.useState(null),[O,F]=le.useState(null),[D,U]=le.useState(!1),[M,q]=le.useState(null),[G,Q]=le.useState(""),[K,ne]=le.useState(!1);le.useEffect(()=>{j(),J()},[]),le.useEffect(()=>{l&&T()},[w,l]),le.useEffect(()=>{l&&B()},[e,l]);const J=async()=>{const{data:A}=await we.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});A&&A.length>0&&(s(A),o(A[0].id))},T=async()=>{const[A,V,W]=await Promise.all([we.from("operation_quarters").select("*").eq("academic_year",w).order("quarter",{ascending:!0}),we.from("operation_defaults").select("*"),we.from("operation_exceptions").select("*")]);A.data&&u(A.data),V.data&&m(V.data),W.data&&x(W.data)},j=async()=>{const{data:{user:A}}=await we.auth.getUser();if(A){const{data:V}=await we.from("profiles").select("*").eq("id",A.id).single();f({...A,profile:V})}},B=async()=>{if(!l)return;c(!0);const A=$a(e).toISOString(),V=Tl(e).toISOString(),{data:W,error:te}=await we.from("supervision_assignments").select("*").eq("zone_id",l).gte("date",A).lte("date",V).order("created_at",{ascending:!0});W&&n(W),c(!1)},E=async()=>{if(!G.trim()||!_||!l)return;const A=Ee(_.date,"yyyy-MM-dd"),{error:V}=await we.from("supervision_assignments").insert([{date:A,supervisor_name:G.trim(),teacher_id:null,zone_id:l}]);V?alert("  : "+V.message):(Q(""),b(null),B())},R=async()=>{if(!G.trim()||!k)return;const{error:A}=await we.from("supervision_assignments").update({supervisor_name:G.trim()}).eq("id",k.id);A?alert(" : "+A.message):(Q(""),S(null),B())},N=A=>{if(!A)return null;const V=A.split("/signatures/");return V.length>1?V[1]:null},C=async(A,V)=>{if(V.stopPropagation(),!confirm(" ?   ."))return;const W=r.find(ae=>ae.id===A);if(W!=null&&W.signature_url){const ae=N(W.signature_url);ae&&await we.storage.from("signatures").remove([ae])}const{error:te}=await we.from("supervision_assignments").delete().eq("id",A);te||B()},P=async A=>{if(!O)return;const V=r.find(ue=>ue.id===O.assignmentId);if(V!=null&&V.signature_url){const ue=N(V.signature_url);ue&&await we.storage.from("signatures").remove([ue])}const W=`sig_${O.assignmentId}_${Date.now()}.png`,{data:te,error:ae}=await we.storage.from("signatures").upload(W,A,{contentType:"image/png",upsert:!0});if(ae){alert("  : "+ae.message);return}const{data:{publicUrl:Y}}=we.storage.from("signatures").getPublicUrl(W),{error:ce}=await we.from("supervision_assignments").update({signature_url:Y}).eq("id",O.assignmentId);ce?alert("  : "+ce.message):(F(null),B())},I=()=>{U(!0)},H=async A=>{if(!l)return;c(!0);const{data:V,error:W}=await we.from("supervision_assignments").select("*").eq("zone_id",l).gte("date",A.start_date).lte("date",A.end_date).order("date",{ascending:!0});if(W){alert("  : "+W.message),c(!1);return}q({quarter:A,assignments:V||[],defaults:p,exceptions:g}),U(!1),c(!1),setTimeout(()=>{window.print()},500)},L=()=>y.jsxs("div",{className:"flex items-center justify-between mb-6",children:[y.jsxs("div",{className:"flex items-center gap-6",children:[y.jsxs("div",{className:"flex items-center gap-4",children:[y.jsx("h3",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:Ee(e,"yyyy M")}),y.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-xl border border-gray-200",children:[y.jsx("button",{onClick:()=>t(cf(e)),className:"p-1.5 hover:bg-white rounded-lg text-ios-gray hover:text-[#1C1C1E] transition-all ios-tap shadow-sm hover:shadow",children:y.jsx(ci,{className:"w-4 h-4"})}),y.jsx("button",{onClick:()=>t($l(e,1)),className:"p-1.5 hover:bg-white rounded-lg text-ios-gray hover:text-[#1C1C1E] transition-all ios-tap shadow-sm hover:shadow",children:y.jsx(qr,{className:"w-4 h-4"})})]})]}),y.jsx("div",{className:"flex bg-gray-100 p-1 rounded-xl border border-gray-200",children:i.map(A=>y.jsx("button",{onClick:()=>o(A.id),className:`px-4 py-1.5 rounded-lg text-xs font-black transition-all ios-tap ${l===A.id?"bg-white text-[#1C1C1E] shadow-sm":"text-ios-gray hover:text-[#1C1C1E]"}`,children:A.name},A.id))})]}),y.jsxs("div",{className:"flex items-center gap-4",children:[y.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group select-none",children:[y.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${K?"bg-[#1C1C1E] border-[#1C1C1E]":"bg-white border-gray-300 group-hover:border-gray-400"}`,children:K&&y.jsx(En,{className:"w-3 h-3 text-white"})}),y.jsx("input",{type:"checkbox",checked:K,onChange:A=>ne(A.target.checked),className:"hidden"}),y.jsx("span",{className:"text-xs font-bold text-ios-gray group-hover:text-[#1C1C1E] transition-colors",children:" "})]}),y.jsxs("button",{onClick:I,className:"flex items-center gap-2 bg-[#1C1C1E] text-white px-4 py-2 rounded-lg font-bold text-xs transition-all shadow-lg hover:bg-gray-800 hover:shadow-xl ios-tap",children:[y.jsx(du,{className:"w-3.5 h-3.5"}),"  "]})]})]}),z=()=>{const A=["","","","","","",""],V=K?A:A.filter((W,te)=>te!==0&&te!==6);return y.jsx("div",{className:`grid ${K?"grid-cols-7":"grid-cols-5"} mb-2 border-b border-gray-100`,children:V.map((W,te)=>y.jsx("div",{className:`py-3 text-[10px] font-black uppercase text-center tracking-widest ${K&&te===0?"text-ios-rose":K&&te===6?"text-ios-indigo":"text-ios-gray"}`,children:W},te))})},ee=()=>{const A=$a(e),V=Tl(A),W=cr(A),te=ii(V),ae=$s({start:W,end:te});return y.jsx("div",{className:`grid ${K?"grid-cols-7":"grid-cols-5"} gap-px bg-gray-100 border border-gray-100 rounded-[12px] overflow-hidden shadow-sm`,children:ae.filter(Y=>K||Y.getDay()!==0&&Y.getDay()!==6).map((Y,ce)=>{var pt;const ue=gp(Y),xe=Nd(Y,A),_e=Y.getDay(),fe=Ee(Y,"yyyy-MM-dd"),ve=r.filter(Ge=>Ge.date===fe),Ce=g.find(Ge=>Ge.exception_date===fe),De=h.find(Ge=>Ge.start_date&&Ge.end_date&&El(Y,{start:Et(Ge.start_date),end:Et(Ge.end_date)})),Re=p.find(Ge=>Ge.day_of_week===_e),Me=De&&!Ce&&((Re==null?void 0:Re.morning)||(Re==null?void 0:Re.dinner)||(Re==null?void 0:Re.period1)||(Re==null?void 0:Re.period2)),Ye=Re&&!Re.period1&&!Re.period2,tt=Me?Ye?1:2:0,Ue=((pt=d==null?void 0:d.profile)==null?void 0:pt.role)==="admin",ot=Ue||ue;return y.jsxs("div",{className:`h-[200px] p-2 flex flex-col gap-2 transition-colors border-b border-r border-gray-100 ${xe?Me?"bg-white":"bg-gray-50":"bg-gray-50/50 opacity-40"}`,children:[y.jsxs("div",{className:"flex justify-between items-start",children:[y.jsx("span",{className:`text-[12px] font-black ${ue?"w-6 h-6 text-ios-indigo border-2 border-ios-indigo rounded-full flex items-center justify-center -mt-1 -ml-1 bg-white":_e===0?"text-ios-rose":_e===6?"text-ios-indigo":"text-[#1C1C1E]"}`,children:Ee(Y,"d")}),Ue&&Me&&ve.length<tt&&y.jsx("button",{onClick:()=>b({date:Y}),className:"w-5 h-5 flex items-center justify-center rounded-full bg-[#1C1C1E] text-white hover:bg-gray-800 transition-all ios-tap shadow-sm",title:" ",children:y.jsx(il,{className:"w-3 h-3"})})]}),y.jsx("div",{className:"flex-1 flex flex-col gap-1.5 overflow-y-auto scrollbar-hide",children:ve.map(Ge=>{var Ur;return y.jsxs("div",{className:"relative group bg-gray-50 rounded-[8px] p-2 border border-dashed border-gray-200 hover:border-ios-indigo/30 transition-all",children:[y.jsxs("div",{className:"flex justify-between items-center mb-1",children:[y.jsx("span",{className:"text-[11px] font-bold text-[#1C1C1E]",children:Ge.supervisor_name}),Ue&&y.jsxs("div",{className:"opacity-0 group-hover:opacity-100 flex items-center transition-opacity",children:[y.jsx("button",{onClick:mi=>{mi.stopPropagation(),Q(Ge.supervisor_name),S({id:Ge.id,name:Ge.supervisor_name,date:Y})},className:"p-1 text-gray-400 hover:text-ios-indigo transition-colors",title:" ",children:y.jsx(lk,{className:"w-3 h-3"})}),y.jsx("button",{onClick:mi=>C(Ge.id,mi),className:"p-1 text-gray-400 hover:text-ios-rose transition-colors",title:"",children:y.jsx(Li,{className:"w-3 h-3"})})]})]}),Ge.signature_url?y.jsxs("div",{className:"relative h-8 flex items-center",children:[y.jsx("img",{src:Ge.signature_url,alt:"",className:"h-full object-contain opacity-80"}),Ue&&y.jsx("button",{onClick:()=>F({assignmentId:Ge.id}),className:"absolute inset-0 bg-black/5 opacity-0 hover:opacity-100 flex items-center justify-center text-[9px] text-[#1C1C1E] font-black rounded backdrop-blur-[1px]",children:""})]}):y.jsx("div",{className:"h-8 flex items-center justify-center",children:Ue||((Ur=d==null?void 0:d.profile)==null?void 0:Ur.full_name)===Ge.supervisor_name&&ot?y.jsxs("button",{onClick:()=>F({assignmentId:Ge.id}),className:"w-full h-full border border-dashed border-ios-indigo/30 rounded flex items-center justify-center gap-1 text-[9px] text-ios-indigo font-bold hover:bg-ios-indigo/5 transition-colors",children:[y.jsx(k0,{className:"w-3 h-3"})," "]}):!ue&&E6(Y)?y.jsx("span",{className:"text-[9px] text-red-500 font-bold",children:""}):y.jsx("span",{className:"text-[9px] text-gray-300 font-medium",children:" "})})]},Ge.id)})})]},ce)})})};return y.jsxs("div",{className:"h-full flex flex-col p-6 animate-spring-up overflow-hidden relative print:hidden",children:[y.jsxs("div",{className:"flex-none",children:[L(),z()]}),y.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide -mr-2 pr-2",children:ee()}),_&&y.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm p-4 animate-fade-in",onClick:()=>b(null),children:y.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-xs overflow-hidden animate-spring-up",onClick:A=>A.stopPropagation(),children:[y.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[y.jsxs("h4",{className:"text-sm font-black text-[#1C1C1E]",children:[Ee(_.date,"M d"),"  "]}),y.jsx("button",{onClick:()=>b(null),className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:y.jsx(Ta,{className:"w-4 h-4"})})]}),y.jsxs("div",{className:"p-4 space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-[10px] font-bold text-ios-gray uppercase tracking-wider mb-2",children:"  "}),y.jsx("input",{type:"text",value:G,onChange:A=>Q(A.target.value),placeholder:" ",className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 text-sm font-bold text-[#1C1C1E] focus:outline-none focus:ring-2 focus:ring-ios-indigo/50 transition-all",onKeyDown:A=>A.key==="Enter"&&E(),autoFocus:!0})]}),y.jsx("button",{onClick:E,className:"w-full py-3 bg-[#1C1C1E] text-white rounded-xl text-xs font-bold hover:bg-gray-800 shadow-lg transition-all",children:""})]})]})}),k&&y.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm p-4 animate-fade-in",onClick:()=>S(null),children:y.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-xs overflow-hidden animate-spring-up",onClick:A=>A.stopPropagation(),children:[y.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[y.jsx("h4",{className:"text-sm font-black text-[#1C1C1E]",children:"  "}),y.jsx("button",{onClick:()=>S(null),className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:y.jsx(Ta,{className:"w-4 h-4"})})]}),y.jsxs("div",{className:"p-4 space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-[10px] font-bold text-ios-gray uppercase tracking-wider mb-2",children:" "}),y.jsx("input",{type:"text",value:G,onChange:A=>Q(A.target.value),placeholder:" ",className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 text-sm font-bold text-[#1C1C1E] focus:outline-none focus:ring-2 focus:ring-ios-indigo/50 transition-all",onKeyDown:A=>A.key==="Enter"&&R(),autoFocus:!0})]}),y.jsx("button",{onClick:R,className:"w-full py-3 bg-[#1C1C1E] text-white rounded-xl text-xs font-bold hover:bg-gray-800 shadow-lg transition-all",children:" "})]})]})}),O&&y.jsx(y8,{onSave:P,onCancel:()=>F(null)}),D&&y.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm p-4 animate-fade-in",onClick:()=>U(!1),children:y.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm overflow-hidden animate-spring-up",onClick:A=>A.stopPropagation(),children:[y.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[y.jsxs("h4",{className:"text-sm font-black text-[#1C1C1E] flex items-center gap-2",children:[y.jsx(du,{className:"w-4 h-4 text-ios-indigo"}),"  "]}),y.jsx("button",{onClick:()=>U(!1),className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:y.jsx(Ta,{className:"w-5 h-5"})})]}),y.jsxs("div",{className:"p-4 max-h-[60vh] overflow-y-auto",children:[y.jsx("p",{className:"text-xs text-ios-gray mb-4",children:" /  ."}),y.jsxs("div",{className:"grid gap-2",children:[h.map(A=>y.jsx("button",{onClick:()=>H(A),className:"w-full p-3 rounded-xl border border-gray-100 hover:border-ios-indigo/50 hover:bg-ios-indigo/5 transition-all text-left group",children:y.jsxs("span",{className:"text-sm font-bold text-[#1C1C1E] group-hover:text-ios-indigo",children:[A.quarter_name?`${A.quarter_name}: `:"",A.start_date," ~ ",A.end_date]})},A.id)),h.length===0&&y.jsx("div",{className:"text-center py-6 text-gray-300 text-xs",children:"   ."})]})]})]})}),M&&Nv.createPortal(y.jsxs("div",{id:"print-root",className:"bg-white text-black hidden print:block",children:[y.jsx("style",{children:`
                            @media print {
                                @page { size: A4 portrait; margin: 0; }
                                body { 
                                    margin: 0 !important;
                                    padding: 0 !important;
                                    background-color: white !important;
                                    font-family: 'Malgun Gothic', 'Dotum', 'Apple SD Gothic Neo', sans-serif !important;
                                    -webkit-print-color-adjust: exact !important;
                                    print-color-adjust: exact !important;
                                    color: #000000 !important;
                                }
                                body > #root {
                                    display: none !important;
                                }
                                body > #print-root {
                                    display: block !important;
                                    width: 210mm !important;
                                    min-height: 297mm !important;
                                    padding: 10mm !important;
                                    box-sizing: border-box !important;
                                    background-color: white !important;
                                    font-family: 'Malgun Gothic', 'Dotum', 'Apple SD Gothic Neo', sans-serif !important;
                                }
                                /* Force solid borders */
                                * {
                                    border-color: #000000 !important;
                                    border-style: solid !important;
                                }
                                /* Ensure text is strictly black */
                                .print-text-black {
                                    color: #000000 !important;
                                }
                            }
                            #print-root {
                                display: none;
                            }
                        `}),y.jsxs("div",{className:"flex flex-col w-full h-full bg-white relative",children:[y.jsxs("div",{className:"flex-none mb-2 text-center",children:[y.jsx("h1",{className:"text-[20pt] font-black tracking-widest mb-1 underline decoration-2 underline-offset-4 text-black",children:"  "}),y.jsxs("div",{className:"flex justify-between items-end border-b-2 border-black pb-1 mb-1 relative",children:[y.jsxs("span",{className:"text-[9pt] font-bold text-black absolute left-0 bottom-1",children:[M.quarter.quarter_name," (",M.quarter.start_date," ~ ",M.quarter.end_date,")"]}),y.jsx("span",{className:"w-full text-center text-[8pt] text-transparent",children:"."}),y.jsxs("span",{className:"text-[8pt] text-black absolute right-0 bottom-1",children:[": ",Ee(new Date,"yyyy. MM. dd.")]})]})]}),y.jsx("div",{className:"flex-1 flex gap-2 items-start justify-center w-full",children:(()=>{try{const A=Et(M.quarter.start_date),V=Et(M.quarter.end_date);return!Uc(A)||!Uc(V)?y.jsx("div",{className:"w-full text-center p-10 text-red-500 font-bold",children:"   ."}):kI({start:A,end:V}).map((W,te)=>{const ae=Array.from({length:31},(Y,ce)=>{const ue=ce+1;try{const xe=H6(W,ue);return!Uc(xe)||!Nd(xe,W)?null:xe}catch{return null}});return y.jsx("div",{className:"flex-1 h-full flex flex-col min-w-0",children:y.jsxs("table",{className:"w-full border-collapse table-fixed border border-black",children:[y.jsxs("colgroup",{children:[y.jsx("col",{style:{width:"12%"}}),y.jsx("col",{style:{width:"22%"}}),y.jsx("col",{style:{width:"22%"}}),y.jsx("col",{style:{width:"22%"}}),y.jsx("col",{style:{width:"22%"}})]}),y.jsxs("thead",{children:[y.jsx("tr",{className:"bg-[#E5E7EB]",children:y.jsx("th",{colSpan:5,className:"border border-black text-center font-bold py-1 text-[10pt] text-black",children:Ee(W,"M")})}),y.jsxs("tr",{className:"bg-[#F3F4F6] text-[7pt] text-black font-bold h-[8mm]",children:[y.jsx("th",{rowSpan:2,className:"border border-black text-center align-middle",children:""}),y.jsx("th",{colSpan:2,className:"border border-black text-center align-middle h-[4mm]",children:" 1"}),y.jsx("th",{colSpan:2,className:"border border-black text-center align-middle h-[4mm]",children:" 2"})]}),y.jsxs("tr",{className:"bg-[#F3F4F6] text-[7pt] text-black font-bold h-[4mm]",children:[y.jsx("th",{className:"border border-black text-center align-middle",children:""}),y.jsx("th",{className:"border border-black text-center align-middle",children:""}),y.jsx("th",{className:"border border-black text-center align-middle",children:""}),y.jsx("th",{className:"border border-black text-center align-middle",children:""})]})]}),y.jsx("tbody",{children:ae.map((Y,ce)=>{if(!Y)return y.jsxs("tr",{className:"h-[7mm] bg-gray-100/30",children:[y.jsx("td",{className:"border border-black"}),y.jsx("td",{className:"border border-black"}),y.jsx("td",{className:"border border-black"}),y.jsx("td",{className:"border border-black"}),y.jsx("td",{className:"border border-black"})]},ce);const ue=Ee(Y,"yyyy-MM-dd"),xe=Ee(Y,"E",{locale:Yt}),_e=M.assignments.filter(Ye=>Ye.date===ue),fe=_e[0],ve=_e[1],Ce=M.defaults.find(Ye=>Ye.day_of_week===Y.getDay()),De=M.exceptions.find(Ye=>Ye.exception_date===ue),Me=El(Y,{start:Et(M.quarter.start_date),end:Et(M.quarter.end_date)})&&!De&&((Ce==null?void 0:Ce.morning)||(Ce==null?void 0:Ce.dinner)||(Ce==null?void 0:Ce.period1)||(Ce==null?void 0:Ce.period2));return y.jsxs("tr",{className:"h-[7mm] text-[7pt] text-black",children:[y.jsxs("td",{className:`border border-black text-center font-bold tracking-tighter align-middle p-0 ${xe===""?"text-blue-700":xe===""?"text-red-600":"text-black"}`,children:[Ee(Y,"d"),"(",xe,")"]}),y.jsx("td",{className:"border border-black text-center break-all align-middle p-0.5",children:Me?(fe==null?void 0:fe.supervisor_name)||"":"-"}),y.jsx("td",{className:"border border-black text-center align-middle p-0.5",children:Me&&(fe==null?void 0:fe.signature_url)&&y.jsx("img",{src:fe.signature_url,className:"max-h-[18px] w-auto mx-auto object-contain",alt:""})}),y.jsx("td",{className:"border border-black text-center break-all align-middle p-0.5",children:Me&&(ve==null?void 0:ve.supervisor_name)||""}),y.jsx("td",{className:"border border-black text-center align-middle p-0.5",children:Me&&(ve==null?void 0:ve.signature_url)&&y.jsx("img",{src:ve.signature_url,className:"max-h-[18px] w-auto mx-auto object-contain",alt:""})})]},ce)})})]})},te)})}catch{return y.jsx("div",{className:"w-full text-center text-red-500",children:"  "})}})()}),y.jsx("div",{className:"mt-2 text-center text-[9pt] font-bold flex-none text-black",children:"      .  "})]})]}),document.body)]})},_8=({onSave:e,onCancel:t,teacherName:r})=>{const n=le.useRef(null),[i,s]=le.useState(!1),[l,o]=le.useState(!1);le.useEffect(()=>{const u=n.current;if(!u)return;const p=u.getContext("2d"),m=window.devicePixelRatio||1,g=u.getBoundingClientRect();u.width=g.width*m,u.height=g.height*m,p.scale(m,m),p.strokeStyle="#1C1C1E",p.lineWidth=10,p.lineCap="round",p.lineJoin="round"},[]);const a=u=>{const m=n.current.getBoundingClientRect(),g=u.touches?u.touches[0].clientX:u.clientX,x=u.touches?u.touches[0].clientY:u.clientY;return{x:g-m.left,y:x-m.top}},c=u=>{s(!0);const{x:p,y:m}=a(u),g=n.current.getContext("2d");g.beginPath(),g.moveTo(p,m)},d=u=>{if(!i)return;const{x:p,y:m}=a(u),g=n.current.getContext("2d");g.lineTo(p,m),g.stroke(),o(!0)},f=()=>s(!1),h=()=>{if(!l)return alert("  .");n.current.toBlob(p=>e(p),"image/png")};return y.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-md flex flex-col justify-end",children:y.jsxs("div",{className:"bg-white rounded-t-[32px] p-6 mobile-slide-up h-[70vh]",children:[y.jsxs("div",{className:"flex justify-between items-center mb-8",children:[y.jsxs("div",{children:[y.jsxs("h2",{className:"text-2xl font-black text-[#1C1C1E]",children:[r,""]}),y.jsx("p",{className:"text-ios-gray text-sm font-bold",children:"     ."})]}),y.jsx("button",{onClick:t,className:"p-2 bg-gray-100 rounded-full",children:y.jsx(Pl,{className:"w-5 h-5 text-ios-gray"})})]}),y.jsx("div",{className:"mobile-signature-pad mb-8",children:y.jsx("canvas",{ref:n,style:{width:"100%",height:"100%"},onMouseDown:c,onMouseMove:d,onMouseUp:f,onMouseLeave:f,onTouchStart:c,onTouchMove:d,onTouchEnd:f})}),y.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[y.jsx("button",{onClick:()=>{n.current.getContext("2d").clearRect(0,0,n.current.width,n.current.height),o(!1)},className:"py-4 bg-gray-100 text-[#1C1C1E] rounded-2xl font-black mobile-tap-feedback",children:" "}),y.jsx("button",{onClick:h,className:"py-4 bg-[#007AFF] text-white rounded-2xl font-black mobile-tap-feedback shadow-lg",children:" "})]})]})})},b8=({onLogout:e,currentUser:t})=>{const r=le.useRef(null),[n,i]=le.useState("menu"),[s,l]=le.useState(!0),[o,a]=le.useState([]),[c,d]=le.useState(null),[f,h]=le.useState(!1),[u,p]=le.useState([]),m={A:le.useRef(null),B:le.useRef(null),C:le.useRef(null)},[g,x]=le.useState([]),[v,w]=le.useState(null),[_,b]=le.useState([]),[k,S]=le.useState(null),[O,F]=le.useState(Ee(new Date,"yyyy-MM-dd")),D=Ee(new Date,"yyyy-MM-dd");le.useEffect(()=>{U()},[]),le.useEffect(()=>{M()},[O]),le.useEffect(()=>{k&&q()},[k]),le.useEffect(()=>{v&&(n==="attendance"||n==="seatmap")&&G()},[v,n,O,k]);const U=async()=>{l(!0);const{data:C}=await we.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});C&&C.length>0&&(b(C),S(C[0].id)),M()},M=async()=>{const{data:C,error:P}=await we.from("supervision_assignments").select("*").eq("date",O);C&&a(C),l(!1)},q=async()=>{var P;if(!k)return;const{data:C}=await we.from("sessions").select("*").eq("zone_id",k).order("start_time",{ascending:!0});if(C){x(C);const I=Ee(new Date,"HH:mm:ss"),H=C.find(L=>I>=L.start_time&&I<=L.end_time);w(H?H.id:(P=C[0])==null?void 0:P.id)}},G=async()=>{l(!0);const{data:C,error:P}=await we.from("seats").select("*, zone_color").order("seat_number",{ascending:!0});if(P){console.error("Error fetching seats:",P),l(!1);return}const{data:I,error:H}=await we.from("bookings").select(`
                id, seat_id, session_id,
                profiles (full_name, username, grade),
                attendance (id, status, timestamp_in, timestamp_out)
            `).eq("date",O);if(C){const L=C.map(z=>{var W,te,ae,Y;const ee=(I||[]).find(ce=>ce.seat_id===z.id&&ce.session_id===v),A=(I||[]).some(ce=>ce.seat_id===z.id),V=(W=ee==null?void 0:ee.attendance)==null?void 0:W[0];return{seat_id:z.id,seat_number:z.seat_number,display_number:z.display_number,zone_name:z.zone_name,zone_color:z.zone_color,booking_id:ee==null?void 0:ee.id,full_name:(te=ee==null?void 0:ee.profiles)==null?void 0:te.full_name,username:(ae=ee==null?void 0:ee.profiles)==null?void 0:ae.username,grade:(Y=ee==null?void 0:ee.profiles)==null?void 0:Y.grade,attendance_id:V==null?void 0:V.id,status:(V==null?void 0:V.status)||"absent",timestamp_in:V==null?void 0:V.timestamp_in,timestamp_out:V==null?void 0:V.timestamp_out,is_active:!!ee,is_booked_today:A}});L.sort((z,ee)=>(z.seat_number||"").localeCompare(ee.seat_number||"",void 0,{numeric:!0,sensitivity:"base"})),p(L)}l(!1)},Q=async C=>{const P=`sig_duty_${c.id}_${Date.now()}.png`,{error:I}=await we.storage.from("signatures").upload(P,C,{contentType:"image/png"});if(I)return alert("  ");const{data:{publicUrl:H}}=we.storage.from("signatures").getPublicUrl(P),{error:L}=await we.from("supervision_assignments").update({signature_url:H}).eq("id",c.id);L||(h(!1),M())},K=()=>{const C=new Date,P=9*60*60*1e3;return new Date(C.getTime()+P).toISOString().replace("Z","+09:00")},ne=async C=>{if(C.status!=="absent")return;const I={id:C.attendance_id,booking_id:C.booking_id,status:"present",updated_at:new Date().toISOString()};if(!C.timestamp_in){const z=g.find(ee=>ee.id===v);z?(I.timestamp_in=`${D}T${z.start_time}+09:00`,I.status="present"):I.timestamp_in=K()}const{data:H,error:L}=await we.from("attendance").upsert(I,{onConflict:"booking_id"}).select().single();!L&&H?p(z=>z.map(ee=>ee.booking_id===C.booking_id?{...ee,status:H.status,attendance_id:H.id,timestamp_in:H.timestamp_in}:ee)):G()},J=async C=>{if(C.attendance_id)try{const{error:P}=await we.from("attendance").delete().eq("id",C.attendance_id);if(P)throw P;G()}catch(P){console.error("Error resetting attendance:",P)}},T=()=>{e&&e()},j=C=>{const P=new Date(O);P.setDate(P.getDate()+C),F(Ee(P,"yyyy-MM-dd"))};le.useEffect(()=>{},[n]);const B=()=>{const C=_.find(A=>A.id===k),P=(C==null?void 0:C.name)||"";Ee(new Date,"yyyy M d"),["","","","","","",""][new Date().getDay()];const I=(C==null?void 0:C.code)||"A",H=(C==null?void 0:C.name)||"A ZONE",L=u.filter(A=>A.zone_name===H||A.zone_name===I||A.seat_number&&A.seat_number.startsWith(I)),z=L.filter(A=>A.status==="present").length,ee=L.filter(A=>A.is_active&&(A.status==="absent"||!A.status)).length;return y.jsxs("header",{className:"mobile-header pb-3.5",children:[y.jsxs("div",{className:"flex justify-between items-center mb-5",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"p-2.5 bg-gray-50 rounded-full shadow-sm border border-gray-100/50",children:y.jsx(ek,{className:"w-5 h-5 text-gray-400",strokeWidth:2.5})}),y.jsx("h1",{className:"text-[20px] font-black text-[#1C1C1E] tracking-tight",children:" "})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[n==="attendance"&&y.jsxs("button",{onClick:()=>i("seatmap"),className:"px-3.5 py-2.5 bg-[#F0F7FF] text-[#007AFF] rounded-xl active:scale-95 transition-all text-[13px] font-black flex items-center gap-2 border border-blue-50",children:[y.jsx(hu,{className:"w-4 h-4"}),""]}),n!=="menu"?y.jsx("button",{onClick:()=>i(n==="seatmap"?"attendance":"menu"),className:"px-4 py-2.5 bg-gray-50 text-[#8E8E93] rounded-xl active:scale-95 transition-all text-[13px] font-black border border-gray-100/50",children:n==="seatmap"?"":""}):y.jsx("button",{onClick:T,className:"p-2.5 bg-rose-50 text-[#FF3B30] rounded-full active:scale-95 transition-all border border-rose-100/50",children:y.jsx(Pl,{className:"w-5 h-5"})})]})]}),(n==="attendance"||n==="seatmap"||n==="supervision")&&y.jsxs("div",{className:"flex flex-col gap-5 animate-in fade-in slide-in-from-top-4 duration-300",children:[y.jsxs("div",{className:"flex gap-2 items-stretch",children:[y.jsx("div",{className:"flex-1 bg-[#1C1C1E] p-1 rounded-[6px] shadow-lg shadow-black/10 flex items-center justify-center min-h-[36px]",children:y.jsx("span",{className:"text-[12px] font-black text-white px-2",children:P})}),y.jsxs("div",{className:"flex-1 flex items-center justify-between bg-white px-2 rounded-[6px] border border-gray-100 shadow-sm min-h-[36px]",children:[y.jsx("button",{onClick:()=>j(-1),className:"w-8 h-8 flex items-center justify-center text-gray-300 active:text-[#1C1C1E] transition-colors",children:y.jsx(ci,{className:"w-4 h-4"})}),y.jsxs("span",{className:"text-[11px] font-black text-[#1C1C1E] tracking-tight",children:[O," (",["","","","","","",""][new Date(O).getDay()],")"]}),y.jsx("button",{onClick:()=>j(1),className:"w-8 h-8 flex items-center justify-center text-gray-300 active:text-[#1C1C1E] transition-colors",children:y.jsx(qr,{className:"w-4 h-4"})})]})]}),(n==="attendance"||n==="seatmap")&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"flex bg-gray-50/50 p-1 rounded-xl border border-gray-100 overflow-x-auto scrollbar-hide",children:g.map(A=>y.jsx("button",{onClick:()=>w(A.id),className:`flex-1 px-3 py-2.5 rounded-lg text-xs font-black whitespace-nowrap transition-all ${v===A.id?"bg-white text-[#1C1C1E] shadow-sm":"text-gray-400"}`,children:A.name},A.id))}),y.jsxs("div",{className:"flex gap-3 h-20",children:[y.jsxs("div",{className:"flex-1 bg-blue-50/50 p-3 rounded-2xl border border-blue-100 flex flex-col justify-center items-center font-black",children:[y.jsx("span",{className:"text-[10px] text-[#007AFF] uppercase tracking-wider mb-1",children:" "}),y.jsxs("span",{className:"text-2xl text-[#007AFF]",children:[z,""]})]}),y.jsxs("div",{className:"flex-1 bg-rose-50/50 p-3 rounded-2xl border border-rose-100 flex flex-col justify-center items-center font-black",children:[y.jsx("span",{className:"text-[10px] text-[#FF3B30] uppercase tracking-wider mb-1",children:"/"}),y.jsxs("span",{className:"text-2xl text-[#FF3B30]",children:[ee,""]})]})]})]})]})]})},E=()=>y.jsxs("div",{className:"mobile-menu-container",children:[y.jsxs("div",{className:"mobile-menu-grid",children:[y.jsxs("button",{onClick:()=>i("supervision"),className:"mobile-menu-btn",children:[y.jsx("div",{className:"mobile-menu-btn-icon bg-blue-50",children:y.jsx(k0,{className:"w-8 h-8 text-[#007AFF]"})}),y.jsx("span",{className:"mobile-menu-btn-text",children:" "})]}),y.jsxs("button",{onClick:()=>i("attendance"),className:"mobile-menu-btn",children:[y.jsx("div",{className:"mobile-menu-btn-icon bg-rose-50",children:y.jsx(En,{className:"w-8 h-8 text-[#FF3B30]"})}),y.jsx("span",{className:"mobile-menu-btn-text",children:" "})]})]}),D&&y.jsx("div",{className:"text-center",children:y.jsxs("p",{className:"text-sm font-bold text-gray-400",children:[" ",Ee(new Date,"yyyy M d")," ."]})})]}),R=()=>{const C=new Date,P=Ee(C,"HH:mm:ss"),I=g.length>0?g.reduce((A,V)=>V.end_time>A?V.end_time:A,"00:00:00"):"23:59:59",H=Ee(C,"yyyy-MM-dd"),L=O<H,z=O===H,ee=(t==null?void 0:t.role)!=="admin"&&(L||z&&P>I);return y.jsx("main",{className:"flex-1 flex flex-col h-full overflow-hidden",style:{padding:"0 1rem 1rem 1rem"},children:y.jsxs("div",{className:"flex-1 flex flex-col gap-4 h-full overflow-y-auto pb-6 pt-2",children:[o.map((A,V)=>y.jsx("div",{className:"flex-1 min-h-[300px] bg-white rounded-[32px] p-6 border border-gray-100 shadow-sm flex flex-col items-center justify-center",children:y.jsxs("div",{className:"flex flex-col items-center gap-4 w-full",children:[y.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center shadow-inner",children:y.jsx(sl,{className:"w-8 h-8 text-[#8E8E93]"})}),y.jsxs("div",{className:"text-center",children:[y.jsxs("h3",{className:"text-lg font-black text-[#1C1C1E]",children:[A.supervisor_name," "]}),A.signature_url?y.jsxs("p",{className:"mt-1.5 text-xs font-bold text-emerald-500 flex items-center justify-center gap-1.5",children:[y.jsx(En,{className:"w-4 h-4"}),"   "]}):y.jsx("p",{className:"mt-1.5 text-xs font-bold text-[#FF9500]",children:"   "})]}),!A.signature_url&&(ee?y.jsx("div",{className:"w-full py-5 bg-gray-50 text-gray-400 rounded-2xl text-center border border-gray-100",children:y.jsx("p",{className:"text-sm font-bold",children:"     ."})}):y.jsx("button",{onClick:()=>{d(A),h(!0)},className:"w-full py-5 bg-[#007AFF] text-white rounded-2xl text-base font-black mobile-tap-feedback shadow-lg shadow-blue-100",children:""})),A.signature_url&&y.jsx("div",{className:"w-full bg-gray-50 rounded-2xl p-4 flex items-center justify-center border border-dashed border-gray-200 min-h-[100px]",children:y.jsx("img",{src:A.signature_url,alt:"Signature",className:"max-h-16 opacity-60 object-contain"})})]})},A.id)),o.length===1&&y.jsx("div",{className:"flex-1 min-h-0 p-6 border border-transparent opacity-0 pointer-events-none"}),o.length===0&&y.jsx("div",{className:"flex-1 bg-white rounded-[32px] border border-dashed border-gray-200 text-gray-400 text-center flex items-center justify-center p-6",children:y.jsx("p",{className:"text-base font-bold",children:"    ."})})]})})},N=()=>y.jsxs("main",{className:"mobile-attendance-list",children:[y.jsx("div",{className:"mobile-zone-grid",children:["A","B","C"].map(C=>{var L;const P=`${C} zone`,I=u.filter(z=>z.zone_name===P||z.zone_name===C||z.seat_number&&z.seat_number.startsWith(C)),H=C==="A"?"#34C759":C==="B"?"#FF9500":"#FF3B30";return y.jsxs("div",{className:"zone-column",ref:m[C],children:[y.jsxs("div",{className:"zone-title-bar",style:{backgroundColor:((L=I[0])==null?void 0:L.zone_color)||H},children:[C," ZONE"]}),y.jsx("div",{className:"zone-divider"}),y.jsx("div",{className:"zone-seats-list",children:I.map(z=>{const ee=z.is_active?"tier-active":z.is_booked_today?"tier-reserved":"tier-empty",A=z.zone_color||H,V=z.status==="present"?"green":"red";return y.jsxs("div",{className:`mobile-grid-card ${ee}`,children:[y.jsxs("div",{className:"grid-card-header",style:{backgroundColor:A},children:[z.display_number||z.seat_number.replace(`${C}-`,""),z.is_active&&y.jsx("div",{className:`status-dot ${V}`})]}),y.jsx("div",{className:"grid-card-body",children:z.full_name?y.jsxs(y.Fragment,{children:[y.jsx("span",{className:"grid-card-student",children:z.full_name}),y.jsx("span",{className:"grid-card-id",children:z.username||" "})]}):y.jsx("span",{className:"grid-card-info text-gray-300",children:""})}),y.jsx("div",{className:"grid-card-footer",children:z.full_name?z.status==="absent"?y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"grid-status-btn status-absent-btn",children:""}),y.jsx("button",{className:"grid-action-btn",onClick:()=>ne(z),style:{backgroundColor:A},children:""})]}):y.jsxs(y.Fragment,{children:[y.jsx("div",{className:`grid-status-btn ${z.status==="present"?"status-present-active":z.status==="late"?"status-late-active":"status-early-active"}`,style:{backgroundColor:z.status==="present"?A:void 0},children:(()=>{const W=g.find(ae=>ae.id===v),te=Ee(new Date,"HH:mm:ss");return z.status==="present"?W&&te>W.end_time?"":"":z.status==="late"?"":""})()}),y.jsx("button",{className:"grid-action-btn subtle",onClick:()=>J(z),children:""})]}):y.jsx("div",{className:"grid-status-btn status-absent-btn opacity-20",children:"-"})})]},z.seat_id)})})]},C)})}),u.length===0&&!s&&y.jsxs("div",{className:"text-center py-12",children:[y.jsx($i,{className:"w-8 h-8 text-gray-200 mx-auto mb-2"}),y.jsx("p",{className:"text-xs text-gray-300 font-bold",children:"   ."})]})]});return y.jsxs("div",{className:"mobile-dashboard-container h-[100dvh] overflow-hidden flex flex-col",children:[B(),s&&y.jsx("div",{className:"flex-1 flex items-center justify-center",children:y.jsx("p",{className:"text-sm font-bold text-gray-400",children:" ..."})}),!s&&n==="menu"&&E(),!s&&n==="supervision"&&R(),!s&&n==="attendance"&&N(),!s&&n==="seatmap"&&y.jsx("div",{ref:r,className:"mobile-seatmap-container flex-1 scrollbar-hide bg-[#F2F2F7] relative overflow-auto",children:y.jsx("div",{className:"mobile-seatmap-content bg-white shadow-xl",children:y.jsx(s_,{isMobileView:!0,externalZoneId:k,externalDate:O,externalSessionId:v})})}),f&&y.jsx(_8,{teacherName:c==null?void 0:c.supervisor_name,onSave:Q,onCancel:()=>h(!1)})]})},g_=({onSelectSeat:e,selectedProxyUser:t,viewDate:r,onDateChange:n,selectedZoneId:i,onZoneChange:s,minimal:l=!1})=>{const o=le.useRef(null),a=le.useRef(null),[c,d]=le.useState(null),[f,h]=le.useState([]),[u,p]=le.useState(!1),[m,g]=le.useState(null),[x,v]=le.useState([]),[w,_]=le.useState({quarters:[],defaults:[],exceptions:[]});le.useEffect(()=>{b()},[]);const b=async()=>{const{data:{user:U}}=await we.auth.getUser();if(U){const{data:q}=await we.from("profiles").select("*").eq("id",U.id).single();g(q)}const{data:M}=await we.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});M&&M.length>0&&(h(M),i||s(M[0].id))};le.useEffect(()=>{if(!i)return;let U=!0;return(async()=>{const[q,G,Q]=await Promise.all([we.from("operation_quarters").select("*"),we.from("operation_defaults").select("*").eq("zone_id",i),we.from("operation_exceptions").select("*").eq("zone_id",i)]);U&&_({quarters:q.data||[],defaults:G.data||[],exceptions:Q.data||[]});const{data:K}=await we.from("sessions").select("*").eq("zone_id",i).order("start_time",{ascending:!0});if(!U||(v(K||[]),!o.current))return;a.current&&a.current.dispose(),o.current.innerHTML="";const ne=document.createElement("canvas");o.current.appendChild(ne);const J=new $e.fabric.Canvas(ne,{backgroundColor:"transparent",selection:!1,hoverCursor:"pointer",moveCursor:"grab"});a.current=J,await F(J,K),U&&(J.on("mouse:down",T=>{var j,B,E,R;if(!T.target)J.isDragging=!0,J.selection=!1,J.lastPosX=T.e.clientX||((B=(j=T.e.touches)==null?void 0:j[0])==null?void 0:B.clientX),J.lastPosY=T.e.clientY||((R=(E=T.e.touches)==null?void 0:E[0])==null?void 0:R.clientY);else if(T.target.data){const N=T.target.data;d(N),e&&e(N),J.getObjects().forEach(P=>{if(P.type==="group"){const I=P.getObjects().find(H=>H.name==="selectionBorder");I&&I.set({strokeWidth:0}),P.set("dirty",!0)}});const C=T.target.getObjects().find(P=>P.name==="selectionBorder");C&&C.set({strokeWidth:2}),T.target.set({dirty:!0,objectCaching:!1}),J.renderAll()}else d(null),e&&e(null)}),J.on("mouse:move",T=>{var j,B,E,R;if(J.isDragging){const N=T.e,C=N.clientX||((B=(j=N.touches)==null?void 0:j[0])==null?void 0:B.clientX),P=N.clientY||((R=(E=N.touches)==null?void 0:E[0])==null?void 0:R.clientY),I=J.viewportTransform;I[4]+=C-J.lastPosX,I[5]+=P-J.lastPosY,J.requestRenderAll(),J.lastPosX=C,J.lastPosY=P}}),J.on("mouse:wheel",T=>{var N;const j=T.e.deltaY,B=J.viewportTransform;B[5]-=j;const E=J.getHeight(),R=((N=o.current)==null?void 0:N.clientHeight)||0;B[5]>0&&(B[5]=0),R>0&&B[5]<-(E-R)&&(B[5]=-(E-R)),J.requestRenderAll(),T.e.preventDefault(),T.e.stopPropagation()}),J.on("mouse:up",()=>{J.setViewportTransform(J.viewportTransform),J.isDragging=!1,J.selection=!1}))})(),()=>{U=!1,a.current&&(a.current.dispose(),a.current=null)}},[i,m,r]);const k=U=>{const M=Et(U);if(!w.quarters.some(J=>J.start_date&&J.end_date&&El(M,{start:Et(J.start_date),end:Et(J.end_date)}))||w.exceptions.find(J=>J.exception_date===U))return!1;const Q=M.getDay(),K=w.defaults.find(J=>J.day_of_week===Q);return!!(K&&(K.morning||K.dinner||K.period1||K.period2))},S=()=>{let U=Bi(Et(r),1),M=!1,q=0;const G=180;for(;!M&&q<G;){const Q=Ee(U,"yyyy-MM-dd");k(Q)?(n(Q),M=!0):(U=Bi(U,1),q++)}},O=()=>{let U=Ad(Et(r),1),M=!1,q=0;const G=180;for(;!M&&q<G;){const Q=Ee(U,"yyyy-MM-dd");k(Q)?(n(Q),M=!0):(U=Ad(U,1),q++)}},F=async(U,M,q)=>{var K,ne;p(!0);const{data:G}=await we.from("seats").select("*").eq("zone_id",i).order("global_number",{ascending:!0}),{data:Q}=await we.from("bookings").select("*, profiles(username, full_name), sessions!inner(*)").eq("date",r).eq("sessions.zone_id",i);if(G&&G.length>0){if(!U||U.isDisposed||!U.getContext())return;U.clear();const J=Math.min(...G.map(V=>V.pos_x)),j=Math.max(...G.map(V=>V.pos_x+(V.width||72)))-J,B=((K=o.current)==null?void 0:K.clientWidth)||j,E=Math.max(j,B),R=Math.round((E-j)/2-J),N=Math.min(...G.map(V=>V.pos_y)),P=Math.max(...G.map(V=>V.pos_y+(V.height||72)))-N,I=Math.round(-N),H=((ne=o.current)==null?void 0:ne.clientHeight)||0,L=Math.max(P,H);if(U.isDisposed||!U.getContext())return;U.setDimensions({width:E,height:L});const z=new Date,ee=z.getHours().toString().padStart(2,"0")+":"+z.getMinutes().toString().padStart(2,"0")+":00",A=M==null?void 0:M.find(V=>ee>=V.start_time&&ee<=V.end_time);G.forEach(V=>{const W=(Q==null?void 0:Q.filter(te=>te.seat_id===V.id))||[];D(U,{...V,pos_x:V.pos_x+R,pos_y:V.pos_y+I},W,A,M)})}p(!1)},D=(U,M,q,G,Q)=>{if(M.type==="structure"){const z=new $e.fabric.Rect({fill:"#E5E5EA",width:M.width||72,height:M.height||72,rx:6,ry:6,stroke:"#D1D1D6",strokeWidth:1}),ee=new $e.fabric.IText(M.label||"",{fontSize:10,originX:"center",originY:"center",left:(M.width||72)/2,top:(M.height||72)/2,fill:"#AEAEB2",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),A=new $e.fabric.Group([z,ee],{left:M.pos_x,top:M.pos_y,angle:M.rotation,selectable:!1,evented:!1,data:{...M}});U.add(A);return}const ne=!!q.find(z=>z.session_id===(G==null?void 0:G.id)),J=q.length>0,T=z=>m?!!(["admin","teacher"].includes(m.role)||z.user_id===m.id):!1,j=M.zone_color||"#5E5CE6",B=new $e.fabric.Rect({fill:j,opacity:ne?.8:J?.1:.02,width:72,height:72,rx:6,ry:6,strokeWidth:0,left:0,top:0,originX:"left",originY:"top",selectable:!1}),E=new $e.fabric.Path("M 0 6 Q 0 0 6 0 L 66 0 Q 72 0 72 6 L 72 18 L 0 18 z",{fill:j,opacity:ne?1:J?.4:.15,strokeWidth:0,left:0,top:0,originX:"left",originY:"top",selectable:!1}),R=new $e.fabric.IText(M.display_number||M.seat_number,{fontSize:11,left:6,top:4,originX:"left",originY:"top",fill:ne?"#ffffff":j,fontFamily:"Inter, -apple-system",fontWeight:"900",selectable:!1}),N={Morning:"",Dinner:"","1st Period":"1 ","2nd Period":"2 "},C=[...Q||[]].sort((z,ee)=>z.id-ee.id),P=C.length>4;let I=[];if(P){const z=Math.ceil(C.length/2),ee=C.slice(0,z),A=C.slice(z),V=ae=>ae.map(Y=>{const ce=q.find(xe=>xe.session_id===Y.id),ue=N[Y.name]||Y.name.substring(0,2);return ce?T(ce)?`${ue}:${ce.profiles.full_name.substring(0,4)}`:`${ue}:`:`${ue}:`}).join(`
`),W=new $e.fabric.Text(V(ee),{fontSize:5.5,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:ne?"#ffffff":"#000000",left:4,top:20,lineHeight:1.35,selectable:!1}),te=new $e.fabric.Text(V(A),{fontSize:5.5,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:ne?"#ffffff":"#000000",left:38,top:20,lineHeight:1.35,selectable:!1});I=[W,te]}else C.forEach((z,ee)=>{const A=q.find(ue=>ue.session_id===z.id),V=N[z.name]||z.name.substring(0,2),W=21+ee*13,te=new $e.fabric.Text(V,{fontSize:8,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:ne?"#ffffff":"#000000",left:4,top:W+.5,originX:"left",originY:"top",selectable:!1});I.push(te);const ae=new $e.fabric.Line([17,W,17,W+10],{stroke:ne?"rgba(255,255,255,0.3)":"rgba(0,0,0,0.1)",strokeWidth:.5,originX:"left",originY:"top",selectable:!1});I.push(ae);let Y="";if(A)if(T(A)){const ue=A.profiles.username||"",xe=A.profiles.full_name||"";Y=ue?`${ue} ${xe}`:xe}else Y="";const ce=new $e.fabric.Text(Y,{fontSize:8,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:ne?"#ffffff":"#000000",left:23,top:W,originX:"left",originY:"top",selectable:!1});if(I.push(ce),ee<C.length-1){const ue=new $e.fabric.Line([4,W+11.5,68,W+11.5],{stroke:ne?"rgba(255,255,255,0.2)":"rgba(0,0,0,0.08)",strokeWidth:.5,originX:"left",originY:"top",selectable:!1});I.push(ue)}});const H=new $e.fabric.Rect({width:74,height:74,rx:8,ry:8,fill:"transparent",stroke:j,strokeWidth:0,left:-2,top:-2,originX:"left",originY:"top",selectable:!1,name:"selectionBorder",strokeUniform:!0}),L=new $e.fabric.Group([B,E,R,...I,H],{left:M.pos_x,top:M.pos_y,originX:"left",originY:"top",angle:M.rotation,data:{...M,seatBookings:q,activeSession:G},selectable:!1,hoverCursor:"pointer"});U.add(L)};return y.jsxs("div",{className:"flex flex-col gap-4 w-full h-full relative overflow-hidden",children:[!l&&y.jsxs("div",{className:"flex items-center gap-4 px-1",children:[y.jsx("div",{className:"flex gap-[10px] m-[10px] mb-0 border-none shrink-0",children:f.map(U=>y.jsx("button",{onClick:()=>s(U.id),className:`px-6 py-2 rounded-lg text-xs font-black transition-all ios-tap border-none outline-none ring-0 ${i===U.id?"bg-[#1C1C1E] text-white shadow-md":"bg-gray-100 text-ios-gray hover:bg-gray-200"}`,children:U.name},U.id))}),y.jsxs("div",{className:"flex items-center gap-2 text-ios-gray",children:[y.jsx(Pv,{className:"w-3.5 h-3.5"}),y.jsx("span",{className:"text-[10px] font-bold",children:"     ."})]}),y.jsxs("div",{className:"flex bg-gray-50 p-1 rounded-full border border-gray-100 items-center gap-1 ml-auto",children:[y.jsx("button",{onClick:O,className:"p-1.5 hover:bg-white rounded-full transition-all text-ios-gray hover:text-[#1C1C1E] ios-tap",children:y.jsx(ci,{className:"w-4 h-4"})}),y.jsxs("div",{className:"relative group px-2 flex items-center gap-2 cursor-pointer",children:[y.jsx(Hi,{className:"w-4 h-4 text-ios-indigo"}),y.jsx("span",{className:"text-[14px] font-black text-[#1C1C1E] whitespace-nowrap",children:Ee(Et(r),"yyyy-MM-dd (EEE)",{locale:Yt})}),y.jsx("input",{type:"date",value:r,onChange:U=>n(U.target.value),className:"absolute inset-0 opacity-0 cursor-pointer"})]}),y.jsx("button",{onClick:S,className:"p-1.5 hover:bg-white rounded-full transition-all text-ios-gray hover:text-[#1C1C1E] ios-tap",children:y.jsx(qr,{className:"w-4 h-4"})})]})]}),u&&y.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-30 flex items-center justify-center",children:y.jsx("div",{className:"w-8 h-8 border-3 border-ios-indigo border-t-transparent rounded-full animate-spin"})}),y.jsx("div",{ref:o,className:"flex-1 h-full relative overflow-hidden cursor-grab active:cursor-grabbing touch-none select-none scrollbar-hide"})]})},S8=({isOpen:e,onClose:t,zoneId:r,onSelect:n})=>e?y.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:y.jsxs("div",{className:"bg-white w-full h-[80vh] rounded-3xl overflow-hidden flex flex-col shadow-2xl relative",children:[y.jsx("button",{onClick:t,className:"absolute top-4 right-4 z-50 p-2 bg-white/90 backdrop-blur rounded-full shadow-lg text-black hover:bg-gray-100 transition-all border border-gray-100",children:y.jsx(Ta,{className:"w-6 h-6"})}),y.jsx("div",{className:"flex-1 bg-gray-50 relative overflow-hidden",children:y.jsx(g_,{viewDate:Ee(new Date,"yyyy-MM-dd"),selectedZoneId:r,onDateChange:()=>{},onZoneChange:()=>{},isReadOnly:!0,minimal:!0,onSelectSeat:n})})]})}):null,k8=({onCancel:e,onSuccess:t,currentUser:r})=>{const[n,i]=le.useState(0),[s,l]=le.useState(!1),[o,a]=le.useState([]),[c,d]=le.useState([]),[f,h]=le.useState([]),[u,p]=le.useState(null),[m,g]=le.useState([]),[x,v]=le.useState(null),[w,_]=le.useState(""),[b,k]=le.useState("A"),[S,O]=le.useState(""),F=V=>{if(!V)return"";const W=V.seat_number.toString(),te=V.zone_name||"";return te&&W.startsWith(`${te}-`)?W.replace(`${te}-`,""):te&&W.startsWith(te)?W.replace(te,""):W},[D,U]=le.useState([]),[M,q]=le.useState([]),[G,Q]=le.useState([]),[K,ne]=le.useState(!1);le.useEffect(()=>{(async()=>{l(!0);try{const{data:W}=await we.from("operation_quarters").select("*").order("start_date");a(W||[]);const{data:te}=await we.from("zones").select("*").order("created_at");h(te||[]);let ae=null;te&&te.length>0&&(ae=te[0].id,v(ae))}catch(W){console.error("Error fetching wizard configs:",W)}finally{l(!1)}})()},[]),le.useEffect(()=>{if(!x)return;(async()=>{l(!0);try{const[W,te,ae,Y]=await Promise.all([we.from("sessions").select("*").eq("zone_id",x).order("start_time"),we.from("operation_defaults").select("*").eq("zone_id",x),we.from("operation_exceptions").select("*").eq("zone_id",x),we.from("seats").select("*").eq("zone_id",x).order("global_number")]);d(W.data||[]),U(te.data||[]),q(ae.data||[]),Q(Y.data||[]);const ce=Y.data||[];if(ce.length>0){const ue=ce[0].zone_name||"";k(ue)}g([]),_("")}catch(W){console.error("Error fetching zone data:",W)}finally{l(!1)}})()},[x]);const J=V=>{const W=Qn(new Date),te=Qn(V),ae=Bi(W,2);if(Wc(te,ae))return!1;const Y=o.find(Ce=>{const De=Et(Ce.start_date),Re=Et(Ce.end_date);return(Ui(te,De)||T6(te,De))&&(Ui(te,Re)||Wc(te,Re))});if(!Y)return!1;const ce=Et(Y.start_date),ue=Ad(ce,7);if(Wc(W,ue))return!1;const xe=Ee(te,"yyyy-MM-dd"),_e=M.find(Ce=>Ce.exception_date===xe);if(_e&&_e.is_closed)return!1;const fe=te.getDay(),ve=D.find(Ce=>Ce.day_of_week===fe);return!(!ve||!ve.morning&&!ve.dinner&&!ve.period1&&!ve.period2)},[T,j]=le.useState(new Date),B=()=>j(V=>cf(V)),E=()=>j(V=>$l(V,1)),R=()=>{const V=Qn(new Date(T.getFullYear(),T.getMonth(),1)),W=new Date(T.getFullYear(),T.getMonth()+1,0),ae=Qn(V).getDay(),Y=Array(ae).fill(null),ce=[];for(let xe=1;xe<=W.getDate();xe++)ce.push(new Date(T.getFullYear(),T.getMonth(),xe));const ue=[...Y,...ce];return y.jsxs("div",{className:"space-y-4 animate-fade-in",children:[y.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:" "}),y.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"  ."}),y.jsxs("div",{className:"flex items-center justify-between bg-white rounded-2xl p-2 shadow-sm border border-gray-100 mb-4",children:[y.jsx("button",{onClick:B,className:"p-2 hover:bg-gray-100 rounded-full text-ios-gray hover:text-black transition-colors",children:y.jsx(ci,{className:"w-5 h-5"})}),y.jsx("span",{className:"text-base font-black text-[#1C1C1E]",children:Ee(T,"yyyy M")}),y.jsx("button",{onClick:E,className:"p-2 hover:bg-gray-100 rounded-full text-ios-gray hover:text-black transition-colors",children:y.jsx(qr,{className:"w-5 h-5"})})]}),y.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["","","","","","",""].map(xe=>y.jsx("div",{className:"text-center text-xs font-bold text-gray-400 py-2",children:xe},xe)),ue.map((xe,_e)=>{if(!xe)return y.jsx("div",{},`empty-${_e}`);const fe=J(xe),ve=u&&Ui(xe,u);return y.jsxs("button",{disabled:!fe,onClick:()=>p(xe),className:`
                                aspect-square rounded-xl flex flex-col items-center justify-center text-sm font-bold transition-all relative
                                ${ve?"bg-[#1C1C1E] text-white shadow-lg scale-105 z-10":fe?"bg-white text-[#1C1C1E] border border-gray-100 hover:border-gray-300":"bg-transparent text-gray-400 cursor-not-allowed"}
                            `,children:[y.jsx("span",{className:fe?"":"opacity-50",children:Ee(xe,"d")}),fe&&y.jsx("span",{className:"w-1 h-1 rounded-full bg-ios-indigo absolute bottom-2"})]},_e)})]})]})},N=()=>{const V=W=>{m.includes(W)?g(m.filter(te=>te!==W)):g([...m,W])};return y.jsxs("div",{className:"space-y-4 animate-fade-in",children:[y.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:" "}),y.jsxs("p",{className:"text-sm font-bold text-ios-gray",children:["   .",y.jsx("br",{}),"(  )"]}),y.jsx("div",{className:"space-y-3 mt-4",children:c.filter(W=>{if(!u)return!1;const te=u.getDay(),ae=D.find(ce=>ce.day_of_week===te);if(!ae)return!1;const Y=W.name.toLowerCase();return Y.includes("morning")||Y.includes("")||Y.includes("")?ae.morning:Y.includes("dinner")||Y.includes("")||Y.includes("")?ae.dinner:Y.includes("1st")||Y.includes("1")||Y.includes("period1")?ae.period1:Y.includes("2nd")||Y.includes("2")||Y.includes("period2")?ae.period2:!1}).map(W=>{const te=m.includes(W.id);return y.jsxs("button",{onClick:()=>V(W.id),className:`w-full p-4 rounded-2xl border-2 transition-all flex items-center justify-between group text-left ios-tap
                                ${te?"border-ios-indigo bg-ios-indigo/5":"border-white bg-white shadow-sm"}
                            `,children:[y.jsxs("div",{children:[y.jsx("h4",{className:`text-base font-black ${te?"text-ios-indigo":"text-[#1C1C1E]"}`,children:W.name}),y.jsxs("p",{className:"text-xs font-bold text-ios-gray mt-1",children:[W.start_time.slice(0,5)," ~ ",W.end_time.slice(0,5)]})]}),y.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors
                                ${te?"border-ios-indigo bg-ios-indigo text-white":"border-gray-200 bg-gray-50"}
                            `,children:te&&y.jsx(ys,{className:"w-4 h-4"})})]},W.id)})})]})},C=()=>y.jsxs("div",{className:"space-y-4 animate-fade-in",children:[y.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:"  "}),y.jsx("p",{className:"text-sm font-bold text-ios-gray",children:" (Zone) ."}),y.jsx("div",{className:"space-y-3 mt-4",children:f.map(V=>{const W=x===V.id;return y.jsxs("button",{onClick:()=>v(V.id),className:`w-full p-5 rounded-2xl border-2 transition-all flex items-center justify-between text-left ios-tap
                                ${W?"border-ios-indigo bg-ios-indigo/5":"border-white bg-white shadow-sm"}
                            `,children:[y.jsx("span",{className:`text-lg font-black ${W?"text-ios-indigo":"text-[#1C1C1E]"}`,children:V.name}),W&&y.jsx("div",{className:"text-xs font-bold text-ios-indigo bg-ios-indigo/10 px-2 py-1 rounded",children:""})]},V.id)})})]}),P=()=>{var ce,ue;const W=(()=>{if(!G||G.length===0)return[];const xe=new Set;return G.forEach(_e=>{xe.add(_e.zone_name||"")}),Array.from(xe).sort()})(),te=xe=>{if(W.length===0)return;let _e=W.indexOf(b);_e===-1&&(_e=0);let fe;xe==="up"?fe=(_e+1)%W.length:fe=(_e-1+W.length)%W.length;const ve=W[fe];k(ve);const Ce=G.find(De=>(De.zone_name||"")===ve);_(Ce?F(Ce):"")},ae=xe=>{if(!G||G.length===0)return;const _e=b||W[0],fe=G.filter(Me=>(Me.zone_name||"")===_e);if(fe.length===0)return;const ve=[...fe].sort((Me,Ye)=>{const tt=parseInt(Me.seat_number.toString().replace(/\D/g,""))||0,Ue=parseInt(Ye.seat_number.toString().replace(/\D/g,""))||0;return tt-Ue}),Ce=ve.find(Me=>F(Me)===w.toString());let De=0;if(Ce){const Me=ve.indexOf(Ce);xe==="up"?De=(Me+1)%ve.length:De=(Me-1+ve.length)%ve.length}else De=0;const Re=ve[De];_(F(Re))},Y=b||(W.length>0?W[0]:"-");return y.jsxs("div",{className:"space-y-4 animate-fade-in",children:[y.jsxs("h3",{className:"text-xl font-black text-[#1C1C1E]",children:[(ce=f.find(xe=>xe.id===x))==null?void 0:ce.name,"  "]}),y.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"(Section)    ."}),y.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-gray-100 mt-4",children:[y.jsxs("div",{className:"flex gap-4",children:[y.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2",children:[y.jsx("label",{className:"text-xs font-black text-ios-gray uppercase tracking-widest",children:" (Section)"}),y.jsx("button",{onClick:()=>te("up"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:y.jsx(Fg,{className:"w-6 h-6"})}),y.jsx("div",{className:"h-16 flex items-center justify-center",children:y.jsx("span",{className:"text-5xl font-black text-[#1C1C1E] text-center leading-tight",children:Y})}),y.jsx("button",{onClick:()=>te("down"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:y.jsx(Og,{className:"w-6 h-6"})})]}),y.jsx("div",{className:"w-px bg-gray-100 my-4"}),y.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2",children:[y.jsx("label",{className:"text-xs font-black text-ios-gray uppercase tracking-widest",children:" (No.)"}),y.jsx("button",{onClick:()=>ae("up"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:y.jsx(Fg,{className:"w-6 h-6"})}),y.jsx("div",{className:"h-16 flex items-center justify-center w-full",children:y.jsx("input",{type:"text",value:w,onChange:xe=>_(xe.target.value),placeholder:"-",className:"w-full text-5xl font-black text-center border-none focus:ring-0 outline-none bg-transparent text-[#1C1C1E] p-0"})}),y.jsx("button",{onClick:()=>ae("down"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:y.jsx(Og,{className:"w-6 h-6"})})]})]}),y.jsx("div",{className:"border-t border-gray-100 pt-6 mt-2",children:y.jsxs("button",{onClick:()=>ne(!0),className:"w-full py-4 rounded-xl bg-gray-50 hover:bg-gray-100 text-[#1C1C1E] font-bold text-sm flex items-center justify-center gap-2 transition-all border border-gray-200",children:[y.jsx(As,{className:"w-4 h-4"}),"  "]})})]}),w&&y.jsxs("div",{className:"flex items-center gap-2 justify-center text-ios-indigo text-xs font-bold animate-fade-in",children:[y.jsx(ys,{className:"w-3 h-3"}),(ue=f.find(xe=>xe.id===x))==null?void 0:ue.name," ",Y!==""?`${Y}`:""," - ",w,""]})]})},I=()=>y.jsxs("div",{className:"space-y-4 animate-fade-in",children:[y.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:" "}),y.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"       ."}),y.jsx("textarea",{value:S,onChange:V=>O(V.target.value),placeholder:":   2 ,   50  ",className:"w-full h-48 bg-white border border-gray-200 rounded-2xl p-5 text-base font-medium resize-none focus:ring-2 focus:ring-ios-indigo/20 outline-none transition-all shadow-sm"})]}),H=()=>{var ae;const V=u?Ee(u,"M d (EEE)",{locale:Yt}):"",W=(ae=f.find(Y=>Y.id===x))==null?void 0:ae.name,te=c.filter(Y=>m.includes(Y.id)).map(Y=>Y.name).join(", ");return y.jsxs("div",{className:"space-y-6 animate-fade-in",children:[y.jsx("h3",{className:"text-xl font-black text-[#1C1C1E] text-center",children:"  "}),y.jsx("div",{className:"bg-white rounded-3xl shadow-[0_4px_20px_rgba(0,0,0,0.03)] border border-gray-100 overflow-hidden",children:y.jsxs("div",{className:"p-6 space-y-6",children:[y.jsxs("div",{className:"flex items-start gap-4",children:[y.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-indigo/10 flex items-center justify-center shrink-0",children:y.jsx(Hi,{className:"w-5 h-5 text-ios-indigo"})}),y.jsxs("div",{children:[y.jsx("p",{className:"text-xs font-bold text-ios-gray",children:""}),y.jsx("p",{className:"text-lg font-black text-[#1C1C1E]",children:V})]})]}),y.jsxs("div",{className:"flex items-start gap-4",children:[y.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-rose/10 flex items-center justify-center shrink-0",children:y.jsx($i,{className:"w-5 h-5 text-ios-rose"})}),y.jsxs("div",{children:[y.jsx("p",{className:"text-xs font-bold text-ios-gray",children:""}),y.jsx("p",{className:"text-lg font-black text-[#1C1C1E]",children:te})]})]}),y.jsxs("div",{className:"flex items-start gap-4",children:[y.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-emerald/10 flex items-center justify-center shrink-0",children:y.jsx(As,{className:"w-5 h-5 text-ios-emerald"})}),y.jsxs("div",{children:[y.jsx("p",{className:"text-xs font-bold text-ios-gray",children:""}),y.jsx("p",{className:"text-lg font-black text-[#1C1C1E]",children:W}),y.jsxs("p",{className:"text-base font-bold text-ios-indigo mt-0.5",children:[w," "]})]})]}),y.jsxs("div",{className:"flex items-start gap-4 border-t border-gray-50 pt-4",children:[y.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-amber/10 flex items-center justify-center shrink-0",children:y.jsx(Ov,{className:"w-5 h-5 text-ios-amber"})}),y.jsxs("div",{children:[y.jsx("p",{className:"text-xs font-bold text-ios-gray",children:" "}),y.jsx("p",{className:"text-sm font-medium text-[#1C1C1E] leading-relaxed line-clamp-3",children:S||" "})]})]})]})}),y.jsx("div",{className:"text-center",children:y.jsx("p",{className:"text-xs text-red-400 font-bold mb-2",children:"*      ."})})]})},L=()=>{switch(n){case 0:return!!u;case 1:return!!x;case 2:return!!w;case 3:return m.length>0;case 4:return!!S.trim();default:return!0}},z=()=>{n<5&&L()&&i(V=>V+1)},ee=()=>{n>0?i(V=>V-1):e()},A=async()=>{if(!s){l(!0);try{const V=Ee(u,"yyyy-MM-dd");let W=null;if(G&&G.length>0){const ue=G.find(xe=>{const _e=xe.zone_name||"",fe=F(xe);return _e===b&&fe===w.toString()});ue&&(W=ue.id)}if(!W){alert("    .   ."),l(!1);return}const te=m.map(ue=>({user_id:r.id,seat_id:W,date:V,session_id:ue,booking_type:"regular"})),{error:ae}=await we.from("bookings").insert(te);if(ae)throw ae;const Y=m.map(ue=>({user_id:r.id,date:V,session_id:ue,content:S})),{error:ce}=await we.from("study_plans").insert(Y);alert("  !"),t()}catch(V){console.error("Booking failed:",V),alert(`  .    .
`+V.message)}finally{l(!1)}}};return y.jsxs("div",{className:"flex flex-col h-full bg-[#F2F2F7]",children:[y.jsxs("div",{className:"flex-none px-6 py-4 flex items-center justify-between bg-white/80 backdrop-blur border-b border-gray-200",children:[y.jsx("button",{onClick:ee,className:"p-2 -ml-2 rounded-full hover:bg-gray-100 text-ios-gray hover:text-[#1C1C1E] transition-colors",children:y.jsx(ci,{className:"w-6 h-6"})}),y.jsxs("span",{className:"text-base font-black text-[#1C1C1E]",children:[" (",n+1,"/6)"]}),y.jsx("div",{className:"w-10"})," "]}),y.jsx("div",{className:"flex-1 overflow-y-auto p-6 pb-32",children:y.jsxs("div",{className:"max-w-md mx-auto",children:[n===0&&R(),n===1&&C(),n===2&&P(),n===3&&N(),n===4&&I(),n===5&&H()]})}),y.jsx("div",{className:"flex-none p-6 bg-white border-t border-gray-100 pb-[max(1.5rem,env(safe-area-inset-bottom))]",children:y.jsx("button",{onClick:n===5?A:z,disabled:!L()||s,className:`w-full py-4 rounded-2xl font-black text-base flex items-center justify-center gap-2 transition-all shadow-lg ios-tap
                    ${L()&&!s?"bg-[#1C1C1E] text-white hover:bg-gray-800":"bg-gray-200 text-gray-400 cursor-not-allowed shadow-none"}
                `,children:s?y.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):n===5?y.jsxs(y.Fragment,{children:[y.jsx(ys,{className:"w-5 h-5"}),"  "]}):y.jsxs(y.Fragment,{children:["  ",y.jsx(qr,{className:"w-5 h-5"})]})})}),y.jsx(S8,{isOpen:K,zoneId:x,onClose:()=>ne(!1),onSelect:V=>{if(V){const W=V.zone_name||"";k(W);const te=F(V);_(te),ne(!1)}}})]})},m_=({user:e})=>{const[t,r]=le.useState("idle"),[n,i]=le.useState(""),s=()=>{const o=new Date,a=9*60*60*1e3;return new Date(o.getTime()+a).toISOString().replace("Z","+09:00")},l=async()=>{if(r("locating"),i("Verifying your location..."),!navigator.geolocation){r("error"),i("Geolocation is not supported by your browser.");return}navigator.geolocation.getCurrentPosition(async o=>{const{latitude:a,longitude:c,accuracy:d}=o.coords,{data:f}=await we.from("sessions").select("*");if(!f){r("error"),i("     .");return}const h=new Date,u=h.getHours().toString().padStart(2,"0")+":"+h.getMinutes().toString().padStart(2,"0")+":00",p=f.find(S=>u>=S.start_time&&u<=S.end_time);if(!p){i("     ."),r("error");return}const{data:m}=await we.from("zones").select("settings").eq("id",p.zone_id).single(),g=(m==null?void 0:m.settings)||{},x=g.points||[{lat:g.latitude||37.5665,lng:g.longitude||126.978,name:" "}],v=g.radius||100;let w=!1,_=1/0,b=null;const k=6371e3;if(x.forEach(S=>{const O=a*Math.PI/180,F=S.lat*Math.PI/180,D=(S.lat-a)*Math.PI/180,U=(S.lng-c)*Math.PI/180,M=Math.sin(D/2)*Math.sin(D/2)+Math.cos(O)*Math.cos(F)*Math.sin(U/2)*Math.sin(U/2),q=2*Math.atan2(Math.sqrt(M),Math.sqrt(1-M)),G=k*q;G<_&&(_=G,b=S),G<=v&&(w=!0)}),w){r("verified");try{const S=h.toISOString().split("T")[0],{data:O,error:F}=await we.from("bookings").select("id").eq("user_id",e.id).eq("date",S).eq("session_id",p.id).maybeSingle();if(F||!O){i(` '${p.name}'   .`),r("error");return}const D=new Date(`${S}T${p.start_time}+09:00`),U=new Date(D.getTime()+10*60*1e3),M=s(),Q=new Date(M)>U?"late":"present",{error:K}=await we.from("attendance").upsert({booking_id:O.id,status:Q,timestamp_in:M,updated_at:new Date().toISOString()},{onConflict:"booking_id"});if(K)throw K;i(`'${p.name}'   !`),setTimeout(()=>r("done"),1500)}catch(S){console.error("Attendance recording error:",S),i("    .   ."),r("error")}}else r("error"),d>1e3?i(`  . ( : ${Math.round(d)}m)
             PC  GPS   . 
                '' 'GPS'   .`):i(`   .
              '${(b==null?void 0:b.name)||" "}'  ${Math.round(_)}m  .
            ( : ${v}m)
            
            Tip:   GPS    ,      .`),console.log("GPS Verification Debug:",{user:{lat:a,lng:c,accuracy:d},nearestPoint:b,minDistance:_,targetRadius:v})},o=>{r("error"),i("    . GPS   .")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})};return y.jsxs("div",{className:"ios-glass rounded-ios p-12 max-w-lg w-full text-center space-y-10 relative overflow-hidden animate-spring-up shadow-3xl",children:[y.jsx("div",{className:"absolute top-0 left-0 w-32 h-32 bg-ios-indigo/5 blur-3xl -z-10"}),y.jsx("div",{className:`w-24 h-24 rounded-[2rem] mx-auto flex items-center justify-center transition-all duration-700 shadow-inner-white ${t==="verified"||t==="done"?"bg-ios-emerald/20 text-ios-emerald shadow-ios-emerald/20":t==="error"?"bg-ios-rose/20 text-ios-rose shadow-ios-rose/20":t==="locating"?"bg-ios-indigo/20 text-ios-indigo shadow-ios-indigo/20 animate-pulse":"bg-white/5 text-white/30"}`,children:t==="done"?y.jsx(ys,{className:"w-12 h-12"}):t==="error"?y.jsx(ei,{className:"w-12 h-12"}):t==="locating"?y.jsx(As,{className:"w-12 h-12"}):y.jsx(C0,{className:"w-12 h-12"})}),y.jsxs("div",{className:"space-y-4",children:[y.jsx("h3",{className:"text-3xl font-black tracking-tight text-white",children:t==="done"?"  ":t==="locating"?"  ":"  "}),y.jsx("p",{className:"text-ios-gray font-medium text-lg leading-relaxed px-4",children:n||"     GPS  ."})]}),t!=="done"&&y.jsx("button",{onClick:l,disabled:t==="locating",className:`w-full py-6 rounded-2xl font-black text-lg transition-all shadow-2xl ios-tap ${t==="locating"?"bg-white/5 text-white/20":t==="error"?"bg-black text-white shadow-black/30":"bg-white text-black"}`,children:t==="locating"?"  ...":"  "})]})},x_=({user:e})=>{const[t,r]=le.useState([]),[n,i]=le.useState(!1),[s,l]=le.useState({cumulativeDays:0,cumulativeTime:0,attendanceRate:0,lateCount:0}),[o,a]=le.useState([]),[c,d]=le.useState(!1),[f,h]=le.useState([]);le.useEffect(()=>{if(!e)return;(async()=>{const g="2025-03-01",v=Ee(new Date,"yyyy-MM-dd"),{data:w}=await we.from("bookings").select(`
                *,
                sessions (
                    start_time,
                    end_time
                ),
                attendance (
                    status,
                    timestamp_in
                )
            `).eq("user_id",e.id).gte("date",g);if(w){h(w);let _=0,b=0,k=0,S=0;const O=new Set;w.forEach(F=>{if(F.date>v)return;_++;const U=F.attendance&&F.attendance[0];if(U&&(U.status==="present"||U.status==="late")&&(b++,O.add(F.date),U.status==="late"&&k++,F.sessions)){const M=new Date(`${F.date}T${F.sessions.start_time}`),G=(new Date(`${F.date}T${F.sessions.end_time}`)-M)/(1e3*60);let Q=0;if(U.timestamp_in){const K=new Date(U.timestamp_in),ne=new Date(`${F.date}T${F.sessions.start_time}+09:00`);K>ne&&(Q=(K-ne)/(1e3*60))}S+=Math.max(0,G-Math.max(0,Q))}}),l({cumulativeDays:O.size,cumulativeTime:Math.round(S),attendanceRate:_>0?Math.round(b/_*100):0,lateCount:k})}a([])})()},[e]);const u=$s({start:$a(new Date),end:Tl(new Date)}),p=m=>{const g=Math.floor(m/60),x=m%60;return`${g} ${x}`};return y.jsxs("div",{className:"flex flex-col gap-4 md:gap-6",children:[y.jsx("div",{className:"animate-spring-up",children:y.jsxs("div",{className:"ios-glass rounded-ios p-10 border-white/5 shadow-inner-white",children:[y.jsx("div",{className:"flex items-center justify-between mb-10",children:y.jsxs("h3",{className:"text-xl font-black flex items-center gap-3",children:[y.jsx("div",{className:"w-10 h-10 rounded-ios bg-ios-indigo/20 flex items-center justify-center",children:y.jsx(Hi,{className:"w-5 h-5 text-ios-indigo"})}),"  "]})}),y.jsx("div",{className:"grid grid-cols-7 gap-3 text-center mb-6",children:["","","","","","",""].map((m,g)=>y.jsx("span",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest",children:m},g))}),y.jsx("div",{className:"grid grid-cols-7 gap-3",children:u.map((m,g)=>{const x=Ee(m,"yyyy-MM-dd"),v=f.find(b=>b.date===x);let w=null;if(v){const b=Ee(new Date,"yyyy-MM-dd");if(x>b)w="booking";else{const k=v.attendance&&v.attendance[0];k?w=k.status:w="absent"}}const _=gp(m);return y.jsxs("div",{className:`aspect-square rounded-ios flex items-center justify-center text-[12px] font-black transition-all duration-500 ios-tap relative group ${_?"bg-[#1C1C1E] text-white shadow-xl scale-[1.15] z-10":w==="present"?"bg-ios-emerald/10 text-ios-emerald":w==="late"?"bg-ios-amber/10 text-ios-amber":w==="absent"?"bg-ios-rose/10 text-ios-rose":w==="booking"?"bg-ios-indigo/10 text-ios-indigo":"bg-gray-50 text-gray-300 hover:bg-gray-100 hover:text-gray-500"}`,children:[Ee(m,"d"),w&&!_&&w!=="booking"&&y.jsx("div",{className:`absolute bottom-1 w-1 h-1 rounded-full ${w==="present"?"bg-ios-emerald":w==="late"?"bg-ios-amber":"bg-ios-rose"}`}),w==="booking"&&!_&&y.jsx("div",{className:"absolute bottom-1 w-1 h-1 rounded-full bg-ios-indigo"})]},g)})}),y.jsx("div",{className:"mt-10 pt-8 border-t border-gray-100",children:y.jsxs("div",{className:"flex flex-col gap-4",children:[y.jsx("span",{className:"text-[11px] font-black text-ios-gray uppercase tracking-[0.2em]",children:" "}),y.jsx("div",{className:"flex flex-wrap gap-4",children:[{label:"",color:"bg-ios-emerald"},{label:"",color:"bg-ios-amber"},{label:"",color:"bg-ios-rose"},{label:"",color:"bg-ios-indigo"}].map(m=>y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:`w-2 h-2 rounded-full ${m.color}`}),y.jsx("span",{className:"text-[10px] font-bold text-gray-400",children:m.label})]},m.label))})]})})]})}),y.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4 md:gap-6 overflow-visible",children:[y.jsx("div",{className:"xl:col-span-2 flex flex-col gap-4 md:gap-6 animate-spring-up",style:{animationDelay:"100ms"},children:y.jsxs("div",{className:"grid grid-cols-2 gap-4 md:gap-6",children:[y.jsxs("div",{className:"col-span-2 ios-glass rounded-ios p-8 flex flex-col items-center text-center gap-2 group hover:bg-white transition-all duration-500 ios-tap border border-transparent hover:border-gray-100 shadow-sm relative overflow-hidden",children:[y.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-ios-amber/10 blur-3xl -z-10"}),y.jsx("div",{className:"w-16 h-16 rounded-ios bg-ios-amber/10 text-ios-amber flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform mb-2",children:y.jsx(Bf,{className:"w-8 h-8"})}),y.jsx("p",{className:"text-[11px] uppercase font-black text-ios-gray tracking-widest",children:"   "}),y.jsxs("div",{className:"flex flex-col items-center",children:[y.jsxs("p",{className:"text-4xl font-black text-[#1C1C1E]",children:[s.cumulativeDays,""]}),y.jsx("p",{className:"text-sm font-bold text-gray-400 mt-1",children:p(s.cumulativeTime)})]})]}),y.jsxs("div",{className:"ios-glass rounded-ios p-8 flex flex-col items-center text-center gap-4 group hover:bg-white transition-all duration-500 ios-tap border border-transparent hover:border-gray-100 shadow-sm",children:[y.jsx("div",{className:"w-12 h-12 rounded-ios bg-ios-emerald/10 text-ios-emerald flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform",children:y.jsx(ys,{className:"w-6 h-6"})}),y.jsxs("div",{children:[y.jsx("p",{className:"text-[10px] uppercase font-black text-ios-gray tracking-widest mb-1",children:""}),y.jsxs("p",{className:"text-2xl font-black text-[#1C1C1E]",children:[s.attendanceRate,"%"]})]})]}),y.jsxs("div",{className:"ios-glass rounded-ios p-8 flex flex-col items-center text-center gap-4 group hover:bg-white transition-all duration-500 ios-tap border border-transparent hover:border-gray-100 shadow-sm",children:[y.jsx("div",{className:"w-12 h-12 rounded-ios bg-ios-rose/10 text-ios-rose flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform",children:y.jsx(Nk,{className:"w-6 h-6"})}),y.jsxs("div",{children:[y.jsx("p",{className:"text-[10px] uppercase font-black text-ios-gray tracking-widest mb-1",children:" "}),y.jsxs("p",{className:"text-2xl font-black text-[#1C1C1E]",children:[s.lateCount,""]})]})]})]})}),y.jsx("div",{className:"animate-spring-up",style:{animationDelay:"200ms"},children:y.jsxs("div",{className:"bg-gradient-to-br from-ios-indigo via-[#7D7AFF] to-[#9B99FF] rounded-ios p-10 text-white shadow-2xl shadow-ios-indigo/30 relative overflow-hidden group ios-tap",children:[y.jsxs("div",{className:"relative z-10",children:[y.jsx("div",{className:"w-14 h-14 rounded-ios bg-white/20 backdrop-blur-md flex items-center justify-center mb-6 shadow-inner-white",children:y.jsx(Bf,{className:"w-8 h-8 text-white"})}),y.jsx("h4",{className:"text-2xl font-black tracking-tight mb-2",children:" "}),y.jsxs("p",{className:"text-[15px] text-white/80 font-medium mb-8 leading-relaxed",children:[" 5%  .",y.jsx("br",{}),"   ."]}),y.jsx("button",{onClick:()=>d(!0),className:"w-full py-4 bg-black hover:bg-gray-900 rounded-ios text-xs font-black uppercase tracking-widest transition-all backdrop-blur-sm border border-white/10",children:" "})]}),y.jsx("div",{className:"absolute -right-16 -top-16 w-64 h-64 bg-white/10 rounded-full blur-3xl group-hover:scale-150 transition-transform duration-[2000ms]"}),y.jsx("div",{className:"absolute left-[-10%] bottom-[-10%] w-40 h-40 bg-white/5 rounded-full blur-2xl group-hover:translate-x-10 transition-transform duration-[2000ms]"})]})})]}),c&&y.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 animate-in fade-in duration-200",children:[y.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>d(!1)}),y.jsxs("div",{className:"bg-white rounded-ios p-8 w-full max-w-md relative z-10 shadow-2xl animate-spring-up",children:[y.jsxs("div",{className:"flex items-center justify-between mb-8",children:[y.jsxs("h3",{className:"text-xl font-black flex items-center gap-3",children:[y.jsx("div",{className:"w-10 h-10 rounded-ios bg-ios-amber/20 flex items-center justify-center",children:y.jsx(Bf,{className:"w-5 h-5 text-ios-amber"})})," "]}),y.jsx("div",{className:"bg-gray-100 rounded-full px-3 py-1",children:y.jsx("span",{className:"text-[10px] font-bold text-gray-500",children:"TOP 10"})})]}),y.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2",children:o.length>0?o.map((m,g)=>y.jsxs("div",{className:"flex items-center justify-between p-4 rounded-ios bg-gray-50 border border-gray-100/50",children:[y.jsxs("div",{className:"flex items-center gap-4",children:[y.jsx("div",{className:`w-8 h-8 flex items-center justify-center font-black rounded-full shadow-sm ${g===0?"bg-yellow-400 text-white":g===1?"bg-gray-400 text-white":g===2?"bg-orange-400 text-white":"bg-white text-gray-400 border border-gray-200"}`,children:m.rank}),y.jsx("div",{className:"flex flex-col",children:y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-sm font-black text-[#1C1C1E]",children:m.name}),y.jsx("span",{className:"text-[10px] font-bold text-gray-500 bg-white px-1.5 py-0.5 rounded border border-gray-200",children:m.info})]})})]}),y.jsx("p",{className:"text-xs font-bold text-ios-indigo bg-ios-indigo/5 px-2 py-1 rounded-lg",children:p(m.score)})]},g)):y.jsx("div",{className:"text-center py-12 text-gray-400 font-medium text-sm bg-gray-50 rounded-ios",children:"  ,   ."})}),y.jsx("button",{onClick:()=>d(!1),className:"w-full mt-6 py-4 bg-[#1C1C1E] text-white rounded-ios font-black text-sm hover:scale-[1.02] active:scale-[0.98] transition-all shadow-lg",children:""})]})]})]})},C8=({onLogout:e,currentUser:t})=>{const[r,n]=le.useState("home"),[i,s]=le.useState(null),[l,o]=le.useState("GOE STUDY CAFE"),[a,c]=le.useState(""),[d,f]=le.useState({}),[h,u]=le.useState(new Date);le.useEffect(()=>{const v=async()=>{const{data:k}=await we.from("sessions").select("*");if(k){const S=new Date,O=S.getHours().toString().padStart(2,"0")+":"+S.getMinutes().toString().padStart(2,"0")+":00",F=k.find(D=>O>=D.start_time&&O<=D.end_time);s(F)}},w=async()=>{var S;const{data:k}=await we.from("configs").select("value").eq("key","school_info").single();(S=k==null?void 0:k.value)!=null&&S.name&&o(k.value.name)},_=async()=>{if(!t)return;const k=Ee(new Date,"yyyy-MM-dd"),S=cr(h,{weekStartsOn:1}),O=ii(h,{weekStartsOn:1}),{data:F}=await we.from("study_plans").select("content").eq("user_id",t.id).eq("date",k);if(F&&F.length>0){const U=F.map(M=>M.content).filter(Boolean).join(`
`);c(U)}else c("");const{data:D}=await we.from("bookings").select(`
                *,
                sessions (
                    id,
                    start_time,
                    end_time
                ),
                attendance (
                    id,
                    booking_id,
                    status,
                    timestamp_in,
                    timestamp_out
                )
            `).eq("user_id",t.id).gte("date",Ee(S,"yyyy-MM-dd")).lte("date",Ee(O,"yyyy-MM-dd"));if(D){const U={};D.forEach(M=>{const q=M.date;U[q]||(U[q]={bookings:[],attendance:[]}),U[q].bookings.push(M),M.attendance&&M.attendance.length>0&&U[q].attendance.push(...M.attendance)}),f(U)}};v(),w(),_();const b=setInterval(()=>{v(),_()},6e4);return()=>clearInterval(b)},[t,h]);const p=()=>u(v=>p_(v)),m=()=>u(v=>lf(v,1)),g=(v,w)=>{var q,G;if(!w||!w.bookings.length)return null;const _=new Date,b=Ee(_,"yyyy-MM-dd"),{bookings:k,attendance:S}=w;if(v>b)return{label:"",color:"text-ios-indigo bg-ios-indigo/10"};if(v<b)return S.length?S.some(K=>K.status==="late")?{label:"",color:"text-ios-amber bg-ios-amber/10"}:{label:"",color:"text-ios-emerald bg-ios-emerald/10"}:{label:"",color:"text-ios-rose bg-ios-rose/10"};const O=Ee(_,"HH:mm:ss"),F=[...k].sort((Q,K)=>{var ne,J;return(((ne=Q.sessions)==null?void 0:ne.start_time)||"").localeCompare(((J=K.sessions)==null?void 0:J.start_time)||"")});if(!F.length)return null;const D=(q=F[0].sessions)==null?void 0:q.start_time,U=(G=F[F.length-1].sessions)==null?void 0:G.end_time;if(U&&O>U)return{label:"",color:"text-gray-500 bg-gray-100"};if(D&&O<D)return{label:"",color:"text-ios-indigo bg-ios-indigo/10"};const M=F.find(Q=>{const K=Q.sessions;return K&&O>=K.start_time&&O<=K.end_time});return M?S.find(K=>K.booking_id===M.id)?{label:"",color:"text-white bg-ios-emerald"}:{label:"",color:"text-ios-rose bg-ios-rose/10"}:{label:"",color:"text-ios-amber bg-ios-amber/10"}},x=()=>{switch(r){case"home":return y.jsxs("div",{className:"flex-1 flex flex-col gap-4 p-4 animate-fade-in relative overflow-y-auto scrollbar-hide",children:[y.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-ios-indigo/5 blur-3xl -z-10"}),y.jsx("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-ios-blue/5 blur-3xl -z-10"}),y.jsxs("div",{className:"flex-[2] bg-white rounded-[2rem] border border-gray-100 shadow-sm p-6 relative overflow-hidden flex flex-col",children:[y.jsxs("div",{className:"flex items-center justify-between mb-2",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"w-8 h-8 rounded-full bg-ios-amber/10 flex items-center justify-center",children:y.jsx(Ov,{className:"w-4 h-4 text-ios-amber"})}),y.jsx("h2",{className:"text-lg font-black text-[#1C1C1E]",children:" "})]}),y.jsxs("span",{className:"text-[10px] font-bold text-ios-gray bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100 max-sm:hidden",children:[Ee(new Date,"M d")," "]})]}),y.jsx("div",{className:"flex-1 flex items-center justify-center text-center",children:a?y.jsx("p",{className:"text-[15px] text-[#1C1C1E] font-bold leading-relaxed whitespace-pre-line line-clamp-3",children:a}):y.jsxs("div",{className:"text-center",children:[y.jsx("p",{className:"text-sm text-gray-400 font-bold leading-relaxed mb-1",children:"    ."}),y.jsx("span",{className:"text-xs font-medium text-gray-300",children:"   ."})]})}),y.jsxs("div",{className:"bg-gray-50/50 rounded-2xl p-4 border border-gray-100/50 mt-auto relative",children:[y.jsx("button",{onClick:p,className:"absolute left-1 top-1/2 -translate-y-1/2 w-8 h-8 flex items-center justify-center text-gray-400 hover:text-[#1C1C1E] transition-colors",children:y.jsx(ci,{className:"w-5 h-5"})}),y.jsx("button",{onClick:m,className:"absolute right-1 top-1/2 -translate-y-1/2 w-8 h-8 flex items-center justify-center text-gray-400 hover:text-[#1C1C1E] transition-colors",children:y.jsx(qr,{className:"w-5 h-5"})}),y.jsx("div",{className:"flex justify-between items-center px-6",children:$s({start:cr(h,{weekStartsOn:1}),end:ii(h,{weekStartsOn:1})}).map((v,w)=>{const _=Ee(v,"yyyy-MM-dd"),b=d[_],k=g(_,b),S=Ui(v,new Date);return y.jsxs("div",{className:"flex flex-col items-center gap-2",children:[y.jsx("span",{className:`text-[9px] font-black ${S?"text-[#1C1C1E]":"text-gray-300"}`,children:["","","","","","",""][w]}),y.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-[10px] font-black transition-all ${S?"bg-[#1C1C1E] text-white shadow-lg ring-4 ring-white z-10":"bg-white border border-gray-100 text-gray-300"}`,children:Ee(v,"d")}),y.jsx("div",{className:"h-4 flex items-center justify-center",children:k?y.jsx("span",{className:`text-[8px] font-bold px-1.5 py-0.5 rounded-full whitespace-nowrap ${k.color}`,children:k.label}):y.jsx("div",{className:"w-1 h-1 rounded-full bg-transparent"})})]},w)})})]})]}),y.jsxs("button",{onClick:()=>n("map"),className:"flex-1 bg-white rounded-3xl border border-gray-100 shadow-sm p-4 flex items-center justify-center gap-6 group transition-all active:scale-[0.98] relative overflow-hidden ios-tap",children:[y.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-ios-indigo/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),y.jsx("div",{className:"w-14 h-14 rounded-full bg-ios-indigo/10 flex items-center justify-center group-hover:scale-110 transition-transform duration-500",children:y.jsx(hu,{className:"w-7 h-7 text-ios-indigo"})}),y.jsxs("div",{className:"text-left space-y-1 relative z-10 flex-1",children:[y.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:""}),y.jsx("p",{className:"text-xs font-bold text-ios-gray",children:"  "})]}),y.jsx(qr,{className:"w-5 h-5 text-gray-300"})]}),y.jsxs("button",{onClick:()=>n("attendance"),className:"flex-1 bg-white rounded-3xl border border-gray-100 shadow-sm p-4 flex items-center justify-center gap-6 group transition-all active:scale-[0.98] relative overflow-hidden ios-tap",children:[y.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-ios-emerald/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),y.jsx("div",{className:"w-14 h-14 rounded-full bg-ios-emerald/10 flex items-center justify-center group-hover:scale-110 transition-transform duration-500",children:y.jsx(As,{className:"w-7 h-7 text-ios-emerald"})}),y.jsxs("div",{className:"text-left space-y-1 relative z-10 flex-1",children:[y.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:""}),y.jsx("p",{className:"text-xs font-bold text-ios-gray",children:"GPS  "})]}),y.jsx(qr,{className:"w-5 h-5 text-gray-300"})]})]});case"map":return y.jsx("div",{className:"flex-1 bg-white relative overflow-hidden flex flex-col",children:y.jsx(k8,{onCancel:()=>n("home"),onSuccess:()=>n("profile"),currentUser:t})});case"attendance":return y.jsx("div",{className:"flex-1 bg-white p-6 flex flex-col items-center justify-center",children:y.jsx(m_,{user:t})});case"profile":return y.jsx("div",{className:"flex-1 bg-[#F2F2F7] overflow-y-auto scrollbar-hide p-6",children:y.jsx(x_,{user:t})});default:return null}};return y.jsxs("div",{className:"mobile-container flex flex-col bg-[#F2F2F7] h-screen overflow-hidden font-sans pb-[safe-area-inset-bottom]",children:[y.jsxs("header",{className:"flex-none bg-white/80 backdrop-blur-md border-b border-gray-200/50 px-5 py-3 flex items-center justify-between z-50 sticky top-0 pt-[max(1rem,env(safe-area-inset-top))]",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"w-10 h-10 rounded-[10px] bg-[#1C1C1E] flex items-center justify-center shadow-sm",children:y.jsx(Ua,{className:"w-5 h-5 text-white"})}),y.jsxs("div",{children:[y.jsx("h1",{className:"text-[17px] font-black text-[#1C1C1E] tracking-tighter leading-tight uppercase",children:l.split(" ")[0]}),y.jsx("p",{className:"text-[9px] font-black tracking-[0.2em] text-ios-indigo uppercase opacity-80 leading-none mt-0.5",children:l.split(" ").slice(1).join(" ")||"STUDY CAFE"})]})]}),y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsxs("div",{className:"text-right",children:[y.jsx("p",{className:"text-[11px] font-black text-[#1C1C1E]",children:t==null?void 0:t.full_name}),y.jsx("p",{className:"text-[10px] font-black text-ios-gray leading-none mt-0.5",children:Ee(new Date,"yyyy M d (EEE)",{locale:Yt})})]}),y.jsx("button",{onClick:e,className:"w-10 h-10 rounded-full bg-gray-50 flex items-center justify-center text-ios-gray hover:text-black active:scale-95 transition-all border border-gray-100/50",children:y.jsx(Pl,{className:"w-4 h-4"})})]})]}),y.jsx("main",{className:"flex-1 flex flex-col overflow-hidden relative",children:x()}),r!=="map"&&y.jsx("nav",{className:"flex-none bg-white border-t border-gray-200/50 pb-[calc(1rem+env(safe-area-inset-bottom))] pt-3 px-6 flex justify-between items-center z-50 shadow-[0_-4px_20px_rgba(0,0,0,0.02)]",children:[{id:"home",icon:jv,label:""},{id:"map",icon:hu,label:""},{id:"attendance",icon:As,label:""},{id:"profile",icon:sl,label:"MY"}].map(v=>y.jsx("button",{onClick:()=>n(v.id),className:`flex flex-col items-center justify-center p-2 rounded-xl transition-all duration-300 w-16 group ${r===v.id?"text-[#1C1C1E]":"text-gray-300 hover:text-gray-500"}`,children:y.jsx("div",{className:"relative transition-transform duration-300",children:y.jsx(v.icon,{className:`w-7 h-7 stroke-[2.5px] ${r===v.id?"fill-current":"fill-transparent"}`})})},v.id))})]})},T8=({selectedSeat:e,onComplete:t,targetUser:r,loggedInUser:n,initialDate:i,onDateChange:s,currentZoneId:l})=>{const[o,a]=le.useState(1),[c,d]=le.useState(i||Ee(Bi(new Date,2),"yyyy-MM-dd")),[f,h]=le.useState(Ee(Bi(new Date,2),"yyyy-MM-dd")),[u,p]=le.useState([]),[m,g]=le.useState([]),[x,v]=le.useState(null),[w,_]=le.useState(null),[b,k]=le.useState({quarters:[],defaults:[],exceptions:[]}),[S,O]=le.useState([]),[F,D]=le.useState([]),[U,M]=le.useState(!1),[q,G]=le.useState("");le.useEffect(()=>{i&&d(i)},[i]);const Q={Morning:" ",Dinner:" ","1st Period":"1","2nd Period":"2"},K=I=>Q[I]||I;le.useEffect(()=>{(async()=>{const{data:{user:H}}=await we.auth.getUser();if(H){const{data:z}=await we.from("profiles").select("*").eq("id",H.id).single();v(r||z),_(z)}const L=(e==null?void 0:e.zone_id)||l;if(L){M(!0);const[z,ee,A,V]=await Promise.all([we.from("sessions").select("*").eq("zone_id",L).order("start_time",{ascending:!0}),we.from("operation_quarters").select("*"),we.from("operation_defaults").select("*").eq("zone_id",L),we.from("operation_exceptions").select("*").eq("zone_id",L)]);z.data&&p(z.data),k({quarters:ee.data||[],defaults:A.data||[],exceptions:V.data||[]}),M(!1)}else{const{data:z}=await we.from("operation_quarters").select("*");k(ee=>({...ee,quarters:z||[]}))}})()},[e,l,r]),le.useEffect(()=>{v(r||w)},[r,w]),le.useEffect(()=>{x&&c&&e&&(ne(),J()),g([])},[x,c,e,l]);const ne=async()=>{const{data:I}=await we.from("bookings").select("*").eq("user_id",x.id).eq("date",c);O(I||[])},J=async()=>{if(!e)return;const{data:I}=await we.from("bookings").select("*, profiles(username, full_name)").eq("seat_id",e.id).eq("date",c);D(I||[])},T=I=>{const H=Et(I),L=n||w,z=L&&["admin","teacher"].includes(L.role),ee=Qn(Bi(new Date,z?0:2));if(Wc(H,ee))return{ok:!1,msg:`   ${z?"0":"2"}  .`};if(b.quarters.length>0&&!b.quarters.some(W=>W.start_date&&W.end_date&&El(H,{start:Et(W.start_date),end:Et(W.end_date)})))return{ok:!1,msg:"    ."};const A=b.exceptions.find(V=>V.exception_date===I);if(A)return{ok:!1,msg:`: ${A.reason}`};if(b.defaults.length>0){const V=H.getDay(),W=b.defaults.find(ae=>ae.day_of_week===V);if(!(W&&(W.morning||W.dinner||W.period1||W.period2)))return{ok:!1,msg:"   ."}}return{ok:!0}},j=()=>{if(o===1){const I=n||w;if(I&&["admin","teacher"].includes(I.role)&&!r){G("/     .     .");return}const H=T(c);if(!H.ok){G(H.msg);return}if(S.length>0&&e&&S[0].seat_id!==e.id){G(`  ${S[0].seat_number}  .`);return}}G(""),a(I=>I+1)},B=I=>{g(H=>H.find(z=>z.id===I.id)?H.filter(z=>z.id!==I.id):[...H,I].sort((z,ee)=>z.id-ee.id))};async function E(I,H){if(I.stopPropagation(),!!window.confirm("   ?"))try{M(!0);const{error:L}=await we.from("bookings").delete().eq("seat_id",e.id).eq("date",c).eq("session_id",H);if(L)throw L;D(z=>z.filter(ee=>ee.session_id!==H)),O(z=>z.filter(ee=>ee.session_id!==H)),alert(" .")}catch(L){console.error("Cancel Error:",L),G(`    : ${L.message}`)}finally{M(!1)}}async function R(){if(m.length===0||U)return;const I=n||w;if(I&&["admin","teacher"].includes(I.role)&&!r){G("/     ."),a(1);return}const H=()=>{const L=new Date,z=9*60*60*1e3;return new Date(L.getTime()+z).toISOString().replace("Z","+09:00")};M(!0);try{const{data:L}=await we.from("bookings").select("session_id, user_id, seat_id").eq("date",c).in("session_id",m.map(A=>A.id));if(L&&L.length>0){const A=L.some(W=>W.seat_id===e.id),V=L.some(W=>W.user_id===x.id);if(A||V){G(A?"   .":"      ."),a(2),M(!1),ne(),J();return}}const z=m.map(A=>({user_id:x.id,seat_id:e.id,session_id:A.id,date:c,created_at:H()})),{error:ee}=await we.from("bookings").insert(z);ee?(G(` : ${ee.message}`),a(2)):(alert(" ."),t(),window.location.reload())}catch{G("   ")}finally{M(!1)}}const[N,C]=le.useState(new Date),P=()=>{const I=$a(N),H=Tl(I),L=cr(I),z=ii(H),ee=$s({start:L,end:z});return y.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-4 shadow-sm",children:[y.jsxs("div",{className:"flex items-center justify-between mb-4 px-1",children:[y.jsx("h4",{className:"text-sm font-black text-[#1C1C1E]",children:Ee(N,"yyyy M",{locale:Yt})}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{onClick:()=>C(cf(N)),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",children:y.jsx(ci,{className:"w-4 h-4 text-ios-gray"})}),y.jsx("button",{onClick:()=>C($l(N,1)),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",children:y.jsx(qr,{className:"w-4 h-4 text-ios-gray"})})]})]}),y.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[["","","","","","",""].map(A=>y.jsx("div",{className:"text-center text-[10px] font-bold text-ios-gray/50 py-1",children:A},A)),ee.map((A,V)=>{const W=Ee(A,"yyyy-MM-dd"),te=T(W),ae=c===W,Y=Ui($a(A),I),ce=gp(A);return y.jsx("button",{disabled:!te.ok,onClick:()=>{d(W),s&&s(W)},className:`
                  h-9 w-full rounded-lg flex flex-col items-center justify-center transition-all relative
                  ${ae?"bg-[#1C1C1E] text-white shadow-md z-10":""}
                  ${!ae&&Y&&te.ok?"hover:bg-gray-100 text-[#1C1C1E] font-black":""}
                  ${!ae&&te.ok&&!Y?"text-ios-gray/40 font-black":""}
                  ${te.ok?"":"opacity-20 cursor-not-allowed text-ios-gray grayscale"}
                  ${!ae&&ce?"border border-ios-indigo text-ios-indigo font-black":""}
                `,children:y.jsx("span",{className:"text-xs",children:Ee(A,"d")})},V)})]}),y.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-50 flex items-center gap-4 px-1",children:[y.jsxs("div",{className:"flex items-center gap-1.5",children:[y.jsx("div",{className:"w-2 h-2 rounded-full bg-[#1C1C1E]/10"}),y.jsx("span",{className:"text-[10px] font-bold text-ios-gray/70",children:""})]}),y.jsxs("div",{className:"flex items-center gap-1.5",children:[y.jsx("div",{className:"w-2 h-2 rounded-full bg-ios-indigo/20"}),y.jsx("span",{className:"text-[10px] font-bold text-ios-indigo/70",children:""})]})]})]})};return y.jsxs("div",{className:"bg-white border border-gray-100 border-b-0 rounded-t-[6px] rounded-b-none pt-[10px] px-6 pb-6 lg:px-8 lg:pb-8 space-y-5 animate-spring-up overflow-hidden relative h-full",children:[y.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-ios-indigo/5 blur-2xl -z-10"}),y.jsxs("div",{className:"bg-gray-50/50 rounded-[6px] mt-[10px] pt-4 px-4 pb-4 flex items-center gap-4 border border-gray-100",children:[y.jsx("div",{className:"w-12 h-12 rounded-[6px] bg-white text-[#000000] flex items-center justify-center font-black text-sm border border-gray-200 shadow-sm",children:e?e.display_number||e.seat_number:"?"}),y.jsxs("div",{children:[y.jsx("p",{className:"text-[9px] font-black text-[#000000] uppercase tracking-[0.2em] mb-0.5 opacity-50",children:"  "}),y.jsx("p",{className:"text-base font-black text-[#1C1C1E]",children:e?`Zone ${e.zone_name}`:"  "})]})]}),y.jsx("div",{className:"flex items-center gap-2",children:[1,2,3].map(I=>y.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-all duration-700 ${o>=I?"bg-[#1C1C1E]":"bg-gray-100"}`},I))}),o===1&&y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center",children:y.jsx(Hi,{className:"w-5 h-5 text-ios-indigo"})}),y.jsx("h3",{className:"text-xl font-black tracking-tight text-[#1C1C1E]",children:"  "})]}),y.jsxs("div",{className:"space-y-4",children:[P(),!T(c).ok&&y.jsxs("div",{className:"p-4 bg-ios-rose/5 border border-ios-rose/10 rounded-xl flex items-center gap-2 animate-shake",children:[y.jsx(ei,{className:"w-4 h-4 text-ios-rose"}),y.jsx("p",{className:"text-[11px] font-black text-ios-rose italic",children:T(c).msg})]}),y.jsxs("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-100 text-center",children:[y.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:" "}),y.jsx("p",{className:"text-lg font-black text-[#1C1C1E]",children:Ee(Et(c),"yyyy M d (EEEE)",{locale:Yt})})]})]}),q&&y.jsxs("div",{className:"p-4 bg-ios-rose/5 border border-ios-rose/10 rounded-[6px] flex items-center gap-2 animate-shake",children:[y.jsx(ei,{className:"w-4 h-4 text-ios-rose"}),y.jsx("p",{className:"text-[11px] font-black text-ios-rose",children:q})]}),y.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-50 flex gap-3",children:[y.jsx("button",{onClick:t,className:"flex-1 py-3.5 rounded-xl text-sm font-black text-ios-gray bg-gray-50 hover:bg-gray-100 transition-all ios-tap",children:""}),y.jsx("button",{disabled:!T(c).ok||!e,onClick:j,className:`flex-[1.5] py-3.5 rounded-xl text-sm font-black text-white transition-all shadow-lg ios-tap ${T(c).ok&&e?"bg-[#1C1C1E] shadow-black/10 hover:bg-gray-800":"bg-gray-200 cursor-not-allowed shadow-none"}`,children:" "})]})]}),o===2&&y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center",children:y.jsx($i,{className:"w-5 h-5 text-ios-indigo"})}),y.jsx("h3",{className:"text-xl font-black tracking-tight text-[#1C1C1E]",children:"  "})]}),y.jsx("p",{className:"text-[11px] font-black text-ios-gray px-1",children:"      . (  )"}),y.jsx("div",{className:"grid grid-cols-1 gap-3",children:u.map(I=>{var W;const H=Et(c).getDay(),L=b.defaults.find(te=>te.day_of_week===H),z=I.id===1?L==null?void 0:L.morning:I.id===2?L==null?void 0:L.dinner:I.id===3?L==null?void 0:L.period1:I.id===4?L==null?void 0:L.period2:!1,ee=S.some(te=>te.session_id===I.id),A=F.some(te=>te.session_id===I.id),V=m.some(te=>te.id===I.id);return z?y.jsxs("button",{disabled:ee||A,onClick:()=>B(I),className:`p-4 rounded-[6px] border transition-all duration-300 flex items-center justify-between group ios-tap text-left ${V?"border-[#1C1C1E] bg-[#1C1C1E]/5 shadow-sm":ee||A?["admin","teacher"].includes(x==null?void 0:x.role)?"border-red-100 bg-red-50/30":"opacity-30 bg-gray-100 cursor-not-allowed":"border-gray-100 bg-gray-50/50 hover:bg-gray-100/80"}`,children:[y.jsxs("div",{className:"flex-1 flex flex-col items-start",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("p",{className:"font-black text-base text-[#1C1C1E]",children:K(I.name)}),ee&&y.jsx("span",{className:"text-[9px] font-black text-ios-gray bg-gray-200 px-1.5 py-0.5 rounded-full uppercase",children:" "}),!ee&&A&&y.jsxs("div",{className:"flex flex-col items-start gap-1",children:[y.jsx("span",{className:"text-[9px] font-black text-ios-rose bg-ios-rose/10 px-1.5 py-0.5 rounded-full uppercase",children:" "}),["admin","teacher"].includes(w==null?void 0:w.role)&&((W=F.find(te=>te.session_id===I.id))==null?void 0:W.profiles)&&y.jsxs("span",{className:"text-[9px] font-bold text-ios-rose/70",children:[F.find(te=>te.session_id===I.id).profiles.username," ",F.find(te=>te.session_id===I.id).profiles.full_name]})]})]}),y.jsxs("p",{className:"text-[10px] font-black text-ios-gray/70 uppercase tracking-tight mt-0.5",children:[I.start_time.slice(0,5)," ~ ",I.end_time.slice(0,5)]})]}),V?y.jsx("div",{className:"w-5 h-5 rounded-full bg-[#1C1C1E] flex items-center justify-center shadow-sm",children:y.jsx(En,{className:"w-3 h-3 text-white stroke-[3px]"})}):(ee||A)&&["admin","teacher"].includes(x.role)?y.jsx("button",{onClick:te=>E(te,I.id),className:"w-8 h-8 rounded-full bg-red-50 hover:bg-red-100 flex items-center justify-center transition-all group/btn border border-red-200",title:" ",children:y.jsx(Li,{className:"w-4 h-4 text-red-500 group-hover/btn:scale-110 transition-transform"})}):y.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-gray-300 bg-white"})]},I.id):null})}),q&&y.jsxs("div",{className:"p-4 bg-ios-rose/5 border border-ios-rose/10 rounded-[6px] flex items-center gap-2 animate-shake",children:[y.jsx(ei,{className:"w-4 h-4 text-ios-rose"}),y.jsx("p",{className:"text-[11px] font-black text-ios-rose",children:q})]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{onClick:()=>t(),className:"flex-1 bg-gray-100 text-[#1C1C1E] py-4 rounded-[6px] font-black text-xs transition-all hover:bg-gray-200 ios-tap",children:""}),y.jsx("button",{onClick:()=>a(1),className:"flex-1 py-4 bg-gray-100 text-ios-gray rounded-[6px] font-black text-xs ios-tap",children:""}),y.jsxs("button",{disabled:m.length===0,onClick:j,className:"flex-[2] bg-[#1C1C1E] text-white py-4 rounded-[6px] font-black text-xs transition-all shadow-md disabled:opacity-20 ios-tap flex flex-col items-center justify-center leading-tight",children:[y.jsxs("span",{children:[m.length," "]}),y.jsx("span",{className:"opacity-60 text-[10px] mt-0.5",children:""})]})]})]}),o===3&&y.jsxs("div",{className:"space-y-8",children:[y.jsxs("div",{className:"text-center space-y-3",children:[y.jsx("div",{className:"w-12 h-12 rounded-[6px] bg-emerald-50 text-ios-emerald flex items-center justify-center mx-auto border border-emerald-100",children:y.jsx(En,{className:"w-6 h-6"})}),y.jsxs("div",{className:"space-y-1.5",children:[y.jsx("h3",{className:"text-2xl font-black tracking-tight text-[#1C1C1E]",children:" "}),y.jsx("p",{className:"text-xs text-ios-gray font-medium",children:"    ."})]})]}),y.jsx("div",{className:"space-y-1.5",children:[{label:" ",value:Ee(Et(c),"yyyy M d (EEEE)",{locale:Yt}),color:"text-[#1C1C1E]"},{label:" ",value:m.map(I=>K(I.name)).join(", "),color:"text-[#1C1C1E]"},{label:" ",value:e.zone_name,color:"text-[#1C1C1E]"},{label:" ",value:`${e.seat_number}`,color:"text-[#1C1C1E]"}].map((I,H)=>y.jsxs("div",{className:"flex justify-between items-center p-4 rounded-[6px] bg-gray-50 border border-gray-100",children:[y.jsx("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest leading-none",children:I.label}),y.jsx("span",{className:`text-sm font-black text-right max-w-[200px] ${I.color}`,children:I.value})]},H))}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{onClick:()=>t(),className:"flex-1 bg-gray-100 text-[#1C1C1E] py-5 rounded-[6px] font-black text-base transition-all hover:bg-gray-200 ios-tap",children:""}),y.jsxs("button",{disabled:U,onClick:R,className:"flex-[2] bg-[#1C1C1E] text-white py-5 rounded-[6px] font-black text-base transition-all shadow-lg shadow-black/20 flex items-center justify-center gap-3 ios-tap overflow-hidden relative group disabled:opacity-50",children:[U?" ...":" "," ",y.jsx(qr,{className:"w-5 h-5"})]})]})]})]})},E8=()=>{const[e,t]=le.useState([]),[r,n]=le.useState(!1),[i,s]=le.useState(""),[l,o]=le.useState("all"),[a,c]=le.useState(""),[d,f]=le.useState(null),[h,u]=le.useState("id-asc");le.useEffect(()=>{p()},[]);const p=async()=>{n(!0);const{data:w,error:_}=await we.from("applicant_pool").select("*").order("name",{ascending:!0});_?console.error("Error fetching applicants:",_):t(w||[]),n(!1)},m=()=>{const w=ms.json_to_sheet([{:"",:""}]);w["!cols"]=[{wch:15},{wch:15}];const _=ms.book_new();ms.book_append_sheet(_,w,""),t_(_,"__.xlsx")},g=async w=>{const _=w.target.files[0];if(!_)return;n(!0);const b=new FileReader;b.onload=async k=>{const S=k.target.result,O=Ed(S,{type:"binary"}),F=O.SheetNames[0],D=O.Sheets[F],M=ms.sheet_to_json(D).map(G=>({name:G.,student_id:String(G.).padStart(5,"0"),role:G.===""?"parent":G.===""?"teacher":G.===""?"admin":"student",status:"applied"})).filter(G=>G.name&&G.student_id),{error:q}=await we.from("applicant_pool").upsert(M,{onConflict:"name,student_id"});q?alert("  : "+q.message):(alert(`${M.length}   .`),p()),n(!1)},b.readAsBinaryString(_)},x=async(w,_,b="",k=w.role)=>{n(!0);const{error:S}=await we.from("applicant_pool").update({status:_,rejection_reason:b,role:k}).eq("id",w.id);S?alert("  : "+S.message):(p(),f(null),c("")),n(!1)},v=e.filter(w=>{const _=w.name.includes(i)||w.student_id.includes(i),b=l==="all"||w.status===l,k=h==="grade-1"?w.student_id.startsWith("1"):h==="grade-2"?w.student_id.startsWith("2"):h==="grade-3"?w.student_id.startsWith("3"):!0;return _&&b&&k}).sort((w,_)=>h==="name-asc"?w.name.localeCompare(_.name):h==="name-desc"?_.name.localeCompare(w.name):h==="id-asc"||h.startsWith("grade")?w.student_id.localeCompare(_.student_id):h==="id-desc"?_.student_id.localeCompare(w.student_id):0);return y.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 flex flex-col h-full overflow-hidden shadow-sm animate-spring-up",children:[y.jsxs("div",{className:"p-6 border-b border-gray-50 flex flex-col md:flex-row md:items-center justify-between gap-4 shrink-0",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center",children:y.jsx(Dl,{className:"w-5 h-5 text-ios-indigo"})}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-[14px] font-black text-[#1C1C1E]",children:"    "}),y.jsx("p",{className:"text-[10px] text-ios-gray font-black uppercase tracking-widest mt-0.5",children:"Applicant Pool Management"})]})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsxs("button",{onClick:m,className:"flex items-center gap-2 bg-white hover:bg-gray-50 text-[#1C1C1E] px-4 py-2.5 rounded-[6px] text-xs font-black transition-all border border-gray-200 ios-tap",children:[y.jsx(DS,{className:"w-4 h-4 text-ios-indigo"})," "]}),y.jsxs("label",{className:"flex items-center gap-2 bg-[#1C1C1E] hover:bg-[#2C2C2E] text-white px-4 py-2.5 rounded-[6px] text-xs font-black transition-all border border-transparent cursor-pointer ios-tap shadow-sm",children:[y.jsx(Ok,{className:"w-4 h-4 text-white"})," ",y.jsx("input",{type:"file",className:"hidden",accept:".xlsx,.xls",onChange:g})]})]})]}),y.jsxs("div",{className:"px-6 py-4 bg-gray-50/50 border-b border-gray-50 flex flex-col md:flex-row gap-4 shrink-0",children:[y.jsxs("div",{className:"flex-1 relative",children:[y.jsx(id,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray"}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("input",{type:"text",placeholder:"   ...",value:i,onChange:w=>s(w.target.value),className:"flex-1 bg-white border border-gray-200 rounded-[6px] pl-10 pr-4 py-2 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all"}),y.jsxs("select",{value:h,onChange:w=>u(w.target.value),className:"bg-white border border-gray-200 rounded-[6px] px-3 py-2 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all outline-none cursor-pointer min-w-[140px]",children:[y.jsx("option",{value:"id-asc",children:" ()"}),y.jsx("option",{value:"id-desc",children:" ()"}),y.jsx("option",{value:"name-asc",children:" ()"}),y.jsx("option",{value:"name-desc",children:" ()"}),y.jsx("option",{value:"grade-1",children:"1 ()"}),y.jsx("option",{value:"grade-2",children:"2 ()"}),y.jsx("option",{value:"grade-3",children:"3 ()"})]})]})]}),y.jsx("div",{className:"flex gap-2",children:["all","applied","pending","approved","rejected"].map(w=>y.jsx("button",{onClick:()=>o(w),className:`px-4 py-2 rounded-[6px] text-[10px] font-black uppercase tracking-widest transition-all ${l===w?"bg-[#1C1C1E] text-white shadow-md":"bg-white text-ios-gray border border-gray-200 hover:border-ios-indigo"}`,children:w==="all"?"":w==="applied"?"":w==="pending"?"":w==="approved"?"":""},w))})]}),y.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-hide",children:[y.jsxs("table",{className:"w-full text-left border-collapse",children:[y.jsx("thead",{className:"sticky top-0 bg-gray-50/90 backdrop-blur-sm z-10",children:y.jsxs("tr",{children:[y.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),y.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),y.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),y.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),y.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),y.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),y.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100 text-right",children:""})]})}),y.jsx("tbody",{children:v.map(w=>y.jsxs("tr",{className:"hover:bg-gray-50 transition-colors group",children:[y.jsx("td",{className:"px-6 py-4 text-xs font-mono font-black text-ios-indigo",children:w.student_id}),y.jsx("td",{className:"px-6 py-4 text-xs font-bold text-[#1C1C1E]",children:w.name}),y.jsx("td",{className:"px-6 py-4",children:y.jsx("span",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest",children:"Student"})}),y.jsx("td",{className:"px-6 py-4 text-xs font-medium text-ios-gray flex items-center gap-1.5",children:w.phone_number?y.jsxs(y.Fragment,{children:[y.jsx(nd,{className:"w-3 h-3 text-ios-emerald"}),w.phone_number]}):"-"}),y.jsx("td",{className:"px-6 py-4",children:w.pledge_accepted?y.jsxs("div",{className:"flex flex-col gap-0.5",children:[y.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-black text-ios-indigo",children:[y.jsx(NS,{className:"w-3 h-3"})," "]}),y.jsx("span",{className:"text-[9px] text-ios-gray opacity-50 font-mono",children:new Date(w.pledged_at).toLocaleDateString()})]}):y.jsx("span",{className:"text-[10px] font-black text-ios-gray opacity-30",children:""})}),y.jsx("td",{className:"px-6 py-4",children:w.status==="applied"?y.jsx("span",{className:"px-2 py-1 rounded-full text-[9px] font-black uppercase tracking-wider bg-gray-100 text-ios-gray",children:" "}):y.jsxs("select",{value:w.status,onChange:_=>x(w,_.target.value),className:`px-2 py-1 rounded-full text-[9px] font-black uppercase tracking-wider border-none focus:ring-1 transition-all cursor-pointer ${w.status==="approved"?"bg-ios-emerald/10 text-ios-emerald focus:ring-ios-emerald":w.status==="pending"?"bg-ios-amber/10 text-ios-amber focus:ring-ios-amber":w.status==="rejected"?"bg-ios-rose/10 text-ios-rose focus:ring-ios-rose":"bg-gray-100 text-ios-gray focus:ring-gray-300"}`,children:[y.jsx("option",{value:"pending",children:" "}),y.jsx("option",{value:"approved",children:""}),y.jsx("option",{value:"rejected",children:""}),y.jsx("option",{value:"applied",children:"  ()"})]})}),y.jsx("td",{className:"px-6 py-4 text-right",children:y.jsxs("div",{className:"flex items-center justify-end gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[w.status==="pending"&&y.jsxs(y.Fragment,{children:[y.jsx("button",{onClick:()=>x(w,"approved"),className:"p-1.5 rounded-[4px] bg-ios-emerald/10 text-ios-emerald hover:bg-[#1C1C1E] text-white transition-all ios-tap",title:"",children:y.jsx(En,{className:"w-3.5 h-3.5"})}),y.jsx("button",{onClick:()=>f(w),className:"p-1.5 rounded-[4px] bg-ios-rose/10 text-ios-rose hover:bg-[#1C1C1E] text-white transition-all ios-tap",title:"",children:y.jsx(Ta,{className:"w-3.5 h-3.5"})})]}),y.jsx("button",{className:"p-1.5 rounded-[4px] bg-gray-100 text-ios-gray hover:bg-gray-200 transition-all ios-tap",children:y.jsx(jS,{className:"w-3.5 h-3.5"})})]})})]},w.id))})]}),v.length===0&&y.jsxs("div",{className:"py-20 flex flex-col items-center justify-center text-ios-gray space-y-3",children:[y.jsx(ei,{className:"w-10 h-10 opacity-20"}),y.jsx("p",{className:"text-xs font-black",children:"  ."})]})]}),d&&y.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-50 flex items-center justify-center p-6",children:y.jsx("div",{className:"bg-white rounded-ios w-full max-w-sm shadow-2xl animate-spring-up overflow-hidden",children:y.jsxs("div",{className:"p-6 space-y-4",children:[y.jsxs("h4",{className:"text-[14px] font-black text-[#1C1C1E]",children:[d.name,"   "]}),y.jsx("textarea",{value:a,onChange:w=>c(w.target.value),placeholder:"  ... (:   )",className:"w-full h-32 bg-gray-50 border border-gray-200 rounded-[6px] p-3 text-xs font-bold focus:ring-1 focus:ring-ios-rose transition-all resize-none"}),y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsx("button",{onClick:()=>f(null),className:"w-full py-3 bg-gray-100 text-ios-gray rounded-[6px] text-xs font-black ios-tap",children:""}),y.jsx("button",{onClick:()=>x(d,"rejected",a),className:"w-full py-3 bg-[#1C1C1E] text-white rounded-[6px] text-xs font-black shadow-lg shadow-black/20 ios-tap",children:" "})]})]})})}),y.jsx("div",{className:"px-6 py-3 bg-gray-50/50 border-t border-gray-50 flex items-center justify-between shrink-0",children:y.jsxs("div",{className:"flex gap-6",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-ios-indigo"}),y.jsxs("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:[": ",e.length,""]})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-ios-amber"}),y.jsxs("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:[": ",e.filter(w=>w.status==="pending").length,""]})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-ios-emerald"}),y.jsxs("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:[": ",e.filter(w=>w.status==="approved").length,""]})]})]})})]})},N8=({onLoginSuccess:e})=>{const[t,r]=le.useState("student"),[n,i]=le.useState("login"),[s,l]=le.useState({name:"",studentId:"",phone:"",password:"",pledgeAccepted:!1,privacyAccepted:!1}),[o,a]=le.useState(!1),[c,d]=le.useState(""),[f,h]=le.useState(""),[u,p]=le.useState(null),[m,g]=le.useState(()=>localStorage.getItem("schoolName")||"GOE");le.useEffect(()=>{(async()=>{const{data:D}=await we.from("configs").select("value").eq("key","school_info").single();if(D&&D.value.name){const U=D.value.name.split(" ")[0];g(U),localStorage.setItem("schoolName",D.value.name)}})()},[]);const x=()=>d(""),v=F=>F.replace(/[^0-9]/g,"").replace(/^(\d{0,3})(\d{0,4})(\d{0,4})$/g,"$1-$2-$3").replace(/(-{1,2})$/g,""),w=F=>{r(F),i("login"),l({...s,name:"",studentId:"",phone:"",password:""}),x()},_=async F=>{F.preventDefault(),a(!0),d(""),t==="teacher"?await b():await k(),a(!1)},b=async()=>{const F=`${s.name}@goe.edu`,{data:D,error:U}=await we.auth.signInWithPassword({email:F,password:s.password});if(U){d("    .");return}const{data:M}=await we.from("profiles").select("*").eq("id",D.user.id).single();M?e({...M,full_name:M.full_name||s.name}):d("    .")},k=async()=>{const{data:F,error:D}=await we.from("applicant_pool").select("*").eq("name",s.name).eq("student_id",s.studentId).maybeSingle();if(D||!F){d("   /  .");return}if(p(F),t==="parent"&&(!F.phone_number||!F.pledge_accepted)){d("     .");return}F.status==="applied"?(l(U=>({...U,phone:"",pledgeAccepted:!1,privacyAccepted:!1})),i("pledge")):F.status==="pending"?i("pending"):F.status==="rejected"?(h(F.rejection_reason||"  ,   ."),i("rejected")):F.status==="approved"&&i("challenge")},S=async F=>{if(F.preventDefault(),!s.pledgeAccepted||!s.privacyAccepted){d("    .");return}if(s.phone.length<10){d("   .");return}a(!0);const{error:D}=await we.from("applicant_pool").update({phone_number:s.phone,pledge_accepted:!0,privacy_accepted:!0,pledged_at:new Date().toISOString(),status:"pending"}).eq("id",u.id);D?d("    ."):i("pending"),a(!1)},O=async F=>{F.preventDefault(),s.phone===u.phone_number?e({...u,full_name:u.name,role:t}):d("     .")};return y.jsx("div",{className:"min-h-screen bg-[#F2F2F7] flex items-center justify-center p-6 font-sans",children:y.jsxs("div",{className:"w-full max-w-md bg-white rounded-[2rem] shadow-2xl shadow-ios-indigo/10 overflow-hidden animate-spring-up border border-gray-100",children:[y.jsxs("div",{className:"bg-white p-10 text-[#1C1C1E] relative overflow-hidden border-b border-gray-100",children:[y.jsxs("div",{className:"relative z-10 space-y-2",children:[y.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gray-50 flex items-center justify-center mb-6 border border-gray-100 shadow-sm overflow-hidden",children:y.jsx(Ua,{className:"w-7 h-7 text-ios-indigo"})}),y.jsx("h1",{className:"text-3xl font-black tracking-tighter leading-none",children:m}),y.jsx("p",{className:"text-[10px] font-black tracking-[0.3em] uppercase text-ios-indigo",children:"Study Cafe System"})]}),y.jsx("div",{className:"absolute -right-10 -top-10 w-40 h-40 bg-ios-indigo/5 rounded-full blur-3xl"})]}),y.jsxs("div",{className:"p-8 space-y-8",children:[n==="login"&&y.jsx("div",{className:"flex bg-gray-50 p-1.5 rounded-2xl gap-1",children:[{id:"student",label:"",icon:LS},{id:"parent",label:"",icon:Dl},{id:"teacher",label:"",icon:gS}].map(F=>y.jsxs("button",{onClick:()=>w(F.id),className:`flex-1 flex items-center justify-center gap-2 py-3 rounded-xl text-xs font-black transition-all ${t===F.id?"bg-white text-ios-indigo shadow-md":"text-ios-gray hover:text-[#1C1C1E]"}`,children:[y.jsx(F.icon,{className:`w-3.5 h-3.5 ${t===F.id?"text-ios-indigo":"text-ios-gray"}`}),F.label]},F.id))}),n==="login"&&y.jsxs("form",{onSubmit:_,className:"space-y-6",children:[y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{className:"relative group",children:[y.jsx(sl,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),y.jsx("input",{required:!0,type:"text",placeholder:t==="teacher"?" (ID)":" (ID)",value:s.name,onChange:F=>l({...s,name:F.target.value}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none"})]}),y.jsxs("div",{className:"relative group",children:[y.jsx(qS,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),y.jsx("input",{required:!0,type:t==="teacher"?"password":"text",placeholder:t==="teacher"?" (PW)":" 5 (PW)",maxLength:t==="teacher"?void 0:5,value:t==="teacher"?s.password:s.studentId,onChange:F=>l(t==="teacher"?{...s,password:F.target.value}:{...s,studentId:F.target.value}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none"})]})]}),c&&y.jsxs("div",{className:"flex items-center gap-2 text-ios-rose bg-ios-rose/5 p-4 rounded-xl animate-shake",children:[y.jsx(ei,{className:"w-4 h-4 shrink-0"}),y.jsx("p",{className:"text-[11px] font-black",children:c})]}),y.jsx("button",{type:"submit",disabled:o,className:"w-full py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-sm flex items-center justify-center gap-2 hover:scale-[1.02] active:scale-[0.98] transition-all shadow-xl shadow-gray-200/50 ios-tap disabled:opacity-50",children:o?y.jsx(Uf,{className:"w-4 h-4 animate-spin"}):y.jsxs(y.Fragment,{children:[" ",y.jsx(fS,{className:"w-4 h-4"})]})})]}),n==="pledge"&&y.jsxs("form",{onSubmit:S,className:"space-y-6 animate-spring-up",children:[y.jsxs("div",{className:"space-y-2",children:[y.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight text-center",children:"  "}),y.jsx("p",{className:"text-[11px] text-ios-gray text-center font-bold",children:"      ."})]}),y.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 max-h-48 overflow-y-auto space-y-4 text-[11px] font-bold text-ios-gray leading-relaxed border border-gray-100",children:[y.jsxs("div",{className:"space-y-2",children:[y.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[    ]"}),y.jsx("p",{children:"1.          ."}),y.jsx("p",{children:"2.       ."}),y.jsx("p",{children:"3.       ."})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[  ]"}),y.jsx("p",{children:"     ,      ."}),y.jsx("p",{children:"         ."})]})]}),y.jsxs("div",{className:"space-y-3",children:[y.jsxs("div",{className:"relative group",children:[y.jsx(nd,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),y.jsx("input",{required:!0,type:"tel",autoComplete:"off",placeholder:"   ( )",value:s.phone,onChange:F=>l({...s,phone:v(F.target.value)}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none"})]}),y.jsxs("label",{className:"flex items-start gap-3 p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100 transition-all border border-transparent hover:border-gray-200",children:[y.jsx("input",{type:"checkbox",checked:s.pledgeAccepted,onChange:F=>l({...s,pledgeAccepted:F.target.checked}),className:"mt-0.5"}),y.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:"     . ()"})]}),y.jsxs("label",{className:"flex items-start gap-3 p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100 transition-all border border-transparent hover:border-gray-200",children:[y.jsx("input",{type:"checkbox",checked:s.privacyAccepted,onChange:F=>l({...s,privacyAccepted:F.target.checked}),className:"mt-0.5"}),y.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:"    . ()"})]})]}),c&&y.jsx("div",{className:"text-ios-rose text-[11px] font-black text-center",children:c}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{type:"button",onClick:()=>i("login"),className:"flex-1 py-4 bg-gray-100 text-ios-gray rounded-2xl font-black text-sm ios-tap",children:""}),y.jsx("button",{type:"submit",disabled:o,className:"flex-[2] py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-sm shadow-xl shadow-gray-200/50 ios-tap",children:o?y.jsx(Uf,{className:"w-4 h-4 animate-spin mx-auto"}):"   "})]})]}),n==="pending"&&y.jsxs("div",{className:"text-center space-y-6 py-4 animate-spring-up",children:[y.jsx("div",{className:"w-20 h-20 rounded-[2rem] bg-ios-amber/10 flex items-center justify-center mx-auto mb-2 border border-ios-amber/20 shadow-inner",children:y.jsx(Uf,{className:"w-10 h-10 text-ios-amber animate-spin"})}),y.jsxs("div",{className:"space-y-2",children:[y.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:"  "}),y.jsx("p",{className:"text-xs text-ios-gray font-medium leading-relaxed px-4",children:"   .      ."})]}),y.jsx("button",{onClick:()=>i("login"),className:"text-xs font-black text-ios-indigo uppercase tracking-widest",children:""})]}),n==="rejected"&&y.jsxs("div",{className:"text-center space-y-6 py-4 animate-spring-up",children:[y.jsx("div",{className:"w-20 h-20 rounded-[2rem] bg-ios-rose/10 flex items-center justify-center mx-auto mb-2 border border-ios-rose/20 shadow-inner",children:y.jsx(ei,{className:"w-10 h-10 text-ios-rose"})}),y.jsxs("div",{className:"space-y-2",children:[y.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:" "}),y.jsxs("div",{className:"bg-ios-rose/5 p-4 rounded-xl mt-4 max-w-[280px] mx-auto text-left",children:[y.jsx("p",{className:"text-[9px] font-black text-ios-rose/70 uppercase mb-1 tracking-widest",children:""}),y.jsx("p",{className:"text-[11px] font-bold text-ios-rose leading-relaxed",children:f})]})]}),y.jsx("button",{onClick:()=>i("login"),className:"w-full py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-xs shadow-xl shadow-gray-200/50 ios-tap uppercase tracking-widest",children:" "})]}),n==="challenge"&&y.jsxs("form",{onSubmit:O,className:"space-y-6 animate-spring-up",children:[y.jsxs("div",{className:"text-center space-y-4",children:[y.jsx("div",{className:"w-20 h-20 rounded-[2rem] bg-ios-emerald/10 flex items-center justify-center mx-auto border border-ios-emerald/20 shadow-inner",children:y.jsx(C0,{className:"w-10 h-10 text-ios-emerald"})}),y.jsxs("div",{className:"space-y-2",children:[y.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:t==="parent"?" ":" "}),y.jsx("p",{className:"text-[11px] text-ios-gray font-bold",children:t==="parent"?"   .":"   ."})]})]}),y.jsxs("div",{className:"relative group",children:[y.jsx(nd,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),y.jsx("input",{required:!0,type:"tel",placeholder:t==="parent"?"  ":"  ",value:s.phone,onChange:F=>l({...s,phone:v(F.target.value)}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none"})]}),c&&y.jsx("div",{className:"text-ios-rose text-[11px] font-black text-center animate-shake",children:c}),y.jsx("button",{type:"submit",className:"w-full py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-sm shadow-xl shadow-gray-200/50 ios-tap",children:t==="parent"?"  ":"  "})]})]})]})})},A8=({onLogout:e,currentUser:t})=>{const[r,n]=le.useState("home"),[i,s]=le.useState("GOE STUDY CAFE"),[l,o]=le.useState({bookings:[],attendance:[],currentSession:null,nextSession:null}),[a,c]=le.useState({}),[d,f]=le.useState(new Date),[h,u]=le.useState({present:0,late:0,absent:0,history:[]}),[p,m]=le.useState(!0),g=()=>f(S=>p_(S)),x=()=>f(S=>lf(S,1)),v=(S,O)=>{var J,T;if(!O||!O.bookings.length)return null;const F=new Date,D=Ee(F,"yyyy-MM-dd"),{bookings:U,attendance:M}=O;if(S>D)return{label:"",color:"text-ios-indigo bg-ios-indigo/10"};if(S<D)return M.length?M.some(B=>B.status==="late")?{label:"",color:"text-ios-amber bg-ios-amber/10"}:{label:"",color:"text-ios-emerald bg-ios-emerald/10"}:{label:"",color:"text-ios-rose bg-ios-rose/10"};const q=Ee(F,"HH:mm:ss"),G=[...U].sort((j,B)=>{var E,R;return(((E=j.sessions)==null?void 0:E.start_time)||"").localeCompare(((R=B.sessions)==null?void 0:R.start_time)||"")});if(!G.length)return null;const Q=(J=G[0].sessions)==null?void 0:J.start_time,K=(T=G[G.length-1].sessions)==null?void 0:T.end_time;if(K&&q>K)return{label:"",color:"text-gray-500 bg-gray-100"};if(Q&&q<Q)return{label:"",color:"text-ios-indigo bg-ios-indigo/10"};const ne=G.find(j=>{const B=j.sessions;return B&&q>=B.start_time&&q<=B.end_time});return ne?M.find(B=>B.booking_id===ne.id)?{label:"",color:"text-white bg-ios-emerald"}:{label:"",color:"text-ios-rose bg-ios-rose/10"}:{label:"",color:"text-ios-amber bg-ios-amber/10"}},w=()=>{const{bookings:S,attendance:O,currentSession:F}=l;if(S.length===0)return{label:"  ",color:"bg-gray-100 text-gray-400",sub:"   ."};const D=S.find(M=>M.session_id===(F==null?void 0:F.id)),U=O.length>0;if(D)return O.find(q=>q.booking_id===D.id)?{label:" ",color:"bg-ios-emerald text-white",sub:`${D.sessions.name}  `}:{label:"",color:"bg-ios-rose text-white",sub:"    ."};if(U){const M=[...O].sort((q,G)=>(G.timestamp_in||"").localeCompare(q.timestamp_in||""))[0];return M.timestamp_out?{label:" ",color:"bg-gray-800 text-white",sub:`${Ee(new Date(M.timestamp_out),"HH:mm")}  `}:{label:" ",color:"bg-ios-amber text-white",sub:"    ."}}return{label:" ",color:"bg-ios-indigo text-white",sub:"   ."}},_=()=>{var F,D;const{bookings:S}=l;if(S.length===0)return"-";const O=[...S].sort((U,M)=>{var q,G;return(((q=U.sessions)==null?void 0:q.end_time)||"").localeCompare(((G=M.sessions)==null?void 0:G.end_time)||"")}).pop();return((D=(F=O==null?void 0:O.sessions)==null?void 0:F.end_time)==null?void 0:D.substring(0,5))||"-"};le.useEffect(()=>{const S=async()=>{if(!t)return;const D=Ee(new Date,"yyyy-MM-dd"),{data:U}=await we.from("bookings").select("*, sessions (*), attendance (*)").eq("user_id",t.id).eq("date",D).order("session_id",{ascending:!0}),M=cr(d,{weekStartsOn:1}),q=ii(d,{weekStartsOn:1}),{data:G}=await we.from("bookings").select(`
          *,
          sessions (id, start_time, end_time),
          attendance (id, booking_id, status, timestamp_in, timestamp_out)
        `).eq("user_id",t.id).gte("date",Ee(M,"yyyy-MM-dd")).lte("date",Ee(q,"yyyy-MM-dd"));if(G){const K={};G.forEach(ne=>{const J=ne.date;K[J]||(K[J]={bookings:[],attendance:[]}),K[J].bookings.push(ne),ne.attendance&&ne.attendance.length>0&&K[J].attendance.push(...ne.attendance)}),c(K)}const{data:Q}=await we.from("sessions").select("*").order("start_time");if(Q){const ne=Ee(new Date,"HH:mm:ss"),J=Q.find(j=>ne>=j.start_time&&ne<=j.end_time),T=Q.find(j=>j.start_time>ne);o({bookings:U||[],attendance:(U==null?void 0:U.flatMap(j=>j.attendance))||[],currentSession:J,nextSession:T})}if(r==="stats"||p){const K=Ee(CI(new Date),"yyyy-MM-dd"),ne=Ee(NI(new Date),"yyyy-MM-dd"),{data:J}=await we.from("bookings").select("id, date, attendance (status, timestamp_in)").eq("user_id",t.id).gte("date",K).lte("date",ne);if(J){const T={present:0,late:0,absent:0},j=[];J.forEach(B=>{var R;const E=(R=B.attendance)==null?void 0:R[0];E&&(E.status==="present"?T.present++:E.status==="late"?T.late++:E.status==="absent"&&T.absent++,j.push({date:B.date,status:E.status,time:E.timestamp_in?Ee(new Date(E.timestamp_in),"HH:mm"):"-"}))}),u({...T,history:j.sort((B,E)=>E.date.localeCompare(B.date)).slice(0,15)})}}m(!1)},O=async()=>{var U;const{data:D}=await we.from("configs").select("value").eq("key","school_info").single();(U=D==null?void 0:D.value)!=null&&U.name&&s(D.value.name)};S(),O();const F=setInterval(S,6e4);return()=>clearInterval(F)},[t,d,r,p]);const b=()=>{var D,U;const S=w(),O=_(),F=(D=l.attendance.find(M=>M.timestamp_out))==null?void 0:D.timestamp_out;return y.jsxs("div",{className:"h-full p-4 flex flex-col gap-2 animate-fade-in relative scrollbar-hide",children:[y.jsxs("div",{className:"flex-[2] bg-white rounded-[2rem] pt-8 pb-5 px-5 shadow-sm border border-gray-100 flex flex-col items-center text-center relative overflow-hidden",children:[y.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-ios-indigo/5 blur-3xl -z-10"}),y.jsx("div",{className:`px-6 py-2 rounded-full text-[13px] font-black uppercase tracking-widest ${S.color} shadow-lg shadow-current/10`,children:S.label}),y.jsx("div",{className:"flex-1 flex flex-col items-center justify-center space-y-3",children:y.jsx("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:t==null?void 0:t.full_name})}),y.jsxs("div",{className:"w-full grid grid-cols-3 gap-2 pt-4 border-t border-gray-50",children:[y.jsxs("div",{className:"space-y-1",children:[y.jsx("p",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:" "}),y.jsx("p",{className:"text-xl font-black text-[#1C1C1E]",children:((U=l.bookings[0])==null?void 0:U.seat_number)||"-"})]}),y.jsxs("div",{className:"space-y-1 border-l border-gray-50",children:[y.jsx("p",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:" "}),y.jsx("p",{className:"text-xl font-black text-[#1C1C1E] underline decoration-ios-indigo/30 underline-offset-4",children:O})]}),y.jsxs("div",{className:"space-y-1 border-l border-gray-50",children:[y.jsx("p",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:" "}),y.jsx("p",{className:"text-xl font-black text-ios-indigo",children:F?Ee(new Date(F),"HH:mm"):"--:--"})]})]})]}),y.jsxs("div",{className:"flex-1 bg-white rounded-[1.5rem] p-4 border border-gray-100 shadow-sm flex flex-col justify-center space-y-2",children:[y.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[y.jsx("div",{className:"w-8 h-8 rounded-full bg-ios-blue/10 flex items-center justify-center",children:y.jsx($i,{className:"w-4 h-4 text-ios-blue"})}),y.jsx("h2",{className:"text-[15px] font-black text-[#1C1C1E]",children:"  "})]}),y.jsx("div",{className:"space-y-2 overflow-y-auto max-h-[120px] pr-1 scrollbar-hide",children:l.bookings.length>0?l.bookings.map((M,q)=>{var K,ne,J,T;const G=(K=M.attendance)==null?void 0:K[0],Q=G?G.status==="present"?{label:"",color:"text-ios-emerald bg-ios-emerald/10"}:G.status==="late"?{label:"",color:"text-ios-amber bg-ios-amber/10"}:{label:"",color:"text-ios-rose bg-ios-rose/10"}:{label:"",color:"text-gray-400 bg-gray-50"};return y.jsxs("div",{className:`flex items-center justify-between py-2 ${q!==l.bookings.length-1?"border-b border-gray-50":""}`,children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${(G==null?void 0:G.status)==="present"?"bg-ios-emerald":(G==null?void 0:G.status)==="late"?"bg-ios-amber":"bg-gray-200"}`}),y.jsxs("div",{children:[y.jsx("p",{className:"text-[11px] font-black text-[#1C1C1E] leading-none mb-1",children:(ne=M.sessions)==null?void 0:ne.name}),y.jsxs("p",{className:"text-[9px] font-bold text-ios-gray leading-none",children:[(J=M.sessions)==null?void 0:J.start_time.substring(0,5)," - ",(T=M.sessions)==null?void 0:T.end_time.substring(0,5)]})]})]}),y.jsx("span",{className:`text-[9px] font-black px-2 py-0.5 rounded-full ${Q.color}`,children:Q.label})]},M.id)}):y.jsx("div",{className:"flex flex-col items-center justify-center py-4 bg-gray-50 rounded-2xl",children:y.jsx("p",{className:"text-[10px] font-black text-ios-gray",children:"   ."})})})]}),y.jsxs("div",{className:"flex-1 bg-white rounded-[1.5rem] border border-gray-100 shadow-sm p-4 flex flex-col justify-center space-y-3",children:[y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"w-8 h-8 rounded-full bg-ios-indigo/10 flex items-center justify-center",children:y.jsx(Hi,{className:"w-4 h-4 text-ios-indigo"})}),y.jsx("h2",{className:"text-[15px] font-black text-[#1C1C1E]",children:"  "})]}),y.jsxs("div",{className:"flex items-center gap-1 bg-gray-50 rounded-full px-2 py-0.5",children:[y.jsx("button",{onClick:g,className:"p-1 hover:text-black text-gray-400",children:y.jsx(ci,{className:"w-3 h-3"})}),y.jsxs("span",{className:"text-[9px] font-bold text-[#1C1C1E] min-w-[70px] text-center",children:[Ee(cr(d,{weekStartsOn:1}),"M/dd")," - ",Ee(ii(d,{weekStartsOn:1}),"M/dd")]}),y.jsx("button",{onClick:x,className:"p-1 hover:text-black text-gray-400",children:y.jsx(qr,{className:"w-3 h-3"})})]})]}),y.jsx("div",{className:"flex justify-between items-center",children:$s({start:cr(d,{weekStartsOn:1}),end:ii(d,{weekStartsOn:1})}).map((M,q)=>{const G=Ee(M,"yyyy-MM-dd"),Q=a[G],K=v(G,Q),ne=Ui(M,new Date);return y.jsxs("div",{className:"flex flex-col items-center gap-1.5",children:[y.jsx("span",{className:`text-[8px] font-black ${ne?"text-[#1C1C1E]":"text-gray-300"}`,children:["","","","","","",""][q]}),y.jsx("div",{className:`w-7 h-7 rounded-full flex items-center justify-center text-[9px] font-black transition-all ${ne?"bg-[#1C1C1E] text-white shadow-md":"bg-white border border-gray-100 text-gray-300"}`,children:Ee(M,"d")}),y.jsx("div",{className:"h-3 flex items-center justify-center",children:K?y.jsx("span",{className:`text-[7px] font-bold px-1 py-0.5 rounded-full whitespace-nowrap ${K.color}`,children:K.label}):y.jsx("div",{className:"w-1 h-1 rounded-full bg-transparent"})})]},q)})})]})]})},k=()=>y.jsxs("div",{className:"p-5 space-y-6 animate-fade-in scrollbar-hide",children:[y.jsxs("div",{className:"bg-white rounded-[2rem] p-8 shadow-sm border border-gray-100 relative overflow-hidden",children:[y.jsxs("div",{className:"flex items-center gap-2 mb-6 text-ios-indigo",children:[y.jsx(Ag,{className:"w-4 h-4"}),y.jsx("h3",{className:"text-xs font-black uppercase tracking-widest",children:"   "})]}),y.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[y.jsxs("div",{className:"flex flex-col items-center p-4 bg-ios-emerald/5 rounded-2xl",children:[y.jsx("span",{className:"text-[10px] font-black text-ios-emerald uppercase opacity-60 mb-1",children:""}),y.jsx("span",{className:"text-2xl font-black text-ios-emerald",children:h.present})]}),y.jsxs("div",{className:"flex flex-col items-center p-4 bg-ios-amber/5 rounded-2xl",children:[y.jsx("span",{className:"text-[10px] font-black text-ios-amber uppercase opacity-60 mb-1",children:""}),y.jsx("span",{className:"text-2xl font-black text-ios-amber",children:h.late})]}),y.jsxs("div",{className:"flex flex-col items-center p-4 bg-ios-rose/5 rounded-2xl",children:[y.jsx("span",{className:"text-[10px] font-black text-ios-rose uppercase opacity-60 mb-1",children:""}),y.jsx("span",{className:"text-2xl font-black text-ios-rose",children:h.absent})]})]})]}),y.jsxs("div",{className:"space-y-3",children:[y.jsxs("div",{className:"flex items-center justify-between px-2",children:[y.jsx("h3",{className:"text-xs font-black text-[#1C1C1E] uppercase tracking-widest",children:"  "}),y.jsx("span",{className:"text-[10px] font-bold text-ios-gray",children:"TOP 15"})]}),y.jsx("div",{className:"space-y-2",children:h.history.length>0?h.history.map((S,O)=>y.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-gray-100 shadow-sm flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-4",children:[y.jsx("div",{className:`w-2 h-2 rounded-full ${S.status==="present"?"bg-ios-emerald":S.status==="late"?"bg-ios-amber":"bg-ios-rose"}`}),y.jsxs("div",{className:"space-y-0.5",children:[y.jsx("p",{className:"text-xs font-black text-[#1C1C1E]",children:Ee(new Date(S.date),"M d (EEE)",{locale:Yt})}),y.jsx("p",{className:"text-[10px] font-bold text-ios-gray uppercase tracking-widest",children:S.status==="present"?" ":S.status==="late"?"":""})]})]}),y.jsxs("div",{className:"text-right",children:[y.jsx("p",{className:"text-xs font-black text-ios-gray",children:S.time!=="-"?S.time:"--:--"}),y.jsx("p",{className:"text-[9px] font-bold text-ios-gray/40 uppercase tracking-tighter",children:"Entry Time"})]})]},O)):y.jsxs("div",{className:"py-20 text-center space-y-2",children:[y.jsx(Hi,{className:"w-10 h-10 text-gray-200 mx-auto"}),y.jsx("p",{className:"text-xs font-black text-ios-gray",children:"  ."})]})})]})]});return y.jsxs("div",{className:"mobile-container flex flex-col bg-[#F2F2F7] h-screen overflow-hidden font-sans pb-[safe-area-inset-bottom]",children:[y.jsxs("header",{className:"flex-none bg-white/80 backdrop-blur-md border-b border-gray-200/50 px-5 py-3 flex items-center justify-between z-50 sticky top-0 pt-[max(1rem,env(safe-area-inset-top))]",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"w-10 h-10 rounded-[10px] bg-[#1C1C1E] flex items-center justify-center shadow-sm",children:y.jsx(Ua,{className:"w-5 h-5 text-white"})}),y.jsxs("div",{children:[y.jsx("h1",{className:"text-[17px] font-black text-[#1C1C1E] tracking-tighter leading-tight uppercase",children:i.split(" ")[0]}),y.jsx("p",{className:"text-[9px] font-black tracking-[0.2em] text-ios-indigo uppercase opacity-80 leading-none mt-0.5",children:"PARENT VIEW"})]})]}),y.jsxs("div",{className:"flex items-center gap-4",children:[y.jsxs("div",{className:"text-right",children:[y.jsx("p",{className:"text-[13px] font-black text-[#1C1C1E]",children:t==null?void 0:t.full_name}),y.jsx("p",{className:"text-[10px] font-black text-ios-gray leading-none mt-0.5",children:Ee(new Date,"M d (EEE)",{locale:Yt})})]}),y.jsx("button",{onClick:e,className:"w-10 h-10 rounded-full bg-ios-rose/5 flex items-center justify-center text-ios-rose hover:bg-ios-rose/10 transition-colors",title:"",children:y.jsx(Pl,{className:"w-5 h-5"})})]})]}),y.jsx("main",{className:"flex-1 overflow-hidden relative",children:p?y.jsxs("div",{className:"h-full flex flex-col items-center justify-center space-y-4 animate-pulse",children:[y.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-[2rem]"}),y.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded-full"})]}):y.jsx("div",{className:"h-full overflow-y-auto scrollbar-hide",children:r==="home"?b():k()})}),y.jsx("nav",{className:"flex-none bg-white border-t border-gray-200/50 pb-[calc(1rem+env(safe-area-inset-bottom))] pt-3 px-16 flex justify-around items-center z-50 shadow-[0_-4px_20px_rgba(0,0,0,0.02)]",children:[{id:"home",icon:jv,label:""},{id:"stats",icon:Ag,label:""}].map(S=>y.jsxs("button",{onClick:()=>n(S.id),className:`flex flex-col items-center justify-center p-2 rounded-xl transition-all duration-300 w-20 group ${r===S.id?"text-[#1C1C1E]":"text-gray-300 hover:text-gray-500"}`,children:[y.jsx(S.icon,{className:`w-7 h-7 stroke-[2.5px] ${r===S.id?"fill-current":"fill-transparent"}`}),y.jsx("span",{className:"text-[9px] font-black mt-1",children:S.label})]},S.id))})]})},O8=()=>{const[e,t]=le.useState(new Date),[r,n]=le.useState([]),[i,s]=le.useState(null),[l,o]=le.useState([]),[a,c]=le.useState([]),[d,f]=le.useState([]),[h,u]=le.useState(!0),[p,m]=le.useState(!1),[g,x]=le.useState(!1),[v,w]=le.useState(!1),[_,b]=le.useState({date:Ee(new Date,"yyyy-MM-dd"),reason:"",is_closed:!0}),[k,S]=le.useState(new Date().getFullYear()),[O,F]=le.useState(new Date().getFullYear());le.useEffect(()=>{D()},[]);const D=async()=>{const{data:N}=await we.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});N&&N.length>0&&(n(N),s(N[0].id))};le.useEffect(()=>{i&&U(k,i)},[k,i]);const U=async(N,C)=>{u(!0);const[P,I,H]=await Promise.all([we.from("operation_quarters").select("*").eq("academic_year",N).order("quarter",{ascending:!0}),we.from("operation_defaults").select("*").eq("zone_id",C).order("day_of_week",{ascending:!0}),we.from("operation_exceptions").select("*").eq("zone_id",C).order("exception_date",{ascending:!0})]),L=P.data||[],ee=[1,2,3,4].map(V=>L.find(te=>te.quarter===V)||{quarter:V,start_date:null,end_date:null,academic_year:N}),A=L.filter(V=>V.quarter>4);o([...ee,...A].sort((V,W)=>V.quarter-W.quarter)),I.data&&I.data.length>0?c(I.data):c([0,1,2,3,4,5,6].map(V=>({zone_id:C,day_of_week:V,morning:!1,dinner:!1,period1:!1,period2:!1}))),H.data&&f(H.data),u(!1)},M=()=>{S(O)},q=(N,C,P)=>{const I=l.map(H=>H.quarter===N?{...H,[C]:P}:H);o(I)},G=async()=>{m(!0);const N=l.filter(P=>P.start_date||P.end_date).map(({id:P,quarter:I,start_date:H,end_date:L,quarter_name:z})=>({quarter:I,start_date:H||null,end_date:L||null,quarter_name:z||`${I}`,academic_year:k})),{error:C}=await we.from("operation_quarters").upsert(N,{onConflict:"academic_year, quarter"});C?alert("     : "+C.message):(alert("   ."),U(k)),m(!1)},Q=async N=>{const C=l.find(P=>P.quarter===N);if(C){if(C.start_date&&C.end_date){const{count:P,error:I}=await we.from("bookings").select("*",{count:"exact",head:!0}).gte("date",C.start_date).lte("date",C.end_date);if(I)console.error("Error checking bookings:",I);else if(P>0){if(!window.confirm(` (${C.start_date} ~ ${C.end_date})  ${P}  .    ?
(    ,    .)`))return}else if(!window.confirm(`${N}   ?`))return}else if(!window.confirm(`${N}  ?`))return;try{const{error:P}=await we.from("operation_quarters").delete().eq("academic_year",k).eq("quarter",N);if(P)throw P;N<=4?o(I=>I.map(H=>H.quarter===N?{...H,start_date:null,end_date:null,quarter_name:null}:H)):o(I=>I.filter(H=>H.quarter!==N)),alert(`${N}   .`)}catch(P){console.error("Error deleting quarter:",P),alert("   .")}}},K=()=>{const N=l.length>0?Math.max(...l.map(C=>C.quarter)):0;o([...l,{quarter:N+1,start_date:null,end_date:null,academic_year:k}])},ne=(N,C)=>{const P=a.map(I=>I.day_of_week===N?{...I,[C]:!I[C]}:I);c(P)},J=async()=>{x(!0);const{error:N}=await we.from("operation_defaults").upsert(a,{onConflict:"day_of_week"});N?alert("      ."):(alert("    ."),U(k)),x(!1)},T=async N=>{if(N.preventDefault(),!i)return;const{error:C}=await we.from("operation_exceptions").insert([{exception_date:_.date,reason:_.reason,is_closed:!0,zone_id:i}]);C||(b({..._,reason:""}),U(k,i))},j=async N=>{await we.from("operation_exceptions").delete().eq("id",N),U(k)},B=()=>y.jsxs("div",{className:"flex items-center justify-between mb-6 px-2",children:[y.jsxs("div",{className:"flex items-center gap-6",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:Ee(e,"yyyy MMMM",{locale:Yt})}),y.jsx("p",{className:"text-[10px] font-black text-ios-indigo uppercase tracking-widest mt-1",children:"Operating Calendar"})]}),y.jsx("div",{className:"flex bg-gray-100 p-1 rounded-xl border border-gray-200",children:r.map(N=>y.jsx("button",{onClick:()=>s(N.id),className:`px-4 py-1.5 rounded-lg text-xs font-black transition-all ios-tap ${i===N.id?"bg-white text-[#1C1C1E] shadow-sm":"text-ios-gray hover:text-[#1C1C1E]"}`,children:N.name},N.id))})]}),y.jsxs("div",{className:"flex gap-4 items-center",children:[y.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[y.jsxs("div",{className:"relative",children:[y.jsx("input",{type:"checkbox",className:"sr-only peer",checked:v,onChange:N=>w(N.target.checked)}),y.jsx("div",{className:"w-10 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-ios-indigo"})]}),y.jsx("span",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest peer-checked:text-[#1C1C1E] transition-colors",children:"/ "})]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{onClick:()=>t(cf(e)),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",children:y.jsx(ci,{className:"w-5 h-5 text-ios-gray"})}),y.jsx("button",{onClick:()=>t($l(e,1)),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",children:y.jsx(qr,{className:"w-5 h-5 text-ios-gray"})})]})]})]}),E=()=>{const N=["","","","","","",""],C=v?N:N.slice(1,6);return y.jsx("div",{className:`grid ${v?"grid-cols-7":"grid-cols-5"} mb-2 border-b border-gray-100`,children:C.map((P,I)=>{const H=v?I:I+1;return y.jsx("div",{className:`py-3 text-[10px] font-black uppercase text-center tracking-widest ${H===0?"text-ios-rose":H===6?"text-ios-indigo":"text-ios-gray"}`,children:P},H)})})},R=()=>{const N=$a(e),C=Tl(N),P=cr(N,{weekStartsOn:v?0:1}),I=ii(C,{weekStartsOn:v?0:1});let H=$s({start:P,end:I});return v||(H=H.filter(L=>L.getDay()!==0&&L.getDay()!==6)),y.jsx("div",{className:`grid ${v?"grid-cols-7":"grid-cols-5"} gap-px bg-gray-100 border border-gray-100 rounded-[12px] overflow-hidden shadow-sm`,children:H.map((L,z)=>{const ee=Ui(L,new Date),A=Nd(L,N),V=L.getDay(),W=Ee(L,"yyyy-MM-dd"),te=d.find(ue=>ue.exception_date===W),ae=l.find(ue=>ue.start_date&&ue.end_date&&El(L,{start:Et(ue.start_date),end:Et(ue.end_date)})),Y=a.find(ue=>ue.day_of_week===V),ce=ae&&!te&&((Y==null?void 0:Y.morning)||(Y==null?void 0:Y.dinner)||(Y==null?void 0:Y.period1)||(Y==null?void 0:Y.period2));return y.jsxs("div",{className:`min-h-[100px] p-2 flex flex-col gap-1 transition-colors border-b border-r border-gray-100 ${A?te?"bg-red-50/30":ce?"bg-[#f0f9ff]":"bg-white":"opacity-30 bg-gray-50"}`,children:[y.jsxs("div",{className:"flex justify-between items-start",children:[y.jsx("span",{className:`text-[11px] font-black ${ee?"w-6 h-6 text-ios-indigo border-2 border-ios-indigo rounded-full flex items-center justify-center -mt-1 -ml-1 bg-white":V===0?"text-ios-rose":V===6?"text-ios-indigo":"text-[#1C1C1E]"}`,children:Ee(L,"d")}),ae&&y.jsxs("span",{className:"text-[8px] font-black bg-white/50 text-ios-indigo px-1.5 py-0.5 rounded-full uppercase tracking-tighter border border-ios-indigo/10",children:["Q",ae.quarter]})]}),te?y.jsxs("div",{className:"mt-1 flex flex-col gap-1",children:[y.jsx("span",{className:"text-[10px] font-black text-red-600 uppercase tracking-widest",children:"CLOSED"}),y.jsx("span",{className:"text-[9px] font-bold text-ios-gray leading-tight",children:te.reason})]}):ce?y.jsx("div",{className:"mt-1 flex flex-col gap-0.5",children:[{label:"",key:"morning"},{label:"",key:"dinner"},{label:"1",key:"period1"},{label:"2",key:"period2"}].map(ue=>y.jsxs("div",{className:"flex justify-between items-center bg-white/40 rounded-[2px] px-1 py-0.5",children:[y.jsx("span",{className:"text-[8px] font-bold text-ios-gray",children:ue.label}),y.jsx("span",{className:`text-[8px] font-black uppercase tracking-wider ${Y[ue.key]?"text-ios-indigo":"text-red-600"}`,children:Y[ue.key]?"OPEN":"CLOSED"})]},ue.key))}):null]},z)})})};return h?y.jsx("div",{className:"h-full flex items-center justify-center",children:y.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-ios-indigo"})}):y.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 h-full overflow-hidden",children:[y.jsxs("div",{className:"flex-1 bg-white rounded-[6px] border border-gray-100 flex flex-col p-6 shadow-sm overflow-y-auto scrollbar-hide",children:[B(),E(),R()]}),y.jsxs("div",{className:"lg:w-96 flex flex-col gap-6 overflow-y-auto scrollbar-hide pb-6",children:[y.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 p-6 shadow-sm",children:[y.jsxs("div",{className:"flex items-center justify-between mb-6",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx($i,{className:"w-4 h-4 text-ios-indigo"}),y.jsx("h4",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"  "})]}),y.jsx("div",{className:"flex gap-2",children:y.jsxs("button",{onClick:G,disabled:p,className:"bg-[#1C1C1E] text-white px-5 py-2.5 rounded-[8px] text-[11px] font-black uppercase tracking-widest flex items-center gap-2 hover:bg-gray-800 shadow-md transition-all active:scale-95",children:[y.jsx(pu,{className:"w-3.5 h-3.5"})," "]})})]}),y.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-[8px] border border-gray-100",children:[y.jsx("label",{className:"block text-[10px] font-black text-ios-gray uppercase tracking-widest mb-2",children:" "}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("select",{value:O,onChange:N=>F(Number(N.target.value)),className:"flex-1 bg-white border border-gray-200 rounded-[6px] px-3 py-2 text-xs font-bold text-[#1C1C1E] focus:outline-none focus:ring-1 focus:ring-ios-indigo",children:[k-2,k-1,k,k+1,k+2].sort().map(N=>y.jsxs("option",{value:N,children:[N,""]},N))}),y.jsx("button",{onClick:M,className:"bg-[#1C1C1E] text-white px-3 py-2 rounded-[6px] text-[10px] font-black uppercase whitespace-nowrap hover:bg-gray-800 transition-colors",children:""})]})]}),y.jsxs("div",{className:"space-y-6",children:[l.map(N=>y.jsxs("div",{className:"space-y-2",children:[y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsxs("p",{className:"text-[11px] font-black text-ios-indigo",children:[N.quarter,""]}),(N.start_date||N.end_date||N.quarter>4)&&y.jsx("button",{onClick:()=>Q(N.quarter),className:"p-1 text-ios-gray hover:text-ios-rose transition-colors",title:" ",children:y.jsx(Li,{className:"w-3 h-3"})})]}),y.jsxs("span",{className:"text-[8px] font-bold text-ios-gray bg-gray-50 px-2 py-0.5 rounded-full uppercase tracking-widest",children:["Year ",k," - Q",N.quarter]})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[y.jsx("input",{type:"date",value:N.start_date||"",onChange:C=>q(N.quarter,"start_date",C.target.value),className:"bg-gray-50 border-none rounded-[6px] px-3 py-2 text-[11px] font-bold focus:ring-1 focus:ring-ios-indigo transition-all"}),y.jsx("input",{type:"date",value:N.end_date||"",onChange:C=>q(N.quarter,"end_date",C.target.value),className:"bg-gray-50 border-none rounded-[6px] px-3 py-2 text-[11px] font-bold focus:ring-1 focus:ring-ios-indigo transition-all"})]})]},N.quarter)),y.jsxs("button",{onClick:K,className:"w-full py-3 bg-gray-50 text-ios-gray border border-dashed border-gray-200 rounded-[6px] text-[10px] font-black uppercase tracking-wider flex items-center justify-center gap-1.5 hover:bg-gray-100 hover:text-[#1C1C1E] hover:border-gray-300 transition-all active:scale-95",children:[y.jsx(il,{className:"w-3.5 h-3.5"}),"  "]})]})]}),y.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 p-6 shadow-sm",children:[y.jsxs("div",{className:"flex items-center justify-between mb-6",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx($i,{className:"w-4 h-4 text-ios-indigo"}),y.jsx("h4",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"   "})]}),y.jsxs("button",{onClick:J,disabled:g,className:"bg-[#1C1C1E] text-white px-5 py-2.5 rounded-[8px] text-[11px] font-black uppercase tracking-widest flex items-center gap-2 hover:bg-gray-800 shadow-md transition-all active:scale-95",children:[y.jsx(pu,{className:"w-3.5 h-3.5"})," "]})]}),y.jsxs("div",{className:"space-y-1 overflow-x-auto",children:[y.jsxs("div",{className:"grid grid-cols-5 gap-2 pb-2 border-b border-gray-100 mb-2",children:[y.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest",children:""}),y.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest text-center",children:""}),y.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest text-center",children:""}),y.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest text-center",children:"1"}),y.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest text-center",children:"2"})]}),[1,2,3,4,5,6,0].map(N=>{const C=a.find(P=>P.day_of_week===N)||{day_of_week:N,morning:!1,dinner:!1,period1:!1,period2:!1};return y.jsxs("div",{className:"grid grid-cols-5 gap-2 items-center py-2 hover:bg-gray-50 rounded-[4px] transition-colors",children:[y.jsx("span",{className:`text-[10px] font-black ${N===0?"text-ios-rose":N===6?"text-ios-indigo":"text-[#1C1C1E]"}`,children:["","","","","","",""][N]}),["morning","dinner","period1","period2"].map(P=>y.jsx("div",{className:"flex justify-center",children:y.jsx("input",{type:"checkbox",checked:C[P],onChange:()=>ne(N,P),className:"w-4 h-4 rounded-full border-gray-200 text-ios-indigo focus:ring-ios-indigo/20 transition-all cursor-pointer"})},P))]},N)})]})]}),y.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 p-6 shadow-sm flex-1",children:[y.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[y.jsx(ei,{className:"w-4 h-4 text-ios-indigo"}),y.jsx("h4",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"()  "})]}),y.jsxs("form",{onSubmit:T,className:"space-y-4 mb-8",children:[y.jsxs("div",{className:"space-y-1",children:[y.jsx("p",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest px-1",children:" "}),y.jsx("input",{type:"date",value:_.date,onChange:N=>b({..._,date:N.target.value}),className:"w-full bg-gray-50 border-none rounded-[6px] px-3 py-3 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all outline-none"})]}),y.jsxs("div",{className:"space-y-1",children:[y.jsx("p",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest px-1",children:" "}),y.jsx("input",{type:"text",placeholder:": ,   ",value:_.reason,onChange:N=>b({..._,reason:N.target.value}),className:"w-full bg-gray-50 border-none rounded-[6px] px-3 py-3 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all outline-none"})]}),y.jsxs("button",{type:"submit",disabled:!_.reason,className:"w-full py-3 bg-[#1C1C1E] text-white rounded-[6px] font-black text-[11px] uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-gray-800 transition-all disabled:opacity-30 disabled:hover:bg-[#1C1C1E]",children:[y.jsx(il,{className:"w-3 h-3"})," "]})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx("p",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest px-1 border-b border-gray-50 pb-2 mb-4",children:"  "}),y.jsxs("div",{className:"space-y-3 max-h-60 overflow-y-auto pr-2 scrollbar-hide",children:[d.length===0&&y.jsx("p",{className:"text-[10px] text-ios-gray italic text-center py-4",children:"  ."}),d.map(N=>y.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-[6px] hover:bg-ios-rose/5 transition-all group border border-transparent hover:border-ios-rose/10",children:[y.jsxs("div",{className:"flex-1",children:[y.jsx("p",{className:"text-[11px] font-black text-[#1C1C1E]",children:N.exception_date}),y.jsx("p",{className:"text-[9px] font-bold text-ios-gray truncate",children:N.reason})]}),y.jsx("button",{onClick:()=>j(N.id),className:"p-1.5 text-ios-gray hover:text-ios-rose transition-colors opacity-0 group-hover:opacity-100",children:y.jsx(Li,{className:"w-3.5 h-3.5"})})]},N.id))]})]})]})]})]})},F8=()=>{var q,G,Q;const[e,t]=le.useState(!0),[r,n]=le.useState(!1),[i,s]=le.useState(null),[l,o]=le.useState(!1),[a,c]=le.useState("GOE STUDY CAFE"),[d,f]=le.useState(""),[h,u]=le.useState([]),[p,m]=le.useState(null),[g,x]=le.useState([]),[v,w]=le.useState({points:[{lat:37.5665,lng:126.978,name:" "}],radius:100});le.useEffect(()=>{_()},[]),le.useEffect(()=>{p&&b(p)},[p]);const _=async()=>{t(!0);try{const{data:K}=await we.from("configs").select("*").eq("key","school_info").single();K&&(c(K.value.name||"POGOK STUDY CAFE"),f(K.value.address||""));const{data:ne,error:J}=await we.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});if(J)throw J;u(ne||[]),ne&&ne.length>0&&m(ne[0].id)}catch(K){console.error("Error fetching initial data:",K),s("    .")}finally{t(!1)}},b=async K=>{try{const{data:ne,error:J}=await we.from("sessions").select("*").eq("zone_id",K).order("start_time",{ascending:!0});if(J)throw J;x(ne||[]);const T=h.find(j=>j.id===K);T!=null&&T.settings&&(T.settings.points?w(T.settings):T.settings.latitude?w({points:[{lat:T.settings.latitude,lng:T.settings.longitude,name:" "}],radius:T.settings.radius||100}):w({points:[{lat:37.5665,lng:126.978,name:" "}],radius:100}))}catch(ne){console.error("Error fetching zone data:",ne),s("     .")}},k=async()=>{const K=prompt("     (: 2):");if(!K)return;n(!0);const{data:ne,error:J}=await we.from("zones").insert([{name:K,settings:{points:[{lat:37.5665,lng:126.978,name:" "}],radius:100}}]).select().single();J?alert("  : "+J.message):(u([...h,ne]),m(ne.id)),n(!1)},S=async(K,ne)=>{const J=prompt("   :",ne);if(!J||J===ne)return;n(!0);const{error:T}=await we.from("zones").update({name:J}).eq("id",K);T?alert("  : "+T.message):u(h.map(j=>j.id===K?{...j,name:J}:j)),n(!1)},O=async K=>{if(!confirm("   ?        ."))return;n(!0);const{error:ne}=await we.from("zones").delete().eq("id",K);if(ne)alert("  : "+ne.message);else{const J=h.filter(T=>T.id!==K);u(J),J.length>0&&m(J[0].id)}n(!1)},F=async()=>{if(!p)return;const K=prompt("   (: 3):");if(!K)return;const{data:ne,error:J}=await we.from("sessions").insert([{zone_id:p,name:K,start_time:"09:00:00",end_time:"12:00:00"}]).select().single();J?alert("  "):x([...g,ne])},D=async K=>{if(!confirm(" ?"))return;const{error:ne}=await we.from("sessions").delete().eq("id",K);ne?alert(" "):x(g.filter(J=>J.id!==K))},U=(K,ne,J)=>{x(g.map(T=>T.id===K?{...T,[ne]:J}:T))},M=async()=>{n(!0),s(null),o(!1);try{if(await we.from("configs").upsert({key:"school_info",value:{name:a,address:d}}),p&&await we.from("zones").update({settings:v}).eq("id",p),g.length>0){const{error:K}=await we.from("sessions").upsert(g.map(ne=>({id:ne.id,zone_id:p,name:ne.name,start_time:ne.start_time,end_time:ne.end_time})));if(K)throw K}o(!0),setTimeout(()=>o(!1),3e3)}catch(K){s("   : "+K.message)}finally{n(!1)}};return e?y.jsxs("div",{className:"h-full flex flex-col items-center justify-center bg-white rounded-t-[6px]",children:[y.jsx("div",{className:"w-10 h-10 border-4 border-ios-indigo/20 border-t-ios-indigo rounded-full animate-spin mb-4"}),y.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"   ..."})]}):y.jsxs("div",{className:"bg-white rounded-t-[6px] h-full flex flex-col overflow-hidden animate-spring-up",children:[y.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide p-8 pb-32",children:y.jsxs("div",{className:"max-w-4xl mx-auto space-y-12",children:[y.jsxs("div",{className:"flex items-center justify-between bg-gray-50/50 p-6 rounded-2xl border border-gray-100",children:[y.jsxs("div",{className:"flex items-center gap-4",children:[y.jsx("div",{className:"w-12 h-12 rounded-xl bg-[#1C1C1E] flex items-center justify-center shadow-lg",children:y.jsx(sd,{className:"w-6 h-6 text-white"})}),y.jsxs("div",{children:[y.jsx("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:"  "}),y.jsx("p",{className:"text-sm text-ios-gray font-bold",children:"       ."})]})]}),i&&y.jsxs("div",{className:"flex items-center gap-2 bg-ios-rose/10 px-4 py-2 rounded-lg border border-ios-rose/20 text-ios-rose font-bold text-xs animate-shake",children:[y.jsx(ei,{className:"w-4 h-4"})," ",i]})]}),y.jsxs("section",{className:"space-y-6",children:[y.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[y.jsx(wk,{className:"w-5 h-5 text-ios-indigo"}),y.jsx("h3",{className:"text-lg font-black text-[#1C1C1E]",children:"  "})]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest ml-1",children:" "}),y.jsx("input",{type:"text",value:a,onChange:K=>c(K.target.value),className:"w-full bg-gray-50 border border-transparent focus:bg-white focus:border-ios-indigo/20 rounded-xl px-5 py-4 text-base font-bold text-[#1C1C1E] transition-all outline-none"})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest ml-1",children:" "}),y.jsx("input",{type:"text",value:d,onChange:K=>f(K.target.value),className:"w-full bg-gray-50 border border-transparent focus:bg-white focus:border-ios-indigo/20 rounded-xl px-5 py-4 text-base font-bold text-[#1C1C1E] transition-all outline-none",placeholder:"     "})]})]})]}),y.jsx("hr",{className:"border-gray-100"}),y.jsxs("section",{className:"space-y-6",children:[y.jsxs("div",{className:"flex items-center justify-between mb-2",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx(Ua,{className:"w-5 h-5 text-ios-amber"}),y.jsx("h3",{className:"text-lg font-black text-[#1C1C1E]",children:" (Zone) "})]}),y.jsxs("button",{onClick:k,className:"flex items-center gap-2 px-4 py-2 bg-[#1C1C1E] text-white rounded-lg text-xs font-bold shadow-lg hover:shadow-xl transition-all ios-tap",children:[y.jsx(il,{className:"w-4 h-4"}),"  "]})]}),y.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:h.map(K=>y.jsx("div",{onClick:()=>m(K.id),className:`relative p-5 rounded-2xl border-2 transition-all cursor-pointer group ${p===K.id?"bg-ios-indigo/5 border-ios-indigo shadow-md":"bg-white border-gray-100 hover:border-gray-200"}`,children:y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsxs("div",{className:"flex items-start justify-between",children:[y.jsxs("span",{className:`text-[10px] font-black uppercase tracking-widest ${p===K.id?"text-ios-indigo":"text-ios-gray"}`,children:["ZONE #",K.id]}),y.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[y.jsx("button",{onClick:ne=>{ne.stopPropagation(),S(K.id,K.name)},className:"p-1.5 hover:bg-white rounded-md text-ios-gray hover:text-[#1C1C1E] shadow-sm",children:y.jsx(Ck,{className:"w-3 h-3"})}),y.jsx("button",{onClick:ne=>{ne.stopPropagation(),O(K.id)},className:"p-1.5 hover:bg-white rounded-md text-ios-gray hover:text-ios-rose shadow-sm",children:y.jsx(Li,{className:"w-3 h-3"})})]})]}),y.jsx("h4",{className:"text-lg font-black text-[#1C1C1E]",children:K.name}),y.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[y.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${p===K.id?"bg-ios-indigo animate-pulse":"bg-gray-300"}`}),y.jsx("span",{className:"text-[11px] font-bold text-ios-gray",children:p===K.id?" ":" "})]})]})},K.id))})]}),p&&y.jsxs(y.Fragment,{children:[y.jsx("hr",{className:"border-gray-100"}),y.jsxs("section",{className:"space-y-6 animate-fade-in",children:[y.jsxs("div",{className:"flex items-center justify-between mb-2",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx($i,{className:"w-5 h-5 text-ios-emerald"}),y.jsxs("h3",{className:"text-lg font-black text-[#1C1C1E]",children:["[",(q=h.find(K=>K.id===p))==null?void 0:q.name,"]   "]})]}),y.jsxs("button",{onClick:F,className:"flex items-center gap-2 px-4 py-2 bg-[#1C1C1E] text-white rounded-lg text-xs font-bold shadow-lg hover:shadow-xl transition-all ios-tap",children:[y.jsx(TS,{className:"w-4 h-4"}),"  "]})]}),y.jsx("div",{className:"grid grid-cols-1 gap-3",children:g.length===0?y.jsx("div",{className:"p-12 text-center bg-gray-50 border border-dashed border-gray-200 rounded-2xl",children:y.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"  . ' ' ."})}):g.map((K,ne)=>y.jsxs("div",{className:"group flex items-center justify-between bg-white border border-gray-100 p-5 rounded-2xl hover:shadow-md transition-all",children:[y.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[y.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-50 flex items-center justify-center text-[11px] font-black text-ios-gray border border-gray-100",children:ne+1}),y.jsxs("div",{className:"w-40",children:[y.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest mb-1 block",children:" "}),y.jsx("input",{type:"text",value:K.name,onChange:J=>U(K.id,"name",J.target.value),className:"text-sm font-black text-[#1C1C1E] bg-transparent border-none p-0 focus:ring-0 w-full"})]}),y.jsxs("div",{className:"flex items-center gap-8",children:[y.jsxs("div",{children:[y.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest mb-1 block",children:""}),y.jsx("input",{type:"time",value:K.start_time,onChange:J=>U(K.id,"start_time",J.target.value),className:"text-sm font-black text-[#1C1C1E] border-none p-0 bg-transparent focus:ring-0 w-32 pr-2"})]}),y.jsx(qr,{className:"w-4 h-4 text-gray-200 mt-4"}),y.jsxs("div",{children:[y.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest mb-1 block",children:""}),y.jsx("input",{type:"time",value:K.end_time,onChange:J=>U(K.id,"end_time",J.target.value),className:"text-sm font-black text-[#1C1C1E] border-none p-0 bg-transparent focus:ring-0 w-32 pr-2"})]})]})]}),y.jsx("button",{onClick:()=>D(K.id),className:"p-2.5 text-ios-gray hover:text-ios-rose hover:bg-ios-rose/5 rounded-xl transition-all opacity-0 group-hover:opacity-100",children:y.jsx(Li,{className:"w-4 h-4"})})]},K.id))})]}),y.jsx("hr",{className:"border-gray-100"}),y.jsxs("section",{className:"space-y-6 animate-fade-in",children:[y.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[y.jsx(rk,{className:"w-5 h-5 text-ios-rose"}),y.jsx("h3",{className:"text-lg font-black text-[#1C1C1E]",children:"    "})]}),y.jsxs("div",{className:"bg-gray-50/50 p-6 rounded-2xl border border-gray-100 space-y-8",children:[y.jsxs("div",{className:"flex items-start gap-3 p-4 bg-ios-amber/5 border border-ios-amber/10 rounded-xl",children:[y.jsx(Pv,{className:"w-4 h-4 text-ios-amber mt-0.5"}),y.jsxs("p",{className:"text-xs text-ios-amber font-bold leading-relaxed",children:["     GPS     .",y.jsx("br",{}),"         ."]})]}),y.jsxs("div",{className:"space-y-4",children:[y.jsx("div",{className:"flex items-center justify-between",children:y.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest flex items-center gap-1.5 ml-1",children:"  "})}),y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx(dk,{className:"w-5 h-5 text-ios-indigo"}),y.jsx("div",{className:"flex-1",children:y.jsx("input",{type:"number",value:v.radius||100,onChange:K=>w({...v,radius:parseInt(K.target.value)}),className:"w-full bg-white border border-gray-100 rounded-xl px-4 py-3 text-sm font-bold text-[#1C1C1E] outline-none focus:ring-1 focus:ring-ios-indigo transition-all",placeholder:"  (m)"})}),y.jsx("span",{className:"text-xs font-bold text-ios-gray",children:"(m)"})]})]}),y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest flex items-center gap-1.5 ml-1",children:["   (",((G=v.points)==null?void 0:G.length)||0,")"]}),(!v.points||v.points.length<3)&&y.jsx("button",{onClick:()=>{const K=[...v.points||[]];K.push({lat:37.5665,lng:126.978,name:` ${K.length+1}`}),w({...v,points:K})},className:"text-[10px] font-bold text-ios-indigo hover:bg-ios-indigo/10 px-2 py-1 rounded transition-colors",children:"+  "})]}),y.jsx("div",{className:"space-y-3",children:(Q=v.points)==null?void 0:Q.map((K,ne)=>y.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm relative group",children:[y.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[y.jsx(As,{className:"w-4 h-4 text-ios-rose"}),y.jsx("input",{type:"text",value:K.name||` ${ne+1}`,onChange:J=>{const T=[...v.points];T[ne].name=J.target.value,w({...v,points:T})},className:"text-sm font-black text-[#1C1C1E] border-none p-0 focus:ring-0 w-32 bg-transparent",placeholder:" "}),v.points.length>1&&y.jsx("button",{onClick:()=>{const J=v.points.filter((T,j)=>j!==ne);w({...v,points:J})},className:"ml-auto p-1.5 text-gray-300 hover:text-ios-rose hover:bg-red-50 rounded-lg transition-colors",children:y.jsx(Li,{className:"w-3.5 h-3.5"})})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsxs("div",{children:[y.jsx("label",{className:"text-[9px] text-gray-400 font-bold mb-1 block",children:" (Latitude)"}),y.jsx("input",{type:"number",step:"0.000001",value:K.lat,onChange:J=>{const T=[...v.points];T[ne].lat=parseFloat(J.target.value),w({...v,points:T})},className:"w-full bg-gray-50/50 border border-gray-100 rounded-lg px-3 py-2 text-xs font-bold font-mono text-[#1C1C1E] focus:bg-white focus:border-ios-indigo transition-all"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"text-[9px] text-gray-400 font-bold mb-1 block",children:" (Longitude)"}),y.jsx("input",{type:"number",step:"0.000001",value:K.lng,onChange:J=>{const T=[...v.points];T[ne].lng=parseFloat(J.target.value),w({...v,points:T})},className:"w-full bg-gray-50/50 border border-gray-100 rounded-lg px-3 py-2 text-xs font-bold font-mono text-[#1C1C1E] focus:bg-white focus:border-ios-indigo transition-all"})]})]})]},ne))})]})]})]})]})]})}),y.jsx("div",{className:"flex-none p-6 border-t border-gray-100 bg-white/80 backdrop-blur-xl z-20",children:y.jsxs("div",{className:"max-w-4xl mx-auto flex items-center gap-4",children:[y.jsx("button",{onClick:M,disabled:r,className:`flex-1 py-5 rounded-2xl font-black text-base flex items-center justify-center gap-3 transition-all ios-tap shadow-lg ${l?"bg-[#1C1C1E] text-white":"bg-[#1C1C1E] text-white hover:bg-gray-800"}`,children:r?y.jsx("div",{className:"w-5 h-5 border-2 border-white/20 border-t-white rounded-full animate-spin"}):l?y.jsxs(y.Fragment,{children:[y.jsx(ys,{className:"w-5 h-5"}),"    "]}):y.jsxs(y.Fragment,{children:[y.jsx(pu,{className:"w-5 h-5"}),"    "]})}),l&&y.jsxs("div",{className:"bg-ios-emerald/10 text-ios-emerald px-6 py-5 rounded-2xl font-black text-sm animate-fade-in flex items-center gap-2",children:[y.jsx(En,{className:"w-4 h-4"})," !"]})]})})]})},j8=()=>{const[e,t]=le.useState(!0),[r,n]=le.useState([]),[i,s]=le.useState(null),[l,o]=le.useState([]),[a,c]=le.useState([]),[d,f]=le.useState([]),[h,u]=le.useState([]),[p,m]=le.useState([1,2,3]),[g,x]=le.useState(!1),[v,w]=le.useState([]);le.useEffect(()=>{_()},[]);const _=async()=>{t(!0);const{data:D}=await we.from("operation_quarters").select("*").order("academic_year",{ascending:!0}).order("quarter",{ascending:!0});if(D&&D.length>0){n(D);const M=Ee(new Date,"yyyy-MM-dd");let q=D.find(G=>M>=G.start_date&&M<=G.end_date);if(!q){const G=new Date;q=D.reduce((Q,K)=>{const ne=Math.abs(new Date(Q.start_date)-G);return Math.abs(new Date(K.start_date)-G)<ne?K:Q})}q&&b(q)}const{data:U}=await we.from("zones").select("id").limit(1);if(U&&U.length>0){const{data:M}=await we.from("sessions").select("*").eq("zone_id",U[0].id).order("start_time",{ascending:!0});if(M){f(M);const q=M.filter(G=>G.name.includes("")||G.name.includes("")).map(G=>G.id);u(q)}}t(!1)},b=D=>{s(D);const U=new Date(D.start_date),M=new Date(D.end_date),G=TI({start:U,end:M},{weekStartsOn:1}).map((Q,K)=>{let ne=ii(Q,{weekStartsOn:1});const J=Q<U?U:Q,T=ne>M?M:ne;return{id:K+1,start:J,end:T,label:`${K+1} (${Ee(J,"MM/dd(eee)",{locale:Yt})} - ${Ee(T,"MM/dd(eee)",{locale:Yt})})`}});o(G),c(G.map(Q=>Q.id))},k=D=>{c(U=>U.includes(D)?U.filter(M=>M!==D):[...U,D])},S=D=>{m(U=>U.includes(D)?U.filter(M=>M!==D):[...U,D])},O=D=>{u(U=>U.includes(D)?U.filter(M=>M!==D):[...U,D])},F=async()=>{if(a.length===0||p.length===0||h.length===0){alert(" , ,    .");return}x(!0);try{const{data:D}=await we.from("profiles").select("*").in("grade",p).eq("role","student").order("grade",{ascending:!0}).order("class_number",{ascending:!0}).order("student_number",{ascending:!0});if(!D||D.length===0){alert("   ."),x(!1);return}const U=[];for(const M of a){const q=l.find(j=>j.id===M),G=Ee(q.start,"yyyy-MM-dd"),Q=Ee(q.end,"yyyy-MM-dd"),{data:K}=await we.from("bookings").select(`
                        *,
                        attendance(*)
                    `).gte("date",G).lte("date",Q).in("session_id",h),ne=$s({start:q.start,end:q.end}),J=new Set((K||[]).map(j=>j.date)),T=ne.filter(j=>{const B=[0,6].includes(j.getDay()),E=Ee(j,"yyyy-MM-dd");return!B||J.has(E)});for(const j of p.sort()){const B=D.filter(N=>N.grade===j);if(B.length===0)continue;const E=B.map(N=>N.id),R=(K||[]).filter(N=>E.includes(N.user_id));U.push({weekInfo:q,grade:j,students:B,bookings:R,businessDays:T,sessions:d.filter(N=>h.includes(N.id))})}}w(U),setTimeout(()=>{window.print(),x(!1)},1e3)}catch(D){console.error("Print error:",D),alert("     ."),x(!1)}};return e?y.jsxs("div",{className:"h-full flex flex-col items-center justify-center gap-4 bg-white/50 backdrop-blur-sm",children:[y.jsx("div",{className:"w-10 h-10 border-4 border-ios-indigo border-t-transparent rounded-full animate-spin"}),y.jsx("p",{className:"text-[13px] font-black text-ios-gray animate-pulse",children:"   ..."})]}):y.jsxs("div",{className:"h-full flex flex-col bg-[#F2F2F7]",children:[y.jsx("div",{className:"flex-1 overflow-y-auto p-8 pt-6 hide-on-print",children:y.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-4",children:[y.jsx("div",{className:"w-12 h-12 rounded-2xl bg-[#1C1C1E] flex items-center justify-center shadow-lg shadow-black/10",children:y.jsx(du,{className:"w-6 h-6 text-white"})}),y.jsxs("div",{children:[y.jsx("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:"  "}),y.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"     PDF  ."})]})]}),y.jsx("button",{onClick:F,disabled:g,className:"bg-ios-indigo text-white px-8 py-4 rounded-2xl font-black text-[15px] shadow-lg shadow-ios-indigo/20 hover:scale-[1.02] active:scale-95 transition-all flex items-center gap-3 disabled:opacity-50",children:g?y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"  "]}):y.jsxs(y.Fragment,{children:[y.jsx(Fv,{className:"w-5 h-5"}),"PDF   "]})})]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[y.jsxs("div",{className:"bg-white rounded-[24px] p-6 shadow-sm border border-gray-100 flex flex-col",children:[y.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[y.jsx(Hi,{className:"w-4 h-4 text-ios-indigo"}),y.jsx("h3",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:" "})]}),y.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto pr-2 custom-scrollbar",children:r.map(D=>y.jsxs("button",{onClick:()=>b(D),className:`w-full text-left p-4 rounded-xl border-2 transition-all flex items-center justify-between group ${(i==null?void 0:i.id)===D.id?"bg-ios-indigo/5 border-ios-indigo text-ios-indigo":"bg-white border-gray-50 text-ios-gray hover:border-gray-200"}`,children:[y.jsxs("div",{children:[y.jsxs("p",{className:"text-[13px] font-black",children:[D.quarter_name," (",D.academic_year,")"]}),y.jsxs("p",{className:"text-[11px] opacity-70 mt-0.5",children:[Ee(new Date(D.start_date),"yyyy-MM-dd(eee)",{locale:Yt})," ~ ",Ee(new Date(D.end_date),"yyyy-MM-dd(eee)",{locale:Yt})]})]}),(i==null?void 0:i.id)===D.id&&y.jsx(ys,{className:"w-5 h-5"})]},D.id))})]}),y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"bg-white rounded-[24px] p-6 shadow-sm border border-gray-100",children:[y.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[y.jsx(Dl,{className:"w-4 h-4 text-ios-indigo"}),y.jsx("h3",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:" "})]}),y.jsx("div",{className:"flex gap-3",children:[1,2,3].map(D=>y.jsxs("button",{onClick:()=>S(D),className:`flex-1 py-3 px-4 rounded-xl font-black text-[13px] transition-all border-2 flex items-center justify-between gap-2 ${p.includes(D)?"bg-ios-indigo text-white border-ios-indigo shadow-md shadow-ios-indigo/20":"bg-white text-ios-gray border-gray-100"}`,children:[y.jsxs("span",{className:"flex-1 text-center",children:[D,""]}),p.includes(D)&&y.jsx(En,{className:"w-4 h-4",strokeWidth:3})]},D))})]}),y.jsxs("div",{className:"bg-white rounded-[24px] p-6 shadow-sm border border-gray-100",children:[y.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[y.jsx($i,{className:"w-4 h-4 text-ios-indigo"}),y.jsx("h3",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:" "})]}),y.jsx("div",{className:"grid grid-cols-2 gap-3",children:d.map(D=>y.jsxs("button",{onClick:()=>O(D.id),className:`py-3 px-4 rounded-xl font-black text-[12px] transition-all border-2 flex items-center justify-between ${h.includes(D.id)?"bg-ios-indigo/5 border-ios-indigo text-ios-indigo":"bg-white text-ios-gray border-gray-100"}`,children:[y.jsx("span",{children:D.name}),h.includes(D.id)&&y.jsx(En,{className:"w-4 h-4"})]},D.id))})]})]})]}),y.jsxs("div",{className:"bg-white rounded-[24px] p-6 shadow-sm border border-gray-100",children:[y.jsxs("div",{className:"flex items-center justify-between mb-6",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(IS,{className:"w-4 h-4 text-ios-indigo"}),y.jsx("h3",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"   (A4 1/)"})]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{onClick:()=>c(l.map(D=>D.id)),className:"text-[11px] font-black text-ios-indigo hover:underline",children:" "}),y.jsx("span",{className:"text-gray-200",children:"|"}),y.jsx("button",{onClick:()=>c([]),className:"text-[11px] font-black text-ios-rose hover:underline",children:""})]})]}),y.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-3",children:l.map(D=>y.jsxs("button",{onClick:()=>k(D.id),className:`relative p-4 rounded-2xl border-2 transition-all group ${a.includes(D.id)?"bg-ios-indigo/5 border-ios-indigo":"bg-white border-gray-100 hover:border-gray-200"}`,children:[y.jsxs("p",{className:`text-[13px] font-black ${a.includes(D.id)?"text-ios-indigo":"text-[#1C1C1E]"}`,children:[D.id,""]}),y.jsxs("p",{className:"text-[10px] text-ios-gray font-bold mt-1",children:[Ee(D.start,"MM/dd(eee)",{locale:Yt})," - ",Ee(D.end,"MM/dd(eee)",{locale:Yt})]}),a.includes(D.id)&&y.jsx("div",{className:"absolute top-2 right-2 flex items-center justify-center w-5 h-5 rounded-full bg-ios-indigo text-white shadow-sm scale-110",children:y.jsx(En,{className:"w-3 h-3",strokeWidth:4})})]},D.id))})]})]})}),y.jsxs("div",{className:`print-area ${g?"block opacity-0 pointer-events-none":"hidden"} fixed inset-0 z-[-1]`,children:[y.jsx("style",{children:`
                    @media print {
                        @page { 
                            size: A4 portrait; 
                            margin: 20mm 10mm 10mm 10mm; 
                        }
                        
                        /* Reset EVERYTHING to non-scrolling block layout */
                        html, body, #root, #root > div, main, main > div, 
                        .flex-1.flex, .admin-content-view, 
                        div[class*="rounded-2xl"], div[class*="bg-white"],
                        .flex-1.bg-\\[\\#F2F2F7\\] { 
                            height: auto !important;
                            overflow: visible !important;
                            display: block !important;
                            position: static !important;
                            margin: 0 !important;
                            padding: 0 !important;
                            border: none !important;
                            box-shadow: none !important;
                            flex: none !important;
                            width: 100% !important;
                        }

                        /* Hide app UI */
                        header, aside, .sidebar, .header, .nav-tabs, .selection-ui, .hide-on-print { 
                            display: none !important;
                        }

                        /* Force the printable content back to visible and opacity-1 */
                        .print-area { 
                            display: block !important; 
                            visibility: visible !important;
                            opacity: 1 !important;
                            position: static !important;
                            z-index: auto !important;
                        }

                        .print-area * {
                            visibility: visible !important;
                        }

                        /* Use standard flow for reliable pagination */
                        .print-area {
                            display: block !important;
                            position: static !important;
                            width: 100% !important;
                            margin: 0 !important;
                            padding: 0 !important;
                        }

                        .page-break { 
                            display: block !important;
                            page-break-after: always !important;
                            break-after: page !important;
                            width: 100% !important;
                            margin: 0 !important;
                            padding: 0 !important;
                            position: relative !important;
                        }

                        /* Ensure no top margin on the first page beyond the @page margin */
                        .page-break:first-child {
                            margin-top: 0 !important;
                        }

                        .header-row { 
                            display: flex; 
                            justify-content: space-between; 
                            align-items: flex-end; 
                            margin: 0 0 10px 0 !important; 
                            padding: 0 0 5px 0 !important;
                            border-bottom: 2px solid #000 !important; 
                        }
                        
                        .school-title { 
                            font-size: 20px !important; 
                            font-weight: 900 !important;
                            margin: 0 !important;
                            padding: 0 !important;
                            line-height: 1 !important;
                        }

                        .doc-title {
                            font-size: 10px !important;
                            margin: 0 !important;
                            padding: 0 !important;
                        }

                        .attendance-table { 
                            width: 100% !important; 
                            border-collapse: collapse !important; 
                            margin: 10px 0 0 0 !important;
                            font-size: 10px !important; 
                            table-layout: fixed !important;
                        }

                        .attendance-table th, .attendance-table td { 
                            border: 1px solid #000 !important; 
                            padding: 4px !important; 
                            text-align: center !important; 
                        }

                        .attendance-table th { 
                            background-color: #eee !important; 
                            -webkit-print-color-adjust: exact !important;
                        }
                    }
                `}),y.jsx("div",{className:"print-root",children:v.map((D,U)=>y.jsxs("div",{className:"page-break",children:[y.jsxs("div",{className:"header-row",children:[y.jsxs("h1",{className:"school-title",children:["   (",i==null?void 0:i.quarter_name,", ",D.weekInfo.id,")"]}),y.jsxs("div",{className:"doc-title",children:[Ee(D.weekInfo.start,"yyyy-MM-dd(eee)",{locale:Yt})," ~ ",Ee(D.weekInfo.end,"yyyy-MM-dd(eee)",{locale:Yt})]})]}),y.jsx("div",{className:"flex justify-between items-center mb-2 px-1 text-[10px] font-bold",children:y.jsxs("div",{className:"flex gap-4",children:[y.jsxs("span",{children:[": ",i==null?void 0:i.academic_year]}),y.jsxs("span",{children:[": ",D.grade,""]})]})}),y.jsxs("table",{className:"attendance-table",children:[y.jsxs("thead",{children:[y.jsxs("tr",{children:[y.jsx("th",{style:{width:"40px"},children:"No"}),y.jsx("th",{style:{width:"100px"},children:"//"}),y.jsx("th",{style:{width:"100px"},children:""}),D.businessDays.map(M=>y.jsxs("th",{colSpan:D.sessions.length,children:[Ee(M,"MM/dd")," (",Ee(M,"E",{locale:Yt})[0],")"]},M.toString()))]}),y.jsxs("tr",{children:[y.jsx("th",{colSpan:3,children:""}),D.businessDays.map(M=>D.sessions.map(q=>y.jsx("th",{style:{fontSize:"8px",padding:"2px 0"},children:q.name},`${M}-${q.id}`)))]})]}),y.jsx("tbody",{children:D.students.map((M,q)=>y.jsxs("tr",{children:[y.jsx("td",{children:q+1}),y.jsxs("td",{children:[M.grade,String(M.class_number).padStart(2,"0"),String(M.student_number).padStart(2,"0")]}),y.jsx("td",{style:{fontWeight:"bold"},children:M.full_name}),D.businessDays.map(G=>{const Q=Ee(G,"yyyy-MM-dd");return D.sessions.map(K=>{var j,B;const ne=D.bookings.find(E=>E.user_id===M.id&&E.date===Q&&E.session_id===K.id),J=(B=(j=ne==null?void 0:ne.attendance)==null?void 0:j[0])==null?void 0:B.status,T=J==="present"?"O":J==="late"?"":J==="early"?"":ne?"":"-";return y.jsx("td",{style:{fontSize:"9px",color:J==="absent"?"#ff3b30":"inherit"},children:T},`${M.id}-${Q}-${K.id}`)})})]},M.id))})]})]},U))})]})]})};function P8(){const[e,t]=le.useState(()=>{const q=localStorage.getItem("activeTab");if(q)return q;const G=localStorage.getItem("currentUser");if(G)try{const Q=JSON.parse(G);if(["admin","teacher"].includes(Q.role))return"admin"}catch(Q){console.error("Failed to parse saved user",Q)}return"map"}),[r,n]=le.useState(()=>localStorage.getItem("adminSubTab")||"attendance"),[i,s]=le.useState(null),[l,o]=le.useState(()=>{const q=localStorage.getItem("currentUser");return q?JSON.parse(q):null}),[a,c]=le.useState(Ee(new Date,"yyyy-MM-dd")),[d,f]=le.useState(null),[h,u]=le.useState(()=>localStorage.getItem("schoolName")||"GOE STUDY CAFE"),[p,m]=le.useState(""),[g,x]=le.useState([]),[v,w]=le.useState(null),[_,b]=le.useState(!1),[k,S]=le.useState(()=>window.innerWidth<768&&window.innerHeight>window.innerWidth);le.useEffect(()=>{const q=()=>{S(window.innerWidth<768&&window.innerHeight>window.innerWidth)};return window.addEventListener("resize",q),()=>window.removeEventListener("resize",q)},[]);const O=async q=>{const G=q.trim();if(!G)return;b(!0);let Q=[];try{let K=we.from("profiles").select("*").eq("role","student").limit(50);/^\d{3}$/.test(G)?K=K.or(`username.like.${G}%,full_name.ilike.%${G}%,username.ilike.%${G}%`):K=K.or(`full_name.ilike.%${G}%,username.ilike.%${G}%`);const{data:ne,error:J}=await K;J?console.error("[Search Error]",J):Q=ne.map(T=>({id:T.id,full_name:T.full_name,username:T.username,grade:T.grade||0,class_number:T.class_number||0,student_number:T.student_number||0,role:"student"})),x(Q)}catch(K){console.error("Search Error:",K),x([])}finally{b(!1)}};le.useEffect(()=>{(async()=>{const{data:G}=await we.from("configs").select("value").eq("key","school_info").single();G&&(u(G.value.name),localStorage.setItem("schoolName",G.value.name))})()},[]),le.useEffect(()=>{l?localStorage.setItem("currentUser",JSON.stringify(l)):localStorage.removeItem("currentUser")},[l]),le.useEffect(()=>{localStorage.setItem("activeTab",e)},[e]),le.useEffect(()=>{localStorage.setItem("adminSubTab",r)},[r]);const F=()=>{o(null),localStorage.removeItem("currentUser"),localStorage.removeItem("activeTab"),localStorage.removeItem("adminSubTab"),t("map")};if(!l)return y.jsx(N8,{onLoginSuccess:q=>{o(q),["admin","teacher"].includes(q.role)&&t("admin")}});const D=[{id:"admin",icon:sd,label:"/ ",roles:["admin","teacher"]},{id:"map",icon:Ua,label:"",roles:["admin","student","parent","teacher"]},{id:"attendance",icon:As,label:" ",roles:["student"]},{id:"profile",icon:sl,label:"  ",roles:["student","parent"]}].filter(q=>!q.roles||q.roles.includes(l.role)),U=[{group:" ",items:[{id:"attendance",label:"  ",icon:id,roles:["admin","teacher"]},{id:"attendance_print",label:" ",icon:du,roles:["admin","teacher"]},{id:"safety",label:" /",icon:C0,roles:["admin","teacher"]}]},{group:"   ",items:[{id:"layout",label:"  ",icon:hu,roles:["admin"]},{id:"students",label:"  ",icon:Dl,roles:["admin"]},{id:"schedule",label:"  ",icon:Hi,roles:["admin"]}]},{group:" ",items:[{id:"settings",label:"   ",icon:sd,roles:["admin"]}]}].map(q=>({...q,items:q.items.filter(G=>G.roles.includes(l.role))})).filter(q=>q.items.length>0);return["admin","teacher"].includes(l.role),l.role==="teacher"||l.role==="admin"&&k?y.jsx(b8,{onLogout:F,currentUser:l}):l.role==="student"?y.jsx(C8,{onLogout:F,currentUser:l}):l.role==="parent"?y.jsx(A8,{onLogout:F,currentUser:l}):y.jsxs("div",{className:"flex flex-col h-screen bg-[#F2F2F7] text-[#1C1C1E] overflow-hidden font-sans selection:bg-ios-indigo/10",children:[y.jsxs("header",{className:"bg-white border-b border-gray-200/60 px-4 py-2 lg:px-8 flex items-center justify-between z-40 shrink-0 shadow-sm",children:[y.jsxs("div",{className:"flex items-center gap-6",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"w-9 h-9 rounded-[6px] bg-[#1C1C1E] flex items-center justify-center shadow-lg shadow-black/10",children:y.jsx(Ua,{className:"w-5 h-5 text-white"})}),y.jsxs("div",{children:[y.jsx("h1",{className:"text-lg font-black tracking-tighter leading-tight uppercase text-[#1C1C1E]",children:h.split(" ")[0]}),y.jsx("p",{className:"text-[8px] font-black tracking-[0.2em] text-ios-indigo uppercase opacity-80",children:h.split(" ").slice(1).join(" ")||"Study Cafe"})]})]}),y.jsx("nav",{className:"flex items-center gap-1 bg-gray-50/80 p-1 rounded-[10px] border border-gray-100 ml-4 backdrop-blur-md",children:D.map(q=>y.jsxs("button",{onClick:()=>t(q.id),className:`flex items-center gap-2 px-4 py-2 rounded-[8px] transition-all duration-300 group relative ${e===q.id?"bg-white shadow-md text-[#1C1C1E]":"text-[#1C1C1E]/40 hover:text-[#1C1C1E] hover:bg-white/50"}`,children:[y.jsx(q.icon,{className:`w-4 h-4 transition-transform duration-300 ${e===q.id?"text-ios-indigo":"group-hover:scale-110"}`}),y.jsx("span",{className:"font-black text-[13px]",children:q.label}),e===q.id&&y.jsx("div",{className:"absolute -bottom-[5px] left-1/2 -translate-x-1/2 w-1 h-1 rounded-full bg-ios-indigo"})]},q.id))}),e==="map"&&["admin","teacher"].includes(l.role)&&y.jsxs("div",{className:"relative ml-4 z-50",children:[v?y.jsxs("div",{className:"flex items-center gap-3 bg-white px-3 py-1.5 rounded-[12px] border-2 border-ios-indigo/20 shadow-sm animate-fade-in-scale",children:[y.jsxs("div",{className:"flex items-center gap-2 pr-2 border-r border-gray-100",children:[y.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-100 text-gray-700 flex items-center justify-center text-[10px] font-black shadow-sm border border-gray-200",children:v.full_name[0]}),y.jsxs("div",{className:"flex flex-col gap-0.5",children:[y.jsx("span",{className:"text-[12px] font-black text-[#1C1C1E]",children:v.full_name}),y.jsxs("span",{className:"text-[9px] text-gray-500 font-medium",children:["   (",v.username,")"]})]})]}),y.jsxs("button",{onClick:()=>{m(""),x([]),w(null)},className:"flex items-center gap-1.5 bg-gray-50 hover:bg-ios-rose/10 text-gray-500 hover:text-ios-rose px-2 py-1.5 rounded-[8px] transition-all group",children:[y.jsx(gk,{className:"w-3 h-3 group-hover:rotate-180 transition-transform duration-500"}),y.jsx("span",{className:"text-[10px] font-bold",children:"  "})]})]}):y.jsxs("div",{className:"group flex items-center gap-2 bg-gray-50/80 px-3 py-1.5 rounded-[10px] border border-gray-100 backdrop-blur-md transition-all focus-within:bg-white focus-within:shadow-md focus-within:w-72 w-56 focus-within:border-ios-indigo/50",children:[y.jsx(id,{className:"w-3.5 h-3.5 text-gray-400 group-focus-within:text-ios-indigo transition-colors"}),y.jsx("input",{type:"text",value:p,onChange:q=>{m(q.target.value),q.target.value.length>=1?O(q.target.value):x([])},placeholder:"  (  )",className:"bg-transparent border-none outline-none text-[12px] font-bold placeholder:text-gray-400 w-full text-gray-700"})]}),g.length>0&&!v&&y.jsx("div",{className:"absolute top-full left-0 mt-2 w-72 bg-white/90 backdrop-blur-xl rounded-[12px] shadow-xl border border-gray-100 overflow-hidden animate-spring-up p-1 z-50",children:g.map(q=>y.jsxs("button",{onClick:()=>{w(q),m(""),x([])},className:"w-full text-left px-3 py-2.5 hover:bg-ios-indigo/5 rounded-[8px] transition-colors flex items-center justify-between group border-b border-gray-50 last:border-0",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"w-8 h-8 rounded-[8px] bg-gray-100 group-hover:bg-white group-hover:shadow-sm flex items-center justify-center text-[10px] font-bold text-gray-500 group-hover:text-ios-indigo transition-all",children:q.full_name[0]}),y.jsxs("div",{children:[y.jsx("div",{className:"text-[13px] font-bold text-[#1C1C1E] group-hover:text-ios-indigo transition-colors",children:q.full_name}),y.jsxs("div",{className:"text-[10px] text-gray-400 font-mono flex items-center gap-1",children:[y.jsxs("span",{children:["ID: ",q.username]}),q.grade>0&&y.jsx("span",{className:"text-gray-300",children:"|"}),q.grade>0&&y.jsxs("span",{children:[q.grade," ",q.class_number," ",q.student_number,""]})]})]})]}),y.jsx("div",{className:"text-[10px] bg-gray-50 text-gray-400 px-2 py-1 rounded-[6px] group-hover:bg-ios-indigo group-hover:text-white transition-colors font-bold",children:""})]},q.id))})]})]}),y.jsxs("div",{className:"flex items-center gap-6",children:[y.jsxs("div",{className:"flex items-center gap-3 bg-gray-50/50 p-1 px-4 py-1.5 rounded-[10px] border border-gray-200/30",children:[y.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-white border border-gray-100 flex items-center justify-center shadow-sm",children:y.jsx(sl,{className:"w-4 h-4 text-ios-indigo"})}),y.jsxs("div",{className:"text-left",children:[y.jsx("p",{className:"text-[13px] font-black leading-none text-[#1C1C1E]",children:l==null?void 0:l.full_name}),y.jsx("p",{className:"text-[9px] font-black text-ios-indigo tracking-widest mt-1 uppercase opacity-60 italic",children:l==null?void 0:l.role})]})]}),y.jsxs("button",{onClick:F,className:"flex items-center gap-2 p-2 px-4 rounded-[10px] text-ios-gray hover:text-ios-rose hover:bg-ios-rose/5 transition-all ios-tap border border-transparent hover:border-ios-rose/10 group",children:[y.jsx(Pl,{className:"w-4 h-4 group-hover:-translate-x-0.5 transition-transform"}),y.jsx("span",{className:"font-bold text-[13px]",children:""})]})]})]}),y.jsx("main",{className:"flex-1 h-full flex overflow-hidden relative",children:e==="admin"?y.jsxs("div",{className:"flex-1 flex overflow-hidden w-full",children:[y.jsxs("aside",{className:"w-64 bg-white border-r border-gray-100 flex flex-col p-6 shrink-0 z-30 shadow-[4px_0_24px_rgba(0,0,0,0.02)]",children:[y.jsx("div",{className:"flex-1 space-y-8",children:U.map((q,G)=>y.jsxs("div",{className:"space-y-3",children:[y.jsx("h5",{className:"text-[10px] font-black text-ios-gray uppercase tracking-[0.2em] px-2",children:q.group}),y.jsx("div",{className:"space-y-1",children:q.items.map(Q=>y.jsxs("button",{onClick:()=>n(Q.id),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-bold transition-all ios-tap group ${r===Q.id?"bg-white text-[#1C1C1E] shadow-md border border-gray-100":"text-ios-gray hover:text-[#1C1C1E] hover:bg-gray-50"}`,children:[y.jsx(Q.icon,{className:`w-4 h-4 ${r===Q.id?"text-ios-indigo":"group-hover:text-ios-indigo transition-colors"}`}),Q.label]},Q.id))})]},G))}),y.jsx("div",{className:"pt-6 border-t border-gray-50",children:y.jsx("p",{className:"text-[8px] font-bold text-gray-300 tracking-tighter uppercase italic",children:"Copyright murmurgene 2026. All rights reserved."})})]}),y.jsx("div",{className:"flex-1 bg-[#F2F2F7] p-6 overflow-hidden",children:y.jsx("div",{className:"h-full w-full rounded-2xl overflow-hidden shadow-sm border border-black/5 bg-white",children:r==="layout"?y.jsx(xE,{}):r==="attendance"?y.jsx(s_,{}):r==="attendance_print"?y.jsx(j8,{}):r==="students"?y.jsx(E8,{}):r==="schedule"?y.jsx(O8,{}):r==="settings"?y.jsx(F8,{}):y.jsx(w8,{})})})]}):y.jsx("div",{className:"flex-1 h-full flex flex-col overflow-hidden p-6",children:e==="attendance"?y.jsx("div",{className:"h-full flex flex-col items-center justify-center",children:y.jsx(m_,{})}):e==="profile"?y.jsx("div",{className:"h-full overflow-y-auto scrollbar-hide",children:y.jsx(x_,{})}):y.jsx("div",{className:"flex-1 flex flex-col overflow-hidden pt-2",children:y.jsxs("section",{className:"flex-1 flex flex-col xl:flex-row gap-6 leading-normal overflow-hidden",children:[y.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:y.jsx("div",{className:"flex-1 w-full bg-white rounded-2xl border border-black/5 overflow-hidden p-2 shadow-sm",children:y.jsx(g_,{onSelectSeat:s,selectedProxyUser:v,viewDate:a,onDateChange:c,selectedZoneId:d,onZoneChange:f})})}),y.jsx("div",{className:"xl:w-80 h-full overflow-y-auto scrollbar-hide bg-white rounded-2xl border border-black/5 shadow-sm",children:y.jsx(T8,{selectedSeat:i,onComplete:()=>s(null),targetUser:v,loggedInUser:l,initialDate:a,onDateChange:c,currentZoneId:d})})]})})})})]})}class D8 extends Cx.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){this.setState({error:t,errorInfo:r}),console.error("Uncaught error:",t,r)}render(){return this.state.hasError?y.jsxs("div",{className:"p-8 bg-white h-screen w-full flex flex-col items-center justify-center text-[#1C1C1E]",children:[y.jsx("h1",{className:"text-2xl font-black mb-4 text-ios-rose",children:"Application Crash"}),y.jsxs("pre",{className:"bg-gray-100 p-4 rounded text-xs overflow-auto max-w-full",children:[this.state.error&&this.state.error.toString(),y.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]}),y.jsx("button",{onClick:()=>window.location.reload(),className:"mt-6 px-6 py-3 bg-[#1C1C1E] text-white rounded-[6px] font-black",children:"Reload Application"})]}):this.props.children}}uh.createRoot(document.getElementById("root")).render(y.jsx(Cx.StrictMode,{children:y.jsx(D8,{children:y.jsx(P8,{})})}));
