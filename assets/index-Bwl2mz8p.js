(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function A_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function O_(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var dx={exports:{}},Ou={},gx={exports:{}},tt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cl=Symbol.for("react.element"),N_=Symbol.for("react.portal"),F_=Symbol.for("react.fragment"),P_=Symbol.for("react.strict_mode"),D_=Symbol.for("react.profiler"),j_=Symbol.for("react.provider"),R_=Symbol.for("react.context"),I_=Symbol.for("react.forward_ref"),M_=Symbol.for("react.suspense"),L_=Symbol.for("react.memo"),B_=Symbol.for("react.lazy"),xg=Symbol.iterator;function U_(e){return e===null||typeof e!="object"?null:(e=xg&&e[xg]||e["@@iterator"],typeof e=="function"?e:null)}var px={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},mx=Object.assign,xx={};function Wa(e,t,r){this.props=e,this.context=t,this.refs=xx,this.updater=r||px}Wa.prototype.isReactComponent={};Wa.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Wa.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function vx(){}vx.prototype=Wa.prototype;function Ad(e,t,r){this.props=e,this.context=t,this.refs=xx,this.updater=r||px}var Od=Ad.prototype=new vx;Od.constructor=Ad;mx(Od,Wa.prototype);Od.isPureReactComponent=!0;var vg=Array.isArray,yx=Object.prototype.hasOwnProperty,Nd={current:null},wx={key:!0,ref:!0,__self:!0,__source:!0};function _x(e,t,r){var n,i={},s=null,l=null;if(t!=null)for(n in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(s=""+t.key),t)yx.call(t,n)&&!wx.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var a=Array(o),c=0;c<o;c++)a[c]=arguments[c+2];i.children=a}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Cl,type:e,key:s,ref:l,props:i,_owner:Nd.current}}function W_(e,t){return{$$typeof:Cl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Fd(e){return typeof e=="object"&&e!==null&&e.$$typeof===Cl}function z_(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var yg=/\/+/g;function ff(e,t){return typeof e=="object"&&e!==null&&e.key!=null?z_(""+e.key):t.toString(36)}function Cc(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Cl:case N_:l=!0}}if(l)return l=e,i=i(l),e=n===""?"."+ff(l,0):n,vg(i)?(r="",e!=null&&(r=e.replace(yg,"$&/")+"/"),Cc(i,t,r,"",function(c){return c})):i!=null&&(Fd(i)&&(i=W_(i,r+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(yg,"$&/")+"/")+e)),t.push(i)),1;if(l=0,n=n===""?".":n+":",vg(e))for(var o=0;o<e.length;o++){s=e[o];var a=n+ff(s,o);l+=Cc(s,t,r,a,i)}else if(a=U_(e),typeof a=="function")for(e=a.call(e),o=0;!(s=e.next()).done;)s=s.value,a=n+ff(s,o++),l+=Cc(s,t,r,a,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Vl(e,t,r){if(e==null)return e;var n=[],i=0;return Cc(e,n,"","",function(s){return t.call(r,s,i++)}),n}function H_(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ar={current:null},Tc={transition:null},V_={ReactCurrentDispatcher:Ar,ReactCurrentBatchConfig:Tc,ReactCurrentOwner:Nd};function bx(){throw Error("act(...) is not supported in production builds of React.")}tt.Children={map:Vl,forEach:function(e,t,r){Vl(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Vl(e,function(){t++}),t},toArray:function(e){return Vl(e,function(t){return t})||[]},only:function(e){if(!Fd(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};tt.Component=Wa;tt.Fragment=F_;tt.Profiler=D_;tt.PureComponent=Ad;tt.StrictMode=P_;tt.Suspense=M_;tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=V_;tt.act=bx;tt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=mx({},e.props),i=e.key,s=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,l=Nd.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(a in t)yx.call(t,a)&&!wx.hasOwnProperty(a)&&(n[a]=t[a]===void 0&&o!==void 0?o[a]:t[a])}var a=arguments.length-2;if(a===1)n.children=r;else if(1<a){o=Array(a);for(var c=0;c<a;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Cl,type:e.type,key:i,ref:s,props:n,_owner:l}};tt.createContext=function(e){return e={$$typeof:R_,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:j_,_context:e},e.Consumer=e};tt.createElement=_x;tt.createFactory=function(e){var t=_x.bind(null,e);return t.type=e,t};tt.createRef=function(){return{current:null}};tt.forwardRef=function(e){return{$$typeof:I_,render:e}};tt.isValidElement=Fd;tt.lazy=function(e){return{$$typeof:B_,_payload:{_status:-1,_result:e},_init:H_}};tt.memo=function(e,t){return{$$typeof:L_,type:e,compare:t===void 0?null:t}};tt.startTransition=function(e){var t=Tc.transition;Tc.transition={};try{e()}finally{Tc.transition=t}};tt.unstable_act=bx;tt.useCallback=function(e,t){return Ar.current.useCallback(e,t)};tt.useContext=function(e){return Ar.current.useContext(e)};tt.useDebugValue=function(){};tt.useDeferredValue=function(e){return Ar.current.useDeferredValue(e)};tt.useEffect=function(e,t){return Ar.current.useEffect(e,t)};tt.useId=function(){return Ar.current.useId()};tt.useImperativeHandle=function(e,t,r){return Ar.current.useImperativeHandle(e,t,r)};tt.useInsertionEffect=function(e,t){return Ar.current.useInsertionEffect(e,t)};tt.useLayoutEffect=function(e,t){return Ar.current.useLayoutEffect(e,t)};tt.useMemo=function(e,t){return Ar.current.useMemo(e,t)};tt.useReducer=function(e,t,r){return Ar.current.useReducer(e,t,r)};tt.useRef=function(e){return Ar.current.useRef(e)};tt.useState=function(e){return Ar.current.useState(e)};tt.useSyncExternalStore=function(e,t,r){return Ar.current.useSyncExternalStore(e,t,r)};tt.useTransition=function(){return Ar.current.useTransition()};tt.version="18.3.1";gx.exports=tt;var le=gx.exports;const Sx=A_(le);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $_=le,X_=Symbol.for("react.element"),Y_=Symbol.for("react.fragment"),G_=Object.prototype.hasOwnProperty,q_=$_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,K_={key:!0,ref:!0,__self:!0,__source:!0};function kx(e,t,r){var n,i={},s=null,l=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)G_.call(t,n)&&!K_.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:X_,type:e,key:s,ref:l,props:i,_owner:q_.current}}Ou.Fragment=Y_;Ou.jsx=kx;Ou.jsxs=kx;dx.exports=Ou;var w=dx.exports,lh={},Cx={exports:{}},qr={},Tx={exports:{}},Ex={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ee,E){var D=ee.length;ee.push(E);e:for(;0<D;){var U=D-1>>>1,k=ee[U];if(0<i(k,E))ee[U]=E,ee[D]=k,D=U;else break e}}function r(ee){return ee.length===0?null:ee[0]}function n(ee){if(ee.length===0)return null;var E=ee[0],D=ee.pop();if(D!==E){ee[0]=D;e:for(var U=0,k=ee.length,P=k>>>1;U<P;){var A=2*(U+1)-1,T=ee[A],j=A+1,R=ee[j];if(0>i(T,D))j<k&&0>i(R,T)?(ee[U]=R,ee[j]=D,U=j):(ee[U]=T,ee[A]=D,U=A);else if(j<k&&0>i(R,D))ee[U]=R,ee[j]=D,U=j;else break e}}return E}function i(ee,E){var D=ee.sortIndex-E.sortIndex;return D!==0?D:ee.id-E.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var a=[],c=[],d=1,f=null,h=3,u=!1,g=!1,m=!1,p=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(ee){for(var E=r(c);E!==null;){if(E.callback===null)n(c);else if(E.startTime<=ee)n(c),E.sortIndex=E.expirationTime,t(a,E);else break;E=r(c)}}function _(ee){if(m=!1,y(ee),!g)if(r(a)!==null)g=!0,Z(b);else{var E=r(c);E!==null&&oe(_,E.startTime-ee)}}function b(ee,E){g=!1,m&&(m=!1,x(N),N=-1),u=!0;var D=h;try{for(y(E),f=r(a);f!==null&&(!(f.expirationTime>E)||ee&&!X());){var U=f.callback;if(typeof U=="function"){f.callback=null,h=f.priorityLevel;var k=U(f.expirationTime<=E);E=e.unstable_now(),typeof k=="function"?f.callback=k:f===r(a)&&n(a),y(E)}else n(a);f=r(a)}if(f!==null)var P=!0;else{var A=r(c);A!==null&&oe(_,A.startTime-E),P=!1}return P}finally{f=null,h=D,u=!1}}var S=!1,C=null,N=-1,F=5,Y=-1;function X(){return!(e.unstable_now()-Y<F)}function V(){if(C!==null){var ee=e.unstable_now();Y=ee;var E=!0;try{E=C(!0,ee)}finally{E?te():(S=!1,C=null)}}else S=!1}var te;if(typeof v=="function")te=function(){v(V)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,re=G.port2;G.port1.onmessage=V,te=function(){re.postMessage(null)}}else te=function(){p(V,0)};function Z(ee){C=ee,S||(S=!0,te())}function oe(ee,E){N=p(function(){ee(e.unstable_now())},E)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_continueExecution=function(){g||u||(g=!0,Z(b))},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(a)},e.unstable_next=function(ee){switch(h){case 1:case 2:case 3:var E=3;break;default:E=h}var D=h;h=E;try{return ee()}finally{h=D}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ee,E){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var D=h;h=ee;try{return E()}finally{h=D}},e.unstable_scheduleCallback=function(ee,E,D){var U=e.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?U+D:U):D=U,ee){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=D+k,ee={id:d++,callback:E,priorityLevel:ee,startTime:D,expirationTime:k,sortIndex:-1},D>U?(ee.sortIndex=D,t(c,ee),r(a)===null&&ee===r(c)&&(m?(x(N),N=-1):m=!0,oe(_,D-U))):(ee.sortIndex=k,t(a,ee),g||u||(g=!0,Z(b))),ee},e.unstable_shouldYield=X,e.unstable_wrapCallback=function(ee){var E=h;return function(){var D=h;h=E;try{return ee.apply(this,arguments)}finally{h=D}}}})(Ex);Tx.exports=Ex;var J_=Tx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q_=le,Yr=J_;function ke(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ax=new Set,Mo={};function Ps(e,t){Oa(e,t),Oa(e+"Capture",t)}function Oa(e,t){for(Mo[e]=t,e=0;e<t.length;e++)Ax.add(t[e])}var ri=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ch=Object.prototype.hasOwnProperty,Z_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wg={},_g={};function e2(e){return ch.call(_g,e)?!0:ch.call(wg,e)?!1:Z_.test(e)?_g[e]=!0:(wg[e]=!0,!1)}function t2(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function r2(e,t,r,n){if(t===null||typeof t>"u"||t2(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Or(e,t,r,n,i,s,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=l}var cr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){cr[e]=new Or(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];cr[t]=new Or(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){cr[e]=new Or(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){cr[e]=new Or(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){cr[e]=new Or(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){cr[e]=new Or(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){cr[e]=new Or(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){cr[e]=new Or(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){cr[e]=new Or(e,5,!1,e.toLowerCase(),null,!1,!1)});var Pd=/[\-:]([a-z])/g;function Dd(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Pd,Dd);cr[t]=new Or(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Pd,Dd);cr[t]=new Or(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Pd,Dd);cr[t]=new Or(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){cr[e]=new Or(e,1,!1,e.toLowerCase(),null,!1,!1)});cr.xlinkHref=new Or("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){cr[e]=new Or(e,1,!1,e.toLowerCase(),null,!0,!0)});function jd(e,t,r,n){var i=cr.hasOwnProperty(t)?cr[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(r2(t,r,i,n)&&(r=null),n||i===null?e2(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var oi=Q_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$l=Symbol.for("react.element"),ta=Symbol.for("react.portal"),ra=Symbol.for("react.fragment"),Rd=Symbol.for("react.strict_mode"),uh=Symbol.for("react.profiler"),Ox=Symbol.for("react.provider"),Nx=Symbol.for("react.context"),Id=Symbol.for("react.forward_ref"),fh=Symbol.for("react.suspense"),hh=Symbol.for("react.suspense_list"),Md=Symbol.for("react.memo"),mi=Symbol.for("react.lazy"),Fx=Symbol.for("react.offscreen"),bg=Symbol.iterator;function Qa(e){return e===null||typeof e!="object"?null:(e=bg&&e[bg]||e["@@iterator"],typeof e=="function"?e:null)}var Ft=Object.assign,hf;function co(e){if(hf===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);hf=t&&t[1]||""}return`
`+hf+e}var df=!1;function gf(e,t){if(!e||df)return"";df=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),l=i.length-1,o=s.length-1;1<=l&&0<=o&&i[l]!==s[o];)o--;for(;1<=l&&0<=o;l--,o--)if(i[l]!==s[o]){if(l!==1||o!==1)do if(l--,o--,0>o||i[l]!==s[o]){var a=`
`+i[l].replace(" at new "," at ");return e.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",e.displayName)),a}while(1<=l&&0<=o);break}}}finally{df=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?co(e):""}function n2(e){switch(e.tag){case 5:return co(e.type);case 16:return co("Lazy");case 13:return co("Suspense");case 19:return co("SuspenseList");case 0:case 2:case 15:return e=gf(e.type,!1),e;case 11:return e=gf(e.type.render,!1),e;case 1:return e=gf(e.type,!0),e;default:return""}}function dh(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ra:return"Fragment";case ta:return"Portal";case uh:return"Profiler";case Rd:return"StrictMode";case fh:return"Suspense";case hh:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Nx:return(e.displayName||"Context")+".Consumer";case Ox:return(e._context.displayName||"Context")+".Provider";case Id:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Md:return t=e.displayName||null,t!==null?t:dh(e.type)||"Memo";case mi:t=e._payload,e=e._init;try{return dh(e(t))}catch{}}return null}function i2(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return dh(t);case 8:return t===Rd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Mi(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Px(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function s2(e){var t=Px(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(l){n=""+l,s.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Xl(e){e._valueTracker||(e._valueTracker=s2(e))}function Dx(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Px(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Bc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function gh(e,t){var r=t.checked;return Ft({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Sg(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Mi(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function jx(e,t){t=t.checked,t!=null&&jd(e,"checked",t,!1)}function ph(e,t){jx(e,t);var r=Mi(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?mh(e,t.type,r):t.hasOwnProperty("defaultValue")&&mh(e,t.type,Mi(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function kg(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function mh(e,t,r){(t!=="number"||Bc(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var uo=Array.isArray;function pa(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Mi(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function xh(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ke(91));return Ft({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Cg(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ke(92));if(uo(r)){if(1<r.length)throw Error(ke(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Mi(r)}}function Rx(e,t){var r=Mi(t.value),n=Mi(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Tg(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Ix(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function vh(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Ix(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Yl,Mx=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Yl=Yl||document.createElement("div"),Yl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Yl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Lo(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var vo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},a2=["Webkit","ms","Moz","O"];Object.keys(vo).forEach(function(e){a2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),vo[t]=vo[e]})});function Lx(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||vo.hasOwnProperty(e)&&vo[e]?(""+t).trim():t+"px"}function Bx(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Lx(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var o2=Ft({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yh(e,t){if(t){if(o2[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ke(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ke(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ke(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ke(62))}}function wh(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _h=null;function Ld(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var bh=null,ma=null,xa=null;function Eg(e){if(e=Al(e)){if(typeof bh!="function")throw Error(ke(280));var t=e.stateNode;t&&(t=ju(t),bh(e.stateNode,e.type,t))}}function Ux(e){ma?xa?xa.push(e):xa=[e]:ma=e}function Wx(){if(ma){var e=ma,t=xa;if(xa=ma=null,Eg(e),t)for(e=0;e<t.length;e++)Eg(t[e])}}function zx(e,t){return e(t)}function Hx(){}var pf=!1;function Vx(e,t,r){if(pf)return e(t,r);pf=!0;try{return zx(e,t,r)}finally{pf=!1,(ma!==null||xa!==null)&&(Hx(),Wx())}}function Bo(e,t){var r=e.stateNode;if(r===null)return null;var n=ju(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ke(231,t,typeof r));return r}var Sh=!1;if(ri)try{var Za={};Object.defineProperty(Za,"passive",{get:function(){Sh=!0}}),window.addEventListener("test",Za,Za),window.removeEventListener("test",Za,Za)}catch{Sh=!1}function l2(e,t,r,n,i,s,l,o,a){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var yo=!1,Uc=null,Wc=!1,kh=null,c2={onError:function(e){yo=!0,Uc=e}};function u2(e,t,r,n,i,s,l,o,a){yo=!1,Uc=null,l2.apply(c2,arguments)}function f2(e,t,r,n,i,s,l,o,a){if(u2.apply(this,arguments),yo){if(yo){var c=Uc;yo=!1,Uc=null}else throw Error(ke(198));Wc||(Wc=!0,kh=c)}}function Ds(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function $x(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Ag(e){if(Ds(e)!==e)throw Error(ke(188))}function h2(e){var t=e.alternate;if(!t){if(t=Ds(e),t===null)throw Error(ke(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Ag(i),e;if(s===n)return Ag(i),t;s=s.sibling}throw Error(ke(188))}if(r.return!==n.return)r=i,n=s;else{for(var l=!1,o=i.child;o;){if(o===r){l=!0,r=i,n=s;break}if(o===n){l=!0,n=i,r=s;break}o=o.sibling}if(!l){for(o=s.child;o;){if(o===r){l=!0,r=s,n=i;break}if(o===n){l=!0,n=s,r=i;break}o=o.sibling}if(!l)throw Error(ke(189))}}if(r.alternate!==n)throw Error(ke(190))}if(r.tag!==3)throw Error(ke(188));return r.stateNode.current===r?e:t}function Xx(e){return e=h2(e),e!==null?Yx(e):null}function Yx(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Yx(e);if(t!==null)return t;e=e.sibling}return null}var Gx=Yr.unstable_scheduleCallback,Og=Yr.unstable_cancelCallback,d2=Yr.unstable_shouldYield,g2=Yr.unstable_requestPaint,Lt=Yr.unstable_now,p2=Yr.unstable_getCurrentPriorityLevel,Bd=Yr.unstable_ImmediatePriority,qx=Yr.unstable_UserBlockingPriority,zc=Yr.unstable_NormalPriority,m2=Yr.unstable_LowPriority,Kx=Yr.unstable_IdlePriority,Nu=null,Ln=null;function x2(e){if(Ln&&typeof Ln.onCommitFiberRoot=="function")try{Ln.onCommitFiberRoot(Nu,e,void 0,(e.current.flags&128)===128)}catch{}}var Sn=Math.clz32?Math.clz32:w2,v2=Math.log,y2=Math.LN2;function w2(e){return e>>>=0,e===0?32:31-(v2(e)/y2|0)|0}var Gl=64,ql=4194304;function fo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Hc(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~i;o!==0?n=fo(o):(s&=l,s!==0&&(n=fo(s)))}else l=r&~i,l!==0?n=fo(l):s!==0&&(n=fo(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Sn(t),i=1<<r,n|=e[r],t&=~i;return n}function _2(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function b2(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var l=31-Sn(s),o=1<<l,a=i[l];a===-1?(!(o&r)||o&n)&&(i[l]=_2(o,t)):a<=t&&(e.expiredLanes|=o),s&=~o}}function Ch(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Jx(){var e=Gl;return Gl<<=1,!(Gl&4194240)&&(Gl=64),e}function mf(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Tl(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Sn(t),e[t]=r}function S2(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Sn(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function Ud(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Sn(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var ht=0;function Qx(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Zx,Wd,ev,tv,rv,Th=!1,Kl=[],Ti=null,Ei=null,Ai=null,Uo=new Map,Wo=new Map,yi=[],k2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ng(e,t){switch(e){case"focusin":case"focusout":Ti=null;break;case"dragenter":case"dragleave":Ei=null;break;case"mouseover":case"mouseout":Ai=null;break;case"pointerover":case"pointerout":Uo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wo.delete(t.pointerId)}}function eo(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=Al(t),t!==null&&Wd(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function C2(e,t,r,n,i){switch(t){case"focusin":return Ti=eo(Ti,e,t,r,n,i),!0;case"dragenter":return Ei=eo(Ei,e,t,r,n,i),!0;case"mouseover":return Ai=eo(Ai,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Uo.set(s,eo(Uo.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Wo.set(s,eo(Wo.get(s)||null,e,t,r,n,i)),!0}return!1}function nv(e){var t=os(e.target);if(t!==null){var r=Ds(t);if(r!==null){if(t=r.tag,t===13){if(t=$x(r),t!==null){e.blockedOn=t,rv(e.priority,function(){ev(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ec(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Eh(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);_h=n,r.target.dispatchEvent(n),_h=null}else return t=Al(r),t!==null&&Wd(t),e.blockedOn=r,!1;t.shift()}return!0}function Fg(e,t,r){Ec(e)&&r.delete(t)}function T2(){Th=!1,Ti!==null&&Ec(Ti)&&(Ti=null),Ei!==null&&Ec(Ei)&&(Ei=null),Ai!==null&&Ec(Ai)&&(Ai=null),Uo.forEach(Fg),Wo.forEach(Fg)}function to(e,t){e.blockedOn===t&&(e.blockedOn=null,Th||(Th=!0,Yr.unstable_scheduleCallback(Yr.unstable_NormalPriority,T2)))}function zo(e){function t(i){return to(i,e)}if(0<Kl.length){to(Kl[0],e);for(var r=1;r<Kl.length;r++){var n=Kl[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ti!==null&&to(Ti,e),Ei!==null&&to(Ei,e),Ai!==null&&to(Ai,e),Uo.forEach(t),Wo.forEach(t),r=0;r<yi.length;r++)n=yi[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<yi.length&&(r=yi[0],r.blockedOn===null);)nv(r),r.blockedOn===null&&yi.shift()}var va=oi.ReactCurrentBatchConfig,Vc=!0;function E2(e,t,r,n){var i=ht,s=va.transition;va.transition=null;try{ht=1,zd(e,t,r,n)}finally{ht=i,va.transition=s}}function A2(e,t,r,n){var i=ht,s=va.transition;va.transition=null;try{ht=4,zd(e,t,r,n)}finally{ht=i,va.transition=s}}function zd(e,t,r,n){if(Vc){var i=Eh(e,t,r,n);if(i===null)Tf(e,t,n,$c,r),Ng(e,n);else if(C2(i,e,t,r,n))n.stopPropagation();else if(Ng(e,n),t&4&&-1<k2.indexOf(e)){for(;i!==null;){var s=Al(i);if(s!==null&&Zx(s),s=Eh(e,t,r,n),s===null&&Tf(e,t,n,$c,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Tf(e,t,n,null,r)}}var $c=null;function Eh(e,t,r,n){if($c=null,e=Ld(n),e=os(e),e!==null)if(t=Ds(e),t===null)e=null;else if(r=t.tag,r===13){if(e=$x(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return $c=e,null}function iv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(p2()){case Bd:return 1;case qx:return 4;case zc:case m2:return 16;case Kx:return 536870912;default:return 16}default:return 16}}var bi=null,Hd=null,Ac=null;function sv(){if(Ac)return Ac;var e,t=Hd,r=t.length,n,i="value"in bi?bi.value:bi.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var l=r-e;for(n=1;n<=l&&t[r-n]===i[s-n];n++);return Ac=i.slice(e,1<n?1-n:void 0)}function Oc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Jl(){return!0}function Pg(){return!1}function Kr(e){function t(r,n,i,s,l){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Jl:Pg,this.isPropagationStopped=Pg,this}return Ft(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Jl)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Jl)},persist:function(){},isPersistent:Jl}),t}var za={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vd=Kr(za),El=Ft({},za,{view:0,detail:0}),O2=Kr(El),xf,vf,ro,Fu=Ft({},El,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$d,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ro&&(ro&&e.type==="mousemove"?(xf=e.screenX-ro.screenX,vf=e.screenY-ro.screenY):vf=xf=0,ro=e),xf)},movementY:function(e){return"movementY"in e?e.movementY:vf}}),Dg=Kr(Fu),N2=Ft({},Fu,{dataTransfer:0}),F2=Kr(N2),P2=Ft({},El,{relatedTarget:0}),yf=Kr(P2),D2=Ft({},za,{animationName:0,elapsedTime:0,pseudoElement:0}),j2=Kr(D2),R2=Ft({},za,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),I2=Kr(R2),M2=Ft({},za,{data:0}),jg=Kr(M2),L2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},B2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},U2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function W2(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=U2[e])?!!t[e]:!1}function $d(){return W2}var z2=Ft({},El,{key:function(e){if(e.key){var t=L2[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Oc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?B2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$d,charCode:function(e){return e.type==="keypress"?Oc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Oc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),H2=Kr(z2),V2=Ft({},Fu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rg=Kr(V2),$2=Ft({},El,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$d}),X2=Kr($2),Y2=Ft({},za,{propertyName:0,elapsedTime:0,pseudoElement:0}),G2=Kr(Y2),q2=Ft({},Fu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),K2=Kr(q2),J2=[9,13,27,32],Xd=ri&&"CompositionEvent"in window,wo=null;ri&&"documentMode"in document&&(wo=document.documentMode);var Q2=ri&&"TextEvent"in window&&!wo,av=ri&&(!Xd||wo&&8<wo&&11>=wo),Ig=" ",Mg=!1;function ov(e,t){switch(e){case"keyup":return J2.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lv(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var na=!1;function Z2(e,t){switch(e){case"compositionend":return lv(t);case"keypress":return t.which!==32?null:(Mg=!0,Ig);case"textInput":return e=t.data,e===Ig&&Mg?null:e;default:return null}}function eb(e,t){if(na)return e==="compositionend"||!Xd&&ov(e,t)?(e=sv(),Ac=Hd=bi=null,na=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return av&&t.locale!=="ko"?null:t.data;default:return null}}var tb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!tb[e.type]:t==="textarea"}function cv(e,t,r,n){Ux(n),t=Xc(t,"onChange"),0<t.length&&(r=new Vd("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var _o=null,Ho=null;function rb(e){wv(e,0)}function Pu(e){var t=aa(e);if(Dx(t))return e}function nb(e,t){if(e==="change")return t}var uv=!1;if(ri){var wf;if(ri){var _f="oninput"in document;if(!_f){var Bg=document.createElement("div");Bg.setAttribute("oninput","return;"),_f=typeof Bg.oninput=="function"}wf=_f}else wf=!1;uv=wf&&(!document.documentMode||9<document.documentMode)}function Ug(){_o&&(_o.detachEvent("onpropertychange",fv),Ho=_o=null)}function fv(e){if(e.propertyName==="value"&&Pu(Ho)){var t=[];cv(t,Ho,e,Ld(e)),Vx(rb,t)}}function ib(e,t,r){e==="focusin"?(Ug(),_o=t,Ho=r,_o.attachEvent("onpropertychange",fv)):e==="focusout"&&Ug()}function sb(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Pu(Ho)}function ab(e,t){if(e==="click")return Pu(t)}function ob(e,t){if(e==="input"||e==="change")return Pu(t)}function lb(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var En=typeof Object.is=="function"?Object.is:lb;function Vo(e,t){if(En(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!ch.call(t,i)||!En(e[i],t[i]))return!1}return!0}function Wg(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function zg(e,t){var r=Wg(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Wg(r)}}function hv(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?hv(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function dv(){for(var e=window,t=Bc();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Bc(e.document)}return t}function Yd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function cb(e){var t=dv(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&hv(r.ownerDocument.documentElement,r)){if(n!==null&&Yd(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=zg(r,s);var l=zg(r,n);i&&l&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ub=ri&&"documentMode"in document&&11>=document.documentMode,ia=null,Ah=null,bo=null,Oh=!1;function Hg(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Oh||ia==null||ia!==Bc(n)||(n=ia,"selectionStart"in n&&Yd(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),bo&&Vo(bo,n)||(bo=n,n=Xc(Ah,"onSelect"),0<n.length&&(t=new Vd("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=ia)))}function Ql(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var sa={animationend:Ql("Animation","AnimationEnd"),animationiteration:Ql("Animation","AnimationIteration"),animationstart:Ql("Animation","AnimationStart"),transitionend:Ql("Transition","TransitionEnd")},bf={},gv={};ri&&(gv=document.createElement("div").style,"AnimationEvent"in window||(delete sa.animationend.animation,delete sa.animationiteration.animation,delete sa.animationstart.animation),"TransitionEvent"in window||delete sa.transitionend.transition);function Du(e){if(bf[e])return bf[e];if(!sa[e])return e;var t=sa[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in gv)return bf[e]=t[r];return e}var pv=Du("animationend"),mv=Du("animationiteration"),xv=Du("animationstart"),vv=Du("transitionend"),yv=new Map,Vg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $i(e,t){yv.set(e,t),Ps(t,[e])}for(var Sf=0;Sf<Vg.length;Sf++){var kf=Vg[Sf],fb=kf.toLowerCase(),hb=kf[0].toUpperCase()+kf.slice(1);$i(fb,"on"+hb)}$i(pv,"onAnimationEnd");$i(mv,"onAnimationIteration");$i(xv,"onAnimationStart");$i("dblclick","onDoubleClick");$i("focusin","onFocus");$i("focusout","onBlur");$i(vv,"onTransitionEnd");Oa("onMouseEnter",["mouseout","mouseover"]);Oa("onMouseLeave",["mouseout","mouseover"]);Oa("onPointerEnter",["pointerout","pointerover"]);Oa("onPointerLeave",["pointerout","pointerover"]);Ps("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ps("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ps("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ps("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ps("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ps("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ho="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),db=new Set("cancel close invalid load scroll toggle".split(" ").concat(ho));function $g(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,f2(n,t,void 0,e),e.currentTarget=null}function wv(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var l=n.length-1;0<=l;l--){var o=n[l],a=o.instance,c=o.currentTarget;if(o=o.listener,a!==s&&i.isPropagationStopped())break e;$g(i,o,c),s=a}else for(l=0;l<n.length;l++){if(o=n[l],a=o.instance,c=o.currentTarget,o=o.listener,a!==s&&i.isPropagationStopped())break e;$g(i,o,c),s=a}}}if(Wc)throw e=kh,Wc=!1,kh=null,e}function xt(e,t){var r=t[jh];r===void 0&&(r=t[jh]=new Set);var n=e+"__bubble";r.has(n)||(_v(t,e,2,!1),r.add(n))}function Cf(e,t,r){var n=0;t&&(n|=4),_v(r,e,n,t)}var Zl="_reactListening"+Math.random().toString(36).slice(2);function $o(e){if(!e[Zl]){e[Zl]=!0,Ax.forEach(function(r){r!=="selectionchange"&&(db.has(r)||Cf(r,!1,e),Cf(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Zl]||(t[Zl]=!0,Cf("selectionchange",!1,t))}}function _v(e,t,r,n){switch(iv(t)){case 1:var i=E2;break;case 4:i=A2;break;default:i=zd}r=i.bind(null,t,r,e),i=void 0,!Sh||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Tf(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(l===4)for(l=n.return;l!==null;){var a=l.tag;if((a===3||a===4)&&(a=l.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;l=l.return}for(;o!==null;){if(l=os(o),l===null)return;if(a=l.tag,a===5||a===6){n=s=l;continue e}o=o.parentNode}}n=n.return}Vx(function(){var c=s,d=Ld(r),f=[];e:{var h=yv.get(e);if(h!==void 0){var u=Vd,g=e;switch(e){case"keypress":if(Oc(r)===0)break e;case"keydown":case"keyup":u=H2;break;case"focusin":g="focus",u=yf;break;case"focusout":g="blur",u=yf;break;case"beforeblur":case"afterblur":u=yf;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=Dg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=F2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=X2;break;case pv:case mv:case xv:u=j2;break;case vv:u=G2;break;case"scroll":u=O2;break;case"wheel":u=K2;break;case"copy":case"cut":case"paste":u=I2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=Rg}var m=(t&4)!==0,p=!m&&e==="scroll",x=m?h!==null?h+"Capture":null:h;m=[];for(var v=c,y;v!==null;){y=v;var _=y.stateNode;if(y.tag===5&&_!==null&&(y=_,x!==null&&(_=Bo(v,x),_!=null&&m.push(Xo(v,_,y)))),p)break;v=v.return}0<m.length&&(h=new u(h,g,null,r,d),f.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",u=e==="mouseout"||e==="pointerout",h&&r!==_h&&(g=r.relatedTarget||r.fromElement)&&(os(g)||g[ni]))break e;if((u||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,u?(g=r.relatedTarget||r.toElement,u=c,g=g?os(g):null,g!==null&&(p=Ds(g),g!==p||g.tag!==5&&g.tag!==6)&&(g=null)):(u=null,g=c),u!==g)){if(m=Dg,_="onMouseLeave",x="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(m=Rg,_="onPointerLeave",x="onPointerEnter",v="pointer"),p=u==null?h:aa(u),y=g==null?h:aa(g),h=new m(_,v+"leave",u,r,d),h.target=p,h.relatedTarget=y,_=null,os(d)===c&&(m=new m(x,v+"enter",g,r,d),m.target=y,m.relatedTarget=p,_=m),p=_,u&&g)t:{for(m=u,x=g,v=0,y=m;y;y=Us(y))v++;for(y=0,_=x;_;_=Us(_))y++;for(;0<v-y;)m=Us(m),v--;for(;0<y-v;)x=Us(x),y--;for(;v--;){if(m===x||x!==null&&m===x.alternate)break t;m=Us(m),x=Us(x)}m=null}else m=null;u!==null&&Xg(f,h,u,m,!1),g!==null&&p!==null&&Xg(f,p,g,m,!0)}}e:{if(h=c?aa(c):window,u=h.nodeName&&h.nodeName.toLowerCase(),u==="select"||u==="input"&&h.type==="file")var b=nb;else if(Lg(h))if(uv)b=ob;else{b=sb;var S=ib}else(u=h.nodeName)&&u.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(b=ab);if(b&&(b=b(e,c))){cv(f,b,r,d);break e}S&&S(e,h,c),e==="focusout"&&(S=h._wrapperState)&&S.controlled&&h.type==="number"&&mh(h,"number",h.value)}switch(S=c?aa(c):window,e){case"focusin":(Lg(S)||S.contentEditable==="true")&&(ia=S,Ah=c,bo=null);break;case"focusout":bo=Ah=ia=null;break;case"mousedown":Oh=!0;break;case"contextmenu":case"mouseup":case"dragend":Oh=!1,Hg(f,r,d);break;case"selectionchange":if(ub)break;case"keydown":case"keyup":Hg(f,r,d)}var C;if(Xd)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else na?ov(e,r)&&(N="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(N="onCompositionStart");N&&(av&&r.locale!=="ko"&&(na||N!=="onCompositionStart"?N==="onCompositionEnd"&&na&&(C=sv()):(bi=d,Hd="value"in bi?bi.value:bi.textContent,na=!0)),S=Xc(c,N),0<S.length&&(N=new jg(N,e,null,r,d),f.push({event:N,listeners:S}),C?N.data=C:(C=lv(r),C!==null&&(N.data=C)))),(C=Q2?Z2(e,r):eb(e,r))&&(c=Xc(c,"onBeforeInput"),0<c.length&&(d=new jg("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:c}),d.data=C))}wv(f,t)})}function Xo(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Xc(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Bo(e,r),s!=null&&n.unshift(Xo(e,s,i)),s=Bo(e,t),s!=null&&n.push(Xo(e,s,i))),e=e.return}return n}function Us(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Xg(e,t,r,n,i){for(var s=t._reactName,l=[];r!==null&&r!==n;){var o=r,a=o.alternate,c=o.stateNode;if(a!==null&&a===n)break;o.tag===5&&c!==null&&(o=c,i?(a=Bo(r,s),a!=null&&l.unshift(Xo(r,a,o))):i||(a=Bo(r,s),a!=null&&l.push(Xo(r,a,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var gb=/\r\n?/g,pb=/\u0000|\uFFFD/g;function Yg(e){return(typeof e=="string"?e:""+e).replace(gb,`
`).replace(pb,"")}function ec(e,t,r){if(t=Yg(t),Yg(e)!==t&&r)throw Error(ke(425))}function Yc(){}var Nh=null,Fh=null;function Ph(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Dh=typeof setTimeout=="function"?setTimeout:void 0,mb=typeof clearTimeout=="function"?clearTimeout:void 0,Gg=typeof Promise=="function"?Promise:void 0,xb=typeof queueMicrotask=="function"?queueMicrotask:typeof Gg<"u"?function(e){return Gg.resolve(null).then(e).catch(vb)}:Dh;function vb(e){setTimeout(function(){throw e})}function Ef(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),zo(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);zo(t)}function Oi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function qg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ha=Math.random().toString(36).slice(2),jn="__reactFiber$"+Ha,Yo="__reactProps$"+Ha,ni="__reactContainer$"+Ha,jh="__reactEvents$"+Ha,yb="__reactListeners$"+Ha,wb="__reactHandles$"+Ha;function os(e){var t=e[jn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ni]||r[jn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=qg(e);e!==null;){if(r=e[jn])return r;e=qg(e)}return t}e=r,r=e.parentNode}return null}function Al(e){return e=e[jn]||e[ni],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function aa(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ke(33))}function ju(e){return e[Yo]||null}var Rh=[],oa=-1;function Xi(e){return{current:e}}function yt(e){0>oa||(e.current=Rh[oa],Rh[oa]=null,oa--)}function mt(e,t){oa++,Rh[oa]=e.current,e.current=t}var Li={},wr=Xi(Li),Dr=Xi(!1),ws=Li;function Na(e,t){var r=e.type.contextTypes;if(!r)return Li;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function jr(e){return e=e.childContextTypes,e!=null}function Gc(){yt(Dr),yt(wr)}function Kg(e,t,r){if(wr.current!==Li)throw Error(ke(168));mt(wr,t),mt(Dr,r)}function bv(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(ke(108,i2(e)||"Unknown",i));return Ft({},r,n)}function qc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Li,ws=wr.current,mt(wr,e),mt(Dr,Dr.current),!0}function Jg(e,t,r){var n=e.stateNode;if(!n)throw Error(ke(169));r?(e=bv(e,t,ws),n.__reactInternalMemoizedMergedChildContext=e,yt(Dr),yt(wr),mt(wr,e)):yt(Dr),mt(Dr,r)}var Xn=null,Ru=!1,Af=!1;function Sv(e){Xn===null?Xn=[e]:Xn.push(e)}function _b(e){Ru=!0,Sv(e)}function Yi(){if(!Af&&Xn!==null){Af=!0;var e=0,t=ht;try{var r=Xn;for(ht=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Xn=null,Ru=!1}catch(i){throw Xn!==null&&(Xn=Xn.slice(e+1)),Gx(Bd,Yi),i}finally{ht=t,Af=!1}}return null}var la=[],ca=0,Kc=null,Jc=0,nn=[],sn=0,_s=null,Yn=1,Gn="";function es(e,t){la[ca++]=Jc,la[ca++]=Kc,Kc=e,Jc=t}function kv(e,t,r){nn[sn++]=Yn,nn[sn++]=Gn,nn[sn++]=_s,_s=e;var n=Yn;e=Gn;var i=32-Sn(n)-1;n&=~(1<<i),r+=1;var s=32-Sn(t)+i;if(30<s){var l=i-i%5;s=(n&(1<<l)-1).toString(32),n>>=l,i-=l,Yn=1<<32-Sn(t)+i|r<<i|n,Gn=s+e}else Yn=1<<s|r<<i|n,Gn=e}function Gd(e){e.return!==null&&(es(e,1),kv(e,1,0))}function qd(e){for(;e===Kc;)Kc=la[--ca],la[ca]=null,Jc=la[--ca],la[ca]=null;for(;e===_s;)_s=nn[--sn],nn[sn]=null,Gn=nn[--sn],nn[sn]=null,Yn=nn[--sn],nn[sn]=null}var Xr=null,$r=null,St=!1,wn=null;function Cv(e,t){var r=an(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Qg(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Xr=e,$r=Oi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Xr=e,$r=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=_s!==null?{id:Yn,overflow:Gn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=an(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Xr=e,$r=null,!0):!1;default:return!1}}function Ih(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Mh(e){if(St){var t=$r;if(t){var r=t;if(!Qg(e,t)){if(Ih(e))throw Error(ke(418));t=Oi(r.nextSibling);var n=Xr;t&&Qg(e,t)?Cv(n,r):(e.flags=e.flags&-4097|2,St=!1,Xr=e)}}else{if(Ih(e))throw Error(ke(418));e.flags=e.flags&-4097|2,St=!1,Xr=e}}}function Zg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Xr=e}function tc(e){if(e!==Xr)return!1;if(!St)return Zg(e),St=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ph(e.type,e.memoizedProps)),t&&(t=$r)){if(Ih(e))throw Tv(),Error(ke(418));for(;t;)Cv(e,t),t=Oi(t.nextSibling)}if(Zg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ke(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){$r=Oi(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}$r=null}}else $r=Xr?Oi(e.stateNode.nextSibling):null;return!0}function Tv(){for(var e=$r;e;)e=Oi(e.nextSibling)}function Fa(){$r=Xr=null,St=!1}function Kd(e){wn===null?wn=[e]:wn.push(e)}var bb=oi.ReactCurrentBatchConfig;function no(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ke(309));var n=r.stateNode}if(!n)throw Error(ke(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(l){var o=i.refs;l===null?delete o[s]:o[s]=l},t._stringRef=s,t)}if(typeof e!="string")throw Error(ke(284));if(!r._owner)throw Error(ke(290,e))}return e}function rc(e,t){throw e=Object.prototype.toString.call(t),Error(ke(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ep(e){var t=e._init;return t(e._payload)}function Ev(e){function t(x,v){if(e){var y=x.deletions;y===null?(x.deletions=[v],x.flags|=16):y.push(v)}}function r(x,v){if(!e)return null;for(;v!==null;)t(x,v),v=v.sibling;return null}function n(x,v){for(x=new Map;v!==null;)v.key!==null?x.set(v.key,v):x.set(v.index,v),v=v.sibling;return x}function i(x,v){return x=Di(x,v),x.index=0,x.sibling=null,x}function s(x,v,y){return x.index=y,e?(y=x.alternate,y!==null?(y=y.index,y<v?(x.flags|=2,v):y):(x.flags|=2,v)):(x.flags|=1048576,v)}function l(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,v,y,_){return v===null||v.tag!==6?(v=Rf(y,x.mode,_),v.return=x,v):(v=i(v,y),v.return=x,v)}function a(x,v,y,_){var b=y.type;return b===ra?d(x,v,y.props.children,_,y.key):v!==null&&(v.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===mi&&ep(b)===v.type)?(_=i(v,y.props),_.ref=no(x,v,y),_.return=x,_):(_=Ic(y.type,y.key,y.props,null,x.mode,_),_.ref=no(x,v,y),_.return=x,_)}function c(x,v,y,_){return v===null||v.tag!==4||v.stateNode.containerInfo!==y.containerInfo||v.stateNode.implementation!==y.implementation?(v=If(y,x.mode,_),v.return=x,v):(v=i(v,y.children||[]),v.return=x,v)}function d(x,v,y,_,b){return v===null||v.tag!==7?(v=gs(y,x.mode,_,b),v.return=x,v):(v=i(v,y),v.return=x,v)}function f(x,v,y){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Rf(""+v,x.mode,y),v.return=x,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case $l:return y=Ic(v.type,v.key,v.props,null,x.mode,y),y.ref=no(x,null,v),y.return=x,y;case ta:return v=If(v,x.mode,y),v.return=x,v;case mi:var _=v._init;return f(x,_(v._payload),y)}if(uo(v)||Qa(v))return v=gs(v,x.mode,y,null),v.return=x,v;rc(x,v)}return null}function h(x,v,y,_){var b=v!==null?v.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return b!==null?null:o(x,v,""+y,_);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case $l:return y.key===b?a(x,v,y,_):null;case ta:return y.key===b?c(x,v,y,_):null;case mi:return b=y._init,h(x,v,b(y._payload),_)}if(uo(y)||Qa(y))return b!==null?null:d(x,v,y,_,null);rc(x,y)}return null}function u(x,v,y,_,b){if(typeof _=="string"&&_!==""||typeof _=="number")return x=x.get(y)||null,o(v,x,""+_,b);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case $l:return x=x.get(_.key===null?y:_.key)||null,a(v,x,_,b);case ta:return x=x.get(_.key===null?y:_.key)||null,c(v,x,_,b);case mi:var S=_._init;return u(x,v,y,S(_._payload),b)}if(uo(_)||Qa(_))return x=x.get(y)||null,d(v,x,_,b,null);rc(v,_)}return null}function g(x,v,y,_){for(var b=null,S=null,C=v,N=v=0,F=null;C!==null&&N<y.length;N++){C.index>N?(F=C,C=null):F=C.sibling;var Y=h(x,C,y[N],_);if(Y===null){C===null&&(C=F);break}e&&C&&Y.alternate===null&&t(x,C),v=s(Y,v,N),S===null?b=Y:S.sibling=Y,S=Y,C=F}if(N===y.length)return r(x,C),St&&es(x,N),b;if(C===null){for(;N<y.length;N++)C=f(x,y[N],_),C!==null&&(v=s(C,v,N),S===null?b=C:S.sibling=C,S=C);return St&&es(x,N),b}for(C=n(x,C);N<y.length;N++)F=u(C,x,N,y[N],_),F!==null&&(e&&F.alternate!==null&&C.delete(F.key===null?N:F.key),v=s(F,v,N),S===null?b=F:S.sibling=F,S=F);return e&&C.forEach(function(X){return t(x,X)}),St&&es(x,N),b}function m(x,v,y,_){var b=Qa(y);if(typeof b!="function")throw Error(ke(150));if(y=b.call(y),y==null)throw Error(ke(151));for(var S=b=null,C=v,N=v=0,F=null,Y=y.next();C!==null&&!Y.done;N++,Y=y.next()){C.index>N?(F=C,C=null):F=C.sibling;var X=h(x,C,Y.value,_);if(X===null){C===null&&(C=F);break}e&&C&&X.alternate===null&&t(x,C),v=s(X,v,N),S===null?b=X:S.sibling=X,S=X,C=F}if(Y.done)return r(x,C),St&&es(x,N),b;if(C===null){for(;!Y.done;N++,Y=y.next())Y=f(x,Y.value,_),Y!==null&&(v=s(Y,v,N),S===null?b=Y:S.sibling=Y,S=Y);return St&&es(x,N),b}for(C=n(x,C);!Y.done;N++,Y=y.next())Y=u(C,x,N,Y.value,_),Y!==null&&(e&&Y.alternate!==null&&C.delete(Y.key===null?N:Y.key),v=s(Y,v,N),S===null?b=Y:S.sibling=Y,S=Y);return e&&C.forEach(function(V){return t(x,V)}),St&&es(x,N),b}function p(x,v,y,_){if(typeof y=="object"&&y!==null&&y.type===ra&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case $l:e:{for(var b=y.key,S=v;S!==null;){if(S.key===b){if(b=y.type,b===ra){if(S.tag===7){r(x,S.sibling),v=i(S,y.props.children),v.return=x,x=v;break e}}else if(S.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===mi&&ep(b)===S.type){r(x,S.sibling),v=i(S,y.props),v.ref=no(x,S,y),v.return=x,x=v;break e}r(x,S);break}else t(x,S);S=S.sibling}y.type===ra?(v=gs(y.props.children,x.mode,_,y.key),v.return=x,x=v):(_=Ic(y.type,y.key,y.props,null,x.mode,_),_.ref=no(x,v,y),_.return=x,x=_)}return l(x);case ta:e:{for(S=y.key;v!==null;){if(v.key===S)if(v.tag===4&&v.stateNode.containerInfo===y.containerInfo&&v.stateNode.implementation===y.implementation){r(x,v.sibling),v=i(v,y.children||[]),v.return=x,x=v;break e}else{r(x,v);break}else t(x,v);v=v.sibling}v=If(y,x.mode,_),v.return=x,x=v}return l(x);case mi:return S=y._init,p(x,v,S(y._payload),_)}if(uo(y))return g(x,v,y,_);if(Qa(y))return m(x,v,y,_);rc(x,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,v!==null&&v.tag===6?(r(x,v.sibling),v=i(v,y),v.return=x,x=v):(r(x,v),v=Rf(y,x.mode,_),v.return=x,x=v),l(x)):r(x,v)}return p}var Pa=Ev(!0),Av=Ev(!1),Qc=Xi(null),Zc=null,ua=null,Jd=null;function Qd(){Jd=ua=Zc=null}function Zd(e){var t=Qc.current;yt(Qc),e._currentValue=t}function Lh(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ya(e,t){Zc=e,Jd=ua=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Pr=!0),e.firstContext=null)}function un(e){var t=e._currentValue;if(Jd!==e)if(e={context:e,memoizedValue:t,next:null},ua===null){if(Zc===null)throw Error(ke(308));ua=e,Zc.dependencies={lanes:0,firstContext:e}}else ua=ua.next=e;return t}var ls=null;function e0(e){ls===null?ls=[e]:ls.push(e)}function Ov(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,e0(t)):(r.next=i.next,i.next=r),t.interleaved=r,ii(e,n)}function ii(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var xi=!1;function t0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Nv(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Jn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ni(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,rt&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,ii(e,r)}return i=n.interleaved,i===null?(t.next=t,e0(n)):(t.next=i.next,i.next=t),n.interleaved=t,ii(e,r)}function Nc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Ud(e,r)}}function tp(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=l:s=s.next=l,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function eu(e,t,r,n){var i=e.updateQueue;xi=!1;var s=i.firstBaseUpdate,l=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var a=o,c=a.next;a.next=null,l===null?s=c:l.next=c,l=a;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==l&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=a))}if(s!==null){var f=i.baseState;l=0,d=c=a=null,o=s;do{var h=o.lane,u=o.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:u,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,m=o;switch(h=t,u=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){f=g.call(u,f,h);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,h=typeof g=="function"?g.call(u,f,h):g,h==null)break e;f=Ft({},f,h);break e;case 2:xi=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else u={eventTime:u,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=u,a=f):d=d.next=u,l|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(d===null&&(a=f),i.baseState=a,i.firstBaseUpdate=c,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do l|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Ss|=l,e.lanes=l,e.memoizedState=f}}function rp(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(ke(191,i));i.call(n)}}}var Ol={},Bn=Xi(Ol),Go=Xi(Ol),qo=Xi(Ol);function cs(e){if(e===Ol)throw Error(ke(174));return e}function r0(e,t){switch(mt(qo,t),mt(Go,e),mt(Bn,Ol),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:vh(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=vh(t,e)}yt(Bn),mt(Bn,t)}function Da(){yt(Bn),yt(Go),yt(qo)}function Fv(e){cs(qo.current);var t=cs(Bn.current),r=vh(t,e.type);t!==r&&(mt(Go,e),mt(Bn,r))}function n0(e){Go.current===e&&(yt(Bn),yt(Go))}var Tt=Xi(0);function tu(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Of=[];function i0(){for(var e=0;e<Of.length;e++)Of[e]._workInProgressVersionPrimary=null;Of.length=0}var Fc=oi.ReactCurrentDispatcher,Nf=oi.ReactCurrentBatchConfig,bs=0,Nt=null,Yt=null,Qt=null,ru=!1,So=!1,Ko=0,Sb=0;function fr(){throw Error(ke(321))}function s0(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!En(e[r],t[r]))return!1;return!0}function a0(e,t,r,n,i,s){if(bs=s,Nt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Fc.current=e===null||e.memoizedState===null?Eb:Ab,e=r(n,i),So){s=0;do{if(So=!1,Ko=0,25<=s)throw Error(ke(301));s+=1,Qt=Yt=null,t.updateQueue=null,Fc.current=Ob,e=r(n,i)}while(So)}if(Fc.current=nu,t=Yt!==null&&Yt.next!==null,bs=0,Qt=Yt=Nt=null,ru=!1,t)throw Error(ke(300));return e}function o0(){var e=Ko!==0;return Ko=0,e}function Dn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qt===null?Nt.memoizedState=Qt=e:Qt=Qt.next=e,Qt}function fn(){if(Yt===null){var e=Nt.alternate;e=e!==null?e.memoizedState:null}else e=Yt.next;var t=Qt===null?Nt.memoizedState:Qt.next;if(t!==null)Qt=t,Yt=e;else{if(e===null)throw Error(ke(310));Yt=e,e={memoizedState:Yt.memoizedState,baseState:Yt.baseState,baseQueue:Yt.baseQueue,queue:Yt.queue,next:null},Qt===null?Nt.memoizedState=Qt=e:Qt=Qt.next=e}return Qt}function Jo(e,t){return typeof t=="function"?t(e):t}function Ff(e){var t=fn(),r=t.queue;if(r===null)throw Error(ke(311));r.lastRenderedReducer=e;var n=Yt,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var l=i.next;i.next=s.next,s.next=l}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=l=null,a=null,c=s;do{var d=c.lane;if((bs&d)===d)a!==null&&(a=a.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var f={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};a===null?(o=a=f,l=n):a=a.next=f,Nt.lanes|=d,Ss|=d}c=c.next}while(c!==null&&c!==s);a===null?l=n:a.next=o,En(n,t.memoizedState)||(Pr=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=a,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,Nt.lanes|=s,Ss|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Pf(e){var t=fn(),r=t.queue;if(r===null)throw Error(ke(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var l=i=i.next;do s=e(s,l.action),l=l.next;while(l!==i);En(s,t.memoizedState)||(Pr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function Pv(){}function Dv(e,t){var r=Nt,n=fn(),i=t(),s=!En(n.memoizedState,i);if(s&&(n.memoizedState=i,Pr=!0),n=n.queue,l0(Iv.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Qt!==null&&Qt.memoizedState.tag&1){if(r.flags|=2048,Qo(9,Rv.bind(null,r,n,i,t),void 0,null),tr===null)throw Error(ke(349));bs&30||jv(r,t,i)}return i}function jv(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Nt.updateQueue,t===null?(t={lastEffect:null,stores:null},Nt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Rv(e,t,r,n){t.value=r,t.getSnapshot=n,Mv(t)&&Lv(e)}function Iv(e,t,r){return r(function(){Mv(t)&&Lv(e)})}function Mv(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!En(e,r)}catch{return!0}}function Lv(e){var t=ii(e,1);t!==null&&kn(t,e,1,-1)}function np(e){var t=Dn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Jo,lastRenderedState:e},t.queue=e,e=e.dispatch=Tb.bind(null,Nt,e),[t.memoizedState,e]}function Qo(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Nt.updateQueue,t===null?(t={lastEffect:null,stores:null},Nt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Bv(){return fn().memoizedState}function Pc(e,t,r,n){var i=Dn();Nt.flags|=e,i.memoizedState=Qo(1|t,r,void 0,n===void 0?null:n)}function Iu(e,t,r,n){var i=fn();n=n===void 0?null:n;var s=void 0;if(Yt!==null){var l=Yt.memoizedState;if(s=l.destroy,n!==null&&s0(n,l.deps)){i.memoizedState=Qo(t,r,s,n);return}}Nt.flags|=e,i.memoizedState=Qo(1|t,r,s,n)}function ip(e,t){return Pc(8390656,8,e,t)}function l0(e,t){return Iu(2048,8,e,t)}function Uv(e,t){return Iu(4,2,e,t)}function Wv(e,t){return Iu(4,4,e,t)}function zv(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Hv(e,t,r){return r=r!=null?r.concat([e]):null,Iu(4,4,zv.bind(null,t,e),r)}function c0(){}function Vv(e,t){var r=fn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&s0(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function $v(e,t){var r=fn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&s0(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Xv(e,t,r){return bs&21?(En(r,t)||(r=Jx(),Nt.lanes|=r,Ss|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Pr=!0),e.memoizedState=r)}function kb(e,t){var r=ht;ht=r!==0&&4>r?r:4,e(!0);var n=Nf.transition;Nf.transition={};try{e(!1),t()}finally{ht=r,Nf.transition=n}}function Yv(){return fn().memoizedState}function Cb(e,t,r){var n=Pi(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Gv(e))qv(t,r);else if(r=Ov(e,t,r,n),r!==null){var i=Tr();kn(r,e,n,i),Kv(r,t,n)}}function Tb(e,t,r){var n=Pi(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Gv(e))qv(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var l=t.lastRenderedState,o=s(l,r);if(i.hasEagerState=!0,i.eagerState=o,En(o,l)){var a=t.interleaved;a===null?(i.next=i,e0(t)):(i.next=a.next,a.next=i),t.interleaved=i;return}}catch{}finally{}r=Ov(e,t,i,n),r!==null&&(i=Tr(),kn(r,e,n,i),Kv(r,t,n))}}function Gv(e){var t=e.alternate;return e===Nt||t!==null&&t===Nt}function qv(e,t){So=ru=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Kv(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Ud(e,r)}}var nu={readContext:un,useCallback:fr,useContext:fr,useEffect:fr,useImperativeHandle:fr,useInsertionEffect:fr,useLayoutEffect:fr,useMemo:fr,useReducer:fr,useRef:fr,useState:fr,useDebugValue:fr,useDeferredValue:fr,useTransition:fr,useMutableSource:fr,useSyncExternalStore:fr,useId:fr,unstable_isNewReconciler:!1},Eb={readContext:un,useCallback:function(e,t){return Dn().memoizedState=[e,t===void 0?null:t],e},useContext:un,useEffect:ip,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Pc(4194308,4,zv.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Pc(4194308,4,e,t)},useInsertionEffect:function(e,t){return Pc(4,2,e,t)},useMemo:function(e,t){var r=Dn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Dn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Cb.bind(null,Nt,e),[n.memoizedState,e]},useRef:function(e){var t=Dn();return e={current:e},t.memoizedState=e},useState:np,useDebugValue:c0,useDeferredValue:function(e){return Dn().memoizedState=e},useTransition:function(){var e=np(!1),t=e[0];return e=kb.bind(null,e[1]),Dn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Nt,i=Dn();if(St){if(r===void 0)throw Error(ke(407));r=r()}else{if(r=t(),tr===null)throw Error(ke(349));bs&30||jv(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,ip(Iv.bind(null,n,s,e),[e]),n.flags|=2048,Qo(9,Rv.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Dn(),t=tr.identifierPrefix;if(St){var r=Gn,n=Yn;r=(n&~(1<<32-Sn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ko++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Sb++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Ab={readContext:un,useCallback:Vv,useContext:un,useEffect:l0,useImperativeHandle:Hv,useInsertionEffect:Uv,useLayoutEffect:Wv,useMemo:$v,useReducer:Ff,useRef:Bv,useState:function(){return Ff(Jo)},useDebugValue:c0,useDeferredValue:function(e){var t=fn();return Xv(t,Yt.memoizedState,e)},useTransition:function(){var e=Ff(Jo)[0],t=fn().memoizedState;return[e,t]},useMutableSource:Pv,useSyncExternalStore:Dv,useId:Yv,unstable_isNewReconciler:!1},Ob={readContext:un,useCallback:Vv,useContext:un,useEffect:l0,useImperativeHandle:Hv,useInsertionEffect:Uv,useLayoutEffect:Wv,useMemo:$v,useReducer:Pf,useRef:Bv,useState:function(){return Pf(Jo)},useDebugValue:c0,useDeferredValue:function(e){var t=fn();return Yt===null?t.memoizedState=e:Xv(t,Yt.memoizedState,e)},useTransition:function(){var e=Pf(Jo)[0],t=fn().memoizedState;return[e,t]},useMutableSource:Pv,useSyncExternalStore:Dv,useId:Yv,unstable_isNewReconciler:!1};function xn(e,t){if(e&&e.defaultProps){t=Ft({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Bh(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ft({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Mu={isMounted:function(e){return(e=e._reactInternals)?Ds(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Tr(),i=Pi(e),s=Jn(n,i);s.payload=t,r!=null&&(s.callback=r),t=Ni(e,s,i),t!==null&&(kn(t,e,i,n),Nc(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Tr(),i=Pi(e),s=Jn(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Ni(e,s,i),t!==null&&(kn(t,e,i,n),Nc(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Tr(),n=Pi(e),i=Jn(r,n);i.tag=2,t!=null&&(i.callback=t),t=Ni(e,i,n),t!==null&&(kn(t,e,n,r),Nc(t,e,n))}};function sp(e,t,r,n,i,s,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,l):t.prototype&&t.prototype.isPureReactComponent?!Vo(r,n)||!Vo(i,s):!0}function Jv(e,t,r){var n=!1,i=Li,s=t.contextType;return typeof s=="object"&&s!==null?s=un(s):(i=jr(t)?ws:wr.current,n=t.contextTypes,s=(n=n!=null)?Na(e,i):Li),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Mu,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function ap(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Mu.enqueueReplaceState(t,t.state,null)}function Uh(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},t0(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=un(s):(s=jr(t)?ws:wr.current,i.context=Na(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Bh(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Mu.enqueueReplaceState(i,i.state,null),eu(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function ja(e,t){try{var r="",n=t;do r+=n2(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Df(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Wh(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Nb=typeof WeakMap=="function"?WeakMap:Map;function Qv(e,t,r){r=Jn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){su||(su=!0,Jh=n),Wh(e,t)},r}function Zv(e,t,r){r=Jn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Wh(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Wh(e,t),typeof n!="function"&&(Fi===null?Fi=new Set([this]):Fi.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function op(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Nb;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=Vb.bind(null,e,t,r),t.then(e,e))}function lp(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function cp(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Jn(-1,1),t.tag=2,Ni(r,t,1))),r.lanes|=1),e)}var Fb=oi.ReactCurrentOwner,Pr=!1;function Sr(e,t,r,n){t.child=e===null?Av(t,null,r,n):Pa(t,e.child,r,n)}function up(e,t,r,n,i){r=r.render;var s=t.ref;return ya(t,i),n=a0(e,t,r,n,s,i),r=o0(),e!==null&&!Pr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,si(e,t,i)):(St&&r&&Gd(t),t.flags|=1,Sr(e,t,n,i),t.child)}function fp(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!x0(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,e1(e,t,s,n,i)):(e=Ic(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var l=s.memoizedProps;if(r=r.compare,r=r!==null?r:Vo,r(l,n)&&e.ref===t.ref)return si(e,t,i)}return t.flags|=1,e=Di(s,n),e.ref=t.ref,e.return=t,t.child=e}function e1(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(Vo(s,n)&&e.ref===t.ref)if(Pr=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(Pr=!0);else return t.lanes=e.lanes,si(e,t,i)}return zh(e,t,r,n,i)}function t1(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},mt(ha,Ur),Ur|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,mt(ha,Ur),Ur|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,mt(ha,Ur),Ur|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,mt(ha,Ur),Ur|=n;return Sr(e,t,i,r),t.child}function r1(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function zh(e,t,r,n,i){var s=jr(r)?ws:wr.current;return s=Na(t,s),ya(t,i),r=a0(e,t,r,n,s,i),n=o0(),e!==null&&!Pr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,si(e,t,i)):(St&&n&&Gd(t),t.flags|=1,Sr(e,t,r,i),t.child)}function hp(e,t,r,n,i){if(jr(r)){var s=!0;qc(t)}else s=!1;if(ya(t,i),t.stateNode===null)Dc(e,t),Jv(t,r,n),Uh(t,r,n,i),n=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var a=l.context,c=r.contextType;typeof c=="object"&&c!==null?c=un(c):(c=jr(r)?ws:wr.current,c=Na(t,c));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof l.getSnapshotBeforeUpdate=="function";f||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||a!==c)&&ap(t,l,n,c),xi=!1;var h=t.memoizedState;l.state=h,eu(t,n,l,i),a=t.memoizedState,o!==n||h!==a||Dr.current||xi?(typeof d=="function"&&(Bh(t,r,d,n),a=t.memoizedState),(o=xi||sp(t,r,o,n,h,a,c))?(f||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=a),l.props=n,l.state=a,l.context=c,n=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,Nv(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:xn(t.type,o),l.props=c,f=t.pendingProps,h=l.context,a=r.contextType,typeof a=="object"&&a!==null?a=un(a):(a=jr(r)?ws:wr.current,a=Na(t,a));var u=r.getDerivedStateFromProps;(d=typeof u=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==f||h!==a)&&ap(t,l,n,a),xi=!1,h=t.memoizedState,l.state=h,eu(t,n,l,i);var g=t.memoizedState;o!==f||h!==g||Dr.current||xi?(typeof u=="function"&&(Bh(t,r,u,n),g=t.memoizedState),(c=xi||sp(t,r,c,n,h,g,a)||!1)?(d||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,g,a),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,g,a)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),l.props=n,l.state=g,l.context=a,n=c):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Hh(e,t,r,n,s,i)}function Hh(e,t,r,n,i,s){r1(e,t);var l=(t.flags&128)!==0;if(!n&&!l)return i&&Jg(t,r,!1),si(e,t,s);n=t.stateNode,Fb.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&l?(t.child=Pa(t,e.child,null,s),t.child=Pa(t,null,o,s)):Sr(e,t,o,s),t.memoizedState=n.state,i&&Jg(t,r,!0),t.child}function n1(e){var t=e.stateNode;t.pendingContext?Kg(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Kg(e,t.context,!1),r0(e,t.containerInfo)}function dp(e,t,r,n,i){return Fa(),Kd(i),t.flags|=256,Sr(e,t,r,n),t.child}var Vh={dehydrated:null,treeContext:null,retryLane:0};function $h(e){return{baseLanes:e,cachePool:null,transitions:null}}function i1(e,t,r){var n=t.pendingProps,i=Tt.current,s=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),mt(Tt,i&1),e===null)return Mh(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=n.children,e=n.fallback,s?(n=t.mode,s=t.child,l={mode:"hidden",children:l},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=l):s=Uu(l,n,0,null),e=gs(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=$h(r),t.memoizedState=Vh,e):u0(t,l));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return Pb(e,t,l,n,o,i,r);if(s){s=n.fallback,l=t.mode,i=e.child,o=i.sibling;var a={mode:"hidden",children:n.children};return!(l&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=a,t.deletions=null):(n=Di(i,a),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Di(o,s):(s=gs(s,l,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,l=e.child.memoizedState,l=l===null?$h(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~r,t.memoizedState=Vh,n}return s=e.child,e=s.sibling,n=Di(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function u0(e,t){return t=Uu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function nc(e,t,r,n){return n!==null&&Kd(n),Pa(t,e.child,null,r),e=u0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Pb(e,t,r,n,i,s,l){if(r)return t.flags&256?(t.flags&=-257,n=Df(Error(ke(422))),nc(e,t,l,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=Uu({mode:"visible",children:n.children},i,0,null),s=gs(s,i,l,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Pa(t,e.child,null,l),t.child.memoizedState=$h(l),t.memoizedState=Vh,s);if(!(t.mode&1))return nc(e,t,l,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(ke(419)),n=Df(s,n,void 0),nc(e,t,l,n)}if(o=(l&e.childLanes)!==0,Pr||o){if(n=tr,n!==null){switch(l&-l){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|l)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ii(e,i),kn(n,e,i,-1))}return m0(),n=Df(Error(ke(421))),nc(e,t,l,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=$b.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,$r=Oi(i.nextSibling),Xr=t,St=!0,wn=null,e!==null&&(nn[sn++]=Yn,nn[sn++]=Gn,nn[sn++]=_s,Yn=e.id,Gn=e.overflow,_s=t),t=u0(t,n.children),t.flags|=4096,t)}function gp(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Lh(e.return,t,r)}function jf(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function s1(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Sr(e,t,n.children,r),n=Tt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&gp(e,r,t);else if(e.tag===19)gp(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(mt(Tt,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&tu(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),jf(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&tu(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}jf(t,!0,r,null,s);break;case"together":jf(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Dc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function si(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ss|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ke(153));if(t.child!==null){for(e=t.child,r=Di(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Di(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Db(e,t,r){switch(t.tag){case 3:n1(t),Fa();break;case 5:Fv(t);break;case 1:jr(t.type)&&qc(t);break;case 4:r0(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;mt(Qc,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(mt(Tt,Tt.current&1),t.flags|=128,null):r&t.child.childLanes?i1(e,t,r):(mt(Tt,Tt.current&1),e=si(e,t,r),e!==null?e.sibling:null);mt(Tt,Tt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return s1(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),mt(Tt,Tt.current),n)break;return null;case 22:case 23:return t.lanes=0,t1(e,t,r)}return si(e,t,r)}var a1,Xh,o1,l1;a1=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Xh=function(){};o1=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,cs(Bn.current);var s=null;switch(r){case"input":i=gh(e,i),n=gh(e,n),s=[];break;case"select":i=Ft({},i,{value:void 0}),n=Ft({},n,{value:void 0}),s=[];break;case"textarea":i=xh(e,i),n=xh(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Yc)}yh(r,n);var l;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Mo.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var a=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&a!==o&&(a!=null||o!=null))if(c==="style")if(o){for(l in o)!o.hasOwnProperty(l)||a&&a.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in a)a.hasOwnProperty(l)&&o[l]!==a[l]&&(r||(r={}),r[l]=a[l])}else r||(s||(s=[]),s.push(c,r)),r=a;else c==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,o=o?o.__html:void 0,a!=null&&o!==a&&(s=s||[]).push(c,a)):c==="children"?typeof a!="string"&&typeof a!="number"||(s=s||[]).push(c,""+a):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Mo.hasOwnProperty(c)?(a!=null&&c==="onScroll"&&xt("scroll",e),s||o===a||(s=[])):(s=s||[]).push(c,a))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};l1=function(e,t,r,n){r!==n&&(t.flags|=4)};function io(e,t){if(!St)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function hr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function jb(e,t,r){var n=t.pendingProps;switch(qd(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hr(t),null;case 1:return jr(t.type)&&Gc(),hr(t),null;case 3:return n=t.stateNode,Da(),yt(Dr),yt(wr),i0(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(tc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,wn!==null&&(ed(wn),wn=null))),Xh(e,t),hr(t),null;case 5:n0(t);var i=cs(qo.current);if(r=t.type,e!==null&&t.stateNode!=null)o1(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ke(166));return hr(t),null}if(e=cs(Bn.current),tc(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[jn]=t,n[Yo]=s,e=(t.mode&1)!==0,r){case"dialog":xt("cancel",n),xt("close",n);break;case"iframe":case"object":case"embed":xt("load",n);break;case"video":case"audio":for(i=0;i<ho.length;i++)xt(ho[i],n);break;case"source":xt("error",n);break;case"img":case"image":case"link":xt("error",n),xt("load",n);break;case"details":xt("toggle",n);break;case"input":Sg(n,s),xt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},xt("invalid",n);break;case"textarea":Cg(n,s),xt("invalid",n)}yh(r,s),i=null;for(var l in s)if(s.hasOwnProperty(l)){var o=s[l];l==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&ec(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&ec(n.textContent,o,e),i=["children",""+o]):Mo.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&xt("scroll",n)}switch(r){case"input":Xl(n),kg(n,s,!0);break;case"textarea":Xl(n),Tg(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Yc)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{l=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Ix(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),r==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[jn]=t,e[Yo]=n,a1(e,t,!1,!1),t.stateNode=e;e:{switch(l=wh(r,n),r){case"dialog":xt("cancel",e),xt("close",e),i=n;break;case"iframe":case"object":case"embed":xt("load",e),i=n;break;case"video":case"audio":for(i=0;i<ho.length;i++)xt(ho[i],e);i=n;break;case"source":xt("error",e),i=n;break;case"img":case"image":case"link":xt("error",e),xt("load",e),i=n;break;case"details":xt("toggle",e),i=n;break;case"input":Sg(e,n),i=gh(e,n),xt("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Ft({},n,{value:void 0}),xt("invalid",e);break;case"textarea":Cg(e,n),i=xh(e,n),xt("invalid",e);break;default:i=n}yh(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="style"?Bx(e,a):s==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&Mx(e,a)):s==="children"?typeof a=="string"?(r!=="textarea"||a!=="")&&Lo(e,a):typeof a=="number"&&Lo(e,""+a):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Mo.hasOwnProperty(s)?a!=null&&s==="onScroll"&&xt("scroll",e):a!=null&&jd(e,s,a,l))}switch(r){case"input":Xl(e),kg(e,n,!1);break;case"textarea":Xl(e),Tg(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Mi(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?pa(e,!!n.multiple,s,!1):n.defaultValue!=null&&pa(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Yc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return hr(t),null;case 6:if(e&&t.stateNode!=null)l1(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ke(166));if(r=cs(qo.current),cs(Bn.current),tc(t)){if(n=t.stateNode,r=t.memoizedProps,n[jn]=t,(s=n.nodeValue!==r)&&(e=Xr,e!==null))switch(e.tag){case 3:ec(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ec(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[jn]=t,t.stateNode=n}return hr(t),null;case 13:if(yt(Tt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(St&&$r!==null&&t.mode&1&&!(t.flags&128))Tv(),Fa(),t.flags|=98560,s=!1;else if(s=tc(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(ke(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ke(317));s[jn]=t}else Fa(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;hr(t),s=!1}else wn!==null&&(ed(wn),wn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Tt.current&1?qt===0&&(qt=3):m0())),t.updateQueue!==null&&(t.flags|=4),hr(t),null);case 4:return Da(),Xh(e,t),e===null&&$o(t.stateNode.containerInfo),hr(t),null;case 10:return Zd(t.type._context),hr(t),null;case 17:return jr(t.type)&&Gc(),hr(t),null;case 19:if(yt(Tt),s=t.memoizedState,s===null)return hr(t),null;if(n=(t.flags&128)!==0,l=s.rendering,l===null)if(n)io(s,!1);else{if(qt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=tu(e),l!==null){for(t.flags|=128,io(s,!1),n=l.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,l=s.alternate,l===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return mt(Tt,Tt.current&1|2),t.child}e=e.sibling}s.tail!==null&&Lt()>Ra&&(t.flags|=128,n=!0,io(s,!1),t.lanes=4194304)}else{if(!n)if(e=tu(l),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),io(s,!0),s.tail===null&&s.tailMode==="hidden"&&!l.alternate&&!St)return hr(t),null}else 2*Lt()-s.renderingStartTime>Ra&&r!==1073741824&&(t.flags|=128,n=!0,io(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(r=s.last,r!==null?r.sibling=l:t.child=l,s.last=l)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Lt(),t.sibling=null,r=Tt.current,mt(Tt,n?r&1|2:r&1),t):(hr(t),null);case 22:case 23:return p0(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Ur&1073741824&&(hr(t),t.subtreeFlags&6&&(t.flags|=8192)):hr(t),null;case 24:return null;case 25:return null}throw Error(ke(156,t.tag))}function Rb(e,t){switch(qd(t),t.tag){case 1:return jr(t.type)&&Gc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Da(),yt(Dr),yt(wr),i0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return n0(t),null;case 13:if(yt(Tt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ke(340));Fa()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return yt(Tt),null;case 4:return Da(),null;case 10:return Zd(t.type._context),null;case 22:case 23:return p0(),null;case 24:return null;default:return null}}var ic=!1,mr=!1,Ib=typeof WeakSet=="function"?WeakSet:Set,Pe=null;function fa(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Dt(e,t,n)}else r.current=null}function Yh(e,t,r){try{r()}catch(n){Dt(e,t,n)}}var pp=!1;function Mb(e,t){if(Nh=Vc,e=dv(),Yd(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var l=0,o=-1,a=-1,c=0,d=0,f=e,h=null;t:for(;;){for(var u;f!==r||i!==0&&f.nodeType!==3||(o=l+i),f!==s||n!==0&&f.nodeType!==3||(a=l+n),f.nodeType===3&&(l+=f.nodeValue.length),(u=f.firstChild)!==null;)h=f,f=u;for(;;){if(f===e)break t;if(h===r&&++c===i&&(o=l),h===s&&++d===n&&(a=l),(u=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=u}r=o===-1||a===-1?null:{start:o,end:a}}else r=null}r=r||{start:0,end:0}}else r=null;for(Fh={focusedElem:e,selectionRange:r},Vc=!1,Pe=t;Pe!==null;)if(t=Pe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Pe=e;else for(;Pe!==null;){t=Pe;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,p=g.memoizedState,x=t.stateNode,v=x.getSnapshotBeforeUpdate(t.elementType===t.type?m:xn(t.type,m),p);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ke(163))}}catch(_){Dt(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,Pe=e;break}Pe=t.return}return g=pp,pp=!1,g}function ko(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&Yh(t,r,s)}i=i.next}while(i!==n)}}function Lu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Gh(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function c1(e){var t=e.alternate;t!==null&&(e.alternate=null,c1(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[jn],delete t[Yo],delete t[jh],delete t[yb],delete t[wb])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function u1(e){return e.tag===5||e.tag===3||e.tag===4}function mp(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||u1(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function qh(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Yc));else if(n!==4&&(e=e.child,e!==null))for(qh(e,t,r),e=e.sibling;e!==null;)qh(e,t,r),e=e.sibling}function Kh(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Kh(e,t,r),e=e.sibling;e!==null;)Kh(e,t,r),e=e.sibling}var sr=null,vn=!1;function di(e,t,r){for(r=r.child;r!==null;)f1(e,t,r),r=r.sibling}function f1(e,t,r){if(Ln&&typeof Ln.onCommitFiberUnmount=="function")try{Ln.onCommitFiberUnmount(Nu,r)}catch{}switch(r.tag){case 5:mr||fa(r,t);case 6:var n=sr,i=vn;sr=null,di(e,t,r),sr=n,vn=i,sr!==null&&(vn?(e=sr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):sr.removeChild(r.stateNode));break;case 18:sr!==null&&(vn?(e=sr,r=r.stateNode,e.nodeType===8?Ef(e.parentNode,r):e.nodeType===1&&Ef(e,r),zo(e)):Ef(sr,r.stateNode));break;case 4:n=sr,i=vn,sr=r.stateNode.containerInfo,vn=!0,di(e,t,r),sr=n,vn=i;break;case 0:case 11:case 14:case 15:if(!mr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,l=s.destroy;s=s.tag,l!==void 0&&(s&2||s&4)&&Yh(r,t,l),i=i.next}while(i!==n)}di(e,t,r);break;case 1:if(!mr&&(fa(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Dt(r,t,o)}di(e,t,r);break;case 21:di(e,t,r);break;case 22:r.mode&1?(mr=(n=mr)||r.memoizedState!==null,di(e,t,r),mr=n):di(e,t,r);break;default:di(e,t,r)}}function xp(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Ib),t.forEach(function(n){var i=Xb.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function gn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:sr=o.stateNode,vn=!1;break e;case 3:sr=o.stateNode.containerInfo,vn=!0;break e;case 4:sr=o.stateNode.containerInfo,vn=!0;break e}o=o.return}if(sr===null)throw Error(ke(160));f1(s,l,i),sr=null,vn=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(c){Dt(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)h1(t,e),t=t.sibling}function h1(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gn(t,e),On(e),n&4){try{ko(3,e,e.return),Lu(3,e)}catch(m){Dt(e,e.return,m)}try{ko(5,e,e.return)}catch(m){Dt(e,e.return,m)}}break;case 1:gn(t,e),On(e),n&512&&r!==null&&fa(r,r.return);break;case 5:if(gn(t,e),On(e),n&512&&r!==null&&fa(r,r.return),e.flags&32){var i=e.stateNode;try{Lo(i,"")}catch(m){Dt(e,e.return,m)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,l=r!==null?r.memoizedProps:s,o=e.type,a=e.updateQueue;if(e.updateQueue=null,a!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&jx(i,s),wh(o,l);var c=wh(o,s);for(l=0;l<a.length;l+=2){var d=a[l],f=a[l+1];d==="style"?Bx(i,f):d==="dangerouslySetInnerHTML"?Mx(i,f):d==="children"?Lo(i,f):jd(i,d,f,c)}switch(o){case"input":ph(i,s);break;case"textarea":Rx(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var u=s.value;u!=null?pa(i,!!s.multiple,u,!1):h!==!!s.multiple&&(s.defaultValue!=null?pa(i,!!s.multiple,s.defaultValue,!0):pa(i,!!s.multiple,s.multiple?[]:"",!1))}i[Yo]=s}catch(m){Dt(e,e.return,m)}}break;case 6:if(gn(t,e),On(e),n&4){if(e.stateNode===null)throw Error(ke(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(m){Dt(e,e.return,m)}}break;case 3:if(gn(t,e),On(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{zo(t.containerInfo)}catch(m){Dt(e,e.return,m)}break;case 4:gn(t,e),On(e);break;case 13:gn(t,e),On(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(d0=Lt())),n&4&&xp(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(mr=(c=mr)||d,gn(t,e),mr=c):gn(t,e),On(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!d&&e.mode&1)for(Pe=e,d=e.child;d!==null;){for(f=Pe=d;Pe!==null;){switch(h=Pe,u=h.child,h.tag){case 0:case 11:case 14:case 15:ko(4,h,h.return);break;case 1:fa(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Dt(n,r,m)}}break;case 5:fa(h,h.return);break;case 22:if(h.memoizedState!==null){yp(f);continue}}u!==null?(u.return=h,Pe=u):yp(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=f.stateNode,a=f.memoizedProps.style,l=a!=null&&a.hasOwnProperty("display")?a.display:null,o.style.display=Lx("display",l))}catch(m){Dt(e,e.return,m)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(m){Dt(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:gn(t,e),On(e),n&4&&xp(e);break;case 21:break;default:gn(t,e),On(e)}}function On(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(u1(r)){var n=r;break e}r=r.return}throw Error(ke(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Lo(i,""),n.flags&=-33);var s=mp(e);Kh(e,s,i);break;case 3:case 4:var l=n.stateNode.containerInfo,o=mp(e);qh(e,o,l);break;default:throw Error(ke(161))}}catch(a){Dt(e,e.return,a)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Lb(e,t,r){Pe=e,d1(e)}function d1(e,t,r){for(var n=(e.mode&1)!==0;Pe!==null;){var i=Pe,s=i.child;if(i.tag===22&&n){var l=i.memoizedState!==null||ic;if(!l){var o=i.alternate,a=o!==null&&o.memoizedState!==null||mr;o=ic;var c=mr;if(ic=l,(mr=a)&&!c)for(Pe=i;Pe!==null;)l=Pe,a=l.child,l.tag===22&&l.memoizedState!==null?wp(i):a!==null?(a.return=l,Pe=a):wp(i);for(;s!==null;)Pe=s,d1(s),s=s.sibling;Pe=i,ic=o,mr=c}vp(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Pe=s):vp(e)}}function vp(e){for(;Pe!==null;){var t=Pe;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:mr||Lu(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!mr)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:xn(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&rp(t,s,n);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}rp(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var a=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&r.focus();break;case"img":a.src&&(r.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&zo(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ke(163))}mr||t.flags&512&&Gh(t)}catch(h){Dt(t,t.return,h)}}if(t===e){Pe=null;break}if(r=t.sibling,r!==null){r.return=t.return,Pe=r;break}Pe=t.return}}function yp(e){for(;Pe!==null;){var t=Pe;if(t===e){Pe=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Pe=r;break}Pe=t.return}}function wp(e){for(;Pe!==null;){var t=Pe;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Lu(4,t)}catch(a){Dt(t,r,a)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(a){Dt(t,i,a)}}var s=t.return;try{Gh(t)}catch(a){Dt(t,s,a)}break;case 5:var l=t.return;try{Gh(t)}catch(a){Dt(t,l,a)}}}catch(a){Dt(t,t.return,a)}if(t===e){Pe=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Pe=o;break}Pe=t.return}}var Bb=Math.ceil,iu=oi.ReactCurrentDispatcher,f0=oi.ReactCurrentOwner,on=oi.ReactCurrentBatchConfig,rt=0,tr=null,$t=null,lr=0,Ur=0,ha=Xi(0),qt=0,Zo=null,Ss=0,Bu=0,h0=0,Co=null,Fr=null,d0=0,Ra=1/0,Vn=null,su=!1,Jh=null,Fi=null,sc=!1,Si=null,au=0,To=0,Qh=null,jc=-1,Rc=0;function Tr(){return rt&6?Lt():jc!==-1?jc:jc=Lt()}function Pi(e){return e.mode&1?rt&2&&lr!==0?lr&-lr:bb.transition!==null?(Rc===0&&(Rc=Jx()),Rc):(e=ht,e!==0||(e=window.event,e=e===void 0?16:iv(e.type)),e):1}function kn(e,t,r,n){if(50<To)throw To=0,Qh=null,Error(ke(185));Tl(e,r,n),(!(rt&2)||e!==tr)&&(e===tr&&(!(rt&2)&&(Bu|=r),qt===4&&wi(e,lr)),Rr(e,n),r===1&&rt===0&&!(t.mode&1)&&(Ra=Lt()+500,Ru&&Yi()))}function Rr(e,t){var r=e.callbackNode;b2(e,t);var n=Hc(e,e===tr?lr:0);if(n===0)r!==null&&Og(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Og(r),t===1)e.tag===0?_b(_p.bind(null,e)):Sv(_p.bind(null,e)),xb(function(){!(rt&6)&&Yi()}),r=null;else{switch(Qx(n)){case 1:r=Bd;break;case 4:r=qx;break;case 16:r=zc;break;case 536870912:r=Kx;break;default:r=zc}r=_1(r,g1.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function g1(e,t){if(jc=-1,Rc=0,rt&6)throw Error(ke(327));var r=e.callbackNode;if(wa()&&e.callbackNode!==r)return null;var n=Hc(e,e===tr?lr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=ou(e,n);else{t=n;var i=rt;rt|=2;var s=m1();(tr!==e||lr!==t)&&(Vn=null,Ra=Lt()+500,ds(e,t));do try{zb();break}catch(o){p1(e,o)}while(!0);Qd(),iu.current=s,rt=i,$t!==null?t=0:(tr=null,lr=0,t=qt)}if(t!==0){if(t===2&&(i=Ch(e),i!==0&&(n=i,t=Zh(e,i))),t===1)throw r=Zo,ds(e,0),wi(e,n),Rr(e,Lt()),r;if(t===6)wi(e,n);else{if(i=e.current.alternate,!(n&30)&&!Ub(i)&&(t=ou(e,n),t===2&&(s=Ch(e),s!==0&&(n=s,t=Zh(e,s))),t===1))throw r=Zo,ds(e,0),wi(e,n),Rr(e,Lt()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(ke(345));case 2:ts(e,Fr,Vn);break;case 3:if(wi(e,n),(n&130023424)===n&&(t=d0+500-Lt(),10<t)){if(Hc(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Tr(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Dh(ts.bind(null,e,Fr,Vn),t);break}ts(e,Fr,Vn);break;case 4:if(wi(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var l=31-Sn(n);s=1<<l,l=t[l],l>i&&(i=l),n&=~s}if(n=i,n=Lt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Bb(n/1960))-n,10<n){e.timeoutHandle=Dh(ts.bind(null,e,Fr,Vn),n);break}ts(e,Fr,Vn);break;case 5:ts(e,Fr,Vn);break;default:throw Error(ke(329))}}}return Rr(e,Lt()),e.callbackNode===r?g1.bind(null,e):null}function Zh(e,t){var r=Co;return e.current.memoizedState.isDehydrated&&(ds(e,t).flags|=256),e=ou(e,t),e!==2&&(t=Fr,Fr=r,t!==null&&ed(t)),e}function ed(e){Fr===null?Fr=e:Fr.push.apply(Fr,e)}function Ub(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!En(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function wi(e,t){for(t&=~h0,t&=~Bu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Sn(t),n=1<<r;e[r]=-1,t&=~n}}function _p(e){if(rt&6)throw Error(ke(327));wa();var t=Hc(e,0);if(!(t&1))return Rr(e,Lt()),null;var r=ou(e,t);if(e.tag!==0&&r===2){var n=Ch(e);n!==0&&(t=n,r=Zh(e,n))}if(r===1)throw r=Zo,ds(e,0),wi(e,t),Rr(e,Lt()),r;if(r===6)throw Error(ke(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ts(e,Fr,Vn),Rr(e,Lt()),null}function g0(e,t){var r=rt;rt|=1;try{return e(t)}finally{rt=r,rt===0&&(Ra=Lt()+500,Ru&&Yi())}}function ks(e){Si!==null&&Si.tag===0&&!(rt&6)&&wa();var t=rt;rt|=1;var r=on.transition,n=ht;try{if(on.transition=null,ht=1,e)return e()}finally{ht=n,on.transition=r,rt=t,!(rt&6)&&Yi()}}function p0(){Ur=ha.current,yt(ha)}function ds(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,mb(r)),$t!==null)for(r=$t.return;r!==null;){var n=r;switch(qd(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Gc();break;case 3:Da(),yt(Dr),yt(wr),i0();break;case 5:n0(n);break;case 4:Da();break;case 13:yt(Tt);break;case 19:yt(Tt);break;case 10:Zd(n.type._context);break;case 22:case 23:p0()}r=r.return}if(tr=e,$t=e=Di(e.current,null),lr=Ur=t,qt=0,Zo=null,h0=Bu=Ss=0,Fr=Co=null,ls!==null){for(t=0;t<ls.length;t++)if(r=ls[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var l=s.next;s.next=i,n.next=l}r.pending=n}ls=null}return e}function p1(e,t){do{var r=$t;try{if(Qd(),Fc.current=nu,ru){for(var n=Nt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}ru=!1}if(bs=0,Qt=Yt=Nt=null,So=!1,Ko=0,f0.current=null,r===null||r.return===null){qt=1,Zo=t,$t=null;break}e:{var s=e,l=r.return,o=r,a=t;if(t=lr,o.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var c=a,d=o,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var u=lp(l);if(u!==null){u.flags&=-257,cp(u,l,o,s,t),u.mode&1&&op(s,c,t),t=u,a=c;var g=t.updateQueue;if(g===null){var m=new Set;m.add(a),t.updateQueue=m}else g.add(a);break e}else{if(!(t&1)){op(s,c,t),m0();break e}a=Error(ke(426))}}else if(St&&o.mode&1){var p=lp(l);if(p!==null){!(p.flags&65536)&&(p.flags|=256),cp(p,l,o,s,t),Kd(ja(a,o));break e}}s=a=ja(a,o),qt!==4&&(qt=2),Co===null?Co=[s]:Co.push(s),s=l;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var x=Qv(s,a,t);tp(s,x);break e;case 1:o=a;var v=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Fi===null||!Fi.has(y)))){s.flags|=65536,t&=-t,s.lanes|=t;var _=Zv(s,o,t);tp(s,_);break e}}s=s.return}while(s!==null)}v1(r)}catch(b){t=b,$t===r&&r!==null&&($t=r=r.return);continue}break}while(!0)}function m1(){var e=iu.current;return iu.current=nu,e===null?nu:e}function m0(){(qt===0||qt===3||qt===2)&&(qt=4),tr===null||!(Ss&268435455)&&!(Bu&268435455)||wi(tr,lr)}function ou(e,t){var r=rt;rt|=2;var n=m1();(tr!==e||lr!==t)&&(Vn=null,ds(e,t));do try{Wb();break}catch(i){p1(e,i)}while(!0);if(Qd(),rt=r,iu.current=n,$t!==null)throw Error(ke(261));return tr=null,lr=0,qt}function Wb(){for(;$t!==null;)x1($t)}function zb(){for(;$t!==null&&!d2();)x1($t)}function x1(e){var t=w1(e.alternate,e,Ur);e.memoizedProps=e.pendingProps,t===null?v1(e):$t=t,f0.current=null}function v1(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Rb(r,t),r!==null){r.flags&=32767,$t=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{qt=6,$t=null;return}}else if(r=jb(r,t,Ur),r!==null){$t=r;return}if(t=t.sibling,t!==null){$t=t;return}$t=t=e}while(t!==null);qt===0&&(qt=5)}function ts(e,t,r){var n=ht,i=on.transition;try{on.transition=null,ht=1,Hb(e,t,r,n)}finally{on.transition=i,ht=n}return null}function Hb(e,t,r,n){do wa();while(Si!==null);if(rt&6)throw Error(ke(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ke(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(S2(e,s),e===tr&&($t=tr=null,lr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||sc||(sc=!0,_1(zc,function(){return wa(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=on.transition,on.transition=null;var l=ht;ht=1;var o=rt;rt|=4,f0.current=null,Mb(e,r),h1(r,e),cb(Fh),Vc=!!Nh,Fh=Nh=null,e.current=r,Lb(r),g2(),rt=o,ht=l,on.transition=s}else e.current=r;if(sc&&(sc=!1,Si=e,au=i),s=e.pendingLanes,s===0&&(Fi=null),x2(r.stateNode),Rr(e,Lt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(su)throw su=!1,e=Jh,Jh=null,e;return au&1&&e.tag!==0&&wa(),s=e.pendingLanes,s&1?e===Qh?To++:(To=0,Qh=e):To=0,Yi(),null}function wa(){if(Si!==null){var e=Qx(au),t=on.transition,r=ht;try{if(on.transition=null,ht=16>e?16:e,Si===null)var n=!1;else{if(e=Si,Si=null,au=0,rt&6)throw Error(ke(331));var i=rt;for(rt|=4,Pe=e.current;Pe!==null;){var s=Pe,l=s.child;if(Pe.flags&16){var o=s.deletions;if(o!==null){for(var a=0;a<o.length;a++){var c=o[a];for(Pe=c;Pe!==null;){var d=Pe;switch(d.tag){case 0:case 11:case 15:ko(8,d,s)}var f=d.child;if(f!==null)f.return=d,Pe=f;else for(;Pe!==null;){d=Pe;var h=d.sibling,u=d.return;if(c1(d),d===c){Pe=null;break}if(h!==null){h.return=u,Pe=h;break}Pe=u}}}var g=s.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var p=m.sibling;m.sibling=null,m=p}while(m!==null)}}Pe=s}}if(s.subtreeFlags&2064&&l!==null)l.return=s,Pe=l;else e:for(;Pe!==null;){if(s=Pe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ko(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,Pe=x;break e}Pe=s.return}}var v=e.current;for(Pe=v;Pe!==null;){l=Pe;var y=l.child;if(l.subtreeFlags&2064&&y!==null)y.return=l,Pe=y;else e:for(l=v;Pe!==null;){if(o=Pe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Lu(9,o)}}catch(b){Dt(o,o.return,b)}if(o===l){Pe=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,Pe=_;break e}Pe=o.return}}if(rt=i,Yi(),Ln&&typeof Ln.onPostCommitFiberRoot=="function")try{Ln.onPostCommitFiberRoot(Nu,e)}catch{}n=!0}return n}finally{ht=r,on.transition=t}}return!1}function bp(e,t,r){t=ja(r,t),t=Qv(e,t,1),e=Ni(e,t,1),t=Tr(),e!==null&&(Tl(e,1,t),Rr(e,t))}function Dt(e,t,r){if(e.tag===3)bp(e,e,r);else for(;t!==null;){if(t.tag===3){bp(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Fi===null||!Fi.has(n))){e=ja(r,e),e=Zv(t,e,1),t=Ni(t,e,1),e=Tr(),t!==null&&(Tl(t,1,e),Rr(t,e));break}}t=t.return}}function Vb(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Tr(),e.pingedLanes|=e.suspendedLanes&r,tr===e&&(lr&r)===r&&(qt===4||qt===3&&(lr&130023424)===lr&&500>Lt()-d0?ds(e,0):h0|=r),Rr(e,t)}function y1(e,t){t===0&&(e.mode&1?(t=ql,ql<<=1,!(ql&130023424)&&(ql=4194304)):t=1);var r=Tr();e=ii(e,t),e!==null&&(Tl(e,t,r),Rr(e,r))}function $b(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),y1(e,r)}function Xb(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ke(314))}n!==null&&n.delete(t),y1(e,r)}var w1;w1=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Dr.current)Pr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Pr=!1,Db(e,t,r);Pr=!!(e.flags&131072)}else Pr=!1,St&&t.flags&1048576&&kv(t,Jc,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Dc(e,t),e=t.pendingProps;var i=Na(t,wr.current);ya(t,r),i=a0(null,t,n,e,i,r);var s=o0();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,jr(n)?(s=!0,qc(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,t0(t),i.updater=Mu,t.stateNode=i,i._reactInternals=t,Uh(t,n,e,r),t=Hh(null,t,n,!0,s,r)):(t.tag=0,St&&s&&Gd(t),Sr(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Dc(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=Gb(n),e=xn(n,e),i){case 0:t=zh(null,t,n,e,r);break e;case 1:t=hp(null,t,n,e,r);break e;case 11:t=up(null,t,n,e,r);break e;case 14:t=fp(null,t,n,xn(n.type,e),r);break e}throw Error(ke(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:xn(n,i),zh(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:xn(n,i),hp(e,t,n,i,r);case 3:e:{if(n1(t),e===null)throw Error(ke(387));n=t.pendingProps,s=t.memoizedState,i=s.element,Nv(e,t),eu(t,n,null,r);var l=t.memoizedState;if(n=l.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=ja(Error(ke(423)),t),t=dp(e,t,n,r,i);break e}else if(n!==i){i=ja(Error(ke(424)),t),t=dp(e,t,n,r,i);break e}else for($r=Oi(t.stateNode.containerInfo.firstChild),Xr=t,St=!0,wn=null,r=Av(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Fa(),n===i){t=si(e,t,r);break e}Sr(e,t,n,r)}t=t.child}return t;case 5:return Fv(t),e===null&&Mh(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,l=i.children,Ph(n,i)?l=null:s!==null&&Ph(n,s)&&(t.flags|=32),r1(e,t),Sr(e,t,l,r),t.child;case 6:return e===null&&Mh(t),null;case 13:return i1(e,t,r);case 4:return r0(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Pa(t,null,n,r):Sr(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:xn(n,i),up(e,t,n,i,r);case 7:return Sr(e,t,t.pendingProps,r),t.child;case 8:return Sr(e,t,t.pendingProps.children,r),t.child;case 12:return Sr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,l=i.value,mt(Qc,n._currentValue),n._currentValue=l,s!==null)if(En(s.value,l)){if(s.children===i.children&&!Dr.current){t=si(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){l=s.child;for(var a=o.firstContext;a!==null;){if(a.context===n){if(s.tag===1){a=Jn(-1,r&-r),a.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?a.next=a:(a.next=d.next,d.next=a),c.pending=a}}s.lanes|=r,a=s.alternate,a!==null&&(a.lanes|=r),Lh(s.return,r,t),o.lanes|=r;break}a=a.next}}else if(s.tag===10)l=s.type===t.type?null:s.child;else if(s.tag===18){if(l=s.return,l===null)throw Error(ke(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),Lh(l,r,t),l=s.sibling}else l=s.child;if(l!==null)l.return=s;else for(l=s;l!==null;){if(l===t){l=null;break}if(s=l.sibling,s!==null){s.return=l.return,l=s;break}l=l.return}s=l}Sr(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,ya(t,r),i=un(i),n=n(i),t.flags|=1,Sr(e,t,n,r),t.child;case 14:return n=t.type,i=xn(n,t.pendingProps),i=xn(n.type,i),fp(e,t,n,i,r);case 15:return e1(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:xn(n,i),Dc(e,t),t.tag=1,jr(n)?(e=!0,qc(t)):e=!1,ya(t,r),Jv(t,n,i),Uh(t,n,i,r),Hh(null,t,n,!0,e,r);case 19:return s1(e,t,r);case 22:return t1(e,t,r)}throw Error(ke(156,t.tag))};function _1(e,t){return Gx(e,t)}function Yb(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function an(e,t,r,n){return new Yb(e,t,r,n)}function x0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Gb(e){if(typeof e=="function")return x0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Id)return 11;if(e===Md)return 14}return 2}function Di(e,t){var r=e.alternate;return r===null?(r=an(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Ic(e,t,r,n,i,s){var l=2;if(n=e,typeof e=="function")x0(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case ra:return gs(r.children,i,s,t);case Rd:l=8,i|=8;break;case uh:return e=an(12,r,t,i|2),e.elementType=uh,e.lanes=s,e;case fh:return e=an(13,r,t,i),e.elementType=fh,e.lanes=s,e;case hh:return e=an(19,r,t,i),e.elementType=hh,e.lanes=s,e;case Fx:return Uu(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ox:l=10;break e;case Nx:l=9;break e;case Id:l=11;break e;case Md:l=14;break e;case mi:l=16,n=null;break e}throw Error(ke(130,e==null?e:typeof e,""))}return t=an(l,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function gs(e,t,r,n){return e=an(7,e,n,t),e.lanes=r,e}function Uu(e,t,r,n){return e=an(22,e,n,t),e.elementType=Fx,e.lanes=r,e.stateNode={isHidden:!1},e}function Rf(e,t,r){return e=an(6,e,null,t),e.lanes=r,e}function If(e,t,r){return t=an(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function qb(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mf(0),this.expirationTimes=mf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mf(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function v0(e,t,r,n,i,s,l,o,a){return e=new qb(e,t,r,o,a),t===1?(t=1,s===!0&&(t|=8)):t=0,s=an(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},t0(s),e}function Kb(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ta,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function b1(e){if(!e)return Li;e=e._reactInternals;e:{if(Ds(e)!==e||e.tag!==1)throw Error(ke(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(jr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ke(171))}if(e.tag===1){var r=e.type;if(jr(r))return bv(e,r,t)}return t}function S1(e,t,r,n,i,s,l,o,a){return e=v0(r,n,!0,e,i,s,l,o,a),e.context=b1(null),r=e.current,n=Tr(),i=Pi(r),s=Jn(n,i),s.callback=t??null,Ni(r,s,i),e.current.lanes=i,Tl(e,i,n),Rr(e,n),e}function Wu(e,t,r,n){var i=t.current,s=Tr(),l=Pi(i);return r=b1(r),t.context===null?t.context=r:t.pendingContext=r,t=Jn(s,l),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ni(i,t,l),e!==null&&(kn(e,i,l,s),Nc(e,i,l)),l}function lu(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Sp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function y0(e,t){Sp(e,t),(e=e.alternate)&&Sp(e,t)}function Jb(){return null}var k1=typeof reportError=="function"?reportError:function(e){console.error(e)};function w0(e){this._internalRoot=e}zu.prototype.render=w0.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ke(409));Wu(e,t,null,null)};zu.prototype.unmount=w0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ks(function(){Wu(null,e,null,null)}),t[ni]=null}};function zu(e){this._internalRoot=e}zu.prototype.unstable_scheduleHydration=function(e){if(e){var t=tv();e={blockedOn:null,target:e,priority:t};for(var r=0;r<yi.length&&t!==0&&t<yi[r].priority;r++);yi.splice(r,0,e),r===0&&nv(e)}};function _0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Hu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function kp(){}function Qb(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=lu(l);s.call(c)}}var l=S1(t,n,e,0,null,!1,!1,"",kp);return e._reactRootContainer=l,e[ni]=l.current,$o(e.nodeType===8?e.parentNode:e),ks(),l}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=lu(a);o.call(c)}}var a=v0(e,0,!1,null,null,!1,!1,"",kp);return e._reactRootContainer=a,e[ni]=a.current,$o(e.nodeType===8?e.parentNode:e),ks(function(){Wu(t,a,r,n)}),a}function Vu(e,t,r,n,i){var s=r._reactRootContainer;if(s){var l=s;if(typeof i=="function"){var o=i;i=function(){var a=lu(l);o.call(a)}}Wu(t,l,e,i)}else l=Qb(r,t,e,i,n);return lu(l)}Zx=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=fo(t.pendingLanes);r!==0&&(Ud(t,r|1),Rr(t,Lt()),!(rt&6)&&(Ra=Lt()+500,Yi()))}break;case 13:ks(function(){var n=ii(e,1);if(n!==null){var i=Tr();kn(n,e,1,i)}}),y0(e,1)}};Wd=function(e){if(e.tag===13){var t=ii(e,134217728);if(t!==null){var r=Tr();kn(t,e,134217728,r)}y0(e,134217728)}};ev=function(e){if(e.tag===13){var t=Pi(e),r=ii(e,t);if(r!==null){var n=Tr();kn(r,e,t,n)}y0(e,t)}};tv=function(){return ht};rv=function(e,t){var r=ht;try{return ht=e,t()}finally{ht=r}};bh=function(e,t,r){switch(t){case"input":if(ph(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=ju(n);if(!i)throw Error(ke(90));Dx(n),ph(n,i)}}}break;case"textarea":Rx(e,r);break;case"select":t=r.value,t!=null&&pa(e,!!r.multiple,t,!1)}};zx=g0;Hx=ks;var Zb={usingClientEntryPoint:!1,Events:[Al,aa,ju,Ux,Wx,g0]},so={findFiberByHostInstance:os,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},eS={bundleType:so.bundleType,version:so.version,rendererPackageName:so.rendererPackageName,rendererConfig:so.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:oi.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Xx(e),e===null?null:e.stateNode},findFiberByHostInstance:so.findFiberByHostInstance||Jb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ac=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ac.isDisabled&&ac.supportsFiber)try{Nu=ac.inject(eS),Ln=ac}catch{}}qr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Zb;qr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_0(t))throw Error(ke(200));return Kb(e,t,null,r)};qr.createRoot=function(e,t){if(!_0(e))throw Error(ke(299));var r=!1,n="",i=k1;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=v0(e,1,!1,null,null,r,!1,n,i),e[ni]=t.current,$o(e.nodeType===8?e.parentNode:e),new w0(t)};qr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ke(188)):(e=Object.keys(e).join(","),Error(ke(268,e)));return e=Xx(t),e=e===null?null:e.stateNode,e};qr.flushSync=function(e){return ks(e)};qr.hydrate=function(e,t,r){if(!Hu(t))throw Error(ke(200));return Vu(null,e,t,!0,r)};qr.hydrateRoot=function(e,t,r){if(!_0(e))throw Error(ke(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",l=k1;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=S1(t,null,e,1,r??null,i,!1,s,l),e[ni]=t.current,$o(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new zu(t)};qr.render=function(e,t,r){if(!Hu(t))throw Error(ke(200));return Vu(null,e,t,!1,r)};qr.unmountComponentAtNode=function(e){if(!Hu(e))throw Error(ke(40));return e._reactRootContainer?(ks(function(){Vu(null,null,e,!1,function(){e._reactRootContainer=null,e[ni]=null})}),!0):!1};qr.unstable_batchedUpdates=g0;qr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Hu(r))throw Error(ke(200));if(e==null||e._reactInternals===void 0)throw Error(ke(38));return Vu(e,t,r,!1,n)};qr.version="18.3.1-next-f1338f8080-20240426";function C1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(C1)}catch(e){console.error(e)}}C1(),Cx.exports=qr;var T1=Cx.exports,Cp=T1;lh.createRoot=Cp.createRoot,lh.hydrateRoot=Cp.hydrateRoot;/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E1=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tS=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rS=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tp=e=>{const t=rS(e);return t.charAt(0).toUpperCase()+t.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var nS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iS=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sS=le.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:l,...o},a)=>le.createElement("svg",{ref:a,...nS,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:E1("lucide",i),...!s&&!iS(o)&&{"aria-hidden":"true"},...o},[...l.map(([c,d])=>le.createElement(c,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=(e,t)=>{const r=le.forwardRef(({className:n,...i},s)=>le.createElement(sS,{ref:s,iconNode:t,className:E1(`lucide-${tS(Tp(e))}`,`lucide-${e}`,n),...i}));return r.displayName=Tp(e),r};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aS=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],oS=Ue("arrow-right",aS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lS=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],Mf=Ue("award",lS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cS=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],A1=Ue("book-open",cS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uS=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],fS=Ue("briefcase",uS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hS=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Nl=Ue("calendar",hS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dS=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Bi=Ue("check",dS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gS=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ep=Ue("chevron-down",gS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pS=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Ui=Ue("chevron-left",pS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mS=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ln=Ue("chevron-right",mS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xS=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Ap=Ue("chevron-up",xS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Qn=Ue("circle-alert",vS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],_a=Ue("circle-check",yS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],_S=Ue("circle-plus",wS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bS=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],SS=Ue("clipboard-check",bS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kS=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ia=Ue("clock",kS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CS=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],TS=Ue("download",CS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ES=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],AS=Ue("ellipsis",ES);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],NS=Ue("file-down",OS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FS=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],PS=Ue("graduation-cap",FS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DS=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],jS=Ue("grid-3x3",DS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RS=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],IS=Ue("hash",RS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MS=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],LS=Ue("house",MS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],O1=Ue("info",BS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const US=[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]],WS=Ue("layout-template",US);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zS=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Lf=Ue("loader-circle",zS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HS=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],VS=Ue("lock",HS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $S=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],$u=Ue("log-out",$S);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XS=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Cs=Ue("map-pin",XS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YS=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],cu=Ue("map",YS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GS=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],qS=Ue("menu",GS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KS=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],JS=Ue("navigation",KS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QS=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],ZS=Ue("palette",QS);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ek=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],uu=Ue("panels-top-left",ek);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tk=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],b0=Ue("pen-tool",tk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rk=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],nk=Ue("pen",rk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ik=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],td=Ue("phone",ik);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sk=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],el=Ue("plus",sk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ak=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Op=Ue("printer",ak);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ok=[["path",{d:"M20.34 17.52a10 10 0 1 0-2.82 2.82",key:"fydyku"}],["circle",{cx:"19",cy:"19",r:"2",key:"17f5cg"}],["path",{d:"m13.41 13.41 4.18 4.18",key:"1gqbwc"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],lk=Ue("radius",ok);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ck=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],uk=Ue("refresh-cw",ck);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fk=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],hk=Ue("rotate-cw",fk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dk=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],fu=Ue("save",dk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gk=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],pk=Ue("school",gk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mk=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],rd=Ue("search",mk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xk=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],nd=Ue("settings",xk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vk=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],S0=Ue("shield-check",vk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yk=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],wk=Ue("square-pen",yk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _k=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ji=Ue("trash-2",_k);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bk=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Sk=Ue("triangle-alert",bk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kk=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Ck=Ue("upload",kk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tk=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],tl=Ue("user",Tk);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ek=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Xu=Ue("users",Ek);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ak=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ba=Ue("x",Ak);var Ve={};const Ok={},Nk=Object.freeze(Object.defineProperty({__proto__:null,default:Ok},Symbol.toStringTag,{value:"Module"})),Bf=O_(Nk);(function(e){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var t=t||{version:"5.5.2"};if(e.fabric=t,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?t.document=document:t.document=document.implementation.createHTMLDocument(""),t.window=window;else{var r=Bf,n=new r.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;t.document=n.document,t.jsdomImplForWrapper=Bf.implForWrapper,t.nodeCanvas=Bf.Canvas,t.window=n,DOMParser=t.window.DOMParser}t.isTouchSupported="ontouchstart"in t.window||"ontouchstart"in t.document||t.window&&t.window.navigator&&t.window.navigator.maxTouchPoints>0,t.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",t.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],t.DPI=96,t.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",t.commaWsp="(?:\\s+,?\\s*|,\\s*)",t.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,t.reNonWord=/[ \n\.,;!\?\-]/,t.fontPaths={},t.iMatrix=[1,0,0,1,0,0],t.svgNS="http://www.w3.org/2000/svg",t.perfLimitSizeTotal=2097152,t.maxCacheSideLimit=4096,t.minCacheSideLimit=256,t.charWidthsCache={},t.textureSize=2048,t.disableStyleCopyPaste=!1,t.enableGLFiltering=!0,t.devicePixelRatio=t.window.devicePixelRatio||t.window.webkitDevicePixelRatio||t.window.mozDevicePixelRatio||1,t.browserShadowBlurConstant=1,t.arcToSegmentsCache={},t.boundsOfCurveCache={},t.cachesBoundsOfCurve=!0,t.forceGLPutImageData=!1,t.initFilterBackend=function(){if(t.enableGLFiltering&&t.isWebglSupported&&t.isWebglSupported(t.textureSize))return console.log("max texture size: "+t.maxTextureSize),new t.WebglFilterBackend({tileSize:t.textureSize});if(t.Canvas2dFilterBackend)return new t.Canvas2dFilterBackend},typeof document<"u"&&typeof window<"u"&&(window.fabric=t),function(){function o(u,g){if(this.__eventListeners[u]){var m=this.__eventListeners[u];g?m[m.indexOf(g)]=!1:t.util.array.fill(m,!1)}}function a(u,g){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var m in u)this.on(m,u[m]);else this.__eventListeners[u]||(this.__eventListeners[u]=[]),this.__eventListeners[u].push(g);return this}function c(u,g){var m=(function(){g.apply(this,arguments),this.off(u,m)}).bind(this);this.on(u,m)}function d(u,g){if(arguments.length===1)for(var m in u)c.call(this,m,u[m]);else c.call(this,u,g);return this}function f(u,g){if(!this.__eventListeners)return this;if(arguments.length===0)for(u in this.__eventListeners)o.call(this,u);else if(arguments.length===1&&typeof arguments[0]=="object")for(var m in u)o.call(this,m,u[m]);else o.call(this,u,g);return this}function h(u,g){if(!this.__eventListeners)return this;var m=this.__eventListeners[u];if(!m)return this;for(var p=0,x=m.length;p<x;p++)m[p]&&m[p].call(this,g||{});return this.__eventListeners[u]=m.filter(function(v){return v!==!1}),this}t.Observable={fire:h,on:a,once:d,off:f}}(),t.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var o=0,a=arguments.length;o<a;o++)this._onObjectAdded(arguments[o]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(o,a,c){var d=this._objects;return c?d[a]=o:d.splice(a,0,o),this._onObjectAdded&&this._onObjectAdded(o),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var o=this._objects,a,c=!1,d=0,f=arguments.length;d<f;d++)a=o.indexOf(arguments[d]),a!==-1&&(c=!0,o.splice(a,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[d]));return this.renderOnAddRemove&&c&&this.requestRenderAll(),this},forEachObject:function(o,a){for(var c=this.getObjects(),d=0,f=c.length;d<f;d++)o.call(a,c[d],d,c);return this},getObjects:function(o){return typeof o>"u"?this._objects.concat():this._objects.filter(function(a){return a.type===o})},item:function(o){return this._objects[o]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(o,a){return this._objects.indexOf(o)>-1?!0:a?this._objects.some(function(c){return typeof c.contains=="function"&&c.contains(o,!0)}):!1},complexity:function(){return this._objects.reduce(function(o,a){return o+=a.complexity?a.complexity():0,o},0)}},t.CommonMethods={_setOptions:function(o){for(var a in o)this.set(a,o[a])},_initGradient:function(o,a){o&&o.colorStops&&!(o instanceof t.Gradient)&&this.set(a,new t.Gradient(o))},_initPattern:function(o,a,c){o&&o.source&&!(o instanceof t.Pattern)?this.set(a,new t.Pattern(o,c)):c&&c()},_setObject:function(o){for(var a in o)this._set(a,o[a])},set:function(o,a){return typeof o=="object"?this._setObject(o):this._set(o,a),this},_set:function(o,a){this[o]=a},toggle:function(o){var a=this.get(o);return typeof a=="boolean"&&this.set(o,!a),this},get:function(o){return this[o]}},function(o){var a=Math.sqrt,c=Math.atan2,d=Math.pow,f=Math.PI/180,h=Math.PI/2;t.util={cos:function(u){if(u===0)return 1;u<0&&(u=-u);var g=u/h;switch(g){case 1:case 3:return 0;case 2:return-1}return Math.cos(u)},sin:function(u){if(u===0)return 0;var g=u/h,m=1;switch(u<0&&(m=-1),g){case 1:return m;case 2:return 0;case 3:return-m}return Math.sin(u)},removeFromArray:function(u,g){var m=u.indexOf(g);return m!==-1&&u.splice(m,1),u},getRandomInt:function(u,g){return Math.floor(Math.random()*(g-u+1))+u},degreesToRadians:function(u){return u*f},radiansToDegrees:function(u){return u/f},rotatePoint:function(u,g,m){var p=new t.Point(u.x-g.x,u.y-g.y),x=t.util.rotateVector(p,m);return new t.Point(x.x,x.y).addEquals(g)},rotateVector:function(u,g){var m=t.util.sin(g),p=t.util.cos(g),x=u.x*p-u.y*m,v=u.x*m+u.y*p;return{x,y:v}},createVector:function(u,g){return new t.Point(g.x-u.x,g.y-u.y)},calcAngleBetweenVectors:function(u,g){return Math.acos((u.x*g.x+u.y*g.y)/(Math.hypot(u.x,u.y)*Math.hypot(g.x,g.y)))},getHatVector:function(u){return new t.Point(u.x,u.y).multiply(1/Math.hypot(u.x,u.y))},getBisector:function(u,g,m){var p=t.util.createVector(u,g),x=t.util.createVector(u,m),v=t.util.calcAngleBetweenVectors(p,x),y=t.util.calcAngleBetweenVectors(t.util.rotateVector(p,v),x),_=v*(y===0?1:-1)/2;return{vector:t.util.getHatVector(t.util.rotateVector(p,_)),angle:v}},projectStrokeOnPoints:function(u,g,m){var p=[],x=g.strokeWidth/2,v=g.strokeUniform?new t.Point(1/g.scaleX,1/g.scaleY):new t.Point(1,1),y=function(_){var b=x/Math.hypot(_.x,_.y);return new t.Point(_.x*b*v.x,_.y*b*v.y)};return u.length<=1||u.forEach(function(_,b){var S=new t.Point(_.x,_.y),C,N;b===0?(N=u[b+1],C=m?y(t.util.createVector(N,S)).addEquals(S):u[u.length-1]):b===u.length-1?(C=u[b-1],N=m?y(t.util.createVector(C,S)).addEquals(S):u[0]):(C=u[b-1],N=u[b+1]);var F=t.util.getBisector(S,C,N),Y=F.vector,X=F.angle,V,te;if(g.strokeLineJoin==="miter"&&(V=-x/Math.sin(X/2),te=new t.Point(Y.x*V*v.x,Y.y*V*v.y),Math.hypot(te.x,te.y)/x<=g.strokeMiterLimit)){p.push(S.add(te)),p.push(S.subtract(te));return}V=-x*Math.SQRT2,te=new t.Point(Y.x*V*v.x,Y.y*V*v.y),p.push(S.add(te)),p.push(S.subtract(te))}),p},transformPoint:function(u,g,m){return m?new t.Point(g[0]*u.x+g[2]*u.y,g[1]*u.x+g[3]*u.y):new t.Point(g[0]*u.x+g[2]*u.y+g[4],g[1]*u.x+g[3]*u.y+g[5])},makeBoundingBoxFromPoints:function(u,g){if(g)for(var m=0;m<u.length;m++)u[m]=t.util.transformPoint(u[m],g);var p=[u[0].x,u[1].x,u[2].x,u[3].x],x=t.util.array.min(p),v=t.util.array.max(p),y=v-x,_=[u[0].y,u[1].y,u[2].y,u[3].y],b=t.util.array.min(_),S=t.util.array.max(_),C=S-b;return{left:x,top:b,width:y,height:C}},invertTransform:function(u){var g=1/(u[0]*u[3]-u[1]*u[2]),m=[g*u[3],-g*u[1],-g*u[2],g*u[0]],p=t.util.transformPoint({x:u[4],y:u[5]},m,!0);return m[4]=-p.x,m[5]=-p.y,m},toFixed:function(u,g){return parseFloat(Number(u).toFixed(g))},parseUnit:function(u,g){var m=/\D{0,2}$/.exec(u),p=parseFloat(u);switch(g||(g=t.Text.DEFAULT_SVG_FONT_SIZE),m[0]){case"mm":return p*t.DPI/25.4;case"cm":return p*t.DPI/2.54;case"in":return p*t.DPI;case"pt":return p*t.DPI/72;case"pc":return p*t.DPI/72*12;case"em":return p*g;default:return p}},falseFunction:function(){return!1},getKlass:function(u,g){return u=t.util.string.camelize(u.charAt(0).toUpperCase()+u.slice(1)),t.util.resolveNamespace(g)[u]},getSvgAttributes:function(u){var g=["instantiated_by_use","style","id","class"];switch(u){case"linearGradient":g=g.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":g=g.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":g=g.concat(["offset","stop-color","stop-opacity"]);break}return g},resolveNamespace:function(u){if(!u)return t;var g=u.split("."),m=g.length,p,x=o||t.window;for(p=0;p<m;++p)x=x[g[p]];return x},loadImage:function(u,g,m,p){if(!u){g&&g.call(m,u);return}var x=t.util.createImage(),v=function(){g&&g.call(m,x,!1),x=x.onload=x.onerror=null};x.onload=v,x.onerror=function(){t.log("Error loading "+x.src),g&&g.call(m,null,!0),x=x.onload=x.onerror=null},u.indexOf("data")!==0&&p!==void 0&&p!==null&&(x.crossOrigin=p),u.substring(0,14)==="data:image/svg"&&(x.onload=null,t.util.loadImageInDom(x,v)),x.src=u},loadImageInDom:function(u,g){var m=t.document.createElement("div");m.style.width=m.style.height="1px",m.style.left=m.style.top="-100%",m.style.position="absolute",m.appendChild(u),t.document.querySelector("body").appendChild(m),u.onload=function(){g(),m.parentNode.removeChild(m),m=null}},enlivenObjects:function(u,g,m,p){u=u||[];var x=[],v=0,y=u.length;function _(){++v===y&&g&&g(x.filter(function(b){return b}))}if(!y){g&&g(x);return}u.forEach(function(b,S){if(!b||!b.type){_();return}var C=t.util.getKlass(b.type,m);C.fromObject(b,function(N,F){F||(x[S]=N),p&&p(b,N,F),_()})})},enlivenObjectEnlivables:function(u,g,m){var p=t.Object.ENLIVEN_PROPS.filter(function(x){return!!u[x]});t.util.enlivenObjects(p.map(function(x){return u[x]}),function(x){var v={};p.forEach(function(y,_){v[y]=x[_],g&&(g[y]=x[_])}),m&&m(v)})},enlivenPatterns:function(u,g){u=u||[];function m(){++x===v&&g&&g(p)}var p=[],x=0,v=u.length;if(!v){g&&g(p);return}u.forEach(function(y,_){y&&y.source?new t.Pattern(y,function(b){p[_]=b,m()}):(p[_]=y,m())})},groupSVGElements:function(u,g,m){var p;return u&&u.length===1?(typeof m<"u"&&(u[0].sourcePath=m),u[0]):(g&&(g.width&&g.height?g.centerPoint={x:g.width/2,y:g.height/2}:(delete g.width,delete g.height)),p=new t.Group(u,g),typeof m<"u"&&(p.sourcePath=m),p)},populateWithProperties:function(u,g,m){if(m&&Array.isArray(m))for(var p=0,x=m.length;p<x;p++)m[p]in u&&(g[m[p]]=u[m[p]])},createCanvasElement:function(){return t.document.createElement("canvas")},copyCanvasElement:function(u){var g=t.util.createCanvasElement();return g.width=u.width,g.height=u.height,g.getContext("2d").drawImage(u,0,0),g},toDataURL:function(u,g,m){return u.toDataURL("image/"+g,m)},createImage:function(){return t.document.createElement("img")},multiplyTransformMatrices:function(u,g,m){return[u[0]*g[0]+u[2]*g[1],u[1]*g[0]+u[3]*g[1],u[0]*g[2]+u[2]*g[3],u[1]*g[2]+u[3]*g[3],m?0:u[0]*g[4]+u[2]*g[5]+u[4],m?0:u[1]*g[4]+u[3]*g[5]+u[5]]},qrDecompose:function(u){var g=c(u[1],u[0]),m=d(u[0],2)+d(u[1],2),p=a(m),x=(u[0]*u[3]-u[2]*u[1])/p,v=c(u[0]*u[2]+u[1]*u[3],m);return{angle:g/f,scaleX:p,scaleY:x,skewX:v/f,skewY:0,translateX:u[4],translateY:u[5]}},calcRotateMatrix:function(u){if(!u.angle)return t.iMatrix.concat();var g=t.util.degreesToRadians(u.angle),m=t.util.cos(g),p=t.util.sin(g);return[m,p,-p,m,0,0]},calcDimensionsMatrix:function(u){var g=typeof u.scaleX>"u"?1:u.scaleX,m=typeof u.scaleY>"u"?1:u.scaleY,p=[u.flipX?-g:g,0,0,u.flipY?-m:m,0,0],x=t.util.multiplyTransformMatrices,v=t.util.degreesToRadians;return u.skewX&&(p=x(p,[1,0,Math.tan(v(u.skewX)),1],!0)),u.skewY&&(p=x(p,[1,Math.tan(v(u.skewY)),0,1],!0)),p},composeMatrix:function(u){var g=[1,0,0,1,u.translateX||0,u.translateY||0],m=t.util.multiplyTransformMatrices;return u.angle&&(g=m(g,t.util.calcRotateMatrix(u))),(u.scaleX!==1||u.scaleY!==1||u.skewX||u.skewY||u.flipX||u.flipY)&&(g=m(g,t.util.calcDimensionsMatrix(u))),g},resetObjectTransform:function(u){u.scaleX=1,u.scaleY=1,u.skewX=0,u.skewY=0,u.flipX=!1,u.flipY=!1,u.rotate(0)},saveObjectTransform:function(u){return{scaleX:u.scaleX,scaleY:u.scaleY,skewX:u.skewX,skewY:u.skewY,angle:u.angle,left:u.left,flipX:u.flipX,flipY:u.flipY,top:u.top}},isTransparent:function(u,g,m,p){p>0&&(g>p?g-=p:g=0,m>p?m-=p:m=0);var x=!0,v,y,_=u.getImageData(g,m,p*2||1,p*2||1),b=_.data.length;for(v=3;v<b&&(y=_.data[v],x=y<=0,x!==!1);v+=4);return _=null,x},parsePreserveAspectRatioAttribute:function(u){var g="meet",m="Mid",p="Mid",x=u.split(" "),v;return x&&x.length&&(g=x.pop(),g!=="meet"&&g!=="slice"?(v=g,g="meet"):x.length&&(v=x.pop())),m=v!=="none"?v.slice(1,4):"none",p=v!=="none"?v.slice(5,8):"none",{meetOrSlice:g,alignX:m,alignY:p}},clearFabricFontCache:function(u){u=(u||"").toLowerCase(),u?t.charWidthsCache[u]&&delete t.charWidthsCache[u]:t.charWidthsCache={}},limitDimsByArea:function(u,g){var m=Math.sqrt(g*u),p=Math.floor(g/m);return{x:Math.floor(m),y:p}},capValue:function(u,g,m){return Math.max(u,Math.min(g,m))},findScaleToFit:function(u,g){return Math.min(g.width/u.width,g.height/u.height)},findScaleToCover:function(u,g){return Math.max(g.width/u.width,g.height/u.height)},matrixToSVG:function(u){return"matrix("+u.map(function(g){return t.util.toFixed(g,t.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(u,g){var m=t.util.invertTransform(g),p=t.util.multiplyTransformMatrices(m,u.calcOwnMatrix());t.util.applyTransformToObject(u,p)},addTransformToObject:function(u,g){t.util.applyTransformToObject(u,t.util.multiplyTransformMatrices(g,u.calcOwnMatrix()))},applyTransformToObject:function(u,g){var m=t.util.qrDecompose(g),p=new t.Point(m.translateX,m.translateY);u.flipX=!1,u.flipY=!1,u.set("scaleX",m.scaleX),u.set("scaleY",m.scaleY),u.skewX=m.skewX,u.skewY=m.skewY,u.angle=m.angle,u.setPositionByOrigin(p,"center","center")},sizeAfterTransform:function(u,g,m){var p=u/2,x=g/2,v=[{x:-p,y:-x},{x:p,y:-x},{x:-p,y:x},{x:p,y:x}],y=t.util.calcDimensionsMatrix(m),_=t.util.makeBoundingBoxFromPoints(v,y);return{x:_.width,y:_.height}},mergeClipPaths:function(u,g){var m=u,p=g;m.inverted&&!p.inverted&&(m=g,p=u),t.util.applyTransformToObject(p,t.util.multiplyTransformMatrices(t.util.invertTransform(m.calcTransformMatrix()),p.calcTransformMatrix()));var x=m.inverted&&p.inverted;return x&&(m.inverted=p.inverted=!1),new t.Group([m],{clipPath:p,inverted:x})},hasStyleChanged:function(u,g,m){return m=m||!1,u.fill!==g.fill||u.stroke!==g.stroke||u.strokeWidth!==g.strokeWidth||u.fontSize!==g.fontSize||u.fontFamily!==g.fontFamily||u.fontWeight!==g.fontWeight||u.fontStyle!==g.fontStyle||u.textBackgroundColor!==g.textBackgroundColor||u.deltaY!==g.deltaY||m&&(u.overline!==g.overline||u.underline!==g.underline||u.linethrough!==g.linethrough)},stylesToArray:function(m,g){for(var m=t.util.object.clone(m,!0),p=g.split(`
`),x=-1,v={},y=[],_=0;_<p.length;_++){if(!m[_]){x+=p[_].length;continue}for(var b=0;b<p[_].length;b++){x++;var S=m[_][b];if(S&&Object.keys(S).length>0){var C=t.util.hasStyleChanged(v,S,!0);C?y.push({start:x,end:x+1,style:S}):y[y.length-1].end++}v=S||{}}}return y},stylesFromArray:function(u,g){if(!Array.isArray(u))return u;for(var m=g.split(`
`),p=-1,x=0,v={},y=0;y<m.length;y++)for(var _=0;_<m[y].length;_++)p++,u[x]&&u[x].start<=p&&p<u[x].end&&(v[y]=v[y]||{},v[y][_]=Object.assign({},u[x].style),p===u[x].end-1&&x++);return v}}}(e),function(){var o=Array.prototype.join,a={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},c={m:"l",M:"L"};function d(E,D,U,k,P,A,T,j,R,z,I){var L=t.util.cos(E),K=t.util.sin(E),O=t.util.cos(D),B=t.util.sin(D),M=U*P*O-k*A*B+T,J=k*P*O+U*A*B+j,se=z+R*(-U*P*K-k*A*L),H=I+R*(-k*P*K+U*A*L),ce=M+R*(U*P*B+k*A*O),ue=J+R*(k*P*B-U*A*O);return["C",se,H,ce,ue,M,J]}function f(E,D,U,k,P,A,T){var j=Math.PI,R=T*j/180,z=t.util.sin(R),I=t.util.cos(R),L=0,K=0;U=Math.abs(U),k=Math.abs(k);var O=-I*E*.5-z*D*.5,B=-I*D*.5+z*E*.5,M=U*U,J=k*k,se=B*B,H=O*O,ce=M*J-M*se-J*H,ue=0;if(ce<0){var xe=Math.sqrt(1-ce/(M*J));U*=xe,k*=xe}else ue=(P===A?-1:1)*Math.sqrt(ce/(M*se+J*H));var _e=ue*U*B/k,fe=-ue*k*O/U,ve=I*_e-z*fe+E*.5,Ce=z*_e+I*fe+D*.5,De=h(1,0,(O-_e)/U,(B-fe)/k),je=h((O-_e)/U,(B-fe)/k,(-O-_e)/U,(-B-fe)/k);A===0&&je>0?je-=2*j:A===1&&je<0&&(je+=2*j);for(var Ie=Math.ceil(Math.abs(je/j*2)),Ye=[],et=je/Ie,Le=8/3*Math.sin(et/4)*Math.sin(et/4)/Math.sin(et/2),ot=De+et,gt=0;gt<Ie;gt++)Ye[gt]=d(De,ot,I,z,U,k,ve,Ce,Le,L,K),L=Ye[gt][5],K=Ye[gt][6],De=ot,ot+=et;return Ye}function h(E,D,U,k){var P=Math.atan2(D,E),A=Math.atan2(k,U);return A>=P?A-P:2*Math.PI-(P-A)}function u(E,D,U,k,P,A,T,j){var R;if(t.cachesBoundsOfCurve&&(R=o.call(arguments),t.boundsOfCurveCache[R]))return t.boundsOfCurveCache[R];var z=Math.sqrt,I=Math.min,L=Math.max,K=Math.abs,O=[],B=[[],[]],M,J,se,H,ce,ue,xe,_e;J=6*E-12*U+6*P,M=-3*E+9*U-9*P+3*T,se=3*U-3*E;for(var fe=0;fe<2;++fe){if(fe>0&&(J=6*D-12*k+6*A,M=-3*D+9*k-9*A+3*j,se=3*k-3*D),K(M)<1e-12){if(K(J)<1e-12)continue;H=-se/J,0<H&&H<1&&O.push(H);continue}xe=J*J-4*se*M,!(xe<0)&&(_e=z(xe),ce=(-J+_e)/(2*M),0<ce&&ce<1&&O.push(ce),ue=(-J-_e)/(2*M),0<ue&&ue<1&&O.push(ue))}for(var ve,Ce,De=O.length,je=De,Ie;De--;)H=O[De],Ie=1-H,ve=Ie*Ie*Ie*E+3*Ie*Ie*H*U+3*Ie*H*H*P+H*H*H*T,B[0][De]=ve,Ce=Ie*Ie*Ie*D+3*Ie*Ie*H*k+3*Ie*H*H*A+H*H*H*j,B[1][De]=Ce;B[0][je]=E,B[1][je]=D,B[0][je+1]=T,B[1][je+1]=j;var Ye=[{x:I.apply(null,B[0]),y:I.apply(null,B[1])},{x:L.apply(null,B[0]),y:L.apply(null,B[1])}];return t.cachesBoundsOfCurve&&(t.boundsOfCurveCache[R]=Ye),Ye}function g(E,D,U){for(var k=U[1],P=U[2],A=U[3],T=U[4],j=U[5],R=U[6],z=U[7],I=f(R-E,z-D,k,P,T,j,A),L=0,K=I.length;L<K;L++)I[L][1]+=E,I[L][2]+=D,I[L][3]+=E,I[L][4]+=D,I[L][5]+=E,I[L][6]+=D;return I}function m(E){var D=0,U=0,k=E.length,P=0,A=0,T,j,R,z=[],I,L,K;for(j=0;j<k;++j){switch(R=!1,T=E[j].slice(0),T[0]){case"l":T[0]="L",T[1]+=D,T[2]+=U;case"L":D=T[1],U=T[2];break;case"h":T[1]+=D;case"H":T[0]="L",T[2]=U,D=T[1];break;case"v":T[1]+=U;case"V":T[0]="L",U=T[1],T[1]=D,T[2]=U;break;case"m":T[0]="M",T[1]+=D,T[2]+=U;case"M":D=T[1],U=T[2],P=T[1],A=T[2];break;case"c":T[0]="C",T[1]+=D,T[2]+=U,T[3]+=D,T[4]+=U,T[5]+=D,T[6]+=U;case"C":L=T[3],K=T[4],D=T[5],U=T[6];break;case"s":T[0]="S",T[1]+=D,T[2]+=U,T[3]+=D,T[4]+=U;case"S":I==="C"?(L=2*D-L,K=2*U-K):(L=D,K=U),D=T[3],U=T[4],T[0]="C",T[5]=T[3],T[6]=T[4],T[3]=T[1],T[4]=T[2],T[1]=L,T[2]=K,L=T[3],K=T[4];break;case"q":T[0]="Q",T[1]+=D,T[2]+=U,T[3]+=D,T[4]+=U;case"Q":L=T[1],K=T[2],D=T[3],U=T[4];break;case"t":T[0]="T",T[1]+=D,T[2]+=U;case"T":I==="Q"?(L=2*D-L,K=2*U-K):(L=D,K=U),T[0]="Q",D=T[1],U=T[2],T[1]=L,T[2]=K,T[3]=D,T[4]=U;break;case"a":T[0]="A",T[6]+=D,T[7]+=U;case"A":R=!0,z=z.concat(g(D,U,T)),D=T[6],U=T[7];break;case"z":case"Z":D=P,U=A;break}R||z.push(T),I=T[0]}return z}function p(E,D,U,k){return Math.sqrt((U-E)*(U-E)+(k-D)*(k-D))}function x(E){return E*E*E}function v(E){return 3*E*E*(1-E)}function y(E){return 3*E*(1-E)*(1-E)}function _(E){return(1-E)*(1-E)*(1-E)}function b(E,D,U,k,P,A,T,j){return function(R){var z=x(R),I=v(R),L=y(R),K=_(R);return{x:T*z+P*I+U*L+E*K,y:j*z+A*I+k*L+D*K}}}function S(E,D,U,k,P,A,T,j){return function(R){var z=1-R,I=3*z*z*(U-E)+6*z*R*(P-U)+3*R*R*(T-P),L=3*z*z*(k-D)+6*z*R*(A-k)+3*R*R*(j-A);return Math.atan2(L,I)}}function C(E){return E*E}function N(E){return 2*E*(1-E)}function F(E){return(1-E)*(1-E)}function Y(E,D,U,k,P,A){return function(T){var j=C(T),R=N(T),z=F(T);return{x:P*j+U*R+E*z,y:A*j+k*R+D*z}}}function X(E,D,U,k,P,A){return function(T){var j=1-T,R=2*j*(U-E)+2*T*(P-U),z=2*j*(k-D)+2*T*(A-k);return Math.atan2(z,R)}}function V(E,D,U){var k={x:D,y:U},P,A=0,T;for(T=1;T<=100;T+=1)P=E(T/100),A+=p(k.x,k.y,P.x,P.y),k=P;return A}function te(E,D){for(var U=0,k=0,P=E.iterator,A={x:E.x,y:E.y},T,j,R=.01,z=E.angleFinder,I;k<D&&R>1e-4;)T=P(U),I=U,j=p(A.x,A.y,T.x,T.y),j+k>D?(U-=R,R/=2):(A=T,U+=R,k+=j);return T.angle=z(I),T}function G(E){for(var D=0,U=E.length,k,P=0,A=0,T=0,j=0,R=[],z,I,L,K=0;K<U;K++){switch(k=E[K],I={x:P,y:A,command:k[0]},k[0]){case"M":I.length=0,T=P=k[1],j=A=k[2];break;case"L":I.length=p(P,A,k[1],k[2]),P=k[1],A=k[2];break;case"C":z=b(P,A,k[1],k[2],k[3],k[4],k[5],k[6]),L=S(P,A,k[1],k[2],k[3],k[4],k[5],k[6]),I.iterator=z,I.angleFinder=L,I.length=V(z,P,A),P=k[5],A=k[6];break;case"Q":z=Y(P,A,k[1],k[2],k[3],k[4]),L=X(P,A,k[1],k[2],k[3],k[4]),I.iterator=z,I.angleFinder=L,I.length=V(z,P,A),P=k[3],A=k[4];break;case"Z":case"z":I.destX=T,I.destY=j,I.length=p(P,A,T,j),P=T,A=j;break}D+=I.length,R.push(I)}return R.push({length:D,x:P,y:A}),R}function re(E,D,U){U||(U=G(E));for(var k=0;D-U[k].length>0&&k<U.length-2;)D-=U[k].length,k++;var P=U[k],A=D/P.length,T=P.command,j=E[k],R;switch(T){case"M":return{x:P.x,y:P.y,angle:0};case"Z":case"z":return R=new t.Point(P.x,P.y).lerp(new t.Point(P.destX,P.destY),A),R.angle=Math.atan2(P.destY-P.y,P.destX-P.x),R;case"L":return R=new t.Point(P.x,P.y).lerp(new t.Point(j[1],j[2]),A),R.angle=Math.atan2(j[2]-P.y,j[1]-P.x),R;case"C":return te(P,D);case"Q":return te(P,D)}}function Z(E){var D=[],U=[],k,P,A=t.rePathCommand,T="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",j="("+T+")"+t.commaWsp,R="([01])"+t.commaWsp+"?",z=j+"?"+j+"?"+j+R+R+j+"?("+T+")",I=new RegExp(z,"g"),L,K,O;if(!E||!E.match)return D;O=E.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var B=0,M,J=O.length;B<J;B++){k=O[B],K=k.slice(1).trim(),U.length=0;var se=k.charAt(0);if(M=[se],se.toLowerCase()==="a")for(var H;H=I.exec(K);)for(var ce=1;ce<H.length;ce++)U.push(H[ce]);else for(;L=A.exec(K);)U.push(L[0]);for(var ce=0,ue=U.length;ce<ue;ce++)P=parseFloat(U[ce]),isNaN(P)||M.push(P);var xe=a[se.toLowerCase()],_e=c[se]||se;if(M.length-1>xe)for(var fe=1,ve=M.length;fe<ve;fe+=xe)D.push([se].concat(M.slice(fe,fe+xe))),se=_e;else D.push(M)}return D}function oe(E,D){var U=[],k,P=new t.Point(E[0].x,E[0].y),A=new t.Point(E[1].x,E[1].y),T=E.length,j=1,R=0,z=T>2;for(D=D||0,z&&(j=E[2].x<A.x?-1:E[2].x===A.x?0:1,R=E[2].y<A.y?-1:E[2].y===A.y?0:1),U.push(["M",P.x-j*D,P.y-R*D]),k=1;k<T;k++){if(!P.eq(A)){var I=P.midPointFrom(A);U.push(["Q",P.x,P.y,I.x,I.y])}P=E[k],k+1<E.length&&(A=E[k+1])}return z&&(j=P.x>E[k-2].x?1:P.x===E[k-2].x?0:-1,R=P.y>E[k-2].y?1:P.y===E[k-2].y?0:-1),U.push(["L",P.x+j*D,P.y+R*D]),U}function ee(E,D,U){return U&&(D=t.util.multiplyTransformMatrices(D,[1,0,0,1,-U.x,-U.y])),E.map(function(k){for(var P=k.slice(0),A={},T=1;T<k.length-1;T+=2)A.x=k[T],A.y=k[T+1],A=t.util.transformPoint(A,D),P[T]=A.x,P[T+1]=A.y;return P})}t.util.joinPath=function(E){return E.map(function(D){return D.join(" ")}).join(" ")},t.util.parsePath=Z,t.util.makePathSimpler=m,t.util.getSmoothPathFromPoints=oe,t.util.getPathSegmentsInfo=G,t.util.getBoundsOfCurve=u,t.util.getPointOnPath=re,t.util.transformPath=ee}(),function(){var o=Array.prototype.slice;function a(u,g){for(var m=o.call(arguments,2),p=[],x=0,v=u.length;x<v;x++)p[x]=m.length?u[x][g].apply(u[x],m):u[x][g].call(u[x]);return p}function c(u,g){return h(u,g,function(m,p){return m>=p})}function d(u,g){return h(u,g,function(m,p){return m<p})}function f(u,g){for(var m=u.length;m--;)u[m]=g;return u}function h(u,g,m){if(!(!u||u.length===0)){var p=u.length-1,x=g?u[p][g]:u[p];if(g)for(;p--;)m(u[p][g],x)&&(x=u[p][g]);else for(;p--;)m(u[p],x)&&(x=u[p]);return x}}t.util.array={fill:f,invoke:a,min:d,max:c}}(),function(){function o(c,d,f){if(f)if(!t.isLikelyNode&&d instanceof Element)c=d;else if(d instanceof Array){c=[];for(var h=0,u=d.length;h<u;h++)c[h]=o({},d[h],f)}else if(d&&typeof d=="object")for(var g in d)g==="canvas"||g==="group"?c[g]=null:d.hasOwnProperty(g)&&(c[g]=o({},d[g],f));else c=d;else for(var g in d)c[g]=d[g];return c}function a(c,d){return o({},c,d)}t.util.object={extend:o,clone:a},t.util.object.extend(t.util,t.Observable)}(),function(){function o(h){return h.replace(/-+(.)?/g,function(u,g){return g?g.toUpperCase():""})}function a(h,u){return h.charAt(0).toUpperCase()+(u?h.slice(1):h.slice(1).toLowerCase())}function c(h){return h.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function d(h){var u=0,g,m=[];for(u=0,g;u<h.length;u++)(g=f(h,u))!==!1&&m.push(g);return m}function f(h,u){var g=h.charCodeAt(u);if(isNaN(g))return"";if(g<55296||g>57343)return h.charAt(u);if(55296<=g&&g<=56319){if(h.length<=u+1)throw"High surrogate without following low surrogate";var m=h.charCodeAt(u+1);if(56320>m||m>57343)throw"High surrogate without following low surrogate";return h.charAt(u)+h.charAt(u+1)}if(u===0)throw"Low surrogate without preceding high surrogate";var p=h.charCodeAt(u-1);if(55296>p||p>56319)throw"Low surrogate without preceding high surrogate";return!1}t.util.string={camelize:o,capitalize:a,escapeXml:c,graphemeSplit:d}}(),function(){var o=Array.prototype.slice,a=function(){},c=function(){for(var g in{toString:1})if(g==="toString")return!1;return!0}(),d=function(g,m,p){for(var x in m)x in g.prototype&&typeof g.prototype[x]=="function"&&(m[x]+"").indexOf("callSuper")>-1?g.prototype[x]=function(v){return function(){var y=this.constructor.superclass;this.constructor.superclass=p;var _=m[v].apply(this,arguments);if(this.constructor.superclass=y,v!=="initialize")return _}}(x):g.prototype[x]=m[x],c&&(m.toString!==Object.prototype.toString&&(g.prototype.toString=m.toString),m.valueOf!==Object.prototype.valueOf&&(g.prototype.valueOf=m.valueOf))};function f(){}function h(g){for(var m=null,p=this;p.constructor.superclass;){var x=p.constructor.superclass.prototype[g];if(p[g]!==x){m=x;break}p=p.constructor.superclass.prototype}return m?arguments.length>1?m.apply(this,o.call(arguments,1)):m.call(this):console.log("tried to callSuper "+g+", method not found in prototype chain",this)}function u(){var g=null,m=o.call(arguments,0);typeof m[0]=="function"&&(g=m.shift());function p(){this.initialize.apply(this,arguments)}p.superclass=g,p.subclasses=[],g&&(f.prototype=g.prototype,p.prototype=new f,g.subclasses.push(p));for(var x=0,v=m.length;x<v;x++)d(p,m[x],g);return p.prototype.initialize||(p.prototype.initialize=a),p.prototype.constructor=p,p.prototype.callSuper=h,p}t.util.createClass=u}(),function(){var o=!!t.document.createElement("div").attachEvent,a=["touchstart","touchmove","touchend"];t.util.addListener=function(d,f,h,u){d&&d.addEventListener(f,h,o?!1:u)},t.util.removeListener=function(d,f,h,u){d&&d.removeEventListener(f,h,o?!1:u)};function c(d){var f=d.changedTouches;return f&&f[0]?f[0]:d}t.util.getPointer=function(d){var f=d.target,h=t.util.getScrollLeftTop(f),u=c(d);return{x:u.clientX+h.left,y:u.clientY+h.top}},t.util.isTouchEvent=function(d){return a.indexOf(d.type)>-1||d.pointerType==="touch"}}(),function(){function o(u,g){var m=u.style;if(!m)return u;if(typeof g=="string")return u.style.cssText+=";"+g,g.indexOf("opacity")>-1?h(u,g.match(/opacity:\s*(\d?\.?\d*)/)[1]):u;for(var p in g)if(p==="opacity")h(u,g[p]);else{var x=p==="float"||p==="cssFloat"?typeof m.styleFloat>"u"?"cssFloat":"styleFloat":p;m.setProperty(x,g[p])}return u}var a=t.document.createElement("div"),c=typeof a.style.opacity=="string",d=typeof a.style.filter=="string",f=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,h=function(u){return u};c?h=function(u,g){return u.style.opacity=g,u}:d&&(h=function(u,g){var m=u.style;return u.currentStyle&&!u.currentStyle.hasLayout&&(m.zoom=1),f.test(m.filter)?(g=g>=.9999?"":"alpha(opacity="+g*100+")",m.filter=m.filter.replace(f,g)):m.filter+=" alpha(opacity="+g*100+")",u}),t.util.setStyle=o}(),function(){var o=Array.prototype.slice;function a(_){return typeof _=="string"?t.document.getElementById(_):_}var c,d=function(_){return o.call(_,0)};try{c=d(t.document.childNodes)instanceof Array}catch{}c||(d=function(_){for(var b=new Array(_.length),S=_.length;S--;)b[S]=_[S];return b});function f(_,b){var S=t.document.createElement(_);for(var C in b)C==="class"?S.className=b[C]:C==="for"?S.htmlFor=b[C]:S.setAttribute(C,b[C]);return S}function h(_,b){_&&(" "+_.className+" ").indexOf(" "+b+" ")===-1&&(_.className+=(_.className?" ":"")+b)}function u(_,b,S){return typeof b=="string"&&(b=f(b,S)),_.parentNode&&_.parentNode.replaceChild(b,_),b.appendChild(_),b}function g(_){for(var b=0,S=0,C=t.document.documentElement,N=t.document.body||{scrollLeft:0,scrollTop:0};_&&(_.parentNode||_.host)&&(_=_.parentNode||_.host,_===t.document?(b=N.scrollLeft||C.scrollLeft||0,S=N.scrollTop||C.scrollTop||0):(b+=_.scrollLeft||0,S+=_.scrollTop||0),!(_.nodeType===1&&_.style.position==="fixed")););return{left:b,top:S}}function m(_){var b,S=_&&_.ownerDocument,C={left:0,top:0},N={left:0,top:0},F,Y={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!S)return N;for(var X in Y)N[Y[X]]+=parseInt(p(_,X),10)||0;return b=S.documentElement,typeof _.getBoundingClientRect<"u"&&(C=_.getBoundingClientRect()),F=g(_),{left:C.left+F.left-(b.clientLeft||0)+N.left,top:C.top+F.top-(b.clientTop||0)+N.top}}var p;t.document.defaultView&&t.document.defaultView.getComputedStyle?p=function(_,b){var S=t.document.defaultView.getComputedStyle(_,null);return S?S[b]:void 0}:p=function(_,b){var S=_.style[b];return!S&&_.currentStyle&&(S=_.currentStyle[b]),S},function(){var _=t.document.documentElement.style,b="userSelect"in _?"userSelect":"MozUserSelect"in _?"MozUserSelect":"WebkitUserSelect"in _?"WebkitUserSelect":"KhtmlUserSelect"in _?"KhtmlUserSelect":"";function S(N){return typeof N.onselectstart<"u"&&(N.onselectstart=t.util.falseFunction),b?N.style[b]="none":typeof N.unselectable=="string"&&(N.unselectable="on"),N}function C(N){return typeof N.onselectstart<"u"&&(N.onselectstart=null),b?N.style[b]="":typeof N.unselectable=="string"&&(N.unselectable=""),N}t.util.makeElementUnselectable=S,t.util.makeElementSelectable=C}();function x(_){var b=t.jsdomImplForWrapper(_);return b._canvas||b._image}function v(_){if(t.isLikelyNode){var b=t.jsdomImplForWrapper(_);b&&(b._image=null,b._canvas=null,b._currentSrc=null,b._attributes=null,b._classList=null)}}function y(_,b){_.imageSmoothingEnabled=_.imageSmoothingEnabled||_.webkitImageSmoothingEnabled||_.mozImageSmoothingEnabled||_.msImageSmoothingEnabled||_.oImageSmoothingEnabled,_.imageSmoothingEnabled=b}t.util.setImageSmoothing=y,t.util.getById=a,t.util.toArray=d,t.util.addClass=h,t.util.makeElement=f,t.util.wrapElement=u,t.util.getScrollLeftTop=g,t.util.getElementOffset=m,t.util.getNodeCanvas=x,t.util.cleanUpJsdomNode=v}(),function(){function o(d,f){return d+(/\?/.test(d)?"&":"?")+f}function a(){}function c(d,f){f||(f={});var h=f.method?f.method.toUpperCase():"GET",u=f.onComplete||function(){},g=new t.window.XMLHttpRequest,m=f.body||f.parameters;return g.onreadystatechange=function(){g.readyState===4&&(u(g),g.onreadystatechange=a)},h==="GET"&&(m=null,typeof f.parameters=="string"&&(d=o(d,f.parameters))),g.open(h,d,!0),(h==="POST"||h==="PUT")&&g.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),g.send(m),g}t.util.request=c}(),t.log=console.log,t.warn=console.warn,function(){var o=t.util.object.extend,a=t.util.object.clone,c=[];t.util.object.extend(c,{cancelAll:function(){var x=this.splice(0);return x.forEach(function(v){v.cancel()}),x},cancelByCanvas:function(x){if(!x)return[];var v=this.filter(function(y){return typeof y.target=="object"&&y.target.canvas===x});return v.forEach(function(y){y.cancel()}),v},cancelByTarget:function(x){var v=this.findAnimationsByTarget(x);return v.forEach(function(y){y.cancel()}),v},findAnimationIndex:function(x){return this.indexOf(this.findAnimation(x))},findAnimation:function(x){return this.find(function(v){return v.cancel===x})},findAnimationsByTarget:function(x){return x?this.filter(function(v){return v.target===x}):[]}});function d(){return!1}function f(x,v,y,_){return-y*Math.cos(x/_*(Math.PI/2))+y+v}function h(x){x||(x={});var v=!1,y,_=function(){var b=t.runningAnimations.indexOf(y);return b>-1&&t.runningAnimations.splice(b,1)[0]};return y=o(a(x),{cancel:function(){return v=!0,_()},currentValue:"startValue"in x?x.startValue:0,completionRate:0,durationRate:0}),t.runningAnimations.push(y),m(function(b){var S=b||+new Date,C=x.duration||500,N=S+C,F,Y=x.onChange||d,X=x.abort||d,V=x.onComplete||d,te=x.easing||f,G="startValue"in x?x.startValue.length>0:!1,re="startValue"in x?x.startValue:0,Z="endValue"in x?x.endValue:100,oe=x.byValue||(G?re.map(function(ee,E){return Z[E]-re[E]}):Z-re);x.onStart&&x.onStart(),function ee(E){F=E||+new Date;var D=F>N?C:F-S,U=D/C,k=G?re.map(function(A,T){return te(D,re[T],oe[T],C)}):te(D,re,oe,C),P=Math.abs(G?(k[0]-re[0])/oe[0]:(k-re)/oe);if(y.currentValue=G?k.slice():k,y.completionRate=P,y.durationRate=U,!v){if(X(k,P,U)){_();return}if(F>N){y.currentValue=G?Z.slice():Z,y.completionRate=1,y.durationRate=1,Y(G?Z.slice():Z,1,1),V(Z,1,1),_();return}else Y(k,P,U),m(ee)}}(S)}),y.cancel}var u=t.window.requestAnimationFrame||t.window.webkitRequestAnimationFrame||t.window.mozRequestAnimationFrame||t.window.oRequestAnimationFrame||t.window.msRequestAnimationFrame||function(x){return t.window.setTimeout(x,1e3/60)},g=t.window.cancelAnimationFrame||t.window.clearTimeout;function m(){return u.apply(t.window,arguments)}function p(){return g.apply(t.window,arguments)}t.util.animate=h,t.util.requestAnimFrame=m,t.util.cancelAnimFrame=p,t.runningAnimations=c}(),function(){function o(c,d,f){var h="rgba("+parseInt(c[0]+f*(d[0]-c[0]),10)+","+parseInt(c[1]+f*(d[1]-c[1]),10)+","+parseInt(c[2]+f*(d[2]-c[2]),10);return h+=","+(c&&d?parseFloat(c[3]+f*(d[3]-c[3])):1),h+=")",h}function a(c,d,f,h){var u=new t.Color(c).getSource(),g=new t.Color(d).getSource(),m=h.onComplete,p=h.onChange;return h=h||{},t.util.animate(t.util.object.extend(h,{duration:f||500,startValue:u,endValue:g,byValue:g,easing:function(x,v,y,_){var b=h.colorEasing?h.colorEasing(x,_):1-Math.cos(x/_*(Math.PI/2));return o(v,y,b)},onComplete:function(x,v,y){if(m)return m(o(g,g,0),v,y)},onChange:function(x,v,y){if(p){if(Array.isArray(x))return p(o(x,x,0),v,y);p(x,v,y)}}}))}t.util.animateColor=a}(),function(){function o(E,D,U,k){return E<Math.abs(D)?(E=D,k=U/4):D===0&&E===0?k=U/(2*Math.PI)*Math.asin(1):k=U/(2*Math.PI)*Math.asin(D/E),{a:E,c:D,p:U,s:k}}function a(E,D,U){return E.a*Math.pow(2,10*(D-=1))*Math.sin((D*U-E.s)*(2*Math.PI)/E.p)}function c(E,D,U,k){return U*((E=E/k-1)*E*E+1)+D}function d(E,D,U,k){return E/=k/2,E<1?U/2*E*E*E+D:U/2*((E-=2)*E*E+2)+D}function f(E,D,U,k){return U*(E/=k)*E*E*E+D}function h(E,D,U,k){return-U*((E=E/k-1)*E*E*E-1)+D}function u(E,D,U,k){return E/=k/2,E<1?U/2*E*E*E*E+D:-U/2*((E-=2)*E*E*E-2)+D}function g(E,D,U,k){return U*(E/=k)*E*E*E*E+D}function m(E,D,U,k){return U*((E=E/k-1)*E*E*E*E+1)+D}function p(E,D,U,k){return E/=k/2,E<1?U/2*E*E*E*E*E+D:U/2*((E-=2)*E*E*E*E+2)+D}function x(E,D,U,k){return-U*Math.cos(E/k*(Math.PI/2))+U+D}function v(E,D,U,k){return U*Math.sin(E/k*(Math.PI/2))+D}function y(E,D,U,k){return-U/2*(Math.cos(Math.PI*E/k)-1)+D}function _(E,D,U,k){return E===0?D:U*Math.pow(2,10*(E/k-1))+D}function b(E,D,U,k){return E===k?D+U:U*(-Math.pow(2,-10*E/k)+1)+D}function S(E,D,U,k){return E===0?D:E===k?D+U:(E/=k/2,E<1?U/2*Math.pow(2,10*(E-1))+D:U/2*(-Math.pow(2,-10*--E)+2)+D)}function C(E,D,U,k){return-U*(Math.sqrt(1-(E/=k)*E)-1)+D}function N(E,D,U,k){return U*Math.sqrt(1-(E=E/k-1)*E)+D}function F(E,D,U,k){return E/=k/2,E<1?-U/2*(Math.sqrt(1-E*E)-1)+D:U/2*(Math.sqrt(1-(E-=2)*E)+1)+D}function Y(E,D,U,k){var P=1.70158,A=0,T=U;if(E===0)return D;if(E/=k,E===1)return D+U;A||(A=k*.3);var j=o(T,U,A,P);return-a(j,E,k)+D}function X(E,D,U,k){var P=1.70158,A=0,T=U;if(E===0)return D;if(E/=k,E===1)return D+U;A||(A=k*.3);var j=o(T,U,A,P);return j.a*Math.pow(2,-10*E)*Math.sin((E*k-j.s)*(2*Math.PI)/j.p)+j.c+D}function V(E,D,U,k){var P=1.70158,A=0,T=U;if(E===0)return D;if(E/=k/2,E===2)return D+U;A||(A=k*(.3*1.5));var j=o(T,U,A,P);return E<1?-.5*a(j,E,k)+D:j.a*Math.pow(2,-10*(E-=1))*Math.sin((E*k-j.s)*(2*Math.PI)/j.p)*.5+j.c+D}function te(E,D,U,k,P){return P===void 0&&(P=1.70158),U*(E/=k)*E*((P+1)*E-P)+D}function G(E,D,U,k,P){return P===void 0&&(P=1.70158),U*((E=E/k-1)*E*((P+1)*E+P)+1)+D}function re(E,D,U,k,P){return P===void 0&&(P=1.70158),E/=k/2,E<1?U/2*(E*E*(((P*=1.525)+1)*E-P))+D:U/2*((E-=2)*E*(((P*=1.525)+1)*E+P)+2)+D}function Z(E,D,U,k){return U-oe(k-E,0,U,k)+D}function oe(E,D,U,k){return(E/=k)<1/2.75?U*(7.5625*E*E)+D:E<2/2.75?U*(7.5625*(E-=1.5/2.75)*E+.75)+D:E<2.5/2.75?U*(7.5625*(E-=2.25/2.75)*E+.9375)+D:U*(7.5625*(E-=2.625/2.75)*E+.984375)+D}function ee(E,D,U,k){return E<k/2?Z(E*2,0,U,k)*.5+D:oe(E*2-k,0,U,k)*.5+U*.5+D}t.util.ease={easeInQuad:function(E,D,U,k){return U*(E/=k)*E+D},easeOutQuad:function(E,D,U,k){return-U*(E/=k)*(E-2)+D},easeInOutQuad:function(E,D,U,k){return E/=k/2,E<1?U/2*E*E+D:-U/2*(--E*(E-2)-1)+D},easeInCubic:function(E,D,U,k){return U*(E/=k)*E*E+D},easeOutCubic:c,easeInOutCubic:d,easeInQuart:f,easeOutQuart:h,easeInOutQuart:u,easeInQuint:g,easeOutQuint:m,easeInOutQuint:p,easeInSine:x,easeOutSine:v,easeInOutSine:y,easeInExpo:_,easeOutExpo:b,easeInOutExpo:S,easeInCirc:C,easeOutCirc:N,easeInOutCirc:F,easeInElastic:Y,easeOutElastic:X,easeInOutElastic:V,easeInBack:te,easeOutBack:G,easeInOutBack:re,easeInBounce:Z,easeOutBounce:oe,easeInOutBounce:ee}}(),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.util.object.clone,f=a.util.toFixed,h=a.util.parseUnit,u=a.util.multiplyTransformMatrices,g=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],m=["symbol","image","marker","pattern","view","svg"],p=["pattern","defs","symbol","metadata","clipPath","mask","desc"],x=["symbol","g","a","svg","clipPath","defs"],v={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},y={stroke:"strokeOpacity",fill:"fillOpacity"},_="font-size",b="clip-path";a.svgValidTagNamesRegEx=N(g),a.svgViewBoxElementsRegEx=N(m),a.svgInvalidAncestorsRegEx=N(p),a.svgValidParentsRegEx=N(x),a.cssRules={},a.gradientDefs={},a.clipPaths={};function S(A){return A in v?v[A]:A}function C(A,T,j,R){var z=Array.isArray(T),I;if((A==="fill"||A==="stroke")&&T==="none")T="";else{if(A==="strokeUniform")return T==="non-scaling-stroke";if(A==="strokeDashArray")T==="none"?T=null:T=T.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(A==="transformMatrix")j&&j.transformMatrix?T=u(j.transformMatrix,a.parseTransformAttribute(T)):T=a.parseTransformAttribute(T);else if(A==="visible")T=T!=="none"&&T!=="hidden",j&&j.visible===!1&&(T=!1);else if(A==="opacity")T=parseFloat(T),j&&typeof j.opacity<"u"&&(T*=j.opacity);else if(A==="textAnchor")T=T==="start"?"left":T==="end"?"right":"center";else if(A==="charSpacing")I=h(T,R)/R*1e3;else if(A==="paintFirst"){var L=T.indexOf("fill"),K=T.indexOf("stroke"),T="fill";(L>-1&&K>-1&&K<L||L===-1&&K>-1)&&(T="stroke")}else{if(A==="href"||A==="xlink:href"||A==="font")return T;if(A==="imageSmoothing")return T==="optimizeQuality";I=z?T.map(h):h(T,R)}}return!z&&isNaN(I)?T:I}function N(A){return new RegExp("^("+A.join("|")+")\\b","i")}function F(A){for(var T in y)if(!(typeof A[y[T]]>"u"||A[T]==="")){if(typeof A[T]>"u"){if(!a.Object.prototype[T])continue;A[T]=a.Object.prototype[T]}if(A[T].indexOf("url(")!==0){var j=new a.Color(A[T]);A[T]=j.setAlpha(f(j.getAlpha()*A[y[T]],2)).toRgba()}}return A}function Y(A,T){var j,R=[],z,I,L;for(I=0,L=T.length;I<L;I++)j=T[I],z=A.getElementsByTagName(j),R=R.concat(Array.prototype.slice.call(z));return R}a.parseTransformAttribute=function(){function A(fe,ve){var Ce=a.util.cos(ve[0]),De=a.util.sin(ve[0]),je=0,Ie=0;ve.length===3&&(je=ve[1],Ie=ve[2]),fe[0]=Ce,fe[1]=De,fe[2]=-De,fe[3]=Ce,fe[4]=je-(Ce*je-De*Ie),fe[5]=Ie-(De*je+Ce*Ie)}function T(fe,ve){var Ce=ve[0],De=ve.length===2?ve[1]:ve[0];fe[0]=Ce,fe[3]=De}function j(fe,ve,Ce){fe[Ce]=Math.tan(a.util.degreesToRadians(ve[0]))}function R(fe,ve){fe[4]=ve[0],ve.length===2&&(fe[5]=ve[1])}var z=a.iMatrix,I=a.reNum,L=a.commaWsp,K="(?:(skewX)\\s*\\(\\s*("+I+")\\s*\\))",O="(?:(skewY)\\s*\\(\\s*("+I+")\\s*\\))",B="(?:(rotate)\\s*\\(\\s*("+I+")(?:"+L+"("+I+")"+L+"("+I+"))?\\s*\\))",M="(?:(scale)\\s*\\(\\s*("+I+")(?:"+L+"("+I+"))?\\s*\\))",J="(?:(translate)\\s*\\(\\s*("+I+")(?:"+L+"("+I+"))?\\s*\\))",se="(?:(matrix)\\s*\\(\\s*("+I+")"+L+"("+I+")"+L+"("+I+")"+L+"("+I+")"+L+"("+I+")"+L+"("+I+")\\s*\\))",H="(?:"+se+"|"+J+"|"+M+"|"+B+"|"+K+"|"+O+")",ce="(?:"+H+"(?:"+L+"*"+H+")*)",ue="^\\s*(?:"+ce+"?)\\s*$",xe=new RegExp(ue),_e=new RegExp(H,"g");return function(fe){var ve=z.concat(),Ce=[];if(!fe||fe&&!xe.test(fe))return ve;fe.replace(_e,function(je){var Ie=new RegExp(H).exec(je).filter(function(Le){return!!Le}),Ye=Ie[1],et=Ie.slice(2).map(parseFloat);switch(Ye){case"translate":R(ve,et);break;case"rotate":et[0]=a.util.degreesToRadians(et[0]),A(ve,et);break;case"scale":T(ve,et);break;case"skewX":j(ve,et,2);break;case"skewY":j(ve,et,1);break;case"matrix":ve=et;break}Ce.push(ve.concat()),ve=z.concat()});for(var De=Ce[0];Ce.length>1;)Ce.shift(),De=a.util.multiplyTransformMatrices(De,Ce[0]);return De}}();function X(A,T){var j,R;A.replace(/;\s*$/,"").split(";").forEach(function(z){var I=z.split(":");j=I[0].trim().toLowerCase(),R=I[1].trim(),T[j]=R})}function V(A,T){var j,R;for(var z in A)typeof A[z]>"u"||(j=z.toLowerCase(),R=A[z],T[j]=R)}function te(A,T){var j={};for(var R in a.cssRules[T])if(G(A,R.split(" ")))for(var z in a.cssRules[T][R])j[z]=a.cssRules[T][R][z];return j}function G(A,T){var j,R=!0;return j=Z(A,T.pop()),j&&T.length&&(R=re(A,T)),j&&R&&T.length===0}function re(A,T){for(var j,R=!0;A.parentNode&&A.parentNode.nodeType===1&&T.length;)R&&(j=T.pop()),A=A.parentNode,R=Z(A,j);return T.length===0}function Z(A,T){var j=A.nodeName,R=A.getAttribute("class"),z=A.getAttribute("id"),I,L;if(I=new RegExp("^"+j,"i"),T=T.replace(I,""),z&&T.length&&(I=new RegExp("#"+z+"(?![a-zA-Z\\-]+)","i"),T=T.replace(I,"")),R&&T.length)for(R=R.split(" "),L=R.length;L--;)I=new RegExp("\\."+R[L]+"(?![a-zA-Z\\-]+)","i"),T=T.replace(I,"");return T.length===0}function oe(A,T){var j;if(A.getElementById&&(j=A.getElementById(T)),j)return j;var R,z,I,L=A.getElementsByTagName("*");for(z=0,I=L.length;z<I;z++)if(R=L[z],T===R.getAttribute("id"))return R}function ee(A){for(var T=Y(A,["use","svg:use"]),j=0;T.length&&j<T.length;){var R=T[j],z=R.getAttribute("xlink:href")||R.getAttribute("href");if(z===null)return;var I=z.slice(1),L=R.getAttribute("x")||0,K=R.getAttribute("y")||0,O=oe(A,I).cloneNode(!0),B=(O.getAttribute("transform")||"")+" translate("+L+", "+K+")",M,J=T.length,se,H,ce,ue,xe=a.svgNS;if(D(O),/^svg$/i.test(O.nodeName)){var _e=O.ownerDocument.createElementNS(xe,"g");for(H=0,ce=O.attributes,ue=ce.length;H<ue;H++)se=ce.item(H),_e.setAttributeNS(xe,se.nodeName,se.nodeValue);for(;O.firstChild;)_e.appendChild(O.firstChild);O=_e}for(H=0,ce=R.attributes,ue=ce.length;H<ue;H++)se=ce.item(H),!(se.nodeName==="x"||se.nodeName==="y"||se.nodeName==="xlink:href"||se.nodeName==="href")&&(se.nodeName==="transform"?B=se.nodeValue+" "+B:O.setAttribute(se.nodeName,se.nodeValue));O.setAttribute("transform",B),O.setAttribute("instantiated_by_use","1"),O.removeAttribute("id"),M=R.parentNode,M.replaceChild(O,R),T.length===J&&j++}}var E=new RegExp("^\\s*("+a.reNum+"+)\\s*,?\\s*("+a.reNum+"+)\\s*,?\\s*("+a.reNum+"+)\\s*,?\\s*("+a.reNum+"+)\\s*$");function D(A){if(!a.svgViewBoxElementsRegEx.test(A.nodeName))return{};var T=A.getAttribute("viewBox"),j=1,R=1,z=0,I=0,L,K,O,B,M=A.getAttribute("width"),J=A.getAttribute("height"),se=A.getAttribute("x")||0,H=A.getAttribute("y")||0,ce=A.getAttribute("preserveAspectRatio")||"",ue=!T||!(T=T.match(E)),xe=!M||!J||M==="100%"||J==="100%",_e=ue&&xe,fe={},ve="",Ce=0,De=0;if(fe.width=0,fe.height=0,fe.toBeParsed=_e,ue&&(se||H)&&A.parentNode&&A.parentNode.nodeName!=="#document"&&(ve=" translate("+h(se)+" "+h(H)+") ",O=(A.getAttribute("transform")||"")+ve,A.setAttribute("transform",O),A.removeAttribute("x"),A.removeAttribute("y")),_e)return fe;if(ue)return fe.width=h(M),fe.height=h(J),fe;if(z=-parseFloat(T[1]),I=-parseFloat(T[2]),L=parseFloat(T[3]),K=parseFloat(T[4]),fe.minX=z,fe.minY=I,fe.viewBoxWidth=L,fe.viewBoxHeight=K,xe?(fe.width=L,fe.height=K):(fe.width=h(M),fe.height=h(J),j=fe.width/L,R=fe.height/K),ce=a.util.parsePreserveAspectRatioAttribute(ce),ce.alignX!=="none"&&(ce.meetOrSlice==="meet"&&(R=j=j>R?R:j),ce.meetOrSlice==="slice"&&(R=j=j>R?j:R),Ce=fe.width-L*j,De=fe.height-K*j,ce.alignX==="Mid"&&(Ce/=2),ce.alignY==="Mid"&&(De/=2),ce.alignX==="Min"&&(Ce=0),ce.alignY==="Min"&&(De=0)),j===1&&R===1&&z===0&&I===0&&se===0&&H===0)return fe;if((se||H)&&A.parentNode.nodeName!=="#document"&&(ve=" translate("+h(se)+" "+h(H)+") "),O=ve+" matrix("+j+" 0 0 "+R+" "+(z*j+Ce)+" "+(I*R+De)+") ",A.nodeName==="svg"){for(B=A.ownerDocument.createElementNS(a.svgNS,"g");A.firstChild;)B.appendChild(A.firstChild);A.appendChild(B)}else B=A,B.removeAttribute("x"),B.removeAttribute("y"),O=B.getAttribute("transform")+O;return B.setAttribute("transform",O),fe}function U(A,T){for(;A&&(A=A.parentNode);)if(A.nodeName&&T.test(A.nodeName.replace("svg:",""))&&!A.getAttribute("instantiated_by_use"))return!0;return!1}a.parseSVGDocument=function(A,T,j,R){if(A){ee(A);var z=a.Object.__uid++,I,L,K=D(A),O=a.util.toArray(A.getElementsByTagName("*"));if(K.crossOrigin=R&&R.crossOrigin,K.svgUid=z,O.length===0&&a.isLikelyNode){O=A.selectNodes('//*[name(.)!="svg"]');var B=[];for(I=0,L=O.length;I<L;I++)B[I]=O[I];O=B}var M=O.filter(function(se){return D(se),a.svgValidTagNamesRegEx.test(se.nodeName.replace("svg:",""))&&!U(se,a.svgInvalidAncestorsRegEx)});if(!M||M&&!M.length){T&&T([],{});return}var J={};O.filter(function(se){return se.nodeName.replace("svg:","")==="clipPath"}).forEach(function(se){var H=se.getAttribute("id");J[H]=a.util.toArray(se.getElementsByTagName("*")).filter(function(ce){return a.svgValidTagNamesRegEx.test(ce.nodeName.replace("svg:",""))})}),a.gradientDefs[z]=a.getGradientDefs(A),a.cssRules[z]=a.getCSSRules(A),a.clipPaths[z]=J,a.parseElements(M,function(se,H){T&&(T(se,K,H,O),delete a.gradientDefs[z],delete a.cssRules[z],delete a.clipPaths[z])},d(K),j,R)}};function k(A,T){var j=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],R="xlink:href",z=T.getAttribute(R).slice(1),I=oe(A,z);if(I&&I.getAttribute(R)&&k(A,I),j.forEach(function(K){I&&!T.hasAttribute(K)&&I.hasAttribute(K)&&T.setAttribute(K,I.getAttribute(K))}),!T.children.length)for(var L=I.cloneNode(!0);L.firstChild;)T.appendChild(L.firstChild);T.removeAttribute(R)}var P=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+a.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+a.reNum+"))?\\s+(.*)");c(a,{parseFontDeclaration:function(A,T){var j=A.match(P);if(j){var R=j[1],z=j[3],I=j[4],L=j[5],K=j[6];R&&(T.fontStyle=R),z&&(T.fontWeight=isNaN(parseFloat(z))?z:parseFloat(z)),I&&(T.fontSize=h(I)),K&&(T.fontFamily=K),L&&(T.lineHeight=L==="normal"?1:L)}},getGradientDefs:function(A){var T=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],j=Y(A,T),R,z=0,I={};for(z=j.length;z--;)R=j[z],R.getAttribute("xlink:href")&&k(A,R),I[R.getAttribute("id")]=R;return I},parseAttributes:function(A,T,j){if(A){var R,z={},I,L;typeof j>"u"&&(j=A.getAttribute("svgUid")),A.parentNode&&a.svgValidParentsRegEx.test(A.parentNode.nodeName)&&(z=a.parseAttributes(A.parentNode,T,j));var K=T.reduce(function(ce,ue){return R=A.getAttribute(ue),R&&(ce[ue]=R),ce},{}),O=c(te(A,j),a.parseStyleAttribute(A));K=c(K,O),O[b]&&A.setAttribute(b,O[b]),I=L=z.fontSize||a.Text.DEFAULT_SVG_FONT_SIZE,K[_]&&(K[_]=I=h(K[_],L));var B,M,J={};for(var se in K)B=S(se),M=C(B,K[se],z,I),J[B]=M;J&&J.font&&a.parseFontDeclaration(J.font,J);var H=c(z,J);return a.svgValidParentsRegEx.test(A.nodeName)?H:F(H)}},parseElements:function(A,T,j,R,z){new a.ElementsParser(A,T,j,R,z).parse()},parseStyleAttribute:function(A){var T={},j=A.getAttribute("style");return j&&(typeof j=="string"?X(j,T):V(j,T)),T},parsePointsAttribute:function(A){if(!A)return null;A=A.replace(/,/g," ").trim(),A=A.split(/\s+/);var T=[],j,R;for(j=0,R=A.length;j<R;j+=2)T.push({x:parseFloat(A[j]),y:parseFloat(A[j+1])});return T},getCSSRules:function(A){var T=A.getElementsByTagName("style"),j,R,z={},I;for(j=0,R=T.length;j<R;j++){var L=T[j].textContent;L=L.replace(/\/\*[\s\S]*?\*\//g,""),L.trim()!==""&&(I=L.split("}"),I=I.filter(function(K){return K.trim()}),I.forEach(function(K){var O=K.split("{"),B={},M=O[1].trim(),J=M.split(";").filter(function(ue){return ue.trim()});for(j=0,R=J.length;j<R;j++){var se=J[j].split(":"),H=se[0].trim(),ce=se[1].trim();B[H]=ce}K=O[0].trim(),K.split(",").forEach(function(ue){ue=ue.replace(/^svg/i,"").trim(),ue!==""&&(z[ue]?a.util.object.extend(z[ue],B):z[ue]=a.util.object.clone(B))})}))}return z},loadSVGFromURL:function(A,T,j,R){A=A.replace(/^\n\s*/,"").trim(),new a.util.request(A,{method:"get",onComplete:z});function z(I){var L=I.responseXML;if(!L||!L.documentElement)return T&&T(null),!1;a.parseSVGDocument(L.documentElement,function(K,O,B,M){T&&T(K,O,B,M)},j,R)}},loadSVGFromString:function(A,T,j,R){var z=new a.window.DOMParser,I=z.parseFromString(A.trim(),"text/xml");a.parseSVGDocument(I.documentElement,function(L,K,O,B){T(L,K,O,B)},j,R)}})}(e),t.ElementsParser=function(o,a,c,d,f,h){this.elements=o,this.callback=a,this.options=c,this.reviver=d,this.svgUid=c&&c.svgUid||0,this.parsingOptions=f,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=h},function(o){o.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},o.createObjects=function(){var a=this;this.elements.forEach(function(c,d){c.setAttribute("svgUid",a.svgUid),a.createObject(c,d)})},o.findTag=function(a){return t[t.util.string.capitalize(a.tagName.replace("svg:",""))]},o.createObject=function(a,c){var d=this.findTag(a);if(d&&d.fromElement)try{d.fromElement(a,this.createCallback(c,a),this.options)}catch(f){t.log(f)}else this.checkIfDone()},o.createCallback=function(a,c){var d=this;return function(f){var h;d.resolveGradient(f,c,"fill"),d.resolveGradient(f,c,"stroke"),f instanceof t.Image&&f._originalElement&&(h=f.parsePreserveAspectRatioAttribute(c)),f._removeTransformMatrix(h),d.resolveClipPath(f,c),d.reviver&&d.reviver(c,f),d.instances[a]=f,d.checkIfDone()}},o.extractPropertyDefinition=function(a,c,d){var f=a[c],h=this.regexUrl;if(h.test(f)){h.lastIndex=0;var u=h.exec(f)[1];return h.lastIndex=0,t[d][this.svgUid][u]}},o.resolveGradient=function(a,c,d){var f=this.extractPropertyDefinition(a,d,"gradientDefs");if(f){var h=c.getAttribute(d+"-opacity"),u=t.Gradient.fromElement(f,a,h,this.options);a.set(d,u)}},o.createClipPathCallback=function(a,c){return function(d){d._removeTransformMatrix(),d.fillRule=d.clipRule,c.push(d)}},o.resolveClipPath=function(a,c){var d=this.extractPropertyDefinition(a,"clipPath","clipPaths"),f,h,u,g,m,p;if(d){g=[],u=t.util.invertTransform(a.calcTransformMatrix());for(var x=d[0].parentNode,v=c;v.parentNode&&v.getAttribute("clip-path")!==a.clipPath;)v=v.parentNode;v.parentNode.appendChild(x);for(var y=0;y<d.length;y++)f=d[y],h=this.findTag(f),h.fromElement(f,this.createClipPathCallback(a,g),this.options);g.length===1?d=g[0]:d=new t.Group(g),m=t.util.multiplyTransformMatrices(u,d.calcTransformMatrix()),d.clipPath&&this.resolveClipPath(d,v);var p=t.util.qrDecompose(m);d.flipX=!1,d.flipY=!1,d.set("scaleX",p.scaleX),d.set("scaleY",p.scaleY),d.angle=p.angle,d.skewX=p.skewX,d.skewY=0,d.setPositionByOrigin({x:p.translateX,y:p.translateY},"center","center"),a.clipPath=d}else delete a.clipPath},o.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(a){return a!=null}),this.callback(this.instances,this.elements))}}(t.ElementsParser.prototype),function(o){var a=o.fabric||(o.fabric={});if(a.Point){a.warn("fabric.Point is already defined");return}a.Point=c;function c(d,f){this.x=d,this.y=f}c.prototype={type:"point",constructor:c,add:function(d){return new c(this.x+d.x,this.y+d.y)},addEquals:function(d){return this.x+=d.x,this.y+=d.y,this},scalarAdd:function(d){return new c(this.x+d,this.y+d)},scalarAddEquals:function(d){return this.x+=d,this.y+=d,this},subtract:function(d){return new c(this.x-d.x,this.y-d.y)},subtractEquals:function(d){return this.x-=d.x,this.y-=d.y,this},scalarSubtract:function(d){return new c(this.x-d,this.y-d)},scalarSubtractEquals:function(d){return this.x-=d,this.y-=d,this},multiply:function(d){return new c(this.x*d,this.y*d)},multiplyEquals:function(d){return this.x*=d,this.y*=d,this},divide:function(d){return new c(this.x/d,this.y/d)},divideEquals:function(d){return this.x/=d,this.y/=d,this},eq:function(d){return this.x===d.x&&this.y===d.y},lt:function(d){return this.x<d.x&&this.y<d.y},lte:function(d){return this.x<=d.x&&this.y<=d.y},gt:function(d){return this.x>d.x&&this.y>d.y},gte:function(d){return this.x>=d.x&&this.y>=d.y},lerp:function(d,f){return typeof f>"u"&&(f=.5),f=Math.max(Math.min(1,f),0),new c(this.x+(d.x-this.x)*f,this.y+(d.y-this.y)*f)},distanceFrom:function(d){var f=this.x-d.x,h=this.y-d.y;return Math.sqrt(f*f+h*h)},midPointFrom:function(d){return this.lerp(d)},min:function(d){return new c(Math.min(this.x,d.x),Math.min(this.y,d.y))},max:function(d){return new c(Math.max(this.x,d.x),Math.max(this.y,d.y))},toString:function(){return this.x+","+this.y},setXY:function(d,f){return this.x=d,this.y=f,this},setX:function(d){return this.x=d,this},setY:function(d){return this.y=d,this},setFromPoint:function(d){return this.x=d.x,this.y=d.y,this},swap:function(d){var f=this.x,h=this.y;this.x=d.x,this.y=d.y,d.x=f,d.y=h},clone:function(){return new c(this.x,this.y)}}}(e),function(o){var a=o.fabric||(o.fabric={});if(a.Intersection){a.warn("fabric.Intersection is already defined");return}function c(d){this.status=d,this.points=[]}a.Intersection=c,a.Intersection.prototype={constructor:c,appendPoint:function(d){return this.points.push(d),this},appendPoints:function(d){return this.points=this.points.concat(d),this}},a.Intersection.intersectLineLine=function(d,f,h,u){var g,m=(u.x-h.x)*(d.y-h.y)-(u.y-h.y)*(d.x-h.x),p=(f.x-d.x)*(d.y-h.y)-(f.y-d.y)*(d.x-h.x),x=(u.y-h.y)*(f.x-d.x)-(u.x-h.x)*(f.y-d.y);if(x!==0){var v=m/x,y=p/x;0<=v&&v<=1&&0<=y&&y<=1?(g=new c("Intersection"),g.appendPoint(new a.Point(d.x+v*(f.x-d.x),d.y+v*(f.y-d.y)))):g=new c}else m===0||p===0?g=new c("Coincident"):g=new c("Parallel");return g},a.Intersection.intersectLinePolygon=function(d,f,h){var u=new c,g=h.length,m,p,x,v;for(v=0;v<g;v++)m=h[v],p=h[(v+1)%g],x=c.intersectLineLine(d,f,m,p),u.appendPoints(x.points);return u.points.length>0&&(u.status="Intersection"),u},a.Intersection.intersectPolygonPolygon=function(d,f){var h=new c,u=d.length,g;for(g=0;g<u;g++){var m=d[g],p=d[(g+1)%u],x=c.intersectLinePolygon(m,p,f);h.appendPoints(x.points)}return h.points.length>0&&(h.status="Intersection"),h},a.Intersection.intersectPolygonRectangle=function(d,f,h){var u=f.min(h),g=f.max(h),m=new a.Point(g.x,u.y),p=new a.Point(u.x,g.y),x=c.intersectLinePolygon(u,m,d),v=c.intersectLinePolygon(m,g,d),y=c.intersectLinePolygon(g,p,d),_=c.intersectLinePolygon(p,u,d),b=new c;return b.appendPoints(x.points),b.appendPoints(v.points),b.appendPoints(y.points),b.appendPoints(_.points),b.points.length>0&&(b.status="Intersection"),b}}(e),function(o){var a=o.fabric||(o.fabric={});if(a.Color){a.warn("fabric.Color is already defined.");return}function c(f){f?this._tryParsingColor(f):this.setSource([0,0,0,1])}a.Color=c,a.Color.prototype={_tryParsingColor:function(f){var h;f in c.colorNameMap&&(f=c.colorNameMap[f]),f==="transparent"&&(h=[255,255,255,0]),h||(h=c.sourceFromHex(f)),h||(h=c.sourceFromRgb(f)),h||(h=c.sourceFromHsl(f)),h||(h=[0,0,0,1]),h&&this.setSource(h)},_rgbToHsl:function(f,h,u){f/=255,h/=255,u/=255;var g,m,p,x=a.util.array.max([f,h,u]),v=a.util.array.min([f,h,u]);if(p=(x+v)/2,x===v)g=m=0;else{var y=x-v;switch(m=p>.5?y/(2-x-v):y/(x+v),x){case f:g=(h-u)/y+(h<u?6:0);break;case h:g=(u-f)/y+2;break;case u:g=(f-h)/y+4;break}g/=6}return[Math.round(g*360),Math.round(m*100),Math.round(p*100)]},getSource:function(){return this._source},setSource:function(f){this._source=f},toRgb:function(){var f=this.getSource();return"rgb("+f[0]+","+f[1]+","+f[2]+")"},toRgba:function(){var f=this.getSource();return"rgba("+f[0]+","+f[1]+","+f[2]+","+f[3]+")"},toHsl:function(){var f=this.getSource(),h=this._rgbToHsl(f[0],f[1],f[2]);return"hsl("+h[0]+","+h[1]+"%,"+h[2]+"%)"},toHsla:function(){var f=this.getSource(),h=this._rgbToHsl(f[0],f[1],f[2]);return"hsla("+h[0]+","+h[1]+"%,"+h[2]+"%,"+f[3]+")"},toHex:function(){var f=this.getSource(),h,u,g;return h=f[0].toString(16),h=h.length===1?"0"+h:h,u=f[1].toString(16),u=u.length===1?"0"+u:u,g=f[2].toString(16),g=g.length===1?"0"+g:g,h.toUpperCase()+u.toUpperCase()+g.toUpperCase()},toHexa:function(){var f=this.getSource(),h;return h=Math.round(f[3]*255),h=h.toString(16),h=h.length===1?"0"+h:h,this.toHex()+h.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(f){var h=this.getSource();return h[3]=f,this.setSource(h),this},toGrayscale:function(){var f=this.getSource(),h=parseInt((f[0]*.3+f[1]*.59+f[2]*.11).toFixed(0),10),u=f[3];return this.setSource([h,h,h,u]),this},toBlackWhite:function(f){var h=this.getSource(),u=(h[0]*.3+h[1]*.59+h[2]*.11).toFixed(0),g=h[3];return f=f||127,u=Number(u)<Number(f)?0:255,this.setSource([u,u,u,g]),this},overlayWith:function(f){f instanceof c||(f=new c(f));var h=[],u=this.getAlpha(),g=.5,m=this.getSource(),p=f.getSource(),x;for(x=0;x<3;x++)h.push(Math.round(m[x]*(1-g)+p[x]*g));return h[3]=u,this.setSource(h),this}},a.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,a.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,a.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,a.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function d(f,h,u){return u<0&&(u+=1),u>1&&(u-=1),u<1/6?f+(h-f)*6*u:u<1/2?h:u<2/3?f+(h-f)*(2/3-u)*6:f}a.Color.fromRgb=function(f){return c.fromSource(c.sourceFromRgb(f))},a.Color.sourceFromRgb=function(f){var h=f.match(c.reRGBa);if(h){var u=parseInt(h[1],10)/(/%$/.test(h[1])?100:1)*(/%$/.test(h[1])?255:1),g=parseInt(h[2],10)/(/%$/.test(h[2])?100:1)*(/%$/.test(h[2])?255:1),m=parseInt(h[3],10)/(/%$/.test(h[3])?100:1)*(/%$/.test(h[3])?255:1);return[parseInt(u,10),parseInt(g,10),parseInt(m,10),h[4]?parseFloat(h[4]):1]}},a.Color.fromRgba=c.fromRgb,a.Color.fromHsl=function(f){return c.fromSource(c.sourceFromHsl(f))},a.Color.sourceFromHsl=function(f){var h=f.match(c.reHSLa);if(h){var u=(parseFloat(h[1])%360+360)%360/360,g=parseFloat(h[2])/(/%$/.test(h[2])?100:1),m=parseFloat(h[3])/(/%$/.test(h[3])?100:1),p,x,v;if(g===0)p=x=v=m;else{var y=m<=.5?m*(g+1):m+g-m*g,_=m*2-y;p=d(_,y,u+1/3),x=d(_,y,u),v=d(_,y,u-1/3)}return[Math.round(p*255),Math.round(x*255),Math.round(v*255),h[4]?parseFloat(h[4]):1]}},a.Color.fromHsla=c.fromHsl,a.Color.fromHex=function(f){return c.fromSource(c.sourceFromHex(f))},a.Color.sourceFromHex=function(f){if(f.match(c.reHex)){var h=f.slice(f.indexOf("#")+1),u=h.length===3||h.length===4,g=h.length===8||h.length===4,m=u?h.charAt(0)+h.charAt(0):h.substring(0,2),p=u?h.charAt(1)+h.charAt(1):h.substring(2,4),x=u?h.charAt(2)+h.charAt(2):h.substring(4,6),v=g?u?h.charAt(3)+h.charAt(3):h.substring(6,8):"FF";return[parseInt(m,16),parseInt(p,16),parseInt(x,16),parseFloat((parseInt(v,16)/255).toFixed(2))]}},a.Color.fromSource=function(f){var h=new c;return h.setSource(f),h}}(e),function(o){var a=o.fabric||(o.fabric={}),c=["e","se","s","sw","w","nw","n","ne","e"],d=["ns","nesw","ew","nwse"],f={},h="left",u="top",g="right",m="bottom",p="center",x={top:m,bottom:u,left:g,right:h,center:p},v=a.util.radiansToDegrees,y=Math.sign||function(B){return(B>0)-(B<0)||+B};function _(B,M){var J=B.angle+v(Math.atan2(M.y,M.x))+360;return Math.round(J%360/45)}function b(B,M){var J=M.transform.target,se=J.canvas,H=a.util.object.clone(M);H.target=J,se&&se.fire("object:"+B,H),J.fire(B,M)}function S(B,M){var J=M.canvas,se=J.uniScaleKey,H=B[se];return J.uniformScaling&&!H||!J.uniformScaling&&H}function C(B){return B.originX===p&&B.originY===p}function N(B,M,J){var se=B.lockScalingX,H=B.lockScalingY;return!!(se&&H||!M&&(se||H)&&J||se&&M==="x"||H&&M==="y")}function F(B,M,J){var se="not-allowed",H=S(B,J),ce="";if(M.x!==0&&M.y===0?ce="x":M.x===0&&M.y!==0&&(ce="y"),N(J,ce,H))return se;var ue=_(J,M);return c[ue]+"-resize"}function Y(B,M,J){var se="not-allowed";if(M.x!==0&&J.lockSkewingY||M.y!==0&&J.lockSkewingX)return se;var H=_(J,M)%4;return d[H]+"-resize"}function X(B,M,J){return B[J.canvas.altActionKey]?f.skewCursorStyleHandler(B,M,J):f.scaleCursorStyleHandler(B,M,J)}function V(B,M,J){var se=B[J.canvas.altActionKey];if(M.x===0)return se?"skewX":"scaleY";if(M.y===0)return se?"skewY":"scaleX"}function te(B,M,J){return J.lockRotation?"not-allowed":M.cursorStyle}function G(B,M,J,se){return{e:B,transform:M,pointer:{x:J,y:se}}}function re(B){return function(M,J,se,H){var ce=J.target,ue=ce.getCenterPoint(),xe=ce.translateToOriginPoint(ue,J.originX,J.originY),_e=B(M,J,se,H);return ce.setPositionByOrigin(xe,J.originX,J.originY),_e}}function Z(B,M){return function(J,se,H,ce){var ue=M(J,se,H,ce);return ue&&b(B,G(J,se,H,ce)),ue}}function oe(B,M,J,se,H){var ce=B.target,ue=ce.controls[B.corner],xe=ce.canvas.getZoom(),_e=ce.padding/xe,fe=ce.toLocalPoint(new a.Point(se,H),M,J);return fe.x>=_e&&(fe.x-=_e),fe.x<=-_e&&(fe.x+=_e),fe.y>=_e&&(fe.y-=_e),fe.y<=_e&&(fe.y+=_e),fe.x-=ue.offsetX,fe.y-=ue.offsetY,fe}function ee(B){return B.flipX!==B.flipY}function E(B,M,J,se,H){if(B[M]!==0){var ce=B._getTransformedDimensions()[se],ue=H/ce*B[J];B.set(J,ue)}}function D(B,M,J,se){var H=M.target,ce=H._getTransformedDimensions(0,H.skewY),ue=oe(M,M.originX,M.originY,J,se),xe=Math.abs(ue.x*2)-ce.x,_e=H.skewX,fe;xe<2?fe=0:(fe=v(Math.atan2(xe/H.scaleX,ce.y/H.scaleY)),M.originX===h&&M.originY===m&&(fe=-fe),M.originX===g&&M.originY===u&&(fe=-fe),ee(H)&&(fe=-fe));var ve=_e!==fe;if(ve){var Ce=H._getTransformedDimensions().y;H.set("skewX",fe),E(H,"skewY","scaleY","y",Ce)}return ve}function U(B,M,J,se){var H=M.target,ce=H._getTransformedDimensions(H.skewX,0),ue=oe(M,M.originX,M.originY,J,se),xe=Math.abs(ue.y*2)-ce.y,_e=H.skewY,fe;xe<2?fe=0:(fe=v(Math.atan2(xe/H.scaleY,ce.x/H.scaleX)),M.originX===h&&M.originY===m&&(fe=-fe),M.originX===g&&M.originY===u&&(fe=-fe),ee(H)&&(fe=-fe));var ve=_e!==fe;if(ve){var Ce=H._getTransformedDimensions().x;H.set("skewY",fe),E(H,"skewX","scaleX","x",Ce)}return ve}function k(B,M,J,se){var H=M.target,ce=H.skewX,ue,xe=M.originY;if(H.lockSkewingX)return!1;if(ce===0){var _e=oe(M,p,p,J,se);_e.x>0?ue=h:ue=g}else ce>0&&(ue=xe===u?h:g),ce<0&&(ue=xe===u?g:h),ee(H)&&(ue=ue===h?g:h);M.originX=ue;var fe=Z("skewing",re(D));return fe(B,M,J,se)}function P(B,M,J,se){var H=M.target,ce=H.skewY,ue,xe=M.originX;if(H.lockSkewingY)return!1;if(ce===0){var _e=oe(M,p,p,J,se);_e.y>0?ue=u:ue=m}else ce>0&&(ue=xe===h?u:m),ce<0&&(ue=xe===h?m:u),ee(H)&&(ue=ue===u?m:u);M.originY=ue;var fe=Z("skewing",re(U));return fe(B,M,J,se)}function A(B,M,J,se){var H=M,ce=H.target,ue=ce.translateToOriginPoint(ce.getCenterPoint(),H.originX,H.originY);if(ce.lockRotation)return!1;var xe=Math.atan2(H.ey-ue.y,H.ex-ue.x),_e=Math.atan2(se-ue.y,J-ue.x),fe=v(_e-xe+H.theta),ve=!0;if(ce.snapAngle>0){var Ce=ce.snapAngle,De=ce.snapThreshold||Ce,je=Math.ceil(fe/Ce)*Ce,Ie=Math.floor(fe/Ce)*Ce;Math.abs(fe-Ie)<De?fe=Ie:Math.abs(fe-je)<De&&(fe=je)}return fe<0&&(fe=360+fe),fe%=360,ve=ce.angle!==fe,ce.angle=fe,ve}function T(B,M,J,se,H){H=H||{};var ce=M.target,ue=ce.lockScalingX,xe=ce.lockScalingY,_e=H.by,fe,ve,Ce,De,je=S(B,ce),Ie=N(ce,_e,je),Ye,et,Le=M.gestureScale;if(Ie)return!1;if(Le)ve=M.scaleX*Le,Ce=M.scaleY*Le;else{if(fe=oe(M,M.originX,M.originY,J,se),Ye=_e!=="y"?y(fe.x):1,et=_e!=="x"?y(fe.y):1,M.signX||(M.signX=Ye),M.signY||(M.signY=et),ce.lockScalingFlip&&(M.signX!==Ye||M.signY!==et))return!1;if(De=ce._getTransformedDimensions(),je&&!_e){var ot=Math.abs(fe.x)+Math.abs(fe.y),gt=M.original,Ge=Math.abs(De.x*gt.scaleX/ce.scaleX)+Math.abs(De.y*gt.scaleY/ce.scaleY),Lr=ot/Ge;ve=gt.scaleX*Lr,Ce=gt.scaleY*Lr}else ve=Math.abs(fe.x*ce.scaleX/De.x),Ce=Math.abs(fe.y*ce.scaleY/De.y);C(M)&&(ve*=2,Ce*=2),M.signX!==Ye&&_e!=="y"&&(M.originX=x[M.originX],ve*=-1,M.signX=Ye),M.signY!==et&&_e!=="x"&&(M.originY=x[M.originY],Ce*=-1,M.signY=et)}var hi=ce.scaleX,lf=ce.scaleY;return _e?(_e==="x"&&ce.set("scaleX",ve),_e==="y"&&ce.set("scaleY",Ce)):(!ue&&ce.set("scaleX",ve),!xe&&ce.set("scaleY",Ce)),hi!==ce.scaleX||lf!==ce.scaleY}function j(B,M,J,se){return T(B,M,J,se)}function R(B,M,J,se){return T(B,M,J,se,{by:"x"})}function z(B,M,J,se){return T(B,M,J,se,{by:"y"})}function I(B,M,J,se){return B[M.target.canvas.altActionKey]?f.skewHandlerX(B,M,J,se):f.scalingY(B,M,J,se)}function L(B,M,J,se){return B[M.target.canvas.altActionKey]?f.skewHandlerY(B,M,J,se):f.scalingX(B,M,J,se)}function K(B,M,J,se){var H=M.target,ce=oe(M,M.originX,M.originY,J,se),ue=H.strokeWidth/(H.strokeUniform?H.scaleX:1),xe=C(M)?2:1,_e=H.width,fe=Math.abs(ce.x*xe/H.scaleX)-ue;return H.set("width",Math.max(fe,0)),_e!==fe}function O(B,M,J,se){var H=M.target,ce=J-M.offsetX,ue=se-M.offsetY,xe=!H.get("lockMovementX")&&H.left!==ce,_e=!H.get("lockMovementY")&&H.top!==ue;return xe&&H.set("left",ce),_e&&H.set("top",ue),(xe||_e)&&b("moving",G(B,M,J,se)),xe||_e}f.scaleCursorStyleHandler=F,f.skewCursorStyleHandler=Y,f.scaleSkewCursorStyleHandler=X,f.rotationWithSnapping=Z("rotating",re(A)),f.scalingEqually=Z("scaling",re(j)),f.scalingX=Z("scaling",re(R)),f.scalingY=Z("scaling",re(z)),f.scalingYOrSkewingX=I,f.scalingXOrSkewingY=L,f.changeWidth=Z("resizing",re(K)),f.skewHandlerX=k,f.skewHandlerY=P,f.dragHandler=O,f.scaleOrSkewActionName=V,f.rotationStyleHandler=te,f.fireEvent=b,f.wrapWithFixedAnchor=re,f.wrapWithFireEvent=Z,f.getLocalPoint=oe,a.controlsUtils=f}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.degreesToRadians,d=a.controlsUtils;function f(u,g,m,p,x){p=p||{};var v=this.sizeX||p.cornerSize||x.cornerSize,y=this.sizeY||p.cornerSize||x.cornerSize,_=typeof p.transparentCorners<"u"?p.transparentCorners:x.transparentCorners,b=_?"stroke":"fill",S=!_&&(p.cornerStrokeColor||x.cornerStrokeColor),C=g,N=m,F;u.save(),u.fillStyle=p.cornerColor||x.cornerColor,u.strokeStyle=p.cornerStrokeColor||x.cornerStrokeColor,v>y?(F=v,u.scale(1,y/v),N=m*v/y):y>v?(F=y,u.scale(v/y,1),C=g*y/v):F=v,u.lineWidth=1,u.beginPath(),u.arc(C,N,F/2,0,2*Math.PI,!1),u[b](),S&&u.stroke(),u.restore()}function h(u,g,m,p,x){p=p||{};var v=this.sizeX||p.cornerSize||x.cornerSize,y=this.sizeY||p.cornerSize||x.cornerSize,_=typeof p.transparentCorners<"u"?p.transparentCorners:x.transparentCorners,b=_?"stroke":"fill",S=!_&&(p.cornerStrokeColor||x.cornerStrokeColor),C=v/2,N=y/2;u.save(),u.fillStyle=p.cornerColor||x.cornerColor,u.strokeStyle=p.cornerStrokeColor||x.cornerStrokeColor,u.lineWidth=1,u.translate(g,m),u.rotate(c(x.angle)),u[b+"Rect"](-C,-N,v,y),S&&u.strokeRect(-C,-N,v,y),u.restore()}d.renderCircleControl=f,d.renderSquareControl=h}(e),function(o){var a=o.fabric||(o.fabric={});function c(d){for(var f in d)this[f]=d[f]}a.Control=c,a.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(d,f){return f.cursorStyle},getActionName:function(d,f){return f.actionName},getVisibility:function(d,f){var h=d._controlsVisibility;return h&&typeof h[f]<"u"?h[f]:this.visible},setVisibility:function(d){this.visible=d},positionHandler:function(d,f){var h=a.util.transformPoint({x:this.x*d.x+this.offsetX,y:this.y*d.y+this.offsetY},f);return h},calcCornerCoords:function(d,f,h,u,g){var m,p,x,v,y=g?this.touchSizeX:this.sizeX,_=g?this.touchSizeY:this.sizeY;if(y&&_&&y!==_){var b=Math.atan2(_,y),S=Math.sqrt(y*y+_*_)/2,C=b-a.util.degreesToRadians(d),N=Math.PI/2-b-a.util.degreesToRadians(d);m=S*a.util.cos(C),p=S*a.util.sin(C),x=S*a.util.cos(N),v=S*a.util.sin(N)}else{var F=y&&_?y:f;S=F*.7071067812;var C=a.util.degreesToRadians(45-d);m=x=S*a.util.cos(C),p=v=S*a.util.sin(C)}return{tl:{x:h-v,y:u-x},tr:{x:h+m,y:u-p},bl:{x:h-m,y:u+p},br:{x:h+v,y:u+x}}},render:function(d,f,h,u,g){switch(u=u||{},u.cornerStyle||g.cornerStyle){case"circle":a.controlsUtils.renderCircleControl.call(this,d,f,h,u,g);break;default:a.controlsUtils.renderSquareControl.call(this,d,f,h,u,g)}}}}(e),function(){function o(h,u){var g=h.getAttribute("style"),m=h.getAttribute("offset")||0,p,x,v,y;if(m=parseFloat(m)/(/%$/.test(m)?100:1),m=m<0?0:m>1?1:m,g){var _=g.split(/\s*;\s*/);for(_[_.length-1]===""&&_.pop(),y=_.length;y--;){var b=_[y].split(/\s*:\s*/),S=b[0].trim(),C=b[1].trim();S==="stop-color"?p=C:S==="stop-opacity"&&(v=C)}}return p||(p=h.getAttribute("stop-color")||"rgb(0,0,0)"),v||(v=h.getAttribute("stop-opacity")),p=new t.Color(p),x=p.getAlpha(),v=isNaN(parseFloat(v))?1:parseFloat(v),v*=x*u,{offset:m,color:p.toRgb(),opacity:v}}function a(h){return{x1:h.getAttribute("x1")||0,y1:h.getAttribute("y1")||0,x2:h.getAttribute("x2")||"100%",y2:h.getAttribute("y2")||0}}function c(h){return{x1:h.getAttribute("fx")||h.getAttribute("cx")||"50%",y1:h.getAttribute("fy")||h.getAttribute("cy")||"50%",r1:0,x2:h.getAttribute("cx")||"50%",y2:h.getAttribute("cy")||"50%",r2:h.getAttribute("r")||"50%"}}var d=t.util.object.clone;t.Gradient=t.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(h){h||(h={}),h.coords||(h.coords={});var u,g=this;Object.keys(h).forEach(function(m){g[m]=h[m]}),this.id?this.id+="_"+t.Object.__uid++:this.id=t.Object.__uid++,u={x1:h.coords.x1||0,y1:h.coords.y1||0,x2:h.coords.x2||0,y2:h.coords.y2||0},this.type==="radial"&&(u.r1=h.coords.r1||0,u.r2=h.coords.r2||0),this.coords=u,this.colorStops=h.colorStops.slice()},addColorStop:function(h){for(var u in h){var g=new t.Color(h[u]);this.colorStops.push({offset:parseFloat(u),color:g.toRgb(),opacity:g.getAlpha()})}return this},toObject:function(h){var u={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return t.util.populateWithProperties(this,u,h),u},toSVG:function(h,x){var g=d(this.coords,!0),m,p,x=x||{},v,y,_=d(this.colorStops,!0),b=g.r1>g.r2,S=this.gradientTransform?this.gradientTransform.concat():t.iMatrix.concat(),C=-this.offsetX,N=-this.offsetY,F=!!x.additionalTransform,Y=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(_.sort(function(re,Z){return re.offset-Z.offset}),Y==="objectBoundingBox"?(C/=h.width,N/=h.height):(C+=h.width/2,N+=h.height/2),h.type==="path"&&this.gradientUnits!=="percentage"&&(C-=h.pathOffset.x,N-=h.pathOffset.y),S[4]-=C,S[5]-=N,y='id="SVGID_'+this.id+'" gradientUnits="'+Y+'"',y+=' gradientTransform="'+(F?x.additionalTransform+" ":"")+t.util.matrixToSVG(S)+'" ',this.type==="linear"?v=["<linearGradient ",y,' x1="',g.x1,'" y1="',g.y1,'" x2="',g.x2,'" y2="',g.y2,`">
`]:this.type==="radial"&&(v=["<radialGradient ",y,' cx="',b?g.x1:g.x2,'" cy="',b?g.y1:g.y2,'" r="',b?g.r1:g.r2,'" fx="',b?g.x2:g.x1,'" fy="',b?g.y2:g.y1,`">
`]),this.type==="radial"){if(b)for(_=_.concat(),_.reverse(),m=0,p=_.length;m<p;m++)_[m].offset=1-_[m].offset;var X=Math.min(g.r1,g.r2);if(X>0){var V=Math.max(g.r1,g.r2),te=X/V;for(m=0,p=_.length;m<p;m++)_[m].offset+=te*(1-_[m].offset)}}for(m=0,p=_.length;m<p;m++){var G=_[m];v.push("<stop ",'offset="',G.offset*100+"%",'" style="stop-color:',G.color,typeof G.opacity<"u"?";stop-opacity: "+G.opacity:";",`"/>
`)}return v.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),v.join("")},toLive:function(h){var u,g=t.util.object.clone(this.coords),m,p;if(this.type){for(this.type==="linear"?u=h.createLinearGradient(g.x1,g.y1,g.x2,g.y2):this.type==="radial"&&(u=h.createRadialGradient(g.x1,g.y1,g.r1,g.x2,g.y2,g.r2)),m=0,p=this.colorStops.length;m<p;m++){var x=this.colorStops[m].color,v=this.colorStops[m].opacity,y=this.colorStops[m].offset;typeof v<"u"&&(x=new t.Color(x).setAlpha(v).toRgba()),u.addColorStop(y,x)}return u}}}),t.util.object.extend(t.Gradient,{fromElement:function(h,u,g,m){var p=parseFloat(g)/(/%$/.test(g)?100:1);p=p<0?0:p>1?1:p,isNaN(p)&&(p=1);var x=h.getElementsByTagName("stop"),v,y=h.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",_=h.getAttribute("gradientTransform")||"",b=[],S,C,N=0,F=0,Y;for(h.nodeName==="linearGradient"||h.nodeName==="LINEARGRADIENT"?(v="linear",S=a(h)):(v="radial",S=c(h)),C=x.length;C--;)b.push(o(x[C],p));Y=t.parseTransformAttribute(_),f(u,S,m,y),y==="pixels"&&(N=-u.left,F=-u.top);var X=new t.Gradient({id:h.getAttribute("id"),type:v,coords:S,colorStops:b,gradientUnits:y,gradientTransform:Y,offsetX:N,offsetY:F});return X}});function f(h,u,g,m){var p,x;Object.keys(u).forEach(function(v){p=u[v],p==="Infinity"?x=1:p==="-Infinity"?x=0:(x=parseFloat(u[v],10),typeof p=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(p)&&(x*=.01,m==="pixels"&&((v==="x1"||v==="x2"||v==="r2")&&(x*=g.viewBoxWidth||g.width),(v==="y1"||v==="y2")&&(x*=g.viewBoxHeight||g.height)))),u[v]=x})}}(),function(){var o=t.util.toFixed;t.Pattern=t.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(a,c){if(a||(a={}),this.id=t.Object.__uid++,this.setOptions(a),!a.source||a.source&&typeof a.source!="string"){c&&c(this);return}else{var d=this;this.source=t.util.createImage(),t.util.loadImage(a.source,function(f,h){d.source=f,c&&c(d,h)},null,this.crossOrigin)}},toObject:function(a){var c=t.Object.NUM_FRACTION_DIGITS,d,f;return typeof this.source.src=="string"?d=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(d=this.source.toDataURL()),f={type:"pattern",source:d,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:o(this.offsetX,c),offsetY:o(this.offsetY,c),patternTransform:this.patternTransform?this.patternTransform.concat():null},t.util.populateWithProperties(this,f,a),f},toSVG:function(a){var c=typeof this.source=="function"?this.source():this.source,d=c.width/a.width,f=c.height/a.height,h=this.offsetX/a.width,u=this.offsetY/a.height,g="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(f=1,u&&(f+=Math.abs(u))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(d=1,h&&(d+=Math.abs(h))),c.src?g=c.src:c.toDataURL&&(g=c.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+h+'" y="'+u+'" width="'+d+'" height="'+f+`">
<image x="0" y="0" width="`+c.width+'" height="'+c.height+'" xlink:href="'+g+`"></image>
</pattern>
`},setOptions:function(a){for(var c in a)this[c]=a[c]},toLive:function(a){var c=this.source;return!c||typeof c.src<"u"&&(!c.complete||c.naturalWidth===0||c.naturalHeight===0)?"":a.createPattern(c,this.repeat)}})}(),function(o){var a=o.fabric||(o.fabric={}),c=a.util.toFixed;if(a.Shadow){a.warn("fabric.Shadow is already defined.");return}a.Shadow=a.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(d){typeof d=="string"&&(d=this._parseShadow(d));for(var f in d)this[f]=d[f];this.id=a.Object.__uid++},_parseShadow:function(d){var f=d.trim(),h=a.Shadow.reOffsetsAndBlur.exec(f)||[],u=f.replace(a.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:u.trim(),offsetX:parseFloat(h[1],10)||0,offsetY:parseFloat(h[2],10)||0,blur:parseFloat(h[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(d){var f=40,h=40,u=a.Object.NUM_FRACTION_DIGITS,g=a.util.rotateVector({x:this.offsetX,y:this.offsetY},a.util.degreesToRadians(-d.angle)),m=20,p=new a.Color(this.color);return d.width&&d.height&&(f=c((Math.abs(g.x)+this.blur)/d.width,u)*100+m,h=c((Math.abs(g.y)+this.blur)/d.height,u)*100+m),d.flipX&&(g.x*=-1),d.flipY&&(g.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+h+'%" height="'+(100+2*h)+'%" x="-'+f+'%" width="'+(100+2*f)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+c(this.blur?this.blur/2:0,u)+`"></feGaussianBlur>
	<feOffset dx="`+c(g.x,u)+'" dy="'+c(g.y,u)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+p.toRgb()+'" flood-opacity="'+p.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var d={},f=a.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(h){this[h]!==f[h]&&(d[h]=this[h])},this),d}}),a.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(e),function(){if(t.StaticCanvas){t.warn("fabric.StaticCanvas is already defined.");return}var o=t.util.object.extend,a=t.util.getElementOffset,c=t.util.removeFromArray,d=t.util.toFixed,f=t.util.transformPoint,h=t.util.invertTransform,u=t.util.getNodeCanvas,g=t.util.createCanvasElement,m=new Error("Could not initialize `canvas` element");t.StaticCanvas=t.util.createClass(t.CommonMethods,{initialize:function(p,x){x||(x={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(p,x)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:t.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(p,x){var v=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(p),this._initOptions(x),this.interactive||this._initRetinaScaling(),x.overlayImage&&this.setOverlayImage(x.overlayImage,v),x.backgroundImage&&this.setBackgroundImage(x.backgroundImage,v),x.backgroundColor&&this.setBackgroundColor(x.backgroundColor,v),x.overlayColor&&this.setOverlayColor(x.overlayColor,v),this.calcOffset()},_isRetinaScaling:function(){return t.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,t.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var p=t.devicePixelRatio;this.__initRetinaScaling(p,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(p,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(p,x,v){x.setAttribute("width",this.width*p),x.setAttribute("height",this.height*p),v.scale(p,p)},calcOffset:function(){return this._offset=a(this.lowerCanvasEl),this},setOverlayImage:function(p,x,v){return this.__setBgOverlayImage("overlayImage",p,x,v)},setBackgroundImage:function(p,x,v){return this.__setBgOverlayImage("backgroundImage",p,x,v)},setOverlayColor:function(p,x){return this.__setBgOverlayColor("overlayColor",p,x)},setBackgroundColor:function(p,x){return this.__setBgOverlayColor("backgroundColor",p,x)},__setBgOverlayImage:function(p,x,v,y){return typeof x=="string"?t.util.loadImage(x,function(_,b){if(_){var S=new t.Image(_,y);this[p]=S,S.canvas=this}v&&v(_,b)},this,y&&y.crossOrigin):(y&&x.setOptions(y),this[p]=x,x&&(x.canvas=this),v&&v(x,!1)),this},__setBgOverlayColor:function(p,x,v){return this[p]=x,this._initGradient(x,p),this._initPattern(x,p,v),this},_createCanvasElement:function(){var p=g();if(!p||(p.style||(p.style={}),typeof p.getContext>"u"))throw m;return p},_initOptions:function(p){var x=this.lowerCanvasEl;this._setOptions(p),this.width=this.width||parseInt(x.width,10)||0,this.height=this.height||parseInt(x.height,10)||0,this.lowerCanvasEl.style&&(x.width=this.width,x.height=this.height,x.style.width=this.width+"px",x.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(p){p&&p.getContext?this.lowerCanvasEl=p:this.lowerCanvasEl=t.util.getById(p)||this._createCanvasElement(),t.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(p,x){return this.setDimensions({width:p},x)},setHeight:function(p,x){return this.setDimensions({height:p},x)},setDimensions:function(p,x){var v;x=x||{};for(var y in p)v=p[y],x.cssOnly||(this._setBackstoreDimension(y,p[y]),v+="px",this.hasLostContext=!0),x.backstoreOnly||this._setCssDimension(y,v);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),x.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(p,x){return this.lowerCanvasEl[p]=x,this.upperCanvasEl&&(this.upperCanvasEl[p]=x),this.cacheCanvasEl&&(this.cacheCanvasEl[p]=x),this[p]=x,this},_setCssDimension:function(p,x){return this.lowerCanvasEl.style[p]=x,this.upperCanvasEl&&(this.upperCanvasEl.style[p]=x),this.wrapperEl&&(this.wrapperEl.style[p]=x),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(p){var x=this._activeObject,v=this.backgroundImage,y=this.overlayImage,_,b,S;for(this.viewportTransform=p,b=0,S=this._objects.length;b<S;b++)_=this._objects[b],_.group||_.setCoords(!0);return x&&x.setCoords(),v&&v.setCoords(!0),y&&y.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(p,x){var v=p,y=this.viewportTransform.slice(0);p=f(p,h(this.viewportTransform)),y[0]=x,y[3]=x;var _=f(p,y);return y[4]+=v.x-_.x,y[5]+=v.y-_.y,this.setViewportTransform(y)},setZoom:function(p){return this.zoomToPoint(new t.Point(0,0),p),this},absolutePan:function(p){var x=this.viewportTransform.slice(0);return x[4]=-p.x,x[5]=-p.y,this.setViewportTransform(x)},relativePan:function(p){return this.absolutePan(new t.Point(-p.x-this.viewportTransform[4],-p.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(p){this.stateful&&p.setupState(),p._set("canvas",this),p.setCoords(),this.fire("object:added",{target:p}),p.fire("added")},_onObjectRemoved:function(p){this.fire("object:removed",{target:p}),p.fire("removed"),delete p.canvas},clearContext:function(p){return p.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var p=this.contextContainer;return this.renderCanvas(p,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=t.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var p={},x=this.width,v=this.height,y=h(this.viewportTransform);return p.tl=f({x:0,y:0},y),p.br=f({x,y:v},y),p.tr=new t.Point(p.br.x,p.tl.y),p.bl=new t.Point(p.tl.x,p.br.y),this.vptCoords=p,p},cancelRequestedRender:function(){this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(p,x){var v=this.viewportTransform,y=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(p),t.util.setImageSmoothing(p,this.imageSmoothingEnabled),this.fire("before:render",{ctx:p}),this._renderBackground(p),p.save(),p.transform(v[0],v[1],v[2],v[3],v[4],v[5]),this._renderObjects(p,x),p.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(p),y&&(y.canvas=this,y.shouldCache(),y._transformDone=!0,y.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(p)),this._renderOverlay(p),this.controlsAboveOverlay&&this.interactive&&this.drawControls(p),this.fire("after:render",{ctx:p})},drawClipPathOnCanvas:function(p){var x=this.viewportTransform,v=this.clipPath;p.save(),p.transform(x[0],x[1],x[2],x[3],x[4],x[5]),p.globalCompositeOperation="destination-in",v.transform(p),p.scale(1/v.zoomX,1/v.zoomY),p.drawImage(v._cacheCanvas,-v.cacheTranslationX,-v.cacheTranslationY),p.restore()},_renderObjects:function(p,x){var v,y;for(v=0,y=x.length;v<y;++v)x[v]&&x[v].render(p)},_renderBackgroundOrOverlay:function(p,x){var v=this[x+"Color"],y=this[x+"Image"],_=this.viewportTransform,b=this[x+"Vpt"];if(!(!v&&!y)){if(v){p.save(),p.beginPath(),p.moveTo(0,0),p.lineTo(this.width,0),p.lineTo(this.width,this.height),p.lineTo(0,this.height),p.closePath(),p.fillStyle=v.toLive?v.toLive(p,this):v,b&&p.transform(_[0],_[1],_[2],_[3],_[4],_[5]),p.transform(1,0,0,1,v.offsetX||0,v.offsetY||0);var S=v.gradientTransform||v.patternTransform;S&&p.transform(S[0],S[1],S[2],S[3],S[4],S[5]),p.fill(),p.restore()}if(y){p.save();var C=this.skipOffscreen;this.skipOffscreen=b,b&&p.transform(_[0],_[1],_[2],_[3],_[4],_[5]),y.render(p),this.skipOffscreen=C,p.restore()}}},_renderBackground:function(p){this._renderBackgroundOrOverlay(p,"background")},_renderOverlay:function(p){this._renderBackgroundOrOverlay(p,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new t.Point(this.width/2,this.height/2)},centerObjectH:function(p){return this._centerObject(p,new t.Point(this.getCenterPoint().x,p.getCenterPoint().y))},centerObjectV:function(p){return this._centerObject(p,new t.Point(p.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(p){var x=this.getCenterPoint();return this._centerObject(p,x)},viewportCenterObject:function(p){var x=this.getVpCenter();return this._centerObject(p,x)},viewportCenterObjectH:function(p){var x=this.getVpCenter();return this._centerObject(p,new t.Point(x.x,p.getCenterPoint().y)),this},viewportCenterObjectV:function(p){var x=this.getVpCenter();return this._centerObject(p,new t.Point(p.getCenterPoint().x,x.y))},getVpCenter:function(){var p=this.getCenterPoint(),x=h(this.viewportTransform);return f(p,x)},_centerObject:function(p,x){return p.setPositionByOrigin(x,"center","center"),p.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(p){return this.toDatalessObject(p)},toObject:function(p){return this._toObjectMethod("toObject",p)},toDatalessObject:function(p){return this._toObjectMethod("toDatalessObject",p)},_toObjectMethod:function(p,x){var v=this.clipPath,y={version:t.version,objects:this._toObjects(p,x)};return v&&!v.excludeFromExport&&(y.clipPath=this._toObject(this.clipPath,p,x)),o(y,this.__serializeBgOverlay(p,x)),t.util.populateWithProperties(this,y,x),y},_toObjects:function(p,x){return this._objects.filter(function(v){return!v.excludeFromExport}).map(function(v){return this._toObject(v,p,x)},this)},_toObject:function(p,x,v){var y;this.includeDefaultValues||(y=p.includeDefaultValues,p.includeDefaultValues=!1);var _=p[x](v);return this.includeDefaultValues||(p.includeDefaultValues=y),_},__serializeBgOverlay:function(p,x){var v={},y=this.backgroundImage,_=this.overlayImage,b=this.backgroundColor,S=this.overlayColor;return b&&b.toObject?b.excludeFromExport||(v.background=b.toObject(x)):b&&(v.background=b),S&&S.toObject?S.excludeFromExport||(v.overlay=S.toObject(x)):S&&(v.overlay=S),y&&!y.excludeFromExport&&(v.backgroundImage=this._toObject(y,p,x)),_&&!_.excludeFromExport&&(v.overlayImage=this._toObject(_,p,x)),v},svgViewportTransformation:!0,toSVG:function(p,x){p||(p={}),p.reviver=x;var v=[];return this._setSVGPreamble(v,p),this._setSVGHeader(v,p),this.clipPath&&v.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(v,"background"),this._setSVGBgOverlayImage(v,"backgroundImage",x),this._setSVGObjects(v,x),this.clipPath&&v.push(`</g>
`),this._setSVGBgOverlayColor(v,"overlay"),this._setSVGBgOverlayImage(v,"overlayImage",x),v.push("</svg>"),v.join("")},_setSVGPreamble:function(p,x){x.suppressPreamble||p.push('<?xml version="1.0" encoding="',x.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(p,x){var v=x.width||this.width,y=x.height||this.height,_,b='viewBox="0 0 '+this.width+" "+this.height+'" ',S=t.Object.NUM_FRACTION_DIGITS;x.viewBox?b='viewBox="'+x.viewBox.x+" "+x.viewBox.y+" "+x.viewBox.width+" "+x.viewBox.height+'" ':this.svgViewportTransformation&&(_=this.viewportTransform,b='viewBox="'+d(-_[4]/_[0],S)+" "+d(-_[5]/_[3],S)+" "+d(this.width/_[0],S)+" "+d(this.height/_[3],S)+'" '),p.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',v,'" ','height="',y,'" ',b,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",t.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(x),`</defs>
`)},createSVGClipPathMarkup:function(p){var x=this.clipPath;return x?(x.clipPathId="CLIPPATH_"+t.Object.__uid++,'<clipPath id="'+x.clipPathId+`" >
`+this.clipPath.toClipPathSVG(p.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var p=this,x=["background","overlay"].map(function(v){var y=p[v+"Color"];if(y&&y.toLive){var _=p[v+"Vpt"],b=p.viewportTransform,S={width:p.width/(_?b[0]:1),height:p.height/(_?b[3]:1)};return y.toSVG(S,{additionalTransform:_?t.util.matrixToSVG(b):""})}});return x.join("")},createSVGFontFacesMarkup:function(){var p="",x={},v,y,_,b,S,C,N,F,Y,X=t.fontPaths,V=[];for(this._objects.forEach(function G(re){V.push(re),re._objects&&re._objects.forEach(G)}),F=0,Y=V.length;F<Y;F++)if(v=V[F],y=v.fontFamily,!(v.type.indexOf("text")===-1||x[y]||!X[y])&&(x[y]=!0,!!v.styles)){_=v.styles;for(S in _){b=_[S];for(N in b)C=b[N],y=C.fontFamily,!x[y]&&X[y]&&(x[y]=!0)}}for(var te in x)p+=[`		@font-face {
`,"			font-family: '",te,`';
`,"			src: url('",X[te],`');
`,`		}
`].join("");return p&&(p=['	<style type="text/css">',`<![CDATA[
`,p,"]]>",`</style>
`].join("")),p},_setSVGObjects:function(p,x){var v,y,_,b=this._objects;for(y=0,_=b.length;y<_;y++)v=b[y],!v.excludeFromExport&&this._setSVGObject(p,v,x)},_setSVGObject:function(p,x,v){p.push(x.toSVG(v))},_setSVGBgOverlayImage:function(p,x,v){this[x]&&!this[x].excludeFromExport&&this[x].toSVG&&p.push(this[x].toSVG(v))},_setSVGBgOverlayColor:function(p,x){var v=this[x+"Color"],y=this.viewportTransform,_=this.width,b=this.height;if(v)if(v.toLive){var S=v.repeat,C=t.util.invertTransform(y),N=this[x+"Vpt"],F=N?t.util.matrixToSVG(C):"";p.push('<rect transform="'+F+" translate(",_/2,",",b/2,')"',' x="',v.offsetX-_/2,'" y="',v.offsetY-b/2,'" ','width="',S==="repeat-y"||S==="no-repeat"?v.source.width:_,'" height="',S==="repeat-x"||S==="no-repeat"?v.source.height:b,'" fill="url(#SVGID_'+v.id+')"',`></rect>
`)}else p.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',v,'"',`></rect>
`)},sendToBack:function(p){if(!p)return this;var x=this._activeObject,v,y,_;if(p===x&&p.type==="activeSelection")for(_=x._objects,v=_.length;v--;)y=_[v],c(this._objects,y),this._objects.unshift(y);else c(this._objects,p),this._objects.unshift(p);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(p){if(!p)return this;var x=this._activeObject,v,y,_;if(p===x&&p.type==="activeSelection")for(_=x._objects,v=0;v<_.length;v++)y=_[v],c(this._objects,y),this._objects.push(y);else c(this._objects,p),this._objects.push(p);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(p,x){if(!p)return this;var v=this._activeObject,y,_,b,S,C,N=0;if(p===v&&p.type==="activeSelection")for(C=v._objects,y=0;y<C.length;y++)_=C[y],b=this._objects.indexOf(_),b>0+N&&(S=b-1,c(this._objects,_),this._objects.splice(S,0,_)),N++;else b=this._objects.indexOf(p),b!==0&&(S=this._findNewLowerIndex(p,b,x),c(this._objects,p),this._objects.splice(S,0,p));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(p,x,v){var y,_;if(v)for(y=x,_=x-1;_>=0;--_){var b=p.intersectsWithObject(this._objects[_])||p.isContainedWithinObject(this._objects[_])||this._objects[_].isContainedWithinObject(p);if(b){y=_;break}}else y=x-1;return y},bringForward:function(p,x){if(!p)return this;var v=this._activeObject,y,_,b,S,C,N=0;if(p===v&&p.type==="activeSelection")for(C=v._objects,y=C.length;y--;)_=C[y],b=this._objects.indexOf(_),b<this._objects.length-1-N&&(S=b+1,c(this._objects,_),this._objects.splice(S,0,_)),N++;else b=this._objects.indexOf(p),b!==this._objects.length-1&&(S=this._findNewUpperIndex(p,b,x),c(this._objects,p),this._objects.splice(S,0,p));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(p,x,v){var y,_,b;if(v)for(y=x,_=x+1,b=this._objects.length;_<b;++_){var S=p.intersectsWithObject(this._objects[_])||p.isContainedWithinObject(this._objects[_])||this._objects[_].isContainedWithinObject(p);if(S){y=_;break}}else y=x+1;return y},moveTo:function(p,x){return c(this._objects,p),this._objects.splice(x,0,p),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(p){p.dispose&&p.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),t.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),t.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),o(t.StaticCanvas.prototype,t.Observable),o(t.StaticCanvas.prototype,t.Collection),o(t.StaticCanvas.prototype,t.DataURLExporter),o(t.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(p){var x=g();if(!x||!x.getContext)return null;var v=x.getContext("2d");if(!v)return null;switch(p){case"setLineDash":return typeof v.setLineDash<"u";default:return null}}}),t.StaticCanvas.prototype.toJSON=t.StaticCanvas.prototype.toObject,t.isLikelyNode&&(t.StaticCanvas.prototype.createPNGStream=function(){var p=u(this.lowerCanvasEl);return p&&p.createPNGStream()},t.StaticCanvas.prototype.createJPEGStream=function(p){var x=u(this.lowerCanvasEl);return x&&x.createJPEGStream(p)})}(),t.BaseBrush=t.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(o){o.strokeStyle=this.color,o.lineWidth=this.width,o.lineCap=this.strokeLineCap,o.miterLimit=this.strokeMiterLimit,o.lineJoin=this.strokeLineJoin,o.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(o){var a=this.canvas.viewportTransform;o.save(),o.transform(a[0],a[1],a[2],a[3],a[4],a[5])},_setShadow:function(){if(this.shadow){var o=this.canvas,a=this.shadow,c=o.contextTop,d=o.getZoom();o&&o._isRetinaScaling()&&(d*=t.devicePixelRatio),c.shadowColor=a.color,c.shadowBlur=a.blur*d,c.shadowOffsetX=a.offsetX*d,c.shadowOffsetY=a.offsetY*d}},needsFullRender:function(){var o=new t.Color(this.color);return o.getAlpha()<1||!!this.shadow},_resetShadow:function(){var o=this.canvas.contextTop;o.shadowColor="",o.shadowBlur=o.shadowOffsetX=o.shadowOffsetY=0},_isOutSideCanvas:function(o){return o.x<0||o.x>this.canvas.getWidth()||o.y<0||o.y>this.canvas.getHeight()}}),function(){t.PencilBrush=t.util.createClass(t.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(o){this.canvas=o,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(o,a,c){var d=a.midPointFrom(c);return o.quadraticCurveTo(a.x,a.y,d.x,d.y),d},onMouseDown:function(o,a){this.canvas._isMainEvent(a.e)&&(this.drawStraightLine=a.e[this.straightLineKey],this._prepareForDrawing(o),this._captureDrawingPath(o),this._render())},onMouseMove:function(o,a){if(this.canvas._isMainEvent(a.e)&&(this.drawStraightLine=a.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o))&&this._captureDrawingPath(o)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var c=this._points,d=c.length,f=this.canvas.contextTop;this._saveAndTransform(f),this.oldEnd&&(f.beginPath(),f.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(f,c[d-2],c[d-1],!0),f.stroke(),f.restore()}},onMouseUp:function(o){return this.canvas._isMainEvent(o.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(o){var a=new t.Point(o.x,o.y);this._reset(),this._addPoint(a),this.canvas.contextTop.moveTo(a.x,a.y)},_addPoint:function(o){return this._points.length>1&&o.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(o),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(o){var a=new t.Point(o.x,o.y);return this._addPoint(a)},_render:function(o){var a,c,d=this._points[0],f=this._points[1];if(o=o||this.canvas.contextTop,this._saveAndTransform(o),o.beginPath(),this._points.length===2&&d.x===f.x&&d.y===f.y){var h=this.width/1e3;d=new t.Point(d.x,d.y),f=new t.Point(f.x,f.y),d.x-=h,f.x+=h}for(o.moveTo(d.x,d.y),a=1,c=this._points.length;a<c;a++)this._drawSegment(o,d,f),d=this._points[a],f=this._points[a+1];o.lineTo(d.x,d.y),o.stroke(),o.restore()},convertPointsToSVGPath:function(o){var a=this.width/1e3;return t.util.getSmoothPathFromPoints(o,a)},_isEmptySVGPath:function(o){var a=t.util.joinPath(o);return a==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(o){var a=new t.Path(o,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,a.shadow=new t.Shadow(this.shadow)),a},decimatePoints:function(o,a){if(o.length<=2)return o;var c=this.canvas.getZoom(),d=Math.pow(a/c,2),f,h=o.length-1,u=o[0],g=[u],m;for(f=1;f<h-1;f++)m=Math.pow(u.x-o[f].x,2)+Math.pow(u.y-o[f].y,2),m>=d&&(u=o[f],g.push(u));return g.push(o[h]),g},_finalizeAndAddPath:function(){var o=this.canvas.contextTop;o.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var a=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(a)){this.canvas.requestRenderAll();return}var c=this.createPath(a);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:c}),this.canvas.add(c),this.canvas.requestRenderAll(),c.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:c})}})}(),t.CircleBrush=t.util.createClass(t.BaseBrush,{width:10,initialize:function(o){this.canvas=o,this.points=[]},drawDot:function(o){var a=this.addPoint(o),c=this.canvas.contextTop;this._saveAndTransform(c),this.dot(c,a),c.restore()},dot:function(o,a){o.fillStyle=a.fill,o.beginPath(),o.arc(a.x,a.y,a.radius,0,Math.PI*2,!1),o.closePath(),o.fill()},onMouseDown:function(o){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(o)},_render:function(){var o=this.canvas.contextTop,a,c,d=this.points;for(this._saveAndTransform(o),a=0,c=d.length;a<c;a++)this.dot(o,d[a]);o.restore()},onMouseMove:function(o){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(o),this._render()):this.drawDot(o))},onMouseUp:function(){var o=this.canvas.renderOnAddRemove,a,c;this.canvas.renderOnAddRemove=!1;var d=[];for(a=0,c=this.points.length;a<c;a++){var f=this.points[a],h=new t.Circle({radius:f.radius,left:f.x,top:f.y,originX:"center",originY:"center",fill:f.fill});this.shadow&&(h.shadow=new t.Shadow(this.shadow)),d.push(h)}var u=new t.Group(d);u.canvas=this.canvas,this.canvas.fire("before:path:created",{path:u}),this.canvas.add(u),this.canvas.fire("path:created",{path:u}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=o,this.canvas.requestRenderAll()},addPoint:function(o){var a=new t.Point(o.x,o.y),c=t.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,d=new t.Color(this.color).setAlpha(t.util.getRandomInt(0,100)/100).toRgba();return a.radius=c,a.fill=d,this.points.push(a),a}}),t.SprayBrush=t.util.createClass(t.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(o){this.canvas=o,this.sprayChunks=[]},onMouseDown:function(o){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(o),this.render(this.sprayChunkPoints)},onMouseMove:function(o){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o)||(this.addSprayChunk(o),this.render(this.sprayChunkPoints))},onMouseUp:function(){var o=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var a=[],c=0,d=this.sprayChunks.length;c<d;c++)for(var f=this.sprayChunks[c],h=0,u=f.length;h<u;h++){var g=new t.Rect({width:f[h].width,height:f[h].width,left:f[h].x+1,top:f[h].y+1,originX:"center",originY:"center",fill:this.color});a.push(g)}this.optimizeOverlapping&&(a=this._getOptimizedRects(a));var m=new t.Group(a);this.shadow&&m.set("shadow",new t.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:m}),this.canvas.add(m),this.canvas.fire("path:created",{path:m}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=o,this.canvas.requestRenderAll()},_getOptimizedRects:function(o){var a={},c,d,f;for(d=0,f=o.length;d<f;d++)c=o[d].left+""+o[d].top,a[c]||(a[c]=o[d]);var h=[];for(c in a)h.push(a[c]);return h},render:function(o){var a=this.canvas.contextTop,c,d;for(a.fillStyle=this.color,this._saveAndTransform(a),c=0,d=o.length;c<d;c++){var f=o[c];typeof f.opacity<"u"&&(a.globalAlpha=f.opacity),a.fillRect(f.x,f.y,f.width,f.width)}a.restore()},_render:function(){var o=this.canvas.contextTop,a,c;for(o.fillStyle=this.color,this._saveAndTransform(o),a=0,c=this.sprayChunks.length;a<c;a++)this.render(this.sprayChunks[a]);o.restore()},addSprayChunk:function(o){this.sprayChunkPoints=[];var a,c,d,f=this.width/2,h;for(h=0;h<this.density;h++){a=t.util.getRandomInt(o.x-f,o.x+f),c=t.util.getRandomInt(o.y-f,o.y+f),this.dotWidthVariance?d=t.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):d=this.dotWidth;var u=new t.Point(a,c);u.width=d,this.randomOpacity&&(u.opacity=t.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(u)}this.sprayChunks.push(this.sprayChunkPoints)}}),t.PatternBrush=t.util.createClass(t.PencilBrush,{getPatternSrc:function(){var o=20,a=5,c=t.util.createCanvasElement(),d=c.getContext("2d");return c.width=c.height=o+a,d.fillStyle=this.color,d.beginPath(),d.arc(o/2,o/2,o/2,0,Math.PI*2,!1),d.closePath(),d.fill(),c},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(o){return o.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(o){this.callSuper("_setBrushStyles",o),o.strokeStyle=this.getPattern(o)},createPath:function(o){var a=this.callSuper("createPath",o),c=a._getLeftTopCoords().scalarAdd(a.strokeWidth/2);return a.stroke=new t.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-c.x,offsetY:-c.y}),a}}),function(){var o=t.util.getPointer,a=t.util.degreesToRadians,c=t.util.isTouchEvent;t.Canvas=t.util.createClass(t.StaticCanvas,{initialize:function(f,h){h||(h={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(f,h),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=t.PencilBrush&&new t.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var f=this.getActiveObjects(),h,u,g;if(f.length>0&&!this.preserveObjectStacking){u=[],g=[];for(var m=0,p=this._objects.length;m<p;m++)h=this._objects[m],f.indexOf(h)===-1?u.push(h):g.push(h);f.length>1&&(this._activeObject._objects=g),u.push.apply(u,g)}else u=this._objects;return u},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var f=this.contextContainer;return this.renderCanvas(f,this._chooseObjectsToRender()),this},renderTopLayer:function(f){f.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(f),this.contextTopDirty=!0),f.restore()},renderTop:function(){var f=this.contextTop;return this.clearContext(f),this.renderTopLayer(f),this.fire("after:render"),this},_normalizePointer:function(f,h){var u=f.calcTransformMatrix(),g=t.util.invertTransform(u),m=this.restorePointerVpt(h);return t.util.transformPoint(m,g)},isTargetTransparent:function(f,h,u){if(f.shouldCache()&&f._cacheCanvas&&f!==this._activeObject){var g=this._normalizePointer(f,{x:h,y:u}),m=Math.max(f.cacheTranslationX+g.x*f.zoomX,0),p=Math.max(f.cacheTranslationY+g.y*f.zoomY,0),_=t.util.isTransparent(f._cacheContext,Math.round(m),Math.round(p),this.targetFindTolerance);return _}var x=this.contextCache,v=f.selectionBackgroundColor,y=this.viewportTransform;f.selectionBackgroundColor="",this.clearContext(x),x.save(),x.transform(y[0],y[1],y[2],y[3],y[4],y[5]),f.render(x),x.restore(),f.selectionBackgroundColor=v;var _=t.util.isTransparent(x,h,u,this.targetFindTolerance);return _},_isSelectionKeyPressed:function(f){var h=!1;return Array.isArray(this.selectionKey)?h=!!this.selectionKey.find(function(u){return f[u]===!0}):h=f[this.selectionKey],h},_shouldClearSelection:function(f,h){var u=this.getActiveObjects(),g=this._activeObject;return!h||h&&g&&u.length>1&&u.indexOf(h)===-1&&g!==h&&!this._isSelectionKeyPressed(f)||h&&!h.evented||h&&!h.selectable&&g&&g!==h},_shouldCenterTransform:function(f,h,u){if(f){var g;return h==="scale"||h==="scaleX"||h==="scaleY"||h==="resizing"?g=this.centeredScaling||f.centeredScaling:h==="rotate"&&(g=this.centeredRotation||f.centeredRotation),g?!u:u}},_getOriginFromCorner:function(f,h){var u={x:f.originX,y:f.originY};return h==="ml"||h==="tl"||h==="bl"?u.x="right":(h==="mr"||h==="tr"||h==="br")&&(u.x="left"),h==="tl"||h==="mt"||h==="tr"?u.y="bottom":(h==="bl"||h==="mb"||h==="br")&&(u.y="top"),u},_getActionFromCorner:function(f,h,u,g){if(!h||!f)return"drag";var m=g.controls[h];return m.getActionName(u,m,g)},_setupCurrentTransform:function(f,h,u){if(h){var g=this.getPointer(f),m=h.__corner,p=h.controls[m],x=u&&m?p.getActionHandler(f,h,p):t.controlsUtils.dragHandler,v=this._getActionFromCorner(u,m,f,h),y=this._getOriginFromCorner(h,m),_=f[this.centeredKey],b={target:h,action:v,actionHandler:x,corner:m,scaleX:h.scaleX,scaleY:h.scaleY,skewX:h.skewX,skewY:h.skewY,offsetX:g.x-h.left,offsetY:g.y-h.top,originX:y.x,originY:y.y,ex:g.x,ey:g.y,lastX:g.x,lastY:g.y,theta:a(h.angle),width:h.width*h.scaleX,shiftKey:f.shiftKey,altKey:_,original:t.util.saveObjectTransform(h)};this._shouldCenterTransform(h,v,_)&&(b.originX="center",b.originY="center"),b.original.originX=y.x,b.original.originY=y.y,this._currentTransform=b,this._beforeTransform(f)}},setCursor:function(f){this.upperCanvasEl.style.cursor=f},_drawSelection:function(f){var h=this._groupSelector,u=new t.Point(h.ex,h.ey),g=t.util.transformPoint(u,this.viewportTransform),m=new t.Point(h.ex+h.left,h.ey+h.top),p=t.util.transformPoint(m,this.viewportTransform),x=Math.min(g.x,p.x),v=Math.min(g.y,p.y),y=Math.max(g.x,p.x),_=Math.max(g.y,p.y),b=this.selectionLineWidth/2;this.selectionColor&&(f.fillStyle=this.selectionColor,f.fillRect(x,v,y-x,_-v)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(f.lineWidth=this.selectionLineWidth,f.strokeStyle=this.selectionBorderColor,x+=b,v+=b,y-=b,_-=b,t.Object.prototype._setLineDash.call(this,f,this.selectionDashArray),f.strokeRect(x,v,y-x,_-v))},findTarget:function(f,h){if(!this.skipTargetFind){var u=!0,g=this.getPointer(f,u),m=this._activeObject,p=this.getActiveObjects(),x,v,y=c(f),_=p.length>1&&!h||p.length===1;if(this.targets=[],_&&m._findTargetCorner(g,y)||p.length>1&&!h&&m===this._searchPossibleTargets([m],g))return m;if(p.length===1&&m===this._searchPossibleTargets([m],g))if(this.preserveObjectStacking)x=m,v=this.targets,this.targets=[];else return m;var b=this._searchPossibleTargets(this._objects,g);return f[this.altSelectionKey]&&b&&x&&b!==x&&(b=x,this.targets=v),b}},_checkTarget:function(f,h,u){if(h&&h.visible&&h.evented&&h.containsPoint(f))if((this.perPixelTargetFind||h.perPixelTargetFind)&&!h.isEditing){var g=this.isTargetTransparent(h,u.x,u.y);if(!g)return!0}else return!0},_searchPossibleTargets:function(f,h){for(var u,g=f.length,m;g--;){var p=f[g],x=p.group?this._normalizePointer(p.group,h):h;if(this._checkTarget(x,p,h)){u=f[g],u.subTargetCheck&&u instanceof t.Group&&(m=this._searchPossibleTargets(u._objects,h),m&&this.targets.push(m));break}}return u},restorePointerVpt:function(f){return t.util.transformPoint(f,t.util.invertTransform(this.viewportTransform))},getPointer:function(f,h){if(this._absolutePointer&&!h)return this._absolutePointer;if(this._pointer&&h)return this._pointer;var u=o(f),g=this.upperCanvasEl,m=g.getBoundingClientRect(),p=m.width||0,x=m.height||0,v;(!p||!x)&&("top"in m&&"bottom"in m&&(x=Math.abs(m.top-m.bottom)),"right"in m&&"left"in m&&(p=Math.abs(m.right-m.left))),this.calcOffset(),u.x=u.x-this._offset.left,u.y=u.y-this._offset.top,h||(u=this.restorePointerVpt(u));var y=this.getRetinaScaling();return y!==1&&(u.x/=y,u.y/=y),p===0||x===0?v={width:1,height:1}:v={width:g.width/p,height:g.height/x},{x:u.x*v.width,y:u.y*v.height}},_createUpperCanvas:function(){var f=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),h=this.lowerCanvasEl,u=this.upperCanvasEl;u?u.className="":(u=this._createCanvasElement(),this.upperCanvasEl=u),t.util.addClass(u,"upper-canvas "+f),this.wrapperEl.appendChild(u),this._copyCanvasStyle(h,u),this._applyCanvasStyle(u),this.contextTop=u.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=t.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),t.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),t.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(f){var h=this.width||f.width,u=this.height||f.height;t.util.setStyle(f,{position:"absolute",width:h+"px",height:u+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),f.width=h,f.height=u,t.util.makeElementUnselectable(f)},_copyCanvasStyle:function(f,h){h.style.cssText=f.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var f=this._activeObject;return f?f.type==="activeSelection"&&f._objects?f._objects.slice(0):[f]:[]},_onObjectRemoved:function(f){f===this._activeObject&&(this.fire("before:selection:cleared",{target:f}),this._discardActiveObject(),this.fire("selection:cleared",{target:f}),f.fire("deselected")),f===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",f)},_fireSelectionEvents:function(f,h){var u=!1,g=this.getActiveObjects(),m=[],p=[];f.forEach(function(x){g.indexOf(x)===-1&&(u=!0,x.fire("deselected",{e:h,target:x}),p.push(x))}),g.forEach(function(x){f.indexOf(x)===-1&&(u=!0,x.fire("selected",{e:h,target:x}),m.push(x))}),f.length>0&&g.length>0?u&&this.fire("selection:updated",{e:h,selected:m,deselected:p}):g.length>0?this.fire("selection:created",{e:h,selected:m}):f.length>0&&this.fire("selection:cleared",{e:h,deselected:p})},setActiveObject:function(f,h){var u=this.getActiveObjects();return this._setActiveObject(f,h),this._fireSelectionEvents(u,h),this},_setActiveObject:function(f,h){return this._activeObject===f||!this._discardActiveObject(h,f)||f.onSelect({e:h})?!1:(this._activeObject=f,!0)},_discardActiveObject:function(f,h){var u=this._activeObject;if(u){if(u.onDeselect({e:f,object:h}))return!1;this._activeObject=null}return!0},discardActiveObject:function(f){var h=this.getActiveObjects(),u=this.getActiveObject();return h.length&&this.fire("before:selection:cleared",{target:u,e:f}),this._discardActiveObject(f),this._fireSelectionEvents(h,f),this},dispose:function(){var f=this.wrapperEl;return this.removeListeners(),f.removeChild(this.upperCanvasEl),f.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach((function(h){t.util.cleanUpJsdomNode(this[h]),this[h]=void 0}).bind(this)),f.parentNode&&f.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,t.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(f){var h=this._activeObject;h&&h._renderControls(f)},_toObject:function(f,h,u){var g=this._realizeGroupTransformOnObject(f),m=this.callSuper("_toObject",f,h,u);return this._unwindGroupTransformOnObject(f,g),m},_realizeGroupTransformOnObject:function(f){if(f.group&&f.group.type==="activeSelection"&&this._activeObject===f.group){var h=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],u={};return h.forEach(function(g){u[g]=f[g]}),t.util.addTransformToObject(f,this._activeObject.calcOwnMatrix()),u}else return null},_unwindGroupTransformOnObject:function(f,h){h&&f.set(h)},_setSVGObject:function(f,h,u){var g=this._realizeGroupTransformOnObject(h);this.callSuper("_setSVGObject",f,h,u),this._unwindGroupTransformOnObject(h,g)},setViewportTransform:function(f){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),t.StaticCanvas.prototype.setViewportTransform.call(this,f)}});for(var d in t.StaticCanvas)d!=="prototype"&&(t.Canvas[d]=t.StaticCanvas[d])}(),function(){var o=t.util.addListener,a=t.util.removeListener,c=3,d=2,f=1,h={passive:!1};function u(g,m){return g.button&&g.button===m-1}t.util.object.extend(t.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(o,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(g,m){var p=this.upperCanvasEl,x=this._getEventPrefix();g(t.window,"resize",this._onResize),g(p,x+"down",this._onMouseDown),g(p,x+"move",this._onMouseMove,h),g(p,x+"out",this._onMouseOut),g(p,x+"enter",this._onMouseEnter),g(p,"wheel",this._onMouseWheel),g(p,"contextmenu",this._onContextMenu),g(p,"dblclick",this._onDoubleClick),g(p,"dragover",this._onDragOver),g(p,"dragenter",this._onDragEnter),g(p,"dragleave",this._onDragLeave),g(p,"drop",this._onDrop),this.enablePointerEvents||g(p,"touchstart",this._onTouchStart,h),typeof eventjs<"u"&&m in eventjs&&(eventjs[m](p,"gesture",this._onGesture),eventjs[m](p,"drag",this._onDrag),eventjs[m](p,"orientation",this._onOrientationChange),eventjs[m](p,"shake",this._onShake),eventjs[m](p,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(a,"remove");var g=this._getEventPrefix();a(t.document,g+"up",this._onMouseUp),a(t.document,"touchend",this._onTouchEnd,h),a(t.document,g+"move",this._onMouseMove,h),a(t.document,"touchmove",this._onMouseMove,h)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(g,m){this.__onTransformGesture&&this.__onTransformGesture(g,m)},_onDrag:function(g,m){this.__onDrag&&this.__onDrag(g,m)},_onMouseWheel:function(g){this.__onMouseWheel(g)},_onMouseOut:function(g){var m=this._hoveredTarget;this.fire("mouse:out",{target:m,e:g}),this._hoveredTarget=null,m&&m.fire("mouseout",{e:g});var p=this;this._hoveredTargets.forEach(function(x){p.fire("mouse:out",{target:x,e:g}),x&&x.fire("mouseout",{e:g})}),this._hoveredTargets=[]},_onMouseEnter:function(g){!this._currentTransform&&!this.findTarget(g)&&(this.fire("mouse:over",{target:null,e:g}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(g,m){this.__onOrientationChange&&this.__onOrientationChange(g,m)},_onShake:function(g,m){this.__onShake&&this.__onShake(g,m)},_onLongPress:function(g,m){this.__onLongPress&&this.__onLongPress(g,m)},_onDragOver:function(g){g.preventDefault();var m=this._simpleEventHandler("dragover",g);this._fireEnterLeaveEvents(m,g)},_onDrop:function(g){return this._simpleEventHandler("drop:before",g),this._simpleEventHandler("drop",g)},_onContextMenu:function(g){return this.stopContextMenu&&(g.stopPropagation(),g.preventDefault()),!1},_onDoubleClick:function(g){this._cacheTransformEventData(g),this._handleEvent(g,"dblclick"),this._resetTransformEventData(g)},getPointerId:function(g){var m=g.changedTouches;return m?m[0]&&m[0].identifier:this.enablePointerEvents?g.pointerId:-1},_isMainEvent:function(g){return g.isPrimary===!0?!0:g.isPrimary===!1?!1:g.type==="touchend"&&g.touches.length===0?!0:g.changedTouches?g.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(g){g.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(g)),this.__onMouseDown(g),this._resetTransformEventData();var m=this.upperCanvasEl,p=this._getEventPrefix();o(t.document,"touchend",this._onTouchEnd,h),o(t.document,"touchmove",this._onMouseMove,h),a(m,p+"down",this._onMouseDown)},_onMouseDown:function(g){this.__onMouseDown(g),this._resetTransformEventData();var m=this.upperCanvasEl,p=this._getEventPrefix();a(m,p+"move",this._onMouseMove,h),o(t.document,p+"up",this._onMouseUp),o(t.document,p+"move",this._onMouseMove,h)},_onTouchEnd:function(g){if(!(g.touches.length>0)){this.__onMouseUp(g),this._resetTransformEventData(),this.mainTouchId=null;var m=this._getEventPrefix();a(t.document,"touchend",this._onTouchEnd,h),a(t.document,"touchmove",this._onMouseMove,h);var p=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){o(p.upperCanvasEl,m+"down",p._onMouseDown),p._willAddMouseDown=0},400)}},_onMouseUp:function(g){this.__onMouseUp(g),this._resetTransformEventData();var m=this.upperCanvasEl,p=this._getEventPrefix();this._isMainEvent(g)&&(a(t.document,p+"up",this._onMouseUp),a(t.document,p+"move",this._onMouseMove,h),o(m,p+"move",this._onMouseMove,h))},_onMouseMove:function(g){!this.allowTouchScrolling&&g.preventDefault&&g.preventDefault(),this.__onMouseMove(g)},_onResize:function(){this.calcOffset()},_shouldRender:function(g){var m=this._activeObject;return!!m!=!!g||m&&g&&m!==g?!0:(m&&m.isEditing,!1)},__onMouseUp:function(g){var m,p=this._currentTransform,x=this._groupSelector,v=!1,y=!x||x.left===0&&x.top===0;if(this._cacheTransformEventData(g),m=this._target,this._handleEvent(g,"up:before"),u(g,c)){this.fireRightClick&&this._handleEvent(g,"up",c,y);return}if(u(g,d)){this.fireMiddleClick&&this._handleEvent(g,"up",d,y),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(g);return}if(this._isMainEvent(g)){if(p&&(this._finalizeCurrentTransform(g),v=p.actionPerformed),!y){var _=m===this._activeObject;this._maybeGroupObjects(g),v||(v=this._shouldRender(m)||!_&&m===this._activeObject)}var b,S;if(m){if(b=m._findTargetCorner(this.getPointer(g,!0),t.util.isTouchEvent(g)),m.selectable&&m!==this._activeObject&&m.activeOn==="up")this.setActiveObject(m,g),v=!0;else{var C=m.controls[b],N=C&&C.getMouseUpHandler(g,m,C);N&&(S=this.getPointer(g),N(g,p,S.x,S.y))}m.isMoving=!1}if(p&&(p.target!==m||p.corner!==b)){var F=p.target&&p.target.controls[p.corner],Y=F&&F.getMouseUpHandler(g,m,C);S=S||this.getPointer(g),Y&&Y(g,p,S.x,S.y)}this._setCursorFromEvent(g,m),this._handleEvent(g,"up",f,y),this._groupSelector=null,this._currentTransform=null,m&&(m.__corner=0),v?this.requestRenderAll():y||this.renderTop()}},_simpleEventHandler:function(g,m){var p=this.findTarget(m),x=this.targets,v={e:m,target:p,subTargets:x};if(this.fire(g,v),p&&p.fire(g,v),!x)return p;for(var y=0;y<x.length;y++)x[y].fire(g,v);return p},_handleEvent:function(g,m,p,x){var v=this._target,y=this.targets||[],_={e:g,target:v,subTargets:y,button:p||f,isClick:x||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};m==="up"&&(_.currentTarget=this.findTarget(g),_.currentSubTargets=this.targets),this.fire("mouse:"+m,_),v&&v.fire("mouse"+m,_);for(var b=0;b<y.length;b++)y[b].fire("mouse"+m,_)},_finalizeCurrentTransform:function(g){var m=this._currentTransform,p=m.target,x={e:g,target:p,transform:m,action:m.action};p._scaling&&(p._scaling=!1),p.setCoords(),(m.actionPerformed||this.stateful&&p.hasStateChanged())&&this._fire("modified",x)},_onMouseDownInDrawingMode:function(g){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(g).requestRenderAll();var m=this.getPointer(g);this.freeDrawingBrush.onMouseDown(m,{e:g,pointer:m}),this._handleEvent(g,"down")},_onMouseMoveInDrawingMode:function(g){if(this._isCurrentlyDrawing){var m=this.getPointer(g);this.freeDrawingBrush.onMouseMove(m,{e:g,pointer:m})}this.setCursor(this.freeDrawingCursor),this._handleEvent(g,"move")},_onMouseUpInDrawingMode:function(g){var m=this.getPointer(g);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:g,pointer:m}),this._handleEvent(g,"up")},__onMouseDown:function(g){this._cacheTransformEventData(g),this._handleEvent(g,"down:before");var m=this._target;if(u(g,c)){this.fireRightClick&&this._handleEvent(g,"down",c);return}if(u(g,d)){this.fireMiddleClick&&this._handleEvent(g,"down",d);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(g);return}if(this._isMainEvent(g)&&!this._currentTransform){var p=this._pointer;this._previousPointer=p;var x=this._shouldRender(m),v=this._shouldGroup(g,m);if(this._shouldClearSelection(g,m)?this.discardActiveObject(g):v&&(this._handleGrouping(g,m),m=this._activeObject),this.selection&&(!m||!m.selectable&&!m.isEditing&&m!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),m){var y=m===this._activeObject;m.selectable&&m.activeOn==="down"&&this.setActiveObject(m,g);var _=m._findTargetCorner(this.getPointer(g,!0),t.util.isTouchEvent(g));if(m.__corner=_,m===this._activeObject&&(_||!v)){this._setupCurrentTransform(g,m,y);var b=m.controls[_],p=this.getPointer(g),S=b&&b.getMouseDownHandler(g,m,b);S&&S(g,this._currentTransform,p.x,p.y)}}this._handleEvent(g,"down"),(x||v)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(g){this._resetTransformEventData(),this._pointer=this.getPointer(g,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(g)||null},_beforeTransform:function(g){var m=this._currentTransform;this.stateful&&m.target.saveState(),this.fire("before:transform",{e:g,transform:m})},__onMouseMove:function(g){this._handleEvent(g,"move:before"),this._cacheTransformEventData(g);var m,p;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(g);return}if(this._isMainEvent(g)){var x=this._groupSelector;x?(p=this._absolutePointer,x.left=p.x-x.ex,x.top=p.y-x.ey,this.renderTop()):this._currentTransform?this._transformObject(g):(m=this.findTarget(g)||null,this._setCursorFromEvent(g,m),this._fireOverOutEvents(m,g)),this._handleEvent(g,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(g,m){var p=this._hoveredTarget,x=this._hoveredTargets,v=this.targets,y=Math.max(x.length,v.length);this.fireSyntheticInOutEvents(g,m,{oldTarget:p,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var _=0;_<y;_++)this.fireSyntheticInOutEvents(v[_],m,{oldTarget:x[_],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=g,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(g,m){var p=this._draggedoverTarget,x=this._hoveredTargets,v=this.targets,y=Math.max(x.length,v.length);this.fireSyntheticInOutEvents(g,m,{oldTarget:p,evtOut:"dragleave",evtIn:"dragenter"});for(var _=0;_<y;_++)this.fireSyntheticInOutEvents(v[_],m,{oldTarget:x[_],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=g},fireSyntheticInOutEvents:function(g,m,p){var x,v,y=p.oldTarget,_,b,S=y!==g,C=p.canvasEvtIn,N=p.canvasEvtOut;S&&(x={e:m,target:g,previousTarget:y},v={e:m,target:y,nextTarget:g}),b=g&&S,_=y&&S,_&&(N&&this.fire(N,v),y.fire(p.evtOut,v)),b&&(C&&this.fire(C,x),g.fire(p.evtIn,x))},__onMouseWheel:function(g){this._cacheTransformEventData(g),this._handleEvent(g,"wheel"),this._resetTransformEventData()},_transformObject:function(g){var m=this.getPointer(g),p=this._currentTransform;p.reset=!1,p.shiftKey=g.shiftKey,p.altKey=g[this.centeredKey],this._performTransformAction(g,p,m),p.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(g,m,p){var x=p.x,v=p.y,y=m.action,_=!1,b=m.actionHandler;b&&(_=b(g,m,x,v)),y==="drag"&&_&&(m.target.isMoving=!0,this.setCursor(m.target.moveCursor||this.moveCursor)),m.actionPerformed=m.actionPerformed||_},_fire:t.controlsUtils.fireEvent,_setCursorFromEvent:function(g,m){if(!m)return this.setCursor(this.defaultCursor),!1;var p=m.hoverCursor||this.hoverCursor,x=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,v=(!x||!x.contains(m))&&m._findTargetCorner(this.getPointer(g,!0));v?this.setCursor(this.getCornerCursor(v,m,g)):(m.subTargetCheck&&this.targets.concat().reverse().map(function(y){p=y.hoverCursor||p}),this.setCursor(p))},getCornerCursor:function(g,m,p){var x=m.controls[g];return x.cursorStyleHandler(p,x,m)}})}(),function(){var o=Math.min,a=Math.max;t.util.object.extend(t.Canvas.prototype,{_shouldGroup:function(c,d){var f=this._activeObject;return f&&this._isSelectionKeyPressed(c)&&d&&d.selectable&&this.selection&&(f!==d||f.type==="activeSelection")&&!d.onSelect({e:c})},_handleGrouping:function(c,d){var f=this._activeObject;f.__corner||d===f&&(d=this.findTarget(c,!0),!d||!d.selectable)||(f&&f.type==="activeSelection"?this._updateActiveSelection(d,c):this._createActiveSelection(d,c))},_updateActiveSelection:function(c,d){var f=this._activeObject,h=f._objects.slice(0);f.contains(c)?(f.removeWithUpdate(c),this._hoveredTarget=c,this._hoveredTargets=this.targets.concat(),f.size()===1&&this._setActiveObject(f.item(0),d)):(f.addWithUpdate(c),this._hoveredTarget=f,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(h,d)},_createActiveSelection:function(c,d){var f=this.getActiveObjects(),h=this._createGroup(c);this._hoveredTarget=h,this._setActiveObject(h,d),this._fireSelectionEvents(f,d)},_createGroup:function(c){var d=this._objects,f=d.indexOf(this._activeObject)<d.indexOf(c),h=f?[this._activeObject,c]:[c,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new t.ActiveSelection(h,{canvas:this})},_groupSelectedObjects:function(c){var d=this._collectObjects(c),f;d.length===1?this.setActiveObject(d[0],c):d.length>1&&(f=new t.ActiveSelection(d.reverse(),{canvas:this}),this.setActiveObject(f,c))},_collectObjects:function(c){for(var d=[],f,h=this._groupSelector.ex,u=this._groupSelector.ey,g=h+this._groupSelector.left,m=u+this._groupSelector.top,p=new t.Point(o(h,g),o(u,m)),x=new t.Point(a(h,g),a(u,m)),v=!this.selectionFullyContained,y=h===g&&u===m,_=this._objects.length;_--&&(f=this._objects[_],!(!(!f||!f.selectable||!f.visible)&&(v&&f.intersectsWithRect(p,x,!0)||f.isContainedWithinRect(p,x,!0)||v&&f.containsPoint(p,null,!0)||v&&f.containsPoint(x,null,!0))&&(d.push(f),y))););return d.length>1&&(d=d.filter(function(b){return!b.onSelect({e:c})})),d},_maybeGroupObjects:function(c){this.selection&&this._groupSelector&&this._groupSelectedObjects(c),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){t.util.object.extend(t.StaticCanvas.prototype,{toDataURL:function(o){o||(o={});var a=o.format||"png",c=o.quality||1,d=(o.multiplier||1)*(o.enableRetinaScaling?this.getRetinaScaling():1),f=this.toCanvasElement(d,o);return t.util.toDataURL(f,a,c)},toCanvasElement:function(o,a){o=o||1,a=a||{};var c=(a.width||this.width)*o,d=(a.height||this.height)*o,f=this.getZoom(),h=this.width,u=this.height,g=f*o,m=this.viewportTransform,p=(m[4]-(a.left||0))*o,x=(m[5]-(a.top||0))*o,v=this.interactive,y=[g,0,0,g,p,x],_=this.enableRetinaScaling,b=t.util.createCanvasElement(),S=this.contextTop;return b.width=c,b.height=d,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=y,this.width=c,this.height=d,this.calcViewportBoundaries(),this.renderCanvas(b.getContext("2d"),this._objects),this.viewportTransform=m,this.width=h,this.height=u,this.calcViewportBoundaries(),this.interactive=v,this.enableRetinaScaling=_,this.contextTop=S,b}})}(),t.util.object.extend(t.StaticCanvas.prototype,{loadFromJSON:function(o,a,c){if(o){var d=typeof o=="string"?JSON.parse(o):t.util.object.clone(o),f=this,h=d.clipPath,u=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete d.clipPath,this._enlivenObjects(d.objects,function(g){f.clear(),f._setBgOverlay(d,function(){h?f._enlivenObjects([h],function(m){f.clipPath=m[0],f.__setupCanvas.call(f,d,g,u,a)}):f.__setupCanvas.call(f,d,g,u,a)})},c),this}},__setupCanvas:function(o,a,c,d){var f=this;a.forEach(function(h,u){f.insertAt(h,u)}),this.renderOnAddRemove=c,delete o.objects,delete o.backgroundImage,delete o.overlayImage,delete o.background,delete o.overlay,this._setOptions(o),this.renderAll(),d&&d()},_setBgOverlay:function(o,a){var c={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!o.backgroundImage&&!o.overlayImage&&!o.background&&!o.overlay){a&&a();return}var d=function(){c.backgroundImage&&c.overlayImage&&c.backgroundColor&&c.overlayColor&&a&&a()};this.__setBgOverlay("backgroundImage",o.backgroundImage,c,d),this.__setBgOverlay("overlayImage",o.overlayImage,c,d),this.__setBgOverlay("backgroundColor",o.background,c,d),this.__setBgOverlay("overlayColor",o.overlay,c,d)},__setBgOverlay:function(o,a,c,d){var f=this;if(!a){c[o]=!0,d&&d();return}o==="backgroundImage"||o==="overlayImage"?t.util.enlivenObjects([a],function(h){f[o]=h[0],c[o]=!0,d&&d()}):this["set"+t.util.string.capitalize(o,!0)](a,function(){c[o]=!0,d&&d()})},_enlivenObjects:function(o,a,c){if(!o||o.length===0){a&&a([]);return}t.util.enlivenObjects(o,function(d){a&&a(d)},null,c)},_toDataURL:function(o,a){this.clone(function(c){a(c.toDataURL(o))})},_toDataURLWithMultiplier:function(o,a,c){this.clone(function(d){c(d.toDataURLWithMultiplier(o,a))})},clone:function(o,a){var c=JSON.stringify(this.toJSON(a));this.cloneWithoutData(function(d){d.loadFromJSON(c,function(){o&&o(d)})})},cloneWithoutData:function(o){var a=t.util.createCanvasElement();a.width=this.width,a.height=this.height;var c=new t.Canvas(a);this.backgroundImage?(c.setBackgroundImage(this.backgroundImage.src,function(){c.renderAll(),o&&o(c)}),c.backgroundImageOpacity=this.backgroundImageOpacity,c.backgroundImageStretch=this.backgroundImageStretch):o&&o(c)}}),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.util.object.clone,f=a.util.toFixed,h=a.util.string.capitalize,u=a.util.degreesToRadians,g=!a.isLikelyNode,m=2;a.Object||(a.Object=a.util.createClass(a.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:g,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(p){p&&this.setOptions(p)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=a.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(p){var x=a.perfLimitSizeTotal,v=p.width,y=p.height,_=a.maxCacheSideLimit,b=a.minCacheSideLimit;if(v<=_&&y<=_&&v*y<=x)return v<b&&(p.width=b),y<b&&(p.height=b),p;var S=v/y,C=a.util.limitDimsByArea(S,x),N=a.util.capValue,F=N(b,C.x,_),Y=N(b,C.y,_);return v>F&&(p.zoomX/=v/F,p.width=F,p.capped=!0),y>Y&&(p.zoomY/=y/Y,p.height=Y,p.capped=!0),p},_getCacheCanvasDimensions:function(){var p=this.getTotalObjectScaling(),x=this._getTransformedDimensions(0,0),v=x.x*p.scaleX/this.scaleX,y=x.y*p.scaleY/this.scaleY;return{width:Math.ceil(v+m),height:Math.ceil(y+m),zoomX:p.scaleX,zoomY:p.scaleY,x:v,y}},_updateCacheCanvas:function(){var p=this.canvas;if(this.noScaleCache&&p&&p._currentTransform){var x=p._currentTransform.target,v=p._currentTransform.action;if(this===x&&v.slice&&v.slice(0,5)==="scale")return!1}var y=this._cacheCanvas,_=this._limitCacheSize(this._getCacheCanvasDimensions()),b=_.width,S=_.height,C,N,F=_.zoomX,Y=_.zoomY,X=b!==this.cacheWidth||S!==this.cacheHeight,V=this.zoomX!==F||this.zoomY!==Y,te=X||V;return te?(X?(y.width=b,y.height=S):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,y.width,y.height)),C=_.x/2,N=_.y/2,this.cacheTranslationX=Math.round(y.width/2-C)+C,this.cacheTranslationY=Math.round(y.height/2-N)+N,this.cacheWidth=b,this.cacheHeight=S,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(F,Y),this.zoomX=F,this.zoomY=Y,!0):!1},setOptions:function(p){this._setOptions(p),this._initGradient(p.fill,"fill"),this._initGradient(p.stroke,"stroke"),this._initPattern(p.fill,"fill"),this._initPattern(p.stroke,"stroke")},transform:function(p){var x=this.group&&!this.group._transformDone||this.group&&this.canvas&&p===this.canvas.contextTop,v=this.calcTransformMatrix(!x);p.transform(v[0],v[1],v[2],v[3],v[4],v[5])},toObject:function(p){var x=a.Object.NUM_FRACTION_DIGITS,v={type:this.type,version:a.version,originX:this.originX,originY:this.originY,left:f(this.left,x),top:f(this.top,x),width:f(this.width,x),height:f(this.height,x),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:f(this.strokeWidth,x),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:f(this.strokeMiterLimit,x),scaleX:f(this.scaleX,x),scaleY:f(this.scaleY,x),angle:f(this.angle,x),flipX:this.flipX,flipY:this.flipY,opacity:f(this.opacity,x),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:f(this.skewX,x),skewY:f(this.skewY,x)};return this.clipPath&&!this.clipPath.excludeFromExport&&(v.clipPath=this.clipPath.toObject(p),v.clipPath.inverted=this.clipPath.inverted,v.clipPath.absolutePositioned=this.clipPath.absolutePositioned),a.util.populateWithProperties(this,v,p),this.includeDefaultValues||(v=this._removeDefaultValues(v)),v},toDatalessObject:function(p){return this.toObject(p)},_removeDefaultValues:function(p){var x=a.util.getKlass(p.type).prototype,v=x.stateProperties;return v.forEach(function(y){y==="left"||y==="top"||(p[y]===x[y]&&delete p[y],Array.isArray(p[y])&&Array.isArray(x[y])&&p[y].length===0&&x[y].length===0&&delete p[y])}),p},toString:function(){return"#<fabric."+h(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var p=a.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(p.scaleX),scaleY:Math.abs(p.scaleY)}},getTotalObjectScaling:function(){var p=this.getObjectScaling(),x=p.scaleX,v=p.scaleY;if(this.canvas){var y=this.canvas.getZoom(),_=this.canvas.getRetinaScaling();x*=y*_,v*=y*_}return{scaleX:x,scaleY:v}},getObjectOpacity:function(){var p=this.opacity;return this.group&&(p*=this.group.getObjectOpacity()),p},_set:function(p,x){var v=p==="scaleX"||p==="scaleY",y=this[p]!==x,_=!1;return v&&(x=this._constrainScale(x)),p==="scaleX"&&x<0?(this.flipX=!this.flipX,x*=-1):p==="scaleY"&&x<0?(this.flipY=!this.flipY,x*=-1):p==="shadow"&&x&&!(x instanceof a.Shadow)?x=new a.Shadow(x):p==="dirty"&&this.group&&this.group.set("dirty",x),this[p]=x,y&&(_=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(p)>-1?(this.dirty=!0,_&&this.group.set("dirty",!0)):_&&this.stateProperties.indexOf(p)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:a.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(p){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(p.save(),this._setupCompositeOperation(p),this.drawSelectionBackground(p),this.transform(p),this._setOpacity(p),this._setShadow(p,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(p)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(p),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),p.restore())},renderCache:function(p){p=p||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,p.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(p,x){if(p.save(),x.inverted?p.globalCompositeOperation="destination-out":p.globalCompositeOperation="destination-in",x.absolutePositioned){var v=a.util.invertTransform(this.calcTransformMatrix());p.transform(v[0],v[1],v[2],v[3],v[4],v[5])}x.transform(p),p.scale(1/x.zoomX,1/x.zoomY),p.drawImage(x._cacheCanvas,-x.cacheTranslationX,-x.cacheTranslationY),p.restore()},drawObject:function(p,x){var v=this.fill,y=this.stroke;x?(this.fill="black",this.stroke="",this._setClippingProperties(p)):this._renderBackground(p),this._render(p),this._drawClipPath(p,this.clipPath),this.fill=v,this.stroke=y},_drawClipPath:function(p,x){x&&(x.canvas=this.canvas,x.shouldCache(),x._transformDone=!0,x.renderCache({forClipping:!0}),this.drawClipPathOnCache(p,x))},drawCacheOnCanvas:function(p){p.scale(1/this.zoomX,1/this.zoomY),p.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(p){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!p&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!p){var x=this.cacheWidth/this.zoomX,v=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-x/2,-v/2,x,v)}return!0}return!1},_renderBackground:function(p){if(this.backgroundColor){var x=this._getNonTransformedDimensions();p.fillStyle=this.backgroundColor,p.fillRect(-x.x/2,-x.y/2,x.x,x.y),this._removeShadow(p)}},_setOpacity:function(p){this.group&&!this.group._transformDone?p.globalAlpha=this.getObjectOpacity():p.globalAlpha*=this.opacity},_setStrokeStyles:function(p,x){var v=x.stroke;v&&(p.lineWidth=x.strokeWidth,p.lineCap=x.strokeLineCap,p.lineDashOffset=x.strokeDashOffset,p.lineJoin=x.strokeLineJoin,p.miterLimit=x.strokeMiterLimit,v.toLive?v.gradientUnits==="percentage"||v.gradientTransform||v.patternTransform?this._applyPatternForTransformedGradient(p,v):(p.strokeStyle=v.toLive(p,this),this._applyPatternGradientTransform(p,v)):p.strokeStyle=x.stroke)},_setFillStyles:function(p,x){var v=x.fill;v&&(v.toLive?(p.fillStyle=v.toLive(p,this),this._applyPatternGradientTransform(p,x.fill)):p.fillStyle=v)},_setClippingProperties:function(p){p.globalAlpha=1,p.strokeStyle="transparent",p.fillStyle="#000000"},_setLineDash:function(p,x){!x||x.length===0||(1&x.length&&x.push.apply(x,x),p.setLineDash(x))},_renderControls:function(p,x){var v=this.getViewportTransform(),y=this.calcTransformMatrix(),_,b,S;x=x||{},b=typeof x.hasBorders<"u"?x.hasBorders:this.hasBorders,S=typeof x.hasControls<"u"?x.hasControls:this.hasControls,y=a.util.multiplyTransformMatrices(v,y),_=a.util.qrDecompose(y),p.save(),p.translate(_.translateX,_.translateY),p.lineWidth=1*this.borderScaleFactor,this.group||(p.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(_.angle-=180),p.rotate(u(this.group?_.angle:this.angle)),x.forActiveSelection||this.group?b&&this.drawBordersInGroup(p,_,x):b&&this.drawBorders(p,x),S&&this.drawControls(p,x),p.restore()},_setShadow:function(p){if(this.shadow){var x=this.shadow,v=this.canvas,y,_=v&&v.viewportTransform[0]||1,b=v&&v.viewportTransform[3]||1;x.nonScaling?y={scaleX:1,scaleY:1}:y=this.getObjectScaling(),v&&v._isRetinaScaling()&&(_*=a.devicePixelRatio,b*=a.devicePixelRatio),p.shadowColor=x.color,p.shadowBlur=x.blur*a.browserShadowBlurConstant*(_+b)*(y.scaleX+y.scaleY)/4,p.shadowOffsetX=x.offsetX*_*y.scaleX,p.shadowOffsetY=x.offsetY*b*y.scaleY}},_removeShadow:function(p){this.shadow&&(p.shadowColor="",p.shadowBlur=p.shadowOffsetX=p.shadowOffsetY=0)},_applyPatternGradientTransform:function(p,x){if(!x||!x.toLive)return{offsetX:0,offsetY:0};var v=x.gradientTransform||x.patternTransform,y=-this.width/2+x.offsetX||0,_=-this.height/2+x.offsetY||0;return x.gradientUnits==="percentage"?p.transform(this.width,0,0,this.height,y,_):p.transform(1,0,0,1,y,_),v&&p.transform(v[0],v[1],v[2],v[3],v[4],v[5]),{offsetX:y,offsetY:_}},_renderPaintInOrder:function(p){this.paintFirst==="stroke"?(this._renderStroke(p),this._renderFill(p)):(this._renderFill(p),this._renderStroke(p))},_render:function(){},_renderFill:function(p){this.fill&&(p.save(),this._setFillStyles(p,this),this.fillRule==="evenodd"?p.fill("evenodd"):p.fill(),p.restore())},_renderStroke:function(p){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(p),p.save(),this.strokeUniform&&this.group){var x=this.getObjectScaling();p.scale(1/x.scaleX,1/x.scaleY)}else this.strokeUniform&&p.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(p,this.strokeDashArray),this._setStrokeStyles(p,this),p.stroke(),p.restore()}},_applyPatternForTransformedGradient:function(p,x){var v=this._limitCacheSize(this._getCacheCanvasDimensions()),y=a.util.createCanvasElement(),_,b=this.canvas.getRetinaScaling(),S=v.x/this.scaleX/b,C=v.y/this.scaleY/b;y.width=Math.ceil(S),y.height=Math.ceil(C),_=y.getContext("2d"),_.beginPath(),_.moveTo(0,0),_.lineTo(S,0),_.lineTo(S,C),_.lineTo(0,C),_.closePath(),_.translate(S/2,C/2),_.scale(v.zoomX/this.scaleX/b,v.zoomY/this.scaleY/b),this._applyPatternGradientTransform(_,x),_.fillStyle=x.toLive(p),_.fill(),p.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),p.scale(b*this.scaleX/v.zoomX,b*this.scaleY/v.zoomY),p.strokeStyle=_.createPattern(y,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var p=a.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",p.scaleX),this.set("scaleY",p.scaleY),this.angle=p.angle,this.skewX=p.skewX,this.skewY=0}},_removeTransformMatrix:function(p){var x=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),x=a.util.transformPoint(x,this.transformMatrix)),this.transformMatrix=null,p&&(this.scaleX*=p.scaleX,this.scaleY*=p.scaleY,this.cropX=p.cropX,this.cropY=p.cropY,x.x+=p.offsetLeft,x.y+=p.offsetTop,this.width=p.width,this.height=p.height),this.setPositionByOrigin(x,"center","center")},clone:function(p,x){var v=this.toObject(x);this.constructor.fromObject?this.constructor.fromObject(v,p):a.Object._fromObject("Object",v,p)},cloneAsImage:function(p,x){var v=this.toCanvasElement(x);return p&&p(new a.Image(v)),this},toCanvasElement:function(p){p||(p={});var x=a.util,v=x.saveObjectTransform(this),y=this.group,_=this.shadow,b=Math.abs,S=(p.multiplier||1)*(p.enableRetinaScaling?a.devicePixelRatio:1);delete this.group,p.withoutTransform&&x.resetObjectTransform(this),p.withoutShadow&&(this.shadow=null);var C=a.util.createCanvasElement(),N=this.getBoundingRect(!0,!0),F=this.shadow,Y,X={x:0,y:0},V,te,G;F&&(V=F.blur,F.nonScaling?Y={scaleX:1,scaleY:1}:Y=this.getObjectScaling(),X.x=2*Math.round(b(F.offsetX)+V)*b(Y.scaleX),X.y=2*Math.round(b(F.offsetY)+V)*b(Y.scaleY)),te=N.width+X.x,G=N.height+X.y,C.width=Math.ceil(te),C.height=Math.ceil(G);var re=new a.StaticCanvas(C,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});p.format==="jpeg"&&(re.backgroundColor="#fff"),this.setPositionByOrigin(new a.Point(re.width/2,re.height/2),"center","center");var Z=this.canvas;re.add(this);var oe=re.toCanvasElement(S||1,p);return this.shadow=_,this.set("canvas",Z),y&&(this.group=y),this.set(v).setCoords(),re._objects=[],re.dispose(),re=null,oe},toDataURL:function(p){return p||(p={}),a.util.toDataURL(this.toCanvasElement(p),p.format||"png",p.quality||1)},isType:function(p){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===p},complexity:function(){return 1},toJSON:function(p){return this.toObject(p)},rotate:function(p){var x=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return x&&this._setOriginToCenter(),this.set("angle",p),x&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(p,x){x=x||this.canvas.getPointer(p);var v=new a.Point(x.x,x.y),y=this._getLeftTopCoords();return this.angle&&(v=a.util.rotatePoint(v,y,u(-this.angle))),{x:v.x-y.x,y:v.y-y.y}},_setupCompositeOperation:function(p){this.globalCompositeOperation&&(p.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){a.runningAnimations&&a.runningAnimations.cancelByTarget(this)}}),a.util.createAccessors&&a.util.createAccessors(a.Object),c(a.Object.prototype,a.Observable),a.Object.NUM_FRACTION_DIGITS=2,a.Object.ENLIVEN_PROPS=["clipPath"],a.Object._fromObject=function(p,x,v,y){var _=a[p];x=d(x,!0),a.util.enlivenPatterns([x.fill,x.stroke],function(b){typeof b[0]<"u"&&(x.fill=b[0]),typeof b[1]<"u"&&(x.stroke=b[1]),a.util.enlivenObjectEnlivables(x,x,function(){var S=y?new _(x[y],x):new _(x);v&&v(S)})})},a.Object.__uid=0)}(e),function(){var o=t.util.degreesToRadians,a={left:-.5,center:0,right:.5},c={top:-.5,center:0,bottom:.5};t.util.object.extend(t.Object.prototype,{translateToGivenOrigin:function(d,f,h,u,g){var m=d.x,p=d.y,x,v,y;return typeof f=="string"?f=a[f]:f-=.5,typeof u=="string"?u=a[u]:u-=.5,x=u-f,typeof h=="string"?h=c[h]:h-=.5,typeof g=="string"?g=c[g]:g-=.5,v=g-h,(x||v)&&(y=this._getTransformedDimensions(),m=d.x+x*y.x,p=d.y+v*y.y),new t.Point(m,p)},translateToCenterPoint:function(d,f,h){var u=this.translateToGivenOrigin(d,f,h,"center","center");return this.angle?t.util.rotatePoint(u,d,o(this.angle)):u},translateToOriginPoint:function(d,f,h){var u=this.translateToGivenOrigin(d,"center","center",f,h);return this.angle?t.util.rotatePoint(u,d,o(this.angle)):u},getCenterPoint:function(){var d=new t.Point(this.left,this.top);return this.translateToCenterPoint(d,this.originX,this.originY)},getPointByOrigin:function(d,f){var h=this.getCenterPoint();return this.translateToOriginPoint(h,d,f)},toLocalPoint:function(d,f,h){var u=this.getCenterPoint(),g,m;return typeof f<"u"&&typeof h<"u"?g=this.translateToGivenOrigin(u,"center","center",f,h):g=new t.Point(this.left,this.top),m=new t.Point(d.x,d.y),this.angle&&(m=t.util.rotatePoint(m,u,-o(this.angle))),m.subtractEquals(g)},setPositionByOrigin:function(d,f,h){var u=this.translateToCenterPoint(d,f,h),g=this.translateToOriginPoint(u,this.originX,this.originY);this.set("left",g.x),this.set("top",g.y)},adjustPosition:function(d){var f=o(this.angle),h=this.getScaledWidth(),u=t.util.cos(f)*h,g=t.util.sin(f)*h,m,p;typeof this.originX=="string"?m=a[this.originX]:m=this.originX-.5,typeof d=="string"?p=a[d]:p=d-.5,this.left+=u*(p-m),this.top+=g*(p-m),this.setCoords(),this.originX=d},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var d=this.getCenterPoint();this.originX="center",this.originY="center",this.left=d.x,this.top=d.y},_resetOrigin:function(){var d=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=d.x,this.top=d.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function o(h){return[new t.Point(h.tl.x,h.tl.y),new t.Point(h.tr.x,h.tr.y),new t.Point(h.br.x,h.br.y),new t.Point(h.bl.x,h.bl.y)]}var a=t.util,c=a.degreesToRadians,d=a.multiplyTransformMatrices,f=a.transformPoint;a.object.extend(t.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(h,u){return u?h?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),h?this.aCoords:this.lineCoords)},getCoords:function(h,u){return o(this._getCoords(h,u))},intersectsWithRect:function(h,u,g,m){var p=this.getCoords(g,m),x=t.Intersection.intersectPolygonRectangle(p,h,u);return x.status==="Intersection"},intersectsWithObject:function(h,u,g){var m=t.Intersection.intersectPolygonPolygon(this.getCoords(u,g),h.getCoords(u,g));return m.status==="Intersection"||h.isContainedWithinObject(this,u,g)||this.isContainedWithinObject(h,u,g)},isContainedWithinObject:function(h,u,g){for(var m=this.getCoords(u,g),p=u?h.aCoords:h.lineCoords,x=0,v=h._getImageLines(p);x<4;x++)if(!h.containsPoint(m[x],v))return!1;return!0},isContainedWithinRect:function(h,u,g,m){var p=this.getBoundingRect(g,m);return p.left>=h.x&&p.left+p.width<=u.x&&p.top>=h.y&&p.top+p.height<=u.y},containsPoint:function(h,x,g,m){var p=this._getCoords(g,m),x=x||this._getImageLines(p),v=this._findCrossPoints(h,x);return v!==0&&v%2===1},isOnScreen:function(h){if(!this.canvas)return!1;var u=this.canvas.vptCoords.tl,g=this.canvas.vptCoords.br,m=this.getCoords(!0,h);return m.some(function(p){return p.x<=g.x&&p.x>=u.x&&p.y<=g.y&&p.y>=u.y})||this.intersectsWithRect(u,g,!0,h)?!0:this._containsCenterOfCanvas(u,g,h)},_containsCenterOfCanvas:function(h,u,g){var m={x:(h.x+u.x)/2,y:(h.y+u.y)/2};return!!this.containsPoint(m,null,!0,g)},isPartiallyOnScreen:function(h){if(!this.canvas)return!1;var u=this.canvas.vptCoords.tl,g=this.canvas.vptCoords.br;if(this.intersectsWithRect(u,g,!0,h))return!0;var m=this.getCoords(!0,h).every(function(p){return(p.x>=g.x||p.x<=u.x)&&(p.y>=g.y||p.y<=u.y)});return m&&this._containsCenterOfCanvas(u,g,h)},_getImageLines:function(h){var u={topline:{o:h.tl,d:h.tr},rightline:{o:h.tr,d:h.br},bottomline:{o:h.br,d:h.bl},leftline:{o:h.bl,d:h.tl}};return u},_findCrossPoints:function(h,u){var g,m,p,x,v,y=0,_;for(var b in u)if(_=u[b],!(_.o.y<h.y&&_.d.y<h.y)&&!(_.o.y>=h.y&&_.d.y>=h.y)&&(_.o.x===_.d.x&&_.o.x>=h.x?v=_.o.x:(g=0,m=(_.d.y-_.o.y)/(_.d.x-_.o.x),p=h.y-g*h.x,x=_.o.y-m*_.o.x,v=-(p-x)/(g-m)),v>=h.x&&(y+=1),y===2))break;return y},getBoundingRect:function(h,u){var g=this.getCoords(h,u);return a.makeBoundingBoxFromPoints(g)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(h){return Math.abs(h)<this.minScaleLimit?h<0?-this.minScaleLimit:this.minScaleLimit:h===0?1e-4:h},scale:function(h){return this._set("scaleX",h),this._set("scaleY",h),this.setCoords()},scaleToWidth:function(h,u){var g=this.getBoundingRect(u).width/this.getScaledWidth();return this.scale(h/this.width/g)},scaleToHeight:function(h,u){var g=this.getBoundingRect(u).height/this.getScaledHeight();return this.scale(h/this.height/g)},calcLineCoords:function(){var h=this.getViewportTransform(),u=this.padding,g=c(this.angle),m=a.cos(g),p=a.sin(g),x=m*u,v=p*u,y=x+v,_=x-v,b=this.calcACoords(),S={tl:f(b.tl,h),tr:f(b.tr,h),bl:f(b.bl,h),br:f(b.br,h)};return u&&(S.tl.x-=_,S.tl.y-=y,S.tr.x+=y,S.tr.y-=_,S.bl.x-=y,S.bl.y+=_,S.br.x+=_,S.br.y+=y),S},calcOCoords:function(){var h=this._calcRotateMatrix(),u=this._calcTranslateMatrix(),g=this.getViewportTransform(),m=d(g,u),p=d(m,h),p=d(p,[1/g[0],0,0,1/g[3],0,0]),x=this._calculateCurrentDimensions(),v={};return this.forEachControl(function(y,_,b){v[_]=y.positionHandler(x,p,b)}),v},calcACoords:function(){var h=this._calcRotateMatrix(),u=this._calcTranslateMatrix(),g=d(u,h),m=this._getTransformedDimensions(),p=m.x/2,x=m.y/2;return{tl:f({x:-p,y:-x},g),tr:f({x:p,y:-x},g),bl:f({x:-p,y:x},g),br:f({x:p,y:x},g)}},setCoords:function(h){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),h?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return a.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var h=this.getCenterPoint();return[1,0,0,1,h.x,h.y]},transformMatrixKey:function(h){var u="_",g="";return!h&&this.group&&(g=this.group.transformMatrixKey(h)+u),g+this.top+u+this.left+u+this.scaleX+u+this.scaleY+u+this.skewX+u+this.skewY+u+this.angle+u+this.originX+u+this.originY+u+this.width+u+this.height+u+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(h){var u=this.calcOwnMatrix();if(h||!this.group)return u;var g=this.transformMatrixKey(h),m=this.matrixCache||(this.matrixCache={});return m.key===g?m.value:(this.group&&(u=d(this.group.calcTransformMatrix(!1),u)),m.key=g,m.value=u,u)},calcOwnMatrix:function(){var h=this.transformMatrixKey(!0),u=this.ownMatrixCache||(this.ownMatrixCache={});if(u.key===h)return u.value;var g=this._calcTranslateMatrix(),m={angle:this.angle,translateX:g[4],translateY:g[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return u.key=h,u.value=a.composeMatrix(m),u.value},_getNonTransformedDimensions:function(){var h=this.strokeWidth,u=this.width+h,g=this.height+h;return{x:u,y:g}},_getTransformedDimensions:function(h,u){typeof h>"u"&&(h=this.skewX),typeof u>"u"&&(u=this.skewY);var g,m,p,x=h===0&&u===0;if(this.strokeUniform?(m=this.width,p=this.height):(g=this._getNonTransformedDimensions(),m=g.x,p=g.y),x)return this._finalizeDimensions(m*this.scaleX,p*this.scaleY);var v=a.sizeAfterTransform(m,p,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:h,skewY:u});return this._finalizeDimensions(v.x,v.y)},_finalizeDimensions:function(h,u){return this.strokeUniform?{x:h+this.strokeWidth,y:u+this.strokeWidth}:{x:h,y:u}},_calculateCurrentDimensions:function(){var h=this.getViewportTransform(),u=this._getTransformedDimensions(),g=f(u,h,!0);return g.scalarAdd(2*this.padding)}})}(),t.util.object.extend(t.Object.prototype,{sendToBack:function(){return this.group?t.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?t.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(o){return this.group?t.StaticCanvas.prototype.sendBackwards.call(this.group,this,o):this.canvas&&this.canvas.sendBackwards(this,o),this},bringForward:function(o){return this.group?t.StaticCanvas.prototype.bringForward.call(this.group,this,o):this.canvas&&this.canvas.bringForward(this,o),this},moveTo:function(o){return this.group&&this.group.type!=="activeSelection"?t.StaticCanvas.prototype.moveTo.call(this.group,this,o):this.canvas&&this.canvas.moveTo(this,o),this}}),function(){function o(c,d){if(d){if(d.toLive)return c+": url(#SVGID_"+d.id+"); ";var f=new t.Color(d),h=c+": "+f.toRgb()+"; ",u=f.getAlpha();return u!==1&&(h+=c+"-opacity: "+u.toString()+"; "),h}else return c+": none; "}var a=t.util.toFixed;t.util.object.extend(t.Object.prototype,{getSvgStyles:function(c){var d=this.fillRule?this.fillRule:"nonzero",f=this.strokeWidth?this.strokeWidth:"0",h=this.strokeDashArray?this.strokeDashArray.join(" "):"none",u=this.strokeDashOffset?this.strokeDashOffset:"0",g=this.strokeLineCap?this.strokeLineCap:"butt",m=this.strokeLineJoin?this.strokeLineJoin:"miter",p=this.strokeMiterLimit?this.strokeMiterLimit:"4",x=typeof this.opacity<"u"?this.opacity:"1",v=this.visible?"":" visibility: hidden;",y=c?"":this.getSvgFilter(),_=o("fill",this.fill),b=o("stroke",this.stroke);return[b,"stroke-width: ",f,"; ","stroke-dasharray: ",h,"; ","stroke-linecap: ",g,"; ","stroke-dashoffset: ",u,"; ","stroke-linejoin: ",m,"; ","stroke-miterlimit: ",p,"; ",_,"fill-rule: ",d,"; ","opacity: ",x,";",y,v].join("")},getSvgSpanStyles:function(c,d){var f="; ",u=c.fontFamily?"font-family: "+(c.fontFamily.indexOf("'")===-1&&c.fontFamily.indexOf('"')===-1?"'"+c.fontFamily+"'":c.fontFamily)+f:"",h=c.strokeWidth?"stroke-width: "+c.strokeWidth+f:"",u=u,g=c.fontSize?"font-size: "+c.fontSize+"px"+f:"",m=c.fontStyle?"font-style: "+c.fontStyle+f:"",p=c.fontWeight?"font-weight: "+c.fontWeight+f:"",x=c.fill?o("fill",c.fill):"",v=c.stroke?o("stroke",c.stroke):"",y=this.getSvgTextDecoration(c),_=c.deltaY?"baseline-shift: "+-c.deltaY+"; ":"";return y&&(y="text-decoration: "+y+f),[v,h,u,g,m,p,y,x,_,d?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(c){return["overline","underline","line-through"].filter(function(d){return c[d.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(c,d){var f=c?this.calcTransformMatrix():this.calcOwnMatrix(),h='transform="'+t.util.matrixToSVG(f);return h+(d||"")+'" '},_setSVGBg:function(c){if(this.backgroundColor){var d=t.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',a(-this.width/2,d),'" y="',a(-this.height/2,d),'" width="',a(this.width,d),'" height="',a(this.height,d),`"></rect>
`)}},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(c),{reviver:c})},toClipPathSVG:function(c){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(c),{reviver:c})},_createBaseClipPathSVGMarkup:function(c,d){d=d||{};var f=d.reviver,h=d.additionalTransform||"",u=[this.getSvgTransform(!0,h),this.getSvgCommons()].join(""),g=c.indexOf("COMMON_PARTS");return c[g]=u,f?f(c.join("")):c.join("")},_createBaseSVGMarkup:function(c,d){d=d||{};var f=d.noStyle,h=d.reviver,u=f?"":'style="'+this.getSvgStyles()+'" ',g=d.withShadow?'style="'+this.getSvgFilter()+'" ':"",m=this.clipPath,p=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",x=m&&m.absolutePositioned,v=this.stroke,y=this.fill,_=this.shadow,b,S=[],C,N=c.indexOf("COMMON_PARTS"),F=d.additionalTransform;return m&&(m.clipPathId="CLIPPATH_"+t.Object.__uid++,C='<clipPath id="'+m.clipPathId+`" >
`+m.toClipPathSVG(h)+`</clipPath>
`),x&&S.push("<g ",g,this.getSvgCommons(),` >
`),S.push("<g ",this.getSvgTransform(!1),x?"":g+this.getSvgCommons(),` >
`),b=[u,p,f?"":this.addPaintOrder()," ",F?'transform="'+F+'" ':""].join(""),c[N]=b,y&&y.toLive&&S.push(y.toSVG(this)),v&&v.toLive&&S.push(v.toSVG(this)),_&&S.push(_.toSVG(this)),m&&S.push(C),S.push(c.join("")),S.push(`</g>
`),x&&S.push(`</g>
`),h?h(S.join("")):S.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var o=t.util.object.extend,a="stateProperties";function c(f,h,u){var g={},m=!0;u.forEach(function(p){g[p]=f[p]}),o(f[h],g,m)}function d(f,h,u){if(f===h)return!0;if(Array.isArray(f)){if(!Array.isArray(h)||f.length!==h.length)return!1;for(var g=0,m=f.length;g<m;g++)if(!d(f[g],h[g]))return!1;return!0}else if(f&&typeof f=="object"){var p=Object.keys(f),x;if(!h||typeof h!="object"||!u&&p.length!==Object.keys(h).length)return!1;for(var g=0,m=p.length;g<m;g++)if(x=p[g],!(x==="canvas"||x==="group")&&!d(f[x],h[x]))return!1;return!0}}t.util.object.extend(t.Object.prototype,{hasStateChanged:function(f){f=f||a;var h="_"+f;return Object.keys(this[h]).length<this[f].length?!0:!d(this[h],this,!0)},saveState:function(f){var h=f&&f.propertySet||a,u="_"+h;return this[u]?(c(this,u,this[h]),f&&f.stateProperties&&c(this,u,f.stateProperties),this):this.setupState(f)},setupState:function(f){f=f||{};var h=f.propertySet||a;return f.propertySet=h,this["_"+h]={},this.saveState(f),this}})}(),function(){var o=t.util.degreesToRadians;t.util.object.extend(t.Object.prototype,{_findTargetCorner:function(a,c){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var d=a.x,f=a.y,h,u,g=Object.keys(this.oCoords),m=g.length-1,p;for(this.__corner=0;m>=0;m--)if(p=g[m],!!this.isControlVisible(p)&&(u=this._getImageLines(c?this.oCoords[p].touchCorner:this.oCoords[p].corner),h=this._findCrossPoints({x:d,y:f},u),h!==0&&h%2===1))return this.__corner=p,p;return!1},forEachControl:function(a){for(var c in this.controls)a(this.controls[c],c,this)},_setCornerCoords:function(){var a=this.oCoords;for(var c in a){var d=this.controls[c];a[c].corner=d.calcCornerCoords(this.angle,this.cornerSize,a[c].x,a[c].y,!1),a[c].touchCorner=d.calcCornerCoords(this.angle,this.touchCornerSize,a[c].x,a[c].y,!0)}},drawSelectionBackground:function(a){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;a.save();var c=this.getCenterPoint(),d=this._calculateCurrentDimensions(),f=this.canvas.viewportTransform;return a.translate(c.x,c.y),a.scale(1/f[0],1/f[3]),a.rotate(o(this.angle)),a.fillStyle=this.selectionBackgroundColor,a.fillRect(-d.x/2,-d.y/2,d.x,d.y),a.restore(),this},drawBorders:function(a,c){c=c||{};var d=this._calculateCurrentDimensions(),f=this.borderScaleFactor,h=d.x+f,u=d.y+f,g=typeof c.hasControls<"u"?c.hasControls:this.hasControls,m=!1;return a.save(),a.strokeStyle=c.borderColor||this.borderColor,this._setLineDash(a,c.borderDashArray||this.borderDashArray),a.strokeRect(-h/2,-u/2,h,u),g&&(a.beginPath(),this.forEachControl(function(p,x,v){p.withConnection&&p.getVisibility(v,x)&&(m=!0,a.moveTo(p.x*h,p.y*u),a.lineTo(p.x*h+p.offsetX,p.y*u+p.offsetY))}),m&&a.stroke()),a.restore(),this},drawBordersInGroup:function(a,c,d){d=d||{};var f=t.util.sizeAfterTransform(this.width,this.height,c),h=this.strokeWidth,u=this.strokeUniform,g=this.borderScaleFactor,m=f.x+h*(u?this.canvas.getZoom():c.scaleX)+g,p=f.y+h*(u?this.canvas.getZoom():c.scaleY)+g;return a.save(),this._setLineDash(a,d.borderDashArray||this.borderDashArray),a.strokeStyle=d.borderColor||this.borderColor,a.strokeRect(-m/2,-p/2,m,p),a.restore(),this},drawControls:function(a,c){c=c||{},a.save();var d=1,f,h;return this.canvas&&(d=this.canvas.getRetinaScaling()),a.setTransform(d,0,0,d,0,0),a.strokeStyle=a.fillStyle=c.cornerColor||this.cornerColor,this.transparentCorners||(a.strokeStyle=c.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(a,c.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(f=this.group.calcTransformMatrix()),this.forEachControl(function(u,g,m){h=m.oCoords[g],u.getVisibility(m,g)&&(f&&(h=t.util.transformPoint(h,f)),u.render(a,h.x,h.y,c,m))}),a.restore(),this},isControlVisible:function(a){return this.controls[a]&&this.controls[a].getVisibility(this,a)},setControlVisible:function(a,c){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[a]=c,this},setControlsVisibility:function(a){a||(a={});for(var c in a)this.setControlVisible(c,a[c]);return this},onDeselect:function(){},onSelect:function(){}})}(),t.util.object.extend(t.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(o,a){a=a||{};var c=function(){},d=a.onComplete||c,f=a.onChange||c,h=this;return t.util.animate({target:this,startValue:o.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(u){o.set("left",u),h.requestRenderAll(),f()},onComplete:function(){o.setCoords(),d()}})},fxCenterObjectV:function(o,a){a=a||{};var c=function(){},d=a.onComplete||c,f=a.onChange||c,h=this;return t.util.animate({target:this,startValue:o.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(u){o.set("top",u),h.requestRenderAll(),f()},onComplete:function(){o.setCoords(),d()}})},fxRemove:function(o,a){a=a||{};var c=function(){},d=a.onComplete||c,f=a.onChange||c,h=this;return t.util.animate({target:this,startValue:o.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(u){o.set("opacity",u),h.requestRenderAll(),f()},onComplete:function(){h.remove(o),d()}})}}),t.util.object.extend(t.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var o=[],a,c,d=[];for(a in arguments[0])o.push(a);for(var f=0,h=o.length;f<h;f++)a=o[f],c=f!==h-1,d.push(this._animate(a,arguments[0][a],arguments[1],c));return d}else return this._animate.apply(this,arguments)},_animate:function(o,a,c,d){var f=this,h;a=a.toString(),c?c=t.util.object.clone(c):c={},~o.indexOf(".")&&(h=o.split("."));var u=f.colorProperties.indexOf(o)>-1||h&&f.colorProperties.indexOf(h[1])>-1,g=h?this.get(h[0])[h[1]]:this.get(o);"from"in c||(c.from=g),u||(~a.indexOf("=")?a=g+parseFloat(a.replace("=","")):a=parseFloat(a));var m={target:this,startValue:c.from,endValue:a,byValue:c.by,easing:c.easing,duration:c.duration,abort:c.abort&&function(p,x,v){return c.abort.call(f,p,x,v)},onChange:function(p,x,v){h?f[h[0]][h[1]]=p:f.set(o,p),!d&&c.onChange&&c.onChange(p,x,v)},onComplete:function(p,x,v){d||(f.setCoords(),c.onComplete&&c.onComplete(p,x,v))}};return u?t.util.animateColor(m.startValue,m.endValue,m.duration,m):t.util.animate(m)}}),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.util.object.clone,f={x1:1,x2:1,y1:1,y2:1};if(a.Line){a.warn("fabric.Line is already defined");return}a.Line=a.util.createClass(a.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:a.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(u,g){u||(u=[0,0,0,0]),this.callSuper("initialize",g),this.set("x1",u[0]),this.set("y1",u[1]),this.set("x2",u[2]),this.set("y2",u[3]),this._setWidthHeight(g)},_setWidthHeight:function(u){u||(u={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in u?u.left:this._getLeftToOriginX(),this.top="top"in u?u.top:this._getTopToOriginY()},_set:function(u,g){return this.callSuper("_set",u,g),typeof f[u]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:h({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:h({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(u){u.beginPath();var g=this.calcLinePoints();u.moveTo(g.x1,g.y1),u.lineTo(g.x2,g.y2),u.lineWidth=this.strokeWidth;var m=u.strokeStyle;u.strokeStyle=this.stroke||u.fillStyle,this.stroke&&this._renderStroke(u),u.strokeStyle=m},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(u){return c(this.callSuper("toObject",u),this.calcLinePoints())},_getNonTransformedDimensions:function(){var u=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(u.y-=this.strokeWidth),this.height===0&&(u.x-=this.strokeWidth)),u},calcLinePoints:function(){var u=this.x1<=this.x2?-1:1,g=this.y1<=this.y2?-1:1,m=u*this.width*.5,p=g*this.height*.5,x=u*this.width*-.5,v=g*this.height*-.5;return{x1:m,x2:x,y1:p,y2:v}},_toSVG:function(){var u=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',u.x1,'" y1="',u.y1,'" x2="',u.x2,'" y2="',u.y2,`" />
`]}}),a.Line.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),a.Line.fromElement=function(u,g,m){m=m||{};var p=a.parseAttributes(u,a.Line.ATTRIBUTE_NAMES),x=[p.x1||0,p.y1||0,p.x2||0,p.y2||0];g(new a.Line(x,c(p,m)))},a.Line.fromObject=function(u,g){function m(x){delete x.points,g&&g(x)}var p=d(u,!0);p.points=[u.x1,u.y1,u.x2,u.y2],a.Object._fromObject("Line",p,m,"points")};function h(u,g){var m=u.origin,p=u.axis1,x=u.axis2,v=u.dimension,y=g.nearest,_=g.center,b=g.farthest;return function(){switch(this.get(m)){case y:return Math.min(this.get(p),this.get(x));case _:return Math.min(this.get(p),this.get(x))+.5*this.get(v);case b:return Math.max(this.get(p),this.get(x))}}}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.degreesToRadians;if(a.Circle){a.warn("fabric.Circle is already defined.");return}a.Circle=a.util.createClass(a.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:a.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(f,h){return this.callSuper("_set",f,h),f==="radius"&&this.setRadius(h),this},toObject:function(f){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(f))},_toSVG:function(){var f,h=0,u=0,g=(this.endAngle-this.startAngle)%360;if(g===0)f=["<circle ","COMMON_PARTS",'cx="'+h+'" cy="'+u+'" ','r="',this.radius,`" />
`];else{var m=c(this.startAngle),p=c(this.endAngle),x=this.radius,v=a.util.cos(m)*x,y=a.util.sin(m)*x,_=a.util.cos(p)*x,b=a.util.sin(p)*x,S=g>180?"1":"0";f=['<path d="M '+v+" "+y," A "+x+" "+x," 0 ",+S+" 1"," "+_+" "+b,'" ',"COMMON_PARTS",` />
`]}return f},_render:function(f){f.beginPath(),f.arc(0,0,this.radius,c(this.startAngle),c(this.endAngle),!1),this._renderPaintInOrder(f)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(f){return this.radius=f,this.set("width",f*2).set("height",f*2)}}),a.Circle.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),a.Circle.fromElement=function(f,h){var u=a.parseAttributes(f,a.Circle.ATTRIBUTE_NAMES);if(!d(u))throw new Error("value of `r` attribute is required and can not be negative");u.left=(u.left||0)-u.radius,u.top=(u.top||0)-u.radius,h(new a.Circle(u))};function d(f){return"radius"in f&&f.radius>=0}a.Circle.fromObject=function(f,h){a.Object._fromObject("Circle",f,h)}}(e),function(o){var a=o.fabric||(o.fabric={});if(a.Triangle){a.warn("fabric.Triangle is already defined");return}a.Triangle=a.util.createClass(a.Object,{type:"triangle",width:100,height:100,_render:function(c){var d=this.width/2,f=this.height/2;c.beginPath(),c.moveTo(-d,f),c.lineTo(0,-f),c.lineTo(d,f),c.closePath(),this._renderPaintInOrder(c)},_toSVG:function(){var c=this.width/2,d=this.height/2,f=[-c+" "+d,"0 "+-d,c+" "+d].join(",");return["<polygon ","COMMON_PARTS",'points="',f,'" />']}}),a.Triangle.fromObject=function(c,d){return a.Object._fromObject("Triangle",c,d)}}(e),function(o){var a=o.fabric||(o.fabric={}),c=Math.PI*2;if(a.Ellipse){a.warn("fabric.Ellipse is already defined.");return}a.Ellipse=a.util.createClass(a.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:a.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(d){this.callSuper("initialize",d),this.set("rx",d&&d.rx||0),this.set("ry",d&&d.ry||0)},_set:function(d,f){switch(this.callSuper("_set",d,f),d){case"rx":this.rx=f,this.set("width",f*2);break;case"ry":this.ry=f,this.set("height",f*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(d){return this.callSuper("toObject",["rx","ry"].concat(d))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(d){d.beginPath(),d.save(),d.transform(1,0,0,this.ry/this.rx,0,0),d.arc(0,0,this.rx,0,c,!1),d.restore(),this._renderPaintInOrder(d)}}),a.Ellipse.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),a.Ellipse.fromElement=function(d,f){var h=a.parseAttributes(d,a.Ellipse.ATTRIBUTE_NAMES);h.left=(h.left||0)-h.rx,h.top=(h.top||0)-h.ry,f(new a.Ellipse(h))},a.Ellipse.fromObject=function(d,f){a.Object._fromObject("Ellipse",d,f)}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend;if(a.Rect){a.warn("fabric.Rect is already defined");return}a.Rect=a.util.createClass(a.Object,{stateProperties:a.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:a.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(d){this.callSuper("initialize",d),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(d){var f=this.rx?Math.min(this.rx,this.width/2):0,h=this.ry?Math.min(this.ry,this.height/2):0,u=this.width,g=this.height,m=-this.width/2,p=-this.height/2,x=f!==0||h!==0,v=1-.5522847498;d.beginPath(),d.moveTo(m+f,p),d.lineTo(m+u-f,p),x&&d.bezierCurveTo(m+u-v*f,p,m+u,p+v*h,m+u,p+h),d.lineTo(m+u,p+g-h),x&&d.bezierCurveTo(m+u,p+g-v*h,m+u-v*f,p+g,m+u-f,p+g),d.lineTo(m+f,p+g),x&&d.bezierCurveTo(m+v*f,p+g,m,p+g-v*h,m,p+g-h),d.lineTo(m,p+h),x&&d.bezierCurveTo(m,p+v*h,m+v*f,p,m+f,p),d.closePath(),this._renderPaintInOrder(d)},toObject:function(d){return this.callSuper("toObject",["rx","ry"].concat(d))},_toSVG:function(){var d=-this.width/2,f=-this.height/2;return["<rect ","COMMON_PARTS",'x="',d,'" y="',f,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),a.Rect.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),a.Rect.fromElement=function(d,f,h){if(!d)return f(null);h=h||{};var u=a.parseAttributes(d,a.Rect.ATTRIBUTE_NAMES);u.left=u.left||0,u.top=u.top||0,u.height=u.height||0,u.width=u.width||0;var g=new a.Rect(c(h?a.util.object.clone(h):{},u));g.visible=g.visible&&g.width>0&&g.height>0,f(g)},a.Rect.fromObject=function(d,f){return a.Object._fromObject("Rect",d,f)}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.util.array.min,f=a.util.array.max,h=a.util.toFixed,u=a.util.projectStrokeOnPoints;if(a.Polyline){a.warn("fabric.Polyline is already defined");return}a.Polyline=a.util.createClass(a.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:a.Object.prototype.cacheProperties.concat("points"),initialize:function(g,m){m=m||{},this.points=g||[],this.callSuper("initialize",m),this._setPositionDimensions(m)},_projectStrokeOnPoints:function(){return u(this.points,this,!0)},_setPositionDimensions:function(g){var m=this._calcDimensions(g),p,x=this.exactBoundingBox?this.strokeWidth:0;this.width=m.width-x,this.height=m.height-x,g.fromSVG||(p=this.translateToGivenOrigin({x:m.left-this.strokeWidth/2+x/2,y:m.top-this.strokeWidth/2+x/2},"left","top",this.originX,this.originY)),typeof g.left>"u"&&(this.left=g.fromSVG?m.left:p.x),typeof g.top>"u"&&(this.top=g.fromSVG?m.top:p.y),this.pathOffset={x:m.left+this.width/2+x/2,y:m.top+this.height/2+x/2}},_calcDimensions:function(){var g=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,m=d(g,"x")||0,p=d(g,"y")||0,x=f(g,"x")||0,v=f(g,"y")||0,y=x-m,_=v-p;return{left:m,top:p,width:y,height:_}},toObject:function(g){return c(this.callSuper("toObject",g),{points:this.points.concat()})},_toSVG:function(){for(var g=[],m=this.pathOffset.x,p=this.pathOffset.y,x=a.Object.NUM_FRACTION_DIGITS,v=0,y=this.points.length;v<y;v++)g.push(h(this.points[v].x-m,x),",",h(this.points[v].y-p,x)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',g.join(""),`" />
`]},commonRender:function(g){var m,p=this.points.length,x=this.pathOffset.x,v=this.pathOffset.y;if(!p||isNaN(this.points[p-1].y))return!1;g.beginPath(),g.moveTo(this.points[0].x-x,this.points[0].y-v);for(var y=0;y<p;y++)m=this.points[y],g.lineTo(m.x-x,m.y-v);return!0},_render:function(g){this.commonRender(g)&&this._renderPaintInOrder(g)},complexity:function(){return this.get("points").length}}),a.Polyline.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat(),a.Polyline.fromElementGenerator=function(g){return function(m,p,x){if(!m)return p(null);x||(x={});var v=a.parsePointsAttribute(m.getAttribute("points")),y=a.parseAttributes(m,a[g].ATTRIBUTE_NAMES);y.fromSVG=!0,p(new a[g](v,c(y,x)))}},a.Polyline.fromElement=a.Polyline.fromElementGenerator("Polyline"),a.Polyline.fromObject=function(g,m){return a.Object._fromObject("Polyline",g,m,"points")}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.projectStrokeOnPoints;if(a.Polygon){a.warn("fabric.Polygon is already defined");return}a.Polygon=a.util.createClass(a.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return c(this.points,this)},_render:function(d){this.commonRender(d)&&(d.closePath(),this._renderPaintInOrder(d))}}),a.Polygon.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat(),a.Polygon.fromElement=a.Polyline.fromElementGenerator("Polygon"),a.Polygon.fromObject=function(d,f){a.Object._fromObject("Polygon",d,f,"points")}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.array.min,d=a.util.array.max,f=a.util.object.extend,h=a.util.object.clone,u=a.util.toFixed;if(a.Path){a.warn("fabric.Path is already defined");return}a.Path=a.util.createClass(a.Object,{type:"path",path:null,cacheProperties:a.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:a.Object.prototype.stateProperties.concat("path"),initialize:function(g,m){m=h(m||{}),delete m.path,this.callSuper("initialize",m),this._setPath(g||[],m)},_setPath:function(g,m){this.path=a.util.makePathSimpler(Array.isArray(g)?g:a.util.parsePath(g)),a.Polyline.prototype._setPositionDimensions.call(this,m||{})},_renderPathCommands:function(g){var m,p=0,x=0,v=0,y=0,_=0,b=0,S=-this.pathOffset.x,C=-this.pathOffset.y;g.beginPath();for(var N=0,F=this.path.length;N<F;++N)switch(m=this.path[N],m[0]){case"L":v=m[1],y=m[2],g.lineTo(v+S,y+C);break;case"M":v=m[1],y=m[2],p=v,x=y,g.moveTo(v+S,y+C);break;case"C":v=m[5],y=m[6],_=m[3],b=m[4],g.bezierCurveTo(m[1]+S,m[2]+C,_+S,b+C,v+S,y+C);break;case"Q":g.quadraticCurveTo(m[1]+S,m[2]+C,m[3]+S,m[4]+C),v=m[3],y=m[4],_=m[1],b=m[2];break;case"z":case"Z":v=p,y=x,g.closePath();break}},_render:function(g){this._renderPathCommands(g),this._renderPaintInOrder(g)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(g){return f(this.callSuper("toObject",g),{path:this.path.map(function(m){return m.slice()})})},toDatalessObject:function(g){var m=this.toObject(["sourcePath"].concat(g));return m.sourcePath&&delete m.path,m},_toSVG:function(){var g=a.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',g,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var g=a.Object.NUM_FRACTION_DIGITS;return" translate("+u(-this.pathOffset.x,g)+", "+u(-this.pathOffset.y,g)+")"},toClipPathSVG:function(g){var m=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:g,additionalTransform:m})},toSVG:function(g){var m=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:g,additionalTransform:m})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var g=[],m=[],p,x=0,v=0,y=0,_=0,b,S=0,C=this.path.length;S<C;++S){switch(p=this.path[S],p[0]){case"L":y=p[1],_=p[2],b=[];break;case"M":y=p[1],_=p[2],x=y,v=_,b=[];break;case"C":b=a.util.getBoundsOfCurve(y,_,p[1],p[2],p[3],p[4],p[5],p[6]),y=p[5],_=p[6];break;case"Q":b=a.util.getBoundsOfCurve(y,_,p[1],p[2],p[1],p[2],p[3],p[4]),y=p[3],_=p[4];break;case"z":case"Z":y=x,_=v;break}b.forEach(function(G){g.push(G.x),m.push(G.y)}),g.push(y),m.push(_)}var N=c(g)||0,F=c(m)||0,Y=d(g)||0,X=d(m)||0,V=Y-N,te=X-F;return{left:N,top:F,width:V,height:te}}}),a.Path.fromObject=function(g,m){if(typeof g.sourcePath=="string"){var p=g.sourcePath;a.loadSVGFromURL(p,function(x){var v=x[0];v.setOptions(g),g.clipPath?a.util.enlivenObjects([g.clipPath],function(y){v.clipPath=y[0],m&&m(v)}):m&&m(v)})}else a.Object._fromObject("Path",g,m,"path")},a.Path.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat(["d"]),a.Path.fromElement=function(g,m,p){var x=a.parseAttributes(g,a.Path.ATTRIBUTE_NAMES);x.fromSVG=!0,m(new a.Path(x.d,f(x,p)))}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.array.min,d=a.util.array.max;a.Group||(a.Group=a.util.createClass(a.Object,a.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(f,h,u){h=h||{},this._objects=[],u&&this.callSuper("initialize",h),this._objects=f||[];for(var g=this._objects.length;g--;)this._objects[g].group=this;if(u)this._updateObjectsACoords();else{var m=h&&h.centerPoint;h.originX!==void 0&&(this.originX=h.originX),h.originY!==void 0&&(this.originY=h.originY),m||this._calcBounds(),this._updateObjectsCoords(m),delete h.centerPoint,this.callSuper("initialize",h)}this.setCoords()},_updateObjectsACoords:function(){for(var f=!0,h=this._objects.length;h--;)this._objects[h].setCoords(f)},_updateObjectsCoords:function(h){for(var h=h||this.getCenterPoint(),u=this._objects.length;u--;)this._updateObjectCoords(this._objects[u],h)},_updateObjectCoords:function(f,h){var u=f.left,g=f.top,m=!0;f.set({left:u-h.x,top:g-h.y}),f.group=this,f.setCoords(m)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(f){var h=!!this.group;return this._restoreObjectsState(),a.util.resetObjectTransform(this),f&&(h&&a.util.removeTransformFromObject(f,this.group.calcTransformMatrix()),this._objects.push(f),f.group=this,f._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,h?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(f){return this._restoreObjectsState(),a.util.resetObjectTransform(this),this.remove(f),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(f){this.dirty=!0,f.group=this,f._set("canvas",this.canvas)},_onObjectRemoved:function(f){this.dirty=!0,delete f.group},_set:function(f,h){var u=this._objects.length;if(this.useSetOnGroup)for(;u--;)this._objects[u].setOnGroup(f,h);if(f==="canvas")for(;u--;)this._objects[u]._set(f,h);a.Object.prototype._set.call(this,f,h)},toObject:function(f){var h=this.includeDefaultValues,u=this._objects.filter(function(m){return!m.excludeFromExport}).map(function(m){var p=m.includeDefaultValues;m.includeDefaultValues=h;var x=m.toObject(f);return m.includeDefaultValues=p,x}),g=a.Object.prototype.toObject.call(this,f);return g.objects=u,g},toDatalessObject:function(f){var h,u=this.sourcePath;if(u)h=u;else{var g=this.includeDefaultValues;h=this._objects.map(function(p){var x=p.includeDefaultValues;p.includeDefaultValues=g;var v=p.toDatalessObject(f);return p.includeDefaultValues=x,v})}var m=a.Object.prototype.toDatalessObject.call(this,f);return m.objects=h,m},render:function(f){this._transformDone=!0,this.callSuper("render",f),this._transformDone=!1},shouldCache:function(){var f=a.Object.prototype.shouldCache.call(this);if(f){for(var h=0,u=this._objects.length;h<u;h++)if(this._objects[h].willDrawShadow())return this.ownCaching=!1,!1}return f},willDrawShadow:function(){if(a.Object.prototype.willDrawShadow.call(this))return!0;for(var f=0,h=this._objects.length;f<h;f++)if(this._objects[f].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(f){for(var h=0,u=this._objects.length;h<u;h++)this._objects[h].render(f);this._drawClipPath(f,this.clipPath)},isCacheDirty:function(f){if(this.callSuper("isCacheDirty",f))return!0;if(!this.statefullCache)return!1;for(var h=0,u=this._objects.length;h<u;h++)if(this._objects[h].isCacheDirty(!0)){if(this._cacheCanvas){var g=this.cacheWidth/this.zoomX,m=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-g/2,-m/2,g,m)}return!0}return!1},_restoreObjectsState:function(){var f=this.calcOwnMatrix();return this._objects.forEach(function(h){a.util.addTransformToObject(h,f),delete h.group,h.setCoords()}),this},destroy:function(){return this._objects.forEach(function(f){f.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(f){f.dispose&&f.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var f=this._objects,h=this.canvas;this._objects=[];var u=this.toObject();delete u.objects;var g=new a.ActiveSelection([]);return g.set(u),g.type="activeSelection",h.remove(this),f.forEach(function(m){m.group=g,m.dirty=!0,h.add(m)}),g.canvas=h,g._objects=f,h._activeObject=g,g.setCoords(),g}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var f=!0;return this.forEachObject(function(h){h.setCoords(f)}),this},_calcBounds:function(f){for(var h=[],u=[],g,m,p,x=["tr","br","bl","tl"],v=0,y=this._objects.length,_,b=x.length;v<y;++v){for(g=this._objects[v],p=g.calcACoords(),_=0;_<b;_++)m=x[_],h.push(p[m].x),u.push(p[m].y);g.aCoords=p}this._getBounds(h,u,f)},_getBounds:function(f,h,u){var g=new a.Point(c(f),c(h)),m=new a.Point(d(f),d(h)),p=g.y||0,x=g.x||0,v=m.x-g.x||0,y=m.y-g.y||0;this.width=v,this.height=y,u||this.setPositionByOrigin({x,y:p},"left","top")},_toSVG:function(f){for(var h=["<g ","COMMON_PARTS",` >
`],u=0,g=this._objects.length;u<g;u++)h.push("		",this._objects[u].toSVG(f));return h.push(`</g>
`),h},getSvgStyles:function(){var f=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",h=this.visible?"":" visibility: hidden;";return[f,this.getSvgFilter(),h].join("")},toClipPathSVG:function(f){for(var h=[],u=0,g=this._objects.length;u<g;u++)h.push("	",this._objects[u].toClipPathSVG(f));return this._createBaseClipPathSVGMarkup(h,{reviver:f})}}),a.Group.fromObject=function(f,h){var u=f.objects,g=a.util.object.clone(f,!0);if(delete g.objects,typeof u=="string"){a.loadSVGFromURL(u,function(m){var p=a.util.groupSVGElements(m,f,u),x=g.clipPath;delete g.clipPath,p.set(g),x?a.util.enlivenObjects([x],function(v){p.clipPath=v[0],h&&h(p)}):h&&h(p)});return}a.util.enlivenObjects(u,function(m){a.util.enlivenObjectEnlivables(f,g,function(){h&&h(new a.Group(m,g,!0))})})})}(e),function(o){var a=o.fabric||(o.fabric={});a.ActiveSelection||(a.ActiveSelection=a.util.createClass(a.Group,{type:"activeSelection",initialize:function(c,d){d=d||{},this._objects=c||[];for(var f=this._objects.length;f--;)this._objects[f].group=this;d.originX&&(this.originX=d.originX),d.originY&&(this.originY=d.originY),this._calcBounds(),this._updateObjectsCoords(),a.Object.prototype.initialize.call(this,d),this.setCoords()},toGroup:function(){var c=this._objects.concat();this._objects=[];var d=a.Object.prototype.toObject.call(this),f=new a.Group([]);if(delete d.type,f.set(d),c.forEach(function(u){u.canvas.remove(u),u.group=f}),f._objects=c,!this.canvas)return f;var h=this.canvas;return h.add(f),h._activeObject=f,f.setCoords(),f},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(c,d,f){c.save(),c.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,f=f||{},typeof f.hasControls>"u"&&(f.hasControls=!1),f.forActiveSelection=!0;for(var h=0,u=this._objects.length;h<u;h++)this._objects[h]._renderControls(c,f);this.callSuper("_renderControls",c,d),c.restore()}}),a.ActiveSelection.fromObject=function(c,d){a.util.enlivenObjects(c.objects,function(f){delete c.objects,d&&d(new a.ActiveSelection(f,c,!0))})})}(e),function(o){var a=t.util.object.extend;if(o.fabric||(o.fabric={}),o.fabric.Image){t.warn("fabric.Image is already defined.");return}t.Image=t.util.createClass(t.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:t.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:t.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(c,d){d||(d={}),this.filters=[],this.cacheKey="texture"+t.Object.__uid++,this.callSuper("initialize",d),this._initElement(c,d)},getElement:function(){return this._element||{}},setElement:function(c,d){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=c,this._originalElement=c,this._initConfig(d),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(c){var d=t.filterBackend;d&&d.evictCachesForKey&&d.evictCachesForKey(c)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((function(c){t.util.cleanUpJsdomNode(this[c]),this[c]=void 0}).bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var c=this.getElement();return{width:c.naturalWidth||c.width,height:c.naturalHeight||c.height}},_stroke:function(c){if(!(!this.stroke||this.strokeWidth===0)){var d=this.width/2,f=this.height/2;c.beginPath(),c.moveTo(-d,-f),c.lineTo(d,-f),c.lineTo(d,f),c.lineTo(-d,f),c.lineTo(-d,-f),c.closePath()}},toObject:function(c){var d=[];this.filters.forEach(function(h){h&&d.push(h.toObject())});var f=a(this.callSuper("toObject",["cropX","cropY"].concat(c)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:d});return this.resizeFilter&&(f.resizeFilter=this.resizeFilter.toObject()),f},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var c=[],d=[],f,h=this._element,u=-this.width/2,g=-this.height/2,m="",p="";if(!h)return[];if(this.hasCrop()){var x=t.Object.__uid++;c.push('<clipPath id="imageCrop_'+x+`">
`,'	<rect x="'+u+'" y="'+g+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),m=' clip-path="url(#imageCrop_'+x+')" '}if(this.imageSmoothing||(p='" image-rendering="optimizeSpeed'),d.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',u-this.cropX,'" y="',g-this.cropY,'" width="',h.width||h.naturalWidth,'" height="',h.height||h.height,p,'"',m,`></image>
`),this.stroke||this.strokeDashArray){var v=this.fill;this.fill=null,f=["	<rect ",'x="',u,'" y="',g,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=v}return this.paintFirst!=="fill"?c=c.concat(f,d):c=c.concat(d,f),c},getSrc:function(c){var d=c?this._element:this._originalElement;return d?d.toDataURL?d.toDataURL():this.srcFromAttribute?d.getAttribute("src"):d.src:this.src||""},setSrc:function(c,d,f){return t.util.loadImage(c,function(h,u){this.setElement(h,f),this._setWidthHeight(),d&&d(this,u)},this,f&&f.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var c=this.resizeFilter,d=this.minimumScaleTrigger,f=this.getTotalObjectScaling(),h=f.scaleX,u=f.scaleY,g=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!c||h>d&&u>d){this._element=g,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=h,this._lastScaleY=u;return}t.filterBackend||(t.filterBackend=t.initFilterBackend());var m=t.util.createCanvasElement(),p=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,x=g.width,v=g.height;m.width=x,m.height=v,this._element=m,this._lastScaleX=c.scaleX=h,this._lastScaleY=c.scaleY=u,t.filterBackend.applyFilters([c],g,x,v,this._element,p),this._filterScalingX=m.width/this._originalElement.width,this._filterScalingY=m.height/this._originalElement.height},applyFilters:function(c){if(c=c||this.filters||[],c=c.filter(function(g){return g&&!g.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),c.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var d=this._originalElement,f=d.naturalWidth||d.width,h=d.naturalHeight||d.height;if(this._element===this._originalElement){var u=t.util.createCanvasElement();u.width=f,u.height=h,this._element=u,this._filteredEl=u}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,f,h),this._lastScaleX=1,this._lastScaleY=1;return t.filterBackend||(t.filterBackend=t.initFilterBackend()),t.filterBackend.applyFilters(c,this._originalElement,f,h,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(c){t.util.setImageSmoothing(c,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(c),this._renderPaintInOrder(c)},drawCacheOnCanvas:function(c){t.util.setImageSmoothing(c,this.imageSmoothing),t.Object.prototype.drawCacheOnCanvas.call(this,c)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(c){var d=this._element;if(d){var f=this._filterScalingX,h=this._filterScalingY,u=this.width,g=this.height,m=Math.min,p=Math.max,x=p(this.cropX,0),v=p(this.cropY,0),y=d.naturalWidth||d.width,_=d.naturalHeight||d.height,b=x*f,S=v*h,C=m(u*f,y-b),N=m(g*h,_-S),F=-u/2,Y=-g/2,X=m(u,y/f-x),V=m(g,_/h-v);d&&c.drawImage(d,b,S,C,N,F,Y,X,V)}},_needsResize:function(){var c=this.getTotalObjectScaling();return c.scaleX!==this._lastScaleX||c.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(c,d){this.setElement(t.util.getById(c),d),t.util.addClass(this.getElement(),t.Image.CSS_CANVAS)},_initConfig:function(c){c||(c={}),this.setOptions(c),this._setWidthHeight(c)},_initFilters:function(c,d){c&&c.length?t.util.enlivenObjects(c,function(f){d&&d(f)},"fabric.Image.filters"):d&&d()},_setWidthHeight:function(c){c||(c={});var d=this.getElement();this.width=c.width||d.naturalWidth||d.width||0,this.height=c.height||d.naturalHeight||d.height||0},parsePreserveAspectRatioAttribute:function(){var c=t.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),d=this._element.width,f=this._element.height,h=1,u=1,g=0,m=0,p=0,x=0,v,y=this.width,_=this.height,b={width:y,height:_};return c&&(c.alignX!=="none"||c.alignY!=="none")?(c.meetOrSlice==="meet"&&(h=u=t.util.findScaleToFit(this._element,b),v=(y-d*h)/2,c.alignX==="Min"&&(g=-v),c.alignX==="Max"&&(g=v),v=(_-f*u)/2,c.alignY==="Min"&&(m=-v),c.alignY==="Max"&&(m=v)),c.meetOrSlice==="slice"&&(h=u=t.util.findScaleToCover(this._element,b),v=d-y/h,c.alignX==="Mid"&&(p=v/2),c.alignX==="Max"&&(p=v),v=f-_/u,c.alignY==="Mid"&&(x=v/2),c.alignY==="Max"&&(x=v),d=y/h,f=_/u)):(h=y/d,u=_/f),{width:d,height:f,scaleX:h,scaleY:u,offsetLeft:g,offsetTop:m,cropX:p,cropY:x}}}),t.Image.CSS_CANVAS="canvas-img",t.Image.prototype.getSvgSrc=t.Image.prototype.getSrc,t.Image.fromObject=function(c,d){var f=t.util.object.clone(c);t.util.loadImage(f.src,function(h,u){if(u){d&&d(null,!0);return}t.Image.prototype._initFilters.call(f,f.filters,function(g){f.filters=g||[],t.Image.prototype._initFilters.call(f,[f.resizeFilter],function(m){f.resizeFilter=m[0],t.util.enlivenObjectEnlivables(f,f,function(){var p=new t.Image(h,f);d(p,!1)})})})},null,f.crossOrigin)},t.Image.fromURL=function(c,d,f){t.util.loadImage(c,function(h,u){d&&d(new t.Image(h,f),u)},null,f&&f.crossOrigin)},t.Image.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),t.Image.fromElement=function(c,d,f){var h=t.parseAttributes(c,t.Image.ATTRIBUTE_NAMES);t.Image.fromURL(h["xlink:href"],d,a(f?t.util.object.clone(f):{},h))}}(e),t.util.object.extend(t.Object.prototype,{_getAngleValueForStraighten:function(){var o=this.angle%360;return o>0?Math.round((o-1)/90)*90:Math.round(o/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(o){o=o||{};var a=function(){},c=o.onComplete||a,d=o.onChange||a,f=this;return t.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(h){f.rotate(h),d()},onComplete:function(){f.setCoords(),c()}})}}),t.util.object.extend(t.StaticCanvas.prototype,{straightenObject:function(o){return o.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(o){return o.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function o(c,d){var f="precision "+d+` float;
void main(){}`,h=c.createShader(c.FRAGMENT_SHADER);return c.shaderSource(h,f),c.compileShader(h),!!c.getShaderParameter(h,c.COMPILE_STATUS)}t.isWebglSupported=function(c){if(t.isLikelyNode)return!1;c=c||t.WebglFilterBackend.prototype.tileSize;var d=document.createElement("canvas"),f=d.getContext("webgl")||d.getContext("experimental-webgl"),h=!1;if(f){t.maxTextureSize=f.getParameter(f.MAX_TEXTURE_SIZE),h=t.maxTextureSize>=c;for(var u=["highp","mediump","lowp"],g=0;g<3;g++)if(o(f,u[g])){t.webGlPrecision=u[g];break}}return this.isSupported=h,h},t.WebglFilterBackend=a;function a(c){c&&c.tileSize&&(this.tileSize=c.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}a.prototype={tileSize:2048,resources:{},setupGLContext:function(c,d){this.dispose(),this.createWebGLCanvas(c,d),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(c,d)},chooseFastestCopyGLTo2DMethod:function(c,d){var f=typeof window.performance<"u",h;try{new ImageData(1,1),h=!0}catch{h=!1}var u=typeof ArrayBuffer<"u",g=typeof Uint8ClampedArray<"u";if(f&&h&&u&&g){var m=t.util.createCanvasElement(),p=new ArrayBuffer(c*d*4);if(t.forceGLPutImageData){this.imageBuffer=p,this.copyGLTo2D=l;return}var x={imageBuffer:p,destinationWidth:c,destinationHeight:d,targetCanvas:m},v,y,_;m.width=c,m.height=d,v=window.performance.now(),s.call(x,this.gl,x),y=window.performance.now()-v,v=window.performance.now(),l.call(x,this.gl,x),_=window.performance.now()-v,y>_?(this.imageBuffer=p,this.copyGLTo2D=l):this.copyGLTo2D=s}},createWebGLCanvas:function(c,d){var f=t.util.createCanvasElement();f.width=c,f.height=d;var h={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},u=f.getContext("webgl",h);u||(u=f.getContext("experimental-webgl",h)),u&&(u.clearColor(0,0,0,0),this.canvas=f,this.gl=u)},applyFilters:function(c,d,f,h,u,g){var m=this.gl,p;g&&(p=this.getCachedTexture(g,d));var x={originalWidth:d.width||d.originalWidth,originalHeight:d.height||d.originalHeight,sourceWidth:f,sourceHeight:h,destinationWidth:f,destinationHeight:h,context:m,sourceTexture:this.createTexture(m,f,h,!p&&d),targetTexture:this.createTexture(m,f,h),originalTexture:p||this.createTexture(m,f,h,!p&&d),passes:c.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:u},v=m.createFramebuffer();return m.bindFramebuffer(m.FRAMEBUFFER,v),c.forEach(function(y){y&&y.applyTo(x)}),i(x),this.copyGLTo2D(m,x),m.bindTexture(m.TEXTURE_2D,null),m.deleteTexture(x.sourceTexture),m.deleteTexture(x.targetTexture),m.deleteFramebuffer(v),u.getContext("2d").setTransform(1,0,0,1,0,0),x},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(c,d,f,h,u){var g=c.createTexture();return c.bindTexture(c.TEXTURE_2D,g),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,u||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,u||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),h?c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,h):c.texImage2D(c.TEXTURE_2D,0,c.RGBA,d,f,0,c.RGBA,c.UNSIGNED_BYTE,null),g},getCachedTexture:function(c,d){if(this.textureCache[c])return this.textureCache[c];var f=this.createTexture(this.gl,d.width,d.height,d);return this.textureCache[c]=f,f},evictCachesForKey:function(c){this.textureCache[c]&&(this.gl.deleteTexture(this.textureCache[c]),delete this.textureCache[c])},copyGLTo2D:s,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var c=this.gl,d={renderer:"",vendor:""};if(!c)return d;var f=c.getExtension("WEBGL_debug_renderer_info");if(f){var h=c.getParameter(f.UNMASKED_RENDERER_WEBGL),u=c.getParameter(f.UNMASKED_VENDOR_WEBGL);h&&(d.renderer=h.toLowerCase()),u&&(d.vendor=u.toLowerCase())}return this.gpuInfo=d,d}}}();function i(o){var a=o.targetCanvas,c=a.width,d=a.height,f=o.destinationWidth,h=o.destinationHeight;(c!==f||d!==h)&&(a.width=f,a.height=h)}function s(o,a){var c=o.canvas,d=a.targetCanvas,f=d.getContext("2d");f.translate(0,d.height),f.scale(1,-1);var h=c.height-d.height;f.drawImage(c,0,h,d.width,d.height,0,0,d.width,d.height)}function l(o,a){var c=a.targetCanvas,d=c.getContext("2d"),f=a.destinationWidth,h=a.destinationHeight,u=f*h*4,g=new Uint8Array(this.imageBuffer,0,u),m=new Uint8ClampedArray(this.imageBuffer,0,u);o.readPixels(0,0,f,h,o.RGBA,o.UNSIGNED_BYTE,g);var p=new ImageData(m,f,h);d.putImageData(p,0,0)}(function(){var o=function(){};t.Canvas2dFilterBackend=a;function a(){}a.prototype={evictCachesForKey:o,dispose:o,clearWebGLCaches:o,resources:{},applyFilters:function(c,d,f,h,u){var g=u.getContext("2d");g.drawImage(d,0,0,f,h);var m=g.getImageData(0,0,f,h),p=g.getImageData(0,0,f,h),x={sourceWidth:f,sourceHeight:h,imageData:m,originalEl:d,originalImageData:p,canvasEl:u,ctx:g,filterBackend:this};return c.forEach(function(v){v.applyTo(x)}),(x.imageData.width!==f||x.imageData.height!==h)&&(u.width=x.imageData.width,u.height=x.imageData.height),g.putImageData(x.imageData,0,0),x}}})(),t.Image=t.Image||{},t.Image.filters=t.Image.filters||{},t.Image.filters.BaseFilter=t.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(o){o&&this.setOptions(o)},setOptions:function(o){for(var a in o)this[a]=o[a]},createProgram:function(o,a,c){a=a||this.fragmentSource,c=c||this.vertexSource,t.webGlPrecision!=="highp"&&(a=a.replace(/precision highp float/g,"precision "+t.webGlPrecision+" float"));var d=o.createShader(o.VERTEX_SHADER);if(o.shaderSource(d,c),o.compileShader(d),!o.getShaderParameter(d,o.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+o.getShaderInfoLog(d));var f=o.createShader(o.FRAGMENT_SHADER);if(o.shaderSource(f,a),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+o.getShaderInfoLog(f));var h=o.createProgram();if(o.attachShader(h,d),o.attachShader(h,f),o.linkProgram(h),!o.getProgramParameter(h,o.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+o.getProgramInfoLog(h));var u=this.getAttributeLocations(o,h),g=this.getUniformLocations(o,h)||{};return g.uStepW=o.getUniformLocation(h,"uStepW"),g.uStepH=o.getUniformLocation(h,"uStepH"),{program:h,attributeLocations:u,uniformLocations:g}},getAttributeLocations:function(o,a){return{aPosition:o.getAttribLocation(a,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(o,a,c){var d=a.aPosition,f=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,f),o.enableVertexAttribArray(d),o.vertexAttribPointer(d,2,o.FLOAT,!1,0,0),o.bufferData(o.ARRAY_BUFFER,c,o.STATIC_DRAW)},_setupFrameBuffer:function(o){var a=o.context,c,d;o.passes>1?(c=o.destinationWidth,d=o.destinationHeight,(o.sourceWidth!==c||o.sourceHeight!==d)&&(a.deleteTexture(o.targetTexture),o.targetTexture=o.filterBackend.createTexture(a,c,d)),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,o.targetTexture,0)):(a.bindFramebuffer(a.FRAMEBUFFER,null),a.finish())},_swapTextures:function(o){o.passes--,o.pass++;var a=o.targetTexture;o.targetTexture=o.sourceTexture,o.sourceTexture=a},isNeutralState:function(){var o=this.mainParameter,a=t.Image.filters[this.type].prototype;if(o)if(Array.isArray(a[o])){for(var c=a[o].length;c--;)if(this[o][c]!==a[o][c])return!1;return!0}else return a[o]===this[o];else return!1},applyTo:function(o){o.webgl?(this._setupFrameBuffer(o),this.applyToWebGL(o),this._swapTextures(o)):this.applyTo2d(o)},retrieveShader:function(o){return o.programCache.hasOwnProperty(this.type)||(o.programCache[this.type]=this.createProgram(o.context)),o.programCache[this.type]},applyToWebGL:function(o){var a=o.context,c=this.retrieveShader(o);o.pass===0&&o.originalTexture?a.bindTexture(a.TEXTURE_2D,o.originalTexture):a.bindTexture(a.TEXTURE_2D,o.sourceTexture),a.useProgram(c.program),this.sendAttributeData(a,c.attributeLocations,o.aPosition),a.uniform1f(c.uniformLocations.uStepW,1/o.sourceWidth),a.uniform1f(c.uniformLocations.uStepH,1/o.sourceHeight),this.sendUniformData(a,c.uniformLocations),a.viewport(0,0,o.destinationWidth,o.destinationHeight),a.drawArrays(a.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(o,a,c){o.activeTexture(c),o.bindTexture(o.TEXTURE_2D,a),o.activeTexture(o.TEXTURE0)},unbindAdditionalTexture:function(o,a){o.activeTexture(a),o.bindTexture(o.TEXTURE_2D,null),o.activeTexture(o.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(o){this[this.mainParameter]=o},sendUniformData:function(){},createHelpLayer:function(o){if(!o.helpLayer){var a=document.createElement("canvas");a.width=o.sourceWidth,a.height=o.sourceHeight,o.helpLayer=a}},toObject:function(){var o={type:this.type},a=this.mainParameter;return a&&(o[a]=this[a]),o},toJSON:function(){return this.toObject()}}),t.Image.filters.BaseFilter.fromObject=function(o,a){var c=new t.Image.filters[o.type](o);return a&&a(c),c},function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.ColorMatrix=d(c.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(f){this.callSuper("initialize",f),this.matrix=this.matrix.slice(0)},applyTo2d:function(f){var h=f.imageData,u=h.data,g=u.length,m=this.matrix,p,x,v,y,_,b=this.colorsOnly;for(_=0;_<g;_+=4)p=u[_],x=u[_+1],v=u[_+2],b?(u[_]=p*m[0]+x*m[1]+v*m[2]+m[4]*255,u[_+1]=p*m[5]+x*m[6]+v*m[7]+m[9]*255,u[_+2]=p*m[10]+x*m[11]+v*m[12]+m[14]*255):(y=u[_+3],u[_]=p*m[0]+x*m[1]+v*m[2]+y*m[3]+m[4]*255,u[_+1]=p*m[5]+x*m[6]+v*m[7]+y*m[8]+m[9]*255,u[_+2]=p*m[10]+x*m[11]+v*m[12]+y*m[13]+m[14]*255,u[_+3]=p*m[15]+x*m[16]+v*m[17]+y*m[18]+m[19]*255)},getUniformLocations:function(f,h){return{uColorMatrix:f.getUniformLocation(h,"uColorMatrix"),uConstants:f.getUniformLocation(h,"uConstants")}},sendUniformData:function(f,h){var u=this.matrix,g=[u[0],u[1],u[2],u[3],u[5],u[6],u[7],u[8],u[10],u[11],u[12],u[13],u[15],u[16],u[17],u[18]],m=[u[4],u[9],u[14],u[19]];f.uniformMatrix4fv(h.uColorMatrix,!1,g),f.uniform4fv(h.uConstants,m)}}),a.Image.filters.ColorMatrix.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Brightness=d(c.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(f){if(this.brightness!==0){var h=f.imageData,u=h.data,g,m=u.length,p=Math.round(this.brightness*255);for(g=0;g<m;g+=4)u[g]=u[g]+p,u[g+1]=u[g+1]+p,u[g+2]=u[g+2]+p}},getUniformLocations:function(f,h){return{uBrightness:f.getUniformLocation(h,"uBrightness")}},sendUniformData:function(f,h){f.uniform1f(h.uBrightness,this.brightness)}}),a.Image.filters.Brightness.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.Image.filters,f=a.util.createClass;d.Convolute=f(d.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(h){var u=Math.sqrt(this.matrix.length),g=this.type+"_"+u+"_"+(this.opaque?1:0),m=this.fragmentSource[g];return h.programCache.hasOwnProperty(g)||(h.programCache[g]=this.createProgram(h.context,m)),h.programCache[g]},applyTo2d:function(h){var u=h.imageData,g=u.data,m=this.matrix,p=Math.round(Math.sqrt(m.length)),x=Math.floor(p/2),v=u.width,y=u.height,_=h.ctx.createImageData(v,y),b=_.data,S=this.opaque?1:0,C,N,F,Y,X,V,te,G,re,Z,oe,ee,E;for(oe=0;oe<y;oe++)for(Z=0;Z<v;Z++){for(X=(oe*v+Z)*4,C=0,N=0,F=0,Y=0,E=0;E<p;E++)for(ee=0;ee<p;ee++)te=oe+E-x,V=Z+ee-x,!(te<0||te>=y||V<0||V>=v)&&(G=(te*v+V)*4,re=m[E*p+ee],C+=g[G]*re,N+=g[G+1]*re,F+=g[G+2]*re,S||(Y+=g[G+3]*re));b[X]=C,b[X+1]=N,b[X+2]=F,S?b[X+3]=g[X+3]:b[X+3]=Y}h.imageData=_},getUniformLocations:function(h,u){return{uMatrix:h.getUniformLocation(u,"uMatrix"),uOpaque:h.getUniformLocation(u,"uOpaque"),uHalfSize:h.getUniformLocation(u,"uHalfSize"),uSize:h.getUniformLocation(u,"uSize")}},sendUniformData:function(h,u){h.uniform1fv(u.uMatrix,this.matrix)},toObject:function(){return c(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),a.Image.filters.Convolute.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Grayscale=d(c.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(f){var h=f.imageData,u=h.data,g,m=u.length,p,x=this.mode;for(g=0;g<m;g+=4)x==="average"?p=(u[g]+u[g+1]+u[g+2])/3:x==="lightness"?p=(Math.min(u[g],u[g+1],u[g+2])+Math.max(u[g],u[g+1],u[g+2]))/2:x==="luminosity"&&(p=.21*u[g]+.72*u[g+1]+.07*u[g+2]),u[g]=p,u[g+1]=p,u[g+2]=p},retrieveShader:function(f){var h=this.type+"_"+this.mode;if(!f.programCache.hasOwnProperty(h)){var u=this.fragmentSource[this.mode];f.programCache[h]=this.createProgram(f.context,u)}return f.programCache[h]},getUniformLocations:function(f,h){return{uMode:f.getUniformLocation(h,"uMode")}},sendUniformData:function(f,h){var u=1;f.uniform1i(h.uMode,u)},isNeutralState:function(){return!1}}),a.Image.filters.Grayscale.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Invert=d(c.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(f){var h=f.imageData,u=h.data,g,m=u.length;for(g=0;g<m;g+=4)u[g]=255-u[g],u[g+1]=255-u[g+1],u[g+2]=255-u[g+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(f,h){return{uInvert:f.getUniformLocation(h,"uInvert")}},sendUniformData:function(f,h){f.uniform1i(h.uInvert,this.invert)}}),a.Image.filters.Invert.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.Image.filters,f=a.util.createClass;d.Noise=f(d.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(h){if(this.noise!==0){var u=h.imageData,g=u.data,m,p=g.length,x=this.noise,v;for(m=0,p=g.length;m<p;m+=4)v=(.5-Math.random())*x,g[m]+=v,g[m+1]+=v,g[m+2]+=v}},getUniformLocations:function(h,u){return{uNoise:h.getUniformLocation(u,"uNoise"),uSeed:h.getUniformLocation(u,"uSeed")}},sendUniformData:function(h,u){h.uniform1f(u.uNoise,this.noise/255),h.uniform1f(u.uSeed,Math.random())},toObject:function(){return c(this.callSuper("toObject"),{noise:this.noise})}}),a.Image.filters.Noise.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Pixelate=d(c.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(f){var h=f.imageData,u=h.data,g=h.height,m=h.width,p,x,v,y,_,b,S,C,N,F,Y;for(x=0;x<g;x+=this.blocksize)for(v=0;v<m;v+=this.blocksize)for(p=x*4*m+v*4,y=u[p],_=u[p+1],b=u[p+2],S=u[p+3],F=Math.min(x+this.blocksize,g),Y=Math.min(v+this.blocksize,m),C=x;C<F;C++)for(N=v;N<Y;N++)p=C*4*m+N*4,u[p]=y,u[p+1]=_,u[p+2]=b,u[p+3]=S},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(f,h){return{uBlocksize:f.getUniformLocation(h,"uBlocksize"),uStepW:f.getUniformLocation(h,"uStepW"),uStepH:f.getUniformLocation(h,"uStepH")}},sendUniformData:function(f,h){f.uniform1f(h.uBlocksize,this.blocksize)}}),a.Image.filters.Pixelate.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,d=a.Image.filters,f=a.util.createClass;d.RemoveColor=f(d.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(h){var u=h.imageData,g=u.data,m,p=this.distance*255,x,v,y,_=new a.Color(this.color).getSource(),b=[_[0]-p,_[1]-p,_[2]-p],S=[_[0]+p,_[1]+p,_[2]+p];for(m=0;m<g.length;m+=4)x=g[m],v=g[m+1],y=g[m+2],x>b[0]&&v>b[1]&&y>b[2]&&x<S[0]&&v<S[1]&&y<S[2]&&(g[m+3]=0)},getUniformLocations:function(h,u){return{uLow:h.getUniformLocation(u,"uLow"),uHigh:h.getUniformLocation(u,"uHigh")}},sendUniformData:function(h,u){var g=new a.Color(this.color).getSource(),m=parseFloat(this.distance),p=[0+g[0]/255-m,0+g[1]/255-m,0+g[2]/255-m,1],x=[g[0]/255+m,g[1]/255+m,g[2]/255+m,1];h.uniform4fv(u.uLow,p),h.uniform4fv(u.uHigh,x)},toObject:function(){return c(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),a.Image.filters.RemoveColor.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass,f={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var h in f)c[h]=d(c.ColorMatrix,{type:h,matrix:f[h],mainParameter:!1,colorsOnly:!0}),a.Image.filters[h].fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric,c=a.Image.filters,d=a.util.createClass;c.BlendColor=d(c.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(f){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[f]+`}
}`},retrieveShader:function(f){var h=this.type+"_"+this.mode,u;return f.programCache.hasOwnProperty(h)||(u=this.buildSource(this.mode),f.programCache[h]=this.createProgram(f.context,u)),f.programCache[h]},applyTo2d:function(f){var h=f.imageData,u=h.data,g=u.length,m,p,x,v,y,_,b,S=1-this.alpha;b=new a.Color(this.color).getSource(),m=b[0]*this.alpha,p=b[1]*this.alpha,x=b[2]*this.alpha;for(var C=0;C<g;C+=4)switch(v=u[C],y=u[C+1],_=u[C+2],this.mode){case"multiply":u[C]=v*m/255,u[C+1]=y*p/255,u[C+2]=_*x/255;break;case"screen":u[C]=255-(255-v)*(255-m)/255,u[C+1]=255-(255-y)*(255-p)/255,u[C+2]=255-(255-_)*(255-x)/255;break;case"add":u[C]=v+m,u[C+1]=y+p,u[C+2]=_+x;break;case"diff":case"difference":u[C]=Math.abs(v-m),u[C+1]=Math.abs(y-p),u[C+2]=Math.abs(_-x);break;case"subtract":u[C]=v-m,u[C+1]=y-p,u[C+2]=_-x;break;case"darken":u[C]=Math.min(v,m),u[C+1]=Math.min(y,p),u[C+2]=Math.min(_,x);break;case"lighten":u[C]=Math.max(v,m),u[C+1]=Math.max(y,p),u[C+2]=Math.max(_,x);break;case"overlay":u[C]=m<128?2*v*m/255:255-2*(255-v)*(255-m)/255,u[C+1]=p<128?2*y*p/255:255-2*(255-y)*(255-p)/255,u[C+2]=x<128?2*_*x/255:255-2*(255-_)*(255-x)/255;break;case"exclusion":u[C]=m+v-2*m*v/255,u[C+1]=p+y-2*p*y/255,u[C+2]=x+_-2*x*_/255;break;case"tint":u[C]=m+v*S,u[C+1]=p+y*S,u[C+2]=x+_*S}},getUniformLocations:function(f,h){return{uColor:f.getUniformLocation(h,"uColor")}},sendUniformData:function(f,h){var u=new a.Color(this.color).getSource();u[0]=this.alpha*u[0]/255,u[1]=this.alpha*u[1]/255,u[2]=this.alpha*u[2]/255,u[3]=this.alpha,f.uniform4fv(h.uColor,u)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),a.Image.filters.BlendColor.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric,c=a.Image.filters,d=a.util.createClass;c.BlendImage=d(c.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(f){var h=this.type+"_"+this.mode,u=this.fragmentSource[this.mode];return f.programCache.hasOwnProperty(h)||(f.programCache[h]=this.createProgram(f.context,u)),f.programCache[h]},applyToWebGL:function(f){var h=f.context,u=this.createTexture(f.filterBackend,this.image);this.bindAdditionalTexture(h,u,h.TEXTURE1),this.callSuper("applyToWebGL",f),this.unbindAdditionalTexture(h,h.TEXTURE1)},createTexture:function(f,h){return f.getCachedTexture(h.cacheKey,h._element)},calculateMatrix:function(){var f=this.image,h=f._element.width,u=f._element.height;return[1/f.scaleX,0,0,0,1/f.scaleY,0,-f.left/h,-f.top/u,1]},applyTo2d:function(f){var h=f.imageData,u=f.filterBackend.resources,g=h.data,m=g.length,p=h.width,x=h.height,v,y,_,b,S,C,N,F,Y,X,V=this.image,te;u.blendImage||(u.blendImage=a.util.createCanvasElement()),Y=u.blendImage,X=Y.getContext("2d"),Y.width!==p||Y.height!==x?(Y.width=p,Y.height=x):X.clearRect(0,0,p,x),X.setTransform(V.scaleX,0,0,V.scaleY,V.left,V.top),X.drawImage(V._element,0,0,p,x),te=X.getImageData(0,0,p,x).data;for(var G=0;G<m;G+=4)switch(S=g[G],C=g[G+1],N=g[G+2],F=g[G+3],v=te[G],y=te[G+1],_=te[G+2],b=te[G+3],this.mode){case"multiply":g[G]=S*v/255,g[G+1]=C*y/255,g[G+2]=N*_/255,g[G+3]=F*b/255;break;case"mask":g[G+3]=b;break}},getUniformLocations:function(f,h){return{uTransformMatrix:f.getUniformLocation(h,"uTransformMatrix"),uImage:f.getUniformLocation(h,"uImage")}},sendUniformData:function(f,h){var u=this.calculateMatrix();f.uniform1i(h.uImage,1),f.uniformMatrix3fv(h.uTransformMatrix,!1,u)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),a.Image.filters.BlendImage.fromObject=function(f,h){a.Image.fromObject(f.image,function(u){var g=a.util.object.clone(f);g.image=u,h(new a.Image.filters.BlendImage(g))})}}(e),function(o){var a=o.fabric||(o.fabric={}),c=Math.pow,d=Math.floor,f=Math.sqrt,h=Math.abs,u=Math.round,g=Math.sin,m=Math.ceil,p=a.Image.filters,x=a.util.createClass;p.Resize=x(p.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(v,y){return{uDelta:v.getUniformLocation(y,"uDelta"),uTaps:v.getUniformLocation(y,"uTaps")}},sendUniformData:function(v,y){v.uniform2fv(y.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),v.uniform1fv(y.uTaps,this.taps)},retrieveShader:function(v){var y=this.getFilterWindow(),_=this.type+"_"+y;if(!v.programCache.hasOwnProperty(_)){var b=this.generateShader(y);v.programCache[_]=this.createProgram(v.context,b)}return v.programCache[_]},getFilterWindow:function(){var v=this.tempScale;return Math.ceil(this.lanczosLobes/v)},getTaps:function(){for(var v=this.lanczosCreate(this.lanczosLobes),y=this.tempScale,_=this.getFilterWindow(),b=new Array(_),S=1;S<=_;S++)b[S-1]=v(S*y);return b},generateShader:function(b){for(var y=new Array(b),_=this.fragmentSourceTOP,b,S=1;S<=b;S++)y[S-1]=S+".0 * uDelta";return _+="uniform float uTaps["+b+`];
`,_+=`void main() {
`,_+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,_+=`  float sum = 1.0;
`,y.forEach(function(C,N){_+="  color += texture2D(uTexture, vTexCoord + "+C+") * uTaps["+N+`];
`,_+="  color += texture2D(uTexture, vTexCoord - "+C+") * uTaps["+N+`];
`,_+="  sum += 2.0 * uTaps["+N+`];
`}),_+=`  gl_FragColor = color / sum;
`,_+="}",_},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(v){v.webgl?(v.passes++,this.width=v.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=v.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),v.destinationWidth=this.dW,this._setupFrameBuffer(v),this.applyToWebGL(v),this._swapTextures(v),v.sourceWidth=v.destinationWidth,this.height=v.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),v.destinationHeight=this.dH,this._setupFrameBuffer(v),this.applyToWebGL(v),this._swapTextures(v),v.sourceHeight=v.destinationHeight):this.applyTo2d(v)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(v){return function(y){if(y>=v||y<=-v)return 0;if(y<11920929e-14&&y>-11920929e-14)return 1;y*=Math.PI;var _=y/v;return g(y)/y*g(_)/_}},applyTo2d:function(v){var y=v.imageData,_=this.scaleX,b=this.scaleY;this.rcpScaleX=1/_,this.rcpScaleY=1/b;var S=y.width,C=y.height,N=u(S*_),F=u(C*b),Y;this.resizeType==="sliceHack"?Y=this.sliceByTwo(v,S,C,N,F):this.resizeType==="hermite"?Y=this.hermiteFastResize(v,S,C,N,F):this.resizeType==="bilinear"?Y=this.bilinearFiltering(v,S,C,N,F):this.resizeType==="lanczos"&&(Y=this.lanczosResize(v,S,C,N,F)),v.imageData=Y},sliceByTwo:function(v,y,_,b,S){var C=v.imageData,N=.5,F=!1,Y=!1,X=y*N,V=_*N,te=a.filterBackend.resources,G,re,Z=0,oe=0,ee=y,E=0;for(te.sliceByTwo||(te.sliceByTwo=document.createElement("canvas")),G=te.sliceByTwo,(G.width<y*1.5||G.height<_)&&(G.width=y*1.5,G.height=_),re=G.getContext("2d"),re.clearRect(0,0,y*1.5,_),re.putImageData(C,0,0),b=d(b),S=d(S);!F||!Y;)y=X,_=V,b<d(X*N)?X=d(X*N):(X=b,F=!0),S<d(V*N)?V=d(V*N):(V=S,Y=!0),re.drawImage(G,Z,oe,y,_,ee,E,X,V),Z=ee,oe=E,E+=V;return re.getImageData(Z,oe,b,S)},lanczosResize:function(v,y,_,b,S){function C(U){var k,P,A,T,j,R,z,I,L,K,O;for(E.x=(U+.5)*V,D.x=d(E.x),k=0;k<S;k++){for(E.y=(k+.5)*te,D.y=d(E.y),j=0,R=0,z=0,I=0,L=0,P=D.x-Z;P<=D.x+Z;P++)if(!(P<0||P>=y)){K=d(1e3*h(P-E.x)),ee[K]||(ee[K]={});for(var B=D.y-oe;B<=D.y+oe;B++)B<0||B>=_||(O=d(1e3*h(B-E.y)),ee[K][O]||(ee[K][O]=X(f(c(K*G,2)+c(O*re,2))/1e3)),A=ee[K][O],A>0&&(T=(B*y+P)*4,j+=A,R+=A*N[T],z+=A*N[T+1],I+=A*N[T+2],L+=A*N[T+3]))}T=(k*b+U)*4,Y[T]=R/j,Y[T+1]=z/j,Y[T+2]=I/j,Y[T+3]=L/j}return++U<b?C(U):F}var N=v.imageData.data,F=v.ctx.createImageData(b,S),Y=F.data,X=this.lanczosCreate(this.lanczosLobes),V=this.rcpScaleX,te=this.rcpScaleY,G=2/this.rcpScaleX,re=2/this.rcpScaleY,Z=m(V*this.lanczosLobes/2),oe=m(te*this.lanczosLobes/2),ee={},E={},D={};return C(0)},bilinearFiltering:function(v,y,_,b,S){var C,N,F,Y,X,V,te,G,re,Z,oe,ee,E=0,D,U=this.rcpScaleX,k=this.rcpScaleY,P=4*(y-1),A=v.imageData,T=A.data,j=v.ctx.createImageData(b,S),R=j.data;for(te=0;te<S;te++)for(G=0;G<b;G++)for(X=d(U*G),V=d(k*te),re=U*G-X,Z=k*te-V,D=4*(V*y+X),oe=0;oe<4;oe++)C=T[D+oe],N=T[D+4+oe],F=T[D+P+oe],Y=T[D+P+4+oe],ee=C*(1-re)*(1-Z)+N*re*(1-Z)+F*Z*(1-re)+Y*re*Z,R[E++]=ee;return j},hermiteFastResize:function(v,y,_,b,S){for(var C=this.rcpScaleX,N=this.rcpScaleY,F=m(C/2),Y=m(N/2),X=v.imageData,V=X.data,te=v.ctx.createImageData(b,S),G=te.data,re=0;re<S;re++)for(var Z=0;Z<b;Z++){for(var oe=(Z+re*b)*4,ee=0,E=0,D=0,U=0,k=0,P=0,A=0,T=(re+.5)*N,j=d(re*N);j<(re+1)*N;j++)for(var R=h(T-(j+.5))/Y,z=(Z+.5)*C,I=R*R,L=d(Z*C);L<(Z+1)*C;L++){var K=h(z-(L+.5))/F,O=f(I+K*K);O>1&&O<-1||(ee=2*O*O*O-3*O*O+1,ee>0&&(K=4*(L+j*y),A+=ee*V[K+3],D+=ee,V[K+3]<255&&(ee=ee*V[K+3]/250),U+=ee*V[K],k+=ee*V[K+1],P+=ee*V[K+2],E+=ee))}G[oe]=U/E,G[oe+1]=k/E,G[oe+2]=P/E,G[oe+3]=A/D}return te},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),a.Image.filters.Resize.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Contrast=d(c.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(f){if(this.contrast!==0){var h=f.imageData,u,m,g=h.data,m=g.length,p=Math.floor(this.contrast*255),x=259*(p+255)/(255*(259-p));for(u=0;u<m;u+=4)g[u]=x*(g[u]-128)+128,g[u+1]=x*(g[u+1]-128)+128,g[u+2]=x*(g[u+2]-128)+128}},getUniformLocations:function(f,h){return{uContrast:f.getUniformLocation(h,"uContrast")}},sendUniformData:function(f,h){f.uniform1f(h.uContrast,this.contrast)}}),a.Image.filters.Contrast.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Saturation=d(c.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(f){if(this.saturation!==0){var h=f.imageData,u=h.data,g=u.length,m=-this.saturation,p,x;for(p=0;p<g;p+=4)x=Math.max(u[p],u[p+1],u[p+2]),u[p]+=x!==u[p]?(x-u[p])*m:0,u[p+1]+=x!==u[p+1]?(x-u[p+1])*m:0,u[p+2]+=x!==u[p+2]?(x-u[p+2])*m:0}},getUniformLocations:function(f,h){return{uSaturation:f.getUniformLocation(h,"uSaturation")}},sendUniformData:function(f,h){f.uniform1f(h.uSaturation,-this.saturation)}}),a.Image.filters.Saturation.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Vibrance=d(c.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(f){if(this.vibrance!==0){var h=f.imageData,u=h.data,g=u.length,m=-this.vibrance,p,x,v,y;for(p=0;p<g;p+=4)x=Math.max(u[p],u[p+1],u[p+2]),v=(u[p]+u[p+1]+u[p+2])/3,y=Math.abs(x-v)*2/255*m,u[p]+=x!==u[p]?(x-u[p])*y:0,u[p+1]+=x!==u[p+1]?(x-u[p+1])*y:0,u[p+2]+=x!==u[p+2]?(x-u[p+2])*y:0}},getUniformLocations:function(f,h){return{uVibrance:f.getUniformLocation(h,"uVibrance")}},sendUniformData:function(f,h){f.uniform1f(h.uVibrance,-this.vibrance)}}),a.Image.filters.Vibrance.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Blur=d(c.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(f){f.webgl?(this.aspectRatio=f.sourceWidth/f.sourceHeight,f.passes++,this._setupFrameBuffer(f),this.horizontal=!0,this.applyToWebGL(f),this._swapTextures(f),this._setupFrameBuffer(f),this.horizontal=!1,this.applyToWebGL(f),this._swapTextures(f)):this.applyTo2d(f)},applyTo2d:function(f){f.imageData=this.simpleBlur(f)},simpleBlur:function(f){var h=f.filterBackend.resources,u,g,m=f.imageData.width,p=f.imageData.height;h.blurLayer1||(h.blurLayer1=a.util.createCanvasElement(),h.blurLayer2=a.util.createCanvasElement()),u=h.blurLayer1,g=h.blurLayer2,(u.width!==m||u.height!==p)&&(g.width=u.width=m,g.height=u.height=p);var x=u.getContext("2d"),v=g.getContext("2d"),y=15,_,b,S,C,N=this.blur*.06*.5;for(x.putImageData(f.imageData,0,0),v.clearRect(0,0,m,p),C=-y;C<=y;C++)_=(Math.random()-.5)/4,b=C/y,S=N*b*m+_,v.globalAlpha=1-Math.abs(b),v.drawImage(u,S,_),x.drawImage(g,0,0),v.globalAlpha=1,v.clearRect(0,0,g.width,g.height);for(C=-y;C<=y;C++)_=(Math.random()-.5)/4,b=C/y,S=N*b*p+_,v.globalAlpha=1-Math.abs(b),v.drawImage(u,_,S),x.drawImage(g,0,0),v.globalAlpha=1,v.clearRect(0,0,g.width,g.height);f.ctx.drawImage(u,0,0);var F=f.ctx.getImageData(0,0,u.width,u.height);return x.globalAlpha=1,x.clearRect(0,0,u.width,u.height),F},getUniformLocations:function(f,h){return{delta:f.getUniformLocation(h,"uDelta")}},sendUniformData:function(f,h){var u=this.chooseRightDelta();f.uniform2fv(h.delta,u)},chooseRightDelta:function(){var f=1,h=[0,0],u;return this.horizontal?this.aspectRatio>1&&(f=1/this.aspectRatio):this.aspectRatio<1&&(f=this.aspectRatio),u=f*this.blur*.12,this.horizontal?h[0]=u:h[1]=u,h}}),c.Blur.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Gamma=d(c.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(f){this.gamma=[1,1,1],c.BaseFilter.prototype.initialize.call(this,f)},applyTo2d:function(f){var h=f.imageData,u=h.data,g=this.gamma,m=u.length,p=1/g[0],x=1/g[1],v=1/g[2],y;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),y=0,m=256;y<m;y++)this.rVals[y]=Math.pow(y/255,p)*255,this.gVals[y]=Math.pow(y/255,x)*255,this.bVals[y]=Math.pow(y/255,v)*255;for(y=0,m=u.length;y<m;y+=4)u[y]=this.rVals[u[y]],u[y+1]=this.gVals[u[y+1]],u[y+2]=this.bVals[u[y+2]]},getUniformLocations:function(f,h){return{uGamma:f.getUniformLocation(h,"uGamma")}},sendUniformData:function(f,h){f.uniform3fv(h.uGamma,this.gamma)}}),a.Image.filters.Gamma.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.Composed=d(c.BaseFilter,{type:"Composed",subFilters:[],initialize:function(f){this.callSuper("initialize",f),this.subFilters=this.subFilters.slice(0)},applyTo:function(f){f.passes+=this.subFilters.length-1,this.subFilters.forEach(function(h){h.applyTo(f)})},toObject:function(){return a.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(f){return f.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(f){return!f.isNeutralState()})}}),a.Image.filters.Composed.fromObject=function(f,h){var u=f.subFilters||[],g=u.map(function(p){return new a.Image.filters[p.type](p)}),m=new a.Image.filters.Composed({subFilters:g});return h&&h(m),m}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,d=a.util.createClass;c.HueRotation=d(c.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var f=this.rotation*Math.PI,h=a.util.cos(f),u=a.util.sin(f),g=1/3,m=Math.sqrt(g)*u,p=1-h;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=h+p/3,this.matrix[1]=g*p-m,this.matrix[2]=g*p+m,this.matrix[5]=g*p+m,this.matrix[6]=h+g*p,this.matrix[7]=g*p-m,this.matrix[10]=g*p-m,this.matrix[11]=g*p+m,this.matrix[12]=h+g*p},isNeutralState:function(f){return this.calculateMatrix(),c.BaseFilter.prototype.isNeutralState.call(this,f)},applyTo:function(f){this.calculateMatrix(),c.BaseFilter.prototype.applyTo.call(this,f)}}),a.Image.filters.HueRotation.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.clone;if(a.Text){a.warn("fabric.Text is already defined");return}var d="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");a.Text=a.util.createClass(a.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:a.Object.prototype.stateProperties.concat(d),cacheProperties:a.Object.prototype.cacheProperties.concat(d),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(f,h){this.styles=h?h.styles||{}:{},this.text=f,this.__skipDimension=!0,this.callSuper("initialize",h),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var f=this.path;f&&(f.segmentsInfo=a.util.getPathSegmentsInfo(f.path))},getMeasuringContext:function(){return a._measuringContext||(a._measuringContext=this.canvas&&this.canvas.contextCache||a.util.createCanvasElement().getContext("2d")),a._measuringContext},_splitText:function(){var f=this._splitTextIntoLines(this.text);return this.textLines=f.lines,this._textLines=f.graphemeLines,this._unwrappedTextLines=f._unwrappedLines,this._text=f.graphemeText,f},initDimensions:function(){if(!this.__skipDimension){if(this._splitText(),this._clearCache(),this.path){var f=this.getHeightOfLine(0)*1.1;this.width=this.path.width+f,this.height=this.path.height+f}else this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight();this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"})}},enlargeSpaces:function(){for(var f,h,u,g,m,p,x,v=0,y=this._textLines.length;v<y;v++)if(!(this.textAlign!=="justify"&&(v===y-1||this.isEndOfWrapping(v)))&&(g=0,m=this._textLines[v],h=this.getLineWidth(v),h<this.width&&(x=this.textLines[v].match(this._reSpacesAndTabs)))){u=x.length,f=(this.width-h)/u;for(var _=0,b=m.length;_<=b;_++)p=this.__charBounds[v][_],this._reSpaceAndTab.test(m[_])?(p.width+=f,p.kernedWidth+=f,p.left+=g,g+=f):p.left+=g}},isEndOfWrapping:function(f){return f===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var f=this.callSuper("_getCacheCanvasDimensions"),h=this.fontSize;return f.width+=h*f.zoomX,f.height+=h*f.zoomY,f},_render:function(f){var h=this.path;h&&!h.isNotVisible()&&h._render(f),this._setTextStyles(f),this._renderTextLinesBackground(f),this._renderTextDecoration(f,"underline"),this._renderText(f),this._renderTextDecoration(f,"overline"),this._renderTextDecoration(f,"linethrough")},_renderText:function(f){this.paintFirst==="stroke"?(this._renderTextStroke(f),this._renderTextFill(f)):(this._renderTextFill(f),this._renderTextStroke(f))},_setTextStyles:function(f,h,u){if(f.textBaseline="alphabetic",this.path)switch(this.pathAlign){case"center":f.textBaseline="middle";break;case"ascender":f.textBaseline="top";break;case"descender":f.textBaseline="bottom";break}f.font=this._getFontDeclaration(h,u)},calcTextWidth:function(){for(var f=this.getLineWidth(0),h=1,u=this._textLines.length;h<u;h++){var g=this.getLineWidth(h);g>f&&(f=g)}return f},_renderTextLine:function(f,h,u,g,m,p){this._renderChars(f,h,u,g,m,p)},_renderTextLinesBackground:function(f){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var h,u,g=f.fillStyle,m,p,x=this._getLeftOffset(),v=this._getTopOffset(),y=0,_=0,b,S,C=this.path,N,F=0,Y=this._textLines.length;F<Y;F++){if(h=this.getHeightOfLine(F),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",F)){v+=h;continue}m=this._textLines[F],u=this._getLineLeftOffset(F),_=0,y=0,p=this.getValueOfPropertyAt(F,0,"textBackgroundColor");for(var X=0,V=m.length;X<V;X++)b=this.__charBounds[F][X],S=this.getValueOfPropertyAt(F,X,"textBackgroundColor"),C?(f.save(),f.translate(b.renderLeft,b.renderTop),f.rotate(b.angle),f.fillStyle=S,S&&f.fillRect(-b.width/2,-h/this.lineHeight*(1-this._fontSizeFraction),b.width,h/this.lineHeight),f.restore()):S!==p?(N=x+u+y,this.direction==="rtl"&&(N=this.width-N-_),f.fillStyle=p,p&&f.fillRect(N,v,_,h/this.lineHeight),y=b.left,_=b.width,p=S):_+=b.kernedWidth;S&&!C&&(N=x+u+y,this.direction==="rtl"&&(N=this.width-N-_),f.fillStyle=S,f.fillRect(N,v,_,h/this.lineHeight)),v+=h}f.fillStyle=g,this._removeShadow(f)}},getFontCache:function(f){var h=f.fontFamily.toLowerCase();a.charWidthsCache[h]||(a.charWidthsCache[h]={});var u=a.charWidthsCache[h],g=f.fontStyle.toLowerCase()+"_"+(f.fontWeight+"").toLowerCase();return u[g]||(u[g]={}),u[g]},_measureChar:function(f,h,u,g){var m=this.getFontCache(h),p=this._getFontDeclaration(h),x=this._getFontDeclaration(g),v=u+f,y=p===x,_,b,S,C=h.fontSize/this.CACHE_FONT_SIZE,N;if(u&&m[u]!==void 0&&(S=m[u]),m[f]!==void 0&&(N=_=m[f]),y&&m[v]!==void 0&&(b=m[v],N=b-S),_===void 0||S===void 0||b===void 0){var F=this.getMeasuringContext();this._setTextStyles(F,h,!0)}return _===void 0&&(N=_=F.measureText(f).width,m[f]=_),S===void 0&&y&&u&&(S=F.measureText(u).width,m[u]=S),y&&b===void 0&&(b=F.measureText(v).width,m[v]=b,N=b-S),{width:_*C,kernedWidth:N*C}},getHeightOfChar:function(f,h){return this.getValueOfPropertyAt(f,h,"fontSize")},measureLine:function(f){var h=this._measureLine(f);return this.charSpacing!==0&&(h.width-=this._getWidthOfCharSpacing()),h.width<0&&(h.width=0),h},_measureLine:function(f){var h=0,u,g,m=this._textLines[f],p,x,v=0,y=new Array(m.length),_=0,b,S,C=this.path,N=this.pathSide==="right";for(this.__charBounds[f]=y,u=0;u<m.length;u++)g=m[u],x=this._getGraphemeBox(g,f,u,p),y[u]=x,h+=x.kernedWidth,p=g;if(y[u]={left:x?x.left+x.width:0,width:0,kernedWidth:0,height:this.fontSize},C){switch(S=C.segmentsInfo[C.segmentsInfo.length-1].length,b=a.util.getPointOnPath(C.path,0,C.segmentsInfo),b.x+=C.pathOffset.x,b.y+=C.pathOffset.y,this.textAlign){case"left":_=N?S-h:0;break;case"center":_=(S-h)/2;break;case"right":_=N?0:S-h;break}for(_+=this.pathStartOffset*(N?-1:1),u=N?m.length-1:0;N?u>=0:u<m.length;N?u--:u++)x=y[u],_>S?_%=S:_<0&&(_+=S),this._setGraphemeOnPath(_,x,b),_+=x.kernedWidth}return{width:h,numOfSpaces:v}},_setGraphemeOnPath:function(f,h,u){var g=f+h.kernedWidth/2,m=this.path,p=a.util.getPointOnPath(m.path,g,m.segmentsInfo);h.renderLeft=p.x-u.x,h.renderTop=p.y-u.y,h.angle=p.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(f,h,u,g,m){var p=this.getCompleteStyleDeclaration(h,u),x=g?this.getCompleteStyleDeclaration(h,u-1):{},v=this._measureChar(f,p,g,x),y=v.kernedWidth,_=v.width,b;this.charSpacing!==0&&(b=this._getWidthOfCharSpacing(),_+=b,y+=b);var S={width:_,left:0,height:p.fontSize,kernedWidth:y,deltaY:p.deltaY};if(u>0&&!m){var C=this.__charBounds[h][u-1];S.left=C.left+C.width+v.kernedWidth-v.width}return S},getHeightOfLine:function(f){if(this.__lineHeights[f])return this.__lineHeights[f];for(var h=this._textLines[f],u=this.getHeightOfChar(f,0),g=1,m=h.length;g<m;g++)u=Math.max(this.getHeightOfChar(f,g),u);return this.__lineHeights[f]=u*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var f,h=0,u=0,g=this._textLines.length;u<g;u++)f=this.getHeightOfLine(u),h+=u===g-1?f/this.lineHeight:f;return h},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(f,h){f.save();for(var u=0,g=this._getLeftOffset(),m=this._getTopOffset(),p=0,x=this._textLines.length;p<x;p++){var v=this.getHeightOfLine(p),y=v/this.lineHeight,_=this._getLineLeftOffset(p);this._renderTextLine(h,f,this._textLines[p],g+_,m+u+y,p),u+=v}f.restore()},_renderTextFill:function(f){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(f,"fillText")},_renderTextStroke:function(f){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(f),f.save(),this._setLineDash(f,this.strokeDashArray),f.beginPath(),this._renderTextCommon(f,"strokeText"),f.closePath(),f.restore())},_renderChars:function(f,h,u,g,m,p){var x=this.getHeightOfLine(p),v=this.textAlign.indexOf("justify")!==-1,y,_,b="",S,C=0,N,F=this.path,Y=!v&&this.charSpacing===0&&this.isEmptyStyles(p)&&!F,X=this.direction==="ltr",V=this.direction==="ltr"?1:-1,te,G=h.canvas.getAttribute("dir");if(h.save(),G!==this.direction&&(h.canvas.setAttribute("dir",X?"ltr":"rtl"),h.direction=X?"ltr":"rtl",h.textAlign=X?"left":"right"),m-=x*this._fontSizeFraction/this.lineHeight,Y){this._renderChar(f,h,p,0,u.join(""),g,m,x),h.restore();return}for(var re=0,Z=u.length-1;re<=Z;re++)N=re===Z||this.charSpacing||F,b+=u[re],S=this.__charBounds[p][re],C===0?(g+=V*(S.kernedWidth-S.width),C+=S.width):C+=S.kernedWidth,v&&!N&&this._reSpaceAndTab.test(u[re])&&(N=!0),N||(y=y||this.getCompleteStyleDeclaration(p,re),_=this.getCompleteStyleDeclaration(p,re+1),N=a.util.hasStyleChanged(y,_,!1)),N&&(F?(h.save(),h.translate(S.renderLeft,S.renderTop),h.rotate(S.angle),this._renderChar(f,h,p,re,b,-C/2,0,x),h.restore()):(te=g,this._renderChar(f,h,p,re,b,te,m,x)),b="",y=_,g+=V*C,C=0);h.restore()},_applyPatternGradientTransformText:function(f){var h=a.util.createCanvasElement(),u,g=this.width+this.strokeWidth,m=this.height+this.strokeWidth;return h.width=g,h.height=m,u=h.getContext("2d"),u.beginPath(),u.moveTo(0,0),u.lineTo(g,0),u.lineTo(g,m),u.lineTo(0,m),u.closePath(),u.translate(g/2,m/2),u.fillStyle=f.toLive(u),this._applyPatternGradientTransform(u,f),u.fill(),u.createPattern(h,"no-repeat")},handleFiller:function(f,h,u){var g,m;return u.toLive?u.gradientUnits==="percentage"||u.gradientTransform||u.patternTransform?(g=-this.width/2,m=-this.height/2,f.translate(g,m),f[h]=this._applyPatternGradientTransformText(u),{offsetX:g,offsetY:m}):(f[h]=u.toLive(f,this),this._applyPatternGradientTransform(f,u)):(f[h]=u,{offsetX:0,offsetY:0})},_setStrokeStyles:function(f,h){return f.lineWidth=h.strokeWidth,f.lineCap=this.strokeLineCap,f.lineDashOffset=this.strokeDashOffset,f.lineJoin=this.strokeLineJoin,f.miterLimit=this.strokeMiterLimit,this.handleFiller(f,"strokeStyle",h.stroke)},_setFillStyles:function(f,h){return this.handleFiller(f,"fillStyle",h.fill)},_renderChar:function(f,h,u,g,m,p,x){var v=this._getStyleDeclaration(u,g),y=this.getCompleteStyleDeclaration(u,g),_=f==="fillText"&&y.fill,b=f==="strokeText"&&y.stroke&&y.strokeWidth,S,C;!b&&!_||(h.save(),_&&(S=this._setFillStyles(h,y)),b&&(C=this._setStrokeStyles(h,y)),h.font=this._getFontDeclaration(y),v&&v.textBackgroundColor&&this._removeShadow(h),v&&v.deltaY&&(x+=v.deltaY),_&&h.fillText(m,p-S.offsetX,x-S.offsetY),b&&h.strokeText(m,p-C.offsetX,x-C.offsetY),h.restore())},setSuperscript:function(f,h){return this._setScript(f,h,this.superscript)},setSubscript:function(f,h){return this._setScript(f,h,this.subscript)},_setScript:function(f,h,u){var g=this.get2DCursorLocation(f,!0),m=this.getValueOfPropertyAt(g.lineIndex,g.charIndex,"fontSize"),p=this.getValueOfPropertyAt(g.lineIndex,g.charIndex,"deltaY"),x={fontSize:m*u.size,deltaY:p+m*u.baseline};return this.setSelectionStyles(x,f,h),this},_getLineLeftOffset:function(f){var h=this.getLineWidth(f),u=this.width-h,g=this.textAlign,m=this.direction,x,p=0,x=this.isEndOfWrapping(f);return g==="justify"||g==="justify-center"&&!x||g==="justify-right"&&!x||g==="justify-left"&&!x?0:(g==="center"&&(p=u/2),g==="right"&&(p=u),g==="justify-center"&&(p=u/2),g==="justify-right"&&(p=u),m==="rtl"&&(p-=u),p)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var f=this._forceClearCache;return f||(f=this.hasStateChanged("_dimensionAffectingProps")),f&&(this.dirty=!0,this._forceClearCache=!1),f},getLineWidth:function(f){if(this.__lineWidths[f]!==void 0)return this.__lineWidths[f];var h=this.measureLine(f),u=h.width;return this.__lineWidths[f]=u,u},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(f,h,u){var g=this._getStyleDeclaration(f,h);return g&&typeof g[u]<"u"?g[u]:this[u]},_renderTextDecoration:function(f,h){if(!(!this[h]&&!this.styleHas(h))){f.save(),(h==="overline"||h==="linethrough")&&this._removeShadow(f);for(var u,g,m,p,x,v,y,_,b=this._getLeftOffset(),S=this._getTopOffset(),C,N,F,Y,X,V,te,G,re=this.path,Z=this._getWidthOfCharSpacing(),oe=this.offsets[h],ee=0,E=this._textLines.length;ee<E;ee++){if(u=this.getHeightOfLine(ee),!this[h]&&!this.styleHas(h,ee)){S+=u;continue}y=this._textLines[ee],V=u/this.lineHeight,p=this._getLineLeftOffset(ee),N=0,F=0,_=this.getValueOfPropertyAt(ee,0,h),G=this.getValueOfPropertyAt(ee,0,"fill"),C=S+V*(1-this._fontSizeFraction),g=this.getHeightOfChar(ee,0),x=this.getValueOfPropertyAt(ee,0,"deltaY");for(var D=0,U=y.length;D<U;D++)if(Y=this.__charBounds[ee][D],X=this.getValueOfPropertyAt(ee,D,h),te=this.getValueOfPropertyAt(ee,D,"fill"),m=this.getHeightOfChar(ee,D),v=this.getValueOfPropertyAt(ee,D,"deltaY"),re&&X&&te)f.save(),f.fillStyle=G,f.translate(Y.renderLeft,Y.renderTop),f.rotate(Y.angle),f.fillRect(-Y.kernedWidth/2,oe*m+v,Y.kernedWidth,this.fontSize/15),f.restore();else if((X!==_||te!==G||m!==g||v!==x)&&F>0){var k=b+p+N;this.direction==="rtl"&&(k=this.width-k-F),_&&G&&(f.fillStyle=G,f.fillRect(k,C+oe*g+x,F,this.fontSize/15)),N=Y.left,F=Y.width,_=X,G=te,g=m,x=v}else F+=Y.kernedWidth;var k=b+p+N;this.direction==="rtl"&&(k=this.width-k-F),f.fillStyle=te,X&&te&&f.fillRect(k,C+oe*g+x,F-Z,this.fontSize/15),S+=u}f.restore()}},_getFontDeclaration:function(f,h){var u=f||this,g=this.fontFamily,m=a.Text.genericFonts.indexOf(g.toLowerCase())>-1,p=g===void 0||g.indexOf("'")>-1||g.indexOf(",")>-1||g.indexOf('"')>-1||m?u.fontFamily:'"'+u.fontFamily+'"';return[a.isLikelyNode?u.fontWeight:u.fontStyle,a.isLikelyNode?u.fontStyle:u.fontWeight,h?this.CACHE_FONT_SIZE+"px":u.fontSize+"px",p].join(" ")},render:function(f){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",f)))},_splitTextIntoLines:function(f){for(var h=f.split(this._reNewline),u=new Array(h.length),g=[`
`],m=[],p=0;p<h.length;p++)u[p]=a.util.string.graphemeSplit(h[p]),m=m.concat(u[p],g);return m.pop(),{_unwrappedLines:u,lines:h,graphemeText:m,graphemeLines:u}},toObject:function(f){var h=d.concat(f),u=this.callSuper("toObject",h);return u.styles=a.util.stylesToArray(this.styles,this.text),u.path&&(u.path=this.path.toObject()),u},set:function(f,h){this.callSuper("set",f,h);var u=!1,g=!1;if(typeof f=="object")for(var m in f)m==="path"&&this.setPathInfo(),u=u||this._dimensionAffectingProps.indexOf(m)!==-1,g=g||m==="path";else u=this._dimensionAffectingProps.indexOf(f)!==-1,g=f==="path";return g&&this.setPathInfo(),u&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),a.Text.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),a.Text.DEFAULT_SVG_FONT_SIZE=16,a.Text.fromElement=function(f,h,u){if(!f)return h(null);var g=a.parseAttributes(f,a.Text.ATTRIBUTE_NAMES),m=g.textAnchor||"left";if(u=a.util.object.extend(u?c(u):{},g),u.top=u.top||0,u.left=u.left||0,g.textDecoration){var p=g.textDecoration;p.indexOf("underline")!==-1&&(u.underline=!0),p.indexOf("overline")!==-1&&(u.overline=!0),p.indexOf("line-through")!==-1&&(u.linethrough=!0),delete u.textDecoration}"dx"in g&&(u.left+=g.dx),"dy"in g&&(u.top+=g.dy),"fontSize"in u||(u.fontSize=a.Text.DEFAULT_SVG_FONT_SIZE);var x="";"textContent"in f?x=f.textContent:"firstChild"in f&&f.firstChild!==null&&"data"in f.firstChild&&f.firstChild.data!==null&&(x=f.firstChild.data),x=x.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var v=u.strokeWidth;u.strokeWidth=0;var y=new a.Text(x,u),_=y.getScaledHeight()/y.height,b=(y.height+y.strokeWidth)*y.lineHeight-y.height,S=b*_,C=y.getScaledHeight()+S,N=0;m==="center"&&(N=y.getScaledWidth()/2),m==="right"&&(N=y.getScaledWidth()),y.set({left:y.left-N,top:y.top-(C-y.fontSize*(.07+y._fontSizeFraction))/y.lineHeight,strokeWidth:typeof v<"u"?v:1}),h(y)},a.Text.fromObject=function(f,h){var u=c(f),g=f.path;return delete u.path,a.Object._fromObject("Text",u,function(m){m.styles=a.util.stylesFromArray(f.styles,f.text),g?a.Object._fromObject("Path",g,function(p){m.set("path",p),h(m)},"path"):h(m)},"text")},a.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],a.util.createAccessors&&a.util.createAccessors(a.Text)}(e),function(){t.util.object.extend(t.Text.prototype,{isEmptyStyles:function(o){if(!this.styles||typeof o<"u"&&!this.styles[o])return!0;var a=typeof o>"u"?this.styles:{line:this.styles[o]};for(var c in a)for(var d in a[c])for(var f in a[c][d])return!1;return!0},styleHas:function(o,a){if(!this.styles||!o||o===""||typeof a<"u"&&!this.styles[a])return!1;var c=typeof a>"u"?this.styles:{0:this.styles[a]};for(var d in c)for(var f in c[d])if(typeof c[d][f][o]<"u")return!0;return!1},cleanStyle:function(o){if(!this.styles||!o||o==="")return!1;var a=this.styles,c=0,d,f,h=!0,u=0,g;for(var m in a){d=0;for(var p in a[m]){var g=a[m][p],x=g.hasOwnProperty(o);c++,x?(f?g[o]!==f&&(h=!1):f=g[o],g[o]===this[o]&&delete g[o]):h=!1,Object.keys(g).length!==0?d++:delete a[m][p]}d===0&&delete a[m]}for(var v=0;v<this._textLines.length;v++)u+=this._textLines[v].length;h&&c===u&&(this[o]=f,this.removeStyle(o))},removeStyle:function(o){if(!(!this.styles||!o||o==="")){var a=this.styles,c,d,f;for(d in a){c=a[d];for(f in c)delete c[f][o],Object.keys(c[f]).length===0&&delete c[f];Object.keys(c).length===0&&delete a[d]}}},_extendStyles:function(o,a){var c=this.get2DCursorLocation(o);this._getLineStyle(c.lineIndex)||this._setLineStyle(c.lineIndex),this._getStyleDeclaration(c.lineIndex,c.charIndex)||this._setStyleDeclaration(c.lineIndex,c.charIndex,{}),t.util.object.extend(this._getStyleDeclaration(c.lineIndex,c.charIndex),a)},get2DCursorLocation:function(o,a){typeof o>"u"&&(o=this.selectionStart);for(var c=a?this._unwrappedTextLines:this._textLines,d=c.length,f=0;f<d;f++){if(o<=c[f].length)return{lineIndex:f,charIndex:o};o-=c[f].length+this.missingNewlineOffset(f,a)}return{lineIndex:f-1,charIndex:c[f-1].length<o?c[f-1].length:o}},getSelectionStyles:function(o,a,c){typeof o>"u"&&(o=this.selectionStart||0),typeof a>"u"&&(a=this.selectionEnd||o);for(var d=[],f=o;f<a;f++)d.push(this.getStyleAtPosition(f,c));return d},getStyleAtPosition:function(o,a){var c=this.get2DCursorLocation(o),d=a?this.getCompleteStyleDeclaration(c.lineIndex,c.charIndex):this._getStyleDeclaration(c.lineIndex,c.charIndex);return d||{}},setSelectionStyles:function(o,a,c){typeof a>"u"&&(a=this.selectionStart||0),typeof c>"u"&&(c=this.selectionEnd||a);for(var d=a;d<c;d++)this._extendStyles(d,o);return this._forceClearCache=!0,this},_getStyleDeclaration:function(o,a){var c=this.styles&&this.styles[o];return c?c[a]:null},getCompleteStyleDeclaration:function(o,a){for(var c=this._getStyleDeclaration(o,a)||{},d={},f,h=0;h<this._styleProperties.length;h++)f=this._styleProperties[h],d[f]=typeof c[f]>"u"?this[f]:c[f];return d},_setStyleDeclaration:function(o,a,c){this.styles[o][a]=c},_deleteStyleDeclaration:function(o,a){delete this.styles[o][a]},_getLineStyle:function(o){return!!this.styles[o]},_setLineStyle:function(o){this.styles[o]={}},_deleteLineStyle:function(o){delete this.styles[o]}})}(),function(){function o(a){a.textDecoration&&(a.textDecoration.indexOf("underline")>-1&&(a.underline=!0),a.textDecoration.indexOf("line-through")>-1&&(a.linethrough=!0),a.textDecoration.indexOf("overline")>-1&&(a.overline=!0),delete a.textDecoration)}t.IText=t.util.createClass(t.Text,t.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(a,c){this.callSuper("initialize",a,c),this.initBehavior()},setSelectionStart:function(a){a=Math.max(a,0),this._updateAndFire("selectionStart",a)},setSelectionEnd:function(a){a=Math.min(a,this.text.length),this._updateAndFire("selectionEnd",a)},_updateAndFire:function(a,c){this[a]!==c&&(this._fireSelectionChanged(),this[a]=c),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(a){this.clearContextTop(),this.callSuper("render",a),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(a){this.callSuper("_render",a)},clearContextTop:function(a){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var c=this.canvas.contextTop,d=this.canvas.viewportTransform;c.save(),c.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this.transform(c),this._clearTextArea(c),a||c.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var a=this._getCursorBoundaries(),c=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(a,c):this.renderSelection(a,c),c.restore()}},_clearTextArea:function(a){var c=this.width+4,d=this.height+4;a.clearRect(-c/2,-d/2,c,d)},_getCursorBoundaries:function(a){typeof a>"u"&&(a=this.selectionStart);var c=this._getLeftOffset(),d=this._getTopOffset(),f=this._getCursorBoundariesOffsets(a);return{left:c,top:d,leftOffset:f.left,topOffset:f.top}},_getCursorBoundariesOffsets:function(a){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var c,d,f,h=0,u=0,g,m=this.get2DCursorLocation(a);f=m.charIndex,d=m.lineIndex;for(var p=0;p<d;p++)h+=this.getHeightOfLine(p);c=this._getLineLeftOffset(d);var x=this.__charBounds[d][f];return x&&(u=x.left),this.charSpacing!==0&&f===this._textLines[d].length&&(u-=this._getWidthOfCharSpacing()),g={top:h,left:c+(u>0?u:0)},this.direction==="rtl"&&(g.left*=-1),this.cursorOffsetCache=g,this.cursorOffsetCache},renderCursor:function(a,c){var d=this.get2DCursorLocation(),f=d.lineIndex,h=d.charIndex>0?d.charIndex-1:0,u=this.getValueOfPropertyAt(f,h,"fontSize"),g=this.scaleX*this.canvas.getZoom(),m=this.cursorWidth/g,p=a.topOffset,x=this.getValueOfPropertyAt(f,h,"deltaY");p+=(1-this._fontSizeFraction)*this.getHeightOfLine(f)/this.lineHeight-u*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(a,c),c.fillStyle=this.cursorColor||this.getValueOfPropertyAt(f,h,"fill"),c.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,c.fillRect(a.left+a.leftOffset-m/2,p+a.top+x,m,u)},renderSelection:function(a,c){for(var d=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,f=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,h=this.textAlign.indexOf("justify")!==-1,u=this.get2DCursorLocation(d),g=this.get2DCursorLocation(f),m=u.lineIndex,p=g.lineIndex,x=u.charIndex<0?0:u.charIndex,v=g.charIndex<0?0:g.charIndex,y=m;y<=p;y++){var _=this._getLineLeftOffset(y)||0,b=this.getHeightOfLine(y),S=0,C=0,N=0;if(y===m&&(C=this.__charBounds[m][x].left),y>=m&&y<p)N=h&&!this.isEndOfWrapping(y)?this.width:this.getLineWidth(y)||5;else if(y===p)if(v===0)N=this.__charBounds[p][v].left;else{var F=this._getWidthOfCharSpacing();N=this.__charBounds[p][v-1].left+this.__charBounds[p][v-1].width-F}S=b,(this.lineHeight<1||y===p&&this.lineHeight>1)&&(b/=this.lineHeight);var Y=a.left+_+C,X=N-C,V=b,te=0;this.inCompositionMode?(c.fillStyle=this.compositionColor||"black",V=1,te=b):c.fillStyle=this.selectionColor,this.direction==="rtl"&&(Y=this.width-Y-X),c.fillRect(Y,a.top+a.topOffset+te,X,V),a.topOffset+=S}},getCurrentCharFontSize:function(){var a=this._getCurrentCharIndex();return this.getValueOfPropertyAt(a.l,a.c,"fontSize")},getCurrentCharColor:function(){var a=this._getCurrentCharIndex();return this.getValueOfPropertyAt(a.l,a.c,"fill")},_getCurrentCharIndex:function(){var a=this.get2DCursorLocation(this.selectionStart,!0),c=a.charIndex>0?a.charIndex-1:0;return{l:a.lineIndex,c}}}),t.IText.fromObject=function(a,c){var d=t.util.stylesFromArray(a.styles,a.text),f=Object.assign({},a,{styles:d});if(delete f.path,o(f),f.styles)for(var h in f.styles)for(var u in f.styles[h])o(f.styles[h][u]);t.Object._fromObject("IText",f,function(g){a.path?t.Object._fromObject("Path",a.path,function(m){g.set("path",m),c(g)},"path"):c(g)},"text")}}(),function(){var o=t.util.object.clone;t.util.object.extend(t.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var a=this;this.on("added",function(){var c=a.canvas;c&&(c._hasITextHandlers||(c._hasITextHandlers=!0,a._initCanvasHandlers(c)),c._iTextInstances=c._iTextInstances||[],c._iTextInstances.push(a))})},initRemovedHandler:function(){var a=this;this.on("removed",function(){var c=a.canvas;c&&(c._iTextInstances=c._iTextInstances||[],t.util.removeFromArray(c._iTextInstances,a),c._iTextInstances.length===0&&(c._hasITextHandlers=!1,a._removeCanvasHandlers(c)))})},_initCanvasHandlers:function(a){a._mouseUpITextHandler=function(){a._iTextInstances&&a._iTextInstances.forEach(function(c){c.__isMousedown=!1})},a.on("mouse:up",a._mouseUpITextHandler)},_removeCanvasHandlers:function(a){a.off("mouse:up",a._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(a,c,d,f){var h;return h={isAborted:!1,abort:function(){this.isAborted=!0}},a.animate("_currentCursorOpacity",c,{duration:d,onComplete:function(){h.isAborted||a[f]()},onChange:function(){a.canvas&&a.selectionStart===a.selectionEnd&&a.renderCursorOrSelection()},abort:function(){return h.isAborted}}),h},_onTickComplete:function(){var a=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){a._currentTickCompleteState=a._animateCursor(a,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(a){var c=this,d=a?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){c._tick()},d)},abortCursorAnimation:function(){var a=this._currentTickState||this._currentTickCompleteState,c=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,a&&c&&c.clearContext(c.contextTop||c.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(a){var c=0,d=a-1;if(this._reSpace.test(this._text[d]))for(;this._reSpace.test(this._text[d]);)c++,d--;for(;/\S/.test(this._text[d])&&d>-1;)c++,d--;return a-c},findWordBoundaryRight:function(a){var c=0,d=a;if(this._reSpace.test(this._text[d]))for(;this._reSpace.test(this._text[d]);)c++,d++;for(;/\S/.test(this._text[d])&&d<this._text.length;)c++,d++;return a+c},findLineBoundaryLeft:function(a){for(var c=0,d=a-1;!/\n/.test(this._text[d])&&d>-1;)c++,d--;return a-c},findLineBoundaryRight:function(a){for(var c=0,d=a;!/\n/.test(this._text[d])&&d<this._text.length;)c++,d++;return a+c},searchWordBoundary:function(a,c){for(var d=this._text,f=this._reSpace.test(d[a])?a-1:a,h=d[f],u=t.reNonWord;!u.test(h)&&f>0&&f<d.length;)f+=c,h=d[f];return u.test(h)&&(f+=c===1?0:1),f},selectWord:function(a){a=a||this.selectionStart;var c=this.searchWordBoundary(a,-1),d=this.searchWordBoundary(a,1);this.selectionStart=c,this.selectionEnd=d,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(a){a=a||this.selectionStart;var c=this.findLineBoundaryLeft(a),d=this.findLineBoundaryRight(a);return this.selectionStart=c,this.selectionEnd=d,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(a){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(a),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(a){a._iTextInstances&&a._iTextInstances.forEach(function(c){c.selected=!1,c.isEditing&&c.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(a){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var c=this.getSelectionStartFromPointer(a.e),d=this.selectionStart,f=this.selectionEnd;(c!==this.__selectionStartOnMouseDown||d===f)&&(d===c||f===c)||(c>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=c):(this.selectionStart=c,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==d||this.selectionEnd!==f)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(a,c,d){var f=d.slice(0,a),h=t.util.string.graphemeSplit(f).length;if(a===c)return{selectionStart:h,selectionEnd:h};var u=d.slice(a,c),g=t.util.string.graphemeSplit(u).length;return{selectionStart:h,selectionEnd:h+g}},fromGraphemeToStringSelection:function(a,c,d){var f=d.slice(0,a),h=f.join("").length;if(a===c)return{selectionStart:h,selectionEnd:h};var u=d.slice(a,c),g=u.join("").length;return{selectionStart:h,selectionEnd:h+g}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var a=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=a.selectionStart,this.hiddenTextarea.selectionEnd=a.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var a=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=a.selectionEnd,this.inCompositionMode||(this.selectionStart=a.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var a=this._calcTextareaPosition();this.hiddenTextarea.style.left=a.left,this.hiddenTextarea.style.top=a.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var a=this.inCompositionMode?this.compositionStart:this.selectionStart,c=this._getCursorBoundaries(a),d=this.get2DCursorLocation(a),f=d.lineIndex,h=d.charIndex,u=this.getValueOfPropertyAt(f,h,"fontSize")*this.lineHeight,g=c.leftOffset,m=this.calcTransformMatrix(),p={x:c.left+g,y:c.top+c.topOffset+u},x=this.canvas.getRetinaScaling(),v=this.canvas.upperCanvasEl,y=v.width/x,_=v.height/x,b=y-u,S=_-u,C=v.clientWidth/y,N=v.clientHeight/_;return p=t.util.transformPoint(p,m),p=t.util.transformPoint(p,this.canvas.viewportTransform),p.x*=C,p.y*=N,p.x<0&&(p.x=0),p.x>b&&(p.x=b),p.y<0&&(p.y=0),p.y>S&&(p.y=S),p.x+=this.canvas._offset.left,p.y+=this.canvas._offset.top,{left:p.x+"px",top:p.y+"px",fontSize:u+"px",charHeight:u}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var a=this._textBeforeEdit!==this.text,c=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,c&&(c.blur&&c.blur(),c.parentNode&&c.parentNode.removeChild(c)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),a&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),a&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var a in this.styles)this._textLines[a]||delete this.styles[a]},removeStyleFromTo:function(a,c){var d=this.get2DCursorLocation(a,!0),f=this.get2DCursorLocation(c,!0),h=d.lineIndex,u=d.charIndex,g=f.lineIndex,m=f.charIndex,p,x;if(h!==g){if(this.styles[h])for(p=u;p<this._unwrappedTextLines[h].length;p++)delete this.styles[h][p];if(this.styles[g])for(p=m;p<this._unwrappedTextLines[g].length;p++)x=this.styles[g][p],x&&(this.styles[h]||(this.styles[h]={}),this.styles[h][u+p-m]=x);for(p=h+1;p<=g;p++)delete this.styles[p];this.shiftLineStyles(g,h-g)}else if(this.styles[h]){x=this.styles[h];var v=m-u,y,_;for(p=u;p<m;p++)delete x[p];for(_ in this.styles[h])y=parseInt(_,10),y>=m&&(x[y-v]=x[_],delete x[_])}},shiftLineStyles:function(a,c){var d=o(this.styles);for(var f in this.styles){var h=parseInt(f,10);h>a&&(this.styles[h+c]=d[h],d[h-c]||delete this.styles[h])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(a,c,d,f){var h,u={},g=!1,m=this._unwrappedTextLines[a].length,p=m===c;d||(d=1),this.shiftLineStyles(a,d),this.styles[a]&&(h=this.styles[a][c===0?c:c-1]);for(var x in this.styles[a]){var v=parseInt(x,10);v>=c&&(g=!0,u[v-c]=this.styles[a][x],p&&c===0||delete this.styles[a][x])}var y=!1;for(g&&!p&&(this.styles[a+d]=u,y=!0),(y||m>c)&&d--;d>0;)f&&f[d-1]?this.styles[a+d]={0:o(f[d-1])}:h?this.styles[a+d]={0:o(h)}:delete this.styles[a+d],d--;this._forceClearCache=!0},insertCharStyleObject:function(a,c,d,f){this.styles||(this.styles={});var h=this.styles[a],u=h?o(h):{};d||(d=1);for(var g in u){var m=parseInt(g,10);m>=c&&(h[m+d]=u[m],u[m-d]||delete h[m])}if(this._forceClearCache=!0,f){for(;d--;)Object.keys(f[d]).length&&(this.styles[a]||(this.styles[a]={}),this.styles[a][c+d]=o(f[d]));return}if(h)for(var p=h[c?c-1:1];p&&d--;)this.styles[a][c+d]=o(p)},insertNewStyleBlock:function(a,c,d){for(var f=this.get2DCursorLocation(c,!0),h=[0],u=0,g=0;g<a.length;g++)a[g]===`
`?(u++,h[u]=0):h[u]++;h[0]>0&&(this.insertCharStyleObject(f.lineIndex,f.charIndex,h[0],d),d=d&&d.slice(h[0]+1)),u&&this.insertNewlineStyleObject(f.lineIndex,f.charIndex+h[0],u);for(var g=1;g<u;g++)h[g]>0?this.insertCharStyleObject(f.lineIndex+g,0,h[g],d):d&&this.styles[f.lineIndex+g]&&d[0]&&(this.styles[f.lineIndex+g][0]=d[0]),d=d&&d.slice(h[g]+1);h[g]>0&&this.insertCharStyleObject(f.lineIndex+g,0,h[g],d)},setSelectionStartEndWithShift:function(a,c,d){d<=a?(c===a?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=a),this.selectionStart=d):d>a&&d<c?this._selectionDirection==="right"?this.selectionEnd=d:this.selectionStart=d:(c===a?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=c),this.selectionEnd=d)},setSelectionInBoundaries:function(){var a=this.text.length;this.selectionStart>a?this.selectionStart=a:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>a?this.selectionEnd=a:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),t.util.object.extend(t.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(o){if(this.canvas){this.__newClickTime=+new Date;var a=o.pointer;this.isTripleClick(a)&&(this.fire("tripleclick",o),this._stopEvent(o.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=a,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(o){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===o.x&&this.__lastPointer.y===o.y},_stopEvent:function(o){o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(o){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(o.e))},tripleClickHandler:function(o){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(o.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(o){!this.canvas||!this.editable||o.e.button&&o.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(o.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(o){!this.canvas||!this.editable||o.e.button&&o.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(o){if(this.__isMousedown=!1,!(!this.editable||this.group||o.transform&&o.transform.actionPerformed||o.e.button&&o.e.button!==1)){if(this.canvas){var a=this.canvas._activeObject;if(a&&a!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(o.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(o){var a=this.getSelectionStartFromPointer(o),c=this.selectionStart,d=this.selectionEnd;o.shiftKey?this.setSelectionStartEndWithShift(c,d,a):(this.selectionStart=a,this.selectionEnd=a),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(o){for(var a=this.getLocalPointer(o),c=0,d=0,f=0,h=0,u=0,g,m,p=0,x=this._textLines.length;p<x&&f<=a.y;p++)f+=this.getHeightOfLine(p)*this.scaleY,u=p,p>0&&(h+=this._textLines[p-1].length+this.missingNewlineOffset(p-1));g=this._getLineLeftOffset(u),d=g*this.scaleX,m=this._textLines[u],this.direction==="rtl"&&(a.x=this.width*this.scaleX-a.x+d);for(var v=0,y=m.length;v<y&&(c=d,d+=this.__charBounds[u][v].kernedWidth*this.scaleX,d<=a.x);v++)h++;return this._getNewSelectionStartFromOffset(a,c,d,h,y)},_getNewSelectionStartFromOffset:function(o,a,c,d,f){var h=o.x-a,u=c-o.x,g=u>h||u<0?0:1,m=d+g;return this.flipX&&(m=f-m),m>this._text.length&&(m=this._text.length),m}}),t.util.object.extend(t.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=t.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var o=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+o.top+"; left: "+o.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+o.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):t.document.body.appendChild(this.hiddenTextarea),t.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),t.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),t.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),t.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(t.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(o){if(this.isEditing){var a=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(o.keyCode in a)this[a[o.keyCode]](o);else if(o.keyCode in this.ctrlKeysMapDown&&(o.ctrlKey||o.metaKey))this[this.ctrlKeysMapDown[o.keyCode]](o);else return;o.stopImmediatePropagation(),o.preventDefault(),o.keyCode>=33&&o.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(o){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(o.keyCode in this.ctrlKeysMapUp&&(o.ctrlKey||o.metaKey))this[this.ctrlKeysMapUp[o.keyCode]](o);else return;o.stopImmediatePropagation(),o.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(o){var a=this.fromPaste;if(this.fromPaste=!1,o&&o.stopPropagation(),!!this.isEditing){var c=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,d=this._text.length,f=c.length,h,u,g=f-d,m=this.selectionStart,p=this.selectionEnd,x=m!==p,v,y,_;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var b=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),S=m>b.selectionStart;x?(h=this._text.slice(m,p),g+=p-m):f<d&&(S?h=this._text.slice(p+g,p):h=this._text.slice(m,m-g)),u=c.slice(b.selectionEnd-g,b.selectionEnd),h&&h.length&&(u.length&&(v=this.getSelectionStyles(m,m+1,!1),v=u.map(function(){return v[0]})),x?(y=m,_=p):S?(y=p-h.length,_=p):(y=p,_=p+h.length),this.removeStyleFromTo(y,_)),u.length&&(a&&u.join("")===t.copiedText&&!t.disableStyleCopyPaste&&(v=t.copiedTextStyle),this.insertNewStyleBlock(u,m,v)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(o){this.compositionStart=o.target.selectionStart,this.compositionEnd=o.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(t.copiedText=this.getSelectedText(),t.disableStyleCopyPaste?t.copiedTextStyle=null:t.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(o){return o&&o.clipboardData||t.window.clipboardData},_getWidthBeforeCursor:function(o,a){var c=this._getLineLeftOffset(o),d;return a>0&&(d=this.__charBounds[o][a-1],c+=d.left+d.width),c},getDownCursorOffset:function(o,a){var c=this._getSelectionForOffset(o,a),d=this.get2DCursorLocation(c),f=d.lineIndex;if(f===this._textLines.length-1||o.metaKey||o.keyCode===34)return this._text.length-c;var h=d.charIndex,u=this._getWidthBeforeCursor(f,h),g=this._getIndexOnLine(f+1,u),m=this._textLines[f].slice(h);return m.length+g+1+this.missingNewlineOffset(f)},_getSelectionForOffset:function(o,a){return o.shiftKey&&this.selectionStart!==this.selectionEnd&&a?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(o,a){var c=this._getSelectionForOffset(o,a),d=this.get2DCursorLocation(c),f=d.lineIndex;if(f===0||o.metaKey||o.keyCode===33)return-c;var h=d.charIndex,u=this._getWidthBeforeCursor(f,h),g=this._getIndexOnLine(f-1,u),m=this._textLines[f].slice(0,h),p=this.missingNewlineOffset(f-1);return-this._textLines[f-1].length+g-m.length+(1-p)},_getIndexOnLine:function(o,a){for(var c=this._textLines[o],d=this._getLineLeftOffset(o),f=d,h=0,u,g,m=0,p=c.length;m<p;m++)if(u=this.__charBounds[o][m].width,f+=u,f>a){g=!0;var x=f-u,v=f,y=Math.abs(x-a),_=Math.abs(v-a);h=_<y?m:m-1;break}return g||(h=c.length-1),h},moveCursorDown:function(o){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",o)},moveCursorUp:function(o){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",o)},_moveCursorUpOrDown:function(o,a){var c="get"+o+"CursorOffset",d=this[c](a,this._selectionDirection==="right");a.shiftKey?this.moveCursorWithShift(d):this.moveCursorWithoutShift(d),d!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(o){var a=this._selectionDirection==="left"?this.selectionStart+o:this.selectionEnd+o;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,a),o!==0},moveCursorWithoutShift:function(o){return o<0?(this.selectionStart+=o,this.selectionEnd=this.selectionStart):(this.selectionEnd+=o,this.selectionStart=this.selectionEnd),o!==0},moveCursorLeft:function(o){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",o)},_move:function(o,a,c){var d;if(o.altKey)d=this["findWordBoundary"+c](this[a]);else if(o.metaKey||o.keyCode===35||o.keyCode===36)d=this["findLineBoundary"+c](this[a]);else return this[a]+=c==="Left"?-1:1,!0;if(typeof d<"u"&&this[a]!==d)return this[a]=d,!0},_moveLeft:function(o,a){return this._move(o,a,"Left")},_moveRight:function(o,a){return this._move(o,a,"Right")},moveCursorLeftWithoutShift:function(o){var a=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(a=this._moveLeft(o,"selectionStart")),this.selectionEnd=this.selectionStart,a},moveCursorLeftWithShift:function(o){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(o,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(o,"selectionStart")},moveCursorRight:function(o){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",o)},_moveCursorLeftOrRight:function(o,a){var c="moveCursor"+o+"With";this._currentCursorOpacity=1,a.shiftKey?c+="Shift":c+="outShift",this[c](a)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(o){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(o,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(o,"selectionEnd")},moveCursorRightWithoutShift:function(o){var a=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(a=this._moveRight(o,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,a},removeChars:function(o,a){typeof a>"u"&&(a=o+1),this.removeStyleFromTo(o,a),this._text.splice(o,a-o),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(o,a,c,d){typeof d>"u"&&(d=c),d>c&&this.removeStyleFromTo(c,d);var f=t.util.string.graphemeSplit(o);this.insertNewStyleBlock(f,c,a),this._text=[].concat(this._text.slice(0,c),f,this._text.slice(d)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var o=t.util.toFixed,a=t.util.radiansToDegrees,c=t.util.calcRotateMatrix,d=t.util.transformPoint,f=/  +/g;t.util.object.extend(t.Text.prototype,{_toSVG:function(){var h=this._getSVGLeftTopOffsets(),u=this._getSVGTextAndBg(h.textTop,h.textLeft);return this._wrapSVGTextAndBg(u)},toSVG:function(h){var u=this._createBaseSVGMarkup(this._toSVG(),{reviver:h,noStyle:!0,withShadow:!0}),g=this.path;return g?u+g._createBaseSVGMarkup(g._toSVG(),{reviver:h,withShadow:!0}):u},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(h){var u=!0,g=this.getSvgTextDecoration(this);return[h.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",g?'text-decoration="'+g+'" ':"",'style="',this.getSvgStyles(u),'"',this.addPaintOrder()," >",h.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(h,u){var g=[],m=[],p=h,x;this._setSVGBg(m);for(var v=0,y=this._textLines.length;v<y;v++)x=this._getLineLeftOffset(v),(this.textBackgroundColor||this.styleHas("textBackgroundColor",v))&&this._setSVGTextLineBg(m,v,u+x,p),this._setSVGTextLineText(g,v,u+x,p),p+=this.getHeightOfLine(v);return{textSpans:g,textBgRects:m}},_createTextCharSpan:function(h,u,g,m,p){var x=h!==h.trim()||h.match(f),v=this.getSvgSpanStyles(u,x),y=v?'style="'+v+'"':"",_=u.deltaY,b="",S=t.Object.NUM_FRACTION_DIGITS,C="";if(_&&(b=' dy="'+o(_,S)+'" '),p.renderLeft!==void 0){var N=p.angle;C=' rotate="'+o(a(N),t.Object.NUM_FRACTION_DIGITS)+'" ';var F=p.width/2,Y=c({angle:a(N)});Y[4]=p.renderLeft,Y[5]=p.renderTop;var X=d({x:-F,y:0},Y);g=X.x,m=X.y}return['<tspan x="',o(g,S),'" y="',o(m,S),'" ',b,y,C,">",t.util.string.escapeXml(h),"</tspan>"].join("")},_setSVGTextLineText:function(h,u,g,m){var p=this.getHeightOfLine(u),x=this.textAlign.indexOf("justify")!==-1,v,y,_="",b,S,C=0,N=this._textLines[u],F;m+=p*(1-this._fontSizeFraction)/this.lineHeight;for(var Y=0,X=N.length-1;Y<=X;Y++)F=Y===X||this.charSpacing||this.path,_+=N[Y],b=this.__charBounds[u][Y],C===0?(g+=b.kernedWidth-b.width,C+=b.width):C+=b.kernedWidth,x&&!F&&this._reSpaceAndTab.test(N[Y])&&(F=!0),F||(v=v||this.getCompleteStyleDeclaration(u,Y),y=this.getCompleteStyleDeclaration(u,Y+1),F=t.util.hasStyleChanged(v,y,!0)),F&&(S=this._getStyleDeclaration(u,Y)||{},h.push(this._createTextCharSpan(_,S,g,m,b)),_="",v=y,g+=C,C=0)},_pushTextBgRect:function(h,u,g,m,p,x){var v=t.Object.NUM_FRACTION_DIGITS;h.push("		<rect ",this._getFillAttributes(u),' x="',o(g,v),'" y="',o(m,v),'" width="',o(p,v),'" height="',o(x,v),`"></rect>
`)},_setSVGTextLineBg:function(h,u,g,m){for(var p=this._textLines[u],x=this.getHeightOfLine(u)/this.lineHeight,v=0,y=0,_,b,S=this.getValueOfPropertyAt(u,0,"textBackgroundColor"),C=0,N=p.length;C<N;C++)_=this.__charBounds[u][C],b=this.getValueOfPropertyAt(u,C,"textBackgroundColor"),b!==S?(S&&this._pushTextBgRect(h,S,g+y,m,v,x),y=_.left,v=_.width,S=b):v+=_.kernedWidth;b&&this._pushTextBgRect(h,b,g+y,m,v,x)},_getFillAttributes:function(h){var u=h&&typeof h=="string"?new t.Color(h):"";return!u||!u.getSource()||u.getAlpha()===1?'fill="'+h+'"':'opacity="'+u.getAlpha()+'" fill="'+u.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(h){for(var u=0,g=0,m=0;m<h;m++)u+=this.getHeightOfLine(m);return g=this.getHeightOfLine(m),{lineTop:u,offset:(this._fontSizeMult-this._fontSizeFraction)*g/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(h){var u=t.Object.prototype.getSvgStyles.call(this,h);return u+" white-space: pre;"}})}(),function(o){var a=o.fabric||(o.fabric={});a.Textbox=a.util.createClass(a.IText,a.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:a.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(c){for(var d=0,f=0,h=0,u={},g=0;g<c.graphemeLines.length;g++)c.graphemeText[h]===`
`&&g>0?(f=0,h++,d++):!this.splitByGrapheme&&this._reSpaceAndTab.test(c.graphemeText[h])&&g>0&&(f++,h++),u[g]={line:d,offset:f},h+=c.graphemeLines[g].length,f+=c.graphemeLines[g].length;return u},styleHas:function(c,d){if(this._styleMap&&!this.isWrapping){var f=this._styleMap[d];f&&(d=f.line)}return a.Text.prototype.styleHas.call(this,c,d)},isEmptyStyles:function(c){if(!this.styles)return!0;var d=0,f=c+1,h,u,g=!1,m=this._styleMap[c],p=this._styleMap[c+1];m&&(c=m.line,d=m.offset),p&&(f=p.line,g=f===c,h=p.offset),u=typeof c>"u"?this.styles:{line:this.styles[c]};for(var x in u)for(var v in u[x])if(v>=d&&(!g||v<h))for(var y in u[x][v])return!1;return!0},_getStyleDeclaration:function(c,d){if(this._styleMap&&!this.isWrapping){var f=this._styleMap[c];if(!f)return null;c=f.line,d=f.offset+d}return this.callSuper("_getStyleDeclaration",c,d)},_setStyleDeclaration:function(c,d,f){var h=this._styleMap[c];c=h.line,d=h.offset+d,this.styles[c][d]=f},_deleteStyleDeclaration:function(c,d){var f=this._styleMap[c];c=f.line,d=f.offset+d,delete this.styles[c][d]},_getLineStyle:function(c){var d=this._styleMap[c];return!!this.styles[d.line]},_setLineStyle:function(c){var d=this._styleMap[c];this.styles[d.line]={}},_wrapText:function(c,d){var f=[],h;for(this.isWrapping=!0,h=0;h<c.length;h++)f=f.concat(this._wrapLine(c[h],h,d));return this.isWrapping=!1,f},_measureWord:function(c,d,f){var h=0,u,g=!0;f=f||0;for(var m=0,p=c.length;m<p;m++){var x=this._getGraphemeBox(c[m],d,m+f,u,g);h+=x.kernedWidth,u=c[m]}return h},_wrapLine:function(c,d,f,Y){var u=0,g=this.splitByGrapheme,m=[],p=[],x=g?a.util.string.graphemeSplit(c):c.split(this._wordJoiners),v="",y=0,_=g?"":" ",b=0,S=0,C=0,N=!0,F=this._getWidthOfCharSpacing(),Y=Y||0;x.length===0&&x.push([]),f-=Y;for(var X=0;X<x.length;X++)v=g?x[X]:a.util.string.graphemeSplit(x[X]),b=this._measureWord(v,d,y),y+=v.length,u+=S+b-F,u>f&&!N?(m.push(p),p=[],u=b,N=!0):u+=F,!N&&!g&&p.push(_),p=p.concat(v),S=g?0:this._measureWord([_],d,y),y++,N=!1,b>C&&(C=b);return X&&m.push(p),C+Y>this.dynamicMinWidth&&(this.dynamicMinWidth=C-F+Y),m},isEndOfWrapping:function(c){return!this._styleMap[c+1]||this._styleMap[c+1].line!==this._styleMap[c].line},missingNewlineOffset:function(c,d){return this.splitByGrapheme&&!d?this.isEndOfWrapping(c)?1:0:1},_splitTextIntoLines:function(c){for(var d=a.Text.prototype._splitTextIntoLines.call(this,c),f=this._wrapText(d.lines,this.width),h=new Array(f.length),u=0;u<f.length;u++)h[u]=f[u].join("");return d.lines=h,d.graphemeLines=f,d},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var c={};for(var d in this._styleMap)this._textLines[d]&&(c[this._styleMap[d].line]=1);for(var d in this.styles)c[d]||delete this.styles[d]},toObject:function(c){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(c))}}),a.Textbox.fromObject=function(c,d){var f=a.util.stylesFromArray(c.styles,c.text),h=Object.assign({},c,{styles:f});return delete h.path,a.Object._fromObject("Textbox",h,function(u){c.path?a.Object._fromObject("Path",c.path,function(g){u.set("path",g),d(u)},"path"):d(u)},"text")}}(e),function(){var o=t.controlsUtils,a=o.scaleSkewCursorStyleHandler,c=o.scaleCursorStyleHandler,d=o.scalingEqually,f=o.scalingYOrSkewingX,h=o.scalingXOrSkewingY,u=o.scaleOrSkewActionName,g=t.Object.prototype.controls;if(g.ml=new t.Control({x:-.5,y:0,cursorStyleHandler:a,actionHandler:h,getActionName:u}),g.mr=new t.Control({x:.5,y:0,cursorStyleHandler:a,actionHandler:h,getActionName:u}),g.mb=new t.Control({x:0,y:.5,cursorStyleHandler:a,actionHandler:f,getActionName:u}),g.mt=new t.Control({x:0,y:-.5,cursorStyleHandler:a,actionHandler:f,getActionName:u}),g.tl=new t.Control({x:-.5,y:-.5,cursorStyleHandler:c,actionHandler:d}),g.tr=new t.Control({x:.5,y:-.5,cursorStyleHandler:c,actionHandler:d}),g.bl=new t.Control({x:-.5,y:.5,cursorStyleHandler:c,actionHandler:d}),g.br=new t.Control({x:.5,y:.5,cursorStyleHandler:c,actionHandler:d}),g.mtr=new t.Control({x:0,y:-.5,actionHandler:o.rotationWithSnapping,cursorStyleHandler:o.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),t.Textbox){var m=t.Textbox.prototype.controls={};m.mtr=g.mtr,m.tr=g.tr,m.br=g.br,m.tl=g.tl,m.bl=g.bl,m.mt=g.mt,m.mb=g.mb,m.mr=new t.Control({x:.5,y:0,actionHandler:o.changeWidth,cursorStyleHandler:a,actionName:"resizing"}),m.ml=new t.Control({x:-.5,y:0,actionHandler:o.changeWidth,cursorStyleHandler:a,actionName:"resizing"})}}()})(Ve);function Yu(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Fk(e,t,r,n){function i(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function o(d){try{c(n.next(d))}catch(f){l(f)}}function a(d){try{c(n.throw(d))}catch(f){l(f)}}function c(d){d.done?s(d.value):i(d.value).then(o,a)}c((n=n.apply(e,t||[])).next())})}const Pk=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class k0 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Dk extends k0{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Np extends k0{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Fp extends k0{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var id;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(id||(id={}));class jk{constructor(t,{headers:r={},customFetch:n,region:i=id.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=Pk(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Fk(this,arguments,void 0,function*(r,n={}){var i;let s,l;try{const{headers:o,method:a,body:c,signal:d,timeout:f}=n;let h={},{region:u}=n;u||(u=this.region);const g=new URL(`${this.url}/${r}`);u&&u!=="any"&&(h["x-region"]=u,g.searchParams.set("forceFunctionRegion",u));let m;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",m=c):typeof c=="string"?(h["Content-Type"]="text/plain",m=c):typeof FormData<"u"&&c instanceof FormData?m=c:(h["Content-Type"]="application/json",m=JSON.stringify(c)):c&&typeof c!="string"&&!(typeof Blob<"u"&&c instanceof Blob)&&!(c instanceof ArrayBuffer)&&!(typeof FormData<"u"&&c instanceof FormData)?m=JSON.stringify(c):m=c;let p=d;f&&(l=new AbortController,s=setTimeout(()=>l.abort(),f),d?(p=l.signal,d.addEventListener("abort",()=>l.abort())):p=l.signal);const x=yield this.fetch(g.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),o),body:m,signal:p}).catch(b=>{throw new Dk(b)}),v=x.headers.get("x-relay-error");if(v&&v==="true")throw new Np(x);if(!x.ok)throw new Fp(x);let y=((i=x.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),_;return y==="application/json"?_=yield x.json():y==="application/octet-stream"||y==="application/pdf"?_=yield x.blob():y==="text/event-stream"?_=x:y==="multipart/form-data"?_=yield x.formData():_=yield x.text(),{data:_,error:null,response:x}}catch(o){return{data:null,error:o,response:o instanceof Fp||o instanceof Np?o.context:void 0}}finally{s&&clearTimeout(s)}})}}var Rk=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},Ik=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{let l=null,o=null,a=null,c=s.status,d=s.statusText;if(s.ok){var f,h;if(r.method!=="HEAD"){var u;const x=await s.text();x===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((u=r.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?o=x:o=JSON.parse(x))}const m=(f=r.headers.get("Prefer"))===null||f===void 0?void 0:f.match(/count=(exact|planned|estimated)/),p=(h=s.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");m&&p&&p.length>1&&(a=parseInt(p[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(o)&&(o.length>1?(l={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,a=null,c=406,d="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var g;const m=await s.text();try{l=JSON.parse(m),Array.isArray(l)&&s.status===404&&(o=[],l=null,c=200,d="OK")}catch{s.status===404&&m===""?(c=204,d="No Content"):l={message:m}}if(l&&r.isMaybeSingle&&(!(l==null||(g=l.details)===null||g===void 0)&&g.includes("0 rows"))&&(l=null,c=200,d="OK"),l&&r.shouldThrowOnError)throw new Rk(l)}return{error:l,data:o,count:a,status:c,statusText:d}});return this.shouldThrowOnError||(i=i.catch(s=>{var l;let o="";const a=s==null?void 0:s.cause;if(a){var c,d,f,h;const g=(c=a==null?void 0:a.message)!==null&&c!==void 0?c:"",m=(d=a==null?void 0:a.code)!==null&&d!==void 0?d:"";o=`${(f=s==null?void 0:s.name)!==null&&f!==void 0?f:"FetchError"}: ${s==null?void 0:s.message}`,o+=`

Caused by: ${(h=a==null?void 0:a.name)!==null&&h!==void 0?h:"Error"}: ${g}`,m&&(o+=` (${m})`),a!=null&&a.stack&&(o+=`
${a.stack}`)}else{var u;o=(u=s==null?void 0:s.stack)!==null&&u!==void 0?u:""}return{error:{message:`${(l=s==null?void 0:s.name)!==null&&l!==void 0?l:"FetchError"}: ${s==null?void 0:s.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}},Mk=class extends Ik{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const s=i?`${i}.order`:"order",l=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"offset":`${n}.offset`,s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(s,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:s="text"}={}){var l;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),a=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${s}; for="${a}"; options=${o};`),s==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const Pp=new RegExp("[,()]");var Js=class extends Mk{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Pp.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Pp.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const s=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${s}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},Lk=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:n}=t??{},i=r?"HEAD":"GET";let s=!1;const l=(e??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join(""),{url:o,headers:a}=this.cloneRequestState();return o.searchParams.set("select",l),n&&a.append("Prefer",`count=${n}`),new Js({method:i,url:o,headers:a,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const i="POST",{url:s,headers:l}=this.cloneRequestState();if(t&&l.append("Prefer",`count=${t}`),r||l.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((a,c)=>a.concat(Object.keys(c)),[]);if(o.length>0){const a=[...new Set(o)].map(c=>`"${c}"`);s.searchParams.set("columns",a.join(","))}}return new Js({method:i,url:s,headers:l,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){var s;const l="POST",{url:o,headers:a}=this.cloneRequestState();if(a.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&o.searchParams.set("on_conflict",t),n&&a.append("Prefer",`count=${n}`),i||a.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(c.length>0){const d=[...new Set(c)].map(f=>`"${f}"`);o.searchParams.set("columns",d.join(","))}}return new Js({method:l,url:o,headers:a,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}update(e,{count:t}={}){var r;const n="PATCH",{url:i,headers:s}=this.cloneRequestState();return t&&s.append("Prefer",`count=${t}`),new Js({method:n,url:i,headers:s,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:n,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new Js({method:r,url:n,headers:i,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},Bk=class N1{constructor(t,{headers:r={},schema:n,fetch:i}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=i}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new Lk(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new N1(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:i=!1,count:s}={}){var l;let o;const a=new URL(`${this.url}/rpc/${t}`);let c;const d=u=>u!==null&&typeof u=="object"&&(!Array.isArray(u)||u.some(d)),f=n&&Object.values(r).some(d);f?(o="POST",c=r):n||i?(o=n?"HEAD":"GET",Object.entries(r).filter(([u,g])=>g!==void 0).map(([u,g])=>[u,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([u,g])=>{a.searchParams.append(u,g)})):(o="POST",c=r);const h=new Headers(this.headers);return f?h.set("Prefer",s?`count=${s},return=minimal`:"return=minimal"):s&&h.set("Prefer",`count=${s}`),new Js({method:o,url:a,headers:h,schema:this.schemaName,body:c,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}};class Uk{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const n=r.versions;if(n&&n.node){const i=n.node,s=parseInt(i.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const Wk="2.93.1",zk=`realtime-js/${Wk}`,Hk="1.0.0",F1="2.0.0",Dp=F1,sd=1e4,Vk=1e3,$k=100;var vi;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(vi||(vi={}));var Xt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Xt||(Xt={}));var yn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(yn||(yn={}));var ad;(function(e){e.websocket="websocket"})(ad||(ad={}));var is;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(is||(is={}));class Xk{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},l=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(t,r,n){var i,s;const l=t.topic,o=(i=t.ref)!==null&&i!==void 0?i:"",a=(s=t.join_ref)!==null&&s!==void 0?s:"",c=t.payload.event,d=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},f=Object.keys(d).length===0?"":JSON.stringify(d);if(a.length>255)throw new Error(`joinRef length ${a.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`metadata length ${f.length} exceeds maximum of 255`);const h=this.USER_BROADCAST_PUSH_META_LENGTH+a.length+o.length+l.length+c.length+f.length,u=new ArrayBuffer(this.HEADER_LENGTH+h);let g=new DataView(u),m=0;g.setUint8(m++,this.KINDS.userBroadcastPush),g.setUint8(m++,a.length),g.setUint8(m++,o.length),g.setUint8(m++,l.length),g.setUint8(m++,c.length),g.setUint8(m++,f.length),g.setUint8(m++,r),Array.from(a,x=>g.setUint8(m++,x.charCodeAt(0))),Array.from(o,x=>g.setUint8(m++,x.charCodeAt(0))),Array.from(l,x=>g.setUint8(m++,x.charCodeAt(0))),Array.from(c,x=>g.setUint8(m++,x.charCodeAt(0))),Array.from(f,x=>g.setUint8(m++,x.charCodeAt(0)));var p=new Uint8Array(u.byteLength+n.byteLength);return p.set(new Uint8Array(u),0),p.set(new Uint8Array(n),u.byteLength),p.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[i,s,l,o,a]=n;return r({join_ref:i,ref:s,topic:l,event:o,payload:a})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,i)}}_decodeUserBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2),l=r.getUint8(3),o=r.getUint8(4);let a=this.HEADER_LENGTH+4;const c=n.decode(t.slice(a,a+i));a=a+i;const d=n.decode(t.slice(a,a+s));a=a+s;const f=n.decode(t.slice(a,a+l));a=a+l;const h=t.slice(a,t.byteLength),u=o===this.JSON_ENCODING?JSON.parse(n.decode(h)):h,g={type:this.BROADCAST_EVENT,event:d,payload:u};return l>0&&(g.meta=JSON.parse(f)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:g}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class P1{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var pt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(pt||(pt={}));const jp=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((s,l)=>(s[l]=Yk(l,e,t,i),s),{}):{}},Yk=(e,t,r,n)=>{const i=t.find(o=>o.name===e),s=i==null?void 0:i.type,l=r[e];return s&&!n.includes(s)?D1(s,l):od(l)},D1=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Jk(t,r)}switch(e){case pt.bool:return Gk(t);case pt.float4:case pt.float8:case pt.int2:case pt.int4:case pt.int8:case pt.numeric:case pt.oid:return qk(t);case pt.json:case pt.jsonb:return Kk(t);case pt.timestamp:return Qk(t);case pt.abstime:case pt.date:case pt.daterange:case pt.int4range:case pt.int8range:case pt.money:case pt.reltime:case pt.text:case pt.time:case pt.timestamptz:case pt.timetz:case pt.tsrange:case pt.tstzrange:return od(t);default:return od(t)}},od=e=>e,Gk=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},qk=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Kk=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},Jk=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const l=e.slice(1,r);try{s=JSON.parse("["+l+"]")}catch{s=l?l.split(","):[]}return s.map(o=>D1(t,o))}return e},Qk=e=>typeof e=="string"?e.replace(" ","T"):e,j1=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Uf{constructor(t,r,n={},i=sd){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Rp;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Rp||(Rp={}));class Eo{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:l,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Eo.syncState(this.state,i,s,l),this.pendingDiffs.forEach(a=>{this.state=Eo.syncDiff(this.state,a,s,l)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:l,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Eo.syncDiff(this.state,i,s,l),o())}),this.onJoin((i,s,l)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:l})}),this.onLeave((i,s,l)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const s=this.cloneDeep(t),l=this.transformState(r),o={},a={};return this.map(s,(c,d)=>{l[c]||(a[c]=d)}),this.map(l,(c,d)=>{const f=s[c];if(f){const h=d.map(p=>p.presence_ref),u=f.map(p=>p.presence_ref),g=d.filter(p=>u.indexOf(p.presence_ref)<0),m=f.filter(p=>h.indexOf(p.presence_ref)<0);g.length>0&&(o[c]=g),m.length>0&&(a[c]=m)}else o[c]=d}),this.syncDiff(s,{joins:o,leaves:a},n,i)}static syncDiff(t,r,n,i){const{joins:s,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(o,a)=>{var c;const d=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(a),d.length>0){const f=t[o].map(u=>u.presence_ref),h=d.filter(u=>f.indexOf(u.presence_ref)<0);t[o].unshift(...h)}n(o,d,a)}),this.map(l,(o,a)=>{let c=t[o];if(!c)return;const d=a.map(f=>f.presence_ref);c=c.filter(f=>d.indexOf(f.presence_ref)<0),t[o]=c,i(o,c,a),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ip;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Ip||(Ip={}));var Ao;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Ao||(Ao={}));var $n;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})($n||($n={}));class da{constructor(t,r={config:{}},n){var i,s;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Xt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Uf(this,yn.join,this.params,this.timeout),this.rejoinTimer=new P1(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Xt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Xt.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Xt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Xt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Xt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(yn.reply,{},(l,o)=>{this._trigger(this._replyEventName(o),l)}),this.presence=new Eo(this),this.broadcastEndpointURL=j1(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Xt.closed){const{config:{broadcast:l,presence:o,private:a}}=this.params,c=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&i!==void 0?i:[],d=!!this.bindings[Ao.PRESENCE]&&this.bindings[Ao.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,f={},h={broadcast:l,presence:Object.assign(Object.assign({},o),{enabled:d}),postgres_changes:c,private:a};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(u=>t==null?void 0:t($n.CHANNEL_ERROR,u)),this._onClose(()=>t==null?void 0:t($n.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var g;if(this.socket._isManualToken()||this.socket.setAuth(),u===void 0){t==null||t($n.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,p=(g=m==null?void 0:m.length)!==null&&g!==void 0?g:0,x=[];for(let v=0;v<p;v++){const y=m[v],{filter:{event:_,schema:b,table:S,filter:C}}=y,N=u&&u[v];if(N&&N.event===_&&da.isFilterValueEqual(N.schema,b)&&da.isFilterValueEqual(N.table,S)&&da.isFilterValueEqual(N.filter,C))x.push(Object.assign(Object.assign({},y),{id:N.id}));else{this.unsubscribe(),this.state=Xt.errored,t==null||t($n.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t($n.SUBSCRIBED);return}}).receive("error",u=>{this.state=Xt.errored,t==null||t($n.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t==null||t($n.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Xt.joined&&t===Ao.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var i;if(r==null)return Promise.reject("Payload is required for httpSend()");const s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(o.status===202)return{success:!0};let a=o.statusText;try{const c=await o.json();a=c.error||c.message||a}catch{}return Promise.reject(new Error(a))}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:l}=t,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:l,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var l,o,a;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((a=(o=(l=this.params)===null||l===void 0?void 0:l.config)===null||o===void 0?void 0:o.broadcast)===null||a===void 0)&&a.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Xt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(yn.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Uf(this,yn.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Xt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),l}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Uf(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>$k){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,s;const l=t.toLocaleLowerCase(),{close:o,error:a,leave:c,join:d}=yn;if(n&&[o,a,c,d].indexOf(l)>=0&&n!==this._joinRef())return;let h=this._onMessage(l,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(u=>{var g,m,p;return((g=u.filter)===null||g===void 0?void 0:g.event)==="*"||((p=(m=u.filter)===null||m===void 0?void 0:m.event)===null||p===void 0?void 0:p.toLocaleLowerCase())===l}).map(u=>u.callback(h,n)):(s=this.bindings[l])===null||s===void 0||s.filter(u=>{var g,m,p,x,v,y;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in u){const _=u.id,b=(g=u.filter)===null||g===void 0?void 0:g.event;return _&&((m=r.ids)===null||m===void 0?void 0:m.includes(_))&&(b==="*"||(b==null?void 0:b.toLocaleLowerCase())===((p=r.data)===null||p===void 0?void 0:p.type.toLocaleLowerCase()))}else{const _=(v=(x=u==null?void 0:u.filter)===null||x===void 0?void 0:x.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return _==="*"||_===((y=r==null?void 0:r.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return u.type.toLocaleLowerCase()===l}).map(u=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:m,table:p,commit_timestamp:x,type:v,errors:y}=g;h=Object.assign(Object.assign({},{schema:m,table:p,commit_timestamp:x,eventType:v,new:{},old:{},errors:y}),this._getPayloadRecords(g))}u.callback(h,n)})}_isClosed(){return this.state===Xt.closed}_isJoined(){return this.state===Xt.joined}_isJoining(){return this.state===Xt.joining}_isLeaving(){return this.state===Xt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&da.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(yn.close,{},t)}_onError(t){this._on(yn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Xt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=jp(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=jp(t.columns,t.old_record)),r}}const Wf=()=>{},oc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Zk=[1e3,2e3,5e3,1e4],eC=1e4,tC=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class rC{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=sd,this.transport=null,this.heartbeatIntervalMs=oc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Wf,this.ref=0,this.reconnectTimer=null,this.vsn=Dp,this.logger=Wf,this.conn=null,this.sendBuffer=[],this.serializer=new Xk,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=i=>i?(...s)=>i(...s):(...s)=>fetch(...s),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${ad.websocket}`,this.httpEndpoint=j1(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Uk.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case vi.connecting:return is.Connecting;case vi.open:return is.Open;case vi.closing:return is.Closing;default:return is.Closed}}isConnected(){return this.connectionState()===is.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new da(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:i,ref:s}=t,l=()=>{this.encode(t,o=>{var a;(a=this.conn)===null||a===void 0||a.send(o)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(Vk,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},oc.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const c=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",c)}catch(d){this.log("error","error in heartbeat callback",d)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:i,payload:s,ref:l}=r,o=l?`(${l})`:"",a=s.status||"";this.log("receive",`${a} ${n} ${i} ${o}`.trim(),s),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(i,s,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===vi.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===vi.open||this.conn.readyState===vi.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t);try{this.heartbeatCallback("error")}catch(r){this.log("error","error in heartbeat callback",r)}}_triggerChanError(){this.channels.forEach(t=>t._trigger(yn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([tC],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(i=>{const s={access_token:r,version:zk};r&&i.updateJoinPayload(s),i.joinedOnce&&i._isJoined()&&i._push(yn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new P1(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},oc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,s,l,o,a,c,d,f,h,u;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:sd,this.heartbeatIntervalMs=(i=t==null?void 0:t.heartbeatIntervalMs)!==null&&i!==void 0?i:oc.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(l=t==null?void 0:t.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:Wf,this.vsn=(a=t==null?void 0:t.vsn)!==null&&a!==void 0?a:Dp,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:g=>Zk[g-1]||eC,this.vsn){case Hk:this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(g,m)=>m(JSON.stringify(g)),this.decode=(f=t==null?void 0:t.decode)!==null&&f!==void 0?f:(g,m)=>m(JSON.parse(g));break;case F1:this.encode=(h=t==null?void 0:t.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var rl=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function nC(e,t,r){const n=new URL(t,e);if(r)for(const[i,s]of Object.entries(r))s!==void 0&&n.searchParams.set(i,s);return n.toString()}async function iC(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function sC(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:i,body:s,headers:l}){const o=nC(e.baseUrl,n,i),a=await iC(e.auth),c=await t(o,{method:r,headers:{...s?{"Content-Type":"application/json"}:{},...a,...l},body:s?JSON.stringify(s):void 0}),d=await c.text(),f=(c.headers.get("content-type")||"").includes("application/json"),h=f&&d?JSON.parse(d):d;if(!c.ok){const u=f?h:void 0,g=u==null?void 0:u.error;throw new rl((g==null?void 0:g.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:g==null?void 0:g.type,icebergCode:g==null?void 0:g.code,details:u})}return{status:c.status,headers:c.headers,data:h}}}}function lc(e){return e.join("")}var aC=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:lc(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${lc(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${lc(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${lc(e.namespace)}`}),!0}catch(t){if(t instanceof rl&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof rl&&r.status===409)return;throw r}}};function Ws(e){return e.join("")}var oC=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ws(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ws(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ws(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ws(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ws(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ws(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof rl&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof rl&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},lC=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=sC({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new aC(this.client,t),this.tableOps=new oC(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},Gu=class extends Error{constructor(e,t="storage",r,n){super(e),this.__isStorageError=!0,this.namespace=t,this.name=t==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=n}};function qu(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var cc=class extends Gu{constructor(e,t,r,n="storage"){super(e,n,t,r),this.name=n==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},R1=class extends Gu{constructor(e,t,r="storage"){super(e,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const cC=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),uC=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},ld=e=>{if(Array.isArray(e))return e.map(r=>ld(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=ld(n)}),t},fC=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function nl(e){"@babel/helpers - typeof";return nl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nl(e)}function hC(e,t){if(nl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(nl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dC(e){var t=hC(e,"string");return nl(t)=="symbol"?t:t+""}function gC(e,t,r){return(t=dC(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function He(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Mp(Object(r),!0).forEach(function(n){gC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mp(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const Lp=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},pC=async(e,t,r,n)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const i=e,s=i.status||500;if(typeof i.json=="function")i.json().then(l=>{const o=(l==null?void 0:l.statusCode)||(l==null?void 0:l.code)||s+"";t(new cc(Lp(l),s,o,n))}).catch(()=>{if(n==="vectors"){const l=s+"";t(new cc(i.statusText||`HTTP ${s} error`,s,l,n))}else{const l=s+"";t(new cc(i.statusText||`HTTP ${s} error`,s,l,n))}});else{const l=s+"";t(new cc(i.statusText||`HTTP ${s} error`,s,l,n))}}else t(new R1(Lp(e),e,n))},mC=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||e==="HEAD"||!n?He(He({},i),r):(uC(n)?(i.headers=He({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,t!=null&&t.duplex&&(i.duplex=t.duplex),He(He({},i),r))};async function ao(e,t,r,n,i,s,l){return new Promise((o,a)=>{e(r,mC(t,n,i,s)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;if(l==="vectors"){const d=c.headers.get("content-type");if(!d||!d.includes("application/json"))return{}}return c.json()}).then(c=>o(c)).catch(c=>pC(c,a,n,l))})}function xC(e="storage"){return{get:async(t,r,n,i)=>ao(t,"GET",r,n,i,void 0,e),post:async(t,r,n,i,s)=>ao(t,"POST",r,i,s,n,e),put:async(t,r,n,i,s)=>ao(t,"PUT",r,i,s,n,e),head:async(t,r,n,i)=>ao(t,"HEAD",r,He(He({},n),{},{noResolveJson:!0}),i,void 0,e),remove:async(t,r,n,i,s)=>ao(t,"DELETE",r,i,s,n,e)}}const vC=xC("storage"),{get:il,post:bt,put:cd,head:yC,remove:C0}=vC;var Va=class{constructor(e,t={},r,n="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=cC(r),this.namespace=n}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){var t=this;try{return{data:await e(),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(qu(r))return{data:null,error:r};throw r}}},wC=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(qu(t))return{data:null,error:t};throw t}}};let I1;I1=Symbol.toStringTag;var _C=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[I1]="BlobDownloadBuilder",this.promise=null}asStream(){return new wC(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(qu(t))return{data:null,error:t};throw t}}};const bC={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Bp={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var SC=class extends Va{constructor(e,t={},r,n){super(e,t,n,"storage"),this.bucketId=r}async uploadOrUpdate(e,t,r,n){var i=this;return i.handleOperation(async()=>{let s;const l=He(He({},Bp),n);let o=He(He({},i.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const a=l.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",l.cacheControl),a&&s.append("metadata",i.encodeMetadata(a)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.has("cacheControl")||s.append("cacheControl",l.cacheControl),a&&!s.has("metadata")&&s.append("metadata",i.encodeMetadata(a))):(s=r,o["cache-control"]=`max-age=${l.cacheControl}`,o["content-type"]=l.contentType,a&&(o["x-metadata"]=i.toBase64(i.encodeMetadata(a))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!l.duplex&&(l.duplex="half")),n!=null&&n.headers&&(o=He(He({},o),n.headers));const c=i._removeEmptyFolders(t),d=i._getFinalPath(c),f=await(e=="PUT"?cd:bt)(i.fetch,`${i.url}/object/${d}`,s,He({headers:o},l!=null&&l.duplex?{duplex:l.duplex}:{}));return{path:c,id:f.Id,fullPath:f.Key}})}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var i=this;const s=i._removeEmptyFolders(e),l=i._getFinalPath(s),o=new URL(i.url+`/object/upload/sign/${l}`);return o.searchParams.set("token",t),i.handleOperation(async()=>{let a;const c=He({upsert:Bp.upsert},n),d=He(He({},i.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",c.cacheControl),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.append("cacheControl",c.cacheControl)):(a=r,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType),{path:s,fullPath:(await cd(i.fetch,o.toString(),a,{headers:d})).Key}})}async createSignedUploadUrl(e,t){var r=this;return r.handleOperation(async()=>{let n=r._getFinalPath(e);const i=He({},r.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const s=await bt(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:i}),l=new URL(r.url+s.url),o=l.searchParams.get("token");if(!o)throw new Gu("No token returned by API");return{signedUrl:l.toString(),path:e,token:o}})}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;return n.handleOperation(async()=>await bt(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}))}async copy(e,t,r){var n=this;return n.handleOperation(async()=>({path:(await bt(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key}))}async createSignedUrl(e,t,r){var n=this;return n.handleOperation(async()=>{let i=n._getFinalPath(e),s=await bt(n.fetch,`${n.url}/object/sign/${i}`,He({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${n.url}${s.signedURL}${l}`)}})}async createSignedUrls(e,t,r){var n=this;return n.handleOperation(async()=>{const i=await bt(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i.map(l=>He(He({},l),{},{signedUrl:l.signedURL?encodeURI(`${n.url}${l.signedURL}${s}`):null}))})}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=n?`?${n}`:"",s=this._getFinalPath(e),l=()=>il(this.fetch,`${this.url}/${r}/${s}${i}`,{headers:this.headers,noResolveJson:!0});return new _C(l,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);return t.handleOperation(async()=>ld(await il(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})))}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await yC(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(qu(n)&&n instanceof R1){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const s=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&n.push(l);let o=n.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${r}${o}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await C0(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,r){var n=this;return n.handleOperation(async()=>{const i=He(He(He({},bC),t),{},{prefix:e||""});return await bt(n.fetch,`${n.url}/object/list/${n.bucketId}`,i,{headers:n.headers},r)})}async listV2(e,t){var r=this;return r.handleOperation(async()=>{const n=He({},e);return await bt(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const kC="2.93.1",Fl={"X-Client-Info":`storage-js/${kC}`};var CC=class extends Va{constructor(e,t={},r,n){const i=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase."));const s=i.href.replace(/\/$/,""),l=He(He({},Fl),t);super(s,l,r,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=t.listBucketOptionsToQueryString(e);return await il(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await il(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var r=this;return r.handleOperation(async()=>await bt(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async updateBucket(e,t){var r=this;return r.handleOperation(async()=>await cd(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await C0(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},TC=class extends Va{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=He(He({},Fl),t);super(n,i,r,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),i=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return await il(t.fetch,i,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await C0(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!fC(e))throw new Gu("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new lC({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(i,s){const l=i[s];return typeof l!="function"?l:async(...o)=>{try{return{data:await l.apply(i,o),error:null}}catch(a){if(n)throw a;return{data:null,error:a}}}}})}},EC=class extends Va{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=He(He({},Fl),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var r=this;return r.handleOperation(async()=>await bt(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var r=this;return r.handleOperation(async()=>await bt(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{})}},AC=class extends Va{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=He(He({},Fl),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},OC=class extends Va{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=He(He({},Fl),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await bt(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},NC=class extends OC{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new FC(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},FC=class extends EC{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,He(He({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,He(He({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new PC(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},PC=class extends AC{constructor(e,t,r,n,i){super(e,t,i),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,He(He({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,He(He({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,He(He({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,He(He({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,He(He({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},DC=class extends CC{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new SC(this.url,this.headers,e,this.fetch)}get vectors(){return new NC(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new TC(this.url+"/iceberg",this.headers,this.fetch)}};const M1="2.93.1",Qs=30*1e3,ud=3,zf=ud*Qs,jC="http://localhost:9999",RC="supabase.auth.token",IC={"X-Client-Info":`gotrue-js/${M1}`},fd="X-Supabase-Api-Version",L1={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},MC=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,LC=10*60*1e3;class sl extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Re(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class BC extends sl{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function UC(e){return Re(e)&&e.name==="AuthApiError"}class ss extends sl{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class li extends sl{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class Br extends li{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Hf(e){return Re(e)&&e.name==="AuthSessionMissingError"}class zs extends li{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class uc extends li{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class fc extends li{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function WC(e){return Re(e)&&e.name==="AuthImplicitGrantRedirectError"}class Up extends li{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class zC extends li{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class hd extends li{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Vf(e){return Re(e)&&e.name==="AuthRetryableFetchError"}class Wp extends li{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class dd extends li{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const hu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),zp=` 	
\r=`.split(""),HC=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<zp.length;t+=1)e[zp[t].charCodeAt(0)]=-2;for(let t=0;t<hu.length;t+=1)e[hu[t].charCodeAt(0)]=t;return e})();function Hp(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(hu[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(hu[n]),t.queuedBits-=6}}function B1(e,t,r){const n=HC[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Vp(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=l=>{XC(l,n,r)};for(let l=0;l<e.length;l+=1)B1(e.charCodeAt(l),i,s);return t.join("")}function VC(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function $C(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}VC(n,t)}}function XC(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Sa(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)B1(e.charCodeAt(i),r,n);return new Uint8Array(t)}function YC(e){const t=[];return $C(e,r=>t.push(r)),new Uint8Array(t)}function us(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>Hp(i,r,n)),Hp(null,r,n),t.join("")}function GC(e){return Math.round(Date.now()/1e3)+e}function qC(){return Symbol("auth-callback")}const nr=()=>typeof window<"u"&&typeof document<"u",Qi={tested:!1,writable:!1},U1=()=>{if(!nr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Qi.tested)return Qi.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Qi.tested=!0,Qi.writable=!0}catch{Qi.tested=!0,Qi.writable=!1}return Qi.writable};function KC(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const W1=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),JC=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Zs=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Zi=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},rr=async(e,t)=>{await e.removeItem(t)};class Ku{constructor(){this.promise=new Ku.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Ku.promiseConstructor=Promise;function hc(e){const t=e.split(".");if(t.length!==3)throw new dd("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!MC.test(t[n]))throw new dd("JWT not in base64url format");return{header:JSON.parse(Vp(t[0])),payload:JSON.parse(Vp(t[1])),signature:Sa(t[2]),raw:{header:t[0],payload:t[1]}}}async function QC(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function ZC(e,t){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const l=await e(s);if(!t(s,null,l)){n(l);return}}catch(l){if(!t(s,l)){i(l);return}}})()})}function eT(e){return("0"+e.toString(16)).substr(-2)}function tT(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,eT).join("")}async function rT(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function nT(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await rT(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Hs(e,t,r=!1){const n=tT();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Zs(e,`${t}-code-verifier`,i);const s=await nT(n);return[s,n===s?"plain":"s256"]}const iT=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function sT(e){const t=e.headers.get(fd);if(!t||!t.match(iT))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function aT(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function oT(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const lT=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Vs(e){if(!lT.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function $f(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function cT(e,t){return new Proxy(e,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,i)}})}function $p(e){return JSON.parse(JSON.stringify(e))}const rs=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),uT=[502,503,504];async function Xp(e){var t;if(!JC(e))throw new hd(rs(e),0);if(uT.includes(e.status))throw new hd(rs(e),e.status);let r;try{r=await e.json()}catch(s){throw new ss(rs(s),s)}let n;const i=sT(e);if(i&&i.getTime()>=L1["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Wp(rs(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Br}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0))throw new Wp(rs(r),e.status,r.weak_password.reasons);throw new BC(rs(r),e.status||500,n)}const fT=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function We(e,t,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[fd]||(s[fd]=L1["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const l=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(l.redirect_to=n.redirectTo);const o=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",a=await hT(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(a):{data:Object.assign({},a),error:null}}async function hT(e,t,r,n,i,s){const l=fT(t,n,i,s);let o;try{o=await e(r,Object.assign({},l))}catch(a){throw console.error(a),new hd(rs(a),0)}if(o.ok||await Xp(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(a){await Xp(a)}}function mn(e){var t;let r=null;pT(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=GC(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Yp(e){const t=mn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function _i(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function dT(e){return{data:e,error:null}}function gT(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,l=Yu(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},a=Object.assign({},l);return{data:{properties:o,user:a},error:null}}function Gp(e){return e}function pT(e){return e.access_token&&e.refresh_token&&e.expires_in}const Xf=["global","local","others"];class mT{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=W1(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Xf[0]){if(Xf.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Xf.join(", ")}`);try{return await We(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Re(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await We(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:_i})}catch(n){if(Re(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Yu(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await We(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:gT,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Re(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await We(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:_i})}catch(r){if(Re(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,s,l,o,a;try{const c={nextPage:null,lastPage:0,total:0},d=await We(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:Gp});if(d.error)throw d.error;const f=await d.json(),h=(l=d.headers.get("x-total-count"))!==null&&l!==void 0?l:0,u=(a=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&a!==void 0?a:[];return u.length>0&&(u.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),p=JSON.parse(g.split(";")[1].split("=")[1]);c[`${p}Page`]=m}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(Re(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){Vs(t);try{return await We(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:_i})}catch(r){if(Re(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Vs(t);try{return await We(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:_i})}catch(n){if(Re(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Vs(t);try{return await We(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:_i})}catch(n){if(Re(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Vs(t.userId);try{const{data:r,error:n}=await We(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(Re(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Vs(t.userId),Vs(t.id);try{return{data:await We(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Re(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,i,s,l,o,a;try{const c={nextPage:null,lastPage:0,total:0},d=await We(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:Gp});if(d.error)throw d.error;const f=await d.json(),h=(l=d.headers.get("x-total-count"))!==null&&l!==void 0?l:0,u=(a=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&a!==void 0?a:[];return u.length>0&&(u.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),p=JSON.parse(g.split(";")[1].split("=")[1]);c[`${p}Page`]=m}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(Re(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(t){try{return await We(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Re(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await We(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Re(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await We(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await We(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Re(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await We(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Re(r))return{data:null,error:r};throw r}}}function qp(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const $s={debug:!!(globalThis&&U1()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class z1 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class xT extends z1{}async function vT(e,t,r){$s.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),$s.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){$s.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{$s.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw $s.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new xT(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if($s.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function yT(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function H1(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function wT(e){return parseInt(e,16)}function _T(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function bT(e){var t;const{chainId:r,domain:n,expirationTime:i,issuedAt:s=new Date,nonce:l,notBefore:o,requestId:a,resources:c,scheme:d,uri:f,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const u=H1(e.address),g=d?`${d}://${n}`:n,m=e.statement?`${e.statement}
`:"",p=`${g} wants you to sign in with your Ethereum account:
${u}

${m}`;let x=`URI: ${f}
Version: ${h}
Chain ID: ${r}${l?`
Nonce: ${l}`:""}
Issued At: ${s.toISOString()}`;if(i&&(x+=`
Expiration Time: ${i.toISOString()}`),o&&(x+=`
Not Before: ${o.toISOString()}`),a&&(x+=`
Request ID: ${a}`),c){let v=`
Resources:`;for(const y of c){if(!y||typeof y!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${y}`);v+=`
- ${y}`}x+=v}return`${p}
${x}`}class Vt extends Error{constructor({message:t,code:r,cause:n,name:i}){var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=i??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class du extends Vt{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function ST({error:e,options:t}){var r,n,i;const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Vt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Vt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Vt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=s.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Vt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Vt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Vt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new Vt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Vt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const l=window.location.hostname;if(V1(l)){if(s.rp.id!==l)return new Vt({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Vt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new Vt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Vt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Vt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function kT({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Vt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Vt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(V1(n)){if(r.rpId!==n)return new Vt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Vt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Vt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Vt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class CT{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const TT=new CT;function ET(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,i=Yu(e,["challenge","user","excludeCredentials"]),s=Sa(t).buffer,l=Object.assign(Object.assign({},r),{id:Sa(r.id).buffer}),o=Object.assign(Object.assign({},i),{challenge:s,user:l});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let a=0;a<n.length;a++){const c=n[a];o.excludeCredentials[a]=Object.assign(Object.assign({},c),{id:Sa(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function AT(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Yu(e,["challenge","allowCredentials"]),i=Sa(t).buffer,s=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const o=r[l];s.allowCredentials[l]=Object.assign(Object.assign({},o),{id:Sa(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return s}function OT(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:us(new Uint8Array(e.response.attestationObject)),clientDataJSON:us(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function NT(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:us(new Uint8Array(i.authenticatorData)),clientDataJSON:us(new Uint8Array(i.clientDataJSON)),signature:us(new Uint8Array(i.signature)),userHandle:i.userHandle?us(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function V1(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function Kp(){var e,t;return!!(nr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function FT(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new du("Browser returned unexpected credential type",t)}:{data:null,error:new du("Empty credential response",t)}}catch(t){return{data:null,error:ST({error:t,options:e})}}}async function PT(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new du("Browser returned unexpected credential type",t)}:{data:null,error:new du("Empty credential response",t)}}catch(t){return{data:null,error:kT({error:t,options:e})}}}const DT={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},jT={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function gu(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of e)if(i)for(const s in i){const l=i[s];if(l!==void 0)if(Array.isArray(l))n[s]=l;else if(r(l))n[s]=l;else if(t(l)){const o=n[s];t(o)?n[s]=gu(o,l):n[s]=gu(l)}else n[s]=l}return n}function RT(e,t){return gu(DT,e,t||{})}function IT(e,t){return gu(jT,e,t||{})}class MT{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:i},s){try{const{data:l,error:o}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!l)return{data:null,error:o};const a=i??TT.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:c}=l.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${n}`),c.displayName||(c.displayName=c.name)}switch(l.webauthn.type){case"create":{const c=RT(l.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:d,error:f}=await FT({publicKey:c,signal:a});return d?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}case"request":{const c=IT(l.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:d,error:f}=await PT(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:c,signal:a}));return d?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}}}catch(l){return Re(l)?{data:null,error:l}:{data:null,error:new ss("Unexpected error in challenge",l)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new sl("rpId is required for WebAuthn authentication")};try{if(!Kp())return{data:null,error:new ss("Browser does not support WebAuthn",null)};const{data:l,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:s});if(!l)return{data:null,error:o};const{webauthn:a}=l;return this._verify({factorId:t,challengeId:l.challengeId,webauthn:{type:a.type,rpId:r,rpOrigins:n,credential_response:a.credential_response}})}catch(l){return Re(l)?{data:null,error:l}:{data:null,error:new ss("Unexpected error in authenticate",l)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new sl("rpId is required for WebAuthn registration")};try{if(!Kp())return{data:null,error:new ss("Browser does not support WebAuthn",null)};const{data:l,error:o}=await this._enroll({friendlyName:t});if(!l)return await this.client.mfa.listFactors().then(d=>{var f;return(f=d.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:o};const{data:a,error:c}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:s});return a?this._verify({factorId:l.id,challengeId:a.challengeId,webauthn:{rpId:r,rpOrigins:n,type:a.webauthn.type,credential_response:a.webauthn.credential_response}}):{data:null,error:c}}catch(l){return Re(l)?{data:null,error:l}:{data:null,error:new ss("Unexpected error in register",l)}}}}yT();const LT={url:jC,storageKey:RC,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:IC,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function Jp(e,t,r){return await r()}const Xs={};class al{get jwks(){var t,r;return(r=(t=Xs[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Xs[this.storageKey]=Object.assign(Object.assign({},Xs[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Xs[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Xs[this.storageKey]=Object.assign(Object.assign({},Xs[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},LT),t);if(this.storageKey=s.storageKey,this.instanceID=(r=al.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,al.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&nr()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new mT({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=W1(s.fetch),this.lock=s.lock||Jp,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,this.lockAcquireTimeout=s.lockAcquireTimeout,s.lock?this.lock=s.lock:this.persistSession&&nr()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=vT:this.lock=Jp,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new MT(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:U1()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=qp(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=qp(this.memoryStorage)),nr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l);try{await this._notifyAllSubscribers(l.data.event,l.data.session,!1)}catch(o){this._debug("#broadcastChannel","error",o)}})}this.initialize().catch(l=>{this._debug("#initialize()","error",l)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${M1}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(nr()&&(r=KC(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),nr()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),WC(s)){const a=(t=s.details)===null||t===void 0?void 0:t.code;if(a==="identity_already_exists"||a==="identity_not_found"||a==="single_identity_not_deletable")return{error:s}}return{error:s}}const{session:l,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",l,"redirect type",o),await this._saveSession(l),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Re(r)?this._returnResult({error:r}):this._returnResult({error:new ss("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const s=await We(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:mn}),{data:l,error:o}=s;if(o||!l)return this._returnResult({data:{user:null,session:null},error:o});const a=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",a)),this._returnResult({data:{user:c,session:a},error:null})}catch(s){if(Re(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(t){var r,n,i;try{let s;if("email"in t){const{email:d,password:f,options:h}=t;let u=null,g=null;this.flowType==="pkce"&&([u,g]=await Hs(this.storage,this.storageKey)),s=await We(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:d,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:u,code_challenge_method:g},xform:mn})}else if("phone"in t){const{phone:d,password:f,options:h}=t;s=await We(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(i=h==null?void 0:h.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:mn})}else throw new uc("You must provide either an email or phone number and a password");const{data:l,error:o}=s;if(o||!l)return await rr(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const a=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",a)),this._returnResult({data:{user:c,session:a},error:null})}catch(s){if(await rr(this.storage,`${this.storageKey}-code-verifier`),Re(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:l,options:o}=t;r=await We(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Yp})}else if("phone"in t){const{phone:s,password:l,options:o}=t;r=await We(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Yp})}else throw new uc("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const s=new zs;return this._returnResult({data:{user:null,session:null},error:s})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(Re(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,i,s,l,o,a,c,d,f,h;let u,g;if("message"in t)u=t.message,g=t.signature;else{const{chain:m,wallet:p,statement:x,options:v}=t;let y;if(nr())if(typeof p=="object")y=p;else{const F=window;if("ethereum"in F&&typeof F.ethereum=="object"&&"request"in F.ethereum&&typeof F.ethereum.request=="function")y=F.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof p!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=p}const _=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href),b=await y.request({method:"eth_requestAccounts"}).then(F=>F).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!b||b.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const S=H1(b[0]);let C=(n=v==null?void 0:v.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!C){const F=await y.request({method:"eth_chainId"});C=wT(F)}const N={domain:_.host,address:S,statement:x,uri:_.href,version:"1",chainId:C,nonce:(i=v==null?void 0:v.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(l=(s=v==null?void 0:v.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(o=v==null?void 0:v.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(a=v==null?void 0:v.signInWithEthereum)===null||a===void 0?void 0:a.notBefore,requestId:(c=v==null?void 0:v.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(d=v==null?void 0:v.signInWithEthereum)===null||d===void 0?void 0:d.resources};u=bT(N),g=await y.request({method:"personal_sign",params:[_T(u),S]})}try{const{data:m,error:p}=await We(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:u,signature:g},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:mn});if(p)throw p;if(!m||!m.session||!m.user){const x=new zs;return this._returnResult({data:{user:null,session:null},error:x})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:p})}catch(m){if(Re(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(t){var r,n,i,s,l,o,a,c,d,f,h,u;let g,m;if("message"in t)g=t.message,m=t.signature;else{const{chain:p,wallet:x,statement:v,options:y}=t;let _;if(nr())if(typeof x=="object")_=x;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))_=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=x}const b=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in _&&_.signIn){const S=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:b.host,uri:b.href}),v?{statement:v}:null));let C;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")C=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)C=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)g=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),m=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${b.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${b.href}`,`Issued At: ${(i=(n=y==null?void 0:y.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=y==null?void 0:y.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((l=y==null?void 0:y.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((o=y==null?void 0:y.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((a=y==null?void 0:y.signInWithSolana)===null||a===void 0)&&a.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((c=y==null?void 0:y.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((f=(d=y==null?void 0:y.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",...y.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const S=await _.signMessage(new TextEncoder().encode(g),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=S}}try{const{data:p,error:x}=await We(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:us(m)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(u=t.options)===null||u===void 0?void 0:u.captchaToken}}:null),xform:mn});if(x)throw x;if(!p||!p.session||!p.user){const v=new zs;return this._returnResult({data:{user:null,session:null},error:v})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:Object.assign({},p),error:x})}catch(p){if(Re(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async _exchangeCodeForSession(t){const r=await Zi(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new zC;const{data:s,error:l}=await We(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:mn});if(await rr(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!s||!s.session||!s.user){const o=new zs;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:l})}catch(s){if(await rr(this.storage,`${this.storageKey}-code-verifier`),Re(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:s,nonce:l}=t,o=await We(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:l,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:mn}),{data:a,error:c}=o;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!a||!a.session||!a.user){const d=new zs;return this._returnResult({data:{user:null,session:null},error:d})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:a,error:c})}catch(r){if(Re(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,i,s,l;try{if("email"in t){const{email:o,options:a}=t;let c=null,d=null;this.flowType==="pkce"&&([c,d]=await Hs(this.storage,this.storageKey));const{error:f}=await We(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=a==null?void 0:a.data)!==null&&r!==void 0?r:{},create_user:(n=a==null?void 0:a.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in t){const{phone:o,options:a}=t,{data:c,error:d}=await We(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=a==null?void 0:a.data)!==null&&i!==void 0?i:{},create_user:(s=a==null?void 0:a.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},channel:(l=a==null?void 0:a.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d})}throw new uc("You must provide either an email or phone number.")}catch(o){if(await rr(this.storage,`${this.storageKey}-code-verifier`),Re(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var r,n;try{let i,s;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:o}=await We(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:mn});if(o)throw o;if(!l)throw new Error("An error occurred on token verification.");const a=l.session,c=l.user;return a!=null&&a.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",a)),this._returnResult({data:{user:c,session:a},error:null})}catch(i){if(Re(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,n,i,s,l;try{let o=null,a=null;this.flowType==="pkce"&&([o,a]=await Hs(this.storage,this.storageKey));const c=await We(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:a}),headers:this.headers,xform:dT});return!((s=c.data)===null||s===void 0)&&s.url&&nr()&&!(!((l=t.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(o){if(await rr(this.storage,`${this.storageKey}-code-verifier`),Re(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Br;const{error:i}=await We(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(Re(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:s}=t,{error:l}=await We(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in t){const{phone:n,type:i,options:s}=t,{data:l,error:o}=await We(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:o})}throw new uc("You must provide either an email or phone number and a type")}catch(r){if(Re(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Zi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<zf:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const l=await Zi(this.userStorage,this.storageKey+"-user");l!=null&&l.user?t.user=l.user:t.user=$f()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};t.user=cT(t.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await We(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:_i}):await this._useSession(async r=>{var n,i,s;const{data:l,error:o}=r;if(o)throw o;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Br}:await We(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:_i})})}catch(r){if(Re(r))return Hf(r)&&(await this._removeSession(),await rr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new Br;const l=i.session;let o=null,a=null;this.flowType==="pkce"&&t.email!=null&&([o,a]=await Hs(this.storage,this.storageKey));const{data:c,error:d}=await We(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:a}),jwt:l.access_token,xform:_i});if(d)throw d;return l.user=c.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(n){if(await rr(this.storage,`${this.storageKey}-code-verifier`),Re(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Br;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:l}=hc(t.access_token);if(l.exp&&(n=l.exp,i=n<=r),i){const{data:o,error:a}=await this._callRefreshToken(t.refresh_token);if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:a}=await this._getUser(t.access_token);if(a)return this._returnResult({data:{user:null,session:null},error:a});s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(Re(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:l,error:o}=r;if(o)throw o;t=(n=l.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Br;const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Re(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!nr())throw new fc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new fc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Up("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new fc("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Up("No code detected.");const{data:v,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:l,expires_in:o,expires_at:a,token_type:c}=t;if(!s||!o||!l||!c)throw new fc("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(o);let h=d+f;a&&(h=parseInt(a));const u=h-d;u*1e3<=Qs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${u}s, should have been closer to ${f}s`);const g=h-f;d-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,d):d-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,h,d);const{data:m,error:p}=await this._getUser(s);if(p)throw p;const x={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:f,expires_at:h,refresh_token:l,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:t.type},error:null})}catch(n){if(Re(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Zi(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s&&!Hf(s))return this._returnResult({error:s});const l=(n=i.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:o}=await this.admin.signOut(l,t);if(o&&!(UC(o)&&(o.status===404||o.status===401||o.status===403)||Hf(o)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await rr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=qC(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:l}=r;if(l)throw l;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await Hs(this.storage,this.storageKey,!0));try{return await We(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(await rr(this.storage,`${this.storageKey}-code-verifier`),Re(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Re(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var l,o,a,c,d;const{data:f,error:h}=s;if(h)throw h;const u=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:!0});return await We(this.fetch,"GET",u,{headers:this.headers,jwt:(d=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(i)throw i;return nr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(Re(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:s}}=r;if(i)throw i;const{options:l,provider:o,token:a,access_token:c,nonce:d}=t,f=await We(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s==null?void 0:s.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:a,access_token:c,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:mn}),{data:h,error:u}=f;return u?this._returnResult({data:{user:null,session:null},error:u}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new zs}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:u}))}catch(i){if(await rr(this.storage,`${this.storageKey}-code-verifier`),Re(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:l}=r;if(l)throw l;return await We(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(Re(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await ZC(async i=>(i>0&&await QC(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await We(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:mn})),(i,s)=>{const l=200*Math.pow(2,i);return s&&Vf(s)&&Date.now()+l-n<Qs})}catch(n){if(this._debug(r,"error",n),Re(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),nr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await Zi(this.storage,this.storageKey);if(i&&this.userStorage){let l=await Zi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:i.user},await Zs(this.userStorage,this.storageKey+"-user",l)),i.user=(t=l==null?void 0:l.user)!==null&&t!==void 0?t:$f()}else if(i&&!i.user&&!i.user){const l=await Zi(this.storage,this.storageKey+"-user");l&&(l!=null&&l.user)?(i.user=l.user,await rr(this.storage,this.storageKey+"-user"),await Zs(this.storage,this.storageKey,i)):i.user=$f()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<zf;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${zf}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:l}=await this._callRefreshToken(i.refresh_token);l&&(console.error(l),Vf(l)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:o}=await this._getUser(i.access_token);!o&&(l!=null&&l.user)?(i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(n,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Br;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Ku;const{data:s,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!s.session)throw new Br;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={data:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),Re(s)){const l={data:null,error:s};return Vf(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],l=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(a){s.push(a)}});if(await Promise.all(l),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await rr(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Zs(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=$p(i);await Zs(this.storage,this.storageKey,s)}else{const i=$p(r);await Zs(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await rr(this.storage,this.storageKey),await rr(this.storage,this.storageKey+"-code-verifier"),await rr(this.storage,this.storageKey+"-user"),this.userStorage&&await rr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&nr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Qs);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/Qs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Qs}ms, refresh threshold is ${ud} ticks`),i<=ud&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof z1)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!nr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(t){this._debug("#visibilityChangedCallback","error",t)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,l]=await Hs(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(l)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?this._returnResult({data:null,error:s}):await We(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Re(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:l}=r;if(l)return this._returnResult({data:null,error:l});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:a,error:c}=await We(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(t.factorType==="totp"&&a.type==="totp"&&(!((i=a==null?void 0:a.totp)===null||i===void 0)&&i.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),this._returnResult({data:a,error:null}))})}catch(r){if(Re(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const l=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?OT(t.webauthn.credential_response):NT(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:a}=await We(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return a?this._returnResult({data:null,error:a}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:a}))})}catch(r){if(Re(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const l=await We(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(l.error)return l;const{data:o}=l;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:ET(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:AT(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Re(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const s of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])i.all.push(s),s.status==="verified"&&i[s.factor_type].push(s);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(t){var r,n,i,s;if(t)try{const{payload:u}=hc(t);let g=null;u.aal&&(g=u.aal);let m=g;const{data:{user:p},error:x}=await this.getUser(t);if(x)return this._returnResult({data:null,error:x});((n=(r=p==null?void 0:p.factors)===null||r===void 0?void 0:r.filter(_=>_.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(m="aal2");const y=u.amr||[];return{data:{currentLevel:g,nextLevel:m,currentAuthenticationMethods:y},error:null}}catch(u){if(Re(u))return this._returnResult({data:null,error:u});throw u}const{data:{session:l},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=hc(l.access_token);let c=null;a.aal&&(c=a.aal);let d=c;((s=(i=l.user.factors)===null||i===void 0?void 0:i.filter(u=>u.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(d="aal2");const h=a.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:h},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await We(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Br})})}catch(r){if(Re(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Br});const l=await We(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return l.data&&l.data.redirect_url&&nr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Br});const l=await We(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return l.data&&l.data.redirect_url&&nr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await We(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Br})})}catch(t){if(Re(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?(await We(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Br})})}catch(r){if(Re(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+LC>i)return n;const{data:s,error:l}=await We(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:u,error:g}=await this.getSession();if(g||!u.session)return this._returnResult({data:null,error:g});n=u.session.access_token}const{header:i,payload:s,signature:l,raw:{header:o,payload:a}}=hc(n);r!=null&&r.allowExpired||aT(s.exp);const c=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:u}=await this.getUser(n);if(u)throw u;return{data:{claims:s,header:i,signature:l},error:null}}const d=oT(i.alg),f=await crypto.subtle.importKey("jwk",c,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,l,YC(`${o}.${a}`)))throw new dd("Invalid JWT signature");return{data:{claims:s,header:i,signature:l},error:null}}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}}}al.nextInstanceID={};const BT=al,UT="2.93.1";let go="";typeof Deno<"u"?go="deno":typeof document<"u"?go="web":typeof navigator<"u"&&navigator.product==="ReactNative"?go="react-native":go="node";function WT(){const e=globalThis.process;if(e&&e.platform){const t=e.platform;if(t==="darwin")return"macOS";if(t==="win32")return"Windows";if(t==="linux")return"Linux";if(t==="android")return"Android"}if(typeof navigator<"u"&&navigator.userAgentData&&navigator.userAgentData.platform){const t=navigator.userAgentData.platform;if(t==="macOS")return"macOS";if(t==="Windows")return"Windows";if(t==="Linux")return"Linux";if(t==="Android")return"Android";if(t==="iOS")return"iOS"}return null}function zT(){const e=globalThis.process;if(e){const t=e.versions;if(t&&t.node&&typeof window>"u")try{const r=globalThis.require;if(r)return r("os").release()}catch{return null}}if(typeof Deno<"u"&&Deno.osRelease)try{return Deno.osRelease()}catch{return null}return typeof navigator<"u"&&navigator.userAgentData&&navigator.userAgentData.platformVersion?navigator.userAgentData.platformVersion:null}function HT(){if(typeof Deno<"u")return"deno";if(typeof Bun<"u")return"bun";const e=globalThis.process;if(e){const t=e.versions;if(t&&t.node)return"node"}return null}function VT(){if(typeof Deno<"u"&&Deno.version)return Deno.version.deno;if(typeof Bun<"u"&&Bun.version)return Bun.version;const e=globalThis.process;if(e){const t=e.versions;if(t&&t.node)return t.node}return null}function $T(){const e={"X-Client-Info":`supabase-js-${go}/${UT}`},t=WT();t&&(e["X-Supabase-Client-Platform"]=t);const r=zT();r&&(e["X-Supabase-Client-Platform-Version"]=r);const n=HT();n&&(e["X-Supabase-Client-Runtime"]=n);const i=VT();return i&&(e["X-Supabase-Client-Runtime-Version"]=i),e}const XT=$T(),YT={headers:XT},GT={schema:"public"},qT={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},KT={};function ol(e){"@babel/helpers - typeof";return ol=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ol(e)}function JT(e,t){if(ol(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ol(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QT(e){var t=JT(e,"string");return ol(t)=="symbol"?t:t+""}function ZT(e,t,r){return(t=QT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Pt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qp(Object(r),!0).forEach(function(n){ZT(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qp(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const eE=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),tE=()=>Headers,rE=(e,t,r)=>{const n=eE(r),i=tE();return async(s,l)=>{var o;const a=(o=await t())!==null&&o!==void 0?o:e;let c=new i(l==null?void 0:l.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${a}`),n(s,Pt(Pt({},l),{},{headers:c}))}};function nE(e){return e.endsWith("/")?e:e+"/"}function iE(e,t){var r,n;const{db:i,auth:s,realtime:l,global:o}=e,{db:a,auth:c,realtime:d,global:f}=t,h={db:Pt(Pt({},a),i),auth:Pt(Pt({},c),s),realtime:Pt(Pt({},d),l),storage:{},global:Pt(Pt(Pt({},f),o),{},{headers:Pt(Pt({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function sE(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(nE(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var aE=class extends BT{constructor(e){super(e)}},oE=class{constructor(e,t,r){var n,i;this.supabaseUrl=e,this.supabaseKey=t;const s=sE(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",s),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",s),this.storageUrl=new URL("storage/v1",s),this.functionsUrl=new URL("functions/v1",s);const l=`sb-${s.hostname.split(".")[0]}-auth-token`,o={db:GT,realtime:KT,auth:Pt(Pt({},qT),{},{storageKey:l}),global:YT},a=iE(r??{},o);if(this.storageKey=(n=a.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=a.global.headers)!==null&&i!==void 0?i:{},a.accessToken)this.accessToken=a.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=a.auth)!==null&&c!==void 0?c:{},this.headers,a.global.fetch)}this.fetch=rE(t,this._getAccessToken.bind(this),a.global.fetch),this.realtime=this._initRealtimeClient(Pt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},a.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new Bk(new URL("rest/v1",s).href,{headers:this.headers,schema:a.db.schema,fetch:this.fetch}),this.storage=new DC(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),a.accessToken||this._listenForAuthEvents()}get functions(){return new jk(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,storageKey:s,flowType:l,lock:o,debug:a,throwOnError:c},d,f){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new aE({url:this.authUrl.href,headers:Pt(Pt({},h),d),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,flowType:l,lock:o,debug:a,throwOnError:c,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(u=>u.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new rC(this.realtimeUrl.href,Pt(Pt({},e),{},{params:Pt(Pt({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const lE=(e,t,r)=>new oE(e,t,r);function cE(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}cE()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const uE="https://kglshjhuofkouiodmkgs.supabase.co",fE="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtnbHNoamh1b2Zrb3Vpb2Rta2dzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk0NDE3ODgsImV4cCI6MjA4NTAxNzc4OH0.kqoUY-stIdwOw3vtpowcbzV_AvjgGtzXN6i9bjQCW-Y",we=lE(uE,fE),hE=()=>{var ee,E;const e=le.useRef(null),t=le.useRef(null),[r,n]=le.useState(null),[i,s]=le.useState(""),[l,o]=le.useState(""),[a,c]=le.useState("A"),[d,f]=le.useState("#5E5CE6"),[h,u]=le.useState([]),[g,m]=le.useState(null),[p,x]=le.useState(!1),[v,y]=le.useState(null),_=le.useRef(null),b=le.useRef(null),S=le.useRef(null),C=le.useRef(null);le.useEffect(()=>{_.current=v},[v]),le.useEffect(()=>{N()},[]);const N=async()=>{const{data:D}=await we.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});D&&D.length>0&&(u(D),m(D[0].id))};le.useEffect(()=>{if(!e.current||!g)return;let D=!0;t.current&&t.current.dispose(),e.current.innerHTML="";const U=document.createElement("canvas");e.current.appendChild(U);const k=new Ve.fabric.Canvas(U,{width:1e3,height:600,backgroundColor:"transparent",selection:!0});t.current=k,(async()=>{var L;x(!0);const{data:z,error:I}=await we.from("seats").select("*").eq("zone_id",g).order("global_number",{ascending:!0});if(D){if(I)console.error("Error loading seats:",I);else if(z&&z.length>0){t.current&&t.current.clear();const K=z.filter(se=>typeof se.pos_x=="number"&&typeof se.pos_y=="number");let O=0,B=0,M=1e3,J=600;if(K.length>0){const se=Math.min(...K.map(ve=>ve.pos_x)),ce=Math.max(...K.map(ve=>ve.pos_x+(ve.width||72)))-se,ue=((L=e.current)==null?void 0:L.clientWidth)||ce;M=Math.max(ce+100,ue),O=(M-ce)/2-se;const xe=Math.min(...K.map(ve=>ve.pos_y)),fe=Math.max(...K.map(ve=>ve.pos_y+(ve.height||72)))-xe;B=20-xe,J=Math.max(fe+100,600)}t.current.setDimensions({width:M,height:J}),K.forEach(se=>{Y({...se,pos_x:se.pos_x+O,pos_y:se.pos_y+B});const H=t.current.getObjects().find(ce=>ce.data.id===se.id);H&&delete H.data.isDirty}),t.current.renderAll()}else t.current&&(t.current.clear(),t.current.setDimensions({width:1e3,height:600}));x(!1)}})(),k.on("mouse:down",z=>{var I,L,K,O;if(_.current==="structure"){k.selection=!1;const B=k.getPointer(z.e);setDrawStart({x:B.x,y:B.y});const M=new Ve.fabric.Rect({left:B.x,top:B.y,width:0,height:0,fill:"#E5E5EA",rx:6,ry:6,stroke:"#C7C7CC",strokeWidth:1,opacity:.7});k.add(M),setTempRect(M);return}z.target?saveToHistory():(k.isDragging=!0,k.selection=!0,k.lastPosX=z.e.clientX||((L=(I=z.e.touches)==null?void 0:I[0])==null?void 0:L.clientX),k.lastPosY=z.e.clientY||((O=(K=z.e.touches)==null?void 0:K[0])==null?void 0:O.clientY))});const A=async()=>{if(history.length===0)return;const z=history[history.length-1],I=history.slice(0,-1);setHistory(I),t.current.clear(),z.forEach(L=>{Y({id:L.id,seat_number:L.seatNumber,display_number:L.displayNumber,zone_name:L.zoneName,zone_color:L.zoneColor,pos_x:L.pos_x,pos_y:L.pos_y,width:L.width,height:L.height,label:L.label,type:L.type,rotation:L.rotation,global_number:L.globalNumber})})},T=()=>{const z=k.getActiveObject();z&&z.clone(I=>{C.current=I},["data"])},j=()=>{if(!C.current||!t.current)return;const z=t.current;saveToHistory();try{C.current.clone(I=>{var L,K,O;if(!(!z.getElement()||!z.contextContainer)){if(z.discardActiveObject(),I.set({left:I.left+20,top:I.top+20,evented:!0}),I.type==="activeSelection"){const B=[];I.forEachObject(J=>{var ue,xe;const se=crypto.randomUUID();let H=((ue=J.data)==null?void 0:ue.type)==="structure";!H&&((xe=J.data)!=null&&xe.label)&&(H=!0);const ce=J.data||{};H&&(delete ce.zoneName,delete ce.zoneColor,delete ce.displayNumber),J.set("data",{...ce,id:se,isDirty:!0,type:H?"structure":"seat",seatNumber:ce.seatNumber||(H?`STR_${se.slice(-8)}`:"0")}),z.add(J),B.push(J)});const M=new Ve.fabric.ActiveSelection(B,{canvas:z});z.setActiveObject(M),M.setCoords()}else{const B=crypto.randomUUID();let M=((L=I.data)==null?void 0:L.type)==="structure";if(!M&&((K=I.data)!=null&&K.label)&&(M=!0),M){const se=((O=I.data)==null?void 0:O.label)||"",H=prompt("  ",se);if(H){I.data={...I.data,label:H,type:"structure"};const ce=I.getObjects().find(ue=>ue.type==="i-text");ce&&ce.set("text",H)}}const J=I.data||{};M&&(delete J.zoneName,delete J.zoneColor,delete J.displayNumber),I.set("data",{...J,id:B,isDirty:!0,type:M?"structure":"seat",seatNumber:M?`STR_${B.slice(-8)}`:J.seatNumber||"0"}),z.add(I),z.setActiveObject(I)}z.requestRenderAll()}},["data"])}catch(I){console.error("Error pasting objects:",I)}},R=z=>{(z.ctrlKey||z.metaKey)&&z.key==="z"&&(z.preventDefault(),A()),(z.ctrlKey||z.metaKey)&&z.key==="c"&&document.activeElement.tagName!=="INPUT"&&document.activeElement.tagName!=="TEXTAREA"&&(z.preventDefault(),T()),(z.ctrlKey||z.metaKey)&&z.key==="v"&&document.activeElement.tagName!=="INPUT"&&document.activeElement.tagName!=="TEXTAREA"&&(z.preventDefault(),j())};return window.addEventListener("keydown",R),k.on("mouse:move",z=>{var I,L,K,O;if(_.current==="structure"&&b.current&&S.current){const B=k.getPointer(z.e),M=b.current,J=S.current,se=Math.abs(B.x-M.x),H=Math.abs(B.y-M.y),ce=Math.min(B.x,M.x),ue=Math.min(B.y,M.y);J.set({width:se,height:H,left:ce,top:ue}),k.requestRenderAll();return}if(k.isDragging){const B=z.e,M=B.clientX||((L=(I=B.touches)==null?void 0:I[0])==null?void 0:L.clientX),J=B.clientY||((O=(K=B.touches)==null?void 0:K[0])==null?void 0:O.clientY),se=k.viewportTransform;se[4]+=M-k.lastPosX,se[5]+=J-k.lastPosY,k.requestRenderAll(),k.lastPosX=M,k.lastPosY=J}}),k.on("mouse:wheel",z=>{var B;const I=z.e.deltaY,L=k.viewportTransform;L[5]-=I;const K=((B=e.current)==null?void 0:B.clientHeight)||0,O=k.getHeight();K>0&&L[5]<-(O-K)&&(L[5]=-(O-K)),k.requestRenderAll(),z.e.preventDefault(),z.e.stopPropagation()}),k.on("object:scaling",z=>{const I=z.target;if(I&&I.data){const L=I.getObjects().find(K=>K.type==="i-text");L&&L.set({scaleX:1/I.scaleX,scaleY:1/I.scaleY})}}),k.on("mouse:dblclick",z=>{const I=z.target;if(!I||!I.data)return;const L=I.data.type;if(L!=="seat"&&L!=="structure")return;const K=I.getObjects().find(se=>se.type==="i-text");if(!K)return;saveToHistory();const O={...I.data},B=I.left,M=I.top,J=I.angle;I._restoreObjectsState(),k.remove(I),I.getObjects().forEach(se=>{k.add(se),se===K&&(k.setActiveObject(se),se.enterEditing(),se.selectAll())}),k.requestRenderAll(),K.on("editing:exited",()=>{const se=K.text;L==="structure"&&(O.label=se),L==="seat"&&(O.displayNumber=se);const ce=[I.getObjects().find(xe=>xe.type==="rect"),K];ce.forEach(xe=>k.remove(xe));const ue=new Ve.fabric.Group(ce,{left:B,top:M,angle:J,hasControls:!0,lockRotation:!1,subTargetCheck:!0});ue.data=O,ue.data.isDirty=!0,L==="seat"?ue.set({borderColor:O.zoneColor||"#5E5CE6",cornerColor:"white",cornerStrokeColor:"#5E5CE6",transparentCorners:!1}):ue.set({borderColor:"#007AFF",cornerColor:"white",cornerStrokeColor:"#007AFF",transparentCorners:!1}),k.add(ue),k.setActiveObject(ue),k.requestRenderAll(),K.off("editing:exited")})}),k.on("mouse:up",()=>{if(_.current==="structure"&&S.current){const z=S.current,I=z.width,L=z.height,K=z.left,O=z.top;k.remove(z),setTempRect(null),setDrawStart(null),y(null),I>20&&L>20&&setTimeout(()=>{const B=prompt("  (: , , )","");B&&(saveToHistory(),F(K,O,I,L,B))},50);return}k.isDragging&&(k.setViewportTransform(k.viewportTransform),k.isDragging=!1)}),k.on("selection:created",z=>{var L,K,O,B,M;const I=z.selected;if(I.length===1){const J=I[0];n(J),((L=J.data)==null?void 0:L.type)!=="structure"&&(s(((K=J.data)==null?void 0:K.seatNumber)||""),o(((O=J.data)==null?void 0:O.displayNumber)||""),c(((B=J.data)==null?void 0:B.zoneName)||"A"),f(((M=J.data)==null?void 0:M.zoneColor)||"#5E5CE6"))}else n(null)}),k.on("selection:updated",z=>{var L,K,O,B,M;const I=z.selected;if(I.length===1){const J=I[0];n(J),((L=J.data)==null?void 0:L.type)!=="structure"&&(s(((K=J.data)==null?void 0:K.seatNumber)||""),o(((O=J.data)==null?void 0:O.displayNumber)||""),c(((B=J.data)==null?void 0:B.zoneName)||"A"),f(((M=J.data)==null?void 0:M.zoneColor)||"#5E5CE6"))}else n(null)}),k.on("selection:cleared",()=>{n(null),s(""),o("")}),k.on("object:modified",async z=>{const I=z.target;if(!I)return;(I.type==="activeSelection"?I.getObjects():[I]).forEach(K=>{var O;if(K.data){const B=K.width*K.scaleX,M=K.height*K.scaleY;K.set({width:B,height:M,scaleX:1,scaleY:1});const J=K.getObjects().find(se=>se.type==="i-text");if(J){J.set({scaleX:1,scaleY:1}),((O=K.data)==null?void 0:O.type)==="structure"?J.set({left:0,top:0,originX:"center",originY:"center"}):J.set({left:-B/2+6,top:-M/2+6,originX:"left",originY:"top"});const se=K.getObjects().find(H=>H.type==="rect");se&&(se.set({width:B,height:M}),se.set({left:-B/2,top:-M/2})),K.addWithUpdate()}}K.data&&(K.data.isDirty=!0)})}),()=>{D=!1,window.removeEventListener("keydown",R),k.dispose(),t.current=null}},[g]);const F=(D,U,k,P,A)=>{const T=new Ve.fabric.Rect({fill:"#E5E5EA",width:k,height:P,rx:6,ry:6,stroke:"#D1D1D6",strokeWidth:1}),j=new Ve.fabric.IText(A,{fontSize:12,originX:"center",originY:"center",left:k/2,top:P/2,fill:"#8E8E93",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),R=crypto.randomUUID(),z=new Ve.fabric.Group([T,j],{left:D,top:U,data:{id:R,type:"structure",label:A,width:k,height:P,isDirty:!0,seatNumber:`STR_${R.slice(-8)}`}});t.current.add(z),t.current.setActiveObject(z)},Y=D=>{if(D.type==="structure"){const A=new Ve.fabric.Rect({fill:"#E5E5EA",width:D.width||72,height:D.height||72,rx:6,ry:6,stroke:"#D1D1D6",strokeWidth:1}),T=new Ve.fabric.IText(D.label||"",{fontSize:12,originX:"center",originY:"center",left:(D.width||72)/2,top:(D.height||72)/2,fill:"#8E8E93",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),j=new Ve.fabric.Group([A,T],{id:D.id,left:D.pos_x,top:D.pos_y,angle:D.rotation,data:{id:D.id,type:"structure",label:D.label,width:D.width,height:D.height}});t.current.add(j);return}const U=new Ve.fabric.Rect({fill:D.zone_color||"#5E5CE6",width:72,height:72,rx:6,ry:6,stroke:"rgba(255,255,255,0.1)",strokeWidth:2}),k=new Ve.fabric.IText(D.display_number||D.seat_number,{fontSize:12,left:6,top:6,fill:"#ffffff",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"900",selectable:!1}),P=new Ve.fabric.Group([U,k],{left:D.pos_x,top:D.pos_y,angle:D.rotation,data:{id:D.id,type:"seat",seatNumber:D.seat_number,displayNumber:D.display_number,zoneName:D.zone_name,zoneColor:D.zone_color,globalNumber:D.global_number}});t.current.add(P)},X=()=>{var D;if(r&&((D=r.data)==null?void 0:D.type)!=="structure"){saveToHistory(),r.set("data",{...r.data,seatNumber:i,displayNumber:l,zoneName:a,zoneColor:d});const U=r.getObjects().find(P=>P.type==="i-text");U&&U.set("text",l);const k=r.getObjects().find(P=>P.type==="rect");k&&k.set("fill",d),t.current.renderAll()}},V=()=>{saveToHistory();const U=`${t.current.getObjects().filter(T=>{var j;return((j=T.data)==null?void 0:j.type)!=="structure"}).length+1}`,k=new Ve.fabric.Rect({fill:d,width:72,height:72,rx:6,ry:6,stroke:"rgba(255,255,255,0.1)",strokeWidth:2}),P=new Ve.fabric.IText(U,{fontSize:18,originX:"center",originY:"center",left:36,top:36,fill:"#ffffff",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"900",selectable:!1}),A=new Ve.fabric.Group([k,P],{left:150,top:150,data:{id:crypto.randomUUID(),type:"seat",seatNumber:U,zoneName:a,zoneColor:d,isDirty:!0}});t.current.add(A),t.current.setActiveObject(A)},te=async()=>{const D=t.current;if(!D)return;const U=D.getActiveObject();if(U){saveToHistory();const k=U.type==="activeSelection"?U.getObjects():[U],P=[];k.forEach(A=>{var j;const T=(j=A.data)==null?void 0:j.id;T&&T.length>20&&P.push(T)}),setDeletedIds(A=>[...A,...P]),D.discardActiveObject(),k.forEach(A=>D.remove(A)),D.requestRenderAll(),n(null)}},G=()=>{saveToHistory();const D=t.current.getObjects(),U=["A","B","C"];let k=1;U.forEach(P=>{D.filter(T=>{var j,R;return((j=T.data)==null?void 0:j.zoneName)===P&&((R=T.data)==null?void 0:R.type)!=="structure"}).sort((T,j)=>Math.abs(T.top-j.top)<20?T.left-j.left:T.top-j.top).forEach((T,j)=>{const R=j+1,z=`${P}-${R.toString().padStart(2,"0")}`;T.set("data",{...T.data,seatNumber:R.toString(),displayNumber:z,globalNumber:k++});const I=T.getObjects().find(L=>L.type==="i-text");I&&I.set("text",z)})}),t.current.renderAll()},re=()=>{const D=t.current.getActiveObject();D&&(saveToHistory(),D.rotate(((D.angle||0)+90)%360),t.current.renderAll())},Z=async()=>{x(!0);try{if(deletedIds.length>0){const{error:P}=await we.from("seats").delete().in("id",deletedIds);if(P)throw console.error("Error deleting items:",P),P}const D=t.current.getObjects(),U=[],k=[];if(D.forEach(P=>{var I,L,K,O,B,M,J,se,H;const A=Math.round(P.getScaledWidth()),T=Math.round(P.getScaledHeight()),j=((I=P.data)==null?void 0:I.type)==="structure",R=((L=P.data)==null?void 0:L.seatNumber)||(j?`STR_${P.data.id.slice(-8)}`:"0"),z={zone_id:g,pos_x:Math.round(P.left),pos_y:Math.round(P.top),rotation:Math.round(P.angle||0),type:((K=P.data)==null?void 0:K.type)||"seat",width:A,height:T,label:((O=P.data)==null?void 0:O.label)||null,seat_number:R,display_number:((B=P.data)==null?void 0:B.displayNumber)||null,zone_name:((M=P.data)==null?void 0:M.zoneName)||null,zone_color:((J=P.data)==null?void 0:J.zoneColor)||null,global_number:((se=P.data)==null?void 0:se.globalNumber)||null};(H=P.data)!=null&&H.id&&P.data.id.length>20?(z.id=P.data.id,U.push(z)):k.push(z)}),U.length>0){const{error:P}=await we.from("seats").upsert(U);if(P)throw P}if(k.length>0){const{error:P}=await we.from("seats").insert(k);if(P)throw P}alert("."),setDeletedIds([]),t.current.getObjects().forEach(P=>{P.data&&delete P.data.isDirty}),window.location.reload()}catch(D){console.error("Error saving layout:",D),alert(" : "+(D.message||D.details||JSON.stringify(D)))}finally{x(!1)}},oe=()=>{saveToHistory();const D=t.current.getObjects(),U=30,k=D.filter(j=>{var R;return(R=j.data)==null?void 0:R.isDirty}),P=D.filter(j=>{var R;return!((R=j.data)!=null&&R.isDirty)}),A=P.map(j=>Math.round(j.left)),T=P.map(j=>Math.round(j.top));k.forEach(j=>{let R=j.left,z=j.top,I=R,L=1/0;A.forEach(B=>{const M=Math.abs(R-B);M<U&&M<L&&(L=M,I=B)}),L<U&&j.set("left",I);let K=z,O=1/0;T.forEach(B=>{const M=Math.abs(z-B);M<U&&M<O&&(O=M,K=B)}),O<U&&j.set("top",K),j.setCoords()}),t.current.renderAll()};return w.jsxs("div",{className:"flex flex-col xl:flex-row gap-6 items-stretch w-full h-full mx-auto leading-normal overflow-hidden relative",children:[p&&w.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-30 flex items-center justify-center pointer-events-none",children:w.jsx("div",{className:"w-8 h-8 border-3 border-ios-indigo border-t-transparent rounded-full animate-spin"})}),w.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[w.jsx("div",{className:"flex gap-[10px] m-[10px] mb-4 inline-flex self-start",children:h.map(D=>w.jsx("button",{onClick:()=>m(D.id),className:`px-6 py-2 rounded-lg text-xs font-black transition-all ios-tap border-none outline-none ring-0 ${g===D.id?"bg-[#1C1C1E] text-white shadow-md":"bg-gray-100 text-ios-gray hover:bg-gray-200"}`,children:D.name},D.id))}),w.jsx("div",{className:"flex-1 w-full bg-white rounded-t-[6px] rounded-b-none border-0 overflow-hidden p-2.5 pb-0",children:w.jsx("div",{ref:e,className:"flex-1 h-full relative overflow-hidden cursor-grab active:cursor-grabbing touch-none select-none scrollbar-hide"})})]}),w.jsx("div",{className:"w-full xl:w-80 h-full overflow-y-auto scrollbar-hide space-y-6 animate-spring-up",children:w.jsxs("div",{className:"bg-white border border-gray-100 rounded-[6px] p-6 space-y-8 shadow-sm",children:[w.jsxs("div",{className:"space-y-3",children:[w.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-ios-gray",children:" "}),v==="structure"&&w.jsx("div",{className:"bg-ios-indigo/10 text-ios-indigo text-xs font-bold p-3 rounded-[6px] text-center animate-pulse mb-2",children:"    "}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsxs("button",{onClick:V,className:"flex flex-col items-center justify-center gap-2 bg-gray-50 hover:bg-gray-100 p-4 rounded-[6px] transition-all border border-gray-100 ios-tap group",children:[w.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center group-hover:scale-110 transition-transform",children:w.jsx(el,{className:"w-5 h-5 text-ios-indigo"})}),w.jsx("span",{className:"font-black text-[10px] text-[#1C1C1E]",children:" "})]}),w.jsxs("button",{onClick:()=>y(D=>D==="structure"?null:"structure"),className:`flex flex-col items-center justify-center gap-2 p-4 rounded-[6px] transition-all border ios-tap group ${v==="structure"?"bg-gray-100 border-ios-indigo ring-1 ring-ios-indigo":"bg-gray-50 hover:bg-gray-100 border-gray-100"}`,children:[w.jsx("div",{className:"w-10 h-10 rounded-[6px] flex items-center justify-center group-hover:scale-110 transition-transform bg-ios-indigo/10",children:w.jsx(WS,{className:"w-5 h-5 text-ios-indigo"})}),w.jsx("span",{className:"font-black text-[10px] text-[#1C1C1E]",children:" "})]})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsxs("button",{onClick:G,className:"w-full flex items-center justify-center gap-2 bg-gray-50 hover:bg-gray-100 p-4 rounded-[6px] transition-all border border-gray-100 ios-tap",children:[w.jsx(IS,{className:"w-4 h-4 text-ios-amber"}),w.jsx("span",{className:"font-black text-[10px] text-[#1C1C1E]",children:" "})]}),w.jsxs("button",{onClick:oe,className:"w-full flex items-center justify-center gap-2 bg-gray-50 hover:bg-gray-100 p-4 rounded-[6px] transition-all border border-gray-100 ios-tap",children:[w.jsx(jS,{className:"w-4 h-4 text-ios-emerald"}),w.jsx("span",{className:"font-black text-[10px] text-[#1C1C1E]",children:" "})]})]}),w.jsxs("button",{onClick:Z,disabled:p,className:"w-full flex items-center justify-center gap-2 bg-gray-50 hover:bg-gray-100 p-4 rounded-[6px] transition-all border border-gray-100 ios-tap disabled:opacity-50 group mt-2",children:[w.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center group-hover:scale-110 transition-transform",children:w.jsx(fu,{className:`w-5 h-5 text-ios-indigo ${p?"animate-spin":""}`})}),w.jsx("span",{className:"font-black text-[10px] text-[#1C1C1E]",children:" "})]})]}),w.jsxs("div",{className:`space-y-6 transition-all duration-300 ${r?"opacity-100 translate-y-0":"opacity-20 translate-y-2 pointer-events-none filter blur-[2px]"}`,children:[w.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-ios-gray",children:" "}),((ee=r==null?void 0:r.data)==null?void 0:ee.type)!=="structure"&&w.jsx(w.Fragment,{children:w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:"Display No"}),w.jsx("input",{type:"text",value:l,onChange:D=>o(D.target.value),className:"w-full bg-white border border-gray-200 rounded-[6px] p-3 text-sm font-black text-[#1C1C1E] focus:ring-1 focus:ring-ios-indigo transition-all",placeholder:": A-01"})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:"Zone"}),w.jsxs("select",{value:a,onChange:D=>c(D.target.value),className:"w-full bg-white border border-gray-200 rounded-[6px] p-3 text-sm font-black text-[#1C1C1E] focus:ring-1 focus:ring-ios-indigo appearance-none",children:[w.jsx("option",{value:"A",children:"Zone A"}),w.jsx("option",{value:"B",children:"Zone B"}),w.jsx("option",{value:"C",children:"Zone C"})]})]})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsxs("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1 flex items-center gap-1.5",children:[w.jsx(ZS,{className:"w-2.5 h-2.5"})," Zone Color"]}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx("input",{type:"color",value:d,onChange:D=>f(D.target.value),className:"w-12 h-12 bg-transparent border-0 rounded-[6px] cursor-pointer overflow-hidden p-0 shadow-sm"}),w.jsx("input",{type:"text",value:d.toUpperCase(),onChange:D=>f(D.target.value),className:"flex-1 bg-white border border-gray-200 rounded-[6px] p-3 text-sm font-black text-[#1C1C1E] focus:ring-1 focus:ring-ios-indigo"})]})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsx("button",{onClick:()=>n(null),className:"w-full bg-gray-100 text-gray-500 py-4 rounded-[6px] font-black text-xs hover:bg-gray-200 ios-tap",children:"/"}),w.jsx("button",{onClick:X,className:"w-full bg-[#1C1C1E] text-white py-4 rounded-[6px] font-black text-xs shadow-sm shadow-black/10 ios-tap",children:" "})]})]})}),((E=r==null?void 0:r.data)==null?void 0:E.type)==="structure"&&w.jsx("div",{className:"py-4 text-center",children:w.jsx("p",{className:"text-xs text-ios-gray",children:" //  ."})}),w.jsxs("div",{className:"grid grid-cols-2 gap-3 pb-2",children:[w.jsxs("button",{onClick:re,className:"flex items-center justify-center gap-2 bg-gray-50 hover:bg-gray-100 p-4 rounded-[6px] transition-all border border-gray-100 ios-tap",children:[w.jsx(hk,{className:"w-4 h-4 text-ios-blue"}),w.jsx("span",{className:"font-black text-[10px] text-[#1C1C1E]",children:""})]}),w.jsxs("button",{onClick:te,className:"flex items-center justify-center gap-2 bg-ios-rose/5 hover:bg-ios-rose/10 text-ios-rose p-4 rounded-[6px] transition-all border border-ios-rose/10 ios-tap",children:[w.jsx(ji,{className:"w-4 h-4"}),w.jsx("span",{className:"font-black text-[10px]",children:""})]})]})]})]})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var pu={};pu.version="0.18.5";var $1=1252,dE=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],T0={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},E0=function(e){dE.indexOf(e)!=-1&&($1=T0[0]=e)};function gE(){E0(1252)}var _n=function(e){E0(e)};function A0(){_n(1200),gE()}function Zp(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function pE(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function X1(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var po=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?pE(e.slice(2)):t==254&&r==255?X1(e.slice(2)):t==65279?e.slice(1):e},dc=function(t){return String.fromCharCode(t)},em=function(t){return String.fromCharCode(t)},ll,ki="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function cl(e){for(var t="",r=0,n=0,i=0,s=0,l=0,o=0,a=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),l=(r&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,a=i&63,isNaN(n)?o=a=64:isNaN(i)&&(a=64),t+=ki.charAt(s)+ki.charAt(l)+ki.charAt(o)+ki.charAt(a);return t}function Gr(e){var t="",r=0,n=0,i=0,s=0,l=0,o=0,a=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=ki.indexOf(e.charAt(c++)),l=ki.indexOf(e.charAt(c++)),r=s<<2|l>>4,t+=String.fromCharCode(r),o=ki.indexOf(e.charAt(c++)),n=(l&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),a=ki.indexOf(e.charAt(c++)),i=(o&3)<<6|a,a!==64&&(t+=String.fromCharCode(i));return t}var Qe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ci=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Wi(e){return Qe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function tm(e){return Qe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Hr=function(t){return Qe?ci(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ju(e){if(typeof ArrayBuffer>"u")return Hr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Gi(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function mE(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function O0(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return O0(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Zt=Qe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ci(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function xE(e){for(var t=[],r=0,n=e.length+250,i=Wi(e.length+255),s=0;s<e.length;++s){var l=e.charCodeAt(s);if(l<128)i[r++]=l;else if(l<2048)i[r++]=192|l>>6&31,i[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|l>>8&7,i[r++]=128|l>>2&63,i[r++]=128|o>>6&15|(l&3)<<4,i[r++]=128|o&63}else i[r++]=224|l>>12&15,i[r++]=128|l>>6&63,i[r++]=128|l&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Wi(65535),n=65530)}return t.push(i.slice(0,r)),Zt(t)}var Er=/\u0000/g,mo=/[\u0001-\u0006]/g;function ka(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function bn(e,t){var r=""+e;return r.length>=t?r:jt("0",t-r.length)+r}function N0(e,t){var r=""+e;return r.length>=t?r:jt(" ",t-r.length)+r}function mu(e,t){var r=""+e;return r.length>=t?r:r+jt(" ",t-r.length)}function vE(e,t){var r=""+Math.round(e);return r.length>=t?r:jt("0",t-r.length)+r}function yE(e,t){var r=""+e;return r.length>=t?r:jt("0",t-r.length)+r}var rm=Math.pow(2,32);function Ys(e,t){if(e>rm||e<-rm)return vE(e,t);var r=Math.round(e);return yE(r,t)}function xu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var nm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Yf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function wE(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},im={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},_E={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function vu(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,l=1,o=0,a=1,c=0,d=0,f=Math.floor(i);c<t&&(f=Math.floor(i),o=f*l+s,d=f*c+a,!(i-f<5e-8));)i=1/(i-f),s=l,l=o,a=c,c=d;if(d>t&&(c>t?(d=a,o=s):(d=c,o=l)),!r)return[0,n*o,d];var h=Math.floor(n*o/d);return[h,n*o-h*d,d]}function fs(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,l=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)l=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var a=new Date(1900,0,1);a.setDate(a.getDate()+n-1),l=[a.getFullYear(),a.getMonth()+1,a.getDate()],s=a.getDay(),n<60&&(s=(s+6)%7),r&&(s=EE(a,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var Y1=new Date(1899,11,31,0,0,0),bE=Y1.getTime(),SE=new Date(1900,2,1,0,0,0);function G1(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=SE&&(r+=24*60*60*1e3),(r-(bE+(e.getTimezoneOffset()-Y1.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function F0(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function kE(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function CE(e){var t=e<0?12:11,r=F0(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function TE(e){var t=F0(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function ul(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=CE(e):t===10?r=e.toFixed(10).substr(0,12):r=TE(e),F0(kE(r.toUpperCase()))}function Ts(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ul(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return hn(14,G1(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function EE(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function AE(e,t,r,n){var i="",s=0,l=0,o=r.y,a,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:a=o%100,c=2;break;default:a=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:a=r.m,c=t.length;break;case 3:return Yf[r.m-1][1];case 5:return Yf[r.m-1][0];default:return Yf[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=r.d,c=t.length;break;case 3:return nm[r.q][0];default:return nm[r.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?bn(r.S,t.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,s=Math.round(l*(r.S+r.u)),s>=60*l&&(s=0),t==="s"?s===0?"0":""+s/l:(i=bn(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":a=r.D*24+r.H;break;case"[m]":case"[mm]":a=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":a=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:a=o,c=1;break}var d=c>0?bn(a,c):"";return d}function Ci(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var q1=/%/g;function OE(e,t,r){var n=t.replace(q1,""),i=t.length-n.length;return Zn(e,n,r*Math.pow(10,2*i))+jt("%",i)}function NE(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Zn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function K1(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+K1(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,a,c,d){return a+c+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var J1=/# (\?+)( ?)\/( ?)(\d+)/;function FE(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),l=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(l===0?jt(" ",e[1].length+1+e[4].length):N0(l,e[1].length)+e[2]+"/"+e[3]+bn(o,e[4].length))}function PE(e,t,r){return r+(t===0?"":""+t)+jt(" ",e[1].length+2+e[4].length)}var Q1=/^#*0*\.([0#]+)/,Z1=/\).*[0#]/,ey=/\(###\) ###\\?-####/;function kr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function sm(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function am(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function DE(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function jE(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Qr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Z1)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Qr("n",n,r):"("+Qr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return NE(e,t,r);if(t.indexOf("%")!==-1)return OE(e,t,r);if(t.indexOf("E")!==-1)return K1(t,r);if(t.charCodeAt(0)===36)return"$"+Qr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,l,o,a=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Ys(a,t.length);if(t.match(/^[#?]+$/))return i=Ys(r,0),i==="0"&&(i=""),i.length>t.length?i:kr(t.substr(0,t.length-i.length))+i;if(s=t.match(J1))return FE(s,a,c);if(t.match(/^#+0+$/))return c+Ys(a,t.length-t.indexOf("0"));if(s=t.match(Q1))return i=sm(r,s[1].length).replace(/^([^\.]+)$/,"$1."+kr(s[1])).replace(/\.$/,"."+kr(s[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+jt("0",kr(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+sm(a,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Ci(Ys(a,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Qr(e,t,-r):Ci(""+(Math.floor(r)+DE(r,s[1].length)))+"."+bn(am(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Qr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ka(Qr(e,t.replace(/[\\-]/g,""),r)),l=0,ka(ka(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return l<i.length?i.charAt(l++):g==="0"?"0":""}));if(t.match(ey))return i=Qr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),o=vu(a,Math.pow(10,l)-1,!1),i=""+c,d=Zn("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=mu(o[2],l),d.length<s[4].length&&(d=kr(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),o=vu(a,Math.pow(10,l)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?N0(o[1],l)+s[2]+"/"+s[3]+mu(o[2],l):jt(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=Ys(r,0),t.length<=i.length?i:kr(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=i.indexOf(".");var f=t.indexOf(".")-l,h=t.length-i.length-f;return kr(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return l=am(r,s[1].length),r<0?"-"+Qr(e,t,-r):Ci(jE(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?bn(0,3-g.length):"")+g})+"."+bn(l,s[1].length);switch(t){case"###,##0.00":return Qr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var u=Ci(Ys(a,0));return u!=="0"?c+u:"";case"###,###.00":return Qr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Qr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function RE(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Zn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function IE(e,t,r){var n=t.replace(q1,""),i=t.length-n.length;return Zn(e,n,r*Math.pow(10,2*i))+jt("%",i)}function ty(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+ty(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,a,c,d){return a+c+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Fn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Z1)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Fn("n",n,r):"("+Fn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return RE(e,t,r);if(t.indexOf("%")!==-1)return IE(e,t,r);if(t.indexOf("E")!==-1)return ty(t,r);if(t.charCodeAt(0)===36)return"$"+Fn(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,l,o,a=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+bn(a,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:kr(t.substr(0,t.length-i.length))+i;if(s=t.match(J1))return PE(s,a,c);if(t.match(/^#+0+$/))return c+bn(a,t.length-t.indexOf("0"));if(s=t.match(Q1))return i=(""+r).replace(/^([^\.]+)$/,"$1."+kr(s[1])).replace(/\.$/,"."+kr(s[1])),i=i.replace(/\.(\d*)$/,function(g,m){return"."+m+jt("0",kr(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+a).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Ci(""+a);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Fn(e,t,-r):Ci(""+r)+"."+jt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Fn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ka(Fn(e,t.replace(/[\\-]/g,""),r)),l=0,ka(ka(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return l<i.length?i.charAt(l++):g==="0"?"0":""}));if(t.match(ey))return i=Fn(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),o=vu(a,Math.pow(10,l)-1,!1),i=""+c,d=Zn("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=mu(o[2],l),d.length<s[4].length&&(d=kr(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),o=vu(a,Math.pow(10,l)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?N0(o[1],l)+s[2]+"/"+s[3]+mu(o[2],l):jt(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:kr(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=i.indexOf(".");var f=t.indexOf(".")-l,h=t.length-i.length-f;return kr(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Fn(e,t,-r):Ci(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?bn(0,3-g.length):"")+g})+"."+bn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var u=Ci(""+a);return u!=="0"?c+u:"";default:if(t.match(/\.[0#?]*$/))return Fn(e,t.slice(0,t.lastIndexOf(".")),r)+kr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Zn(e,t,r){return(r|0)===r?Fn(e,t,r):Qr(e,t,r)}function ME(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var ry=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function $a(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":xu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(ry))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function LE(e,t,r,n){for(var i=[],s="",l=0,o="",a="t",c,d,f,h="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!xu(e,l))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(f=e.charCodeAt(++l))!==34&&l<e.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++l;break;case"\\":var u=e.charAt(++l),g=u==="("||u===")"?u:"t";i[i.length]={t:g,v:u},++l;break;case"_":i[i.length]={t:"t",v:" "},l+=2;break;case"@":i[i.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(c==null&&(c=fs(t,r,e.charAt(l+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(l,2)},a=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=fs(t,r),c==null))return"";for(s=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)s+=o;o==="m"&&a.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),i[i.length]={t:o,v:s},a=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=fs(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",h="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",l+=5,h="h"):e.substr(l,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",l+=5,h="h"):(m.t="t",++l),c==null&&m.t==="T")return"";i[i.length]=m,a=o;break;case"[":for(s=o;e.charAt(l++)!=="]"&&l<e.length;)s+=e.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(ry)){if(c==null&&(c=fs(t,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},a=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",$a(e)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++l<e.length&&(o=e.charAt(l))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++l)===o;)s+=o;i[i.length]={t:o,v:s},a=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)s+=e.charAt(l);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++l;break;case"$":i[i.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++l;break}var p=0,x=0,v;for(l=i.length-1,a="t";l>=0;--l)switch(i[l].t){case"h":case"H":i[l].t=h,a="h",p<1&&(p=1);break;case"s":(v=i[l].v.match(/\.0+$/))&&(x=Math.max(x,v[0].length-1)),p<3&&(p=3);case"d":case"y":case"M":case"e":a=i[l].t;break;case"m":a==="s"&&(i[l].t="M",p<2&&(p=2));break;case"X":break;case"Z":p<1&&i[l].v.match(/[Hh]/)&&(p=1),p<2&&i[l].v.match(/[Mm]/)&&(p=2),p<3&&i[l].v.match(/[Ss]/)&&(p=3)}switch(p){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",_;for(l=0;l<i.length;++l)switch(i[l].t){case"t":case"T":case" ":case"D":break;case"X":i[l].v="",i[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[l].v=AE(i[l].t.charCodeAt(0),i[l].v,c,x),i[l].t="t";break;case"n":case"?":for(_=l+1;i[_]!=null&&((o=i[_].t)==="?"||o==="D"||(o===" "||o==="t")&&i[_+1]!=null&&(i[_+1].t==="?"||i[_+1].t==="t"&&i[_+1].v==="/")||i[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[_].v==="/"||i[_].v===" "&&i[_+1]!=null&&i[_+1].t=="?"));)i[l].v+=i[_].v,i[_]={v:"",t:";"},++_;y+=i[l].v,l=_-1;break;case"G":i[l].t="t",i[l].v=Ts(t,r);break}var b="",S,C;if(y.length>0){y.charCodeAt(0)==40?(S=t<0&&y.charCodeAt(0)===45?-t:t,C=Zn("n",y,S)):(S=t<0&&n>1?-t:t,C=Zn("n",y,S),S<0&&i[0]&&i[0].t=="t"&&(C=C.substr(1),i[0].v="-"+i[0].v)),_=C.length-1;var N=i.length;for(l=0;l<i.length;++l)if(i[l]!=null&&i[l].t!="t"&&i[l].v.indexOf(".")>-1){N=l;break}var F=i.length;if(N===i.length&&C.indexOf("E")===-1){for(l=i.length-1;l>=0;--l)i[l]==null||"n?".indexOf(i[l].t)===-1||(_>=i[l].v.length-1?(_-=i[l].v.length,i[l].v=C.substr(_+1,i[l].v.length)):_<0?i[l].v="":(i[l].v=C.substr(0,_+1),_=-1),i[l].t="t",F=l);_>=0&&F<i.length&&(i[F].v=C.substr(0,_+1)+i[F].v)}else if(N!==i.length&&C.indexOf("E")===-1){for(_=C.indexOf(".")-1,l=N;l>=0;--l)if(!(i[l]==null||"n?".indexOf(i[l].t)===-1)){for(d=i[l].v.indexOf(".")>-1&&l===N?i[l].v.indexOf(".")-1:i[l].v.length-1,b=i[l].v.substr(d+1);d>=0;--d)_>=0&&(i[l].v.charAt(d)==="0"||i[l].v.charAt(d)==="#")&&(b=C.charAt(_--)+b);i[l].v=b,i[l].t="t",F=l}for(_>=0&&F<i.length&&(i[F].v=C.substr(0,_+1)+i[F].v),_=C.indexOf(".")+1,l=N;l<i.length;++l)if(!(i[l]==null||"n?(".indexOf(i[l].t)===-1&&l!==N)){for(d=i[l].v.indexOf(".")>-1&&l===N?i[l].v.indexOf(".")+1:0,b=i[l].v.substr(0,d);d<i[l].v.length;++d)_<C.length&&(b+=C.charAt(_++));i[l].v=b,i[l].t="t",F=l}}}for(l=0;l<i.length;++l)i[l]!=null&&"n?".indexOf(i[l].t)>-1&&(S=n>1&&t<0&&l>0&&i[l-1].v==="-"?-t:t,i[l].v=Zn(i[l].t,i[l].v,S),i[l].t="t");var Y="";for(l=0;l!==i.length;++l)i[l]!=null&&(Y+=i[l].v);return Y}var om=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function lm(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function BE(e,t){var r=ME(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(om),o=r[1].match(om);return lm(t,l)?[n,r[0]]:lm(t,o)?[n,r[1]]:[n,r[l!=null&&o!=null?2:1]]}return[n,s]}function hn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ze)[e],n==null&&(n=r.table&&r.table[im[e]]||ze[im[e]]),n==null&&(n=_E[e]||"General");break}if(xu(n,0))return Ts(t,r);t instanceof Date&&(t=G1(t,r.date1904));var i=BE(n,t);if(xu(i[1]))return Ts(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return LE(i[1],t,r,i[0])}function ei(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ze[r]==null){t<0&&(t=r);continue}if(ze[r]==e){t=r;break}}t<0&&(t=391)}return ze[t]=e,t}function Qu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&ei(e[t],t)}function Xa(){ze=wE()}var UE={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ny=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function WE(e){var t=typeof e=="number"?ze[e]:e;return t=t.replace(ny,"(\\d+)"),new RegExp("^"+t+"$")}function zE(e,t,r){var n=-1,i=-1,s=-1,l=-1,o=-1,a=-1;(t.match(ny)||[]).forEach(function(f,h){var u=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=u;break;case"d":s=u;break;case"h":l=u;break;case"s":a=u;break;case"m":l>=0?o=u:i=u;break}}),a>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var d=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2);return l==-1&&o==-1&&a==-1?c:n==-1&&i==-1&&s==-1?d:c+"T"+d}var HE=function(){var e={};e.version="1.2.0";function t(){for(var C=0,N=new Array(256),F=0;F!=256;++F)C=F,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,N[F]=C;return typeof Int32Array<"u"?new Int32Array(N):N}var r=t();function n(C){var N=0,F=0,Y=0,X=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Y=0;Y!=256;++Y)X[Y]=C[Y];for(Y=0;Y!=256;++Y)for(F=C[Y],N=256+Y;N<4096;N+=256)F=X[N]=F>>>8^C[F&255];var V=[];for(Y=1;Y!=16;++Y)V[Y-1]=typeof Int32Array<"u"?X.subarray(Y*256,Y*256+256):X.slice(Y*256,Y*256+256);return V}var i=n(r),s=i[0],l=i[1],o=i[2],a=i[3],c=i[4],d=i[5],f=i[6],h=i[7],u=i[8],g=i[9],m=i[10],p=i[11],x=i[12],v=i[13],y=i[14];function _(C,N){for(var F=N^-1,Y=0,X=C.length;Y<X;)F=F>>>8^r[(F^C.charCodeAt(Y++))&255];return~F}function b(C,N){for(var F=N^-1,Y=C.length-15,X=0;X<Y;)F=y[C[X++]^F&255]^v[C[X++]^F>>8&255]^x[C[X++]^F>>16&255]^p[C[X++]^F>>>24]^m[C[X++]]^g[C[X++]]^u[C[X++]]^h[C[X++]]^f[C[X++]]^d[C[X++]]^c[C[X++]]^a[C[X++]]^o[C[X++]]^l[C[X++]]^s[C[X++]]^r[C[X++]];for(Y+=15;X<Y;)F=F>>>8^r[(F^C[X++])&255];return~F}function S(C,N){for(var F=N^-1,Y=0,X=C.length,V=0,te=0;Y<X;)V=C.charCodeAt(Y++),V<128?F=F>>>8^r[(F^V)&255]:V<2048?(F=F>>>8^r[(F^(192|V>>6&31))&255],F=F>>>8^r[(F^(128|V&63))&255]):V>=55296&&V<57344?(V=(V&1023)+64,te=C.charCodeAt(Y++)&1023,F=F>>>8^r[(F^(240|V>>8&7))&255],F=F>>>8^r[(F^(128|V>>2&63))&255],F=F>>>8^r[(F^(128|te>>6&15|(V&3)<<4))&255],F=F>>>8^r[(F^(128|te&63))&255]):(F=F>>>8^r[(F^(224|V>>12&15))&255],F=F>>>8^r[(F^(128|V>>6&63))&255],F=F>>>8^r[(F^(128|V&63))&255]);return~F}return e.table=r,e.bstr=_,e.buf=b,e.str=S,e}(),Me=function(){var t={};t.version="1.2.1";function r(W,ne){for(var q=W.split("/"),Q=ne.split("/"),ie=0,ae=0,de=Math.min(q.length,Q.length);ie<de;++ie){if(ae=q[ie].length-Q[ie].length)return ae;if(q[ie]!=Q[ie])return q[ie]<Q[ie]?-1:1}return q.length-Q.length}function n(W){if(W.charAt(W.length-1)=="/")return W.slice(0,-1).indexOf("/")===-1?W:n(W.slice(0,-1));var ne=W.lastIndexOf("/");return ne===-1?W:W.slice(0,ne+1)}function i(W){if(W.charAt(W.length-1)=="/")return i(W.slice(0,-1));var ne=W.lastIndexOf("/");return ne===-1?W:W.slice(ne+1)}function s(W,ne){typeof ne=="string"&&(ne=new Date(ne));var q=ne.getHours();q=q<<6|ne.getMinutes(),q=q<<5|ne.getSeconds()>>>1,W.write_shift(2,q);var Q=ne.getFullYear()-1980;Q=Q<<4|ne.getMonth()+1,Q=Q<<5|ne.getDate(),W.write_shift(2,Q)}function l(W){var ne=W.read_shift(2)&65535,q=W.read_shift(2)&65535,Q=new Date,ie=q&31;q>>>=5;var ae=q&15;q>>>=4,Q.setMilliseconds(0),Q.setFullYear(q+1980),Q.setMonth(ae-1),Q.setDate(ie);var de=ne&31;ne>>>=5;var ye=ne&63;return ne>>>=6,Q.setHours(ne),Q.setMinutes(ye),Q.setSeconds(de<<1),Q}function o(W){ar(W,0);for(var ne={},q=0;W.l<=W.length-4;){var Q=W.read_shift(2),ie=W.read_shift(2),ae=W.l+ie,de={};switch(Q){case 21589:q=W.read_shift(1),q&1&&(de.mtime=W.read_shift(4)),ie>5&&(q&2&&(de.atime=W.read_shift(4)),q&4&&(de.ctime=W.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}W.l=ae,ne[Q]=de}return ne}var a;function c(){return a||(a={})}function d(W,ne){if(W[0]==80&&W[1]==75)return mg(W,ne);if((W[0]|32)==109&&(W[1]|32)==105)return b_(W,ne);if(W.length<512)throw new Error("CFB file size "+W.length+" < 512");var q=3,Q=512,ie=0,ae=0,de=0,ye=0,he=0,ge=[],pe=W.slice(0,512);ar(pe,0);var Se=f(pe);switch(q=Se[0],q){case 3:Q=512;break;case 4:Q=4096;break;case 0:if(Se[1]==0)return mg(W,ne);default:throw new Error("Major Version: Expected 3 or 4 saw "+q)}Q!==512&&(pe=W.slice(0,Q),ar(pe,28));var Oe=W.slice(0,Q);h(pe,q);var Fe=pe.read_shift(4,"i");if(q===3&&Fe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Fe);pe.l+=4,de=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),ye=pe.read_shift(4,"i"),ie=pe.read_shift(4,"i"),he=pe.read_shift(4,"i"),ae=pe.read_shift(4,"i");for(var Te=-1,Ne=0;Ne<109&&(Te=pe.read_shift(4,"i"),!(Te<0));++Ne)ge[Ne]=Te;var qe=u(W,Q);p(he,ae,qe,Q,ge);var kt=v(qe,de,ge,Q);kt[de].name="!Directory",ie>0&&ye!==te&&(kt[ye].name="!MiniFAT"),kt[ge[0]].name="!FAT",kt.fat_addrs=ge,kt.ssz=Q;var Ct={},ur=[],qa=[],Ka=[];y(de,kt,qe,ur,ie,Ct,qa,ye),g(qa,Ka,ur),ur.shift();var Ja={FileIndex:qa,FullPaths:Ka};return ne&&ne.raw&&(Ja.raw={header:Oe,sectors:qe}),Ja}function f(W){if(W[W.l]==80&&W[W.l+1]==75)return[0,0];W.chk(G,"Header Signature: "),W.l+=16;var ne=W.read_shift(2,"u");return[W.read_shift(2,"u"),ne]}function h(W,ne){var q=9;switch(W.l+=2,q=W.read_shift(2)){case 9:if(ne!=3)throw new Error("Sector Shift: Expected 9 saw "+q);break;case 12:if(ne!=4)throw new Error("Sector Shift: Expected 12 saw "+q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+q)}W.chk("0600","Mini Sector Shift: "),W.chk("000000000000","Reserved: ")}function u(W,ne){for(var q=Math.ceil(W.length/ne)-1,Q=[],ie=1;ie<q;++ie)Q[ie-1]=W.slice(ie*ne,(ie+1)*ne);return Q[q-1]=W.slice(q*ne),Q}function g(W,ne,q){for(var Q=0,ie=0,ae=0,de=0,ye=0,he=q.length,ge=[],pe=[];Q<he;++Q)ge[Q]=pe[Q]=Q,ne[Q]=q[Q];for(;ye<pe.length;++ye)Q=pe[ye],ie=W[Q].L,ae=W[Q].R,de=W[Q].C,ge[Q]===Q&&(ie!==-1&&ge[ie]!==ie&&(ge[Q]=ge[ie]),ae!==-1&&ge[ae]!==ae&&(ge[Q]=ge[ae])),de!==-1&&(ge[de]=Q),ie!==-1&&Q!=ge[Q]&&(ge[ie]=ge[Q],pe.lastIndexOf(ie)<ye&&pe.push(ie)),ae!==-1&&Q!=ge[Q]&&(ge[ae]=ge[Q],pe.lastIndexOf(ae)<ye&&pe.push(ae));for(Q=1;Q<he;++Q)ge[Q]===Q&&(ae!==-1&&ge[ae]!==ae?ge[Q]=ge[ae]:ie!==-1&&ge[ie]!==ie&&(ge[Q]=ge[ie]));for(Q=1;Q<he;++Q)if(W[Q].type!==0){if(ye=Q,ye!=ge[ye])do ye=ge[ye],ne[Q]=ne[ye]+"/"+ne[Q];while(ye!==0&&ge[ye]!==-1&&ye!=ge[ye]);ge[Q]=-1}for(ne[0]+="/",Q=1;Q<he;++Q)W[Q].type!==2&&(ne[Q]+="/")}function m(W,ne,q){for(var Q=W.start,ie=W.size,ae=[],de=Q;q&&ie>0&&de>=0;)ae.push(ne.slice(de*V,de*V+V)),ie-=V,de=as(q,de*4);return ae.length===0?me(0):Zt(ae).slice(0,W.size)}function p(W,ne,q,Q,ie){var ae=te;if(W===te){if(ne!==0)throw new Error("DIFAT chain shorter than expected")}else if(W!==-1){var de=q[W],ye=(Q>>>2)-1;if(!de)return;for(var he=0;he<ye&&(ae=as(de,he*4))!==te;++he)ie.push(ae);p(as(de,Q-4),ne-1,q,Q,ie)}}function x(W,ne,q,Q,ie){var ae=[],de=[];ie||(ie=[]);var ye=Q-1,he=0,ge=0;for(he=ne;he>=0;){ie[he]=!0,ae[ae.length]=he,de.push(W[he]);var pe=q[Math.floor(he*4/Q)];if(ge=he*4&ye,Q<4+ge)throw new Error("FAT boundary crossed: "+he+" 4 "+Q);if(!W[pe])break;he=as(W[pe],ge)}return{nodes:ae,data:wm([de])}}function v(W,ne,q,Q){var ie=W.length,ae=[],de=[],ye=[],he=[],ge=Q-1,pe=0,Se=0,Oe=0,Fe=0;for(pe=0;pe<ie;++pe)if(ye=[],Oe=pe+ne,Oe>=ie&&(Oe-=ie),!de[Oe]){he=[];var Te=[];for(Se=Oe;Se>=0;){Te[Se]=!0,de[Se]=!0,ye[ye.length]=Se,he.push(W[Se]);var Ne=q[Math.floor(Se*4/Q)];if(Fe=Se*4&ge,Q<4+Fe)throw new Error("FAT boundary crossed: "+Se+" 4 "+Q);if(!W[Ne]||(Se=as(W[Ne],Fe),Te[Se]))break}ae[Oe]={nodes:ye,data:wm([he])}}return ae}function y(W,ne,q,Q,ie,ae,de,ye){for(var he=0,ge=Q.length?2:0,pe=ne[W].data,Se=0,Oe=0,Fe;Se<pe.length;Se+=128){var Te=pe.slice(Se,Se+128);ar(Te,64),Oe=Te.read_shift(2),Fe=L0(Te,0,Oe-ge),Q.push(Fe);var Ne={name:Fe,type:Te.read_shift(1),color:Te.read_shift(1),L:Te.read_shift(4,"i"),R:Te.read_shift(4,"i"),C:Te.read_shift(4,"i"),clsid:Te.read_shift(16),state:Te.read_shift(4,"i"),start:0,size:0},qe=Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2);qe!==0&&(Ne.ct=_(Te,Te.l-8));var kt=Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2);kt!==0&&(Ne.mt=_(Te,Te.l-8)),Ne.start=Te.read_shift(4,"i"),Ne.size=Te.read_shift(4,"i"),Ne.size<0&&Ne.start<0&&(Ne.size=Ne.type=0,Ne.start=te,Ne.name=""),Ne.type===5?(he=Ne.start,ie>0&&he!==te&&(ne[he].name="!StreamData")):Ne.size>=4096?(Ne.storage="fat",ne[Ne.start]===void 0&&(ne[Ne.start]=x(q,Ne.start,ne.fat_addrs,ne.ssz)),ne[Ne.start].name=Ne.name,Ne.content=ne[Ne.start].data.slice(0,Ne.size)):(Ne.storage="minifat",Ne.size<0?Ne.size=0:he!==te&&Ne.start!==te&&ne[he]&&(Ne.content=m(Ne,ne[he].data,(ne[ye]||{}).data))),Ne.content&&ar(Ne.content,0),ae[Fe]=Ne,de.push(Ne)}}function _(W,ne){return new Date((zr(W,ne+4)/1e7*Math.pow(2,32)+zr(W,ne)/1e7-11644473600)*1e3)}function b(W,ne){return c(),d(a.readFileSync(W),ne)}function S(W,ne){var q=ne&&ne.type;switch(q||Qe&&Buffer.isBuffer(W)&&(q="buffer"),q||"base64"){case"file":return b(W,ne);case"base64":return d(Hr(Gr(W)),ne);case"binary":return d(Hr(W),ne)}return d(W,ne)}function C(W,ne){var q=ne||{},Q=q.root||"Root Entry";if(W.FullPaths||(W.FullPaths=[]),W.FileIndex||(W.FileIndex=[]),W.FullPaths.length!==W.FileIndex.length)throw new Error("inconsistent CFB structure");W.FullPaths.length===0&&(W.FullPaths[0]=Q+"/",W.FileIndex[0]={name:Q,type:5}),q.CLSID&&(W.FileIndex[0].clsid=q.CLSID),N(W)}function N(W){var ne="Sh33tJ5";if(!Me.find(W,"/"+ne)){var q=me(4);q[0]=55,q[1]=q[3]=50,q[2]=54,W.FileIndex.push({name:ne,type:2,content:q,size:4,L:69,R:69,C:69}),W.FullPaths.push(W.FullPaths[0]+ne),F(W)}}function F(W,ne){C(W);for(var q=!1,Q=!1,ie=W.FullPaths.length-1;ie>=0;--ie){var ae=W.FileIndex[ie];switch(ae.type){case 0:Q?q=!0:(W.FileIndex.pop(),W.FullPaths.pop());break;case 1:case 2:case 5:Q=!0,isNaN(ae.R*ae.L*ae.C)&&(q=!0),ae.R>-1&&ae.L>-1&&ae.R==ae.L&&(q=!0);break;default:q=!0;break}}if(!(!q&&!ne)){var de=new Date(1987,1,19),ye=0,he=Object.create?Object.create(null):{},ge=[];for(ie=0;ie<W.FullPaths.length;++ie)he[W.FullPaths[ie]]=!0,W.FileIndex[ie].type!==0&&ge.push([W.FullPaths[ie],W.FileIndex[ie]]);for(ie=0;ie<ge.length;++ie){var pe=n(ge[ie][0]);Q=he[pe],Q||(ge.push([pe,{name:i(pe).replace("/",""),type:1,clsid:Z,ct:de,mt:de,content:null}]),he[pe]=!0)}for(ge.sort(function(Fe,Te){return r(Fe[0],Te[0])}),W.FullPaths=[],W.FileIndex=[],ie=0;ie<ge.length;++ie)W.FullPaths[ie]=ge[ie][0],W.FileIndex[ie]=ge[ie][1];for(ie=0;ie<ge.length;++ie){var Se=W.FileIndex[ie],Oe=W.FullPaths[ie];if(Se.name=i(Oe).replace("/",""),Se.L=Se.R=Se.C=-(Se.color=1),Se.size=Se.content?Se.content.length:0,Se.start=0,Se.clsid=Se.clsid||Z,ie===0)Se.C=ge.length>1?1:-1,Se.size=0,Se.type=5;else if(Oe.slice(-1)=="/"){for(ye=ie+1;ye<ge.length&&n(W.FullPaths[ye])!=Oe;++ye);for(Se.C=ye>=ge.length?-1:ye,ye=ie+1;ye<ge.length&&n(W.FullPaths[ye])!=n(Oe);++ye);Se.R=ye>=ge.length?-1:ye,Se.type=1}else n(W.FullPaths[ie+1]||"")==n(Oe)&&(Se.R=ie+1),Se.type=2}}}function Y(W,ne){var q=ne||{};if(q.fileType=="mad")return S_(W,q);switch(F(W),q.fileType){case"zip":return m_(W,q)}var Q=function(Fe){for(var Te=0,Ne=0,qe=0;qe<Fe.FileIndex.length;++qe){var kt=Fe.FileIndex[qe];if(kt.content){var Ct=kt.content.length;Ct>0&&(Ct<4096?Te+=Ct+63>>6:Ne+=Ct+511>>9)}}for(var ur=Fe.FullPaths.length+3>>2,qa=Te+7>>3,Ka=Te+127>>7,Ja=qa+Ne+ur+Ka,Ji=Ja+127>>7,uf=Ji<=109?0:Math.ceil((Ji-109)/127);Ja+Ji+uf+127>>7>Ji;)uf=++Ji<=109?0:Math.ceil((Ji-109)/127);var Hn=[1,uf,Ji,Ka,ur,Ne,Te,0];return Fe.FileIndex[0].size=Te<<6,Hn[7]=(Fe.FileIndex[0].start=Hn[0]+Hn[1]+Hn[2]+Hn[3]+Hn[4]+Hn[5])+(Hn[6]+7>>3),Hn}(W),ie=me(Q[7]<<9),ae=0,de=0;{for(ae=0;ae<8;++ae)ie.write_shift(1,re[ae]);for(ae=0;ae<8;++ae)ie.write_shift(2,0);for(ie.write_shift(2,62),ie.write_shift(2,3),ie.write_shift(2,65534),ie.write_shift(2,9),ie.write_shift(2,6),ae=0;ae<3;++ae)ie.write_shift(2,0);for(ie.write_shift(4,0),ie.write_shift(4,Q[2]),ie.write_shift(4,Q[0]+Q[1]+Q[2]+Q[3]-1),ie.write_shift(4,0),ie.write_shift(4,4096),ie.write_shift(4,Q[3]?Q[0]+Q[1]+Q[2]-1:te),ie.write_shift(4,Q[3]),ie.write_shift(-4,Q[1]?Q[0]-1:te),ie.write_shift(4,Q[1]),ae=0;ae<109;++ae)ie.write_shift(-4,ae<Q[2]?Q[1]+ae:-1)}if(Q[1])for(de=0;de<Q[1];++de){for(;ae<236+de*127;++ae)ie.write_shift(-4,ae<Q[2]?Q[1]+ae:-1);ie.write_shift(-4,de===Q[1]-1?te:de+1)}var ye=function(Fe){for(de+=Fe;ae<de-1;++ae)ie.write_shift(-4,ae+1);Fe&&(++ae,ie.write_shift(-4,te))};for(de=ae=0,de+=Q[1];ae<de;++ae)ie.write_shift(-4,oe.DIFSECT);for(de+=Q[2];ae<de;++ae)ie.write_shift(-4,oe.FATSECT);ye(Q[3]),ye(Q[4]);for(var he=0,ge=0,pe=W.FileIndex[0];he<W.FileIndex.length;++he)pe=W.FileIndex[he],pe.content&&(ge=pe.content.length,!(ge<4096)&&(pe.start=de,ye(ge+511>>9)));for(ye(Q[6]+7>>3);ie.l&511;)ie.write_shift(-4,oe.ENDOFCHAIN);for(de=ae=0,he=0;he<W.FileIndex.length;++he)pe=W.FileIndex[he],pe.content&&(ge=pe.content.length,!(!ge||ge>=4096)&&(pe.start=de,ye(ge+63>>6)));for(;ie.l&511;)ie.write_shift(-4,oe.ENDOFCHAIN);for(ae=0;ae<Q[4]<<2;++ae){var Se=W.FullPaths[ae];if(!Se||Se.length===0){for(he=0;he<17;++he)ie.write_shift(4,0);for(he=0;he<3;++he)ie.write_shift(4,-1);for(he=0;he<12;++he)ie.write_shift(4,0);continue}pe=W.FileIndex[ae],ae===0&&(pe.start=pe.size?pe.start-1:te);var Oe=ae===0&&q.root||pe.name;if(ge=2*(Oe.length+1),ie.write_shift(64,Oe,"utf16le"),ie.write_shift(2,ge),ie.write_shift(1,pe.type),ie.write_shift(1,pe.color),ie.write_shift(-4,pe.L),ie.write_shift(-4,pe.R),ie.write_shift(-4,pe.C),pe.clsid)ie.write_shift(16,pe.clsid,"hex");else for(he=0;he<4;++he)ie.write_shift(4,0);ie.write_shift(4,pe.state||0),ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(4,pe.start),ie.write_shift(4,pe.size),ie.write_shift(4,0)}for(ae=1;ae<W.FileIndex.length;++ae)if(pe=W.FileIndex[ae],pe.size>=4096)if(ie.l=pe.start+1<<9,Qe&&Buffer.isBuffer(pe.content))pe.content.copy(ie,ie.l,0,pe.size),ie.l+=pe.size+511&-512;else{for(he=0;he<pe.size;++he)ie.write_shift(1,pe.content[he]);for(;he&511;++he)ie.write_shift(1,0)}for(ae=1;ae<W.FileIndex.length;++ae)if(pe=W.FileIndex[ae],pe.size>0&&pe.size<4096)if(Qe&&Buffer.isBuffer(pe.content))pe.content.copy(ie,ie.l,0,pe.size),ie.l+=pe.size+63&-64;else{for(he=0;he<pe.size;++he)ie.write_shift(1,pe.content[he]);for(;he&63;++he)ie.write_shift(1,0)}if(Qe)ie.l=ie.length;else for(;ie.l<ie.length;)ie.write_shift(1,0);return ie}function X(W,ne){var q=W.FullPaths.map(function(he){return he.toUpperCase()}),Q=q.map(function(he){var ge=he.split("/");return ge[ge.length-(he.slice(-1)=="/"?2:1)]}),ie=!1;ne.charCodeAt(0)===47?(ie=!0,ne=q[0].slice(0,-1)+ne):ie=ne.indexOf("/")!==-1;var ae=ne.toUpperCase(),de=ie===!0?q.indexOf(ae):Q.indexOf(ae);if(de!==-1)return W.FileIndex[de];var ye=!ae.match(mo);for(ae=ae.replace(Er,""),ye&&(ae=ae.replace(mo,"!")),de=0;de<q.length;++de)if((ye?q[de].replace(mo,"!"):q[de]).replace(Er,"")==ae||(ye?Q[de].replace(mo,"!"):Q[de]).replace(Er,"")==ae)return W.FileIndex[de];return null}var V=64,te=-2,G="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],Z="00000000000000000000000000000000",oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:te,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ee(W,ne,q){c();var Q=Y(W,q);a.writeFileSync(ne,Q)}function E(W){for(var ne=new Array(W.length),q=0;q<W.length;++q)ne[q]=String.fromCharCode(W[q]);return ne.join("")}function D(W,ne){var q=Y(W,ne);switch(ne&&ne.type||"buffer"){case"file":return c(),a.writeFileSync(ne.filename,q),q;case"binary":return typeof q=="string"?q:E(q);case"base64":return cl(typeof q=="string"?q:E(q));case"buffer":if(Qe)return Buffer.isBuffer(q)?q:ci(q);case"array":return typeof q=="string"?Hr(q):q}return q}var U;function k(W){try{var ne=W.InflateRaw,q=new ne;if(q._processChunk(new Uint8Array([3,0]),q._finishFlushFlag),q.bytesRead)U=W;else throw new Error("zlib does not expose bytesRead")}catch(Q){console.error("cannot use native zlib: "+(Q.message||Q))}}function P(W,ne){if(!U)return gg(W,ne);var q=U.InflateRaw,Q=new q,ie=Q._processChunk(W.slice(W.l),Q._finishFlushFlag);return W.l+=Q.bytesRead,ie}function A(W){return U?U.deflateRawSync(W):Le(W)}var T=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],j=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],R=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function z(W){var ne=(W<<1|W<<11)&139536|(W<<5|W<<15)&558144;return(ne>>16|ne>>8|ne)&255}for(var I=typeof Uint8Array<"u",L=I?new Uint8Array(256):[],K=0;K<256;++K)L[K]=z(K);function O(W,ne){var q=L[W&255];return ne<=8?q>>>8-ne:(q=q<<8|L[W>>8&255],ne<=16?q>>>16-ne:(q=q<<8|L[W>>16&255],q>>>24-ne))}function B(W,ne){var q=ne&7,Q=ne>>>3;return(W[Q]|(q<=6?0:W[Q+1]<<8))>>>q&3}function M(W,ne){var q=ne&7,Q=ne>>>3;return(W[Q]|(q<=5?0:W[Q+1]<<8))>>>q&7}function J(W,ne){var q=ne&7,Q=ne>>>3;return(W[Q]|(q<=4?0:W[Q+1]<<8))>>>q&15}function se(W,ne){var q=ne&7,Q=ne>>>3;return(W[Q]|(q<=3?0:W[Q+1]<<8))>>>q&31}function H(W,ne){var q=ne&7,Q=ne>>>3;return(W[Q]|(q<=1?0:W[Q+1]<<8))>>>q&127}function ce(W,ne,q){var Q=ne&7,ie=ne>>>3,ae=(1<<q)-1,de=W[ie]>>>Q;return q<8-Q||(de|=W[ie+1]<<8-Q,q<16-Q)||(de|=W[ie+2]<<16-Q,q<24-Q)||(de|=W[ie+3]<<24-Q),de&ae}function ue(W,ne,q){var Q=ne&7,ie=ne>>>3;return Q<=5?W[ie]|=(q&7)<<Q:(W[ie]|=q<<Q&255,W[ie+1]=(q&7)>>8-Q),ne+3}function xe(W,ne,q){var Q=ne&7,ie=ne>>>3;return q=(q&1)<<Q,W[ie]|=q,ne+1}function _e(W,ne,q){var Q=ne&7,ie=ne>>>3;return q<<=Q,W[ie]|=q&255,q>>>=8,W[ie+1]=q,ne+8}function fe(W,ne,q){var Q=ne&7,ie=ne>>>3;return q<<=Q,W[ie]|=q&255,q>>>=8,W[ie+1]=q&255,W[ie+2]=q>>>8,ne+16}function ve(W,ne){var q=W.length,Q=2*q>ne?2*q:ne+5,ie=0;if(q>=ne)return W;if(Qe){var ae=tm(Q);if(W.copy)W.copy(ae);else for(;ie<W.length;++ie)ae[ie]=W[ie];return ae}else if(I){var de=new Uint8Array(Q);if(de.set)de.set(W);else for(;ie<q;++ie)de[ie]=W[ie];return de}return W.length=Q,W}function Ce(W){for(var ne=new Array(W),q=0;q<W;++q)ne[q]=0;return ne}function De(W,ne,q){var Q=1,ie=0,ae=0,de=0,ye=0,he=W.length,ge=I?new Uint16Array(32):Ce(32);for(ae=0;ae<32;++ae)ge[ae]=0;for(ae=he;ae<q;++ae)W[ae]=0;he=W.length;var pe=I?new Uint16Array(he):Ce(he);for(ae=0;ae<he;++ae)ge[ie=W[ae]]++,Q<ie&&(Q=ie),pe[ae]=0;for(ge[0]=0,ae=1;ae<=Q;++ae)ge[ae+16]=ye=ye+ge[ae-1]<<1;for(ae=0;ae<he;++ae)ye=W[ae],ye!=0&&(pe[ae]=ge[ye+16]++);var Se=0;for(ae=0;ae<he;++ae)if(Se=W[ae],Se!=0)for(ye=O(pe[ae],Q)>>Q-Se,de=(1<<Q+4-Se)-1;de>=0;--de)ne[ye|de<<Se]=Se&15|ae<<4;return Q}var je=I?new Uint16Array(512):Ce(512),Ie=I?new Uint16Array(32):Ce(32);if(!I){for(var Ye=0;Ye<512;++Ye)je[Ye]=0;for(Ye=0;Ye<32;++Ye)Ie[Ye]=0}(function(){for(var W=[],ne=0;ne<32;ne++)W.push(5);De(W,Ie,32);var q=[];for(ne=0;ne<=143;ne++)q.push(8);for(;ne<=255;ne++)q.push(9);for(;ne<=279;ne++)q.push(7);for(;ne<=287;ne++)q.push(8);De(q,je,288)})();var et=function(){for(var ne=I?new Uint8Array(32768):[],q=0,Q=0;q<R.length-1;++q)for(;Q<R[q+1];++Q)ne[Q]=q;for(;Q<32768;++Q)ne[Q]=29;var ie=I?new Uint8Array(259):[];for(q=0,Q=0;q<j.length-1;++q)for(;Q<j[q+1];++Q)ie[Q]=q;function ae(ye,he){for(var ge=0;ge<ye.length;){var pe=Math.min(65535,ye.length-ge),Se=ge+pe==ye.length;for(he.write_shift(1,+Se),he.write_shift(2,pe),he.write_shift(2,~pe&65535);pe-- >0;)he[he.l++]=ye[ge++]}return he.l}function de(ye,he){for(var ge=0,pe=0,Se=I?new Uint16Array(32768):[];pe<ye.length;){var Oe=Math.min(65535,ye.length-pe);if(Oe<10){for(ge=ue(he,ge,+(pe+Oe==ye.length)),ge&7&&(ge+=8-(ge&7)),he.l=ge/8|0,he.write_shift(2,Oe),he.write_shift(2,~Oe&65535);Oe-- >0;)he[he.l++]=ye[pe++];ge=he.l*8;continue}ge=ue(he,ge,+(pe+Oe==ye.length)+2);for(var Fe=0;Oe-- >0;){var Te=ye[pe];Fe=(Fe<<5^Te)&32767;var Ne=-1,qe=0;if((Ne=Se[Fe])&&(Ne|=pe&-32768,Ne>pe&&(Ne-=32768),Ne<pe))for(;ye[Ne+qe]==ye[pe+qe]&&qe<250;)++qe;if(qe>2){Te=ie[qe],Te<=22?ge=_e(he,ge,L[Te+1]>>1)-1:(_e(he,ge,3),ge+=5,_e(he,ge,L[Te-23]>>5),ge+=3);var kt=Te<8?0:Te-4>>2;kt>0&&(fe(he,ge,qe-j[Te]),ge+=kt),Te=ne[pe-Ne],ge=_e(he,ge,L[Te]>>3),ge-=3;var Ct=Te<4?0:Te-2>>1;Ct>0&&(fe(he,ge,pe-Ne-R[Te]),ge+=Ct);for(var ur=0;ur<qe;++ur)Se[Fe]=pe&32767,Fe=(Fe<<5^ye[pe])&32767,++pe;Oe-=qe-1}else Te<=143?Te=Te+48:ge=xe(he,ge,1),ge=_e(he,ge,L[Te]),Se[Fe]=pe&32767,++pe}ge=_e(he,ge,0)-1}return he.l=(ge+7)/8|0,he.l}return function(he,ge){return he.length<8?ae(he,ge):de(he,ge)}}();function Le(W){var ne=me(50+Math.floor(W.length*1.1)),q=et(W,ne);return ne.slice(0,q)}var ot=I?new Uint16Array(32768):Ce(32768),gt=I?new Uint16Array(32768):Ce(32768),Ge=I?new Uint16Array(128):Ce(128),Lr=1,hi=1;function lf(W,ne){var q=se(W,ne)+257;ne+=5;var Q=se(W,ne)+1;ne+=5;var ie=J(W,ne)+4;ne+=4;for(var ae=0,de=I?new Uint8Array(19):Ce(19),ye=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],he=1,ge=I?new Uint8Array(8):Ce(8),pe=I?new Uint8Array(8):Ce(8),Se=de.length,Oe=0;Oe<ie;++Oe)de[T[Oe]]=ae=M(W,ne),he<ae&&(he=ae),ge[ae]++,ne+=3;var Fe=0;for(ge[0]=0,Oe=1;Oe<=he;++Oe)pe[Oe]=Fe=Fe+ge[Oe-1]<<1;for(Oe=0;Oe<Se;++Oe)(Fe=de[Oe])!=0&&(ye[Oe]=pe[Fe]++);var Te=0;for(Oe=0;Oe<Se;++Oe)if(Te=de[Oe],Te!=0){Fe=L[ye[Oe]]>>8-Te;for(var Ne=(1<<7-Te)-1;Ne>=0;--Ne)Ge[Fe|Ne<<Te]=Te&7|Oe<<3}var qe=[];for(he=1;qe.length<q+Q;)switch(Fe=Ge[H(W,ne)],ne+=Fe&7,Fe>>>=3){case 16:for(ae=3+B(W,ne),ne+=2,Fe=qe[qe.length-1];ae-- >0;)qe.push(Fe);break;case 17:for(ae=3+M(W,ne),ne+=3;ae-- >0;)qe.push(0);break;case 18:for(ae=11+H(W,ne),ne+=7;ae-- >0;)qe.push(0);break;default:qe.push(Fe),he<Fe&&(he=Fe);break}var kt=qe.slice(0,q),Ct=qe.slice(q);for(Oe=q;Oe<286;++Oe)kt[Oe]=0;for(Oe=Q;Oe<30;++Oe)Ct[Oe]=0;return Lr=De(kt,ot,286),hi=De(Ct,gt,30),ne}function g_(W,ne){if(W[0]==3&&!(W[1]&3))return[Wi(ne),2];for(var q=0,Q=0,ie=tm(ne||1<<18),ae=0,de=ie.length>>>0,ye=0,he=0;!(Q&1);){if(Q=M(W,q),q+=3,Q>>>1)Q>>1==1?(ye=9,he=5):(q=lf(W,q),ye=Lr,he=hi);else{q&7&&(q+=8-(q&7));var ge=W[q>>>3]|W[(q>>>3)+1]<<8;if(q+=32,ge>0)for(!ne&&de<ae+ge&&(ie=ve(ie,ae+ge),de=ie.length);ge-- >0;)ie[ae++]=W[q>>>3],q+=8;continue}for(;;){!ne&&de<ae+32767&&(ie=ve(ie,ae+32767),de=ie.length);var pe=ce(W,q,ye),Se=Q>>>1==1?je[pe]:ot[pe];if(q+=Se&15,Se>>>=4,!(Se>>>8&255))ie[ae++]=Se;else{if(Se==256)break;Se-=257;var Oe=Se<8?0:Se-4>>2;Oe>5&&(Oe=0);var Fe=ae+j[Se];Oe>0&&(Fe+=ce(W,q,Oe),q+=Oe),pe=ce(W,q,he),Se=Q>>>1==1?Ie[pe]:gt[pe],q+=Se&15,Se>>>=4;var Te=Se<4?0:Se-2>>1,Ne=R[Se];for(Te>0&&(Ne+=ce(W,q,Te),q+=Te),!ne&&de<Fe&&(ie=ve(ie,Fe+100),de=ie.length);ae<Fe;)ie[ae]=ie[ae-Ne],++ae}}}return ne?[ie,q+7>>>3]:[ie.slice(0,ae),q+7>>>3]}function gg(W,ne){var q=W.slice(W.l||0),Q=g_(q,ne);return W.l+=Q[1],Q[0]}function pg(W,ne){if(W)typeof console<"u"&&console.error(ne);else throw new Error(ne)}function mg(W,ne){var q=W;ar(q,0);var Q=[],ie=[],ae={FileIndex:Q,FullPaths:ie};C(ae,{root:ne.root});for(var de=q.length-4;(q[de]!=80||q[de+1]!=75||q[de+2]!=5||q[de+3]!=6)&&de>=0;)--de;q.l=de+4,q.l+=4;var ye=q.read_shift(2);q.l+=6;var he=q.read_shift(4);for(q.l=he,de=0;de<ye;++de){q.l+=20;var ge=q.read_shift(4),pe=q.read_shift(4),Se=q.read_shift(2),Oe=q.read_shift(2),Fe=q.read_shift(2);q.l+=8;var Te=q.read_shift(4),Ne=o(q.slice(q.l+Se,q.l+Se+Oe));q.l+=Se+Oe+Fe;var qe=q.l;q.l=Te+4,p_(q,ge,pe,ae,Ne),q.l=qe}return ae}function p_(W,ne,q,Q,ie){W.l+=2;var ae=W.read_shift(2),de=W.read_shift(2),ye=l(W);if(ae&8257)throw new Error("Unsupported ZIP encryption");for(var he=W.read_shift(4),ge=W.read_shift(4),pe=W.read_shift(4),Se=W.read_shift(2),Oe=W.read_shift(2),Fe="",Te=0;Te<Se;++Te)Fe+=String.fromCharCode(W[W.l++]);if(Oe){var Ne=o(W.slice(W.l,W.l+Oe));(Ne[21589]||{}).mt&&(ye=Ne[21589].mt),((ie||{})[21589]||{}).mt&&(ye=ie[21589].mt)}W.l+=Oe;var qe=W.slice(W.l,W.l+ge);switch(de){case 8:qe=P(W,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var kt=!1;ae&8&&(he=W.read_shift(4),he==134695760&&(he=W.read_shift(4),kt=!0),ge=W.read_shift(4),pe=W.read_shift(4)),ge!=ne&&pg(kt,"Bad compressed size: "+ne+" != "+ge),pe!=q&&pg(kt,"Bad uncompressed size: "+q+" != "+pe),cf(Q,Fe,qe,{unsafe:!0,mt:ye})}function m_(W,ne){var q=ne||{},Q=[],ie=[],ae=me(1),de=q.compression?8:0,ye=0,he=0,ge=0,pe=0,Se=0,Oe=W.FullPaths[0],Fe=Oe,Te=W.FileIndex[0],Ne=[],qe=0;for(he=1;he<W.FullPaths.length;++he)if(Fe=W.FullPaths[he].slice(Oe.length),Te=W.FileIndex[he],!(!Te.size||!Te.content||Fe=="Sh33tJ5")){var kt=pe,Ct=me(Fe.length);for(ge=0;ge<Fe.length;++ge)Ct.write_shift(1,Fe.charCodeAt(ge)&127);Ct=Ct.slice(0,Ct.l),Ne[Se]=HE.buf(Te.content,0);var ur=Te.content;de==8&&(ur=A(ur)),ae=me(30),ae.write_shift(4,67324752),ae.write_shift(2,20),ae.write_shift(2,ye),ae.write_shift(2,de),Te.mt?s(ae,Te.mt):ae.write_shift(4,0),ae.write_shift(-4,Ne[Se]),ae.write_shift(4,ur.length),ae.write_shift(4,Te.content.length),ae.write_shift(2,Ct.length),ae.write_shift(2,0),pe+=ae.length,Q.push(ae),pe+=Ct.length,Q.push(Ct),pe+=ur.length,Q.push(ur),ae=me(46),ae.write_shift(4,33639248),ae.write_shift(2,0),ae.write_shift(2,20),ae.write_shift(2,ye),ae.write_shift(2,de),ae.write_shift(4,0),ae.write_shift(-4,Ne[Se]),ae.write_shift(4,ur.length),ae.write_shift(4,Te.content.length),ae.write_shift(2,Ct.length),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(4,0),ae.write_shift(4,kt),qe+=ae.l,ie.push(ae),qe+=Ct.length,ie.push(Ct),++Se}return ae=me(22),ae.write_shift(4,101010256),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,Se),ae.write_shift(2,Se),ae.write_shift(4,qe),ae.write_shift(4,pe),ae.write_shift(2,0),Zt([Zt(Q),Zt(ie),ae])}var Hl={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function x_(W,ne){if(W.ctype)return W.ctype;var q=W.name||"",Q=q.match(/\.([^\.]+)$/);return Q&&Hl[Q[1]]||ne&&(Q=(q=ne).match(/[\.\\]([^\.\\])+$/),Q&&Hl[Q[1]])?Hl[Q[1]]:"application/octet-stream"}function v_(W){for(var ne=cl(W),q=[],Q=0;Q<ne.length;Q+=76)q.push(ne.slice(Q,Q+76));return q.join(`\r
`)+`\r
`}function y_(W){var ne=W.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ge){var pe=ge.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});ne=ne.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ne.charAt(0)==`
`&&(ne="=0D"+ne.slice(1)),ne=ne.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var q=[],Q=ne.split(`\r
`),ie=0;ie<Q.length;++ie){var ae=Q[ie];if(ae.length==0){q.push("");continue}for(var de=0;de<ae.length;){var ye=76,he=ae.slice(de,de+ye);he.charAt(ye-1)=="="?ye--:he.charAt(ye-2)=="="?ye-=2:he.charAt(ye-3)=="="&&(ye-=3),he=ae.slice(de,de+ye),de+=ye,de<ae.length&&(he+="="),q.push(he)}}return q.join(`\r
`)}function w_(W){for(var ne=[],q=0;q<W.length;++q){for(var Q=W[q];q<=W.length&&Q.charAt(Q.length-1)=="=";)Q=Q.slice(0,Q.length-1)+W[++q];ne.push(Q)}for(var ie=0;ie<ne.length;++ie)ne[ie]=ne[ie].replace(/[=][0-9A-Fa-f]{2}/g,function(ae){return String.fromCharCode(parseInt(ae.slice(1),16))});return Hr(ne.join(`\r
`))}function __(W,ne,q){for(var Q="",ie="",ae="",de,ye=0;ye<10;++ye){var he=ne[ye];if(!he||he.match(/^\s*$/))break;var ge=he.match(/^(.*?):\s*([^\s].*)$/);if(ge)switch(ge[1].toLowerCase()){case"content-location":Q=ge[2].trim();break;case"content-type":ae=ge[2].trim();break;case"content-transfer-encoding":ie=ge[2].trim();break}}switch(++ye,ie.toLowerCase()){case"base64":de=Hr(Gr(ne.slice(ye).join("")));break;case"quoted-printable":de=w_(ne.slice(ye));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ie)}var pe=cf(W,Q.slice(q.length),de,{unsafe:!0});ae&&(pe.ctype=ae)}function b_(W,ne){if(E(W.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var q=ne&&ne.root||"",Q=(Qe&&Buffer.isBuffer(W)?W.toString("binary"):E(W)).split(`\r
`),ie=0,ae="";for(ie=0;ie<Q.length;++ie)if(ae=Q[ie],!!/^Content-Location:/i.test(ae)&&(ae=ae.slice(ae.indexOf("file")),q||(q=ae.slice(0,ae.lastIndexOf("/")+1)),ae.slice(0,q.length)!=q))for(;q.length>0&&(q=q.slice(0,q.length-1),q=q.slice(0,q.lastIndexOf("/")+1),ae.slice(0,q.length)!=q););var de=(Q[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var ye="--"+(de[1]||""),he=[],ge=[],pe={FileIndex:he,FullPaths:ge};C(pe);var Se,Oe=0;for(ie=0;ie<Q.length;++ie){var Fe=Q[ie];Fe!==ye&&Fe!==ye+"--"||(Oe++&&__(pe,Q.slice(Se,ie),q),Se=ie)}return pe}function S_(W,ne){var q=ne||{},Q=q.boundary||"SheetJS";Q="------="+Q;for(var ie=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Q.slice(2)+'"',"","",""],ae=W.FullPaths[0],de=ae,ye=W.FileIndex[0],he=1;he<W.FullPaths.length;++he)if(de=W.FullPaths[he].slice(ae.length),ye=W.FileIndex[he],!(!ye.size||!ye.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(qe){return"_x"+qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(qe){return"_u"+qe.charCodeAt(0).toString(16)+"_"});for(var ge=ye.content,pe=Qe&&Buffer.isBuffer(ge)?ge.toString("binary"):E(ge),Se=0,Oe=Math.min(1024,pe.length),Fe=0,Te=0;Te<=Oe;++Te)(Fe=pe.charCodeAt(Te))>=32&&Fe<128&&++Se;var Ne=Se>=Oe*4/5;ie.push(Q),ie.push("Content-Location: "+(q.root||"file:///C:/SheetJS/")+de),ie.push("Content-Transfer-Encoding: "+(Ne?"quoted-printable":"base64")),ie.push("Content-Type: "+x_(ye,de)),ie.push(""),ie.push(Ne?y_(pe):v_(pe))}return ie.push(Q+`--\r
`),ie.join(`\r
`)}function k_(W){var ne={};return C(ne,W),ne}function cf(W,ne,q,Q){var ie=Q&&Q.unsafe;ie||C(W);var ae=!ie&&Me.find(W,ne);if(!ae){var de=W.FullPaths[0];ne.slice(0,de.length)==de?de=ne:(de.slice(-1)!="/"&&(de+="/"),de=(de+ne).replace("//","/")),ae={name:i(ne),type:2},W.FileIndex.push(ae),W.FullPaths.push(de),ie||Me.utils.cfb_gc(W)}return ae.content=q,ae.size=q?q.length:0,Q&&(Q.CLSID&&(ae.clsid=Q.CLSID),Q.mt&&(ae.mt=Q.mt),Q.ct&&(ae.ct=Q.ct)),ae}function C_(W,ne){C(W);var q=Me.find(W,ne);if(q){for(var Q=0;Q<W.FileIndex.length;++Q)if(W.FileIndex[Q]==q)return W.FileIndex.splice(Q,1),W.FullPaths.splice(Q,1),!0}return!1}function T_(W,ne,q){C(W);var Q=Me.find(W,ne);if(Q){for(var ie=0;ie<W.FileIndex.length;++ie)if(W.FileIndex[ie]==Q)return W.FileIndex[ie].name=i(q),W.FullPaths[ie]=q,!0}return!1}function E_(W){F(W,!0)}return t.find=X,t.read=S,t.parse=d,t.write=D,t.writeFile=ee,t.utils={cfb_new:k_,cfb_add:cf,cfb_del:C_,cfb_mov:T_,cfb_gc:E_,ReadShift:Oo,CheckField:Cy,prep_blob:ar,bconcat:Zt,use_zlib:k,_deflateRaw:Le,_inflateRaw:gg,consts:oe},t}();function VE(e){return typeof e=="string"?Ju(e):Array.isArray(e)?mE(e):e}function Pl(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Ju(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Mn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([VE(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Gi(t)),o.write(t),o.close(),t}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("cannot save file "+e)}function $E(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function It(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function cm(e,t){for(var r=[],n=It(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function Zu(e){for(var t=[],r=It(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function ef(e){for(var t=[],r=It(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function XE(e){for(var t=[],r=It(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var yu=new Date(1899,11,30,0,0,0);function Kt(e,t){var r=e.getTime(),n=yu.getTime()+(e.getTimezoneOffset()-yu.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var iy=new Date,YE=yu.getTime()+(iy.getTimezoneOffset()-yu.getTimezoneOffset())*6e4,um=iy.getTimezoneOffset();function tf(e){var t=new Date;return t.setTime(e*24*60*60*1e3+YE),t.getTimezoneOffset()!==um&&t.setTime(t.getTime()+(t.getTimezoneOffset()-um)*6e4),t}function GE(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var fm=new Date("2017-02-19T19:06:09.000Z"),sy=isNaN(fm.getFullYear())?new Date("2/19/17"):fm,qE=sy.getFullYear()==2017;function wt(e,t){var r=new Date(e);if(qE)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(sy.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Es(e,t){if(Qe&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Mn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Mn(X1(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Mn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Mn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function _t(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=_t(e[r]));return t}function jt(e,t){for(var r="";r.length<t;)r+=e;return r}function Cn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var KE=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ma(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&KE.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var JE=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),l=[s[0]],o=1;o<s.length;++o)l.push(i),l.push(s[o]);return l}}();function ay(e){return e?e.content&&e.type?Es(e.content,!0):e.data?po(e.data):e.asNodeBuffer&&Qe?po(e.asNodeBuffer().toString("binary")):e.asBinary?po(e.asBinary()):e._data&&e._data.getContent?po(Es(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function oy(e){if(!e)return null;if(e.data)return Zp(e.data);if(e.asNodeBuffer&&Qe)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Zp(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function QE(e){return e&&e.name.slice(-4)===".bin"?oy(e):ay(e)}function tn(e,t){for(var r=e.FullPaths||It(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var l=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||i==l)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function P0(e,t){var r=tn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function zt(e,t,r){if(!r)return QE(P0(e,t));if(!t)return null;try{return zt(e,t)}catch{return null}}function Vr(e,t,r){if(!r)return ay(P0(e,t));if(!t)return null;try{return Vr(e,t)}catch{return null}}function ZE(e,t,r){return oy(P0(e,t))}function hm(e){for(var t=e.FullPaths||It(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Je(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Qe?n=ci(r):n=xE(r),Me.utils.cfb_add(e,t,n)}Me.utils.cfb_add(e,t,r)}else e.file(t,r)}function D0(){return Me.utils.cfb_new()}function ly(e,t){switch(t.type){case"base64":return Me.read(e,{type:"base64"});case"binary":return Me.read(e,{type:"binary"});case"buffer":case"array":return Me.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function xo(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Ut=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,e4=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,dm=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,t4=/<[^>]*>/g,br=Ut.match(dm)?dm:t4,r4=/<\w*:/,n4=/<(\/?)\w+:/;function Xe(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var l=e.match(e4),o=0,a="",c=0,d="",f="",h=1;if(l)for(c=0;c!=l.length;++c){for(f=l[c],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(d=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(h=(i=f.charCodeAt(s+1))==34||i==39?1:0,a=f.slice(s+1+h,f.length-h),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=a,n[d.toLowerCase()]=a;else{var u=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[u]&&d.slice(o-3,o)=="ext")continue;n[u]=a,n[u.toLowerCase()]=a}}return n}function Wn(e){return e.replace(n4,"<$1")}var cy={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},j0=Zu(cy),nt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(o,a){return cy[o]||String.fromCharCode(parseInt(a,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,a){return String.fromCharCode(parseInt(a,16))});var l=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,l)+r(i.slice(l+3))}}(),R0=/[&<>'"]/g,i4=/[\u0000-\u0008\u000b-\u001f]/g;function ft(e){var t=e+"";return t.replace(R0,function(r){return j0[r]}).replace(i4,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function gm(e){return ft(e).replace(/ /g,"_x0020_")}var uy=/[\u0000-\u001f]/g;function I0(e){var t=e+"";return t.replace(R0,function(r){return j0[r]}).replace(/\n/g,"<br/>").replace(uy,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function s4(e){var t=e+"";return t.replace(R0,function(r){return j0[r]}).replace(uy,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var pm=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function a4(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function vt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Gf(e){for(var t="",r=0,n=0,i=0,s=0,l=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=i&63,t+=String.fromCharCode(l);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}l=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function mm(e){var t=Wi(2*e.length),r,n,i=1,s=0,l=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[s++]=l&255,t[s++]=l>>>8,l=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function xm(e){return ci(e,"binary").toString("utf8")}var gc="foo bar baz",dt=Qe&&(xm(gc)==Gf(gc)&&xm||mm(gc)==Gf(gc)&&mm)||Gf,Mn=Qe?function(e){return ci(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},fl=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),fy=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),o4=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),l4=/<\/?(?:vt:)?variant>/g,c4=/<(?:vt:)([^>]*)>([\s\S]*)</;function vm(e,t){var r=Xe(e),n=e.match(o4(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var l=s.replace(l4,"").match(c4);l&&i.push({v:dt(l[2]),t:l[1]})}),i}var hy=/(^\s|\s$|\n)/;function or(e,t){return"<"+e+(t.match(hy)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function hl(e){return It(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ee(e,t,r){return"<"+e+(r!=null?hl(r):"")+(t!=null?(t.match(hy)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function gd(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function u4(e,t){switch(typeof e){case"string":var r=Ee("vt:lpwstr",ft(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ee((e|0)==e?"vt:i4":"vt:r8",ft(String(e)));case"boolean":return Ee("vt:bool",e?"true":"false")}if(e instanceof Date)return Ee("vt:filetime",gd(e));throw new Error("Unable to serialize "+e)}function M0(e){if(Qe&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return dt(Gi(O0(e)));throw new Error("Bad input format: expected Buffer or string")}var dl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Gt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},js=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Wr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function f4(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function h4(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,l=n?-t:t;isFinite(l)?l==0?i=s=0:(i=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var ym=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},wm=Qe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ci(t)})):ym(e)}:ym,_m=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(qn(e,i)));return n.join("").replace(Er,"")},L0=Qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Er,""):_m(e,t,r)}:_m,bm=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},dy=Qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):bm(e,t,r)}:bm,Sm=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(ea(e,i)));return n.join("")},Dl=Qe?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Sm(t,r,n)}:Sm,gy=function(e,t){var r=zr(e,t);return r>0?Dl(e,t+4,t+4+r-1):""},py=gy,my=function(e,t){var r=zr(e,t);return r>0?Dl(e,t+4,t+4+r-1):""},xy=my,vy=function(e,t){var r=2*zr(e,t);return r>0?Dl(e,t+4,t+4+r-1):""},yy=vy,wy=function(t,r){var n=zr(t,r);return n>0?L0(t,r+4,r+4+n):""},_y=wy,by=function(e,t){var r=zr(e,t);return r>0?Dl(e,t+4,t+4+r):""},Sy=by,ky=function(e,t){return f4(e,t)},wu=ky,B0=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Qe&&(py=function(t,r){if(!Buffer.isBuffer(t))return gy(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},xy=function(t,r){if(!Buffer.isBuffer(t))return my(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},yy=function(t,r){if(!Buffer.isBuffer(t))return vy(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},_y=function(t,r){if(!Buffer.isBuffer(t))return wy(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Sy=function(t,r){if(!Buffer.isBuffer(t))return by(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},wu=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):ky(t,r)},B0=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ea=function(e,t){return e[t]},qn=function(e,t){return e[t+1]*256+e[t]},d4=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},zr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},as=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},g4=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Oo(e,t){var r="",n,i,s=[],l,o,a,c;switch(t){case"dbcs":if(c=this.l,Qe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(a=0;a<e;++a)r+=String.fromCharCode(qn(this,c)),c+=2;e*=2;break;case"utf8":r=Dl(this,this.l,this.l+e);break;case"utf16le":e*=2,r=L0(this,this.l,this.l+e);break;case"wstr":return Oo.call(this,e,"dbcs");case"lpstr-ansi":r=py(this,this.l),e=4+zr(this,this.l);break;case"lpstr-cp":r=xy(this,this.l),e=4+zr(this,this.l);break;case"lpwstr":r=yy(this,this.l),e=4+2*zr(this,this.l);break;case"lpp4":e=4+zr(this,this.l),r=_y(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+zr(this,this.l),r=Sy(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=ea(this,this.l+e++))!==0;)s.push(dc(l));r=s.join("");break;case"_wstr":for(e=0,r="";(l=qn(this,this.l+e))!==0;)s.push(dc(l)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,a=0;a<e;++a){if(this.lens&&this.lens.indexOf(c)!==-1)return l=ea(this,c),this.l=c+1,o=Oo.call(this,e-a,l?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(dc(qn(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,a=0;a!=e;++a){if(this.lens&&this.lens.indexOf(c)!==-1)return l=ea(this,c),this.l=c+1,o=Oo.call(this,e-a,l?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(dc(ea(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=ea(this,this.l),this.l++,n;case 2:return n=(t==="i"?d4:qn)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?as:g4)(this,this.l),this.l+=4,n):(i=zr(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=wu(this,this.l):i=wu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=dy(this,this.l,e);break}}return this.l+=e,r}var p4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},m4=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},x4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function v4(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)x4(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var l=t.charCodeAt(i);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,p4(this,t,this.l);break;case 8:if(n=8,r==="f"){h4(this,t,this.l);break}case 16:break;case-4:n=4,m4(this,t,this.l);break}return this.l+=n,this}function Cy(e,t){var r=dy(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ar(e,t){e.l=t,e.read_shift=Oo,e.chk=Cy,e.write_shift=v4}function _r(e,t){e.l+=t}function me(e){var t=Wi(e);return ar(t,0),t}function ui(e,t,r){if(e){var n,i,s;ar(e,e.l||0);for(var l=e.length,o=0,a=0;e.l<l;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=yl[o]||yl[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;a=e.l+s;var d=c.f&&c.f(e,s,r);if(e.l=a,t(d,c,o))return}}}function Ir(){var e=[],t=Qe?256:2048,r=function(c){var d=me(c);return ar(d,0),d},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},l=function(){return i(),Zt(e)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:l,_bufs:e}}function be(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=yl[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var l=e.next(s);i<=127?l.write_shift(1,i):(l.write_shift(1,(i&127)+128),l.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&B0(r)&&e.push(r)}}function No(e,t,r){var n=_t(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function km(e,t,r){var n=_t(e);return n.s=No(n.s,t.s,r),n.e=No(n.e,t.s,r),n}function Fo(e,t){if(e.cRel&&e.c<0)for(e=_t(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=_t(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=$e(e);return!e.cRel&&e.cRel!=null&&(r=_4(r)),!e.rRel&&e.rRel!=null&&(r=y4(r)),r}function qf(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+At(e.s.c)+":"+(e.e.cRel?"":"$")+At(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Bt(e.s.r)+":"+(e.e.rRel?"":"$")+Bt(e.e.r):Fo(e.s,t.biff)+":"+Fo(e.e,t.biff)}function U0(e){return parseInt(w4(e),10)-1}function Bt(e){return""+(e+1)}function y4(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function w4(e){return e.replace(/\$(\d+)$/,"$1")}function W0(e){for(var t=b4(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function At(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function _4(e){return e.replace(/^([A-Z])/,"$$$1")}function b4(e){return e.replace(/^\$([A-Z])/,"$1")}function S4(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ot(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function $e(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Mr(e){var t=e.indexOf(":");return t==-1?{s:Ot(e),e:Ot(e)}:{s:Ot(e.slice(0,t)),e:Ot(e.slice(t+1))}}function Ke(e,t){return typeof t>"u"||typeof t=="number"?Ke(e.s,e.e):(typeof e!="string"&&(e=$e(e)),typeof t!="string"&&(t=$e(t)),e==t?e:e+":"+t)}function st(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function Cm(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=hn(e.z,r?Kt(t):t)}catch{}try{return e.w=hn((e.XF||{}).numFmtId||(r?14:0),r?Kt(t):t)}catch{return""+t}}function ai(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?fi[e.v]||e.v:t==null?Cm(e,e.v):Cm(e,t))}function qi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Ty(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),l=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var a=typeof n.origin=="string"?Ot(n.origin):n.origin;l=a.r,o=a.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=st(s["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),l==-1&&(c.e.r=l=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var u={v:t[f][h]},g=l+f,m=o+h;if(c.s.r>g&&(c.s.r=g),c.s.c>m&&(c.s.c=m),c.e.r<g&&(c.e.r=g),c.e.c<m&&(c.e.c=m),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))u=t[f][h];else if(Array.isArray(u.v)&&(u.f=t[f][h][1],u.v=u.v[0]),u.v===null)if(u.f)u.t="n";else if(n.nullError)u.t="e",u.v=0;else if(n.sheetStubs)u.t="z";else continue;else typeof u.v=="number"?u.t="n":typeof u.v=="boolean"?u.t="b":u.v instanceof Date?(u.z=n.dateNF||ze[14],n.cellDates?(u.t="d",u.w=hn(u.z,Kt(u.v))):(u.t="n",u.v=Kt(u.v),u.w=hn(u.z,u.v))):u.t="s";if(i)s[g]||(s[g]=[]),s[g][m]&&s[g][m].z&&(u.z=s[g][m].z),s[g][m]=u;else{var p=$e({c:m,r:g});s[p]&&s[p].z&&(u.z=s[p].z),s[p]=u}}}return c.s.c<1e7&&(s["!ref"]=Ke(c)),s}function Ya(e,t){return Ty(null,e,t)}function k4(e){return e.read_shift(4,"i")}function Tn(e,t){return t||(t=me(4)),t.write_shift(4,e),t}function yr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function er(e,t){var r=!1;return t==null&&(r=!0,t=me(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function C4(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function T4(e,t){return t||(t=me(4)),t.write_shift(2,0),t.write_shift(2,0),t}function z0(e,t){var r=e.l,n=e.read_shift(1),i=yr(e),s=[],l={t:i,h:i};if(n&1){for(var o=e.read_shift(4),a=0;a!=o;++a)s.push(C4(e));l.r=s}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function E4(e,t){var r=!1;return t==null&&(r=!0,t=me(15+4*e.t.length)),t.write_shift(1,0),er(e.t,t),r?t.slice(0,t.l):t}var A4=z0;function O4(e,t){var r=!1;return t==null&&(r=!0,t=me(23+4*e.t.length)),t.write_shift(1,1),er(e.t,t),t.write_shift(4,1),T4({},t),r?t.slice(0,t.l):t}function dn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Rs(e,t){return t==null&&(t=me(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Is(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ms(e,t){return t==null&&(t=me(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var N4=yr,Ey=er;function H0(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function _u(e,t){var r=!1;return t==null&&(r=!0,t=me(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var F4=yr,pd=H0,V0=_u;function $0(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?wu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):as(t,0)>>2;return r?i/100:i}function Ay(e,t){t==null&&(t=me(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Oy(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function P4(e,t){return t||(t=me(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ls=Oy,Ga=P4;function vr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function As(e,t){return(t||me(8)).write_shift(8,e,"f")}function D4(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),a=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=ps[i];c&&(t.rgb=pl(c));break;case 2:t.rgb=pl([l,o,a]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function bu(e,t){if(t||(t=me(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function j4(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function R4(e,t){t||(t=me(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function Ny(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function I4(e){return Ny(e,1)}function M4(e){return Ny(e,2)}var X0=2,Nr=3,pc=11,Tm=12,Su=19,mc=64,L4=65,B4=71,U4=4108,W4=4126,Jt=80,Fy=81,z4=[Jt,Fy],md={1:{n:"CodePage",t:X0},2:{n:"Category",t:Jt},3:{n:"PresentationFormat",t:Jt},4:{n:"ByteCount",t:Nr},5:{n:"LineCount",t:Nr},6:{n:"ParagraphCount",t:Nr},7:{n:"SlideCount",t:Nr},8:{n:"NoteCount",t:Nr},9:{n:"HiddenCount",t:Nr},10:{n:"MultimediaClipCount",t:Nr},11:{n:"ScaleCrop",t:pc},12:{n:"HeadingPairs",t:U4},13:{n:"TitlesOfParts",t:W4},14:{n:"Manager",t:Jt},15:{n:"Company",t:Jt},16:{n:"LinksUpToDate",t:pc},17:{n:"CharacterCount",t:Nr},19:{n:"SharedDoc",t:pc},22:{n:"HyperlinksChanged",t:pc},23:{n:"AppVersion",t:Nr,p:"version"},24:{n:"DigSig",t:L4},26:{n:"ContentType",t:Jt},27:{n:"ContentStatus",t:Jt},28:{n:"Language",t:Jt},29:{n:"Version",t:Jt},255:{},2147483648:{n:"Locale",t:Su},2147483651:{n:"Behavior",t:Su},1919054434:{}},xd={1:{n:"CodePage",t:X0},2:{n:"Title",t:Jt},3:{n:"Subject",t:Jt},4:{n:"Author",t:Jt},5:{n:"Keywords",t:Jt},6:{n:"Comments",t:Jt},7:{n:"Template",t:Jt},8:{n:"LastAuthor",t:Jt},9:{n:"RevNumber",t:Jt},10:{n:"EditTime",t:mc},11:{n:"LastPrinted",t:mc},12:{n:"CreatedDate",t:mc},13:{n:"ModifiedDate",t:mc},14:{n:"PageCount",t:Nr},15:{n:"WordCount",t:Nr},16:{n:"CharCount",t:Nr},17:{n:"Thumbnail",t:B4},18:{n:"Application",t:Jt},19:{n:"DocSecurity",t:Nr},255:{},2147483648:{n:"Locale",t:Su},2147483651:{n:"Behavior",t:Su},1919054434:{}},Em={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},H4=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function V4(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var $4=V4([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ps=_t($4),fi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Py={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},vd={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},xc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Y0(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function X4(e){var t=Y0();if(!e||!e.match)return t;var r={};if((e.match(br)||[]).forEach(function(n){var i=Xe(n);switch(i[0].replace(r4,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[vd[i.ContentType]]!==void 0&&t[vd[i.ContentType]].push(i.PartName);break}}),t.xmlns!==Gt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function Dy(e,t){var r=XE(vd),n=[],i;n[n.length]=Ut,n[n.length]=Ee("Types",null,{xmlns:Gt.CT,"xmlns:xsd":Gt.xsd,"xmlns:xsi":Gt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(a){return Ee("Default",null,{Extension:a[0],ContentType:a[1]})}));var s=function(a){e[a]&&e[a].length>0&&(i=e[a][0],n[n.length]=Ee("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:xc[a][t.bookType]||xc[a].xlsx}))},l=function(a){(e[a]||[]).forEach(function(c){n[n.length]=Ee("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:xc[a][t.bookType]||xc[a].xlsx})})},o=function(a){(e[a]||[]).forEach(function(c){n[n.length]=Ee("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[a][0]})})};return s("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ze={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function gl(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Po(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(br)||[]).forEach(function(i){var s=Xe(i);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:xo(s.Target,t);r[o]=l,n[s.Id]=l}}),r["!id"]=n,r}function Ca(e){var t=[Ut,Ee("Relationships",null,{xmlns:Gt.RELS})];return It(e["!id"]).forEach(function(r){t[t.length]=Ee("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ut(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[Ze.HLINK,Ze.XPATH,Ze.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var Y4="application/vnd.oasis.opendocument.spreadsheet";function G4(e,t){for(var r=M0(e),n,i;n=dl.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Xe(n[0],!1),i.path=="/"&&i.type!==Y4)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function q4(e){var t=[Ut];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Am(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function K4(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function J4(e){var t=[Ut];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Am(e[r][0],e[r][1])),t.push(K4("",e[r][0]));return t.push(Am("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function jy(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+pu.version+"</meta:generator></office:meta></office:document-meta>"}var cn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Q4=function(){for(var e=new Array(cn.length),t=0;t<cn.length;++t){var r=cn[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Ry(e){var t={};e=dt(e);for(var r=0;r<cn.length;++r){var n=cn[r],i=e.match(Q4[r]);i!=null&&i.length>0&&(t[n[1]]=nt(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=wt(t[n[1]]))}return t}function Kf(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=ft(t),n[n.length]=r?Ee(e,t,r):or(e,t))}function Iy(e,t){var r=t||{},n=[Ut,Ee("cp:coreProperties",null,{"xmlns:cp":Gt.CORE_PROPS,"xmlns:dc":Gt.dc,"xmlns:dcterms":Gt.dcterms,"xmlns:dcmitype":Gt.dcmitype,"xmlns:xsi":Gt.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Kf("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:gd(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&Kf("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:gd(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=cn.length;++s){var l=cn[s],o=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Kf(l[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ms=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],My=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Ly(e,t,r,n){var i=[];if(typeof e=="string")i=vm(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(d){return{v:d}}));var l=typeof t=="string"?vm(t,n).map(function(d){return d.v}):t,o=0,a=0;if(l.length>0)for(var c=0;c!==i.length;c+=2){switch(a=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=a,r.SheetNames=l.slice(o,o+a);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=a,r.DefinedNames=l.slice(o,o+a);break;case"Charts":case"Diagramme":r.Chartsheets=a,r.ChartNames=l.slice(o,o+a);break}o+=a}}function Z4(e,t,r){var n={};return t||(t={}),e=dt(e),ms.forEach(function(i){var s=(e.match(fl(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=nt(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var l=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));l&&l.length>0&&(n[i[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Ly(n.HeadingPairs,n.TitlesOfParts,t,r),t}function By(e){var t=[],r=Ee;return e||(e={}),e.Application="SheetJS",t[t.length]=Ut,t[t.length]=Ee("Properties",null,{xmlns:Gt.EXT_PROPS,"xmlns:vt":Gt.vt}),ms.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=ft(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+ft(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var eA=/<[^>]+>[^<]*/g;function tA(e,t){var r={},n="",i=e.match(eA);if(i)for(var s=0;s!=i.length;++s){var l=i[s],o=Xe(l);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=nt(o.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var a=l.split(">"),c=a[0].slice(4),d=a[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=nt(d);break;case"bool":r[n]=vt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=wt(d);break;case"cy":case"error":r[n]=nt(d);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,c,a)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function Uy(e){var t=[Ut,Ee("Properties",null,{xmlns:Gt.CUST_PROPS,"xmlns:vt":Gt.vt})];if(!e)return t.join("");var r=1;return It(e).forEach(function(i){++r,t[t.length]=Ee("property",u4(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ft(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var yd={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Jf;function rA(e,t,r){Jf||(Jf=Zu(yd)),t=Jf[t]||t,e[t]=r}function nA(e,t){var r=[];return It(yd).map(function(n){for(var i=0;i<cn.length;++i)if(cn[i][1]==n)return cn[i];for(i=0;i<ms.length;++i)if(ms[i][1]==n)return ms[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(or(yd[n[1]]||n[1],i))}}),Ee("DocumentProperties",r.join(""),{xmlns:Wr.o})}function iA(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&It(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var l=0;l<cn.length;++l)if(s==cn[l][1])return;for(l=0;l<ms.length;++l)if(s==ms[l][1])return;for(l=0;l<r.length;++l)if(s==r[l])return;var o=e[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o=String(o),i.push(Ee(gm(s),o,{"dt:dt":a}))}}),t&&It(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var l=t[s],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),i.push(Ee(gm(s),l,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Wr.o+'">'+i.join("")+"</"+n+">"}function G0(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function sA(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var l=me(8);return l.write_shift(4,n),l.write_shift(4,i),l}function Wy(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function zy(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Hy(e,t,r){return t===31?zy(e):Wy(e,t,r)}function wd(e,t,r){return Hy(e,t,r===!1?0:4)}function aA(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Hy(e,t,0)}function oA(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Er,""),e.l-i&2&&(e.l+=2)}return r}function lA(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Er,"");return r}function cA(e){var t=e.l,r=ku(e,Fy);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=ku(e,Nr);return[r,n]}function uA(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(cA(e));return r}function Om(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),l=e.read_shift(4);n[s]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(Er,"").replace(mo,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Vy(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function fA(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ku(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==Tm&&n!==t&&z4.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Tm?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return Wy(e,n,4).replace(Er,"");case 31:return zy(e);case 64:return G0(e);case 65:return Vy(e);case 71:return fA(e);case 80:return wd(e,n,!s.raw).replace(Er,"");case 81:return aA(e,n).replace(Er,"");case 4108:return uA(e);case 4126:case 4127:return n==4127?oA(e):lA(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Nm(e,t){var r=me(4),n=me(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=me(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=sA(t);break;case 31:case 80:for(n=me(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Zt([r,n])}function Fm(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],l=0,o=0,a=-1,c={};for(l=0;l!=i;++l){var d=e.read_shift(4),f=e.read_shift(4);s[l]=[d,f+r]}s.sort(function(v,y){return v[1]-y[1]});var h={};for(l=0;l!=i;++l){if(e.l!==s[l][1]){var u=!0;if(l>0&&t)switch(t[s[l-1][0]].t){case 2:e.l+2===s[l][1]&&(e.l+=2,u=!1);break;case 80:e.l<=s[l][1]&&(e.l=s[l][1],u=!1);break;case 4108:e.l<=s[l][1]&&(e.l=s[l][1],u=!1);break}if((!t||l==0)&&e.l<=s[l][1]&&(u=!1,e.l=s[l][1]),u)throw new Error("Read Error: Expected address "+s[l][1]+" at "+e.l+" :"+l)}if(t){var g=t[s[l][0]];if(h[g.n]=ku(e,g.t,{raw:!0}),g.p==="version"&&(h[g.n]=String(h[g.n]>>16)+"."+("0000"+String(h[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(h[g.n]){case 0:h[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:_n(o=h[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[g.n])}}else if(s[l][0]===1){if(o=h.CodePage=ku(e,X0),_n(o),a!==-1){var m=e.l;e.l=s[a][1],c=Om(e,o),e.l=m}}else if(s[l][0]===0){if(o===0){a=l,e.l=s[l+1][1];continue}c=Om(e,o)}else{var p=c[s[l][0]],x;switch(e[e.l]){case 65:e.l+=4,x=Vy(e);break;case 30:e.l+=4,x=wd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,x=wd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,x=e.read_shift(4,"i");break;case 19:e.l+=4,x=e.read_shift(4);break;case 5:e.l+=4,x=e.read_shift(8,"f");break;case 11:e.l+=4,x=Mt(e,4);break;case 64:e.l+=4,x=wt(G0(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[p]=x}}return e.l=r+n,h}var $y=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function hA(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Pm(e,t,r){var n=me(8),i=[],s=[],l=8,o=0,a=me(8),c=me(8);if(a.write_shift(4,2),a.write_shift(4,1200),c.write_shift(4,1),s.push(a),i.push(c),l+=8+a.length,!t){c=me(8),c.write_shift(4,0),i.unshift(c);var d=[me(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(a=me(8+2*(f.length+1)+(f.length%2?0:2)),a.write_shift(4,o+2),a.write_shift(4,f.length+1),a.write_shift(0,f,"dbcs");a.l!=a.length;)a.write_shift(1,0);d.push(a)}a=Zt(d),s.unshift(a),l+=8+a.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!($y.indexOf(e[o][0])>-1||My.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],u=0;if(t){u=+t[e[o][0]];var g=r[u];if(g.p=="version"&&typeof h=="string"){var m=h.split(".");h=(+m[0]<<16)+(+m[1]||0)}a=Nm(g.t,h)}else{var p=hA(h);p==-1&&(p=31,h=String(h)),a=Nm(p,h)}s.push(a),c=me(8),c.write_shift(4,t?u:2+o),i.push(c),l+=8+a.length}var x=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,x),x+=s[o].length;return n.write_shift(4,l),n.write_shift(4,s.length),Zt([n].concat(i).concat(s))}function Dm(e,t,r){var n=e.content;if(!n)return{};ar(n,0);var i,s,l,o,a=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),d=n.read_shift(16);if(d!==Me.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(l=n.read_shift(16),a=n.read_shift(4));var f=Fm(n,t),h={SystemIdentifier:c};for(var u in f)h[u]=f[u];if(h.FMTID=s,i===1)return h;if(a-n.l==2&&(n.l+=2),n.l!==a)throw new Error("Length mismatch 2: "+n.l+" !== "+a);var g;try{g=Fm(n,null)}catch{}for(u in g)h[u]=g[u];return h.FMTID=[s,l],h}function jm(e,t,r,n,i,s){var l=me(i?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Me.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,i?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,i?68:48);var a=Pm(e,r,n);if(o.push(a),i){var c=Pm(i,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+a.length),o.push(c)}return Zt(o)}function gi(e,t){return e.read_shift(t),null}function dA(e,t){t||(t=me(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function gA(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Mt(e,t){return e.read_shift(t)===1}function Cr(e,t){return t||(t=me(2)),t.write_shift(2,+!!e),t}function Ht(e){return e.read_shift(2,"u")}function rn(e,t){return t||(t=me(2)),t.write_shift(2,e),t}function Xy(e,t){return gA(e,t,Ht)}function pA(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Yy(e,t,r){return r||(r=me(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function jl(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var l=n?e.read_shift(n,i):"";return l}function mA(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),l=0,o,a={};i&&(l=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,c);return i&&(e.l+=4*l),n&&(e.l+=o),a.t=d,i||(a.raw="<t>"+a.t+"</t>",a.r=a.t),a}function xA(e){var t=e.t||"",r=me(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=me(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return Zt(i)}function Os(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Rl(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Os(e,n,r)}function Bs(e,t,r){if(r.biff>5)return Rl(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Gy(e,t,r){return r||(r=me(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function vA(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function yA(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Er,"");return n&&(e.l+=24),i}function wA(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(s>>1,"utf16le").replace(Er,"");return r+l}function _A(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return yA(e);case"0303000000000000c000000000000046":return wA(e);default:throw new Error("Unsupported Moniker "+r)}}function vc(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Er,""):"";return r}function Rm(e,t){t||(t=me(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function bA(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,l,o,a,c="",d,f;i&16&&(s=vc(e,r-e.l)),i&128&&(l=vc(e,r-e.l)),(i&257)===257&&(o=vc(e,r-e.l)),(i&257)===1&&(a=_A(e,r-e.l)),i&8&&(c=vc(e,r-e.l)),i&32&&(d=e.read_shift(16)),i&64&&(f=G0(e)),e.l=r;var h=l||o||a||"";h&&c&&(h+="#"+c),h||(h="#"+c),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var u={Target:h};return d&&(u.guid=d),f&&(u.time=f),s&&(u.Tooltip=s),u}function SA(e){var t=me(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(s==28)n=n.slice(1),Rm(n,t);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&Rm(i>-1?n.slice(i+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var a=0;n.slice(a*3,a*3+3)=="../"||n.slice(a*3,a*3+3)=="..\\";)++a;for(t.write_shift(2,a),t.write_shift(4,n.length-3*a+1),r=0;r<n.length-3*a;++r)t.write_shift(1,n.charCodeAt(r+3*a)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function qy(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function Ky(e,t){var r=qy(e);return r[3]=0,r}function zn(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Ns(e,t,r,n){return n||(n=me(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function kA(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function CA(e,t,r){return t===0?"":Bs(e,t,r)}function TA(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[i,s,l]}function Jy(e){var t=e.read_shift(2),r=$0(e);return[t,r]}function EA(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=jl(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function rf(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function Qy(e,t){return t||(t=me(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Zy(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var AA=Zy;function ew(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function OA(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function NA(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function dr(e){e.l+=2,e.l+=e.read_shift(2)}var FA={0:dr,4:dr,5:dr,6:dr,7:NA,8:dr,9:dr,10:dr,11:dr,12:dr,13:OA,14:dr,15:dr,16:dr,17:dr,18:dr,19:dr,20:dr,21:ew};function PA(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(FA[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function yc(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function q0(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=me(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function DA(e,t){return t===0||e.read_shift(2),1200}function jA(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=Bs(e,0,r);return e.read_shift(t+n-e.l),i}function RA(e,t){var r=!t||t.biff==8,n=me(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function IA(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function MA(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=jl(e,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:i,dt:s,name:l}}function LA(e,t){var r=!t||t.biff>=8?2:1,n=me(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function BA(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],l=0;l!=i&&e.l<r;++l)s.push(mA(e));return s.Count=n,s.Unique=i,s}function UA(e,t){var r=me(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=xA(e[i]);var s=Zt([r].concat(n));return s.parts=[r.length].concat(n.map(function(l){return l.length})),s}function WA(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function zA(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function HA(e){var t=kA(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function VA(e){return e.read_shift(2),e.read_shift(4)}function Im(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function $A(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),a=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:l,FirstTab:o,Selected:a,TabRatio:c}}function XA(){var e=me(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function YA(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function GA(e){var t=me(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function qA(){}function KA(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=jl(e,0,r),n}function JA(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=me(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function QA(e){var t=zn(e);return t.isst=e.read_shift(4),t}function ZA(e,t,r,n){var i=me(10);return Ns(e,t,n,i),i.write_shift(4,r),i}function eO(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=zn(e);r.biff==2&&e.l++;var s=Rl(e,n-e.l,r);return i.val=s,i}function tO(e,t,r,n,i){var s=!i||i.biff==8,l=me(8+ +s+(1+s)*r.length);return Ns(e,t,n,l),l.write_shift(2,r.length),s&&l.write_shift(1,1),l.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),l}function rO(e,t,r){var n=e.read_shift(2),i=Bs(e,0,r);return[n,i]}function nO(e,t,r,n){var i=r&&r.biff==5;n||(n=me(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var iO=Bs;function Mm(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),l=e.read_shift(i),o=e.read_shift(2),a=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:l,c:a}}}function sO(e,t){var r=t.biff==8||!t.biff?4:2,n=me(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function aO(e){var t=e.read_shift(2),r=e.read_shift(2),n=Jy(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function oO(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(Jy(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(s.length!=l-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:l,rkrec:s}}function lO(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(s.length!=l-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:l,ixfe:s}}function cO(e,t,r,n){var i={},s=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(4),a=e.read_shift(2);return i.patternType=H4[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=l&15,i.dgRight=l>>4&15,i.dgTop=l>>8&15,i.dgBottom=l>>12&15,i.icvLeft=l>>16&127,i.icvRight=l>>23&127,i.grbitDiag=l>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=a&127,i.icvBack=a>>7&127,i.fsxButton=a>>14&1),i}function uO(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=cO(e,t,n.fStyle,r),n}function Lm(e,t,r,n){var i=r&&r.biff==5;n||(n=me(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function fO(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function hO(e){var t=me(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Bm(e,t,r){var n=zn(e);(r.biff==2||t==9)&&++e.l;var i=pA(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function dO(e,t,r,n,i,s){var l=me(8);return Ns(e,t,n,l),Yy(r,s,l),l}function gO(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=zn(e),i=vr(e);return n.val=i,n}function pO(e,t,r,n){var i=me(14);return Ns(e,t,n,i),As(r,i),i}var Um=CA;function mO(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=Os(e,s),o=[];n>e.l;)o.push(Rl(e));return[s,i,l,o]}function Wm(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=EA(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var xO=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function zm(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),a=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),a=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=Os(e,l,r);i&32&&(c=xO[c.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||o===0||!(d>0)?[]:PP(e,d,r,o);return{chKey:s,Name:c,itab:a,rgce:f}}function tw(e,t,r){if(r.biff<8)return vO(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(TA(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function vO(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=jl(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function yO(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=Os(e,n,r),l=Os(e,i,r);return[s,l]}function wO(e,t,r){var n=Zy(e);e.l++;var i=e.read_shift(1);return t-=8,[DP(e,t,r),i,n]}function Hm(e,t,r){var n=AA(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,NP(e,t,r)]}function _O(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function bO(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=Bs(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},o,l,s]}}function SO(e,t,r){return bO(e,t,r)}function kO(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(rf(e));return r}function CO(e){var t=me(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Qy(e[r],t);return t}function TO(e,t,r){if(r&&r.biff<8)return AO(e,t,r);var n=ew(e),i=PA(e,t-22,n[1]);return{cmo:n,ft:i}}var EO={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function AO(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((EO[n]||_r)(e,t,r)),{cmo:[i,n,s],ft:l}}function OO(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:l=vA(e,6,r);var o=e.read_shift(2);e.read_shift(2),Ht(e,2);var a=e.read_shift(2);e.l+=a;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var d=e[e.l],f=Os(e,e.lens[c+1]-e.lens[c]-1);if(i+=f,i.length>=(d?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function NO(e,t){var r=rf(e);e.l+=16;var n=bA(e,t-24);return[r,n]}function FO(e){var t=me(24),r=Ot(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return Zt([t,SA(e[1])])}function PO(e,t){e.read_shift(2);var r=rf(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Er,""),[r,n]}function DO(e){var t=e[1].Tooltip,r=me(10+2*(t.length+1));r.write_shift(2,2048);var n=Ot(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function jO(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Em[r]||r,r=e.read_shift(2),t[1]=Em[r]||r,t}function RO(e){return e||(e=me(4)),e.write_shift(2,1),e.write_shift(2,1),e}function IO(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Ky(e));return r}function MO(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Ky(e));return r}function LO(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function rw(e,t,r){if(!r.cellStyles)return _r(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(n),a=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:s,w:l,ixfe:o,flags:a};return(r.biff>=5||!r.biff)&&(c.level=a>>8&7),c}function BO(e,t){var r=me(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function UO(e,t){var r={};return t<32||(e.l+=16,r.header=vr(e),r.footer=vr(e),e.l+=2),r}function WO(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}function zO(e){for(var t=me(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var HO=zn,VO=Xy,$O=Rl;function XO(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function YO(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=zn(e);++e.l;var i=Bs(e,t-7,r);return n.t="str",n.val=i,n}function GO(e){var t=zn(e);++e.l;var r=vr(e);return t.t="n",t.val=r,t}function qO(e,t,r){var n=me(15);return Bl(n,e,t),n.write_shift(8,r,"f"),n}function KO(e){var t=zn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function JO(e,t,r){var n=me(9);return Bl(n,e,t),n.write_shift(2,r),n}function QO(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function ZO(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function eN(e,t,r){var n=e.l+t,i=zn(e),s=e.read_shift(2),l=Os(e,s,r);return e.l=n,i.t="str",i.val=l,i}var tN=[2,3,48,49,131,139,140,245],_d=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Zu({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,a){var c=[],d=Wi(1);switch(a.type){case"base64":d=Hr(Gr(o));break;case"binary":d=Hr(o);break;case"buffer":case"array":d=o;break}ar(d,0);var f=d.read_shift(1),h=!!(f&136),u=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:u=!0,h=!0;break;case 49:u=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,p=521;f==2&&(m=d.read_shift(2)),d.l+=3,f!=2&&(m=d.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(p=d.read_shift(2));var x=d.read_shift(2),v=a.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(v=e[d[d.l]]),d.l+=1,d.l+=2),g&&(d.l+=36);for(var y=[],_={},b=Math.min(d.length,f==2?521:p-10-(u?264:0)),S=g?32:11;d.l<b&&d[d.l]!=13;)switch(_={},_.name=ll.utils.decode(v,d.slice(d.l,d.l+S)).replace(/[\u0000\r\n].*$/g,""),d.l+=S,_.type=String.fromCharCode(d.read_shift(1)),f!=2&&!g&&(_.offset=d.read_shift(4)),_.len=d.read_shift(1),f==2&&(_.offset=d.read_shift(2)),_.dec=d.read_shift(1),_.name.length&&y.push(_),f!=2&&(d.l+=g?13:14),_.type){case"B":(!u||_.len!=8)&&a.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":a.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(d[d.l]!==13&&(d.l=p-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=p;var C=0,N=0;for(c[0]=[],N=0;N!=y.length;++N)c[0][N]=y[N].name;for(;m-- >0;){if(d[d.l]===42){d.l+=x;continue}for(++d.l,c[++C]=[],N=0,N=0;N!=y.length;++N){var F=d.slice(d.l,d.l+y[N].len);d.l+=y[N].len,ar(F,0);var Y=ll.utils.decode(v,F);switch(y[N].type){case"C":Y.trim().length&&(c[C][N]=Y.replace(/\s+$/,""));break;case"D":Y.length===8?c[C][N]=new Date(+Y.slice(0,4),+Y.slice(4,6)-1,+Y.slice(6,8)):c[C][N]=Y;break;case"F":c[C][N]=parseFloat(Y.trim());break;case"+":case"I":c[C][N]=g?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(Y.trim().toUpperCase()){case"Y":case"T":c[C][N]=!0;break;case"N":case"F":c[C][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Y+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[C][N]="##MEMO##"+(g?parseInt(Y.trim(),10):F.read_shift(4));break;case"N":Y=Y.replace(/\u0000/g,"").trim(),Y&&Y!="."&&(c[C][N]=+Y||0);break;case"@":c[C][N]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":c[C][N]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":c[C][N]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[C][N]=-F.read_shift(-8,"f");break;case"B":if(u&&y[N].len==8){c[C][N]=F.read_shift(8,"f");break}case"G":case"P":F.l+=y[N].len;break;case"0":if(y[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[N].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return a&&a.sheetRows&&(c=c.slice(0,a.sheetRows)),a.DBF=y,c}function n(o,a){var c=a||{};c.dateNF||(c.dateNF="yyyymmdd");var d=Ya(r(o,c),c);return d["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,d}function i(o,a){try{return qi(n(o,a),a)}catch(c){if(a&&a.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,a){var c=a||{};if(+c.codepage>=0&&_n(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var d=Ir(),f=Eu(o,{header:1,raw:!0,cellDates:!0}),h=f[0],u=f.slice(1),g=o["!cols"]||[],m=0,p=0,x=0,v=1;for(m=0;m<h.length;++m){if(((g[m]||{}).DBF||{}).name){h[m]=g[m].DBF.name,++x;continue}if(h[m]!=null){if(++x,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(p=0;p<1024;++p)if(h.indexOf(h[m]+"_"+p)==-1){h[m]+="_"+p;break}}}}var y=st(o["!ref"]),_=[],b=[],S=[];for(m=0;m<=y.e.c-y.s.c;++m){var C="",N="",F=0,Y=[];for(p=0;p<u.length;++p)u[p][m]!=null&&Y.push(u[p][m]);if(Y.length==0||h[m]==null){_[m]="?";continue}for(p=0;p<Y.length;++p){switch(typeof Y[p]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=Y[p]instanceof Date?"D":"C";break;default:N="C"}F=Math.max(F,String(Y[p]).length),C=C&&C!=N?"C":N}F>250&&(F=250),N=((g[m]||{}).DBF||{}).type,N=="C"&&g[m].DBF.len>F&&(F=g[m].DBF.len),C=="B"&&N=="N"&&(C="N",S[m]=g[m].DBF.dec,F=g[m].DBF.len),b[m]=C=="C"||N=="N"?F:s[C]||0,v+=b[m],_[m]=C}var X=d.next(32);for(X.write_shift(4,318902576),X.write_shift(4,u.length),X.write_shift(2,296+32*x),X.write_shift(2,v),m=0;m<4;++m)X.write_shift(4,0);for(X.write_shift(4,0|(+t[$1]||3)<<8),m=0,p=0;m<h.length;++m)if(h[m]!=null){var V=d.next(32),te=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);V.write_shift(1,te,"sbcs"),V.write_shift(1,_[m]=="?"?"C":_[m],"sbcs"),V.write_shift(4,p),V.write_shift(1,b[m]||s[_[m]]||0),V.write_shift(1,S[m]||0),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(1,0),V.write_shift(4,0),V.write_shift(4,0),p+=b[m]||s[_[m]]||0}var G=d.next(264);for(G.write_shift(4,13),m=0;m<65;++m)G.write_shift(4,0);for(m=0;m<u.length;++m){var re=d.next(v);for(re.write_shift(1,0),p=0;p<h.length;++p)if(h[p]!=null)switch(_[p]){case"L":re.write_shift(1,u[m][p]==null?63:u[m][p]?84:70);break;case"B":re.write_shift(8,u[m][p]||0,"f");break;case"N":var Z="0";for(typeof u[m][p]=="number"&&(Z=u[m][p].toFixed(S[p]||0)),x=0;x<b[p]-Z.length;++x)re.write_shift(1,32);re.write_shift(1,Z,"sbcs");break;case"D":u[m][p]?(re.write_shift(4,("0000"+u[m][p].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(u[m][p].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+u[m][p].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var oe=String(u[m][p]!=null?u[m][p]:"").slice(0,b[p]);for(re.write_shift(1,oe,"sbcs"),x=0;x<b[p]-oe.length;++x)re.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:l}}(),nw=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+It(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,u){var g=e[u];return typeof g=="number"?em(g):g},n=function(h,u,g){var m=u.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?h:em(m)};e["|"]=254;function i(h,u){switch(u.type){case"base64":return s(Gr(h),u);case"binary":return s(h,u);case"buffer":return s(Qe&&Buffer.isBuffer(h)?h.toString("binary"):Gi(h),u);case"array":return s(Es(h),u)}throw new Error("Unrecognized type "+u.type)}function s(h,u){var g=h.split(/[\n\r]+/),m=-1,p=-1,x=0,v=0,y=[],_=[],b=null,S={},C=[],N=[],F=[],Y=0,X;for(+u.codepage>=0&&_n(+u.codepage);x!==g.length;++x){Y=0;var V=g[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),te=V.replace(/;;/g,"\0").split(";").map(function(T){return T.replace(/\u0000/g,";")}),G=te[0],re;if(V.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":te[1].charAt(0)=="P"&&_.push(V.slice(3).replace(/;;/g,";"));break;case"C":var Z=!1,oe=!1,ee=!1,E=!1,D=-1,U=-1;for(v=1;v<te.length;++v)switch(te[v].charAt(0)){case"A":break;case"X":p=parseInt(te[v].slice(1))-1,oe=!0;break;case"Y":for(m=parseInt(te[v].slice(1))-1,oe||(p=0),X=y.length;X<=m;++X)y[X]=[];break;case"K":re=te[v].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(Cn(re))?isNaN(Ma(re).getDate())||(re=wt(re)):(re=Cn(re),b!==null&&$a(b)&&(re=tf(re))),Z=!0;break;case"E":E=!0;var k=Ta(te[v].slice(1),{r:m,c:p});y[m][p]=[y[m][p],k];break;case"S":ee=!0,y[m][p]=[y[m][p],"S5S"];break;case"G":break;case"R":D=parseInt(te[v].slice(1))-1;break;case"C":U=parseInt(te[v].slice(1))-1;break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+V)}if(Z&&(y[m][p]&&y[m][p].length==2?y[m][p][0]=re:y[m][p]=re,b=null),ee){if(E)throw new Error("SYLK shared formula cannot have own formula");var P=D>-1&&y[D][U];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");y[m][p][1]=_w(P[1],{r:m-D,c:p-U})}break;case"F":var A=0;for(v=1;v<te.length;++v)switch(te[v].charAt(0)){case"X":p=parseInt(te[v].slice(1))-1,++A;break;case"Y":for(m=parseInt(te[v].slice(1))-1,X=y.length;X<=m;++X)y[X]=[];break;case"M":Y=parseInt(te[v].slice(1))/20;break;case"F":break;case"G":break;case"P":b=_[parseInt(te[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=te[v].slice(1).split(" "),X=parseInt(F[0],10);X<=parseInt(F[1],10);++X)Y=parseInt(F[2],10),N[X-1]=Y===0?{hidden:!0}:{wch:Y},zi(N[X-1]);break;case"C":p=parseInt(te[v].slice(1))-1,N[p]||(N[p]={});break;case"R":m=parseInt(te[v].slice(1))-1,C[m]||(C[m]={}),Y>0?(C[m].hpt=Y,C[m].hpx=Ba(Y)):Y===0&&(C[m].hidden=!0);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+V)}A<1&&(b=null);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+V)}}return C.length>0&&(S["!rows"]=C),N.length>0&&(S["!cols"]=N),u&&u.sheetRows&&(y=y.slice(0,u.sheetRows)),[y,S]}function l(h,u){var g=i(h,u),m=g[0],p=g[1],x=Ya(m,u);return It(p).forEach(function(v){x[v]=p[v]}),x}function o(h,u){return qi(l(h,u),u)}function a(h,u,g,m){var p="C;Y"+(g+1)+";X"+(m+1)+";K";switch(h.t){case"n":p+=h.v||0,h.f&&!h.F&&(p+=";E"+tg(h.f,{r:g,c:m}));break;case"b":p+=h.v?"TRUE":"FALSE";break;case"e":p+=h.w||h.v;break;case"d":p+='"'+(h.w||h.v)+'"';break;case"s":p+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return p}function c(h,u){u.forEach(function(g,m){var p="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?p+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=ml(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=xl(g.wpx)),typeof g.wch=="number"&&(p+=Math.round(g.wch))),p.charAt(p.length-1)!=" "&&h.push(p)})}function d(h,u){u.forEach(function(g,m){var p="F;";g.hidden?p+="M0;":g.hpt?p+="M"+20*g.hpt+";":g.hpx&&(p+="M"+20*vl(g.hpx)+";"),p.length>2&&h.push(p+"R"+(m+1))})}function f(h,u){var g=["ID;PWXL;N;E"],m=[],p=st(h["!ref"]),x,v=Array.isArray(h),y=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),h["!cols"]&&c(g,h["!cols"]),h["!rows"]&&d(g,h["!rows"]),g.push("B;Y"+(p.e.r-p.s.r+1)+";X"+(p.e.c-p.s.c+1)+";D"+[p.s.c,p.s.r,p.e.c,p.e.r].join(" "));for(var _=p.s.r;_<=p.e.r;++_)for(var b=p.s.c;b<=p.e.c;++b){var S=$e({r:_,c:b});x=v?(h[_]||[])[b]:h[S],!(!x||x.v==null&&(!x.f||x.F))&&m.push(a(x,h,_,b))}return g.join(y)+y+m.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:l,from_sheet:f}}(),iw=function(){function e(s,l){switch(l.type){case"base64":return t(Gr(s),l);case"binary":return t(s,l);case"buffer":return t(Qe&&Buffer.isBuffer(s)?s.toString("binary"):Gi(s),l);case"array":return t(Es(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){for(var o=s.split(`
`),a=-1,c=-1,d=0,f=[];d!==o.length;++d){if(o[d].trim()==="BOT"){f[++a]=[],c=0;continue}if(!(a<0)){var h=o[d].trim().split(","),u=h[0],g=h[1];++d;for(var m=o[d]||"";(m.match(/["]/g)||[]).length&1&&d<o.length-1;)m+=`
`+o[++d];switch(m=m.trim(),+u){case-1:if(m==="BOT"){f[++a]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[a][c]=!0:m==="FALSE"?f[a][c]=!1:isNaN(Cn(g))?isNaN(Ma(g).getDate())?f[a][c]=g:f[a][c]=wt(g):f[a][c]=Cn(g),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[a][c++]=m!==""?m:null;break}if(m==="EOD")break}}return l&&l.sheetRows&&(f=f.slice(0,l.sheetRows)),f}function r(s,l){return Ya(e(s,l),l)}function n(s,l){return qi(r(s,l),l)}var i=function(){var s=function(a,c,d,f,h){a.push(c),a.push(d+","+f),a.push('"'+h.replace(/"/g,'""')+'"')},l=function(a,c,d,f){a.push(c+","+d),a.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(a){var c=[],d=st(a["!ref"]),f,h=Array.isArray(a);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,d.e.r-d.s.r+1,""),s(c,"TUPLES",0,d.e.c-d.s.c+1,""),s(c,"DATA",0,0,"");for(var u=d.s.r;u<=d.e.r;++u){l(c,-1,0,"BOT");for(var g=d.s.c;g<=d.e.c;++g){var m=$e({r:u,c:g});if(f=h?(a[u]||[])[g]:a[m],!f){l(c,1,0,"");continue}switch(f.t){case"n":var p=f.w;!p&&f.v!=null&&(p=f.v),p==null?f.f&&!f.F?l(c,1,0,"="+f.f):l(c,1,0,""):l(c,0,p,"V");break;case"b":l(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":l(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=hn(f.z||ze[14],Kt(wt(f.v)))),l(c,0,f.w,"V");break;default:l(c,1,0,"")}}}l(c,-1,0,"EOD");var x=`\r
`,v=c.join(x);return v}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),sw=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var u=f.split(`
`),g=-1,m=-1,p=0,x=[];p!==u.length;++p){var v=u[p].trim().split(":");if(v[0]==="cell"){var y=Ot(v[1]);if(x.length<=y.r)for(g=x.length;g<=y.r;++g)x[g]||(x[g]=[]);switch(g=y.r,m=y.c,v[2]){case"t":x[g][m]=e(v[3]);break;case"v":x[g][m]=+v[3];break;case"vtf":var _=v[v.length-1];case"vtc":switch(v[3]){case"nl":x[g][m]=!!+v[4];break;default:x[g][m]=+v[4];break}v[2]=="vtf"&&(x[g][m]=[x[g][m],_])}}}return h&&h.sheetRows&&(x=x.slice(0,h.sheetRows)),x}function n(f,h){return Ya(r(f,h),h)}function i(f,h){return qi(n(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),a="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var h=[],u=[],g,m="",p=Mr(f["!ref"]),x=Array.isArray(f),v=p.s.r;v<=p.e.r;++v)for(var y=p.s.c;y<=p.e.c;++y)if(m=$e({r:v,c:y}),g=x?(f[v]||[])[y]:f[m],!(!g||g.v==null||g.t==="z")){switch(u=["cell",m,"t"],g.t){case"s":case"str":u.push(t(g.v));break;case"n":g.f?(u[2]="vtf",u[3]="n",u[4]=g.v,u[5]=t(g.f)):(u[2]="v",u[3]=g.v);break;case"b":u[2]="vt"+(g.f?"f":"c"),u[3]="nl",u[4]=g.v?"1":"0",u[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var _=Kt(wt(g.v));u[2]="vtc",u[3]="nd",u[4]=""+_,u[5]=g.w||hn(g.z||ze[14],_);break;case"e":continue}h.push(u.join(":"))}return h.push("sheet:c:"+(p.e.c-p.s.c+1)+":r:"+(p.e.r-p.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[s,l,o,l,c(f),a].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),La=function(){function e(d,f,h,u,g){g.raw?f[h][u]=d:d===""||(d==="TRUE"?f[h][u]=!0:d==="FALSE"?f[h][u]=!1:isNaN(Cn(d))?isNaN(Ma(d).getDate())?f[h][u]=d:f[h][u]=wt(d):f[h][u]=Cn(d))}function t(d,f){var h=f||{},u=[];if(!d||d.length===0)return u;for(var g=d.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var p=10,x=0,v=0;v<=m;++v)x=g[v].indexOf(" "),x==-1?x=g[v].length:x++,p=Math.max(p,x);for(v=0;v<=m;++v){u[v]=[];var y=0;for(e(g[v].slice(0,p).trim(),u,v,y,h),y=1;y<=(g[v].length-p)/10+1;++y)e(g[v].slice(p+(y-1)*10,p+y*10).trim(),u,v,y,h)}return h.sheetRows&&(u=u.slice(0,h.sheetRows)),u}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var f={},h=!1,u=0,g=0;u<d.length;++u)(g=d.charCodeAt(u))==34?h=!h:!h&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(u in f)Object.prototype.hasOwnProperty.call(f,u)&&g.push([f[u],u]);if(!g.length){f=n;for(u in f)Object.prototype.hasOwnProperty.call(f,u)&&g.push([f[u],u])}return g.sort(function(m,p){return m[0]-p[0]||n[m[1]]-n[p[1]]}),r[g.pop()[1]]||44}function s(d,f){var h=f||{},u="",g=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(u=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(u=d.charAt(4),d=d.slice(6)):u=i(d.slice(0,1024)):h&&h.FS?u=h.FS:u=i(d.slice(0,1024));var p=0,x=0,v=0,y=0,_=0,b=u.charCodeAt(0),S=!1,C=0,N=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var F=h.dateNF!=null?WE(h.dateNF):null;function Y(){var X=d.slice(y,_),V={};if(X.charAt(0)=='"'&&X.charAt(X.length-1)=='"'&&(X=X.slice(1,-1).replace(/""/g,'"')),X.length===0)V.t="z";else if(h.raw)V.t="s",V.v=X;else if(X.trim().length===0)V.t="s",V.v=X;else if(X.charCodeAt(0)==61)X.charCodeAt(1)==34&&X.charCodeAt(X.length-1)==34?(V.t="s",V.v=X.slice(2,-1).replace(/""/g,'"')):mF(X)?(V.t="n",V.f=X.slice(1)):(V.t="s",V.v=X);else if(X=="TRUE")V.t="b",V.v=!0;else if(X=="FALSE")V.t="b",V.v=!1;else if(!isNaN(v=Cn(X)))V.t="n",h.cellText!==!1&&(V.w=X),V.v=v;else if(!isNaN(Ma(X).getDate())||F&&X.match(F)){V.z=h.dateNF||ze[14];var te=0;F&&X.match(F)&&(X=zE(X,h.dateNF,X.match(F)||[]),te=1),h.cellDates?(V.t="d",V.v=wt(X,te)):(V.t="n",V.v=Kt(wt(X,te))),h.cellText!==!1&&(V.w=hn(V.z,V.v instanceof Date?Kt(V.v):V.v)),h.cellNF||delete V.z}else V.t="s",V.v=X;if(V.t=="z"||(h.dense?(g[p]||(g[p]=[]),g[p][x]=V):g[$e({c:x,r:p})]=V),y=_+1,N=d.charCodeAt(y),m.e.c<x&&(m.e.c=x),m.e.r<p&&(m.e.r=p),C==b)++x;else if(x=0,++p,h.sheetRows&&h.sheetRows<=p)return!0}e:for(;_<d.length;++_)switch(C=d.charCodeAt(_)){case 34:N===34&&(S=!S);break;case b:case 10:case 13:if(!S&&Y())break e;break}return _-y>0&&Y(),g["!ref"]=Ke(m),g}function l(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):Ya(t(d,f),f)}function o(d,f){var h="",u=f.type=="string"?[0,0,0,0]:cg(d,f);switch(f.type){case"base64":h=Gr(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof ll<"u"||(h=Qe&&Buffer.isBuffer(d)?d.toString("binary"):Gi(d));break;case"array":h=Es(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return u[0]==239&&u[1]==187&&u[2]==191?h=dt(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=dt(h):f.type=="binary"&&typeof ll<"u",h.slice(0,19)=="socialcalc:version:"?sw.to_sheet(f.type=="string"?h:dt(h),f):l(h,f)}function a(d,f){return qi(o(d,f),f)}function c(d){for(var f=[],h=st(d["!ref"]),u,g=Array.isArray(d),m=h.s.r;m<=h.e.r;++m){for(var p=[],x=h.s.c;x<=h.e.c;++x){var v=$e({r:m,c:x});if(u=g?(d[m]||[])[x]:d[v],!u||u.v==null){p.push("          ");continue}for(var y=(u.w||(ai(u),u.w)||"").slice(0,10);y.length<10;)y+=" ";p.push(y+(x===0?" ":""))}f.push(p.join(""))}return f.join(`
`)}return{to_workbook:a,to_sheet:o,from_sheet:c}}();function rN(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=nw.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return La.to_workbook(e,t)}}var xs=function(){function e(k,P,A){if(k){ar(k,k.l||0);for(var T=A.Enum||D;k.l<k.length;){var j=k.read_shift(2),R=T[j]||T[65535],z=k.read_shift(2),I=k.l+z,L=R.f&&R.f(k,z,A);if(k.l=I,P(L,R,j))return}}}function t(k,P){switch(P.type){case"base64":return r(Hr(Gr(k)),P);case"binary":return r(Hr(k),P);case"buffer":case"array":return r(k,P)}throw"Unsupported type "+P.type}function r(k,P){if(!k)return k;var A=P||{},T=A.dense?[]:{},j="Sheet1",R="",z=0,I={},L=[],K=[],O={s:{r:0,c:0},e:{r:0,c:0}},B=A.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)A.Enum=D,e(k,function(H,ce,ue){switch(ue){case 0:A.vers=H,H>=4096&&(A.qpro=!0);break;case 6:O=H;break;case 204:H&&(R=H);break;case 222:R=H;break;case 15:case 51:A.qpro||(H[1].v=H[1].v.slice(1));case 13:case 14:case 16:ue==14&&(H[2]&112)==112&&(H[2]&15)>1&&(H[2]&15)<15&&(H[1].z=A.dateNF||ze[14],A.cellDates&&(H[1].t="d",H[1].v=tf(H[1].v))),A.qpro&&H[3]>z&&(T["!ref"]=Ke(O),I[j]=T,L.push(j),T=A.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},z=H[3],j=R||"Sheet"+(z+1),R="");var xe=A.dense?(T[H[0].r]||[])[H[0].c]:T[$e(H[0])];if(xe){xe.t=H[1].t,xe.v=H[1].v,H[1].z!=null&&(xe.z=H[1].z),H[1].f!=null&&(xe.f=H[1].f);break}A.dense?(T[H[0].r]||(T[H[0].r]=[]),T[H[0].r][H[0].c]=H[1]):T[$e(H[0])]=H[1];break}},A);else if(k[2]==26||k[2]==14)A.Enum=U,k[2]==14&&(A.qpro=!0,k.l=0),e(k,function(H,ce,ue){switch(ue){case 204:j=H;break;case 22:H[1].v=H[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(H[3]>z&&(T["!ref"]=Ke(O),I[j]=T,L.push(j),T=A.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},z=H[3],j="Sheet"+(z+1)),B>0&&H[0].r>=B)break;A.dense?(T[H[0].r]||(T[H[0].r]=[]),T[H[0].r][H[0].c]=H[1]):T[$e(H[0])]=H[1],O.e.c<H[0].c&&(O.e.c=H[0].c),O.e.r<H[0].r&&(O.e.r=H[0].r);break;case 27:H[14e3]&&(K[H[14e3][0]]=H[14e3][1]);break;case 1537:K[H[0]]=H[1],H[0]==z&&(j=H[1]);break}},A);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(T["!ref"]=Ke(O),I[R||j]=T,L.push(R||j),!K.length)return{SheetNames:L,Sheets:I};for(var M={},J=[],se=0;se<K.length;++se)I[L[se]]?(J.push(K[se]||L[se]),M[K[se]]=I[K[se]]||I[L[se]]):(J.push(K[se]),M[K[se]]={"!ref":"A1"});return{SheetNames:J,Sheets:M}}function n(k,P){var A=P||{};if(+A.codepage>=0&&_n(+A.codepage),A.type=="string")throw new Error("Cannot write WK1 to JS string");var T=Ir(),j=st(k["!ref"]),R=Array.isArray(k),z=[];Ae(T,0,s(1030)),Ae(T,6,a(j));for(var I=Math.min(j.e.r,8191),L=j.s.r;L<=I;++L)for(var K=Bt(L),O=j.s.c;O<=j.e.c;++O){L===j.s.r&&(z[O]=At(O));var B=z[O]+K,M=R?(k[L]||[])[O]:k[B];if(!(!M||M.t=="z"))if(M.t=="n")(M.v|0)==M.v&&M.v>=-32768&&M.v<=32767?Ae(T,13,u(L,O,M.v)):Ae(T,14,m(L,O,M.v));else{var J=ai(M);Ae(T,15,f(L,O,J.slice(0,239)))}}return Ae(T,1),T.end()}function i(k,P){var A=P||{};if(+A.codepage>=0&&_n(+A.codepage),A.type=="string")throw new Error("Cannot write WK3 to JS string");var T=Ir();Ae(T,0,l(k));for(var j=0,R=0;j<k.SheetNames.length;++j)(k.Sheets[k.SheetNames[j]]||{})["!ref"]&&Ae(T,27,E(k.SheetNames[j],R++));var z=0;for(j=0;j<k.SheetNames.length;++j){var I=k.Sheets[k.SheetNames[j]];if(!(!I||!I["!ref"])){for(var L=st(I["!ref"]),K=Array.isArray(I),O=[],B=Math.min(L.e.r,8191),M=L.s.r;M<=B;++M)for(var J=Bt(M),se=L.s.c;se<=L.e.c;++se){M===L.s.r&&(O[se]=At(se));var H=O[se]+J,ce=K?(I[M]||[])[se]:I[H];if(!(!ce||ce.t=="z"))if(ce.t=="n")Ae(T,23,Y(M,se,z,ce.v));else{var ue=ai(ce);Ae(T,22,C(M,se,z,ue.slice(0,239)))}}++z}}return Ae(T,1),T.end()}function s(k){var P=me(2);return P.write_shift(2,k),P}function l(k){var P=me(26);P.write_shift(2,4096),P.write_shift(2,4),P.write_shift(4,0);for(var A=0,T=0,j=0,R=0;R<k.SheetNames.length;++R){var z=k.SheetNames[R],I=k.Sheets[z];if(!(!I||!I["!ref"])){++j;var L=Mr(I["!ref"]);A<L.e.r&&(A=L.e.r),T<L.e.c&&(T=L.e.c)}}return A>8191&&(A=8191),P.write_shift(2,A),P.write_shift(1,j),P.write_shift(1,T),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(1,1),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(4,0),P}function o(k,P,A){var T={s:{c:0,r:0},e:{c:0,r:0}};return P==8&&A.qpro?(T.s.c=k.read_shift(1),k.l++,T.s.r=k.read_shift(2),T.e.c=k.read_shift(1),k.l++,T.e.r=k.read_shift(2),T):(T.s.c=k.read_shift(2),T.s.r=k.read_shift(2),P==12&&A.qpro&&(k.l+=2),T.e.c=k.read_shift(2),T.e.r=k.read_shift(2),P==12&&A.qpro&&(k.l+=2),T.s.c==65535&&(T.s.c=T.e.c=T.s.r=T.e.r=0),T)}function a(k){var P=me(8);return P.write_shift(2,k.s.c),P.write_shift(2,k.s.r),P.write_shift(2,k.e.c),P.write_shift(2,k.e.r),P}function c(k,P,A){var T=[{c:0,r:0},{t:"n",v:0},0,0];return A.qpro&&A.vers!=20768?(T[0].c=k.read_shift(1),T[3]=k.read_shift(1),T[0].r=k.read_shift(2),k.l+=2):(T[2]=k.read_shift(1),T[0].c=k.read_shift(2),T[0].r=k.read_shift(2)),T}function d(k,P,A){var T=k.l+P,j=c(k,P,A);if(j[1].t="s",A.vers==20768){k.l++;var R=k.read_shift(1);return j[1].v=k.read_shift(R,"utf8"),j}return A.qpro&&k.l++,j[1].v=k.read_shift(T-k.l,"cstr"),j}function f(k,P,A){var T=me(7+A.length);T.write_shift(1,255),T.write_shift(2,P),T.write_shift(2,k),T.write_shift(1,39);for(var j=0;j<T.length;++j){var R=A.charCodeAt(j);T.write_shift(1,R>=128?95:R)}return T.write_shift(1,0),T}function h(k,P,A){var T=c(k,P,A);return T[1].v=k.read_shift(2,"i"),T}function u(k,P,A){var T=me(7);return T.write_shift(1,255),T.write_shift(2,P),T.write_shift(2,k),T.write_shift(2,A,"i"),T}function g(k,P,A){var T=c(k,P,A);return T[1].v=k.read_shift(8,"f"),T}function m(k,P,A){var T=me(13);return T.write_shift(1,255),T.write_shift(2,P),T.write_shift(2,k),T.write_shift(8,A,"f"),T}function p(k,P,A){var T=k.l+P,j=c(k,P,A);if(j[1].v=k.read_shift(8,"f"),A.qpro)k.l=T;else{var R=k.read_shift(2);_(k.slice(k.l,k.l+R),j),k.l+=R}return j}function x(k,P,A){var T=P&32768;return P&=-32769,P=(T?k:0)+(P>=8192?P-16384:P),(T?"":"$")+(A?At(P):Bt(P))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(k,P){ar(k,0);for(var A=[],T=0,j="",R="",z="",I="";k.l<k.length;){var L=k[k.l++];switch(L){case 0:A.push(k.read_shift(8,"f"));break;case 1:R=x(P[0].c,k.read_shift(2),!0),j=x(P[0].r,k.read_shift(2),!1),A.push(R+j);break;case 2:{var K=x(P[0].c,k.read_shift(2),!0),O=x(P[0].r,k.read_shift(2),!1);R=x(P[0].c,k.read_shift(2),!0),j=x(P[0].r,k.read_shift(2),!1),A.push(K+O+":"+R+j)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:A.push("("+A.pop()+")");break;case 5:A.push(k.read_shift(2));break;case 6:{for(var B="";L=k[k.l++];)B+=String.fromCharCode(L);A.push('"'+B.replace(/"/g,'""')+'"')}break;case 8:A.push("-"+A.pop());break;case 23:A.push("+"+A.pop());break;case 22:A.push("NOT("+A.pop()+")");break;case 20:case 21:I=A.pop(),z=A.pop(),A.push(["AND","OR"][L-20]+"("+z+","+I+")");break;default:if(L<32&&y[L])I=A.pop(),z=A.pop(),A.push(z+y[L]+I);else if(v[L]){if(T=v[L][1],T==69&&(T=k[k.l++]),T>A.length){console.error("WK1 bad formula parse 0x"+L.toString(16)+":|"+A.join("|")+"|");return}var M=A.slice(-T);A.length-=T,A.push(v[L][0]+"("+M.join(",")+")")}else return L<=7?console.error("WK1 invalid opcode "+L.toString(16)):L<=24?console.error("WK1 unsupported op "+L.toString(16)):L<=30?console.error("WK1 invalid opcode "+L.toString(16)):L<=115?console.error("WK1 unsupported function opcode "+L.toString(16)):console.error("WK1 unrecognized opcode "+L.toString(16))}}A.length==1?P[1].f=""+A[0]:console.error("WK1 bad formula parse |"+A.join("|")+"|")}function b(k){var P=[{c:0,r:0},{t:"n",v:0},0];return P[0].r=k.read_shift(2),P[3]=k[k.l++],P[0].c=k[k.l++],P}function S(k,P){var A=b(k);return A[1].t="s",A[1].v=k.read_shift(P-4,"cstr"),A}function C(k,P,A,T){var j=me(6+T.length);j.write_shift(2,k),j.write_shift(1,A),j.write_shift(1,P),j.write_shift(1,39);for(var R=0;R<T.length;++R){var z=T.charCodeAt(R);j.write_shift(1,z>=128?95:z)}return j.write_shift(1,0),j}function N(k,P){var A=b(k);A[1].v=k.read_shift(2);var T=A[1].v>>1;if(A[1].v&1)switch(T&7){case 0:T=(T>>3)*5e3;break;case 1:T=(T>>3)*500;break;case 2:T=(T>>3)/20;break;case 3:T=(T>>3)/200;break;case 4:T=(T>>3)/2e3;break;case 5:T=(T>>3)/2e4;break;case 6:T=(T>>3)/16;break;case 7:T=(T>>3)/64;break}return A[1].v=T,A}function F(k,P){var A=b(k),T=k.read_shift(4),j=k.read_shift(4),R=k.read_shift(2);if(R==65535)return T===0&&j===3221225472?(A[1].t="e",A[1].v=15):T===0&&j===3489660928?(A[1].t="e",A[1].v=42):A[1].v=0,A;var z=R&32768;return R=(R&32767)-16446,A[1].v=(1-z*2)*(j*Math.pow(2,R+32)+T*Math.pow(2,R)),A}function Y(k,P,A,T){var j=me(14);if(j.write_shift(2,k),j.write_shift(1,A),j.write_shift(1,P),T==0)return j.write_shift(4,0),j.write_shift(4,0),j.write_shift(2,65535),j;var R=0,z=0,I=0,L=0;return T<0&&(R=1,T=-T),z=Math.log2(T)|0,T/=Math.pow(2,z-31),L=T>>>0,L&2147483648||(T/=2,++z,L=T>>>0),T-=L,L|=2147483648,L>>>=0,T*=Math.pow(2,32),I=T>>>0,j.write_shift(4,I),j.write_shift(4,L),z+=16383+(R?32768:0),j.write_shift(2,z),j}function X(k,P){var A=F(k);return k.l+=P-14,A}function V(k,P){var A=b(k),T=k.read_shift(4);return A[1].v=T>>6,A}function te(k,P){var A=b(k),T=k.read_shift(8,"f");return A[1].v=T,A}function G(k,P){var A=te(k);return k.l+=P-10,A}function re(k,P){return k[k.l+P-1]==0?k.read_shift(P,"cstr"):""}function Z(k,P){var A=k[k.l++];A>P-1&&(A=P-1);for(var T="";T.length<A;)T+=String.fromCharCode(k[k.l++]);return T}function oe(k,P,A){if(!(!A.qpro||P<21)){var T=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var j=k.read_shift(P-21,"cstr");return[T,j]}}function ee(k,P){for(var A={},T=k.l+P;k.l<T;){var j=k.read_shift(2);if(j==14e3){for(A[j]=[0,""],A[j][0]=k.read_shift(2);k[k.l];)A[j][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return A}function E(k,P){var A=me(5+k.length);A.write_shift(2,14e3),A.write_shift(2,P);for(var T=0;T<k.length;++T){var j=k.charCodeAt(T);A[A.l++]=j>127?95:j}return A[A.l++]=0,A}var D={0:{n:"BOF",f:Ht},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:p},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:Z},65535:{n:""}},U={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:S},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:X},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:V},38:{n:"??"},39:{n:"NUMBER27",f:te},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function nN(e){var t={},r=e.match(br),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Xe(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=T0[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var iN=function(){var e=fl("t"),t=fl("rPr");function r(s){var l=s.match(e);if(!l)return{t:"s",v:""};var o={t:"s",v:nt(l[1])},a=s.match(t);return a&&(o.s=nN(a[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),sN=function(){var t=/(\r\n|\n)/g;function r(i,s,l){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),l.push("</b>")),i.i&&(s.push("<i>"),l.push("</i>")),i.strike&&(s.push("<s>"),l.push("</s>"));var a=i.valign||"";return a=="superscript"||a=="super"?a="sup":a=="subscript"&&(a="sub"),a!=""&&(s.push("<"+a+">"),l.push("</"+a+">")),l.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),aN=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,oN=/<(?:\w+:)?r>/,lN=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function K0(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=nt(dt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=dt(e),r&&(n.h=I0(n.t))):e.match(oN)&&(n.r=dt(e),n.t=nt(dt((e.replace(lN,"").match(aN)||[]).join("").replace(br,""))),r&&(n.h=sN(iN(n.r)))),n):{t:""}}var cN=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,uN=/<(?:\w+:)?(?:si|sstItem)>/g,fN=/<\/(?:\w+:)?(?:si|sstItem)>/;function hN(e,t){var r=[],n="";if(!e)return r;var i=e.match(cN);if(i){n=i[2].replace(uN,"").split(fN);for(var s=0;s!=n.length;++s){var l=K0(n[s].trim(),t);l!=null&&(r[r.length]=l)}i=Xe(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var dN=/^\s|\s$|[\t\n\r]/;function aw(e,t){if(!t.bookSST)return"";var r=[Ut];r[r.length]=Ee("sst",null,{xmlns:js[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(dN)&&(s+=' xml:space="preserve"'),s+=">"+ft(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function gN(e){return[e.read_shift(4),e.read_shift(4)]}function pN(e,t){var r=[],n=!1;return ui(e,function(s,l,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function mN(e,t){return t||(t=me(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var xN=E4;function vN(e){var t=Ir();be(t,159,mN(e));for(var r=0;r<e.length;++r)be(t,19,xN(e[r]));return be(t,160),t.end()}function ow(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ti(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function yN(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ti(e,4),t.U=ti(e,4),t.W=ti(e,4),t}function wN(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function _N(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(wN(e));return t}function bN(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function SN(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ti(e,4),t.U=ti(e,4),t.W=ti(e,4),t}function kN(e){var t=SN(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function lw(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function cw(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function CN(e){var t=ti(e);switch(t.Minor){case 2:return[t.Minor,TN(e)];case 3:return[t.Minor,EN()];case 4:return[t.Minor,AN(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function TN(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=lw(e,r),i=cw(e,e.length-e.l);return{t:"Std",h:n,v:i}}function EN(){throw new Error("File is password-protected: ECMA-376 Extensible")}function AN(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(br,function(s){var l=Xe(s);switch(Wn(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=l[o]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function ON(e,t){var r={},n=r.EncryptionVersionInfo=ti(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=lw(e,i),t-=i,r.EncryptionVerifier=cw(e,t),r}function NN(e){var t={},r=t.EncryptionVersionInfo=ti(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function J0(e){var t=0,r,n=ow(e),i=n.length+1,s,l,o,a,c;for(r=Wi(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)l=r[s],o=t&16384?1:0,a=t<<1&32767,c=o|a,t=c^l;return t^52811}var uw=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},i=function(l,o){return n(l^o)},s=function(l){for(var o=t[l.length-1],a=104,c=l.length-1;c>=0;--c)for(var d=l[c],f=0;f!=7;++f)d&64&&(o^=r[a]),d*=2,--a;return o};return function(l){for(var o=ow(l),a=s(o),c=o.length,d=Wi(16),f=0;f!=16;++f)d[f]=0;var h,u,g;for((c&1)===1&&(h=a>>8,d[c]=i(e[0],h),--c,h=a&255,u=o[o.length-1],d[c]=i(u,h));c>0;)--c,h=a>>8,d[c]=i(o[c],h),--c,h=a&255,d[c]=i(o[c],h);for(c=15,g=15-o.length;g>0;)h=a>>8,d[c]=i(e[g],h),--c,--g,h=a&255,d[c]=i(o[c],h),--c,--g;return d}}(),FN=function(e,t,r,n,i){i||(i=t),n||(n=uw(e));var s,l;for(s=0;s!=t.length;++s)l=t[s],l^=n[r],l=(l>>5|l<<3)&255,i[s]=l,++r;return[i,r,n]},PN=function(e){var t=0,r=uw(e);return function(n){var i=FN("",n,t,r);return t=i[1],i[0]}};function DN(e,t,r,n){var i={key:Ht(e),verificationBytes:Ht(e)};return r.password&&(i.verifier=J0(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=PN(r.password)),i}function jN(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=NN(e):n.Data=ON(e,t),n}function RN(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?jN(e,t-2,n):DN(e,r.biff>=8?t:t-2,r,n),n}var fw=function(){function e(i,s){switch(s.type){case"base64":return t(Gr(i),s);case"binary":return t(i,s);case"buffer":return t(Qe&&Buffer.isBuffer(i)?i.toString("binary"):Gi(i),s);case"array":return t(Es(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var l=s||{},o=l.dense?[]:{},a=i.match(/\\trowd.*?\\row\b/g);if(!a.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:a.length-1}};return a.forEach(function(d,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,u=0,g,m=-1;g=h.exec(d);){switch(g[0]){case"\\cell":var p=d.slice(u,h.lastIndex-g[0].length);if(p[0]==" "&&(p=p.slice(1)),++m,p.length){var x={v:p,t:"s"};Array.isArray(o)?o[f][m]=x:o[$e({r:f,c:m})]=x}break}u=h.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=Ke(c),o}function r(i,s){return qi(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],l=st(i["!ref"]),o,a=Array.isArray(i),c=l.s.r;c<=l.e.r;++c){s.push("\\trowd\\trautofit1");for(var d=l.s.c;d<=l.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=l.s.c;d<=l.e.c;++d){var f=$e({r:c,c:d});o=a?(i[c]||[])[d]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(ai(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function IN(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function pl(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function MN(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),l=i-s;if(l===0)return[0,0,t];var o=0,a=0,c=i+s;switch(a=l/(c>1?2-c:c),i){case t:o=((r-n)/l+6)%6;break;case r:o=(n-t)/l+2;break;case n:o=(t-r)/l+4;break}return[o/6,a,c/2]}function LN(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,l=[s,s,s],o=6*t,a;if(r!==0)switch(o|0){case 0:case 6:a=i*o,l[0]+=i,l[1]+=a;break;case 1:a=i*(2-o),l[0]+=a,l[1]+=i;break;case 2:a=i*(o-2),l[1]+=i,l[2]+=a;break;case 3:a=i*(4-o),l[1]+=a,l[2]+=i;break;case 4:a=i*(o-4),l[2]+=i,l[0]+=a;break;case 5:a=i*(6-o),l[2]+=a,l[0]+=i;break}for(var c=0;c!=3;++c)l[c]=Math.round(l[c]*255);return l}function Cu(e,t){if(t===0)return e;var r=MN(IN(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),pl(LN(r))}var hw=6,BN=15,UN=1,xr=hw;function ml(e){return Math.floor((e+Math.round(128/xr)/256)*xr)}function xl(e){return Math.floor((e-5)/xr*100+.5)/100}function Tu(e){return Math.round((e*xr+5)/xr*256)/256}function Qf(e){return Tu(xl(ml(e)))}function Q0(e){var t=Math.abs(e-Qf(e)),r=xr;if(t>.005)for(xr=UN;xr<BN;++xr)Math.abs(e-Qf(e))<=t&&(t=Math.abs(e-Qf(e)),r=xr);xr=r}function zi(e){e.width?(e.wpx=ml(e.width),e.wch=xl(e.wpx),e.MDW=xr):e.wpx?(e.wch=xl(e.wpx),e.width=Tu(e.wch),e.MDW=xr):typeof e.wch=="number"&&(e.width=Tu(e.wch),e.wpx=ml(e.width),e.MDW=xr),e.customWidth&&delete e.customWidth}var WN=96,dw=WN;function vl(e){return e*96/dw}function Ba(e){return e*dw/96}var zN={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function HN(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(br)||[]).forEach(function(l){var o=Xe(l);switch(Wn(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=vt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=vt(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function VN(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(br)||[]).forEach(function(l){var o=Xe(l);switch(Wn(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function $N(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(br)||[]).forEach(function(l){var o=Xe(l);switch(Wn(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=dt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?vt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?vt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?vt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?vt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?vt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?vt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?vt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=T0[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=vt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var a=ps[i.color.index];i.color.index==81&&(a=ps[1]),a||(a=ps[1]),i.color.rgb=a[0].toString(16)+a[1].toString(16)+a[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Cu(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function XN(e,t,r){t.NumberFmt=[];for(var n=It(ze),i=0;i<n.length;++i)t.NumberFmt[n[i]]=ze[n[i]];var s=e[0].match(br);if(s)for(i=0;i<s.length;++i){var l=Xe(s[i]);switch(Wn(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=nt(dt(l.formatCode)),a=parseInt(l.numFmtId,10);if(t.NumberFmt[a]=o,a>0){if(a>392){for(a=392;a>60&&t.NumberFmt[a]!=null;--a);t.NumberFmt[a]=o}ei(o,a)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function YN(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ee("numFmt",null,{numFmtId:n,formatCode:ft(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ee("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var wc=["numFmtId","fillId","fontId","borderId","xfId"],_c=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function GN(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(br)||[]).forEach(function(s){var l=Xe(s),o=0;switch(Wn(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],o=0;o<wc.length;++o)n[wc[o]]&&(n[wc[o]]=parseInt(n[wc[o]],10));for(o=0;o<_c.length;++o)n[_c[o]]&&(n[_c[o]]=vt(n[_c[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var a={};l.vertical&&(a.vertical=l.vertical),l.horizontal&&(a.horizontal=l.horizontal),l.textRotation!=null&&(a.textRotation=l.textRotation),l.indent&&(a.indent=l.indent),l.wrapText&&(a.wrapText=vt(l.wrapText)),n.alignment=a;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function qN(e){var t=[];return t[t.length]=Ee("cellXfs",null),e.forEach(function(r){t[t.length]=Ee("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ee("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var KN=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,a,c){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&XN(f,d,c),(f=o.match(i))&&$N(f,d,a,c),(f=o.match(n))&&VN(f,d,a,c),(f=o.match(s))&&HN(f,d,a,c),(f=o.match(r))&&GN(f,d,c),d}}();function gw(e,t){var r=[Ut,Ee("styleSheet",null,{xmlns:js[0],"xmlns:vt":Gt.vt})],n;return e.SSF&&(n=YN(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=qN(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function JN(e,t){var r=e.read_shift(2),n=yr(e);return[r,n]}function QN(e,t,r){r||(r=me(6+4*t.length)),r.write_shift(2,e),er(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function ZN(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=j4(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var o=e.read_shift(1);o>0&&(n.family=o);var a=e.read_shift(1);switch(a>0&&(n.charset=a),e.l++,n.color=D4(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=yr(e),n}function e3(e,t){t||(t=me(25+4*32)),t.write_shift(2,e.sz*20),R4(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),bu(e.color,t);var n=0;return n=2,t.write_shift(1,n),er(e.name,t),t.length>t.l?t.slice(0,t.l):t}var t3=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Zf,r3=_r;function Vm(e,t){t||(t=me(4*3+8*7+16*1)),Zf||(Zf=Zu(t3));var r=Zf[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(bu({auto:1},t),bu({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function n3(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function pw(e,t,r){r||(r=me(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function oo(e,t){return t||(t=me(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var i3=_r;function s3(e,t){return t||(t=me(51)),t.write_shift(1,0),oo(null,t),oo(null,t),oo(null,t),oo(null,t),oo(null,t),t.length>t.l?t.slice(0,t.l):t}function a3(e,t){return t||(t=me(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),_u(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function o3(e,t,r){var n=me(2052);return n.write_shift(4,e),_u(t,n),_u(r,n),n.length>n.l?n.slice(0,n.l):n}function l3(e,t,r){var n={};n.NumberFmt=[];for(var i in ze)n.NumberFmt[i]=ze[i];n.CellXf=[],n.Fonts=[];var s=[],l=!1;return ui(e,function(a,c,d){switch(d){case 44:n.NumberFmt[a[0]]=a[1],ei(a[1],a[0]);break;case 43:n.Fonts.push(a),a.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=Cu(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(a);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(d),l=!0;break;case 38:s.pop(),l=!1;break;default:if(c.T>0)s.push(d);else if(c.T<0)s.pop();else if(!l||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function c3(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(be(e,615,Tn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&be(e,44,QN(i,t[i]))}),be(e,616))}}function u3(e){var t=1;be(e,611,Tn(t)),be(e,43,e3({sz:12,color:{theme:1},name:"Calibri",family:2})),be(e,612)}function f3(e){var t=2;be(e,603,Tn(t)),be(e,45,Vm({patternType:"none"})),be(e,45,Vm({patternType:"gray125"})),be(e,604)}function h3(e){var t=1;be(e,613,Tn(t)),be(e,46,s3()),be(e,614)}function d3(e){var t=1;be(e,626,Tn(t)),be(e,47,pw({numFmtId:0},65535)),be(e,627)}function g3(e,t){be(e,617,Tn(t.length)),t.forEach(function(r){be(e,47,pw(r,0))}),be(e,618)}function p3(e){var t=1;be(e,619,Tn(t)),be(e,48,a3({xfId:0,name:"Normal"})),be(e,620)}function m3(e){var t=0;be(e,505,Tn(t)),be(e,506)}function x3(e){var t=0;be(e,508,o3(t,"TableStyleMedium9","PivotStyleMedium4")),be(e,509)}function v3(e,t){var r=Ir();return be(r,278),c3(r,e.SSF),u3(r),f3(r),h3(r),d3(r),g3(r,t.cellXfs),p3(r),m3(r),x3(r),be(r,279),r.end()}var y3=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function w3(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(br)||[]).forEach(function(i){var s=Xe(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[y3.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function _3(){}function b3(){}var S3=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,k3=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,C3=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function T3(e,t,r){t.themeElements={};var n;[["clrScheme",S3,w3],["fontScheme",k3,_3],["fmtScheme",C3,b3]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var E3=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function mw(e,t){(!e||e.length===0)&&(e=Z0());var r,n={};if(!(r=e.match(E3)))throw new Error("themeElements not found in theme");return T3(r[0],n,t),n.raw=e,n}function Z0(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Ut];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function A3(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var l;try{l=ly(s,{type:"array"})}catch{return}var o=Vr(l,"theme/theme/theme1.xml",!0);if(o)return mw(o,r)}}function O3(e){return e.read_shift(4)}function N3(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=F3(e,4);break;case 2:t.xclrValue=qy(e);break;case 3:t.xclrValue=O3(e);break;case 4:e.l+=4;break}return e.l+=8,t}function F3(e,t){return _r(e,t)}function P3(e,t){return _r(e,t)}function D3(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=N3(e);break;case 6:n[1]=P3(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function j3(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(D3(e,r-e.l));return{ixfe:n,ext:s}}function R3(e,t){t.forEach(function(r){switch(r[0]){}})}function I3(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:yr(e)}}function M3(e){var t=me(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),er(e.name,t),t.slice(0,t.l)}function L3(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function B3(e){var t=me(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function U3(e,t){var r=me(8+2*t.length);return r.write_shift(4,e),er(t,r),r.slice(0,r.l)}function W3(e){return e.l+=4,e.read_shift(4)!=0}function z3(e,t){var r=me(8);return r.write_shift(4,e),r.write_shift(4,1),r}function H3(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],l=!1,o=2;return ui(e,function(a,c,d){switch(d){case 335:n.Types.push({name:a.name});break;case 51:a.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=a?1:0;break;case 338:o=2;break;case 35:s.push(d),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!c.T){if(!l||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function V3(){var e=Ir();return be(e,332),be(e,334,Tn(1)),be(e,335,M3({name:"XLDAPR",version:12e4,flags:3496657072})),be(e,336),be(e,339,U3(1,"XLDAPR")),be(e,52),be(e,35,Tn(514)),be(e,4096,Tn(0)),be(e,4097,rn(1)),be(e,36),be(e,53),be(e,340),be(e,337,z3(1)),be(e,51,B3([[1,0]])),be(e,338),be(e,333),e.end()}function $3(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,l;return e.replace(br,function(o){var a=Xe(o);switch(Wn(a[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:a.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==a.name&&(l=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[a.t-1].name,index:+a.v}):s==0&&n.Value.push({type:n.Types[a.t-1].name,index:+a.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+a.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+a[0]+" in metadata")}return o}),n}function xw(){var e=[Ut];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function X3(e){var t=[];if(!e)return t;var r=1;return(e.match(br)||[]).forEach(function(n){var i=Xe(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function Y3(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=$e(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function G3(e,t,r){var n=[];return ui(e,function(s,l,o){switch(o){case 63:n.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function q3(e,t,r,n){if(!e)return e;var i=n||{},s=!1;ui(e,function(o,a,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!a.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function K3(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var ga=1024;function vw(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Ee("xml",null,{"xmlns:v":Wr.v,"xmlns:o":Wr.o,"xmlns:x":Wr.x,"xmlns:mv":Wr.mv}).replace(/\/>/,">"),Ee("o:shapelayout",Ee("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ee("v:shapetype",[Ee("v:stroke",null,{joinstyle:"miter"}),Ee("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];ga<e*1e3;)ga+=1e3;return t.forEach(function(s){var l=Ot(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var a=o.type=="gradient"?Ee("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Ee("v:fill",a,o),d={on:"t",obscured:"t"};++ga,i=i.concat(["<v:shape"+hl({id:"_x0000_s"+ga,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Ee("v:shadow",null,d),Ee("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",or("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),or("x:AutoFill","False"),or("x:Row",String(l.r)),or("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function $m(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(l){var o=Ot(l.ref);if(i?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[l.ref],!s){s={t:"z"},i?e[o.r][o.c]=s:e[l.ref]=s;var a=st(e["!ref"]||"BDWGO1000001:A1");a.s.r>o.r&&(a.s.r=o.r),a.e.r<o.r&&(a.e.r=o.r),a.s.c>o.c&&(a.s.c=o.c),a.e.c<o.c&&(a.e.c=o.c);var c=Ke(a);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var d={a:l.author,t:l.t,r:l.r,T:r};l.h&&(d.h=l.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}s.c.push(d)})}function J3(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?comment[^>]*>/);if(o){var a=Xe(o[0]),c={author:a.authorId&&r[a.authorId]||"sheetjsghost",ref:a.ref,guid:a.guid},d=Ot(a.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&K0(f[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function yw(e){var t=[Ut,Ee("comments",null,{xmlns:js[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=ft(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(a){a.a&&(i=r.indexOf(ft(a.a))),s.push(a.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(or("t",ft(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)l+=`Reply:
    `+s[o]+`
`;t.push(or("t",ft(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Q3(e,t){var r=[],n=!1,i={},s=0;return e.replace(br,function(o,a){var c=Xe(o);switch(Wn(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=a+o.length;break;case"</text>":i.t=e.slice(s,a).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function Z3(e,t,r){var n=[Ut,Ee("ThreadedComments",null,{xmlns:Gt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var a={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=a.id:a.parentId=s,l.ID=a.id,l.a&&(a.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),n.push(Ee("threadedComment",or("text",l.t||""),a))})}),n.push("</ThreadedComments>"),n.join("")}function eF(e,t){var r=[],n=!1;return e.replace(br,function(s){var l=Xe(s);switch(Wn(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),r}function tF(e){var t=[Ut,Ee("personList",null,{xmlns:Gt.TCMNT,"xmlns:x":js[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ee("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function rF(e){var t={};t.iauthor=e.read_shift(4);var r=Ls(e);return t.rfx=r.s,t.ref=$e(r.s),e.l+=16,t}function nF(e,t){return t==null&&(t=me(36)),t.write_shift(4,e[1].iauthor),Ga(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var iF=yr;function sF(e){return er(e.slice(0,54))}function aF(e,t){var r=[],n=[],i={},s=!1;return ui(e,function(o,a,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!a.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function oF(e){var t=Ir(),r=[];return be(t,628),be(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),be(t,632,sF(i.a)))})}),be(t,631),be(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Ot(n[0]),e:Ot(n[0])};be(t,635,nF([s,i])),i.t&&i.t.length>0&&be(t,637,O4(i)),be(t,636),delete i.iauthor})}),be(t,634),be(t,629),t.end()}var lF="application/vnd.ms-office.vbaProject";function cF(e){var t=Me.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Me.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Me.write(t)}function uF(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Me.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var ww=["xlsb","xlsm","xlam","biff8","xla"];function fF(){return{"!type":"dialog"}}function hF(){return{"!type":"dialog"}}function dF(){return{"!type":"macro"}}function gF(){return{"!type":"macro"}}var Ta=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,l){var o=!1,a=!1;s.length==0?a=!0:s.charAt(0)=="["&&(a=!0,s=s.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,d=l.length>0?parseInt(l,10)|0:0;return o?d+=t.c:--d,a?c+=t.r:--c,i+(o?"":"$")+At(d)+(a?"":"$")+Bt(c)}return function(i,s){return t=s,i.replace(e,r)}}(),eg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,tg=function(){return function(t,r){return t.replace(eg,function(n,i,s,l,o,a){var c=W0(l)-(s?0:r.c),d=U0(a)-(o?0:r.r),f=d==0?"":o?d+1:"["+d+"]",h=c==0?"":s?c+1:"["+c+"]";return i+"R"+f+"C"+h})}}();function _w(e,t){return e.replace(eg,function(r,n,i,s,l,o){return n+(i=="$"?i+s:At(W0(s)+t.c))+(l=="$"?l+o:Bt(U0(o)+t.r))})}function pF(e,t,r){var n=Mr(t),i=n.s,s=Ot(r),l={r:s.r-i.r,c:s.c-i.c};return _w(e,l)}function mF(e){return e.length!=1}function Xm(e){return e.replace(/_xlfn\./g,"")}function Wt(e){e.l+=1}function Hi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function bw(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Sw(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),l=Hi(e),o=Hi(e);return{s:{r:i,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Sw(e){var t=Hi(e),r=Hi(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function xF(e,t,r){if(r.biff<8)return Sw(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=Hi(e),l=Hi(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function kw(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return vF(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Hi(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function vF(e){var t=Hi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function yF(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function wF(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return _F(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),l=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:l,rRel:o}}function _F(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function bF(e,t,r){var n=(e[e.l++]&96)>>5,i=bw(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function SF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var l=bw(e,s,r);return[n,i,l]}function kF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function CF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function TF(e,t,r){var n=(e[e.l++]&96)>>5,i=xF(e,t-1,r);return[n,i]}function EF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Ym(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function AF(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function OF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function NF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function FF(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function PF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Cw(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function DF(e){return e.read_shift(2),Cw(e)}function jF(e){return e.read_shift(2),Cw(e)}function RF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=kw(e,0,r);return[n,i]}function IF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=wF(e,0,r);return[n,i]}function MF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=kw(e,0,r);return[n,i,s]}function LF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[WP[i],Aw[i],n]}function BF(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:UF(e);return[i,(s[0]===0?Aw:UP)[s[1]]]}function UF(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function WF(e,t,r){e.l+=r&&r.biff==2?3:4}function zF(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function HF(e){return e.l++,fi[e.read_shift(1)]}function VF(e){return e.l++,e.read_shift(2)}function $F(e){return e.l++,e.read_shift(1)!==0}function XF(e){return e.l++,vr(e)}function YF(e,t,r){return e.l++,jl(e,t-1,r)}function GF(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Mt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=fi[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=vr(e);break;case 2:r[1]=Bs(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function qF(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Ls:rf)(e));return i}function KF(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,l=[];s!=n&&(l[s]=[]);++s)for(var o=0;o!=i;++o)l[s][o]=GF(e,r.biff);return l}function JF(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function QF(e,t,r){if(r.biff==5)return ZF(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function ZF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function eP(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function tP(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function rP(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function nP(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var iP=_r,sP=_r,aP=_r;function Il(e,t,r){return e.l+=2,[yF(e)]}function rg(e){return e.l+=6,[]}var oP=Il,lP=rg,cP=rg,uP=Il;function Tw(e){return e.l+=2,[Ht(e),e.read_shift(2)&1]}var fP=Il,hP=Tw,dP=rg,gP=Il,pP=Il,mP=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function xP(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),l=mP[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:n,c:i,C:s}}function vP(e){return e.l+=2,[e.read_shift(4)]}function yP(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function wP(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function _P(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function bP(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function SP(e){return e.l+=4,[0,0]}var Gm={1:{n:"PtgExp",f:zF},2:{n:"PtgTbl",f:aP},3:{n:"PtgAdd",f:Wt},4:{n:"PtgSub",f:Wt},5:{n:"PtgMul",f:Wt},6:{n:"PtgDiv",f:Wt},7:{n:"PtgPower",f:Wt},8:{n:"PtgConcat",f:Wt},9:{n:"PtgLt",f:Wt},10:{n:"PtgLe",f:Wt},11:{n:"PtgEq",f:Wt},12:{n:"PtgGe",f:Wt},13:{n:"PtgGt",f:Wt},14:{n:"PtgNe",f:Wt},15:{n:"PtgIsect",f:Wt},16:{n:"PtgUnion",f:Wt},17:{n:"PtgRange",f:Wt},18:{n:"PtgUplus",f:Wt},19:{n:"PtgUminus",f:Wt},20:{n:"PtgPercent",f:Wt},21:{n:"PtgParen",f:Wt},22:{n:"PtgMissArg",f:Wt},23:{n:"PtgStr",f:YF},26:{n:"PtgSheet",f:yP},27:{n:"PtgEndSheet",f:wP},28:{n:"PtgErr",f:HF},29:{n:"PtgBool",f:$F},30:{n:"PtgInt",f:VF},31:{n:"PtgNum",f:XF},32:{n:"PtgArray",f:EF},33:{n:"PtgFunc",f:LF},34:{n:"PtgFuncVar",f:BF},35:{n:"PtgName",f:JF},36:{n:"PtgRef",f:RF},37:{n:"PtgArea",f:bF},38:{n:"PtgMemArea",f:eP},39:{n:"PtgMemErr",f:iP},40:{n:"PtgMemNoMem",f:sP},41:{n:"PtgMemFunc",f:tP},42:{n:"PtgRefErr",f:rP},43:{n:"PtgAreaErr",f:kF},44:{n:"PtgRefN",f:IF},45:{n:"PtgAreaN",f:TF},46:{n:"PtgMemAreaN",f:_P},47:{n:"PtgMemNoMemN",f:bP},57:{n:"PtgNameX",f:QF},58:{n:"PtgRef3d",f:MF},59:{n:"PtgArea3d",f:SF},60:{n:"PtgRefErr3d",f:nP},61:{n:"PtgAreaErr3d",f:CF},255:{}},kP={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},CP={1:{n:"PtgElfLel",f:Tw},2:{n:"PtgElfRw",f:gP},3:{n:"PtgElfCol",f:oP},6:{n:"PtgElfRwV",f:pP},7:{n:"PtgElfColV",f:uP},10:{n:"PtgElfRadical",f:fP},11:{n:"PtgElfRadicalS",f:dP},13:{n:"PtgElfColS",f:lP},15:{n:"PtgElfColSV",f:cP},16:{n:"PtgElfRadicalLel",f:hP},25:{n:"PtgList",f:xP},29:{n:"PtgSxName",f:vP},255:{}},TP={0:{n:"PtgAttrNoop",f:SP},1:{n:"PtgAttrSemi",f:PF},2:{n:"PtgAttrIf",f:NF},4:{n:"PtgAttrChoose",f:AF},8:{n:"PtgAttrGoto",f:OF},16:{n:"PtgAttrSum",f:WF},32:{n:"PtgAttrBaxcel",f:Ym},33:{n:"PtgAttrBaxcel",f:Ym},64:{n:"PtgAttrSpace",f:DF},65:{n:"PtgAttrSpaceSemi",f:jF},128:{n:"PtgAttrIfError",f:FF},255:{}};function Ml(e,t,r,n){if(n.biff<8)return _r(e,t);for(var i=e.l+t,s=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=KF(e,0,n),s.push(r[l][1]);break;case"PtgMemArea":r[l][2]=qF(e,r[l][1],n),s.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=e.read_shift(4),s.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=i-e.l,t!==0&&s.push(_r(e,t)),s}function Ll(e,t,r){for(var n=e.l+t,i,s,l=[];n!=e.l;)t=n-e.l,s=e[e.l],i=Gm[s]||Gm[kP[s]],(s===24||s===25)&&(i=(s===24?CP:TP)[e[e.l+1]]),!i||!i.f?_r(e,t):l.push([i.n,i.f(e,t,r)]);return l}function EP(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var l=n[s];if(l)switch(l[0]){case 2:i.push('"'+l[1].replace(/"/g,'""')+'"');break;default:i.push(l[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var AP={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function OP(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Ew(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function qm(e,t,r){var n=Ew(e,t,r);return n=="#REF"?n:OP(n,r)}function pr(e,t,r,n,i){var s=i&&i.biff||8,l={s:{c:0,r:0}},o=[],a,c,d,f=0,h=0,u,g="";if(!e[0]||!e[0][0])return"";for(var m=-1,p="",x=0,v=e[0].length;x<v;++x){var y=e[0][x];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(a=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:p=jt(" ",e[0][m][1][1]);break;case 1:p=jt("\r",e[0][m][1][1]);break;default:if(p="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+p,m=-1}o.push(c+AP[y[0]]+a);break;case"PtgIsect":a=o.pop(),c=o.pop(),o.push(c+" "+a);break;case"PtgUnion":a=o.pop(),c=o.pop(),o.push(c+","+a);break;case"PtgRange":a=o.pop(),c=o.pop(),o.push(c+":"+a);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=No(y[1][1],l,i),o.push(Fo(d,s));break;case"PtgRefN":d=r?No(y[1][1],r,i):y[1][1],o.push(Fo(d,s));break;case"PtgRef3d":f=y[1][1],d=No(y[1][2],l,i),g=qm(n,f,i),o.push(g+"!"+Fo(d,s));break;case"PtgFunc":case"PtgFuncVar":var _=y[1][0],b=y[1][1];_||(_=0),_&=127;var S=_==0?[]:o.slice(-_);o.length-=_,b==="User"&&(b=S.shift()),o.push(b+"("+S.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":u=km(y[1][1],r?{s:r}:l,i),o.push(qf(u,i));break;case"PtgArea":u=km(y[1][1],l,i),o.push(qf(u,i));break;case"PtgArea3d":f=y[1][1],u=y[1][2],g=qm(n,f,i),o.push(g+"!"+qf(u,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=y[1][2];var C=(n.names||[])[h-1]||(n[0]||[])[h],N=C?C.Name:"SH33TJSNAME"+String(h);N&&N.slice(0,6)=="_xlfn."&&!i.xlfn&&(N=N.slice(6)),o.push(N);break;case"PtgNameX":var F=y[1][1];h=y[1][2];var Y;if(i.biff<=5)F<0&&(F=-F),n[F]&&(Y=n[F][h]);else{var X="";if(((n[F]||[])[0]||[])[0]==14849||(((n[F]||[])[0]||[])[0]==1025?n[F][h]&&n[F][h].itab>0&&(X=n.SheetNames[n[F][h].itab-1]+"!"):X=n.SheetNames[h-1]+"!"),n[F]&&n[F][h])X+=n[F][h].Name;else if(n[0]&&n[0][h])X+=n[0][h].Name;else{var V=(Ew(n,F,i)||"").split(";;");V[h-1]?X=V[h-1]:X+="SH33TJSERRX"}o.push(X);break}Y||(Y={Name:"SH33TJSERRY"}),o.push(Y.Name);break;case"PtgParen":var te="(",G=")";if(m>=0){switch(p="",e[0][m][1][0]){case 2:te=jt(" ",e[0][m][1][1])+te;break;case 3:te=jt("\r",e[0][m][1][1])+te;break;case 4:G=jt(" ",e[0][m][1][1])+G;break;case 5:G=jt("\r",e[0][m][1][1])+G;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(te+o.pop()+G);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var re={c:r.c,r:r.r};if(n.sharedf[$e(d)]){var Z=n.sharedf[$e(d)];o.push(pr(Z,l,re,n,i))}else{var oe=!1;for(a=0;a!=n.arrayf.length;++a)if(c=n.arrayf[a],!(d.c<c[0].s.c||d.c>c[0].e.c)&&!(d.r<c[0].s.r||d.r>c[0].e.r)){o.push(pr(c[1],l,re,n,i)),oe=!0;break}oe||o.push(y[1])}break;case"PtgArray":o.push("{"+EP(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var ee=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&ee.indexOf(e[0][x][0])==-1){y=e[0][m];var E=!0;switch(y[1][0]){case 4:E=!1;case 0:p=jt(" ",y[1][1]);break;case 5:E=!1;case 1:p=jt("\r",y[1][1]);break;default:if(p="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((E?p:"")+o.pop()+(E?"":p)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function NP(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,l=e.read_shift(i);if(l==65535)return[[],_r(e,t-2)];var o=Ll(e,l,r);return t!==l+i&&(s=Ml(e,t-l-i,o,r)),e.l=n,[o,s]}function FP(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,l=e.read_shift(i);if(l==65535)return[[],_r(e,t-2)];var o=Ll(e,l,r);return t!==l+i&&(s=Ml(e,t-l-i,o,r)),e.l=n,[o,s]}function PP(e,t,r,n){var i=e.l+t,s=Ll(e,n,r),l;return i!==e.l&&(l=Ml(e,i-e.l,s,r)),[s,l]}function DP(e,t,r){var n=e.l+t,i,s=e.read_shift(2),l=Ll(e,s,r);return s==65535?[[],_r(e,t-2)]:(t!==s+2&&(i=Ml(e,n-s-2,l,r)),[l,i])}function jP(e){var t;if(qn(e,e.l+6)!==65535)return[vr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function RP(e){if(e==null){var t=me(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return As(e);return As(0)}function eh(e,t,r){var n=e.l+t,i=zn(e);r.biff==2&&++e.l;var s=jP(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=FP(e,n-e.l,r);return{cell:i,val:s[0],formula:o,shared:l>>3&1,tt:s[1]}}function IP(e,t,r,n,i){var s=Ns(t,r,i),l=RP(e.v),o=me(6),a=33;o.write_shift(2,a),o.write_shift(4,0);for(var c=me(e.bf.length),d=0;d<e.bf.length;++d)c[d]=e.bf[d];var f=Zt([s,l,o,c]);return f}function nf(e,t,r){var n=e.read_shift(4),i=Ll(e,n,r),s=e.read_shift(4),l=s>0?Ml(e,s,i,r):null;return[i,l]}var MP=nf,sf=nf,LP=nf,BP=nf,UP={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Aw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},WP={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Km(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function zP(e){var t="of:="+e.replace(eg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function th(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function HP(e){return e.replace(/\./,"!")}var Do={},Ea={},jo=typeof Map<"u";function ng(e,t,r){var n=0,i=e.length;if(r){if(jo?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=jo?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(jo?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function af(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(xr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=xl(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Tu(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function vs(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ki(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){ei(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Ow(e,t,r,n,i,s){try{n.cellNF&&(e.z=ze[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=wt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(ze[t]==null&&ei(UE[t]||"General",t),e.t==="e")e.w=e.w||fi[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ul(e.v);else if(e.t==="d"){var l=Kt(e.v);(l|0)===l?e.w=l.toString(10):e.w=ul(l)}else{if(e.v===void 0)return"";e.w=Ts(e.v,Ea)}else e.t==="d"?e.w=hn(t,Kt(e.v),Ea):e.w=hn(t,e.v,Ea)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Cu(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Cu(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function VP(e,t,r){if(e&&e["!ref"]){var n=st(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function $P(e,t){var r=st(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ke(r))}var XP=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,YP=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,GP=/<(?:\w:)?hyperlink [^>]*>/mg,qP=/"(\w*:\w*)"/,KP=/<(?:\w:)?col\b[^>]*[\/]?>/g,JP=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,QP=/<(?:\w:)?pageMargins[^>]*\/>/g,Nw=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,ZP=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,eD=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function tD(e,t,r,n,i,s,l){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},a={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",f=e.match(YP);f?(c=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):c=d=e;var h=c.match(Nw);h?ig(h[0],o,i,r):(h=c.match(ZP))&&nD(h[0],h[1]||"",o,i,r);var u=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(u>0){var g=c.slice(u,u+50).match(qP);g&&$P(o,g[1])}var m=c.match(eD);m&&m[1]&&mD(m[1],i);var p=[];if(t.cellStyles){var x=c.match(KP);x&&fD(p,x)}f&&yD(f[1],o,t,a,s,l);var v=d.match(JP);v&&(o["!autofilter"]=dD(v[0]));var y=[],_=d.match(XP);if(_)for(u=0;u!=_.length;++u)y[u]=st(_[u].slice(_[u].indexOf('"')+1));var b=d.match(GP);b&&lD(o,b,n);var S=d.match(QP);if(S&&(o["!margins"]=cD(Xe(S[0]))),!o["!ref"]&&a.e.c>=a.s.c&&a.e.r>=a.s.r&&(o["!ref"]=Ke(a)),t.sheetRows>0&&o["!ref"]){var C=st(o["!ref"]);t.sheetRows<=+C.e.r&&(C.e.r=t.sheetRows-1,C.e.r>a.e.r&&(C.e.r=a.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>a.e.c&&(C.e.c=a.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ke(C))}return p.length>0&&(o["!cols"]=p),y.length>0&&(o["!merges"]=y),o}function rD(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ke(e[r])+'"/>';return t+"</mergeCells>"}function ig(e,t,r,n){var i=Xe(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=nt(dt(i.codeName)))}function nD(e,t,r,n,i){ig(e.slice(0,e.indexOf(">")),r,n,i)}function iD(e,t,r,n,i){var s=!1,l={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var a=t.SheetNames[r];try{t.Workbook&&(a=t.Workbook.Sheets[r].CodeName||a)}catch{}s=!0,l.codeName=Mn(ft(a))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+Ee("outlinePr",null,c)}!s&&!o||(i[i.length]=Ee("sheetPr",o,l))}var sD=["objects","scenarios","selectLockedCells","selectUnlockedCells"],aD=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function oD(e){var t={sheet:1};return sD.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),aD.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=J0(e.password).toString(16).toUpperCase()),Ee("sheetProtection",null,t)}function lD(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=Xe(dt(t[i]),!0);if(!s.ref)return;var l=((r||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+nt(s.location))):(s.Target="#"+nt(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=st(s.ref),a=o.s.r;a<=o.e.r;++a)for(var c=o.s.c;c<=o.e.c;++c){var d=$e({c,r:a});n?(e[a]||(e[a]=[]),e[a][c]||(e[a][c]={t:"z",v:void 0}),e[a][c].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}function cD(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function uD(e){return vs(e),Ee("pageMargins",null,e)}function fD(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Xe(t[n],!0);i.hidden&&(i.hidden=vt(i.hidden));var s=parseInt(i.min,10)-1,l=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Q0(i.width)),zi(i);s<=l;)e[s++]=_t(i)}}function hD(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=Ee("col",null,af(i,n)));return r[r.length]="</cols>",r.join("")}function dD(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function gD(e,t,r,n){var i=typeof e.ref=="string"?e.ref:Ke(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=Mr(i);l.s.r==l.e.r&&(l.e.r=Mr(t["!ref"]).e.r,i=Ke(l));for(var o=0;o<s.length;++o){var a=s[o];if(a.Name=="_xlnm._FilterDatabase"&&a.Sheet==n){a.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ee("autoFilter",null,{ref:i})}var pD=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function mD(e,t){t.Views||(t.Views=[{}]),(e.match(pD)||[]).forEach(function(r,n){var i=Xe(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),vt(i.rightToLeft)&&(t.Views[n].RTL=!0)})}function xD(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ee("sheetViews",Ee("sheetView",null,i),{})}function vD(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=fi[e.v];break;case"d":n&&n.cellDates?i=wt(e.v,-1).toISOString():(e=_t(e),e.t="n",i=""+(e.v=Kt(wt(e.v)))),typeof e.z>"u"&&(e.z=ze[14]);break;default:i=e.v;break}var o=or("v",ft(i)),a={r:t},c=Ki(n.cellXfs,e,n);switch(c!==0&&(a.s=c),e.t){case"n":break;case"d":a.t="d";break;case"b":a.t="b";break;case"e":a.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=or("v",""+ng(n.Strings,e.v,n.revStrings)),a.t="s";break}a.t="str";break}if(e.t!=s&&(e.t=s,e.v=l),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Ee("f",ft(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(a.cm=1),Ee("c",o,a)}var yD=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=fl("v"),l=fl("f");return function(a,c,d,f,h,u){for(var g=0,m="",p=[],x=[],v=0,y=0,_=0,b="",S,C,N=0,F=0,Y,X,V=0,te=0,G=Array.isArray(u.CellXf),re,Z=[],oe=[],ee=Array.isArray(c),E=[],D={},U=!1,k=!!d.sheetStubs,P=a.split(t),A=0,T=P.length;A!=T;++A){m=P[A].trim();var j=m.length;if(j!==0){var R=0;e:for(g=0;g<j;++g)switch(m[g]){case">":if(m[g-1]!="/"){++g;break e}if(d&&d.cellStyles){if(C=Xe(m.slice(R,g),!0),N=C.r!=null?parseInt(C.r,10):N+1,F=-1,d.sheetRows&&d.sheetRows<N)continue;D={},U=!1,C.ht&&(U=!0,D.hpt=parseFloat(C.ht),D.hpx=Ba(D.hpt)),C.hidden=="1"&&(U=!0,D.hidden=!0),C.outlineLevel!=null&&(U=!0,D.level=+C.outlineLevel),U&&(E[N-1]=D)}break;case"<":R=g;break}if(R>=g)break;if(C=Xe(m.slice(R,g),!0),N=C.r!=null?parseInt(C.r,10):N+1,F=-1,!(d.sheetRows&&d.sheetRows<N)){f.s.r>N-1&&(f.s.r=N-1),f.e.r<N-1&&(f.e.r=N-1),d&&d.cellStyles&&(D={},U=!1,C.ht&&(U=!0,D.hpt=parseFloat(C.ht),D.hpx=Ba(D.hpt)),C.hidden=="1"&&(U=!0,D.hidden=!0),C.outlineLevel!=null&&(U=!0,D.level=+C.outlineLevel),U&&(E[N-1]=D)),p=m.slice(g).split(e);for(var z=0;z!=p.length&&p[z].trim().charAt(0)=="<";++z);for(p=p.slice(z),g=0;g!=p.length;++g)if(m=p[g].trim(),m.length!==0){if(x=m.match(r),v=g,y=0,_=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,x!=null&&x.length===2){for(v=0,b=x[1],y=0;y!=b.length&&!((_=b.charCodeAt(y)-64)<1||_>26);++y)v=26*v+_;--v,F=v}else++F;for(y=0;y!=m.length&&m.charCodeAt(y)!==62;++y);if(++y,C=Xe(m.slice(0,y),!0),C.r||(C.r=$e({r:N-1,c:F})),b=m.slice(y),S={t:""},(x=b.match(s))!=null&&x[1]!==""&&(S.v=nt(x[1])),d.cellFormula){if((x=b.match(l))!=null&&x[1]!==""){if(S.f=nt(dt(x[1])).replace(/\r\n/g,`
`),d.xlfn||(S.f=Xm(S.f)),x[0].indexOf('t="array"')>-1)S.F=(b.match(i)||[])[1],S.F.indexOf(":")>-1&&Z.push([st(S.F),S.F]);else if(x[0].indexOf('t="shared"')>-1){X=Xe(x[0]);var I=nt(dt(x[1]));d.xlfn||(I=Xm(I)),oe[parseInt(X.si,10)]=[X,I,C.r]}}else(x=b.match(/<f[^>]*\/>/))&&(X=Xe(x[0]),oe[X.si]&&(S.f=pF(oe[X.si][1],oe[X.si][2],C.r)));var L=Ot(C.r);for(y=0;y<Z.length;++y)L.r>=Z[y][0].s.r&&L.r<=Z[y][0].e.r&&L.c>=Z[y][0].s.c&&L.c<=Z[y][0].e.c&&(S.F=Z[y][1])}if(C.t==null&&S.v===void 0)if(S.f||S.F)S.v=0,S.t="n";else if(k)S.t="z";else continue;else S.t=C.t||"n";switch(f.s.c>F&&(f.s.c=F),f.e.c<F&&(f.e.c=F),S.t){case"n":if(S.v==""||S.v==null){if(!k)continue;S.t="z"}else S.v=parseFloat(S.v);break;case"s":if(typeof S.v>"u"){if(!k)continue;S.t="z"}else Y=Do[parseInt(S.v,10)],S.v=Y.t,S.r=Y.r,d.cellHTML&&(S.h=Y.h);break;case"str":S.t="s",S.v=S.v!=null?dt(S.v):"",d.cellHTML&&(S.h=I0(S.v));break;case"inlineStr":x=b.match(n),S.t="s",x!=null&&(Y=K0(x[1]))?(S.v=Y.t,d.cellHTML&&(S.h=Y.h)):S.v="";break;case"b":S.v=vt(S.v);break;case"d":d.cellDates?S.v=wt(S.v,1):(S.v=Kt(wt(S.v,1)),S.t="n");break;case"e":(!d||d.cellText!==!1)&&(S.w=S.v),S.v=Py[S.v];break}if(V=te=0,re=null,G&&C.s!==void 0&&(re=u.CellXf[C.s],re!=null&&(re.numFmtId!=null&&(V=re.numFmtId),d.cellStyles&&re.fillId!=null&&(te=re.fillId))),Ow(S,V,te,d,h,u),d.cellDates&&G&&S.t=="n"&&$a(ze[V])&&(S.t="d",S.v=tf(S.v)),C.cm&&d.xlmeta){var K=(d.xlmeta.Cell||[])[+C.cm-1];K&&K.type=="XLDAPR"&&(S.D=!0)}if(ee){var O=Ot(C.r);c[O.r]||(c[O.r]=[]),c[O.r][O.c]=S}else c[C.r]=S}}}}E.length>0&&(c["!rows"]=E)}}();function wD(e,t,r,n){var i=[],s=[],l=st(e["!ref"]),o="",a,c="",d=[],f=0,h=0,u=e["!rows"],g=Array.isArray(e),m={r:c},p,x=-1;for(h=l.s.c;h<=l.e.c;++h)d[h]=At(h);for(f=l.s.r;f<=l.e.r;++f){for(s=[],c=Bt(f),h=l.s.c;h<=l.e.c;++h){a=d[h]+c;var v=g?(e[f]||[])[h]:e[a];v!==void 0&&(o=vD(v,a,e,t))!=null&&s.push(o)}(s.length>0||u&&u[f])&&(m={r:c},u&&u[f]&&(p=u[f],p.hidden&&(m.hidden=1),x=-1,p.hpx?x=vl(p.hpx):p.hpt&&(x=p.hpt),x>-1&&(m.ht=x,m.customHeight=1),p.level&&(m.outlineLevel=p.level)),i[i.length]=Ee("row",s.join(""),m))}if(u)for(;f<u.length;++f)u&&u[f]&&(m={r:f+1},p=u[f],p.hidden&&(m.hidden=1),x=-1,p.hpx?x=vl(p.hpx):p.hpt&&(x=p.hpt),x>-1&&(m.ht=x,m.customHeight=1),p.level&&(m.outlineLevel=p.level),i[i.length]=Ee("row","",m));return i.join("")}function Fw(e,t,r,n){var i=[Ut,Ee("worksheet",null,{xmlns:js[0],"xmlns:r":Gt.r})],s=r.SheetNames[e],l=0,o="",a=r.Sheets[s];a==null&&(a={});var c=a["!ref"]||"A1",d=st(c);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=Ke(d)}n||(n={}),a["!comments"]=[];var f=[];iD(a,r,e,t,i),i[i.length]=Ee("dimension",null,{ref:c}),i[i.length]=xD(a,t,e,r),t.sheetFormat&&(i[i.length]=Ee("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),a["!cols"]!=null&&a["!cols"].length>0&&(i[i.length]=hD(a,a["!cols"])),i[l=i.length]="<sheetData/>",a["!links"]=[],a["!ref"]!=null&&(o=wD(a,t),o.length>0&&(i[i.length]=o)),i.length>l+1&&(i[i.length]="</sheetData>",i[l]=i[l].replace("/>",">")),a["!protect"]&&(i[i.length]=oD(a["!protect"])),a["!autofilter"]!=null&&(i[i.length]=gD(a["!autofilter"],a,r,e)),a["!merges"]!=null&&a["!merges"].length>0&&(i[i.length]=rD(a["!merges"]));var h=-1,u,g=-1;return a["!links"].length>0&&(i[i.length]="<hyperlinks>",a["!links"].forEach(function(m){m[1].Target&&(u={ref:m[0]},m[1].Target.charAt(0)!="#"&&(g=ut(n,-1,ft(m[1].Target).replace(/#.*$/,""),Ze.HLINK),u["r:id"]="rId"+g),(h=m[1].Target.indexOf("#"))>-1&&(u.location=ft(m[1].Target.slice(h+1))),m[1].Tooltip&&(u.tooltip=ft(m[1].Tooltip)),i[i.length]=Ee("hyperlink",null,u))}),i[i.length]="</hyperlinks>"),delete a["!links"],a["!margins"]!=null&&(i[i.length]=uD(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=or("ignoredErrors",Ee("ignoredError",null,{numberStoredAsText:1,sqref:c}))),f.length>0&&(g=ut(n,-1,"../drawings/drawing"+(e+1)+".xml",Ze.DRAW),i[i.length]=Ee("drawing",null,{"r:id":"rId"+g}),a["!drawing"]=f),a["!comments"].length>0&&(g=ut(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ze.VML),i[i.length]=Ee("legacyDrawing",null,{"r:id":"rId"+g}),a["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function _D(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function bD(e,t,r){var n=me(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=vl(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var l=0;i.level&&(l|=i.level),i.hidden&&(l|=16),(i.hpx||i.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var o=0,a=n.l;n.l+=4;for(var c={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,u=d<<10;u<d+1<<10;++u){c.c=u;var g=Array.isArray(r)?(r[c.r]||[])[c.c]:r[$e(c)];g&&(f<0&&(f=u),h=u)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,h))}var m=n.l;return n.l=a,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function SD(e,t,r,n){var i=bD(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&be(e,0,i)}var kD=Ls,CD=Ga;function TD(){}function ED(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=N4(e),r}function AD(e,t,r){r==null&&(r=me(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return bu({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Ey(e,r),r.slice(0,r.l)}function OD(e){var t=dn(e);return[t]}function ND(e,t,r){return r==null&&(r=me(8)),Rs(t,r)}function FD(e){var t=Is(e);return[t]}function PD(e,t,r){return r==null&&(r=me(4)),Ms(t,r)}function DD(e){var t=dn(e),r=e.read_shift(1);return[t,r,"b"]}function jD(e,t,r){return r==null&&(r=me(9)),Rs(t,r),r.write_shift(1,e.v?1:0),r}function RD(e){var t=Is(e),r=e.read_shift(1);return[t,r,"b"]}function ID(e,t,r){return r==null&&(r=me(5)),Ms(t,r),r.write_shift(1,e.v?1:0),r}function MD(e){var t=dn(e),r=e.read_shift(1);return[t,r,"e"]}function LD(e,t,r){return r==null&&(r=me(9)),Rs(t,r),r.write_shift(1,e.v),r}function BD(e){var t=Is(e),r=e.read_shift(1);return[t,r,"e"]}function UD(e,t,r){return r==null&&(r=me(8)),Ms(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function WD(e){var t=dn(e),r=e.read_shift(4);return[t,r,"s"]}function zD(e,t,r){return r==null&&(r=me(12)),Rs(t,r),r.write_shift(4,t.v),r}function HD(e){var t=Is(e),r=e.read_shift(4);return[t,r,"s"]}function VD(e,t,r){return r==null&&(r=me(8)),Ms(t,r),r.write_shift(4,t.v),r}function $D(e){var t=dn(e),r=vr(e);return[t,r,"n"]}function XD(e,t,r){return r==null&&(r=me(16)),Rs(t,r),As(e.v,r),r}function Pw(e){var t=Is(e),r=vr(e);return[t,r,"n"]}function YD(e,t,r){return r==null&&(r=me(12)),Ms(t,r),As(e.v,r),r}function GD(e){var t=dn(e),r=$0(e);return[t,r,"n"]}function qD(e,t,r){return r==null&&(r=me(12)),Rs(t,r),Ay(e.v,r),r}function KD(e){var t=Is(e),r=$0(e);return[t,r,"n"]}function JD(e,t,r){return r==null&&(r=me(8)),Ms(t,r),Ay(e.v,r),r}function QD(e){var t=dn(e),r=z0(e);return[t,r,"is"]}function ZD(e){var t=dn(e),r=yr(e);return[t,r,"str"]}function e5(e,t,r){return r==null&&(r=me(12+4*e.v.length)),Rs(t,r),er(e.v,r),r.length>r.l?r.slice(0,r.l):r}function t5(e){var t=Is(e),r=yr(e);return[t,r,"str"]}function r5(e,t,r){return r==null&&(r=me(8+4*e.v.length)),Ms(t,r),er(e.v,r),r.length>r.l?r.slice(0,r.l):r}function n5(e,t,r){var n=e.l+t,i=dn(e);i.r=r["!row"];var s=e.read_shift(1),l=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=sf(e,n-e.l,r);l[3]=pr(o,null,i,r.supbooks,r)}else e.l=n;return l}function i5(e,t,r){var n=e.l+t,i=dn(e);i.r=r["!row"];var s=e.read_shift(1),l=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=sf(e,n-e.l,r);l[3]=pr(o,null,i,r.supbooks,r)}else e.l=n;return l}function s5(e,t,r){var n=e.l+t,i=dn(e);i.r=r["!row"];var s=vr(e),l=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=sf(e,n-e.l,r);l[3]=pr(o,null,i,r.supbooks,r)}else e.l=n;return l}function a5(e,t,r){var n=e.l+t,i=dn(e);i.r=r["!row"];var s=yr(e),l=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=sf(e,n-e.l,r);l[3]=pr(o,null,i,r.supbooks,r)}else e.l=n;return l}var o5=Ls,l5=Ga;function c5(e,t){return t==null&&(t=me(4)),t.write_shift(4,e),t}function u5(e,t){var r=e.l+t,n=Ls(e),i=H0(e),s=yr(e),l=yr(e),o=yr(e);e.l=r;var a={rfx:n,relId:i,loc:s,display:o};return l&&(a.Tooltip=l),a}function f5(e,t){var r=me(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ga({s:Ot(e[0]),e:Ot(e[0])},r),V0("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return er(i||"",r),er(e[1].Tooltip||"",r),er("",r),r.slice(0,r.l)}function h5(){}function d5(e,t,r){var n=e.l+t,i=Oy(e),s=e.read_shift(1),l=[i];if(l[2]=s,r.cellFormula){var o=MP(e,n-e.l,r);l[1]=o}else e.l=n;return l}function g5(e,t,r){var n=e.l+t,i=Ls(e),s=[i];if(r.cellFormula){var l=BP(e,n-e.l,r);s[1]=l,e.l=n}else e.l=n;return s}function p5(e,t,r){r==null&&(r=me(18));var n=af(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var Dw=["left","right","top","bottom","header","footer"];function m5(e){var t={};return Dw.forEach(function(r){t[r]=vr(e)}),t}function x5(e,t){return t==null&&(t=me(6*8)),vs(e),Dw.forEach(function(r){As(e[r],t)}),t}function v5(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function y5(e,t,r){r==null&&(r=me(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function w5(e){var t=me(24);return t.write_shift(4,4),t.write_shift(4,1),Ga(e,t),t}function _5(e,t){return t==null&&(t=me(16*4+2)),t.write_shift(2,e.password?J0(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function b5(){}function S5(){}function k5(e,t,r,n,i,s,l){if(!e)return e;var o=t||{};n||(n={"!id":{}});var a=o.dense?[]:{},c,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,u,g,m,p,x,v,y,_,b,S=[];o.biff=12,o["!row"]=0;var C=0,N=!1,F=[],Y={},X=o.supbooks||i.supbooks||[[]];if(X.sharedf=Y,X.arrayf=F,X.SheetNames=i.SheetNames||i.Sheets.map(function(ee){return ee.name}),!o.supbooks&&(o.supbooks=X,i.Names))for(var V=0;V<i.Names.length;++V)X[0][V+1]=i.Names[V];var te=[],G=[],re=!1;yl[16]={n:"BrtShortReal",f:Pw};var Z;if(ui(e,function(E,D,U){if(!h)switch(U){case 148:c=E;break;case 0:u=E,o.sheetRows&&o.sheetRows<=u.r&&(h=!0),_=Bt(p=u.r),o["!row"]=u.r,(E.hidden||E.hpt||E.level!=null)&&(E.hpt&&(E.hpx=Ba(E.hpt)),G[E.r]=E);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:E[2]},E[2]){case"n":g.v=E[1];break;case"s":y=Do[E[1]],g.v=y.t,g.r=y.r;break;case"b":g.v=!!E[1];break;case"e":g.v=E[1],o.cellText!==!1&&(g.w=fi[g.v]);break;case"str":g.t="s",g.v=E[1];break;case"is":g.t="s",g.v=E[1].t;break}if((m=l.CellXf[E[0].iStyleRef])&&Ow(g,m.numFmtId,null,o,s,l),x=E[0].c==-1?x+1:E[0].c,o.dense?(a[p]||(a[p]=[]),a[p][x]=g):a[At(x)+_]=g,o.cellFormula){for(N=!1,C=0;C<F.length;++C){var k=F[C];u.r>=k[0].s.r&&u.r<=k[0].e.r&&x>=k[0].s.c&&x<=k[0].e.c&&(g.F=Ke(k[0]),N=!0)}!N&&E.length>3&&(g.f=E[3])}if(d.s.r>u.r&&(d.s.r=u.r),d.s.c>x&&(d.s.c=x),d.e.r<u.r&&(d.e.r=u.r),d.e.c<x&&(d.e.c=x),o.cellDates&&m&&g.t=="n"&&$a(ze[m.numFmtId])){var P=fs(g.v);P&&(g.t="d",g.v=new Date(P.y,P.m-1,P.d,P.H,P.M,P.S,P.u))}Z&&(Z.type=="XLDAPR"&&(g.D=!0),Z=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;g={t:"z",v:void 0},x=E[0].c==-1?x+1:E[0].c,o.dense?(a[p]||(a[p]=[]),a[p][x]=g):a[At(x)+_]=g,d.s.r>u.r&&(d.s.r=u.r),d.s.c>x&&(d.s.c=x),d.e.r<u.r&&(d.e.r=u.r),d.e.c<x&&(d.e.c=x),Z&&(Z.type=="XLDAPR"&&(g.D=!0),Z=void 0);break;case 176:S.push(E);break;case 49:Z=((o.xlmeta||{}).Cell||[])[E-1];break;case 494:var A=n["!id"][E.relId];for(A?(E.Target=A.Target,E.loc&&(E.Target+="#"+E.loc),E.Rel=A):E.relId==""&&(E.Target="#"+E.loc),p=E.rfx.s.r;p<=E.rfx.e.r;++p)for(x=E.rfx.s.c;x<=E.rfx.e.c;++x)o.dense?(a[p]||(a[p]=[]),a[p][x]||(a[p][x]={t:"z",v:void 0}),a[p][x].l=E):(v=$e({c:x,r:p}),a[v]||(a[v]={t:"z",v:void 0}),a[v].l=E);break;case 426:if(!o.cellFormula)break;F.push(E),b=o.dense?a[p][x]:a[At(x)+_],b.f=pr(E[1],d,{r:u.r,c:x},X,o),b.F=Ke(E[0]);break;case 427:if(!o.cellFormula)break;Y[$e(E[0].s)]=E[1],b=o.dense?a[p][x]:a[At(x)+_],b.f=pr(E[1],d,{r:u.r,c:x},X,o);break;case 60:if(!o.cellStyles)break;for(;E.e>=E.s;)te[E.e--]={width:E.w/256,hidden:!!(E.flags&1),level:E.level},re||(re=!0,Q0(E.w/256)),zi(te[E.e+1]);break;case 161:a["!autofilter"]={ref:Ke(E)};break;case 476:a["!margins"]=E;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),E.name&&(i.Sheets[r].CodeName=E.name),(E.above||E.left)&&(a["!outline"]={above:E.above,left:E.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),E.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!D.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+U.toString(16))}}},o),delete o.supbooks,delete o["!row"],!a["!ref"]&&(d.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(a["!ref"]=Ke(c||d)),o.sheetRows&&a["!ref"]){var oe=st(a["!ref"]);o.sheetRows<=+oe.e.r&&(oe.e.r=o.sheetRows-1,oe.e.r>d.e.r&&(oe.e.r=d.e.r),oe.e.r<oe.s.r&&(oe.s.r=oe.e.r),oe.e.c>d.e.c&&(oe.e.c=d.e.c),oe.e.c<oe.s.c&&(oe.s.c=oe.e.c),a["!fullref"]=a["!ref"],a["!ref"]=Ke(oe))}return S.length>0&&(a["!merges"]=S),te.length>0&&(a["!cols"]=te),G.length>0&&(a["!rows"]=G),a}function C5(e,t,r,n,i,s,l){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=_t(t),t.z=t.z||ze[14],t.v=Kt(wt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var a={r,c:n};switch(a.s=Ki(i.cellXfs,t,i),t.l&&s["!links"].push([$e(a),t.l]),t.c&&s["!comments"].push([$e(a),t.c]),t.t){case"s":case"str":return i.bookSST?(o=ng(i.Strings,t.v,i.revStrings),a.t="s",a.v=o,l?be(e,18,VD(t,a)):be(e,7,zD(t,a))):(a.t="str",l?be(e,17,r5(t,a)):be(e,6,e5(t,a))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?be(e,13,JD(t,a)):be(e,2,qD(t,a)):l?be(e,16,YD(t,a)):be(e,5,XD(t,a)),!0;case"b":return a.t="b",l?be(e,15,ID(t,a)):be(e,4,jD(t,a)),!0;case"e":return a.t="e",l?be(e,14,UD(t,a)):be(e,3,LD(t,a)),!0}return l?be(e,12,PD(t,a)):be(e,1,ND(t,a)),!0}function T5(e,t,r,n){var i=st(t["!ref"]||"A1"),s,l="",o=[];be(e,145);var a=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var d=i.s.r;d<=c;++d){l=Bt(d),SD(e,t,i,d);var f=!1;if(d<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){d===i.s.r&&(o[h]=At(h)),s=o[h]+l;var u=a?(t[d]||[])[h]:t[s];if(!u){f=!1;continue}f=C5(e,u,d,h,n,t,f)}}be(e,146)}function E5(e,t){!t||!t["!merges"]||(be(e,177,c5(t["!merges"].length)),t["!merges"].forEach(function(r){be(e,176,l5(r))}),be(e,178))}function A5(e,t){!t||!t["!cols"]||(be(e,390),t["!cols"].forEach(function(r,n){r&&be(e,60,p5(n,r))}),be(e,391))}function O5(e,t){!t||!t["!ref"]||(be(e,648),be(e,649,w5(st(t["!ref"]))),be(e,650))}function N5(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=ut(r,-1,n[1].Target.replace(/#.*$/,""),Ze.HLINK);be(e,494,f5(n,i))}}),delete t["!links"]}function F5(e,t,r,n){if(t["!comments"].length>0){var i=ut(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ze.VML);be(e,551,V0("rId"+i)),t["!legacy"]=i}}function P5(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:Ke(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=Mr(s);o.s.r==o.e.r&&(o.e.r=Mr(t["!ref"]).e.r,s=Ke(o));for(var a=0;a<l.length;++a){var c=l[a];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}a==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),be(e,161,Ga(st(s))),be(e,162)}}function D5(e,t,r){be(e,133),be(e,137,y5(t,r)),be(e,138),be(e,134)}function j5(e,t){t["!protect"]&&be(e,535,_5(t["!protect"]))}function R5(e,t,r,n){var i=Ir(),s=r.SheetNames[e],l=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var a=st(l["!ref"]||"A1");if(a.e.c>16383||a.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");a.e.c=Math.min(a.e.c,16383),a.e.r=Math.min(a.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],be(i,129),(r.vbaraw||l["!outline"])&&be(i,147,AD(o,l["!outline"])),be(i,148,CD(a)),D5(i,l,r.Workbook),A5(i,l),T5(i,l,e,t),j5(i,l),P5(i,l,r,e),E5(i,l),N5(i,l,n),l["!margins"]&&be(i,476,x5(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&O5(i,l),F5(i,l,e,n),be(i,130),i.end()}function I5(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var i=nt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function M5(e,t,r,n,i,s){var l=s||{"!type":"chart"};if(!e)return s;var o=0,a=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=I5(f);d.s.r=d.s.c=0,d.e.c=o,c=At(o),h[0].forEach(function(u,g){l[c+Bt(g)]={t:"n",v:u,z:h[1]},a=g}),d.e.r<a&&(d.e.r=a),++o}),o>0&&(l["!ref"]=Ke(d)),l}function L5(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,o=e.match(Nw);return o&&ig(o[0],s,i,r),(l=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function B5(e,t){e.l+=10;var r=yr(e);return{name:r}}function U5(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return ui(e,function(a,c,d){switch(d){case 550:s["!rel"]=a;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),a.name&&(i.Sheets[r].CodeName=a.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var sg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],W5=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],z5=[],H5=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Jm(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=vt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function Qm(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=vt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function jw(e){Qm(e.WBProps,sg),Qm(e.CalcPr,H5),Jm(e.WBView,W5),Jm(e.Sheets,z5),Ea.date1904=vt(e.WBProps.date1904)}function V5(e){return!e.Workbook||!e.Workbook.WBProps?"false":vt(e.Workbook.WBProps.date1904)?"true":"false"}var $5="][*?/\\".split("");function Rw(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return $5.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function X5(e,t,r){e.forEach(function(n,i){Rw(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=t&&t[i]&&t[i].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function Y5(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];X5(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)VP(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var G5=/<\w+:workbook/;function q5(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},l=0;if(e.replace(br,function(a,c){var d=Xe(a);switch(Wn(d[0])){case"<?xml":break;case"<workbook":a.match(G5)&&(i="xmlns"+a.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":sg.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=vt(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=dt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=nt(dt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=dt(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),vt(d.hidden||"0")&&(s.Hidden=!0),l=c+a.length;break;case"</definedName>":s.Ref=nt(dt(e.slice(l,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return a}),js.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return jw(r),r}function Iw(e){var t=[Ut];t[t.length]=Ee("workbook",null,{xmlns:js[0],"xmlns:r":Gt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(sg.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ee("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var l={name:ft(e.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Ee("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var a={name:o.Name};o.Comment&&(a.comment=o.Comment),o.Sheet!=null&&(a.localSheetId=""+o.Sheet),o.Hidden&&(a.hidden="1"),o.Ref&&(t[t.length]=Ee("definedName",ft(o.Ref),a))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function K5(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=pd(e),r.name=yr(e),r}function J5(e,t){return t||(t=me(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),V0(e.strRelID,t),er(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Q5(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?yr(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Z5(e,t){t||(t=me(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Ey(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function ej(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function tj(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=F4(e),l=LP(e,0,r),o=H0(e);e.l=n;var a={Name:s,Ptg:l};return i<268435455&&(a.Sheet=i),o&&(a.Comment=o),a}function rj(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],yl[16]={n:"BrtFRTArchID$",f:ej},ui(e,function(a,c,d){switch(d){case 156:l.SheetNames.push(a.name),r.Sheets.push(a);break;case 153:r.WBProps=a;break;case 39:a.Sheet!=null&&(t.SID=a.Sheet),a.Ref=pr(a.Ptg,null,null,l,t),delete t.SID,delete a.Ptg,s.push(a);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([d,a]):l[0]=[d,a],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(a),l.XTI=l.XTI.concat(a);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),jw(r),r.Names=s,r.supbooks=l,r}function nj(e,t){be(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};be(e,156,J5(i))}be(e,144)}function ij(e,t){t||(t=me(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return er("SheetJS",t),er(pu.version,t),er(pu.version,t),er("7262",t),t.length>t.l?t.slice(0,t.l):t}function sj(e,t){t||(t=me(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function aj(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(be(e,135),be(e,158,sj(i)),be(e,136))}}function oj(e,t){var r=Ir();return be(r,131),be(r,128,ij()),be(r,153,Z5(e.Workbook&&e.Workbook.WBProps||null)),aj(r,e),nj(r,e),be(r,132),r.end()}function lj(e,t,r){return t.slice(-4)===".bin"?rj(e,r):q5(e,r)}function cj(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?k5(e,n,r,i,s,l,o):tD(e,n,r,i,s,l,o)}function uj(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?U5(e,n,r,i,s):L5(e,n,r,i,s)}function fj(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?dF():gF()}function hj(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?fF():hF()}function dj(e,t,r,n){return t.slice(-4)===".bin"?l3(e,r,n):KN(e,r,n)}function gj(e,t,r){return mw(e,r)}function pj(e,t,r){return t.slice(-4)===".bin"?pN(e,r):hN(e,r)}function mj(e,t,r){return t.slice(-4)===".bin"?aF(e,r):J3(e,r)}function xj(e,t,r){return t.slice(-4)===".bin"?G3(e):X3(e)}function vj(e,t,r,n){return r.slice(-4)===".bin"?q3(e,t,r,n):void 0}function yj(e,t,r){return t.slice(-4)===".bin"?H3(e,t,r):$3(e,t,r)}function wj(e,t,r){return(t.slice(-4)===".bin"?oj:Iw)(e)}function _j(e,t,r,n,i){return(t.slice(-4)===".bin"?R5:Fw)(e,r,n,i)}function bj(e,t,r){return(t.slice(-4)===".bin"?v3:gw)(e,r)}function Sj(e,t,r){return(t.slice(-4)===".bin"?vN:aw)(e,r)}function kj(e,t,r){return(t.slice(-4)===".bin"?oF:yw)(e)}function Cj(e){return(e.slice(-4)===".bin"?V3:xw)()}var Mw=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Lw=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function pn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(Mw),s,l,o,a;if(i)for(a=0;a!=i.length;++a)s=i[a].match(Lw),(l=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(l+1),n[o]=s[2].slice(1,s[2].length-1));return n}function Tj(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(Mw),i,s,l,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(Lw),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(s+1),r[l]=i[2].slice(1,i[2].length-1));return r}var Ro;function Ej(e,t){var r=Ro[e]||nt(e);return r==="General"?Ts(t):hn(r,t)}function Aj(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=vt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=wt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[nt(t)]=i}function Oj(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||fi[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ul(e.v):e.w=Ts(e.v):e.w=Ej(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Ro[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&$a(n)){var i=fs(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function Nj(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=zN[n.Pattern]||n.Pattern)}e[t.ID]=t}function Fj(e,t,r,n,i,s,l,o,a,c){var d="General",f=n.StyleID,h={};c=c||{};var u=[],g=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&l&&(f=l.StyleID);s[f]!==void 0&&(s[f].nf&&(d=s[f].nf),s[f].Interior&&u.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=vt(e);break;case"String":n.t="s",n.r=pm(nt(e)),n.v=e.indexOf("<")>-1?nt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(wt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=nt(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Py[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=pm(t||e));break}if(Oj(n,d,c),c.cellFormula!==!1)if(n.Formula){var m=nt(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=Ta(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Ta("RC:RC",i):n.ArrayRange&&(n.F=Ta(n.ArrayRange,i),a.push([st(n.F),n.F]))}else for(g=0;g<a.length;++g)i.r>=a[g][0].s.r&&i.r<=a[g][0].e.r&&i.c>=a[g][0].s.c&&i.c<=a[g][0].e.c&&(n.F=a[g][1]);c.cellStyles&&(u.forEach(function(p){!h.patternType&&p.patternType&&(h.patternType=p.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Pj(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function rh(e,t){var r=t||{};Xa();var n=po(M0(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=dt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var l=_t(r);return l.type="string",La.to_workbook(n,l)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ce){i.indexOf("<"+ce)>=0&&(s=!0)}),s)return xR(n,r);Ro={"General Number":"General","General Date":ze[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ze[15],"Short Date":ze[14],"Long Time":ze[19],"Medium Time":ze[18],"Short Time":ze[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ze[2],Standard:ze[4],Percent:ze[10],Scientific:ze[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,a=[],c,d={},f=[],h=r.dense?[]:{},u="",g={},m={},p=pn('<Data ss:Type="String">'),x=0,v=0,y=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}},b={},S={},C="",N=0,F=[],Y={},X={},V=0,te=[],G=[],re={},Z=[],oe,ee=!1,E=[],D=[],U={},k=0,P=0,A={Sheets:[],WBProps:{date1904:!1}},T={};dl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var j="";o=dl.exec(n);)switch(o[3]=(j=o[3]).toLowerCase()){case"data":if(j=="data"){if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&a.push([o[3],!0]);break}if(a[a.length-1][1])break;o[1]==="/"?Fj(n.slice(x,o.index),C,p,a[a.length-1][0]=="comment"?re:g,{c:v,r:y},b,Z[v],m,E,r):(C="",p=pn(o[0]),x=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(G.length>0&&(g.c=G),(!r.sheetRows||r.sheetRows>y)&&g.v!==void 0&&(r.dense?(h[y]||(h[y]=[]),h[y][v]=g):h[At(v)+Bt(y)]=g),g.HRef&&(g.l={Target:nt(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(k=v+(parseInt(g.MergeAcross,10)|0),P=y+(parseInt(g.MergeDown,10)|0),F.push({s:{c:v,r:y},e:{c:k,r:P}})),!r.sheetStubs)g.MergeAcross?v=k+1:++v;else if(g.MergeAcross||g.MergeDown){for(var R=v;R<=k;++R)for(var z=y;z<=P;++z)(R>v||z>y)&&(r.dense?(h[z]||(h[z]=[]),h[z][R]={t:"z"}):h[At(R)+Bt(z)]={t:"z"});v=k+1}else++v;else g=Tj(o[0]),g.Index&&(v=+g.Index-1),v<_.s.c&&(_.s.c=v),v>_.e.c&&(_.e.c=v),o[0].slice(-2)==="/>"&&++v,G=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<_.s.r&&(_.s.r=y),y>_.e.r&&(_.e.r=y),o[0].slice(-2)==="/>"&&(m=pn(o[0]),m.Index&&(y=+m.Index-1)),v=0,++y):(m=pn(o[0]),m.Index&&(y=+m.Index-1),U={},(m.AutoFitHeight=="0"||m.Height)&&(U.hpx=parseInt(m.Height,10),U.hpt=vl(U.hpx),D[y]=U),m.Hidden=="1"&&(U.hidden=!0,D[y]=U));break;case"worksheet":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(u),_.s.r<=_.e.r&&_.s.c<=_.e.c&&(h["!ref"]=Ke(_),r.sheetRows&&r.sheetRows<=_.e.r&&(h["!fullref"]=h["!ref"],_.e.r=r.sheetRows-1,h["!ref"]=Ke(_))),F.length&&(h["!merges"]=F),Z.length>0&&(h["!cols"]=Z),D.length>0&&(h["!rows"]=D),d[u]=h}else _={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=v=0,a.push([o[3],!1]),c=pn(o[0]),u=nt(c.Name),h=r.dense?[]:{},F=[],E=[],D=[],T={name:u,Hidden:0},A.Sheets.push(T);break;case"table":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;a.push([o[3],!1]),Z=[],ee=!1}break;case"style":o[1]==="/"?Nj(b,S,r):S=pn(o[0]);break;case"numberformat":S.nf=nt(pn(o[0]).Format||"General"),Ro[S.nf]&&(S.nf=Ro[S.nf]);for(var I=0;I!=392&&ze[I]!=S.nf;++I);if(I==392){for(I=57;I!=392;++I)if(ze[I]==null){ei(S.nf,I);break}}break;case"column":if(a[a.length-1][0]!=="table")break;if(oe=pn(o[0]),oe.Hidden&&(oe.hidden=!0,delete oe.Hidden),oe.Width&&(oe.wpx=parseInt(oe.Width,10)),!ee&&oe.wpx>10){ee=!0,xr=hw;for(var L=0;L<Z.length;++L)Z[L]&&zi(Z[L])}ee&&zi(oe),Z[oe.Index-1||Z.length]=oe;for(var K=0;K<+oe.Span;++K)Z[Z.length]=_t(oe);break;case"namedrange":if(o[1]==="/")break;A.Names||(A.Names=[]);var O=Xe(o[0]),B={Name:O.Name,Ref:Ta(O.RefersTo.slice(1),{r:0,c:0})};A.Sheets.length>0&&(B.Sheet=A.Sheets.length-1),A.Names.push(B);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?C+=n.slice(N,o.index):N=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;S.Interior=pn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?rA(Y,j,n.slice(V,o.index)):V=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else a.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));Pj(re),G.push(re)}else a.push([o[3],!1]),c=pn(o[0]),re={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var M=pn(o[0]);h["!autofilter"]={ref:Ta(M.Range).replace(/\$/g,"")},a.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&a.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&a.push([o[3],!0]);break;case"null":break;default:if(a.length==0&&o[3]=="document"||a.length==0&&o[3]=="uof")return nx(n,r);var J=!0;switch(a[a.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(o[3]){case"date1904":A.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:J=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(V,o.index)){case"SheetHidden":T.Hidden=1;break;case"SheetVeryHidden":T.Hidden=2;break}else V=o.index+o[0].length;break;case"header":h["!margins"]||vs(h["!margins"]={},"xlml"),isNaN(+Xe(o[0]).Margin)||(h["!margins"].header=+Xe(o[0]).Margin);break;case"footer":h["!margins"]||vs(h["!margins"]={},"xlml"),isNaN(+Xe(o[0]).Margin)||(h["!margins"].footer=+Xe(o[0]).Margin);break;case"pagemargins":var se=Xe(o[0]);h["!margins"]||vs(h["!margins"]={},"xlml"),isNaN(+se.Top)||(h["!margins"].top=+se.Top),isNaN(+se.Left)||(h["!margins"].left=+se.Left),isNaN(+se.Right)||(h["!margins"].right=+se.Right),isNaN(+se.Bottom)||(h["!margins"].bottom=+se.Bottom);break;case"displayrighttoleft":A.Views||(A.Views=[]),A.Views[0]||(A.Views[0]={}),A.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:J=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:J=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:J=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:J=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1;break}if(J||o[3].match(/!\[CDATA/))break;if(!a[a.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+a.join("|");if(a[a.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Aj(X,j,te,n.slice(V,o.index)):(te=o,V=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+a.join("|")}var H={};return!r.bookSheets&&!r.bookProps&&(H.Sheets=d),H.SheetNames=f,H.Workbook=A,H.SSF=_t(ze),H.Props=Y,H.Custprops=X,H}function bd(e,t){switch(og(t=t||{}),t.type||"base64"){case"base64":return rh(Gr(e),t);case"binary":case"buffer":case"file":return rh(e,t);case"array":return rh(Gi(e),t)}}function Dj(e,t){var r=[];return e.Props&&r.push(nA(e.Props,t)),e.Custprops&&r.push(iA(e.Props,e.Custprops)),r.join("")}function jj(){return""}function Rj(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(Ee("NumberFormat",null,{"ss:Format":ft(ze[n.numFmtId])}));var l={"ss:ID":"s"+(21+i)};r.push(Ee("Style",s.join(""),l))}),Ee("Styles",r.join(""))}function Bw(e){return Ee("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+tg(e.Ref,{r:0,c:0})})}function Ij(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(Bw(i)))}return Ee("Names",r.join(""))}function Mj(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],l=0;l<i.length;++l){var o=i[l];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(Bw(o)))}return s.join("")}function Lj(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Ee("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Ee("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Ee("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Ee("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(or("ProtectContents","True")),e["!protect"].objects&&i.push(or("ProtectObjects","True")),e["!protect"].scenarios&&i.push(or("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(or("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(or("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&i.push("<"+l[1]+"/>")})),i.length==0?"":Ee("WorksheetOptions",i.join(""),{xmlns:Wr.x})}function Bj(e){return e.map(function(t){var r=a4(t.t||""),n=Ee("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ee("Comment",n,{"ss:Author":t.a})}).join("")}function Uj(e,t,r,n,i,s,l){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+ft(tg(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var a=Ot(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(a.r==l.r?"":"["+(a.r-l.r)+"]")+"C"+(a.c==l.c?"":"["+(a.c-l.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=ft(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=ft(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],d=0;d!=c.length;++d)c[d].s.c!=l.c||c[d].s.r!=l.r||(c[d].e.c>c[d].s.c&&(o["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(o["ss:MergeDown"]=c[d].e.r-c[d].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=fi[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ze[14]);break;case"s":f="String",h=s4(e.v||"");break}var u=Ki(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+u),o["ss:Index"]=l.c+1;var g=e.v!=null?h:"",m=e.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(e.c||[]).length>0&&(m+=Bj(e.c)),Ee("Cell",m,o)}function Wj(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Ba(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function zj(e,t,r,n){if(!e["!ref"])return"";var i=st(e["!ref"]),s=e["!merges"]||[],l=0,o=[];e["!cols"]&&e["!cols"].forEach(function(p,x){zi(p);var v=!!p.width,y=af(x,p),_={"ss:Index":x+1};v&&(_["ss:Width"]=ml(y.width)),p.hidden&&(_["ss:Hidden"]="1"),o.push(Ee("Column",null,_))});for(var a=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var d=[Wj(c,(e["!rows"]||[])[c])],f=i.s.c;f<=i.e.c;++f){var h=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>f)&&!(s[l].s.r>c)&&!(s[l].e.c<f)&&!(s[l].e.r<c)){(s[l].s.c!=f||s[l].s.r!=c)&&(h=!0);break}if(!h){var u={r:c,c:f},g=$e(u),m=a?(e[c]||[])[f]:e[g];d.push(Uj(m,g,e,t,r,n,u))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function Hj(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],l=s?Mj(s,t,e,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=s?zj(s,t,e,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(Lj(s,t,e,r)),n.join("")}function Vj(e,t){t||(t={}),e.SSF||(e.SSF=_t(ze)),e.SSF&&(Xa(),Qu(e.SSF),t.revssf=ef(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ki(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Dj(e,t)),r.push(jj()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Ee("Worksheet",Hj(n,t,e),{"ss:Name":ft(e.SheetNames[n])}));return r[2]=Rj(e,t),r[3]=Ij(e),Ut+Ee("Workbook",r.join(""),{xmlns:Wr.ss,"xmlns:o":Wr.o,"xmlns:x":Wr.x,"xmlns:ss":Wr.ss,"xmlns:dt":Wr.dt,"xmlns:html":Wr.html})}function $j(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=I4(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=M4(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Xj=[60,1084,2066,2165,2175];function Yj(e,t,r,n,i){var s=n,l=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}l.push(o),r.l+=s;for(var a=qn(r,r.l),c=Sd[a],d=0;c!=null&&Xj.indexOf(a)>-1;)s=qn(r,r.l+2),d=r.l+4,a==2066?d+=4:(a==2165||a==2175)&&(d+=12),o=r.slice(d,r.l+4+s),l.push(o),r.l+=4+s,c=Sd[a=qn(r,r.l)];var f=Zt(l);ar(f,0);var h=0;f.lens=[];for(var u=0;u<l.length;++u)f.lens.push(h),h+=l[u].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,i)}function Nn(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ze[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||fi[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ul(e.v):e.w=Ts(e.v):e.w=hn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&$a(ze[n]||String(n))){var i=fs(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function bc(e,t,r){return{v:e,ixfe:t,t:r}}function Gj(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},l={},o=null,a=[],c="",d={},f,h="",u,g,m,p,x={},v=[],y,_,b=[],S=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},F=function(Le){return Le<8?ps[Le]:Le<64&&S[Le-8]||ps[Le]},Y=function(Le,ot,gt){var Ge=ot.XF.data;if(!(!Ge||!Ge.patternType||!gt||!gt.cellStyles)){ot.s={},ot.s.patternType=Ge.patternType;var Lr;(Lr=pl(F(Ge.icvFore)))&&(ot.s.fgColor={rgb:Lr}),(Lr=pl(F(Ge.icvBack)))&&(ot.s.bgColor={rgb:Lr})}},X=function(Le,ot,gt){if(!(U>1)&&!(gt.sheetRows&&Le.r>=gt.sheetRows)){if(gt.cellStyles&&ot.XF&&ot.XF.data&&Y(Le,ot,gt),delete ot.ixfe,delete ot.XF,f=Le,h=$e(Le),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Le.r<l.s.r&&(l.s.r=Le.r),Le.c<l.s.c&&(l.s.c=Le.c),Le.r+1>l.e.r&&(l.e.r=Le.r+1),Le.c+1>l.e.c&&(l.e.c=Le.c+1),gt.cellFormula&&ot.f){for(var Ge=0;Ge<v.length;++Ge)if(!(v[Ge][0].s.c>Le.c||v[Ge][0].s.r>Le.r)&&!(v[Ge][0].e.c<Le.c||v[Ge][0].e.r<Le.r)){ot.F=Ke(v[Ge][0]),(v[Ge][0].s.c!=Le.c||v[Ge][0].s.r!=Le.r)&&delete ot.f,ot.f&&(ot.f=""+pr(v[Ge][1],l,Le,E,V));break}}gt.dense?(i[Le.r]||(i[Le.r]=[]),i[Le.r][Le.c]=ot):i[h]=ot}},V={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:v,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(V.password=t.password);var te,G=[],re=[],Z=[],oe=[],ee=!1,E=[];E.SheetNames=V.snames,E.sharedf=V.sharedf,E.arrayf=V.arrayf,E.names=[],E.XTI=[];var D=0,U=0,k=0,P=[],A=[],T;V.codepage=1200,_n(1200);for(var j=!1;e.l<e.length-1;){var R=e.l,z=e.read_shift(2);if(z===0&&D===10)break;var I=e.l===e.length?0:e.read_shift(2),L=Sd[z];if(L&&L.f){if(t.bookSheets&&D===133&&z!==133)break;if(D=z,L.r===2||L.r==12){var K=e.read_shift(2);if(I-=2,!V.enc&&K!==z&&((K&255)<<8|K>>8)!==z)throw new Error("rt mismatch: "+K+"!="+z);L.r==12&&(e.l+=10,I-=10)}var O={};if(z===10?O=L.f(e,I,V):O=Yj(z,L,e,I,V),U==0&&[9,521,1033,2057].indexOf(D)===-1)continue;switch(z){case 34:r.opts.Date1904=C.WBProps.date1904=O;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(V.enc||(e.l=0),V.enc=O,!t.password)throw new Error("File is password-protected");if(O.valid==null)throw new Error("Encryption scheme unsupported");if(!O.valid)throw new Error("Password is incorrect");break;case 92:V.lastuser=O;break;case 66:var B=Number(O);switch(B){case 21010:B=1200;break;case 32768:B=1e4;break;case 32769:B=1252;break}_n(V.codepage=B),j=!0;break;case 317:V.rrtabid=O;break;case 25:V.winlocked=O;break;case 439:r.opts.RefreshAll=O;break;case 12:r.opts.CalcCount=O;break;case 16:r.opts.CalcDelta=O;break;case 17:r.opts.CalcIter=O;break;case 13:r.opts.CalcMode=O;break;case 14:r.opts.CalcPrecision=O;break;case 95:r.opts.CalcSaveRecalc=O;break;case 15:V.CalcRefMode=O;break;case 2211:r.opts.FullCalc=O;break;case 129:O.fDialog&&(i["!type"]="dialog"),O.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),O.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:b.push(O);break;case 430:E.push([O]),E[E.length-1].XTI=[];break;case 35:case 547:E[E.length-1].push(O);break;case 24:case 536:T={Name:O.Name,Ref:pr(O.rgce,l,null,E,V)},O.itab>0&&(T.Sheet=O.itab-1),E.names.push(T),E[0]||(E[0]=[],E[0].XTI=[]),E[E.length-1].push(O),O.Name=="_xlnm._FilterDatabase"&&O.itab>0&&O.rgce&&O.rgce[0]&&O.rgce[0][0]&&O.rgce[0][0][0]=="PtgArea3d"&&(A[O.itab-1]={ref:Ke(O.rgce[0][0][1][2])});break;case 22:V.ExternCount=O;break;case 23:E.length==0&&(E[0]=[],E[0].XTI=[]),E[E.length-1].XTI=E[E.length-1].XTI.concat(O),E.XTI=E.XTI.concat(O);break;case 2196:if(V.biff<8)break;T!=null&&(T.Comment=O[1]);break;case 18:i["!protect"]=O;break;case 19:O!==0&&V.WTF&&console.error("Password verifier: "+O);break;case 133:s[O.pos]=O,V.snames.push(O.name);break;case 10:{if(--U)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,i["!ref"]=Ke(l),t.sheetRows&&t.sheetRows<=l.e.r){var M=l.e.r;l.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Ke(l),l.e.r=M}l.e.r++,l.e.c++}G.length>0&&(i["!merges"]=G),re.length>0&&(i["!objects"]=re),Z.length>0&&(i["!cols"]=Z),oe.length>0&&(i["!rows"]=oe),C.Sheets.push(N)}c===""?d=i:n[c]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(V.biff===8&&(V.biff={9:2,521:3,1033:4}[z]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[O.BIFFVer]||8),V.biffguess=O.BIFFVer==0,O.BIFFVer==0&&O.dt==4096&&(V.biff=5,j=!0,_n(V.codepage=28591)),V.biff==8&&O.BIFFVer==0&&O.dt==16&&(V.biff=2),U++)break;if(i=t.dense?[]:{},V.biff<8&&!j&&(j=!0,_n(V.codepage=t.codepage||1252)),V.biff<5||O.BIFFVer==0&&O.dt==4096){c===""&&(c="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var J={pos:e.l-I,name:c};s[J.pos]=J,V.snames.push(c)}else c=(s[R]||{name:""}).name;O.dt==32&&(i["!type"]="chart"),O.dt==64&&(i["!type"]="macro"),G=[],re=[],V.arrayf=v=[],Z=[],oe=[],ee=!1,N={Hidden:(s[R]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[O.r]||[])[O.c]:i[$e({c:O.c,r:O.r})])&&++O.c,y={ixfe:O.ixfe,XF:b[O.ixfe]||{},v:O.val,t:"n"},k>0&&(y.z=P[y.ixfe>>8&63]),Nn(y,t,r.opts.Date1904),X({c:O.c,r:O.r},y,t);break;case 5:case 517:y={ixfe:O.ixfe,XF:b[O.ixfe],v:O.val,t:O.t},k>0&&(y.z=P[y.ixfe>>8&63]),Nn(y,t,r.opts.Date1904),X({c:O.c,r:O.r},y,t);break;case 638:y={ixfe:O.ixfe,XF:b[O.ixfe],v:O.rknum,t:"n"},k>0&&(y.z=P[y.ixfe>>8&63]),Nn(y,t,r.opts.Date1904),X({c:O.c,r:O.r},y,t);break;case 189:for(var se=O.c;se<=O.C;++se){var H=O.rkrec[se-O.c][0];y={ixfe:H,XF:b[H],v:O.rkrec[se-O.c][1],t:"n"},k>0&&(y.z=P[y.ixfe>>8&63]),Nn(y,t,r.opts.Date1904),X({c:se,r:O.r},y,t)}break;case 6:case 518:case 1030:{if(O.val=="String"){o=O;break}if(y=bc(O.val,O.cell.ixfe,O.tt),y.XF=b[y.ixfe],t.cellFormula){var ce=O.formula;if(ce&&ce[0]&&ce[0][0]&&ce[0][0][0]=="PtgExp"){var ue=ce[0][0][1][0],xe=ce[0][0][1][1],_e=$e({r:ue,c:xe});x[_e]?y.f=""+pr(O.formula,l,O.cell,E,V):y.F=((t.dense?(i[ue]||[])[xe]:i[_e])||{}).F}else y.f=""+pr(O.formula,l,O.cell,E,V)}k>0&&(y.z=P[y.ixfe>>8&63]),Nn(y,t,r.opts.Date1904),X(O.cell,y,t),o=O}break;case 7:case 519:if(o)o.val=O,y=bc(O,o.cell.ixfe,"s"),y.XF=b[y.ixfe],t.cellFormula&&(y.f=""+pr(o.formula,l,o.cell,E,V)),k>0&&(y.z=P[y.ixfe>>8&63]),Nn(y,t,r.opts.Date1904),X(o.cell,y,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{v.push(O);var fe=$e(O[0].s);if(u=t.dense?(i[O[0].s.r]||[])[O[0].s.c]:i[fe],t.cellFormula&&u){if(!o||!fe||!u)break;u.f=""+pr(O[1],l,O[0],E,V),u.F=Ke(O[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;x[$e(o.cell)]=O[0],u=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[$e(o.cell)],(u||{}).f=""+pr(O[0],l,f,E,V)}}break;case 253:y=bc(a[O.isst].t,O.ixfe,"s"),a[O.isst].h&&(y.h=a[O.isst].h),y.XF=b[y.ixfe],k>0&&(y.z=P[y.ixfe>>8&63]),Nn(y,t,r.opts.Date1904),X({c:O.c,r:O.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:O.ixfe,XF:b[O.ixfe],t:"z"},k>0&&(y.z=P[y.ixfe>>8&63]),Nn(y,t,r.opts.Date1904),X({c:O.c,r:O.r},y,t));break;case 190:if(t.sheetStubs)for(var ve=O.c;ve<=O.C;++ve){var Ce=O.ixfe[ve-O.c];y={ixfe:Ce,XF:b[Ce],t:"z"},k>0&&(y.z=P[y.ixfe>>8&63]),Nn(y,t,r.opts.Date1904),X({c:ve,r:O.r},y,t)}break;case 214:case 516:case 4:y=bc(O.val,O.ixfe,"s"),y.XF=b[y.ixfe],k>0&&(y.z=P[y.ixfe>>8&63]),Nn(y,t,r.opts.Date1904),X({c:O.c,r:O.r},y,t);break;case 0:case 512:U===1&&(l=O);break;case 252:a=O;break;case 1054:if(V.biff==4){P[k++]=O[1];for(var De=0;De<k+163&&ze[De]!=O[1];++De);De>=163&&ei(O[1],k+163)}else ei(O[1],O[0]);break;case 30:{P[k++]=O;for(var je=0;je<k+163&&ze[je]!=O;++je);je>=163&&ei(O,k+163)}break;case 229:G=G.concat(O);break;case 93:re[O.cmo[0]]=V.lastobj=O;break;case 438:V.lastobj.TxO=O;break;case 127:V.lastobj.ImData=O;break;case 440:for(p=O[0].s.r;p<=O[0].e.r;++p)for(m=O[0].s.c;m<=O[0].e.c;++m)u=t.dense?(i[p]||[])[m]:i[$e({c:m,r:p})],u&&(u.l=O[1]);break;case 2048:for(p=O[0].s.r;p<=O[0].e.r;++p)for(m=O[0].s.c;m<=O[0].e.c;++m)u=t.dense?(i[p]||[])[m]:i[$e({c:m,r:p})],u&&u.l&&(u.l.Tooltip=O[1]);break;case 28:{if(V.biff<=5&&V.biff>=2)break;u=t.dense?(i[O[0].r]||[])[O[0].c]:i[$e(O[0])];var Ie=re[O[2]];u||(t.dense?(i[O[0].r]||(i[O[0].r]=[]),u=i[O[0].r][O[0].c]={t:"z"}):u=i[$e(O[0])]={t:"z"},l.e.r=Math.max(l.e.r,O[0].r),l.s.r=Math.min(l.s.r,O[0].r),l.e.c=Math.max(l.e.c,O[0].c),l.s.c=Math.min(l.s.c,O[0].c)),u.c||(u.c=[]),g={a:O[1],t:Ie.TxO.t},u.c.push(g)}break;case 2173:R3(b[O.ixfe],O.ext);break;case 125:{if(!V.cellStyles)break;for(;O.e>=O.s;)Z[O.e--]={width:O.w/256,level:O.level||0,hidden:!!(O.flags&1)},ee||(ee=!0,Q0(O.w/256)),zi(Z[O.e+1])}break;case 520:{var Ye={};O.level!=null&&(oe[O.r]=Ye,Ye.level=O.level),O.hidden&&(oe[O.r]=Ye,Ye.hidden=!0),O.hpt&&(oe[O.r]=Ye,Ye.hpt=O.hpt,Ye.hpx=Ba(O.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||vs(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[z]]=O;break;case 161:i["!margins"]||vs(i["!margins"]={}),i["!margins"].header=O.header,i["!margins"].footer=O.footer;break;case 574:O.RTL&&(C.Views[0].RTL=!0);break;case 146:S=O;break;case 2198:te=O;break;case 140:_=O;break;case 442:c?N.CodeName=O||N.name:C.WBProps.CodeName=O||"ThisWorkbook";break}}else L||console.error("Missing Info for XLS Record 0x"+z.toString(16)),e.l+=I}return r.SheetNames=It(s).sort(function(et,Le){return Number(et)-Number(Le)}).map(function(et){return s[et].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&A.forEach(function(et,Le){r.Sheets[r.SheetNames[Le]]["!autofilter"]=et}),r.Strings=a,r.SSF=_t(ze),V.enc&&(r.Encryption=V.enc),te&&(r.Themes=te),r.Metadata={},_!==void 0&&(r.Metadata.Country=_),E.names.length>0&&(C.Names=E.names),r.Workbook=C,r}var Io={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function qj(e,t,r){var n=Me.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=Dm(n,md,Io.DSI);for(var s in i)t[s]=i[s]}catch(c){if(r.WTF)throw c}var l=Me.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var o=Dm(l,xd,Io.SI);for(var a in o)t[a]==null&&(t[a]=o[a])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(Ly(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Kj(e,t){var r=[],n=[],i=[],s=0,l,o=cm(md,"n"),a=cm(xd,"n");if(e.Props)for(l=It(e.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(o,l[s])?r:Object.prototype.hasOwnProperty.call(a,l[s])?n:i).push([l[s],e.Props[l[s]]]);if(e.Custprops)for(l=It(e.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(o,l[s])?r:Object.prototype.hasOwnProperty.call(a,l[s])?n:i).push([l[s],e.Custprops[l[s]]]);var c=[];for(s=0;s<i.length;++s)$y.indexOf(i[s][0])>-1||My.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&Me.utils.cfb_add(t,"/SummaryInformation",jm(n,Io.SI,a,xd)),(r.length||c.length)&&Me.utils.cfb_add(t,"/DocumentSummaryInformation",jm(r,Io.DSI,o,md,c.length?c:null,Io.UDI))}function Uw(e,t){t||(t={}),og(t),A0(),t.codepage&&E0(t.codepage);var r,n;if(e.FullPaths){if(Me.find(e,"/encryption"))throw new Error("File is password-protected");r=Me.find(e,"!CompObj"),n=Me.find(e,"/Workbook")||Me.find(e,"/Book")}else{switch(t.type){case"base64":e=Hr(Gr(e));break;case"binary":e=Hr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ar(e,0),n={content:e}}var i,s;if(r&&$j(r),t.bookProps&&!t.bookSheets)i={};else{var l=Qe?"buffer":"array";if(n&&n.content)i=Gj(n.content,t);else if((s=Me.find(e,"PerfectOffice_MAIN"))&&s.content)i=xs.to_workbook(s.content,(t.type=l,t));else if((s=Me.find(e,"NativeContent_MAIN"))&&s.content)i=xs.to_workbook(s.content,(t.type=l,t));else throw(s=Me.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Me.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=cF(e))}var o={};return e.FullPaths&&qj(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}function Jj(e,t){var r=t||{},n=Me.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Me.utils.cfb_add(n,i,Ww(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Kj(e,n),r.biff==8&&e.vbaraw&&uF(n,Me.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var yl={0:{f:_D},1:{f:OD},2:{f:GD},3:{f:MD},4:{f:DD},5:{f:$D},6:{f:ZD},7:{f:WD},8:{f:a5},9:{f:s5},10:{f:n5},11:{f:i5},12:{f:FD},13:{f:KD},14:{f:BD},15:{f:RD},16:{f:Pw},17:{f:t5},18:{f:HD},19:{f:z0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:tj},40:{},42:{},43:{f:ZN},44:{f:JN},45:{f:r3},46:{f:i3},47:{f:n3},48:{},49:{f:k4},50:{},51:{f:L3},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:rw},62:{f:QD},63:{f:Y3},64:{f:b5},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:_r,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:v5},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:ED},148:{f:kD,p:16},151:{f:h5},152:{},153:{f:Q5},154:{},155:{},156:{f:K5},157:{},158:{},159:{T:1,f:gN},160:{T:-1},161:{T:1,f:Ls},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:o5},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:I3},336:{T:-1},337:{f:W3,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:pd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:tw},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:d5},427:{f:g5},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:m5},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:TD},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:u5},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:pd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:iF},633:{T:1},634:{T:-1},635:{T:1,f:rF},636:{T:-1},637:{f:A4},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:B5},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:S5},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Sd={6:{f:eh},10:{f:gi},12:{f:Ht},13:{f:Ht},14:{f:Mt},15:{f:Mt},16:{f:vr},17:{f:Mt},18:{f:Mt},19:{f:Ht},20:{f:Um},21:{f:Um},23:{f:tw},24:{f:zm},25:{f:Mt},26:{},27:{},28:{f:SO},29:{},34:{f:Mt},35:{f:Wm},38:{f:vr},39:{f:vr},40:{f:vr},41:{f:vr},42:{f:Mt},43:{f:Mt},47:{f:RN},49:{f:KA},51:{f:Ht},60:{},61:{f:$A},64:{f:Mt},65:{f:qA},66:{f:Ht},77:{},80:{},81:{},82:{},85:{f:Ht},89:{},90:{},91:{},92:{f:jA},93:{f:TO},94:{},95:{f:Mt},96:{},97:{},99:{f:Mt},125:{f:rw},128:{f:fO},129:{f:IA},130:{f:Ht},131:{f:Mt},132:{f:Mt},133:{f:MA},134:{},140:{f:jO},141:{f:Ht},144:{},146:{f:MO},151:{},152:{},153:{},154:{},155:{},156:{f:Ht},157:{},158:{},160:{f:VO},161:{f:UO},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:oO},190:{f:lO},193:{f:gi},197:{},198:{},199:{},200:{},201:{},202:{f:Mt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ht},220:{},221:{f:Mt},222:{},224:{f:uO},225:{f:DA},226:{f:gi},227:{},229:{f:kO},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:BA},253:{f:QA},255:{f:WA},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Xy},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Mt},353:{f:gi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:mO},431:{f:Mt},432:{},433:{},434:{},437:{},438:{f:OO},439:{f:Mt},440:{f:NO},441:{},442:{f:Rl},443:{},444:{f:Ht},445:{},446:{},448:{f:gi},449:{f:VA,r:2},450:{f:gi},512:{f:Mm},513:{f:HO},515:{f:gO},516:{f:eO},517:{f:Bm},519:{f:$O},520:{f:zA},523:{},545:{f:Hm},549:{f:Im},566:{},574:{f:YA},638:{f:aO},659:{},1048:{},1054:{f:rO},1084:{},1212:{f:wO},2048:{f:PO},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:yc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:gi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:LO,r:12},2173:{f:j3,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Mt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:yO,r:12},2197:{},2198:{f:A3,r:12},2199:{},2200:{},2201:{},2202:{f:_O,r:12},2203:{f:gi},2204:{},2205:{},2206:{},2207:{},2211:{f:HA},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ht},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:WO},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:IO},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Mm},1:{},2:{f:KO},3:{f:GO},4:{f:YO},5:{f:Bm},7:{f:QO},8:{},9:{f:yc},11:{},22:{f:Ht},30:{f:iO},31:{},32:{},33:{f:Hm},36:{},37:{f:Im},50:{f:ZO},62:{},52:{},67:{},68:{f:Ht},69:{},86:{},126:{},127:{f:XO},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:eN},223:{},234:{},354:{},421:{},518:{f:eh},521:{f:yc},536:{f:zm},547:{f:Wm},561:{},579:{},1030:{f:eh},1033:{f:yc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ae(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,l=e.next(4);l.write_shift(2,i),l.write_shift(2,s),s>0&&B0(r)&&e.push(r)}}function Qj(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return Ae(e,t,r,i);var s=t;if(!isNaN(s)){for(var l=r.parts||[],o=0,a=0,c=0;c+(l[o]||8224)<=8224;)c+=l[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,c),e.push(r.slice(a,a+c)),a+=c;a<i;){for(d=e.next(4),d.write_shift(2,60),c=0;c+(l[o]||8224)<=8224;)c+=l[o]||8224,o++;d.write_shift(2,c),e.push(r.slice(a,a+c)),a+=c}}}function Bl(e,t,r){return e||(e=me(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Zj(e,t,r,n){var i=me(9);return Bl(i,e,t),Yy(r,n||"b",i),i}function eR(e,t,r){var n=me(8+2*r.length);return Bl(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function tR(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Kt(wt(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Ae(e,2,JO(r,n,i)):Ae(e,3,qO(r,n,i));return;case"b":case"e":Ae(e,5,Zj(r,n,t.v,t.t));return;case"s":case"str":Ae(e,4,eR(r,n,(t.v||"").slice(0,255)));return}Ae(e,1,Bl(null,r,n))}function rR(e,t,r,n){var i=Array.isArray(t),s=st(t["!ref"]||"A1"),l,o="",a=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=Ke(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Bt(c);for(var d=s.s.c;d<=s.e.c;++d){c===s.s.r&&(a[d]=At(d)),l=a[d]+o;var f=i?(t[c]||[])[d]:t[l];f&&tR(e,f,c,d)}}}function nR(e,t){for(var r=t||{},n=Ir(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ae(n,r.biff==4?1033:r.biff==3?521:9,q0(e,16,r)),rR(n,e.Sheets[e.SheetNames[i]],i,r),Ae(n,10),n.end()}function iR(e,t,r){Ae(e,49,JA({sz:12,name:"Arial"},r))}function sR(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Ae(e,1054,nO(i,t[i],r))})}function aR(e,t){var r=me(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ae(e,2151,r),r=me(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Qy(st(t["!ref"]||"A1"),r),r.write_shift(4,4),Ae(e,2152,r)}function oR(e,t){for(var r=0;r<16;++r)Ae(e,224,Lm({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ae(e,224,Lm(n,0,t))})}function lR(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ae(e,440,FO(n)),n[1].Tooltip&&Ae(e,2048,DO(n))}delete t["!links"]}function cR(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&Ae(e,125,BO(af(i,n),i))})}}function uR(e,t,r,n,i){var s=16+Ki(i.cellXfs,t,i);if(t.v==null&&!t.bf){Ae(e,513,Ns(r,n,s));return}if(t.bf)Ae(e,6,IP(t,r,n,i,s));else switch(t.t){case"d":case"n":var l=t.t=="d"?Kt(wt(t.v)):t.v;Ae(e,515,pO(r,n,l,s));break;case"b":case"e":Ae(e,517,dO(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var o=ng(i.Strings,t.v,i.revStrings);Ae(e,253,ZA(r,n,o,s))}else Ae(e,516,tO(r,n,(t.v||"").slice(0,255),s,i));break;default:Ae(e,513,Ns(r,n,s))}}function fR(e,t,r){var n=Ir(),i=r.SheetNames[e],s=r.Sheets[i]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[e]||{},a=Array.isArray(s),c=t.biff==8,d,f="",h=[],u=st(s["!ref"]||"A1"),g=c?65536:16384;if(u.e.c>255||u.e.r>=g){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");u.e.c=Math.min(u.e.c,255),u.e.r=Math.min(u.e.c,g-1)}Ae(n,2057,q0(r,16,t)),Ae(n,13,rn(1)),Ae(n,12,rn(100)),Ae(n,15,Cr(!0)),Ae(n,17,Cr(!1)),Ae(n,16,As(.001)),Ae(n,95,Cr(!0)),Ae(n,42,Cr(!1)),Ae(n,43,Cr(!1)),Ae(n,130,rn(1)),Ae(n,128,hO()),Ae(n,131,Cr(!1)),Ae(n,132,Cr(!1)),c&&cR(n,s["!cols"]),Ae(n,512,sO(u,t)),c&&(s["!links"]=[]);for(var m=u.s.r;m<=u.e.r;++m){f=Bt(m);for(var p=u.s.c;p<=u.e.c;++p){m===u.s.r&&(h[p]=At(p)),d=h[p]+f;var x=a?(s[m]||[])[p]:s[d];x&&(uR(n,x,m,p,t),c&&x.l&&s["!links"].push([d,x.l]))}}var v=o.CodeName||o.name||i;return c&&Ae(n,574,GA((l.Views||[])[0])),c&&(s["!merges"]||[]).length&&Ae(n,229,CO(s["!merges"])),c&&lR(n,s),Ae(n,442,Gy(v)),c&&aR(n,s),Ae(n,10),n.end()}function hR(e,t,r){var n=Ir(),i=(e||{}).Workbook||{},s=i.Sheets||[],l=i.WBProps||{},o=r.biff==8,a=r.biff==5;if(Ae(n,2057,q0(e,5,r)),r.bookType=="xla"&&Ae(n,135),Ae(n,225,o?rn(1200):null),Ae(n,193,dA(2)),a&&Ae(n,191),a&&Ae(n,192),Ae(n,226),Ae(n,92,RA("SheetJS",r)),Ae(n,66,rn(o?1200:1252)),o&&Ae(n,353,rn(0)),o&&Ae(n,448),Ae(n,317,zO(e.SheetNames.length)),o&&e.vbaraw&&Ae(n,211),o&&e.vbaraw){var c=l.CodeName||"ThisWorkbook";Ae(n,442,Gy(c))}Ae(n,156,rn(17)),Ae(n,25,Cr(!1)),Ae(n,18,Cr(!1)),Ae(n,19,rn(0)),o&&Ae(n,431,Cr(!1)),o&&Ae(n,444,rn(0)),Ae(n,61,XA()),Ae(n,64,Cr(!1)),Ae(n,141,rn(0)),Ae(n,34,Cr(V5(e)=="true")),Ae(n,14,Cr(!0)),o&&Ae(n,439,Cr(!1)),Ae(n,218,rn(0)),iR(n,e,r),sR(n,e.SSF,r),oR(n,r),o&&Ae(n,352,Cr(!1));var d=n.end(),f=Ir();o&&Ae(f,140,RO()),o&&r.Strings&&Qj(f,252,UA(r.Strings)),Ae(f,10);var h=f.end(),u=Ir(),g=0,m=0;for(m=0;m<e.SheetNames.length;++m)g+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var p=d.length+g+h.length;for(m=0;m<e.SheetNames.length;++m){var x=s[m]||{};Ae(u,133,LA({pos:p,hs:x.Hidden||0,dt:0,name:e.SheetNames[m]},r)),p+=t[m].length}var v=u.end();if(g!=v.length)throw new Error("BS8 "+g+" != "+v.length);var y=[];return d.length&&y.push(d),v.length&&y.push(v),h.length&&y.push(h),Zt(y)}function dR(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=_t(ze)),e&&e.SSF&&(Xa(),Qu(e.SSF),r.revssf=ef(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,lg(r),r.cellXfs=[],Ki(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=fR(i,r,e);return n.unshift(hR(e,n,r)),Zt(n)}function Ww(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Mr(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return dR(e,t);case 4:case 3:case 2:return nR(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Zm(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),l=i.index,o=s&&s.index||e.length,a=JE(e.slice(l,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,f=0,h=0,u={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(l=0;l<a.length;++l){var m=a[l].trim(),p=m.slice(0,3).toLowerCase();if(p=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}d=0;continue}if(!(p!="<td"&&p!="<th")){var x=m.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var v=x[o].trim();if(v.match(/<t[dh]/i)){for(var y=v,_=0;y.charAt(0)=="<"&&(_=y.indexOf(">"))>-1;)y=y.slice(_+1);for(var b=0;b<g.length;++b){var S=g[b];S.s.c==d&&S.s.r<c&&c<=S.e.r&&(d=S.e.c+1,b=-1)}var C=Xe(v.slice(0,v.indexOf(">")));h=C.colspan?+C.colspan:1,((f=+C.rowspan)>1||h>1)&&g.push({s:{r:c,c:d},e:{r:c+(f||1)-1,c:d+h-1}});var N=C.t||C["data-t"]||"";if(!y.length){d+=h;continue}if(y=fy(y),u.s.r>c&&(u.s.r=c),u.e.r<c&&(u.e.r=c),u.s.c>d&&(u.s.c=d),u.e.c<d&&(u.e.c=d),!y.length){d+=h;continue}var F={t:"s",v:y};r.raw||!y.trim().length||N=="s"||(y==="TRUE"?F={t:"b",v:!0}:y==="FALSE"?F={t:"b",v:!1}:isNaN(Cn(y))?isNaN(Ma(y).getDate())||(F={t:"d",v:wt(y)},r.cellDates||(F={t:"n",v:Kt(F.v)}),F.z=r.dateNF||ze[14]):F={t:"n",v:Cn(y)}),r.dense?(n[c]||(n[c]=[]),n[c][d]=F):n[$e({r:c,c:d})]=F,d+=h}}}}return n["!ref"]=Ke(u),g.length&&(n["!merges"]=g),n}function gR(e,t,r,n){for(var i=e["!merges"]||[],s=[],l=t.s.c;l<=t.e.c;++l){for(var o=0,a=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>l)&&!(i[c].e.r<r||i[c].e.c<l)){if(i[c].s.r<r||i[c].s.c<l){o=-1;break}o=i[c].e.r-i[c].s.r+1,a=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var d=$e({r,c:l}),f=n.dense?(e[r]||[])[l]:e[d],h=f&&f.v!=null&&(f.h||I0(f.w||(ai(f),f.w)||""))||"",u={};o>1&&(u.rowspan=o),a>1&&(u.colspan=a),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(u["data-t"]=f&&f.t||"z",f.v!=null&&(u["data-v"]=f.v),f.z!=null&&(u["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),u.id=(n.id||"sjs")+"-"+d,s.push(Ee("td",h,u))}}var g="<tr>";return g+s.join("")+"</tr>"}var pR='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',mR="</body></html>";function xR(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return qi(Zm(r[0],t),t);var n=fg();return r.forEach(function(i,s){hg(n,Zm(i,t),"Sheet"+(s+1))}),n}function vR(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function zw(e,t){var r=t||{},n=r.header!=null?r.header:pR,i=r.footer!=null?r.footer:mR,s=[n],l=Mr(e["!ref"]);r.dense=Array.isArray(e),s.push(vR(e,l,r));for(var o=l.s.r;o<=l.e.r;++o)s.push(gR(e,l,o,r));return s.push("</table>"+i),s.join("")}function Hw(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Ot(n.origin):n.origin;i=l.r,s=l.c}var o=t.getElementsByTagName("tr"),a=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var d=Mr(e["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),i==-1&&(c.e.r=i=d.e.r+1)}var f=[],h=0,u=e["!rows"]||(e["!rows"]=[]),g=0,m=0,p=0,x=0,v=0,y=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&m<a;++g){var _=o[g];if(ex(_)){if(n.display)continue;u[m]={hidden:!0}}var b=_.children;for(p=x=0;p<b.length;++p){var S=b[p];if(!(n.display&&ex(S))){var C=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):fy(S.innerHTML),N=S.getAttribute("data-z")||S.getAttribute("z");for(h=0;h<f.length;++h){var F=f[h];F.s.c==x+s&&F.s.r<m+i&&m+i<=F.e.r&&(x=F.e.c+1-s,h=-1)}y=+S.getAttribute("colspan")||1,((v=+S.getAttribute("rowspan")||1)>1||y>1)&&f.push({s:{r:m+i,c:x+s},e:{r:m+i+(v||1)-1,c:x+s+(y||1)-1}});var Y={t:"s",v:C},X=S.getAttribute("data-t")||S.getAttribute("t")||"";C!=null&&(C.length==0?Y.t=X||"z":n.raw||C.trim().length==0||X=="s"||(C==="TRUE"?Y={t:"b",v:!0}:C==="FALSE"?Y={t:"b",v:!1}:isNaN(Cn(C))?isNaN(Ma(C).getDate())||(Y={t:"d",v:wt(C)},n.cellDates||(Y={t:"n",v:Kt(Y.v)}),Y.z=n.dateNF||ze[14]):Y={t:"n",v:Cn(C)})),Y.z===void 0&&N!=null&&(Y.z=N);var V="",te=S.getElementsByTagName("A");if(te&&te.length)for(var G=0;G<te.length&&!(te[G].hasAttribute("href")&&(V=te[G].getAttribute("href"),V.charAt(0)!="#"));++G);V&&V.charAt(0)!="#"&&(Y.l={Target:V}),n.dense?(e[m+i]||(e[m+i]=[]),e[m+i][x+s]=Y):e[$e({c:x+s,r:m+i})]=Y,c.e.c<x+s&&(c.e.c=x+s),x+=y}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,m-1+i),e["!ref"]=Ke(c),m>=a&&(e["!fullref"]=Ke((c.e.r=o.length-g+m-1+i,c))),e}function Vw(e,t){var r=t||{},n=r.dense?[]:{};return Hw(n,e,t)}function yR(e,t){return qi(Vw(e,t),t)}function ex(e){var t="",r=wR(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function wR(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function _R(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=nt(t.replace(/<[^>]*>/g,""));return[r]}var tx={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function $w(e,t){var r=t||{},n=M0(e),i=[],s,l,o={name:""},a="",c=0,d,f,h={},u=[],g=r.dense?[]:{},m,p,x={value:""},v="",y=0,_=[],b=-1,S=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,F={},Y=[],X={},V=0,te=0,G=[],re=1,Z=1,oe=[],ee={Names:[]},E={},D=["",""],U=[],k={},P="",A=0,T=!1,j=!1,R=0;for(dl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=dl.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?g["!ref"]=Ke(C):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=C.e.r&&(g["!fullref"]=g["!ref"],C.e.r=r.sheetRows-1,g["!ref"]=Ke(C)),Y.length&&(g["!merges"]=Y),G.length&&(g["!rows"]=G),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),u.push(d.name),h[d.name]=g,j=!1):m[0].charAt(m[0].length-2)!=="/"&&(d=Xe(m[0],!1),b=S=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,g=r.dense?[]:{},Y=[],G=[],j=!0);break;case"table-row-group":m[1]==="/"?--N:++N;break;case"table-row":case"":if(m[1]==="/"){b+=re,re=1;break}if(f=Xe(m[0],!1),f.?b=f.-1:b==-1&&(b=0),re=+f["number-rows-repeated"]||1,re<10)for(R=0;R<re;++R)N>0&&(G[b+R]={level:N});S=-1;break;case"covered-table-cell":m[1]!=="/"&&++S,r.sheetStubs&&(r.dense?(g[b]||(g[b]=[]),g[b][S]={t:"z"}):g[$e({r:b,c:S})]={t:"z"}),v="",_=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++S,x=Xe(m[0],!1),Z=parseInt(x["number-columns-repeated"]||"1",10),p={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(p.f=Km(nt(x.formula))),(x.||x["value-type"])=="string"&&(p.t="s",p.v=nt(x["string-value"]||""),r.dense?(g[b]||(g[b]=[]),g[b][S]=p):g[$e({r:b,c:S})]=p),S+=Z-1;else if(m[1]!=="/"){++S,v="",y=0,_=[],Z=1;var z=re?b+re-1:b;if(S>C.e.c&&(C.e.c=S),S<C.s.c&&(C.s.c=S),b<C.s.r&&(C.s.r=b),z>C.e.r&&(C.e.r=z),x=Xe(m[0],!1),U=[],k={},p={t:x.||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=nt(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(V=parseInt(x["number-matrix-rows-spanned"],10)||0,te=parseInt(x["number-matrix-columns-spanned"],10)||0,X={s:{r:b,c:S},e:{r:b+V-1,c:S+te-1}},p.F=Ke(X),oe.push([X,p.F])),x.formula)p.f=Km(x.formula);else for(R=0;R<oe.length;++R)b>=oe[R][0].s.r&&b<=oe[R][0].e.r&&S>=oe[R][0].s.c&&S<=oe[R][0].e.c&&(p.F=oe[R][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(V=parseInt(x["number-rows-spanned"],10)||0,te=parseInt(x["number-columns-spanned"],10)||0,X={s:{r:b,c:S},e:{r:b+V-1,c:S+te-1}},Y.push(X)),x["number-columns-repeated"]&&(Z=parseInt(x["number-columns-repeated"],10)),p.t){case"boolean":p.t="b",p.v=vt(x["boolean-value"]);break;case"float":p.t="n",p.v=parseFloat(x.value);break;case"percentage":p.t="n",p.v=parseFloat(x.value);break;case"currency":p.t="n",p.v=parseFloat(x.value);break;case"date":p.t="d",p.v=wt(x["date-value"]),r.cellDates||(p.t="n",p.v=Kt(p.v)),p.z="m/d/yy";break;case"time":p.t="n",p.v=GE(x["time-value"])/86400,r.cellDates&&(p.t="d",p.v=tf(p.v)),p.z="HH:MM:SS";break;case"number":p.t="n",p.v=parseFloat(x.);break;default:if(p.t==="string"||p.t==="text"||!p.t)p.t="s",x["string-value"]!=null&&(v=nt(x["string-value"]),_=[]);else throw new Error("Unsupported value type "+p.t)}}else{if(T=!1,p.t==="s"&&(p.v=v||"",_.length&&(p.R=_),T=y==0),E.Target&&(p.l=E),U.length>0&&(p.c=U,U=[]),v&&r.cellText!==!1&&(p.w=v),T&&(p.t="z",delete p.v),(!T||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=b))for(var I=0;I<re;++I){if(Z=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(g[b+I]||(g[b+I]=[]),g[b+I][S]=I==0?p:_t(p);--Z>0;)g[b+I][S+Z]=_t(p);else for(g[$e({r:b+I,c:S})]=p;--Z>0;)g[$e({r:b+I,c:S+Z})]=_t(p);C.e.c<=S&&(C.e.c=S)}Z=parseInt(x["number-columns-repeated"]||"1",10),S+=Z-1,Z=0,p={},v="",_=[]}E={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s;k.t=v,_.length&&(k.R=_),k.a=P,U.push(k)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);P="",A=0,v="",y=0,_=[];break;case"creator":m[1]==="/"?P=n.slice(A,m.index):A=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);v="",y=0,_=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(F[o.name]=a,(s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(a="",o=Xe(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":l=Xe(m[0],!1),a+=tx[m[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":l=Xe(m[0],!1),a+=tx[m[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":a+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":l=Xe(m[0],!1),D=th(l["cell-range-address"]);var L={Name:l.name,Ref:D[0]+"!"+D[1]};j&&(L.Sheet=u.length),ee.Names.push(L);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!x||!x["string-value"])){var K=_R(n.slice(y,m.index));v=(v.length>0?v+`
`:"")+K[0]}else Xe(m[0],!1),y=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{D=th(Xe(m[0])["target-range-address"]),h[D[0]]["!autofilter"]={ref:D[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(E=Xe(m[0],!1),!E.href)break;E.Target=nt(E.href),delete E.href,E.Target.charAt(0)=="#"&&E.Target.indexOf(".")>-1?(D=th(E.Target.slice(1)),E.Target="#"+D[0]+"!"+D[1]):E.Target.match(/^\.\.[\\\/]/)&&(E.Target=E.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var O={Sheets:h,SheetNames:u,Workbook:ee};return r.bookSheets&&delete O.Sheets,O}function rx(e,t){t=t||{},tn(e,"META-INF/manifest.xml")&&G4(zt(e,"META-INF/manifest.xml"),t);var r=Vr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=$w(dt(r),t);return tn(e,"meta.xml")&&(n.Props=Ry(zt(e,"meta.xml"))),n}function nx(e,t){return $w(e,t)}var bR=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+hl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Ut+t}}(),ix=function(){var e=function(s){return ft(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,l,o){var a=[];a.push('      <table:table table:name="'+ft(l.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,d=0,f=Mr(s["!ref"]||"A1"),h=s["!merges"]||[],u=0,g=Array.isArray(s);if(s["!cols"])for(d=0;d<=f.e.c;++d)a.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var m="",p=s["!rows"]||[];for(c=0;c<f.s.r;++c)m=p[c]?' table:style-name="ro'+p[c].ods+'"':"",a.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=f.e.r;++c){for(m=p[c]?' table:style-name="ro'+p[c].ods+'"':"",a.push("        <table:table-row"+m+`>
`),d=0;d<f.s.c;++d)a.push(t);for(;d<=f.e.c;++d){var x=!1,v={},y="";for(u=0;u!=h.length;++u)if(!(h[u].s.c>d)&&!(h[u].s.r>c)&&!(h[u].e.c<d)&&!(h[u].e.r<c)){(h[u].s.c!=d||h[u].s.r!=c)&&(x=!0),v["table:number-columns-spanned"]=h[u].e.c-h[u].s.c+1,v["table:number-rows-spanned"]=h[u].e.r-h[u].s.r+1;break}if(x){a.push(r);continue}var _=$e({r:c,c:d}),b=g?(s[c]||[])[d]:s[_];if(b&&b.f&&(v["table:formula"]=ft(zP(b.f)),b.F&&b.F.slice(0,_.length)==_)){var S=Mr(b.F);v["table:number-matrix-columns-spanned"]=S.e.c-S.s.c+1,v["table:number-matrix-rows-spanned"]=S.e.r-S.s.r+1}if(!b){a.push(t);continue}switch(b.t){case"b":y=b.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=b.v?"true":"false";break;case"n":y=b.w||String(b.v||0),v["office:value-type"]="float",v["office:value"]=b.v||0;break;case"s":case"str":y=b.v==null?"":b.v,v["office:value-type"]="string";break;case"d":y=b.w||wt(b.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=wt(b.v).toISOString(),v["table:style-name"]="ce1";break;default:a.push(t);continue}var C=e(y);if(b.l&&b.l.Target){var N=b.l.Target;N=N.charAt(0)=="#"?"#"+HP(N.slice(1)):N,N.charAt(0)!="#"&&!N.match(/^\w+:/)&&(N="../"+N),C=Ee("text:a",C,{"xlink:href":N.replace(/&/g,"&amp;")})}a.push("          "+Ee("table:table-cell",Ee("text:p",C,{}),v)+`
`)}a.push(`        </table:table-row>
`)}return a.push(`      </table:table>
`),a.join("")},i=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(c){return l.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var d=0;d<c["!cols"].length;++d)if(c["!cols"][d]){var f=c["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;zi(f),f.ods=o;var h=c["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++o}}});var a=0;l.SheetNames.map(function(c){return l.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var d=0;d<c["!rows"].length;++d)if(c["!rows"][d]){c["!rows"][d].ods=a;var f=c["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+a+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++a}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,o){var a=[Ut],c=hl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=hl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(a.push("<office:document"+c+d+`>
`),a.push(jy().replace(/office:document-meta/g,"office:meta"))):a.push("<office:document-content"+c+`>
`),i(a,l),a.push(`  <office:body>
`),a.push(`    <office:spreadsheet>
`);for(var f=0;f!=l.SheetNames.length;++f)a.push(n(l.Sheets[l.SheetNames[f]],l,f));return a.push(`    </office:spreadsheet>
`),a.push(`  </office:body>
`),o.bookType=="fods"?a.push("</office:document>"):a.push("</office:document-content>"),a.join("")}}();function Xw(e,t){if(t.bookType=="fods")return ix(e,t);var r=D0(),n="",i=[],s=[];return n="mimetype",Je(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Je(r,n,ix(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Je(r,n,bR(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Je(r,n,Ut+jy()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Je(r,n,J4(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Je(r,n,q4(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Fs(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function kd(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):dt(Gi(e))}function SR(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Hr(Mn(e))}function kR(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Vi(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function sx(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function CR(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function TR(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function wl(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function lt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Rt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function at(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=wl(e,r),s=i&7;i=Math.floor(i/8);var l=0,o;if(i==0)break;switch(s){case 0:{for(var a=r[0];e[r[0]++]>=128;);o=e.slice(a,r[0])}break;case 5:l=4,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=wl(e,r),o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function ir(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(lt(n*8+i.type)),i.type==2&&t.push(lt(i.data.length)),t.push(i.data))})}),Vi(t)}function ag(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Zr(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=wl(e,n),s=at(e.slice(n[0],n[0]+i));n[0]+=i;var l={id:Rt(s[1][0].data),messages:[]};s[2].forEach(function(o){var a=at(o.data),c=Rt(a[3][0].data);l.messages.push({meta:a,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(l.merge=Rt(s[3][0].data)>>>0>0),r.push(l)}return r}function Gs(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:lt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:lt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(l){i.push(l.data),l.meta[3]=[{type:0,data:lt(l.data.length)}],n[2].push({data:ir(l.meta),type:2})});var s=ir(n);t.push(lt(s.length)),t.push(s),i.forEach(function(l){return t.push(l)})}),Vi(t)}function ER(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=wl(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=t[r[0]],o>1&&(l|=t[r[0]+1]<<8),o>2&&(l|=t[r[0]+2]<<16),o>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}i.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var a=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,a=(t[r[0]++]&224)<<3,a|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(a=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(a=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Vi(i)],a==0)throw new Error("Invalid offset 0");if(a>i[0].length)throw new Error("Invalid offset beyond length");if(c>=a)for(i.push(i[0].slice(-a)),c-=a;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-a,-a+c))}}var d=Vi(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function en(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(ER(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Vi(t)}function qs(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=lt(n),l=s.length;t.push(s),n<=60?(l++,t.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),l+=n,i[0]=0,i[1]=l&255,i[2]=l>>8&255,i[3]=l>>16&255,r+=n}return Vi(t)}function AR(e,t,r,n){var i=Fs(e),s=i.getUint32(4,!0),l=(n>1?12:8)+sx(s&(n>1?3470:398))*4,o=-1,a=-1,c=NaN,d=new Date(2001,0,1);s&512&&(o=i.getUint32(l,!0),l+=4),l+=sx(s&(n>1?12288:4096))*4,s&16&&(a=i.getUint32(l,!0),l+=4),s&32&&(c=i.getFloat64(l,!0),l+=8),s&64&&(d.setTime(d.getTime()+i.getFloat64(l,!0)*1e3),l+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[a]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(a>-1)f={t:"s",v:t[a]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function OR(e,t,r){var n=Fs(e),i=n.getUint32(8,!0),s=12,l=-1,o=-1,a=NaN,c=NaN,d=new Date(2001,0,1);i&1&&(a=CR(e,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(l=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:a};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:a};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return f}function nh(e,t){var r=new Uint8Array(32),n=Fs(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,TR(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function ih(e,t){var r=new Uint8Array(32),n=Fs(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function NR(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return AR(e,t,r,e[0]);case 5:return OR(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function gr(e){var t=at(e);return wl(t[1][0].data)}function ax(e,t){var r=at(t.data),n=Rt(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(l){var o=at(l.data),a=Rt(o[1][0].data)>>>0;switch(n){case 1:s[a]=kd(o[3][0].data);break;case 8:{var c=e[gr(o[9][0].data)][0],d=at(c.data),f=e[gr(d[1][0].data)][0],h=Rt(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var u=at(f.data);s[a]=u[3].map(function(g){return kd(g.data)}).join("")}break}}),s}function FR(e,t){var r,n,i,s,l,o,a,c,d,f,h,u,g,m,p=at(e),x=Rt(p[1][0].data)>>>0,v=Rt(p[2][0].data)>>>0,y=((n=(r=p[8])==null?void 0:r[0])==null?void 0:n.data)&&Rt(p[8][0].data)>0||!1,_,b;if((s=(i=p[7])==null?void 0:i[0])!=null&&s.data&&t!=0)_=(o=(l=p[7])==null?void 0:l[0])==null?void 0:o.data,b=(c=(a=p[6])==null?void 0:a[0])==null?void 0:c.data;else if((f=(d=p[4])==null?void 0:d[0])!=null&&f.data&&t!=1)_=(u=(h=p[4])==null?void 0:h[0])==null?void 0:u.data,b=(m=(g=p[3])==null?void 0:g[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var S=y?4:1,C=Fs(_),N=[],F=0;F<_.length/2;++F){var Y=C.getUint16(F*2,!0);Y<65535&&N.push([F,Y])}if(N.length!=v)throw"Expected ".concat(v," cells, found ").concat(N.length);var X=[];for(F=0;F<N.length-1;++F)X[N[F][0]]=b.subarray(N[F][1]*S,N[F+1][1]*S);return N.length>=1&&(X[N[N.length-1][0]]=b.subarray(N[N.length-1][1]*S)),{R:x,cells:X}}function PR(e,t){var r,n=at(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Rt(n[7][0].data)>>>0>0?1:0:-1,s=ag(n[5],function(l){return FR(l,i)});return{nrows:Rt(n[4][0].data)>>>0,data:s.reduce(function(l,o){return l[o.R]||(l[o.R]=[]),o.cells.forEach(function(a,c){if(l[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));l[o.R][c]=a}),l},[])}}function DR(e,t,r){var n,i=at(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Rt(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Rt(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Ke(s);var l=at(i[4][0].data),o=ax(e,e[gr(l[4][0].data)][0]),a=(n=l[17])!=null&&n[0]?ax(e,e[gr(l[17][0].data)][0]):[],c=at(l[3][0].data),d=0;c[1].forEach(function(f){var h=at(f.data),u=e[gr(h[2][0].data)][0],g=Rt(u.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var m=PR(e,u);m.data.forEach(function(p,x){p.forEach(function(v,y){var _=$e({r:d+x,c:y}),b=NR(v,o,a);b&&(r[_]=b)})}),d+=m.nrows})}function jR(e,t){var r=at(t.data),n={"!ref":"A1"},i=e[gr(r[2][0].data)],s=Rt(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return DR(e,i[0],n),n}function RR(e,t){var r,n=at(t.data),i={name:(r=n[1])!=null&&r[0]?kd(n[1][0].data):"",sheets:[]},s=ag(n[2],gr);return s.forEach(function(l){e[l].forEach(function(o){var a=Rt(o.meta[1][0].data);a==6e3&&i.sheets.push(jR(e,o))})}),i}function IR(e,t){var r=fg(),n=at(t.data),i=ag(n[1],gr);if(i.forEach(function(s){e[s].forEach(function(l){var o=Rt(l.meta[1][0].data);if(o==2){var a=RR(e,l);a.sheets.forEach(function(c,d){hg(r,c,d==0?a.name:a.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function sh(e){var t,r,n,i,s={},l=[];if(e.FullPaths.forEach(function(a){if(a.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(a){if(a.name.match(/\.iwa$/)){var c;try{c=en(a.content)}catch(f){return console.log("?? "+a.content.length+" "+(f.message||f))}var d;try{d=Zr(c)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){s[f.id]=f.messages,l.push(f.id)})}}),!l.length)throw new Error("File has no messages");var o=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Rt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||l.forEach(function(a){s[a].forEach(function(c){var d=Rt(c.meta[1][0].data)>>>0;if(d==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return IR(s,o)}function MR(e,t,r){var n,i,s,l;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(s=e[8])==null?void 0:s[0])==null?void 0:l.data)&&Rt(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var a=0,c=Fs(e[7][0].data),d=0,f=[],h=Fs(e[4][0].data),u=0,g=[],m=0;m<t.length;++m){if(t[m]==null){c.setUint16(m*2,65535,!0),h.setUint16(m*2,65535);continue}c.setUint16(m*2,d,!0),h.setUint16(m*2,u,!0);var p,x;switch(typeof t[m]){case"string":p=nh({t:"s",v:t[m]},r),x=ih({t:"s",v:t[m]},r);break;case"number":p=nh({t:"n",v:t[m]},r),x=ih({t:"n",v:t[m]},r);break;case"boolean":p=nh({t:"b",v:t[m]},r),x=ih({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}f.push(p),d+=p.length,g.push(x),u+=x.length,++a}for(e[2][0].data=lt(a);m<e[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),h.setUint16(m*2,65535,!0);return e[6][0].data=Vi(f),e[3][0].data=Vi(g),a}function LR(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Mr(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Ke(n)));var s=Eu(r,{range:n,header:1}),l=["~Sh33tJ5~"];s.forEach(function(P){return P.forEach(function(A){typeof A=="string"&&l.push(A)})});var o={},a=[],c=Me.read(t.numbers,{type:"base64"});c.FileIndex.map(function(P,A){return[P,c.FullPaths[A]]}).forEach(function(P){var A=P[0],T=P[1];if(A.type==2&&A.name.match(/\.iwa/)){var j=A.content,R=en(j),z=Zr(R);z.forEach(function(I){a.push(I.id),o[I.id]={deps:[],location:T,type:Rt(I.messages[0].meta[1][0].data)}})}}),a.sort(function(P,A){return P-A});var d=a.filter(function(P){return P>1}).map(function(P){return[P,lt(P)]});c.FileIndex.map(function(P,A){return[P,c.FullPaths[A]]}).forEach(function(P){var A=P[0];if(P[1],!!A.name.match(/\.iwa/)){var T=Zr(en(A.content));T.forEach(function(j){j.messages.forEach(function(R){d.forEach(function(z){j.messages.some(function(I){return Rt(I.meta[1][0].data)!=11006&&kR(I.data,z[1])})&&o[z[0]].deps.push(j.id)})})})}});for(var f=Me.find(c,o[1].location),h=Zr(en(f.content)),u,g=0;g<h.length;++g){var m=h[g];m.id==1&&(u=m)}var p=gr(at(u.messages[0].data)[1][0].data);for(f=Me.find(c,o[p].location),h=Zr(en(f.content)),g=0;g<h.length;++g)m=h[g],m.id==p&&(u=m);for(p=gr(at(u.messages[0].data)[2][0].data),f=Me.find(c,o[p].location),h=Zr(en(f.content)),g=0;g<h.length;++g)m=h[g],m.id==p&&(u=m);for(p=gr(at(u.messages[0].data)[2][0].data),f=Me.find(c,o[p].location),h=Zr(en(f.content)),g=0;g<h.length;++g)m=h[g],m.id==p&&(u=m);var x=at(u.messages[0].data);{x[6][0].data=lt(n.e.r+1),x[7][0].data=lt(n.e.c+1);var v=gr(x[46][0].data),y=Me.find(c,o[v].location),_=Zr(en(y.content));{for(var b=0;b<_.length&&_[b].id!=v;++b);if(_[b].id!=v)throw"Bad ColumnRowUIDMapArchive";var S=at(_[b].messages[0].data);S[1]=[],S[2]=[],S[3]=[];for(var C=0;C<=n.e.c;++C){var N=[];N[1]=N[2]=[{type:0,data:lt(C+420690)}],S[1].push({type:2,data:ir(N)}),S[2].push({type:0,data:lt(C)}),S[3].push({type:0,data:lt(C)})}S[4]=[],S[5]=[],S[6]=[];for(var F=0;F<=n.e.r;++F)N=[],N[1]=N[2]=[{type:0,data:lt(F+726270)}],S[4].push({type:2,data:ir(N)}),S[5].push({type:0,data:lt(F)}),S[6].push({type:0,data:lt(F)});_[b].messages[0].data=ir(S)}y.content=qs(Gs(_)),y.size=y.content.length,delete x[46];var Y=at(x[4][0].data);{Y[7][0].data=lt(n.e.r+1);var X=at(Y[1][0].data),V=gr(X[2][0].data);y=Me.find(c,o[V].location),_=Zr(en(y.content));{if(_[0].id!=V)throw"Bad HeaderStorageBucket";var te=at(_[0].messages[0].data);for(F=0;F<s.length;++F){var G=at(te[2][0].data);G[1][0].data=lt(F),G[4][0].data=lt(s[F].length),te[2][F]={type:te[2][0].type,data:ir(G)}}_[0].messages[0].data=ir(te)}y.content=qs(Gs(_)),y.size=y.content.length;var re=gr(Y[2][0].data);y=Me.find(c,o[re].location),_=Zr(en(y.content));{if(_[0].id!=re)throw"Bad HeaderStorageBucket";for(te=at(_[0].messages[0].data),C=0;C<=n.e.c;++C)G=at(te[2][0].data),G[1][0].data=lt(C),G[4][0].data=lt(n.e.r+1),te[2][C]={type:te[2][0].type,data:ir(G)};_[0].messages[0].data=ir(te)}y.content=qs(Gs(_)),y.size=y.content.length;var Z=gr(Y[4][0].data);(function(){for(var P=Me.find(c,o[Z].location),A=Zr(en(P.content)),T,j=0;j<A.length;++j){var R=A[j];R.id==Z&&(T=R)}var z=at(T.messages[0].data);{z[3]=[];var I=[];l.forEach(function(O,B){I[1]=[{type:0,data:lt(B)}],I[2]=[{type:0,data:lt(1)}],I[3]=[{type:2,data:SR(O)}],z[3].push({type:2,data:ir(I)})})}T.messages[0].data=ir(z);var L=Gs(A),K=qs(L);P.content=K,P.size=P.content.length})();var oe=at(Y[3][0].data);{var ee=oe[1][0];delete oe[2];var E=at(ee.data);{var D=gr(E[2][0].data);(function(){for(var P=Me.find(c,o[D].location),A=Zr(en(P.content)),T,j=0;j<A.length;++j){var R=A[j];R.id==D&&(T=R)}var z=at(T.messages[0].data);{delete z[6],delete oe[7];var I=new Uint8Array(z[5][0].data);z[5]=[];for(var L=0,K=0;K<=n.e.r;++K){var O=at(I);L+=MR(O,s[K],l),O[1][0].data=lt(K),z[5].push({data:ir(O),type:2})}z[1]=[{type:0,data:lt(n.e.c+1)}],z[2]=[{type:0,data:lt(n.e.r+1)}],z[3]=[{type:0,data:lt(L)}],z[4]=[{type:0,data:lt(n.e.r+1)}]}T.messages[0].data=ir(z);var B=Gs(A),M=qs(B);P.content=M,P.size=P.content.length})()}ee.data=ir(E)}Y[3][0].data=ir(oe)}x[4][0].data=ir(Y)}u.messages[0].data=ir(x);var U=Gs(h),k=qs(U);return f.content=k,f.size=f.content.length,c}function Yw(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function og(e){Yw([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function lg(e){Yw([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function BR(e){return Ze.WS.indexOf(e)>-1?"sheet":e==Ze.CS?"chart":e==Ze.DS?"dialog":e==Ze.MS?"macro":e&&e.length?e:"sheet"}function UR(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,BR(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function WR(e,t,r,n,i,s,l,o,a,c,d,f){try{s[n]=Po(Vr(e,r,!0),t);var h=zt(e,t),u;switch(o){case"sheet":u=cj(h,t,i,a,s[n],c,d,f);break;case"chart":if(u=uj(h,t,i,a,s[n],c,d,f),!u||!u["!drawel"])break;var g=xo(u["!drawel"].Target,t),m=gl(g),p=K3(Vr(e,g,!0),Po(Vr(e,m,!0),g)),x=xo(p,g),v=gl(x);u=M5(Vr(e,x,!0),x,a,Po(Vr(e,v,!0),x),c,u);break;case"macro":u=fj(h,t,i,a,s[n],c,d,f);break;case"dialog":u=hj(h,t,i,a,s[n],c,d,f);break;default:throw new Error("Unrecognized sheet type "+o)}l[n]=u;var y=[];s&&s[n]&&It(s[n]).forEach(function(_){var b="";if(s[n][_].Type==Ze.CMNT){b=xo(s[n][_].Target,t);var S=mj(zt(e,b,!0),b,a);if(!S||!S.length)return;$m(u,S,!1)}s[n][_].Type==Ze.TCMNT&&(b=xo(s[n][_].Target,t),y=y.concat(Q3(zt(e,b,!0),a)))}),y&&y.length&&$m(u,y,!0,a.people||[])}catch(_){if(a.WTF)throw _}}function Jr(e){return e.charAt(0)=="/"?e.slice(1):e}function zR(e,t){if(Xa(),t=t||{},og(t),tn(e,"META-INF/manifest.xml")||tn(e,"objectdata.xml"))return rx(e,t);if(tn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof sh<"u"){if(e.FileIndex)return sh(e);var r=Me.utils.cfb_new();return hm(e).forEach(function(G){Je(r,G,ZE(e,G))}),sh(r)}throw new Error("Unsupported NUMBERS file")}if(!tn(e,"[Content_Types].xml"))throw tn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):tn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=hm(e),i=X4(Vr(e,"[Content_Types].xml")),s=!1,l,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",zt(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!zt(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var a={},c={};if(!t.bookSheets&&!t.bookProps){if(Do=[],i.sst)try{Do=pj(zt(e,Jr(i.sst)),i.sst,t)}catch(G){if(t.WTF)throw G}t.cellStyles&&i.themes.length&&(a=gj(Vr(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=dj(zt(e,Jr(i.style)),i.style,a,t))}i.links.map(function(G){try{var re=Po(Vr(e,gl(Jr(G))),G);return vj(zt(e,Jr(G)),re,G,t)}catch{}});var d=lj(zt(e,Jr(i.workbooks[0])),i.workbooks[0],t),f={},h="";i.coreprops.length&&(h=zt(e,Jr(i.coreprops[0]),!0),h&&(f=Ry(h)),i.extprops.length!==0&&(h=zt(e,Jr(i.extprops[0]),!0),h&&Z4(h,f,t)));var u={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(h=Vr(e,Jr(i.custprops[0]),!0),h&&(u=tA(h,t)));var g={};if((t.bookSheets||t.bookProps)&&(d.Sheets?l=d.Sheets.map(function(re){return re.name}):f.Worksheets&&f.SheetNames.length>0&&(l=f.SheetNames),t.bookProps&&(g.Props=f,g.Custprops=u),t.bookSheets&&typeof l<"u"&&(g.SheetNames=l),t.bookSheets?g.SheetNames:t.bookProps))return g;l={};var m={};t.bookDeps&&i.calcchain&&(m=xj(zt(e,Jr(i.calcchain)),i.calcchain));var p=0,x={},v,y;{var _=d.Sheets;f.Worksheets=_.length,f.SheetNames=[];for(var b=0;b!=_.length;++b)f.SheetNames[b]=_[b].name}var S=s?"bin":"xml",C=i.workbooks[0].lastIndexOf("/"),N=(i.workbooks[0].slice(0,C+1)+"_rels/"+i.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");tn(e,N)||(N="xl/_rels/workbook."+S+".rels");var F=Po(Vr(e,N,!0),N.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=yj(zt(e,Jr(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=eF(zt(e,Jr(i.people[0])),t)),F&&(F=UR(F,d.Sheets));var Y=zt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(p=0;p!=f.Worksheets;++p){var X="sheet";if(F&&F[p]?(v="xl/"+F[p][1].replace(/[\/]?xl\//,""),tn(e,v)||(v=F[p][1]),tn(e,v)||(v=N.replace(/_rels\/.*$/,"")+F[p][1]),X=F[p][2]):(v="xl/worksheets/sheet"+(p+1-Y)+"."+S,v=v.replace(/sheet0\./,"sheet.")),y=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(p!=t.sheets)continue e;break;case"string":if(f.SheetNames[p].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var V=!1,te=0;te!=t.sheets.length;++te)typeof t.sheets[te]=="number"&&t.sheets[te]==p&&(V=1),typeof t.sheets[te]=="string"&&t.sheets[te].toLowerCase()==f.SheetNames[p].toLowerCase()&&(V=1);if(!V)continue e}}WR(e,v,y,f.SheetNames[p],p,x,l,X,t,d,a,c)}return g={Directory:i,Workbook:d,Props:f,Custprops:u,Deps:m,Sheets:l,SheetNames:f.SheetNames,Strings:Do,Styles:c,Themes:a,SSF:_t(ze)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(G,re){G=G.replace(/^Root Entry[\/]/,""),g.keys.push(G),g.files[G]=e.FileIndex[re]}))),t&&t.bookVBA&&(i.vba.length>0?g.vbaraw=zt(e,Jr(i.vba[0]),!0):i.defaults&&i.defaults.bin===lF&&(g.vbaraw=zt(e,"xl/vbaProject.bin",!0))),g}function HR(e,t){var r=t||{},n="Workbook",i=Me.find(e,n);try{if(n="/!DataSpaces/Version",i=Me.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(yN(i.content),n="/!DataSpaces/DataSpaceMap",i=Me.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=_N(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Me.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=bN(i.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Me.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);kN(i.content)}catch{}if(n="/EncryptionInfo",i=Me.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=CN(i.content);if(n="/EncryptedPackage",i=Me.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function VR(e,t){return t.bookType=="ods"?Xw(e,t):t.bookType=="numbers"?LR(e,t):t.bookType=="xlsb"?$R(e,t):XR(e,t)}function $R(e,t){ga=1024,e&&!e.SSF&&(e.SSF=_t(ze)),e&&e.SSF&&(Xa(),Qu(e.SSF),t.revssf=ef(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,jo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=ww.indexOf(t.bookType)>-1,i=Y0();lg(t=t||{});var s=D0(),l="",o=0;if(t.cellXfs=[],Ki(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Je(s,l,Iy(e.Props,t)),i.coreprops.push(l),ut(t.rels,2,l,Ze.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var a=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&a.push(e.SheetNames[c]);e.Props.SheetNames=a}for(e.Props.Worksheets=e.Props.SheetNames.length,Je(s,l,By(e.Props)),i.extprops.push(l),ut(t.rels,3,l,Ze.EXT_PROPS),e.Custprops!==e.Props&&It(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Je(s,l,Uy(e.Custprops)),i.custprops.push(l),ut(t.rels,4,l,Ze.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,Je(s,l,_j(o-1,l,t,e,d)),i.sheets.push(l),ut(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ze.WS[0])}if(f){var u=f["!comments"],g=!1,m="";u&&u.length>0&&(m="xl/comments"+o+"."+r,Je(s,m,kj(u,m)),i.comments.push(m),ut(d,-1,"../comments"+o+"."+r,Ze.CMNT),g=!0),f["!legacy"]&&g&&Je(s,"xl/drawings/vmlDrawing"+o+".vml",vw(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Je(s,gl(l),Ca(d))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Je(s,l,Sj(t.Strings,l,t)),i.strs.push(l),ut(t.wbrels,-1,"sharedStrings."+r,Ze.SST)),l="xl/workbook."+r,Je(s,l,wj(e,l)),i.workbooks.push(l),ut(t.rels,1,l,Ze.WB),l="xl/theme/theme1.xml",Je(s,l,Z0(e.Themes,t)),i.themes.push(l),ut(t.wbrels,-1,"theme/theme1.xml",Ze.THEME),l="xl/styles."+r,Je(s,l,bj(e,l,t)),i.styles.push(l),ut(t.wbrels,-1,"styles."+r,Ze.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Je(s,l,e.vbaraw),i.vba.push(l),ut(t.wbrels,-1,"vbaProject.bin",Ze.VBA)),l="xl/metadata."+r,Je(s,l,Cj(l)),i.metadata.push(l),ut(t.wbrels,-1,"metadata."+r,Ze.XLMETA),Je(s,"[Content_Types].xml",Dy(i,t)),Je(s,"_rels/.rels",Ca(t.rels)),Je(s,"xl/_rels/workbook."+r+".rels",Ca(t.wbrels)),delete t.revssf,delete t.ssf,s}function XR(e,t){ga=1024,e&&!e.SSF&&(e.SSF=_t(ze)),e&&e.SSF&&(Xa(),Qu(e.SSF),t.revssf=ef(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,jo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=ww.indexOf(t.bookType)>-1,i=Y0();lg(t=t||{});var s=D0(),l="",o=0;if(t.cellXfs=[],Ki(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Je(s,l,Iy(e.Props,t)),i.coreprops.push(l),ut(t.rels,2,l,Ze.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var a=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&a.push(e.SheetNames[c]);e.Props.SheetNames=a}e.Props.Worksheets=e.Props.SheetNames.length,Je(s,l,By(e.Props)),i.extprops.push(l),ut(t.rels,3,l,Ze.EXT_PROPS),e.Custprops!==e.Props&&It(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Je(s,l,Uy(e.Custprops)),i.custprops.push(l),ut(t.rels,4,l,Ze.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],u=(h||{})["!type"]||"sheet";switch(u){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,Je(s,l,Fw(o-1,t,e,f)),i.sheets.push(l),ut(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ze.WS[0])}if(h){var g=h["!comments"],m=!1,p="";if(g&&g.length>0){var x=!1;g.forEach(function(v){v[1].forEach(function(y){y.T==!0&&(x=!0)})}),x&&(p="xl/threadedComments/threadedComment"+o+"."+r,Je(s,p,Z3(g,d,t)),i.threadedcomments.push(p),ut(f,-1,"../threadedComments/threadedComment"+o+"."+r,Ze.TCMNT)),p="xl/comments"+o+"."+r,Je(s,p,yw(g)),i.comments.push(p),ut(f,-1,"../comments"+o+"."+r,Ze.CMNT),m=!0}h["!legacy"]&&m&&Je(s,"xl/drawings/vmlDrawing"+o+".vml",vw(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Je(s,gl(l),Ca(f))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Je(s,l,aw(t.Strings,t)),i.strs.push(l),ut(t.wbrels,-1,"sharedStrings."+r,Ze.SST)),l="xl/workbook."+r,Je(s,l,Iw(e)),i.workbooks.push(l),ut(t.rels,1,l,Ze.WB),l="xl/theme/theme1.xml",Je(s,l,Z0(e.Themes,t)),i.themes.push(l),ut(t.wbrels,-1,"theme/theme1.xml",Ze.THEME),l="xl/styles."+r,Je(s,l,gw(e,t)),i.styles.push(l),ut(t.wbrels,-1,"styles."+r,Ze.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Je(s,l,e.vbaraw),i.vba.push(l),ut(t.wbrels,-1,"vbaProject.bin",Ze.VBA)),l="xl/metadata."+r,Je(s,l,xw()),i.metadata.push(l),ut(t.wbrels,-1,"metadata."+r,Ze.XLMETA),d.length>1&&(l="xl/persons/person.xml",Je(s,l,tF(d)),i.people.push(l),ut(t.wbrels,-1,"persons/person.xml",Ze.PEOPLE)),Je(s,"[Content_Types].xml",Dy(i,t)),Je(s,"_rels/.rels",Ca(t.rels)),Je(s,"xl/_rels/workbook."+r+".rels",Ca(t.wbrels)),delete t.revssf,delete t.ssf,s}function cg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Gr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function YR(e,t){return Me.find(e,"EncryptedPackage")?HR(e,t):Uw(e,t)}function GR(e,t){var r,n=e,i=t||{};return i.type||(i.type=Qe&&Buffer.isBuffer(e)?"buffer":"base64"),r=ly(n,i),zR(r,i)}function Gw(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return bd(e.slice(r),t);default:break e}return La.to_workbook(e,t)}function qR(e,t){var r="",n=cg(e,t);switch(t.type){case"base64":r=Gr(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Es(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=dt(r)),t.type="binary",Gw(r,t)}function KR(e,t){var r=e;return t.type=="base64"&&(r=Gr(r)),r=ll.utils.decode(1200,r.slice(2),"str"),t.type="binary",Gw(r,t)}function JR(e){return e.match(/[^\x00-\x7F]/)?Mn(e):e}function ah(e,t,r,n){return n?(r.type="string",La.to_workbook(e,r)):La.to_workbook(t,r)}function Cd(e,t){A0();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Cd(new Uint8Array(e),(r=_t(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Ea={},r.dateNF&&(Ea.dateNF=r.dateNF),r.type||(r.type=Qe&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Qe?"buffer":"binary",n=$E(e),typeof Uint8Array<"u"&&!Qe&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=JR(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),o=new Uint8Array(l);if(o.foo="bar",!o.foo)return r=_t(r),r.type="array",Cd(O0(n),r)}switch((i=cg(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return YR(Me.read(n,r),r);break;case 9:if(i[1]<=8)return Uw(n,r);break;case 60:return bd(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return rN(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return iw.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?GR(n,r):ah(e,n,r,s);case 239:return i[3]===60?bd(n,r):ah(e,n,r,s);case 255:if(i[1]===254)return KR(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return xs.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return xs.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return _d.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return fw.to_workbook(n,r);break;case 10:case 13:case 32:return qR(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return tN.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?_d.to_workbook(n,r):ah(e,n,r,s)}function qw(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Pl(t.file,Me.write(e,{type:Qe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Me.write(e,t)}function QR(e,t){var r=_t(t||{}),n=VR(e,r);return ZR(n,r)}function ZR(e,t){var r={},n=Qe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Me.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Ju(i))}return t.password&&typeof encrypt_agile<"u"?qw(encrypt_agile(i,t.password),t):t.type==="file"?Pl(t.file,i):t.type=="string"?dt(i):i}function eI(e,t){var r=t||{},n=Jj(e,r);return qw(n,r)}function Pn(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return cl(Mn(n));case"binary":return Mn(n);case"string":return e;case"file":return Pl(t.file,n,"utf8");case"buffer":return Qe?ci(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Pn(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function tI(e,t){switch(t.type){case"base64":return cl(e);case"binary":return e;case"string":return e;case"file":return Pl(t.file,e,"binary");case"buffer":return Qe?ci(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Sc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?cl(r):t.type=="string"?dt(r):r;case"file":return Pl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Kw(e,t){A0(),Y5(e);var r=_t(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Kw(e,r);return r.type="array",Ju(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Pn(Vj(e,r),r);case"slk":case"sylk":return Pn(nw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return Pn(zw(e.Sheets[e.SheetNames[i]],r),r);case"txt":return tI(Qw(e.Sheets[e.SheetNames[i]],r),r);case"csv":return Pn(ug(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return Pn(iw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return Sc(_d.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return Pn(La.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return Pn(fw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return Pn(sw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return Pn(Xw(e,r),r);case"wk1":return Sc(xs.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return Sc(xs.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Sc(Ww(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),eI(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return QR(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function rI(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Jw(e,t,r){var n={};return n.type="file",n.file=t,rI(n),Kw(e,n)}function nI(e,t,r,n,i,s,l,o){var a=Bt(r),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!l||e[r])for(var u=t.s.c;u<=t.e.c;++u){var g=l?e[r][u]:e[n[u]+a];if(g===void 0||g.t===void 0){if(c===void 0)continue;s[u]!=null&&(h[s[u]]=c);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[u]!=null){if(m==null)if(g.t=="e"&&m===null)h[s[u]]=null;else if(c!==void 0)h[s[u]]=c;else if(d&&m===null)h[s[u]]=null;else continue;else h[s[u]]=d&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?m:ai(g,m,o);m!=null&&(f=!1)}}return{row:h,isempty:f}}function Eu(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],l=0,o="",a={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},d=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof d){case"string":a=st(d);break;case"number":a=st(e["!ref"]),a.s.r=d;break;default:a=d}n>0&&(i=0);var f=Bt(a.s.r),h=[],u=[],g=0,m=0,p=Array.isArray(e),x=a.s.r,v=0,y={};p&&!e[x]&&(e[x]=[]);var _=c.skipHidden&&e["!cols"]||[],b=c.skipHidden&&e["!rows"]||[];for(v=a.s.c;v<=a.e.c;++v)if(!(_[v]||{}).hidden)switch(h[v]=At(v),r=p?e[x][v]:e[h[v]+f],n){case 1:s[v]=v-a.s.c;break;case 2:s[v]=h[v];break;case 3:s[v]=c.header[v-a.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=ai(r,null,c),m=y[l]||0,!m)y[l]=1;else{do o=l+"_"+m++;while(y[o]);y[l]=m,y[o]=1}s[v]=o}for(x=a.s.r+i;x<=a.e.r;++x)if(!(b[x]||{}).hidden){var S=nI(e,a,x,h,n,s,p,c);(S.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(u[g++]=S.row)}return u.length=g,u}var ox=/"/g;function iI(e,t,r,n,i,s,l,o){for(var a=!0,c=[],d="",f=Bt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var u=o.dense?(e[r]||[])[h]:e[n[h]+f];if(u==null)d="";else if(u.v!=null){a=!1,d=""+(o.rawNumbers&&u.t=="n"?u.v:ai(u,null,o));for(var g=0,m=0;g!==d.length;++g)if((m=d.charCodeAt(g))===i||m===s||m===34||o.forceQuotes){d='"'+d.replace(ox,'""')+'"';break}d=="ID"&&(d='"ID"')}else u.f!=null&&!u.F?(a=!1,d="="+u.f,d.indexOf(",")>=0&&(d='"'+d.replace(ox,'""')+'"')):d="";c.push(d)}return o.blankrows===!1&&a?null:c.join(l)}function ug(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=st(e["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,a=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],u=n.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(h[g]||{}).hidden||(f[g]=At(g));for(var m=0,p=i.s.r;p<=i.e.r;++p)(u[p]||{}).hidden||(d=iI(e,i,p,f,l,a,s,n),d!=null&&(n.strip&&(d=d.replace(c,"")),(d||n.blankrows!==!1)&&r.push((m++?o:"")+d)));return delete n.dense,r.join("")}function Qw(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=ug(e,t);return r}function sI(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=st(e["!ref"]),s="",l=[],o,a=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)l[o]=At(o);for(var d=i.s.r;d<=i.e.r;++d)for(s=Bt(d),o=i.s.c;o<=i.e.c;++o)if(t=l[o]+s,r=c?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}a[a.length]=t+"="+n}return a}function Zw(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},l=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var a=typeof n.origin=="string"?Ot(n.origin):n.origin;l=a.r,o=a.c}var c,d={s:{c:0,r:0},e:{c:o,r:l+t.length-1+i}};if(s["!ref"]){var f=st(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),l==-1&&(l=f.e.r+1,d.e.r=l+t.length-1+i)}else l==-1&&(l=0,d.e.r=t.length-1+i);var h=n.header||[],u=0;t.forEach(function(m,p){It(m).forEach(function(x){(u=h.indexOf(x))==-1&&(h[u=h.length]=x);var v=m[x],y="z",_="",b=$e({c:o+u,r:l+p+i});c=_l(s,b),v&&typeof v=="object"&&!(v instanceof Date)?s[b]=v:(typeof v=="number"?y="n":typeof v=="boolean"?y="b":typeof v=="string"?y="s":v instanceof Date?(y="d",n.cellDates||(y="n",v=Kt(v)),_=n.dateNF||ze[14]):v===null&&n.nullError&&(y="e",v=0),c?(c.t=y,c.v=v,delete c.w,delete c.R,_&&(c.z=_)):s[b]=c={t:y,v},_&&(c.z=_))})}),d.e.c=Math.max(d.e.c,o+h.length-1);var g=Bt(l);if(i)for(u=0;u<h.length;++u)s[At(u+o)+g]={t:"s",v:h[u]};return s["!ref"]=Ke(d),s}function aI(e,t){return Zw(null,e,t)}function _l(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Ot(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?_l(e,$e(t)):_l(e,$e({r:t,c:r||0}))}function oI(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function fg(){return{SheetNames:[],Sheets:{}}}function hg(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var l=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=l+i)!=-1;++i);}if(Rw(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function lI(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=oI(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function cI(e,t){return e.z=t,e}function e_(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function uI(e,t,r){return e_(e,"#"+t,r)}function fI(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function hI(e,t,r,n){for(var i=typeof t!="string"?t:st(t),s=typeof t=="string"?t:Ke(t),l=i.s.r;l<=i.e.r;++l)for(var o=i.s.c;o<=i.e.c;++o){var a=_l(e,l,o);a.t="n",a.F=s,delete a.v,l==i.s.r&&o==i.s.c&&(a.f=r,n&&(a.D=!0))}return e}var hs={encode_col:At,encode_row:Bt,encode_cell:$e,encode_range:Ke,decode_col:W0,decode_row:U0,split_cell:S4,decode_cell:Ot,decode_range:Mr,format_cell:ai,sheet_add_aoa:Ty,sheet_add_json:Zw,sheet_add_dom:Hw,aoa_to_sheet:Ya,json_to_sheet:aI,table_to_sheet:Vw,table_to_book:yR,sheet_to_csv:ug,sheet_to_txt:Qw,sheet_to_json:Eu,sheet_to_html:zw,sheet_to_formulae:sI,sheet_to_row_object_array:Eu,sheet_get_cell:_l,book_new:fg,book_append_sheet:hg,book_set_sheet_visibility:lI,cell_set_number_format:cI,cell_set_hyperlink:e_,cell_set_internal_link:uI,cell_add_comment:fI,sheet_set_array_formula:hI,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const t_=({isMobileView:e=!1,externalZoneId:t=null,externalDate:r=null,externalSessionId:n=null})=>{const i=le.useRef(null),s=le.useRef(null),[l,o]=le.useState([]),[a,c]=le.useState(null),[d,f]=le.useState(new Date().toISOString().split("T")[0]),[h,u]=le.useState(null),[g,m]=le.useState([]),[p,x]=le.useState(!1),[v,y]=le.useState({present:0,absent:0,total:0}),[_,b]=le.useState(!1);le.useEffect(()=>{S()},[]),le.useEffect(()=>{t&&c(t)},[t]),le.useEffect(()=>{r&&f(r)},[r]),le.useEffect(()=>{n&&u(n)},[n]);const S=async()=>{x(!0);const{data:G}=await we.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});G&&G.length>0&&(o(G),c(G[0].id))};le.useEffect(()=>{a&&C(a)},[a]);const C=async G=>{const{data:re}=await we.from("sessions").select("*").eq("zone_id",G).order("start_time",{ascending:!0});if(re){m(re);const Z=new Date().toISOString().split("T")[0];if(d===Z){const oe=new Date,ee=oe.getHours().toString().padStart(2,"0")+":"+oe.getMinutes().toString().padStart(2,"0")+":00",E=re.find(D=>ee>=D.start_time&&ee<=D.end_time);E?u(E.id):re.length>0&&u(re[0].id)}else re.length>0&&u(re[0].id)}};le.useEffect(()=>{const G=new Date().toISOString().split("T")[0];if(d===G&&g.length>0){const re=new Date,Z=re.getHours().toString().padStart(2,"0")+":"+re.getMinutes().toString().padStart(2,"0")+":00",oe=g.find(ee=>Z>=ee.start_time&&Z<=ee.end_time);oe&&u(oe.id)}},[d]),le.useEffect(()=>{if(!i.current||!a||!h)return;s.current&&s.current.dispose(),i.current.innerHTML="";const G=document.createElement("canvas");i.current.appendChild(G);const re=new Ve.fabric.Canvas(G,{backgroundColor:"transparent",selection:!1,allowTouchScrolling:!0});s.current=re,(async()=>{await N(g)})();let oe=!1,ee,E,D,U;re.on("mouse:down",P=>{var I,L,K;const A=P.e,T=P.target;if((I=P.subTargets)==null?void 0:I.find(O=>O.name==="actionButton"||O.name==="actionLabel")){V(T);return}oe=!0;const R=A.type==="touchstart"?A.touches[0]:A;ee=R.clientX,E=R.clientY;const z=((L=i.current)==null?void 0:L.closest(".mobile-seatmap-container"))||((K=i.current)==null?void 0:K.parentElement);z&&(D=z.scrollLeft,U=z.scrollTop)}),re.on("mouse:move",P=>{var I,L;if(!oe)return;const A=P.e,T=A.type==="touchmove"?A.touches[0]:A,j=T.clientX-ee,R=T.clientY-E,z=((I=i.current)==null?void 0:I.closest(".mobile-seatmap-container"))||((L=i.current)==null?void 0:L.parentElement);z&&(z.scrollLeft=D-j,z.scrollTop=U-R)}),re.on("mouse:up",()=>{oe=!1}),re.on("mouse:out",()=>{});const k=we.channel("attendance_changes").on("postgres_changes",{event:"*",schema:"public",table:"attendance"},()=>{N(g)}).subscribe(P=>{b(P==="SUBSCRIBED")});return()=>{we.removeChannel(k),re.dispose(),s.current=null}},[h,a,d,n,t,r,g]);const N=async G=>{if(!s.current||!a||!h)return;x(!0);const{data:re}=await we.from("seats").select("*").eq("zone_id",a).order("global_number",{ascending:!0}),Z=d,oe=X().split("T")[0],ee=Z===oe,{data:E}=await we.from("bookings").select(`
          *,
          profiles(full_name, username),
          attendance(id, status, timestamp_in, timestamp_out)
        `).eq("date",Z);if(E&&E.length>0){const ce=new Date(new Date().getTime()+324e5).toISOString().split("T")[1].substring(0,8),ue=[];if(E.forEach(xe=>{const _e=G.find(ve=>ve.id===xe.session_id);if(!_e)return;const fe=Array.isArray(xe.attendance)?xe.attendance[0]:xe.attendance;if(fe&&(fe.status==="present"||fe.status==="late")&&!fe.timestamp_out){const ve=_e.end_time.length===5?_e.end_time+":00":_e.end_time;(Z<oe||ee&&ve<ce)&&ue.push({id:fe.id,timestamp_out:`${Z}T${ve}+09:00`,updated_at:new Date().toISOString()})}}),ue.length>0){const{error:xe}=await we.from("attendance").upsert(ue);xe||ue.forEach(_e=>{const fe=E.find(ve=>{var De,je;return(Array.isArray(ve.attendance)?(De=ve.attendance[0])==null?void 0:De.id:(je=ve.attendance)==null?void 0:je.id)===_e.id});fe&&(Array.isArray(fe.attendance)?fe.attendance[0].timestamp_out=_e.timestamp_out:fe.attendance.timestamp_out=_e.timestamp_out)})}}s.current&&s.current.clear();const D=re||[];if(D.length===0){x(!1);return}const U=D.map(H=>H.pos_x).filter(H=>typeof H=="number"&&!isNaN(H)),k=D.map(H=>H.pos_y).filter(H=>typeof H=="number"&&!isNaN(H));if(U.length===0||k.length===0){x(!1);return}const P=Math.min(...U),A=Math.max(...D.map(H=>H.pos_x+(H.width||72)).filter(H=>!isNaN(H))),T=Math.min(...k),j=Math.max(...D.map(H=>H.pos_y+(H.height||72)).filter(H=>!isNaN(H))),R=A-P,z=j-T,I=R+40,L=z+40,K=20-P,O=20-T;s.current&&(s.current.setDimensions({width:I,height:L}),i.current&&(i.current.style.width=`${I}px`,i.current.style.height=`${L}px`));let B=G==null?void 0:G.find(H=>H.id===h);if(!B&&ee){const H=new Date,ce=H.getHours().toString().padStart(2,"0")+":"+H.getMinutes().toString().padStart(2,"0")+":00";B=G==null?void 0:G.find(ue=>ce>=ue.start_time&&ce<=ue.end_time)}let M=0;const se=((E==null?void 0:E.filter(H=>H.session_id===h))||[]).length;re.forEach(H=>{if(H.type==="structure"){F({...H,pos_x:H.pos_x+K,pos_y:H.pos_y+O},null,null,[],null,G,!1);return}const ce=(E==null?void 0:E.filter(ve=>ve.seat_id===H.id))||[],ue=ce.find(ve=>ve.session_id===h),xe=Array.isArray(ue==null?void 0:ue.attendance)?ue.attendance[0]:(ue==null?void 0:ue.attendance)||null;let _e=(xe==null?void 0:xe.status)||"absent";if(ee&&ue&&!xe&&h&&G){const ve=G.find(Ce=>Ce.id===h);if(ve){const Ce=new Date,De=Ce.getHours().toString().padStart(2,"0")+":"+Ce.getMinutes().toString().padStart(2,"0")+":00";ve.end_time<De&&(_e="absent")}}const fe=ce.length>0;ue&&_e==="present"&&M++,F({...H,pos_x:H.pos_x+K,pos_y:H.pos_y+O},ue,_e,ce,B,G,fe)}),y({present:M,absent:se-M,total:se,rate:se>0?Math.round(M/se*100):0}),x(!1)},F=(G,re,Z,oe,ee,E,D,U)=>{if(G.type==="structure"){const K=new Ve.fabric.Rect({fill:"#E5E5EA",width:G.width||72,height:G.height||72,rx:6,ry:6,stroke:"#D1D1D6",strokeWidth:1}),O=new Ve.fabric.IText(G.label||"",{fontSize:10,originX:"center",originY:"center",left:(G.width||72)/2,top:(G.height||72)/2,fill:"#AEAEB2",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),B=new Ve.fabric.Group([K,O],{left:G.pos_x,top:G.pos_y,angle:G.rotation,selectable:!1,evented:!1,data:{...G}});s.current.add(B);return}const k=!!re,P=D,A=G.zone_color||"#5E5CE6",T=new Ve.fabric.Rect({fill:"#FFFFFF",width:71,height:71,rx:6,ry:6,stroke:"#E5E5EA",strokeWidth:1,left:.5,top:.5,originX:"left",originY:"top",selectable:!1}),j=new Ve.fabric.Path("M 0 6 Q 0 0 6 0 L 66 0 Q 72 0 72 6 L 72 18 L 0 18 z",{fill:A,strokeWidth:0,left:0,top:0,originX:"left",originY:"top",selectable:!1});let R=[T,j];if(k){const K=Array.isArray(re==null?void 0:re.attendance)?re.attendance[0]:(re==null?void 0:re.attendance)||null,B=(Z==="present"||Z==="late")&&!(K!=null&&K.timestamp_out)?"#00FF00":"#FF3B30",M=new Ve.fabric.Circle({radius:3,fill:B,left:58,top:9,originX:"center",originY:"center",selectable:!1,stroke:"rgba(255,255,255,0.8)",strokeWidth:1.5});R.push(M)}const z=new Ve.fabric.IText(G.display_number||G.seat_number,{fontSize:10,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"900",fill:"#ffffff",left:36,top:9,originX:"center",originY:"center",selectable:!1});if(R.push(z),k){const K=re==null?void 0:re.profiles,O=K?`${K.username?K.username+" ":""}${K.full_name}`:"  ",B=new Ve.fabric.IText(O,{fontSize:10,textAlign:"center",originX:"center",originY:"center",left:36,top:34,fill:"#1C1C1E",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1});R.push(B);const M=Array.isArray(re==null?void 0:re.attendance)?re.attendance[0]:(re==null?void 0:re.attendance)||null,J=!!(M!=null&&M.timestamp_out),se=(Z==="present"||Z==="late")&&!J;let H="",ce="",ue="#8E8E93",xe="#F2F2F7",_e=A,fe="#FFFFFF",ve=!1;se?(H="",ce="",ue="#FFFFFF",xe=A,_e="#FFFFFF",fe=A,ve=!0):J&&(H="",ce="",ue="#1C1C1E",xe="#F2F2F7",_e=A,fe="#FFFFFF");const Ce="M 0 50 L 36 50 L 36 72 L 6 72 Q 0 72 0 66 Z",De=new Ve.fabric.Path(Ce,{fill:xe,selectable:!1}),je=new Ve.fabric.IText(H,{fontSize:8,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",fill:ue,originX:"center",originY:"center",left:18,top:61,selectable:!1}),Ie="M 36 50 L 72 50 L 72 66 Q 72 72 66 72 L 36 72 Z",Ye=new Ve.fabric.Path(Ie,{fill:_e,stroke:ve?A:null,strokeWidth:ve?1:0,selectable:!1,hoverCursor:"pointer",name:"actionButton"}),et=new Ve.fabric.IText(ce,{fontSize:8,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",fill:fe,originX:"center",originY:"center",left:54,top:61,selectable:!1,name:"actionLabel"});R.push(De,je,Ye,et)}else{const K=new Ve.fabric.IText("",{fontSize:12,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",fill:"#E5E5EA",left:36,top:34,originX:"center",originY:"center",selectable:!1}),O="M 0 50 L 72 50 L 72 66 Q 72 72 66 72 L 6 72 Q 0 72 0 66 Z",B=new Ve.fabric.Path(O,{fill:"#F2F2F7",opacity:.3,selectable:!1}),M=new Ve.fabric.IText("-",{fontSize:10,fill:"#AEAEB2",left:36,top:61,originX:"center",originY:"center",selectable:!1});R.push(K,B,M)}let I=1;k||(I=P?.4:.15);const L=new Ve.fabric.Group(R,{left:G.pos_x,top:G.pos_y,opacity:I,angle:G.rotation,data:{...G,booking:re,status:Z},selectable:!1,hoverCursor:k?"pointer":"default",subTargetCheck:!0});s.current.add(L)},Y=G=>{const re=new Date(d);re.setDate(re.getDate()+G),f(re.toISOString().split("T")[0])},X=()=>{const G=new Date,re=9*60*60*1e3;return new Date(G.getTime()+re).toISOString().replace("Z","+09:00")},V=async G=>{const{booking:re,status:Z}=G.data;if(!re)return;const oe=g.find(U=>U.id===re.session_id);if(!oe)return;const ee=Array.isArray(re.attendance)?re.attendance[0]:re.attendance||null,E=!!(ee!=null&&ee.timestamp_out);if((Z==="present"||Z==="late")&&!E){const{error:U}=await we.from("attendance").update({timestamp_out:X(),updated_at:new Date().toISOString()}).eq("id",ee.id);U&&console.error("Error during check-out:",U),U||await N(g)}else if(E){const{error:U}=await we.from("attendance").update({status:"absent",timestamp_in:null,timestamp_out:null,updated_at:new Date().toISOString()}).eq("id",ee.id);U&&console.error("Error during reset to absent:",U),U||await N(g)}else{const U=(oe==null?void 0:oe.start_time)||"00:00:00",k={booking_id:re.id,status:"present",timestamp_in:`${d}T${U}${U.length===5?":00":""}+09:00`,timestamp_out:null,updated_at:new Date().toISOString()};ee!=null&&ee.id&&(k.id=ee.id);const{error:P}=await we.from("attendance").upsert(k,{onConflict:"booking_id"});P?console.error("Error during attendance upsert:",P):await N(g)}},te=()=>{const G=s.current.getObjects().map(oe=>{var ee,E;return{ID:oe.data.global_number,:oe.data.display_number,:((E=(ee=oe.data.booking)==null?void 0:ee.profiles)==null?void 0:E.full_name)||"",:oe.data.status==="present"?"":"",:oe.data.zone_name,:d}}),re=hs.json_to_sheet(G),Z=hs.book_new();hs.book_append_sheet(Z,re,""),Jw(Z,`_${d}.xlsx`)};return w.jsxs("div",{className:`flex flex-col gap-4 w-full ${e?"min-h-fit":"h-full"} pt-[10px]`,children:[!e&&w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between px-2",children:[w.jsxs("div",{className:"flex items-center gap-4 ml-[10px] mt-[10px]",children:[w.jsx("div",{className:"flex gap-[10px]",children:l.map(G=>w.jsx("button",{onClick:()=>c(G.id),className:`h-8 px-4 rounded-[8px] text-[11px] font-black transition-all ios-tap flex items-center justify-center border-none outline-none ring-0 ${a===G.id?"bg-[#1C1C1E] text-white shadow-md":"bg-gray-100 text-ios-gray hover:bg-gray-200"}`,children:G.name},G.id))}),w.jsxs("div",{className:"flex items-center bg-gray-100 p-0.5 rounded-[8px] border border-gray-200 h-8",children:[w.jsx("button",{onClick:()=>Y(-1),className:"h-7 px-2.5 rounded-[6px] hover:bg-white text-ios-gray transition-all text-[12px] flex items-center justify-center",children:"<"}),w.jsxs("span",{className:"h-7 px-3 text-[11px] font-black min-w-[90px] text-center flex items-center justify-center",children:[d," (",["","","","","","",""][new Date(d).getDay()],")"]}),w.jsx("button",{onClick:()=>Y(1),className:"h-7 px-2.5 rounded-[6px] hover:bg-white text-ios-gray transition-all text-[12px] flex items-center justify-center",children:">"})]}),w.jsx("div",{className:"flex bg-gray-100 pt-[3px] pb-[4px] px-0.5 rounded-[8px] border border-gray-200 h-8",children:g.map(G=>w.jsx("button",{onClick:()=>u(G.id),className:`h-[25px] px-5 rounded-[6px] text-[10px] font-black transition-all duration-300 ios-tap flex items-center justify-center ${h===G.id?"bg-[#1C1C1E] text-white shadow-md":"text-ios-gray hover:text-[#1C1C1E] hover:bg-gray-200/50"}`,children:G.name.toUpperCase()},G.id))})]}),w.jsxs("div",{className:"flex items-center gap-2 mr-[10px] mt-[10px]",children:[w.jsxs("button",{onClick:te,className:"flex items-center gap-2 bg-gray-50 hover:bg-gray-100 text-[#1C1C1E] h-8 px-4 rounded-[8px] text-[11px] font-black transition-all border border-gray-100 ios-tap",children:[w.jsx(TS,{className:"w-3.5 h-3.5 text-ios-blue"})," "]}),w.jsx("div",{className:"bg-white h-8 px-3 rounded-[8px] shadow-sm border border-gray-100 flex items-center justify-center",title:_?"    .":"   ...",children:w.jsx("div",{className:`w-2 h-2 rounded-full shrink-0 border border-white shadow-sm transition-all duration-500 ${_?"bg-emerald-500 animate-pulse shadow-emerald-500/50":"bg-rose-500 opacity-80"}`})})]})]}),w.jsxs("div",{className:"flex items-center gap-2 px-2 ml-[10px]",children:[w.jsxs("div",{className:"flex items-center gap-1.5 bg-emerald-50 border border-emerald-100 px-3 py-1.5 rounded-[8px]",children:[w.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500"}),w.jsxs("span",{className:"text-[10px] font-black text-emerald-700",children:[" ",v.present]})]}),w.jsxs("div",{className:"flex items-center gap-1.5 bg-rose-50 border border-rose-100 px-3 py-1.5 rounded-[8px]",children:[w.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-rose-500"}),w.jsxs("span",{className:"text-[10px] font-black text-rose-700",children:[" ",v.absent]})]}),w.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-50 border border-gray-100 px-3 py-1.5 rounded-[8px]",children:[w.jsx(Xu,{className:"w-3 h-3 text-ios-gray"}),w.jsxs("span",{className:"text-[10px] font-black text-ios-gray",children:[" ",v.total]})]}),w.jsx("div",{className:"flex items-center gap-1.5 bg-ios-indigo/5 border border-ios-indigo/10 px-3 py-1.5 rounded-[8px]",children:w.jsxs("span",{className:"text-[10px] font-black text-ios-indigo",children:[" ",v.rate,"%"]})})]})]}),w.jsxs("div",{className:`${e?"w-full":"flex-1 flex flex-col w-full"} overflow-hidden relative`,children:[p&&w.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-30 flex items-center justify-center pointer-events-none",children:w.jsx("div",{className:"w-8 h-8 border-3 border-ios-indigo border-t-transparent rounded-full animate-spin"})}),w.jsx("div",{className:`${e?"w-full":"flex-1 w-full"} bg-white rounded-t-[6px] rounded-b-none border-0 overflow-hidden p-2.5 pb-0`,children:w.jsx("div",{ref:i,className:`relative overflow-hidden cursor-grab active:cursor-grabbing select-none scrollbar-hide ${e?"w-full min-h-[600px] h-auto touch-action-none":"flex-1 h-full"}`,style:e?{touchAction:"none"}:{}})})]})]})};function it(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function An(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function Ri(e,t){const r=it(e);return isNaN(t)?An(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Ul(e,t){const r=it(e);if(isNaN(t))return An(e,NaN);if(!t)return r;const n=r.getDate(),i=An(e,r.getTime());i.setMonth(r.getMonth()+t+1,0);const s=i.getDate();return n>=s?i:(r.setFullYear(i.getFullYear(),i.getMonth(),n),r)}const r_=6048e5,dI=864e5,n_=6e4,i_=36e5;let gI={};function Wl(){return gI}function Un(e,t){var o,a,c,d;const r=Wl(),n=(t==null?void 0:t.weekStartsOn)??((a=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:a.weekStartsOn)??r.weekStartsOn??((d=(c=r.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??0,i=it(e),s=i.getDay(),l=(s<n?7:0)+s-n;return i.setDate(i.getDate()-l),i.setHours(0,0,0,0),i}function Au(e){return Un(e,{weekStartsOn:1})}function s_(e){const t=it(e),r=t.getFullYear(),n=An(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const i=Au(n),s=An(e,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);const l=Au(s);return t.getTime()>=i.getTime()?r+1:t.getTime()>=l.getTime()?r:r-1}function Kn(e){const t=it(e);return t.setHours(0,0,0,0),t}function lx(e){const t=it(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function pI(e,t){const r=Kn(e),n=Kn(t),i=+r-lx(r),s=+n-lx(n);return Math.round((i-s)/dI)}function mI(e){const t=s_(e),r=An(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Au(r)}function a_(e,t){const r=t*7;return Ri(e,r)}function xI(e){return An(e,Date.now())}function ys(e,t){const r=Kn(e),n=Kn(t);return+r==+n}function vI(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Mc(e){if(!vI(e)&&typeof e!="number")return!1;const t=it(e);return!isNaN(Number(t))}function bl(e){const t=it(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function zl(e,t){const r=it(e.start),n=it(e.end);let i=+r>+n;const s=i?+r:+n,l=i?n:r;l.setHours(0,0,0,0);let o=1;const a=[];for(;+l<=s;)a.push(it(l)),l.setDate(l.getDate()+o),l.setHours(0,0,0,0);return i?a.reverse():a}function yI(e,t){const r=it(e.start),n=it(e.end);let i=+r>+n;const s=i?+r:+n,l=i?n:r;l.setHours(0,0,0,0),l.setDate(1);let o=1;const a=[];for(;+l<=s;)a.push(it(l)),l.setMonth(l.getMonth()+o);return i?a.reverse():a}function Ua(e){const t=it(e);return t.setDate(1),t.setHours(0,0,0,0),t}function wI(e){const t=it(e),r=An(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function Sl(e,t){var o,a,c,d;const r=Wl(),n=(t==null?void 0:t.weekStartsOn)??((a=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:a.weekStartsOn)??r.weekStartsOn??((d=(c=r.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??0,i=it(e),s=i.getDay(),l=(s<n?-7:0)+6-(s-n);return i.setDate(i.getDate()+l),i.setHours(23,59,59,999),i}const _I={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},bI=(e,t,r)=>{let n;const i=_I[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Aa(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const SI={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},kI={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},CI={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},TI={date:Aa({formats:SI,defaultWidth:"full"}),time:Aa({formats:kI,defaultWidth:"full"}),dateTime:Aa({formats:CI,defaultWidth:"full"})},EI={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},AI=(e,t,r,n)=>EI[e];function Rn(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let i;if(n==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):l;i=e.formattingValues[o]||e.formattingValues[l]}else{const l=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;i=e.values[o]||e.values[l]}const s=e.argumentCallback?e.argumentCallback(t):t;return i[s]}}const OI={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},NI={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},FI={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},PI={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},DI={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},jI={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},RI=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},II={ordinalNumber:RI,era:Rn({values:OI,defaultWidth:"wide"}),quarter:Rn({values:NI,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Rn({values:FI,defaultWidth:"wide"}),day:Rn({values:PI,defaultWidth:"wide"}),dayPeriod:Rn({values:DI,defaultWidth:"wide",formattingValues:jI,defaultFormattingWidth:"wide"})};function In(e){return(t,r={})=>{const n=r.width,i=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(i);if(!s)return null;const l=s[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],a=Array.isArray(o)?LI(o,f=>f.test(l)):MI(o,f=>f.test(l));let c;c=e.valueCallback?e.valueCallback(a):a,c=r.valueCallback?r.valueCallback(c):c;const d=t.slice(l.length);return{value:c,rest:d}}}function MI(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function LI(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function o_(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const i=n[0],s=t.match(e.parsePattern);if(!s)return null;let l=e.valueCallback?e.valueCallback(s[0]):s[0];l=r.valueCallback?r.valueCallback(l):l;const o=t.slice(i.length);return{value:l,rest:o}}}const BI=/^(\d+)(th|st|nd|rd)?/i,UI=/\d+/i,WI={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},zI={any:[/^b/i,/^(a|c)/i]},HI={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},VI={any:[/1/i,/2/i,/3/i,/4/i]},$I={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},XI={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},YI={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},GI={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},qI={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},KI={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},JI={ordinalNumber:o_({matchPattern:BI,parsePattern:UI,valueCallback:e=>parseInt(e,10)}),era:In({matchPatterns:WI,defaultMatchWidth:"wide",parsePatterns:zI,defaultParseWidth:"any"}),quarter:In({matchPatterns:HI,defaultMatchWidth:"wide",parsePatterns:VI,defaultParseWidth:"any",valueCallback:e=>e+1}),month:In({matchPatterns:$I,defaultMatchWidth:"wide",parsePatterns:XI,defaultParseWidth:"any"}),day:In({matchPatterns:YI,defaultMatchWidth:"wide",parsePatterns:GI,defaultParseWidth:"any"}),dayPeriod:In({matchPatterns:qI,defaultMatchWidth:"any",parsePatterns:KI,defaultParseWidth:"any"})},QI={code:"en-US",formatDistance:bI,formatLong:TI,formatRelative:AI,localize:II,match:JI,options:{weekStartsOn:0,firstWeekContainsDate:1}};function ZI(e){const t=it(e);return pI(t,wI(t))+1}function e6(e){const t=it(e),r=+Au(t)-+mI(t);return Math.round(r/r_)+1}function l_(e,t){var d,f,h,u;const r=it(e),n=r.getFullYear(),i=Wl(),s=(t==null?void 0:t.firstWeekContainsDate)??((f=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??i.firstWeekContainsDate??((u=(h=i.locale)==null?void 0:h.options)==null?void 0:u.firstWeekContainsDate)??1,l=An(e,0);l.setFullYear(n+1,0,s),l.setHours(0,0,0,0);const o=Un(l,t),a=An(e,0);a.setFullYear(n,0,s),a.setHours(0,0,0,0);const c=Un(a,t);return r.getTime()>=o.getTime()?n+1:r.getTime()>=c.getTime()?n:n-1}function t6(e,t){var o,a,c,d;const r=Wl(),n=(t==null?void 0:t.firstWeekContainsDate)??((a=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:a.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(c=r.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??1,i=l_(e,t),s=An(e,0);return s.setFullYear(i,0,n),s.setHours(0,0,0,0),Un(s,t)}function r6(e,t){const r=it(e),n=+Un(r,t)-+t6(r,t);return Math.round(n/r_)+1}function ct(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const pi={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return ct(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):ct(r+1,2)},d(e,t){return ct(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return ct(e.getHours()%12||12,t.length)},H(e,t){return ct(e.getHours(),t.length)},m(e,t){return ct(e.getMinutes(),t.length)},s(e,t){return ct(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),i=Math.trunc(n*Math.pow(10,r-3));return ct(i,t.length)}},Ks={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},cx={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),i=n>0?n:1-n;return r.ordinalNumber(i,{unit:"year"})}return pi.y(e,t)},Y:function(e,t,r,n){const i=l_(e,n),s=i>0?i:1-i;if(t==="YY"){const l=s%100;return ct(l,2)}return t==="Yo"?r.ordinalNumber(s,{unit:"year"}):ct(s,t.length)},R:function(e,t){const r=s_(e);return ct(r,t.length)},u:function(e,t){const r=e.getFullYear();return ct(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return ct(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return ct(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return pi.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return ct(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const i=r6(e,n);return t==="wo"?r.ordinalNumber(i,{unit:"week"}):ct(i,t.length)},I:function(e,t,r){const n=e6(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):ct(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):pi.d(e,t)},D:function(e,t,r){const n=ZI(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):ct(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return ct(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});case"eeee":default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return ct(s,t.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});case"cccc":default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),i=n===0?7:n;switch(t){case"i":return String(i);case"ii":return ct(i,t.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let i;switch(n===12?i=Ks.noon:n===0?i=Ks.midnight:i=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let i;switch(n>=17?i=Ks.evening:n>=12?i=Ks.afternoon:n>=4?i=Ks.morning:i=Ks.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return pi.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):pi.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):ct(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):ct(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):pi.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):pi.s(e,t)},S:function(e,t){return pi.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return fx(n);case"XXXX":case"XX":return ns(n);case"XXXXX":case"XXX":default:return ns(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return fx(n);case"xxxx":case"xx":return ns(n);case"xxxxx":case"xxx":default:return ns(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+ux(n,":");case"OOOO":default:return"GMT"+ns(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+ux(n,":");case"zzzz":default:return"GMT"+ns(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return ct(n,t.length)},T:function(e,t,r){const n=e.getTime();return ct(n,t.length)}};function ux(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=Math.trunc(n/60),s=n%60;return s===0?r+String(i):r+String(i)+t+ct(s,2)}function fx(e,t){return e%60===0?(e>0?"-":"+")+ct(Math.abs(e)/60,2):ns(e,t)}function ns(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=ct(Math.trunc(n/60),2),s=ct(n%60,2);return r+i+t+s}const hx=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},c_=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},n6=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return hx(e,t);let s;switch(n){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",hx(n,t)).replace("{{time}}",c_(i,t))},i6={p:c_,P:n6},s6=/^D+$/,a6=/^Y+$/,o6=["D","DD","YY","YYYY"];function l6(e){return s6.test(e)}function c6(e){return a6.test(e)}function u6(e,t,r){const n=f6(e,t,r);if(console.warn(n),o6.includes(e))throw new RangeError(n)}function f6(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const h6=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,d6=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,g6=/^'([^]*?)'?$/,p6=/''/g,m6=/[a-zA-Z]/;function Be(e,t,r){var d,f,h,u,g,m,p,x;const n=Wl(),i=(r==null?void 0:r.locale)??n.locale??QI,s=(r==null?void 0:r.firstWeekContainsDate)??((f=(d=r==null?void 0:r.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(h=n.locale)==null?void 0:h.options)==null?void 0:u.firstWeekContainsDate)??1,l=(r==null?void 0:r.weekStartsOn)??((m=(g=r==null?void 0:r.locale)==null?void 0:g.options)==null?void 0:m.weekStartsOn)??n.weekStartsOn??((x=(p=n.locale)==null?void 0:p.options)==null?void 0:x.weekStartsOn)??0,o=it(e);if(!Mc(o))throw new RangeError("Invalid time value");let a=t.match(d6).map(v=>{const y=v[0];if(y==="p"||y==="P"){const _=i6[y];return _(v,i.formatLong)}return v}).join("").match(h6).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const y=v[0];if(y==="'")return{isToken:!1,value:x6(v)};if(cx[y])return{isToken:!0,value:v};if(y.match(m6))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");return{isToken:!1,value:v}});i.localize.preprocessor&&(a=i.localize.preprocessor(o,a));const c={firstWeekContainsDate:s,weekStartsOn:l,locale:i};return a.map(v=>{if(!v.isToken)return v.value;const y=v.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&c6(y)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&l6(y))&&u6(y,t,String(e));const _=cx[y[0]];return _(o,y,i.localize,c)}).join("")}function x6(e){const t=e.match(g6);return t?t[1].replace(p6,"'"):e}function v6(e,t){const r=it(e),n=it(t);return r.getTime()>n.getTime()}function Lc(e,t){const r=it(e),n=it(t);return+r<+n}function y6(e){return+it(e)<Date.now()}function Td(e,t){const r=it(e),n=it(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function dg(e){return ys(e,xI(e))}function kl(e,t){const r=+it(e),[n,i]=[+it(t.start),+it(t.end)].sort((s,l)=>s-l);return r>=n&&r<=i}function Ed(e,t){return Ri(e,-t)}function Et(e,t){const n=S6(e);let i;if(n.date){const a=k6(n.date,2);i=C6(a.restDateString,a.year)}if(!i||isNaN(i.getTime()))return new Date(NaN);const s=i.getTime();let l=0,o;if(n.time&&(l=T6(n.time),isNaN(l)))return new Date(NaN);if(n.timezone){if(o=E6(n.timezone),isNaN(o))return new Date(NaN)}else{const a=new Date(s+l),c=new Date(0);return c.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),c.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),c}return new Date(s+l+o)}const kc={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},w6=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,_6=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,b6=/^([+-])(\d{2})(?::?(\d{2}))?$/;function S6(e){const t={},r=e.split(kc.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],kc.timeZoneDelimiter.test(t.date)&&(t.date=e.split(kc.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const i=kc.timezone.exec(n);i?(t.time=n.replace(i[1],""),t.timezone=i[1]):t.time=n}return t}function k6(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const i=n[1]?parseInt(n[1]):null,s=n[2]?parseInt(n[2]):null;return{year:s===null?i:s*100,restDateString:e.slice((n[1]||n[2]).length)}}function C6(e,t){if(t===null)return new Date(NaN);const r=e.match(w6);if(!r)return new Date(NaN);const n=!!r[4],i=lo(r[1]),s=lo(r[2])-1,l=lo(r[3]),o=lo(r[4]),a=lo(r[5])-1;if(n)return P6(t,o,a)?A6(t,o,a):new Date(NaN);{const c=new Date(0);return!N6(t,s,l)||!F6(t,i)?new Date(NaN):(c.setUTCFullYear(t,s,Math.max(i,l)),c)}}function lo(e){return e?parseInt(e):1}function T6(e){const t=e.match(_6);if(!t)return NaN;const r=oh(t[1]),n=oh(t[2]),i=oh(t[3]);return D6(r,n,i)?r*i_+n*n_+i*1e3:NaN}function oh(e){return e&&parseFloat(e.replace(",","."))||0}function E6(e){if(e==="Z")return 0;const t=e.match(b6);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;return j6(n,i)?r*(n*i_+i*n_):NaN}function A6(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const i=n.getUTCDay()||7,s=(t-1)*7+r+1-i;return n.setUTCDate(n.getUTCDate()+s),n}const O6=[31,null,31,30,31,30,31,31,30,31,30,31];function u_(e){return e%400===0||e%4===0&&e%100!==0}function N6(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(O6[t]||(u_(e)?29:28))}function F6(e,t){return t>=1&&t<=(u_(e)?366:365)}function P6(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function D6(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function j6(e,t){return t>=0&&t<=59}function R6(e,t){const r=it(e);return r.setDate(t),r}function of(e,t){return Ul(e,-1)}function I6(e,t){return a_(e,-1)}const M6={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},L6=(e,t,r)=>{let n;const i=M6[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?n+" ":n+" ":n},B6={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},U6={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},W6={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},z6={date:Aa({formats:B6,defaultWidth:"full"}),time:Aa({formats:U6,defaultWidth:"full"}),dateTime:Aa({formats:W6,defaultWidth:"full"})},H6={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},V6=(e,t,r,n)=>H6[e],$6={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},X6={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},Y6={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},G6={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},q6={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},K6={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},J6=(e,t)=>{const r=Number(e);switch(String(t==null?void 0:t.unit)){case"minute":case"second":return String(r);case"date":return r+"";default:return r+""}},Q6={ordinalNumber:J6,era:Rn({values:$6,defaultWidth:"wide"}),quarter:Rn({values:X6,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Rn({values:Y6,defaultWidth:"wide"}),day:Rn({values:G6,defaultWidth:"wide"}),dayPeriod:Rn({values:q6,defaultWidth:"wide",formattingValues:K6,defaultFormattingWidth:"wide"})},Z6=/^(\d+)(|)?/i,e8=/\d+/i,t8={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},r8={any:[/^(bc|)/i,/^(ad|)/i]},n8={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},i8={any:[/1/i,/2/i,/3/i,/4/i]},s8={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},a8={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},o8={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},l8={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},c8={any:/^(am|pm|||||||)/i},u8={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},f8={ordinalNumber:o_({matchPattern:Z6,parsePattern:e8,valueCallback:e=>parseInt(e,10)}),era:In({matchPatterns:t8,defaultMatchWidth:"wide",parsePatterns:r8,defaultParseWidth:"any"}),quarter:In({matchPatterns:n8,defaultMatchWidth:"wide",parsePatterns:i8,defaultParseWidth:"any",valueCallback:e=>e+1}),month:In({matchPatterns:s8,defaultMatchWidth:"wide",parsePatterns:a8,defaultParseWidth:"any"}),day:In({matchPatterns:o8,defaultMatchWidth:"wide",parsePatterns:l8,defaultParseWidth:"any"}),dayPeriod:In({matchPatterns:c8,defaultMatchWidth:"any",parsePatterns:u8,defaultParseWidth:"any"})},Ii={code:"ko",formatDistance:L6,formatLong:z6,formatRelative:V6,localize:Q6,match:f8,options:{weekStartsOn:0,firstWeekContainsDate:1}},h8=({onSave:e,onCancel:t})=>{const r=le.useRef(null),[n,i]=le.useState(!1),[s,l]=le.useState(!1);le.useEffect(()=>{const u=r.current;if(!u)return;const g=u.getContext("2d"),m=window.devicePixelRatio||1,p=u.getBoundingClientRect();u.width=p.width*m,u.height=p.height*m,g.scale(m,m),g.strokeStyle="black",g.lineWidth=10,g.lineCap="round"},[]);const o=u=>{const m=r.current.getBoundingClientRect(),p=u.touches?u.touches[0].clientX:u.clientX,x=u.touches?u.touches[0].clientY:u.clientY;return{x:p-m.left,y:x-m.top}},a=u=>{i(!0);const{x:g,y:m}=o(u),p=r.current.getContext("2d");p.strokeStyle="black",p.lineWidth=10,p.lineCap="round",p.beginPath(),p.moveTo(g,m)},c=u=>{if(!n)return;const{x:g,y:m}=o(u),p=r.current.getContext("2d");p.lineTo(g,m),p.stroke(),l(!0)},d=()=>{i(!1)},f=()=>{const u=r.current;u.getContext("2d").clearRect(0,0,u.width,u.height),l(!1)},h=()=>{if(!s){alert("  .");return}r.current.toBlob(g=>{e(g)},"image/png")};return w.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-fade-in",onClick:t,children:w.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden animate-spring-up",onClick:u=>u.stopPropagation(),children:[w.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[w.jsxs("h4",{className:"text-sm font-black text-[#1C1C1E] flex items-center gap-2",children:[w.jsx(b0,{className:"w-4 h-4 text-ios-indigo"}),"  "]}),w.jsx("button",{onClick:t,className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:w.jsx(ba,{className:"w-5 h-5"})})]}),w.jsxs("div",{className:"p-6 bg-white flex flex-col items-center gap-4",children:[w.jsx("p",{className:"text-xs text-ios-gray mb-2",children:"    ."}),w.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-xl bg-gray-50 touch-none overflow-hidden relative w-full h-[200px]",children:w.jsx("canvas",{ref:r,style:{width:"100%",height:"100%"},onMouseDown:a,onMouseMove:c,onMouseUp:d,onMouseLeave:d,onTouchStart:a,onTouchMove:c,onTouchEnd:d})})]}),w.jsxs("div",{className:"p-4 border-t border-gray-100 flex gap-3 bg-gray-50",children:[w.jsx("button",{onClick:f,className:"flex-1 py-3 bg-white border border-gray-200 text-[#1C1C1E] rounded-xl text-xs font-bold hover:bg-gray-50 transition-all",children:""}),w.jsxs("button",{onClick:h,className:"flex-[2] py-3 bg-[#1C1C1E] text-white rounded-xl text-xs font-bold hover:bg-gray-800 shadow-lg transition-all flex items-center justify-center gap-2",children:[w.jsx(Bi,{className:"w-4 h-4"}),"  "]})]})]})})},d8=()=>{const[e,t]=le.useState(new Date),[r,n]=le.useState([]),[i,s]=le.useState([]),[l,o]=le.useState(null),[a,c]=le.useState(!1),[d,f]=le.useState(null),[h,u]=le.useState([]),[g,m]=le.useState([]),[p,x]=le.useState([]),y=e.getMonth()+1<3?e.getFullYear()-1:e.getFullYear(),[_,b]=le.useState(null),[S,C]=le.useState(null),[N,F]=le.useState(null),[Y,X]=le.useState(!1),[V,te]=le.useState(null),[G,re]=le.useState(""),[Z,oe]=le.useState(!1);le.useEffect(()=>{D(),ee()},[]),le.useEffect(()=>{l&&E()},[y,l]),le.useEffect(()=>{l&&U()},[e,l]);const ee=async()=>{const{data:O}=await we.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});O&&O.length>0&&(s(O),o(O[0].id))},E=async()=>{const[O,B,M]=await Promise.all([we.from("operation_quarters").select("*").eq("academic_year",y).order("quarter",{ascending:!0}),we.from("operation_defaults").select("*"),we.from("operation_exceptions").select("*")]);O.data&&u(O.data),B.data&&m(B.data),M.data&&x(M.data)},D=async()=>{const{data:{user:O}}=await we.auth.getUser();if(O){const{data:B}=await we.from("profiles").select("*").eq("id",O.id).single();f({...O,profile:B})}},U=async()=>{if(!l)return;c(!0);const O=Ua(e).toISOString(),B=bl(e).toISOString(),{data:M,error:J}=await we.from("supervision_assignments").select("*").eq("zone_id",l).gte("date",O).lte("date",B).order("created_at",{ascending:!0});M&&n(M),c(!1)},k=async()=>{if(!G.trim()||!_||!l)return;const O=Be(_.date,"yyyy-MM-dd"),{error:B}=await we.from("supervision_assignments").insert([{date:O,supervisor_name:G.trim(),teacher_id:null,zone_id:l}]);B?alert("  : "+B.message):(re(""),b(null),U())},P=async()=>{if(!G.trim()||!S)return;const{error:O}=await we.from("supervision_assignments").update({supervisor_name:G.trim()}).eq("id",S.id);O?alert(" : "+O.message):(re(""),C(null),U())},A=O=>{if(!O)return null;const B=O.split("/signatures/");return B.length>1?B[1]:null},T=async(O,B)=>{if(B.stopPropagation(),!confirm(" ?   ."))return;const M=r.find(se=>se.id===O);if(M!=null&&M.signature_url){const se=A(M.signature_url);se&&await we.storage.from("signatures").remove([se])}const{error:J}=await we.from("supervision_assignments").delete().eq("id",O);J||U()},j=async O=>{if(!N)return;const B=r.find(ue=>ue.id===N.assignmentId);if(B!=null&&B.signature_url){const ue=A(B.signature_url);ue&&await we.storage.from("signatures").remove([ue])}const M=`sig_${N.assignmentId}_${Date.now()}.png`,{data:J,error:se}=await we.storage.from("signatures").upload(M,O,{contentType:"image/png",upsert:!0});if(se){alert("  : "+se.message);return}const{data:{publicUrl:H}}=we.storage.from("signatures").getPublicUrl(M),{error:ce}=await we.from("supervision_assignments").update({signature_url:H}).eq("id",N.assignmentId);ce?alert("  : "+ce.message):(F(null),U())},R=()=>{X(!0)},z=async O=>{if(!l)return;c(!0);const{data:B,error:M}=await we.from("supervision_assignments").select("*").eq("zone_id",l).gte("date",O.start_date).lte("date",O.end_date).order("date",{ascending:!0});if(M){alert("  : "+M.message),c(!1);return}te({quarter:O,assignments:B||[],defaults:g,exceptions:p}),X(!1),c(!1),setTimeout(()=>{window.print()},500)},I=()=>w.jsxs("div",{className:"flex items-center justify-between mb-6",children:[w.jsxs("div",{className:"flex items-center gap-6",children:[w.jsxs("div",{className:"flex items-center gap-4",children:[w.jsx("h3",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:Be(e,"yyyy M")}),w.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-xl border border-gray-200",children:[w.jsx("button",{onClick:()=>t(of(e)),className:"p-1.5 hover:bg-white rounded-lg text-ios-gray hover:text-[#1C1C1E] transition-all ios-tap shadow-sm hover:shadow",children:w.jsx(Ui,{className:"w-4 h-4"})}),w.jsx("button",{onClick:()=>t(Ul(e,1)),className:"p-1.5 hover:bg-white rounded-lg text-ios-gray hover:text-[#1C1C1E] transition-all ios-tap shadow-sm hover:shadow",children:w.jsx(ln,{className:"w-4 h-4"})})]})]}),w.jsx("div",{className:"flex bg-gray-100 p-1 rounded-xl border border-gray-200",children:i.map(O=>w.jsx("button",{onClick:()=>o(O.id),className:`px-4 py-1.5 rounded-lg text-xs font-black transition-all ios-tap ${l===O.id?"bg-white text-[#1C1C1E] shadow-sm":"text-ios-gray hover:text-[#1C1C1E]"}`,children:O.name},O.id))})]}),w.jsxs("div",{className:"flex items-center gap-4",children:[w.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group select-none",children:[w.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${Z?"bg-[#1C1C1E] border-[#1C1C1E]":"bg-white border-gray-300 group-hover:border-gray-400"}`,children:Z&&w.jsx(Bi,{className:"w-3 h-3 text-white"})}),w.jsx("input",{type:"checkbox",checked:Z,onChange:O=>oe(O.target.checked),className:"hidden"}),w.jsx("span",{className:"text-xs font-bold text-ios-gray group-hover:text-[#1C1C1E] transition-colors",children:" "})]}),w.jsxs("button",{onClick:R,className:"flex items-center gap-2 bg-[#1C1C1E] text-white px-4 py-2 rounded-lg font-bold text-xs transition-all shadow-lg hover:bg-gray-800 hover:shadow-xl ios-tap",children:[w.jsx(Op,{className:"w-3.5 h-3.5"}),"  "]})]})]}),L=()=>{const O=["","","","","","",""],B=Z?O:O.filter((M,J)=>J!==0&&J!==6);return w.jsx("div",{className:`grid ${Z?"grid-cols-7":"grid-cols-5"} mb-2 border-b border-gray-100`,children:B.map((M,J)=>w.jsx("div",{className:`py-3 text-[10px] font-black uppercase text-center tracking-widest ${Z&&J===0?"text-ios-rose":Z&&J===6?"text-ios-indigo":"text-ios-gray"}`,children:M},J))})},K=()=>{const O=Ua(e),B=bl(O),M=Un(O),J=Sl(B),se=zl({start:M,end:J});return w.jsx("div",{className:`grid ${Z?"grid-cols-7":"grid-cols-5"} gap-px bg-gray-100 border border-gray-100 rounded-[12px] overflow-hidden shadow-sm`,children:se.filter(H=>Z||H.getDay()!==0&&H.getDay()!==6).map((H,ce)=>{var gt;const ue=dg(H),xe=Td(H,O),_e=H.getDay(),fe=Be(H,"yyyy-MM-dd"),ve=r.filter(Ge=>Ge.date===fe),Ce=p.find(Ge=>Ge.exception_date===fe),De=h.find(Ge=>Ge.start_date&&Ge.end_date&&kl(H,{start:Et(Ge.start_date),end:Et(Ge.end_date)})),je=g.find(Ge=>Ge.day_of_week===_e),Ie=De&&!Ce&&((je==null?void 0:je.morning)||(je==null?void 0:je.dinner)||(je==null?void 0:je.period1)||(je==null?void 0:je.period2)),Ye=je&&!je.period1&&!je.period2,et=Ie?Ye?1:2:0,Le=((gt=d==null?void 0:d.profile)==null?void 0:gt.role)==="admin",ot=Le||ue;return w.jsxs("div",{className:`h-[200px] p-2 flex flex-col gap-2 transition-colors border-b border-r border-gray-100 ${xe?Ie?"bg-white":"bg-gray-50":"bg-gray-50/50 opacity-40"}`,children:[w.jsxs("div",{className:"flex justify-between items-start",children:[w.jsx("span",{className:`text-[12px] font-black ${ue?"w-6 h-6 text-ios-indigo border-2 border-ios-indigo rounded-full flex items-center justify-center -mt-1 -ml-1 bg-white":_e===0?"text-ios-rose":_e===6?"text-ios-indigo":"text-[#1C1C1E]"}`,children:Be(H,"d")}),Le&&Ie&&ve.length<et&&w.jsx("button",{onClick:()=>b({date:H}),className:"w-5 h-5 flex items-center justify-center rounded-full bg-[#1C1C1E] text-white hover:bg-gray-800 transition-all ios-tap shadow-sm",title:" ",children:w.jsx(el,{className:"w-3 h-3"})})]}),w.jsx("div",{className:"flex-1 flex flex-col gap-1.5 overflow-y-auto scrollbar-hide",children:ve.map(Ge=>{var Lr;return w.jsxs("div",{className:"relative group bg-gray-50 rounded-[8px] p-2 border border-dashed border-gray-200 hover:border-ios-indigo/30 transition-all",children:[w.jsxs("div",{className:"flex justify-between items-center mb-1",children:[w.jsx("span",{className:"text-[11px] font-bold text-[#1C1C1E]",children:Ge.supervisor_name}),Le&&w.jsxs("div",{className:"opacity-0 group-hover:opacity-100 flex items-center transition-opacity",children:[w.jsx("button",{onClick:hi=>{hi.stopPropagation(),re(Ge.supervisor_name),C({id:Ge.id,name:Ge.supervisor_name,date:H})},className:"p-1 text-gray-400 hover:text-ios-indigo transition-colors",title:" ",children:w.jsx(nk,{className:"w-3 h-3"})}),w.jsx("button",{onClick:hi=>T(Ge.id,hi),className:"p-1 text-gray-400 hover:text-ios-rose transition-colors",title:"",children:w.jsx(ji,{className:"w-3 h-3"})})]})]}),Ge.signature_url?w.jsxs("div",{className:"relative h-8 flex items-center",children:[w.jsx("img",{src:Ge.signature_url,alt:"",className:"h-full object-contain opacity-80"}),Le&&w.jsx("button",{onClick:()=>F({assignmentId:Ge.id}),className:"absolute inset-0 bg-black/5 opacity-0 hover:opacity-100 flex items-center justify-center text-[9px] text-[#1C1C1E] font-black rounded backdrop-blur-[1px]",children:""})]}):w.jsx("div",{className:"h-8 flex items-center justify-center",children:Le||((Lr=d==null?void 0:d.profile)==null?void 0:Lr.full_name)===Ge.supervisor_name&&ot?w.jsxs("button",{onClick:()=>F({assignmentId:Ge.id}),className:"w-full h-full border border-dashed border-ios-indigo/30 rounded flex items-center justify-center gap-1 text-[9px] text-ios-indigo font-bold hover:bg-ios-indigo/5 transition-colors",children:[w.jsx(b0,{className:"w-3 h-3"})," "]}):!ue&&y6(H)?w.jsx("span",{className:"text-[9px] text-red-500 font-bold",children:""}):w.jsx("span",{className:"text-[9px] text-gray-300 font-medium",children:" "})})]},Ge.id)})})]},ce)})})};return w.jsxs("div",{className:"h-full flex flex-col p-6 animate-spring-up overflow-hidden relative print:hidden",children:[w.jsxs("div",{className:"flex-none",children:[I(),L()]}),w.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide -mr-2 pr-2",children:K()}),_&&w.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm p-4 animate-fade-in",onClick:()=>b(null),children:w.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-xs overflow-hidden animate-spring-up",onClick:O=>O.stopPropagation(),children:[w.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[w.jsxs("h4",{className:"text-sm font-black text-[#1C1C1E]",children:[Be(_.date,"M d"),"  "]}),w.jsx("button",{onClick:()=>b(null),className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:w.jsx(ba,{className:"w-4 h-4"})})]}),w.jsxs("div",{className:"p-4 space-y-4",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-[10px] font-bold text-ios-gray uppercase tracking-wider mb-2",children:"  "}),w.jsx("input",{type:"text",value:G,onChange:O=>re(O.target.value),placeholder:" ",className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 text-sm font-bold text-[#1C1C1E] focus:outline-none focus:ring-2 focus:ring-ios-indigo/50 transition-all",onKeyDown:O=>O.key==="Enter"&&k(),autoFocus:!0})]}),w.jsx("button",{onClick:k,className:"w-full py-3 bg-[#1C1C1E] text-white rounded-xl text-xs font-bold hover:bg-gray-800 shadow-lg transition-all",children:""})]})]})}),S&&w.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm p-4 animate-fade-in",onClick:()=>C(null),children:w.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-xs overflow-hidden animate-spring-up",onClick:O=>O.stopPropagation(),children:[w.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[w.jsx("h4",{className:"text-sm font-black text-[#1C1C1E]",children:"  "}),w.jsx("button",{onClick:()=>C(null),className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:w.jsx(ba,{className:"w-4 h-4"})})]}),w.jsxs("div",{className:"p-4 space-y-4",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-[10px] font-bold text-ios-gray uppercase tracking-wider mb-2",children:" "}),w.jsx("input",{type:"text",value:G,onChange:O=>re(O.target.value),placeholder:" ",className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 text-sm font-bold text-[#1C1C1E] focus:outline-none focus:ring-2 focus:ring-ios-indigo/50 transition-all",onKeyDown:O=>O.key==="Enter"&&P(),autoFocus:!0})]}),w.jsx("button",{onClick:P,className:"w-full py-3 bg-[#1C1C1E] text-white rounded-xl text-xs font-bold hover:bg-gray-800 shadow-lg transition-all",children:" "})]})]})}),N&&w.jsx(h8,{onSave:j,onCancel:()=>F(null)}),Y&&w.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm p-4 animate-fade-in",onClick:()=>X(!1),children:w.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm overflow-hidden animate-spring-up",onClick:O=>O.stopPropagation(),children:[w.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[w.jsxs("h4",{className:"text-sm font-black text-[#1C1C1E] flex items-center gap-2",children:[w.jsx(Op,{className:"w-4 h-4 text-ios-indigo"}),"  "]}),w.jsx("button",{onClick:()=>X(!1),className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:w.jsx(ba,{className:"w-5 h-5"})})]}),w.jsxs("div",{className:"p-4 max-h-[60vh] overflow-y-auto",children:[w.jsx("p",{className:"text-xs text-ios-gray mb-4",children:" /  ."}),w.jsxs("div",{className:"grid gap-2",children:[h.map(O=>w.jsx("button",{onClick:()=>z(O),className:"w-full p-3 rounded-xl border border-gray-100 hover:border-ios-indigo/50 hover:bg-ios-indigo/5 transition-all text-left group",children:w.jsxs("span",{className:"text-sm font-bold text-[#1C1C1E] group-hover:text-ios-indigo",children:[O.quarter_name?`${O.quarter_name}: `:"",O.start_date," ~ ",O.end_date]})},O.id)),h.length===0&&w.jsx("div",{className:"text-center py-6 text-gray-300 text-xs",children:"   ."})]})]})]})}),V&&T1.createPortal(w.jsxs("div",{id:"print-root",className:"bg-white text-black hidden print:block",children:[w.jsx("style",{children:`
                            @media print {
                                @page { size: A4 portrait; margin: 0; }
                                body { 
                                    margin: 0 !important;
                                    padding: 0 !important;
                                    background-color: white !important;
                                    font-family: 'Malgun Gothic', 'Dotum', 'Apple SD Gothic Neo', sans-serif !important;
                                    -webkit-print-color-adjust: exact !important;
                                    print-color-adjust: exact !important;
                                    color: #000000 !important;
                                }
                                body > #root {
                                    display: none !important;
                                }
                                body > #print-root {
                                    display: block !important;
                                    width: 210mm !important;
                                    min-height: 297mm !important;
                                    padding: 10mm !important;
                                    box-sizing: border-box !important;
                                    background-color: white !important;
                                    font-family: 'Malgun Gothic', 'Dotum', 'Apple SD Gothic Neo', sans-serif !important;
                                }
                                /* Force solid borders */
                                * {
                                    border-color: #000000 !important;
                                    border-style: solid !important;
                                }
                                /* Ensure text is strictly black */
                                .print-text-black {
                                    color: #000000 !important;
                                }
                            }
                            #print-root {
                                display: none;
                            }
                        `}),w.jsxs("div",{className:"flex flex-col w-full h-full bg-white relative",children:[w.jsxs("div",{className:"flex-none mb-2 text-center",children:[w.jsx("h1",{className:"text-[20pt] font-black tracking-widest mb-1 underline decoration-2 underline-offset-4 text-black",children:"  "}),w.jsxs("div",{className:"flex justify-between items-end border-b-2 border-black pb-1 mb-1 relative",children:[w.jsxs("span",{className:"text-[9pt] font-bold text-black absolute left-0 bottom-1",children:[V.quarter.quarter_name," (",V.quarter.start_date," ~ ",V.quarter.end_date,")"]}),w.jsx("span",{className:"w-full text-center text-[8pt] text-transparent",children:"."}),w.jsxs("span",{className:"text-[8pt] text-black absolute right-0 bottom-1",children:[": ",Be(new Date,"yyyy. MM. dd.")]})]})]}),w.jsx("div",{className:"flex-1 flex gap-2 items-start justify-center w-full",children:(()=>{try{const O=Et(V.quarter.start_date),B=Et(V.quarter.end_date);return!Mc(O)||!Mc(B)?w.jsx("div",{className:"w-full text-center p-10 text-red-500 font-bold",children:"   ."}):yI({start:O,end:B}).map((M,J)=>{const se=Array.from({length:31},(H,ce)=>{const ue=ce+1;try{const xe=R6(M,ue);return!Mc(xe)||!Td(xe,M)?null:xe}catch{return null}});return w.jsx("div",{className:"flex-1 h-full flex flex-col min-w-0",children:w.jsxs("table",{className:"w-full border-collapse table-fixed border border-black",children:[w.jsxs("colgroup",{children:[w.jsx("col",{style:{width:"12%"}}),w.jsx("col",{style:{width:"22%"}}),w.jsx("col",{style:{width:"22%"}}),w.jsx("col",{style:{width:"22%"}}),w.jsx("col",{style:{width:"22%"}})]}),w.jsxs("thead",{children:[w.jsx("tr",{className:"bg-[#E5E7EB]",children:w.jsx("th",{colSpan:5,className:"border border-black text-center font-bold py-1 text-[10pt] text-black",children:Be(M,"M")})}),w.jsxs("tr",{className:"bg-[#F3F4F6] text-[7pt] text-black font-bold h-[8mm]",children:[w.jsx("th",{rowSpan:2,className:"border border-black text-center align-middle",children:""}),w.jsx("th",{colSpan:2,className:"border border-black text-center align-middle h-[4mm]",children:" 1"}),w.jsx("th",{colSpan:2,className:"border border-black text-center align-middle h-[4mm]",children:" 2"})]}),w.jsxs("tr",{className:"bg-[#F3F4F6] text-[7pt] text-black font-bold h-[4mm]",children:[w.jsx("th",{className:"border border-black text-center align-middle",children:""}),w.jsx("th",{className:"border border-black text-center align-middle",children:""}),w.jsx("th",{className:"border border-black text-center align-middle",children:""}),w.jsx("th",{className:"border border-black text-center align-middle",children:""})]})]}),w.jsx("tbody",{children:se.map((H,ce)=>{if(!H)return w.jsxs("tr",{className:"h-[7mm] bg-gray-100/30",children:[w.jsx("td",{className:"border border-black"}),w.jsx("td",{className:"border border-black"}),w.jsx("td",{className:"border border-black"}),w.jsx("td",{className:"border border-black"}),w.jsx("td",{className:"border border-black"})]},ce);const ue=Be(H,"yyyy-MM-dd"),xe=Be(H,"E",{locale:Ii}),_e=V.assignments.filter(Ye=>Ye.date===ue),fe=_e[0],ve=_e[1],Ce=V.defaults.find(Ye=>Ye.day_of_week===H.getDay()),De=V.exceptions.find(Ye=>Ye.exception_date===ue),Ie=kl(H,{start:Et(V.quarter.start_date),end:Et(V.quarter.end_date)})&&!De&&((Ce==null?void 0:Ce.morning)||(Ce==null?void 0:Ce.dinner)||(Ce==null?void 0:Ce.period1)||(Ce==null?void 0:Ce.period2));return w.jsxs("tr",{className:"h-[7mm] text-[7pt] text-black",children:[w.jsxs("td",{className:`border border-black text-center font-bold tracking-tighter align-middle p-0 ${xe===""?"text-blue-700":xe===""?"text-red-600":"text-black"}`,children:[Be(H,"d"),"(",xe,")"]}),w.jsx("td",{className:"border border-black text-center break-all align-middle p-0.5",children:Ie?(fe==null?void 0:fe.supervisor_name)||"":"-"}),w.jsx("td",{className:"border border-black text-center align-middle p-0.5",children:Ie&&(fe==null?void 0:fe.signature_url)&&w.jsx("img",{src:fe.signature_url,className:"max-h-[18px] w-auto mx-auto object-contain",alt:""})}),w.jsx("td",{className:"border border-black text-center break-all align-middle p-0.5",children:Ie&&(ve==null?void 0:ve.supervisor_name)||""}),w.jsx("td",{className:"border border-black text-center align-middle p-0.5",children:Ie&&(ve==null?void 0:ve.signature_url)&&w.jsx("img",{src:ve.signature_url,className:"max-h-[18px] w-auto mx-auto object-contain",alt:""})})]},ce)})})]})},J)})}catch{return w.jsx("div",{className:"w-full text-center text-red-500",children:"  "})}})()}),w.jsx("div",{className:"mt-2 text-center text-[9pt] font-bold flex-none text-black",children:"      .  "})]})]}),document.body)]})},g8=({onSave:e,onCancel:t,teacherName:r})=>{const n=le.useRef(null),[i,s]=le.useState(!1),[l,o]=le.useState(!1);le.useEffect(()=>{const u=n.current;if(!u)return;const g=u.getContext("2d"),m=window.devicePixelRatio||1,p=u.getBoundingClientRect();u.width=p.width*m,u.height=p.height*m,g.scale(m,m),g.strokeStyle="#1C1C1E",g.lineWidth=10,g.lineCap="round",g.lineJoin="round"},[]);const a=u=>{const m=n.current.getBoundingClientRect(),p=u.touches?u.touches[0].clientX:u.clientX,x=u.touches?u.touches[0].clientY:u.clientY;return{x:p-m.left,y:x-m.top}},c=u=>{s(!0);const{x:g,y:m}=a(u),p=n.current.getContext("2d");p.beginPath(),p.moveTo(g,m)},d=u=>{if(!i)return;const{x:g,y:m}=a(u),p=n.current.getContext("2d");p.lineTo(g,m),p.stroke(),o(!0)},f=()=>s(!1),h=()=>{if(!l)return alert("  .");n.current.toBlob(g=>e(g),"image/png")};return w.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-md flex flex-col justify-end",children:w.jsxs("div",{className:"bg-white rounded-t-[32px] p-6 mobile-slide-up h-[70vh]",children:[w.jsxs("div",{className:"flex justify-between items-center mb-8",children:[w.jsxs("div",{children:[w.jsxs("h2",{className:"text-2xl font-black text-[#1C1C1E]",children:[r,""]}),w.jsx("p",{className:"text-ios-gray text-sm font-bold",children:"     ."})]}),w.jsx("button",{onClick:t,className:"p-2 bg-gray-100 rounded-full",children:w.jsx($u,{className:"w-5 h-5 text-ios-gray"})})]}),w.jsx("div",{className:"mobile-signature-pad mb-8",children:w.jsx("canvas",{ref:n,style:{width:"100%",height:"100%"},onMouseDown:c,onMouseMove:d,onMouseUp:f,onMouseLeave:f,onTouchStart:c,onTouchMove:d,onTouchEnd:f})}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsx("button",{onClick:()=>{n.current.getContext("2d").clearRect(0,0,n.current.width,n.current.height),o(!1)},className:"py-4 bg-gray-100 text-[#1C1C1E] rounded-2xl font-black mobile-tap-feedback",children:" "}),w.jsx("button",{onClick:h,className:"py-4 bg-[#007AFF] text-white rounded-2xl font-black mobile-tap-feedback shadow-lg",children:" "})]})]})})},p8=({onLogout:e,currentUser:t})=>{const r=le.useRef(null),[n,i]=le.useState("menu"),[s,l]=le.useState(!0),[o,a]=le.useState([]),[c,d]=le.useState(null),[f,h]=le.useState(!1),[u,g]=le.useState([]),m={A:le.useRef(null),B:le.useRef(null),C:le.useRef(null)},[p,x]=le.useState([]),[v,y]=le.useState(null),[_,b]=le.useState([]),[S,C]=le.useState(null),[N,F]=le.useState(Be(new Date,"yyyy-MM-dd")),Y=Be(new Date,"yyyy-MM-dd");le.useEffect(()=>{X()},[]),le.useEffect(()=>{V()},[N]),le.useEffect(()=>{S&&te()},[S]),le.useEffect(()=>{v&&(n==="attendance"||n==="seatmap")&&G()},[v,n,N,S]);const X=async()=>{l(!0);const{data:T}=await we.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});T&&T.length>0&&(b(T),C(T[0].id)),V()},V=async()=>{const{data:T,error:j}=await we.from("supervision_assignments").select("*").eq("date",N);T&&a(T),l(!1)},te=async()=>{var j;if(!S)return;const{data:T}=await we.from("sessions").select("*").eq("zone_id",S).order("start_time",{ascending:!0});if(T){x(T);const R=Be(new Date,"HH:mm:ss"),z=T.find(I=>R>=I.start_time&&R<=I.end_time);y(z?z.id:(j=T[0])==null?void 0:j.id)}},G=async()=>{l(!0);const{data:T,error:j}=await we.from("seats").select("*, zone_color").order("seat_number",{ascending:!0});if(j){console.error("Error fetching seats:",j),l(!1);return}const{data:R,error:z}=await we.from("bookings").select(`
                id, seat_id, session_id,
                profiles (full_name, username, grade),
                attendance (id, status, timestamp_in, timestamp_out)
            `).eq("date",N);if(T){const I=T.map(L=>{var M,J,se,H;const K=(R||[]).find(ce=>ce.seat_id===L.id&&ce.session_id===v),O=(R||[]).some(ce=>ce.seat_id===L.id),B=(M=K==null?void 0:K.attendance)==null?void 0:M[0];return{seat_id:L.id,seat_number:L.seat_number,display_number:L.display_number,zone_name:L.zone_name,zone_color:L.zone_color,booking_id:K==null?void 0:K.id,full_name:(J=K==null?void 0:K.profiles)==null?void 0:J.full_name,username:(se=K==null?void 0:K.profiles)==null?void 0:se.username,grade:(H=K==null?void 0:K.profiles)==null?void 0:H.grade,attendance_id:B==null?void 0:B.id,status:(B==null?void 0:B.status)||"absent",timestamp_in:B==null?void 0:B.timestamp_in,timestamp_out:B==null?void 0:B.timestamp_out,is_active:!!K,is_booked_today:O}});I.sort((L,K)=>(L.seat_number||"").localeCompare(K.seat_number||"",void 0,{numeric:!0,sensitivity:"base"})),g(I)}l(!1)},re=async T=>{const j=`sig_duty_${c.id}_${Date.now()}.png`,{error:R}=await we.storage.from("signatures").upload(j,T,{contentType:"image/png"});if(R)return alert("  ");const{data:{publicUrl:z}}=we.storage.from("signatures").getPublicUrl(j),{error:I}=await we.from("supervision_assignments").update({signature_url:z}).eq("id",c.id);I||(h(!1),V())},Z=()=>{const T=new Date,j=9*60*60*1e3;return new Date(T.getTime()+j).toISOString().replace("Z","+09:00")},oe=async T=>{if(T.status!=="absent")return;const R={id:T.attendance_id,booking_id:T.booking_id,status:"present",updated_at:new Date().toISOString()};if(!T.timestamp_in){const L=p.find(K=>K.id===v);L?(R.timestamp_in=`${Y}T${L.start_time}+09:00`,R.status="present"):R.timestamp_in=Z()}const{data:z,error:I}=await we.from("attendance").upsert(R,{onConflict:"booking_id"}).select().single();!I&&z?g(L=>L.map(K=>K.booking_id===T.booking_id?{...K,status:z.status,attendance_id:z.id,timestamp_in:z.timestamp_in}:K)):G()},ee=async T=>{if(T.attendance_id)try{const{error:j}=await we.from("attendance").delete().eq("id",T.attendance_id);if(j)throw j;G()}catch(j){console.error("Error resetting attendance:",j)}},E=()=>{e&&e()},D=T=>{const j=new Date(N);j.setDate(j.getDate()+T),F(Be(j,"yyyy-MM-dd"))};le.useEffect(()=>{},[n]);const U=()=>{const T=_.find(B=>B.id===S),j=(T==null?void 0:T.name)||"";Be(new Date,"yyyy M d"),["","","","","","",""][new Date().getDay()];let R=`${j} `;n==="supervision"&&(R=" "),(n==="attendance"||n==="seatmap")&&(R=" ");const z=(T==null?void 0:T.code)||"A",I=(T==null?void 0:T.name)||"A ZONE",L=u.filter(B=>B.zone_name===I||B.zone_name===z||B.seat_number&&B.seat_number.startsWith(z)),K=L.filter(B=>B.status==="present").length,O=L.filter(B=>B.is_active&&(B.status==="absent"||!B.status)).length;return w.jsxs("header",{className:"mobile-header pb-3.5",children:[w.jsxs("div",{className:"flex justify-between items-center mb-5",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"p-2.5 bg-gray-50 rounded-full shadow-sm border border-gray-100/50",children:w.jsx(qS,{className:"w-5 h-5 text-gray-400",strokeWidth:2.5})}),w.jsx("h1",{className:"text-[20px] font-black text-[#1C1C1E] tracking-tight",children:R})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[n==="attendance"&&w.jsxs("button",{onClick:()=>i("seatmap"),className:"px-3.5 py-2.5 bg-[#F0F7FF] text-[#007AFF] rounded-xl active:scale-95 transition-all text-[13px] font-black flex items-center gap-2 border border-blue-50",children:[w.jsx(cu,{className:"w-4 h-4"}),""]}),n!=="menu"?w.jsx("button",{onClick:()=>i(n==="seatmap"?"attendance":"menu"),className:"px-4 py-2.5 bg-gray-50 text-[#8E8E93] rounded-xl active:scale-95 transition-all text-[13px] font-black border border-gray-100/50",children:n==="seatmap"?"":""}):w.jsx("button",{onClick:E,className:"p-2.5 bg-rose-50 text-[#FF3B30] rounded-full active:scale-95 transition-all border border-rose-100/50",children:w.jsx($u,{className:"w-5 h-5"})})]})]}),(n==="attendance"||n==="seatmap"||n==="supervision")&&w.jsxs("div",{className:"flex flex-col gap-5 animate-in fade-in slide-in-from-top-4 duration-300",children:[w.jsxs("div",{className:"flex gap-2 items-stretch",children:[w.jsx("div",{className:"flex-1 bg-[#1C1C1E] p-1 rounded-[6px] shadow-lg shadow-black/10 flex items-center justify-center min-h-[36px]",children:w.jsx("span",{className:"text-[12px] font-black text-white px-2",children:j})}),w.jsxs("div",{className:"flex-1 flex items-center justify-between bg-white px-2 rounded-[6px] border border-gray-100 shadow-sm min-h-[36px]",children:[w.jsx("button",{onClick:()=>D(-1),className:"w-8 h-8 flex items-center justify-center text-gray-300 active:text-[#1C1C1E] transition-colors",children:w.jsx(Ui,{className:"w-4 h-4"})}),w.jsxs("span",{className:"text-[11px] font-black text-[#1C1C1E] tracking-tight",children:[N," (",["","","","","","",""][new Date(N).getDay()],")"]}),w.jsx("button",{onClick:()=>D(1),className:"w-8 h-8 flex items-center justify-center text-gray-300 active:text-[#1C1C1E] transition-colors",children:w.jsx(ln,{className:"w-4 h-4"})})]})]}),(n==="attendance"||n==="seatmap")&&w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"flex bg-gray-50/50 p-1 rounded-xl border border-gray-100 overflow-x-auto scrollbar-hide",children:p.map(B=>w.jsx("button",{onClick:()=>y(B.id),className:`flex-1 px-3 py-2.5 rounded-lg text-xs font-black whitespace-nowrap transition-all ${v===B.id?"bg-white text-[#1C1C1E] shadow-sm":"text-gray-400"}`,children:B.name},B.id))}),w.jsxs("div",{className:"flex gap-3 h-20",children:[w.jsxs("div",{className:"flex-1 bg-blue-50/50 p-3 rounded-2xl border border-blue-100 flex flex-col justify-center items-center font-black",children:[w.jsx("span",{className:"text-[10px] text-[#007AFF] uppercase tracking-wider mb-1",children:" "}),w.jsxs("span",{className:"text-2xl text-[#007AFF]",children:[K,""]})]}),w.jsxs("div",{className:"flex-1 bg-rose-50/50 p-3 rounded-2xl border border-rose-100 flex flex-col justify-center items-center font-black",children:[w.jsx("span",{className:"text-[10px] text-[#FF3B30] uppercase tracking-wider mb-1",children:"/"}),w.jsxs("span",{className:"text-2xl text-[#FF3B30]",children:[O,""]})]})]})]})]})]})},k=()=>w.jsxs("div",{className:"mobile-menu-container",children:[w.jsxs("div",{className:"mobile-menu-grid",children:[w.jsxs("button",{onClick:()=>i("supervision"),className:"mobile-menu-btn",children:[w.jsx("div",{className:"mobile-menu-btn-icon bg-blue-50",children:w.jsx(b0,{className:"w-8 h-8 text-[#007AFF]"})}),w.jsx("span",{className:"mobile-menu-btn-text",children:" "})]}),w.jsxs("button",{onClick:()=>i("attendance"),className:"mobile-menu-btn",children:[w.jsx("div",{className:"mobile-menu-btn-icon bg-rose-50",children:w.jsx(Bi,{className:"w-8 h-8 text-[#FF3B30]"})}),w.jsx("span",{className:"mobile-menu-btn-text",children:" "})]})]}),Y&&w.jsx("div",{className:"text-center",children:w.jsxs("p",{className:"text-sm font-bold text-gray-400",children:[" ",Be(new Date,"yyyy M d")," ."]})})]}),P=()=>{const T=new Date,j=Be(T,"HH:mm:ss"),R=p.length>0?p.reduce((O,B)=>B.end_time>O?B.end_time:O,"00:00:00"):"23:59:59",z=Be(T,"yyyy-MM-dd"),I=N<z,L=N===z,K=(t==null?void 0:t.role)!=="admin"&&(I||L&&j>R);return w.jsx("main",{className:"flex-1 flex flex-col h-full overflow-hidden",style:{padding:"0 1rem 1rem 1rem"},children:w.jsxs("div",{className:"flex-1 flex flex-col gap-4 h-full overflow-y-auto pb-6 pt-2",children:[o.map((O,B)=>w.jsx("div",{className:"flex-1 min-h-[300px] bg-white rounded-[32px] p-6 border border-gray-100 shadow-sm flex flex-col items-center justify-center",children:w.jsxs("div",{className:"flex flex-col items-center gap-4 w-full",children:[w.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center shadow-inner",children:w.jsx(tl,{className:"w-8 h-8 text-[#8E8E93]"})}),w.jsxs("div",{className:"text-center",children:[w.jsxs("h3",{className:"text-lg font-black text-[#1C1C1E]",children:[O.supervisor_name," "]}),O.signature_url?w.jsxs("p",{className:"mt-1.5 text-xs font-bold text-emerald-500 flex items-center justify-center gap-1.5",children:[w.jsx(Bi,{className:"w-4 h-4"}),"   "]}):w.jsx("p",{className:"mt-1.5 text-xs font-bold text-[#FF9500]",children:"   "})]}),!O.signature_url&&(K?w.jsx("div",{className:"w-full py-5 bg-gray-50 text-gray-400 rounded-2xl text-center border border-gray-100",children:w.jsx("p",{className:"text-sm font-bold",children:"     ."})}):w.jsx("button",{onClick:()=>{d(O),h(!0)},className:"w-full py-5 bg-[#007AFF] text-white rounded-2xl text-base font-black mobile-tap-feedback shadow-lg shadow-blue-100",children:""})),O.signature_url&&w.jsx("div",{className:"w-full bg-gray-50 rounded-2xl p-4 flex items-center justify-center border border-dashed border-gray-200 min-h-[100px]",children:w.jsx("img",{src:O.signature_url,alt:"Signature",className:"max-h-16 opacity-60 object-contain"})})]})},O.id)),o.length===1&&w.jsx("div",{className:"flex-1 min-h-0 p-6 border border-transparent opacity-0 pointer-events-none"}),o.length===0&&w.jsx("div",{className:"flex-1 bg-white rounded-[32px] border border-dashed border-gray-200 text-gray-400 text-center flex items-center justify-center p-6",children:w.jsx("p",{className:"text-base font-bold",children:"    ."})})]})})},A=()=>w.jsxs("main",{className:"mobile-attendance-list",children:[w.jsx("div",{className:"mobile-zone-grid",children:["A","B","C"].map(T=>{var I;const j=`${T} zone`,R=u.filter(L=>L.zone_name===j||L.zone_name===T||L.seat_number&&L.seat_number.startsWith(T)),z=T==="A"?"#34C759":T==="B"?"#FF9500":"#FF3B30";return w.jsxs("div",{className:"zone-column",ref:m[T],children:[w.jsxs("div",{className:"zone-title-bar",style:{backgroundColor:((I=R[0])==null?void 0:I.zone_color)||z},children:[T," ZONE"]}),w.jsx("div",{className:"zone-divider"}),w.jsx("div",{className:"zone-seats-list",children:R.map(L=>{const K=L.is_active?"tier-active":L.is_booked_today?"tier-reserved":"tier-empty",O=L.zone_color||z,B=L.status==="present"?"green":"red";return w.jsxs("div",{className:`mobile-grid-card ${K}`,children:[w.jsxs("div",{className:"grid-card-header",style:{backgroundColor:O},children:[L.display_number||L.seat_number.replace(`${T}-`,""),L.is_active&&w.jsx("div",{className:`status-dot ${B}`})]}),w.jsx("div",{className:"grid-card-body",children:L.full_name?w.jsxs(w.Fragment,{children:[w.jsx("span",{className:"grid-card-student",children:L.full_name}),w.jsx("span",{className:"grid-card-id",children:L.username||" "})]}):w.jsx("span",{className:"grid-card-info text-gray-300",children:""})}),w.jsx("div",{className:"grid-card-footer",children:L.full_name?L.status==="absent"?w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"grid-status-btn status-absent-btn",children:""}),w.jsx("button",{className:"grid-action-btn",onClick:()=>oe(L),style:{backgroundColor:O},children:""})]}):w.jsxs(w.Fragment,{children:[w.jsx("div",{className:`grid-status-btn ${L.status==="present"?"status-present-active":L.status==="late"?"status-late-active":"status-early-active"}`,style:{backgroundColor:L.status==="present"?O:void 0},children:(()=>{const M=p.find(se=>se.id===v),J=Be(new Date,"HH:mm:ss");return L.status==="present"?M&&J>M.end_time?"":"":L.status==="late"?"":""})()}),w.jsx("button",{className:"grid-action-btn subtle",onClick:()=>ee(L),children:""})]}):w.jsx("div",{className:"grid-status-btn status-absent-btn opacity-20",children:"-"})})]},L.seat_id)})})]},T)})}),u.length===0&&!s&&w.jsxs("div",{className:"text-center py-12",children:[w.jsx(Ia,{className:"w-8 h-8 text-gray-200 mx-auto mb-2"}),w.jsx("p",{className:"text-xs text-gray-300 font-bold",children:"   ."})]})]});return w.jsxs("div",{className:"mobile-dashboard-container h-[100dvh] overflow-hidden flex flex-col",children:[U(),s&&w.jsx("div",{className:"flex-1 flex items-center justify-center",children:w.jsx("p",{className:"text-sm font-bold text-gray-400",children:" ..."})}),!s&&n==="menu"&&k(),!s&&n==="supervision"&&P(),!s&&n==="attendance"&&A(),!s&&n==="seatmap"&&w.jsx("div",{ref:r,className:"mobile-seatmap-container flex-1 scrollbar-hide bg-[#F2F2F7] relative overflow-auto",children:w.jsx("div",{className:"mobile-seatmap-content bg-white shadow-xl",children:w.jsx(t_,{isMobileView:!0,externalZoneId:S,externalDate:N,externalSessionId:v})})}),f&&w.jsx(g8,{teacherName:c==null?void 0:c.supervisor_name,onSave:re,onCancel:()=>h(!1)})]})},f_=({onSelectSeat:e,selectedProxyUser:t,viewDate:r,onDateChange:n,selectedZoneId:i,onZoneChange:s,minimal:l=!1})=>{const o=le.useRef(null),a=le.useRef(null),[c,d]=le.useState(null),[f,h]=le.useState([]),[u,g]=le.useState(!1),[m,p]=le.useState(null),[x,v]=le.useState([]),[y,_]=le.useState({quarters:[],defaults:[],exceptions:[]});le.useEffect(()=>{b()},[]);const b=async()=>{const{data:{user:X}}=await we.auth.getUser();if(X){const{data:te}=await we.from("profiles").select("*").eq("id",X.id).single();p(te)}const{data:V}=await we.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});V&&V.length>0&&(h(V),i||s(V[0].id))};le.useEffect(()=>{if(!i)return;let X=!0;return(async()=>{const[te,G,re]=await Promise.all([we.from("operation_quarters").select("*"),we.from("operation_defaults").select("*").eq("zone_id",i),we.from("operation_exceptions").select("*").eq("zone_id",i)]);X&&_({quarters:te.data||[],defaults:G.data||[],exceptions:re.data||[]});const{data:Z}=await we.from("sessions").select("*").eq("zone_id",i).order("start_time",{ascending:!0});if(!X||(v(Z||[]),!o.current))return;a.current&&a.current.dispose(),o.current.innerHTML="";const oe=document.createElement("canvas");o.current.appendChild(oe);const ee=new Ve.fabric.Canvas(oe,{backgroundColor:"transparent",selection:!1,hoverCursor:"pointer",moveCursor:"grab"});a.current=ee,await F(ee,Z),X&&(ee.on("mouse:down",E=>{var D,U,k,P;if(!E.target)ee.isDragging=!0,ee.selection=!1,ee.lastPosX=E.e.clientX||((U=(D=E.e.touches)==null?void 0:D[0])==null?void 0:U.clientX),ee.lastPosY=E.e.clientY||((P=(k=E.e.touches)==null?void 0:k[0])==null?void 0:P.clientY);else if(E.target.data){const A=E.target.data;d(A),e&&e(A),ee.getObjects().forEach(j=>{if(j.type==="group"){const R=j.getObjects().find(z=>z.name==="selectionBorder");R&&R.set({strokeWidth:0}),j.set("dirty",!0)}});const T=E.target.getObjects().find(j=>j.name==="selectionBorder");T&&T.set({strokeWidth:2}),E.target.set({dirty:!0,objectCaching:!1}),ee.renderAll()}else d(null),e&&e(null)}),ee.on("mouse:move",E=>{var D,U,k,P;if(ee.isDragging){const A=E.e,T=A.clientX||((U=(D=A.touches)==null?void 0:D[0])==null?void 0:U.clientX),j=A.clientY||((P=(k=A.touches)==null?void 0:k[0])==null?void 0:P.clientY),R=ee.viewportTransform;R[4]+=T-ee.lastPosX,R[5]+=j-ee.lastPosY,ee.requestRenderAll(),ee.lastPosX=T,ee.lastPosY=j}}),ee.on("mouse:wheel",E=>{var A;const D=E.e.deltaY,U=ee.viewportTransform;U[5]-=D;const k=ee.getHeight(),P=((A=o.current)==null?void 0:A.clientHeight)||0;U[5]>0&&(U[5]=0),P>0&&U[5]<-(k-P)&&(U[5]=-(k-P)),ee.requestRenderAll(),E.e.preventDefault(),E.e.stopPropagation()}),ee.on("mouse:up",()=>{ee.setViewportTransform(ee.viewportTransform),ee.isDragging=!1,ee.selection=!1}))})(),()=>{X=!1,a.current&&(a.current.dispose(),a.current=null)}},[i,m,r]);const S=X=>{const V=Et(X);if(!y.quarters.some(ee=>ee.start_date&&ee.end_date&&kl(V,{start:Et(ee.start_date),end:Et(ee.end_date)}))||y.exceptions.find(ee=>ee.exception_date===X))return!1;const re=V.getDay(),Z=y.defaults.find(ee=>ee.day_of_week===re);return!!(Z&&(Z.morning||Z.dinner||Z.period1||Z.period2))},C=()=>{let X=Ri(Et(r),1),V=!1,te=0;const G=180;for(;!V&&te<G;){const re=Be(X,"yyyy-MM-dd");S(re)?(n(re),V=!0):(X=Ri(X,1),te++)}},N=()=>{let X=Ed(Et(r),1),V=!1,te=0;const G=180;for(;!V&&te<G;){const re=Be(X,"yyyy-MM-dd");S(re)?(n(re),V=!0):(X=Ed(X,1),te++)}},F=async(X,V,te)=>{var Z,oe;g(!0);const{data:G}=await we.from("seats").select("*").eq("zone_id",i).order("global_number",{ascending:!0}),{data:re}=await we.from("bookings").select("*, profiles(username, full_name), sessions!inner(*)").eq("date",r).eq("sessions.zone_id",i);if(G&&G.length>0){if(!X||X.isDisposed||!X.getContext())return;X.clear();const ee=Math.min(...G.map(B=>B.pos_x)),D=Math.max(...G.map(B=>B.pos_x+(B.width||72)))-ee,U=((Z=o.current)==null?void 0:Z.clientWidth)||D,k=Math.max(D,U),P=Math.round((k-D)/2-ee),A=Math.min(...G.map(B=>B.pos_y)),j=Math.max(...G.map(B=>B.pos_y+(B.height||72)))-A,R=Math.round(-A),z=((oe=o.current)==null?void 0:oe.clientHeight)||0,I=Math.max(j,z);if(X.isDisposed||!X.getContext())return;X.setDimensions({width:k,height:I});const L=new Date,K=L.getHours().toString().padStart(2,"0")+":"+L.getMinutes().toString().padStart(2,"0")+":00",O=V==null?void 0:V.find(B=>K>=B.start_time&&K<=B.end_time);G.forEach(B=>{const M=(re==null?void 0:re.filter(J=>J.seat_id===B.id))||[];Y(X,{...B,pos_x:B.pos_x+P,pos_y:B.pos_y+R},M,O,V)})}g(!1)},Y=(X,V,te,G,re)=>{if(V.type==="structure"){const L=new Ve.fabric.Rect({fill:"#E5E5EA",width:V.width||72,height:V.height||72,rx:6,ry:6,stroke:"#D1D1D6",strokeWidth:1}),K=new Ve.fabric.IText(V.label||"",{fontSize:10,originX:"center",originY:"center",left:(V.width||72)/2,top:(V.height||72)/2,fill:"#AEAEB2",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),O=new Ve.fabric.Group([L,K],{left:V.pos_x,top:V.pos_y,angle:V.rotation,selectable:!1,evented:!1,data:{...V}});X.add(O);return}const oe=!!te.find(L=>L.session_id===(G==null?void 0:G.id)),ee=te.length>0,E=L=>m?!!(["admin","teacher"].includes(m.role)||L.user_id===m.id):!1,D=V.zone_color||"#5E5CE6",U=new Ve.fabric.Rect({fill:D,opacity:oe?.8:ee?.1:.02,width:72,height:72,rx:6,ry:6,strokeWidth:0,left:0,top:0,originX:"left",originY:"top",selectable:!1}),k=new Ve.fabric.Path("M 0 6 Q 0 0 6 0 L 66 0 Q 72 0 72 6 L 72 18 L 0 18 z",{fill:D,opacity:oe?1:ee?.4:.15,strokeWidth:0,left:0,top:0,originX:"left",originY:"top",selectable:!1}),P=new Ve.fabric.IText(V.display_number||V.seat_number,{fontSize:11,left:6,top:4,originX:"left",originY:"top",fill:oe?"#ffffff":D,fontFamily:"Inter, -apple-system",fontWeight:"900",selectable:!1}),A={Morning:"",Dinner:"","1st Period":"1 ","2nd Period":"2 "},T=[...re||[]].sort((L,K)=>L.id-K.id),j=T.length>4;let R=[];if(j){const L=Math.ceil(T.length/2),K=T.slice(0,L),O=T.slice(L),B=se=>se.map(H=>{const ce=te.find(xe=>xe.session_id===H.id),ue=A[H.name]||H.name.substring(0,2);return ce?E(ce)?`${ue}:${ce.profiles.full_name.substring(0,4)}`:`${ue}:`:`${ue}:`}).join(`
`),M=new Ve.fabric.Text(B(K),{fontSize:5.5,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:oe?"#ffffff":"#000000",left:4,top:20,lineHeight:1.35,selectable:!1}),J=new Ve.fabric.Text(B(O),{fontSize:5.5,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:oe?"#ffffff":"#000000",left:38,top:20,lineHeight:1.35,selectable:!1});R=[M,J]}else T.forEach((L,K)=>{const O=te.find(ue=>ue.session_id===L.id),B=A[L.name]||L.name.substring(0,2),M=21+K*13,J=new Ve.fabric.Text(B,{fontSize:8,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:oe?"#ffffff":"#000000",left:4,top:M+.5,originX:"left",originY:"top",selectable:!1});R.push(J);const se=new Ve.fabric.Line([17,M,17,M+10],{stroke:oe?"rgba(255,255,255,0.3)":"rgba(0,0,0,0.1)",strokeWidth:.5,originX:"left",originY:"top",selectable:!1});R.push(se);let H="";if(O)if(E(O)){const ue=O.profiles.username||"",xe=O.profiles.full_name||"";H=ue?`${ue} ${xe}`:xe}else H="";const ce=new Ve.fabric.Text(H,{fontSize:8,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:oe?"#ffffff":"#000000",left:23,top:M,originX:"left",originY:"top",selectable:!1});if(R.push(ce),K<T.length-1){const ue=new Ve.fabric.Line([4,M+11.5,68,M+11.5],{stroke:oe?"rgba(255,255,255,0.2)":"rgba(0,0,0,0.08)",strokeWidth:.5,originX:"left",originY:"top",selectable:!1});R.push(ue)}});const z=new Ve.fabric.Rect({width:74,height:74,rx:8,ry:8,fill:"transparent",stroke:D,strokeWidth:0,left:-2,top:-2,originX:"left",originY:"top",selectable:!1,name:"selectionBorder",strokeUniform:!0}),I=new Ve.fabric.Group([U,k,P,...R,z],{left:V.pos_x,top:V.pos_y,originX:"left",originY:"top",angle:V.rotation,data:{...V,seatBookings:te,activeSession:G},selectable:!1,hoverCursor:"pointer"});X.add(I)};return w.jsxs("div",{className:"flex flex-col gap-4 w-full h-full relative overflow-hidden",children:[!l&&w.jsxs("div",{className:"flex items-center gap-4 px-1",children:[w.jsx("div",{className:"flex gap-[10px] m-[10px] mb-0 border-none shrink-0",children:f.map(X=>w.jsx("button",{onClick:()=>s(X.id),className:`px-6 py-2 rounded-lg text-xs font-black transition-all ios-tap border-none outline-none ring-0 ${i===X.id?"bg-[#1C1C1E] text-white shadow-md":"bg-gray-100 text-ios-gray hover:bg-gray-200"}`,children:X.name},X.id))}),w.jsxs("div",{className:"flex items-center gap-2 text-ios-gray",children:[w.jsx(O1,{className:"w-3.5 h-3.5"}),w.jsx("span",{className:"text-[10px] font-bold",children:"     ."})]}),w.jsxs("div",{className:"flex bg-gray-50 p-1 rounded-full border border-gray-100 items-center gap-1 ml-auto",children:[w.jsx("button",{onClick:N,className:"p-1.5 hover:bg-white rounded-full transition-all text-ios-gray hover:text-[#1C1C1E] ios-tap",children:w.jsx(Ui,{className:"w-4 h-4"})}),w.jsxs("div",{className:"relative group px-2 flex items-center gap-2 cursor-pointer",children:[w.jsx(Nl,{className:"w-4 h-4 text-ios-indigo"}),w.jsx("span",{className:"text-[14px] font-black text-[#1C1C1E] whitespace-nowrap",children:Be(Et(r),"yyyy-MM-dd (EEE)",{locale:Ii})}),w.jsx("input",{type:"date",value:r,onChange:X=>n(X.target.value),className:"absolute inset-0 opacity-0 cursor-pointer"})]}),w.jsx("button",{onClick:C,className:"p-1.5 hover:bg-white rounded-full transition-all text-ios-gray hover:text-[#1C1C1E] ios-tap",children:w.jsx(ln,{className:"w-4 h-4"})})]})]}),u&&w.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-30 flex items-center justify-center",children:w.jsx("div",{className:"w-8 h-8 border-3 border-ios-indigo border-t-transparent rounded-full animate-spin"})}),w.jsx("div",{ref:o,className:"flex-1 h-full relative overflow-hidden cursor-grab active:cursor-grabbing touch-none select-none scrollbar-hide"})]})},m8=({isOpen:e,onClose:t,zoneId:r,onSelect:n})=>e?w.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:w.jsxs("div",{className:"bg-white w-full h-[80vh] rounded-3xl overflow-hidden flex flex-col shadow-2xl relative",children:[w.jsx("button",{onClick:t,className:"absolute top-4 right-4 z-50 p-2 bg-white/90 backdrop-blur rounded-full shadow-lg text-black hover:bg-gray-100 transition-all border border-gray-100",children:w.jsx(ba,{className:"w-6 h-6"})}),w.jsx("div",{className:"flex-1 bg-gray-50 relative overflow-hidden",children:w.jsx(f_,{viewDate:Be(new Date,"yyyy-MM-dd"),selectedZoneId:r,onDateChange:()=>{},onZoneChange:()=>{},isReadOnly:!0,minimal:!0,onSelectSeat:n})})]})}):null,x8=({onCancel:e,onSuccess:t,currentUser:r})=>{const[n,i]=le.useState(0),[s,l]=le.useState(!1),[o,a]=le.useState([]),[c,d]=le.useState([]),[f,h]=le.useState([]),[u,g]=le.useState(null),[m,p]=le.useState([]),[x,v]=le.useState(null),[y,_]=le.useState(""),[b,S]=le.useState("A"),[C,N]=le.useState(""),F=B=>{if(!B)return"";const M=B.seat_number.toString(),J=B.zone_name||"";return J&&M.startsWith(`${J}-`)?M.replace(`${J}-`,""):J&&M.startsWith(J)?M.replace(J,""):M},[Y,X]=le.useState([]),[V,te]=le.useState([]),[G,re]=le.useState([]),[Z,oe]=le.useState(!1);le.useEffect(()=>{(async()=>{l(!0);try{const{data:M}=await we.from("operation_quarters").select("*").order("start_date");a(M||[]);const{data:J}=await we.from("zones").select("*").order("created_at");h(J||[]);let se=null;J&&J.length>0&&(se=J[0].id,v(se))}catch(M){console.error("Error fetching wizard configs:",M)}finally{l(!1)}})()},[]),le.useEffect(()=>{if(!x)return;(async()=>{l(!0);try{const[M,J,se,H]=await Promise.all([we.from("sessions").select("*").eq("zone_id",x).order("start_time"),we.from("operation_defaults").select("*").eq("zone_id",x),we.from("operation_exceptions").select("*").eq("zone_id",x),we.from("seats").select("*").eq("zone_id",x).order("global_number")]);d(M.data||[]),X(J.data||[]),te(se.data||[]),re(H.data||[]);const ce=H.data||[];if(ce.length>0){const ue=ce[0].zone_name||"";S(ue)}p([]),_("")}catch(M){console.error("Error fetching zone data:",M)}finally{l(!1)}})()},[x]);const ee=B=>{const M=Kn(new Date),J=Kn(B),se=Ri(M,2);if(Lc(J,se))return!1;const H=o.find(Ce=>{const De=Et(Ce.start_date),je=Et(Ce.end_date);return(ys(J,De)||v6(J,De))&&(ys(J,je)||Lc(J,je))});if(!H)return!1;const ce=Et(H.start_date),ue=Ed(ce,7);if(Lc(M,ue))return!1;const xe=Be(J,"yyyy-MM-dd"),_e=V.find(Ce=>Ce.exception_date===xe);if(_e&&_e.is_closed)return!1;const fe=J.getDay(),ve=Y.find(Ce=>Ce.day_of_week===fe);return!(!ve||!ve.morning&&!ve.dinner&&!ve.period1&&!ve.period2)},[E,D]=le.useState(new Date),U=()=>D(B=>of(B)),k=()=>D(B=>Ul(B,1)),P=()=>{const B=Kn(new Date(E.getFullYear(),E.getMonth(),1)),M=new Date(E.getFullYear(),E.getMonth()+1,0),se=Kn(B).getDay(),H=Array(se).fill(null),ce=[];for(let xe=1;xe<=M.getDate();xe++)ce.push(new Date(E.getFullYear(),E.getMonth(),xe));const ue=[...H,...ce];return w.jsxs("div",{className:"space-y-4 animate-fade-in",children:[w.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:" "}),w.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"  ."}),w.jsxs("div",{className:"flex items-center justify-between bg-white rounded-2xl p-2 shadow-sm border border-gray-100 mb-4",children:[w.jsx("button",{onClick:U,className:"p-2 hover:bg-gray-100 rounded-full text-ios-gray hover:text-black transition-colors",children:w.jsx(Ui,{className:"w-5 h-5"})}),w.jsx("span",{className:"text-base font-black text-[#1C1C1E]",children:Be(E,"yyyy M")}),w.jsx("button",{onClick:k,className:"p-2 hover:bg-gray-100 rounded-full text-ios-gray hover:text-black transition-colors",children:w.jsx(ln,{className:"w-5 h-5"})})]}),w.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["","","","","","",""].map(xe=>w.jsx("div",{className:"text-center text-xs font-bold text-gray-400 py-2",children:xe},xe)),ue.map((xe,_e)=>{if(!xe)return w.jsx("div",{},`empty-${_e}`);const fe=ee(xe),ve=u&&ys(xe,u);return w.jsxs("button",{disabled:!fe,onClick:()=>g(xe),className:`
                                aspect-square rounded-xl flex flex-col items-center justify-center text-sm font-bold transition-all relative
                                ${ve?"bg-[#1C1C1E] text-white shadow-lg scale-105 z-10":fe?"bg-white text-[#1C1C1E] border border-gray-100 hover:border-gray-300":"bg-transparent text-gray-400 cursor-not-allowed"}
                            `,children:[w.jsx("span",{className:fe?"":"opacity-50",children:Be(xe,"d")}),fe&&w.jsx("span",{className:"w-1 h-1 rounded-full bg-ios-indigo absolute bottom-2"})]},_e)})]})]})},A=()=>{const B=M=>{m.includes(M)?p(m.filter(J=>J!==M)):p([...m,M])};return w.jsxs("div",{className:"space-y-4 animate-fade-in",children:[w.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:" "}),w.jsxs("p",{className:"text-sm font-bold text-ios-gray",children:["   .",w.jsx("br",{}),"(  )"]}),w.jsx("div",{className:"space-y-3 mt-4",children:c.filter(M=>{if(!u)return!1;const J=u.getDay(),se=Y.find(ce=>ce.day_of_week===J);if(!se)return!1;const H=M.name.toLowerCase();return H.includes("morning")||H.includes("")||H.includes("")?se.morning:H.includes("dinner")||H.includes("")||H.includes("")?se.dinner:H.includes("1st")||H.includes("1")||H.includes("period1")?se.period1:H.includes("2nd")||H.includes("2")||H.includes("period2")?se.period2:!1}).map(M=>{const J=m.includes(M.id);return w.jsxs("button",{onClick:()=>B(M.id),className:`w-full p-4 rounded-2xl border-2 transition-all flex items-center justify-between group text-left ios-tap
                                ${J?"border-ios-indigo bg-ios-indigo/5":"border-white bg-white shadow-sm"}
                            `,children:[w.jsxs("div",{children:[w.jsx("h4",{className:`text-base font-black ${J?"text-ios-indigo":"text-[#1C1C1E]"}`,children:M.name}),w.jsxs("p",{className:"text-xs font-bold text-ios-gray mt-1",children:[M.start_time.slice(0,5)," ~ ",M.end_time.slice(0,5)]})]}),w.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors
                                ${J?"border-ios-indigo bg-ios-indigo text-white":"border-gray-200 bg-gray-50"}
                            `,children:J&&w.jsx(_a,{className:"w-4 h-4"})})]},M.id)})})]})},T=()=>w.jsxs("div",{className:"space-y-4 animate-fade-in",children:[w.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:"  "}),w.jsx("p",{className:"text-sm font-bold text-ios-gray",children:" (Zone) ."}),w.jsx("div",{className:"space-y-3 mt-4",children:f.map(B=>{const M=x===B.id;return w.jsxs("button",{onClick:()=>v(B.id),className:`w-full p-5 rounded-2xl border-2 transition-all flex items-center justify-between text-left ios-tap
                                ${M?"border-ios-indigo bg-ios-indigo/5":"border-white bg-white shadow-sm"}
                            `,children:[w.jsx("span",{className:`text-lg font-black ${M?"text-ios-indigo":"text-[#1C1C1E]"}`,children:B.name}),M&&w.jsx("div",{className:"text-xs font-bold text-ios-indigo bg-ios-indigo/10 px-2 py-1 rounded",children:""})]},B.id)})})]}),j=()=>{var ce,ue;const M=(()=>{if(!G||G.length===0)return[];const xe=new Set;return G.forEach(_e=>{xe.add(_e.zone_name||"")}),Array.from(xe).sort()})(),J=xe=>{if(M.length===0)return;let _e=M.indexOf(b);_e===-1&&(_e=0);let fe;xe==="up"?fe=(_e+1)%M.length:fe=(_e-1+M.length)%M.length;const ve=M[fe];S(ve);const Ce=G.find(De=>(De.zone_name||"")===ve);_(Ce?F(Ce):"")},se=xe=>{if(!G||G.length===0)return;const _e=b||M[0],fe=G.filter(Ie=>(Ie.zone_name||"")===_e);if(fe.length===0)return;const ve=[...fe].sort((Ie,Ye)=>{const et=parseInt(Ie.seat_number.toString().replace(/\D/g,""))||0,Le=parseInt(Ye.seat_number.toString().replace(/\D/g,""))||0;return et-Le}),Ce=ve.find(Ie=>F(Ie)===y.toString());let De=0;if(Ce){const Ie=ve.indexOf(Ce);xe==="up"?De=(Ie+1)%ve.length:De=(Ie-1+ve.length)%ve.length}else De=0;const je=ve[De];_(F(je))},H=b||(M.length>0?M[0]:"-");return w.jsxs("div",{className:"space-y-4 animate-fade-in",children:[w.jsxs("h3",{className:"text-xl font-black text-[#1C1C1E]",children:[(ce=f.find(xe=>xe.id===x))==null?void 0:ce.name,"  "]}),w.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"(Section)    ."}),w.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-gray-100 mt-4",children:[w.jsxs("div",{className:"flex gap-4",children:[w.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2",children:[w.jsx("label",{className:"text-xs font-black text-ios-gray uppercase tracking-widest",children:" (Section)"}),w.jsx("button",{onClick:()=>J("up"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:w.jsx(Ap,{className:"w-6 h-6"})}),w.jsx("div",{className:"h-16 flex items-center justify-center",children:w.jsx("span",{className:"text-5xl font-black text-[#1C1C1E] text-center leading-tight",children:H})}),w.jsx("button",{onClick:()=>J("down"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:w.jsx(Ep,{className:"w-6 h-6"})})]}),w.jsx("div",{className:"w-px bg-gray-100 my-4"}),w.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2",children:[w.jsx("label",{className:"text-xs font-black text-ios-gray uppercase tracking-widest",children:" (No.)"}),w.jsx("button",{onClick:()=>se("up"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:w.jsx(Ap,{className:"w-6 h-6"})}),w.jsx("div",{className:"h-16 flex items-center justify-center w-full",children:w.jsx("input",{type:"text",value:y,onChange:xe=>_(xe.target.value),placeholder:"-",className:"w-full text-5xl font-black text-center border-none focus:ring-0 outline-none bg-transparent text-[#1C1C1E] p-0"})}),w.jsx("button",{onClick:()=>se("down"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:w.jsx(Ep,{className:"w-6 h-6"})})]})]}),w.jsx("div",{className:"border-t border-gray-100 pt-6 mt-2",children:w.jsxs("button",{onClick:()=>oe(!0),className:"w-full py-4 rounded-xl bg-gray-50 hover:bg-gray-100 text-[#1C1C1E] font-bold text-sm flex items-center justify-center gap-2 transition-all border border-gray-200",children:[w.jsx(Cs,{className:"w-4 h-4"}),"  "]})})]}),y&&w.jsxs("div",{className:"flex items-center gap-2 justify-center text-ios-indigo text-xs font-bold animate-fade-in",children:[w.jsx(_a,{className:"w-3 h-3"}),(ue=f.find(xe=>xe.id===x))==null?void 0:ue.name," ",H!==""?`${H}`:""," - ",y,""]})]})},R=()=>w.jsxs("div",{className:"space-y-4 animate-fade-in",children:[w.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:" "}),w.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"       ."}),w.jsx("textarea",{value:C,onChange:B=>N(B.target.value),placeholder:":   2 ,   50  ",className:"w-full h-48 bg-white border border-gray-200 rounded-2xl p-5 text-base font-medium resize-none focus:ring-2 focus:ring-ios-indigo/20 outline-none transition-all shadow-sm"})]}),z=()=>{var se;const B=u?Be(u,"M d (EEE)",{locale:Ii}):"",M=(se=f.find(H=>H.id===x))==null?void 0:se.name,J=c.filter(H=>m.includes(H.id)).map(H=>H.name).join(", ");return w.jsxs("div",{className:"space-y-6 animate-fade-in",children:[w.jsx("h3",{className:"text-xl font-black text-[#1C1C1E] text-center",children:"  "}),w.jsx("div",{className:"bg-white rounded-3xl shadow-[0_4px_20px_rgba(0,0,0,0.03)] border border-gray-100 overflow-hidden",children:w.jsxs("div",{className:"p-6 space-y-6",children:[w.jsxs("div",{className:"flex items-start gap-4",children:[w.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-indigo/10 flex items-center justify-center shrink-0",children:w.jsx(Nl,{className:"w-5 h-5 text-ios-indigo"})}),w.jsxs("div",{children:[w.jsx("p",{className:"text-xs font-bold text-ios-gray",children:""}),w.jsx("p",{className:"text-lg font-black text-[#1C1C1E]",children:B})]})]}),w.jsxs("div",{className:"flex items-start gap-4",children:[w.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-rose/10 flex items-center justify-center shrink-0",children:w.jsx(Ia,{className:"w-5 h-5 text-ios-rose"})}),w.jsxs("div",{children:[w.jsx("p",{className:"text-xs font-bold text-ios-gray",children:""}),w.jsx("p",{className:"text-lg font-black text-[#1C1C1E]",children:J})]})]}),w.jsxs("div",{className:"flex items-start gap-4",children:[w.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-emerald/10 flex items-center justify-center shrink-0",children:w.jsx(Cs,{className:"w-5 h-5 text-ios-emerald"})}),w.jsxs("div",{children:[w.jsx("p",{className:"text-xs font-bold text-ios-gray",children:""}),w.jsx("p",{className:"text-lg font-black text-[#1C1C1E]",children:M}),w.jsxs("p",{className:"text-base font-bold text-ios-indigo mt-0.5",children:[y," "]})]})]}),w.jsxs("div",{className:"flex items-start gap-4 border-t border-gray-50 pt-4",children:[w.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-amber/10 flex items-center justify-center shrink-0",children:w.jsx(A1,{className:"w-5 h-5 text-ios-amber"})}),w.jsxs("div",{children:[w.jsx("p",{className:"text-xs font-bold text-ios-gray",children:" "}),w.jsx("p",{className:"text-sm font-medium text-[#1C1C1E] leading-relaxed line-clamp-3",children:C||" "})]})]})]})}),w.jsx("div",{className:"text-center",children:w.jsx("p",{className:"text-xs text-red-400 font-bold mb-2",children:"*      ."})})]})},I=()=>{switch(n){case 0:return!!u;case 1:return!!x;case 2:return!!y;case 3:return m.length>0;case 4:return!!C.trim();default:return!0}},L=()=>{n<5&&I()&&i(B=>B+1)},K=()=>{n>0?i(B=>B-1):e()},O=async()=>{if(!s){l(!0);try{const B=Be(u,"yyyy-MM-dd");let M=null;if(G&&G.length>0){const ue=G.find(xe=>{const _e=xe.zone_name||"",fe=F(xe);return _e===b&&fe===y.toString()});ue&&(M=ue.id)}if(!M){alert("    .   ."),l(!1);return}const J=m.map(ue=>({user_id:r.id,seat_id:M,date:B,session_id:ue,booking_type:"regular"})),{error:se}=await we.from("bookings").insert(J);if(se)throw se;const H=m.map(ue=>({user_id:r.id,date:B,session_id:ue,content:C})),{error:ce}=await we.from("study_plans").insert(H);alert("  !"),t()}catch(B){console.error("Booking failed:",B),alert(`  .    .
`+B.message)}finally{l(!1)}}};return w.jsxs("div",{className:"flex flex-col h-full bg-[#F2F2F7]",children:[w.jsxs("div",{className:"flex-none px-6 py-4 flex items-center justify-between bg-white/80 backdrop-blur border-b border-gray-200",children:[w.jsx("button",{onClick:K,className:"p-2 -ml-2 rounded-full hover:bg-gray-100 text-ios-gray hover:text-[#1C1C1E] transition-colors",children:w.jsx(Ui,{className:"w-6 h-6"})}),w.jsxs("span",{className:"text-base font-black text-[#1C1C1E]",children:[" (",n+1,"/6)"]}),w.jsx("div",{className:"w-10"})," "]}),w.jsx("div",{className:"flex-1 overflow-y-auto p-6 pb-32",children:w.jsxs("div",{className:"max-w-md mx-auto",children:[n===0&&P(),n===1&&T(),n===2&&j(),n===3&&A(),n===4&&R(),n===5&&z()]})}),w.jsx("div",{className:"flex-none p-6 bg-white border-t border-gray-100 pb-[max(1.5rem,env(safe-area-inset-bottom))]",children:w.jsx("button",{onClick:n===5?O:L,disabled:!I()||s,className:`w-full py-4 rounded-2xl font-black text-base flex items-center justify-center gap-2 transition-all shadow-lg ios-tap
                    ${I()&&!s?"bg-[#1C1C1E] text-white hover:bg-gray-800":"bg-gray-200 text-gray-400 cursor-not-allowed shadow-none"}
                `,children:s?w.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):n===5?w.jsxs(w.Fragment,{children:[w.jsx(_a,{className:"w-5 h-5"}),"  "]}):w.jsxs(w.Fragment,{children:["  ",w.jsx(ln,{className:"w-5 h-5"})]})})}),w.jsx(m8,{isOpen:Z,zoneId:x,onClose:()=>oe(!1),onSelect:B=>{if(B){const M=B.zone_name||"";S(M);const J=F(B);_(J),oe(!1)}}})]})},h_=({user:e})=>{const[t,r]=le.useState("idle"),[n,i]=le.useState(""),s=()=>{const o=new Date,a=9*60*60*1e3;return new Date(o.getTime()+a).toISOString().replace("Z","+09:00")},l=async()=>{if(r("locating"),i("Verifying your location..."),!navigator.geolocation){r("error"),i("Geolocation is not supported by your browser.");return}navigator.geolocation.getCurrentPosition(async o=>{const{latitude:a,longitude:c,accuracy:d}=o.coords,{data:f}=await we.from("sessions").select("*");if(!f){r("error"),i("     .");return}const h=new Date,u=h.getHours().toString().padStart(2,"0")+":"+h.getMinutes().toString().padStart(2,"0")+":00",g=f.find(C=>u>=C.start_time&&u<=C.end_time);if(!g){i("     ."),r("error");return}const{data:m}=await we.from("zones").select("settings").eq("id",g.zone_id).single(),p=(m==null?void 0:m.settings)||{},x=p.points||[{lat:p.latitude||37.5665,lng:p.longitude||126.978,name:" "}],v=p.radius||100;let y=!1,_=1/0,b=null;const S=6371e3;if(x.forEach(C=>{const N=a*Math.PI/180,F=C.lat*Math.PI/180,Y=(C.lat-a)*Math.PI/180,X=(C.lng-c)*Math.PI/180,V=Math.sin(Y/2)*Math.sin(Y/2)+Math.cos(N)*Math.cos(F)*Math.sin(X/2)*Math.sin(X/2),te=2*Math.atan2(Math.sqrt(V),Math.sqrt(1-V)),G=S*te;G<_&&(_=G,b=C),G<=v&&(y=!0)}),y){r("verified");try{const C=h.toISOString().split("T")[0],{data:N,error:F}=await we.from("bookings").select("id").eq("user_id",e.id).eq("date",C).eq("session_id",g.id).maybeSingle();if(F||!N){i(` '${g.name}'   .`),r("error");return}const Y=new Date(`${C}T${g.start_time}+09:00`),X=new Date(Y.getTime()+10*60*1e3),V=s(),re=new Date(V)>X?"late":"present",{error:Z}=await we.from("attendance").upsert({booking_id:N.id,status:re,timestamp_in:V,updated_at:new Date().toISOString()},{onConflict:"booking_id"});if(Z)throw Z;i(`'${g.name}'   !`),setTimeout(()=>r("done"),1500)}catch(C){console.error("Attendance recording error:",C),i("    .   ."),r("error")}}else r("error"),d>1e3?i(`  . ( : ${Math.round(d)}m)
             PC  GPS   . 
                '' 'GPS'   .`):i(`   .
              '${(b==null?void 0:b.name)||" "}'  ${Math.round(_)}m  .
            ( : ${v}m)
            
            Tip:   GPS    ,      .`),console.log("GPS Verification Debug:",{user:{lat:a,lng:c,accuracy:d},nearestPoint:b,minDistance:_,targetRadius:v})},o=>{r("error"),i("    . GPS   .")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})};return w.jsxs("div",{className:"ios-glass rounded-ios p-12 max-w-lg w-full text-center space-y-10 relative overflow-hidden animate-spring-up shadow-3xl",children:[w.jsx("div",{className:"absolute top-0 left-0 w-32 h-32 bg-ios-indigo/5 blur-3xl -z-10"}),w.jsx("div",{className:`w-24 h-24 rounded-[2rem] mx-auto flex items-center justify-center transition-all duration-700 shadow-inner-white ${t==="verified"||t==="done"?"bg-ios-emerald/20 text-ios-emerald shadow-ios-emerald/20":t==="error"?"bg-ios-rose/20 text-ios-rose shadow-ios-rose/20":t==="locating"?"bg-ios-indigo/20 text-ios-indigo shadow-ios-indigo/20 animate-pulse":"bg-white/5 text-white/30"}`,children:t==="done"?w.jsx(_a,{className:"w-12 h-12"}):t==="error"?w.jsx(Qn,{className:"w-12 h-12"}):t==="locating"?w.jsx(Cs,{className:"w-12 h-12"}):w.jsx(S0,{className:"w-12 h-12"})}),w.jsxs("div",{className:"space-y-4",children:[w.jsx("h3",{className:"text-3xl font-black tracking-tight text-white",children:t==="done"?"  ":t==="locating"?"  ":"  "}),w.jsx("p",{className:"text-ios-gray font-medium text-lg leading-relaxed px-4",children:n||"     GPS  ."})]}),t!=="done"&&w.jsx("button",{onClick:l,disabled:t==="locating",className:`w-full py-6 rounded-2xl font-black text-lg transition-all shadow-2xl ios-tap ${t==="locating"?"bg-white/5 text-white/20":t==="error"?"bg-black text-white shadow-black/30":"bg-white text-black"}`,children:t==="locating"?"  ...":"  "})]})},d_=({user:e})=>{const[t,r]=le.useState([]),[n,i]=le.useState(!1),[s,l]=le.useState({cumulativeDays:0,cumulativeTime:0,attendanceRate:0,lateCount:0}),[o,a]=le.useState([]),[c,d]=le.useState(!1),[f,h]=le.useState([]);le.useEffect(()=>{if(!e)return;(async()=>{const p="2025-03-01",v=Be(new Date,"yyyy-MM-dd"),{data:y}=await we.from("bookings").select(`
                *,
                sessions (
                    start_time,
                    end_time
                ),
                attendance (
                    status,
                    timestamp_in
                )
            `).eq("user_id",e.id).gte("date",p);if(y){h(y);let _=0,b=0,S=0,C=0;const N=new Set;y.forEach(F=>{if(F.date>v)return;_++;const X=F.attendance&&F.attendance[0];if(X&&(X.status==="present"||X.status==="late")&&(b++,N.add(F.date),X.status==="late"&&S++,F.sessions)){const V=new Date(`${F.date}T${F.sessions.start_time}`),G=(new Date(`${F.date}T${F.sessions.end_time}`)-V)/(1e3*60);let re=0;if(X.timestamp_in){const Z=new Date(X.timestamp_in),oe=new Date(`${F.date}T${F.sessions.start_time}+09:00`);Z>oe&&(re=(Z-oe)/(1e3*60))}C+=Math.max(0,G-Math.max(0,re))}}),l({cumulativeDays:N.size,cumulativeTime:Math.round(C),attendanceRate:_>0?Math.round(b/_*100):0,lateCount:S})}a([])})()},[e]);const u=zl({start:Ua(new Date),end:bl(new Date)}),g=m=>{const p=Math.floor(m/60),x=m%60;return`${p} ${x}`};return w.jsxs("div",{className:"flex flex-col gap-4 md:gap-6",children:[w.jsx("div",{className:"animate-spring-up",children:w.jsxs("div",{className:"ios-glass rounded-ios p-10 border-white/5 shadow-inner-white",children:[w.jsx("div",{className:"flex items-center justify-between mb-10",children:w.jsxs("h3",{className:"text-xl font-black flex items-center gap-3",children:[w.jsx("div",{className:"w-10 h-10 rounded-ios bg-ios-indigo/20 flex items-center justify-center",children:w.jsx(Nl,{className:"w-5 h-5 text-ios-indigo"})}),"  "]})}),w.jsx("div",{className:"grid grid-cols-7 gap-3 text-center mb-6",children:["","","","","","",""].map((m,p)=>w.jsx("span",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest",children:m},p))}),w.jsx("div",{className:"grid grid-cols-7 gap-3",children:u.map((m,p)=>{const x=Be(m,"yyyy-MM-dd"),v=f.find(b=>b.date===x);let y=null;if(v){const b=Be(new Date,"yyyy-MM-dd");if(x>b)y="booking";else{const S=v.attendance&&v.attendance[0];S?y=S.status:y="absent"}}const _=dg(m);return w.jsxs("div",{className:`aspect-square rounded-ios flex items-center justify-center text-[12px] font-black transition-all duration-500 ios-tap relative group ${_?"bg-[#1C1C1E] text-white shadow-xl scale-[1.15] z-10":y==="present"?"bg-ios-emerald/10 text-ios-emerald":y==="late"?"bg-ios-amber/10 text-ios-amber":y==="absent"?"bg-ios-rose/10 text-ios-rose":y==="booking"?"bg-ios-indigo/10 text-ios-indigo":"bg-gray-50 text-gray-300 hover:bg-gray-100 hover:text-gray-500"}`,children:[Be(m,"d"),y&&!_&&y!=="booking"&&w.jsx("div",{className:`absolute bottom-1 w-1 h-1 rounded-full ${y==="present"?"bg-ios-emerald":y==="late"?"bg-ios-amber":"bg-ios-rose"}`}),y==="booking"&&!_&&w.jsx("div",{className:"absolute bottom-1 w-1 h-1 rounded-full bg-ios-indigo"})]},p)})}),w.jsx("div",{className:"mt-10 pt-8 border-t border-gray-100",children:w.jsxs("div",{className:"flex flex-col gap-4",children:[w.jsx("span",{className:"text-[11px] font-black text-ios-gray uppercase tracking-[0.2em]",children:" "}),w.jsx("div",{className:"flex flex-wrap gap-4",children:[{label:"",color:"bg-ios-emerald"},{label:"",color:"bg-ios-amber"},{label:"",color:"bg-ios-rose"},{label:"",color:"bg-ios-indigo"}].map(m=>w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:`w-2 h-2 rounded-full ${m.color}`}),w.jsx("span",{className:"text-[10px] font-bold text-gray-400",children:m.label})]},m.label))})]})})]})}),w.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4 md:gap-6 overflow-visible",children:[w.jsx("div",{className:"xl:col-span-2 flex flex-col gap-4 md:gap-6 animate-spring-up",style:{animationDelay:"100ms"},children:w.jsxs("div",{className:"grid grid-cols-2 gap-4 md:gap-6",children:[w.jsxs("div",{className:"col-span-2 ios-glass rounded-ios p-8 flex flex-col items-center text-center gap-2 group hover:bg-white transition-all duration-500 ios-tap border border-transparent hover:border-gray-100 shadow-sm relative overflow-hidden",children:[w.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-ios-amber/10 blur-3xl -z-10"}),w.jsx("div",{className:"w-16 h-16 rounded-ios bg-ios-amber/10 text-ios-amber flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform mb-2",children:w.jsx(Mf,{className:"w-8 h-8"})}),w.jsx("p",{className:"text-[11px] uppercase font-black text-ios-gray tracking-widest",children:"   "}),w.jsxs("div",{className:"flex flex-col items-center",children:[w.jsxs("p",{className:"text-4xl font-black text-[#1C1C1E]",children:[s.cumulativeDays,""]}),w.jsx("p",{className:"text-sm font-bold text-gray-400 mt-1",children:g(s.cumulativeTime)})]})]}),w.jsxs("div",{className:"ios-glass rounded-ios p-8 flex flex-col items-center text-center gap-4 group hover:bg-white transition-all duration-500 ios-tap border border-transparent hover:border-gray-100 shadow-sm",children:[w.jsx("div",{className:"w-12 h-12 rounded-ios bg-ios-emerald/10 text-ios-emerald flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform",children:w.jsx(_a,{className:"w-6 h-6"})}),w.jsxs("div",{children:[w.jsx("p",{className:"text-[10px] uppercase font-black text-ios-gray tracking-widest mb-1",children:""}),w.jsxs("p",{className:"text-2xl font-black text-[#1C1C1E]",children:[s.attendanceRate,"%"]})]})]}),w.jsxs("div",{className:"ios-glass rounded-ios p-8 flex flex-col items-center text-center gap-4 group hover:bg-white transition-all duration-500 ios-tap border border-transparent hover:border-gray-100 shadow-sm",children:[w.jsx("div",{className:"w-12 h-12 rounded-ios bg-ios-rose/10 text-ios-rose flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform",children:w.jsx(Sk,{className:"w-6 h-6"})}),w.jsxs("div",{children:[w.jsx("p",{className:"text-[10px] uppercase font-black text-ios-gray tracking-widest mb-1",children:" "}),w.jsxs("p",{className:"text-2xl font-black text-[#1C1C1E]",children:[s.lateCount,""]})]})]})]})}),w.jsx("div",{className:"animate-spring-up",style:{animationDelay:"200ms"},children:w.jsxs("div",{className:"bg-gradient-to-br from-ios-indigo via-[#7D7AFF] to-[#9B99FF] rounded-ios p-10 text-white shadow-2xl shadow-ios-indigo/30 relative overflow-hidden group ios-tap",children:[w.jsxs("div",{className:"relative z-10",children:[w.jsx("div",{className:"w-14 h-14 rounded-ios bg-white/20 backdrop-blur-md flex items-center justify-center mb-6 shadow-inner-white",children:w.jsx(Mf,{className:"w-8 h-8 text-white"})}),w.jsx("h4",{className:"text-2xl font-black tracking-tight mb-2",children:" "}),w.jsxs("p",{className:"text-[15px] text-white/80 font-medium mb-8 leading-relaxed",children:[" 5%  .",w.jsx("br",{}),"   ."]}),w.jsx("button",{onClick:()=>d(!0),className:"w-full py-4 bg-black hover:bg-gray-900 rounded-ios text-xs font-black uppercase tracking-widest transition-all backdrop-blur-sm border border-white/10",children:" "})]}),w.jsx("div",{className:"absolute -right-16 -top-16 w-64 h-64 bg-white/10 rounded-full blur-3xl group-hover:scale-150 transition-transform duration-[2000ms]"}),w.jsx("div",{className:"absolute left-[-10%] bottom-[-10%] w-40 h-40 bg-white/5 rounded-full blur-2xl group-hover:translate-x-10 transition-transform duration-[2000ms]"})]})})]}),c&&w.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 animate-in fade-in duration-200",children:[w.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>d(!1)}),w.jsxs("div",{className:"bg-white rounded-ios p-8 w-full max-w-md relative z-10 shadow-2xl animate-spring-up",children:[w.jsxs("div",{className:"flex items-center justify-between mb-8",children:[w.jsxs("h3",{className:"text-xl font-black flex items-center gap-3",children:[w.jsx("div",{className:"w-10 h-10 rounded-ios bg-ios-amber/20 flex items-center justify-center",children:w.jsx(Mf,{className:"w-5 h-5 text-ios-amber"})})," "]}),w.jsx("div",{className:"bg-gray-100 rounded-full px-3 py-1",children:w.jsx("span",{className:"text-[10px] font-bold text-gray-500",children:"TOP 10"})})]}),w.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2",children:o.length>0?o.map((m,p)=>w.jsxs("div",{className:"flex items-center justify-between p-4 rounded-ios bg-gray-50 border border-gray-100/50",children:[w.jsxs("div",{className:"flex items-center gap-4",children:[w.jsx("div",{className:`w-8 h-8 flex items-center justify-center font-black rounded-full shadow-sm ${p===0?"bg-yellow-400 text-white":p===1?"bg-gray-400 text-white":p===2?"bg-orange-400 text-white":"bg-white text-gray-400 border border-gray-200"}`,children:m.rank}),w.jsx("div",{className:"flex flex-col",children:w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("span",{className:"text-sm font-black text-[#1C1C1E]",children:m.name}),w.jsx("span",{className:"text-[10px] font-bold text-gray-500 bg-white px-1.5 py-0.5 rounded border border-gray-200",children:m.info})]})})]}),w.jsx("p",{className:"text-xs font-bold text-ios-indigo bg-ios-indigo/5 px-2 py-1 rounded-lg",children:g(m.score)})]},p)):w.jsx("div",{className:"text-center py-12 text-gray-400 font-medium text-sm bg-gray-50 rounded-ios",children:"  ,   ."})}),w.jsx("button",{onClick:()=>d(!1),className:"w-full mt-6 py-4 bg-[#1C1C1E] text-white rounded-ios font-black text-sm hover:scale-[1.02] active:scale-[0.98] transition-all shadow-lg",children:""})]})]})]})},v8=({onLogout:e,currentUser:t})=>{const[r,n]=le.useState("home"),[i,s]=le.useState(null),[l,o]=le.useState("GOE STUDY CAFE"),[a,c]=le.useState(""),[d,f]=le.useState({}),[h,u]=le.useState(new Date);le.useEffect(()=>{const v=async()=>{const{data:S}=await we.from("sessions").select("*");if(S){const C=new Date,N=C.getHours().toString().padStart(2,"0")+":"+C.getMinutes().toString().padStart(2,"0")+":00",F=S.find(Y=>N>=Y.start_time&&N<=Y.end_time);s(F)}},y=async()=>{var C;const{data:S}=await we.from("configs").select("value").eq("key","school_info").single();(C=S==null?void 0:S.value)!=null&&C.name&&o(S.value.name)},_=async()=>{if(!t)return;const S=Be(new Date,"yyyy-MM-dd"),C=Un(h,{weekStartsOn:1}),N=Sl(h,{weekStartsOn:1}),{data:F}=await we.from("study_plans").select("content").eq("user_id",t.id).eq("date",S);if(F&&F.length>0){const X=F.map(V=>V.content).filter(Boolean).join(`
`);c(X)}else c("");const{data:Y}=await we.from("bookings").select(`
                *,
                sessions (
                    id,
                    start_time,
                    end_time
                ),
                attendance (
                    id,
                    booking_id,
                    status,
                    timestamp_in,
                    timestamp_out
                )
            `).eq("user_id",t.id).gte("date",Be(C,"yyyy-MM-dd")).lte("date",Be(N,"yyyy-MM-dd"));if(Y){const X={};Y.forEach(V=>{const te=V.date;X[te]||(X[te]={bookings:[],attendance:[]}),X[te].bookings.push(V),V.attendance&&V.attendance.length>0&&X[te].attendance.push(...V.attendance)}),f(X)}};v(),y(),_();const b=setInterval(()=>{v(),_()},6e4);return()=>clearInterval(b)},[t,h]);const g=()=>u(v=>I6(v)),m=()=>u(v=>a_(v,1)),p=(v,y)=>{var te,G;if(!y||!y.bookings.length)return null;const _=new Date,b=Be(_,"yyyy-MM-dd"),{bookings:S,attendance:C}=y;if(v>b)return{label:"",color:"text-ios-indigo bg-ios-indigo/10"};if(v<b)return C.length?C.some(Z=>Z.status==="late")?{label:"",color:"text-ios-amber bg-ios-amber/10"}:{label:"",color:"text-ios-emerald bg-ios-emerald/10"}:{label:"",color:"text-ios-rose bg-ios-rose/10"};const N=Be(_,"HH:mm:ss"),F=[...S].sort((re,Z)=>{var oe,ee;return(((oe=re.sessions)==null?void 0:oe.start_time)||"").localeCompare(((ee=Z.sessions)==null?void 0:ee.start_time)||"")});if(!F.length)return null;const Y=(te=F[0].sessions)==null?void 0:te.start_time,X=(G=F[F.length-1].sessions)==null?void 0:G.end_time;if(X&&N>X)return{label:"",color:"text-gray-500 bg-gray-100"};if(Y&&N<Y)return{label:"",color:"text-ios-indigo bg-ios-indigo/10"};const V=F.find(re=>{const Z=re.sessions;return Z&&N>=Z.start_time&&N<=Z.end_time});return V?C.find(Z=>Z.booking_id===V.id)?{label:"",color:"text-white bg-ios-emerald"}:{label:"",color:"text-ios-rose bg-ios-rose/10"}:{label:"",color:"text-ios-amber bg-ios-amber/10"}},x=()=>{switch(r){case"home":return w.jsxs("div",{className:"flex-1 flex flex-col gap-4 p-4 animate-fade-in relative overflow-y-auto scrollbar-hide",children:[w.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-ios-indigo/5 blur-3xl -z-10"}),w.jsx("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-ios-blue/5 blur-3xl -z-10"}),w.jsxs("div",{className:"flex-[2] bg-white rounded-[2rem] border border-gray-100 shadow-sm p-6 relative overflow-hidden flex flex-col",children:[w.jsxs("div",{className:"flex items-center justify-between mb-2",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"w-8 h-8 rounded-full bg-ios-amber/10 flex items-center justify-center",children:w.jsx(A1,{className:"w-4 h-4 text-ios-amber"})}),w.jsx("h2",{className:"text-lg font-black text-[#1C1C1E]",children:" "})]}),w.jsxs("span",{className:"text-[10px] font-bold text-ios-gray bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100 max-sm:hidden",children:[Be(new Date,"M d")," "]})]}),w.jsx("div",{className:"flex-1 flex items-center justify-center text-center",children:a?w.jsx("p",{className:"text-[15px] text-[#1C1C1E] font-bold leading-relaxed whitespace-pre-line line-clamp-3",children:a}):w.jsxs("div",{className:"text-center",children:[w.jsx("p",{className:"text-sm text-gray-400 font-bold leading-relaxed mb-1",children:"    ."}),w.jsx("span",{className:"text-xs font-medium text-gray-300",children:"   ."})]})}),w.jsxs("div",{className:"bg-gray-50/50 rounded-2xl p-4 border border-gray-100/50 mt-auto relative",children:[w.jsx("button",{onClick:g,className:"absolute left-1 top-1/2 -translate-y-1/2 w-8 h-8 flex items-center justify-center text-gray-400 hover:text-[#1C1C1E] transition-colors",children:w.jsx(Ui,{className:"w-5 h-5"})}),w.jsx("button",{onClick:m,className:"absolute right-1 top-1/2 -translate-y-1/2 w-8 h-8 flex items-center justify-center text-gray-400 hover:text-[#1C1C1E] transition-colors",children:w.jsx(ln,{className:"w-5 h-5"})}),w.jsx("div",{className:"flex justify-between items-center px-6",children:zl({start:Un(h,{weekStartsOn:1}),end:Sl(h,{weekStartsOn:1})}).map((v,y)=>{const _=Be(v,"yyyy-MM-dd"),b=d[_],S=p(_,b),C=ys(v,new Date);return w.jsxs("div",{className:"flex flex-col items-center gap-2",children:[w.jsx("span",{className:`text-[9px] font-black ${C?"text-[#1C1C1E]":"text-gray-300"}`,children:["","","","","","",""][y]}),w.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-[10px] font-black transition-all ${C?"bg-[#1C1C1E] text-white shadow-lg ring-4 ring-white z-10":"bg-white border border-gray-100 text-gray-300"}`,children:Be(v,"d")}),w.jsx("div",{className:"h-4 flex items-center justify-center",children:S?w.jsx("span",{className:`text-[8px] font-bold px-1.5 py-0.5 rounded-full whitespace-nowrap ${S.color}`,children:S.label}):w.jsx("div",{className:"w-1 h-1 rounded-full bg-transparent"})})]},y)})})]})]}),w.jsxs("button",{onClick:()=>n("map"),className:"flex-1 bg-white rounded-3xl border border-gray-100 shadow-sm p-4 flex items-center justify-center gap-6 group transition-all active:scale-[0.98] relative overflow-hidden ios-tap",children:[w.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-ios-indigo/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),w.jsx("div",{className:"w-14 h-14 rounded-full bg-ios-indigo/10 flex items-center justify-center group-hover:scale-110 transition-transform duration-500",children:w.jsx(cu,{className:"w-7 h-7 text-ios-indigo"})}),w.jsxs("div",{className:"text-left space-y-1 relative z-10 flex-1",children:[w.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:""}),w.jsx("p",{className:"text-xs font-bold text-ios-gray",children:"  "})]}),w.jsx(ln,{className:"w-5 h-5 text-gray-300"})]}),w.jsxs("button",{onClick:()=>n("attendance"),className:"flex-1 bg-white rounded-3xl border border-gray-100 shadow-sm p-4 flex items-center justify-center gap-6 group transition-all active:scale-[0.98] relative overflow-hidden ios-tap",children:[w.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-ios-emerald/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),w.jsx("div",{className:"w-14 h-14 rounded-full bg-ios-emerald/10 flex items-center justify-center group-hover:scale-110 transition-transform duration-500",children:w.jsx(Cs,{className:"w-7 h-7 text-ios-emerald"})}),w.jsxs("div",{className:"text-left space-y-1 relative z-10 flex-1",children:[w.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:""}),w.jsx("p",{className:"text-xs font-bold text-ios-gray",children:"GPS  "})]}),w.jsx(ln,{className:"w-5 h-5 text-gray-300"})]})]});case"map":return w.jsx("div",{className:"flex-1 bg-white relative overflow-hidden flex flex-col",children:w.jsx(x8,{onCancel:()=>n("home"),onSuccess:()=>n("profile"),currentUser:t})});case"attendance":return w.jsx("div",{className:"flex-1 bg-white p-6 flex flex-col items-center justify-center",children:w.jsx(h_,{user:t})});case"profile":return w.jsx("div",{className:"flex-1 bg-[#F2F2F7] overflow-y-auto scrollbar-hide p-6",children:w.jsx(d_,{user:t})});default:return null}};return w.jsxs("div",{className:"mobile-container flex flex-col bg-[#F2F2F7] h-screen overflow-hidden font-sans pb-[safe-area-inset-bottom]",children:[w.jsxs("header",{className:"flex-none bg-white/80 backdrop-blur-md border-b border-gray-200/50 px-5 py-4 flex items-center justify-between z-50 sticky top-0 pt-[max(1rem,env(safe-area-inset-top))]",children:[w.jsxs("div",{children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("h1",{className:"text-lg font-black text-[#1C1C1E] tracking-tight",children:l}),i&&w.jsxs("span",{className:"bg-ios-indigo/10 text-ios-indigo text-[10px] font-black px-2 py-0.5 rounded-full uppercase tracking-wide animate-pulse",children:[i.name,"  "]})]}),w.jsx("p",{className:"text-[11px] font-bold text-ios-gray mt-0.5",children:Be(new Date,"M d (EEE)",{locale:Ii})})]}),w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsxs("div",{className:"text-right block",children:[w.jsx("p",{className:"text-xs font-black text-[#1C1C1E]",children:t==null?void 0:t.full_name}),w.jsx("p",{className:"text-[10px] font-bold text-ios-gray",children:t==null?void 0:t.username})]}),w.jsx("button",{onClick:e,className:"w-9 h-9 rounded-full bg-gray-100 flex items-center justify-center text-ios-gray hover:text-black hover:bg-gray-200 transition-colors",children:w.jsx($u,{className:"w-4 h-4"})})]})]}),w.jsx("main",{className:"flex-1 flex flex-col overflow-hidden relative",children:x()}),r!=="map"&&w.jsx("nav",{className:"flex-none bg-white border-t border-gray-200/50 pb-[calc(1rem+env(safe-area-inset-bottom))] pt-3 px-6 flex justify-between items-center z-50 shadow-[0_-4px_20px_rgba(0,0,0,0.02)]",children:[{id:"home",icon:LS,label:""},{id:"map",icon:cu,label:""},{id:"attendance",icon:Cs,label:""},{id:"profile",icon:tl,label:"MY"}].map(v=>w.jsx("button",{onClick:()=>n(v.id),className:`flex flex-col items-center justify-center p-2 rounded-xl transition-all duration-300 w-16 group ${r===v.id?"text-[#1C1C1E]":"text-gray-300 hover:text-gray-500"}`,children:w.jsx("div",{className:"relative transition-transform duration-300",children:w.jsx(v.icon,{className:`w-7 h-7 stroke-[2.5px] ${r===v.id?"fill-current":"fill-transparent"}`})})},v.id))})]})},y8=({selectedSeat:e,onComplete:t,targetUser:r,loggedInUser:n,initialDate:i,onDateChange:s,currentZoneId:l})=>{const[o,a]=le.useState(1),[c,d]=le.useState(i||Be(Ri(new Date,2),"yyyy-MM-dd")),[f,h]=le.useState(Be(Ri(new Date,2),"yyyy-MM-dd")),[u,g]=le.useState([]),[m,p]=le.useState([]),[x,v]=le.useState(null),[y,_]=le.useState(null),[b,S]=le.useState({quarters:[],defaults:[],exceptions:[]}),[C,N]=le.useState([]),[F,Y]=le.useState([]),[X,V]=le.useState(!1),[te,G]=le.useState("");le.useEffect(()=>{i&&d(i)},[i]);const re={Morning:" ",Dinner:" ","1st Period":"1","2nd Period":"2"},Z=R=>re[R]||R;le.useEffect(()=>{(async()=>{const{data:{user:z}}=await we.auth.getUser();if(z){const{data:L}=await we.from("profiles").select("*").eq("id",z.id).single();v(r||L),_(L)}const I=(e==null?void 0:e.zone_id)||l;if(I){V(!0);const[L,K,O,B]=await Promise.all([we.from("sessions").select("*").eq("zone_id",I).order("start_time",{ascending:!0}),we.from("operation_quarters").select("*"),we.from("operation_defaults").select("*").eq("zone_id",I),we.from("operation_exceptions").select("*").eq("zone_id",I)]);L.data&&g(L.data),S({quarters:K.data||[],defaults:O.data||[],exceptions:B.data||[]}),V(!1)}else{const{data:L}=await we.from("operation_quarters").select("*");S(K=>({...K,quarters:L||[]}))}})()},[e,l,r]),le.useEffect(()=>{v(r||y)},[r,y]),le.useEffect(()=>{x&&c&&e&&(oe(),ee()),p([])},[x,c,e,l]);const oe=async()=>{const{data:R}=await we.from("bookings").select("*").eq("user_id",x.id).eq("date",c);N(R||[])},ee=async()=>{if(!e)return;const{data:R}=await we.from("bookings").select("*, profiles(username, full_name)").eq("seat_id",e.id).eq("date",c);Y(R||[])},E=R=>{const z=Et(R),I=n||y,L=I&&["admin","teacher"].includes(I.role),K=Kn(Ri(new Date,L?0:2));if(Lc(z,K))return{ok:!1,msg:`   ${L?"0":"2"}  .`};if(b.quarters.length>0&&!b.quarters.some(M=>M.start_date&&M.end_date&&kl(z,{start:Et(M.start_date),end:Et(M.end_date)})))return{ok:!1,msg:"    ."};const O=b.exceptions.find(B=>B.exception_date===R);if(O)return{ok:!1,msg:`: ${O.reason}`};if(b.defaults.length>0){const B=z.getDay(),M=b.defaults.find(se=>se.day_of_week===B);if(!(M&&(M.morning||M.dinner||M.period1||M.period2)))return{ok:!1,msg:"   ."}}return{ok:!0}},D=()=>{if(o===1){const R=n||y;if(R&&["admin","teacher"].includes(R.role)&&!r){G("/     .     .");return}const z=E(c);if(!z.ok){G(z.msg);return}if(C.length>0&&e&&C[0].seat_id!==e.id){G(`  ${C[0].seat_number}  .`);return}}G(""),a(R=>R+1)},U=R=>{p(z=>z.find(L=>L.id===R.id)?z.filter(L=>L.id!==R.id):[...z,R].sort((L,K)=>L.id-K.id))};async function k(R,z){if(R.stopPropagation(),!!window.confirm("   ?"))try{V(!0);const{error:I}=await we.from("bookings").delete().eq("seat_id",e.id).eq("date",c).eq("session_id",z);if(I)throw I;Y(L=>L.filter(K=>K.session_id!==z)),N(L=>L.filter(K=>K.session_id!==z)),alert(" .")}catch(I){console.error("Cancel Error:",I),G(`    : ${I.message}`)}finally{V(!1)}}async function P(){if(m.length===0||X)return;const R=n||y;if(R&&["admin","teacher"].includes(R.role)&&!r){G("/     ."),a(1);return}const z=()=>{const I=new Date,L=9*60*60*1e3;return new Date(I.getTime()+L).toISOString().replace("Z","+09:00")};V(!0);try{const{data:I}=await we.from("bookings").select("session_id, user_id, seat_id").eq("date",c).in("session_id",m.map(O=>O.id));if(I&&I.length>0){const O=I.some(M=>M.seat_id===e.id),B=I.some(M=>M.user_id===x.id);if(O||B){G(O?"   .":"      ."),a(2),V(!1),oe(),ee();return}}const L=m.map(O=>({user_id:x.id,seat_id:e.id,session_id:O.id,date:c,created_at:z()})),{error:K}=await we.from("bookings").insert(L);K?(G(` : ${K.message}`),a(2)):(alert(" ."),t(),window.location.reload())}catch{G("   ")}finally{V(!1)}}const[A,T]=le.useState(new Date),j=()=>{const R=Ua(A),z=bl(R),I=Un(R),L=Sl(z),K=zl({start:I,end:L});return w.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-4 shadow-sm",children:[w.jsxs("div",{className:"flex items-center justify-between mb-4 px-1",children:[w.jsx("h4",{className:"text-sm font-black text-[#1C1C1E]",children:Be(A,"yyyy M",{locale:Ii})}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx("button",{onClick:()=>T(of(A)),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",children:w.jsx(Ui,{className:"w-4 h-4 text-ios-gray"})}),w.jsx("button",{onClick:()=>T(Ul(A,1)),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",children:w.jsx(ln,{className:"w-4 h-4 text-ios-gray"})})]})]}),w.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[["","","","","","",""].map(O=>w.jsx("div",{className:"text-center text-[10px] font-bold text-ios-gray/50 py-1",children:O},O)),K.map((O,B)=>{const M=Be(O,"yyyy-MM-dd"),J=E(M),se=c===M,H=ys(Ua(O),R),ce=dg(O);return w.jsx("button",{disabled:!J.ok,onClick:()=>{d(M),s&&s(M)},className:`
                  h-9 w-full rounded-lg flex flex-col items-center justify-center transition-all relative
                  ${se?"bg-[#1C1C1E] text-white shadow-md z-10":""}
                  ${!se&&H&&J.ok?"hover:bg-gray-100 text-[#1C1C1E] font-black":""}
                  ${!se&&J.ok&&!H?"text-ios-gray/40 font-black":""}
                  ${J.ok?"":"opacity-20 cursor-not-allowed text-ios-gray grayscale"}
                  ${!se&&ce?"border border-ios-indigo text-ios-indigo font-black":""}
                `,children:w.jsx("span",{className:"text-xs",children:Be(O,"d")})},B)})]}),w.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-50 flex items-center gap-4 px-1",children:[w.jsxs("div",{className:"flex items-center gap-1.5",children:[w.jsx("div",{className:"w-2 h-2 rounded-full bg-[#1C1C1E]/10"}),w.jsx("span",{className:"text-[10px] font-bold text-ios-gray/70",children:""})]}),w.jsxs("div",{className:"flex items-center gap-1.5",children:[w.jsx("div",{className:"w-2 h-2 rounded-full bg-ios-indigo/20"}),w.jsx("span",{className:"text-[10px] font-bold text-ios-indigo/70",children:""})]})]})]})};return w.jsxs("div",{className:"bg-white border border-gray-100 border-b-0 rounded-t-[6px] rounded-b-none pt-[10px] px-6 pb-6 lg:px-8 lg:pb-8 space-y-5 animate-spring-up overflow-hidden relative h-full",children:[w.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-ios-indigo/5 blur-2xl -z-10"}),w.jsxs("div",{className:"bg-gray-50/50 rounded-[6px] mt-[10px] pt-4 px-4 pb-4 flex items-center gap-4 border border-gray-100",children:[w.jsx("div",{className:"w-12 h-12 rounded-[6px] bg-white text-[#000000] flex items-center justify-center font-black text-sm border border-gray-200 shadow-sm",children:e?e.display_number||e.seat_number:"?"}),w.jsxs("div",{children:[w.jsx("p",{className:"text-[9px] font-black text-[#000000] uppercase tracking-[0.2em] mb-0.5 opacity-50",children:"  "}),w.jsx("p",{className:"text-base font-black text-[#1C1C1E]",children:e?`Zone ${e.zone_name}`:"  "})]})]}),w.jsx("div",{className:"flex items-center gap-2",children:[1,2,3].map(R=>w.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-all duration-700 ${o>=R?"bg-[#1C1C1E]":"bg-gray-100"}`},R))}),o===1&&w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center",children:w.jsx(Nl,{className:"w-5 h-5 text-ios-indigo"})}),w.jsx("h3",{className:"text-xl font-black tracking-tight text-[#1C1C1E]",children:"  "})]}),w.jsxs("div",{className:"space-y-4",children:[j(),!E(c).ok&&w.jsxs("div",{className:"p-4 bg-ios-rose/5 border border-ios-rose/10 rounded-xl flex items-center gap-2 animate-shake",children:[w.jsx(Qn,{className:"w-4 h-4 text-ios-rose"}),w.jsx("p",{className:"text-[11px] font-black text-ios-rose italic",children:E(c).msg})]}),w.jsxs("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-100 text-center",children:[w.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:" "}),w.jsx("p",{className:"text-lg font-black text-[#1C1C1E]",children:Be(Et(c),"yyyy M d (EEEE)",{locale:Ii})})]})]}),te&&w.jsxs("div",{className:"p-4 bg-ios-rose/5 border border-ios-rose/10 rounded-[6px] flex items-center gap-2 animate-shake",children:[w.jsx(Qn,{className:"w-4 h-4 text-ios-rose"}),w.jsx("p",{className:"text-[11px] font-black text-ios-rose",children:te})]}),w.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-50 flex gap-3",children:[w.jsx("button",{onClick:t,className:"flex-1 py-3.5 rounded-xl text-sm font-black text-ios-gray bg-gray-50 hover:bg-gray-100 transition-all ios-tap",children:""}),w.jsx("button",{disabled:!E(c).ok||!e,onClick:D,className:`flex-[1.5] py-3.5 rounded-xl text-sm font-black text-white transition-all shadow-lg ios-tap ${E(c).ok&&e?"bg-[#1C1C1E] shadow-black/10 hover:bg-gray-800":"bg-gray-200 cursor-not-allowed shadow-none"}`,children:" "})]})]}),o===2&&w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center",children:w.jsx(Ia,{className:"w-5 h-5 text-ios-indigo"})}),w.jsx("h3",{className:"text-xl font-black tracking-tight text-[#1C1C1E]",children:"  "})]}),w.jsx("p",{className:"text-[11px] font-black text-ios-gray px-1",children:"      . (  )"}),w.jsx("div",{className:"grid grid-cols-1 gap-3",children:u.map(R=>{var M;const z=Et(c).getDay(),I=b.defaults.find(J=>J.day_of_week===z),L=R.id===1?I==null?void 0:I.morning:R.id===2?I==null?void 0:I.dinner:R.id===3?I==null?void 0:I.period1:R.id===4?I==null?void 0:I.period2:!1,K=C.some(J=>J.session_id===R.id),O=F.some(J=>J.session_id===R.id),B=m.some(J=>J.id===R.id);return L?w.jsxs("button",{disabled:K||O,onClick:()=>U(R),className:`p-4 rounded-[6px] border transition-all duration-300 flex items-center justify-between group ios-tap text-left ${B?"border-[#1C1C1E] bg-[#1C1C1E]/5 shadow-sm":K||O?["admin","teacher"].includes(x==null?void 0:x.role)?"border-red-100 bg-red-50/30":"opacity-30 bg-gray-100 cursor-not-allowed":"border-gray-100 bg-gray-50/50 hover:bg-gray-100/80"}`,children:[w.jsxs("div",{className:"flex-1 flex flex-col items-start",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("p",{className:"font-black text-base text-[#1C1C1E]",children:Z(R.name)}),K&&w.jsx("span",{className:"text-[9px] font-black text-ios-gray bg-gray-200 px-1.5 py-0.5 rounded-full uppercase",children:" "}),!K&&O&&w.jsxs("div",{className:"flex flex-col items-start gap-1",children:[w.jsx("span",{className:"text-[9px] font-black text-ios-rose bg-ios-rose/10 px-1.5 py-0.5 rounded-full uppercase",children:" "}),["admin","teacher"].includes(y==null?void 0:y.role)&&((M=F.find(J=>J.session_id===R.id))==null?void 0:M.profiles)&&w.jsxs("span",{className:"text-[9px] font-bold text-ios-rose/70",children:[F.find(J=>J.session_id===R.id).profiles.username," ",F.find(J=>J.session_id===R.id).profiles.full_name]})]})]}),w.jsxs("p",{className:"text-[10px] font-black text-ios-gray/70 uppercase tracking-tight mt-0.5",children:[R.start_time.slice(0,5)," ~ ",R.end_time.slice(0,5)]})]}),B?w.jsx("div",{className:"w-5 h-5 rounded-full bg-[#1C1C1E] flex items-center justify-center shadow-sm",children:w.jsx(Bi,{className:"w-3 h-3 text-white stroke-[3px]"})}):(K||O)&&["admin","teacher"].includes(x.role)?w.jsx("button",{onClick:J=>k(J,R.id),className:"w-8 h-8 rounded-full bg-red-50 hover:bg-red-100 flex items-center justify-center transition-all group/btn border border-red-200",title:" ",children:w.jsx(ji,{className:"w-4 h-4 text-red-500 group-hover/btn:scale-110 transition-transform"})}):w.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-gray-300 bg-white"})]},R.id):null})}),te&&w.jsxs("div",{className:"p-4 bg-ios-rose/5 border border-ios-rose/10 rounded-[6px] flex items-center gap-2 animate-shake",children:[w.jsx(Qn,{className:"w-4 h-4 text-ios-rose"}),w.jsx("p",{className:"text-[11px] font-black text-ios-rose",children:te})]}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx("button",{onClick:()=>t(),className:"flex-1 bg-gray-100 text-[#1C1C1E] py-4 rounded-[6px] font-black text-xs transition-all hover:bg-gray-200 ios-tap",children:""}),w.jsx("button",{onClick:()=>a(1),className:"flex-1 py-4 bg-gray-100 text-ios-gray rounded-[6px] font-black text-xs ios-tap",children:""}),w.jsxs("button",{disabled:m.length===0,onClick:D,className:"flex-[2] bg-[#1C1C1E] text-white py-4 rounded-[6px] font-black text-xs transition-all shadow-md disabled:opacity-20 ios-tap flex flex-col items-center justify-center leading-tight",children:[w.jsxs("span",{children:[m.length," "]}),w.jsx("span",{className:"opacity-60 text-[10px] mt-0.5",children:""})]})]})]}),o===3&&w.jsxs("div",{className:"space-y-8",children:[w.jsxs("div",{className:"text-center space-y-3",children:[w.jsx("div",{className:"w-12 h-12 rounded-[6px] bg-emerald-50 text-ios-emerald flex items-center justify-center mx-auto border border-emerald-100",children:w.jsx(Bi,{className:"w-6 h-6"})}),w.jsxs("div",{className:"space-y-1.5",children:[w.jsx("h3",{className:"text-2xl font-black tracking-tight text-[#1C1C1E]",children:" "}),w.jsx("p",{className:"text-xs text-ios-gray font-medium",children:"    ."})]})]}),w.jsx("div",{className:"space-y-1.5",children:[{label:" ",value:Be(Et(c),"yyyy M d (EEEE)",{locale:Ii}),color:"text-[#1C1C1E]"},{label:" ",value:m.map(R=>Z(R.name)).join(", "),color:"text-[#1C1C1E]"},{label:" ",value:e.zone_name,color:"text-[#1C1C1E]"},{label:" ",value:`${e.seat_number}`,color:"text-[#1C1C1E]"}].map((R,z)=>w.jsxs("div",{className:"flex justify-between items-center p-4 rounded-[6px] bg-gray-50 border border-gray-100",children:[w.jsx("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest leading-none",children:R.label}),w.jsx("span",{className:`text-sm font-black text-right max-w-[200px] ${R.color}`,children:R.value})]},z))}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx("button",{onClick:()=>t(),className:"flex-1 bg-gray-100 text-[#1C1C1E] py-5 rounded-[6px] font-black text-base transition-all hover:bg-gray-200 ios-tap",children:""}),w.jsxs("button",{disabled:X,onClick:P,className:"flex-[2] bg-[#1C1C1E] text-white py-5 rounded-[6px] font-black text-base transition-all shadow-lg shadow-black/20 flex items-center justify-center gap-3 ios-tap overflow-hidden relative group disabled:opacity-50",children:[X?" ...":" "," ",w.jsx(ln,{className:"w-5 h-5"})]})]})]})]})},w8=()=>{const[e,t]=le.useState([]),[r,n]=le.useState(!1),[i,s]=le.useState(""),[l,o]=le.useState("all"),[a,c]=le.useState(""),[d,f]=le.useState(null),[h,u]=le.useState("id-asc");le.useEffect(()=>{g()},[]);const g=async()=>{n(!0);const{data:y,error:_}=await we.from("applicant_pool").select("*").order("name",{ascending:!0});_?console.error("Error fetching applicants:",_):t(y||[]),n(!1)},m=()=>{const y=hs.json_to_sheet([{:"",:""}]);y["!cols"]=[{wch:15},{wch:15}];const _=hs.book_new();hs.book_append_sheet(_,y,""),Jw(_,"__.xlsx")},p=async y=>{const _=y.target.files[0];if(!_)return;n(!0);const b=new FileReader;b.onload=async S=>{const C=S.target.result,N=Cd(C,{type:"binary"}),F=N.SheetNames[0],Y=N.Sheets[F],V=hs.sheet_to_json(Y).map(G=>({name:G.,student_id:String(G.).padStart(5,"0"),role:G.===""?"parent":G.===""?"teacher":G.===""?"admin":"student",status:"applied"})).filter(G=>G.name&&G.student_id),{error:te}=await we.from("applicant_pool").upsert(V,{onConflict:"name,student_id"});te?alert("  : "+te.message):(alert(`${V.length}   .`),g()),n(!1)},b.readAsBinaryString(_)},x=async(y,_,b="",S=y.role)=>{n(!0);const{error:C}=await we.from("applicant_pool").update({status:_,rejection_reason:b,role:S}).eq("id",y.id);C?alert("  : "+C.message):(g(),f(null),c("")),n(!1)},v=e.filter(y=>{const _=y.name.includes(i)||y.student_id.includes(i),b=l==="all"||y.status===l,S=h==="grade-1"?y.student_id.startsWith("1"):h==="grade-2"?y.student_id.startsWith("2"):h==="grade-3"?y.student_id.startsWith("3"):!0;return _&&b&&S}).sort((y,_)=>h==="name-asc"?y.name.localeCompare(_.name):h==="name-desc"?_.name.localeCompare(y.name):h==="id-asc"||h.startsWith("grade")?y.student_id.localeCompare(_.student_id):h==="id-desc"?_.student_id.localeCompare(y.student_id):0);return w.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 flex flex-col h-full overflow-hidden shadow-sm animate-spring-up",children:[w.jsxs("div",{className:"p-6 border-b border-gray-50 flex flex-col md:flex-row md:items-center justify-between gap-4 shrink-0",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center",children:w.jsx(Xu,{className:"w-5 h-5 text-ios-indigo"})}),w.jsxs("div",{children:[w.jsx("h3",{className:"text-[14px] font-black text-[#1C1C1E]",children:"    "}),w.jsx("p",{className:"text-[10px] text-ios-gray font-black uppercase tracking-widest mt-0.5",children:"Applicant Pool Management"})]})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsxs("button",{onClick:m,className:"flex items-center gap-2 bg-white hover:bg-gray-50 text-[#1C1C1E] px-4 py-2.5 rounded-[6px] text-xs font-black transition-all border border-gray-200 ios-tap",children:[w.jsx(NS,{className:"w-4 h-4 text-ios-indigo"})," "]}),w.jsxs("label",{className:"flex items-center gap-2 bg-[#1C1C1E] hover:bg-[#2C2C2E] text-white px-4 py-2.5 rounded-[6px] text-xs font-black transition-all border border-transparent cursor-pointer ios-tap shadow-sm",children:[w.jsx(Ck,{className:"w-4 h-4 text-white"})," ",w.jsx("input",{type:"file",className:"hidden",accept:".xlsx,.xls",onChange:p})]})]})]}),w.jsxs("div",{className:"px-6 py-4 bg-gray-50/50 border-b border-gray-50 flex flex-col md:flex-row gap-4 shrink-0",children:[w.jsxs("div",{className:"flex-1 relative",children:[w.jsx(rd,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray"}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx("input",{type:"text",placeholder:"   ...",value:i,onChange:y=>s(y.target.value),className:"flex-1 bg-white border border-gray-200 rounded-[6px] pl-10 pr-4 py-2 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all"}),w.jsxs("select",{value:h,onChange:y=>u(y.target.value),className:"bg-white border border-gray-200 rounded-[6px] px-3 py-2 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all outline-none cursor-pointer min-w-[140px]",children:[w.jsx("option",{value:"id-asc",children:" ()"}),w.jsx("option",{value:"id-desc",children:" ()"}),w.jsx("option",{value:"name-asc",children:" ()"}),w.jsx("option",{value:"name-desc",children:" ()"}),w.jsx("option",{value:"grade-1",children:"1 ()"}),w.jsx("option",{value:"grade-2",children:"2 ()"}),w.jsx("option",{value:"grade-3",children:"3 ()"})]})]})]}),w.jsx("div",{className:"flex gap-2",children:["all","applied","pending","approved","rejected"].map(y=>w.jsx("button",{onClick:()=>o(y),className:`px-4 py-2 rounded-[6px] text-[10px] font-black uppercase tracking-widest transition-all ${l===y?"bg-[#1C1C1E] text-white shadow-md":"bg-white text-ios-gray border border-gray-200 hover:border-ios-indigo"}`,children:y==="all"?"":y==="applied"?"":y==="pending"?"":y==="approved"?"":""},y))})]}),w.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-hide",children:[w.jsxs("table",{className:"w-full text-left border-collapse",children:[w.jsx("thead",{className:"sticky top-0 bg-gray-50/90 backdrop-blur-sm z-10",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),w.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),w.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),w.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),w.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),w.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100",children:""}),w.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100 text-right",children:""})]})}),w.jsx("tbody",{children:v.map(y=>w.jsxs("tr",{className:"hover:bg-gray-50 transition-colors group",children:[w.jsx("td",{className:"px-6 py-4 text-xs font-mono font-black text-ios-indigo",children:y.student_id}),w.jsx("td",{className:"px-6 py-4 text-xs font-bold text-[#1C1C1E]",children:y.name}),w.jsx("td",{className:"px-6 py-4",children:w.jsx("span",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest",children:"Student"})}),w.jsx("td",{className:"px-6 py-4 text-xs font-medium text-ios-gray flex items-center gap-1.5",children:y.phone_number?w.jsxs(w.Fragment,{children:[w.jsx(td,{className:"w-3 h-3 text-ios-emerald"}),y.phone_number]}):"-"}),w.jsx("td",{className:"px-6 py-4",children:y.pledge_accepted?w.jsxs("div",{className:"flex flex-col gap-0.5",children:[w.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-black text-ios-indigo",children:[w.jsx(SS,{className:"w-3 h-3"})," "]}),w.jsx("span",{className:"text-[9px] text-ios-gray opacity-50 font-mono",children:new Date(y.pledged_at).toLocaleDateString()})]}):w.jsx("span",{className:"text-[10px] font-black text-ios-gray opacity-30",children:""})}),w.jsx("td",{className:"px-6 py-4",children:y.status==="applied"?w.jsx("span",{className:"px-2 py-1 rounded-full text-[9px] font-black uppercase tracking-wider bg-gray-100 text-ios-gray",children:" "}):w.jsxs("select",{value:y.status,onChange:_=>x(y,_.target.value),className:`px-2 py-1 rounded-full text-[9px] font-black uppercase tracking-wider border-none focus:ring-1 transition-all cursor-pointer ${y.status==="approved"?"bg-ios-emerald/10 text-ios-emerald focus:ring-ios-emerald":y.status==="pending"?"bg-ios-amber/10 text-ios-amber focus:ring-ios-amber":y.status==="rejected"?"bg-ios-rose/10 text-ios-rose focus:ring-ios-rose":"bg-gray-100 text-ios-gray focus:ring-gray-300"}`,children:[w.jsx("option",{value:"pending",children:" "}),w.jsx("option",{value:"approved",children:""}),w.jsx("option",{value:"rejected",children:""}),w.jsx("option",{value:"applied",children:"  ()"})]})}),w.jsx("td",{className:"px-6 py-4 text-right",children:w.jsxs("div",{className:"flex items-center justify-end gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[y.status==="pending"&&w.jsxs(w.Fragment,{children:[w.jsx("button",{onClick:()=>x(y,"approved"),className:"p-1.5 rounded-[4px] bg-ios-emerald/10 text-ios-emerald hover:bg-[#1C1C1E] text-white transition-all ios-tap",title:"",children:w.jsx(Bi,{className:"w-3.5 h-3.5"})}),w.jsx("button",{onClick:()=>f(y),className:"p-1.5 rounded-[4px] bg-ios-rose/10 text-ios-rose hover:bg-[#1C1C1E] text-white transition-all ios-tap",title:"",children:w.jsx(ba,{className:"w-3.5 h-3.5"})})]}),w.jsx("button",{className:"p-1.5 rounded-[4px] bg-gray-100 text-ios-gray hover:bg-gray-200 transition-all ios-tap",children:w.jsx(AS,{className:"w-3.5 h-3.5"})})]})})]},y.id))})]}),v.length===0&&w.jsxs("div",{className:"py-20 flex flex-col items-center justify-center text-ios-gray space-y-3",children:[w.jsx(Qn,{className:"w-10 h-10 opacity-20"}),w.jsx("p",{className:"text-xs font-black",children:"  ."})]})]}),d&&w.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-50 flex items-center justify-center p-6",children:w.jsx("div",{className:"bg-white rounded-ios w-full max-w-sm shadow-2xl animate-spring-up overflow-hidden",children:w.jsxs("div",{className:"p-6 space-y-4",children:[w.jsxs("h4",{className:"text-[14px] font-black text-[#1C1C1E]",children:[d.name,"   "]}),w.jsx("textarea",{value:a,onChange:y=>c(y.target.value),placeholder:"  ... (:   )",className:"w-full h-32 bg-gray-50 border border-gray-200 rounded-[6px] p-3 text-xs font-bold focus:ring-1 focus:ring-ios-rose transition-all resize-none"}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsx("button",{onClick:()=>f(null),className:"w-full py-3 bg-gray-100 text-ios-gray rounded-[6px] text-xs font-black ios-tap",children:""}),w.jsx("button",{onClick:()=>x(d,"rejected",a),className:"w-full py-3 bg-[#1C1C1E] text-white rounded-[6px] text-xs font-black shadow-lg shadow-black/20 ios-tap",children:" "})]})]})})}),w.jsx("div",{className:"px-6 py-3 bg-gray-50/50 border-t border-gray-50 flex items-center justify-between shrink-0",children:w.jsxs("div",{className:"flex gap-6",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-ios-indigo"}),w.jsxs("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:[": ",e.length,""]})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-ios-amber"}),w.jsxs("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:[": ",e.filter(y=>y.status==="pending").length,""]})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-ios-emerald"}),w.jsxs("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:[": ",e.filter(y=>y.status==="approved").length,""]})]})]})})]})},_8=({onLoginSuccess:e})=>{const[t,r]=le.useState("student"),[n,i]=le.useState("login"),[s,l]=le.useState({name:"",studentId:"",phone:"",password:"",pledgeAccepted:!1,privacyAccepted:!1}),[o,a]=le.useState(!1),[c,d]=le.useState(""),[f,h]=le.useState(""),[u,g]=le.useState(null),[m,p]=le.useState(()=>localStorage.getItem("schoolName")||"GOE");le.useEffect(()=>{(async()=>{const{data:Y}=await we.from("configs").select("value").eq("key","school_info").single();if(Y&&Y.value.name){const X=Y.value.name.split(" ")[0];p(X),localStorage.setItem("schoolName",Y.value.name)}})()},[]);const x=()=>d(""),v=F=>F.replace(/[^0-9]/g,"").replace(/^(\d{0,3})(\d{0,4})(\d{0,4})$/g,"$1-$2-$3").replace(/(-{1,2})$/g,""),y=F=>{r(F),i("login"),l({...s,name:"",studentId:"",phone:"",password:""}),x()},_=async F=>{F.preventDefault(),a(!0),d(""),t==="teacher"?await b():await S(),a(!1)},b=async()=>{const F=`${s.name}@goe.edu`,{data:Y,error:X}=await we.auth.signInWithPassword({email:F,password:s.password});if(X){d("    .");return}const{data:V}=await we.from("profiles").select("*").eq("id",Y.user.id).single();V?e({...V,full_name:V.full_name||s.name}):d("    .")},S=async()=>{const{data:F,error:Y}=await we.from("applicant_pool").select("*").eq("name",s.name).eq("student_id",s.studentId).maybeSingle();if(Y||!F){d("   /  .");return}if(g(F),t==="parent"&&(!F.phone_number||!F.pledge_accepted)){d("     .");return}F.status==="applied"?(l(X=>({...X,phone:"",pledgeAccepted:!1,privacyAccepted:!1})),i("pledge")):F.status==="pending"?i("pending"):F.status==="rejected"?(h(F.rejection_reason||"  ,   ."),i("rejected")):F.status==="approved"&&i("challenge")},C=async F=>{if(F.preventDefault(),!s.pledgeAccepted||!s.privacyAccepted){d("    .");return}if(s.phone.length<10){d("   .");return}a(!0);const{error:Y}=await we.from("applicant_pool").update({phone_number:s.phone,pledge_accepted:!0,privacy_accepted:!0,pledged_at:new Date().toISOString(),status:"pending"}).eq("id",u.id);Y?d("    ."):i("pending"),a(!1)},N=async F=>{F.preventDefault(),s.phone===u.phone_number?e({...u,full_name:u.name}):d("     .")};return w.jsx("div",{className:"min-h-screen bg-[#F2F2F7] flex items-center justify-center p-6 font-sans",children:w.jsxs("div",{className:"w-full max-w-md bg-white rounded-[2rem] shadow-2xl shadow-ios-indigo/10 overflow-hidden animate-spring-up border border-gray-100",children:[w.jsxs("div",{className:"bg-white p-10 text-[#1C1C1E] relative overflow-hidden border-b border-gray-100",children:[w.jsxs("div",{className:"relative z-10 space-y-2",children:[w.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gray-50 flex items-center justify-center mb-6 border border-gray-100 shadow-sm overflow-hidden",children:w.jsx(uu,{className:"w-7 h-7 text-ios-indigo"})}),w.jsx("h1",{className:"text-3xl font-black tracking-tighter italic leading-none",children:m}),w.jsx("p",{className:"text-[10px] font-black tracking-[0.3em] uppercase text-ios-indigo",children:"Study Cafe System"})]}),w.jsx("div",{className:"absolute -right-10 -top-10 w-40 h-40 bg-ios-indigo/5 rounded-full blur-3xl"})]}),w.jsxs("div",{className:"p-8 space-y-8",children:[n==="login"&&w.jsx("div",{className:"flex bg-gray-50 p-1.5 rounded-2xl gap-1",children:[{id:"student",label:"",icon:PS},{id:"parent",label:"",icon:Xu},{id:"teacher",label:"",icon:fS}].map(F=>w.jsxs("button",{onClick:()=>y(F.id),className:`flex-1 flex items-center justify-center gap-2 py-3 rounded-xl text-xs font-black transition-all ${t===F.id?"bg-white text-ios-indigo shadow-md":"text-ios-gray hover:text-[#1C1C1E]"}`,children:[w.jsx(F.icon,{className:`w-3.5 h-3.5 ${t===F.id?"text-ios-indigo":"text-ios-gray"}`}),F.label]},F.id))}),n==="login"&&w.jsxs("form",{onSubmit:_,className:"space-y-6",children:[w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"relative group",children:[w.jsx(tl,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),w.jsx("input",{required:!0,type:"text",placeholder:t==="teacher"?" (ID)":" (ID)",value:s.name,onChange:F=>l({...s,name:F.target.value}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none"})]}),w.jsxs("div",{className:"relative group",children:[w.jsx(VS,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),w.jsx("input",{required:!0,type:t==="teacher"?"password":"text",placeholder:t==="teacher"?" (PW)":" 5 (PW)",maxLength:t==="teacher"?void 0:5,value:t==="teacher"?s.password:s.studentId,onChange:F=>l(t==="teacher"?{...s,password:F.target.value}:{...s,studentId:F.target.value}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none"})]})]}),c&&w.jsxs("div",{className:"flex items-center gap-2 text-ios-rose bg-ios-rose/5 p-4 rounded-xl animate-shake",children:[w.jsx(Qn,{className:"w-4 h-4 shrink-0"}),w.jsx("p",{className:"text-[11px] font-black",children:c})]}),w.jsx("button",{type:"submit",disabled:o,className:"w-full py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-sm flex items-center justify-center gap-2 hover:scale-[1.02] active:scale-[0.98] transition-all shadow-xl shadow-gray-200/50 ios-tap disabled:opacity-50",children:o?w.jsx(Lf,{className:"w-4 h-4 animate-spin"}):w.jsxs(w.Fragment,{children:[" ",w.jsx(oS,{className:"w-4 h-4"})]})})]}),n==="pledge"&&w.jsxs("form",{onSubmit:C,className:"space-y-6 animate-spring-up",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight text-center",children:"  "}),w.jsx("p",{className:"text-[11px] text-ios-gray text-center font-bold",children:"      ."})]}),w.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 max-h-48 overflow-y-auto space-y-4 text-[11px] font-bold text-ios-gray leading-relaxed border border-gray-100",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[    ]"}),w.jsx("p",{children:"1.          ."}),w.jsx("p",{children:"2.       ."}),w.jsx("p",{children:"3.       ."})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[  ]"}),w.jsx("p",{children:"     ,      ."}),w.jsx("p",{children:"         ."})]})]}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{className:"relative group",children:[w.jsx(td,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),w.jsx("input",{required:!0,type:"tel",autoComplete:"off",placeholder:"   ( )",value:s.phone,onChange:F=>l({...s,phone:v(F.target.value)}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none"})]}),w.jsxs("label",{className:"flex items-start gap-3 p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100 transition-all border border-transparent hover:border-gray-200",children:[w.jsx("input",{type:"checkbox",checked:s.pledgeAccepted,onChange:F=>l({...s,pledgeAccepted:F.target.checked}),className:"mt-0.5"}),w.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:"     . ()"})]}),w.jsxs("label",{className:"flex items-start gap-3 p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100 transition-all border border-transparent hover:border-gray-200",children:[w.jsx("input",{type:"checkbox",checked:s.privacyAccepted,onChange:F=>l({...s,privacyAccepted:F.target.checked}),className:"mt-0.5"}),w.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:"    . ()"})]})]}),c&&w.jsx("div",{className:"text-ios-rose text-[11px] font-black text-center",children:c}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx("button",{type:"button",onClick:()=>i("login"),className:"flex-1 py-4 bg-gray-100 text-ios-gray rounded-2xl font-black text-sm ios-tap",children:""}),w.jsx("button",{type:"submit",disabled:o,className:"flex-[2] py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-sm shadow-xl shadow-gray-200/50 ios-tap",children:o?w.jsx(Lf,{className:"w-4 h-4 animate-spin mx-auto"}):"   "})]})]}),n==="pending"&&w.jsxs("div",{className:"text-center space-y-6 py-4 animate-spring-up",children:[w.jsx("div",{className:"w-20 h-20 rounded-[2rem] bg-ios-amber/10 flex items-center justify-center mx-auto mb-2 border border-ios-amber/20 shadow-inner",children:w.jsx(Lf,{className:"w-10 h-10 text-ios-amber animate-spin"})}),w.jsxs("div",{className:"space-y-2",children:[w.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:"  "}),w.jsx("p",{className:"text-xs text-ios-gray font-medium leading-relaxed px-4",children:"   .      ."})]}),w.jsx("button",{onClick:()=>i("login"),className:"text-xs font-black text-ios-indigo uppercase tracking-widest",children:""})]}),n==="rejected"&&w.jsxs("div",{className:"text-center space-y-6 py-4 animate-spring-up",children:[w.jsx("div",{className:"w-20 h-20 rounded-[2rem] bg-ios-rose/10 flex items-center justify-center mx-auto mb-2 border border-ios-rose/20 shadow-inner",children:w.jsx(Qn,{className:"w-10 h-10 text-ios-rose"})}),w.jsxs("div",{className:"space-y-2",children:[w.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:" "}),w.jsxs("div",{className:"bg-ios-rose/5 p-4 rounded-xl mt-4 max-w-[280px] mx-auto text-left",children:[w.jsx("p",{className:"text-[9px] font-black text-ios-rose/70 uppercase mb-1 tracking-widest",children:""}),w.jsx("p",{className:"text-[11px] font-bold text-ios-rose leading-relaxed",children:f})]})]}),w.jsx("button",{onClick:()=>i("login"),className:"w-full py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-xs shadow-xl shadow-gray-200/50 ios-tap uppercase tracking-widest",children:" "})]}),n==="challenge"&&w.jsxs("form",{onSubmit:N,className:"space-y-6 animate-spring-up",children:[w.jsxs("div",{className:"text-center space-y-4",children:[w.jsx("div",{className:"w-20 h-20 rounded-[2rem] bg-ios-emerald/10 flex items-center justify-center mx-auto border border-ios-emerald/20 shadow-inner",children:w.jsx(S0,{className:"w-10 h-10 text-ios-emerald"})}),w.jsxs("div",{className:"space-y-2",children:[w.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:" "}),w.jsx("p",{className:"text-[11px] text-ios-gray font-bold",children:"   ."})]})]}),w.jsxs("div",{className:"relative group",children:[w.jsx(td,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),w.jsx("input",{required:!0,type:"tel",placeholder:"  ",value:s.phone,onChange:F=>l({...s,phone:v(F.target.value)}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none"})]}),c&&w.jsx("div",{className:"text-ios-rose text-[11px] font-black text-center animate-shake",children:c}),w.jsx("button",{type:"submit",className:"w-full py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-sm shadow-xl shadow-gray-200/50 ios-tap",children:"  "})]})]})]})})},b8=()=>{const[e,t]=le.useState(new Date),[r,n]=le.useState([]),[i,s]=le.useState(null),[l,o]=le.useState([]),[a,c]=le.useState([]),[d,f]=le.useState([]),[h,u]=le.useState(!0),[g,m]=le.useState(!1),[p,x]=le.useState(!1),[v,y]=le.useState({date:Be(new Date,"yyyy-MM-dd"),reason:"",is_closed:!0}),[_,b]=le.useState(new Date().getFullYear()),[S,C]=le.useState(new Date().getFullYear());le.useEffect(()=>{N()},[]);const N=async()=>{const{data:k}=await we.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});k&&k.length>0&&(n(k),s(k[0].id))};le.useEffect(()=>{i&&F(_,i)},[_,i]);const F=async(k,P)=>{u(!0);const[A,T,j]=await Promise.all([we.from("operation_quarters").select("*").eq("academic_year",k).order("quarter",{ascending:!0}),we.from("operation_defaults").select("*").eq("zone_id",P).order("day_of_week",{ascending:!0}),we.from("operation_exceptions").select("*").eq("zone_id",P).order("exception_date",{ascending:!0})]),R=A.data||[],I=[1,2,3,4].map(K=>R.find(B=>B.quarter===K)||{quarter:K,start_date:null,end_date:null,academic_year:k}),L=R.filter(K=>K.quarter>4);o([...I,...L].sort((K,O)=>K.quarter-O.quarter)),T.data&&T.data.length>0?c(T.data):c([0,1,2,3,4,5,6].map(K=>({zone_id:P,day_of_week:K,morning:!1,dinner:!1,period1:!1,period2:!1}))),j.data&&f(j.data),u(!1)},Y=()=>{b(S)},X=(k,P,A)=>{const T=l.map(j=>j.quarter===k?{...j,[P]:A}:j);o(T)},V=async()=>{m(!0);const k=l.filter(A=>A.start_date||A.end_date).map(({id:A,quarter:T,start_date:j,end_date:R,quarter_name:z})=>({quarter:T,start_date:j||null,end_date:R||null,quarter_name:z||`${T}`,academic_year:_})),{error:P}=await we.from("operation_quarters").upsert(k,{onConflict:"academic_year, quarter"});P?alert("     : "+P.message):(alert("   ."),F(_)),m(!1)},te=async k=>{const P=l.find(A=>A.quarter===k);if(P){if(P.start_date&&P.end_date){const{count:A,error:T}=await we.from("bookings").select("*",{count:"exact",head:!0}).gte("date",P.start_date).lte("date",P.end_date);if(T)console.error("Error checking bookings:",T);else if(A>0){if(!window.confirm(` (${P.start_date} ~ ${P.end_date})  ${A}  .    ?
(    ,    .)`))return}else if(!window.confirm(`${k}   ?`))return}else if(!window.confirm(`${k}  ?`))return;try{const{error:A}=await we.from("operation_quarters").delete().eq("academic_year",_).eq("quarter",k);if(A)throw A;k<=4?o(T=>T.map(j=>j.quarter===k?{...j,start_date:null,end_date:null,quarter_name:null}:j)):o(T=>T.filter(j=>j.quarter!==k)),alert(`${k}   .`)}catch(A){console.error("Error deleting quarter:",A),alert("   .")}}},G=()=>{const k=l.length>0?Math.max(...l.map(P=>P.quarter)):0;o([...l,{quarter:k+1,start_date:null,end_date:null,academic_year:_}])},re=(k,P)=>{const A=a.map(T=>T.day_of_week===k?{...T,[P]:!T[P]}:T);c(A)},Z=async()=>{x(!0);const{error:k}=await we.from("operation_defaults").upsert(a,{onConflict:"day_of_week"});k?alert("      ."):(alert("    ."),F(_)),x(!1)},oe=async k=>{if(k.preventDefault(),!i)return;const{error:P}=await we.from("operation_exceptions").insert([{exception_date:v.date,reason:v.reason,is_closed:!0,zone_id:i}]);P||(y({...v,reason:""}),F(_,i))},ee=async k=>{await we.from("operation_exceptions").delete().eq("id",k),F(_)},E=()=>w.jsxs("div",{className:"flex items-center justify-between mb-6 px-2",children:[w.jsxs("div",{className:"flex items-center gap-6",children:[w.jsxs("div",{children:[w.jsx("h3",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:Be(e,"yyyy MMMM",{locale:Ii})}),w.jsx("p",{className:"text-[10px] font-black text-ios-indigo uppercase tracking-widest mt-1",children:"Operating Calendar"})]}),w.jsx("div",{className:"flex bg-gray-100 p-1 rounded-xl border border-gray-200",children:r.map(k=>w.jsx("button",{onClick:()=>s(k.id),className:`px-4 py-1.5 rounded-lg text-xs font-black transition-all ios-tap ${i===k.id?"bg-white text-[#1C1C1E] shadow-sm":"text-ios-gray hover:text-[#1C1C1E]"}`,children:k.name},k.id))})]}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx("button",{onClick:()=>t(of(e)),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",children:w.jsx(Ui,{className:"w-5 h-5 text-ios-gray"})}),w.jsx("button",{onClick:()=>t(Ul(e,1)),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",children:w.jsx(ln,{className:"w-5 h-5 text-ios-gray"})})]})]}),D=()=>{const k=["","","","","","",""];return w.jsx("div",{className:"grid grid-cols-7 mb-2 border-b border-gray-100",children:k.map((P,A)=>w.jsx("div",{className:`py-3 text-[10px] font-black uppercase text-center tracking-widest ${A===0?"text-ios-rose":A===6?"text-ios-indigo":"text-ios-gray"}`,children:P},A))})},U=()=>{const k=Ua(e),P=bl(k),A=Un(k),T=Sl(P),j=zl({start:A,end:T});return w.jsx("div",{className:"grid grid-cols-7 gap-px bg-gray-100 border border-gray-100 rounded-[12px] overflow-hidden shadow-sm",children:j.map((R,z)=>{const I=ys(R,new Date),L=Td(R,k),K=R.getDay(),O=Be(R,"yyyy-MM-dd"),B=d.find(H=>H.exception_date===O),M=l.find(H=>H.start_date&&H.end_date&&kl(R,{start:Et(H.start_date),end:Et(H.end_date)})),J=a.find(H=>H.day_of_week===K),se=M&&!B&&((J==null?void 0:J.morning)||(J==null?void 0:J.dinner)||(J==null?void 0:J.period1)||(J==null?void 0:J.period2));return w.jsxs("div",{className:`min-h-[100px] p-2 flex flex-col gap-1 transition-colors border-b border-r border-gray-100 ${L?B?"bg-red-50/30":se?"bg-[#f0f9ff]":"bg-white":"opacity-30 bg-gray-50"}`,children:[w.jsxs("div",{className:"flex justify-between items-start",children:[w.jsx("span",{className:`text-[11px] font-black ${I?"w-6 h-6 text-ios-indigo border-2 border-ios-indigo rounded-full flex items-center justify-center -mt-1 -ml-1 bg-white":K===0?"text-ios-rose":K===6?"text-ios-indigo":"text-[#1C1C1E]"}`,children:Be(R,"d")}),M&&w.jsxs("span",{className:"text-[8px] font-black bg-white/50 text-ios-indigo px-1.5 py-0.5 rounded-full uppercase tracking-tighter border border-ios-indigo/10",children:["Q",M.quarter]})]}),B?w.jsxs("div",{className:"mt-1 flex flex-col gap-1",children:[w.jsx("span",{className:"text-[10px] font-black text-red-600 uppercase tracking-widest",children:"CLOSED"}),w.jsx("span",{className:"text-[9px] font-bold text-ios-gray leading-tight",children:B.reason})]}):se?w.jsx("div",{className:"mt-1 flex flex-col gap-0.5",children:[{label:"",key:"morning"},{label:"",key:"dinner"},{label:"1",key:"period1"},{label:"2",key:"period2"}].map(H=>w.jsxs("div",{className:"flex justify-between items-center bg-white/40 rounded-[2px] px-1 py-0.5",children:[w.jsx("span",{className:"text-[8px] font-bold text-ios-gray",children:H.label}),w.jsx("span",{className:`text-[8px] font-black uppercase tracking-wider ${J[H.key]?"text-ios-indigo":"text-red-600"}`,children:J[H.key]?"OPEN":"CLOSED"})]},H.key))}):null]},z)})})};return h?w.jsx("div",{className:"h-full flex items-center justify-center",children:w.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-ios-indigo"})}):w.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 h-full overflow-hidden",children:[w.jsxs("div",{className:"flex-1 bg-white rounded-[6px] border border-gray-100 flex flex-col p-6 shadow-sm overflow-y-auto scrollbar-hide",children:[E(),D(),U()]}),w.jsxs("div",{className:"lg:w-96 flex flex-col gap-6 overflow-y-auto scrollbar-hide pb-6",children:[w.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 p-6 shadow-sm",children:[w.jsxs("div",{className:"flex items-center justify-between mb-6",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(Ia,{className:"w-4 h-4 text-ios-indigo"}),w.jsx("h4",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"  "})]}),w.jsx("div",{className:"flex gap-2",children:w.jsxs("button",{onClick:V,disabled:g,className:"bg-[#1C1C1E] text-white px-5 py-2.5 rounded-[8px] text-[11px] font-black uppercase tracking-widest flex items-center gap-2 hover:bg-gray-800 shadow-md transition-all active:scale-95",children:[w.jsx(fu,{className:"w-3.5 h-3.5"})," "]})})]}),w.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-[8px] border border-gray-100",children:[w.jsx("label",{className:"block text-[10px] font-black text-ios-gray uppercase tracking-widest mb-2",children:" "}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx("select",{value:S,onChange:k=>C(Number(k.target.value)),className:"flex-1 bg-white border border-gray-200 rounded-[6px] px-3 py-2 text-xs font-bold text-[#1C1C1E] focus:outline-none focus:ring-1 focus:ring-ios-indigo",children:[_-2,_-1,_,_+1,_+2].sort().map(k=>w.jsxs("option",{value:k,children:[k,""]},k))}),w.jsx("button",{onClick:Y,className:"bg-[#1C1C1E] text-white px-3 py-2 rounded-[6px] text-[10px] font-black uppercase whitespace-nowrap hover:bg-gray-800 transition-colors",children:""})]})]}),w.jsxs("div",{className:"space-y-6",children:[l.map(k=>w.jsxs("div",{className:"space-y-2",children:[w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsxs("p",{className:"text-[11px] font-black text-ios-indigo",children:[k.quarter,""]}),(k.start_date||k.end_date||k.quarter>4)&&w.jsx("button",{onClick:()=>te(k.quarter),className:"p-1 text-ios-gray hover:text-ios-rose transition-colors",title:" ",children:w.jsx(ji,{className:"w-3 h-3"})})]}),w.jsxs("span",{className:"text-[8px] font-bold text-ios-gray bg-gray-50 px-2 py-0.5 rounded-full uppercase tracking-widest",children:["Year ",_," - Q",k.quarter]})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[w.jsx("input",{type:"date",value:k.start_date||"",onChange:P=>X(k.quarter,"start_date",P.target.value),className:"bg-gray-50 border-none rounded-[6px] px-3 py-2 text-[11px] font-bold focus:ring-1 focus:ring-ios-indigo transition-all"}),w.jsx("input",{type:"date",value:k.end_date||"",onChange:P=>X(k.quarter,"end_date",P.target.value),className:"bg-gray-50 border-none rounded-[6px] px-3 py-2 text-[11px] font-bold focus:ring-1 focus:ring-ios-indigo transition-all"})]})]},k.quarter)),w.jsxs("button",{onClick:G,className:"w-full py-3 bg-gray-50 text-ios-gray border border-dashed border-gray-200 rounded-[6px] text-[10px] font-black uppercase tracking-wider flex items-center justify-center gap-1.5 hover:bg-gray-100 hover:text-[#1C1C1E] hover:border-gray-300 transition-all active:scale-95",children:[w.jsx(el,{className:"w-3.5 h-3.5"}),"  "]})]})]}),w.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 p-6 shadow-sm",children:[w.jsxs("div",{className:"flex items-center justify-between mb-6",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(Ia,{className:"w-4 h-4 text-ios-indigo"}),w.jsx("h4",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"   "})]}),w.jsxs("button",{onClick:Z,disabled:p,className:"bg-[#1C1C1E] text-white px-5 py-2.5 rounded-[8px] text-[11px] font-black uppercase tracking-widest flex items-center gap-2 hover:bg-gray-800 shadow-md transition-all active:scale-95",children:[w.jsx(fu,{className:"w-3.5 h-3.5"})," "]})]}),w.jsxs("div",{className:"space-y-1 overflow-x-auto",children:[w.jsxs("div",{className:"grid grid-cols-5 gap-2 pb-2 border-b border-gray-100 mb-2",children:[w.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest",children:""}),w.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest text-center",children:""}),w.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest text-center",children:""}),w.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest text-center",children:"1"}),w.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest text-center",children:"2"})]}),[1,2,3,4,5,6,0].map(k=>{const P=a.find(A=>A.day_of_week===k)||{day_of_week:k,morning:!1,dinner:!1,period1:!1,period2:!1};return w.jsxs("div",{className:"grid grid-cols-5 gap-2 items-center py-2 hover:bg-gray-50 rounded-[4px] transition-colors",children:[w.jsx("span",{className:`text-[10px] font-black ${k===0?"text-ios-rose":k===6?"text-ios-indigo":"text-[#1C1C1E]"}`,children:["","","","","","",""][k]}),["morning","dinner","period1","period2"].map(A=>w.jsx("div",{className:"flex justify-center",children:w.jsx("input",{type:"checkbox",checked:P[A],onChange:()=>re(k,A),className:"w-4 h-4 rounded-full border-gray-200 text-ios-indigo focus:ring-ios-indigo/20 transition-all cursor-pointer"})},A))]},k)})]})]}),w.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 p-6 shadow-sm flex-1",children:[w.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[w.jsx(Qn,{className:"w-4 h-4 text-ios-indigo"}),w.jsx("h4",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"()  "})]}),w.jsxs("form",{onSubmit:oe,className:"space-y-4 mb-8",children:[w.jsxs("div",{className:"space-y-1",children:[w.jsx("p",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest px-1",children:" "}),w.jsx("input",{type:"date",value:v.date,onChange:k=>y({...v,date:k.target.value}),className:"w-full bg-gray-50 border-none rounded-[6px] px-3 py-3 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all outline-none"})]}),w.jsxs("div",{className:"space-y-1",children:[w.jsx("p",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest px-1",children:" "}),w.jsx("input",{type:"text",placeholder:": ,   ",value:v.reason,onChange:k=>y({...v,reason:k.target.value}),className:"w-full bg-gray-50 border-none rounded-[6px] px-3 py-3 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all outline-none"})]}),w.jsxs("button",{type:"submit",disabled:!v.reason,className:"w-full py-3 bg-[#1C1C1E] text-white rounded-[6px] font-black text-[11px] uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-gray-800 transition-all disabled:opacity-30 disabled:hover:bg-[#1C1C1E]",children:[w.jsx(el,{className:"w-3 h-3"})," "]})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx("p",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest px-1 border-b border-gray-50 pb-2 mb-4",children:"  "}),w.jsxs("div",{className:"space-y-3 max-h-60 overflow-y-auto pr-2 scrollbar-hide",children:[d.length===0&&w.jsx("p",{className:"text-[10px] text-ios-gray italic text-center py-4",children:"  ."}),d.map(k=>w.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-[6px] hover:bg-ios-rose/5 transition-all group border border-transparent hover:border-ios-rose/10",children:[w.jsxs("div",{className:"flex-1",children:[w.jsx("p",{className:"text-[11px] font-black text-[#1C1C1E]",children:k.exception_date}),w.jsx("p",{className:"text-[9px] font-bold text-ios-gray truncate",children:k.reason})]}),w.jsx("button",{onClick:()=>ee(k.id),className:"p-1.5 text-ios-gray hover:text-ios-rose transition-colors opacity-0 group-hover:opacity-100",children:w.jsx(ji,{className:"w-3.5 h-3.5"})})]},k.id))]})]})]})]})]})},S8=()=>{var te,G,re;const[e,t]=le.useState(!0),[r,n]=le.useState(!1),[i,s]=le.useState(null),[l,o]=le.useState(!1),[a,c]=le.useState("GOE STUDY CAFE"),[d,f]=le.useState(""),[h,u]=le.useState([]),[g,m]=le.useState(null),[p,x]=le.useState([]),[v,y]=le.useState({points:[{lat:37.5665,lng:126.978,name:" "}],radius:100});le.useEffect(()=>{_()},[]),le.useEffect(()=>{g&&b(g)},[g]);const _=async()=>{t(!0);try{const{data:Z}=await we.from("configs").select("*").eq("key","school_info").single();Z&&(c(Z.value.name||"POGOK STUDY CAFE"),f(Z.value.address||""));const{data:oe,error:ee}=await we.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});if(ee)throw ee;u(oe||[]),oe&&oe.length>0&&m(oe[0].id)}catch(Z){console.error("Error fetching initial data:",Z),s("    .")}finally{t(!1)}},b=async Z=>{try{const{data:oe,error:ee}=await we.from("sessions").select("*").eq("zone_id",Z).order("start_time",{ascending:!0});if(ee)throw ee;x(oe||[]);const E=h.find(D=>D.id===Z);E!=null&&E.settings&&(E.settings.points?y(E.settings):E.settings.latitude?y({points:[{lat:E.settings.latitude,lng:E.settings.longitude,name:" "}],radius:E.settings.radius||100}):y({points:[{lat:37.5665,lng:126.978,name:" "}],radius:100}))}catch(oe){console.error("Error fetching zone data:",oe),s("     .")}},S=async()=>{const Z=prompt("     (: 2):");if(!Z)return;n(!0);const{data:oe,error:ee}=await we.from("zones").insert([{name:Z,settings:{points:[{lat:37.5665,lng:126.978,name:" "}],radius:100}}]).select().single();ee?alert("  : "+ee.message):(u([...h,oe]),m(oe.id)),n(!1)},C=async(Z,oe)=>{const ee=prompt("   :",oe);if(!ee||ee===oe)return;n(!0);const{error:E}=await we.from("zones").update({name:ee}).eq("id",Z);E?alert("  : "+E.message):u(h.map(D=>D.id===Z?{...D,name:ee}:D)),n(!1)},N=async Z=>{if(!confirm("   ?        ."))return;n(!0);const{error:oe}=await we.from("zones").delete().eq("id",Z);if(oe)alert("  : "+oe.message);else{const ee=h.filter(E=>E.id!==Z);u(ee),ee.length>0&&m(ee[0].id)}n(!1)},F=async()=>{if(!g)return;const Z=prompt("   (: 3):");if(!Z)return;const{data:oe,error:ee}=await we.from("sessions").insert([{zone_id:g,name:Z,start_time:"09:00:00",end_time:"12:00:00"}]).select().single();ee?alert("  "):x([...p,oe])},Y=async Z=>{if(!confirm(" ?"))return;const{error:oe}=await we.from("sessions").delete().eq("id",Z);oe?alert(" "):x(p.filter(ee=>ee.id!==Z))},X=(Z,oe,ee)=>{x(p.map(E=>E.id===Z?{...E,[oe]:ee}:E))},V=async()=>{n(!0),s(null),o(!1);try{if(await we.from("configs").upsert({key:"school_info",value:{name:a,address:d}}),g&&await we.from("zones").update({settings:v}).eq("id",g),p.length>0){const{error:Z}=await we.from("sessions").upsert(p.map(oe=>({id:oe.id,zone_id:g,name:oe.name,start_time:oe.start_time,end_time:oe.end_time})));if(Z)throw Z}o(!0),setTimeout(()=>o(!1),3e3)}catch(Z){s("   : "+Z.message)}finally{n(!1)}};return e?w.jsxs("div",{className:"h-full flex flex-col items-center justify-center bg-white rounded-t-[6px]",children:[w.jsx("div",{className:"w-10 h-10 border-4 border-ios-indigo/20 border-t-ios-indigo rounded-full animate-spin mb-4"}),w.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"   ..."})]}):w.jsxs("div",{className:"bg-white rounded-t-[6px] h-full flex flex-col overflow-hidden animate-spring-up",children:[w.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide p-8 pb-32",children:w.jsxs("div",{className:"max-w-4xl mx-auto space-y-12",children:[w.jsxs("div",{className:"flex items-center justify-between bg-gray-50/50 p-6 rounded-2xl border border-gray-100",children:[w.jsxs("div",{className:"flex items-center gap-4",children:[w.jsx("div",{className:"w-12 h-12 rounded-xl bg-[#1C1C1E] flex items-center justify-center shadow-lg",children:w.jsx(nd,{className:"w-6 h-6 text-white"})}),w.jsxs("div",{children:[w.jsx("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:"  "}),w.jsx("p",{className:"text-sm text-ios-gray font-bold",children:"       ."})]})]}),i&&w.jsxs("div",{className:"flex items-center gap-2 bg-ios-rose/10 px-4 py-2 rounded-lg border border-ios-rose/20 text-ios-rose font-bold text-xs animate-shake",children:[w.jsx(Qn,{className:"w-4 h-4"})," ",i]})]}),w.jsxs("section",{className:"space-y-6",children:[w.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[w.jsx(pk,{className:"w-5 h-5 text-ios-indigo"}),w.jsx("h3",{className:"text-lg font-black text-[#1C1C1E]",children:"  "})]}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest ml-1",children:" "}),w.jsx("input",{type:"text",value:a,onChange:Z=>c(Z.target.value),className:"w-full bg-gray-50 border border-transparent focus:bg-white focus:border-ios-indigo/20 rounded-xl px-5 py-4 text-base font-bold text-[#1C1C1E] transition-all outline-none"})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest ml-1",children:" "}),w.jsx("input",{type:"text",value:d,onChange:Z=>f(Z.target.value),className:"w-full bg-gray-50 border border-transparent focus:bg-white focus:border-ios-indigo/20 rounded-xl px-5 py-4 text-base font-bold text-[#1C1C1E] transition-all outline-none",placeholder:"     "})]})]})]}),w.jsx("hr",{className:"border-gray-100"}),w.jsxs("section",{className:"space-y-6",children:[w.jsxs("div",{className:"flex items-center justify-between mb-2",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx(uu,{className:"w-5 h-5 text-ios-amber"}),w.jsx("h3",{className:"text-lg font-black text-[#1C1C1E]",children:" (Zone) "})]}),w.jsxs("button",{onClick:S,className:"flex items-center gap-2 px-4 py-2 bg-[#1C1C1E] text-white rounded-lg text-xs font-bold shadow-lg hover:shadow-xl transition-all ios-tap",children:[w.jsx(el,{className:"w-4 h-4"}),"  "]})]}),w.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:h.map(Z=>w.jsx("div",{onClick:()=>m(Z.id),className:`relative p-5 rounded-2xl border-2 transition-all cursor-pointer group ${g===Z.id?"bg-ios-indigo/5 border-ios-indigo shadow-md":"bg-white border-gray-100 hover:border-gray-200"}`,children:w.jsxs("div",{className:"flex flex-col gap-1",children:[w.jsxs("div",{className:"flex items-start justify-between",children:[w.jsxs("span",{className:`text-[10px] font-black uppercase tracking-widest ${g===Z.id?"text-ios-indigo":"text-ios-gray"}`,children:["ZONE #",Z.id]}),w.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[w.jsx("button",{onClick:oe=>{oe.stopPropagation(),C(Z.id,Z.name)},className:"p-1.5 hover:bg-white rounded-md text-ios-gray hover:text-[#1C1C1E] shadow-sm",children:w.jsx(wk,{className:"w-3 h-3"})}),w.jsx("button",{onClick:oe=>{oe.stopPropagation(),N(Z.id)},className:"p-1.5 hover:bg-white rounded-md text-ios-gray hover:text-ios-rose shadow-sm",children:w.jsx(ji,{className:"w-3 h-3"})})]})]}),w.jsx("h4",{className:"text-lg font-black text-[#1C1C1E]",children:Z.name}),w.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[w.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${g===Z.id?"bg-ios-indigo animate-pulse":"bg-gray-300"}`}),w.jsx("span",{className:"text-[11px] font-bold text-ios-gray",children:g===Z.id?" ":" "})]})]})},Z.id))})]}),g&&w.jsxs(w.Fragment,{children:[w.jsx("hr",{className:"border-gray-100"}),w.jsxs("section",{className:"space-y-6 animate-fade-in",children:[w.jsxs("div",{className:"flex items-center justify-between mb-2",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx(Ia,{className:"w-5 h-5 text-ios-emerald"}),w.jsxs("h3",{className:"text-lg font-black text-[#1C1C1E]",children:["[",(te=h.find(Z=>Z.id===g))==null?void 0:te.name,"]   "]})]}),w.jsxs("button",{onClick:F,className:"flex items-center gap-2 px-4 py-2 bg-[#1C1C1E] text-white rounded-lg text-xs font-bold shadow-lg hover:shadow-xl transition-all ios-tap",children:[w.jsx(_S,{className:"w-4 h-4"}),"  "]})]}),w.jsx("div",{className:"grid grid-cols-1 gap-3",children:p.length===0?w.jsx("div",{className:"p-12 text-center bg-gray-50 border border-dashed border-gray-200 rounded-2xl",children:w.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"  . ' ' ."})}):p.map((Z,oe)=>w.jsxs("div",{className:"group flex items-center justify-between bg-white border border-gray-100 p-5 rounded-2xl hover:shadow-md transition-all",children:[w.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[w.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-50 flex items-center justify-center text-[11px] font-black text-ios-gray border border-gray-100",children:oe+1}),w.jsxs("div",{className:"w-40",children:[w.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest mb-1 block",children:" "}),w.jsx("input",{type:"text",value:Z.name,onChange:ee=>X(Z.id,"name",ee.target.value),className:"text-sm font-black text-[#1C1C1E] bg-transparent border-none p-0 focus:ring-0 w-full"})]}),w.jsxs("div",{className:"flex items-center gap-8",children:[w.jsxs("div",{children:[w.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest mb-1 block",children:""}),w.jsx("input",{type:"time",value:Z.start_time,onChange:ee=>X(Z.id,"start_time",ee.target.value),className:"text-sm font-black text-[#1C1C1E] border-none p-0 bg-transparent focus:ring-0 w-32 pr-2"})]}),w.jsx(ln,{className:"w-4 h-4 text-gray-200 mt-4"}),w.jsxs("div",{children:[w.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest mb-1 block",children:""}),w.jsx("input",{type:"time",value:Z.end_time,onChange:ee=>X(Z.id,"end_time",ee.target.value),className:"text-sm font-black text-[#1C1C1E] border-none p-0 bg-transparent focus:ring-0 w-32 pr-2"})]})]})]}),w.jsx("button",{onClick:()=>Y(Z.id),className:"p-2.5 text-ios-gray hover:text-ios-rose hover:bg-ios-rose/5 rounded-xl transition-all opacity-0 group-hover:opacity-100",children:w.jsx(ji,{className:"w-4 h-4"})})]},Z.id))})]}),w.jsx("hr",{className:"border-gray-100"}),w.jsxs("section",{className:"space-y-6 animate-fade-in",children:[w.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[w.jsx(JS,{className:"w-5 h-5 text-ios-rose"}),w.jsx("h3",{className:"text-lg font-black text-[#1C1C1E]",children:"    "})]}),w.jsxs("div",{className:"bg-gray-50/50 p-6 rounded-2xl border border-gray-100 space-y-8",children:[w.jsxs("div",{className:"flex items-start gap-3 p-4 bg-ios-amber/5 border border-ios-amber/10 rounded-xl",children:[w.jsx(O1,{className:"w-4 h-4 text-ios-amber mt-0.5"}),w.jsxs("p",{className:"text-xs text-ios-amber font-bold leading-relaxed",children:["     GPS     .",w.jsx("br",{}),"         ."]})]}),w.jsxs("div",{className:"space-y-4",children:[w.jsx("div",{className:"flex items-center justify-between",children:w.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest flex items-center gap-1.5 ml-1",children:"  "})}),w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx(lk,{className:"w-5 h-5 text-ios-indigo"}),w.jsx("div",{className:"flex-1",children:w.jsx("input",{type:"number",value:v.radius||100,onChange:Z=>y({...v,radius:parseInt(Z.target.value)}),className:"w-full bg-white border border-gray-100 rounded-xl px-4 py-3 text-sm font-bold text-[#1C1C1E] outline-none focus:ring-1 focus:ring-ios-indigo transition-all",placeholder:"  (m)"})}),w.jsx("span",{className:"text-xs font-bold text-ios-gray",children:"(m)"})]})]}),w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest flex items-center gap-1.5 ml-1",children:["   (",((G=v.points)==null?void 0:G.length)||0,")"]}),(!v.points||v.points.length<3)&&w.jsx("button",{onClick:()=>{const Z=[...v.points||[]];Z.push({lat:37.5665,lng:126.978,name:` ${Z.length+1}`}),y({...v,points:Z})},className:"text-[10px] font-bold text-ios-indigo hover:bg-ios-indigo/10 px-2 py-1 rounded transition-colors",children:"+  "})]}),w.jsx("div",{className:"space-y-3",children:(re=v.points)==null?void 0:re.map((Z,oe)=>w.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm relative group",children:[w.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[w.jsx(Cs,{className:"w-4 h-4 text-ios-rose"}),w.jsx("input",{type:"text",value:Z.name||` ${oe+1}`,onChange:ee=>{const E=[...v.points];E[oe].name=ee.target.value,y({...v,points:E})},className:"text-sm font-black text-[#1C1C1E] border-none p-0 focus:ring-0 w-32 bg-transparent",placeholder:" "}),v.points.length>1&&w.jsx("button",{onClick:()=>{const ee=v.points.filter((E,D)=>D!==oe);y({...v,points:ee})},className:"ml-auto p-1.5 text-gray-300 hover:text-ios-rose hover:bg-red-50 rounded-lg transition-colors",children:w.jsx(ji,{className:"w-3.5 h-3.5"})})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsxs("div",{children:[w.jsx("label",{className:"text-[9px] text-gray-400 font-bold mb-1 block",children:" (Latitude)"}),w.jsx("input",{type:"number",step:"0.000001",value:Z.lat,onChange:ee=>{const E=[...v.points];E[oe].lat=parseFloat(ee.target.value),y({...v,points:E})},className:"w-full bg-gray-50/50 border border-gray-100 rounded-lg px-3 py-2 text-xs font-bold font-mono text-[#1C1C1E] focus:bg-white focus:border-ios-indigo transition-all"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"text-[9px] text-gray-400 font-bold mb-1 block",children:" (Longitude)"}),w.jsx("input",{type:"number",step:"0.000001",value:Z.lng,onChange:ee=>{const E=[...v.points];E[oe].lng=parseFloat(ee.target.value),y({...v,points:E})},className:"w-full bg-gray-50/50 border border-gray-100 rounded-lg px-3 py-2 text-xs font-bold font-mono text-[#1C1C1E] focus:bg-white focus:border-ios-indigo transition-all"})]})]})]},oe))})]})]})]})]})]})}),w.jsx("div",{className:"flex-none p-6 border-t border-gray-100 bg-white/80 backdrop-blur-xl z-20",children:w.jsxs("div",{className:"max-w-4xl mx-auto flex items-center gap-4",children:[w.jsx("button",{onClick:V,disabled:r,className:`flex-1 py-5 rounded-2xl font-black text-base flex items-center justify-center gap-3 transition-all ios-tap shadow-lg ${l?"bg-[#1C1C1E] text-white":"bg-[#1C1C1E] text-white hover:bg-gray-800"}`,children:r?w.jsx("div",{className:"w-5 h-5 border-2 border-white/20 border-t-white rounded-full animate-spin"}):l?w.jsxs(w.Fragment,{children:[w.jsx(_a,{className:"w-5 h-5"}),"    "]}):w.jsxs(w.Fragment,{children:[w.jsx(fu,{className:"w-5 h-5"}),"    "]})}),l&&w.jsxs("div",{className:"bg-ios-emerald/10 text-ios-emerald px-6 py-5 rounded-2xl font-black text-sm animate-fade-in flex items-center gap-2",children:[w.jsx(Bi,{className:"w-4 h-4"})," !"]})]})})]})};function k8(){const[e,t]=le.useState(()=>{const te=localStorage.getItem("activeTab");if(te)return te;const G=localStorage.getItem("currentUser");if(G)try{const re=JSON.parse(G);if(["admin","teacher"].includes(re.role))return"admin"}catch(re){console.error("Failed to parse saved user",re)}return"map"}),[r,n]=le.useState(()=>localStorage.getItem("adminSubTab")||"attendance"),[i,s]=le.useState(null),[l,o]=le.useState(()=>{const te=localStorage.getItem("currentUser");return te?JSON.parse(te):null}),[a,c]=le.useState(Be(new Date,"yyyy-MM-dd")),[d,f]=le.useState(null),[h,u]=le.useState(()=>localStorage.getItem("schoolName")||"GOE STUDY CAFE"),[g,m]=le.useState(""),[p,x]=le.useState([]),[v,y]=le.useState(null),[_,b]=le.useState(!1),[S,C]=le.useState(()=>window.innerWidth<768&&window.innerHeight>window.innerWidth);le.useEffect(()=>{const te=()=>{C(window.innerWidth<768&&window.innerHeight>window.innerWidth)};return window.addEventListener("resize",te),()=>window.removeEventListener("resize",te)},[]);const N=async te=>{const G=te.trim();if(!G)return;b(!0);let re=[];try{let Z=we.from("profiles").select("*").eq("role","student").limit(50);/^\d{3}$/.test(G)?Z=Z.or(`username.like.${G}%,full_name.ilike.%${G}%,username.ilike.%${G}%`):Z=Z.or(`full_name.ilike.%${G}%,username.ilike.%${G}%`);const{data:oe,error:ee}=await Z;ee?console.error("[Search Error]",ee):re=oe.map(E=>({id:E.id,full_name:E.full_name,username:E.username,grade:E.grade||0,class_number:E.class_number||0,student_number:E.student_number||0,role:"student"})),x(re)}catch(Z){console.error("Search Error:",Z),x([])}finally{b(!1)}};le.useEffect(()=>{(async()=>{const{data:G}=await we.from("configs").select("value").eq("key","school_info").single();G&&(u(G.value.name),localStorage.setItem("schoolName",G.value.name))})()},[]),le.useEffect(()=>{l?localStorage.setItem("currentUser",JSON.stringify(l)):localStorage.removeItem("currentUser")},[l]),le.useEffect(()=>{localStorage.setItem("activeTab",e)},[e]),le.useEffect(()=>{localStorage.setItem("adminSubTab",r)},[r]);const F=()=>{o(null),localStorage.removeItem("currentUser"),localStorage.removeItem("activeTab"),localStorage.removeItem("adminSubTab"),t("map")};if(!l)return w.jsx(_8,{onLoginSuccess:te=>{o(te),["admin","teacher"].includes(te.role)&&t("admin")}});const Y=[{id:"admin",icon:nd,label:"/ ",roles:["admin","teacher"]},{id:"map",icon:uu,label:"",roles:["admin","student","parent","teacher"]},{id:"attendance",icon:Cs,label:" ",roles:["student"]},{id:"profile",icon:tl,label:"  ",roles:["student","parent"]}].filter(te=>!te.roles||te.roles.includes(l.role)),X=[{group:" ",items:[{id:"attendance",label:"  ",icon:rd,roles:["admin","teacher"]},{id:"safety",label:" /",icon:S0,roles:["admin","teacher"]}]},{group:"   ",items:[{id:"layout",label:"  ",icon:cu,roles:["admin"]},{id:"students",label:"  ",icon:Xu,roles:["admin"]},{id:"schedule",label:"  ",icon:Nl,roles:["admin"]}]},{group:" ",items:[{id:"settings",label:"   ",icon:nd,roles:["admin"]}]}].map(te=>({...te,items:te.items.filter(G=>G.roles.includes(l.role))})).filter(te=>te.items.length>0);return["admin","teacher"].includes(l.role),l.role==="teacher"||l.role==="admin"&&S?w.jsx(p8,{onLogout:F,currentUser:l}):l.role==="student"?w.jsx(v8,{onLogout:F,currentUser:l}):w.jsxs("div",{className:"flex flex-col h-screen bg-[#F2F2F7] text-[#1C1C1E] overflow-hidden font-sans selection:bg-ios-indigo/10",children:[w.jsxs("header",{className:"bg-white border-b border-gray-200/60 px-4 py-2 lg:px-8 flex items-center justify-between z-40 shrink-0 shadow-sm",children:[w.jsxs("div",{className:"flex items-center gap-6",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"w-9 h-9 rounded-[6px] bg-[#1C1C1E] flex items-center justify-center shadow-lg shadow-black/10",children:w.jsx(uu,{className:"w-5 h-5 text-white"})}),w.jsxs("div",{children:[w.jsx("h1",{className:"text-lg font-black tracking-tighter leading-tight italic uppercase text-[#1C1C1E]",children:h.split(" ")[0]}),w.jsx("p",{className:"text-[8px] font-black tracking-[0.2em] text-ios-indigo uppercase opacity-80",children:h.split(" ").slice(1).join(" ")||"Study Cafe"})]})]}),w.jsx("nav",{className:"flex items-center gap-1 bg-gray-50/80 p-1 rounded-[10px] border border-gray-100 ml-4 backdrop-blur-md",children:Y.map(te=>w.jsxs("button",{onClick:()=>t(te.id),className:`flex items-center gap-2 px-4 py-2 rounded-[8px] transition-all duration-300 group relative ${e===te.id?"bg-white shadow-md text-[#1C1C1E]":"text-[#1C1C1E]/40 hover:text-[#1C1C1E] hover:bg-white/50"}`,children:[w.jsx(te.icon,{className:`w-4 h-4 transition-transform duration-300 ${e===te.id?"text-ios-indigo":"group-hover:scale-110"}`}),w.jsx("span",{className:"font-black text-[13px]",children:te.label}),e===te.id&&w.jsx("div",{className:"absolute -bottom-[5px] left-1/2 -translate-x-1/2 w-1 h-1 rounded-full bg-ios-indigo"})]},te.id))}),e==="map"&&["admin","teacher"].includes(l.role)&&w.jsxs("div",{className:"relative ml-4 z-50",children:[v?w.jsxs("div",{className:"flex items-center gap-3 bg-white px-3 py-1.5 rounded-[12px] border-2 border-ios-indigo/20 shadow-sm animate-fade-in-scale",children:[w.jsxs("div",{className:"flex items-center gap-2 pr-2 border-r border-gray-100",children:[w.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-100 text-gray-700 flex items-center justify-center text-[10px] font-black shadow-sm border border-gray-200",children:v.full_name[0]}),w.jsxs("div",{className:"flex flex-col gap-0.5",children:[w.jsx("span",{className:"text-[12px] font-black text-[#1C1C1E]",children:v.full_name}),w.jsxs("span",{className:"text-[9px] text-gray-500 font-medium",children:["   (",v.username,")"]})]})]}),w.jsxs("button",{onClick:()=>{m(""),x([]),y(null)},className:"flex items-center gap-1.5 bg-gray-50 hover:bg-ios-rose/10 text-gray-500 hover:text-ios-rose px-2 py-1.5 rounded-[8px] transition-all group",children:[w.jsx(uk,{className:"w-3 h-3 group-hover:rotate-180 transition-transform duration-500"}),w.jsx("span",{className:"text-[10px] font-bold",children:"  "})]})]}):w.jsxs("div",{className:"group flex items-center gap-2 bg-gray-50/80 px-3 py-1.5 rounded-[10px] border border-gray-100 backdrop-blur-md transition-all focus-within:bg-white focus-within:shadow-md focus-within:w-72 w-56 focus-within:border-ios-indigo/50",children:[w.jsx(rd,{className:"w-3.5 h-3.5 text-gray-400 group-focus-within:text-ios-indigo transition-colors"}),w.jsx("input",{type:"text",value:g,onChange:te=>{m(te.target.value),te.target.value.length>=1?N(te.target.value):x([])},placeholder:"  (  )",className:"bg-transparent border-none outline-none text-[12px] font-bold placeholder:text-gray-400 w-full text-gray-700"})]}),p.length>0&&!v&&w.jsx("div",{className:"absolute top-full left-0 mt-2 w-72 bg-white/90 backdrop-blur-xl rounded-[12px] shadow-xl border border-gray-100 overflow-hidden animate-spring-up p-1 z-50",children:p.map(te=>w.jsxs("button",{onClick:()=>{y(te),m(""),x([])},className:"w-full text-left px-3 py-2.5 hover:bg-ios-indigo/5 rounded-[8px] transition-colors flex items-center justify-between group border-b border-gray-50 last:border-0",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"w-8 h-8 rounded-[8px] bg-gray-100 group-hover:bg-white group-hover:shadow-sm flex items-center justify-center text-[10px] font-bold text-gray-500 group-hover:text-ios-indigo transition-all",children:te.full_name[0]}),w.jsxs("div",{children:[w.jsx("div",{className:"text-[13px] font-bold text-[#1C1C1E] group-hover:text-ios-indigo transition-colors",children:te.full_name}),w.jsxs("div",{className:"text-[10px] text-gray-400 font-mono flex items-center gap-1",children:[w.jsxs("span",{children:["ID: ",te.username]}),te.grade>0&&w.jsx("span",{className:"text-gray-300",children:"|"}),te.grade>0&&w.jsxs("span",{children:[te.grade," ",te.class_number," ",te.student_number,""]})]})]})]}),w.jsx("div",{className:"text-[10px] bg-gray-50 text-gray-400 px-2 py-1 rounded-[6px] group-hover:bg-ios-indigo group-hover:text-white transition-colors font-bold",children:""})]},te.id))})]})]}),w.jsxs("div",{className:"flex items-center gap-6",children:[w.jsxs("div",{className:"flex items-center gap-3 bg-gray-50/50 p-1 px-4 py-1.5 rounded-[10px] border border-gray-200/30",children:[w.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-white border border-gray-100 flex items-center justify-center shadow-sm",children:w.jsx(tl,{className:"w-4 h-4 text-ios-indigo"})}),w.jsxs("div",{className:"text-left",children:[w.jsx("p",{className:"text-[13px] font-black leading-none text-[#1C1C1E]",children:l==null?void 0:l.full_name}),w.jsx("p",{className:"text-[9px] font-black text-ios-indigo tracking-widest mt-1 uppercase opacity-60 italic",children:l==null?void 0:l.role})]})]}),w.jsxs("button",{onClick:F,className:"flex items-center gap-2 p-2 px-4 rounded-[10px] text-ios-gray hover:text-ios-rose hover:bg-ios-rose/5 transition-all ios-tap border border-transparent hover:border-ios-rose/10 group",children:[w.jsx($u,{className:"w-4 h-4 group-hover:-translate-x-0.5 transition-transform"}),w.jsx("span",{className:"font-bold text-[13px]",children:""})]})]})]}),w.jsx("main",{className:"flex-1 h-full flex overflow-hidden relative",children:e==="admin"?w.jsxs("div",{className:"flex-1 flex overflow-hidden w-full",children:[w.jsxs("aside",{className:"w-64 bg-white border-r border-gray-100 flex flex-col p-6 shrink-0 z-30 shadow-[4px_0_24px_rgba(0,0,0,0.02)]",children:[w.jsx("div",{className:"flex-1 space-y-8",children:X.map((te,G)=>w.jsxs("div",{className:"space-y-3",children:[w.jsx("h5",{className:"text-[10px] font-black text-ios-gray uppercase tracking-[0.2em] px-2",children:te.group}),w.jsx("div",{className:"space-y-1",children:te.items.map(re=>w.jsxs("button",{onClick:()=>n(re.id),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-bold transition-all ios-tap group ${r===re.id?"bg-white text-[#1C1C1E] shadow-md border border-gray-100":"text-ios-gray hover:text-[#1C1C1E] hover:bg-gray-50"}`,children:[w.jsx(re.icon,{className:`w-4 h-4 ${r===re.id?"text-ios-indigo":"group-hover:text-ios-indigo transition-colors"}`}),re.label]},re.id))})]},G))}),w.jsx("div",{className:"pt-6 border-t border-gray-50",children:w.jsx("p",{className:"text-[8px] font-bold text-gray-300 tracking-tighter uppercase italic",children:"Copyright murmurgene 2026. All rights reserved."})})]}),w.jsx("div",{className:"flex-1 bg-[#F2F2F7] p-6 overflow-hidden",children:w.jsx("div",{className:"h-full w-full rounded-2xl overflow-hidden shadow-sm border border-black/5 bg-white",children:r==="layout"?w.jsx(hE,{}):r==="attendance"?w.jsx(t_,{}):r==="students"?w.jsx(w8,{}):r==="schedule"?w.jsx(b8,{}):r==="settings"?w.jsx(S8,{}):w.jsx(d8,{})})})]}):w.jsx("div",{className:"flex-1 h-full flex flex-col overflow-hidden p-6",children:e==="attendance"?w.jsx("div",{className:"h-full flex flex-col items-center justify-center",children:w.jsx(h_,{})}):e==="profile"?w.jsx("div",{className:"h-full overflow-y-auto scrollbar-hide",children:w.jsx(d_,{})}):w.jsx("div",{className:"flex-1 flex flex-col overflow-hidden pt-2",children:w.jsxs("section",{className:"flex-1 flex flex-col xl:flex-row gap-6 leading-normal overflow-hidden",children:[w.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:w.jsx("div",{className:"flex-1 w-full bg-white rounded-2xl border border-black/5 overflow-hidden p-2 shadow-sm",children:w.jsx(f_,{onSelectSeat:s,selectedProxyUser:v,viewDate:a,onDateChange:c,selectedZoneId:d,onZoneChange:f})})}),w.jsx("div",{className:"xl:w-80 h-full overflow-y-auto scrollbar-hide bg-white rounded-2xl border border-black/5 shadow-sm",children:w.jsx(y8,{selectedSeat:i,onComplete:()=>s(null),targetUser:v,loggedInUser:l,initialDate:a,onDateChange:c,currentZoneId:d})})]})})})})]})}class C8 extends Sx.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){this.setState({error:t,errorInfo:r}),console.error("Uncaught error:",t,r)}render(){return this.state.hasError?w.jsxs("div",{className:"p-8 bg-white h-screen w-full flex flex-col items-center justify-center text-[#1C1C1E]",children:[w.jsx("h1",{className:"text-2xl font-black mb-4 text-ios-rose",children:"Application Crash"}),w.jsxs("pre",{className:"bg-gray-100 p-4 rounded text-xs overflow-auto max-w-full",children:[this.state.error&&this.state.error.toString(),w.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]}),w.jsx("button",{onClick:()=>window.location.reload(),className:"mt-6 px-6 py-3 bg-[#1C1C1E] text-white rounded-[6px] font-black",children:"Reload Application"})]}):this.props.children}}lh.createRoot(document.getElementById("root")).render(w.jsx(Sx.StrictMode,{children:w.jsx(C8,{children:w.jsx(k8,{})})}));
