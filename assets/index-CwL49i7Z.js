var wN=Object.defineProperty;var _N=(e,t,r)=>t in e?wN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ft=(e,t,r)=>_N(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var cY=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bN(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function SN(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var BS={exports:{}},Lg={},US={exports:{}},or={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Id=Symbol.for("react.element"),kN=Symbol.for("react.portal"),CN=Symbol.for("react.fragment"),EN=Symbol.for("react.strict_mode"),TN=Symbol.for("react.profiler"),NN=Symbol.for("react.provider"),AN=Symbol.for("react.context"),ON=Symbol.for("react.forward_ref"),PN=Symbol.for("react.suspense"),FN=Symbol.for("react.memo"),jN=Symbol.for("react.lazy"),Cw=Symbol.iterator;function DN(e){return e===null||typeof e!="object"?null:(e=Cw&&e[Cw]||e["@@iterator"],typeof e=="function"?e:null)}var WS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},zS=Object.assign,HS={};function bf(e,t,r){this.props=e,this.context=t,this.refs=HS,this.updater=r||WS}bf.prototype.isReactComponent={};bf.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};bf.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function $S(){}$S.prototype=bf.prototype;function qv(e,t,r){this.props=e,this.context=t,this.refs=HS,this.updater=r||WS}var Gv=qv.prototype=new $S;Gv.constructor=qv;zS(Gv,bf.prototype);Gv.isPureReactComponent=!0;var Ew=Array.isArray,VS=Object.prototype.hasOwnProperty,Xv={current:null},qS={key:!0,ref:!0,__self:!0,__source:!0};function GS(e,t,r){var n,i={},s=null,l=null;if(t!=null)for(n in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(s=""+t.key),t)VS.call(t,n)&&!qS.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var a=Array(o),c=0;c<o;c++)a[c]=arguments[c+2];i.children=a}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Id,type:e,key:s,ref:l,props:i,_owner:Xv.current}}function LN(e,t){return{$$typeof:Id,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Yv(e){return typeof e=="object"&&e!==null&&e.$$typeof===Id}function IN(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Tw=/\/+/g;function G1(e,t){return typeof e=="object"&&e!==null&&e.key!=null?IN(""+e.key):t.toString(36)}function wp(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Id:case kN:l=!0}}if(l)return l=e,i=i(l),e=n===""?"."+G1(l,0):n,Ew(i)?(r="",e!=null&&(r=e.replace(Tw,"$&/")+"/"),wp(i,t,r,"",function(c){return c})):i!=null&&(Yv(i)&&(i=LN(i,r+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(Tw,"$&/")+"/")+e)),t.push(i)),1;if(l=0,n=n===""?".":n+":",Ew(e))for(var o=0;o<e.length;o++){s=e[o];var a=n+G1(s,o);l+=wp(s,t,r,a,i)}else if(a=DN(e),typeof a=="function")for(e=a.call(e),o=0;!(s=e.next()).done;)s=s.value,a=n+G1(s,o++),l+=wp(s,t,r,a,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function A0(e,t,r){if(e==null)return e;var n=[],i=0;return wp(e,n,"","",function(s){return t.call(r,s,i++)}),n}function RN(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Vi={current:null},_p={transition:null},MN={ReactCurrentDispatcher:Vi,ReactCurrentBatchConfig:_p,ReactCurrentOwner:Xv};function XS(){throw Error("act(...) is not supported in production builds of React.")}or.Children={map:A0,forEach:function(e,t,r){A0(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return A0(e,function(){t++}),t},toArray:function(e){return A0(e,function(t){return t})||[]},only:function(e){if(!Yv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};or.Component=bf;or.Fragment=CN;or.Profiler=TN;or.PureComponent=qv;or.StrictMode=EN;or.Suspense=PN;or.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=MN;or.act=XS;or.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=zS({},e.props),i=e.key,s=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,l=Xv.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(a in t)VS.call(t,a)&&!qS.hasOwnProperty(a)&&(n[a]=t[a]===void 0&&o!==void 0?o[a]:t[a])}var a=arguments.length-2;if(a===1)n.children=r;else if(1<a){o=Array(a);for(var c=0;c<a;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Id,type:e.type,key:i,ref:s,props:n,_owner:l}};or.createContext=function(e){return e={$$typeof:AN,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:NN,_context:e},e.Consumer=e};or.createElement=GS;or.createFactory=function(e){var t=GS.bind(null,e);return t.type=e,t};or.createRef=function(){return{current:null}};or.forwardRef=function(e){return{$$typeof:ON,render:e}};or.isValidElement=Yv;or.lazy=function(e){return{$$typeof:jN,_payload:{_status:-1,_result:e},_init:RN}};or.memo=function(e,t){return{$$typeof:FN,type:e,compare:t===void 0?null:t}};or.startTransition=function(e){var t=_p.transition;_p.transition={};try{e()}finally{_p.transition=t}};or.unstable_act=XS;or.useCallback=function(e,t){return Vi.current.useCallback(e,t)};or.useContext=function(e){return Vi.current.useContext(e)};or.useDebugValue=function(){};or.useDeferredValue=function(e){return Vi.current.useDeferredValue(e)};or.useEffect=function(e,t){return Vi.current.useEffect(e,t)};or.useId=function(){return Vi.current.useId()};or.useImperativeHandle=function(e,t,r){return Vi.current.useImperativeHandle(e,t,r)};or.useInsertionEffect=function(e,t){return Vi.current.useInsertionEffect(e,t)};or.useLayoutEffect=function(e,t){return Vi.current.useLayoutEffect(e,t)};or.useMemo=function(e,t){return Vi.current.useMemo(e,t)};or.useReducer=function(e,t,r){return Vi.current.useReducer(e,t,r)};or.useRef=function(e){return Vi.current.useRef(e)};or.useState=function(e){return Vi.current.useState(e)};or.useSyncExternalStore=function(e,t,r){return Vi.current.useSyncExternalStore(e,t,r)};or.useTransition=function(){return Vi.current.useTransition()};or.version="18.3.1";US.exports=or;var ye=US.exports;const Bp=bN(ye);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BN=ye,UN=Symbol.for("react.element"),WN=Symbol.for("react.fragment"),zN=Object.prototype.hasOwnProperty,HN=BN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$N={key:!0,ref:!0,__self:!0,__source:!0};function YS(e,t,r){var n,i={},s=null,l=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)zN.call(t,n)&&!$N.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:UN,type:e,key:s,ref:l,props:i,_owner:HN.current}}Lg.Fragment=WN;Lg.jsx=YS;Lg.jsxs=YS;BS.exports=Lg;var v=BS.exports,hx={},KS={exports:{}},Ns={},JS={exports:{}},QS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(J,P){var H=J.length;J.push(P);e:for(;0<H;){var U=H-1>>>1,S=J[U];if(0<i(S,P))J[U]=P,J[H]=S,H=U;else break e}}function r(J){return J.length===0?null:J[0]}function n(J){if(J.length===0)return null;var P=J[0],H=J.pop();if(H!==P){J[0]=H;e:for(var U=0,S=J.length,I=S>>>1;U<I;){var O=2*(U+1)-1,N=J[O],R=O+1,z=J[R];if(0>i(N,H))R<S&&0>i(z,N)?(J[U]=z,J[R]=H,U=R):(J[U]=N,J[O]=H,U=O);else if(R<S&&0>i(z,H))J[U]=z,J[R]=H,U=R;else break e}}return P}function i(J,P){var H=J.sortIndex-P.sortIndex;return H!==0?H:J.id-P.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var a=[],c=[],f=1,h=null,d=3,u=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(J){for(var P=r(c);P!==null;){if(P.callback===null)n(c);else if(P.startTime<=J)n(c),P.sortIndex=P.expirationTime,t(a,P);else break;P=r(c)}}function _(J){if(m=!1,w(J),!p)if(r(a)!==null)p=!0,Q(C);else{var P=r(c);P!==null&&ne(_,P.startTime-J)}}function C(J,P){p=!1,m&&(m=!1,x(A),A=-1),u=!0;var H=d;try{for(w(P),h=r(a);h!==null&&(!(h.expirationTime>P)||J&&!F());){var U=h.callback;if(typeof U=="function"){h.callback=null,d=h.priorityLevel;var S=U(h.expirationTime<=P);P=e.unstable_now(),typeof S=="function"?h.callback=S:h===r(a)&&n(a),w(P)}else n(a);h=r(a)}if(h!==null)var I=!0;else{var O=r(c);O!==null&&ne(_,O.startTime-P),I=!1}return I}finally{h=null,d=H,u=!1}}var E=!1,T=null,A=-1,j=5,B=-1;function F(){return!(e.unstable_now()-B<j)}function L(){if(T!==null){var J=e.unstable_now();B=J;var P=!0;try{P=T(!0,J)}finally{P?G():(E=!1,T=null)}}else E=!1}var G;if(typeof y=="function")G=function(){y(L)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,re=X.port2;X.port1.onmessage=L,G=function(){re.postMessage(null)}}else G=function(){g(L,0)};function Q(J){T=J,E||(E=!0,G())}function ne(J,P){A=g(function(){J(e.unstable_now())},P)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(J){J.callback=null},e.unstable_continueExecution=function(){p||u||(p=!0,Q(C))},e.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<J?Math.floor(1e3/J):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return r(a)},e.unstable_next=function(J){switch(d){case 1:case 2:case 3:var P=3;break;default:P=d}var H=d;d=P;try{return J()}finally{d=H}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(J,P){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var H=d;d=J;try{return P()}finally{d=H}},e.unstable_scheduleCallback=function(J,P,H){var U=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?U+H:U):H=U,J){case 1:var S=-1;break;case 2:S=250;break;case 5:S=1073741823;break;case 4:S=1e4;break;default:S=5e3}return S=H+S,J={id:f++,callback:P,priorityLevel:J,startTime:H,expirationTime:S,sortIndex:-1},H>U?(J.sortIndex=H,t(c,J),r(a)===null&&J===r(c)&&(m?(x(A),A=-1):m=!0,ne(_,H-U))):(J.sortIndex=S,t(a,J),p||u||(p=!0,Q(C))),J},e.unstable_shouldYield=F,e.unstable_wrapCallback=function(J){var P=d;return function(){var H=d;d=P;try{return J.apply(this,arguments)}finally{d=H}}}})(QS);JS.exports=QS;var VN=JS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qN=ye,Es=VN;function pt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ZS=new Set,Gh={};function Hc(e,t){uf(e,t),uf(e+"Capture",t)}function uf(e,t){for(Gh[e]=t,e=0;e<t.length;e++)ZS.add(t[e])}var Ao=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dx=Object.prototype.hasOwnProperty,GN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Nw={},Aw={};function XN(e){return dx.call(Aw,e)?!0:dx.call(Nw,e)?!1:GN.test(e)?Aw[e]=!0:(Nw[e]=!0,!1)}function YN(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function KN(e,t,r,n){if(t===null||typeof t>"u"||YN(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function qi(e,t,r,n,i,s,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=l}var mi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){mi[e]=new qi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];mi[t]=new qi(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){mi[e]=new qi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){mi[e]=new qi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){mi[e]=new qi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){mi[e]=new qi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){mi[e]=new qi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){mi[e]=new qi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){mi[e]=new qi(e,5,!1,e.toLowerCase(),null,!1,!1)});var Kv=/[\-:]([a-z])/g;function Jv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Kv,Jv);mi[t]=new qi(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Kv,Jv);mi[t]=new qi(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Kv,Jv);mi[t]=new qi(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){mi[e]=new qi(e,1,!1,e.toLowerCase(),null,!1,!1)});mi.xlinkHref=new qi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){mi[e]=new qi(e,1,!1,e.toLowerCase(),null,!0,!0)});function Qv(e,t,r,n){var i=mi.hasOwnProperty(t)?mi[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(KN(t,r,i,n)&&(r=null),n||i===null?XN(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Lo=qN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O0=Symbol.for("react.element"),Fu=Symbol.for("react.portal"),ju=Symbol.for("react.fragment"),Zv=Symbol.for("react.strict_mode"),px=Symbol.for("react.profiler"),ek=Symbol.for("react.provider"),tk=Symbol.for("react.context"),e2=Symbol.for("react.forward_ref"),gx=Symbol.for("react.suspense"),mx=Symbol.for("react.suspense_list"),t2=Symbol.for("react.memo"),ol=Symbol.for("react.lazy"),rk=Symbol.for("react.offscreen"),Ow=Symbol.iterator;function rh(e){return e===null||typeof e!="object"?null:(e=Ow&&e[Ow]||e["@@iterator"],typeof e=="function"?e:null)}var nn=Object.assign,X1;function mh(e){if(X1===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);X1=t&&t[1]||""}return`
`+X1+e}var Y1=!1;function K1(e,t){if(!e||Y1)return"";Y1=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),l=i.length-1,o=s.length-1;1<=l&&0<=o&&i[l]!==s[o];)o--;for(;1<=l&&0<=o;l--,o--)if(i[l]!==s[o]){if(l!==1||o!==1)do if(l--,o--,0>o||i[l]!==s[o]){var a=`
`+i[l].replace(" at new "," at ");return e.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",e.displayName)),a}while(1<=l&&0<=o);break}}}finally{Y1=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?mh(e):""}function JN(e){switch(e.tag){case 5:return mh(e.type);case 16:return mh("Lazy");case 13:return mh("Suspense");case 19:return mh("SuspenseList");case 0:case 2:case 15:return e=K1(e.type,!1),e;case 11:return e=K1(e.type.render,!1),e;case 1:return e=K1(e.type,!0),e;default:return""}}function xx(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ju:return"Fragment";case Fu:return"Portal";case px:return"Profiler";case Zv:return"StrictMode";case gx:return"Suspense";case mx:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case tk:return(e.displayName||"Context")+".Consumer";case ek:return(e._context.displayName||"Context")+".Provider";case e2:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case t2:return t=e.displayName||null,t!==null?t:xx(e.type)||"Memo";case ol:t=e._payload,e=e._init;try{return xx(e(t))}catch{}}return null}function QN(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return xx(t);case 8:return t===Zv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Al(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function nk(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ZN(e){var t=nk(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(l){n=""+l,s.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function P0(e){e._valueTracker||(e._valueTracker=ZN(e))}function ik(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=nk(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Up(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function vx(e,t){var r=t.checked;return nn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Pw(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Al(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function sk(e,t){t=t.checked,t!=null&&Qv(e,"checked",t,!1)}function yx(e,t){sk(e,t);var r=Al(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?wx(e,t.type,r):t.hasOwnProperty("defaultValue")&&wx(e,t.type,Al(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Fw(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function wx(e,t,r){(t!=="number"||Up(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var xh=Array.isArray;function Gu(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Al(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function _x(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(pt(91));return nn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function jw(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(pt(92));if(xh(r)){if(1<r.length)throw Error(pt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Al(r)}}function ak(e,t){var r=Al(t.value),n=Al(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Dw(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function ok(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bx(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?ok(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var F0,lk=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(F0=F0||document.createElement("div"),F0.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=F0.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Xh(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Ch={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},eA=["Webkit","ms","Moz","O"];Object.keys(Ch).forEach(function(e){eA.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ch[t]=Ch[e]})});function ck(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Ch.hasOwnProperty(e)&&Ch[e]?(""+t).trim():t+"px"}function uk(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=ck(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var tA=nn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sx(e,t){if(t){if(tA[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(pt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(pt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(pt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(pt(62))}}function kx(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cx=null;function r2(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ex=null,Xu=null,Yu=null;function Lw(e){if(e=Bd(e)){if(typeof Ex!="function")throw Error(pt(280));var t=e.stateNode;t&&(t=Ug(t),Ex(e.stateNode,e.type,t))}}function fk(e){Xu?Yu?Yu.push(e):Yu=[e]:Xu=e}function hk(){if(Xu){var e=Xu,t=Yu;if(Yu=Xu=null,Lw(e),t)for(e=0;e<t.length;e++)Lw(t[e])}}function dk(e,t){return e(t)}function pk(){}var J1=!1;function gk(e,t,r){if(J1)return e(t,r);J1=!0;try{return dk(e,t,r)}finally{J1=!1,(Xu!==null||Yu!==null)&&(pk(),hk())}}function Yh(e,t){var r=e.stateNode;if(r===null)return null;var n=Ug(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(pt(231,t,typeof r));return r}var Tx=!1;if(Ao)try{var nh={};Object.defineProperty(nh,"passive",{get:function(){Tx=!0}}),window.addEventListener("test",nh,nh),window.removeEventListener("test",nh,nh)}catch{Tx=!1}function rA(e,t,r,n,i,s,l,o,a){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(f){this.onError(f)}}var Eh=!1,Wp=null,zp=!1,Nx=null,nA={onError:function(e){Eh=!0,Wp=e}};function iA(e,t,r,n,i,s,l,o,a){Eh=!1,Wp=null,rA.apply(nA,arguments)}function sA(e,t,r,n,i,s,l,o,a){if(iA.apply(this,arguments),Eh){if(Eh){var c=Wp;Eh=!1,Wp=null}else throw Error(pt(198));zp||(zp=!0,Nx=c)}}function $c(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function mk(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Iw(e){if($c(e)!==e)throw Error(pt(188))}function aA(e){var t=e.alternate;if(!t){if(t=$c(e),t===null)throw Error(pt(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Iw(i),e;if(s===n)return Iw(i),t;s=s.sibling}throw Error(pt(188))}if(r.return!==n.return)r=i,n=s;else{for(var l=!1,o=i.child;o;){if(o===r){l=!0,r=i,n=s;break}if(o===n){l=!0,n=i,r=s;break}o=o.sibling}if(!l){for(o=s.child;o;){if(o===r){l=!0,r=s,n=i;break}if(o===n){l=!0,n=s,r=i;break}o=o.sibling}if(!l)throw Error(pt(189))}}if(r.alternate!==n)throw Error(pt(190))}if(r.tag!==3)throw Error(pt(188));return r.stateNode.current===r?e:t}function xk(e){return e=aA(e),e!==null?vk(e):null}function vk(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=vk(e);if(t!==null)return t;e=e.sibling}return null}var yk=Es.unstable_scheduleCallback,Rw=Es.unstable_cancelCallback,oA=Es.unstable_shouldYield,lA=Es.unstable_requestPaint,wn=Es.unstable_now,cA=Es.unstable_getCurrentPriorityLevel,n2=Es.unstable_ImmediatePriority,wk=Es.unstable_UserBlockingPriority,Hp=Es.unstable_NormalPriority,uA=Es.unstable_LowPriority,_k=Es.unstable_IdlePriority,Ig=null,Xa=null;function fA(e){if(Xa&&typeof Xa.onCommitFiberRoot=="function")try{Xa.onCommitFiberRoot(Ig,e,void 0,(e.current.flags&128)===128)}catch{}}var xa=Math.clz32?Math.clz32:pA,hA=Math.log,dA=Math.LN2;function pA(e){return e>>>=0,e===0?32:31-(hA(e)/dA|0)|0}var j0=64,D0=4194304;function vh(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function $p(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~i;o!==0?n=vh(o):(s&=l,s!==0&&(n=vh(s)))}else l=r&~i,l!==0?n=vh(l):s!==0&&(n=vh(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-xa(t),i=1<<r,n|=e[r],t&=~i;return n}function gA(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mA(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var l=31-xa(s),o=1<<l,a=i[l];a===-1?(!(o&r)||o&n)&&(i[l]=gA(o,t)):a<=t&&(e.expiredLanes|=o),s&=~o}}function Ax(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function bk(){var e=j0;return j0<<=1,!(j0&4194240)&&(j0=64),e}function Q1(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Rd(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-xa(t),e[t]=r}function xA(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-xa(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function i2(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-xa(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Nr=0;function Sk(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var kk,s2,Ck,Ek,Tk,Ox=!1,L0=[],vl=null,yl=null,wl=null,Kh=new Map,Jh=new Map,ul=[],vA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mw(e,t){switch(e){case"focusin":case"focusout":vl=null;break;case"dragenter":case"dragleave":yl=null;break;case"mouseover":case"mouseout":wl=null;break;case"pointerover":case"pointerout":Kh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jh.delete(t.pointerId)}}function ih(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=Bd(t),t!==null&&s2(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function yA(e,t,r,n,i){switch(t){case"focusin":return vl=ih(vl,e,t,r,n,i),!0;case"dragenter":return yl=ih(yl,e,t,r,n,i),!0;case"mouseover":return wl=ih(wl,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Kh.set(s,ih(Kh.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Jh.set(s,ih(Jh.get(s)||null,e,t,r,n,i)),!0}return!1}function Nk(e){var t=mc(e.target);if(t!==null){var r=$c(t);if(r!==null){if(t=r.tag,t===13){if(t=mk(r),t!==null){e.blockedOn=t,Tk(e.priority,function(){Ck(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function bp(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Px(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Cx=n,r.target.dispatchEvent(n),Cx=null}else return t=Bd(r),t!==null&&s2(t),e.blockedOn=r,!1;t.shift()}return!0}function Bw(e,t,r){bp(e)&&r.delete(t)}function wA(){Ox=!1,vl!==null&&bp(vl)&&(vl=null),yl!==null&&bp(yl)&&(yl=null),wl!==null&&bp(wl)&&(wl=null),Kh.forEach(Bw),Jh.forEach(Bw)}function sh(e,t){e.blockedOn===t&&(e.blockedOn=null,Ox||(Ox=!0,Es.unstable_scheduleCallback(Es.unstable_NormalPriority,wA)))}function Qh(e){function t(i){return sh(i,e)}if(0<L0.length){sh(L0[0],e);for(var r=1;r<L0.length;r++){var n=L0[r];n.blockedOn===e&&(n.blockedOn=null)}}for(vl!==null&&sh(vl,e),yl!==null&&sh(yl,e),wl!==null&&sh(wl,e),Kh.forEach(t),Jh.forEach(t),r=0;r<ul.length;r++)n=ul[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ul.length&&(r=ul[0],r.blockedOn===null);)Nk(r),r.blockedOn===null&&ul.shift()}var Ku=Lo.ReactCurrentBatchConfig,Vp=!0;function _A(e,t,r,n){var i=Nr,s=Ku.transition;Ku.transition=null;try{Nr=1,a2(e,t,r,n)}finally{Nr=i,Ku.transition=s}}function bA(e,t,r,n){var i=Nr,s=Ku.transition;Ku.transition=null;try{Nr=4,a2(e,t,r,n)}finally{Nr=i,Ku.transition=s}}function a2(e,t,r,n){if(Vp){var i=Px(e,t,r,n);if(i===null)lm(e,t,n,qp,r),Mw(e,n);else if(yA(i,e,t,r,n))n.stopPropagation();else if(Mw(e,n),t&4&&-1<vA.indexOf(e)){for(;i!==null;){var s=Bd(i);if(s!==null&&kk(s),s=Px(e,t,r,n),s===null&&lm(e,t,n,qp,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else lm(e,t,n,null,r)}}var qp=null;function Px(e,t,r,n){if(qp=null,e=r2(n),e=mc(e),e!==null)if(t=$c(e),t===null)e=null;else if(r=t.tag,r===13){if(e=mk(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return qp=e,null}function Ak(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cA()){case n2:return 1;case wk:return 4;case Hp:case uA:return 16;case _k:return 536870912;default:return 16}default:return 16}}var dl=null,o2=null,Sp=null;function Ok(){if(Sp)return Sp;var e,t=o2,r=t.length,n,i="value"in dl?dl.value:dl.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var l=r-e;for(n=1;n<=l&&t[r-n]===i[s-n];n++);return Sp=i.slice(e,1<n?1-n:void 0)}function kp(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function I0(){return!0}function Uw(){return!1}function As(e){function t(r,n,i,s,l){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?I0:Uw,this.isPropagationStopped=Uw,this}return nn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=I0)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=I0)},persist:function(){},isPersistent:I0}),t}var Sf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},l2=As(Sf),Md=nn({},Sf,{view:0,detail:0}),SA=As(Md),Z1,em,ah,Rg=nn({},Md,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:c2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ah&&(ah&&e.type==="mousemove"?(Z1=e.screenX-ah.screenX,em=e.screenY-ah.screenY):em=Z1=0,ah=e),Z1)},movementY:function(e){return"movementY"in e?e.movementY:em}}),Ww=As(Rg),kA=nn({},Rg,{dataTransfer:0}),CA=As(kA),EA=nn({},Md,{relatedTarget:0}),tm=As(EA),TA=nn({},Sf,{animationName:0,elapsedTime:0,pseudoElement:0}),NA=As(TA),AA=nn({},Sf,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),OA=As(AA),PA=nn({},Sf,{data:0}),zw=As(PA),FA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},DA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function LA(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=DA[e])?!!t[e]:!1}function c2(){return LA}var IA=nn({},Md,{key:function(e){if(e.key){var t=FA[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=kp(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?jA[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:c2,charCode:function(e){return e.type==="keypress"?kp(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?kp(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),RA=As(IA),MA=nn({},Rg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Hw=As(MA),BA=nn({},Md,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:c2}),UA=As(BA),WA=nn({},Sf,{propertyName:0,elapsedTime:0,pseudoElement:0}),zA=As(WA),HA=nn({},Rg,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),$A=As(HA),VA=[9,13,27,32],u2=Ao&&"CompositionEvent"in window,Th=null;Ao&&"documentMode"in document&&(Th=document.documentMode);var qA=Ao&&"TextEvent"in window&&!Th,Pk=Ao&&(!u2||Th&&8<Th&&11>=Th),$w=" ",Vw=!1;function Fk(e,t){switch(e){case"keyup":return VA.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jk(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Du=!1;function GA(e,t){switch(e){case"compositionend":return jk(t);case"keypress":return t.which!==32?null:(Vw=!0,$w);case"textInput":return e=t.data,e===$w&&Vw?null:e;default:return null}}function XA(e,t){if(Du)return e==="compositionend"||!u2&&Fk(e,t)?(e=Ok(),Sp=o2=dl=null,Du=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Pk&&t.locale!=="ko"?null:t.data;default:return null}}var YA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qw(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!YA[e.type]:t==="textarea"}function Dk(e,t,r,n){fk(n),t=Gp(t,"onChange"),0<t.length&&(r=new l2("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Nh=null,Zh=null;function KA(e){Vk(e,0)}function Mg(e){var t=Ru(e);if(ik(t))return e}function JA(e,t){if(e==="change")return t}var Lk=!1;if(Ao){var rm;if(Ao){var nm="oninput"in document;if(!nm){var Gw=document.createElement("div");Gw.setAttribute("oninput","return;"),nm=typeof Gw.oninput=="function"}rm=nm}else rm=!1;Lk=rm&&(!document.documentMode||9<document.documentMode)}function Xw(){Nh&&(Nh.detachEvent("onpropertychange",Ik),Zh=Nh=null)}function Ik(e){if(e.propertyName==="value"&&Mg(Zh)){var t=[];Dk(t,Zh,e,r2(e)),gk(KA,t)}}function QA(e,t,r){e==="focusin"?(Xw(),Nh=t,Zh=r,Nh.attachEvent("onpropertychange",Ik)):e==="focusout"&&Xw()}function ZA(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Mg(Zh)}function e6(e,t){if(e==="click")return Mg(t)}function t6(e,t){if(e==="input"||e==="change")return Mg(t)}function r6(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ba=typeof Object.is=="function"?Object.is:r6;function ed(e,t){if(ba(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!dx.call(t,i)||!ba(e[i],t[i]))return!1}return!0}function Yw(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Kw(e,t){var r=Yw(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Yw(r)}}function Rk(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Rk(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Mk(){for(var e=window,t=Up();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Up(e.document)}return t}function f2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function n6(e){var t=Mk(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Rk(r.ownerDocument.documentElement,r)){if(n!==null&&f2(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=Kw(r,s);var l=Kw(r,n);i&&l&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var i6=Ao&&"documentMode"in document&&11>=document.documentMode,Lu=null,Fx=null,Ah=null,jx=!1;function Jw(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;jx||Lu==null||Lu!==Up(n)||(n=Lu,"selectionStart"in n&&f2(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ah&&ed(Ah,n)||(Ah=n,n=Gp(Fx,"onSelect"),0<n.length&&(t=new l2("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Lu)))}function R0(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Iu={animationend:R0("Animation","AnimationEnd"),animationiteration:R0("Animation","AnimationIteration"),animationstart:R0("Animation","AnimationStart"),transitionend:R0("Transition","TransitionEnd")},im={},Bk={};Ao&&(Bk=document.createElement("div").style,"AnimationEvent"in window||(delete Iu.animationend.animation,delete Iu.animationiteration.animation,delete Iu.animationstart.animation),"TransitionEvent"in window||delete Iu.transitionend.transition);function Bg(e){if(im[e])return im[e];if(!Iu[e])return e;var t=Iu[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Bk)return im[e]=t[r];return e}var Uk=Bg("animationend"),Wk=Bg("animationiteration"),zk=Bg("animationstart"),Hk=Bg("transitionend"),$k=new Map,Qw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bl(e,t){$k.set(e,t),Hc(t,[e])}for(var sm=0;sm<Qw.length;sm++){var am=Qw[sm],s6=am.toLowerCase(),a6=am[0].toUpperCase()+am.slice(1);Bl(s6,"on"+a6)}Bl(Uk,"onAnimationEnd");Bl(Wk,"onAnimationIteration");Bl(zk,"onAnimationStart");Bl("dblclick","onDoubleClick");Bl("focusin","onFocus");Bl("focusout","onBlur");Bl(Hk,"onTransitionEnd");uf("onMouseEnter",["mouseout","mouseover"]);uf("onMouseLeave",["mouseout","mouseover"]);uf("onPointerEnter",["pointerout","pointerover"]);uf("onPointerLeave",["pointerout","pointerover"]);Hc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Hc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Hc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Hc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Hc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Hc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var yh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),o6=new Set("cancel close invalid load scroll toggle".split(" ").concat(yh));function Zw(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,sA(n,t,void 0,e),e.currentTarget=null}function Vk(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var l=n.length-1;0<=l;l--){var o=n[l],a=o.instance,c=o.currentTarget;if(o=o.listener,a!==s&&i.isPropagationStopped())break e;Zw(i,o,c),s=a}else for(l=0;l<n.length;l++){if(o=n[l],a=o.instance,c=o.currentTarget,o=o.listener,a!==s&&i.isPropagationStopped())break e;Zw(i,o,c),s=a}}}if(zp)throw e=Nx,zp=!1,Nx=null,e}function Br(e,t){var r=t[Mx];r===void 0&&(r=t[Mx]=new Set);var n=e+"__bubble";r.has(n)||(qk(t,e,2,!1),r.add(n))}function om(e,t,r){var n=0;t&&(n|=4),qk(r,e,n,t)}var M0="_reactListening"+Math.random().toString(36).slice(2);function td(e){if(!e[M0]){e[M0]=!0,ZS.forEach(function(r){r!=="selectionchange"&&(o6.has(r)||om(r,!1,e),om(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[M0]||(t[M0]=!0,om("selectionchange",!1,t))}}function qk(e,t,r,n){switch(Ak(t)){case 1:var i=_A;break;case 4:i=bA;break;default:i=a2}r=i.bind(null,t,r,e),i=void 0,!Tx||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function lm(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(l===4)for(l=n.return;l!==null;){var a=l.tag;if((a===3||a===4)&&(a=l.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;l=l.return}for(;o!==null;){if(l=mc(o),l===null)return;if(a=l.tag,a===5||a===6){n=s=l;continue e}o=o.parentNode}}n=n.return}gk(function(){var c=s,f=r2(r),h=[];e:{var d=$k.get(e);if(d!==void 0){var u=l2,p=e;switch(e){case"keypress":if(kp(r)===0)break e;case"keydown":case"keyup":u=RA;break;case"focusin":p="focus",u=tm;break;case"focusout":p="blur",u=tm;break;case"beforeblur":case"afterblur":u=tm;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=Ww;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=CA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=UA;break;case Uk:case Wk:case zk:u=NA;break;case Hk:u=zA;break;case"scroll":u=SA;break;case"wheel":u=$A;break;case"copy":case"cut":case"paste":u=OA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=Hw}var m=(t&4)!==0,g=!m&&e==="scroll",x=m?d!==null?d+"Capture":null:d;m=[];for(var y=c,w;y!==null;){w=y;var _=w.stateNode;if(w.tag===5&&_!==null&&(w=_,x!==null&&(_=Yh(y,x),_!=null&&m.push(rd(y,_,w)))),g)break;y=y.return}0<m.length&&(d=new u(d,p,null,r,f),h.push({event:d,listeners:m}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",u=e==="mouseout"||e==="pointerout",d&&r!==Cx&&(p=r.relatedTarget||r.fromElement)&&(mc(p)||p[Oo]))break e;if((u||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,u?(p=r.relatedTarget||r.toElement,u=c,p=p?mc(p):null,p!==null&&(g=$c(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(u=null,p=c),u!==p)){if(m=Ww,_="onMouseLeave",x="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=Hw,_="onPointerLeave",x="onPointerEnter",y="pointer"),g=u==null?d:Ru(u),w=p==null?d:Ru(p),d=new m(_,y+"leave",u,r,f),d.target=g,d.relatedTarget=w,_=null,mc(f)===c&&(m=new m(x,y+"enter",p,r,f),m.target=w,m.relatedTarget=g,_=m),g=_,u&&p)t:{for(m=u,x=p,y=0,w=m;w;w=hu(w))y++;for(w=0,_=x;_;_=hu(_))w++;for(;0<y-w;)m=hu(m),y--;for(;0<w-y;)x=hu(x),w--;for(;y--;){if(m===x||x!==null&&m===x.alternate)break t;m=hu(m),x=hu(x)}m=null}else m=null;u!==null&&e_(h,d,u,m,!1),p!==null&&g!==null&&e_(h,g,p,m,!0)}}e:{if(d=c?Ru(c):window,u=d.nodeName&&d.nodeName.toLowerCase(),u==="select"||u==="input"&&d.type==="file")var C=JA;else if(qw(d))if(Lk)C=t6;else{C=ZA;var E=QA}else(u=d.nodeName)&&u.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(C=e6);if(C&&(C=C(e,c))){Dk(h,C,r,f);break e}E&&E(e,d,c),e==="focusout"&&(E=d._wrapperState)&&E.controlled&&d.type==="number"&&wx(d,"number",d.value)}switch(E=c?Ru(c):window,e){case"focusin":(qw(E)||E.contentEditable==="true")&&(Lu=E,Fx=c,Ah=null);break;case"focusout":Ah=Fx=Lu=null;break;case"mousedown":jx=!0;break;case"contextmenu":case"mouseup":case"dragend":jx=!1,Jw(h,r,f);break;case"selectionchange":if(i6)break;case"keydown":case"keyup":Jw(h,r,f)}var T;if(u2)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Du?Fk(e,r)&&(A="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(A="onCompositionStart");A&&(Pk&&r.locale!=="ko"&&(Du||A!=="onCompositionStart"?A==="onCompositionEnd"&&Du&&(T=Ok()):(dl=f,o2="value"in dl?dl.value:dl.textContent,Du=!0)),E=Gp(c,A),0<E.length&&(A=new zw(A,e,null,r,f),h.push({event:A,listeners:E}),T?A.data=T:(T=jk(r),T!==null&&(A.data=T)))),(T=qA?GA(e,r):XA(e,r))&&(c=Gp(c,"onBeforeInput"),0<c.length&&(f=new zw("onBeforeInput","beforeinput",null,r,f),h.push({event:f,listeners:c}),f.data=T))}Vk(h,t)})}function rd(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Gp(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Yh(e,r),s!=null&&n.unshift(rd(e,s,i)),s=Yh(e,t),s!=null&&n.push(rd(e,s,i))),e=e.return}return n}function hu(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function e_(e,t,r,n,i){for(var s=t._reactName,l=[];r!==null&&r!==n;){var o=r,a=o.alternate,c=o.stateNode;if(a!==null&&a===n)break;o.tag===5&&c!==null&&(o=c,i?(a=Yh(r,s),a!=null&&l.unshift(rd(r,a,o))):i||(a=Yh(r,s),a!=null&&l.push(rd(r,a,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var l6=/\r\n?/g,c6=/\u0000|\uFFFD/g;function t_(e){return(typeof e=="string"?e:""+e).replace(l6,`
`).replace(c6,"")}function B0(e,t,r){if(t=t_(t),t_(e)!==t&&r)throw Error(pt(425))}function Xp(){}var Dx=null,Lx=null;function Ix(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Rx=typeof setTimeout=="function"?setTimeout:void 0,u6=typeof clearTimeout=="function"?clearTimeout:void 0,r_=typeof Promise=="function"?Promise:void 0,f6=typeof queueMicrotask=="function"?queueMicrotask:typeof r_<"u"?function(e){return r_.resolve(null).then(e).catch(h6)}:Rx;function h6(e){setTimeout(function(){throw e})}function cm(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Qh(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Qh(t)}function _l(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function n_(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var kf=Math.random().toString(36).slice(2),Ua="__reactFiber$"+kf,nd="__reactProps$"+kf,Oo="__reactContainer$"+kf,Mx="__reactEvents$"+kf,d6="__reactListeners$"+kf,p6="__reactHandles$"+kf;function mc(e){var t=e[Ua];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Oo]||r[Ua]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=n_(e);e!==null;){if(r=e[Ua])return r;e=n_(e)}return t}e=r,r=e.parentNode}return null}function Bd(e){return e=e[Ua]||e[Oo],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ru(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(pt(33))}function Ug(e){return e[nd]||null}var Bx=[],Mu=-1;function Ul(e){return{current:e}}function Hr(e){0>Mu||(e.current=Bx[Mu],Bx[Mu]=null,Mu--)}function Rr(e,t){Mu++,Bx[Mu]=e.current,e.current=t}var Ol={},Fi=Ul(Ol),es=Ul(!1),Nc=Ol;function ff(e,t){var r=e.type.contextTypes;if(!r)return Ol;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function ts(e){return e=e.childContextTypes,e!=null}function Yp(){Hr(es),Hr(Fi)}function i_(e,t,r){if(Fi.current!==Ol)throw Error(pt(168));Rr(Fi,t),Rr(es,r)}function Gk(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(pt(108,QN(e)||"Unknown",i));return nn({},r,n)}function Kp(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ol,Nc=Fi.current,Rr(Fi,e),Rr(es,es.current),!0}function s_(e,t,r){var n=e.stateNode;if(!n)throw Error(pt(169));r?(e=Gk(e,t,Nc),n.__reactInternalMemoizedMergedChildContext=e,Hr(es),Hr(Fi),Rr(Fi,e)):Hr(es),Rr(es,r)}var yo=null,Wg=!1,um=!1;function Xk(e){yo===null?yo=[e]:yo.push(e)}function g6(e){Wg=!0,Xk(e)}function Wl(){if(!um&&yo!==null){um=!0;var e=0,t=Nr;try{var r=yo;for(Nr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}yo=null,Wg=!1}catch(i){throw yo!==null&&(yo=yo.slice(e+1)),yk(n2,Wl),i}finally{Nr=t,um=!1}}return null}var Bu=[],Uu=0,Jp=null,Qp=0,zs=[],Hs=0,Ac=null,_o=1,bo="";function oc(e,t){Bu[Uu++]=Qp,Bu[Uu++]=Jp,Jp=e,Qp=t}function Yk(e,t,r){zs[Hs++]=_o,zs[Hs++]=bo,zs[Hs++]=Ac,Ac=e;var n=_o;e=bo;var i=32-xa(n)-1;n&=~(1<<i),r+=1;var s=32-xa(t)+i;if(30<s){var l=i-i%5;s=(n&(1<<l)-1).toString(32),n>>=l,i-=l,_o=1<<32-xa(t)+i|r<<i|n,bo=s+e}else _o=1<<s|r<<i|n,bo=e}function h2(e){e.return!==null&&(oc(e,1),Yk(e,1,0))}function d2(e){for(;e===Jp;)Jp=Bu[--Uu],Bu[Uu]=null,Qp=Bu[--Uu],Bu[Uu]=null;for(;e===Ac;)Ac=zs[--Hs],zs[Hs]=null,bo=zs[--Hs],zs[Hs]=null,_o=zs[--Hs],zs[Hs]=null}var ks=null,_s=null,Yr=!1,pa=null;function Kk(e,t){var r=$s(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function a_(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ks=e,_s=_l(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ks=e,_s=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ac!==null?{id:_o,overflow:bo}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=$s(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ks=e,_s=null,!0):!1;default:return!1}}function Ux(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Wx(e){if(Yr){var t=_s;if(t){var r=t;if(!a_(e,t)){if(Ux(e))throw Error(pt(418));t=_l(r.nextSibling);var n=ks;t&&a_(e,t)?Kk(n,r):(e.flags=e.flags&-4097|2,Yr=!1,ks=e)}}else{if(Ux(e))throw Error(pt(418));e.flags=e.flags&-4097|2,Yr=!1,ks=e}}}function o_(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ks=e}function U0(e){if(e!==ks)return!1;if(!Yr)return o_(e),Yr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ix(e.type,e.memoizedProps)),t&&(t=_s)){if(Ux(e))throw Jk(),Error(pt(418));for(;t;)Kk(e,t),t=_l(t.nextSibling)}if(o_(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(pt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){_s=_l(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}_s=null}}else _s=ks?_l(e.stateNode.nextSibling):null;return!0}function Jk(){for(var e=_s;e;)e=_l(e.nextSibling)}function hf(){_s=ks=null,Yr=!1}function p2(e){pa===null?pa=[e]:pa.push(e)}var m6=Lo.ReactCurrentBatchConfig;function oh(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(pt(309));var n=r.stateNode}if(!n)throw Error(pt(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(l){var o=i.refs;l===null?delete o[s]:o[s]=l},t._stringRef=s,t)}if(typeof e!="string")throw Error(pt(284));if(!r._owner)throw Error(pt(290,e))}return e}function W0(e,t){throw e=Object.prototype.toString.call(t),Error(pt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function l_(e){var t=e._init;return t(e._payload)}function Qk(e){function t(x,y){if(e){var w=x.deletions;w===null?(x.deletions=[y],x.flags|=16):w.push(y)}}function r(x,y){if(!e)return null;for(;y!==null;)t(x,y),y=y.sibling;return null}function n(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function i(x,y){return x=Cl(x,y),x.index=0,x.sibling=null,x}function s(x,y,w){return x.index=w,e?(w=x.alternate,w!==null?(w=w.index,w<y?(x.flags|=2,y):w):(x.flags|=2,y)):(x.flags|=1048576,y)}function l(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,y,w,_){return y===null||y.tag!==6?(y=xm(w,x.mode,_),y.return=x,y):(y=i(y,w),y.return=x,y)}function a(x,y,w,_){var C=w.type;return C===ju?f(x,y,w.props.children,_,w.key):y!==null&&(y.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===ol&&l_(C)===y.type)?(_=i(y,w.props),_.ref=oh(x,y,w),_.return=x,_):(_=Pp(w.type,w.key,w.props,null,x.mode,_),_.ref=oh(x,y,w),_.return=x,_)}function c(x,y,w,_){return y===null||y.tag!==4||y.stateNode.containerInfo!==w.containerInfo||y.stateNode.implementation!==w.implementation?(y=vm(w,x.mode,_),y.return=x,y):(y=i(y,w.children||[]),y.return=x,y)}function f(x,y,w,_,C){return y===null||y.tag!==7?(y=bc(w,x.mode,_,C),y.return=x,y):(y=i(y,w),y.return=x,y)}function h(x,y,w){if(typeof y=="string"&&y!==""||typeof y=="number")return y=xm(""+y,x.mode,w),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case O0:return w=Pp(y.type,y.key,y.props,null,x.mode,w),w.ref=oh(x,null,y),w.return=x,w;case Fu:return y=vm(y,x.mode,w),y.return=x,y;case ol:var _=y._init;return h(x,_(y._payload),w)}if(xh(y)||rh(y))return y=bc(y,x.mode,w,null),y.return=x,y;W0(x,y)}return null}function d(x,y,w,_){var C=y!==null?y.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return C!==null?null:o(x,y,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case O0:return w.key===C?a(x,y,w,_):null;case Fu:return w.key===C?c(x,y,w,_):null;case ol:return C=w._init,d(x,y,C(w._payload),_)}if(xh(w)||rh(w))return C!==null?null:f(x,y,w,_,null);W0(x,w)}return null}function u(x,y,w,_,C){if(typeof _=="string"&&_!==""||typeof _=="number")return x=x.get(w)||null,o(y,x,""+_,C);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case O0:return x=x.get(_.key===null?w:_.key)||null,a(y,x,_,C);case Fu:return x=x.get(_.key===null?w:_.key)||null,c(y,x,_,C);case ol:var E=_._init;return u(x,y,w,E(_._payload),C)}if(xh(_)||rh(_))return x=x.get(w)||null,f(y,x,_,C,null);W0(y,_)}return null}function p(x,y,w,_){for(var C=null,E=null,T=y,A=y=0,j=null;T!==null&&A<w.length;A++){T.index>A?(j=T,T=null):j=T.sibling;var B=d(x,T,w[A],_);if(B===null){T===null&&(T=j);break}e&&T&&B.alternate===null&&t(x,T),y=s(B,y,A),E===null?C=B:E.sibling=B,E=B,T=j}if(A===w.length)return r(x,T),Yr&&oc(x,A),C;if(T===null){for(;A<w.length;A++)T=h(x,w[A],_),T!==null&&(y=s(T,y,A),E===null?C=T:E.sibling=T,E=T);return Yr&&oc(x,A),C}for(T=n(x,T);A<w.length;A++)j=u(T,x,A,w[A],_),j!==null&&(e&&j.alternate!==null&&T.delete(j.key===null?A:j.key),y=s(j,y,A),E===null?C=j:E.sibling=j,E=j);return e&&T.forEach(function(F){return t(x,F)}),Yr&&oc(x,A),C}function m(x,y,w,_){var C=rh(w);if(typeof C!="function")throw Error(pt(150));if(w=C.call(w),w==null)throw Error(pt(151));for(var E=C=null,T=y,A=y=0,j=null,B=w.next();T!==null&&!B.done;A++,B=w.next()){T.index>A?(j=T,T=null):j=T.sibling;var F=d(x,T,B.value,_);if(F===null){T===null&&(T=j);break}e&&T&&F.alternate===null&&t(x,T),y=s(F,y,A),E===null?C=F:E.sibling=F,E=F,T=j}if(B.done)return r(x,T),Yr&&oc(x,A),C;if(T===null){for(;!B.done;A++,B=w.next())B=h(x,B.value,_),B!==null&&(y=s(B,y,A),E===null?C=B:E.sibling=B,E=B);return Yr&&oc(x,A),C}for(T=n(x,T);!B.done;A++,B=w.next())B=u(T,x,A,B.value,_),B!==null&&(e&&B.alternate!==null&&T.delete(B.key===null?A:B.key),y=s(B,y,A),E===null?C=B:E.sibling=B,E=B);return e&&T.forEach(function(L){return t(x,L)}),Yr&&oc(x,A),C}function g(x,y,w,_){if(typeof w=="object"&&w!==null&&w.type===ju&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case O0:e:{for(var C=w.key,E=y;E!==null;){if(E.key===C){if(C=w.type,C===ju){if(E.tag===7){r(x,E.sibling),y=i(E,w.props.children),y.return=x,x=y;break e}}else if(E.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===ol&&l_(C)===E.type){r(x,E.sibling),y=i(E,w.props),y.ref=oh(x,E,w),y.return=x,x=y;break e}r(x,E);break}else t(x,E);E=E.sibling}w.type===ju?(y=bc(w.props.children,x.mode,_,w.key),y.return=x,x=y):(_=Pp(w.type,w.key,w.props,null,x.mode,_),_.ref=oh(x,y,w),_.return=x,x=_)}return l(x);case Fu:e:{for(E=w.key;y!==null;){if(y.key===E)if(y.tag===4&&y.stateNode.containerInfo===w.containerInfo&&y.stateNode.implementation===w.implementation){r(x,y.sibling),y=i(y,w.children||[]),y.return=x,x=y;break e}else{r(x,y);break}else t(x,y);y=y.sibling}y=vm(w,x.mode,_),y.return=x,x=y}return l(x);case ol:return E=w._init,g(x,y,E(w._payload),_)}if(xh(w))return p(x,y,w,_);if(rh(w))return m(x,y,w,_);W0(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,y!==null&&y.tag===6?(r(x,y.sibling),y=i(y,w),y.return=x,x=y):(r(x,y),y=xm(w,x.mode,_),y.return=x,x=y),l(x)):r(x,y)}return g}var df=Qk(!0),Zk=Qk(!1),Zp=Ul(null),eg=null,Wu=null,g2=null;function m2(){g2=Wu=eg=null}function x2(e){var t=Zp.current;Hr(Zp),e._currentValue=t}function zx(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ju(e,t){eg=e,g2=Wu=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Zi=!0),e.firstContext=null)}function Xs(e){var t=e._currentValue;if(g2!==e)if(e={context:e,memoizedValue:t,next:null},Wu===null){if(eg===null)throw Error(pt(308));Wu=e,eg.dependencies={lanes:0,firstContext:e}}else Wu=Wu.next=e;return t}var xc=null;function v2(e){xc===null?xc=[e]:xc.push(e)}function e4(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,v2(t)):(r.next=i.next,i.next=r),t.interleaved=r,Po(e,n)}function Po(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ll=!1;function y2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function t4(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ko(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function bl(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,pr&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Po(e,r)}return i=n.interleaved,i===null?(t.next=t,v2(n)):(t.next=i.next,i.next=t),n.interleaved=t,Po(e,r)}function Cp(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,i2(e,r)}}function c_(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=l:s=s.next=l,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function tg(e,t,r,n){var i=e.updateQueue;ll=!1;var s=i.firstBaseUpdate,l=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var a=o,c=a.next;a.next=null,l===null?s=c:l.next=c,l=a;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==l&&(o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=a))}if(s!==null){var h=i.baseState;l=0,f=c=a=null,o=s;do{var d=o.lane,u=o.eventTime;if((n&d)===d){f!==null&&(f=f.next={eventTime:u,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,m=o;switch(d=t,u=r,m.tag){case 1:if(p=m.payload,typeof p=="function"){h=p.call(u,h,d);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,d=typeof p=="function"?p.call(u,h,d):p,d==null)break e;h=nn({},h,d);break e;case 2:ll=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=i.effects,d===null?i.effects=[o]:d.push(o))}else u={eventTime:u,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(c=f=u,a=h):f=f.next=u,l|=d;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;d=o,o=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(f===null&&(a=h),i.baseState=a,i.firstBaseUpdate=c,i.lastBaseUpdate=f,t=i.shared.interleaved,t!==null){i=t;do l|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Pc|=l,e.lanes=l,e.memoizedState=h}}function u_(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(pt(191,i));i.call(n)}}}var Ud={},Ya=Ul(Ud),id=Ul(Ud),sd=Ul(Ud);function vc(e){if(e===Ud)throw Error(pt(174));return e}function w2(e,t){switch(Rr(sd,t),Rr(id,e),Rr(Ya,Ud),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:bx(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=bx(t,e)}Hr(Ya),Rr(Ya,t)}function pf(){Hr(Ya),Hr(id),Hr(sd)}function r4(e){vc(sd.current);var t=vc(Ya.current),r=bx(t,e.type);t!==r&&(Rr(id,e),Rr(Ya,r))}function _2(e){id.current===e&&(Hr(Ya),Hr(id))}var Qr=Ul(0);function rg(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var fm=[];function b2(){for(var e=0;e<fm.length;e++)fm[e]._workInProgressVersionPrimary=null;fm.length=0}var Ep=Lo.ReactCurrentDispatcher,hm=Lo.ReactCurrentBatchConfig,Oc=0,rn=null,qn=null,Zn=null,ng=!1,Oh=!1,ad=0,x6=0;function yi(){throw Error(pt(321))}function S2(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ba(e[r],t[r]))return!1;return!0}function k2(e,t,r,n,i,s){if(Oc=s,rn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ep.current=e===null||e.memoizedState===null?_6:b6,e=r(n,i),Oh){s=0;do{if(Oh=!1,ad=0,25<=s)throw Error(pt(301));s+=1,Zn=qn=null,t.updateQueue=null,Ep.current=S6,e=r(n,i)}while(Oh)}if(Ep.current=ig,t=qn!==null&&qn.next!==null,Oc=0,Zn=qn=rn=null,ng=!1,t)throw Error(pt(300));return e}function C2(){var e=ad!==0;return ad=0,e}function Ba(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zn===null?rn.memoizedState=Zn=e:Zn=Zn.next=e,Zn}function Ys(){if(qn===null){var e=rn.alternate;e=e!==null?e.memoizedState:null}else e=qn.next;var t=Zn===null?rn.memoizedState:Zn.next;if(t!==null)Zn=t,qn=e;else{if(e===null)throw Error(pt(310));qn=e,e={memoizedState:qn.memoizedState,baseState:qn.baseState,baseQueue:qn.baseQueue,queue:qn.queue,next:null},Zn===null?rn.memoizedState=Zn=e:Zn=Zn.next=e}return Zn}function od(e,t){return typeof t=="function"?t(e):t}function dm(e){var t=Ys(),r=t.queue;if(r===null)throw Error(pt(311));r.lastRenderedReducer=e;var n=qn,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var l=i.next;i.next=s.next,s.next=l}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=l=null,a=null,c=s;do{var f=c.lane;if((Oc&f)===f)a!==null&&(a=a.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};a===null?(o=a=h,l=n):a=a.next=h,rn.lanes|=f,Pc|=f}c=c.next}while(c!==null&&c!==s);a===null?l=n:a.next=o,ba(n,t.memoizedState)||(Zi=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=a,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,rn.lanes|=s,Pc|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function pm(e){var t=Ys(),r=t.queue;if(r===null)throw Error(pt(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var l=i=i.next;do s=e(s,l.action),l=l.next;while(l!==i);ba(s,t.memoizedState)||(Zi=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function n4(){}function i4(e,t){var r=rn,n=Ys(),i=t(),s=!ba(n.memoizedState,i);if(s&&(n.memoizedState=i,Zi=!0),n=n.queue,E2(o4.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Zn!==null&&Zn.memoizedState.tag&1){if(r.flags|=2048,ld(9,a4.bind(null,r,n,i,t),void 0,null),ni===null)throw Error(pt(349));Oc&30||s4(r,t,i)}return i}function s4(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=rn.updateQueue,t===null?(t={lastEffect:null,stores:null},rn.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function a4(e,t,r,n){t.value=r,t.getSnapshot=n,l4(t)&&c4(e)}function o4(e,t,r){return r(function(){l4(t)&&c4(e)})}function l4(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ba(e,r)}catch{return!0}}function c4(e){var t=Po(e,1);t!==null&&va(t,e,1,-1)}function f_(e){var t=Ba();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:od,lastRenderedState:e},t.queue=e,e=e.dispatch=w6.bind(null,rn,e),[t.memoizedState,e]}function ld(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=rn.updateQueue,t===null?(t={lastEffect:null,stores:null},rn.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function u4(){return Ys().memoizedState}function Tp(e,t,r,n){var i=Ba();rn.flags|=e,i.memoizedState=ld(1|t,r,void 0,n===void 0?null:n)}function zg(e,t,r,n){var i=Ys();n=n===void 0?null:n;var s=void 0;if(qn!==null){var l=qn.memoizedState;if(s=l.destroy,n!==null&&S2(n,l.deps)){i.memoizedState=ld(t,r,s,n);return}}rn.flags|=e,i.memoizedState=ld(1|t,r,s,n)}function h_(e,t){return Tp(8390656,8,e,t)}function E2(e,t){return zg(2048,8,e,t)}function f4(e,t){return zg(4,2,e,t)}function h4(e,t){return zg(4,4,e,t)}function d4(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function p4(e,t,r){return r=r!=null?r.concat([e]):null,zg(4,4,d4.bind(null,t,e),r)}function T2(){}function g4(e,t){var r=Ys();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&S2(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function m4(e,t){var r=Ys();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&S2(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function x4(e,t,r){return Oc&21?(ba(r,t)||(r=bk(),rn.lanes|=r,Pc|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Zi=!0),e.memoizedState=r)}function v6(e,t){var r=Nr;Nr=r!==0&&4>r?r:4,e(!0);var n=hm.transition;hm.transition={};try{e(!1),t()}finally{Nr=r,hm.transition=n}}function v4(){return Ys().memoizedState}function y6(e,t,r){var n=kl(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},y4(e))w4(t,r);else if(r=e4(e,t,r,n),r!==null){var i=Hi();va(r,e,n,i),_4(r,t,n)}}function w6(e,t,r){var n=kl(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(y4(e))w4(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var l=t.lastRenderedState,o=s(l,r);if(i.hasEagerState=!0,i.eagerState=o,ba(o,l)){var a=t.interleaved;a===null?(i.next=i,v2(t)):(i.next=a.next,a.next=i),t.interleaved=i;return}}catch{}finally{}r=e4(e,t,i,n),r!==null&&(i=Hi(),va(r,e,n,i),_4(r,t,n))}}function y4(e){var t=e.alternate;return e===rn||t!==null&&t===rn}function w4(e,t){Oh=ng=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function _4(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,i2(e,r)}}var ig={readContext:Xs,useCallback:yi,useContext:yi,useEffect:yi,useImperativeHandle:yi,useInsertionEffect:yi,useLayoutEffect:yi,useMemo:yi,useReducer:yi,useRef:yi,useState:yi,useDebugValue:yi,useDeferredValue:yi,useTransition:yi,useMutableSource:yi,useSyncExternalStore:yi,useId:yi,unstable_isNewReconciler:!1},_6={readContext:Xs,useCallback:function(e,t){return Ba().memoizedState=[e,t===void 0?null:t],e},useContext:Xs,useEffect:h_,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Tp(4194308,4,d4.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Tp(4194308,4,e,t)},useInsertionEffect:function(e,t){return Tp(4,2,e,t)},useMemo:function(e,t){var r=Ba();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Ba();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=y6.bind(null,rn,e),[n.memoizedState,e]},useRef:function(e){var t=Ba();return e={current:e},t.memoizedState=e},useState:f_,useDebugValue:T2,useDeferredValue:function(e){return Ba().memoizedState=e},useTransition:function(){var e=f_(!1),t=e[0];return e=v6.bind(null,e[1]),Ba().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=rn,i=Ba();if(Yr){if(r===void 0)throw Error(pt(407));r=r()}else{if(r=t(),ni===null)throw Error(pt(349));Oc&30||s4(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,h_(o4.bind(null,n,s,e),[e]),n.flags|=2048,ld(9,a4.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Ba(),t=ni.identifierPrefix;if(Yr){var r=bo,n=_o;r=(n&~(1<<32-xa(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=ad++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=x6++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},b6={readContext:Xs,useCallback:g4,useContext:Xs,useEffect:E2,useImperativeHandle:p4,useInsertionEffect:f4,useLayoutEffect:h4,useMemo:m4,useReducer:dm,useRef:u4,useState:function(){return dm(od)},useDebugValue:T2,useDeferredValue:function(e){var t=Ys();return x4(t,qn.memoizedState,e)},useTransition:function(){var e=dm(od)[0],t=Ys().memoizedState;return[e,t]},useMutableSource:n4,useSyncExternalStore:i4,useId:v4,unstable_isNewReconciler:!1},S6={readContext:Xs,useCallback:g4,useContext:Xs,useEffect:E2,useImperativeHandle:p4,useInsertionEffect:f4,useLayoutEffect:h4,useMemo:m4,useReducer:pm,useRef:u4,useState:function(){return pm(od)},useDebugValue:T2,useDeferredValue:function(e){var t=Ys();return qn===null?t.memoizedState=e:x4(t,qn.memoizedState,e)},useTransition:function(){var e=pm(od)[0],t=Ys().memoizedState;return[e,t]},useMutableSource:n4,useSyncExternalStore:i4,useId:v4,unstable_isNewReconciler:!1};function fa(e,t){if(e&&e.defaultProps){t=nn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Hx(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:nn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Hg={isMounted:function(e){return(e=e._reactInternals)?$c(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Hi(),i=kl(e),s=ko(n,i);s.payload=t,r!=null&&(s.callback=r),t=bl(e,s,i),t!==null&&(va(t,e,i,n),Cp(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Hi(),i=kl(e),s=ko(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=bl(e,s,i),t!==null&&(va(t,e,i,n),Cp(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Hi(),n=kl(e),i=ko(r,n);i.tag=2,t!=null&&(i.callback=t),t=bl(e,i,n),t!==null&&(va(t,e,n,r),Cp(t,e,n))}};function d_(e,t,r,n,i,s,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,l):t.prototype&&t.prototype.isPureReactComponent?!ed(r,n)||!ed(i,s):!0}function b4(e,t,r){var n=!1,i=Ol,s=t.contextType;return typeof s=="object"&&s!==null?s=Xs(s):(i=ts(t)?Nc:Fi.current,n=t.contextTypes,s=(n=n!=null)?ff(e,i):Ol),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Hg,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function p_(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Hg.enqueueReplaceState(t,t.state,null)}function $x(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},y2(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Xs(s):(s=ts(t)?Nc:Fi.current,i.context=ff(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Hx(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Hg.enqueueReplaceState(i,i.state,null),tg(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function gf(e,t){try{var r="",n=t;do r+=JN(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function gm(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Vx(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var k6=typeof WeakMap=="function"?WeakMap:Map;function S4(e,t,r){r=ko(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){ag||(ag=!0,tv=n),Vx(e,t)},r}function k4(e,t,r){r=ko(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Vx(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Vx(e,t),typeof n!="function"&&(Sl===null?Sl=new Set([this]):Sl.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function g_(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new k6;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=M6.bind(null,e,t,r),t.then(e,e))}function m_(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function x_(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ko(-1,1),t.tag=2,bl(r,t,1))),r.lanes|=1),e)}var C6=Lo.ReactCurrentOwner,Zi=!1;function Ui(e,t,r,n){t.child=e===null?Zk(t,null,r,n):df(t,e.child,r,n)}function v_(e,t,r,n,i){r=r.render;var s=t.ref;return Ju(t,i),n=k2(e,t,r,n,s,i),r=C2(),e!==null&&!Zi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Fo(e,t,i)):(Yr&&r&&h2(t),t.flags|=1,Ui(e,t,n,i),t.child)}function y_(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!L2(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,C4(e,t,s,n,i)):(e=Pp(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var l=s.memoizedProps;if(r=r.compare,r=r!==null?r:ed,r(l,n)&&e.ref===t.ref)return Fo(e,t,i)}return t.flags|=1,e=Cl(s,n),e.ref=t.ref,e.return=t,t.child=e}function C4(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(ed(s,n)&&e.ref===t.ref)if(Zi=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(Zi=!0);else return t.lanes=e.lanes,Fo(e,t,i)}return qx(e,t,r,n,i)}function E4(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Rr(Hu,ms),ms|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Rr(Hu,ms),ms|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Rr(Hu,ms),ms|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Rr(Hu,ms),ms|=n;return Ui(e,t,i,r),t.child}function T4(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function qx(e,t,r,n,i){var s=ts(r)?Nc:Fi.current;return s=ff(t,s),Ju(t,i),r=k2(e,t,r,n,s,i),n=C2(),e!==null&&!Zi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Fo(e,t,i)):(Yr&&n&&h2(t),t.flags|=1,Ui(e,t,r,i),t.child)}function w_(e,t,r,n,i){if(ts(r)){var s=!0;Kp(t)}else s=!1;if(Ju(t,i),t.stateNode===null)Np(e,t),b4(t,r,n),$x(t,r,n,i),n=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var a=l.context,c=r.contextType;typeof c=="object"&&c!==null?c=Xs(c):(c=ts(r)?Nc:Fi.current,c=ff(t,c));var f=r.getDerivedStateFromProps,h=typeof f=="function"||typeof l.getSnapshotBeforeUpdate=="function";h||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||a!==c)&&p_(t,l,n,c),ll=!1;var d=t.memoizedState;l.state=d,tg(t,n,l,i),a=t.memoizedState,o!==n||d!==a||es.current||ll?(typeof f=="function"&&(Hx(t,r,f,n),a=t.memoizedState),(o=ll||d_(t,r,o,n,d,a,c))?(h||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=a),l.props=n,l.state=a,l.context=c,n=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,t4(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:fa(t.type,o),l.props=c,h=t.pendingProps,d=l.context,a=r.contextType,typeof a=="object"&&a!==null?a=Xs(a):(a=ts(r)?Nc:Fi.current,a=ff(t,a));var u=r.getDerivedStateFromProps;(f=typeof u=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==h||d!==a)&&p_(t,l,n,a),ll=!1,d=t.memoizedState,l.state=d,tg(t,n,l,i);var p=t.memoizedState;o!==h||d!==p||es.current||ll?(typeof u=="function"&&(Hx(t,r,u,n),p=t.memoizedState),(c=ll||d_(t,r,c,n,d,p,a)||!1)?(f||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,p,a),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,p,a)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),l.props=n,l.state=p,l.context=a,n=c):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return Gx(e,t,r,n,s,i)}function Gx(e,t,r,n,i,s){T4(e,t);var l=(t.flags&128)!==0;if(!n&&!l)return i&&s_(t,r,!1),Fo(e,t,s);n=t.stateNode,C6.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&l?(t.child=df(t,e.child,null,s),t.child=df(t,null,o,s)):Ui(e,t,o,s),t.memoizedState=n.state,i&&s_(t,r,!0),t.child}function N4(e){var t=e.stateNode;t.pendingContext?i_(e,t.pendingContext,t.pendingContext!==t.context):t.context&&i_(e,t.context,!1),w2(e,t.containerInfo)}function __(e,t,r,n,i){return hf(),p2(i),t.flags|=256,Ui(e,t,r,n),t.child}var Xx={dehydrated:null,treeContext:null,retryLane:0};function Yx(e){return{baseLanes:e,cachePool:null,transitions:null}}function A4(e,t,r){var n=t.pendingProps,i=Qr.current,s=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Rr(Qr,i&1),e===null)return Wx(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=n.children,e=n.fallback,s?(n=t.mode,s=t.child,l={mode:"hidden",children:l},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=l):s=qg(l,n,0,null),e=bc(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Yx(r),t.memoizedState=Xx,e):N2(t,l));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return E6(e,t,l,n,o,i,r);if(s){s=n.fallback,l=t.mode,i=e.child,o=i.sibling;var a={mode:"hidden",children:n.children};return!(l&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=a,t.deletions=null):(n=Cl(i,a),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Cl(o,s):(s=bc(s,l,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,l=e.child.memoizedState,l=l===null?Yx(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~r,t.memoizedState=Xx,n}return s=e.child,e=s.sibling,n=Cl(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function N2(e,t){return t=qg({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function z0(e,t,r,n){return n!==null&&p2(n),df(t,e.child,null,r),e=N2(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function E6(e,t,r,n,i,s,l){if(r)return t.flags&256?(t.flags&=-257,n=gm(Error(pt(422))),z0(e,t,l,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=qg({mode:"visible",children:n.children},i,0,null),s=bc(s,i,l,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&df(t,e.child,null,l),t.child.memoizedState=Yx(l),t.memoizedState=Xx,s);if(!(t.mode&1))return z0(e,t,l,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(pt(419)),n=gm(s,n,void 0),z0(e,t,l,n)}if(o=(l&e.childLanes)!==0,Zi||o){if(n=ni,n!==null){switch(l&-l){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|l)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Po(e,i),va(n,e,i,-1))}return D2(),n=gm(Error(pt(421))),z0(e,t,l,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=B6.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,_s=_l(i.nextSibling),ks=t,Yr=!0,pa=null,e!==null&&(zs[Hs++]=_o,zs[Hs++]=bo,zs[Hs++]=Ac,_o=e.id,bo=e.overflow,Ac=t),t=N2(t,n.children),t.flags|=4096,t)}function b_(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),zx(e.return,t,r)}function mm(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function O4(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Ui(e,t,n.children,r),n=Qr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&b_(e,r,t);else if(e.tag===19)b_(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Rr(Qr,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&rg(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),mm(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&rg(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}mm(t,!0,r,null,s);break;case"together":mm(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Np(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Fo(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Pc|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(pt(153));if(t.child!==null){for(e=t.child,r=Cl(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Cl(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function T6(e,t,r){switch(t.tag){case 3:N4(t),hf();break;case 5:r4(t);break;case 1:ts(t.type)&&Kp(t);break;case 4:w2(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Rr(Zp,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Rr(Qr,Qr.current&1),t.flags|=128,null):r&t.child.childLanes?A4(e,t,r):(Rr(Qr,Qr.current&1),e=Fo(e,t,r),e!==null?e.sibling:null);Rr(Qr,Qr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return O4(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Rr(Qr,Qr.current),n)break;return null;case 22:case 23:return t.lanes=0,E4(e,t,r)}return Fo(e,t,r)}var P4,Kx,F4,j4;P4=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Kx=function(){};F4=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,vc(Ya.current);var s=null;switch(r){case"input":i=vx(e,i),n=vx(e,n),s=[];break;case"select":i=nn({},i,{value:void 0}),n=nn({},n,{value:void 0}),s=[];break;case"textarea":i=_x(e,i),n=_x(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Xp)}Sx(r,n);var l;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Gh.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var a=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&a!==o&&(a!=null||o!=null))if(c==="style")if(o){for(l in o)!o.hasOwnProperty(l)||a&&a.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in a)a.hasOwnProperty(l)&&o[l]!==a[l]&&(r||(r={}),r[l]=a[l])}else r||(s||(s=[]),s.push(c,r)),r=a;else c==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,o=o?o.__html:void 0,a!=null&&o!==a&&(s=s||[]).push(c,a)):c==="children"?typeof a!="string"&&typeof a!="number"||(s=s||[]).push(c,""+a):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Gh.hasOwnProperty(c)?(a!=null&&c==="onScroll"&&Br("scroll",e),s||o===a||(s=[])):(s=s||[]).push(c,a))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};j4=function(e,t,r,n){r!==n&&(t.flags|=4)};function lh(e,t){if(!Yr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function wi(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function N6(e,t,r){var n=t.pendingProps;switch(d2(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wi(t),null;case 1:return ts(t.type)&&Yp(),wi(t),null;case 3:return n=t.stateNode,pf(),Hr(es),Hr(Fi),b2(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(U0(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,pa!==null&&(iv(pa),pa=null))),Kx(e,t),wi(t),null;case 5:_2(t);var i=vc(sd.current);if(r=t.type,e!==null&&t.stateNode!=null)F4(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(pt(166));return wi(t),null}if(e=vc(Ya.current),U0(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Ua]=t,n[nd]=s,e=(t.mode&1)!==0,r){case"dialog":Br("cancel",n),Br("close",n);break;case"iframe":case"object":case"embed":Br("load",n);break;case"video":case"audio":for(i=0;i<yh.length;i++)Br(yh[i],n);break;case"source":Br("error",n);break;case"img":case"image":case"link":Br("error",n),Br("load",n);break;case"details":Br("toggle",n);break;case"input":Pw(n,s),Br("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Br("invalid",n);break;case"textarea":jw(n,s),Br("invalid",n)}Sx(r,s),i=null;for(var l in s)if(s.hasOwnProperty(l)){var o=s[l];l==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&B0(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&B0(n.textContent,o,e),i=["children",""+o]):Gh.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&Br("scroll",n)}switch(r){case"input":P0(n),Fw(n,s,!0);break;case"textarea":P0(n),Dw(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Xp)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{l=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ok(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),r==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[Ua]=t,e[nd]=n,P4(e,t,!1,!1),t.stateNode=e;e:{switch(l=kx(r,n),r){case"dialog":Br("cancel",e),Br("close",e),i=n;break;case"iframe":case"object":case"embed":Br("load",e),i=n;break;case"video":case"audio":for(i=0;i<yh.length;i++)Br(yh[i],e);i=n;break;case"source":Br("error",e),i=n;break;case"img":case"image":case"link":Br("error",e),Br("load",e),i=n;break;case"details":Br("toggle",e),i=n;break;case"input":Pw(e,n),i=vx(e,n),Br("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=nn({},n,{value:void 0}),Br("invalid",e);break;case"textarea":jw(e,n),i=_x(e,n),Br("invalid",e);break;default:i=n}Sx(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="style"?uk(e,a):s==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&lk(e,a)):s==="children"?typeof a=="string"?(r!=="textarea"||a!=="")&&Xh(e,a):typeof a=="number"&&Xh(e,""+a):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Gh.hasOwnProperty(s)?a!=null&&s==="onScroll"&&Br("scroll",e):a!=null&&Qv(e,s,a,l))}switch(r){case"input":P0(e),Fw(e,n,!1);break;case"textarea":P0(e),Dw(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Al(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Gu(e,!!n.multiple,s,!1):n.defaultValue!=null&&Gu(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Xp)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return wi(t),null;case 6:if(e&&t.stateNode!=null)j4(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(pt(166));if(r=vc(sd.current),vc(Ya.current),U0(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ua]=t,(s=n.nodeValue!==r)&&(e=ks,e!==null))switch(e.tag){case 3:B0(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&B0(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ua]=t,t.stateNode=n}return wi(t),null;case 13:if(Hr(Qr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Yr&&_s!==null&&t.mode&1&&!(t.flags&128))Jk(),hf(),t.flags|=98560,s=!1;else if(s=U0(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(pt(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(pt(317));s[Ua]=t}else hf(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;wi(t),s=!1}else pa!==null&&(iv(pa),pa=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Qr.current&1?Xn===0&&(Xn=3):D2())),t.updateQueue!==null&&(t.flags|=4),wi(t),null);case 4:return pf(),Kx(e,t),e===null&&td(t.stateNode.containerInfo),wi(t),null;case 10:return x2(t.type._context),wi(t),null;case 17:return ts(t.type)&&Yp(),wi(t),null;case 19:if(Hr(Qr),s=t.memoizedState,s===null)return wi(t),null;if(n=(t.flags&128)!==0,l=s.rendering,l===null)if(n)lh(s,!1);else{if(Xn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=rg(e),l!==null){for(t.flags|=128,lh(s,!1),n=l.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,l=s.alternate,l===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Rr(Qr,Qr.current&1|2),t.child}e=e.sibling}s.tail!==null&&wn()>mf&&(t.flags|=128,n=!0,lh(s,!1),t.lanes=4194304)}else{if(!n)if(e=rg(l),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),lh(s,!0),s.tail===null&&s.tailMode==="hidden"&&!l.alternate&&!Yr)return wi(t),null}else 2*wn()-s.renderingStartTime>mf&&r!==1073741824&&(t.flags|=128,n=!0,lh(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(r=s.last,r!==null?r.sibling=l:t.child=l,s.last=l)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=wn(),t.sibling=null,r=Qr.current,Rr(Qr,n?r&1|2:r&1),t):(wi(t),null);case 22:case 23:return j2(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?ms&1073741824&&(wi(t),t.subtreeFlags&6&&(t.flags|=8192)):wi(t),null;case 24:return null;case 25:return null}throw Error(pt(156,t.tag))}function A6(e,t){switch(d2(t),t.tag){case 1:return ts(t.type)&&Yp(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return pf(),Hr(es),Hr(Fi),b2(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return _2(t),null;case 13:if(Hr(Qr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(pt(340));hf()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Hr(Qr),null;case 4:return pf(),null;case 10:return x2(t.type._context),null;case 22:case 23:return j2(),null;case 24:return null;default:return null}}var H0=!1,Ni=!1,O6=typeof WeakSet=="function"?WeakSet:Set,Ct=null;function zu(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){un(e,t,n)}else r.current=null}function Jx(e,t,r){try{r()}catch(n){un(e,t,n)}}var S_=!1;function P6(e,t){if(Dx=Vp,e=Mk(),f2(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var l=0,o=-1,a=-1,c=0,f=0,h=e,d=null;t:for(;;){for(var u;h!==r||i!==0&&h.nodeType!==3||(o=l+i),h!==s||n!==0&&h.nodeType!==3||(a=l+n),h.nodeType===3&&(l+=h.nodeValue.length),(u=h.firstChild)!==null;)d=h,h=u;for(;;){if(h===e)break t;if(d===r&&++c===i&&(o=l),d===s&&++f===n&&(a=l),(u=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=u}r=o===-1||a===-1?null:{start:o,end:a}}else r=null}r=r||{start:0,end:0}}else r=null;for(Lx={focusedElem:e,selectionRange:r},Vp=!1,Ct=t;Ct!==null;)if(t=Ct,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ct=e;else for(;Ct!==null;){t=Ct;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,x=t.stateNode,y=x.getSnapshotBeforeUpdate(t.elementType===t.type?m:fa(t.type,m),g);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pt(163))}}catch(_){un(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,Ct=e;break}Ct=t.return}return p=S_,S_=!1,p}function Ph(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&Jx(t,r,s)}i=i.next}while(i!==n)}}function $g(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Qx(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function D4(e){var t=e.alternate;t!==null&&(e.alternate=null,D4(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ua],delete t[nd],delete t[Mx],delete t[d6],delete t[p6])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function L4(e){return e.tag===5||e.tag===3||e.tag===4}function k_(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||L4(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Zx(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Xp));else if(n!==4&&(e=e.child,e!==null))for(Zx(e,t,r),e=e.sibling;e!==null;)Zx(e,t,r),e=e.sibling}function ev(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(ev(e,t,r),e=e.sibling;e!==null;)ev(e,t,r),e=e.sibling}var hi=null,ha=!1;function rl(e,t,r){for(r=r.child;r!==null;)I4(e,t,r),r=r.sibling}function I4(e,t,r){if(Xa&&typeof Xa.onCommitFiberUnmount=="function")try{Xa.onCommitFiberUnmount(Ig,r)}catch{}switch(r.tag){case 5:Ni||zu(r,t);case 6:var n=hi,i=ha;hi=null,rl(e,t,r),hi=n,ha=i,hi!==null&&(ha?(e=hi,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):hi.removeChild(r.stateNode));break;case 18:hi!==null&&(ha?(e=hi,r=r.stateNode,e.nodeType===8?cm(e.parentNode,r):e.nodeType===1&&cm(e,r),Qh(e)):cm(hi,r.stateNode));break;case 4:n=hi,i=ha,hi=r.stateNode.containerInfo,ha=!0,rl(e,t,r),hi=n,ha=i;break;case 0:case 11:case 14:case 15:if(!Ni&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,l=s.destroy;s=s.tag,l!==void 0&&(s&2||s&4)&&Jx(r,t,l),i=i.next}while(i!==n)}rl(e,t,r);break;case 1:if(!Ni&&(zu(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){un(r,t,o)}rl(e,t,r);break;case 21:rl(e,t,r);break;case 22:r.mode&1?(Ni=(n=Ni)||r.memoizedState!==null,rl(e,t,r),Ni=n):rl(e,t,r);break;default:rl(e,t,r)}}function C_(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new O6),t.forEach(function(n){var i=U6.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function oa(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:hi=o.stateNode,ha=!1;break e;case 3:hi=o.stateNode.containerInfo,ha=!0;break e;case 4:hi=o.stateNode.containerInfo,ha=!0;break e}o=o.return}if(hi===null)throw Error(pt(160));I4(s,l,i),hi=null,ha=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(c){un(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)R4(t,e),t=t.sibling}function R4(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(oa(t,e),ja(e),n&4){try{Ph(3,e,e.return),$g(3,e)}catch(m){un(e,e.return,m)}try{Ph(5,e,e.return)}catch(m){un(e,e.return,m)}}break;case 1:oa(t,e),ja(e),n&512&&r!==null&&zu(r,r.return);break;case 5:if(oa(t,e),ja(e),n&512&&r!==null&&zu(r,r.return),e.flags&32){var i=e.stateNode;try{Xh(i,"")}catch(m){un(e,e.return,m)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,l=r!==null?r.memoizedProps:s,o=e.type,a=e.updateQueue;if(e.updateQueue=null,a!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&sk(i,s),kx(o,l);var c=kx(o,s);for(l=0;l<a.length;l+=2){var f=a[l],h=a[l+1];f==="style"?uk(i,h):f==="dangerouslySetInnerHTML"?lk(i,h):f==="children"?Xh(i,h):Qv(i,f,h,c)}switch(o){case"input":yx(i,s);break;case"textarea":ak(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var u=s.value;u!=null?Gu(i,!!s.multiple,u,!1):d!==!!s.multiple&&(s.defaultValue!=null?Gu(i,!!s.multiple,s.defaultValue,!0):Gu(i,!!s.multiple,s.multiple?[]:"",!1))}i[nd]=s}catch(m){un(e,e.return,m)}}break;case 6:if(oa(t,e),ja(e),n&4){if(e.stateNode===null)throw Error(pt(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(m){un(e,e.return,m)}}break;case 3:if(oa(t,e),ja(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Qh(t.containerInfo)}catch(m){un(e,e.return,m)}break;case 4:oa(t,e),ja(e);break;case 13:oa(t,e),ja(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(P2=wn())),n&4&&C_(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(Ni=(c=Ni)||f,oa(t,e),Ni=c):oa(t,e),ja(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!f&&e.mode&1)for(Ct=e,f=e.child;f!==null;){for(h=Ct=f;Ct!==null;){switch(d=Ct,u=d.child,d.tag){case 0:case 11:case 14:case 15:Ph(4,d,d.return);break;case 1:zu(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){n=d,r=d.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){un(n,r,m)}}break;case 5:zu(d,d.return);break;case 22:if(d.memoizedState!==null){T_(h);continue}}u!==null?(u.return=d,Ct=u):T_(h)}f=f.sibling}e:for(f=null,h=e;;){if(h.tag===5){if(f===null){f=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,a=h.memoizedProps.style,l=a!=null&&a.hasOwnProperty("display")?a.display:null,o.style.display=ck("display",l))}catch(m){un(e,e.return,m)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){un(e,e.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:oa(t,e),ja(e),n&4&&C_(e);break;case 21:break;default:oa(t,e),ja(e)}}function ja(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(L4(r)){var n=r;break e}r=r.return}throw Error(pt(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Xh(i,""),n.flags&=-33);var s=k_(e);ev(e,s,i);break;case 3:case 4:var l=n.stateNode.containerInfo,o=k_(e);Zx(e,o,l);break;default:throw Error(pt(161))}}catch(a){un(e,e.return,a)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function F6(e,t,r){Ct=e,M4(e)}function M4(e,t,r){for(var n=(e.mode&1)!==0;Ct!==null;){var i=Ct,s=i.child;if(i.tag===22&&n){var l=i.memoizedState!==null||H0;if(!l){var o=i.alternate,a=o!==null&&o.memoizedState!==null||Ni;o=H0;var c=Ni;if(H0=l,(Ni=a)&&!c)for(Ct=i;Ct!==null;)l=Ct,a=l.child,l.tag===22&&l.memoizedState!==null?N_(i):a!==null?(a.return=l,Ct=a):N_(i);for(;s!==null;)Ct=s,M4(s),s=s.sibling;Ct=i,H0=o,Ni=c}E_(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Ct=s):E_(e)}}function E_(e){for(;Ct!==null;){var t=Ct;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ni||$g(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ni)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:fa(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&u_(t,s,n);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}u_(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var a=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&r.focus();break;case"img":a.src&&(r.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&Qh(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pt(163))}Ni||t.flags&512&&Qx(t)}catch(d){un(t,t.return,d)}}if(t===e){Ct=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ct=r;break}Ct=t.return}}function T_(e){for(;Ct!==null;){var t=Ct;if(t===e){Ct=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ct=r;break}Ct=t.return}}function N_(e){for(;Ct!==null;){var t=Ct;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{$g(4,t)}catch(a){un(t,r,a)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(a){un(t,i,a)}}var s=t.return;try{Qx(t)}catch(a){un(t,s,a)}break;case 5:var l=t.return;try{Qx(t)}catch(a){un(t,l,a)}}}catch(a){un(t,t.return,a)}if(t===e){Ct=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ct=o;break}Ct=t.return}}var j6=Math.ceil,sg=Lo.ReactCurrentDispatcher,A2=Lo.ReactCurrentOwner,Vs=Lo.ReactCurrentBatchConfig,pr=0,ni=null,Rn=null,gi=0,ms=0,Hu=Ul(0),Xn=0,cd=null,Pc=0,Vg=0,O2=0,Fh=null,Qi=null,P2=0,mf=1/0,xo=null,ag=!1,tv=null,Sl=null,$0=!1,pl=null,og=0,jh=0,rv=null,Ap=-1,Op=0;function Hi(){return pr&6?wn():Ap!==-1?Ap:Ap=wn()}function kl(e){return e.mode&1?pr&2&&gi!==0?gi&-gi:m6.transition!==null?(Op===0&&(Op=bk()),Op):(e=Nr,e!==0||(e=window.event,e=e===void 0?16:Ak(e.type)),e):1}function va(e,t,r,n){if(50<jh)throw jh=0,rv=null,Error(pt(185));Rd(e,r,n),(!(pr&2)||e!==ni)&&(e===ni&&(!(pr&2)&&(Vg|=r),Xn===4&&fl(e,gi)),rs(e,n),r===1&&pr===0&&!(t.mode&1)&&(mf=wn()+500,Wg&&Wl()))}function rs(e,t){var r=e.callbackNode;mA(e,t);var n=$p(e,e===ni?gi:0);if(n===0)r!==null&&Rw(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Rw(r),t===1)e.tag===0?g6(A_.bind(null,e)):Xk(A_.bind(null,e)),f6(function(){!(pr&6)&&Wl()}),r=null;else{switch(Sk(n)){case 1:r=n2;break;case 4:r=wk;break;case 16:r=Hp;break;case 536870912:r=_k;break;default:r=Hp}r=q4(r,B4.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function B4(e,t){if(Ap=-1,Op=0,pr&6)throw Error(pt(327));var r=e.callbackNode;if(Qu()&&e.callbackNode!==r)return null;var n=$p(e,e===ni?gi:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=lg(e,n);else{t=n;var i=pr;pr|=2;var s=W4();(ni!==e||gi!==t)&&(xo=null,mf=wn()+500,_c(e,t));do try{I6();break}catch(o){U4(e,o)}while(!0);m2(),sg.current=s,pr=i,Rn!==null?t=0:(ni=null,gi=0,t=Xn)}if(t!==0){if(t===2&&(i=Ax(e),i!==0&&(n=i,t=nv(e,i))),t===1)throw r=cd,_c(e,0),fl(e,n),rs(e,wn()),r;if(t===6)fl(e,n);else{if(i=e.current.alternate,!(n&30)&&!D6(i)&&(t=lg(e,n),t===2&&(s=Ax(e),s!==0&&(n=s,t=nv(e,s))),t===1))throw r=cd,_c(e,0),fl(e,n),rs(e,wn()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(pt(345));case 2:lc(e,Qi,xo);break;case 3:if(fl(e,n),(n&130023424)===n&&(t=P2+500-wn(),10<t)){if($p(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Hi(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Rx(lc.bind(null,e,Qi,xo),t);break}lc(e,Qi,xo);break;case 4:if(fl(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var l=31-xa(n);s=1<<l,l=t[l],l>i&&(i=l),n&=~s}if(n=i,n=wn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*j6(n/1960))-n,10<n){e.timeoutHandle=Rx(lc.bind(null,e,Qi,xo),n);break}lc(e,Qi,xo);break;case 5:lc(e,Qi,xo);break;default:throw Error(pt(329))}}}return rs(e,wn()),e.callbackNode===r?B4.bind(null,e):null}function nv(e,t){var r=Fh;return e.current.memoizedState.isDehydrated&&(_c(e,t).flags|=256),e=lg(e,t),e!==2&&(t=Qi,Qi=r,t!==null&&iv(t)),e}function iv(e){Qi===null?Qi=e:Qi.push.apply(Qi,e)}function D6(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!ba(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function fl(e,t){for(t&=~O2,t&=~Vg,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-xa(t),n=1<<r;e[r]=-1,t&=~n}}function A_(e){if(pr&6)throw Error(pt(327));Qu();var t=$p(e,0);if(!(t&1))return rs(e,wn()),null;var r=lg(e,t);if(e.tag!==0&&r===2){var n=Ax(e);n!==0&&(t=n,r=nv(e,n))}if(r===1)throw r=cd,_c(e,0),fl(e,t),rs(e,wn()),r;if(r===6)throw Error(pt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,lc(e,Qi,xo),rs(e,wn()),null}function F2(e,t){var r=pr;pr|=1;try{return e(t)}finally{pr=r,pr===0&&(mf=wn()+500,Wg&&Wl())}}function Fc(e){pl!==null&&pl.tag===0&&!(pr&6)&&Qu();var t=pr;pr|=1;var r=Vs.transition,n=Nr;try{if(Vs.transition=null,Nr=1,e)return e()}finally{Nr=n,Vs.transition=r,pr=t,!(pr&6)&&Wl()}}function j2(){ms=Hu.current,Hr(Hu)}function _c(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,u6(r)),Rn!==null)for(r=Rn.return;r!==null;){var n=r;switch(d2(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Yp();break;case 3:pf(),Hr(es),Hr(Fi),b2();break;case 5:_2(n);break;case 4:pf();break;case 13:Hr(Qr);break;case 19:Hr(Qr);break;case 10:x2(n.type._context);break;case 22:case 23:j2()}r=r.return}if(ni=e,Rn=e=Cl(e.current,null),gi=ms=t,Xn=0,cd=null,O2=Vg=Pc=0,Qi=Fh=null,xc!==null){for(t=0;t<xc.length;t++)if(r=xc[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var l=s.next;s.next=i,n.next=l}r.pending=n}xc=null}return e}function U4(e,t){do{var r=Rn;try{if(m2(),Ep.current=ig,ng){for(var n=rn.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}ng=!1}if(Oc=0,Zn=qn=rn=null,Oh=!1,ad=0,A2.current=null,r===null||r.return===null){Xn=1,cd=t,Rn=null;break}e:{var s=e,l=r.return,o=r,a=t;if(t=gi,o.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var c=a,f=o,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var u=m_(l);if(u!==null){u.flags&=-257,x_(u,l,o,s,t),u.mode&1&&g_(s,c,t),t=u,a=c;var p=t.updateQueue;if(p===null){var m=new Set;m.add(a),t.updateQueue=m}else p.add(a);break e}else{if(!(t&1)){g_(s,c,t),D2();break e}a=Error(pt(426))}}else if(Yr&&o.mode&1){var g=m_(l);if(g!==null){!(g.flags&65536)&&(g.flags|=256),x_(g,l,o,s,t),p2(gf(a,o));break e}}s=a=gf(a,o),Xn!==4&&(Xn=2),Fh===null?Fh=[s]:Fh.push(s),s=l;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var x=S4(s,a,t);c_(s,x);break e;case 1:o=a;var y=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Sl===null||!Sl.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var _=k4(s,o,t);c_(s,_);break e}}s=s.return}while(s!==null)}H4(r)}catch(C){t=C,Rn===r&&r!==null&&(Rn=r=r.return);continue}break}while(!0)}function W4(){var e=sg.current;return sg.current=ig,e===null?ig:e}function D2(){(Xn===0||Xn===3||Xn===2)&&(Xn=4),ni===null||!(Pc&268435455)&&!(Vg&268435455)||fl(ni,gi)}function lg(e,t){var r=pr;pr|=2;var n=W4();(ni!==e||gi!==t)&&(xo=null,_c(e,t));do try{L6();break}catch(i){U4(e,i)}while(!0);if(m2(),pr=r,sg.current=n,Rn!==null)throw Error(pt(261));return ni=null,gi=0,Xn}function L6(){for(;Rn!==null;)z4(Rn)}function I6(){for(;Rn!==null&&!oA();)z4(Rn)}function z4(e){var t=V4(e.alternate,e,ms);e.memoizedProps=e.pendingProps,t===null?H4(e):Rn=t,A2.current=null}function H4(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=A6(r,t),r!==null){r.flags&=32767,Rn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Xn=6,Rn=null;return}}else if(r=N6(r,t,ms),r!==null){Rn=r;return}if(t=t.sibling,t!==null){Rn=t;return}Rn=t=e}while(t!==null);Xn===0&&(Xn=5)}function lc(e,t,r){var n=Nr,i=Vs.transition;try{Vs.transition=null,Nr=1,R6(e,t,r,n)}finally{Vs.transition=i,Nr=n}return null}function R6(e,t,r,n){do Qu();while(pl!==null);if(pr&6)throw Error(pt(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(pt(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(xA(e,s),e===ni&&(Rn=ni=null,gi=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||$0||($0=!0,q4(Hp,function(){return Qu(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Vs.transition,Vs.transition=null;var l=Nr;Nr=1;var o=pr;pr|=4,A2.current=null,P6(e,r),R4(r,e),n6(Lx),Vp=!!Dx,Lx=Dx=null,e.current=r,F6(r),lA(),pr=o,Nr=l,Vs.transition=s}else e.current=r;if($0&&($0=!1,pl=e,og=i),s=e.pendingLanes,s===0&&(Sl=null),fA(r.stateNode),rs(e,wn()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(ag)throw ag=!1,e=tv,tv=null,e;return og&1&&e.tag!==0&&Qu(),s=e.pendingLanes,s&1?e===rv?jh++:(jh=0,rv=e):jh=0,Wl(),null}function Qu(){if(pl!==null){var e=Sk(og),t=Vs.transition,r=Nr;try{if(Vs.transition=null,Nr=16>e?16:e,pl===null)var n=!1;else{if(e=pl,pl=null,og=0,pr&6)throw Error(pt(331));var i=pr;for(pr|=4,Ct=e.current;Ct!==null;){var s=Ct,l=s.child;if(Ct.flags&16){var o=s.deletions;if(o!==null){for(var a=0;a<o.length;a++){var c=o[a];for(Ct=c;Ct!==null;){var f=Ct;switch(f.tag){case 0:case 11:case 15:Ph(8,f,s)}var h=f.child;if(h!==null)h.return=f,Ct=h;else for(;Ct!==null;){f=Ct;var d=f.sibling,u=f.return;if(D4(f),f===c){Ct=null;break}if(d!==null){d.return=u,Ct=d;break}Ct=u}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}Ct=s}}if(s.subtreeFlags&2064&&l!==null)l.return=s,Ct=l;else e:for(;Ct!==null;){if(s=Ct,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ph(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,Ct=x;break e}Ct=s.return}}var y=e.current;for(Ct=y;Ct!==null;){l=Ct;var w=l.child;if(l.subtreeFlags&2064&&w!==null)w.return=l,Ct=w;else e:for(l=y;Ct!==null;){if(o=Ct,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:$g(9,o)}}catch(C){un(o,o.return,C)}if(o===l){Ct=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,Ct=_;break e}Ct=o.return}}if(pr=i,Wl(),Xa&&typeof Xa.onPostCommitFiberRoot=="function")try{Xa.onPostCommitFiberRoot(Ig,e)}catch{}n=!0}return n}finally{Nr=r,Vs.transition=t}}return!1}function O_(e,t,r){t=gf(r,t),t=S4(e,t,1),e=bl(e,t,1),t=Hi(),e!==null&&(Rd(e,1,t),rs(e,t))}function un(e,t,r){if(e.tag===3)O_(e,e,r);else for(;t!==null;){if(t.tag===3){O_(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Sl===null||!Sl.has(n))){e=gf(r,e),e=k4(t,e,1),t=bl(t,e,1),e=Hi(),t!==null&&(Rd(t,1,e),rs(t,e));break}}t=t.return}}function M6(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Hi(),e.pingedLanes|=e.suspendedLanes&r,ni===e&&(gi&r)===r&&(Xn===4||Xn===3&&(gi&130023424)===gi&&500>wn()-P2?_c(e,0):O2|=r),rs(e,t)}function $4(e,t){t===0&&(e.mode&1?(t=D0,D0<<=1,!(D0&130023424)&&(D0=4194304)):t=1);var r=Hi();e=Po(e,t),e!==null&&(Rd(e,t,r),rs(e,r))}function B6(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),$4(e,r)}function U6(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(pt(314))}n!==null&&n.delete(t),$4(e,r)}var V4;V4=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||es.current)Zi=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Zi=!1,T6(e,t,r);Zi=!!(e.flags&131072)}else Zi=!1,Yr&&t.flags&1048576&&Yk(t,Qp,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Np(e,t),e=t.pendingProps;var i=ff(t,Fi.current);Ju(t,r),i=k2(null,t,n,e,i,r);var s=C2();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ts(n)?(s=!0,Kp(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,y2(t),i.updater=Hg,t.stateNode=i,i._reactInternals=t,$x(t,n,e,r),t=Gx(null,t,n,!0,s,r)):(t.tag=0,Yr&&s&&h2(t),Ui(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Np(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=z6(n),e=fa(n,e),i){case 0:t=qx(null,t,n,e,r);break e;case 1:t=w_(null,t,n,e,r);break e;case 11:t=v_(null,t,n,e,r);break e;case 14:t=y_(null,t,n,fa(n.type,e),r);break e}throw Error(pt(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:fa(n,i),qx(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:fa(n,i),w_(e,t,n,i,r);case 3:e:{if(N4(t),e===null)throw Error(pt(387));n=t.pendingProps,s=t.memoizedState,i=s.element,t4(e,t),tg(t,n,null,r);var l=t.memoizedState;if(n=l.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=gf(Error(pt(423)),t),t=__(e,t,n,r,i);break e}else if(n!==i){i=gf(Error(pt(424)),t),t=__(e,t,n,r,i);break e}else for(_s=_l(t.stateNode.containerInfo.firstChild),ks=t,Yr=!0,pa=null,r=Zk(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(hf(),n===i){t=Fo(e,t,r);break e}Ui(e,t,n,r)}t=t.child}return t;case 5:return r4(t),e===null&&Wx(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,l=i.children,Ix(n,i)?l=null:s!==null&&Ix(n,s)&&(t.flags|=32),T4(e,t),Ui(e,t,l,r),t.child;case 6:return e===null&&Wx(t),null;case 13:return A4(e,t,r);case 4:return w2(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=df(t,null,n,r):Ui(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:fa(n,i),v_(e,t,n,i,r);case 7:return Ui(e,t,t.pendingProps,r),t.child;case 8:return Ui(e,t,t.pendingProps.children,r),t.child;case 12:return Ui(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,l=i.value,Rr(Zp,n._currentValue),n._currentValue=l,s!==null)if(ba(s.value,l)){if(s.children===i.children&&!es.current){t=Fo(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){l=s.child;for(var a=o.firstContext;a!==null;){if(a.context===n){if(s.tag===1){a=ko(-1,r&-r),a.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?a.next=a:(a.next=f.next,f.next=a),c.pending=a}}s.lanes|=r,a=s.alternate,a!==null&&(a.lanes|=r),zx(s.return,r,t),o.lanes|=r;break}a=a.next}}else if(s.tag===10)l=s.type===t.type?null:s.child;else if(s.tag===18){if(l=s.return,l===null)throw Error(pt(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),zx(l,r,t),l=s.sibling}else l=s.child;if(l!==null)l.return=s;else for(l=s;l!==null;){if(l===t){l=null;break}if(s=l.sibling,s!==null){s.return=l.return,l=s;break}l=l.return}s=l}Ui(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Ju(t,r),i=Xs(i),n=n(i),t.flags|=1,Ui(e,t,n,r),t.child;case 14:return n=t.type,i=fa(n,t.pendingProps),i=fa(n.type,i),y_(e,t,n,i,r);case 15:return C4(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:fa(n,i),Np(e,t),t.tag=1,ts(n)?(e=!0,Kp(t)):e=!1,Ju(t,r),b4(t,n,i),$x(t,n,i,r),Gx(null,t,n,!0,e,r);case 19:return O4(e,t,r);case 22:return E4(e,t,r)}throw Error(pt(156,t.tag))};function q4(e,t){return yk(e,t)}function W6(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $s(e,t,r,n){return new W6(e,t,r,n)}function L2(e){return e=e.prototype,!(!e||!e.isReactComponent)}function z6(e){if(typeof e=="function")return L2(e)?1:0;if(e!=null){if(e=e.$$typeof,e===e2)return 11;if(e===t2)return 14}return 2}function Cl(e,t){var r=e.alternate;return r===null?(r=$s(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Pp(e,t,r,n,i,s){var l=2;if(n=e,typeof e=="function")L2(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case ju:return bc(r.children,i,s,t);case Zv:l=8,i|=8;break;case px:return e=$s(12,r,t,i|2),e.elementType=px,e.lanes=s,e;case gx:return e=$s(13,r,t,i),e.elementType=gx,e.lanes=s,e;case mx:return e=$s(19,r,t,i),e.elementType=mx,e.lanes=s,e;case rk:return qg(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ek:l=10;break e;case tk:l=9;break e;case e2:l=11;break e;case t2:l=14;break e;case ol:l=16,n=null;break e}throw Error(pt(130,e==null?e:typeof e,""))}return t=$s(l,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function bc(e,t,r,n){return e=$s(7,e,n,t),e.lanes=r,e}function qg(e,t,r,n){return e=$s(22,e,n,t),e.elementType=rk,e.lanes=r,e.stateNode={isHidden:!1},e}function xm(e,t,r){return e=$s(6,e,null,t),e.lanes=r,e}function vm(e,t,r){return t=$s(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function H6(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Q1(0),this.expirationTimes=Q1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Q1(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function I2(e,t,r,n,i,s,l,o,a){return e=new H6(e,t,r,o,a),t===1?(t=1,s===!0&&(t|=8)):t=0,s=$s(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},y2(s),e}function $6(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fu,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function G4(e){if(!e)return Ol;e=e._reactInternals;e:{if($c(e)!==e||e.tag!==1)throw Error(pt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ts(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(pt(171))}if(e.tag===1){var r=e.type;if(ts(r))return Gk(e,r,t)}return t}function X4(e,t,r,n,i,s,l,o,a){return e=I2(r,n,!0,e,i,s,l,o,a),e.context=G4(null),r=e.current,n=Hi(),i=kl(r),s=ko(n,i),s.callback=t??null,bl(r,s,i),e.current.lanes=i,Rd(e,i,n),rs(e,n),e}function Gg(e,t,r,n){var i=t.current,s=Hi(),l=kl(i);return r=G4(r),t.context===null?t.context=r:t.pendingContext=r,t=ko(s,l),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=bl(i,t,l),e!==null&&(va(e,i,l,s),Cp(e,i,l)),l}function cg(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function P_(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function R2(e,t){P_(e,t),(e=e.alternate)&&P_(e,t)}function V6(){return null}var Y4=typeof reportError=="function"?reportError:function(e){console.error(e)};function M2(e){this._internalRoot=e}Xg.prototype.render=M2.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(pt(409));Gg(e,t,null,null)};Xg.prototype.unmount=M2.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Fc(function(){Gg(null,e,null,null)}),t[Oo]=null}};function Xg(e){this._internalRoot=e}Xg.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ek();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ul.length&&t!==0&&t<ul[r].priority;r++);ul.splice(r,0,e),r===0&&Nk(e)}};function B2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Yg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function F_(){}function q6(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=cg(l);s.call(c)}}var l=X4(t,n,e,0,null,!1,!1,"",F_);return e._reactRootContainer=l,e[Oo]=l.current,td(e.nodeType===8?e.parentNode:e),Fc(),l}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=cg(a);o.call(c)}}var a=I2(e,0,!1,null,null,!1,!1,"",F_);return e._reactRootContainer=a,e[Oo]=a.current,td(e.nodeType===8?e.parentNode:e),Fc(function(){Gg(t,a,r,n)}),a}function Kg(e,t,r,n,i){var s=r._reactRootContainer;if(s){var l=s;if(typeof i=="function"){var o=i;i=function(){var a=cg(l);o.call(a)}}Gg(t,l,e,i)}else l=q6(r,t,e,i,n);return cg(l)}kk=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=vh(t.pendingLanes);r!==0&&(i2(t,r|1),rs(t,wn()),!(pr&6)&&(mf=wn()+500,Wl()))}break;case 13:Fc(function(){var n=Po(e,1);if(n!==null){var i=Hi();va(n,e,1,i)}}),R2(e,1)}};s2=function(e){if(e.tag===13){var t=Po(e,134217728);if(t!==null){var r=Hi();va(t,e,134217728,r)}R2(e,134217728)}};Ck=function(e){if(e.tag===13){var t=kl(e),r=Po(e,t);if(r!==null){var n=Hi();va(r,e,t,n)}R2(e,t)}};Ek=function(){return Nr};Tk=function(e,t){var r=Nr;try{return Nr=e,t()}finally{Nr=r}};Ex=function(e,t,r){switch(t){case"input":if(yx(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Ug(n);if(!i)throw Error(pt(90));ik(n),yx(n,i)}}}break;case"textarea":ak(e,r);break;case"select":t=r.value,t!=null&&Gu(e,!!r.multiple,t,!1)}};dk=F2;pk=Fc;var G6={usingClientEntryPoint:!1,Events:[Bd,Ru,Ug,fk,hk,F2]},ch={findFiberByHostInstance:mc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},X6={bundleType:ch.bundleType,version:ch.version,rendererPackageName:ch.rendererPackageName,rendererConfig:ch.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Lo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=xk(e),e===null?null:e.stateNode},findFiberByHostInstance:ch.findFiberByHostInstance||V6,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var V0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!V0.isDisabled&&V0.supportsFiber)try{Ig=V0.inject(X6),Xa=V0}catch{}}Ns.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=G6;Ns.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!B2(t))throw Error(pt(200));return $6(e,t,null,r)};Ns.createRoot=function(e,t){if(!B2(e))throw Error(pt(299));var r=!1,n="",i=Y4;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=I2(e,1,!1,null,null,r,!1,n,i),e[Oo]=t.current,td(e.nodeType===8?e.parentNode:e),new M2(t)};Ns.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(pt(188)):(e=Object.keys(e).join(","),Error(pt(268,e)));return e=xk(t),e=e===null?null:e.stateNode,e};Ns.flushSync=function(e){return Fc(e)};Ns.hydrate=function(e,t,r){if(!Yg(t))throw Error(pt(200));return Kg(null,e,t,!0,r)};Ns.hydrateRoot=function(e,t,r){if(!B2(e))throw Error(pt(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",l=Y4;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=X4(t,null,e,1,r??null,i,!1,s,l),e[Oo]=t.current,td(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Xg(t)};Ns.render=function(e,t,r){if(!Yg(t))throw Error(pt(200));return Kg(null,e,t,!1,r)};Ns.unmountComponentAtNode=function(e){if(!Yg(e))throw Error(pt(40));return e._reactRootContainer?(Fc(function(){Kg(null,null,e,!1,function(){e._reactRootContainer=null,e[Oo]=null})}),!0):!1};Ns.unstable_batchedUpdates=F2;Ns.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Yg(r))throw Error(pt(200));if(e==null||e._reactInternals===void 0)throw Error(pt(38));return Kg(e,t,r,!1,n)};Ns.version="18.3.1-next-f1338f8080-20240426";function K4(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(K4)}catch(e){console.error(e)}}K4(),KS.exports=Ns;var ug=KS.exports,j_=ug;hx.createRoot=j_.createRoot,hx.hydrateRoot=j_.hydrateRoot;/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J4=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y6=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K6=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D_=e=>{const t=K6(e);return t.charAt(0).toUpperCase()+t.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var J6={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q6=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z6=ye.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:l,...o},a)=>ye.createElement("svg",{ref:a,...J6,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:J4("lucide",i),...!s&&!Q6(o)&&{"aria-hidden":"true"},...o},[...l.map(([c,f])=>ye.createElement(c,f)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=(e,t)=>{const r=ye.forwardRef(({className:n,...i},s)=>ye.createElement(Z6,{ref:s,iconNode:t,className:J4(`lucide-${Y6(D_(e))}`,`lucide-${e}`,n),...i}));return r.displayName=D_(e),r};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e8=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],t8=It("arrow-right",e8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r8=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],ym=It("award",r8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n8=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],U2=It("book-open",n8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i8=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],Q4=It("box",i8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s8=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],a8=It("briefcase",s8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o8=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Vc=It("calendar",o8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l8=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],L_=It("chart-column",l8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c8=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],qs=It("check",c8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u8=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],I_=It("chevron-down",u8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f8=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],jo=It("chevron-left",f8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h8=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Cs=It("chevron-right",h8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d8=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],R_=It("chevron-up",d8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ya=It("circle-alert",p8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],El=It("circle-check",g8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],x8=It("circle-plus",m8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v8=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],y8=It("clipboard-check",v8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w8=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Pl=It("clock",w8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _8=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Z4=It("download",_8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b8=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],M_=It("eraser",b8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S8=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],k8=It("file-down",S8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C8=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],E8=It("file-text",C8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T8=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],N8=It("graduation-cap",T8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],O8=It("grid-3x3",A8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P8=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],F8=It("hash",P8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j8=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],e3=It("house",j8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],t3=It("info",D8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L8=[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]],I8=It("layout-template",L8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R8=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],wm=It("loader-circle",R8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M8=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],B8=It("lock",M8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U8=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Jg=It("log-out",U8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W8=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],jc=It("map-pin",W8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z8=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],sv=It("map",z8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H8=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],$8=It("navigation",H8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V8=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],q8=It("palette",V8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],fg=It("panels-top-left",G8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X8=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],W2=It("pen-tool",X8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y8=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],K8=It("pen",Y8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J8=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],av=It("phone",J8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q8=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ud=It("plus",Q8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z8=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Fl=It("printer",Z8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eO=[["path",{d:"M20.34 17.52a10 10 0 1 0-2.82 2.82",key:"fydyku"}],["circle",{cx:"19",cy:"19",r:"2",key:"17f5cg"}],["path",{d:"m13.41 13.41 4.18 4.18",key:"1gqbwc"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],tO=It("radius",eO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rO=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],nO=It("refresh-cw",rO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iO=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],sO=It("rotate-ccw",iO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aO=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],oO=It("rotate-cw",aO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lO=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],fd=It("save",lO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cO=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],uO=It("school",cO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fO=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ov=It("search",fO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hO=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],dO=It("settings-2",hO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pO=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],hg=It("settings",pO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gO=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],z2=It("shield-check",gO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mO=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],xO=It("square-pen",mO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vO=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],jl=It("trash-2",vO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yO=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],wO=It("triangle-alert",yO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _O=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],bO=It("upload",_O);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SO=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],hd=It("user",SO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kO=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Wd=It("users",kO);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CO=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Tl=It("x",CO);var zt={};const EO={},TO=Object.freeze(Object.defineProperty({__proto__:null,default:EO},Symbol.toStringTag,{value:"Module"})),_m=SN(TO);(function(e){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var t=t||{version:"5.5.2"};if(e.fabric=t,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?t.document=document:t.document=document.implementation.createHTMLDocument(""),t.window=window;else{var r=_m,n=new r.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;t.document=n.document,t.jsdomImplForWrapper=_m.implForWrapper,t.nodeCanvas=_m.Canvas,t.window=n,DOMParser=t.window.DOMParser}t.isTouchSupported="ontouchstart"in t.window||"ontouchstart"in t.document||t.window&&t.window.navigator&&t.window.navigator.maxTouchPoints>0,t.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",t.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],t.DPI=96,t.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",t.commaWsp="(?:\\s+,?\\s*|,\\s*)",t.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,t.reNonWord=/[ \n\.,;!\?\-]/,t.fontPaths={},t.iMatrix=[1,0,0,1,0,0],t.svgNS="http://www.w3.org/2000/svg",t.perfLimitSizeTotal=2097152,t.maxCacheSideLimit=4096,t.minCacheSideLimit=256,t.charWidthsCache={},t.textureSize=2048,t.disableStyleCopyPaste=!1,t.enableGLFiltering=!0,t.devicePixelRatio=t.window.devicePixelRatio||t.window.webkitDevicePixelRatio||t.window.mozDevicePixelRatio||1,t.browserShadowBlurConstant=1,t.arcToSegmentsCache={},t.boundsOfCurveCache={},t.cachesBoundsOfCurve=!0,t.forceGLPutImageData=!1,t.initFilterBackend=function(){if(t.enableGLFiltering&&t.isWebglSupported&&t.isWebglSupported(t.textureSize))return console.log("max texture size: "+t.maxTextureSize),new t.WebglFilterBackend({tileSize:t.textureSize});if(t.Canvas2dFilterBackend)return new t.Canvas2dFilterBackend},typeof document<"u"&&typeof window<"u"&&(window.fabric=t),function(){function o(u,p){if(this.__eventListeners[u]){var m=this.__eventListeners[u];p?m[m.indexOf(p)]=!1:t.util.array.fill(m,!1)}}function a(u,p){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var m in u)this.on(m,u[m]);else this.__eventListeners[u]||(this.__eventListeners[u]=[]),this.__eventListeners[u].push(p);return this}function c(u,p){var m=(function(){p.apply(this,arguments),this.off(u,m)}).bind(this);this.on(u,m)}function f(u,p){if(arguments.length===1)for(var m in u)c.call(this,m,u[m]);else c.call(this,u,p);return this}function h(u,p){if(!this.__eventListeners)return this;if(arguments.length===0)for(u in this.__eventListeners)o.call(this,u);else if(arguments.length===1&&typeof arguments[0]=="object")for(var m in u)o.call(this,m,u[m]);else o.call(this,u,p);return this}function d(u,p){if(!this.__eventListeners)return this;var m=this.__eventListeners[u];if(!m)return this;for(var g=0,x=m.length;g<x;g++)m[g]&&m[g].call(this,p||{});return this.__eventListeners[u]=m.filter(function(y){return y!==!1}),this}t.Observable={fire:d,on:a,once:f,off:h}}(),t.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var o=0,a=arguments.length;o<a;o++)this._onObjectAdded(arguments[o]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(o,a,c){var f=this._objects;return c?f[a]=o:f.splice(a,0,o),this._onObjectAdded&&this._onObjectAdded(o),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var o=this._objects,a,c=!1,f=0,h=arguments.length;f<h;f++)a=o.indexOf(arguments[f]),a!==-1&&(c=!0,o.splice(a,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[f]));return this.renderOnAddRemove&&c&&this.requestRenderAll(),this},forEachObject:function(o,a){for(var c=this.getObjects(),f=0,h=c.length;f<h;f++)o.call(a,c[f],f,c);return this},getObjects:function(o){return typeof o>"u"?this._objects.concat():this._objects.filter(function(a){return a.type===o})},item:function(o){return this._objects[o]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(o,a){return this._objects.indexOf(o)>-1?!0:a?this._objects.some(function(c){return typeof c.contains=="function"&&c.contains(o,!0)}):!1},complexity:function(){return this._objects.reduce(function(o,a){return o+=a.complexity?a.complexity():0,o},0)}},t.CommonMethods={_setOptions:function(o){for(var a in o)this.set(a,o[a])},_initGradient:function(o,a){o&&o.colorStops&&!(o instanceof t.Gradient)&&this.set(a,new t.Gradient(o))},_initPattern:function(o,a,c){o&&o.source&&!(o instanceof t.Pattern)?this.set(a,new t.Pattern(o,c)):c&&c()},_setObject:function(o){for(var a in o)this._set(a,o[a])},set:function(o,a){return typeof o=="object"?this._setObject(o):this._set(o,a),this},_set:function(o,a){this[o]=a},toggle:function(o){var a=this.get(o);return typeof a=="boolean"&&this.set(o,!a),this},get:function(o){return this[o]}},function(o){var a=Math.sqrt,c=Math.atan2,f=Math.pow,h=Math.PI/180,d=Math.PI/2;t.util={cos:function(u){if(u===0)return 1;u<0&&(u=-u);var p=u/d;switch(p){case 1:case 3:return 0;case 2:return-1}return Math.cos(u)},sin:function(u){if(u===0)return 0;var p=u/d,m=1;switch(u<0&&(m=-1),p){case 1:return m;case 2:return 0;case 3:return-m}return Math.sin(u)},removeFromArray:function(u,p){var m=u.indexOf(p);return m!==-1&&u.splice(m,1),u},getRandomInt:function(u,p){return Math.floor(Math.random()*(p-u+1))+u},degreesToRadians:function(u){return u*h},radiansToDegrees:function(u){return u/h},rotatePoint:function(u,p,m){var g=new t.Point(u.x-p.x,u.y-p.y),x=t.util.rotateVector(g,m);return new t.Point(x.x,x.y).addEquals(p)},rotateVector:function(u,p){var m=t.util.sin(p),g=t.util.cos(p),x=u.x*g-u.y*m,y=u.x*m+u.y*g;return{x,y}},createVector:function(u,p){return new t.Point(p.x-u.x,p.y-u.y)},calcAngleBetweenVectors:function(u,p){return Math.acos((u.x*p.x+u.y*p.y)/(Math.hypot(u.x,u.y)*Math.hypot(p.x,p.y)))},getHatVector:function(u){return new t.Point(u.x,u.y).multiply(1/Math.hypot(u.x,u.y))},getBisector:function(u,p,m){var g=t.util.createVector(u,p),x=t.util.createVector(u,m),y=t.util.calcAngleBetweenVectors(g,x),w=t.util.calcAngleBetweenVectors(t.util.rotateVector(g,y),x),_=y*(w===0?1:-1)/2;return{vector:t.util.getHatVector(t.util.rotateVector(g,_)),angle:y}},projectStrokeOnPoints:function(u,p,m){var g=[],x=p.strokeWidth/2,y=p.strokeUniform?new t.Point(1/p.scaleX,1/p.scaleY):new t.Point(1,1),w=function(_){var C=x/Math.hypot(_.x,_.y);return new t.Point(_.x*C*y.x,_.y*C*y.y)};return u.length<=1||u.forEach(function(_,C){var E=new t.Point(_.x,_.y),T,A;C===0?(A=u[C+1],T=m?w(t.util.createVector(A,E)).addEquals(E):u[u.length-1]):C===u.length-1?(T=u[C-1],A=m?w(t.util.createVector(T,E)).addEquals(E):u[0]):(T=u[C-1],A=u[C+1]);var j=t.util.getBisector(E,T,A),B=j.vector,F=j.angle,L,G;if(p.strokeLineJoin==="miter"&&(L=-x/Math.sin(F/2),G=new t.Point(B.x*L*y.x,B.y*L*y.y),Math.hypot(G.x,G.y)/x<=p.strokeMiterLimit)){g.push(E.add(G)),g.push(E.subtract(G));return}L=-x*Math.SQRT2,G=new t.Point(B.x*L*y.x,B.y*L*y.y),g.push(E.add(G)),g.push(E.subtract(G))}),g},transformPoint:function(u,p,m){return m?new t.Point(p[0]*u.x+p[2]*u.y,p[1]*u.x+p[3]*u.y):new t.Point(p[0]*u.x+p[2]*u.y+p[4],p[1]*u.x+p[3]*u.y+p[5])},makeBoundingBoxFromPoints:function(u,p){if(p)for(var m=0;m<u.length;m++)u[m]=t.util.transformPoint(u[m],p);var g=[u[0].x,u[1].x,u[2].x,u[3].x],x=t.util.array.min(g),y=t.util.array.max(g),w=y-x,_=[u[0].y,u[1].y,u[2].y,u[3].y],C=t.util.array.min(_),E=t.util.array.max(_),T=E-C;return{left:x,top:C,width:w,height:T}},invertTransform:function(u){var p=1/(u[0]*u[3]-u[1]*u[2]),m=[p*u[3],-p*u[1],-p*u[2],p*u[0]],g=t.util.transformPoint({x:u[4],y:u[5]},m,!0);return m[4]=-g.x,m[5]=-g.y,m},toFixed:function(u,p){return parseFloat(Number(u).toFixed(p))},parseUnit:function(u,p){var m=/\D{0,2}$/.exec(u),g=parseFloat(u);switch(p||(p=t.Text.DEFAULT_SVG_FONT_SIZE),m[0]){case"mm":return g*t.DPI/25.4;case"cm":return g*t.DPI/2.54;case"in":return g*t.DPI;case"pt":return g*t.DPI/72;case"pc":return g*t.DPI/72*12;case"em":return g*p;default:return g}},falseFunction:function(){return!1},getKlass:function(u,p){return u=t.util.string.camelize(u.charAt(0).toUpperCase()+u.slice(1)),t.util.resolveNamespace(p)[u]},getSvgAttributes:function(u){var p=["instantiated_by_use","style","id","class"];switch(u){case"linearGradient":p=p.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":p=p.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":p=p.concat(["offset","stop-color","stop-opacity"]);break}return p},resolveNamespace:function(u){if(!u)return t;var p=u.split("."),m=p.length,g,x=o||t.window;for(g=0;g<m;++g)x=x[p[g]];return x},loadImage:function(u,p,m,g){if(!u){p&&p.call(m,u);return}var x=t.util.createImage(),y=function(){p&&p.call(m,x,!1),x=x.onload=x.onerror=null};x.onload=y,x.onerror=function(){t.log("Error loading "+x.src),p&&p.call(m,null,!0),x=x.onload=x.onerror=null},u.indexOf("data")!==0&&g!==void 0&&g!==null&&(x.crossOrigin=g),u.substring(0,14)==="data:image/svg"&&(x.onload=null,t.util.loadImageInDom(x,y)),x.src=u},loadImageInDom:function(u,p){var m=t.document.createElement("div");m.style.width=m.style.height="1px",m.style.left=m.style.top="-100%",m.style.position="absolute",m.appendChild(u),t.document.querySelector("body").appendChild(m),u.onload=function(){p(),m.parentNode.removeChild(m),m=null}},enlivenObjects:function(u,p,m,g){u=u||[];var x=[],y=0,w=u.length;function _(){++y===w&&p&&p(x.filter(function(C){return C}))}if(!w){p&&p(x);return}u.forEach(function(C,E){if(!C||!C.type){_();return}var T=t.util.getKlass(C.type,m);T.fromObject(C,function(A,j){j||(x[E]=A),g&&g(C,A,j),_()})})},enlivenObjectEnlivables:function(u,p,m){var g=t.Object.ENLIVEN_PROPS.filter(function(x){return!!u[x]});t.util.enlivenObjects(g.map(function(x){return u[x]}),function(x){var y={};g.forEach(function(w,_){y[w]=x[_],p&&(p[w]=x[_])}),m&&m(y)})},enlivenPatterns:function(u,p){u=u||[];function m(){++x===y&&p&&p(g)}var g=[],x=0,y=u.length;if(!y){p&&p(g);return}u.forEach(function(w,_){w&&w.source?new t.Pattern(w,function(C){g[_]=C,m()}):(g[_]=w,m())})},groupSVGElements:function(u,p,m){var g;return u&&u.length===1?(typeof m<"u"&&(u[0].sourcePath=m),u[0]):(p&&(p.width&&p.height?p.centerPoint={x:p.width/2,y:p.height/2}:(delete p.width,delete p.height)),g=new t.Group(u,p),typeof m<"u"&&(g.sourcePath=m),g)},populateWithProperties:function(u,p,m){if(m&&Array.isArray(m))for(var g=0,x=m.length;g<x;g++)m[g]in u&&(p[m[g]]=u[m[g]])},createCanvasElement:function(){return t.document.createElement("canvas")},copyCanvasElement:function(u){var p=t.util.createCanvasElement();return p.width=u.width,p.height=u.height,p.getContext("2d").drawImage(u,0,0),p},toDataURL:function(u,p,m){return u.toDataURL("image/"+p,m)},createImage:function(){return t.document.createElement("img")},multiplyTransformMatrices:function(u,p,m){return[u[0]*p[0]+u[2]*p[1],u[1]*p[0]+u[3]*p[1],u[0]*p[2]+u[2]*p[3],u[1]*p[2]+u[3]*p[3],m?0:u[0]*p[4]+u[2]*p[5]+u[4],m?0:u[1]*p[4]+u[3]*p[5]+u[5]]},qrDecompose:function(u){var p=c(u[1],u[0]),m=f(u[0],2)+f(u[1],2),g=a(m),x=(u[0]*u[3]-u[2]*u[1])/g,y=c(u[0]*u[2]+u[1]*u[3],m);return{angle:p/h,scaleX:g,scaleY:x,skewX:y/h,skewY:0,translateX:u[4],translateY:u[5]}},calcRotateMatrix:function(u){if(!u.angle)return t.iMatrix.concat();var p=t.util.degreesToRadians(u.angle),m=t.util.cos(p),g=t.util.sin(p);return[m,g,-g,m,0,0]},calcDimensionsMatrix:function(u){var p=typeof u.scaleX>"u"?1:u.scaleX,m=typeof u.scaleY>"u"?1:u.scaleY,g=[u.flipX?-p:p,0,0,u.flipY?-m:m,0,0],x=t.util.multiplyTransformMatrices,y=t.util.degreesToRadians;return u.skewX&&(g=x(g,[1,0,Math.tan(y(u.skewX)),1],!0)),u.skewY&&(g=x(g,[1,Math.tan(y(u.skewY)),0,1],!0)),g},composeMatrix:function(u){var p=[1,0,0,1,u.translateX||0,u.translateY||0],m=t.util.multiplyTransformMatrices;return u.angle&&(p=m(p,t.util.calcRotateMatrix(u))),(u.scaleX!==1||u.scaleY!==1||u.skewX||u.skewY||u.flipX||u.flipY)&&(p=m(p,t.util.calcDimensionsMatrix(u))),p},resetObjectTransform:function(u){u.scaleX=1,u.scaleY=1,u.skewX=0,u.skewY=0,u.flipX=!1,u.flipY=!1,u.rotate(0)},saveObjectTransform:function(u){return{scaleX:u.scaleX,scaleY:u.scaleY,skewX:u.skewX,skewY:u.skewY,angle:u.angle,left:u.left,flipX:u.flipX,flipY:u.flipY,top:u.top}},isTransparent:function(u,p,m,g){g>0&&(p>g?p-=g:p=0,m>g?m-=g:m=0);var x=!0,y,w,_=u.getImageData(p,m,g*2||1,g*2||1),C=_.data.length;for(y=3;y<C&&(w=_.data[y],x=w<=0,x!==!1);y+=4);return _=null,x},parsePreserveAspectRatioAttribute:function(u){var p="meet",m="Mid",g="Mid",x=u.split(" "),y;return x&&x.length&&(p=x.pop(),p!=="meet"&&p!=="slice"?(y=p,p="meet"):x.length&&(y=x.pop())),m=y!=="none"?y.slice(1,4):"none",g=y!=="none"?y.slice(5,8):"none",{meetOrSlice:p,alignX:m,alignY:g}},clearFabricFontCache:function(u){u=(u||"").toLowerCase(),u?t.charWidthsCache[u]&&delete t.charWidthsCache[u]:t.charWidthsCache={}},limitDimsByArea:function(u,p){var m=Math.sqrt(p*u),g=Math.floor(p/m);return{x:Math.floor(m),y:g}},capValue:function(u,p,m){return Math.max(u,Math.min(p,m))},findScaleToFit:function(u,p){return Math.min(p.width/u.width,p.height/u.height)},findScaleToCover:function(u,p){return Math.max(p.width/u.width,p.height/u.height)},matrixToSVG:function(u){return"matrix("+u.map(function(p){return t.util.toFixed(p,t.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(u,p){var m=t.util.invertTransform(p),g=t.util.multiplyTransformMatrices(m,u.calcOwnMatrix());t.util.applyTransformToObject(u,g)},addTransformToObject:function(u,p){t.util.applyTransformToObject(u,t.util.multiplyTransformMatrices(p,u.calcOwnMatrix()))},applyTransformToObject:function(u,p){var m=t.util.qrDecompose(p),g=new t.Point(m.translateX,m.translateY);u.flipX=!1,u.flipY=!1,u.set("scaleX",m.scaleX),u.set("scaleY",m.scaleY),u.skewX=m.skewX,u.skewY=m.skewY,u.angle=m.angle,u.setPositionByOrigin(g,"center","center")},sizeAfterTransform:function(u,p,m){var g=u/2,x=p/2,y=[{x:-g,y:-x},{x:g,y:-x},{x:-g,y:x},{x:g,y:x}],w=t.util.calcDimensionsMatrix(m),_=t.util.makeBoundingBoxFromPoints(y,w);return{x:_.width,y:_.height}},mergeClipPaths:function(u,p){var m=u,g=p;m.inverted&&!g.inverted&&(m=p,g=u),t.util.applyTransformToObject(g,t.util.multiplyTransformMatrices(t.util.invertTransform(m.calcTransformMatrix()),g.calcTransformMatrix()));var x=m.inverted&&g.inverted;return x&&(m.inverted=g.inverted=!1),new t.Group([m],{clipPath:g,inverted:x})},hasStyleChanged:function(u,p,m){return m=m||!1,u.fill!==p.fill||u.stroke!==p.stroke||u.strokeWidth!==p.strokeWidth||u.fontSize!==p.fontSize||u.fontFamily!==p.fontFamily||u.fontWeight!==p.fontWeight||u.fontStyle!==p.fontStyle||u.textBackgroundColor!==p.textBackgroundColor||u.deltaY!==p.deltaY||m&&(u.overline!==p.overline||u.underline!==p.underline||u.linethrough!==p.linethrough)},stylesToArray:function(m,p){for(var m=t.util.object.clone(m,!0),g=p.split(`
`),x=-1,y={},w=[],_=0;_<g.length;_++){if(!m[_]){x+=g[_].length;continue}for(var C=0;C<g[_].length;C++){x++;var E=m[_][C];if(E&&Object.keys(E).length>0){var T=t.util.hasStyleChanged(y,E,!0);T?w.push({start:x,end:x+1,style:E}):w[w.length-1].end++}y=E||{}}}return w},stylesFromArray:function(u,p){if(!Array.isArray(u))return u;for(var m=p.split(`
`),g=-1,x=0,y={},w=0;w<m.length;w++)for(var _=0;_<m[w].length;_++)g++,u[x]&&u[x].start<=g&&g<u[x].end&&(y[w]=y[w]||{},y[w][_]=Object.assign({},u[x].style),g===u[x].end-1&&x++);return y}}}(e),function(){var o=Array.prototype.join,a={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},c={m:"l",M:"L"};function f(P,H,U,S,I,O,N,R,z,K,Y){var Z=t.util.cos(P),se=t.util.sin(P),V=t.util.cos(H),le=t.util.sin(H),ae=U*I*V-S*O*le+N,W=S*I*V+U*O*le+R,he=K+z*(-U*I*se-S*O*Z),fe=Y+z*(-S*I*se+U*O*Z),Te=ae+z*(U*I*le+S*O*V),be=W+z*(S*I*le-U*O*V);return["C",he,fe,Te,be,ae,W]}function h(P,H,U,S,I,O,N){var R=Math.PI,z=N*R/180,K=t.util.sin(z),Y=t.util.cos(z),Z=0,se=0;U=Math.abs(U),S=Math.abs(S);var V=-Y*P*.5-K*H*.5,le=-Y*H*.5+K*P*.5,ae=U*U,W=S*S,he=le*le,fe=V*V,Te=ae*W-ae*he-W*fe,be=0;if(Te<0){var pe=Math.sqrt(1-Te/(ae*W));U*=pe,S*=pe}else be=(I===O?-1:1)*Math.sqrt(Te/(ae*he+W*fe));var xe=be*U*le/S,ce=-be*S*V/U,Ne=Y*xe-K*ce+P*.5,Ie=K*xe+Y*ce+H*.5,Re=d(1,0,(V-xe)/U,(le-ce)/S),De=d((V-xe)/U,(le-ce)/S,(-V-xe)/U,(-le-ce)/S);O===0&&De>0?De-=2*R:O===1&&De<0&&(De+=2*R);for(var Me=Math.ceil(Math.abs(De/R*2)),Ge=[],Ae=De/Me,Pe=8/3*Math.sin(Ae/4)*Math.sin(Ae/4)/Math.sin(Ae/2),Ue=Re+Ae,Ye=0;Ye<Me;Ye++)Ge[Ye]=f(Re,Ue,Y,K,U,S,Ne,Ie,Pe,Z,se),Z=Ge[Ye][5],se=Ge[Ye][6],Re=Ue,Ue+=Ae;return Ge}function d(P,H,U,S){var I=Math.atan2(H,P),O=Math.atan2(S,U);return O>=I?O-I:2*Math.PI-(I-O)}function u(P,H,U,S,I,O,N,R){var z;if(t.cachesBoundsOfCurve&&(z=o.call(arguments),t.boundsOfCurveCache[z]))return t.boundsOfCurveCache[z];var K=Math.sqrt,Y=Math.min,Z=Math.max,se=Math.abs,V=[],le=[[],[]],ae,W,he,fe,Te,be,pe,xe;W=6*P-12*U+6*I,ae=-3*P+9*U-9*I+3*N,he=3*U-3*P;for(var ce=0;ce<2;++ce){if(ce>0&&(W=6*H-12*S+6*O,ae=-3*H+9*S-9*O+3*R,he=3*S-3*H),se(ae)<1e-12){if(se(W)<1e-12)continue;fe=-he/W,0<fe&&fe<1&&V.push(fe);continue}pe=W*W-4*he*ae,!(pe<0)&&(xe=K(pe),Te=(-W+xe)/(2*ae),0<Te&&Te<1&&V.push(Te),be=(-W-xe)/(2*ae),0<be&&be<1&&V.push(be))}for(var Ne,Ie,Re=V.length,De=Re,Me;Re--;)fe=V[Re],Me=1-fe,Ne=Me*Me*Me*P+3*Me*Me*fe*U+3*Me*fe*fe*I+fe*fe*fe*N,le[0][Re]=Ne,Ie=Me*Me*Me*H+3*Me*Me*fe*S+3*Me*fe*fe*O+fe*fe*fe*R,le[1][Re]=Ie;le[0][De]=P,le[1][De]=H,le[0][De+1]=N,le[1][De+1]=R;var Ge=[{x:Y.apply(null,le[0]),y:Y.apply(null,le[1])},{x:Z.apply(null,le[0]),y:Z.apply(null,le[1])}];return t.cachesBoundsOfCurve&&(t.boundsOfCurveCache[z]=Ge),Ge}function p(P,H,U){for(var S=U[1],I=U[2],O=U[3],N=U[4],R=U[5],z=U[6],K=U[7],Y=h(z-P,K-H,S,I,N,R,O),Z=0,se=Y.length;Z<se;Z++)Y[Z][1]+=P,Y[Z][2]+=H,Y[Z][3]+=P,Y[Z][4]+=H,Y[Z][5]+=P,Y[Z][6]+=H;return Y}function m(P){var H=0,U=0,S=P.length,I=0,O=0,N,R,z,K=[],Y,Z,se;for(R=0;R<S;++R){switch(z=!1,N=P[R].slice(0),N[0]){case"l":N[0]="L",N[1]+=H,N[2]+=U;case"L":H=N[1],U=N[2];break;case"h":N[1]+=H;case"H":N[0]="L",N[2]=U,H=N[1];break;case"v":N[1]+=U;case"V":N[0]="L",U=N[1],N[1]=H,N[2]=U;break;case"m":N[0]="M",N[1]+=H,N[2]+=U;case"M":H=N[1],U=N[2],I=N[1],O=N[2];break;case"c":N[0]="C",N[1]+=H,N[2]+=U,N[3]+=H,N[4]+=U,N[5]+=H,N[6]+=U;case"C":Z=N[3],se=N[4],H=N[5],U=N[6];break;case"s":N[0]="S",N[1]+=H,N[2]+=U,N[3]+=H,N[4]+=U;case"S":Y==="C"?(Z=2*H-Z,se=2*U-se):(Z=H,se=U),H=N[3],U=N[4],N[0]="C",N[5]=N[3],N[6]=N[4],N[3]=N[1],N[4]=N[2],N[1]=Z,N[2]=se,Z=N[3],se=N[4];break;case"q":N[0]="Q",N[1]+=H,N[2]+=U,N[3]+=H,N[4]+=U;case"Q":Z=N[1],se=N[2],H=N[3],U=N[4];break;case"t":N[0]="T",N[1]+=H,N[2]+=U;case"T":Y==="Q"?(Z=2*H-Z,se=2*U-se):(Z=H,se=U),N[0]="Q",H=N[1],U=N[2],N[1]=Z,N[2]=se,N[3]=H,N[4]=U;break;case"a":N[0]="A",N[6]+=H,N[7]+=U;case"A":z=!0,K=K.concat(p(H,U,N)),H=N[6],U=N[7];break;case"z":case"Z":H=I,U=O;break}z||K.push(N),Y=N[0]}return K}function g(P,H,U,S){return Math.sqrt((U-P)*(U-P)+(S-H)*(S-H))}function x(P){return P*P*P}function y(P){return 3*P*P*(1-P)}function w(P){return 3*P*(1-P)*(1-P)}function _(P){return(1-P)*(1-P)*(1-P)}function C(P,H,U,S,I,O,N,R){return function(z){var K=x(z),Y=y(z),Z=w(z),se=_(z);return{x:N*K+I*Y+U*Z+P*se,y:R*K+O*Y+S*Z+H*se}}}function E(P,H,U,S,I,O,N,R){return function(z){var K=1-z,Y=3*K*K*(U-P)+6*K*z*(I-U)+3*z*z*(N-I),Z=3*K*K*(S-H)+6*K*z*(O-S)+3*z*z*(R-O);return Math.atan2(Z,Y)}}function T(P){return P*P}function A(P){return 2*P*(1-P)}function j(P){return(1-P)*(1-P)}function B(P,H,U,S,I,O){return function(N){var R=T(N),z=A(N),K=j(N);return{x:I*R+U*z+P*K,y:O*R+S*z+H*K}}}function F(P,H,U,S,I,O){return function(N){var R=1-N,z=2*R*(U-P)+2*N*(I-U),K=2*R*(S-H)+2*N*(O-S);return Math.atan2(K,z)}}function L(P,H,U){var S={x:H,y:U},I,O=0,N;for(N=1;N<=100;N+=1)I=P(N/100),O+=g(S.x,S.y,I.x,I.y),S=I;return O}function G(P,H){for(var U=0,S=0,I=P.iterator,O={x:P.x,y:P.y},N,R,z=.01,K=P.angleFinder,Y;S<H&&z>1e-4;)N=I(U),Y=U,R=g(O.x,O.y,N.x,N.y),R+S>H?(U-=z,z/=2):(O=N,U+=z,S+=R);return N.angle=K(Y),N}function X(P){for(var H=0,U=P.length,S,I=0,O=0,N=0,R=0,z=[],K,Y,Z,se=0;se<U;se++){switch(S=P[se],Y={x:I,y:O,command:S[0]},S[0]){case"M":Y.length=0,N=I=S[1],R=O=S[2];break;case"L":Y.length=g(I,O,S[1],S[2]),I=S[1],O=S[2];break;case"C":K=C(I,O,S[1],S[2],S[3],S[4],S[5],S[6]),Z=E(I,O,S[1],S[2],S[3],S[4],S[5],S[6]),Y.iterator=K,Y.angleFinder=Z,Y.length=L(K,I,O),I=S[5],O=S[6];break;case"Q":K=B(I,O,S[1],S[2],S[3],S[4]),Z=F(I,O,S[1],S[2],S[3],S[4]),Y.iterator=K,Y.angleFinder=Z,Y.length=L(K,I,O),I=S[3],O=S[4];break;case"Z":case"z":Y.destX=N,Y.destY=R,Y.length=g(I,O,N,R),I=N,O=R;break}H+=Y.length,z.push(Y)}return z.push({length:H,x:I,y:O}),z}function re(P,H,U){U||(U=X(P));for(var S=0;H-U[S].length>0&&S<U.length-2;)H-=U[S].length,S++;var I=U[S],O=H/I.length,N=I.command,R=P[S],z;switch(N){case"M":return{x:I.x,y:I.y,angle:0};case"Z":case"z":return z=new t.Point(I.x,I.y).lerp(new t.Point(I.destX,I.destY),O),z.angle=Math.atan2(I.destY-I.y,I.destX-I.x),z;case"L":return z=new t.Point(I.x,I.y).lerp(new t.Point(R[1],R[2]),O),z.angle=Math.atan2(R[2]-I.y,R[1]-I.x),z;case"C":return G(I,H);case"Q":return G(I,H)}}function Q(P){var H=[],U=[],S,I,O=t.rePathCommand,N="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",R="("+N+")"+t.commaWsp,z="([01])"+t.commaWsp+"?",K=R+"?"+R+"?"+R+z+z+R+"?("+N+")",Y=new RegExp(K,"g"),Z,se,V;if(!P||!P.match)return H;V=P.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var le=0,ae,W=V.length;le<W;le++){S=V[le],se=S.slice(1).trim(),U.length=0;var he=S.charAt(0);if(ae=[he],he.toLowerCase()==="a")for(var fe;fe=Y.exec(se);)for(var Te=1;Te<fe.length;Te++)U.push(fe[Te]);else for(;Z=O.exec(se);)U.push(Z[0]);for(var Te=0,be=U.length;Te<be;Te++)I=parseFloat(U[Te]),isNaN(I)||ae.push(I);var pe=a[he.toLowerCase()],xe=c[he]||he;if(ae.length-1>pe)for(var ce=1,Ne=ae.length;ce<Ne;ce+=pe)H.push([he].concat(ae.slice(ce,ce+pe))),he=xe;else H.push(ae)}return H}function ne(P,H){var U=[],S,I=new t.Point(P[0].x,P[0].y),O=new t.Point(P[1].x,P[1].y),N=P.length,R=1,z=0,K=N>2;for(H=H||0,K&&(R=P[2].x<O.x?-1:P[2].x===O.x?0:1,z=P[2].y<O.y?-1:P[2].y===O.y?0:1),U.push(["M",I.x-R*H,I.y-z*H]),S=1;S<N;S++){if(!I.eq(O)){var Y=I.midPointFrom(O);U.push(["Q",I.x,I.y,Y.x,Y.y])}I=P[S],S+1<P.length&&(O=P[S+1])}return K&&(R=I.x>P[S-2].x?1:I.x===P[S-2].x?0:-1,z=I.y>P[S-2].y?1:I.y===P[S-2].y?0:-1),U.push(["L",I.x+R*H,I.y+z*H]),U}function J(P,H,U){return U&&(H=t.util.multiplyTransformMatrices(H,[1,0,0,1,-U.x,-U.y])),P.map(function(S){for(var I=S.slice(0),O={},N=1;N<S.length-1;N+=2)O.x=S[N],O.y=S[N+1],O=t.util.transformPoint(O,H),I[N]=O.x,I[N+1]=O.y;return I})}t.util.joinPath=function(P){return P.map(function(H){return H.join(" ")}).join(" ")},t.util.parsePath=Q,t.util.makePathSimpler=m,t.util.getSmoothPathFromPoints=ne,t.util.getPathSegmentsInfo=X,t.util.getBoundsOfCurve=u,t.util.getPointOnPath=re,t.util.transformPath=J}(),function(){var o=Array.prototype.slice;function a(u,p){for(var m=o.call(arguments,2),g=[],x=0,y=u.length;x<y;x++)g[x]=m.length?u[x][p].apply(u[x],m):u[x][p].call(u[x]);return g}function c(u,p){return d(u,p,function(m,g){return m>=g})}function f(u,p){return d(u,p,function(m,g){return m<g})}function h(u,p){for(var m=u.length;m--;)u[m]=p;return u}function d(u,p,m){if(!(!u||u.length===0)){var g=u.length-1,x=p?u[g][p]:u[g];if(p)for(;g--;)m(u[g][p],x)&&(x=u[g][p]);else for(;g--;)m(u[g],x)&&(x=u[g]);return x}}t.util.array={fill:h,invoke:a,min:f,max:c}}(),function(){function o(c,f,h){if(h)if(!t.isLikelyNode&&f instanceof Element)c=f;else if(f instanceof Array){c=[];for(var d=0,u=f.length;d<u;d++)c[d]=o({},f[d],h)}else if(f&&typeof f=="object")for(var p in f)p==="canvas"||p==="group"?c[p]=null:f.hasOwnProperty(p)&&(c[p]=o({},f[p],h));else c=f;else for(var p in f)c[p]=f[p];return c}function a(c,f){return o({},c,f)}t.util.object={extend:o,clone:a},t.util.object.extend(t.util,t.Observable)}(),function(){function o(d){return d.replace(/-+(.)?/g,function(u,p){return p?p.toUpperCase():""})}function a(d,u){return d.charAt(0).toUpperCase()+(u?d.slice(1):d.slice(1).toLowerCase())}function c(d){return d.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function f(d){var u=0,p,m=[];for(u=0,p;u<d.length;u++)(p=h(d,u))!==!1&&m.push(p);return m}function h(d,u){var p=d.charCodeAt(u);if(isNaN(p))return"";if(p<55296||p>57343)return d.charAt(u);if(55296<=p&&p<=56319){if(d.length<=u+1)throw"High surrogate without following low surrogate";var m=d.charCodeAt(u+1);if(56320>m||m>57343)throw"High surrogate without following low surrogate";return d.charAt(u)+d.charAt(u+1)}if(u===0)throw"Low surrogate without preceding high surrogate";var g=d.charCodeAt(u-1);if(55296>g||g>56319)throw"Low surrogate without preceding high surrogate";return!1}t.util.string={camelize:o,capitalize:a,escapeXml:c,graphemeSplit:f}}(),function(){var o=Array.prototype.slice,a=function(){},c=function(){for(var p in{toString:1})if(p==="toString")return!1;return!0}(),f=function(p,m,g){for(var x in m)x in p.prototype&&typeof p.prototype[x]=="function"&&(m[x]+"").indexOf("callSuper")>-1?p.prototype[x]=function(y){return function(){var w=this.constructor.superclass;this.constructor.superclass=g;var _=m[y].apply(this,arguments);if(this.constructor.superclass=w,y!=="initialize")return _}}(x):p.prototype[x]=m[x],c&&(m.toString!==Object.prototype.toString&&(p.prototype.toString=m.toString),m.valueOf!==Object.prototype.valueOf&&(p.prototype.valueOf=m.valueOf))};function h(){}function d(p){for(var m=null,g=this;g.constructor.superclass;){var x=g.constructor.superclass.prototype[p];if(g[p]!==x){m=x;break}g=g.constructor.superclass.prototype}return m?arguments.length>1?m.apply(this,o.call(arguments,1)):m.call(this):console.log("tried to callSuper "+p+", method not found in prototype chain",this)}function u(){var p=null,m=o.call(arguments,0);typeof m[0]=="function"&&(p=m.shift());function g(){this.initialize.apply(this,arguments)}g.superclass=p,g.subclasses=[],p&&(h.prototype=p.prototype,g.prototype=new h,p.subclasses.push(g));for(var x=0,y=m.length;x<y;x++)f(g,m[x],p);return g.prototype.initialize||(g.prototype.initialize=a),g.prototype.constructor=g,g.prototype.callSuper=d,g}t.util.createClass=u}(),function(){var o=!!t.document.createElement("div").attachEvent,a=["touchstart","touchmove","touchend"];t.util.addListener=function(f,h,d,u){f&&f.addEventListener(h,d,o?!1:u)},t.util.removeListener=function(f,h,d,u){f&&f.removeEventListener(h,d,o?!1:u)};function c(f){var h=f.changedTouches;return h&&h[0]?h[0]:f}t.util.getPointer=function(f){var h=f.target,d=t.util.getScrollLeftTop(h),u=c(f);return{x:u.clientX+d.left,y:u.clientY+d.top}},t.util.isTouchEvent=function(f){return a.indexOf(f.type)>-1||f.pointerType==="touch"}}(),function(){function o(u,p){var m=u.style;if(!m)return u;if(typeof p=="string")return u.style.cssText+=";"+p,p.indexOf("opacity")>-1?d(u,p.match(/opacity:\s*(\d?\.?\d*)/)[1]):u;for(var g in p)if(g==="opacity")d(u,p[g]);else{var x=g==="float"||g==="cssFloat"?typeof m.styleFloat>"u"?"cssFloat":"styleFloat":g;m.setProperty(x,p[g])}return u}var a=t.document.createElement("div"),c=typeof a.style.opacity=="string",f=typeof a.style.filter=="string",h=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,d=function(u){return u};c?d=function(u,p){return u.style.opacity=p,u}:f&&(d=function(u,p){var m=u.style;return u.currentStyle&&!u.currentStyle.hasLayout&&(m.zoom=1),h.test(m.filter)?(p=p>=.9999?"":"alpha(opacity="+p*100+")",m.filter=m.filter.replace(h,p)):m.filter+=" alpha(opacity="+p*100+")",u}),t.util.setStyle=o}(),function(){var o=Array.prototype.slice;function a(_){return typeof _=="string"?t.document.getElementById(_):_}var c,f=function(_){return o.call(_,0)};try{c=f(t.document.childNodes)instanceof Array}catch{}c||(f=function(_){for(var C=new Array(_.length),E=_.length;E--;)C[E]=_[E];return C});function h(_,C){var E=t.document.createElement(_);for(var T in C)T==="class"?E.className=C[T]:T==="for"?E.htmlFor=C[T]:E.setAttribute(T,C[T]);return E}function d(_,C){_&&(" "+_.className+" ").indexOf(" "+C+" ")===-1&&(_.className+=(_.className?" ":"")+C)}function u(_,C,E){return typeof C=="string"&&(C=h(C,E)),_.parentNode&&_.parentNode.replaceChild(C,_),C.appendChild(_),C}function p(_){for(var C=0,E=0,T=t.document.documentElement,A=t.document.body||{scrollLeft:0,scrollTop:0};_&&(_.parentNode||_.host)&&(_=_.parentNode||_.host,_===t.document?(C=A.scrollLeft||T.scrollLeft||0,E=A.scrollTop||T.scrollTop||0):(C+=_.scrollLeft||0,E+=_.scrollTop||0),!(_.nodeType===1&&_.style.position==="fixed")););return{left:C,top:E}}function m(_){var C,E=_&&_.ownerDocument,T={left:0,top:0},A={left:0,top:0},j,B={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!E)return A;for(var F in B)A[B[F]]+=parseInt(g(_,F),10)||0;return C=E.documentElement,typeof _.getBoundingClientRect<"u"&&(T=_.getBoundingClientRect()),j=p(_),{left:T.left+j.left-(C.clientLeft||0)+A.left,top:T.top+j.top-(C.clientTop||0)+A.top}}var g;t.document.defaultView&&t.document.defaultView.getComputedStyle?g=function(_,C){var E=t.document.defaultView.getComputedStyle(_,null);return E?E[C]:void 0}:g=function(_,C){var E=_.style[C];return!E&&_.currentStyle&&(E=_.currentStyle[C]),E},function(){var _=t.document.documentElement.style,C="userSelect"in _?"userSelect":"MozUserSelect"in _?"MozUserSelect":"WebkitUserSelect"in _?"WebkitUserSelect":"KhtmlUserSelect"in _?"KhtmlUserSelect":"";function E(A){return typeof A.onselectstart<"u"&&(A.onselectstart=t.util.falseFunction),C?A.style[C]="none":typeof A.unselectable=="string"&&(A.unselectable="on"),A}function T(A){return typeof A.onselectstart<"u"&&(A.onselectstart=null),C?A.style[C]="":typeof A.unselectable=="string"&&(A.unselectable=""),A}t.util.makeElementUnselectable=E,t.util.makeElementSelectable=T}();function x(_){var C=t.jsdomImplForWrapper(_);return C._canvas||C._image}function y(_){if(t.isLikelyNode){var C=t.jsdomImplForWrapper(_);C&&(C._image=null,C._canvas=null,C._currentSrc=null,C._attributes=null,C._classList=null)}}function w(_,C){_.imageSmoothingEnabled=_.imageSmoothingEnabled||_.webkitImageSmoothingEnabled||_.mozImageSmoothingEnabled||_.msImageSmoothingEnabled||_.oImageSmoothingEnabled,_.imageSmoothingEnabled=C}t.util.setImageSmoothing=w,t.util.getById=a,t.util.toArray=f,t.util.addClass=d,t.util.makeElement=h,t.util.wrapElement=u,t.util.getScrollLeftTop=p,t.util.getElementOffset=m,t.util.getNodeCanvas=x,t.util.cleanUpJsdomNode=y}(),function(){function o(f,h){return f+(/\?/.test(f)?"&":"?")+h}function a(){}function c(f,h){h||(h={});var d=h.method?h.method.toUpperCase():"GET",u=h.onComplete||function(){},p=new t.window.XMLHttpRequest,m=h.body||h.parameters;return p.onreadystatechange=function(){p.readyState===4&&(u(p),p.onreadystatechange=a)},d==="GET"&&(m=null,typeof h.parameters=="string"&&(f=o(f,h.parameters))),p.open(d,f,!0),(d==="POST"||d==="PUT")&&p.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),p.send(m),p}t.util.request=c}(),t.log=console.log,t.warn=console.warn,function(){var o=t.util.object.extend,a=t.util.object.clone,c=[];t.util.object.extend(c,{cancelAll:function(){var x=this.splice(0);return x.forEach(function(y){y.cancel()}),x},cancelByCanvas:function(x){if(!x)return[];var y=this.filter(function(w){return typeof w.target=="object"&&w.target.canvas===x});return y.forEach(function(w){w.cancel()}),y},cancelByTarget:function(x){var y=this.findAnimationsByTarget(x);return y.forEach(function(w){w.cancel()}),y},findAnimationIndex:function(x){return this.indexOf(this.findAnimation(x))},findAnimation:function(x){return this.find(function(y){return y.cancel===x})},findAnimationsByTarget:function(x){return x?this.filter(function(y){return y.target===x}):[]}});function f(){return!1}function h(x,y,w,_){return-w*Math.cos(x/_*(Math.PI/2))+w+y}function d(x){x||(x={});var y=!1,w,_=function(){var C=t.runningAnimations.indexOf(w);return C>-1&&t.runningAnimations.splice(C,1)[0]};return w=o(a(x),{cancel:function(){return y=!0,_()},currentValue:"startValue"in x?x.startValue:0,completionRate:0,durationRate:0}),t.runningAnimations.push(w),m(function(C){var E=C||+new Date,T=x.duration||500,A=E+T,j,B=x.onChange||f,F=x.abort||f,L=x.onComplete||f,G=x.easing||h,X="startValue"in x?x.startValue.length>0:!1,re="startValue"in x?x.startValue:0,Q="endValue"in x?x.endValue:100,ne=x.byValue||(X?re.map(function(J,P){return Q[P]-re[P]}):Q-re);x.onStart&&x.onStart(),function J(P){j=P||+new Date;var H=j>A?T:j-E,U=H/T,S=X?re.map(function(O,N){return G(H,re[N],ne[N],T)}):G(H,re,ne,T),I=Math.abs(X?(S[0]-re[0])/ne[0]:(S-re)/ne);if(w.currentValue=X?S.slice():S,w.completionRate=I,w.durationRate=U,!y){if(F(S,I,U)){_();return}if(j>A){w.currentValue=X?Q.slice():Q,w.completionRate=1,w.durationRate=1,B(X?Q.slice():Q,1,1),L(Q,1,1),_();return}else B(S,I,U),m(J)}}(E)}),w.cancel}var u=t.window.requestAnimationFrame||t.window.webkitRequestAnimationFrame||t.window.mozRequestAnimationFrame||t.window.oRequestAnimationFrame||t.window.msRequestAnimationFrame||function(x){return t.window.setTimeout(x,1e3/60)},p=t.window.cancelAnimationFrame||t.window.clearTimeout;function m(){return u.apply(t.window,arguments)}function g(){return p.apply(t.window,arguments)}t.util.animate=d,t.util.requestAnimFrame=m,t.util.cancelAnimFrame=g,t.runningAnimations=c}(),function(){function o(c,f,h){var d="rgba("+parseInt(c[0]+h*(f[0]-c[0]),10)+","+parseInt(c[1]+h*(f[1]-c[1]),10)+","+parseInt(c[2]+h*(f[2]-c[2]),10);return d+=","+(c&&f?parseFloat(c[3]+h*(f[3]-c[3])):1),d+=")",d}function a(c,f,h,d){var u=new t.Color(c).getSource(),p=new t.Color(f).getSource(),m=d.onComplete,g=d.onChange;return d=d||{},t.util.animate(t.util.object.extend(d,{duration:h||500,startValue:u,endValue:p,byValue:p,easing:function(x,y,w,_){var C=d.colorEasing?d.colorEasing(x,_):1-Math.cos(x/_*(Math.PI/2));return o(y,w,C)},onComplete:function(x,y,w){if(m)return m(o(p,p,0),y,w)},onChange:function(x,y,w){if(g){if(Array.isArray(x))return g(o(x,x,0),y,w);g(x,y,w)}}}))}t.util.animateColor=a}(),function(){function o(P,H,U,S){return P<Math.abs(H)?(P=H,S=U/4):H===0&&P===0?S=U/(2*Math.PI)*Math.asin(1):S=U/(2*Math.PI)*Math.asin(H/P),{a:P,c:H,p:U,s:S}}function a(P,H,U){return P.a*Math.pow(2,10*(H-=1))*Math.sin((H*U-P.s)*(2*Math.PI)/P.p)}function c(P,H,U,S){return U*((P=P/S-1)*P*P+1)+H}function f(P,H,U,S){return P/=S/2,P<1?U/2*P*P*P+H:U/2*((P-=2)*P*P+2)+H}function h(P,H,U,S){return U*(P/=S)*P*P*P+H}function d(P,H,U,S){return-U*((P=P/S-1)*P*P*P-1)+H}function u(P,H,U,S){return P/=S/2,P<1?U/2*P*P*P*P+H:-U/2*((P-=2)*P*P*P-2)+H}function p(P,H,U,S){return U*(P/=S)*P*P*P*P+H}function m(P,H,U,S){return U*((P=P/S-1)*P*P*P*P+1)+H}function g(P,H,U,S){return P/=S/2,P<1?U/2*P*P*P*P*P+H:U/2*((P-=2)*P*P*P*P+2)+H}function x(P,H,U,S){return-U*Math.cos(P/S*(Math.PI/2))+U+H}function y(P,H,U,S){return U*Math.sin(P/S*(Math.PI/2))+H}function w(P,H,U,S){return-U/2*(Math.cos(Math.PI*P/S)-1)+H}function _(P,H,U,S){return P===0?H:U*Math.pow(2,10*(P/S-1))+H}function C(P,H,U,S){return P===S?H+U:U*(-Math.pow(2,-10*P/S)+1)+H}function E(P,H,U,S){return P===0?H:P===S?H+U:(P/=S/2,P<1?U/2*Math.pow(2,10*(P-1))+H:U/2*(-Math.pow(2,-10*--P)+2)+H)}function T(P,H,U,S){return-U*(Math.sqrt(1-(P/=S)*P)-1)+H}function A(P,H,U,S){return U*Math.sqrt(1-(P=P/S-1)*P)+H}function j(P,H,U,S){return P/=S/2,P<1?-U/2*(Math.sqrt(1-P*P)-1)+H:U/2*(Math.sqrt(1-(P-=2)*P)+1)+H}function B(P,H,U,S){var I=1.70158,O=0,N=U;if(P===0)return H;if(P/=S,P===1)return H+U;O||(O=S*.3);var R=o(N,U,O,I);return-a(R,P,S)+H}function F(P,H,U,S){var I=1.70158,O=0,N=U;if(P===0)return H;if(P/=S,P===1)return H+U;O||(O=S*.3);var R=o(N,U,O,I);return R.a*Math.pow(2,-10*P)*Math.sin((P*S-R.s)*(2*Math.PI)/R.p)+R.c+H}function L(P,H,U,S){var I=1.70158,O=0,N=U;if(P===0)return H;if(P/=S/2,P===2)return H+U;O||(O=S*(.3*1.5));var R=o(N,U,O,I);return P<1?-.5*a(R,P,S)+H:R.a*Math.pow(2,-10*(P-=1))*Math.sin((P*S-R.s)*(2*Math.PI)/R.p)*.5+R.c+H}function G(P,H,U,S,I){return I===void 0&&(I=1.70158),U*(P/=S)*P*((I+1)*P-I)+H}function X(P,H,U,S,I){return I===void 0&&(I=1.70158),U*((P=P/S-1)*P*((I+1)*P+I)+1)+H}function re(P,H,U,S,I){return I===void 0&&(I=1.70158),P/=S/2,P<1?U/2*(P*P*(((I*=1.525)+1)*P-I))+H:U/2*((P-=2)*P*(((I*=1.525)+1)*P+I)+2)+H}function Q(P,H,U,S){return U-ne(S-P,0,U,S)+H}function ne(P,H,U,S){return(P/=S)<1/2.75?U*(7.5625*P*P)+H:P<2/2.75?U*(7.5625*(P-=1.5/2.75)*P+.75)+H:P<2.5/2.75?U*(7.5625*(P-=2.25/2.75)*P+.9375)+H:U*(7.5625*(P-=2.625/2.75)*P+.984375)+H}function J(P,H,U,S){return P<S/2?Q(P*2,0,U,S)*.5+H:ne(P*2-S,0,U,S)*.5+U*.5+H}t.util.ease={easeInQuad:function(P,H,U,S){return U*(P/=S)*P+H},easeOutQuad:function(P,H,U,S){return-U*(P/=S)*(P-2)+H},easeInOutQuad:function(P,H,U,S){return P/=S/2,P<1?U/2*P*P+H:-U/2*(--P*(P-2)-1)+H},easeInCubic:function(P,H,U,S){return U*(P/=S)*P*P+H},easeOutCubic:c,easeInOutCubic:f,easeInQuart:h,easeOutQuart:d,easeInOutQuart:u,easeInQuint:p,easeOutQuint:m,easeInOutQuint:g,easeInSine:x,easeOutSine:y,easeInOutSine:w,easeInExpo:_,easeOutExpo:C,easeInOutExpo:E,easeInCirc:T,easeOutCirc:A,easeInOutCirc:j,easeInElastic:B,easeOutElastic:F,easeInOutElastic:L,easeInBack:G,easeOutBack:X,easeInOutBack:re,easeInBounce:Q,easeOutBounce:ne,easeInOutBounce:J}}(),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,f=a.util.object.clone,h=a.util.toFixed,d=a.util.parseUnit,u=a.util.multiplyTransformMatrices,p=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],m=["symbol","image","marker","pattern","view","svg"],g=["pattern","defs","symbol","metadata","clipPath","mask","desc"],x=["symbol","g","a","svg","clipPath","defs"],y={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},w={stroke:"strokeOpacity",fill:"fillOpacity"},_="font-size",C="clip-path";a.svgValidTagNamesRegEx=A(p),a.svgViewBoxElementsRegEx=A(m),a.svgInvalidAncestorsRegEx=A(g),a.svgValidParentsRegEx=A(x),a.cssRules={},a.gradientDefs={},a.clipPaths={};function E(O){return O in y?y[O]:O}function T(O,N,R,z){var K=Array.isArray(N),Y;if((O==="fill"||O==="stroke")&&N==="none")N="";else{if(O==="strokeUniform")return N==="non-scaling-stroke";if(O==="strokeDashArray")N==="none"?N=null:N=N.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(O==="transformMatrix")R&&R.transformMatrix?N=u(R.transformMatrix,a.parseTransformAttribute(N)):N=a.parseTransformAttribute(N);else if(O==="visible")N=N!=="none"&&N!=="hidden",R&&R.visible===!1&&(N=!1);else if(O==="opacity")N=parseFloat(N),R&&typeof R.opacity<"u"&&(N*=R.opacity);else if(O==="textAnchor")N=N==="start"?"left":N==="end"?"right":"center";else if(O==="charSpacing")Y=d(N,z)/z*1e3;else if(O==="paintFirst"){var Z=N.indexOf("fill"),se=N.indexOf("stroke"),N="fill";(Z>-1&&se>-1&&se<Z||Z===-1&&se>-1)&&(N="stroke")}else{if(O==="href"||O==="xlink:href"||O==="font")return N;if(O==="imageSmoothing")return N==="optimizeQuality";Y=K?N.map(d):d(N,z)}}return!K&&isNaN(Y)?N:Y}function A(O){return new RegExp("^("+O.join("|")+")\\b","i")}function j(O){for(var N in w)if(!(typeof O[w[N]]>"u"||O[N]==="")){if(typeof O[N]>"u"){if(!a.Object.prototype[N])continue;O[N]=a.Object.prototype[N]}if(O[N].indexOf("url(")!==0){var R=new a.Color(O[N]);O[N]=R.setAlpha(h(R.getAlpha()*O[w[N]],2)).toRgba()}}return O}function B(O,N){var R,z=[],K,Y,Z;for(Y=0,Z=N.length;Y<Z;Y++)R=N[Y],K=O.getElementsByTagName(R),z=z.concat(Array.prototype.slice.call(K));return z}a.parseTransformAttribute=function(){function O(ce,Ne){var Ie=a.util.cos(Ne[0]),Re=a.util.sin(Ne[0]),De=0,Me=0;Ne.length===3&&(De=Ne[1],Me=Ne[2]),ce[0]=Ie,ce[1]=Re,ce[2]=-Re,ce[3]=Ie,ce[4]=De-(Ie*De-Re*Me),ce[5]=Me-(Re*De+Ie*Me)}function N(ce,Ne){var Ie=Ne[0],Re=Ne.length===2?Ne[1]:Ne[0];ce[0]=Ie,ce[3]=Re}function R(ce,Ne,Ie){ce[Ie]=Math.tan(a.util.degreesToRadians(Ne[0]))}function z(ce,Ne){ce[4]=Ne[0],Ne.length===2&&(ce[5]=Ne[1])}var K=a.iMatrix,Y=a.reNum,Z=a.commaWsp,se="(?:(skewX)\\s*\\(\\s*("+Y+")\\s*\\))",V="(?:(skewY)\\s*\\(\\s*("+Y+")\\s*\\))",le="(?:(rotate)\\s*\\(\\s*("+Y+")(?:"+Z+"("+Y+")"+Z+"("+Y+"))?\\s*\\))",ae="(?:(scale)\\s*\\(\\s*("+Y+")(?:"+Z+"("+Y+"))?\\s*\\))",W="(?:(translate)\\s*\\(\\s*("+Y+")(?:"+Z+"("+Y+"))?\\s*\\))",he="(?:(matrix)\\s*\\(\\s*("+Y+")"+Z+"("+Y+")"+Z+"("+Y+")"+Z+"("+Y+")"+Z+"("+Y+")"+Z+"("+Y+")\\s*\\))",fe="(?:"+he+"|"+W+"|"+ae+"|"+le+"|"+se+"|"+V+")",Te="(?:"+fe+"(?:"+Z+"*"+fe+")*)",be="^\\s*(?:"+Te+"?)\\s*$",pe=new RegExp(be),xe=new RegExp(fe,"g");return function(ce){var Ne=K.concat(),Ie=[];if(!ce||ce&&!pe.test(ce))return Ne;ce.replace(xe,function(De){var Me=new RegExp(fe).exec(De).filter(function(Pe){return!!Pe}),Ge=Me[1],Ae=Me.slice(2).map(parseFloat);switch(Ge){case"translate":z(Ne,Ae);break;case"rotate":Ae[0]=a.util.degreesToRadians(Ae[0]),O(Ne,Ae);break;case"scale":N(Ne,Ae);break;case"skewX":R(Ne,Ae,2);break;case"skewY":R(Ne,Ae,1);break;case"matrix":Ne=Ae;break}Ie.push(Ne.concat()),Ne=K.concat()});for(var Re=Ie[0];Ie.length>1;)Ie.shift(),Re=a.util.multiplyTransformMatrices(Re,Ie[0]);return Re}}();function F(O,N){var R,z;O.replace(/;\s*$/,"").split(";").forEach(function(K){var Y=K.split(":");R=Y[0].trim().toLowerCase(),z=Y[1].trim(),N[R]=z})}function L(O,N){var R,z;for(var K in O)typeof O[K]>"u"||(R=K.toLowerCase(),z=O[K],N[R]=z)}function G(O,N){var R={};for(var z in a.cssRules[N])if(X(O,z.split(" ")))for(var K in a.cssRules[N][z])R[K]=a.cssRules[N][z][K];return R}function X(O,N){var R,z=!0;return R=Q(O,N.pop()),R&&N.length&&(z=re(O,N)),R&&z&&N.length===0}function re(O,N){for(var R,z=!0;O.parentNode&&O.parentNode.nodeType===1&&N.length;)z&&(R=N.pop()),O=O.parentNode,z=Q(O,R);return N.length===0}function Q(O,N){var R=O.nodeName,z=O.getAttribute("class"),K=O.getAttribute("id"),Y,Z;if(Y=new RegExp("^"+R,"i"),N=N.replace(Y,""),K&&N.length&&(Y=new RegExp("#"+K+"(?![a-zA-Z\\-]+)","i"),N=N.replace(Y,"")),z&&N.length)for(z=z.split(" "),Z=z.length;Z--;)Y=new RegExp("\\."+z[Z]+"(?![a-zA-Z\\-]+)","i"),N=N.replace(Y,"");return N.length===0}function ne(O,N){var R;if(O.getElementById&&(R=O.getElementById(N)),R)return R;var z,K,Y,Z=O.getElementsByTagName("*");for(K=0,Y=Z.length;K<Y;K++)if(z=Z[K],N===z.getAttribute("id"))return z}function J(O){for(var N=B(O,["use","svg:use"]),R=0;N.length&&R<N.length;){var z=N[R],K=z.getAttribute("xlink:href")||z.getAttribute("href");if(K===null)return;var Y=K.slice(1),Z=z.getAttribute("x")||0,se=z.getAttribute("y")||0,V=ne(O,Y).cloneNode(!0),le=(V.getAttribute("transform")||"")+" translate("+Z+", "+se+")",ae,W=N.length,he,fe,Te,be,pe=a.svgNS;if(H(V),/^svg$/i.test(V.nodeName)){var xe=V.ownerDocument.createElementNS(pe,"g");for(fe=0,Te=V.attributes,be=Te.length;fe<be;fe++)he=Te.item(fe),xe.setAttributeNS(pe,he.nodeName,he.nodeValue);for(;V.firstChild;)xe.appendChild(V.firstChild);V=xe}for(fe=0,Te=z.attributes,be=Te.length;fe<be;fe++)he=Te.item(fe),!(he.nodeName==="x"||he.nodeName==="y"||he.nodeName==="xlink:href"||he.nodeName==="href")&&(he.nodeName==="transform"?le=he.nodeValue+" "+le:V.setAttribute(he.nodeName,he.nodeValue));V.setAttribute("transform",le),V.setAttribute("instantiated_by_use","1"),V.removeAttribute("id"),ae=z.parentNode,ae.replaceChild(V,z),N.length===W&&R++}}var P=new RegExp("^\\s*("+a.reNum+"+)\\s*,?\\s*("+a.reNum+"+)\\s*,?\\s*("+a.reNum+"+)\\s*,?\\s*("+a.reNum+"+)\\s*$");function H(O){if(!a.svgViewBoxElementsRegEx.test(O.nodeName))return{};var N=O.getAttribute("viewBox"),R=1,z=1,K=0,Y=0,Z,se,V,le,ae=O.getAttribute("width"),W=O.getAttribute("height"),he=O.getAttribute("x")||0,fe=O.getAttribute("y")||0,Te=O.getAttribute("preserveAspectRatio")||"",be=!N||!(N=N.match(P)),pe=!ae||!W||ae==="100%"||W==="100%",xe=be&&pe,ce={},Ne="",Ie=0,Re=0;if(ce.width=0,ce.height=0,ce.toBeParsed=xe,be&&(he||fe)&&O.parentNode&&O.parentNode.nodeName!=="#document"&&(Ne=" translate("+d(he)+" "+d(fe)+") ",V=(O.getAttribute("transform")||"")+Ne,O.setAttribute("transform",V),O.removeAttribute("x"),O.removeAttribute("y")),xe)return ce;if(be)return ce.width=d(ae),ce.height=d(W),ce;if(K=-parseFloat(N[1]),Y=-parseFloat(N[2]),Z=parseFloat(N[3]),se=parseFloat(N[4]),ce.minX=K,ce.minY=Y,ce.viewBoxWidth=Z,ce.viewBoxHeight=se,pe?(ce.width=Z,ce.height=se):(ce.width=d(ae),ce.height=d(W),R=ce.width/Z,z=ce.height/se),Te=a.util.parsePreserveAspectRatioAttribute(Te),Te.alignX!=="none"&&(Te.meetOrSlice==="meet"&&(z=R=R>z?z:R),Te.meetOrSlice==="slice"&&(z=R=R>z?R:z),Ie=ce.width-Z*R,Re=ce.height-se*R,Te.alignX==="Mid"&&(Ie/=2),Te.alignY==="Mid"&&(Re/=2),Te.alignX==="Min"&&(Ie=0),Te.alignY==="Min"&&(Re=0)),R===1&&z===1&&K===0&&Y===0&&he===0&&fe===0)return ce;if((he||fe)&&O.parentNode.nodeName!=="#document"&&(Ne=" translate("+d(he)+" "+d(fe)+") "),V=Ne+" matrix("+R+" 0 0 "+z+" "+(K*R+Ie)+" "+(Y*z+Re)+") ",O.nodeName==="svg"){for(le=O.ownerDocument.createElementNS(a.svgNS,"g");O.firstChild;)le.appendChild(O.firstChild);O.appendChild(le)}else le=O,le.removeAttribute("x"),le.removeAttribute("y"),V=le.getAttribute("transform")+V;return le.setAttribute("transform",V),ce}function U(O,N){for(;O&&(O=O.parentNode);)if(O.nodeName&&N.test(O.nodeName.replace("svg:",""))&&!O.getAttribute("instantiated_by_use"))return!0;return!1}a.parseSVGDocument=function(O,N,R,z){if(O){J(O);var K=a.Object.__uid++,Y,Z,se=H(O),V=a.util.toArray(O.getElementsByTagName("*"));if(se.crossOrigin=z&&z.crossOrigin,se.svgUid=K,V.length===0&&a.isLikelyNode){V=O.selectNodes('//*[name(.)!="svg"]');var le=[];for(Y=0,Z=V.length;Y<Z;Y++)le[Y]=V[Y];V=le}var ae=V.filter(function(he){return H(he),a.svgValidTagNamesRegEx.test(he.nodeName.replace("svg:",""))&&!U(he,a.svgInvalidAncestorsRegEx)});if(!ae||ae&&!ae.length){N&&N([],{});return}var W={};V.filter(function(he){return he.nodeName.replace("svg:","")==="clipPath"}).forEach(function(he){var fe=he.getAttribute("id");W[fe]=a.util.toArray(he.getElementsByTagName("*")).filter(function(Te){return a.svgValidTagNamesRegEx.test(Te.nodeName.replace("svg:",""))})}),a.gradientDefs[K]=a.getGradientDefs(O),a.cssRules[K]=a.getCSSRules(O),a.clipPaths[K]=W,a.parseElements(ae,function(he,fe){N&&(N(he,se,fe,V),delete a.gradientDefs[K],delete a.cssRules[K],delete a.clipPaths[K])},f(se),R,z)}};function S(O,N){var R=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],z="xlink:href",K=N.getAttribute(z).slice(1),Y=ne(O,K);if(Y&&Y.getAttribute(z)&&S(O,Y),R.forEach(function(se){Y&&!N.hasAttribute(se)&&Y.hasAttribute(se)&&N.setAttribute(se,Y.getAttribute(se))}),!N.children.length)for(var Z=Y.cloneNode(!0);Z.firstChild;)N.appendChild(Z.firstChild);N.removeAttribute(z)}var I=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+a.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+a.reNum+"))?\\s+(.*)");c(a,{parseFontDeclaration:function(O,N){var R=O.match(I);if(R){var z=R[1],K=R[3],Y=R[4],Z=R[5],se=R[6];z&&(N.fontStyle=z),K&&(N.fontWeight=isNaN(parseFloat(K))?K:parseFloat(K)),Y&&(N.fontSize=d(Y)),se&&(N.fontFamily=se),Z&&(N.lineHeight=Z==="normal"?1:Z)}},getGradientDefs:function(O){var N=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],R=B(O,N),z,K=0,Y={};for(K=R.length;K--;)z=R[K],z.getAttribute("xlink:href")&&S(O,z),Y[z.getAttribute("id")]=z;return Y},parseAttributes:function(O,N,R){if(O){var z,K={},Y,Z;typeof R>"u"&&(R=O.getAttribute("svgUid")),O.parentNode&&a.svgValidParentsRegEx.test(O.parentNode.nodeName)&&(K=a.parseAttributes(O.parentNode,N,R));var se=N.reduce(function(Te,be){return z=O.getAttribute(be),z&&(Te[be]=z),Te},{}),V=c(G(O,R),a.parseStyleAttribute(O));se=c(se,V),V[C]&&O.setAttribute(C,V[C]),Y=Z=K.fontSize||a.Text.DEFAULT_SVG_FONT_SIZE,se[_]&&(se[_]=Y=d(se[_],Z));var le,ae,W={};for(var he in se)le=E(he),ae=T(le,se[he],K,Y),W[le]=ae;W&&W.font&&a.parseFontDeclaration(W.font,W);var fe=c(K,W);return a.svgValidParentsRegEx.test(O.nodeName)?fe:j(fe)}},parseElements:function(O,N,R,z,K){new a.ElementsParser(O,N,R,z,K).parse()},parseStyleAttribute:function(O){var N={},R=O.getAttribute("style");return R&&(typeof R=="string"?F(R,N):L(R,N)),N},parsePointsAttribute:function(O){if(!O)return null;O=O.replace(/,/g," ").trim(),O=O.split(/\s+/);var N=[],R,z;for(R=0,z=O.length;R<z;R+=2)N.push({x:parseFloat(O[R]),y:parseFloat(O[R+1])});return N},getCSSRules:function(O){var N=O.getElementsByTagName("style"),R,z,K={},Y;for(R=0,z=N.length;R<z;R++){var Z=N[R].textContent;Z=Z.replace(/\/\*[\s\S]*?\*\//g,""),Z.trim()!==""&&(Y=Z.split("}"),Y=Y.filter(function(se){return se.trim()}),Y.forEach(function(se){var V=se.split("{"),le={},ae=V[1].trim(),W=ae.split(";").filter(function(be){return be.trim()});for(R=0,z=W.length;R<z;R++){var he=W[R].split(":"),fe=he[0].trim(),Te=he[1].trim();le[fe]=Te}se=V[0].trim(),se.split(",").forEach(function(be){be=be.replace(/^svg/i,"").trim(),be!==""&&(K[be]?a.util.object.extend(K[be],le):K[be]=a.util.object.clone(le))})}))}return K},loadSVGFromURL:function(O,N,R,z){O=O.replace(/^\n\s*/,"").trim(),new a.util.request(O,{method:"get",onComplete:K});function K(Y){var Z=Y.responseXML;if(!Z||!Z.documentElement)return N&&N(null),!1;a.parseSVGDocument(Z.documentElement,function(se,V,le,ae){N&&N(se,V,le,ae)},R,z)}},loadSVGFromString:function(O,N,R,z){var K=new a.window.DOMParser,Y=K.parseFromString(O.trim(),"text/xml");a.parseSVGDocument(Y.documentElement,function(Z,se,V,le){N(Z,se,V,le)},R,z)}})}(e),t.ElementsParser=function(o,a,c,f,h,d){this.elements=o,this.callback=a,this.options=c,this.reviver=f,this.svgUid=c&&c.svgUid||0,this.parsingOptions=h,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=d},function(o){o.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},o.createObjects=function(){var a=this;this.elements.forEach(function(c,f){c.setAttribute("svgUid",a.svgUid),a.createObject(c,f)})},o.findTag=function(a){return t[t.util.string.capitalize(a.tagName.replace("svg:",""))]},o.createObject=function(a,c){var f=this.findTag(a);if(f&&f.fromElement)try{f.fromElement(a,this.createCallback(c,a),this.options)}catch(h){t.log(h)}else this.checkIfDone()},o.createCallback=function(a,c){var f=this;return function(h){var d;f.resolveGradient(h,c,"fill"),f.resolveGradient(h,c,"stroke"),h instanceof t.Image&&h._originalElement&&(d=h.parsePreserveAspectRatioAttribute(c)),h._removeTransformMatrix(d),f.resolveClipPath(h,c),f.reviver&&f.reviver(c,h),f.instances[a]=h,f.checkIfDone()}},o.extractPropertyDefinition=function(a,c,f){var h=a[c],d=this.regexUrl;if(d.test(h)){d.lastIndex=0;var u=d.exec(h)[1];return d.lastIndex=0,t[f][this.svgUid][u]}},o.resolveGradient=function(a,c,f){var h=this.extractPropertyDefinition(a,f,"gradientDefs");if(h){var d=c.getAttribute(f+"-opacity"),u=t.Gradient.fromElement(h,a,d,this.options);a.set(f,u)}},o.createClipPathCallback=function(a,c){return function(f){f._removeTransformMatrix(),f.fillRule=f.clipRule,c.push(f)}},o.resolveClipPath=function(a,c){var f=this.extractPropertyDefinition(a,"clipPath","clipPaths"),h,d,u,p,m,g;if(f){p=[],u=t.util.invertTransform(a.calcTransformMatrix());for(var x=f[0].parentNode,y=c;y.parentNode&&y.getAttribute("clip-path")!==a.clipPath;)y=y.parentNode;y.parentNode.appendChild(x);for(var w=0;w<f.length;w++)h=f[w],d=this.findTag(h),d.fromElement(h,this.createClipPathCallback(a,p),this.options);p.length===1?f=p[0]:f=new t.Group(p),m=t.util.multiplyTransformMatrices(u,f.calcTransformMatrix()),f.clipPath&&this.resolveClipPath(f,y);var g=t.util.qrDecompose(m);f.flipX=!1,f.flipY=!1,f.set("scaleX",g.scaleX),f.set("scaleY",g.scaleY),f.angle=g.angle,f.skewX=g.skewX,f.skewY=0,f.setPositionByOrigin({x:g.translateX,y:g.translateY},"center","center"),a.clipPath=f}else delete a.clipPath},o.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(a){return a!=null}),this.callback(this.instances,this.elements))}}(t.ElementsParser.prototype),function(o){var a=o.fabric||(o.fabric={});if(a.Point){a.warn("fabric.Point is already defined");return}a.Point=c;function c(f,h){this.x=f,this.y=h}c.prototype={type:"point",constructor:c,add:function(f){return new c(this.x+f.x,this.y+f.y)},addEquals:function(f){return this.x+=f.x,this.y+=f.y,this},scalarAdd:function(f){return new c(this.x+f,this.y+f)},scalarAddEquals:function(f){return this.x+=f,this.y+=f,this},subtract:function(f){return new c(this.x-f.x,this.y-f.y)},subtractEquals:function(f){return this.x-=f.x,this.y-=f.y,this},scalarSubtract:function(f){return new c(this.x-f,this.y-f)},scalarSubtractEquals:function(f){return this.x-=f,this.y-=f,this},multiply:function(f){return new c(this.x*f,this.y*f)},multiplyEquals:function(f){return this.x*=f,this.y*=f,this},divide:function(f){return new c(this.x/f,this.y/f)},divideEquals:function(f){return this.x/=f,this.y/=f,this},eq:function(f){return this.x===f.x&&this.y===f.y},lt:function(f){return this.x<f.x&&this.y<f.y},lte:function(f){return this.x<=f.x&&this.y<=f.y},gt:function(f){return this.x>f.x&&this.y>f.y},gte:function(f){return this.x>=f.x&&this.y>=f.y},lerp:function(f,h){return typeof h>"u"&&(h=.5),h=Math.max(Math.min(1,h),0),new c(this.x+(f.x-this.x)*h,this.y+(f.y-this.y)*h)},distanceFrom:function(f){var h=this.x-f.x,d=this.y-f.y;return Math.sqrt(h*h+d*d)},midPointFrom:function(f){return this.lerp(f)},min:function(f){return new c(Math.min(this.x,f.x),Math.min(this.y,f.y))},max:function(f){return new c(Math.max(this.x,f.x),Math.max(this.y,f.y))},toString:function(){return this.x+","+this.y},setXY:function(f,h){return this.x=f,this.y=h,this},setX:function(f){return this.x=f,this},setY:function(f){return this.y=f,this},setFromPoint:function(f){return this.x=f.x,this.y=f.y,this},swap:function(f){var h=this.x,d=this.y;this.x=f.x,this.y=f.y,f.x=h,f.y=d},clone:function(){return new c(this.x,this.y)}}}(e),function(o){var a=o.fabric||(o.fabric={});if(a.Intersection){a.warn("fabric.Intersection is already defined");return}function c(f){this.status=f,this.points=[]}a.Intersection=c,a.Intersection.prototype={constructor:c,appendPoint:function(f){return this.points.push(f),this},appendPoints:function(f){return this.points=this.points.concat(f),this}},a.Intersection.intersectLineLine=function(f,h,d,u){var p,m=(u.x-d.x)*(f.y-d.y)-(u.y-d.y)*(f.x-d.x),g=(h.x-f.x)*(f.y-d.y)-(h.y-f.y)*(f.x-d.x),x=(u.y-d.y)*(h.x-f.x)-(u.x-d.x)*(h.y-f.y);if(x!==0){var y=m/x,w=g/x;0<=y&&y<=1&&0<=w&&w<=1?(p=new c("Intersection"),p.appendPoint(new a.Point(f.x+y*(h.x-f.x),f.y+y*(h.y-f.y)))):p=new c}else m===0||g===0?p=new c("Coincident"):p=new c("Parallel");return p},a.Intersection.intersectLinePolygon=function(f,h,d){var u=new c,p=d.length,m,g,x,y;for(y=0;y<p;y++)m=d[y],g=d[(y+1)%p],x=c.intersectLineLine(f,h,m,g),u.appendPoints(x.points);return u.points.length>0&&(u.status="Intersection"),u},a.Intersection.intersectPolygonPolygon=function(f,h){var d=new c,u=f.length,p;for(p=0;p<u;p++){var m=f[p],g=f[(p+1)%u],x=c.intersectLinePolygon(m,g,h);d.appendPoints(x.points)}return d.points.length>0&&(d.status="Intersection"),d},a.Intersection.intersectPolygonRectangle=function(f,h,d){var u=h.min(d),p=h.max(d),m=new a.Point(p.x,u.y),g=new a.Point(u.x,p.y),x=c.intersectLinePolygon(u,m,f),y=c.intersectLinePolygon(m,p,f),w=c.intersectLinePolygon(p,g,f),_=c.intersectLinePolygon(g,u,f),C=new c;return C.appendPoints(x.points),C.appendPoints(y.points),C.appendPoints(w.points),C.appendPoints(_.points),C.points.length>0&&(C.status="Intersection"),C}}(e),function(o){var a=o.fabric||(o.fabric={});if(a.Color){a.warn("fabric.Color is already defined.");return}function c(h){h?this._tryParsingColor(h):this.setSource([0,0,0,1])}a.Color=c,a.Color.prototype={_tryParsingColor:function(h){var d;h in c.colorNameMap&&(h=c.colorNameMap[h]),h==="transparent"&&(d=[255,255,255,0]),d||(d=c.sourceFromHex(h)),d||(d=c.sourceFromRgb(h)),d||(d=c.sourceFromHsl(h)),d||(d=[0,0,0,1]),d&&this.setSource(d)},_rgbToHsl:function(h,d,u){h/=255,d/=255,u/=255;var p,m,g,x=a.util.array.max([h,d,u]),y=a.util.array.min([h,d,u]);if(g=(x+y)/2,x===y)p=m=0;else{var w=x-y;switch(m=g>.5?w/(2-x-y):w/(x+y),x){case h:p=(d-u)/w+(d<u?6:0);break;case d:p=(u-h)/w+2;break;case u:p=(h-d)/w+4;break}p/=6}return[Math.round(p*360),Math.round(m*100),Math.round(g*100)]},getSource:function(){return this._source},setSource:function(h){this._source=h},toRgb:function(){var h=this.getSource();return"rgb("+h[0]+","+h[1]+","+h[2]+")"},toRgba:function(){var h=this.getSource();return"rgba("+h[0]+","+h[1]+","+h[2]+","+h[3]+")"},toHsl:function(){var h=this.getSource(),d=this._rgbToHsl(h[0],h[1],h[2]);return"hsl("+d[0]+","+d[1]+"%,"+d[2]+"%)"},toHsla:function(){var h=this.getSource(),d=this._rgbToHsl(h[0],h[1],h[2]);return"hsla("+d[0]+","+d[1]+"%,"+d[2]+"%,"+h[3]+")"},toHex:function(){var h=this.getSource(),d,u,p;return d=h[0].toString(16),d=d.length===1?"0"+d:d,u=h[1].toString(16),u=u.length===1?"0"+u:u,p=h[2].toString(16),p=p.length===1?"0"+p:p,d.toUpperCase()+u.toUpperCase()+p.toUpperCase()},toHexa:function(){var h=this.getSource(),d;return d=Math.round(h[3]*255),d=d.toString(16),d=d.length===1?"0"+d:d,this.toHex()+d.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(h){var d=this.getSource();return d[3]=h,this.setSource(d),this},toGrayscale:function(){var h=this.getSource(),d=parseInt((h[0]*.3+h[1]*.59+h[2]*.11).toFixed(0),10),u=h[3];return this.setSource([d,d,d,u]),this},toBlackWhite:function(h){var d=this.getSource(),u=(d[0]*.3+d[1]*.59+d[2]*.11).toFixed(0),p=d[3];return h=h||127,u=Number(u)<Number(h)?0:255,this.setSource([u,u,u,p]),this},overlayWith:function(h){h instanceof c||(h=new c(h));var d=[],u=this.getAlpha(),p=.5,m=this.getSource(),g=h.getSource(),x;for(x=0;x<3;x++)d.push(Math.round(m[x]*(1-p)+g[x]*p));return d[3]=u,this.setSource(d),this}},a.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,a.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,a.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,a.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function f(h,d,u){return u<0&&(u+=1),u>1&&(u-=1),u<1/6?h+(d-h)*6*u:u<1/2?d:u<2/3?h+(d-h)*(2/3-u)*6:h}a.Color.fromRgb=function(h){return c.fromSource(c.sourceFromRgb(h))},a.Color.sourceFromRgb=function(h){var d=h.match(c.reRGBa);if(d){var u=parseInt(d[1],10)/(/%$/.test(d[1])?100:1)*(/%$/.test(d[1])?255:1),p=parseInt(d[2],10)/(/%$/.test(d[2])?100:1)*(/%$/.test(d[2])?255:1),m=parseInt(d[3],10)/(/%$/.test(d[3])?100:1)*(/%$/.test(d[3])?255:1);return[parseInt(u,10),parseInt(p,10),parseInt(m,10),d[4]?parseFloat(d[4]):1]}},a.Color.fromRgba=c.fromRgb,a.Color.fromHsl=function(h){return c.fromSource(c.sourceFromHsl(h))},a.Color.sourceFromHsl=function(h){var d=h.match(c.reHSLa);if(d){var u=(parseFloat(d[1])%360+360)%360/360,p=parseFloat(d[2])/(/%$/.test(d[2])?100:1),m=parseFloat(d[3])/(/%$/.test(d[3])?100:1),g,x,y;if(p===0)g=x=y=m;else{var w=m<=.5?m*(p+1):m+p-m*p,_=m*2-w;g=f(_,w,u+1/3),x=f(_,w,u),y=f(_,w,u-1/3)}return[Math.round(g*255),Math.round(x*255),Math.round(y*255),d[4]?parseFloat(d[4]):1]}},a.Color.fromHsla=c.fromHsl,a.Color.fromHex=function(h){return c.fromSource(c.sourceFromHex(h))},a.Color.sourceFromHex=function(h){if(h.match(c.reHex)){var d=h.slice(h.indexOf("#")+1),u=d.length===3||d.length===4,p=d.length===8||d.length===4,m=u?d.charAt(0)+d.charAt(0):d.substring(0,2),g=u?d.charAt(1)+d.charAt(1):d.substring(2,4),x=u?d.charAt(2)+d.charAt(2):d.substring(4,6),y=p?u?d.charAt(3)+d.charAt(3):d.substring(6,8):"FF";return[parseInt(m,16),parseInt(g,16),parseInt(x,16),parseFloat((parseInt(y,16)/255).toFixed(2))]}},a.Color.fromSource=function(h){var d=new c;return d.setSource(h),d}}(e),function(o){var a=o.fabric||(o.fabric={}),c=["e","se","s","sw","w","nw","n","ne","e"],f=["ns","nesw","ew","nwse"],h={},d="left",u="top",p="right",m="bottom",g="center",x={top:m,bottom:u,left:p,right:d,center:g},y=a.util.radiansToDegrees,w=Math.sign||function(le){return(le>0)-(le<0)||+le};function _(le,ae){var W=le.angle+y(Math.atan2(ae.y,ae.x))+360;return Math.round(W%360/45)}function C(le,ae){var W=ae.transform.target,he=W.canvas,fe=a.util.object.clone(ae);fe.target=W,he&&he.fire("object:"+le,fe),W.fire(le,ae)}function E(le,ae){var W=ae.canvas,he=W.uniScaleKey,fe=le[he];return W.uniformScaling&&!fe||!W.uniformScaling&&fe}function T(le){return le.originX===g&&le.originY===g}function A(le,ae,W){var he=le.lockScalingX,fe=le.lockScalingY;return!!(he&&fe||!ae&&(he||fe)&&W||he&&ae==="x"||fe&&ae==="y")}function j(le,ae,W){var he="not-allowed",fe=E(le,W),Te="";if(ae.x!==0&&ae.y===0?Te="x":ae.x===0&&ae.y!==0&&(Te="y"),A(W,Te,fe))return he;var be=_(W,ae);return c[be]+"-resize"}function B(le,ae,W){var he="not-allowed";if(ae.x!==0&&W.lockSkewingY||ae.y!==0&&W.lockSkewingX)return he;var fe=_(W,ae)%4;return f[fe]+"-resize"}function F(le,ae,W){return le[W.canvas.altActionKey]?h.skewCursorStyleHandler(le,ae,W):h.scaleCursorStyleHandler(le,ae,W)}function L(le,ae,W){var he=le[W.canvas.altActionKey];if(ae.x===0)return he?"skewX":"scaleY";if(ae.y===0)return he?"skewY":"scaleX"}function G(le,ae,W){return W.lockRotation?"not-allowed":ae.cursorStyle}function X(le,ae,W,he){return{e:le,transform:ae,pointer:{x:W,y:he}}}function re(le){return function(ae,W,he,fe){var Te=W.target,be=Te.getCenterPoint(),pe=Te.translateToOriginPoint(be,W.originX,W.originY),xe=le(ae,W,he,fe);return Te.setPositionByOrigin(pe,W.originX,W.originY),xe}}function Q(le,ae){return function(W,he,fe,Te){var be=ae(W,he,fe,Te);return be&&C(le,X(W,he,fe,Te)),be}}function ne(le,ae,W,he,fe){var Te=le.target,be=Te.controls[le.corner],pe=Te.canvas.getZoom(),xe=Te.padding/pe,ce=Te.toLocalPoint(new a.Point(he,fe),ae,W);return ce.x>=xe&&(ce.x-=xe),ce.x<=-xe&&(ce.x+=xe),ce.y>=xe&&(ce.y-=xe),ce.y<=xe&&(ce.y+=xe),ce.x-=be.offsetX,ce.y-=be.offsetY,ce}function J(le){return le.flipX!==le.flipY}function P(le,ae,W,he,fe){if(le[ae]!==0){var Te=le._getTransformedDimensions()[he],be=fe/Te*le[W];le.set(W,be)}}function H(le,ae,W,he){var fe=ae.target,Te=fe._getTransformedDimensions(0,fe.skewY),be=ne(ae,ae.originX,ae.originY,W,he),pe=Math.abs(be.x*2)-Te.x,xe=fe.skewX,ce;pe<2?ce=0:(ce=y(Math.atan2(pe/fe.scaleX,Te.y/fe.scaleY)),ae.originX===d&&ae.originY===m&&(ce=-ce),ae.originX===p&&ae.originY===u&&(ce=-ce),J(fe)&&(ce=-ce));var Ne=xe!==ce;if(Ne){var Ie=fe._getTransformedDimensions().y;fe.set("skewX",ce),P(fe,"skewY","scaleY","y",Ie)}return Ne}function U(le,ae,W,he){var fe=ae.target,Te=fe._getTransformedDimensions(fe.skewX,0),be=ne(ae,ae.originX,ae.originY,W,he),pe=Math.abs(be.y*2)-Te.y,xe=fe.skewY,ce;pe<2?ce=0:(ce=y(Math.atan2(pe/fe.scaleY,Te.x/fe.scaleX)),ae.originX===d&&ae.originY===m&&(ce=-ce),ae.originX===p&&ae.originY===u&&(ce=-ce),J(fe)&&(ce=-ce));var Ne=xe!==ce;if(Ne){var Ie=fe._getTransformedDimensions().x;fe.set("skewY",ce),P(fe,"skewX","scaleX","x",Ie)}return Ne}function S(le,ae,W,he){var fe=ae.target,Te=fe.skewX,be,pe=ae.originY;if(fe.lockSkewingX)return!1;if(Te===0){var xe=ne(ae,g,g,W,he);xe.x>0?be=d:be=p}else Te>0&&(be=pe===u?d:p),Te<0&&(be=pe===u?p:d),J(fe)&&(be=be===d?p:d);ae.originX=be;var ce=Q("skewing",re(H));return ce(le,ae,W,he)}function I(le,ae,W,he){var fe=ae.target,Te=fe.skewY,be,pe=ae.originX;if(fe.lockSkewingY)return!1;if(Te===0){var xe=ne(ae,g,g,W,he);xe.y>0?be=u:be=m}else Te>0&&(be=pe===d?u:m),Te<0&&(be=pe===d?m:u),J(fe)&&(be=be===u?m:u);ae.originY=be;var ce=Q("skewing",re(U));return ce(le,ae,W,he)}function O(le,ae,W,he){var fe=ae,Te=fe.target,be=Te.translateToOriginPoint(Te.getCenterPoint(),fe.originX,fe.originY);if(Te.lockRotation)return!1;var pe=Math.atan2(fe.ey-be.y,fe.ex-be.x),xe=Math.atan2(he-be.y,W-be.x),ce=y(xe-pe+fe.theta),Ne=!0;if(Te.snapAngle>0){var Ie=Te.snapAngle,Re=Te.snapThreshold||Ie,De=Math.ceil(ce/Ie)*Ie,Me=Math.floor(ce/Ie)*Ie;Math.abs(ce-Me)<Re?ce=Me:Math.abs(ce-De)<Re&&(ce=De)}return ce<0&&(ce=360+ce),ce%=360,Ne=Te.angle!==ce,Te.angle=ce,Ne}function N(le,ae,W,he,fe){fe=fe||{};var Te=ae.target,be=Te.lockScalingX,pe=Te.lockScalingY,xe=fe.by,ce,Ne,Ie,Re,De=E(le,Te),Me=A(Te,xe,De),Ge,Ae,Pe=ae.gestureScale;if(Me)return!1;if(Pe)Ne=ae.scaleX*Pe,Ie=ae.scaleY*Pe;else{if(ce=ne(ae,ae.originX,ae.originY,W,he),Ge=xe!=="y"?w(ce.x):1,Ae=xe!=="x"?w(ce.y):1,ae.signX||(ae.signX=Ge),ae.signY||(ae.signY=Ae),Te.lockScalingFlip&&(ae.signX!==Ge||ae.signY!==Ae))return!1;if(Re=Te._getTransformedDimensions(),De&&!xe){var Ue=Math.abs(ce.x)+Math.abs(ce.y),Ye=ae.original,nt=Math.abs(Re.x*Ye.scaleX/Te.scaleX)+Math.abs(Re.y*Ye.scaleY/Te.scaleY),Qe=Ue/nt;Ne=Ye.scaleX*Qe,Ie=Ye.scaleY*Qe}else Ne=Math.abs(ce.x*Te.scaleX/Re.x),Ie=Math.abs(ce.y*Te.scaleY/Re.y);T(ae)&&(Ne*=2,Ie*=2),ae.signX!==Ge&&xe!=="y"&&(ae.originX=x[ae.originX],Ne*=-1,ae.signX=Ge),ae.signY!==Ae&&xe!=="x"&&(ae.originY=x[ae.originY],Ie*=-1,ae.signY=Ae)}var ht=Te.scaleX,it=Te.scaleY;return xe?(xe==="x"&&Te.set("scaleX",Ne),xe==="y"&&Te.set("scaleY",Ie)):(!be&&Te.set("scaleX",Ne),!pe&&Te.set("scaleY",Ie)),ht!==Te.scaleX||it!==Te.scaleY}function R(le,ae,W,he){return N(le,ae,W,he)}function z(le,ae,W,he){return N(le,ae,W,he,{by:"x"})}function K(le,ae,W,he){return N(le,ae,W,he,{by:"y"})}function Y(le,ae,W,he){return le[ae.target.canvas.altActionKey]?h.skewHandlerX(le,ae,W,he):h.scalingY(le,ae,W,he)}function Z(le,ae,W,he){return le[ae.target.canvas.altActionKey]?h.skewHandlerY(le,ae,W,he):h.scalingX(le,ae,W,he)}function se(le,ae,W,he){var fe=ae.target,Te=ne(ae,ae.originX,ae.originY,W,he),be=fe.strokeWidth/(fe.strokeUniform?fe.scaleX:1),pe=T(ae)?2:1,xe=fe.width,ce=Math.abs(Te.x*pe/fe.scaleX)-be;return fe.set("width",Math.max(ce,0)),xe!==ce}function V(le,ae,W,he){var fe=ae.target,Te=W-ae.offsetX,be=he-ae.offsetY,pe=!fe.get("lockMovementX")&&fe.left!==Te,xe=!fe.get("lockMovementY")&&fe.top!==be;return pe&&fe.set("left",Te),xe&&fe.set("top",be),(pe||xe)&&C("moving",X(le,ae,W,he)),pe||xe}h.scaleCursorStyleHandler=j,h.skewCursorStyleHandler=B,h.scaleSkewCursorStyleHandler=F,h.rotationWithSnapping=Q("rotating",re(O)),h.scalingEqually=Q("scaling",re(R)),h.scalingX=Q("scaling",re(z)),h.scalingY=Q("scaling",re(K)),h.scalingYOrSkewingX=Y,h.scalingXOrSkewingY=Z,h.changeWidth=Q("resizing",re(se)),h.skewHandlerX=S,h.skewHandlerY=I,h.dragHandler=V,h.scaleOrSkewActionName=L,h.rotationStyleHandler=G,h.fireEvent=C,h.wrapWithFixedAnchor=re,h.wrapWithFireEvent=Q,h.getLocalPoint=ne,a.controlsUtils=h}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.degreesToRadians,f=a.controlsUtils;function h(u,p,m,g,x){g=g||{};var y=this.sizeX||g.cornerSize||x.cornerSize,w=this.sizeY||g.cornerSize||x.cornerSize,_=typeof g.transparentCorners<"u"?g.transparentCorners:x.transparentCorners,C=_?"stroke":"fill",E=!_&&(g.cornerStrokeColor||x.cornerStrokeColor),T=p,A=m,j;u.save(),u.fillStyle=g.cornerColor||x.cornerColor,u.strokeStyle=g.cornerStrokeColor||x.cornerStrokeColor,y>w?(j=y,u.scale(1,w/y),A=m*y/w):w>y?(j=w,u.scale(y/w,1),T=p*w/y):j=y,u.lineWidth=1,u.beginPath(),u.arc(T,A,j/2,0,2*Math.PI,!1),u[C](),E&&u.stroke(),u.restore()}function d(u,p,m,g,x){g=g||{};var y=this.sizeX||g.cornerSize||x.cornerSize,w=this.sizeY||g.cornerSize||x.cornerSize,_=typeof g.transparentCorners<"u"?g.transparentCorners:x.transparentCorners,C=_?"stroke":"fill",E=!_&&(g.cornerStrokeColor||x.cornerStrokeColor),T=y/2,A=w/2;u.save(),u.fillStyle=g.cornerColor||x.cornerColor,u.strokeStyle=g.cornerStrokeColor||x.cornerStrokeColor,u.lineWidth=1,u.translate(p,m),u.rotate(c(x.angle)),u[C+"Rect"](-T,-A,y,w),E&&u.strokeRect(-T,-A,y,w),u.restore()}f.renderCircleControl=h,f.renderSquareControl=d}(e),function(o){var a=o.fabric||(o.fabric={});function c(f){for(var h in f)this[h]=f[h]}a.Control=c,a.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(f,h){return h.cursorStyle},getActionName:function(f,h){return h.actionName},getVisibility:function(f,h){var d=f._controlsVisibility;return d&&typeof d[h]<"u"?d[h]:this.visible},setVisibility:function(f){this.visible=f},positionHandler:function(f,h){var d=a.util.transformPoint({x:this.x*f.x+this.offsetX,y:this.y*f.y+this.offsetY},h);return d},calcCornerCoords:function(f,h,d,u,p){var m,g,x,y,w=p?this.touchSizeX:this.sizeX,_=p?this.touchSizeY:this.sizeY;if(w&&_&&w!==_){var C=Math.atan2(_,w),E=Math.sqrt(w*w+_*_)/2,T=C-a.util.degreesToRadians(f),A=Math.PI/2-C-a.util.degreesToRadians(f);m=E*a.util.cos(T),g=E*a.util.sin(T),x=E*a.util.cos(A),y=E*a.util.sin(A)}else{var j=w&&_?w:h;E=j*.7071067812;var T=a.util.degreesToRadians(45-f);m=x=E*a.util.cos(T),g=y=E*a.util.sin(T)}return{tl:{x:d-y,y:u-x},tr:{x:d+m,y:u-g},bl:{x:d-m,y:u+g},br:{x:d+y,y:u+x}}},render:function(f,h,d,u,p){switch(u=u||{},u.cornerStyle||p.cornerStyle){case"circle":a.controlsUtils.renderCircleControl.call(this,f,h,d,u,p);break;default:a.controlsUtils.renderSquareControl.call(this,f,h,d,u,p)}}}}(e),function(){function o(d,u){var p=d.getAttribute("style"),m=d.getAttribute("offset")||0,g,x,y,w;if(m=parseFloat(m)/(/%$/.test(m)?100:1),m=m<0?0:m>1?1:m,p){var _=p.split(/\s*;\s*/);for(_[_.length-1]===""&&_.pop(),w=_.length;w--;){var C=_[w].split(/\s*:\s*/),E=C[0].trim(),T=C[1].trim();E==="stop-color"?g=T:E==="stop-opacity"&&(y=T)}}return g||(g=d.getAttribute("stop-color")||"rgb(0,0,0)"),y||(y=d.getAttribute("stop-opacity")),g=new t.Color(g),x=g.getAlpha(),y=isNaN(parseFloat(y))?1:parseFloat(y),y*=x*u,{offset:m,color:g.toRgb(),opacity:y}}function a(d){return{x1:d.getAttribute("x1")||0,y1:d.getAttribute("y1")||0,x2:d.getAttribute("x2")||"100%",y2:d.getAttribute("y2")||0}}function c(d){return{x1:d.getAttribute("fx")||d.getAttribute("cx")||"50%",y1:d.getAttribute("fy")||d.getAttribute("cy")||"50%",r1:0,x2:d.getAttribute("cx")||"50%",y2:d.getAttribute("cy")||"50%",r2:d.getAttribute("r")||"50%"}}var f=t.util.object.clone;t.Gradient=t.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(d){d||(d={}),d.coords||(d.coords={});var u,p=this;Object.keys(d).forEach(function(m){p[m]=d[m]}),this.id?this.id+="_"+t.Object.__uid++:this.id=t.Object.__uid++,u={x1:d.coords.x1||0,y1:d.coords.y1||0,x2:d.coords.x2||0,y2:d.coords.y2||0},this.type==="radial"&&(u.r1=d.coords.r1||0,u.r2=d.coords.r2||0),this.coords=u,this.colorStops=d.colorStops.slice()},addColorStop:function(d){for(var u in d){var p=new t.Color(d[u]);this.colorStops.push({offset:parseFloat(u),color:p.toRgb(),opacity:p.getAlpha()})}return this},toObject:function(d){var u={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return t.util.populateWithProperties(this,u,d),u},toSVG:function(d,x){var p=f(this.coords,!0),m,g,x=x||{},y,w,_=f(this.colorStops,!0),C=p.r1>p.r2,E=this.gradientTransform?this.gradientTransform.concat():t.iMatrix.concat(),T=-this.offsetX,A=-this.offsetY,j=!!x.additionalTransform,B=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(_.sort(function(re,Q){return re.offset-Q.offset}),B==="objectBoundingBox"?(T/=d.width,A/=d.height):(T+=d.width/2,A+=d.height/2),d.type==="path"&&this.gradientUnits!=="percentage"&&(T-=d.pathOffset.x,A-=d.pathOffset.y),E[4]-=T,E[5]-=A,w='id="SVGID_'+this.id+'" gradientUnits="'+B+'"',w+=' gradientTransform="'+(j?x.additionalTransform+" ":"")+t.util.matrixToSVG(E)+'" ',this.type==="linear"?y=["<linearGradient ",w,' x1="',p.x1,'" y1="',p.y1,'" x2="',p.x2,'" y2="',p.y2,`">
`]:this.type==="radial"&&(y=["<radialGradient ",w,' cx="',C?p.x1:p.x2,'" cy="',C?p.y1:p.y2,'" r="',C?p.r1:p.r2,'" fx="',C?p.x2:p.x1,'" fy="',C?p.y2:p.y1,`">
`]),this.type==="radial"){if(C)for(_=_.concat(),_.reverse(),m=0,g=_.length;m<g;m++)_[m].offset=1-_[m].offset;var F=Math.min(p.r1,p.r2);if(F>0){var L=Math.max(p.r1,p.r2),G=F/L;for(m=0,g=_.length;m<g;m++)_[m].offset+=G*(1-_[m].offset)}}for(m=0,g=_.length;m<g;m++){var X=_[m];y.push("<stop ",'offset="',X.offset*100+"%",'" style="stop-color:',X.color,typeof X.opacity<"u"?";stop-opacity: "+X.opacity:";",`"/>
`)}return y.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),y.join("")},toLive:function(d){var u,p=t.util.object.clone(this.coords),m,g;if(this.type){for(this.type==="linear"?u=d.createLinearGradient(p.x1,p.y1,p.x2,p.y2):this.type==="radial"&&(u=d.createRadialGradient(p.x1,p.y1,p.r1,p.x2,p.y2,p.r2)),m=0,g=this.colorStops.length;m<g;m++){var x=this.colorStops[m].color,y=this.colorStops[m].opacity,w=this.colorStops[m].offset;typeof y<"u"&&(x=new t.Color(x).setAlpha(y).toRgba()),u.addColorStop(w,x)}return u}}}),t.util.object.extend(t.Gradient,{fromElement:function(d,u,p,m){var g=parseFloat(p)/(/%$/.test(p)?100:1);g=g<0?0:g>1?1:g,isNaN(g)&&(g=1);var x=d.getElementsByTagName("stop"),y,w=d.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",_=d.getAttribute("gradientTransform")||"",C=[],E,T,A=0,j=0,B;for(d.nodeName==="linearGradient"||d.nodeName==="LINEARGRADIENT"?(y="linear",E=a(d)):(y="radial",E=c(d)),T=x.length;T--;)C.push(o(x[T],g));B=t.parseTransformAttribute(_),h(u,E,m,w),w==="pixels"&&(A=-u.left,j=-u.top);var F=new t.Gradient({id:d.getAttribute("id"),type:y,coords:E,colorStops:C,gradientUnits:w,gradientTransform:B,offsetX:A,offsetY:j});return F}});function h(d,u,p,m){var g,x;Object.keys(u).forEach(function(y){g=u[y],g==="Infinity"?x=1:g==="-Infinity"?x=0:(x=parseFloat(u[y],10),typeof g=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(g)&&(x*=.01,m==="pixels"&&((y==="x1"||y==="x2"||y==="r2")&&(x*=p.viewBoxWidth||p.width),(y==="y1"||y==="y2")&&(x*=p.viewBoxHeight||p.height)))),u[y]=x})}}(),function(){var o=t.util.toFixed;t.Pattern=t.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(a,c){if(a||(a={}),this.id=t.Object.__uid++,this.setOptions(a),!a.source||a.source&&typeof a.source!="string"){c&&c(this);return}else{var f=this;this.source=t.util.createImage(),t.util.loadImage(a.source,function(h,d){f.source=h,c&&c(f,d)},null,this.crossOrigin)}},toObject:function(a){var c=t.Object.NUM_FRACTION_DIGITS,f,h;return typeof this.source.src=="string"?f=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(f=this.source.toDataURL()),h={type:"pattern",source:f,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:o(this.offsetX,c),offsetY:o(this.offsetY,c),patternTransform:this.patternTransform?this.patternTransform.concat():null},t.util.populateWithProperties(this,h,a),h},toSVG:function(a){var c=typeof this.source=="function"?this.source():this.source,f=c.width/a.width,h=c.height/a.height,d=this.offsetX/a.width,u=this.offsetY/a.height,p="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(h=1,u&&(h+=Math.abs(u))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(f=1,d&&(f+=Math.abs(d))),c.src?p=c.src:c.toDataURL&&(p=c.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+d+'" y="'+u+'" width="'+f+'" height="'+h+`">
<image x="0" y="0" width="`+c.width+'" height="'+c.height+'" xlink:href="'+p+`"></image>
</pattern>
`},setOptions:function(a){for(var c in a)this[c]=a[c]},toLive:function(a){var c=this.source;return!c||typeof c.src<"u"&&(!c.complete||c.naturalWidth===0||c.naturalHeight===0)?"":a.createPattern(c,this.repeat)}})}(),function(o){var a=o.fabric||(o.fabric={}),c=a.util.toFixed;if(a.Shadow){a.warn("fabric.Shadow is already defined.");return}a.Shadow=a.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(f){typeof f=="string"&&(f=this._parseShadow(f));for(var h in f)this[h]=f[h];this.id=a.Object.__uid++},_parseShadow:function(f){var h=f.trim(),d=a.Shadow.reOffsetsAndBlur.exec(h)||[],u=h.replace(a.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:u.trim(),offsetX:parseFloat(d[1],10)||0,offsetY:parseFloat(d[2],10)||0,blur:parseFloat(d[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(f){var h=40,d=40,u=a.Object.NUM_FRACTION_DIGITS,p=a.util.rotateVector({x:this.offsetX,y:this.offsetY},a.util.degreesToRadians(-f.angle)),m=20,g=new a.Color(this.color);return f.width&&f.height&&(h=c((Math.abs(p.x)+this.blur)/f.width,u)*100+m,d=c((Math.abs(p.y)+this.blur)/f.height,u)*100+m),f.flipX&&(p.x*=-1),f.flipY&&(p.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+d+'%" height="'+(100+2*d)+'%" x="-'+h+'%" width="'+(100+2*h)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+c(this.blur?this.blur/2:0,u)+`"></feGaussianBlur>
	<feOffset dx="`+c(p.x,u)+'" dy="'+c(p.y,u)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+g.toRgb()+'" flood-opacity="'+g.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var f={},h=a.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(d){this[d]!==h[d]&&(f[d]=this[d])},this),f}}),a.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(e),function(){if(t.StaticCanvas){t.warn("fabric.StaticCanvas is already defined.");return}var o=t.util.object.extend,a=t.util.getElementOffset,c=t.util.removeFromArray,f=t.util.toFixed,h=t.util.transformPoint,d=t.util.invertTransform,u=t.util.getNodeCanvas,p=t.util.createCanvasElement,m=new Error("Could not initialize `canvas` element");t.StaticCanvas=t.util.createClass(t.CommonMethods,{initialize:function(g,x){x||(x={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(g,x)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:t.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(g,x){var y=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(g),this._initOptions(x),this.interactive||this._initRetinaScaling(),x.overlayImage&&this.setOverlayImage(x.overlayImage,y),x.backgroundImage&&this.setBackgroundImage(x.backgroundImage,y),x.backgroundColor&&this.setBackgroundColor(x.backgroundColor,y),x.overlayColor&&this.setOverlayColor(x.overlayColor,y),this.calcOffset()},_isRetinaScaling:function(){return t.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,t.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var g=t.devicePixelRatio;this.__initRetinaScaling(g,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(g,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(g,x,y){x.setAttribute("width",this.width*g),x.setAttribute("height",this.height*g),y.scale(g,g)},calcOffset:function(){return this._offset=a(this.lowerCanvasEl),this},setOverlayImage:function(g,x,y){return this.__setBgOverlayImage("overlayImage",g,x,y)},setBackgroundImage:function(g,x,y){return this.__setBgOverlayImage("backgroundImage",g,x,y)},setOverlayColor:function(g,x){return this.__setBgOverlayColor("overlayColor",g,x)},setBackgroundColor:function(g,x){return this.__setBgOverlayColor("backgroundColor",g,x)},__setBgOverlayImage:function(g,x,y,w){return typeof x=="string"?t.util.loadImage(x,function(_,C){if(_){var E=new t.Image(_,w);this[g]=E,E.canvas=this}y&&y(_,C)},this,w&&w.crossOrigin):(w&&x.setOptions(w),this[g]=x,x&&(x.canvas=this),y&&y(x,!1)),this},__setBgOverlayColor:function(g,x,y){return this[g]=x,this._initGradient(x,g),this._initPattern(x,g,y),this},_createCanvasElement:function(){var g=p();if(!g||(g.style||(g.style={}),typeof g.getContext>"u"))throw m;return g},_initOptions:function(g){var x=this.lowerCanvasEl;this._setOptions(g),this.width=this.width||parseInt(x.width,10)||0,this.height=this.height||parseInt(x.height,10)||0,this.lowerCanvasEl.style&&(x.width=this.width,x.height=this.height,x.style.width=this.width+"px",x.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(g){g&&g.getContext?this.lowerCanvasEl=g:this.lowerCanvasEl=t.util.getById(g)||this._createCanvasElement(),t.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(g,x){return this.setDimensions({width:g},x)},setHeight:function(g,x){return this.setDimensions({height:g},x)},setDimensions:function(g,x){var y;x=x||{};for(var w in g)y=g[w],x.cssOnly||(this._setBackstoreDimension(w,g[w]),y+="px",this.hasLostContext=!0),x.backstoreOnly||this._setCssDimension(w,y);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),x.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(g,x){return this.lowerCanvasEl[g]=x,this.upperCanvasEl&&(this.upperCanvasEl[g]=x),this.cacheCanvasEl&&(this.cacheCanvasEl[g]=x),this[g]=x,this},_setCssDimension:function(g,x){return this.lowerCanvasEl.style[g]=x,this.upperCanvasEl&&(this.upperCanvasEl.style[g]=x),this.wrapperEl&&(this.wrapperEl.style[g]=x),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(g){var x=this._activeObject,y=this.backgroundImage,w=this.overlayImage,_,C,E;for(this.viewportTransform=g,C=0,E=this._objects.length;C<E;C++)_=this._objects[C],_.group||_.setCoords(!0);return x&&x.setCoords(),y&&y.setCoords(!0),w&&w.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(g,x){var y=g,w=this.viewportTransform.slice(0);g=h(g,d(this.viewportTransform)),w[0]=x,w[3]=x;var _=h(g,w);return w[4]+=y.x-_.x,w[5]+=y.y-_.y,this.setViewportTransform(w)},setZoom:function(g){return this.zoomToPoint(new t.Point(0,0),g),this},absolutePan:function(g){var x=this.viewportTransform.slice(0);return x[4]=-g.x,x[5]=-g.y,this.setViewportTransform(x)},relativePan:function(g){return this.absolutePan(new t.Point(-g.x-this.viewportTransform[4],-g.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(g){this.stateful&&g.setupState(),g._set("canvas",this),g.setCoords(),this.fire("object:added",{target:g}),g.fire("added")},_onObjectRemoved:function(g){this.fire("object:removed",{target:g}),g.fire("removed"),delete g.canvas},clearContext:function(g){return g.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var g=this.contextContainer;return this.renderCanvas(g,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=t.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var g={},x=this.width,y=this.height,w=d(this.viewportTransform);return g.tl=h({x:0,y:0},w),g.br=h({x,y},w),g.tr=new t.Point(g.br.x,g.tl.y),g.bl=new t.Point(g.tl.x,g.br.y),this.vptCoords=g,g},cancelRequestedRender:function(){this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(g,x){var y=this.viewportTransform,w=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(g),t.util.setImageSmoothing(g,this.imageSmoothingEnabled),this.fire("before:render",{ctx:g}),this._renderBackground(g),g.save(),g.transform(y[0],y[1],y[2],y[3],y[4],y[5]),this._renderObjects(g,x),g.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(g),w&&(w.canvas=this,w.shouldCache(),w._transformDone=!0,w.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(g)),this._renderOverlay(g),this.controlsAboveOverlay&&this.interactive&&this.drawControls(g),this.fire("after:render",{ctx:g})},drawClipPathOnCanvas:function(g){var x=this.viewportTransform,y=this.clipPath;g.save(),g.transform(x[0],x[1],x[2],x[3],x[4],x[5]),g.globalCompositeOperation="destination-in",y.transform(g),g.scale(1/y.zoomX,1/y.zoomY),g.drawImage(y._cacheCanvas,-y.cacheTranslationX,-y.cacheTranslationY),g.restore()},_renderObjects:function(g,x){var y,w;for(y=0,w=x.length;y<w;++y)x[y]&&x[y].render(g)},_renderBackgroundOrOverlay:function(g,x){var y=this[x+"Color"],w=this[x+"Image"],_=this.viewportTransform,C=this[x+"Vpt"];if(!(!y&&!w)){if(y){g.save(),g.beginPath(),g.moveTo(0,0),g.lineTo(this.width,0),g.lineTo(this.width,this.height),g.lineTo(0,this.height),g.closePath(),g.fillStyle=y.toLive?y.toLive(g,this):y,C&&g.transform(_[0],_[1],_[2],_[3],_[4],_[5]),g.transform(1,0,0,1,y.offsetX||0,y.offsetY||0);var E=y.gradientTransform||y.patternTransform;E&&g.transform(E[0],E[1],E[2],E[3],E[4],E[5]),g.fill(),g.restore()}if(w){g.save();var T=this.skipOffscreen;this.skipOffscreen=C,C&&g.transform(_[0],_[1],_[2],_[3],_[4],_[5]),w.render(g),this.skipOffscreen=T,g.restore()}}},_renderBackground:function(g){this._renderBackgroundOrOverlay(g,"background")},_renderOverlay:function(g){this._renderBackgroundOrOverlay(g,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new t.Point(this.width/2,this.height/2)},centerObjectH:function(g){return this._centerObject(g,new t.Point(this.getCenterPoint().x,g.getCenterPoint().y))},centerObjectV:function(g){return this._centerObject(g,new t.Point(g.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(g){var x=this.getCenterPoint();return this._centerObject(g,x)},viewportCenterObject:function(g){var x=this.getVpCenter();return this._centerObject(g,x)},viewportCenterObjectH:function(g){var x=this.getVpCenter();return this._centerObject(g,new t.Point(x.x,g.getCenterPoint().y)),this},viewportCenterObjectV:function(g){var x=this.getVpCenter();return this._centerObject(g,new t.Point(g.getCenterPoint().x,x.y))},getVpCenter:function(){var g=this.getCenterPoint(),x=d(this.viewportTransform);return h(g,x)},_centerObject:function(g,x){return g.setPositionByOrigin(x,"center","center"),g.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(g){return this.toDatalessObject(g)},toObject:function(g){return this._toObjectMethod("toObject",g)},toDatalessObject:function(g){return this._toObjectMethod("toDatalessObject",g)},_toObjectMethod:function(g,x){var y=this.clipPath,w={version:t.version,objects:this._toObjects(g,x)};return y&&!y.excludeFromExport&&(w.clipPath=this._toObject(this.clipPath,g,x)),o(w,this.__serializeBgOverlay(g,x)),t.util.populateWithProperties(this,w,x),w},_toObjects:function(g,x){return this._objects.filter(function(y){return!y.excludeFromExport}).map(function(y){return this._toObject(y,g,x)},this)},_toObject:function(g,x,y){var w;this.includeDefaultValues||(w=g.includeDefaultValues,g.includeDefaultValues=!1);var _=g[x](y);return this.includeDefaultValues||(g.includeDefaultValues=w),_},__serializeBgOverlay:function(g,x){var y={},w=this.backgroundImage,_=this.overlayImage,C=this.backgroundColor,E=this.overlayColor;return C&&C.toObject?C.excludeFromExport||(y.background=C.toObject(x)):C&&(y.background=C),E&&E.toObject?E.excludeFromExport||(y.overlay=E.toObject(x)):E&&(y.overlay=E),w&&!w.excludeFromExport&&(y.backgroundImage=this._toObject(w,g,x)),_&&!_.excludeFromExport&&(y.overlayImage=this._toObject(_,g,x)),y},svgViewportTransformation:!0,toSVG:function(g,x){g||(g={}),g.reviver=x;var y=[];return this._setSVGPreamble(y,g),this._setSVGHeader(y,g),this.clipPath&&y.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(y,"background"),this._setSVGBgOverlayImage(y,"backgroundImage",x),this._setSVGObjects(y,x),this.clipPath&&y.push(`</g>
`),this._setSVGBgOverlayColor(y,"overlay"),this._setSVGBgOverlayImage(y,"overlayImage",x),y.push("</svg>"),y.join("")},_setSVGPreamble:function(g,x){x.suppressPreamble||g.push('<?xml version="1.0" encoding="',x.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(g,x){var y=x.width||this.width,w=x.height||this.height,_,C='viewBox="0 0 '+this.width+" "+this.height+'" ',E=t.Object.NUM_FRACTION_DIGITS;x.viewBox?C='viewBox="'+x.viewBox.x+" "+x.viewBox.y+" "+x.viewBox.width+" "+x.viewBox.height+'" ':this.svgViewportTransformation&&(_=this.viewportTransform,C='viewBox="'+f(-_[4]/_[0],E)+" "+f(-_[5]/_[3],E)+" "+f(this.width/_[0],E)+" "+f(this.height/_[3],E)+'" '),g.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',y,'" ','height="',w,'" ',C,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",t.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(x),`</defs>
`)},createSVGClipPathMarkup:function(g){var x=this.clipPath;return x?(x.clipPathId="CLIPPATH_"+t.Object.__uid++,'<clipPath id="'+x.clipPathId+`" >
`+this.clipPath.toClipPathSVG(g.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var g=this,x=["background","overlay"].map(function(y){var w=g[y+"Color"];if(w&&w.toLive){var _=g[y+"Vpt"],C=g.viewportTransform,E={width:g.width/(_?C[0]:1),height:g.height/(_?C[3]:1)};return w.toSVG(E,{additionalTransform:_?t.util.matrixToSVG(C):""})}});return x.join("")},createSVGFontFacesMarkup:function(){var g="",x={},y,w,_,C,E,T,A,j,B,F=t.fontPaths,L=[];for(this._objects.forEach(function X(re){L.push(re),re._objects&&re._objects.forEach(X)}),j=0,B=L.length;j<B;j++)if(y=L[j],w=y.fontFamily,!(y.type.indexOf("text")===-1||x[w]||!F[w])&&(x[w]=!0,!!y.styles)){_=y.styles;for(E in _){C=_[E];for(A in C)T=C[A],w=T.fontFamily,!x[w]&&F[w]&&(x[w]=!0)}}for(var G in x)g+=[`		@font-face {
`,"			font-family: '",G,`';
`,"			src: url('",F[G],`');
`,`		}
`].join("");return g&&(g=['	<style type="text/css">',`<![CDATA[
`,g,"]]>",`</style>
`].join("")),g},_setSVGObjects:function(g,x){var y,w,_,C=this._objects;for(w=0,_=C.length;w<_;w++)y=C[w],!y.excludeFromExport&&this._setSVGObject(g,y,x)},_setSVGObject:function(g,x,y){g.push(x.toSVG(y))},_setSVGBgOverlayImage:function(g,x,y){this[x]&&!this[x].excludeFromExport&&this[x].toSVG&&g.push(this[x].toSVG(y))},_setSVGBgOverlayColor:function(g,x){var y=this[x+"Color"],w=this.viewportTransform,_=this.width,C=this.height;if(y)if(y.toLive){var E=y.repeat,T=t.util.invertTransform(w),A=this[x+"Vpt"],j=A?t.util.matrixToSVG(T):"";g.push('<rect transform="'+j+" translate(",_/2,",",C/2,')"',' x="',y.offsetX-_/2,'" y="',y.offsetY-C/2,'" ','width="',E==="repeat-y"||E==="no-repeat"?y.source.width:_,'" height="',E==="repeat-x"||E==="no-repeat"?y.source.height:C,'" fill="url(#SVGID_'+y.id+')"',`></rect>
`)}else g.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',y,'"',`></rect>
`)},sendToBack:function(g){if(!g)return this;var x=this._activeObject,y,w,_;if(g===x&&g.type==="activeSelection")for(_=x._objects,y=_.length;y--;)w=_[y],c(this._objects,w),this._objects.unshift(w);else c(this._objects,g),this._objects.unshift(g);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(g){if(!g)return this;var x=this._activeObject,y,w,_;if(g===x&&g.type==="activeSelection")for(_=x._objects,y=0;y<_.length;y++)w=_[y],c(this._objects,w),this._objects.push(w);else c(this._objects,g),this._objects.push(g);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(g,x){if(!g)return this;var y=this._activeObject,w,_,C,E,T,A=0;if(g===y&&g.type==="activeSelection")for(T=y._objects,w=0;w<T.length;w++)_=T[w],C=this._objects.indexOf(_),C>0+A&&(E=C-1,c(this._objects,_),this._objects.splice(E,0,_)),A++;else C=this._objects.indexOf(g),C!==0&&(E=this._findNewLowerIndex(g,C,x),c(this._objects,g),this._objects.splice(E,0,g));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(g,x,y){var w,_;if(y)for(w=x,_=x-1;_>=0;--_){var C=g.intersectsWithObject(this._objects[_])||g.isContainedWithinObject(this._objects[_])||this._objects[_].isContainedWithinObject(g);if(C){w=_;break}}else w=x-1;return w},bringForward:function(g,x){if(!g)return this;var y=this._activeObject,w,_,C,E,T,A=0;if(g===y&&g.type==="activeSelection")for(T=y._objects,w=T.length;w--;)_=T[w],C=this._objects.indexOf(_),C<this._objects.length-1-A&&(E=C+1,c(this._objects,_),this._objects.splice(E,0,_)),A++;else C=this._objects.indexOf(g),C!==this._objects.length-1&&(E=this._findNewUpperIndex(g,C,x),c(this._objects,g),this._objects.splice(E,0,g));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(g,x,y){var w,_,C;if(y)for(w=x,_=x+1,C=this._objects.length;_<C;++_){var E=g.intersectsWithObject(this._objects[_])||g.isContainedWithinObject(this._objects[_])||this._objects[_].isContainedWithinObject(g);if(E){w=_;break}}else w=x+1;return w},moveTo:function(g,x){return c(this._objects,g),this._objects.splice(x,0,g),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(g){g.dispose&&g.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),t.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),t.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),o(t.StaticCanvas.prototype,t.Observable),o(t.StaticCanvas.prototype,t.Collection),o(t.StaticCanvas.prototype,t.DataURLExporter),o(t.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(g){var x=p();if(!x||!x.getContext)return null;var y=x.getContext("2d");if(!y)return null;switch(g){case"setLineDash":return typeof y.setLineDash<"u";default:return null}}}),t.StaticCanvas.prototype.toJSON=t.StaticCanvas.prototype.toObject,t.isLikelyNode&&(t.StaticCanvas.prototype.createPNGStream=function(){var g=u(this.lowerCanvasEl);return g&&g.createPNGStream()},t.StaticCanvas.prototype.createJPEGStream=function(g){var x=u(this.lowerCanvasEl);return x&&x.createJPEGStream(g)})}(),t.BaseBrush=t.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(o){o.strokeStyle=this.color,o.lineWidth=this.width,o.lineCap=this.strokeLineCap,o.miterLimit=this.strokeMiterLimit,o.lineJoin=this.strokeLineJoin,o.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(o){var a=this.canvas.viewportTransform;o.save(),o.transform(a[0],a[1],a[2],a[3],a[4],a[5])},_setShadow:function(){if(this.shadow){var o=this.canvas,a=this.shadow,c=o.contextTop,f=o.getZoom();o&&o._isRetinaScaling()&&(f*=t.devicePixelRatio),c.shadowColor=a.color,c.shadowBlur=a.blur*f,c.shadowOffsetX=a.offsetX*f,c.shadowOffsetY=a.offsetY*f}},needsFullRender:function(){var o=new t.Color(this.color);return o.getAlpha()<1||!!this.shadow},_resetShadow:function(){var o=this.canvas.contextTop;o.shadowColor="",o.shadowBlur=o.shadowOffsetX=o.shadowOffsetY=0},_isOutSideCanvas:function(o){return o.x<0||o.x>this.canvas.getWidth()||o.y<0||o.y>this.canvas.getHeight()}}),function(){t.PencilBrush=t.util.createClass(t.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(o){this.canvas=o,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(o,a,c){var f=a.midPointFrom(c);return o.quadraticCurveTo(a.x,a.y,f.x,f.y),f},onMouseDown:function(o,a){this.canvas._isMainEvent(a.e)&&(this.drawStraightLine=a.e[this.straightLineKey],this._prepareForDrawing(o),this._captureDrawingPath(o),this._render())},onMouseMove:function(o,a){if(this.canvas._isMainEvent(a.e)&&(this.drawStraightLine=a.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o))&&this._captureDrawingPath(o)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var c=this._points,f=c.length,h=this.canvas.contextTop;this._saveAndTransform(h),this.oldEnd&&(h.beginPath(),h.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(h,c[f-2],c[f-1],!0),h.stroke(),h.restore()}},onMouseUp:function(o){return this.canvas._isMainEvent(o.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(o){var a=new t.Point(o.x,o.y);this._reset(),this._addPoint(a),this.canvas.contextTop.moveTo(a.x,a.y)},_addPoint:function(o){return this._points.length>1&&o.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(o),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(o){var a=new t.Point(o.x,o.y);return this._addPoint(a)},_render:function(o){var a,c,f=this._points[0],h=this._points[1];if(o=o||this.canvas.contextTop,this._saveAndTransform(o),o.beginPath(),this._points.length===2&&f.x===h.x&&f.y===h.y){var d=this.width/1e3;f=new t.Point(f.x,f.y),h=new t.Point(h.x,h.y),f.x-=d,h.x+=d}for(o.moveTo(f.x,f.y),a=1,c=this._points.length;a<c;a++)this._drawSegment(o,f,h),f=this._points[a],h=this._points[a+1];o.lineTo(f.x,f.y),o.stroke(),o.restore()},convertPointsToSVGPath:function(o){var a=this.width/1e3;return t.util.getSmoothPathFromPoints(o,a)},_isEmptySVGPath:function(o){var a=t.util.joinPath(o);return a==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(o){var a=new t.Path(o,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,a.shadow=new t.Shadow(this.shadow)),a},decimatePoints:function(o,a){if(o.length<=2)return o;var c=this.canvas.getZoom(),f=Math.pow(a/c,2),h,d=o.length-1,u=o[0],p=[u],m;for(h=1;h<d-1;h++)m=Math.pow(u.x-o[h].x,2)+Math.pow(u.y-o[h].y,2),m>=f&&(u=o[h],p.push(u));return p.push(o[d]),p},_finalizeAndAddPath:function(){var o=this.canvas.contextTop;o.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var a=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(a)){this.canvas.requestRenderAll();return}var c=this.createPath(a);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:c}),this.canvas.add(c),this.canvas.requestRenderAll(),c.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:c})}})}(),t.CircleBrush=t.util.createClass(t.BaseBrush,{width:10,initialize:function(o){this.canvas=o,this.points=[]},drawDot:function(o){var a=this.addPoint(o),c=this.canvas.contextTop;this._saveAndTransform(c),this.dot(c,a),c.restore()},dot:function(o,a){o.fillStyle=a.fill,o.beginPath(),o.arc(a.x,a.y,a.radius,0,Math.PI*2,!1),o.closePath(),o.fill()},onMouseDown:function(o){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(o)},_render:function(){var o=this.canvas.contextTop,a,c,f=this.points;for(this._saveAndTransform(o),a=0,c=f.length;a<c;a++)this.dot(o,f[a]);o.restore()},onMouseMove:function(o){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(o),this._render()):this.drawDot(o))},onMouseUp:function(){var o=this.canvas.renderOnAddRemove,a,c;this.canvas.renderOnAddRemove=!1;var f=[];for(a=0,c=this.points.length;a<c;a++){var h=this.points[a],d=new t.Circle({radius:h.radius,left:h.x,top:h.y,originX:"center",originY:"center",fill:h.fill});this.shadow&&(d.shadow=new t.Shadow(this.shadow)),f.push(d)}var u=new t.Group(f);u.canvas=this.canvas,this.canvas.fire("before:path:created",{path:u}),this.canvas.add(u),this.canvas.fire("path:created",{path:u}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=o,this.canvas.requestRenderAll()},addPoint:function(o){var a=new t.Point(o.x,o.y),c=t.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,f=new t.Color(this.color).setAlpha(t.util.getRandomInt(0,100)/100).toRgba();return a.radius=c,a.fill=f,this.points.push(a),a}}),t.SprayBrush=t.util.createClass(t.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(o){this.canvas=o,this.sprayChunks=[]},onMouseDown:function(o){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(o),this.render(this.sprayChunkPoints)},onMouseMove:function(o){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o)||(this.addSprayChunk(o),this.render(this.sprayChunkPoints))},onMouseUp:function(){var o=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var a=[],c=0,f=this.sprayChunks.length;c<f;c++)for(var h=this.sprayChunks[c],d=0,u=h.length;d<u;d++){var p=new t.Rect({width:h[d].width,height:h[d].width,left:h[d].x+1,top:h[d].y+1,originX:"center",originY:"center",fill:this.color});a.push(p)}this.optimizeOverlapping&&(a=this._getOptimizedRects(a));var m=new t.Group(a);this.shadow&&m.set("shadow",new t.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:m}),this.canvas.add(m),this.canvas.fire("path:created",{path:m}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=o,this.canvas.requestRenderAll()},_getOptimizedRects:function(o){var a={},c,f,h;for(f=0,h=o.length;f<h;f++)c=o[f].left+""+o[f].top,a[c]||(a[c]=o[f]);var d=[];for(c in a)d.push(a[c]);return d},render:function(o){var a=this.canvas.contextTop,c,f;for(a.fillStyle=this.color,this._saveAndTransform(a),c=0,f=o.length;c<f;c++){var h=o[c];typeof h.opacity<"u"&&(a.globalAlpha=h.opacity),a.fillRect(h.x,h.y,h.width,h.width)}a.restore()},_render:function(){var o=this.canvas.contextTop,a,c;for(o.fillStyle=this.color,this._saveAndTransform(o),a=0,c=this.sprayChunks.length;a<c;a++)this.render(this.sprayChunks[a]);o.restore()},addSprayChunk:function(o){this.sprayChunkPoints=[];var a,c,f,h=this.width/2,d;for(d=0;d<this.density;d++){a=t.util.getRandomInt(o.x-h,o.x+h),c=t.util.getRandomInt(o.y-h,o.y+h),this.dotWidthVariance?f=t.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):f=this.dotWidth;var u=new t.Point(a,c);u.width=f,this.randomOpacity&&(u.opacity=t.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(u)}this.sprayChunks.push(this.sprayChunkPoints)}}),t.PatternBrush=t.util.createClass(t.PencilBrush,{getPatternSrc:function(){var o=20,a=5,c=t.util.createCanvasElement(),f=c.getContext("2d");return c.width=c.height=o+a,f.fillStyle=this.color,f.beginPath(),f.arc(o/2,o/2,o/2,0,Math.PI*2,!1),f.closePath(),f.fill(),c},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(o){return o.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(o){this.callSuper("_setBrushStyles",o),o.strokeStyle=this.getPattern(o)},createPath:function(o){var a=this.callSuper("createPath",o),c=a._getLeftTopCoords().scalarAdd(a.strokeWidth/2);return a.stroke=new t.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-c.x,offsetY:-c.y}),a}}),function(){var o=t.util.getPointer,a=t.util.degreesToRadians,c=t.util.isTouchEvent;t.Canvas=t.util.createClass(t.StaticCanvas,{initialize:function(h,d){d||(d={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(h,d),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=t.PencilBrush&&new t.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var h=this.getActiveObjects(),d,u,p;if(h.length>0&&!this.preserveObjectStacking){u=[],p=[];for(var m=0,g=this._objects.length;m<g;m++)d=this._objects[m],h.indexOf(d)===-1?u.push(d):p.push(d);h.length>1&&(this._activeObject._objects=p),u.push.apply(u,p)}else u=this._objects;return u},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var h=this.contextContainer;return this.renderCanvas(h,this._chooseObjectsToRender()),this},renderTopLayer:function(h){h.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(h),this.contextTopDirty=!0),h.restore()},renderTop:function(){var h=this.contextTop;return this.clearContext(h),this.renderTopLayer(h),this.fire("after:render"),this},_normalizePointer:function(h,d){var u=h.calcTransformMatrix(),p=t.util.invertTransform(u),m=this.restorePointerVpt(d);return t.util.transformPoint(m,p)},isTargetTransparent:function(h,d,u){if(h.shouldCache()&&h._cacheCanvas&&h!==this._activeObject){var p=this._normalizePointer(h,{x:d,y:u}),m=Math.max(h.cacheTranslationX+p.x*h.zoomX,0),g=Math.max(h.cacheTranslationY+p.y*h.zoomY,0),_=t.util.isTransparent(h._cacheContext,Math.round(m),Math.round(g),this.targetFindTolerance);return _}var x=this.contextCache,y=h.selectionBackgroundColor,w=this.viewportTransform;h.selectionBackgroundColor="",this.clearContext(x),x.save(),x.transform(w[0],w[1],w[2],w[3],w[4],w[5]),h.render(x),x.restore(),h.selectionBackgroundColor=y;var _=t.util.isTransparent(x,d,u,this.targetFindTolerance);return _},_isSelectionKeyPressed:function(h){var d=!1;return Array.isArray(this.selectionKey)?d=!!this.selectionKey.find(function(u){return h[u]===!0}):d=h[this.selectionKey],d},_shouldClearSelection:function(h,d){var u=this.getActiveObjects(),p=this._activeObject;return!d||d&&p&&u.length>1&&u.indexOf(d)===-1&&p!==d&&!this._isSelectionKeyPressed(h)||d&&!d.evented||d&&!d.selectable&&p&&p!==d},_shouldCenterTransform:function(h,d,u){if(h){var p;return d==="scale"||d==="scaleX"||d==="scaleY"||d==="resizing"?p=this.centeredScaling||h.centeredScaling:d==="rotate"&&(p=this.centeredRotation||h.centeredRotation),p?!u:u}},_getOriginFromCorner:function(h,d){var u={x:h.originX,y:h.originY};return d==="ml"||d==="tl"||d==="bl"?u.x="right":(d==="mr"||d==="tr"||d==="br")&&(u.x="left"),d==="tl"||d==="mt"||d==="tr"?u.y="bottom":(d==="bl"||d==="mb"||d==="br")&&(u.y="top"),u},_getActionFromCorner:function(h,d,u,p){if(!d||!h)return"drag";var m=p.controls[d];return m.getActionName(u,m,p)},_setupCurrentTransform:function(h,d,u){if(d){var p=this.getPointer(h),m=d.__corner,g=d.controls[m],x=u&&m?g.getActionHandler(h,d,g):t.controlsUtils.dragHandler,y=this._getActionFromCorner(u,m,h,d),w=this._getOriginFromCorner(d,m),_=h[this.centeredKey],C={target:d,action:y,actionHandler:x,corner:m,scaleX:d.scaleX,scaleY:d.scaleY,skewX:d.skewX,skewY:d.skewY,offsetX:p.x-d.left,offsetY:p.y-d.top,originX:w.x,originY:w.y,ex:p.x,ey:p.y,lastX:p.x,lastY:p.y,theta:a(d.angle),width:d.width*d.scaleX,shiftKey:h.shiftKey,altKey:_,original:t.util.saveObjectTransform(d)};this._shouldCenterTransform(d,y,_)&&(C.originX="center",C.originY="center"),C.original.originX=w.x,C.original.originY=w.y,this._currentTransform=C,this._beforeTransform(h)}},setCursor:function(h){this.upperCanvasEl.style.cursor=h},_drawSelection:function(h){var d=this._groupSelector,u=new t.Point(d.ex,d.ey),p=t.util.transformPoint(u,this.viewportTransform),m=new t.Point(d.ex+d.left,d.ey+d.top),g=t.util.transformPoint(m,this.viewportTransform),x=Math.min(p.x,g.x),y=Math.min(p.y,g.y),w=Math.max(p.x,g.x),_=Math.max(p.y,g.y),C=this.selectionLineWidth/2;this.selectionColor&&(h.fillStyle=this.selectionColor,h.fillRect(x,y,w-x,_-y)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(h.lineWidth=this.selectionLineWidth,h.strokeStyle=this.selectionBorderColor,x+=C,y+=C,w-=C,_-=C,t.Object.prototype._setLineDash.call(this,h,this.selectionDashArray),h.strokeRect(x,y,w-x,_-y))},findTarget:function(h,d){if(!this.skipTargetFind){var u=!0,p=this.getPointer(h,u),m=this._activeObject,g=this.getActiveObjects(),x,y,w=c(h),_=g.length>1&&!d||g.length===1;if(this.targets=[],_&&m._findTargetCorner(p,w)||g.length>1&&!d&&m===this._searchPossibleTargets([m],p))return m;if(g.length===1&&m===this._searchPossibleTargets([m],p))if(this.preserveObjectStacking)x=m,y=this.targets,this.targets=[];else return m;var C=this._searchPossibleTargets(this._objects,p);return h[this.altSelectionKey]&&C&&x&&C!==x&&(C=x,this.targets=y),C}},_checkTarget:function(h,d,u){if(d&&d.visible&&d.evented&&d.containsPoint(h))if((this.perPixelTargetFind||d.perPixelTargetFind)&&!d.isEditing){var p=this.isTargetTransparent(d,u.x,u.y);if(!p)return!0}else return!0},_searchPossibleTargets:function(h,d){for(var u,p=h.length,m;p--;){var g=h[p],x=g.group?this._normalizePointer(g.group,d):d;if(this._checkTarget(x,g,d)){u=h[p],u.subTargetCheck&&u instanceof t.Group&&(m=this._searchPossibleTargets(u._objects,d),m&&this.targets.push(m));break}}return u},restorePointerVpt:function(h){return t.util.transformPoint(h,t.util.invertTransform(this.viewportTransform))},getPointer:function(h,d){if(this._absolutePointer&&!d)return this._absolutePointer;if(this._pointer&&d)return this._pointer;var u=o(h),p=this.upperCanvasEl,m=p.getBoundingClientRect(),g=m.width||0,x=m.height||0,y;(!g||!x)&&("top"in m&&"bottom"in m&&(x=Math.abs(m.top-m.bottom)),"right"in m&&"left"in m&&(g=Math.abs(m.right-m.left))),this.calcOffset(),u.x=u.x-this._offset.left,u.y=u.y-this._offset.top,d||(u=this.restorePointerVpt(u));var w=this.getRetinaScaling();return w!==1&&(u.x/=w,u.y/=w),g===0||x===0?y={width:1,height:1}:y={width:p.width/g,height:p.height/x},{x:u.x*y.width,y:u.y*y.height}},_createUpperCanvas:function(){var h=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),d=this.lowerCanvasEl,u=this.upperCanvasEl;u?u.className="":(u=this._createCanvasElement(),this.upperCanvasEl=u),t.util.addClass(u,"upper-canvas "+h),this.wrapperEl.appendChild(u),this._copyCanvasStyle(d,u),this._applyCanvasStyle(u),this.contextTop=u.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=t.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),t.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),t.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(h){var d=this.width||h.width,u=this.height||h.height;t.util.setStyle(h,{position:"absolute",width:d+"px",height:u+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),h.width=d,h.height=u,t.util.makeElementUnselectable(h)},_copyCanvasStyle:function(h,d){d.style.cssText=h.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var h=this._activeObject;return h?h.type==="activeSelection"&&h._objects?h._objects.slice(0):[h]:[]},_onObjectRemoved:function(h){h===this._activeObject&&(this.fire("before:selection:cleared",{target:h}),this._discardActiveObject(),this.fire("selection:cleared",{target:h}),h.fire("deselected")),h===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",h)},_fireSelectionEvents:function(h,d){var u=!1,p=this.getActiveObjects(),m=[],g=[];h.forEach(function(x){p.indexOf(x)===-1&&(u=!0,x.fire("deselected",{e:d,target:x}),g.push(x))}),p.forEach(function(x){h.indexOf(x)===-1&&(u=!0,x.fire("selected",{e:d,target:x}),m.push(x))}),h.length>0&&p.length>0?u&&this.fire("selection:updated",{e:d,selected:m,deselected:g}):p.length>0?this.fire("selection:created",{e:d,selected:m}):h.length>0&&this.fire("selection:cleared",{e:d,deselected:g})},setActiveObject:function(h,d){var u=this.getActiveObjects();return this._setActiveObject(h,d),this._fireSelectionEvents(u,d),this},_setActiveObject:function(h,d){return this._activeObject===h||!this._discardActiveObject(d,h)||h.onSelect({e:d})?!1:(this._activeObject=h,!0)},_discardActiveObject:function(h,d){var u=this._activeObject;if(u){if(u.onDeselect({e:h,object:d}))return!1;this._activeObject=null}return!0},discardActiveObject:function(h){var d=this.getActiveObjects(),u=this.getActiveObject();return d.length&&this.fire("before:selection:cleared",{target:u,e:h}),this._discardActiveObject(h),this._fireSelectionEvents(d,h),this},dispose:function(){var h=this.wrapperEl;return this.removeListeners(),h.removeChild(this.upperCanvasEl),h.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach((function(d){t.util.cleanUpJsdomNode(this[d]),this[d]=void 0}).bind(this)),h.parentNode&&h.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,t.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(h){var d=this._activeObject;d&&d._renderControls(h)},_toObject:function(h,d,u){var p=this._realizeGroupTransformOnObject(h),m=this.callSuper("_toObject",h,d,u);return this._unwindGroupTransformOnObject(h,p),m},_realizeGroupTransformOnObject:function(h){if(h.group&&h.group.type==="activeSelection"&&this._activeObject===h.group){var d=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],u={};return d.forEach(function(p){u[p]=h[p]}),t.util.addTransformToObject(h,this._activeObject.calcOwnMatrix()),u}else return null},_unwindGroupTransformOnObject:function(h,d){d&&h.set(d)},_setSVGObject:function(h,d,u){var p=this._realizeGroupTransformOnObject(d);this.callSuper("_setSVGObject",h,d,u),this._unwindGroupTransformOnObject(d,p)},setViewportTransform:function(h){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),t.StaticCanvas.prototype.setViewportTransform.call(this,h)}});for(var f in t.StaticCanvas)f!=="prototype"&&(t.Canvas[f]=t.StaticCanvas[f])}(),function(){var o=t.util.addListener,a=t.util.removeListener,c=3,f=2,h=1,d={passive:!1};function u(p,m){return p.button&&p.button===m-1}t.util.object.extend(t.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(o,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(p,m){var g=this.upperCanvasEl,x=this._getEventPrefix();p(t.window,"resize",this._onResize),p(g,x+"down",this._onMouseDown),p(g,x+"move",this._onMouseMove,d),p(g,x+"out",this._onMouseOut),p(g,x+"enter",this._onMouseEnter),p(g,"wheel",this._onMouseWheel),p(g,"contextmenu",this._onContextMenu),p(g,"dblclick",this._onDoubleClick),p(g,"dragover",this._onDragOver),p(g,"dragenter",this._onDragEnter),p(g,"dragleave",this._onDragLeave),p(g,"drop",this._onDrop),this.enablePointerEvents||p(g,"touchstart",this._onTouchStart,d),typeof eventjs<"u"&&m in eventjs&&(eventjs[m](g,"gesture",this._onGesture),eventjs[m](g,"drag",this._onDrag),eventjs[m](g,"orientation",this._onOrientationChange),eventjs[m](g,"shake",this._onShake),eventjs[m](g,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(a,"remove");var p=this._getEventPrefix();a(t.document,p+"up",this._onMouseUp),a(t.document,"touchend",this._onTouchEnd,d),a(t.document,p+"move",this._onMouseMove,d),a(t.document,"touchmove",this._onMouseMove,d)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(p,m){this.__onTransformGesture&&this.__onTransformGesture(p,m)},_onDrag:function(p,m){this.__onDrag&&this.__onDrag(p,m)},_onMouseWheel:function(p){this.__onMouseWheel(p)},_onMouseOut:function(p){var m=this._hoveredTarget;this.fire("mouse:out",{target:m,e:p}),this._hoveredTarget=null,m&&m.fire("mouseout",{e:p});var g=this;this._hoveredTargets.forEach(function(x){g.fire("mouse:out",{target:x,e:p}),x&&x.fire("mouseout",{e:p})}),this._hoveredTargets=[]},_onMouseEnter:function(p){!this._currentTransform&&!this.findTarget(p)&&(this.fire("mouse:over",{target:null,e:p}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(p,m){this.__onOrientationChange&&this.__onOrientationChange(p,m)},_onShake:function(p,m){this.__onShake&&this.__onShake(p,m)},_onLongPress:function(p,m){this.__onLongPress&&this.__onLongPress(p,m)},_onDragOver:function(p){p.preventDefault();var m=this._simpleEventHandler("dragover",p);this._fireEnterLeaveEvents(m,p)},_onDrop:function(p){return this._simpleEventHandler("drop:before",p),this._simpleEventHandler("drop",p)},_onContextMenu:function(p){return this.stopContextMenu&&(p.stopPropagation(),p.preventDefault()),!1},_onDoubleClick:function(p){this._cacheTransformEventData(p),this._handleEvent(p,"dblclick"),this._resetTransformEventData(p)},getPointerId:function(p){var m=p.changedTouches;return m?m[0]&&m[0].identifier:this.enablePointerEvents?p.pointerId:-1},_isMainEvent:function(p){return p.isPrimary===!0?!0:p.isPrimary===!1?!1:p.type==="touchend"&&p.touches.length===0?!0:p.changedTouches?p.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(p){p.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(p)),this.__onMouseDown(p),this._resetTransformEventData();var m=this.upperCanvasEl,g=this._getEventPrefix();o(t.document,"touchend",this._onTouchEnd,d),o(t.document,"touchmove",this._onMouseMove,d),a(m,g+"down",this._onMouseDown)},_onMouseDown:function(p){this.__onMouseDown(p),this._resetTransformEventData();var m=this.upperCanvasEl,g=this._getEventPrefix();a(m,g+"move",this._onMouseMove,d),o(t.document,g+"up",this._onMouseUp),o(t.document,g+"move",this._onMouseMove,d)},_onTouchEnd:function(p){if(!(p.touches.length>0)){this.__onMouseUp(p),this._resetTransformEventData(),this.mainTouchId=null;var m=this._getEventPrefix();a(t.document,"touchend",this._onTouchEnd,d),a(t.document,"touchmove",this._onMouseMove,d);var g=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){o(g.upperCanvasEl,m+"down",g._onMouseDown),g._willAddMouseDown=0},400)}},_onMouseUp:function(p){this.__onMouseUp(p),this._resetTransformEventData();var m=this.upperCanvasEl,g=this._getEventPrefix();this._isMainEvent(p)&&(a(t.document,g+"up",this._onMouseUp),a(t.document,g+"move",this._onMouseMove,d),o(m,g+"move",this._onMouseMove,d))},_onMouseMove:function(p){!this.allowTouchScrolling&&p.preventDefault&&p.preventDefault(),this.__onMouseMove(p)},_onResize:function(){this.calcOffset()},_shouldRender:function(p){var m=this._activeObject;return!!m!=!!p||m&&p&&m!==p?!0:(m&&m.isEditing,!1)},__onMouseUp:function(p){var m,g=this._currentTransform,x=this._groupSelector,y=!1,w=!x||x.left===0&&x.top===0;if(this._cacheTransformEventData(p),m=this._target,this._handleEvent(p,"up:before"),u(p,c)){this.fireRightClick&&this._handleEvent(p,"up",c,w);return}if(u(p,f)){this.fireMiddleClick&&this._handleEvent(p,"up",f,w),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(p);return}if(this._isMainEvent(p)){if(g&&(this._finalizeCurrentTransform(p),y=g.actionPerformed),!w){var _=m===this._activeObject;this._maybeGroupObjects(p),y||(y=this._shouldRender(m)||!_&&m===this._activeObject)}var C,E;if(m){if(C=m._findTargetCorner(this.getPointer(p,!0),t.util.isTouchEvent(p)),m.selectable&&m!==this._activeObject&&m.activeOn==="up")this.setActiveObject(m,p),y=!0;else{var T=m.controls[C],A=T&&T.getMouseUpHandler(p,m,T);A&&(E=this.getPointer(p),A(p,g,E.x,E.y))}m.isMoving=!1}if(g&&(g.target!==m||g.corner!==C)){var j=g.target&&g.target.controls[g.corner],B=j&&j.getMouseUpHandler(p,m,T);E=E||this.getPointer(p),B&&B(p,g,E.x,E.y)}this._setCursorFromEvent(p,m),this._handleEvent(p,"up",h,w),this._groupSelector=null,this._currentTransform=null,m&&(m.__corner=0),y?this.requestRenderAll():w||this.renderTop()}},_simpleEventHandler:function(p,m){var g=this.findTarget(m),x=this.targets,y={e:m,target:g,subTargets:x};if(this.fire(p,y),g&&g.fire(p,y),!x)return g;for(var w=0;w<x.length;w++)x[w].fire(p,y);return g},_handleEvent:function(p,m,g,x){var y=this._target,w=this.targets||[],_={e:p,target:y,subTargets:w,button:g||h,isClick:x||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};m==="up"&&(_.currentTarget=this.findTarget(p),_.currentSubTargets=this.targets),this.fire("mouse:"+m,_),y&&y.fire("mouse"+m,_);for(var C=0;C<w.length;C++)w[C].fire("mouse"+m,_)},_finalizeCurrentTransform:function(p){var m=this._currentTransform,g=m.target,x={e:p,target:g,transform:m,action:m.action};g._scaling&&(g._scaling=!1),g.setCoords(),(m.actionPerformed||this.stateful&&g.hasStateChanged())&&this._fire("modified",x)},_onMouseDownInDrawingMode:function(p){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(p).requestRenderAll();var m=this.getPointer(p);this.freeDrawingBrush.onMouseDown(m,{e:p,pointer:m}),this._handleEvent(p,"down")},_onMouseMoveInDrawingMode:function(p){if(this._isCurrentlyDrawing){var m=this.getPointer(p);this.freeDrawingBrush.onMouseMove(m,{e:p,pointer:m})}this.setCursor(this.freeDrawingCursor),this._handleEvent(p,"move")},_onMouseUpInDrawingMode:function(p){var m=this.getPointer(p);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:p,pointer:m}),this._handleEvent(p,"up")},__onMouseDown:function(p){this._cacheTransformEventData(p),this._handleEvent(p,"down:before");var m=this._target;if(u(p,c)){this.fireRightClick&&this._handleEvent(p,"down",c);return}if(u(p,f)){this.fireMiddleClick&&this._handleEvent(p,"down",f);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(p);return}if(this._isMainEvent(p)&&!this._currentTransform){var g=this._pointer;this._previousPointer=g;var x=this._shouldRender(m),y=this._shouldGroup(p,m);if(this._shouldClearSelection(p,m)?this.discardActiveObject(p):y&&(this._handleGrouping(p,m),m=this._activeObject),this.selection&&(!m||!m.selectable&&!m.isEditing&&m!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),m){var w=m===this._activeObject;m.selectable&&m.activeOn==="down"&&this.setActiveObject(m,p);var _=m._findTargetCorner(this.getPointer(p,!0),t.util.isTouchEvent(p));if(m.__corner=_,m===this._activeObject&&(_||!y)){this._setupCurrentTransform(p,m,w);var C=m.controls[_],g=this.getPointer(p),E=C&&C.getMouseDownHandler(p,m,C);E&&E(p,this._currentTransform,g.x,g.y)}}this._handleEvent(p,"down"),(x||y)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(p){this._resetTransformEventData(),this._pointer=this.getPointer(p,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(p)||null},_beforeTransform:function(p){var m=this._currentTransform;this.stateful&&m.target.saveState(),this.fire("before:transform",{e:p,transform:m})},__onMouseMove:function(p){this._handleEvent(p,"move:before"),this._cacheTransformEventData(p);var m,g;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(p);return}if(this._isMainEvent(p)){var x=this._groupSelector;x?(g=this._absolutePointer,x.left=g.x-x.ex,x.top=g.y-x.ey,this.renderTop()):this._currentTransform?this._transformObject(p):(m=this.findTarget(p)||null,this._setCursorFromEvent(p,m),this._fireOverOutEvents(m,p)),this._handleEvent(p,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(p,m){var g=this._hoveredTarget,x=this._hoveredTargets,y=this.targets,w=Math.max(x.length,y.length);this.fireSyntheticInOutEvents(p,m,{oldTarget:g,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var _=0;_<w;_++)this.fireSyntheticInOutEvents(y[_],m,{oldTarget:x[_],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=p,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(p,m){var g=this._draggedoverTarget,x=this._hoveredTargets,y=this.targets,w=Math.max(x.length,y.length);this.fireSyntheticInOutEvents(p,m,{oldTarget:g,evtOut:"dragleave",evtIn:"dragenter"});for(var _=0;_<w;_++)this.fireSyntheticInOutEvents(y[_],m,{oldTarget:x[_],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=p},fireSyntheticInOutEvents:function(p,m,g){var x,y,w=g.oldTarget,_,C,E=w!==p,T=g.canvasEvtIn,A=g.canvasEvtOut;E&&(x={e:m,target:p,previousTarget:w},y={e:m,target:w,nextTarget:p}),C=p&&E,_=w&&E,_&&(A&&this.fire(A,y),w.fire(g.evtOut,y)),C&&(T&&this.fire(T,x),p.fire(g.evtIn,x))},__onMouseWheel:function(p){this._cacheTransformEventData(p),this._handleEvent(p,"wheel"),this._resetTransformEventData()},_transformObject:function(p){var m=this.getPointer(p),g=this._currentTransform;g.reset=!1,g.shiftKey=p.shiftKey,g.altKey=p[this.centeredKey],this._performTransformAction(p,g,m),g.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(p,m,g){var x=g.x,y=g.y,w=m.action,_=!1,C=m.actionHandler;C&&(_=C(p,m,x,y)),w==="drag"&&_&&(m.target.isMoving=!0,this.setCursor(m.target.moveCursor||this.moveCursor)),m.actionPerformed=m.actionPerformed||_},_fire:t.controlsUtils.fireEvent,_setCursorFromEvent:function(p,m){if(!m)return this.setCursor(this.defaultCursor),!1;var g=m.hoverCursor||this.hoverCursor,x=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,y=(!x||!x.contains(m))&&m._findTargetCorner(this.getPointer(p,!0));y?this.setCursor(this.getCornerCursor(y,m,p)):(m.subTargetCheck&&this.targets.concat().reverse().map(function(w){g=w.hoverCursor||g}),this.setCursor(g))},getCornerCursor:function(p,m,g){var x=m.controls[p];return x.cursorStyleHandler(g,x,m)}})}(),function(){var o=Math.min,a=Math.max;t.util.object.extend(t.Canvas.prototype,{_shouldGroup:function(c,f){var h=this._activeObject;return h&&this._isSelectionKeyPressed(c)&&f&&f.selectable&&this.selection&&(h!==f||h.type==="activeSelection")&&!f.onSelect({e:c})},_handleGrouping:function(c,f){var h=this._activeObject;h.__corner||f===h&&(f=this.findTarget(c,!0),!f||!f.selectable)||(h&&h.type==="activeSelection"?this._updateActiveSelection(f,c):this._createActiveSelection(f,c))},_updateActiveSelection:function(c,f){var h=this._activeObject,d=h._objects.slice(0);h.contains(c)?(h.removeWithUpdate(c),this._hoveredTarget=c,this._hoveredTargets=this.targets.concat(),h.size()===1&&this._setActiveObject(h.item(0),f)):(h.addWithUpdate(c),this._hoveredTarget=h,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(d,f)},_createActiveSelection:function(c,f){var h=this.getActiveObjects(),d=this._createGroup(c);this._hoveredTarget=d,this._setActiveObject(d,f),this._fireSelectionEvents(h,f)},_createGroup:function(c){var f=this._objects,h=f.indexOf(this._activeObject)<f.indexOf(c),d=h?[this._activeObject,c]:[c,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new t.ActiveSelection(d,{canvas:this})},_groupSelectedObjects:function(c){var f=this._collectObjects(c),h;f.length===1?this.setActiveObject(f[0],c):f.length>1&&(h=new t.ActiveSelection(f.reverse(),{canvas:this}),this.setActiveObject(h,c))},_collectObjects:function(c){for(var f=[],h,d=this._groupSelector.ex,u=this._groupSelector.ey,p=d+this._groupSelector.left,m=u+this._groupSelector.top,g=new t.Point(o(d,p),o(u,m)),x=new t.Point(a(d,p),a(u,m)),y=!this.selectionFullyContained,w=d===p&&u===m,_=this._objects.length;_--&&(h=this._objects[_],!(!(!h||!h.selectable||!h.visible)&&(y&&h.intersectsWithRect(g,x,!0)||h.isContainedWithinRect(g,x,!0)||y&&h.containsPoint(g,null,!0)||y&&h.containsPoint(x,null,!0))&&(f.push(h),w))););return f.length>1&&(f=f.filter(function(C){return!C.onSelect({e:c})})),f},_maybeGroupObjects:function(c){this.selection&&this._groupSelector&&this._groupSelectedObjects(c),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){t.util.object.extend(t.StaticCanvas.prototype,{toDataURL:function(o){o||(o={});var a=o.format||"png",c=o.quality||1,f=(o.multiplier||1)*(o.enableRetinaScaling?this.getRetinaScaling():1),h=this.toCanvasElement(f,o);return t.util.toDataURL(h,a,c)},toCanvasElement:function(o,a){o=o||1,a=a||{};var c=(a.width||this.width)*o,f=(a.height||this.height)*o,h=this.getZoom(),d=this.width,u=this.height,p=h*o,m=this.viewportTransform,g=(m[4]-(a.left||0))*o,x=(m[5]-(a.top||0))*o,y=this.interactive,w=[p,0,0,p,g,x],_=this.enableRetinaScaling,C=t.util.createCanvasElement(),E=this.contextTop;return C.width=c,C.height=f,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=w,this.width=c,this.height=f,this.calcViewportBoundaries(),this.renderCanvas(C.getContext("2d"),this._objects),this.viewportTransform=m,this.width=d,this.height=u,this.calcViewportBoundaries(),this.interactive=y,this.enableRetinaScaling=_,this.contextTop=E,C}})}(),t.util.object.extend(t.StaticCanvas.prototype,{loadFromJSON:function(o,a,c){if(o){var f=typeof o=="string"?JSON.parse(o):t.util.object.clone(o),h=this,d=f.clipPath,u=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete f.clipPath,this._enlivenObjects(f.objects,function(p){h.clear(),h._setBgOverlay(f,function(){d?h._enlivenObjects([d],function(m){h.clipPath=m[0],h.__setupCanvas.call(h,f,p,u,a)}):h.__setupCanvas.call(h,f,p,u,a)})},c),this}},__setupCanvas:function(o,a,c,f){var h=this;a.forEach(function(d,u){h.insertAt(d,u)}),this.renderOnAddRemove=c,delete o.objects,delete o.backgroundImage,delete o.overlayImage,delete o.background,delete o.overlay,this._setOptions(o),this.renderAll(),f&&f()},_setBgOverlay:function(o,a){var c={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!o.backgroundImage&&!o.overlayImage&&!o.background&&!o.overlay){a&&a();return}var f=function(){c.backgroundImage&&c.overlayImage&&c.backgroundColor&&c.overlayColor&&a&&a()};this.__setBgOverlay("backgroundImage",o.backgroundImage,c,f),this.__setBgOverlay("overlayImage",o.overlayImage,c,f),this.__setBgOverlay("backgroundColor",o.background,c,f),this.__setBgOverlay("overlayColor",o.overlay,c,f)},__setBgOverlay:function(o,a,c,f){var h=this;if(!a){c[o]=!0,f&&f();return}o==="backgroundImage"||o==="overlayImage"?t.util.enlivenObjects([a],function(d){h[o]=d[0],c[o]=!0,f&&f()}):this["set"+t.util.string.capitalize(o,!0)](a,function(){c[o]=!0,f&&f()})},_enlivenObjects:function(o,a,c){if(!o||o.length===0){a&&a([]);return}t.util.enlivenObjects(o,function(f){a&&a(f)},null,c)},_toDataURL:function(o,a){this.clone(function(c){a(c.toDataURL(o))})},_toDataURLWithMultiplier:function(o,a,c){this.clone(function(f){c(f.toDataURLWithMultiplier(o,a))})},clone:function(o,a){var c=JSON.stringify(this.toJSON(a));this.cloneWithoutData(function(f){f.loadFromJSON(c,function(){o&&o(f)})})},cloneWithoutData:function(o){var a=t.util.createCanvasElement();a.width=this.width,a.height=this.height;var c=new t.Canvas(a);this.backgroundImage?(c.setBackgroundImage(this.backgroundImage.src,function(){c.renderAll(),o&&o(c)}),c.backgroundImageOpacity=this.backgroundImageOpacity,c.backgroundImageStretch=this.backgroundImageStretch):o&&o(c)}}),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,f=a.util.object.clone,h=a.util.toFixed,d=a.util.string.capitalize,u=a.util.degreesToRadians,p=!a.isLikelyNode,m=2;a.Object||(a.Object=a.util.createClass(a.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:p,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(g){g&&this.setOptions(g)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=a.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(g){var x=a.perfLimitSizeTotal,y=g.width,w=g.height,_=a.maxCacheSideLimit,C=a.minCacheSideLimit;if(y<=_&&w<=_&&y*w<=x)return y<C&&(g.width=C),w<C&&(g.height=C),g;var E=y/w,T=a.util.limitDimsByArea(E,x),A=a.util.capValue,j=A(C,T.x,_),B=A(C,T.y,_);return y>j&&(g.zoomX/=y/j,g.width=j,g.capped=!0),w>B&&(g.zoomY/=w/B,g.height=B,g.capped=!0),g},_getCacheCanvasDimensions:function(){var g=this.getTotalObjectScaling(),x=this._getTransformedDimensions(0,0),y=x.x*g.scaleX/this.scaleX,w=x.y*g.scaleY/this.scaleY;return{width:Math.ceil(y+m),height:Math.ceil(w+m),zoomX:g.scaleX,zoomY:g.scaleY,x:y,y:w}},_updateCacheCanvas:function(){var g=this.canvas;if(this.noScaleCache&&g&&g._currentTransform){var x=g._currentTransform.target,y=g._currentTransform.action;if(this===x&&y.slice&&y.slice(0,5)==="scale")return!1}var w=this._cacheCanvas,_=this._limitCacheSize(this._getCacheCanvasDimensions()),C=_.width,E=_.height,T,A,j=_.zoomX,B=_.zoomY,F=C!==this.cacheWidth||E!==this.cacheHeight,L=this.zoomX!==j||this.zoomY!==B,G=F||L;return G?(F?(w.width=C,w.height=E):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,w.width,w.height)),T=_.x/2,A=_.y/2,this.cacheTranslationX=Math.round(w.width/2-T)+T,this.cacheTranslationY=Math.round(w.height/2-A)+A,this.cacheWidth=C,this.cacheHeight=E,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(j,B),this.zoomX=j,this.zoomY=B,!0):!1},setOptions:function(g){this._setOptions(g),this._initGradient(g.fill,"fill"),this._initGradient(g.stroke,"stroke"),this._initPattern(g.fill,"fill"),this._initPattern(g.stroke,"stroke")},transform:function(g){var x=this.group&&!this.group._transformDone||this.group&&this.canvas&&g===this.canvas.contextTop,y=this.calcTransformMatrix(!x);g.transform(y[0],y[1],y[2],y[3],y[4],y[5])},toObject:function(g){var x=a.Object.NUM_FRACTION_DIGITS,y={type:this.type,version:a.version,originX:this.originX,originY:this.originY,left:h(this.left,x),top:h(this.top,x),width:h(this.width,x),height:h(this.height,x),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:h(this.strokeWidth,x),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:h(this.strokeMiterLimit,x),scaleX:h(this.scaleX,x),scaleY:h(this.scaleY,x),angle:h(this.angle,x),flipX:this.flipX,flipY:this.flipY,opacity:h(this.opacity,x),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:h(this.skewX,x),skewY:h(this.skewY,x)};return this.clipPath&&!this.clipPath.excludeFromExport&&(y.clipPath=this.clipPath.toObject(g),y.clipPath.inverted=this.clipPath.inverted,y.clipPath.absolutePositioned=this.clipPath.absolutePositioned),a.util.populateWithProperties(this,y,g),this.includeDefaultValues||(y=this._removeDefaultValues(y)),y},toDatalessObject:function(g){return this.toObject(g)},_removeDefaultValues:function(g){var x=a.util.getKlass(g.type).prototype,y=x.stateProperties;return y.forEach(function(w){w==="left"||w==="top"||(g[w]===x[w]&&delete g[w],Array.isArray(g[w])&&Array.isArray(x[w])&&g[w].length===0&&x[w].length===0&&delete g[w])}),g},toString:function(){return"#<fabric."+d(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var g=a.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(g.scaleX),scaleY:Math.abs(g.scaleY)}},getTotalObjectScaling:function(){var g=this.getObjectScaling(),x=g.scaleX,y=g.scaleY;if(this.canvas){var w=this.canvas.getZoom(),_=this.canvas.getRetinaScaling();x*=w*_,y*=w*_}return{scaleX:x,scaleY:y}},getObjectOpacity:function(){var g=this.opacity;return this.group&&(g*=this.group.getObjectOpacity()),g},_set:function(g,x){var y=g==="scaleX"||g==="scaleY",w=this[g]!==x,_=!1;return y&&(x=this._constrainScale(x)),g==="scaleX"&&x<0?(this.flipX=!this.flipX,x*=-1):g==="scaleY"&&x<0?(this.flipY=!this.flipY,x*=-1):g==="shadow"&&x&&!(x instanceof a.Shadow)?x=new a.Shadow(x):g==="dirty"&&this.group&&this.group.set("dirty",x),this[g]=x,w&&(_=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(g)>-1?(this.dirty=!0,_&&this.group.set("dirty",!0)):_&&this.stateProperties.indexOf(g)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:a.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(g){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(g.save(),this._setupCompositeOperation(g),this.drawSelectionBackground(g),this.transform(g),this._setOpacity(g),this._setShadow(g,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(g)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(g),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),g.restore())},renderCache:function(g){g=g||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,g.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(g,x){if(g.save(),x.inverted?g.globalCompositeOperation="destination-out":g.globalCompositeOperation="destination-in",x.absolutePositioned){var y=a.util.invertTransform(this.calcTransformMatrix());g.transform(y[0],y[1],y[2],y[3],y[4],y[5])}x.transform(g),g.scale(1/x.zoomX,1/x.zoomY),g.drawImage(x._cacheCanvas,-x.cacheTranslationX,-x.cacheTranslationY),g.restore()},drawObject:function(g,x){var y=this.fill,w=this.stroke;x?(this.fill="black",this.stroke="",this._setClippingProperties(g)):this._renderBackground(g),this._render(g),this._drawClipPath(g,this.clipPath),this.fill=y,this.stroke=w},_drawClipPath:function(g,x){x&&(x.canvas=this.canvas,x.shouldCache(),x._transformDone=!0,x.renderCache({forClipping:!0}),this.drawClipPathOnCache(g,x))},drawCacheOnCanvas:function(g){g.scale(1/this.zoomX,1/this.zoomY),g.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(g){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!g&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!g){var x=this.cacheWidth/this.zoomX,y=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-x/2,-y/2,x,y)}return!0}return!1},_renderBackground:function(g){if(this.backgroundColor){var x=this._getNonTransformedDimensions();g.fillStyle=this.backgroundColor,g.fillRect(-x.x/2,-x.y/2,x.x,x.y),this._removeShadow(g)}},_setOpacity:function(g){this.group&&!this.group._transformDone?g.globalAlpha=this.getObjectOpacity():g.globalAlpha*=this.opacity},_setStrokeStyles:function(g,x){var y=x.stroke;y&&(g.lineWidth=x.strokeWidth,g.lineCap=x.strokeLineCap,g.lineDashOffset=x.strokeDashOffset,g.lineJoin=x.strokeLineJoin,g.miterLimit=x.strokeMiterLimit,y.toLive?y.gradientUnits==="percentage"||y.gradientTransform||y.patternTransform?this._applyPatternForTransformedGradient(g,y):(g.strokeStyle=y.toLive(g,this),this._applyPatternGradientTransform(g,y)):g.strokeStyle=x.stroke)},_setFillStyles:function(g,x){var y=x.fill;y&&(y.toLive?(g.fillStyle=y.toLive(g,this),this._applyPatternGradientTransform(g,x.fill)):g.fillStyle=y)},_setClippingProperties:function(g){g.globalAlpha=1,g.strokeStyle="transparent",g.fillStyle="#000000"},_setLineDash:function(g,x){!x||x.length===0||(1&x.length&&x.push.apply(x,x),g.setLineDash(x))},_renderControls:function(g,x){var y=this.getViewportTransform(),w=this.calcTransformMatrix(),_,C,E;x=x||{},C=typeof x.hasBorders<"u"?x.hasBorders:this.hasBorders,E=typeof x.hasControls<"u"?x.hasControls:this.hasControls,w=a.util.multiplyTransformMatrices(y,w),_=a.util.qrDecompose(w),g.save(),g.translate(_.translateX,_.translateY),g.lineWidth=1*this.borderScaleFactor,this.group||(g.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(_.angle-=180),g.rotate(u(this.group?_.angle:this.angle)),x.forActiveSelection||this.group?C&&this.drawBordersInGroup(g,_,x):C&&this.drawBorders(g,x),E&&this.drawControls(g,x),g.restore()},_setShadow:function(g){if(this.shadow){var x=this.shadow,y=this.canvas,w,_=y&&y.viewportTransform[0]||1,C=y&&y.viewportTransform[3]||1;x.nonScaling?w={scaleX:1,scaleY:1}:w=this.getObjectScaling(),y&&y._isRetinaScaling()&&(_*=a.devicePixelRatio,C*=a.devicePixelRatio),g.shadowColor=x.color,g.shadowBlur=x.blur*a.browserShadowBlurConstant*(_+C)*(w.scaleX+w.scaleY)/4,g.shadowOffsetX=x.offsetX*_*w.scaleX,g.shadowOffsetY=x.offsetY*C*w.scaleY}},_removeShadow:function(g){this.shadow&&(g.shadowColor="",g.shadowBlur=g.shadowOffsetX=g.shadowOffsetY=0)},_applyPatternGradientTransform:function(g,x){if(!x||!x.toLive)return{offsetX:0,offsetY:0};var y=x.gradientTransform||x.patternTransform,w=-this.width/2+x.offsetX||0,_=-this.height/2+x.offsetY||0;return x.gradientUnits==="percentage"?g.transform(this.width,0,0,this.height,w,_):g.transform(1,0,0,1,w,_),y&&g.transform(y[0],y[1],y[2],y[3],y[4],y[5]),{offsetX:w,offsetY:_}},_renderPaintInOrder:function(g){this.paintFirst==="stroke"?(this._renderStroke(g),this._renderFill(g)):(this._renderFill(g),this._renderStroke(g))},_render:function(){},_renderFill:function(g){this.fill&&(g.save(),this._setFillStyles(g,this),this.fillRule==="evenodd"?g.fill("evenodd"):g.fill(),g.restore())},_renderStroke:function(g){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(g),g.save(),this.strokeUniform&&this.group){var x=this.getObjectScaling();g.scale(1/x.scaleX,1/x.scaleY)}else this.strokeUniform&&g.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(g,this.strokeDashArray),this._setStrokeStyles(g,this),g.stroke(),g.restore()}},_applyPatternForTransformedGradient:function(g,x){var y=this._limitCacheSize(this._getCacheCanvasDimensions()),w=a.util.createCanvasElement(),_,C=this.canvas.getRetinaScaling(),E=y.x/this.scaleX/C,T=y.y/this.scaleY/C;w.width=Math.ceil(E),w.height=Math.ceil(T),_=w.getContext("2d"),_.beginPath(),_.moveTo(0,0),_.lineTo(E,0),_.lineTo(E,T),_.lineTo(0,T),_.closePath(),_.translate(E/2,T/2),_.scale(y.zoomX/this.scaleX/C,y.zoomY/this.scaleY/C),this._applyPatternGradientTransform(_,x),_.fillStyle=x.toLive(g),_.fill(),g.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),g.scale(C*this.scaleX/y.zoomX,C*this.scaleY/y.zoomY),g.strokeStyle=_.createPattern(w,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var g=a.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",g.scaleX),this.set("scaleY",g.scaleY),this.angle=g.angle,this.skewX=g.skewX,this.skewY=0}},_removeTransformMatrix:function(g){var x=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),x=a.util.transformPoint(x,this.transformMatrix)),this.transformMatrix=null,g&&(this.scaleX*=g.scaleX,this.scaleY*=g.scaleY,this.cropX=g.cropX,this.cropY=g.cropY,x.x+=g.offsetLeft,x.y+=g.offsetTop,this.width=g.width,this.height=g.height),this.setPositionByOrigin(x,"center","center")},clone:function(g,x){var y=this.toObject(x);this.constructor.fromObject?this.constructor.fromObject(y,g):a.Object._fromObject("Object",y,g)},cloneAsImage:function(g,x){var y=this.toCanvasElement(x);return g&&g(new a.Image(y)),this},toCanvasElement:function(g){g||(g={});var x=a.util,y=x.saveObjectTransform(this),w=this.group,_=this.shadow,C=Math.abs,E=(g.multiplier||1)*(g.enableRetinaScaling?a.devicePixelRatio:1);delete this.group,g.withoutTransform&&x.resetObjectTransform(this),g.withoutShadow&&(this.shadow=null);var T=a.util.createCanvasElement(),A=this.getBoundingRect(!0,!0),j=this.shadow,B,F={x:0,y:0},L,G,X;j&&(L=j.blur,j.nonScaling?B={scaleX:1,scaleY:1}:B=this.getObjectScaling(),F.x=2*Math.round(C(j.offsetX)+L)*C(B.scaleX),F.y=2*Math.round(C(j.offsetY)+L)*C(B.scaleY)),G=A.width+F.x,X=A.height+F.y,T.width=Math.ceil(G),T.height=Math.ceil(X);var re=new a.StaticCanvas(T,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});g.format==="jpeg"&&(re.backgroundColor="#fff"),this.setPositionByOrigin(new a.Point(re.width/2,re.height/2),"center","center");var Q=this.canvas;re.add(this);var ne=re.toCanvasElement(E||1,g);return this.shadow=_,this.set("canvas",Q),w&&(this.group=w),this.set(y).setCoords(),re._objects=[],re.dispose(),re=null,ne},toDataURL:function(g){return g||(g={}),a.util.toDataURL(this.toCanvasElement(g),g.format||"png",g.quality||1)},isType:function(g){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===g},complexity:function(){return 1},toJSON:function(g){return this.toObject(g)},rotate:function(g){var x=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return x&&this._setOriginToCenter(),this.set("angle",g),x&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(g,x){x=x||this.canvas.getPointer(g);var y=new a.Point(x.x,x.y),w=this._getLeftTopCoords();return this.angle&&(y=a.util.rotatePoint(y,w,u(-this.angle))),{x:y.x-w.x,y:y.y-w.y}},_setupCompositeOperation:function(g){this.globalCompositeOperation&&(g.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){a.runningAnimations&&a.runningAnimations.cancelByTarget(this)}}),a.util.createAccessors&&a.util.createAccessors(a.Object),c(a.Object.prototype,a.Observable),a.Object.NUM_FRACTION_DIGITS=2,a.Object.ENLIVEN_PROPS=["clipPath"],a.Object._fromObject=function(g,x,y,w){var _=a[g];x=f(x,!0),a.util.enlivenPatterns([x.fill,x.stroke],function(C){typeof C[0]<"u"&&(x.fill=C[0]),typeof C[1]<"u"&&(x.stroke=C[1]),a.util.enlivenObjectEnlivables(x,x,function(){var E=w?new _(x[w],x):new _(x);y&&y(E)})})},a.Object.__uid=0)}(e),function(){var o=t.util.degreesToRadians,a={left:-.5,center:0,right:.5},c={top:-.5,center:0,bottom:.5};t.util.object.extend(t.Object.prototype,{translateToGivenOrigin:function(f,h,d,u,p){var m=f.x,g=f.y,x,y,w;return typeof h=="string"?h=a[h]:h-=.5,typeof u=="string"?u=a[u]:u-=.5,x=u-h,typeof d=="string"?d=c[d]:d-=.5,typeof p=="string"?p=c[p]:p-=.5,y=p-d,(x||y)&&(w=this._getTransformedDimensions(),m=f.x+x*w.x,g=f.y+y*w.y),new t.Point(m,g)},translateToCenterPoint:function(f,h,d){var u=this.translateToGivenOrigin(f,h,d,"center","center");return this.angle?t.util.rotatePoint(u,f,o(this.angle)):u},translateToOriginPoint:function(f,h,d){var u=this.translateToGivenOrigin(f,"center","center",h,d);return this.angle?t.util.rotatePoint(u,f,o(this.angle)):u},getCenterPoint:function(){var f=new t.Point(this.left,this.top);return this.translateToCenterPoint(f,this.originX,this.originY)},getPointByOrigin:function(f,h){var d=this.getCenterPoint();return this.translateToOriginPoint(d,f,h)},toLocalPoint:function(f,h,d){var u=this.getCenterPoint(),p,m;return typeof h<"u"&&typeof d<"u"?p=this.translateToGivenOrigin(u,"center","center",h,d):p=new t.Point(this.left,this.top),m=new t.Point(f.x,f.y),this.angle&&(m=t.util.rotatePoint(m,u,-o(this.angle))),m.subtractEquals(p)},setPositionByOrigin:function(f,h,d){var u=this.translateToCenterPoint(f,h,d),p=this.translateToOriginPoint(u,this.originX,this.originY);this.set("left",p.x),this.set("top",p.y)},adjustPosition:function(f){var h=o(this.angle),d=this.getScaledWidth(),u=t.util.cos(h)*d,p=t.util.sin(h)*d,m,g;typeof this.originX=="string"?m=a[this.originX]:m=this.originX-.5,typeof f=="string"?g=a[f]:g=f-.5,this.left+=u*(g-m),this.top+=p*(g-m),this.setCoords(),this.originX=f},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var f=this.getCenterPoint();this.originX="center",this.originY="center",this.left=f.x,this.top=f.y},_resetOrigin:function(){var f=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=f.x,this.top=f.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function o(d){return[new t.Point(d.tl.x,d.tl.y),new t.Point(d.tr.x,d.tr.y),new t.Point(d.br.x,d.br.y),new t.Point(d.bl.x,d.bl.y)]}var a=t.util,c=a.degreesToRadians,f=a.multiplyTransformMatrices,h=a.transformPoint;a.object.extend(t.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(d,u){return u?d?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),d?this.aCoords:this.lineCoords)},getCoords:function(d,u){return o(this._getCoords(d,u))},intersectsWithRect:function(d,u,p,m){var g=this.getCoords(p,m),x=t.Intersection.intersectPolygonRectangle(g,d,u);return x.status==="Intersection"},intersectsWithObject:function(d,u,p){var m=t.Intersection.intersectPolygonPolygon(this.getCoords(u,p),d.getCoords(u,p));return m.status==="Intersection"||d.isContainedWithinObject(this,u,p)||this.isContainedWithinObject(d,u,p)},isContainedWithinObject:function(d,u,p){for(var m=this.getCoords(u,p),g=u?d.aCoords:d.lineCoords,x=0,y=d._getImageLines(g);x<4;x++)if(!d.containsPoint(m[x],y))return!1;return!0},isContainedWithinRect:function(d,u,p,m){var g=this.getBoundingRect(p,m);return g.left>=d.x&&g.left+g.width<=u.x&&g.top>=d.y&&g.top+g.height<=u.y},containsPoint:function(d,x,p,m){var g=this._getCoords(p,m),x=x||this._getImageLines(g),y=this._findCrossPoints(d,x);return y!==0&&y%2===1},isOnScreen:function(d){if(!this.canvas)return!1;var u=this.canvas.vptCoords.tl,p=this.canvas.vptCoords.br,m=this.getCoords(!0,d);return m.some(function(g){return g.x<=p.x&&g.x>=u.x&&g.y<=p.y&&g.y>=u.y})||this.intersectsWithRect(u,p,!0,d)?!0:this._containsCenterOfCanvas(u,p,d)},_containsCenterOfCanvas:function(d,u,p){var m={x:(d.x+u.x)/2,y:(d.y+u.y)/2};return!!this.containsPoint(m,null,!0,p)},isPartiallyOnScreen:function(d){if(!this.canvas)return!1;var u=this.canvas.vptCoords.tl,p=this.canvas.vptCoords.br;if(this.intersectsWithRect(u,p,!0,d))return!0;var m=this.getCoords(!0,d).every(function(g){return(g.x>=p.x||g.x<=u.x)&&(g.y>=p.y||g.y<=u.y)});return m&&this._containsCenterOfCanvas(u,p,d)},_getImageLines:function(d){var u={topline:{o:d.tl,d:d.tr},rightline:{o:d.tr,d:d.br},bottomline:{o:d.br,d:d.bl},leftline:{o:d.bl,d:d.tl}};return u},_findCrossPoints:function(d,u){var p,m,g,x,y,w=0,_;for(var C in u)if(_=u[C],!(_.o.y<d.y&&_.d.y<d.y)&&!(_.o.y>=d.y&&_.d.y>=d.y)&&(_.o.x===_.d.x&&_.o.x>=d.x?y=_.o.x:(p=0,m=(_.d.y-_.o.y)/(_.d.x-_.o.x),g=d.y-p*d.x,x=_.o.y-m*_.o.x,y=-(g-x)/(p-m)),y>=d.x&&(w+=1),w===2))break;return w},getBoundingRect:function(d,u){var p=this.getCoords(d,u);return a.makeBoundingBoxFromPoints(p)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(d){return Math.abs(d)<this.minScaleLimit?d<0?-this.minScaleLimit:this.minScaleLimit:d===0?1e-4:d},scale:function(d){return this._set("scaleX",d),this._set("scaleY",d),this.setCoords()},scaleToWidth:function(d,u){var p=this.getBoundingRect(u).width/this.getScaledWidth();return this.scale(d/this.width/p)},scaleToHeight:function(d,u){var p=this.getBoundingRect(u).height/this.getScaledHeight();return this.scale(d/this.height/p)},calcLineCoords:function(){var d=this.getViewportTransform(),u=this.padding,p=c(this.angle),m=a.cos(p),g=a.sin(p),x=m*u,y=g*u,w=x+y,_=x-y,C=this.calcACoords(),E={tl:h(C.tl,d),tr:h(C.tr,d),bl:h(C.bl,d),br:h(C.br,d)};return u&&(E.tl.x-=_,E.tl.y-=w,E.tr.x+=w,E.tr.y-=_,E.bl.x-=w,E.bl.y+=_,E.br.x+=_,E.br.y+=w),E},calcOCoords:function(){var d=this._calcRotateMatrix(),u=this._calcTranslateMatrix(),p=this.getViewportTransform(),m=f(p,u),g=f(m,d),g=f(g,[1/p[0],0,0,1/p[3],0,0]),x=this._calculateCurrentDimensions(),y={};return this.forEachControl(function(w,_,C){y[_]=w.positionHandler(x,g,C)}),y},calcACoords:function(){var d=this._calcRotateMatrix(),u=this._calcTranslateMatrix(),p=f(u,d),m=this._getTransformedDimensions(),g=m.x/2,x=m.y/2;return{tl:h({x:-g,y:-x},p),tr:h({x:g,y:-x},p),bl:h({x:-g,y:x},p),br:h({x:g,y:x},p)}},setCoords:function(d){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),d?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return a.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var d=this.getCenterPoint();return[1,0,0,1,d.x,d.y]},transformMatrixKey:function(d){var u="_",p="";return!d&&this.group&&(p=this.group.transformMatrixKey(d)+u),p+this.top+u+this.left+u+this.scaleX+u+this.scaleY+u+this.skewX+u+this.skewY+u+this.angle+u+this.originX+u+this.originY+u+this.width+u+this.height+u+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(d){var u=this.calcOwnMatrix();if(d||!this.group)return u;var p=this.transformMatrixKey(d),m=this.matrixCache||(this.matrixCache={});return m.key===p?m.value:(this.group&&(u=f(this.group.calcTransformMatrix(!1),u)),m.key=p,m.value=u,u)},calcOwnMatrix:function(){var d=this.transformMatrixKey(!0),u=this.ownMatrixCache||(this.ownMatrixCache={});if(u.key===d)return u.value;var p=this._calcTranslateMatrix(),m={angle:this.angle,translateX:p[4],translateY:p[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return u.key=d,u.value=a.composeMatrix(m),u.value},_getNonTransformedDimensions:function(){var d=this.strokeWidth,u=this.width+d,p=this.height+d;return{x:u,y:p}},_getTransformedDimensions:function(d,u){typeof d>"u"&&(d=this.skewX),typeof u>"u"&&(u=this.skewY);var p,m,g,x=d===0&&u===0;if(this.strokeUniform?(m=this.width,g=this.height):(p=this._getNonTransformedDimensions(),m=p.x,g=p.y),x)return this._finalizeDimensions(m*this.scaleX,g*this.scaleY);var y=a.sizeAfterTransform(m,g,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:d,skewY:u});return this._finalizeDimensions(y.x,y.y)},_finalizeDimensions:function(d,u){return this.strokeUniform?{x:d+this.strokeWidth,y:u+this.strokeWidth}:{x:d,y:u}},_calculateCurrentDimensions:function(){var d=this.getViewportTransform(),u=this._getTransformedDimensions(),p=h(u,d,!0);return p.scalarAdd(2*this.padding)}})}(),t.util.object.extend(t.Object.prototype,{sendToBack:function(){return this.group?t.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?t.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(o){return this.group?t.StaticCanvas.prototype.sendBackwards.call(this.group,this,o):this.canvas&&this.canvas.sendBackwards(this,o),this},bringForward:function(o){return this.group?t.StaticCanvas.prototype.bringForward.call(this.group,this,o):this.canvas&&this.canvas.bringForward(this,o),this},moveTo:function(o){return this.group&&this.group.type!=="activeSelection"?t.StaticCanvas.prototype.moveTo.call(this.group,this,o):this.canvas&&this.canvas.moveTo(this,o),this}}),function(){function o(c,f){if(f){if(f.toLive)return c+": url(#SVGID_"+f.id+"); ";var h=new t.Color(f),d=c+": "+h.toRgb()+"; ",u=h.getAlpha();return u!==1&&(d+=c+"-opacity: "+u.toString()+"; "),d}else return c+": none; "}var a=t.util.toFixed;t.util.object.extend(t.Object.prototype,{getSvgStyles:function(c){var f=this.fillRule?this.fillRule:"nonzero",h=this.strokeWidth?this.strokeWidth:"0",d=this.strokeDashArray?this.strokeDashArray.join(" "):"none",u=this.strokeDashOffset?this.strokeDashOffset:"0",p=this.strokeLineCap?this.strokeLineCap:"butt",m=this.strokeLineJoin?this.strokeLineJoin:"miter",g=this.strokeMiterLimit?this.strokeMiterLimit:"4",x=typeof this.opacity<"u"?this.opacity:"1",y=this.visible?"":" visibility: hidden;",w=c?"":this.getSvgFilter(),_=o("fill",this.fill),C=o("stroke",this.stroke);return[C,"stroke-width: ",h,"; ","stroke-dasharray: ",d,"; ","stroke-linecap: ",p,"; ","stroke-dashoffset: ",u,"; ","stroke-linejoin: ",m,"; ","stroke-miterlimit: ",g,"; ",_,"fill-rule: ",f,"; ","opacity: ",x,";",w,y].join("")},getSvgSpanStyles:function(c,f){var h="; ",u=c.fontFamily?"font-family: "+(c.fontFamily.indexOf("'")===-1&&c.fontFamily.indexOf('"')===-1?"'"+c.fontFamily+"'":c.fontFamily)+h:"",d=c.strokeWidth?"stroke-width: "+c.strokeWidth+h:"",u=u,p=c.fontSize?"font-size: "+c.fontSize+"px"+h:"",m=c.fontStyle?"font-style: "+c.fontStyle+h:"",g=c.fontWeight?"font-weight: "+c.fontWeight+h:"",x=c.fill?o("fill",c.fill):"",y=c.stroke?o("stroke",c.stroke):"",w=this.getSvgTextDecoration(c),_=c.deltaY?"baseline-shift: "+-c.deltaY+"; ":"";return w&&(w="text-decoration: "+w+h),[y,d,u,p,m,g,w,x,_,f?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(c){return["overline","underline","line-through"].filter(function(f){return c[f.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(c,f){var h=c?this.calcTransformMatrix():this.calcOwnMatrix(),d='transform="'+t.util.matrixToSVG(h);return d+(f||"")+'" '},_setSVGBg:function(c){if(this.backgroundColor){var f=t.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',a(-this.width/2,f),'" y="',a(-this.height/2,f),'" width="',a(this.width,f),'" height="',a(this.height,f),`"></rect>
`)}},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(c),{reviver:c})},toClipPathSVG:function(c){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(c),{reviver:c})},_createBaseClipPathSVGMarkup:function(c,f){f=f||{};var h=f.reviver,d=f.additionalTransform||"",u=[this.getSvgTransform(!0,d),this.getSvgCommons()].join(""),p=c.indexOf("COMMON_PARTS");return c[p]=u,h?h(c.join("")):c.join("")},_createBaseSVGMarkup:function(c,f){f=f||{};var h=f.noStyle,d=f.reviver,u=h?"":'style="'+this.getSvgStyles()+'" ',p=f.withShadow?'style="'+this.getSvgFilter()+'" ':"",m=this.clipPath,g=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",x=m&&m.absolutePositioned,y=this.stroke,w=this.fill,_=this.shadow,C,E=[],T,A=c.indexOf("COMMON_PARTS"),j=f.additionalTransform;return m&&(m.clipPathId="CLIPPATH_"+t.Object.__uid++,T='<clipPath id="'+m.clipPathId+`" >
`+m.toClipPathSVG(d)+`</clipPath>
`),x&&E.push("<g ",p,this.getSvgCommons(),` >
`),E.push("<g ",this.getSvgTransform(!1),x?"":p+this.getSvgCommons(),` >
`),C=[u,g,h?"":this.addPaintOrder()," ",j?'transform="'+j+'" ':""].join(""),c[A]=C,w&&w.toLive&&E.push(w.toSVG(this)),y&&y.toLive&&E.push(y.toSVG(this)),_&&E.push(_.toSVG(this)),m&&E.push(T),E.push(c.join("")),E.push(`</g>
`),x&&E.push(`</g>
`),d?d(E.join("")):E.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var o=t.util.object.extend,a="stateProperties";function c(h,d,u){var p={},m=!0;u.forEach(function(g){p[g]=h[g]}),o(h[d],p,m)}function f(h,d,u){if(h===d)return!0;if(Array.isArray(h)){if(!Array.isArray(d)||h.length!==d.length)return!1;for(var p=0,m=h.length;p<m;p++)if(!f(h[p],d[p]))return!1;return!0}else if(h&&typeof h=="object"){var g=Object.keys(h),x;if(!d||typeof d!="object"||!u&&g.length!==Object.keys(d).length)return!1;for(var p=0,m=g.length;p<m;p++)if(x=g[p],!(x==="canvas"||x==="group")&&!f(h[x],d[x]))return!1;return!0}}t.util.object.extend(t.Object.prototype,{hasStateChanged:function(h){h=h||a;var d="_"+h;return Object.keys(this[d]).length<this[h].length?!0:!f(this[d],this,!0)},saveState:function(h){var d=h&&h.propertySet||a,u="_"+d;return this[u]?(c(this,u,this[d]),h&&h.stateProperties&&c(this,u,h.stateProperties),this):this.setupState(h)},setupState:function(h){h=h||{};var d=h.propertySet||a;return h.propertySet=d,this["_"+d]={},this.saveState(h),this}})}(),function(){var o=t.util.degreesToRadians;t.util.object.extend(t.Object.prototype,{_findTargetCorner:function(a,c){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var f=a.x,h=a.y,d,u,p=Object.keys(this.oCoords),m=p.length-1,g;for(this.__corner=0;m>=0;m--)if(g=p[m],!!this.isControlVisible(g)&&(u=this._getImageLines(c?this.oCoords[g].touchCorner:this.oCoords[g].corner),d=this._findCrossPoints({x:f,y:h},u),d!==0&&d%2===1))return this.__corner=g,g;return!1},forEachControl:function(a){for(var c in this.controls)a(this.controls[c],c,this)},_setCornerCoords:function(){var a=this.oCoords;for(var c in a){var f=this.controls[c];a[c].corner=f.calcCornerCoords(this.angle,this.cornerSize,a[c].x,a[c].y,!1),a[c].touchCorner=f.calcCornerCoords(this.angle,this.touchCornerSize,a[c].x,a[c].y,!0)}},drawSelectionBackground:function(a){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;a.save();var c=this.getCenterPoint(),f=this._calculateCurrentDimensions(),h=this.canvas.viewportTransform;return a.translate(c.x,c.y),a.scale(1/h[0],1/h[3]),a.rotate(o(this.angle)),a.fillStyle=this.selectionBackgroundColor,a.fillRect(-f.x/2,-f.y/2,f.x,f.y),a.restore(),this},drawBorders:function(a,c){c=c||{};var f=this._calculateCurrentDimensions(),h=this.borderScaleFactor,d=f.x+h,u=f.y+h,p=typeof c.hasControls<"u"?c.hasControls:this.hasControls,m=!1;return a.save(),a.strokeStyle=c.borderColor||this.borderColor,this._setLineDash(a,c.borderDashArray||this.borderDashArray),a.strokeRect(-d/2,-u/2,d,u),p&&(a.beginPath(),this.forEachControl(function(g,x,y){g.withConnection&&g.getVisibility(y,x)&&(m=!0,a.moveTo(g.x*d,g.y*u),a.lineTo(g.x*d+g.offsetX,g.y*u+g.offsetY))}),m&&a.stroke()),a.restore(),this},drawBordersInGroup:function(a,c,f){f=f||{};var h=t.util.sizeAfterTransform(this.width,this.height,c),d=this.strokeWidth,u=this.strokeUniform,p=this.borderScaleFactor,m=h.x+d*(u?this.canvas.getZoom():c.scaleX)+p,g=h.y+d*(u?this.canvas.getZoom():c.scaleY)+p;return a.save(),this._setLineDash(a,f.borderDashArray||this.borderDashArray),a.strokeStyle=f.borderColor||this.borderColor,a.strokeRect(-m/2,-g/2,m,g),a.restore(),this},drawControls:function(a,c){c=c||{},a.save();var f=1,h,d;return this.canvas&&(f=this.canvas.getRetinaScaling()),a.setTransform(f,0,0,f,0,0),a.strokeStyle=a.fillStyle=c.cornerColor||this.cornerColor,this.transparentCorners||(a.strokeStyle=c.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(a,c.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(h=this.group.calcTransformMatrix()),this.forEachControl(function(u,p,m){d=m.oCoords[p],u.getVisibility(m,p)&&(h&&(d=t.util.transformPoint(d,h)),u.render(a,d.x,d.y,c,m))}),a.restore(),this},isControlVisible:function(a){return this.controls[a]&&this.controls[a].getVisibility(this,a)},setControlVisible:function(a,c){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[a]=c,this},setControlsVisibility:function(a){a||(a={});for(var c in a)this.setControlVisible(c,a[c]);return this},onDeselect:function(){},onSelect:function(){}})}(),t.util.object.extend(t.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(o,a){a=a||{};var c=function(){},f=a.onComplete||c,h=a.onChange||c,d=this;return t.util.animate({target:this,startValue:o.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(u){o.set("left",u),d.requestRenderAll(),h()},onComplete:function(){o.setCoords(),f()}})},fxCenterObjectV:function(o,a){a=a||{};var c=function(){},f=a.onComplete||c,h=a.onChange||c,d=this;return t.util.animate({target:this,startValue:o.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(u){o.set("top",u),d.requestRenderAll(),h()},onComplete:function(){o.setCoords(),f()}})},fxRemove:function(o,a){a=a||{};var c=function(){},f=a.onComplete||c,h=a.onChange||c,d=this;return t.util.animate({target:this,startValue:o.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(u){o.set("opacity",u),d.requestRenderAll(),h()},onComplete:function(){d.remove(o),f()}})}}),t.util.object.extend(t.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var o=[],a,c,f=[];for(a in arguments[0])o.push(a);for(var h=0,d=o.length;h<d;h++)a=o[h],c=h!==d-1,f.push(this._animate(a,arguments[0][a],arguments[1],c));return f}else return this._animate.apply(this,arguments)},_animate:function(o,a,c,f){var h=this,d;a=a.toString(),c?c=t.util.object.clone(c):c={},~o.indexOf(".")&&(d=o.split("."));var u=h.colorProperties.indexOf(o)>-1||d&&h.colorProperties.indexOf(d[1])>-1,p=d?this.get(d[0])[d[1]]:this.get(o);"from"in c||(c.from=p),u||(~a.indexOf("=")?a=p+parseFloat(a.replace("=","")):a=parseFloat(a));var m={target:this,startValue:c.from,endValue:a,byValue:c.by,easing:c.easing,duration:c.duration,abort:c.abort&&function(g,x,y){return c.abort.call(h,g,x,y)},onChange:function(g,x,y){d?h[d[0]][d[1]]=g:h.set(o,g),!f&&c.onChange&&c.onChange(g,x,y)},onComplete:function(g,x,y){f||(h.setCoords(),c.onComplete&&c.onComplete(g,x,y))}};return u?t.util.animateColor(m.startValue,m.endValue,m.duration,m):t.util.animate(m)}}),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,f=a.util.object.clone,h={x1:1,x2:1,y1:1,y2:1};if(a.Line){a.warn("fabric.Line is already defined");return}a.Line=a.util.createClass(a.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:a.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(u,p){u||(u=[0,0,0,0]),this.callSuper("initialize",p),this.set("x1",u[0]),this.set("y1",u[1]),this.set("x2",u[2]),this.set("y2",u[3]),this._setWidthHeight(p)},_setWidthHeight:function(u){u||(u={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in u?u.left:this._getLeftToOriginX(),this.top="top"in u?u.top:this._getTopToOriginY()},_set:function(u,p){return this.callSuper("_set",u,p),typeof h[u]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:d({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:d({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(u){u.beginPath();var p=this.calcLinePoints();u.moveTo(p.x1,p.y1),u.lineTo(p.x2,p.y2),u.lineWidth=this.strokeWidth;var m=u.strokeStyle;u.strokeStyle=this.stroke||u.fillStyle,this.stroke&&this._renderStroke(u),u.strokeStyle=m},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(u){return c(this.callSuper("toObject",u),this.calcLinePoints())},_getNonTransformedDimensions:function(){var u=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(u.y-=this.strokeWidth),this.height===0&&(u.x-=this.strokeWidth)),u},calcLinePoints:function(){var u=this.x1<=this.x2?-1:1,p=this.y1<=this.y2?-1:1,m=u*this.width*.5,g=p*this.height*.5,x=u*this.width*-.5,y=p*this.height*-.5;return{x1:m,x2:x,y1:g,y2:y}},_toSVG:function(){var u=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',u.x1,'" y1="',u.y1,'" x2="',u.x2,'" y2="',u.y2,`" />
`]}}),a.Line.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),a.Line.fromElement=function(u,p,m){m=m||{};var g=a.parseAttributes(u,a.Line.ATTRIBUTE_NAMES),x=[g.x1||0,g.y1||0,g.x2||0,g.y2||0];p(new a.Line(x,c(g,m)))},a.Line.fromObject=function(u,p){function m(x){delete x.points,p&&p(x)}var g=f(u,!0);g.points=[u.x1,u.y1,u.x2,u.y2],a.Object._fromObject("Line",g,m,"points")};function d(u,p){var m=u.origin,g=u.axis1,x=u.axis2,y=u.dimension,w=p.nearest,_=p.center,C=p.farthest;return function(){switch(this.get(m)){case w:return Math.min(this.get(g),this.get(x));case _:return Math.min(this.get(g),this.get(x))+.5*this.get(y);case C:return Math.max(this.get(g),this.get(x))}}}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.degreesToRadians;if(a.Circle){a.warn("fabric.Circle is already defined.");return}a.Circle=a.util.createClass(a.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:a.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(h,d){return this.callSuper("_set",h,d),h==="radius"&&this.setRadius(d),this},toObject:function(h){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(h))},_toSVG:function(){var h,d=0,u=0,p=(this.endAngle-this.startAngle)%360;if(p===0)h=["<circle ","COMMON_PARTS",'cx="'+d+'" cy="'+u+'" ','r="',this.radius,`" />
`];else{var m=c(this.startAngle),g=c(this.endAngle),x=this.radius,y=a.util.cos(m)*x,w=a.util.sin(m)*x,_=a.util.cos(g)*x,C=a.util.sin(g)*x,E=p>180?"1":"0";h=['<path d="M '+y+" "+w," A "+x+" "+x," 0 ",+E+" 1"," "+_+" "+C,'" ',"COMMON_PARTS",` />
`]}return h},_render:function(h){h.beginPath(),h.arc(0,0,this.radius,c(this.startAngle),c(this.endAngle),!1),this._renderPaintInOrder(h)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(h){return this.radius=h,this.set("width",h*2).set("height",h*2)}}),a.Circle.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),a.Circle.fromElement=function(h,d){var u=a.parseAttributes(h,a.Circle.ATTRIBUTE_NAMES);if(!f(u))throw new Error("value of `r` attribute is required and can not be negative");u.left=(u.left||0)-u.radius,u.top=(u.top||0)-u.radius,d(new a.Circle(u))};function f(h){return"radius"in h&&h.radius>=0}a.Circle.fromObject=function(h,d){a.Object._fromObject("Circle",h,d)}}(e),function(o){var a=o.fabric||(o.fabric={});if(a.Triangle){a.warn("fabric.Triangle is already defined");return}a.Triangle=a.util.createClass(a.Object,{type:"triangle",width:100,height:100,_render:function(c){var f=this.width/2,h=this.height/2;c.beginPath(),c.moveTo(-f,h),c.lineTo(0,-h),c.lineTo(f,h),c.closePath(),this._renderPaintInOrder(c)},_toSVG:function(){var c=this.width/2,f=this.height/2,h=[-c+" "+f,"0 "+-f,c+" "+f].join(",");return["<polygon ","COMMON_PARTS",'points="',h,'" />']}}),a.Triangle.fromObject=function(c,f){return a.Object._fromObject("Triangle",c,f)}}(e),function(o){var a=o.fabric||(o.fabric={}),c=Math.PI*2;if(a.Ellipse){a.warn("fabric.Ellipse is already defined.");return}a.Ellipse=a.util.createClass(a.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:a.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(f){this.callSuper("initialize",f),this.set("rx",f&&f.rx||0),this.set("ry",f&&f.ry||0)},_set:function(f,h){switch(this.callSuper("_set",f,h),f){case"rx":this.rx=h,this.set("width",h*2);break;case"ry":this.ry=h,this.set("height",h*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(f){return this.callSuper("toObject",["rx","ry"].concat(f))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(f){f.beginPath(),f.save(),f.transform(1,0,0,this.ry/this.rx,0,0),f.arc(0,0,this.rx,0,c,!1),f.restore(),this._renderPaintInOrder(f)}}),a.Ellipse.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),a.Ellipse.fromElement=function(f,h){var d=a.parseAttributes(f,a.Ellipse.ATTRIBUTE_NAMES);d.left=(d.left||0)-d.rx,d.top=(d.top||0)-d.ry,h(new a.Ellipse(d))},a.Ellipse.fromObject=function(f,h){a.Object._fromObject("Ellipse",f,h)}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend;if(a.Rect){a.warn("fabric.Rect is already defined");return}a.Rect=a.util.createClass(a.Object,{stateProperties:a.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:a.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(f){this.callSuper("initialize",f),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(f){var h=this.rx?Math.min(this.rx,this.width/2):0,d=this.ry?Math.min(this.ry,this.height/2):0,u=this.width,p=this.height,m=-this.width/2,g=-this.height/2,x=h!==0||d!==0,y=1-.5522847498;f.beginPath(),f.moveTo(m+h,g),f.lineTo(m+u-h,g),x&&f.bezierCurveTo(m+u-y*h,g,m+u,g+y*d,m+u,g+d),f.lineTo(m+u,g+p-d),x&&f.bezierCurveTo(m+u,g+p-y*d,m+u-y*h,g+p,m+u-h,g+p),f.lineTo(m+h,g+p),x&&f.bezierCurveTo(m+y*h,g+p,m,g+p-y*d,m,g+p-d),f.lineTo(m,g+d),x&&f.bezierCurveTo(m,g+y*d,m+y*h,g,m+h,g),f.closePath(),this._renderPaintInOrder(f)},toObject:function(f){return this.callSuper("toObject",["rx","ry"].concat(f))},_toSVG:function(){var f=-this.width/2,h=-this.height/2;return["<rect ","COMMON_PARTS",'x="',f,'" y="',h,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),a.Rect.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),a.Rect.fromElement=function(f,h,d){if(!f)return h(null);d=d||{};var u=a.parseAttributes(f,a.Rect.ATTRIBUTE_NAMES);u.left=u.left||0,u.top=u.top||0,u.height=u.height||0,u.width=u.width||0;var p=new a.Rect(c(d?a.util.object.clone(d):{},u));p.visible=p.visible&&p.width>0&&p.height>0,h(p)},a.Rect.fromObject=function(f,h){return a.Object._fromObject("Rect",f,h)}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,f=a.util.array.min,h=a.util.array.max,d=a.util.toFixed,u=a.util.projectStrokeOnPoints;if(a.Polyline){a.warn("fabric.Polyline is already defined");return}a.Polyline=a.util.createClass(a.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:a.Object.prototype.cacheProperties.concat("points"),initialize:function(p,m){m=m||{},this.points=p||[],this.callSuper("initialize",m),this._setPositionDimensions(m)},_projectStrokeOnPoints:function(){return u(this.points,this,!0)},_setPositionDimensions:function(p){var m=this._calcDimensions(p),g,x=this.exactBoundingBox?this.strokeWidth:0;this.width=m.width-x,this.height=m.height-x,p.fromSVG||(g=this.translateToGivenOrigin({x:m.left-this.strokeWidth/2+x/2,y:m.top-this.strokeWidth/2+x/2},"left","top",this.originX,this.originY)),typeof p.left>"u"&&(this.left=p.fromSVG?m.left:g.x),typeof p.top>"u"&&(this.top=p.fromSVG?m.top:g.y),this.pathOffset={x:m.left+this.width/2+x/2,y:m.top+this.height/2+x/2}},_calcDimensions:function(){var p=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,m=f(p,"x")||0,g=f(p,"y")||0,x=h(p,"x")||0,y=h(p,"y")||0,w=x-m,_=y-g;return{left:m,top:g,width:w,height:_}},toObject:function(p){return c(this.callSuper("toObject",p),{points:this.points.concat()})},_toSVG:function(){for(var p=[],m=this.pathOffset.x,g=this.pathOffset.y,x=a.Object.NUM_FRACTION_DIGITS,y=0,w=this.points.length;y<w;y++)p.push(d(this.points[y].x-m,x),",",d(this.points[y].y-g,x)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',p.join(""),`" />
`]},commonRender:function(p){var m,g=this.points.length,x=this.pathOffset.x,y=this.pathOffset.y;if(!g||isNaN(this.points[g-1].y))return!1;p.beginPath(),p.moveTo(this.points[0].x-x,this.points[0].y-y);for(var w=0;w<g;w++)m=this.points[w],p.lineTo(m.x-x,m.y-y);return!0},_render:function(p){this.commonRender(p)&&this._renderPaintInOrder(p)},complexity:function(){return this.get("points").length}}),a.Polyline.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat(),a.Polyline.fromElementGenerator=function(p){return function(m,g,x){if(!m)return g(null);x||(x={});var y=a.parsePointsAttribute(m.getAttribute("points")),w=a.parseAttributes(m,a[p].ATTRIBUTE_NAMES);w.fromSVG=!0,g(new a[p](y,c(w,x)))}},a.Polyline.fromElement=a.Polyline.fromElementGenerator("Polyline"),a.Polyline.fromObject=function(p,m){return a.Object._fromObject("Polyline",p,m,"points")}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.projectStrokeOnPoints;if(a.Polygon){a.warn("fabric.Polygon is already defined");return}a.Polygon=a.util.createClass(a.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return c(this.points,this)},_render:function(f){this.commonRender(f)&&(f.closePath(),this._renderPaintInOrder(f))}}),a.Polygon.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat(),a.Polygon.fromElement=a.Polyline.fromElementGenerator("Polygon"),a.Polygon.fromObject=function(f,h){a.Object._fromObject("Polygon",f,h,"points")}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.array.min,f=a.util.array.max,h=a.util.object.extend,d=a.util.object.clone,u=a.util.toFixed;if(a.Path){a.warn("fabric.Path is already defined");return}a.Path=a.util.createClass(a.Object,{type:"path",path:null,cacheProperties:a.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:a.Object.prototype.stateProperties.concat("path"),initialize:function(p,m){m=d(m||{}),delete m.path,this.callSuper("initialize",m),this._setPath(p||[],m)},_setPath:function(p,m){this.path=a.util.makePathSimpler(Array.isArray(p)?p:a.util.parsePath(p)),a.Polyline.prototype._setPositionDimensions.call(this,m||{})},_renderPathCommands:function(p){var m,g=0,x=0,y=0,w=0,_=0,C=0,E=-this.pathOffset.x,T=-this.pathOffset.y;p.beginPath();for(var A=0,j=this.path.length;A<j;++A)switch(m=this.path[A],m[0]){case"L":y=m[1],w=m[2],p.lineTo(y+E,w+T);break;case"M":y=m[1],w=m[2],g=y,x=w,p.moveTo(y+E,w+T);break;case"C":y=m[5],w=m[6],_=m[3],C=m[4],p.bezierCurveTo(m[1]+E,m[2]+T,_+E,C+T,y+E,w+T);break;case"Q":p.quadraticCurveTo(m[1]+E,m[2]+T,m[3]+E,m[4]+T),y=m[3],w=m[4],_=m[1],C=m[2];break;case"z":case"Z":y=g,w=x,p.closePath();break}},_render:function(p){this._renderPathCommands(p),this._renderPaintInOrder(p)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(p){return h(this.callSuper("toObject",p),{path:this.path.map(function(m){return m.slice()})})},toDatalessObject:function(p){var m=this.toObject(["sourcePath"].concat(p));return m.sourcePath&&delete m.path,m},_toSVG:function(){var p=a.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',p,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var p=a.Object.NUM_FRACTION_DIGITS;return" translate("+u(-this.pathOffset.x,p)+", "+u(-this.pathOffset.y,p)+")"},toClipPathSVG:function(p){var m=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:p,additionalTransform:m})},toSVG:function(p){var m=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:p,additionalTransform:m})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var p=[],m=[],g,x=0,y=0,w=0,_=0,C,E=0,T=this.path.length;E<T;++E){switch(g=this.path[E],g[0]){case"L":w=g[1],_=g[2],C=[];break;case"M":w=g[1],_=g[2],x=w,y=_,C=[];break;case"C":C=a.util.getBoundsOfCurve(w,_,g[1],g[2],g[3],g[4],g[5],g[6]),w=g[5],_=g[6];break;case"Q":C=a.util.getBoundsOfCurve(w,_,g[1],g[2],g[1],g[2],g[3],g[4]),w=g[3],_=g[4];break;case"z":case"Z":w=x,_=y;break}C.forEach(function(X){p.push(X.x),m.push(X.y)}),p.push(w),m.push(_)}var A=c(p)||0,j=c(m)||0,B=f(p)||0,F=f(m)||0,L=B-A,G=F-j;return{left:A,top:j,width:L,height:G}}}),a.Path.fromObject=function(p,m){if(typeof p.sourcePath=="string"){var g=p.sourcePath;a.loadSVGFromURL(g,function(x){var y=x[0];y.setOptions(p),p.clipPath?a.util.enlivenObjects([p.clipPath],function(w){y.clipPath=w[0],m&&m(y)}):m&&m(y)})}else a.Object._fromObject("Path",p,m,"path")},a.Path.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat(["d"]),a.Path.fromElement=function(p,m,g){var x=a.parseAttributes(p,a.Path.ATTRIBUTE_NAMES);x.fromSVG=!0,m(new a.Path(x.d,h(x,g)))}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.array.min,f=a.util.array.max;a.Group||(a.Group=a.util.createClass(a.Object,a.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(h,d,u){d=d||{},this._objects=[],u&&this.callSuper("initialize",d),this._objects=h||[];for(var p=this._objects.length;p--;)this._objects[p].group=this;if(u)this._updateObjectsACoords();else{var m=d&&d.centerPoint;d.originX!==void 0&&(this.originX=d.originX),d.originY!==void 0&&(this.originY=d.originY),m||this._calcBounds(),this._updateObjectsCoords(m),delete d.centerPoint,this.callSuper("initialize",d)}this.setCoords()},_updateObjectsACoords:function(){for(var h=!0,d=this._objects.length;d--;)this._objects[d].setCoords(h)},_updateObjectsCoords:function(d){for(var d=d||this.getCenterPoint(),u=this._objects.length;u--;)this._updateObjectCoords(this._objects[u],d)},_updateObjectCoords:function(h,d){var u=h.left,p=h.top,m=!0;h.set({left:u-d.x,top:p-d.y}),h.group=this,h.setCoords(m)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(h){var d=!!this.group;return this._restoreObjectsState(),a.util.resetObjectTransform(this),h&&(d&&a.util.removeTransformFromObject(h,this.group.calcTransformMatrix()),this._objects.push(h),h.group=this,h._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,d?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(h){return this._restoreObjectsState(),a.util.resetObjectTransform(this),this.remove(h),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(h){this.dirty=!0,h.group=this,h._set("canvas",this.canvas)},_onObjectRemoved:function(h){this.dirty=!0,delete h.group},_set:function(h,d){var u=this._objects.length;if(this.useSetOnGroup)for(;u--;)this._objects[u].setOnGroup(h,d);if(h==="canvas")for(;u--;)this._objects[u]._set(h,d);a.Object.prototype._set.call(this,h,d)},toObject:function(h){var d=this.includeDefaultValues,u=this._objects.filter(function(m){return!m.excludeFromExport}).map(function(m){var g=m.includeDefaultValues;m.includeDefaultValues=d;var x=m.toObject(h);return m.includeDefaultValues=g,x}),p=a.Object.prototype.toObject.call(this,h);return p.objects=u,p},toDatalessObject:function(h){var d,u=this.sourcePath;if(u)d=u;else{var p=this.includeDefaultValues;d=this._objects.map(function(g){var x=g.includeDefaultValues;g.includeDefaultValues=p;var y=g.toDatalessObject(h);return g.includeDefaultValues=x,y})}var m=a.Object.prototype.toDatalessObject.call(this,h);return m.objects=d,m},render:function(h){this._transformDone=!0,this.callSuper("render",h),this._transformDone=!1},shouldCache:function(){var h=a.Object.prototype.shouldCache.call(this);if(h){for(var d=0,u=this._objects.length;d<u;d++)if(this._objects[d].willDrawShadow())return this.ownCaching=!1,!1}return h},willDrawShadow:function(){if(a.Object.prototype.willDrawShadow.call(this))return!0;for(var h=0,d=this._objects.length;h<d;h++)if(this._objects[h].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(h){for(var d=0,u=this._objects.length;d<u;d++)this._objects[d].render(h);this._drawClipPath(h,this.clipPath)},isCacheDirty:function(h){if(this.callSuper("isCacheDirty",h))return!0;if(!this.statefullCache)return!1;for(var d=0,u=this._objects.length;d<u;d++)if(this._objects[d].isCacheDirty(!0)){if(this._cacheCanvas){var p=this.cacheWidth/this.zoomX,m=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-p/2,-m/2,p,m)}return!0}return!1},_restoreObjectsState:function(){var h=this.calcOwnMatrix();return this._objects.forEach(function(d){a.util.addTransformToObject(d,h),delete d.group,d.setCoords()}),this},destroy:function(){return this._objects.forEach(function(h){h.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(h){h.dispose&&h.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var h=this._objects,d=this.canvas;this._objects=[];var u=this.toObject();delete u.objects;var p=new a.ActiveSelection([]);return p.set(u),p.type="activeSelection",d.remove(this),h.forEach(function(m){m.group=p,m.dirty=!0,d.add(m)}),p.canvas=d,p._objects=h,d._activeObject=p,p.setCoords(),p}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var h=!0;return this.forEachObject(function(d){d.setCoords(h)}),this},_calcBounds:function(h){for(var d=[],u=[],p,m,g,x=["tr","br","bl","tl"],y=0,w=this._objects.length,_,C=x.length;y<w;++y){for(p=this._objects[y],g=p.calcACoords(),_=0;_<C;_++)m=x[_],d.push(g[m].x),u.push(g[m].y);p.aCoords=g}this._getBounds(d,u,h)},_getBounds:function(h,d,u){var p=new a.Point(c(h),c(d)),m=new a.Point(f(h),f(d)),g=p.y||0,x=p.x||0,y=m.x-p.x||0,w=m.y-p.y||0;this.width=y,this.height=w,u||this.setPositionByOrigin({x,y:g},"left","top")},_toSVG:function(h){for(var d=["<g ","COMMON_PARTS",` >
`],u=0,p=this._objects.length;u<p;u++)d.push("		",this._objects[u].toSVG(h));return d.push(`</g>
`),d},getSvgStyles:function(){var h=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",d=this.visible?"":" visibility: hidden;";return[h,this.getSvgFilter(),d].join("")},toClipPathSVG:function(h){for(var d=[],u=0,p=this._objects.length;u<p;u++)d.push("	",this._objects[u].toClipPathSVG(h));return this._createBaseClipPathSVGMarkup(d,{reviver:h})}}),a.Group.fromObject=function(h,d){var u=h.objects,p=a.util.object.clone(h,!0);if(delete p.objects,typeof u=="string"){a.loadSVGFromURL(u,function(m){var g=a.util.groupSVGElements(m,h,u),x=p.clipPath;delete p.clipPath,g.set(p),x?a.util.enlivenObjects([x],function(y){g.clipPath=y[0],d&&d(g)}):d&&d(g)});return}a.util.enlivenObjects(u,function(m){a.util.enlivenObjectEnlivables(h,p,function(){d&&d(new a.Group(m,p,!0))})})})}(e),function(o){var a=o.fabric||(o.fabric={});a.ActiveSelection||(a.ActiveSelection=a.util.createClass(a.Group,{type:"activeSelection",initialize:function(c,f){f=f||{},this._objects=c||[];for(var h=this._objects.length;h--;)this._objects[h].group=this;f.originX&&(this.originX=f.originX),f.originY&&(this.originY=f.originY),this._calcBounds(),this._updateObjectsCoords(),a.Object.prototype.initialize.call(this,f),this.setCoords()},toGroup:function(){var c=this._objects.concat();this._objects=[];var f=a.Object.prototype.toObject.call(this),h=new a.Group([]);if(delete f.type,h.set(f),c.forEach(function(u){u.canvas.remove(u),u.group=h}),h._objects=c,!this.canvas)return h;var d=this.canvas;return d.add(h),d._activeObject=h,h.setCoords(),h},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(c,f,h){c.save(),c.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,h=h||{},typeof h.hasControls>"u"&&(h.hasControls=!1),h.forActiveSelection=!0;for(var d=0,u=this._objects.length;d<u;d++)this._objects[d]._renderControls(c,h);this.callSuper("_renderControls",c,f),c.restore()}}),a.ActiveSelection.fromObject=function(c,f){a.util.enlivenObjects(c.objects,function(h){delete c.objects,f&&f(new a.ActiveSelection(h,c,!0))})})}(e),function(o){var a=t.util.object.extend;if(o.fabric||(o.fabric={}),o.fabric.Image){t.warn("fabric.Image is already defined.");return}t.Image=t.util.createClass(t.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:t.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:t.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(c,f){f||(f={}),this.filters=[],this.cacheKey="texture"+t.Object.__uid++,this.callSuper("initialize",f),this._initElement(c,f)},getElement:function(){return this._element||{}},setElement:function(c,f){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=c,this._originalElement=c,this._initConfig(f),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(c){var f=t.filterBackend;f&&f.evictCachesForKey&&f.evictCachesForKey(c)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((function(c){t.util.cleanUpJsdomNode(this[c]),this[c]=void 0}).bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var c=this.getElement();return{width:c.naturalWidth||c.width,height:c.naturalHeight||c.height}},_stroke:function(c){if(!(!this.stroke||this.strokeWidth===0)){var f=this.width/2,h=this.height/2;c.beginPath(),c.moveTo(-f,-h),c.lineTo(f,-h),c.lineTo(f,h),c.lineTo(-f,h),c.lineTo(-f,-h),c.closePath()}},toObject:function(c){var f=[];this.filters.forEach(function(d){d&&f.push(d.toObject())});var h=a(this.callSuper("toObject",["cropX","cropY"].concat(c)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:f});return this.resizeFilter&&(h.resizeFilter=this.resizeFilter.toObject()),h},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var c=[],f=[],h,d=this._element,u=-this.width/2,p=-this.height/2,m="",g="";if(!d)return[];if(this.hasCrop()){var x=t.Object.__uid++;c.push('<clipPath id="imageCrop_'+x+`">
`,'	<rect x="'+u+'" y="'+p+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),m=' clip-path="url(#imageCrop_'+x+')" '}if(this.imageSmoothing||(g='" image-rendering="optimizeSpeed'),f.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',u-this.cropX,'" y="',p-this.cropY,'" width="',d.width||d.naturalWidth,'" height="',d.height||d.height,g,'"',m,`></image>
`),this.stroke||this.strokeDashArray){var y=this.fill;this.fill=null,h=["	<rect ",'x="',u,'" y="',p,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=y}return this.paintFirst!=="fill"?c=c.concat(h,f):c=c.concat(f,h),c},getSrc:function(c){var f=c?this._element:this._originalElement;return f?f.toDataURL?f.toDataURL():this.srcFromAttribute?f.getAttribute("src"):f.src:this.src||""},setSrc:function(c,f,h){return t.util.loadImage(c,function(d,u){this.setElement(d,h),this._setWidthHeight(),f&&f(this,u)},this,h&&h.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var c=this.resizeFilter,f=this.minimumScaleTrigger,h=this.getTotalObjectScaling(),d=h.scaleX,u=h.scaleY,p=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!c||d>f&&u>f){this._element=p,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=d,this._lastScaleY=u;return}t.filterBackend||(t.filterBackend=t.initFilterBackend());var m=t.util.createCanvasElement(),g=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,x=p.width,y=p.height;m.width=x,m.height=y,this._element=m,this._lastScaleX=c.scaleX=d,this._lastScaleY=c.scaleY=u,t.filterBackend.applyFilters([c],p,x,y,this._element,g),this._filterScalingX=m.width/this._originalElement.width,this._filterScalingY=m.height/this._originalElement.height},applyFilters:function(c){if(c=c||this.filters||[],c=c.filter(function(p){return p&&!p.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),c.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var f=this._originalElement,h=f.naturalWidth||f.width,d=f.naturalHeight||f.height;if(this._element===this._originalElement){var u=t.util.createCanvasElement();u.width=h,u.height=d,this._element=u,this._filteredEl=u}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,h,d),this._lastScaleX=1,this._lastScaleY=1;return t.filterBackend||(t.filterBackend=t.initFilterBackend()),t.filterBackend.applyFilters(c,this._originalElement,h,d,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(c){t.util.setImageSmoothing(c,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(c),this._renderPaintInOrder(c)},drawCacheOnCanvas:function(c){t.util.setImageSmoothing(c,this.imageSmoothing),t.Object.prototype.drawCacheOnCanvas.call(this,c)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(c){var f=this._element;if(f){var h=this._filterScalingX,d=this._filterScalingY,u=this.width,p=this.height,m=Math.min,g=Math.max,x=g(this.cropX,0),y=g(this.cropY,0),w=f.naturalWidth||f.width,_=f.naturalHeight||f.height,C=x*h,E=y*d,T=m(u*h,w-C),A=m(p*d,_-E),j=-u/2,B=-p/2,F=m(u,w/h-x),L=m(p,_/d-y);f&&c.drawImage(f,C,E,T,A,j,B,F,L)}},_needsResize:function(){var c=this.getTotalObjectScaling();return c.scaleX!==this._lastScaleX||c.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(c,f){this.setElement(t.util.getById(c),f),t.util.addClass(this.getElement(),t.Image.CSS_CANVAS)},_initConfig:function(c){c||(c={}),this.setOptions(c),this._setWidthHeight(c)},_initFilters:function(c,f){c&&c.length?t.util.enlivenObjects(c,function(h){f&&f(h)},"fabric.Image.filters"):f&&f()},_setWidthHeight:function(c){c||(c={});var f=this.getElement();this.width=c.width||f.naturalWidth||f.width||0,this.height=c.height||f.naturalHeight||f.height||0},parsePreserveAspectRatioAttribute:function(){var c=t.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),f=this._element.width,h=this._element.height,d=1,u=1,p=0,m=0,g=0,x=0,y,w=this.width,_=this.height,C={width:w,height:_};return c&&(c.alignX!=="none"||c.alignY!=="none")?(c.meetOrSlice==="meet"&&(d=u=t.util.findScaleToFit(this._element,C),y=(w-f*d)/2,c.alignX==="Min"&&(p=-y),c.alignX==="Max"&&(p=y),y=(_-h*u)/2,c.alignY==="Min"&&(m=-y),c.alignY==="Max"&&(m=y)),c.meetOrSlice==="slice"&&(d=u=t.util.findScaleToCover(this._element,C),y=f-w/d,c.alignX==="Mid"&&(g=y/2),c.alignX==="Max"&&(g=y),y=h-_/u,c.alignY==="Mid"&&(x=y/2),c.alignY==="Max"&&(x=y),f=w/d,h=_/u)):(d=w/f,u=_/h),{width:f,height:h,scaleX:d,scaleY:u,offsetLeft:p,offsetTop:m,cropX:g,cropY:x}}}),t.Image.CSS_CANVAS="canvas-img",t.Image.prototype.getSvgSrc=t.Image.prototype.getSrc,t.Image.fromObject=function(c,f){var h=t.util.object.clone(c);t.util.loadImage(h.src,function(d,u){if(u){f&&f(null,!0);return}t.Image.prototype._initFilters.call(h,h.filters,function(p){h.filters=p||[],t.Image.prototype._initFilters.call(h,[h.resizeFilter],function(m){h.resizeFilter=m[0],t.util.enlivenObjectEnlivables(h,h,function(){var g=new t.Image(d,h);f(g,!1)})})})},null,h.crossOrigin)},t.Image.fromURL=function(c,f,h){t.util.loadImage(c,function(d,u){f&&f(new t.Image(d,h),u)},null,h&&h.crossOrigin)},t.Image.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),t.Image.fromElement=function(c,f,h){var d=t.parseAttributes(c,t.Image.ATTRIBUTE_NAMES);t.Image.fromURL(d["xlink:href"],f,a(h?t.util.object.clone(h):{},d))}}(e),t.util.object.extend(t.Object.prototype,{_getAngleValueForStraighten:function(){var o=this.angle%360;return o>0?Math.round((o-1)/90)*90:Math.round(o/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(o){o=o||{};var a=function(){},c=o.onComplete||a,f=o.onChange||a,h=this;return t.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(d){h.rotate(d),f()},onComplete:function(){h.setCoords(),c()}})}}),t.util.object.extend(t.StaticCanvas.prototype,{straightenObject:function(o){return o.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(o){return o.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function o(c,f){var h="precision "+f+` float;
void main(){}`,d=c.createShader(c.FRAGMENT_SHADER);return c.shaderSource(d,h),c.compileShader(d),!!c.getShaderParameter(d,c.COMPILE_STATUS)}t.isWebglSupported=function(c){if(t.isLikelyNode)return!1;c=c||t.WebglFilterBackend.prototype.tileSize;var f=document.createElement("canvas"),h=f.getContext("webgl")||f.getContext("experimental-webgl"),d=!1;if(h){t.maxTextureSize=h.getParameter(h.MAX_TEXTURE_SIZE),d=t.maxTextureSize>=c;for(var u=["highp","mediump","lowp"],p=0;p<3;p++)if(o(h,u[p])){t.webGlPrecision=u[p];break}}return this.isSupported=d,d},t.WebglFilterBackend=a;function a(c){c&&c.tileSize&&(this.tileSize=c.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}a.prototype={tileSize:2048,resources:{},setupGLContext:function(c,f){this.dispose(),this.createWebGLCanvas(c,f),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(c,f)},chooseFastestCopyGLTo2DMethod:function(c,f){var h=typeof window.performance<"u",d;try{new ImageData(1,1),d=!0}catch{d=!1}var u=typeof ArrayBuffer<"u",p=typeof Uint8ClampedArray<"u";if(h&&d&&u&&p){var m=t.util.createCanvasElement(),g=new ArrayBuffer(c*f*4);if(t.forceGLPutImageData){this.imageBuffer=g,this.copyGLTo2D=l;return}var x={imageBuffer:g,destinationWidth:c,destinationHeight:f,targetCanvas:m},y,w,_;m.width=c,m.height=f,y=window.performance.now(),s.call(x,this.gl,x),w=window.performance.now()-y,y=window.performance.now(),l.call(x,this.gl,x),_=window.performance.now()-y,w>_?(this.imageBuffer=g,this.copyGLTo2D=l):this.copyGLTo2D=s}},createWebGLCanvas:function(c,f){var h=t.util.createCanvasElement();h.width=c,h.height=f;var d={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},u=h.getContext("webgl",d);u||(u=h.getContext("experimental-webgl",d)),u&&(u.clearColor(0,0,0,0),this.canvas=h,this.gl=u)},applyFilters:function(c,f,h,d,u,p){var m=this.gl,g;p&&(g=this.getCachedTexture(p,f));var x={originalWidth:f.width||f.originalWidth,originalHeight:f.height||f.originalHeight,sourceWidth:h,sourceHeight:d,destinationWidth:h,destinationHeight:d,context:m,sourceTexture:this.createTexture(m,h,d,!g&&f),targetTexture:this.createTexture(m,h,d),originalTexture:g||this.createTexture(m,h,d,!g&&f),passes:c.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:u},y=m.createFramebuffer();return m.bindFramebuffer(m.FRAMEBUFFER,y),c.forEach(function(w){w&&w.applyTo(x)}),i(x),this.copyGLTo2D(m,x),m.bindTexture(m.TEXTURE_2D,null),m.deleteTexture(x.sourceTexture),m.deleteTexture(x.targetTexture),m.deleteFramebuffer(y),u.getContext("2d").setTransform(1,0,0,1,0,0),x},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(c,f,h,d,u){var p=c.createTexture();return c.bindTexture(c.TEXTURE_2D,p),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,u||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,u||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),d?c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,d):c.texImage2D(c.TEXTURE_2D,0,c.RGBA,f,h,0,c.RGBA,c.UNSIGNED_BYTE,null),p},getCachedTexture:function(c,f){if(this.textureCache[c])return this.textureCache[c];var h=this.createTexture(this.gl,f.width,f.height,f);return this.textureCache[c]=h,h},evictCachesForKey:function(c){this.textureCache[c]&&(this.gl.deleteTexture(this.textureCache[c]),delete this.textureCache[c])},copyGLTo2D:s,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var c=this.gl,f={renderer:"",vendor:""};if(!c)return f;var h=c.getExtension("WEBGL_debug_renderer_info");if(h){var d=c.getParameter(h.UNMASKED_RENDERER_WEBGL),u=c.getParameter(h.UNMASKED_VENDOR_WEBGL);d&&(f.renderer=d.toLowerCase()),u&&(f.vendor=u.toLowerCase())}return this.gpuInfo=f,f}}}();function i(o){var a=o.targetCanvas,c=a.width,f=a.height,h=o.destinationWidth,d=o.destinationHeight;(c!==h||f!==d)&&(a.width=h,a.height=d)}function s(o,a){var c=o.canvas,f=a.targetCanvas,h=f.getContext("2d");h.translate(0,f.height),h.scale(1,-1);var d=c.height-f.height;h.drawImage(c,0,d,f.width,f.height,0,0,f.width,f.height)}function l(o,a){var c=a.targetCanvas,f=c.getContext("2d"),h=a.destinationWidth,d=a.destinationHeight,u=h*d*4,p=new Uint8Array(this.imageBuffer,0,u),m=new Uint8ClampedArray(this.imageBuffer,0,u);o.readPixels(0,0,h,d,o.RGBA,o.UNSIGNED_BYTE,p);var g=new ImageData(m,h,d);f.putImageData(g,0,0)}(function(){var o=function(){};t.Canvas2dFilterBackend=a;function a(){}a.prototype={evictCachesForKey:o,dispose:o,clearWebGLCaches:o,resources:{},applyFilters:function(c,f,h,d,u){var p=u.getContext("2d");p.drawImage(f,0,0,h,d);var m=p.getImageData(0,0,h,d),g=p.getImageData(0,0,h,d),x={sourceWidth:h,sourceHeight:d,imageData:m,originalEl:f,originalImageData:g,canvasEl:u,ctx:p,filterBackend:this};return c.forEach(function(y){y.applyTo(x)}),(x.imageData.width!==h||x.imageData.height!==d)&&(u.width=x.imageData.width,u.height=x.imageData.height),p.putImageData(x.imageData,0,0),x}}})(),t.Image=t.Image||{},t.Image.filters=t.Image.filters||{},t.Image.filters.BaseFilter=t.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(o){o&&this.setOptions(o)},setOptions:function(o){for(var a in o)this[a]=o[a]},createProgram:function(o,a,c){a=a||this.fragmentSource,c=c||this.vertexSource,t.webGlPrecision!=="highp"&&(a=a.replace(/precision highp float/g,"precision "+t.webGlPrecision+" float"));var f=o.createShader(o.VERTEX_SHADER);if(o.shaderSource(f,c),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+o.getShaderInfoLog(f));var h=o.createShader(o.FRAGMENT_SHADER);if(o.shaderSource(h,a),o.compileShader(h),!o.getShaderParameter(h,o.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+o.getShaderInfoLog(h));var d=o.createProgram();if(o.attachShader(d,f),o.attachShader(d,h),o.linkProgram(d),!o.getProgramParameter(d,o.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+o.getProgramInfoLog(d));var u=this.getAttributeLocations(o,d),p=this.getUniformLocations(o,d)||{};return p.uStepW=o.getUniformLocation(d,"uStepW"),p.uStepH=o.getUniformLocation(d,"uStepH"),{program:d,attributeLocations:u,uniformLocations:p}},getAttributeLocations:function(o,a){return{aPosition:o.getAttribLocation(a,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(o,a,c){var f=a.aPosition,h=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,h),o.enableVertexAttribArray(f),o.vertexAttribPointer(f,2,o.FLOAT,!1,0,0),o.bufferData(o.ARRAY_BUFFER,c,o.STATIC_DRAW)},_setupFrameBuffer:function(o){var a=o.context,c,f;o.passes>1?(c=o.destinationWidth,f=o.destinationHeight,(o.sourceWidth!==c||o.sourceHeight!==f)&&(a.deleteTexture(o.targetTexture),o.targetTexture=o.filterBackend.createTexture(a,c,f)),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,o.targetTexture,0)):(a.bindFramebuffer(a.FRAMEBUFFER,null),a.finish())},_swapTextures:function(o){o.passes--,o.pass++;var a=o.targetTexture;o.targetTexture=o.sourceTexture,o.sourceTexture=a},isNeutralState:function(){var o=this.mainParameter,a=t.Image.filters[this.type].prototype;if(o)if(Array.isArray(a[o])){for(var c=a[o].length;c--;)if(this[o][c]!==a[o][c])return!1;return!0}else return a[o]===this[o];else return!1},applyTo:function(o){o.webgl?(this._setupFrameBuffer(o),this.applyToWebGL(o),this._swapTextures(o)):this.applyTo2d(o)},retrieveShader:function(o){return o.programCache.hasOwnProperty(this.type)||(o.programCache[this.type]=this.createProgram(o.context)),o.programCache[this.type]},applyToWebGL:function(o){var a=o.context,c=this.retrieveShader(o);o.pass===0&&o.originalTexture?a.bindTexture(a.TEXTURE_2D,o.originalTexture):a.bindTexture(a.TEXTURE_2D,o.sourceTexture),a.useProgram(c.program),this.sendAttributeData(a,c.attributeLocations,o.aPosition),a.uniform1f(c.uniformLocations.uStepW,1/o.sourceWidth),a.uniform1f(c.uniformLocations.uStepH,1/o.sourceHeight),this.sendUniformData(a,c.uniformLocations),a.viewport(0,0,o.destinationWidth,o.destinationHeight),a.drawArrays(a.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(o,a,c){o.activeTexture(c),o.bindTexture(o.TEXTURE_2D,a),o.activeTexture(o.TEXTURE0)},unbindAdditionalTexture:function(o,a){o.activeTexture(a),o.bindTexture(o.TEXTURE_2D,null),o.activeTexture(o.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(o){this[this.mainParameter]=o},sendUniformData:function(){},createHelpLayer:function(o){if(!o.helpLayer){var a=document.createElement("canvas");a.width=o.sourceWidth,a.height=o.sourceHeight,o.helpLayer=a}},toObject:function(){var o={type:this.type},a=this.mainParameter;return a&&(o[a]=this[a]),o},toJSON:function(){return this.toObject()}}),t.Image.filters.BaseFilter.fromObject=function(o,a){var c=new t.Image.filters[o.type](o);return a&&a(c),c},function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.ColorMatrix=f(c.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(h){this.callSuper("initialize",h),this.matrix=this.matrix.slice(0)},applyTo2d:function(h){var d=h.imageData,u=d.data,p=u.length,m=this.matrix,g,x,y,w,_,C=this.colorsOnly;for(_=0;_<p;_+=4)g=u[_],x=u[_+1],y=u[_+2],C?(u[_]=g*m[0]+x*m[1]+y*m[2]+m[4]*255,u[_+1]=g*m[5]+x*m[6]+y*m[7]+m[9]*255,u[_+2]=g*m[10]+x*m[11]+y*m[12]+m[14]*255):(w=u[_+3],u[_]=g*m[0]+x*m[1]+y*m[2]+w*m[3]+m[4]*255,u[_+1]=g*m[5]+x*m[6]+y*m[7]+w*m[8]+m[9]*255,u[_+2]=g*m[10]+x*m[11]+y*m[12]+w*m[13]+m[14]*255,u[_+3]=g*m[15]+x*m[16]+y*m[17]+w*m[18]+m[19]*255)},getUniformLocations:function(h,d){return{uColorMatrix:h.getUniformLocation(d,"uColorMatrix"),uConstants:h.getUniformLocation(d,"uConstants")}},sendUniformData:function(h,d){var u=this.matrix,p=[u[0],u[1],u[2],u[3],u[5],u[6],u[7],u[8],u[10],u[11],u[12],u[13],u[15],u[16],u[17],u[18]],m=[u[4],u[9],u[14],u[19]];h.uniformMatrix4fv(d.uColorMatrix,!1,p),h.uniform4fv(d.uConstants,m)}}),a.Image.filters.ColorMatrix.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Brightness=f(c.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(h){if(this.brightness!==0){var d=h.imageData,u=d.data,p,m=u.length,g=Math.round(this.brightness*255);for(p=0;p<m;p+=4)u[p]=u[p]+g,u[p+1]=u[p+1]+g,u[p+2]=u[p+2]+g}},getUniformLocations:function(h,d){return{uBrightness:h.getUniformLocation(d,"uBrightness")}},sendUniformData:function(h,d){h.uniform1f(d.uBrightness,this.brightness)}}),a.Image.filters.Brightness.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,f=a.Image.filters,h=a.util.createClass;f.Convolute=h(f.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(d){var u=Math.sqrt(this.matrix.length),p=this.type+"_"+u+"_"+(this.opaque?1:0),m=this.fragmentSource[p];return d.programCache.hasOwnProperty(p)||(d.programCache[p]=this.createProgram(d.context,m)),d.programCache[p]},applyTo2d:function(d){var u=d.imageData,p=u.data,m=this.matrix,g=Math.round(Math.sqrt(m.length)),x=Math.floor(g/2),y=u.width,w=u.height,_=d.ctx.createImageData(y,w),C=_.data,E=this.opaque?1:0,T,A,j,B,F,L,G,X,re,Q,ne,J,P;for(ne=0;ne<w;ne++)for(Q=0;Q<y;Q++){for(F=(ne*y+Q)*4,T=0,A=0,j=0,B=0,P=0;P<g;P++)for(J=0;J<g;J++)G=ne+P-x,L=Q+J-x,!(G<0||G>=w||L<0||L>=y)&&(X=(G*y+L)*4,re=m[P*g+J],T+=p[X]*re,A+=p[X+1]*re,j+=p[X+2]*re,E||(B+=p[X+3]*re));C[F]=T,C[F+1]=A,C[F+2]=j,E?C[F+3]=p[F+3]:C[F+3]=B}d.imageData=_},getUniformLocations:function(d,u){return{uMatrix:d.getUniformLocation(u,"uMatrix"),uOpaque:d.getUniformLocation(u,"uOpaque"),uHalfSize:d.getUniformLocation(u,"uHalfSize"),uSize:d.getUniformLocation(u,"uSize")}},sendUniformData:function(d,u){d.uniform1fv(u.uMatrix,this.matrix)},toObject:function(){return c(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),a.Image.filters.Convolute.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Grayscale=f(c.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(h){var d=h.imageData,u=d.data,p,m=u.length,g,x=this.mode;for(p=0;p<m;p+=4)x==="average"?g=(u[p]+u[p+1]+u[p+2])/3:x==="lightness"?g=(Math.min(u[p],u[p+1],u[p+2])+Math.max(u[p],u[p+1],u[p+2]))/2:x==="luminosity"&&(g=.21*u[p]+.72*u[p+1]+.07*u[p+2]),u[p]=g,u[p+1]=g,u[p+2]=g},retrieveShader:function(h){var d=this.type+"_"+this.mode;if(!h.programCache.hasOwnProperty(d)){var u=this.fragmentSource[this.mode];h.programCache[d]=this.createProgram(h.context,u)}return h.programCache[d]},getUniformLocations:function(h,d){return{uMode:h.getUniformLocation(d,"uMode")}},sendUniformData:function(h,d){var u=1;h.uniform1i(d.uMode,u)},isNeutralState:function(){return!1}}),a.Image.filters.Grayscale.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Invert=f(c.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(h){var d=h.imageData,u=d.data,p,m=u.length;for(p=0;p<m;p+=4)u[p]=255-u[p],u[p+1]=255-u[p+1],u[p+2]=255-u[p+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(h,d){return{uInvert:h.getUniformLocation(d,"uInvert")}},sendUniformData:function(h,d){h.uniform1i(d.uInvert,this.invert)}}),a.Image.filters.Invert.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,f=a.Image.filters,h=a.util.createClass;f.Noise=h(f.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(d){if(this.noise!==0){var u=d.imageData,p=u.data,m,g=p.length,x=this.noise,y;for(m=0,g=p.length;m<g;m+=4)y=(.5-Math.random())*x,p[m]+=y,p[m+1]+=y,p[m+2]+=y}},getUniformLocations:function(d,u){return{uNoise:d.getUniformLocation(u,"uNoise"),uSeed:d.getUniformLocation(u,"uSeed")}},sendUniformData:function(d,u){d.uniform1f(u.uNoise,this.noise/255),d.uniform1f(u.uSeed,Math.random())},toObject:function(){return c(this.callSuper("toObject"),{noise:this.noise})}}),a.Image.filters.Noise.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Pixelate=f(c.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(h){var d=h.imageData,u=d.data,p=d.height,m=d.width,g,x,y,w,_,C,E,T,A,j,B;for(x=0;x<p;x+=this.blocksize)for(y=0;y<m;y+=this.blocksize)for(g=x*4*m+y*4,w=u[g],_=u[g+1],C=u[g+2],E=u[g+3],j=Math.min(x+this.blocksize,p),B=Math.min(y+this.blocksize,m),T=x;T<j;T++)for(A=y;A<B;A++)g=T*4*m+A*4,u[g]=w,u[g+1]=_,u[g+2]=C,u[g+3]=E},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(h,d){return{uBlocksize:h.getUniformLocation(d,"uBlocksize"),uStepW:h.getUniformLocation(d,"uStepW"),uStepH:h.getUniformLocation(d,"uStepH")}},sendUniformData:function(h,d){h.uniform1f(d.uBlocksize,this.blocksize)}}),a.Image.filters.Pixelate.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.extend,f=a.Image.filters,h=a.util.createClass;f.RemoveColor=h(f.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(d){var u=d.imageData,p=u.data,m,g=this.distance*255,x,y,w,_=new a.Color(this.color).getSource(),C=[_[0]-g,_[1]-g,_[2]-g],E=[_[0]+g,_[1]+g,_[2]+g];for(m=0;m<p.length;m+=4)x=p[m],y=p[m+1],w=p[m+2],x>C[0]&&y>C[1]&&w>C[2]&&x<E[0]&&y<E[1]&&w<E[2]&&(p[m+3]=0)},getUniformLocations:function(d,u){return{uLow:d.getUniformLocation(u,"uLow"),uHigh:d.getUniformLocation(u,"uHigh")}},sendUniformData:function(d,u){var p=new a.Color(this.color).getSource(),m=parseFloat(this.distance),g=[0+p[0]/255-m,0+p[1]/255-m,0+p[2]/255-m,1],x=[p[0]/255+m,p[1]/255+m,p[2]/255+m,1];d.uniform4fv(u.uLow,g),d.uniform4fv(u.uHigh,x)},toObject:function(){return c(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),a.Image.filters.RemoveColor.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass,h={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var d in h)c[d]=f(c.ColorMatrix,{type:d,matrix:h[d],mainParameter:!1,colorsOnly:!0}),a.Image.filters[d].fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric,c=a.Image.filters,f=a.util.createClass;c.BlendColor=f(c.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(h){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[h]+`}
}`},retrieveShader:function(h){var d=this.type+"_"+this.mode,u;return h.programCache.hasOwnProperty(d)||(u=this.buildSource(this.mode),h.programCache[d]=this.createProgram(h.context,u)),h.programCache[d]},applyTo2d:function(h){var d=h.imageData,u=d.data,p=u.length,m,g,x,y,w,_,C,E=1-this.alpha;C=new a.Color(this.color).getSource(),m=C[0]*this.alpha,g=C[1]*this.alpha,x=C[2]*this.alpha;for(var T=0;T<p;T+=4)switch(y=u[T],w=u[T+1],_=u[T+2],this.mode){case"multiply":u[T]=y*m/255,u[T+1]=w*g/255,u[T+2]=_*x/255;break;case"screen":u[T]=255-(255-y)*(255-m)/255,u[T+1]=255-(255-w)*(255-g)/255,u[T+2]=255-(255-_)*(255-x)/255;break;case"add":u[T]=y+m,u[T+1]=w+g,u[T+2]=_+x;break;case"diff":case"difference":u[T]=Math.abs(y-m),u[T+1]=Math.abs(w-g),u[T+2]=Math.abs(_-x);break;case"subtract":u[T]=y-m,u[T+1]=w-g,u[T+2]=_-x;break;case"darken":u[T]=Math.min(y,m),u[T+1]=Math.min(w,g),u[T+2]=Math.min(_,x);break;case"lighten":u[T]=Math.max(y,m),u[T+1]=Math.max(w,g),u[T+2]=Math.max(_,x);break;case"overlay":u[T]=m<128?2*y*m/255:255-2*(255-y)*(255-m)/255,u[T+1]=g<128?2*w*g/255:255-2*(255-w)*(255-g)/255,u[T+2]=x<128?2*_*x/255:255-2*(255-_)*(255-x)/255;break;case"exclusion":u[T]=m+y-2*m*y/255,u[T+1]=g+w-2*g*w/255,u[T+2]=x+_-2*x*_/255;break;case"tint":u[T]=m+y*E,u[T+1]=g+w*E,u[T+2]=x+_*E}},getUniformLocations:function(h,d){return{uColor:h.getUniformLocation(d,"uColor")}},sendUniformData:function(h,d){var u=new a.Color(this.color).getSource();u[0]=this.alpha*u[0]/255,u[1]=this.alpha*u[1]/255,u[2]=this.alpha*u[2]/255,u[3]=this.alpha,h.uniform4fv(d.uColor,u)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),a.Image.filters.BlendColor.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric,c=a.Image.filters,f=a.util.createClass;c.BlendImage=f(c.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(h){var d=this.type+"_"+this.mode,u=this.fragmentSource[this.mode];return h.programCache.hasOwnProperty(d)||(h.programCache[d]=this.createProgram(h.context,u)),h.programCache[d]},applyToWebGL:function(h){var d=h.context,u=this.createTexture(h.filterBackend,this.image);this.bindAdditionalTexture(d,u,d.TEXTURE1),this.callSuper("applyToWebGL",h),this.unbindAdditionalTexture(d,d.TEXTURE1)},createTexture:function(h,d){return h.getCachedTexture(d.cacheKey,d._element)},calculateMatrix:function(){var h=this.image,d=h._element.width,u=h._element.height;return[1/h.scaleX,0,0,0,1/h.scaleY,0,-h.left/d,-h.top/u,1]},applyTo2d:function(h){var d=h.imageData,u=h.filterBackend.resources,p=d.data,m=p.length,g=d.width,x=d.height,y,w,_,C,E,T,A,j,B,F,L=this.image,G;u.blendImage||(u.blendImage=a.util.createCanvasElement()),B=u.blendImage,F=B.getContext("2d"),B.width!==g||B.height!==x?(B.width=g,B.height=x):F.clearRect(0,0,g,x),F.setTransform(L.scaleX,0,0,L.scaleY,L.left,L.top),F.drawImage(L._element,0,0,g,x),G=F.getImageData(0,0,g,x).data;for(var X=0;X<m;X+=4)switch(E=p[X],T=p[X+1],A=p[X+2],j=p[X+3],y=G[X],w=G[X+1],_=G[X+2],C=G[X+3],this.mode){case"multiply":p[X]=E*y/255,p[X+1]=T*w/255,p[X+2]=A*_/255,p[X+3]=j*C/255;break;case"mask":p[X+3]=C;break}},getUniformLocations:function(h,d){return{uTransformMatrix:h.getUniformLocation(d,"uTransformMatrix"),uImage:h.getUniformLocation(d,"uImage")}},sendUniformData:function(h,d){var u=this.calculateMatrix();h.uniform1i(d.uImage,1),h.uniformMatrix3fv(d.uTransformMatrix,!1,u)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),a.Image.filters.BlendImage.fromObject=function(h,d){a.Image.fromObject(h.image,function(u){var p=a.util.object.clone(h);p.image=u,d(new a.Image.filters.BlendImage(p))})}}(e),function(o){var a=o.fabric||(o.fabric={}),c=Math.pow,f=Math.floor,h=Math.sqrt,d=Math.abs,u=Math.round,p=Math.sin,m=Math.ceil,g=a.Image.filters,x=a.util.createClass;g.Resize=x(g.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(y,w){return{uDelta:y.getUniformLocation(w,"uDelta"),uTaps:y.getUniformLocation(w,"uTaps")}},sendUniformData:function(y,w){y.uniform2fv(w.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),y.uniform1fv(w.uTaps,this.taps)},retrieveShader:function(y){var w=this.getFilterWindow(),_=this.type+"_"+w;if(!y.programCache.hasOwnProperty(_)){var C=this.generateShader(w);y.programCache[_]=this.createProgram(y.context,C)}return y.programCache[_]},getFilterWindow:function(){var y=this.tempScale;return Math.ceil(this.lanczosLobes/y)},getTaps:function(){for(var y=this.lanczosCreate(this.lanczosLobes),w=this.tempScale,_=this.getFilterWindow(),C=new Array(_),E=1;E<=_;E++)C[E-1]=y(E*w);return C},generateShader:function(C){for(var w=new Array(C),_=this.fragmentSourceTOP,C,E=1;E<=C;E++)w[E-1]=E+".0 * uDelta";return _+="uniform float uTaps["+C+`];
`,_+=`void main() {
`,_+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,_+=`  float sum = 1.0;
`,w.forEach(function(T,A){_+="  color += texture2D(uTexture, vTexCoord + "+T+") * uTaps["+A+`];
`,_+="  color += texture2D(uTexture, vTexCoord - "+T+") * uTaps["+A+`];
`,_+="  sum += 2.0 * uTaps["+A+`];
`}),_+=`  gl_FragColor = color / sum;
`,_+="}",_},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(y){y.webgl?(y.passes++,this.width=y.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=y.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),y.destinationWidth=this.dW,this._setupFrameBuffer(y),this.applyToWebGL(y),this._swapTextures(y),y.sourceWidth=y.destinationWidth,this.height=y.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),y.destinationHeight=this.dH,this._setupFrameBuffer(y),this.applyToWebGL(y),this._swapTextures(y),y.sourceHeight=y.destinationHeight):this.applyTo2d(y)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(y){return function(w){if(w>=y||w<=-y)return 0;if(w<11920929e-14&&w>-11920929e-14)return 1;w*=Math.PI;var _=w/y;return p(w)/w*p(_)/_}},applyTo2d:function(y){var w=y.imageData,_=this.scaleX,C=this.scaleY;this.rcpScaleX=1/_,this.rcpScaleY=1/C;var E=w.width,T=w.height,A=u(E*_),j=u(T*C),B;this.resizeType==="sliceHack"?B=this.sliceByTwo(y,E,T,A,j):this.resizeType==="hermite"?B=this.hermiteFastResize(y,E,T,A,j):this.resizeType==="bilinear"?B=this.bilinearFiltering(y,E,T,A,j):this.resizeType==="lanczos"&&(B=this.lanczosResize(y,E,T,A,j)),y.imageData=B},sliceByTwo:function(y,w,_,C,E){var T=y.imageData,A=.5,j=!1,B=!1,F=w*A,L=_*A,G=a.filterBackend.resources,X,re,Q=0,ne=0,J=w,P=0;for(G.sliceByTwo||(G.sliceByTwo=document.createElement("canvas")),X=G.sliceByTwo,(X.width<w*1.5||X.height<_)&&(X.width=w*1.5,X.height=_),re=X.getContext("2d"),re.clearRect(0,0,w*1.5,_),re.putImageData(T,0,0),C=f(C),E=f(E);!j||!B;)w=F,_=L,C<f(F*A)?F=f(F*A):(F=C,j=!0),E<f(L*A)?L=f(L*A):(L=E,B=!0),re.drawImage(X,Q,ne,w,_,J,P,F,L),Q=J,ne=P,P+=L;return re.getImageData(Q,ne,C,E)},lanczosResize:function(y,w,_,C,E){function T(U){var S,I,O,N,R,z,K,Y,Z,se,V;for(P.x=(U+.5)*L,H.x=f(P.x),S=0;S<E;S++){for(P.y=(S+.5)*G,H.y=f(P.y),R=0,z=0,K=0,Y=0,Z=0,I=H.x-Q;I<=H.x+Q;I++)if(!(I<0||I>=w)){se=f(1e3*d(I-P.x)),J[se]||(J[se]={});for(var le=H.y-ne;le<=H.y+ne;le++)le<0||le>=_||(V=f(1e3*d(le-P.y)),J[se][V]||(J[se][V]=F(h(c(se*X,2)+c(V*re,2))/1e3)),O=J[se][V],O>0&&(N=(le*w+I)*4,R+=O,z+=O*A[N],K+=O*A[N+1],Y+=O*A[N+2],Z+=O*A[N+3]))}N=(S*C+U)*4,B[N]=z/R,B[N+1]=K/R,B[N+2]=Y/R,B[N+3]=Z/R}return++U<C?T(U):j}var A=y.imageData.data,j=y.ctx.createImageData(C,E),B=j.data,F=this.lanczosCreate(this.lanczosLobes),L=this.rcpScaleX,G=this.rcpScaleY,X=2/this.rcpScaleX,re=2/this.rcpScaleY,Q=m(L*this.lanczosLobes/2),ne=m(G*this.lanczosLobes/2),J={},P={},H={};return T(0)},bilinearFiltering:function(y,w,_,C,E){var T,A,j,B,F,L,G,X,re,Q,ne,J,P=0,H,U=this.rcpScaleX,S=this.rcpScaleY,I=4*(w-1),O=y.imageData,N=O.data,R=y.ctx.createImageData(C,E),z=R.data;for(G=0;G<E;G++)for(X=0;X<C;X++)for(F=f(U*X),L=f(S*G),re=U*X-F,Q=S*G-L,H=4*(L*w+F),ne=0;ne<4;ne++)T=N[H+ne],A=N[H+4+ne],j=N[H+I+ne],B=N[H+I+4+ne],J=T*(1-re)*(1-Q)+A*re*(1-Q)+j*Q*(1-re)+B*re*Q,z[P++]=J;return R},hermiteFastResize:function(y,w,_,C,E){for(var T=this.rcpScaleX,A=this.rcpScaleY,j=m(T/2),B=m(A/2),F=y.imageData,L=F.data,G=y.ctx.createImageData(C,E),X=G.data,re=0;re<E;re++)for(var Q=0;Q<C;Q++){for(var ne=(Q+re*C)*4,J=0,P=0,H=0,U=0,S=0,I=0,O=0,N=(re+.5)*A,R=f(re*A);R<(re+1)*A;R++)for(var z=d(N-(R+.5))/B,K=(Q+.5)*T,Y=z*z,Z=f(Q*T);Z<(Q+1)*T;Z++){var se=d(K-(Z+.5))/j,V=h(Y+se*se);V>1&&V<-1||(J=2*V*V*V-3*V*V+1,J>0&&(se=4*(Z+R*w),O+=J*L[se+3],H+=J,L[se+3]<255&&(J=J*L[se+3]/250),U+=J*L[se],S+=J*L[se+1],I+=J*L[se+2],P+=J))}X[ne]=U/P,X[ne+1]=S/P,X[ne+2]=I/P,X[ne+3]=O/H}return G},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),a.Image.filters.Resize.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Contrast=f(c.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(h){if(this.contrast!==0){var d=h.imageData,u,m,p=d.data,m=p.length,g=Math.floor(this.contrast*255),x=259*(g+255)/(255*(259-g));for(u=0;u<m;u+=4)p[u]=x*(p[u]-128)+128,p[u+1]=x*(p[u+1]-128)+128,p[u+2]=x*(p[u+2]-128)+128}},getUniformLocations:function(h,d){return{uContrast:h.getUniformLocation(d,"uContrast")}},sendUniformData:function(h,d){h.uniform1f(d.uContrast,this.contrast)}}),a.Image.filters.Contrast.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Saturation=f(c.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(h){if(this.saturation!==0){var d=h.imageData,u=d.data,p=u.length,m=-this.saturation,g,x;for(g=0;g<p;g+=4)x=Math.max(u[g],u[g+1],u[g+2]),u[g]+=x!==u[g]?(x-u[g])*m:0,u[g+1]+=x!==u[g+1]?(x-u[g+1])*m:0,u[g+2]+=x!==u[g+2]?(x-u[g+2])*m:0}},getUniformLocations:function(h,d){return{uSaturation:h.getUniformLocation(d,"uSaturation")}},sendUniformData:function(h,d){h.uniform1f(d.uSaturation,-this.saturation)}}),a.Image.filters.Saturation.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Vibrance=f(c.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(h){if(this.vibrance!==0){var d=h.imageData,u=d.data,p=u.length,m=-this.vibrance,g,x,y,w;for(g=0;g<p;g+=4)x=Math.max(u[g],u[g+1],u[g+2]),y=(u[g]+u[g+1]+u[g+2])/3,w=Math.abs(x-y)*2/255*m,u[g]+=x!==u[g]?(x-u[g])*w:0,u[g+1]+=x!==u[g+1]?(x-u[g+1])*w:0,u[g+2]+=x!==u[g+2]?(x-u[g+2])*w:0}},getUniformLocations:function(h,d){return{uVibrance:h.getUniformLocation(d,"uVibrance")}},sendUniformData:function(h,d){h.uniform1f(d.uVibrance,-this.vibrance)}}),a.Image.filters.Vibrance.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Blur=f(c.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(h){h.webgl?(this.aspectRatio=h.sourceWidth/h.sourceHeight,h.passes++,this._setupFrameBuffer(h),this.horizontal=!0,this.applyToWebGL(h),this._swapTextures(h),this._setupFrameBuffer(h),this.horizontal=!1,this.applyToWebGL(h),this._swapTextures(h)):this.applyTo2d(h)},applyTo2d:function(h){h.imageData=this.simpleBlur(h)},simpleBlur:function(h){var d=h.filterBackend.resources,u,p,m=h.imageData.width,g=h.imageData.height;d.blurLayer1||(d.blurLayer1=a.util.createCanvasElement(),d.blurLayer2=a.util.createCanvasElement()),u=d.blurLayer1,p=d.blurLayer2,(u.width!==m||u.height!==g)&&(p.width=u.width=m,p.height=u.height=g);var x=u.getContext("2d"),y=p.getContext("2d"),w=15,_,C,E,T,A=this.blur*.06*.5;for(x.putImageData(h.imageData,0,0),y.clearRect(0,0,m,g),T=-w;T<=w;T++)_=(Math.random()-.5)/4,C=T/w,E=A*C*m+_,y.globalAlpha=1-Math.abs(C),y.drawImage(u,E,_),x.drawImage(p,0,0),y.globalAlpha=1,y.clearRect(0,0,p.width,p.height);for(T=-w;T<=w;T++)_=(Math.random()-.5)/4,C=T/w,E=A*C*g+_,y.globalAlpha=1-Math.abs(C),y.drawImage(u,_,E),x.drawImage(p,0,0),y.globalAlpha=1,y.clearRect(0,0,p.width,p.height);h.ctx.drawImage(u,0,0);var j=h.ctx.getImageData(0,0,u.width,u.height);return x.globalAlpha=1,x.clearRect(0,0,u.width,u.height),j},getUniformLocations:function(h,d){return{delta:h.getUniformLocation(d,"uDelta")}},sendUniformData:function(h,d){var u=this.chooseRightDelta();h.uniform2fv(d.delta,u)},chooseRightDelta:function(){var h=1,d=[0,0],u;return this.horizontal?this.aspectRatio>1&&(h=1/this.aspectRatio):this.aspectRatio<1&&(h=this.aspectRatio),u=h*this.blur*.12,this.horizontal?d[0]=u:d[1]=u,d}}),c.Blur.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Gamma=f(c.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(h){this.gamma=[1,1,1],c.BaseFilter.prototype.initialize.call(this,h)},applyTo2d:function(h){var d=h.imageData,u=d.data,p=this.gamma,m=u.length,g=1/p[0],x=1/p[1],y=1/p[2],w;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),w=0,m=256;w<m;w++)this.rVals[w]=Math.pow(w/255,g)*255,this.gVals[w]=Math.pow(w/255,x)*255,this.bVals[w]=Math.pow(w/255,y)*255;for(w=0,m=u.length;w<m;w+=4)u[w]=this.rVals[u[w]],u[w+1]=this.gVals[u[w+1]],u[w+2]=this.bVals[u[w+2]]},getUniformLocations:function(h,d){return{uGamma:h.getUniformLocation(d,"uGamma")}},sendUniformData:function(h,d){h.uniform3fv(d.uGamma,this.gamma)}}),a.Image.filters.Gamma.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.Composed=f(c.BaseFilter,{type:"Composed",subFilters:[],initialize:function(h){this.callSuper("initialize",h),this.subFilters=this.subFilters.slice(0)},applyTo:function(h){h.passes+=this.subFilters.length-1,this.subFilters.forEach(function(d){d.applyTo(h)})},toObject:function(){return a.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(h){return h.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(h){return!h.isNeutralState()})}}),a.Image.filters.Composed.fromObject=function(h,d){var u=h.subFilters||[],p=u.map(function(g){return new a.Image.filters[g.type](g)}),m=new a.Image.filters.Composed({subFilters:p});return d&&d(m),m}}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.Image.filters,f=a.util.createClass;c.HueRotation=f(c.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var h=this.rotation*Math.PI,d=a.util.cos(h),u=a.util.sin(h),p=1/3,m=Math.sqrt(p)*u,g=1-d;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=d+g/3,this.matrix[1]=p*g-m,this.matrix[2]=p*g+m,this.matrix[5]=p*g+m,this.matrix[6]=d+p*g,this.matrix[7]=p*g-m,this.matrix[10]=p*g-m,this.matrix[11]=p*g+m,this.matrix[12]=d+p*g},isNeutralState:function(h){return this.calculateMatrix(),c.BaseFilter.prototype.isNeutralState.call(this,h)},applyTo:function(h){this.calculateMatrix(),c.BaseFilter.prototype.applyTo.call(this,h)}}),a.Image.filters.HueRotation.fromObject=a.Image.filters.BaseFilter.fromObject}(e),function(o){var a=o.fabric||(o.fabric={}),c=a.util.object.clone;if(a.Text){a.warn("fabric.Text is already defined");return}var f="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");a.Text=a.util.createClass(a.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:a.Object.prototype.stateProperties.concat(f),cacheProperties:a.Object.prototype.cacheProperties.concat(f),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(h,d){this.styles=d?d.styles||{}:{},this.text=h,this.__skipDimension=!0,this.callSuper("initialize",d),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var h=this.path;h&&(h.segmentsInfo=a.util.getPathSegmentsInfo(h.path))},getMeasuringContext:function(){return a._measuringContext||(a._measuringContext=this.canvas&&this.canvas.contextCache||a.util.createCanvasElement().getContext("2d")),a._measuringContext},_splitText:function(){var h=this._splitTextIntoLines(this.text);return this.textLines=h.lines,this._textLines=h.graphemeLines,this._unwrappedTextLines=h._unwrappedLines,this._text=h.graphemeText,h},initDimensions:function(){if(!this.__skipDimension){if(this._splitText(),this._clearCache(),this.path){var h=this.getHeightOfLine(0)*1.1;this.width=this.path.width+h,this.height=this.path.height+h}else this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight();this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"})}},enlargeSpaces:function(){for(var h,d,u,p,m,g,x,y=0,w=this._textLines.length;y<w;y++)if(!(this.textAlign!=="justify"&&(y===w-1||this.isEndOfWrapping(y)))&&(p=0,m=this._textLines[y],d=this.getLineWidth(y),d<this.width&&(x=this.textLines[y].match(this._reSpacesAndTabs)))){u=x.length,h=(this.width-d)/u;for(var _=0,C=m.length;_<=C;_++)g=this.__charBounds[y][_],this._reSpaceAndTab.test(m[_])?(g.width+=h,g.kernedWidth+=h,g.left+=p,p+=h):g.left+=p}},isEndOfWrapping:function(h){return h===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var h=this.callSuper("_getCacheCanvasDimensions"),d=this.fontSize;return h.width+=d*h.zoomX,h.height+=d*h.zoomY,h},_render:function(h){var d=this.path;d&&!d.isNotVisible()&&d._render(h),this._setTextStyles(h),this._renderTextLinesBackground(h),this._renderTextDecoration(h,"underline"),this._renderText(h),this._renderTextDecoration(h,"overline"),this._renderTextDecoration(h,"linethrough")},_renderText:function(h){this.paintFirst==="stroke"?(this._renderTextStroke(h),this._renderTextFill(h)):(this._renderTextFill(h),this._renderTextStroke(h))},_setTextStyles:function(h,d,u){if(h.textBaseline="alphabetic",this.path)switch(this.pathAlign){case"center":h.textBaseline="middle";break;case"ascender":h.textBaseline="top";break;case"descender":h.textBaseline="bottom";break}h.font=this._getFontDeclaration(d,u)},calcTextWidth:function(){for(var h=this.getLineWidth(0),d=1,u=this._textLines.length;d<u;d++){var p=this.getLineWidth(d);p>h&&(h=p)}return h},_renderTextLine:function(h,d,u,p,m,g){this._renderChars(h,d,u,p,m,g)},_renderTextLinesBackground:function(h){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var d,u,p=h.fillStyle,m,g,x=this._getLeftOffset(),y=this._getTopOffset(),w=0,_=0,C,E,T=this.path,A,j=0,B=this._textLines.length;j<B;j++){if(d=this.getHeightOfLine(j),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",j)){y+=d;continue}m=this._textLines[j],u=this._getLineLeftOffset(j),_=0,w=0,g=this.getValueOfPropertyAt(j,0,"textBackgroundColor");for(var F=0,L=m.length;F<L;F++)C=this.__charBounds[j][F],E=this.getValueOfPropertyAt(j,F,"textBackgroundColor"),T?(h.save(),h.translate(C.renderLeft,C.renderTop),h.rotate(C.angle),h.fillStyle=E,E&&h.fillRect(-C.width/2,-d/this.lineHeight*(1-this._fontSizeFraction),C.width,d/this.lineHeight),h.restore()):E!==g?(A=x+u+w,this.direction==="rtl"&&(A=this.width-A-_),h.fillStyle=g,g&&h.fillRect(A,y,_,d/this.lineHeight),w=C.left,_=C.width,g=E):_+=C.kernedWidth;E&&!T&&(A=x+u+w,this.direction==="rtl"&&(A=this.width-A-_),h.fillStyle=E,h.fillRect(A,y,_,d/this.lineHeight)),y+=d}h.fillStyle=p,this._removeShadow(h)}},getFontCache:function(h){var d=h.fontFamily.toLowerCase();a.charWidthsCache[d]||(a.charWidthsCache[d]={});var u=a.charWidthsCache[d],p=h.fontStyle.toLowerCase()+"_"+(h.fontWeight+"").toLowerCase();return u[p]||(u[p]={}),u[p]},_measureChar:function(h,d,u,p){var m=this.getFontCache(d),g=this._getFontDeclaration(d),x=this._getFontDeclaration(p),y=u+h,w=g===x,_,C,E,T=d.fontSize/this.CACHE_FONT_SIZE,A;if(u&&m[u]!==void 0&&(E=m[u]),m[h]!==void 0&&(A=_=m[h]),w&&m[y]!==void 0&&(C=m[y],A=C-E),_===void 0||E===void 0||C===void 0){var j=this.getMeasuringContext();this._setTextStyles(j,d,!0)}return _===void 0&&(A=_=j.measureText(h).width,m[h]=_),E===void 0&&w&&u&&(E=j.measureText(u).width,m[u]=E),w&&C===void 0&&(C=j.measureText(y).width,m[y]=C,A=C-E),{width:_*T,kernedWidth:A*T}},getHeightOfChar:function(h,d){return this.getValueOfPropertyAt(h,d,"fontSize")},measureLine:function(h){var d=this._measureLine(h);return this.charSpacing!==0&&(d.width-=this._getWidthOfCharSpacing()),d.width<0&&(d.width=0),d},_measureLine:function(h){var d=0,u,p,m=this._textLines[h],g,x,y=0,w=new Array(m.length),_=0,C,E,T=this.path,A=this.pathSide==="right";for(this.__charBounds[h]=w,u=0;u<m.length;u++)p=m[u],x=this._getGraphemeBox(p,h,u,g),w[u]=x,d+=x.kernedWidth,g=p;if(w[u]={left:x?x.left+x.width:0,width:0,kernedWidth:0,height:this.fontSize},T){switch(E=T.segmentsInfo[T.segmentsInfo.length-1].length,C=a.util.getPointOnPath(T.path,0,T.segmentsInfo),C.x+=T.pathOffset.x,C.y+=T.pathOffset.y,this.textAlign){case"left":_=A?E-d:0;break;case"center":_=(E-d)/2;break;case"right":_=A?0:E-d;break}for(_+=this.pathStartOffset*(A?-1:1),u=A?m.length-1:0;A?u>=0:u<m.length;A?u--:u++)x=w[u],_>E?_%=E:_<0&&(_+=E),this._setGraphemeOnPath(_,x,C),_+=x.kernedWidth}return{width:d,numOfSpaces:y}},_setGraphemeOnPath:function(h,d,u){var p=h+d.kernedWidth/2,m=this.path,g=a.util.getPointOnPath(m.path,p,m.segmentsInfo);d.renderLeft=g.x-u.x,d.renderTop=g.y-u.y,d.angle=g.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(h,d,u,p,m){var g=this.getCompleteStyleDeclaration(d,u),x=p?this.getCompleteStyleDeclaration(d,u-1):{},y=this._measureChar(h,g,p,x),w=y.kernedWidth,_=y.width,C;this.charSpacing!==0&&(C=this._getWidthOfCharSpacing(),_+=C,w+=C);var E={width:_,left:0,height:g.fontSize,kernedWidth:w,deltaY:g.deltaY};if(u>0&&!m){var T=this.__charBounds[d][u-1];E.left=T.left+T.width+y.kernedWidth-y.width}return E},getHeightOfLine:function(h){if(this.__lineHeights[h])return this.__lineHeights[h];for(var d=this._textLines[h],u=this.getHeightOfChar(h,0),p=1,m=d.length;p<m;p++)u=Math.max(this.getHeightOfChar(h,p),u);return this.__lineHeights[h]=u*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var h,d=0,u=0,p=this._textLines.length;u<p;u++)h=this.getHeightOfLine(u),d+=u===p-1?h/this.lineHeight:h;return d},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(h,d){h.save();for(var u=0,p=this._getLeftOffset(),m=this._getTopOffset(),g=0,x=this._textLines.length;g<x;g++){var y=this.getHeightOfLine(g),w=y/this.lineHeight,_=this._getLineLeftOffset(g);this._renderTextLine(d,h,this._textLines[g],p+_,m+u+w,g),u+=y}h.restore()},_renderTextFill:function(h){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(h,"fillText")},_renderTextStroke:function(h){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(h),h.save(),this._setLineDash(h,this.strokeDashArray),h.beginPath(),this._renderTextCommon(h,"strokeText"),h.closePath(),h.restore())},_renderChars:function(h,d,u,p,m,g){var x=this.getHeightOfLine(g),y=this.textAlign.indexOf("justify")!==-1,w,_,C="",E,T=0,A,j=this.path,B=!y&&this.charSpacing===0&&this.isEmptyStyles(g)&&!j,F=this.direction==="ltr",L=this.direction==="ltr"?1:-1,G,X=d.canvas.getAttribute("dir");if(d.save(),X!==this.direction&&(d.canvas.setAttribute("dir",F?"ltr":"rtl"),d.direction=F?"ltr":"rtl",d.textAlign=F?"left":"right"),m-=x*this._fontSizeFraction/this.lineHeight,B){this._renderChar(h,d,g,0,u.join(""),p,m,x),d.restore();return}for(var re=0,Q=u.length-1;re<=Q;re++)A=re===Q||this.charSpacing||j,C+=u[re],E=this.__charBounds[g][re],T===0?(p+=L*(E.kernedWidth-E.width),T+=E.width):T+=E.kernedWidth,y&&!A&&this._reSpaceAndTab.test(u[re])&&(A=!0),A||(w=w||this.getCompleteStyleDeclaration(g,re),_=this.getCompleteStyleDeclaration(g,re+1),A=a.util.hasStyleChanged(w,_,!1)),A&&(j?(d.save(),d.translate(E.renderLeft,E.renderTop),d.rotate(E.angle),this._renderChar(h,d,g,re,C,-T/2,0,x),d.restore()):(G=p,this._renderChar(h,d,g,re,C,G,m,x)),C="",w=_,p+=L*T,T=0);d.restore()},_applyPatternGradientTransformText:function(h){var d=a.util.createCanvasElement(),u,p=this.width+this.strokeWidth,m=this.height+this.strokeWidth;return d.width=p,d.height=m,u=d.getContext("2d"),u.beginPath(),u.moveTo(0,0),u.lineTo(p,0),u.lineTo(p,m),u.lineTo(0,m),u.closePath(),u.translate(p/2,m/2),u.fillStyle=h.toLive(u),this._applyPatternGradientTransform(u,h),u.fill(),u.createPattern(d,"no-repeat")},handleFiller:function(h,d,u){var p,m;return u.toLive?u.gradientUnits==="percentage"||u.gradientTransform||u.patternTransform?(p=-this.width/2,m=-this.height/2,h.translate(p,m),h[d]=this._applyPatternGradientTransformText(u),{offsetX:p,offsetY:m}):(h[d]=u.toLive(h,this),this._applyPatternGradientTransform(h,u)):(h[d]=u,{offsetX:0,offsetY:0})},_setStrokeStyles:function(h,d){return h.lineWidth=d.strokeWidth,h.lineCap=this.strokeLineCap,h.lineDashOffset=this.strokeDashOffset,h.lineJoin=this.strokeLineJoin,h.miterLimit=this.strokeMiterLimit,this.handleFiller(h,"strokeStyle",d.stroke)},_setFillStyles:function(h,d){return this.handleFiller(h,"fillStyle",d.fill)},_renderChar:function(h,d,u,p,m,g,x){var y=this._getStyleDeclaration(u,p),w=this.getCompleteStyleDeclaration(u,p),_=h==="fillText"&&w.fill,C=h==="strokeText"&&w.stroke&&w.strokeWidth,E,T;!C&&!_||(d.save(),_&&(E=this._setFillStyles(d,w)),C&&(T=this._setStrokeStyles(d,w)),d.font=this._getFontDeclaration(w),y&&y.textBackgroundColor&&this._removeShadow(d),y&&y.deltaY&&(x+=y.deltaY),_&&d.fillText(m,g-E.offsetX,x-E.offsetY),C&&d.strokeText(m,g-T.offsetX,x-T.offsetY),d.restore())},setSuperscript:function(h,d){return this._setScript(h,d,this.superscript)},setSubscript:function(h,d){return this._setScript(h,d,this.subscript)},_setScript:function(h,d,u){var p=this.get2DCursorLocation(h,!0),m=this.getValueOfPropertyAt(p.lineIndex,p.charIndex,"fontSize"),g=this.getValueOfPropertyAt(p.lineIndex,p.charIndex,"deltaY"),x={fontSize:m*u.size,deltaY:g+m*u.baseline};return this.setSelectionStyles(x,h,d),this},_getLineLeftOffset:function(h){var d=this.getLineWidth(h),u=this.width-d,p=this.textAlign,m=this.direction,x,g=0,x=this.isEndOfWrapping(h);return p==="justify"||p==="justify-center"&&!x||p==="justify-right"&&!x||p==="justify-left"&&!x?0:(p==="center"&&(g=u/2),p==="right"&&(g=u),p==="justify-center"&&(g=u/2),p==="justify-right"&&(g=u),m==="rtl"&&(g-=u),g)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var h=this._forceClearCache;return h||(h=this.hasStateChanged("_dimensionAffectingProps")),h&&(this.dirty=!0,this._forceClearCache=!1),h},getLineWidth:function(h){if(this.__lineWidths[h]!==void 0)return this.__lineWidths[h];var d=this.measureLine(h),u=d.width;return this.__lineWidths[h]=u,u},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(h,d,u){var p=this._getStyleDeclaration(h,d);return p&&typeof p[u]<"u"?p[u]:this[u]},_renderTextDecoration:function(h,d){if(!(!this[d]&&!this.styleHas(d))){h.save(),(d==="overline"||d==="linethrough")&&this._removeShadow(h);for(var u,p,m,g,x,y,w,_,C=this._getLeftOffset(),E=this._getTopOffset(),T,A,j,B,F,L,G,X,re=this.path,Q=this._getWidthOfCharSpacing(),ne=this.offsets[d],J=0,P=this._textLines.length;J<P;J++){if(u=this.getHeightOfLine(J),!this[d]&&!this.styleHas(d,J)){E+=u;continue}w=this._textLines[J],L=u/this.lineHeight,g=this._getLineLeftOffset(J),A=0,j=0,_=this.getValueOfPropertyAt(J,0,d),X=this.getValueOfPropertyAt(J,0,"fill"),T=E+L*(1-this._fontSizeFraction),p=this.getHeightOfChar(J,0),x=this.getValueOfPropertyAt(J,0,"deltaY");for(var H=0,U=w.length;H<U;H++)if(B=this.__charBounds[J][H],F=this.getValueOfPropertyAt(J,H,d),G=this.getValueOfPropertyAt(J,H,"fill"),m=this.getHeightOfChar(J,H),y=this.getValueOfPropertyAt(J,H,"deltaY"),re&&F&&G)h.save(),h.fillStyle=X,h.translate(B.renderLeft,B.renderTop),h.rotate(B.angle),h.fillRect(-B.kernedWidth/2,ne*m+y,B.kernedWidth,this.fontSize/15),h.restore();else if((F!==_||G!==X||m!==p||y!==x)&&j>0){var S=C+g+A;this.direction==="rtl"&&(S=this.width-S-j),_&&X&&(h.fillStyle=X,h.fillRect(S,T+ne*p+x,j,this.fontSize/15)),A=B.left,j=B.width,_=F,X=G,p=m,x=y}else j+=B.kernedWidth;var S=C+g+A;this.direction==="rtl"&&(S=this.width-S-j),h.fillStyle=G,F&&G&&h.fillRect(S,T+ne*p+x,j-Q,this.fontSize/15),E+=u}h.restore()}},_getFontDeclaration:function(h,d){var u=h||this,p=this.fontFamily,m=a.Text.genericFonts.indexOf(p.toLowerCase())>-1,g=p===void 0||p.indexOf("'")>-1||p.indexOf(",")>-1||p.indexOf('"')>-1||m?u.fontFamily:'"'+u.fontFamily+'"';return[a.isLikelyNode?u.fontWeight:u.fontStyle,a.isLikelyNode?u.fontStyle:u.fontWeight,d?this.CACHE_FONT_SIZE+"px":u.fontSize+"px",g].join(" ")},render:function(h){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",h)))},_splitTextIntoLines:function(h){for(var d=h.split(this._reNewline),u=new Array(d.length),p=[`
`],m=[],g=0;g<d.length;g++)u[g]=a.util.string.graphemeSplit(d[g]),m=m.concat(u[g],p);return m.pop(),{_unwrappedLines:u,lines:d,graphemeText:m,graphemeLines:u}},toObject:function(h){var d=f.concat(h),u=this.callSuper("toObject",d);return u.styles=a.util.stylesToArray(this.styles,this.text),u.path&&(u.path=this.path.toObject()),u},set:function(h,d){this.callSuper("set",h,d);var u=!1,p=!1;if(typeof h=="object")for(var m in h)m==="path"&&this.setPathInfo(),u=u||this._dimensionAffectingProps.indexOf(m)!==-1,p=p||m==="path";else u=this._dimensionAffectingProps.indexOf(h)!==-1,p=h==="path";return p&&this.setPathInfo(),u&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),a.Text.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),a.Text.DEFAULT_SVG_FONT_SIZE=16,a.Text.fromElement=function(h,d,u){if(!h)return d(null);var p=a.parseAttributes(h,a.Text.ATTRIBUTE_NAMES),m=p.textAnchor||"left";if(u=a.util.object.extend(u?c(u):{},p),u.top=u.top||0,u.left=u.left||0,p.textDecoration){var g=p.textDecoration;g.indexOf("underline")!==-1&&(u.underline=!0),g.indexOf("overline")!==-1&&(u.overline=!0),g.indexOf("line-through")!==-1&&(u.linethrough=!0),delete u.textDecoration}"dx"in p&&(u.left+=p.dx),"dy"in p&&(u.top+=p.dy),"fontSize"in u||(u.fontSize=a.Text.DEFAULT_SVG_FONT_SIZE);var x="";"textContent"in h?x=h.textContent:"firstChild"in h&&h.firstChild!==null&&"data"in h.firstChild&&h.firstChild.data!==null&&(x=h.firstChild.data),x=x.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var y=u.strokeWidth;u.strokeWidth=0;var w=new a.Text(x,u),_=w.getScaledHeight()/w.height,C=(w.height+w.strokeWidth)*w.lineHeight-w.height,E=C*_,T=w.getScaledHeight()+E,A=0;m==="center"&&(A=w.getScaledWidth()/2),m==="right"&&(A=w.getScaledWidth()),w.set({left:w.left-A,top:w.top-(T-w.fontSize*(.07+w._fontSizeFraction))/w.lineHeight,strokeWidth:typeof y<"u"?y:1}),d(w)},a.Text.fromObject=function(h,d){var u=c(h),p=h.path;return delete u.path,a.Object._fromObject("Text",u,function(m){m.styles=a.util.stylesFromArray(h.styles,h.text),p?a.Object._fromObject("Path",p,function(g){m.set("path",g),d(m)},"path"):d(m)},"text")},a.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],a.util.createAccessors&&a.util.createAccessors(a.Text)}(e),function(){t.util.object.extend(t.Text.prototype,{isEmptyStyles:function(o){if(!this.styles||typeof o<"u"&&!this.styles[o])return!0;var a=typeof o>"u"?this.styles:{line:this.styles[o]};for(var c in a)for(var f in a[c])for(var h in a[c][f])return!1;return!0},styleHas:function(o,a){if(!this.styles||!o||o===""||typeof a<"u"&&!this.styles[a])return!1;var c=typeof a>"u"?this.styles:{0:this.styles[a]};for(var f in c)for(var h in c[f])if(typeof c[f][h][o]<"u")return!0;return!1},cleanStyle:function(o){if(!this.styles||!o||o==="")return!1;var a=this.styles,c=0,f,h,d=!0,u=0,p;for(var m in a){f=0;for(var g in a[m]){var p=a[m][g],x=p.hasOwnProperty(o);c++,x?(h?p[o]!==h&&(d=!1):h=p[o],p[o]===this[o]&&delete p[o]):d=!1,Object.keys(p).length!==0?f++:delete a[m][g]}f===0&&delete a[m]}for(var y=0;y<this._textLines.length;y++)u+=this._textLines[y].length;d&&c===u&&(this[o]=h,this.removeStyle(o))},removeStyle:function(o){if(!(!this.styles||!o||o==="")){var a=this.styles,c,f,h;for(f in a){c=a[f];for(h in c)delete c[h][o],Object.keys(c[h]).length===0&&delete c[h];Object.keys(c).length===0&&delete a[f]}}},_extendStyles:function(o,a){var c=this.get2DCursorLocation(o);this._getLineStyle(c.lineIndex)||this._setLineStyle(c.lineIndex),this._getStyleDeclaration(c.lineIndex,c.charIndex)||this._setStyleDeclaration(c.lineIndex,c.charIndex,{}),t.util.object.extend(this._getStyleDeclaration(c.lineIndex,c.charIndex),a)},get2DCursorLocation:function(o,a){typeof o>"u"&&(o=this.selectionStart);for(var c=a?this._unwrappedTextLines:this._textLines,f=c.length,h=0;h<f;h++){if(o<=c[h].length)return{lineIndex:h,charIndex:o};o-=c[h].length+this.missingNewlineOffset(h,a)}return{lineIndex:h-1,charIndex:c[h-1].length<o?c[h-1].length:o}},getSelectionStyles:function(o,a,c){typeof o>"u"&&(o=this.selectionStart||0),typeof a>"u"&&(a=this.selectionEnd||o);for(var f=[],h=o;h<a;h++)f.push(this.getStyleAtPosition(h,c));return f},getStyleAtPosition:function(o,a){var c=this.get2DCursorLocation(o),f=a?this.getCompleteStyleDeclaration(c.lineIndex,c.charIndex):this._getStyleDeclaration(c.lineIndex,c.charIndex);return f||{}},setSelectionStyles:function(o,a,c){typeof a>"u"&&(a=this.selectionStart||0),typeof c>"u"&&(c=this.selectionEnd||a);for(var f=a;f<c;f++)this._extendStyles(f,o);return this._forceClearCache=!0,this},_getStyleDeclaration:function(o,a){var c=this.styles&&this.styles[o];return c?c[a]:null},getCompleteStyleDeclaration:function(o,a){for(var c=this._getStyleDeclaration(o,a)||{},f={},h,d=0;d<this._styleProperties.length;d++)h=this._styleProperties[d],f[h]=typeof c[h]>"u"?this[h]:c[h];return f},_setStyleDeclaration:function(o,a,c){this.styles[o][a]=c},_deleteStyleDeclaration:function(o,a){delete this.styles[o][a]},_getLineStyle:function(o){return!!this.styles[o]},_setLineStyle:function(o){this.styles[o]={}},_deleteLineStyle:function(o){delete this.styles[o]}})}(),function(){function o(a){a.textDecoration&&(a.textDecoration.indexOf("underline")>-1&&(a.underline=!0),a.textDecoration.indexOf("line-through")>-1&&(a.linethrough=!0),a.textDecoration.indexOf("overline")>-1&&(a.overline=!0),delete a.textDecoration)}t.IText=t.util.createClass(t.Text,t.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(a,c){this.callSuper("initialize",a,c),this.initBehavior()},setSelectionStart:function(a){a=Math.max(a,0),this._updateAndFire("selectionStart",a)},setSelectionEnd:function(a){a=Math.min(a,this.text.length),this._updateAndFire("selectionEnd",a)},_updateAndFire:function(a,c){this[a]!==c&&(this._fireSelectionChanged(),this[a]=c),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(a){this.clearContextTop(),this.callSuper("render",a),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(a){this.callSuper("_render",a)},clearContextTop:function(a){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var c=this.canvas.contextTop,f=this.canvas.viewportTransform;c.save(),c.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this.transform(c),this._clearTextArea(c),a||c.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var a=this._getCursorBoundaries(),c=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(a,c):this.renderSelection(a,c),c.restore()}},_clearTextArea:function(a){var c=this.width+4,f=this.height+4;a.clearRect(-c/2,-f/2,c,f)},_getCursorBoundaries:function(a){typeof a>"u"&&(a=this.selectionStart);var c=this._getLeftOffset(),f=this._getTopOffset(),h=this._getCursorBoundariesOffsets(a);return{left:c,top:f,leftOffset:h.left,topOffset:h.top}},_getCursorBoundariesOffsets:function(a){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var c,f,h,d=0,u=0,p,m=this.get2DCursorLocation(a);h=m.charIndex,f=m.lineIndex;for(var g=0;g<f;g++)d+=this.getHeightOfLine(g);c=this._getLineLeftOffset(f);var x=this.__charBounds[f][h];return x&&(u=x.left),this.charSpacing!==0&&h===this._textLines[f].length&&(u-=this._getWidthOfCharSpacing()),p={top:d,left:c+(u>0?u:0)},this.direction==="rtl"&&(p.left*=-1),this.cursorOffsetCache=p,this.cursorOffsetCache},renderCursor:function(a,c){var f=this.get2DCursorLocation(),h=f.lineIndex,d=f.charIndex>0?f.charIndex-1:0,u=this.getValueOfPropertyAt(h,d,"fontSize"),p=this.scaleX*this.canvas.getZoom(),m=this.cursorWidth/p,g=a.topOffset,x=this.getValueOfPropertyAt(h,d,"deltaY");g+=(1-this._fontSizeFraction)*this.getHeightOfLine(h)/this.lineHeight-u*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(a,c),c.fillStyle=this.cursorColor||this.getValueOfPropertyAt(h,d,"fill"),c.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,c.fillRect(a.left+a.leftOffset-m/2,g+a.top+x,m,u)},renderSelection:function(a,c){for(var f=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,h=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,d=this.textAlign.indexOf("justify")!==-1,u=this.get2DCursorLocation(f),p=this.get2DCursorLocation(h),m=u.lineIndex,g=p.lineIndex,x=u.charIndex<0?0:u.charIndex,y=p.charIndex<0?0:p.charIndex,w=m;w<=g;w++){var _=this._getLineLeftOffset(w)||0,C=this.getHeightOfLine(w),E=0,T=0,A=0;if(w===m&&(T=this.__charBounds[m][x].left),w>=m&&w<g)A=d&&!this.isEndOfWrapping(w)?this.width:this.getLineWidth(w)||5;else if(w===g)if(y===0)A=this.__charBounds[g][y].left;else{var j=this._getWidthOfCharSpacing();A=this.__charBounds[g][y-1].left+this.__charBounds[g][y-1].width-j}E=C,(this.lineHeight<1||w===g&&this.lineHeight>1)&&(C/=this.lineHeight);var B=a.left+_+T,F=A-T,L=C,G=0;this.inCompositionMode?(c.fillStyle=this.compositionColor||"black",L=1,G=C):c.fillStyle=this.selectionColor,this.direction==="rtl"&&(B=this.width-B-F),c.fillRect(B,a.top+a.topOffset+G,F,L),a.topOffset+=E}},getCurrentCharFontSize:function(){var a=this._getCurrentCharIndex();return this.getValueOfPropertyAt(a.l,a.c,"fontSize")},getCurrentCharColor:function(){var a=this._getCurrentCharIndex();return this.getValueOfPropertyAt(a.l,a.c,"fill")},_getCurrentCharIndex:function(){var a=this.get2DCursorLocation(this.selectionStart,!0),c=a.charIndex>0?a.charIndex-1:0;return{l:a.lineIndex,c}}}),t.IText.fromObject=function(a,c){var f=t.util.stylesFromArray(a.styles,a.text),h=Object.assign({},a,{styles:f});if(delete h.path,o(h),h.styles)for(var d in h.styles)for(var u in h.styles[d])o(h.styles[d][u]);t.Object._fromObject("IText",h,function(p){a.path?t.Object._fromObject("Path",a.path,function(m){p.set("path",m),c(p)},"path"):c(p)},"text")}}(),function(){var o=t.util.object.clone;t.util.object.extend(t.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var a=this;this.on("added",function(){var c=a.canvas;c&&(c._hasITextHandlers||(c._hasITextHandlers=!0,a._initCanvasHandlers(c)),c._iTextInstances=c._iTextInstances||[],c._iTextInstances.push(a))})},initRemovedHandler:function(){var a=this;this.on("removed",function(){var c=a.canvas;c&&(c._iTextInstances=c._iTextInstances||[],t.util.removeFromArray(c._iTextInstances,a),c._iTextInstances.length===0&&(c._hasITextHandlers=!1,a._removeCanvasHandlers(c)))})},_initCanvasHandlers:function(a){a._mouseUpITextHandler=function(){a._iTextInstances&&a._iTextInstances.forEach(function(c){c.__isMousedown=!1})},a.on("mouse:up",a._mouseUpITextHandler)},_removeCanvasHandlers:function(a){a.off("mouse:up",a._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(a,c,f,h){var d;return d={isAborted:!1,abort:function(){this.isAborted=!0}},a.animate("_currentCursorOpacity",c,{duration:f,onComplete:function(){d.isAborted||a[h]()},onChange:function(){a.canvas&&a.selectionStart===a.selectionEnd&&a.renderCursorOrSelection()},abort:function(){return d.isAborted}}),d},_onTickComplete:function(){var a=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){a._currentTickCompleteState=a._animateCursor(a,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(a){var c=this,f=a?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){c._tick()},f)},abortCursorAnimation:function(){var a=this._currentTickState||this._currentTickCompleteState,c=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,a&&c&&c.clearContext(c.contextTop||c.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(a){var c=0,f=a-1;if(this._reSpace.test(this._text[f]))for(;this._reSpace.test(this._text[f]);)c++,f--;for(;/\S/.test(this._text[f])&&f>-1;)c++,f--;return a-c},findWordBoundaryRight:function(a){var c=0,f=a;if(this._reSpace.test(this._text[f]))for(;this._reSpace.test(this._text[f]);)c++,f++;for(;/\S/.test(this._text[f])&&f<this._text.length;)c++,f++;return a+c},findLineBoundaryLeft:function(a){for(var c=0,f=a-1;!/\n/.test(this._text[f])&&f>-1;)c++,f--;return a-c},findLineBoundaryRight:function(a){for(var c=0,f=a;!/\n/.test(this._text[f])&&f<this._text.length;)c++,f++;return a+c},searchWordBoundary:function(a,c){for(var f=this._text,h=this._reSpace.test(f[a])?a-1:a,d=f[h],u=t.reNonWord;!u.test(d)&&h>0&&h<f.length;)h+=c,d=f[h];return u.test(d)&&(h+=c===1?0:1),h},selectWord:function(a){a=a||this.selectionStart;var c=this.searchWordBoundary(a,-1),f=this.searchWordBoundary(a,1);this.selectionStart=c,this.selectionEnd=f,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(a){a=a||this.selectionStart;var c=this.findLineBoundaryLeft(a),f=this.findLineBoundaryRight(a);return this.selectionStart=c,this.selectionEnd=f,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(a){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(a),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(a){a._iTextInstances&&a._iTextInstances.forEach(function(c){c.selected=!1,c.isEditing&&c.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(a){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var c=this.getSelectionStartFromPointer(a.e),f=this.selectionStart,h=this.selectionEnd;(c!==this.__selectionStartOnMouseDown||f===h)&&(f===c||h===c)||(c>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=c):(this.selectionStart=c,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==f||this.selectionEnd!==h)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(a,c,f){var h=f.slice(0,a),d=t.util.string.graphemeSplit(h).length;if(a===c)return{selectionStart:d,selectionEnd:d};var u=f.slice(a,c),p=t.util.string.graphemeSplit(u).length;return{selectionStart:d,selectionEnd:d+p}},fromGraphemeToStringSelection:function(a,c,f){var h=f.slice(0,a),d=h.join("").length;if(a===c)return{selectionStart:d,selectionEnd:d};var u=f.slice(a,c),p=u.join("").length;return{selectionStart:d,selectionEnd:d+p}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var a=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=a.selectionStart,this.hiddenTextarea.selectionEnd=a.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var a=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=a.selectionEnd,this.inCompositionMode||(this.selectionStart=a.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var a=this._calcTextareaPosition();this.hiddenTextarea.style.left=a.left,this.hiddenTextarea.style.top=a.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var a=this.inCompositionMode?this.compositionStart:this.selectionStart,c=this._getCursorBoundaries(a),f=this.get2DCursorLocation(a),h=f.lineIndex,d=f.charIndex,u=this.getValueOfPropertyAt(h,d,"fontSize")*this.lineHeight,p=c.leftOffset,m=this.calcTransformMatrix(),g={x:c.left+p,y:c.top+c.topOffset+u},x=this.canvas.getRetinaScaling(),y=this.canvas.upperCanvasEl,w=y.width/x,_=y.height/x,C=w-u,E=_-u,T=y.clientWidth/w,A=y.clientHeight/_;return g=t.util.transformPoint(g,m),g=t.util.transformPoint(g,this.canvas.viewportTransform),g.x*=T,g.y*=A,g.x<0&&(g.x=0),g.x>C&&(g.x=C),g.y<0&&(g.y=0),g.y>E&&(g.y=E),g.x+=this.canvas._offset.left,g.y+=this.canvas._offset.top,{left:g.x+"px",top:g.y+"px",fontSize:u+"px",charHeight:u}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var a=this._textBeforeEdit!==this.text,c=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,c&&(c.blur&&c.blur(),c.parentNode&&c.parentNode.removeChild(c)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),a&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),a&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var a in this.styles)this._textLines[a]||delete this.styles[a]},removeStyleFromTo:function(a,c){var f=this.get2DCursorLocation(a,!0),h=this.get2DCursorLocation(c,!0),d=f.lineIndex,u=f.charIndex,p=h.lineIndex,m=h.charIndex,g,x;if(d!==p){if(this.styles[d])for(g=u;g<this._unwrappedTextLines[d].length;g++)delete this.styles[d][g];if(this.styles[p])for(g=m;g<this._unwrappedTextLines[p].length;g++)x=this.styles[p][g],x&&(this.styles[d]||(this.styles[d]={}),this.styles[d][u+g-m]=x);for(g=d+1;g<=p;g++)delete this.styles[g];this.shiftLineStyles(p,d-p)}else if(this.styles[d]){x=this.styles[d];var y=m-u,w,_;for(g=u;g<m;g++)delete x[g];for(_ in this.styles[d])w=parseInt(_,10),w>=m&&(x[w-y]=x[_],delete x[_])}},shiftLineStyles:function(a,c){var f=o(this.styles);for(var h in this.styles){var d=parseInt(h,10);d>a&&(this.styles[d+c]=f[d],f[d-c]||delete this.styles[d])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(a,c,f,h){var d,u={},p=!1,m=this._unwrappedTextLines[a].length,g=m===c;f||(f=1),this.shiftLineStyles(a,f),this.styles[a]&&(d=this.styles[a][c===0?c:c-1]);for(var x in this.styles[a]){var y=parseInt(x,10);y>=c&&(p=!0,u[y-c]=this.styles[a][x],g&&c===0||delete this.styles[a][x])}var w=!1;for(p&&!g&&(this.styles[a+f]=u,w=!0),(w||m>c)&&f--;f>0;)h&&h[f-1]?this.styles[a+f]={0:o(h[f-1])}:d?this.styles[a+f]={0:o(d)}:delete this.styles[a+f],f--;this._forceClearCache=!0},insertCharStyleObject:function(a,c,f,h){this.styles||(this.styles={});var d=this.styles[a],u=d?o(d):{};f||(f=1);for(var p in u){var m=parseInt(p,10);m>=c&&(d[m+f]=u[m],u[m-f]||delete d[m])}if(this._forceClearCache=!0,h){for(;f--;)Object.keys(h[f]).length&&(this.styles[a]||(this.styles[a]={}),this.styles[a][c+f]=o(h[f]));return}if(d)for(var g=d[c?c-1:1];g&&f--;)this.styles[a][c+f]=o(g)},insertNewStyleBlock:function(a,c,f){for(var h=this.get2DCursorLocation(c,!0),d=[0],u=0,p=0;p<a.length;p++)a[p]===`
`?(u++,d[u]=0):d[u]++;d[0]>0&&(this.insertCharStyleObject(h.lineIndex,h.charIndex,d[0],f),f=f&&f.slice(d[0]+1)),u&&this.insertNewlineStyleObject(h.lineIndex,h.charIndex+d[0],u);for(var p=1;p<u;p++)d[p]>0?this.insertCharStyleObject(h.lineIndex+p,0,d[p],f):f&&this.styles[h.lineIndex+p]&&f[0]&&(this.styles[h.lineIndex+p][0]=f[0]),f=f&&f.slice(d[p]+1);d[p]>0&&this.insertCharStyleObject(h.lineIndex+p,0,d[p],f)},setSelectionStartEndWithShift:function(a,c,f){f<=a?(c===a?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=a),this.selectionStart=f):f>a&&f<c?this._selectionDirection==="right"?this.selectionEnd=f:this.selectionStart=f:(c===a?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=c),this.selectionEnd=f)},setSelectionInBoundaries:function(){var a=this.text.length;this.selectionStart>a?this.selectionStart=a:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>a?this.selectionEnd=a:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),t.util.object.extend(t.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(o){if(this.canvas){this.__newClickTime=+new Date;var a=o.pointer;this.isTripleClick(a)&&(this.fire("tripleclick",o),this._stopEvent(o.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=a,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(o){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===o.x&&this.__lastPointer.y===o.y},_stopEvent:function(o){o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(o){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(o.e))},tripleClickHandler:function(o){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(o.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(o){!this.canvas||!this.editable||o.e.button&&o.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(o.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(o){!this.canvas||!this.editable||o.e.button&&o.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(o){if(this.__isMousedown=!1,!(!this.editable||this.group||o.transform&&o.transform.actionPerformed||o.e.button&&o.e.button!==1)){if(this.canvas){var a=this.canvas._activeObject;if(a&&a!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(o.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(o){var a=this.getSelectionStartFromPointer(o),c=this.selectionStart,f=this.selectionEnd;o.shiftKey?this.setSelectionStartEndWithShift(c,f,a):(this.selectionStart=a,this.selectionEnd=a),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(o){for(var a=this.getLocalPointer(o),c=0,f=0,h=0,d=0,u=0,p,m,g=0,x=this._textLines.length;g<x&&h<=a.y;g++)h+=this.getHeightOfLine(g)*this.scaleY,u=g,g>0&&(d+=this._textLines[g-1].length+this.missingNewlineOffset(g-1));p=this._getLineLeftOffset(u),f=p*this.scaleX,m=this._textLines[u],this.direction==="rtl"&&(a.x=this.width*this.scaleX-a.x+f);for(var y=0,w=m.length;y<w&&(c=f,f+=this.__charBounds[u][y].kernedWidth*this.scaleX,f<=a.x);y++)d++;return this._getNewSelectionStartFromOffset(a,c,f,d,w)},_getNewSelectionStartFromOffset:function(o,a,c,f,h){var d=o.x-a,u=c-o.x,p=u>d||u<0?0:1,m=f+p;return this.flipX&&(m=h-m),m>this._text.length&&(m=this._text.length),m}}),t.util.object.extend(t.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=t.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var o=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+o.top+"; left: "+o.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+o.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):t.document.body.appendChild(this.hiddenTextarea),t.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),t.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),t.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),t.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(t.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(o){if(this.isEditing){var a=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(o.keyCode in a)this[a[o.keyCode]](o);else if(o.keyCode in this.ctrlKeysMapDown&&(o.ctrlKey||o.metaKey))this[this.ctrlKeysMapDown[o.keyCode]](o);else return;o.stopImmediatePropagation(),o.preventDefault(),o.keyCode>=33&&o.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(o){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(o.keyCode in this.ctrlKeysMapUp&&(o.ctrlKey||o.metaKey))this[this.ctrlKeysMapUp[o.keyCode]](o);else return;o.stopImmediatePropagation(),o.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(o){var a=this.fromPaste;if(this.fromPaste=!1,o&&o.stopPropagation(),!!this.isEditing){var c=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,f=this._text.length,h=c.length,d,u,p=h-f,m=this.selectionStart,g=this.selectionEnd,x=m!==g,y,w,_;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var C=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),E=m>C.selectionStart;x?(d=this._text.slice(m,g),p+=g-m):h<f&&(E?d=this._text.slice(g+p,g):d=this._text.slice(m,m-p)),u=c.slice(C.selectionEnd-p,C.selectionEnd),d&&d.length&&(u.length&&(y=this.getSelectionStyles(m,m+1,!1),y=u.map(function(){return y[0]})),x?(w=m,_=g):E?(w=g-d.length,_=g):(w=g,_=g+d.length),this.removeStyleFromTo(w,_)),u.length&&(a&&u.join("")===t.copiedText&&!t.disableStyleCopyPaste&&(y=t.copiedTextStyle),this.insertNewStyleBlock(u,m,y)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(o){this.compositionStart=o.target.selectionStart,this.compositionEnd=o.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(t.copiedText=this.getSelectedText(),t.disableStyleCopyPaste?t.copiedTextStyle=null:t.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(o){return o&&o.clipboardData||t.window.clipboardData},_getWidthBeforeCursor:function(o,a){var c=this._getLineLeftOffset(o),f;return a>0&&(f=this.__charBounds[o][a-1],c+=f.left+f.width),c},getDownCursorOffset:function(o,a){var c=this._getSelectionForOffset(o,a),f=this.get2DCursorLocation(c),h=f.lineIndex;if(h===this._textLines.length-1||o.metaKey||o.keyCode===34)return this._text.length-c;var d=f.charIndex,u=this._getWidthBeforeCursor(h,d),p=this._getIndexOnLine(h+1,u),m=this._textLines[h].slice(d);return m.length+p+1+this.missingNewlineOffset(h)},_getSelectionForOffset:function(o,a){return o.shiftKey&&this.selectionStart!==this.selectionEnd&&a?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(o,a){var c=this._getSelectionForOffset(o,a),f=this.get2DCursorLocation(c),h=f.lineIndex;if(h===0||o.metaKey||o.keyCode===33)return-c;var d=f.charIndex,u=this._getWidthBeforeCursor(h,d),p=this._getIndexOnLine(h-1,u),m=this._textLines[h].slice(0,d),g=this.missingNewlineOffset(h-1);return-this._textLines[h-1].length+p-m.length+(1-g)},_getIndexOnLine:function(o,a){for(var c=this._textLines[o],f=this._getLineLeftOffset(o),h=f,d=0,u,p,m=0,g=c.length;m<g;m++)if(u=this.__charBounds[o][m].width,h+=u,h>a){p=!0;var x=h-u,y=h,w=Math.abs(x-a),_=Math.abs(y-a);d=_<w?m:m-1;break}return p||(d=c.length-1),d},moveCursorDown:function(o){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",o)},moveCursorUp:function(o){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",o)},_moveCursorUpOrDown:function(o,a){var c="get"+o+"CursorOffset",f=this[c](a,this._selectionDirection==="right");a.shiftKey?this.moveCursorWithShift(f):this.moveCursorWithoutShift(f),f!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(o){var a=this._selectionDirection==="left"?this.selectionStart+o:this.selectionEnd+o;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,a),o!==0},moveCursorWithoutShift:function(o){return o<0?(this.selectionStart+=o,this.selectionEnd=this.selectionStart):(this.selectionEnd+=o,this.selectionStart=this.selectionEnd),o!==0},moveCursorLeft:function(o){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",o)},_move:function(o,a,c){var f;if(o.altKey)f=this["findWordBoundary"+c](this[a]);else if(o.metaKey||o.keyCode===35||o.keyCode===36)f=this["findLineBoundary"+c](this[a]);else return this[a]+=c==="Left"?-1:1,!0;if(typeof f<"u"&&this[a]!==f)return this[a]=f,!0},_moveLeft:function(o,a){return this._move(o,a,"Left")},_moveRight:function(o,a){return this._move(o,a,"Right")},moveCursorLeftWithoutShift:function(o){var a=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(a=this._moveLeft(o,"selectionStart")),this.selectionEnd=this.selectionStart,a},moveCursorLeftWithShift:function(o){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(o,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(o,"selectionStart")},moveCursorRight:function(o){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",o)},_moveCursorLeftOrRight:function(o,a){var c="moveCursor"+o+"With";this._currentCursorOpacity=1,a.shiftKey?c+="Shift":c+="outShift",this[c](a)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(o){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(o,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(o,"selectionEnd")},moveCursorRightWithoutShift:function(o){var a=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(a=this._moveRight(o,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,a},removeChars:function(o,a){typeof a>"u"&&(a=o+1),this.removeStyleFromTo(o,a),this._text.splice(o,a-o),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(o,a,c,f){typeof f>"u"&&(f=c),f>c&&this.removeStyleFromTo(c,f);var h=t.util.string.graphemeSplit(o);this.insertNewStyleBlock(h,c,a),this._text=[].concat(this._text.slice(0,c),h,this._text.slice(f)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var o=t.util.toFixed,a=t.util.radiansToDegrees,c=t.util.calcRotateMatrix,f=t.util.transformPoint,h=/  +/g;t.util.object.extend(t.Text.prototype,{_toSVG:function(){var d=this._getSVGLeftTopOffsets(),u=this._getSVGTextAndBg(d.textTop,d.textLeft);return this._wrapSVGTextAndBg(u)},toSVG:function(d){var u=this._createBaseSVGMarkup(this._toSVG(),{reviver:d,noStyle:!0,withShadow:!0}),p=this.path;return p?u+p._createBaseSVGMarkup(p._toSVG(),{reviver:d,withShadow:!0}):u},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(d){var u=!0,p=this.getSvgTextDecoration(this);return[d.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",p?'text-decoration="'+p+'" ':"",'style="',this.getSvgStyles(u),'"',this.addPaintOrder()," >",d.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(d,u){var p=[],m=[],g=d,x;this._setSVGBg(m);for(var y=0,w=this._textLines.length;y<w;y++)x=this._getLineLeftOffset(y),(this.textBackgroundColor||this.styleHas("textBackgroundColor",y))&&this._setSVGTextLineBg(m,y,u+x,g),this._setSVGTextLineText(p,y,u+x,g),g+=this.getHeightOfLine(y);return{textSpans:p,textBgRects:m}},_createTextCharSpan:function(d,u,p,m,g){var x=d!==d.trim()||d.match(h),y=this.getSvgSpanStyles(u,x),w=y?'style="'+y+'"':"",_=u.deltaY,C="",E=t.Object.NUM_FRACTION_DIGITS,T="";if(_&&(C=' dy="'+o(_,E)+'" '),g.renderLeft!==void 0){var A=g.angle;T=' rotate="'+o(a(A),t.Object.NUM_FRACTION_DIGITS)+'" ';var j=g.width/2,B=c({angle:a(A)});B[4]=g.renderLeft,B[5]=g.renderTop;var F=f({x:-j,y:0},B);p=F.x,m=F.y}return['<tspan x="',o(p,E),'" y="',o(m,E),'" ',C,w,T,">",t.util.string.escapeXml(d),"</tspan>"].join("")},_setSVGTextLineText:function(d,u,p,m){var g=this.getHeightOfLine(u),x=this.textAlign.indexOf("justify")!==-1,y,w,_="",C,E,T=0,A=this._textLines[u],j;m+=g*(1-this._fontSizeFraction)/this.lineHeight;for(var B=0,F=A.length-1;B<=F;B++)j=B===F||this.charSpacing||this.path,_+=A[B],C=this.__charBounds[u][B],T===0?(p+=C.kernedWidth-C.width,T+=C.width):T+=C.kernedWidth,x&&!j&&this._reSpaceAndTab.test(A[B])&&(j=!0),j||(y=y||this.getCompleteStyleDeclaration(u,B),w=this.getCompleteStyleDeclaration(u,B+1),j=t.util.hasStyleChanged(y,w,!0)),j&&(E=this._getStyleDeclaration(u,B)||{},d.push(this._createTextCharSpan(_,E,p,m,C)),_="",y=w,p+=T,T=0)},_pushTextBgRect:function(d,u,p,m,g,x){var y=t.Object.NUM_FRACTION_DIGITS;d.push("		<rect ",this._getFillAttributes(u),' x="',o(p,y),'" y="',o(m,y),'" width="',o(g,y),'" height="',o(x,y),`"></rect>
`)},_setSVGTextLineBg:function(d,u,p,m){for(var g=this._textLines[u],x=this.getHeightOfLine(u)/this.lineHeight,y=0,w=0,_,C,E=this.getValueOfPropertyAt(u,0,"textBackgroundColor"),T=0,A=g.length;T<A;T++)_=this.__charBounds[u][T],C=this.getValueOfPropertyAt(u,T,"textBackgroundColor"),C!==E?(E&&this._pushTextBgRect(d,E,p+w,m,y,x),w=_.left,y=_.width,E=C):y+=_.kernedWidth;C&&this._pushTextBgRect(d,C,p+w,m,y,x)},_getFillAttributes:function(d){var u=d&&typeof d=="string"?new t.Color(d):"";return!u||!u.getSource()||u.getAlpha()===1?'fill="'+d+'"':'opacity="'+u.getAlpha()+'" fill="'+u.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(d){for(var u=0,p=0,m=0;m<d;m++)u+=this.getHeightOfLine(m);return p=this.getHeightOfLine(m),{lineTop:u,offset:(this._fontSizeMult-this._fontSizeFraction)*p/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(d){var u=t.Object.prototype.getSvgStyles.call(this,d);return u+" white-space: pre;"}})}(),function(o){var a=o.fabric||(o.fabric={});a.Textbox=a.util.createClass(a.IText,a.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:a.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(c){for(var f=0,h=0,d=0,u={},p=0;p<c.graphemeLines.length;p++)c.graphemeText[d]===`
`&&p>0?(h=0,d++,f++):!this.splitByGrapheme&&this._reSpaceAndTab.test(c.graphemeText[d])&&p>0&&(h++,d++),u[p]={line:f,offset:h},d+=c.graphemeLines[p].length,h+=c.graphemeLines[p].length;return u},styleHas:function(c,f){if(this._styleMap&&!this.isWrapping){var h=this._styleMap[f];h&&(f=h.line)}return a.Text.prototype.styleHas.call(this,c,f)},isEmptyStyles:function(c){if(!this.styles)return!0;var f=0,h=c+1,d,u,p=!1,m=this._styleMap[c],g=this._styleMap[c+1];m&&(c=m.line,f=m.offset),g&&(h=g.line,p=h===c,d=g.offset),u=typeof c>"u"?this.styles:{line:this.styles[c]};for(var x in u)for(var y in u[x])if(y>=f&&(!p||y<d))for(var w in u[x][y])return!1;return!0},_getStyleDeclaration:function(c,f){if(this._styleMap&&!this.isWrapping){var h=this._styleMap[c];if(!h)return null;c=h.line,f=h.offset+f}return this.callSuper("_getStyleDeclaration",c,f)},_setStyleDeclaration:function(c,f,h){var d=this._styleMap[c];c=d.line,f=d.offset+f,this.styles[c][f]=h},_deleteStyleDeclaration:function(c,f){var h=this._styleMap[c];c=h.line,f=h.offset+f,delete this.styles[c][f]},_getLineStyle:function(c){var f=this._styleMap[c];return!!this.styles[f.line]},_setLineStyle:function(c){var f=this._styleMap[c];this.styles[f.line]={}},_wrapText:function(c,f){var h=[],d;for(this.isWrapping=!0,d=0;d<c.length;d++)h=h.concat(this._wrapLine(c[d],d,f));return this.isWrapping=!1,h},_measureWord:function(c,f,h){var d=0,u,p=!0;h=h||0;for(var m=0,g=c.length;m<g;m++){var x=this._getGraphemeBox(c[m],f,m+h,u,p);d+=x.kernedWidth,u=c[m]}return d},_wrapLine:function(c,f,h,B){var u=0,p=this.splitByGrapheme,m=[],g=[],x=p?a.util.string.graphemeSplit(c):c.split(this._wordJoiners),y="",w=0,_=p?"":" ",C=0,E=0,T=0,A=!0,j=this._getWidthOfCharSpacing(),B=B||0;x.length===0&&x.push([]),h-=B;for(var F=0;F<x.length;F++)y=p?x[F]:a.util.string.graphemeSplit(x[F]),C=this._measureWord(y,f,w),w+=y.length,u+=E+C-j,u>h&&!A?(m.push(g),g=[],u=C,A=!0):u+=j,!A&&!p&&g.push(_),g=g.concat(y),E=p?0:this._measureWord([_],f,w),w++,A=!1,C>T&&(T=C);return F&&m.push(g),T+B>this.dynamicMinWidth&&(this.dynamicMinWidth=T-j+B),m},isEndOfWrapping:function(c){return!this._styleMap[c+1]||this._styleMap[c+1].line!==this._styleMap[c].line},missingNewlineOffset:function(c,f){return this.splitByGrapheme&&!f?this.isEndOfWrapping(c)?1:0:1},_splitTextIntoLines:function(c){for(var f=a.Text.prototype._splitTextIntoLines.call(this,c),h=this._wrapText(f.lines,this.width),d=new Array(h.length),u=0;u<h.length;u++)d[u]=h[u].join("");return f.lines=d,f.graphemeLines=h,f},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var c={};for(var f in this._styleMap)this._textLines[f]&&(c[this._styleMap[f].line]=1);for(var f in this.styles)c[f]||delete this.styles[f]},toObject:function(c){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(c))}}),a.Textbox.fromObject=function(c,f){var h=a.util.stylesFromArray(c.styles,c.text),d=Object.assign({},c,{styles:h});return delete d.path,a.Object._fromObject("Textbox",d,function(u){c.path?a.Object._fromObject("Path",c.path,function(p){u.set("path",p),f(u)},"path"):f(u)},"text")}}(e),function(){var o=t.controlsUtils,a=o.scaleSkewCursorStyleHandler,c=o.scaleCursorStyleHandler,f=o.scalingEqually,h=o.scalingYOrSkewingX,d=o.scalingXOrSkewingY,u=o.scaleOrSkewActionName,p=t.Object.prototype.controls;if(p.ml=new t.Control({x:-.5,y:0,cursorStyleHandler:a,actionHandler:d,getActionName:u}),p.mr=new t.Control({x:.5,y:0,cursorStyleHandler:a,actionHandler:d,getActionName:u}),p.mb=new t.Control({x:0,y:.5,cursorStyleHandler:a,actionHandler:h,getActionName:u}),p.mt=new t.Control({x:0,y:-.5,cursorStyleHandler:a,actionHandler:h,getActionName:u}),p.tl=new t.Control({x:-.5,y:-.5,cursorStyleHandler:c,actionHandler:f}),p.tr=new t.Control({x:.5,y:-.5,cursorStyleHandler:c,actionHandler:f}),p.bl=new t.Control({x:-.5,y:.5,cursorStyleHandler:c,actionHandler:f}),p.br=new t.Control({x:.5,y:.5,cursorStyleHandler:c,actionHandler:f}),p.mtr=new t.Control({x:0,y:-.5,actionHandler:o.rotationWithSnapping,cursorStyleHandler:o.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),t.Textbox){var m=t.Textbox.prototype.controls={};m.mtr=p.mtr,m.tr=p.tr,m.br=p.br,m.tl=p.tl,m.bl=p.bl,m.mt=p.mt,m.mb=p.mb,m.mr=new t.Control({x:.5,y:0,actionHandler:o.changeWidth,cursorStyleHandler:a,actionName:"resizing"}),m.ml=new t.Control({x:-.5,y:0,actionHandler:o.changeWidth,cursorStyleHandler:a,actionName:"resizing"})}}()})(zt);function Qg(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function NO(e,t,r,n){function i(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function o(f){try{c(n.next(f))}catch(h){l(h)}}function a(f){try{c(n.throw(f))}catch(h){l(h)}}function c(f){f.done?s(f.value):i(f.value).then(o,a)}c((n=n.apply(e,t||[])).next())})}const AO=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class H2 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class OO extends H2{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class B_ extends H2{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class U_ extends H2{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var lv;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(lv||(lv={}));class PO{constructor(t,{headers:r={},customFetch:n,region:i=lv.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=AO(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return NO(this,arguments,void 0,function*(r,n={}){var i;let s,l;try{const{headers:o,method:a,body:c,signal:f,timeout:h}=n;let d={},{region:u}=n;u||(u=this.region);const p=new URL(`${this.url}/${r}`);u&&u!=="any"&&(d["x-region"]=u,p.searchParams.set("forceFunctionRegion",u));let m;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",m=c):typeof c=="string"?(d["Content-Type"]="text/plain",m=c):typeof FormData<"u"&&c instanceof FormData?m=c:(d["Content-Type"]="application/json",m=JSON.stringify(c)):c&&typeof c!="string"&&!(typeof Blob<"u"&&c instanceof Blob)&&!(c instanceof ArrayBuffer)&&!(typeof FormData<"u"&&c instanceof FormData)?m=JSON.stringify(c):m=c;let g=f;h&&(l=new AbortController,s=setTimeout(()=>l.abort(),h),f?(g=l.signal,f.addEventListener("abort",()=>l.abort())):g=l.signal);const x=yield this.fetch(p.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),o),body:m,signal:g}).catch(C=>{throw new OO(C)}),y=x.headers.get("x-relay-error");if(y&&y==="true")throw new B_(x);if(!x.ok)throw new U_(x);let w=((i=x.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),_;return w==="application/json"?_=yield x.json():w==="application/octet-stream"||w==="application/pdf"?_=yield x.blob():w==="text/event-stream"?_=x:w==="multipart/form-data"?_=yield x.formData():_=yield x.text(),{data:_,error:null,response:x}}catch(o){return{data:null,error:o,response:o instanceof U_||o instanceof B_?o.context:void 0}}finally{s&&clearTimeout(s)}})}}var FO=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},jO=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{let l=null,o=null,a=null,c=s.status,f=s.statusText;if(s.ok){var h,d;if(r.method!=="HEAD"){var u;const x=await s.text();x===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((u=r.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?o=x:o=JSON.parse(x))}const m=(h=r.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),g=(d=s.headers.get("content-range"))===null||d===void 0?void 0:d.split("/");m&&g&&g.length>1&&(a=parseInt(g[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(o)&&(o.length>1?(l={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,a=null,c=406,f="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var p;const m=await s.text();try{l=JSON.parse(m),Array.isArray(l)&&s.status===404&&(o=[],l=null,c=200,f="OK")}catch{s.status===404&&m===""?(c=204,f="No Content"):l={message:m}}if(l&&r.isMaybeSingle&&(!(l==null||(p=l.details)===null||p===void 0)&&p.includes("0 rows"))&&(l=null,c=200,f="OK"),l&&r.shouldThrowOnError)throw new FO(l)}return{error:l,data:o,count:a,status:c,statusText:f}});return this.shouldThrowOnError||(i=i.catch(s=>{var l;let o="";const a=s==null?void 0:s.cause;if(a){var c,f,h,d;const p=(c=a==null?void 0:a.message)!==null&&c!==void 0?c:"",m=(f=a==null?void 0:a.code)!==null&&f!==void 0?f:"";o=`${(h=s==null?void 0:s.name)!==null&&h!==void 0?h:"FetchError"}: ${s==null?void 0:s.message}`,o+=`

Caused by: ${(d=a==null?void 0:a.name)!==null&&d!==void 0?d:"Error"}: ${p}`,m&&(o+=` (${m})`),a!=null&&a.stack&&(o+=`
${a.stack}`)}else{var u;o=(u=s==null?void 0:s.stack)!==null&&u!==void 0?u:""}return{error:{message:`${(l=s==null?void 0:s.name)!==null&&l!==void 0?l:"FetchError"}: ${s==null?void 0:s.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}},DO=class extends jO{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const s=i?`${i}.order`:"order",l=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"offset":`${n}.offset`,s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(s,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:s="text"}={}){var l;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),a=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${s}; for="${a}"; options=${o};`),s==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const W_=new RegExp("[,()]");var Eu=class extends DO{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&W_.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&W_.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const s=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${s}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},LO=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:n}=t??{},i=r?"HEAD":"GET";let s=!1;const l=(e??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join(""),{url:o,headers:a}=this.cloneRequestState();return o.searchParams.set("select",l),n&&a.append("Prefer",`count=${n}`),new Eu({method:i,url:o,headers:a,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const i="POST",{url:s,headers:l}=this.cloneRequestState();if(t&&l.append("Prefer",`count=${t}`),r||l.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((a,c)=>a.concat(Object.keys(c)),[]);if(o.length>0){const a=[...new Set(o)].map(c=>`"${c}"`);s.searchParams.set("columns",a.join(","))}}return new Eu({method:i,url:s,headers:l,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){var s;const l="POST",{url:o,headers:a}=this.cloneRequestState();if(a.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&o.searchParams.set("on_conflict",t),n&&a.append("Prefer",`count=${n}`),i||a.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((f,h)=>f.concat(Object.keys(h)),[]);if(c.length>0){const f=[...new Set(c)].map(h=>`"${h}"`);o.searchParams.set("columns",f.join(","))}}return new Eu({method:l,url:o,headers:a,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}update(e,{count:t}={}){var r;const n="PATCH",{url:i,headers:s}=this.cloneRequestState();return t&&s.append("Prefer",`count=${t}`),new Eu({method:n,url:i,headers:s,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:n,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new Eu({method:r,url:n,headers:i,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},IO=class r3{constructor(t,{headers:r={},schema:n,fetch:i}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=i}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new LO(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new r3(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:i=!1,count:s}={}){var l;let o;const a=new URL(`${this.url}/rpc/${t}`);let c;const f=u=>u!==null&&typeof u=="object"&&(!Array.isArray(u)||u.some(f)),h=n&&Object.values(r).some(f);h?(o="POST",c=r):n||i?(o=n?"HEAD":"GET",Object.entries(r).filter(([u,p])=>p!==void 0).map(([u,p])=>[u,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([u,p])=>{a.searchParams.append(u,p)})):(o="POST",c=r);const d=new Headers(this.headers);return h?d.set("Prefer",s?`count=${s},return=minimal`:"return=minimal"):s&&d.set("Prefer",`count=${s}`),new Eu({method:o,url:a,headers:d,schema:this.schemaName,body:c,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}};class RO{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const n=r.versions;if(n&&n.node){const i=n.node,s=parseInt(i.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const MO="2.93.1",BO=`realtime-js/${MO}`,UO="1.0.0",n3="2.0.0",z_=n3,cv=1e4,WO=1e3,zO=100;var cl;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(cl||(cl={}));var Vn;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Vn||(Vn={}));var da;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(da||(da={}));var uv;(function(e){e.websocket="websocket"})(uv||(uv={}));var hc;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(hc||(hc={}));class HO{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},l=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(t,r,n){var i,s;const l=t.topic,o=(i=t.ref)!==null&&i!==void 0?i:"",a=(s=t.join_ref)!==null&&s!==void 0?s:"",c=t.payload.event,f=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},h=Object.keys(f).length===0?"":JSON.stringify(f);if(a.length>255)throw new Error(`joinRef length ${a.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const d=this.USER_BROADCAST_PUSH_META_LENGTH+a.length+o.length+l.length+c.length+h.length,u=new ArrayBuffer(this.HEADER_LENGTH+d);let p=new DataView(u),m=0;p.setUint8(m++,this.KINDS.userBroadcastPush),p.setUint8(m++,a.length),p.setUint8(m++,o.length),p.setUint8(m++,l.length),p.setUint8(m++,c.length),p.setUint8(m++,h.length),p.setUint8(m++,r),Array.from(a,x=>p.setUint8(m++,x.charCodeAt(0))),Array.from(o,x=>p.setUint8(m++,x.charCodeAt(0))),Array.from(l,x=>p.setUint8(m++,x.charCodeAt(0))),Array.from(c,x=>p.setUint8(m++,x.charCodeAt(0))),Array.from(h,x=>p.setUint8(m++,x.charCodeAt(0)));var g=new Uint8Array(u.byteLength+n.byteLength);return g.set(new Uint8Array(u),0),g.set(new Uint8Array(n),u.byteLength),g.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[i,s,l,o,a]=n;return r({join_ref:i,ref:s,topic:l,event:o,payload:a})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,i)}}_decodeUserBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2),l=r.getUint8(3),o=r.getUint8(4);let a=this.HEADER_LENGTH+4;const c=n.decode(t.slice(a,a+i));a=a+i;const f=n.decode(t.slice(a,a+s));a=a+s;const h=n.decode(t.slice(a,a+l));a=a+l;const d=t.slice(a,t.byteLength),u=o===this.JSON_ENCODING?JSON.parse(n.decode(d)):d,p={type:this.BROADCAST_EVENT,event:f,payload:u};return l>0&&(p.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class i3{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ir;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Ir||(Ir={}));const H_=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((s,l)=>(s[l]=$O(l,e,t,i),s),{}):{}},$O=(e,t,r,n)=>{const i=t.find(o=>o.name===e),s=i==null?void 0:i.type,l=r[e];return s&&!n.includes(s)?s3(s,l):fv(l)},s3=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return XO(t,r)}switch(e){case Ir.bool:return VO(t);case Ir.float4:case Ir.float8:case Ir.int2:case Ir.int4:case Ir.int8:case Ir.numeric:case Ir.oid:return qO(t);case Ir.json:case Ir.jsonb:return GO(t);case Ir.timestamp:return YO(t);case Ir.abstime:case Ir.date:case Ir.daterange:case Ir.int4range:case Ir.int8range:case Ir.money:case Ir.reltime:case Ir.text:case Ir.time:case Ir.timestamptz:case Ir.timetz:case Ir.tsrange:case Ir.tstzrange:return fv(t);default:return fv(t)}},fv=e=>e,VO=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},qO=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},GO=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},XO=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const l=e.slice(1,r);try{s=JSON.parse("["+l+"]")}catch{s=l?l.split(","):[]}return s.map(o=>s3(t,o))}return e},YO=e=>typeof e=="string"?e.replace(" ","T"):e,a3=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class bm{constructor(t,r,n={},i=cv){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var $_;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})($_||($_={}));class Dh{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:l,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Dh.syncState(this.state,i,s,l),this.pendingDiffs.forEach(a=>{this.state=Dh.syncDiff(this.state,a,s,l)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:l,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Dh.syncDiff(this.state,i,s,l),o())}),this.onJoin((i,s,l)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:l})}),this.onLeave((i,s,l)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const s=this.cloneDeep(t),l=this.transformState(r),o={},a={};return this.map(s,(c,f)=>{l[c]||(a[c]=f)}),this.map(l,(c,f)=>{const h=s[c];if(h){const d=f.map(g=>g.presence_ref),u=h.map(g=>g.presence_ref),p=f.filter(g=>u.indexOf(g.presence_ref)<0),m=h.filter(g=>d.indexOf(g.presence_ref)<0);p.length>0&&(o[c]=p),m.length>0&&(a[c]=m)}else o[c]=f}),this.syncDiff(s,{joins:o,leaves:a},n,i)}static syncDiff(t,r,n,i){const{joins:s,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(o,a)=>{var c;const f=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(a),f.length>0){const h=t[o].map(u=>u.presence_ref),d=f.filter(u=>h.indexOf(u.presence_ref)<0);t[o].unshift(...d)}n(o,f,a)}),this.map(l,(o,a)=>{let c=t[o];if(!c)return;const f=a.map(h=>h.presence_ref);c=c.filter(h=>f.indexOf(h.presence_ref)<0),t[o]=c,i(o,c,a),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var V_;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(V_||(V_={}));var Lh;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Lh||(Lh={}));var vo;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(vo||(vo={}));class $u{constructor(t,r={config:{}},n){var i,s;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Vn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new bm(this,da.join,this.params,this.timeout),this.rejoinTimer=new i3(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Vn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Vn.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Vn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Vn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Vn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(da.reply,{},(l,o)=>{this._trigger(this._replyEventName(o),l)}),this.presence=new Dh(this),this.broadcastEndpointURL=a3(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Vn.closed){const{config:{broadcast:l,presence:o,private:a}}=this.params,c=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&i!==void 0?i:[],f=!!this.bindings[Lh.PRESENCE]&&this.bindings[Lh.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,h={},d={broadcast:l,presence:Object.assign(Object.assign({},o),{enabled:f}),postgres_changes:c,private:a};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(u=>t==null?void 0:t(vo.CHANNEL_ERROR,u)),this._onClose(()=>t==null?void 0:t(vo.CLOSED)),this.updateJoinPayload(Object.assign({config:d},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var p;if(this.socket._isManualToken()||this.socket.setAuth(),u===void 0){t==null||t(vo.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,g=(p=m==null?void 0:m.length)!==null&&p!==void 0?p:0,x=[];for(let y=0;y<g;y++){const w=m[y],{filter:{event:_,schema:C,table:E,filter:T}}=w,A=u&&u[y];if(A&&A.event===_&&$u.isFilterValueEqual(A.schema,C)&&$u.isFilterValueEqual(A.table,E)&&$u.isFilterValueEqual(A.filter,T))x.push(Object.assign(Object.assign({},w),{id:A.id}));else{this.unsubscribe(),this.state=Vn.errored,t==null||t(vo.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(vo.SUBSCRIBED);return}}).receive("error",u=>{this.state=Vn.errored,t==null||t(vo.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(vo.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Vn.joined&&t===Lh.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var i;if(r==null)return Promise.reject("Payload is required for httpSend()");const s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(o.status===202)return{success:!0};let a=o.statusText;try{const c=await o.json();a=c.error||c.message||a}catch{}return Promise.reject(new Error(a))}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:l}=t,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:l,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var l,o,a;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((a=(o=(l=this.params)===null||l===void 0?void 0:l.config)===null||o===void 0?void 0:o.broadcast)===null||a===void 0)&&a.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Vn.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(da.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new bm(this,da.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Vn.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),l}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new bm(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>zO){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,s;const l=t.toLocaleLowerCase(),{close:o,error:a,leave:c,join:f}=da;if(n&&[o,a,c,f].indexOf(l)>=0&&n!==this._joinRef())return;let d=this._onMessage(l,r,n);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(u=>{var p,m,g;return((p=u.filter)===null||p===void 0?void 0:p.event)==="*"||((g=(m=u.filter)===null||m===void 0?void 0:m.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===l}).map(u=>u.callback(d,n)):(s=this.bindings[l])===null||s===void 0||s.filter(u=>{var p,m,g,x,y,w;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in u){const _=u.id,C=(p=u.filter)===null||p===void 0?void 0:p.event;return _&&((m=r.ids)===null||m===void 0?void 0:m.includes(_))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const _=(y=(x=u==null?void 0:u.filter)===null||x===void 0?void 0:x.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return _==="*"||_===((w=r==null?void 0:r.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return u.type.toLocaleLowerCase()===l}).map(u=>{if(typeof d=="object"&&"ids"in d){const p=d.data,{schema:m,table:g,commit_timestamp:x,type:y,errors:w}=p;d=Object.assign(Object.assign({},{schema:m,table:g,commit_timestamp:x,eventType:y,new:{},old:{},errors:w}),this._getPayloadRecords(p))}u.callback(d,n)})}_isClosed(){return this.state===Vn.closed}_isJoined(){return this.state===Vn.joined}_isJoining(){return this.state===Vn.joining}_isLeaving(){return this.state===Vn.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&$u.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(da.close,{},t)}_onError(t){this._on(da.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Vn.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=H_(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=H_(t.columns,t.old_record)),r}}const Sm=()=>{},q0={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},KO=[1e3,2e3,5e3,1e4],JO=1e4,QO=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ZO{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=cv,this.transport=null,this.heartbeatIntervalMs=q0.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Sm,this.ref=0,this.reconnectTimer=null,this.vsn=z_,this.logger=Sm,this.conn=null,this.sendBuffer=[],this.serializer=new HO,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=i=>i?(...s)=>i(...s):(...s)=>fetch(...s),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${uv.websocket}`,this.httpEndpoint=a3(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=RO.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case cl.connecting:return hc.Connecting;case cl.open:return hc.Open;case cl.closing:return hc.Closing;default:return hc.Closed}}isConnected(){return this.connectionState()===hc.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new $u(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:i,ref:s}=t,l=()=>{this.encode(t,o=>{var a;(a=this.conn)===null||a===void 0||a.send(o)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(WO,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},q0.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const c=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",c)}catch(f){this.log("error","error in heartbeat callback",f)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:i,payload:s,ref:l}=r,o=l?`(${l})`:"",a=s.status||"";this.log("receive",`${a} ${n} ${i} ${o}`.trim(),s),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(i,s,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===cl.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===cl.open||this.conn.readyState===cl.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t);try{this.heartbeatCallback("error")}catch(r){this.log("error","error in heartbeat callback",r)}}_triggerChanError(){this.channels.forEach(t=>t._trigger(da.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([QO],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(i=>{const s={access_token:r,version:BO};r&&i.updateJoinPayload(s),i.joinedOnce&&i._isJoined()&&i._push(da.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new i3(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},q0.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,s,l,o,a,c,f,h,d,u;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:cv,this.heartbeatIntervalMs=(i=t==null?void 0:t.heartbeatIntervalMs)!==null&&i!==void 0?i:q0.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(l=t==null?void 0:t.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:Sm,this.vsn=(a=t==null?void 0:t.vsn)!==null&&a!==void 0?a:z_,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:p=>KO[p-1]||JO,this.vsn){case UO:this.encode=(f=t==null?void 0:t.encode)!==null&&f!==void 0?f:(p,m)=>m(JSON.stringify(p)),this.decode=(h=t==null?void 0:t.decode)!==null&&h!==void 0?h:(p,m)=>m(JSON.parse(p));break;case n3:this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:this.serializer.encode.bind(this.serializer),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var dd=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function eP(e,t,r){const n=new URL(t,e);if(r)for(const[i,s]of Object.entries(r))s!==void 0&&n.searchParams.set(i,s);return n.toString()}async function tP(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function rP(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:i,body:s,headers:l}){const o=eP(e.baseUrl,n,i),a=await tP(e.auth),c=await t(o,{method:r,headers:{...s?{"Content-Type":"application/json"}:{},...a,...l},body:s?JSON.stringify(s):void 0}),f=await c.text(),h=(c.headers.get("content-type")||"").includes("application/json"),d=h&&f?JSON.parse(f):f;if(!c.ok){const u=h?d:void 0,p=u==null?void 0:u.error;throw new dd((p==null?void 0:p.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:p==null?void 0:p.type,icebergCode:p==null?void 0:p.code,details:u})}return{status:c.status,headers:c.headers,data:d}}}}function G0(e){return e.join("")}var nP=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:G0(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${G0(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${G0(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${G0(e.namespace)}`}),!0}catch(t){if(t instanceof dd&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof dd&&r.status===409)return;throw r}}};function du(e){return e.join("")}var iP=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${du(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${du(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${du(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${du(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${du(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${du(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof dd&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof dd&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},sP=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=rP({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new nP(this.client,t),this.tableOps=new iP(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},Zg=class extends Error{constructor(e,t="storage",r,n){super(e),this.__isStorageError=!0,this.namespace=t,this.name=t==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=n}};function e1(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var X0=class extends Zg{constructor(e,t,r,n="storage"){super(e,n,t,r),this.name=n==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},o3=class extends Zg{constructor(e,t,r="storage"){super(e,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const aP=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),oP=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},hv=e=>{if(Array.isArray(e))return e.map(r=>hv(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=hv(n)}),t},lP=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function pd(e){"@babel/helpers - typeof";return pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pd(e)}function cP(e,t){if(pd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(pd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uP(e){var t=cP(e,"string");return pd(t)=="symbol"?t:t+""}function fP(e,t,r){return(t=uP(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Wt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?q_(Object(r),!0).forEach(function(n){fP(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const G_=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},hP=async(e,t,r,n)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const i=e,s=i.status||500;if(typeof i.json=="function")i.json().then(l=>{const o=(l==null?void 0:l.statusCode)||(l==null?void 0:l.code)||s+"";t(new X0(G_(l),s,o,n))}).catch(()=>{if(n==="vectors"){const l=s+"";t(new X0(i.statusText||`HTTP ${s} error`,s,l,n))}else{const l=s+"";t(new X0(i.statusText||`HTTP ${s} error`,s,l,n))}});else{const l=s+"";t(new X0(i.statusText||`HTTP ${s} error`,s,l,n))}}else t(new o3(G_(e),e,n))},dP=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||e==="HEAD"||!n?Wt(Wt({},i),r):(oP(n)?(i.headers=Wt({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,t!=null&&t.duplex&&(i.duplex=t.duplex),Wt(Wt({},i),r))};async function uh(e,t,r,n,i,s,l){return new Promise((o,a)=>{e(r,dP(t,n,i,s)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;if(l==="vectors"){const f=c.headers.get("content-type");if(!f||!f.includes("application/json"))return{}}return c.json()}).then(c=>o(c)).catch(c=>hP(c,a,n,l))})}function pP(e="storage"){return{get:async(t,r,n,i)=>uh(t,"GET",r,n,i,void 0,e),post:async(t,r,n,i,s)=>uh(t,"POST",r,i,s,n,e),put:async(t,r,n,i,s)=>uh(t,"PUT",r,i,s,n,e),head:async(t,r,n,i)=>uh(t,"HEAD",r,Wt(Wt({},n),{},{noResolveJson:!0}),i,void 0,e),remove:async(t,r,n,i,s)=>uh(t,"DELETE",r,i,s,n,e)}}const gP=pP("storage"),{get:gd,post:Xr,put:dv,head:mP,remove:$2}=gP;var Cf=class{constructor(e,t={},r,n="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=aP(r),this.namespace=n}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){var t=this;try{return{data:await e(),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(e1(r))return{data:null,error:r};throw r}}},xP=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(e1(t))return{data:null,error:t};throw t}}};let l3;l3=Symbol.toStringTag;var vP=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[l3]="BlobDownloadBuilder",this.promise=null}asStream(){return new xP(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(e1(t))return{data:null,error:t};throw t}}};const yP={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},X_={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var wP=class extends Cf{constructor(e,t={},r,n){super(e,t,n,"storage"),this.bucketId=r}async uploadOrUpdate(e,t,r,n){var i=this;return i.handleOperation(async()=>{let s;const l=Wt(Wt({},X_),n);let o=Wt(Wt({},i.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const a=l.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",l.cacheControl),a&&s.append("metadata",i.encodeMetadata(a)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.has("cacheControl")||s.append("cacheControl",l.cacheControl),a&&!s.has("metadata")&&s.append("metadata",i.encodeMetadata(a))):(s=r,o["cache-control"]=`max-age=${l.cacheControl}`,o["content-type"]=l.contentType,a&&(o["x-metadata"]=i.toBase64(i.encodeMetadata(a))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!l.duplex&&(l.duplex="half")),n!=null&&n.headers&&(o=Wt(Wt({},o),n.headers));const c=i._removeEmptyFolders(t),f=i._getFinalPath(c),h=await(e=="PUT"?dv:Xr)(i.fetch,`${i.url}/object/${f}`,s,Wt({headers:o},l!=null&&l.duplex?{duplex:l.duplex}:{}));return{path:c,id:h.Id,fullPath:h.Key}})}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var i=this;const s=i._removeEmptyFolders(e),l=i._getFinalPath(s),o=new URL(i.url+`/object/upload/sign/${l}`);return o.searchParams.set("token",t),i.handleOperation(async()=>{let a;const c=Wt({upsert:X_.upsert},n),f=Wt(Wt({},i.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",c.cacheControl),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.append("cacheControl",c.cacheControl)):(a=r,f["cache-control"]=`max-age=${c.cacheControl}`,f["content-type"]=c.contentType),{path:s,fullPath:(await dv(i.fetch,o.toString(),a,{headers:f})).Key}})}async createSignedUploadUrl(e,t){var r=this;return r.handleOperation(async()=>{let n=r._getFinalPath(e);const i=Wt({},r.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const s=await Xr(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:i}),l=new URL(r.url+s.url),o=l.searchParams.get("token");if(!o)throw new Zg("No token returned by API");return{signedUrl:l.toString(),path:e,token:o}})}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;return n.handleOperation(async()=>await Xr(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}))}async copy(e,t,r){var n=this;return n.handleOperation(async()=>({path:(await Xr(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key}))}async createSignedUrl(e,t,r){var n=this;return n.handleOperation(async()=>{let i=n._getFinalPath(e),s=await Xr(n.fetch,`${n.url}/object/sign/${i}`,Wt({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${n.url}${s.signedURL}${l}`)}})}async createSignedUrls(e,t,r){var n=this;return n.handleOperation(async()=>{const i=await Xr(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i.map(l=>Wt(Wt({},l),{},{signedUrl:l.signedURL?encodeURI(`${n.url}${l.signedURL}${s}`):null}))})}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=n?`?${n}`:"",s=this._getFinalPath(e),l=()=>gd(this.fetch,`${this.url}/${r}/${s}${i}`,{headers:this.headers,noResolveJson:!0});return new vP(l,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);return t.handleOperation(async()=>hv(await gd(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})))}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await mP(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(e1(n)&&n instanceof o3){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const s=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&n.push(l);let o=n.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${r}${o}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await $2(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,r){var n=this;return n.handleOperation(async()=>{const i=Wt(Wt(Wt({},yP),t),{},{prefix:e||""});return await Xr(n.fetch,`${n.url}/object/list/${n.bucketId}`,i,{headers:n.headers},r)})}async listV2(e,t){var r=this;return r.handleOperation(async()=>{const n=Wt({},e);return await Xr(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const _P="2.93.1",zd={"X-Client-Info":`storage-js/${_P}`};var bP=class extends Cf{constructor(e,t={},r,n){const i=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase."));const s=i.href.replace(/\/$/,""),l=Wt(Wt({},zd),t);super(s,l,r,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=t.listBucketOptionsToQueryString(e);return await gd(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await gd(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var r=this;return r.handleOperation(async()=>await Xr(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async updateBucket(e,t){var r=this;return r.handleOperation(async()=>await dv(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await Xr(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await $2(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},SP=class extends Cf{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=Wt(Wt({},zd),t);super(n,i,r,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await Xr(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),i=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return await gd(t.fetch,i,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await $2(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!lP(e))throw new Zg("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new sP({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(i,s){const l=i[s];return typeof l!="function"?l:async(...o)=>{try{return{data:await l.apply(i,o),error:null}}catch(a){if(n)throw a;return{data:null,error:a}}}}})}},kP=class extends Cf{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=Wt(Wt({},zd),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await Xr(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var r=this;return r.handleOperation(async()=>await Xr(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await Xr(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var r=this;return r.handleOperation(async()=>await Xr(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{})}},CP=class extends Cf{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=Wt(Wt({},zd),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await Xr(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await Xr(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return t.handleOperation(async()=>await Xr(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await Xr(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await Xr(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},EP=class extends Cf{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=Wt(Wt({},zd),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await Xr(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await Xr(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await Xr(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await Xr(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},TP=class extends EP{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new NP(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},NP=class extends kP{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new AP(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},AP=class extends CP{constructor(e,t,r,n,i){super(e,t,i),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},OP=class extends bP{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new wP(this.url,this.headers,e,this.fetch)}get vectors(){return new TP(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new SP(this.url+"/iceberg",this.headers,this.fetch)}};const c3="2.93.1",Tu=30*1e3,pv=3,km=pv*Tu,PP="http://localhost:9999",FP="supabase.auth.token",jP={"X-Client-Info":`gotrue-js/${c3}`},gv="X-Supabase-Api-Version",u3={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},DP=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,LP=10*60*1e3;class md extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function jt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class IP extends md{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function RP(e){return jt(e)&&e.name==="AuthApiError"}class dc extends md{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Io extends md{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class gs extends Io{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Cm(e){return jt(e)&&e.name==="AuthSessionMissingError"}class pu extends Io{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Y0 extends Io{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class K0 extends Io{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function MP(e){return jt(e)&&e.name==="AuthImplicitGrantRedirectError"}class Y_ extends Io{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class BP extends Io{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class mv extends Io{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Em(e){return jt(e)&&e.name==="AuthRetryableFetchError"}class K_ extends Io{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class xv extends Io{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const dg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),J_=` 	
\r=`.split(""),UP=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<J_.length;t+=1)e[J_[t].charCodeAt(0)]=-2;for(let t=0;t<dg.length;t+=1)e[dg[t].charCodeAt(0)]=t;return e})();function Q_(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(dg[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(dg[n]),t.queuedBits-=6}}function f3(e,t,r){const n=UP[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Z_(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=l=>{HP(l,n,r)};for(let l=0;l<e.length;l+=1)f3(e.charCodeAt(l),i,s);return t.join("")}function WP(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function zP(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}WP(n,t)}}function HP(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Zu(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)f3(e.charCodeAt(i),r,n);return new Uint8Array(t)}function $P(e){const t=[];return zP(e,r=>t.push(r)),new Uint8Array(t)}function yc(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>Q_(i,r,n)),Q_(null,r,n),t.join("")}function VP(e){return Math.round(Date.now()/1e3)+e}function qP(){return Symbol("auth-callback")}const ui=()=>typeof window<"u"&&typeof document<"u",sc={tested:!1,writable:!1},h3=()=>{if(!ui())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(sc.tested)return sc.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),sc.tested=!0,sc.writable=!0}catch{sc.tested=!0,sc.writable=!1}return sc.writable};function GP(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const d3=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),XP=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Nu=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ac=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ci=async(e,t)=>{await e.removeItem(t)};class t1{constructor(){this.promise=new t1.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}t1.promiseConstructor=Promise;function J0(e){const t=e.split(".");if(t.length!==3)throw new xv("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!DP.test(t[n]))throw new xv("JWT not in base64url format");return{header:JSON.parse(Z_(t[0])),payload:JSON.parse(Z_(t[1])),signature:Zu(t[2]),raw:{header:t[0],payload:t[1]}}}async function YP(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function KP(e,t){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const l=await e(s);if(!t(s,null,l)){n(l);return}}catch(l){if(!t(s,l)){i(l);return}}})()})}function JP(e){return("0"+e.toString(16)).substr(-2)}function QP(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,JP).join("")}async function ZP(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function eF(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await ZP(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function gu(e,t,r=!1){const n=QP();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Nu(e,`${t}-code-verifier`,i);const s=await eF(n);return[s,n===s?"plain":"s256"]}const tF=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function rF(e){const t=e.headers.get(gv);if(!t||!t.match(tF))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function nF(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function iF(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const sF=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function mu(e){if(!sF.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Tm(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function aF(e,t){return new Proxy(e,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,i)}})}function eb(e){return JSON.parse(JSON.stringify(e))}const cc=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),oF=[502,503,504];async function tb(e){var t;if(!XP(e))throw new mv(cc(e),0);if(oF.includes(e.status))throw new mv(cc(e),e.status);let r;try{r=await e.json()}catch(s){throw new dc(cc(s),s)}let n;const i=rF(e);if(i&&i.getTime()>=u3["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new K_(cc(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new gs}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0))throw new K_(cc(r),e.status,r.weak_password.reasons);throw new IP(cc(r),e.status||500,n)}const lF=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function Bt(e,t,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[gv]||(s[gv]=u3["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const l=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(l.redirect_to=n.redirectTo);const o=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",a=await cF(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(a):{data:Object.assign({},a),error:null}}async function cF(e,t,r,n,i,s){const l=lF(t,n,i,s);let o;try{o=await e(r,Object.assign({},l))}catch(a){throw console.error(a),new mv(cc(a),0)}if(o.ok||await tb(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(a){await tb(a)}}function ua(e){var t;let r=null;hF(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=VP(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function rb(e){const t=ua(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function hl(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function uF(e){return{data:e,error:null}}function fF(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,l=Qg(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},a=Object.assign({},l);return{data:{properties:o,user:a},error:null}}function nb(e){return e}function hF(e){return e.access_token&&e.refresh_token&&e.expires_in}const Nm=["global","local","others"];class dF{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=d3(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Nm[0]){if(Nm.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Nm.join(", ")}`);try{return await Bt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(jt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Bt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:hl})}catch(n){if(jt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Qg(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await Bt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:fF,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(jt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Bt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:hl})}catch(r){if(jt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,s,l,o,a;try{const c={nextPage:null,lastPage:0,total:0},f=await Bt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:nb});if(f.error)throw f.error;const h=await f.json(),d=(l=f.headers.get("x-total-count"))!==null&&l!==void 0?l:0,u=(a=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&a!==void 0?a:[];return u.length>0&&(u.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(p.split(";")[1].split("=")[1]);c[`${g}Page`]=m}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(jt(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){mu(t);try{return await Bt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:hl})}catch(r){if(jt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){mu(t);try{return await Bt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:hl})}catch(n){if(jt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){mu(t);try{return await Bt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:hl})}catch(n){if(jt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){mu(t.userId);try{const{data:r,error:n}=await Bt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(jt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){mu(t.userId),mu(t.id);try{return{data:await Bt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(jt(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,i,s,l,o,a;try{const c={nextPage:null,lastPage:0,total:0},f=await Bt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:nb});if(f.error)throw f.error;const h=await f.json(),d=(l=f.headers.get("x-total-count"))!==null&&l!==void 0?l:0,u=(a=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&a!==void 0?a:[];return u.length>0&&(u.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(p.split(";")[1].split("=")[1]);c[`${g}Page`]=m}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(jt(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(t){try{return await Bt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(jt(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Bt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(jt(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Bt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(jt(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Bt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(jt(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Bt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(jt(r))return{data:null,error:r};throw r}}}function ib(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const xu={debug:!!(globalThis&&h3()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class p3 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class pF extends p3{}async function gF(e,t,r){xu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),xu.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){xu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{xu.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw xu.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new pF(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(xu.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function mF(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function g3(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function xF(e){return parseInt(e,16)}function vF(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function yF(e){var t;const{chainId:r,domain:n,expirationTime:i,issuedAt:s=new Date,nonce:l,notBefore:o,requestId:a,resources:c,scheme:f,uri:h,version:d}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(d!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${d}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const u=g3(e.address),p=f?`${f}://${n}`:n,m=e.statement?`${e.statement}
`:"",g=`${p} wants you to sign in with your Ethereum account:
${u}

${m}`;let x=`URI: ${h}
Version: ${d}
Chain ID: ${r}${l?`
Nonce: ${l}`:""}
Issued At: ${s.toISOString()}`;if(i&&(x+=`
Expiration Time: ${i.toISOString()}`),o&&(x+=`
Not Before: ${o.toISOString()}`),a&&(x+=`
Request ID: ${a}`),c){let y=`
Resources:`;for(const w of c){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);y+=`
- ${w}`}x+=y}return`${g}
${x}`}class In extends Error{constructor({message:t,code:r,cause:n,name:i}){var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=i??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class pg extends In{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function wF({error:e,options:t}){var r,n,i;const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new In({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new In({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new In({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=s.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new In({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new In({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new In({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new In({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new In({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const l=window.location.hostname;if(m3(l)){if(s.rp.id!==l)return new In({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new In({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new In({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new In({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new In({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function _F({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new In({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new In({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(m3(n)){if(r.rpId!==n)return new In({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new In({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new In({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new In({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class bF{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const SF=new bF;function kF(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,i=Qg(e,["challenge","user","excludeCredentials"]),s=Zu(t).buffer,l=Object.assign(Object.assign({},r),{id:Zu(r.id).buffer}),o=Object.assign(Object.assign({},i),{challenge:s,user:l});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let a=0;a<n.length;a++){const c=n[a];o.excludeCredentials[a]=Object.assign(Object.assign({},c),{id:Zu(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function CF(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Qg(e,["challenge","allowCredentials"]),i=Zu(t).buffer,s=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const o=r[l];s.allowCredentials[l]=Object.assign(Object.assign({},o),{id:Zu(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return s}function EF(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:yc(new Uint8Array(e.response.attestationObject)),clientDataJSON:yc(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function TF(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:yc(new Uint8Array(i.authenticatorData)),clientDataJSON:yc(new Uint8Array(i.clientDataJSON)),signature:yc(new Uint8Array(i.signature)),userHandle:i.userHandle?yc(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function m3(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function sb(){var e,t;return!!(ui()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function NF(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new pg("Browser returned unexpected credential type",t)}:{data:null,error:new pg("Empty credential response",t)}}catch(t){return{data:null,error:wF({error:t,options:e})}}}async function AF(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new pg("Browser returned unexpected credential type",t)}:{data:null,error:new pg("Empty credential response",t)}}catch(t){return{data:null,error:_F({error:t,options:e})}}}const OF={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},PF={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function gg(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of e)if(i)for(const s in i){const l=i[s];if(l!==void 0)if(Array.isArray(l))n[s]=l;else if(r(l))n[s]=l;else if(t(l)){const o=n[s];t(o)?n[s]=gg(o,l):n[s]=gg(l)}else n[s]=l}return n}function FF(e,t){return gg(OF,e,t||{})}function jF(e,t){return gg(PF,e,t||{})}class DF{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:i},s){try{const{data:l,error:o}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!l)return{data:null,error:o};const a=i??SF.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:c}=l.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${n}`),c.displayName||(c.displayName=c.name)}switch(l.webauthn.type){case"create":{const c=FF(l.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:f,error:h}=await NF({publicKey:c,signal:a});return f?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:f}},error:null}:{data:null,error:h}}case"request":{const c=jF(l.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:f,error:h}=await AF(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:c,signal:a}));return f?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:f}},error:null}:{data:null,error:h}}}}catch(l){return jt(l)?{data:null,error:l}:{data:null,error:new dc("Unexpected error in challenge",l)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new md("rpId is required for WebAuthn authentication")};try{if(!sb())return{data:null,error:new dc("Browser does not support WebAuthn",null)};const{data:l,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:s});if(!l)return{data:null,error:o};const{webauthn:a}=l;return this._verify({factorId:t,challengeId:l.challengeId,webauthn:{type:a.type,rpId:r,rpOrigins:n,credential_response:a.credential_response}})}catch(l){return jt(l)?{data:null,error:l}:{data:null,error:new dc("Unexpected error in authenticate",l)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new md("rpId is required for WebAuthn registration")};try{if(!sb())return{data:null,error:new dc("Browser does not support WebAuthn",null)};const{data:l,error:o}=await this._enroll({friendlyName:t});if(!l)return await this.client.mfa.listFactors().then(f=>{var h;return(h=f.data)===null||h===void 0?void 0:h.all.find(d=>d.factor_type==="webauthn"&&d.friendly_name===t&&d.status!=="unverified")}).then(f=>f?this.client.mfa.unenroll({factorId:f==null?void 0:f.id}):void 0),{data:null,error:o};const{data:a,error:c}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:s});return a?this._verify({factorId:l.id,challengeId:a.challengeId,webauthn:{rpId:r,rpOrigins:n,type:a.webauthn.type,credential_response:a.webauthn.credential_response}}):{data:null,error:c}}catch(l){return jt(l)?{data:null,error:l}:{data:null,error:new dc("Unexpected error in register",l)}}}}mF();const LF={url:PP,storageKey:FP,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:jP,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function ab(e,t,r){return await r()}const vu={};class xd{get jwks(){var t,r;return(r=(t=vu[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){vu[this.storageKey]=Object.assign(Object.assign({},vu[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=vu[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){vu[this.storageKey]=Object.assign(Object.assign({},vu[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},LF),t);if(this.storageKey=s.storageKey,this.instanceID=(r=xd.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,xd.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&ui()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new dF({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=d3(s.fetch),this.lock=s.lock||ab,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,this.lockAcquireTimeout=s.lockAcquireTimeout,s.lock?this.lock=s.lock:this.persistSession&&ui()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=gF:this.lock=ab,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new DF(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:h3()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ib(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=ib(this.memoryStorage)),ui()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l);try{await this._notifyAllSubscribers(l.data.event,l.data.session,!1)}catch(o){this._debug("#broadcastChannel","error",o)}})}this.initialize().catch(l=>{this._debug("#initialize()","error",l)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${c3}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(ui()&&(r=GP(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),ui()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),MP(s)){const a=(t=s.details)===null||t===void 0?void 0:t.code;if(a==="identity_already_exists"||a==="identity_not_found"||a==="single_identity_not_deletable")return{error:s}}return{error:s}}const{session:l,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",l,"redirect type",o),await this._saveSession(l),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return jt(r)?this._returnResult({error:r}):this._returnResult({error:new dc("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const s=await Bt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:ua}),{data:l,error:o}=s;if(o||!l)return this._returnResult({data:{user:null,session:null},error:o});const a=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",a)),this._returnResult({data:{user:c,session:a},error:null})}catch(s){if(jt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(t){var r,n,i;try{let s;if("email"in t){const{email:f,password:h,options:d}=t;let u=null,p=null;this.flowType==="pkce"&&([u,p]=await gu(this.storage,this.storageKey)),s=await Bt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:f,password:h,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:u,code_challenge_method:p},xform:ua})}else if("phone"in t){const{phone:f,password:h,options:d}=t;s=await Bt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:h,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},channel:(i=d==null?void 0:d.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:ua})}else throw new Y0("You must provide either an email or phone number and a password");const{data:l,error:o}=s;if(o||!l)return await ci(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const a=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",a)),this._returnResult({data:{user:c,session:a},error:null})}catch(s){if(await ci(this.storage,`${this.storageKey}-code-verifier`),jt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:l,options:o}=t;r=await Bt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:rb})}else if("phone"in t){const{phone:s,password:l,options:o}=t;r=await Bt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:rb})}else throw new Y0("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const s=new pu;return this._returnResult({data:{user:null,session:null},error:s})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(jt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,i,s,l,o,a,c,f,h,d;let u,p;if("message"in t)u=t.message,p=t.signature;else{const{chain:m,wallet:g,statement:x,options:y}=t;let w;if(ui())if(typeof g=="object")w=g;else{const j=window;if("ethereum"in j&&typeof j.ethereum=="object"&&"request"in j.ethereum&&typeof j.ethereum.request=="function")w=j.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=g}const _=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href),C=await w.request({method:"eth_requestAccounts"}).then(j=>j).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!C||C.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const E=g3(C[0]);let T=(n=y==null?void 0:y.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!T){const j=await w.request({method:"eth_chainId"});T=xF(j)}const A={domain:_.host,address:E,statement:x,uri:_.href,version:"1",chainId:T,nonce:(i=y==null?void 0:y.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(l=(s=y==null?void 0:y.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(o=y==null?void 0:y.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(a=y==null?void 0:y.signInWithEthereum)===null||a===void 0?void 0:a.notBefore,requestId:(c=y==null?void 0:y.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(f=y==null?void 0:y.signInWithEthereum)===null||f===void 0?void 0:f.resources};u=yF(A),p=await w.request({method:"personal_sign",params:[vF(u),E]})}try{const{data:m,error:g}=await Bt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:u,signature:p},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(d=t.options)===null||d===void 0?void 0:d.captchaToken}}:null),xform:ua});if(g)throw g;if(!m||!m.session||!m.user){const x=new pu;return this._returnResult({data:{user:null,session:null},error:x})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:g})}catch(m){if(jt(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(t){var r,n,i,s,l,o,a,c,f,h,d,u;let p,m;if("message"in t)p=t.message,m=t.signature;else{const{chain:g,wallet:x,statement:y,options:w}=t;let _;if(ui())if(typeof x=="object")_=x;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))_=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=x}const C=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in _&&_.signIn){const E=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),y?{statement:y}:null));let T;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")T=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)T=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)p=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),m=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${C.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(i=(n=w==null?void 0:w.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=w==null?void 0:w.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((h=(f=w==null?void 0:w.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||h===void 0)&&h.length?["Resources",...w.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const E=await _.signMessage(new TextEncoder().encode(p),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=E}}try{const{data:g,error:x}=await Bt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:yc(m)},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(u=t.options)===null||u===void 0?void 0:u.captchaToken}}:null),xform:ua});if(x)throw x;if(!g||!g.session||!g.user){const y=new pu;return this._returnResult({data:{user:null,session:null},error:y})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:x})}catch(g){if(jt(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(t){const r=await ac(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new BP;const{data:s,error:l}=await Bt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:ua});if(await ci(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!s||!s.session||!s.user){const o=new pu;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:l})}catch(s){if(await ci(this.storage,`${this.storageKey}-code-verifier`),jt(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:s,nonce:l}=t,o=await Bt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:l,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:ua}),{data:a,error:c}=o;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!a||!a.session||!a.user){const f=new pu;return this._returnResult({data:{user:null,session:null},error:f})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:a,error:c})}catch(r){if(jt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,i,s,l;try{if("email"in t){const{email:o,options:a}=t;let c=null,f=null;this.flowType==="pkce"&&([c,f]=await gu(this.storage,this.storageKey));const{error:h}=await Bt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=a==null?void 0:a.data)!==null&&r!==void 0?r:{},create_user:(n=a==null?void 0:a.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},code_challenge:c,code_challenge_method:f},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in t){const{phone:o,options:a}=t,{data:c,error:f}=await Bt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=a==null?void 0:a.data)!==null&&i!==void 0?i:{},create_user:(s=a==null?void 0:a.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},channel:(l=a==null?void 0:a.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:f})}throw new Y0("You must provide either an email or phone number.")}catch(o){if(await ci(this.storage,`${this.storageKey}-code-verifier`),jt(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var r,n;try{let i,s;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:o}=await Bt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:ua});if(o)throw o;if(!l)throw new Error("An error occurred on token verification.");const a=l.session,c=l.user;return a!=null&&a.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",a)),this._returnResult({data:{user:c,session:a},error:null})}catch(i){if(jt(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,n,i,s,l;try{let o=null,a=null;this.flowType==="pkce"&&([o,a]=await gu(this.storage,this.storageKey));const c=await Bt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:a}),headers:this.headers,xform:uF});return!((s=c.data)===null||s===void 0)&&s.url&&ui()&&!(!((l=t.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(o){if(await ci(this.storage,`${this.storageKey}-code-verifier`),jt(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new gs;const{error:i}=await Bt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(jt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:s}=t,{error:l}=await Bt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in t){const{phone:n,type:i,options:s}=t,{data:l,error:o}=await Bt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:o})}throw new Y0("You must provide either an email or phone number and a type")}catch(r){if(jt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ac(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<km:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const l=await ac(this.userStorage,this.storageKey+"-user");l!=null&&l.user?t.user=l.user:t.user=Tm()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};t.user=aF(t.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Bt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:hl}):await this._useSession(async r=>{var n,i,s;const{data:l,error:o}=r;if(o)throw o;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new gs}:await Bt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:hl})})}catch(r){if(jt(r))return Cm(r)&&(await this._removeSession(),await ci(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new gs;const l=i.session;let o=null,a=null;this.flowType==="pkce"&&t.email!=null&&([o,a]=await gu(this.storage,this.storageKey));const{data:c,error:f}=await Bt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:a}),jwt:l.access_token,xform:hl});if(f)throw f;return l.user=c.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(n){if(await ci(this.storage,`${this.storageKey}-code-verifier`),jt(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new gs;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:l}=J0(t.access_token);if(l.exp&&(n=l.exp,i=n<=r),i){const{data:o,error:a}=await this._callRefreshToken(t.refresh_token);if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:a}=await this._getUser(t.access_token);if(a)return this._returnResult({data:{user:null,session:null},error:a});s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(jt(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:l,error:o}=r;if(o)throw o;t=(n=l.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new gs;const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(jt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!ui())throw new K0("No browser detected.");if(t.error||t.error_description||t.error_code)throw new K0(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Y_("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new K0("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Y_("No code detected.");const{data:y,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:l,expires_in:o,expires_at:a,token_type:c}=t;if(!s||!o||!l||!c)throw new K0("No session defined in URL");const f=Math.round(Date.now()/1e3),h=parseInt(o);let d=f+h;a&&(d=parseInt(a));const u=d-f;u*1e3<=Tu&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${u}s, should have been closer to ${h}s`);const p=d-h;f-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,f):f-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,d,f);const{data:m,error:g}=await this._getUser(s);if(g)throw g;const x={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:h,expires_at:d,refresh_token:l,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:t.type},error:null})}catch(n){if(jt(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ac(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s&&!Cm(s))return this._returnResult({error:s});const l=(n=i.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:o}=await this.admin.signOut(l,t);if(o&&!(RP(o)&&(o.status===404||o.status===401||o.status===403)||Cm(o)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await ci(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=qP(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:l}=r;if(l)throw l;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await gu(this.storage,this.storageKey,!0));try{return await Bt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(await ci(this.storage,`${this.storageKey}-code-verifier`),jt(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(jt(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var l,o,a,c,f;const{data:h,error:d}=s;if(d)throw d;const u=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:!0});return await Bt(this.fetch,"GET",u,{headers:this.headers,jwt:(f=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&f!==void 0?f:void 0})});if(i)throw i;return ui()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(jt(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:s}}=r;if(i)throw i;const{options:l,provider:o,token:a,access_token:c,nonce:f}=t,h=await Bt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s==null?void 0:s.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:a,access_token:c,nonce:f,link_identity:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:ua}),{data:d,error:u}=h;return u?this._returnResult({data:{user:null,session:null},error:u}):!d||!d.session||!d.user?this._returnResult({data:{user:null,session:null},error:new pu}):(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("USER_UPDATED",d.session)),this._returnResult({data:d,error:u}))}catch(i){if(await ci(this.storage,`${this.storageKey}-code-verifier`),jt(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:l}=r;if(l)throw l;return await Bt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(jt(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await KP(async i=>(i>0&&await YP(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await Bt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ua})),(i,s)=>{const l=200*Math.pow(2,i);return s&&Em(s)&&Date.now()+l-n<Tu})}catch(n){if(this._debug(r,"error",n),jt(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),ui()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await ac(this.storage,this.storageKey);if(i&&this.userStorage){let l=await ac(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:i.user},await Nu(this.userStorage,this.storageKey+"-user",l)),i.user=(t=l==null?void 0:l.user)!==null&&t!==void 0?t:Tm()}else if(i&&!i.user&&!i.user){const l=await ac(this.storage,this.storageKey+"-user");l&&(l!=null&&l.user)?(i.user=l.user,await ci(this.storage,this.storageKey+"-user"),await Nu(this.storage,this.storageKey,i)):i.user=Tm()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<km;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${km}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:l}=await this._callRefreshToken(i.refresh_token);l&&(console.error(l),Em(l)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:o}=await this._getUser(i.access_token);!o&&(l!=null&&l.user)?(i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(n,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new gs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new t1;const{data:s,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!s.session)throw new gs;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={data:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),jt(s)){const l={data:null,error:s};return Em(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],l=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(a){s.push(a)}});if(await Promise.all(l),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await ci(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Nu(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=eb(i);await Nu(this.storage,this.storageKey,s)}else{const i=eb(r);await Nu(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await ci(this.storage,this.storageKey),await ci(this.storage,this.storageKey+"-code-verifier"),await ci(this.storage,this.storageKey+"-user"),this.userStorage&&await ci(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ui()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Tu);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/Tu);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Tu}ms, refresh threshold is ${pv} ticks`),i<=pv&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof p3)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ui()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(t){this._debug("#visibilityChangedCallback","error",t)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,l]=await gu(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(l)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?this._returnResult({data:null,error:s}):await Bt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(jt(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:l}=r;if(l)return this._returnResult({data:null,error:l});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:a,error:c}=await Bt(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(t.factorType==="totp"&&a.type==="totp"&&(!((i=a==null?void 0:a.totp)===null||i===void 0)&&i.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),this._returnResult({data:a,error:null}))})}catch(r){if(jt(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const l=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?EF(t.webauthn.credential_response):TF(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:a}=await Bt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return a?this._returnResult({data:null,error:a}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:a}))})}catch(r){if(jt(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const l=await Bt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(l.error)return l;const{data:o}=l;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:kF(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:CF(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(jt(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const s of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])i.all.push(s),s.status==="verified"&&i[s.factor_type].push(s);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(t){var r,n,i,s;if(t)try{const{payload:u}=J0(t);let p=null;u.aal&&(p=u.aal);let m=p;const{data:{user:g},error:x}=await this.getUser(t);if(x)return this._returnResult({data:null,error:x});((n=(r=g==null?void 0:g.factors)===null||r===void 0?void 0:r.filter(_=>_.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(m="aal2");const w=u.amr||[];return{data:{currentLevel:p,nextLevel:m,currentAuthenticationMethods:w},error:null}}catch(u){if(jt(u))return this._returnResult({data:null,error:u});throw u}const{data:{session:l},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=J0(l.access_token);let c=null;a.aal&&(c=a.aal);let f=c;((s=(i=l.user.factors)===null||i===void 0?void 0:i.filter(u=>u.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(f="aal2");const d=a.amr||[];return{data:{currentLevel:c,nextLevel:f,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await Bt(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new gs})})}catch(r){if(jt(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new gs});const l=await Bt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return l.data&&l.data.redirect_url&&ui()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(jt(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new gs});const l=await Bt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return l.data&&l.data.redirect_url&&ui()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(jt(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await Bt(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new gs})})}catch(t){if(jt(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?(await Bt(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new gs})})}catch(r){if(jt(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+LP>i)return n;const{data:s,error:l}=await Bt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:u,error:p}=await this.getSession();if(p||!u.session)return this._returnResult({data:null,error:p});n=u.session.access_token}const{header:i,payload:s,signature:l,raw:{header:o,payload:a}}=J0(n);r!=null&&r.allowExpired||nF(s.exp);const c=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:u}=await this.getUser(n);if(u)throw u;return{data:{claims:s,header:i,signature:l},error:null}}const f=iF(i.alg),h=await crypto.subtle.importKey("jwk",c,f,!0,["verify"]);if(!await crypto.subtle.verify(f,h,l,$P(`${o}.${a}`)))throw new xv("Invalid JWT signature");return{data:{claims:s,header:i,signature:l},error:null}}catch(n){if(jt(n))return this._returnResult({data:null,error:n});throw n}}}xd.nextInstanceID={};const IF=xd,RF="2.93.1";let wh="";typeof Deno<"u"?wh="deno":typeof document<"u"?wh="web":typeof navigator<"u"&&navigator.product==="ReactNative"?wh="react-native":wh="node";function MF(){const e=globalThis.process;if(e&&e.platform){const t=e.platform;if(t==="darwin")return"macOS";if(t==="win32")return"Windows";if(t==="linux")return"Linux";if(t==="android")return"Android"}if(typeof navigator<"u"&&navigator.userAgentData&&navigator.userAgentData.platform){const t=navigator.userAgentData.platform;if(t==="macOS")return"macOS";if(t==="Windows")return"Windows";if(t==="Linux")return"Linux";if(t==="Android")return"Android";if(t==="iOS")return"iOS"}return null}function BF(){const e=globalThis.process;if(e){const t=e.versions;if(t&&t.node&&typeof window>"u")try{const r=globalThis.require;if(r)return r("os").release()}catch{return null}}if(typeof Deno<"u"&&Deno.osRelease)try{return Deno.osRelease()}catch{return null}return typeof navigator<"u"&&navigator.userAgentData&&navigator.userAgentData.platformVersion?navigator.userAgentData.platformVersion:null}function UF(){if(typeof Deno<"u")return"deno";if(typeof Bun<"u")return"bun";const e=globalThis.process;if(e){const t=e.versions;if(t&&t.node)return"node"}return null}function WF(){if(typeof Deno<"u"&&Deno.version)return Deno.version.deno;if(typeof Bun<"u"&&Bun.version)return Bun.version;const e=globalThis.process;if(e){const t=e.versions;if(t&&t.node)return t.node}return null}function zF(){const e={"X-Client-Info":`supabase-js-${wh}/${RF}`},t=MF();t&&(e["X-Supabase-Client-Platform"]=t);const r=BF();r&&(e["X-Supabase-Client-Platform-Version"]=r);const n=UF();n&&(e["X-Supabase-Client-Runtime"]=n);const i=WF();return i&&(e["X-Supabase-Client-Runtime-Version"]=i),e}const HF=zF(),$F={headers:HF},VF={schema:"public"},qF={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},GF={};function vd(e){"@babel/helpers - typeof";return vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vd(e)}function XF(e,t){if(vd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(vd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YF(e){var t=XF(e,"string");return vd(t)=="symbol"?t:t+""}function KF(e,t,r){return(t=YF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ob(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ob(Object(r),!0).forEach(function(n){KF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ob(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const JF=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),QF=()=>Headers,ZF=(e,t,r)=>{const n=JF(r),i=QF();return async(s,l)=>{var o;const a=(o=await t())!==null&&o!==void 0?o:e;let c=new i(l==null?void 0:l.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${a}`),n(s,cn(cn({},l),{},{headers:c}))}};function ej(e){return e.endsWith("/")?e:e+"/"}function tj(e,t){var r,n;const{db:i,auth:s,realtime:l,global:o}=e,{db:a,auth:c,realtime:f,global:h}=t,d={db:cn(cn({},a),i),auth:cn(cn({},c),s),realtime:cn(cn({},f),l),storage:{},global:cn(cn(cn({},h),o),{},{headers:cn(cn({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}function rj(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(ej(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var nj=class extends IF{constructor(e){super(e)}},ij=class{constructor(e,t,r){var n,i;this.supabaseUrl=e,this.supabaseKey=t;const s=rj(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",s),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",s),this.storageUrl=new URL("storage/v1",s),this.functionsUrl=new URL("functions/v1",s);const l=`sb-${s.hostname.split(".")[0]}-auth-token`,o={db:VF,realtime:GF,auth:cn(cn({},qF),{},{storageKey:l}),global:$F},a=tj(r??{},o);if(this.storageKey=(n=a.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=a.global.headers)!==null&&i!==void 0?i:{},a.accessToken)this.accessToken=a.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=a.auth)!==null&&c!==void 0?c:{},this.headers,a.global.fetch)}this.fetch=ZF(t,this._getAccessToken.bind(this),a.global.fetch),this.realtime=this._initRealtimeClient(cn({headers:this.headers,accessToken:this._getAccessToken.bind(this)},a.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(f=>this.realtime.setAuth(f)).catch(f=>console.warn("Failed to set initial Realtime auth token:",f)),this.rest=new IO(new URL("rest/v1",s).href,{headers:this.headers,schema:a.db.schema,fetch:this.fetch}),this.storage=new OP(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),a.accessToken||this._listenForAuthEvents()}get functions(){return new PO(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,storageKey:s,flowType:l,lock:o,debug:a,throwOnError:c},f,h){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new nj({url:this.authUrl.href,headers:cn(cn({},d),f),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,flowType:l,lock:o,debug:a,throwOnError:c,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(u=>u.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new ZO(this.realtimeUrl.href,cn(cn({},e),{},{params:cn(cn({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const sj=(e,t,r)=>new ij(e,t,r);function aj(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}aj()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const oj="https://kglshjhuofkouiodmkgs.supabase.co",lj="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtnbHNoamh1b2Zrb3Vpb2Rta2dzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk0NDE3ODgsImV4cCI6MjA4NTAxNzc4OH0.kqoUY-stIdwOw3vtpowcbzV_AvjgGtzXN6i9bjQCW-Y",Xe=sj(oj,lj),cj=()=>{var be;const e=ye.useRef(null),t=ye.useRef(null),[r,n]=ye.useState(null),[i,s]=ye.useState(""),[l,o]=ye.useState(""),[a,c]=ye.useState("A"),[f,h]=ye.useState("#5E5CE6"),[d,u]=ye.useState("#E5E5EA"),[p,m]=ye.useState("#D1D1D6"),[g,x]=ye.useState("#8E8E93"),[y,w]=ye.useState(12),[_,C]=ye.useState([]),[E,T]=ye.useState(null),[A,j]=ye.useState(!1),[B,F]=ye.useState(null),[L,G]=ye.useState(null),[X,re]=ye.useState(null),[Q,ne]=ye.useState([]),[J,P]=ye.useState({paper:"a4",orientation:"portrait"}),[H,U]=ye.useState([]),S=pe=>{var nt,Qe;const xe=pe||t.current;if(!xe)return;const ce=xe.getObjects();if(ce.length===0)return;let Ne=1/0,Ie=1/0,Re=-1/0,De=-1/0;ce.forEach(ht=>{const it=ht.getBoundingRect(!0);Ne=Math.min(Ne,it.left),Ie=Math.min(Ie,it.top),Re=Math.max(Re,it.left+it.width),De=Math.max(De,it.top+it.height)});const Me=Re-Ne,Ge=De-Ie,Ae=((nt=e.current)==null?void 0:nt.clientWidth)||xe.getWidth(),Pe=((Qe=e.current)==null?void 0:Qe.clientHeight)||xe.getHeight(),Ue=Ae/2-(Ne+Me/2),Ye=Pe/2-(Ie+Ge/2);xe.setViewportTransform([1,0,0,1,Ue,Ye]),xe.requestRenderAll()},I=()=>{const pe=t.current;if(!pe)return;const xe=pe.getObjects().map(ce=>{const Ne=ce.data||{};return{id:Ne.id,seatNumber:Ne.seatNumber,displayNumber:Ne.displayNumber,zoneName:Ne.zoneName,zoneColor:Ne.zoneColor,pos_x:ce.left,pos_y:ce.top,width:ce.width,height:ce.height,label:Ne.label,type:Ne.type,rotation:ce.angle,globalNumber:Ne.globalNumber}});ne(ce=>[...ce.slice(-19),xe])},O=ye.useRef(null),N=ye.useRef(null),R=ye.useRef(null),z=ye.useRef(null);ye.useEffect(()=>{O.current=B,N.current=L,R.current=X},[B,L,X]),ye.useEffect(()=>{K()},[]);const K=async()=>{const{data:pe}=await Xe.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});pe&&pe.length>0&&(C(pe),T(pe[0].id))};ye.useEffect(()=>{if(!e.current||!E)return;let pe=!0;t.current&&t.current.dispose(),e.current.innerHTML="";const xe=document.createElement("canvas");e.current.appendChild(xe);const ce=new zt.fabric.Canvas(xe,{width:e.current.clientWidth,height:e.current.clientHeight,backgroundColor:"transparent",selection:!0});t.current=ce,new ResizeObserver(()=>{if(!e.current||!t.current)return;const Ae=e.current.clientWidth,Pe=e.current.clientHeight;t.current.setDimensions({width:Ae,height:Pe}),S(t.current)}).observe(e.current),(async()=>{j(!0);const{data:Ae,error:Pe}=await Xe.from("seats").select("*").eq("zone_id",E).order("global_number",{ascending:!0});pe&&(Pe?console.error("Error loading seats:",Pe):Ae&&Ae.length>0?(t.current&&t.current.clear(),Ae.filter(Ye=>typeof Ye.pos_x=="number"&&typeof Ye.pos_y=="number").forEach(Ye=>{Z(Ye);const nt=t.current.getObjects().find(Qe=>Qe.data.id===Ye.id);nt&&delete nt.data.isDirty}),setTimeout(()=>{pe&&S(t.current)},100),t.current.renderAll()):t.current&&t.current.clear(),j(!1))})(),ce.on("mouse:down",Ae=>{var Pe,Ue,Ye,nt;if(O.current==="structure"){ce.selection=!1;const Qe=ce.getPointer(Ae.e);G({x:Qe.x,y:Qe.y});const ht=new zt.fabric.Rect({left:Qe.x,top:Qe.y,width:0,height:0,fill:"#E5E5EA",stroke:"#C7C7CC",strokeWidth:1,opacity:.7});ce.add(ht),re(ht);return}Ae.target?I():(ce.isDragging=!0,ce.selection=!0,ce.lastPosX=Ae.e.clientX||((Ue=(Pe=Ae.e.touches)==null?void 0:Pe[0])==null?void 0:Ue.clientX),ce.lastPosY=Ae.e.clientY||((nt=(Ye=Ae.e.touches)==null?void 0:Ye[0])==null?void 0:nt.clientY))});const Re=async()=>{if(Q.length===0)return;const Ae=Q[Q.length-1],Pe=Q.slice(0,-1);ne(Pe),t.current.clear(),Ae.forEach(Ue=>{Z({id:Ue.id,seat_number:Ue.seatNumber,display_number:Ue.displayNumber,zone_name:Ue.zoneName,zone_color:Ue.zoneColor,pos_x:Ue.pos_x,pos_y:Ue.pos_y,width:Ue.width,height:Ue.height,label:Ue.label,type:Ue.type,rotation:Ue.rotation,global_number:Ue.globalNumber})})},De=()=>{const Ae=ce.getActiveObject();Ae&&Ae.clone(Pe=>{z.current=Pe},["data"])},Me=()=>{if(!z.current||!t.current)return;const Ae=t.current;I();try{z.current.clone(Pe=>{var Ue,Ye,nt;if(!(!Ae.getElement()||!Ae.contextContainer)){if(Ae.discardActiveObject(),Pe.set({left:Pe.left+20,top:Pe.top+20,evented:!0}),Pe.type==="activeSelection"){const Qe=[];Pe.forEachObject(it=>{var Et,ir;const dt=crypto.randomUUID();let Mt=((Et=it.data)==null?void 0:Et.type)==="structure";!Mt&&((ir=it.data)!=null&&ir.label)&&(Mt=!0);const bt=it.data||{};Mt&&(delete bt.zoneName,delete bt.zoneColor,delete bt.displayNumber),it.set("data",{...bt,id:dt,isDirty:!0,type:Mt?"structure":"seat",seatNumber:bt.seatNumber||(Mt?`STR_${dt.slice(-8)}`:"0")}),Ae.add(it),Qe.push(it)});const ht=new zt.fabric.ActiveSelection(Qe,{canvas:Ae});Ae.setActiveObject(ht),ht.setCoords()}else{const Qe=crypto.randomUUID();let ht=((Ue=Pe.data)==null?void 0:Ue.type)==="structure";if(!ht&&((Ye=Pe.data)!=null&&Ye.label)&&(ht=!0),ht){const dt=((nt=Pe.data)==null?void 0:nt.label)||"",Mt=prompt("  ",dt);if(Mt){Pe.data={...Pe.data,label:Mt,type:"structure"};const bt=Pe.getObjects().find(Et=>Et.type==="i-text");bt&&bt.set("text",Mt)}}const it=Pe.data||{};ht&&(delete it.zoneName,delete it.zoneColor,delete it.displayNumber),Pe.set("data",{...it,id:Qe,isDirty:!0,type:ht?"structure":"seat",seatNumber:ht?`STR_${Qe.slice(-8)}`:it.seatNumber||"0"}),Ae.add(Pe),Ae.setActiveObject(Pe)}Ae.requestRenderAll()}},["data"])}catch(Pe){console.error("Error pasting objects:",Pe)}},Ge=Ae=>{(Ae.ctrlKey||Ae.metaKey)&&Ae.key==="z"&&(Ae.preventDefault(),Re()),(Ae.ctrlKey||Ae.metaKey)&&Ae.key==="c"&&document.activeElement.tagName!=="INPUT"&&document.activeElement.tagName!=="TEXTAREA"&&(Ae.preventDefault(),De()),(Ae.ctrlKey||Ae.metaKey)&&Ae.key==="v"&&document.activeElement.tagName!=="INPUT"&&document.activeElement.tagName!=="TEXTAREA"&&(Ae.preventDefault(),Me())};return window.addEventListener("keydown",Ge),ce.on("mouse:move",Ae=>{var Pe,Ue,Ye,nt;if(O.current==="structure"&&N.current&&R.current){const Qe=ce.getPointer(Ae.e),ht=N.current,it=R.current,dt=Math.abs(Qe.x-ht.x),Mt=Math.abs(Qe.y-ht.y),bt=Math.min(Qe.x,ht.x),Et=Math.min(Qe.y,ht.y);it.set({width:dt,height:Mt,left:bt,top:Et}),ce.requestRenderAll();return}if(ce.isDragging){const Qe=Ae.e,ht=Qe.clientX||((Ue=(Pe=Qe.touches)==null?void 0:Pe[0])==null?void 0:Ue.clientX),it=Qe.clientY||((nt=(Ye=Qe.touches)==null?void 0:Ye[0])==null?void 0:nt.clientY),dt=ce.viewportTransform;dt[4]+=ht-ce.lastPosX,dt[5]+=it-ce.lastPosY,ce.requestRenderAll(),ce.lastPosX=ht,ce.lastPosY=it}}),ce.on("mouse:wheel",Ae=>{const Pe=Ae.e.deltaY,Ue=ce.viewportTransform;Ue[5]-=Pe,ce.requestRenderAll(),Ae.e.preventDefault(),Ae.e.stopPropagation()}),ce.on("object:scaling",Ae=>{const Pe=Ae.target;if(Pe&&Pe.data){const Ue=Pe.getObjects().find(Ye=>Ye.type==="i-text");Ue&&Ue.set({scaleX:1/Pe.scaleX,scaleY:1/Pe.scaleY})}}),ce.on("mouse:dblclick",Ae=>{const Pe=Ae.target;if(!Pe||!Pe.data)return;const Ue=Pe.data.type;if(Ue!=="seat"&&Ue!=="structure")return;const Ye=Pe.getObjects().find(dt=>dt.type==="i-text");if(!Ye)return;I();const nt={...Pe.data},Qe=Pe.left,ht=Pe.top,it=Pe.angle;Pe._restoreObjectsState(),ce.remove(Pe),Pe.getObjects().forEach(dt=>{ce.add(dt),dt===Ye&&(ce.setActiveObject(dt),dt.enterEditing(),dt.selectAll())}),ce.requestRenderAll(),Ye.on("editing:exited",()=>{const dt=Ye.text;Ue==="structure"&&(nt.label=dt),Ue==="seat"&&(nt.displayNumber=dt);const bt=[Pe.getObjects().find(ir=>ir.type==="rect"),Ye];bt.forEach(ir=>ce.remove(ir));const Et=new zt.fabric.Group(bt,{left:Qe,top:ht,angle:it,hasControls:!0,lockRotation:!1,subTargetCheck:!0});Et.data=nt,Et.data.isDirty=!0,Ue==="seat"?Et.set({borderColor:nt.zoneColor||"#5E5CE6",cornerColor:"white",cornerStrokeColor:"#5E5CE6",transparentCorners:!1}):Et.set({borderColor:"#007AFF",cornerColor:"white",cornerStrokeColor:"#007AFF",transparentCorners:!1}),ce.add(Et),ce.setActiveObject(Et),ce.requestRenderAll(),Ye.off("editing:exited")})}),ce.on("mouse:up",()=>{if(O.current==="structure"&&R.current){const Ae=R.current,Pe=Ae.width,Ue=Ae.height,Ye=Ae.left,nt=Ae.top;Pe>20&&Ue>20?setTimeout(()=>{const Qe=prompt("  (: , , )","");ce.remove(Ae),re(null),G(null),F(null),Qe&&(I(),Y(Ye,nt,Pe,Ue,Qe))},50):(ce.remove(Ae),re(null),G(null),F(null));return}ce.isDragging&&(ce.setViewportTransform(ce.viewportTransform),ce.isDragging=!1)}),ce.on("selection:created",Ae=>{var Ue,Ye,nt,Qe,ht;const Pe=Ae.selected;if(Pe.length===1){const it=Pe[0];n(it),((Ue=it.data)==null?void 0:Ue.type)==="structure"?(u(it.data.bgColor||"#E5E5EA"),m(it.data.strokeColor||"#D1D1D6"),x(it.data.textColor||"#8E8E93"),w(it.data.fontSize||12)):(s(((Ye=it.data)==null?void 0:Ye.seatNumber)||""),o(((nt=it.data)==null?void 0:nt.displayNumber)||""),c(((Qe=it.data)==null?void 0:Qe.zoneName)||"A"),h(((ht=it.data)==null?void 0:ht.zoneColor)||"#5E5CE6"))}else n(null)}),ce.on("selection:updated",Ae=>{var Ue,Ye,nt,Qe,ht;const Pe=Ae.selected;if(Pe.length===1){const it=Pe[0];n(it),((Ue=it.data)==null?void 0:Ue.type)==="structure"?(u(it.data.bgColor||"#E5E5EA"),m(it.data.strokeColor||"#D1D1D6"),x(it.data.textColor||"#8E8E93"),w(it.data.fontSize||12)):(s(((Ye=it.data)==null?void 0:Ye.seatNumber)||""),o(((nt=it.data)==null?void 0:nt.displayNumber)||""),c(((Qe=it.data)==null?void 0:Qe.zoneName)||"A"),h(((ht=it.data)==null?void 0:ht.zoneColor)||"#5E5CE6"))}else n(null)}),ce.on("selection:cleared",()=>{n(null),s(""),o(""),u("#E5E5EA"),m("#D1D1D6"),x("#8E8E93"),w(12)}),ce.on("object:modified",async Ae=>{const Pe=Ae.target;if(!Pe)return;(Pe.type==="activeSelection"?Pe.getObjects():[Pe]).forEach(Ye=>{var nt;if(Ye.data){const Qe=Ye.width*Ye.scaleX,ht=Ye.height*Ye.scaleY;Ye.set({width:Qe,height:ht,scaleX:1,scaleY:1});const it=Ye.getObjects().find(dt=>dt.type==="i-text");if(it){it.set({scaleX:1,scaleY:1}),((nt=Ye.data)==null?void 0:nt.type)==="structure"?it.set({left:0,top:0,originX:"center",originY:"center"}):it.set({left:-Qe/2+6,top:-ht/2+6,originX:"left",originY:"top"});const dt=Ye.getObjects().find(Mt=>Mt.type==="rect");dt&&(dt.set({width:Qe,height:ht}),dt.set({left:-Qe/2,top:-ht/2})),Ye.addWithUpdate()}}Ye.data&&(Ye.data.isDirty=!0)})}),()=>{pe=!1,window.removeEventListener("keydown",Ge),ce.dispose(),t.current=null}},[E]);const Y=(pe,xe,ce,Ne,Ie)=>{const Re=new zt.fabric.Rect({fill:d,width:ce,height:Ne,stroke:p,strokeWidth:1}),De=new zt.fabric.IText(Ie,{fontSize:y,originX:"center",originY:"center",left:ce/2,top:Ne/2,fill:g,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),Me=crypto.randomUUID(),Ge=new zt.fabric.Group([Re,De],{left:pe,top:xe,originX:"left",originY:"top",perPixelTargetFind:!0,data:{id:Me,type:"structure",label:Ie,width:ce,height:Ne,bgColor:d,strokeColor:p,textColor:g,fontSize:y,isDirty:!0,seatNumber:`STR_${Me.slice(-8)}`}});t.current.add(Ge),t.current.setActiveObject(Ge)},Z=pe=>{if(pe.type==="structure"){const Ie=new zt.fabric.Rect({fill:pe.bg_color||"#E5E5EA",width:pe.width||72,height:pe.height||72,stroke:pe.stroke_color||"#D1D1D6",strokeWidth:1}),Re=new zt.fabric.IText(pe.label||"",{fontSize:pe.font_size||12,originX:"center",originY:"center",left:(pe.width||72)/2,top:(pe.height||72)/2,fill:pe.text_color||"#8E8E93",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),De=new zt.fabric.Group([Ie,Re],{id:pe.id,left:pe.pos_x,top:pe.pos_y,originX:"left",originY:"top",angle:pe.rotation,perPixelTargetFind:!0,data:{id:pe.id,type:"structure",label:pe.label,width:pe.width,height:pe.height,bgColor:pe.bg_color,strokeColor:pe.stroke_color,textColor:pe.text_color,fontSize:pe.font_size}});t.current.add(De);return}const xe=new zt.fabric.Rect({fill:pe.zone_color||"#5E5CE6",width:72,height:72,rx:6,ry:6,stroke:"rgba(255,255,255,0.1)",strokeWidth:2}),ce=new zt.fabric.IText(pe.display_number||pe.seat_number,{fontSize:12,left:6,top:6,fill:"#ffffff",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"900",selectable:!1}),Ne=new zt.fabric.Group([xe,ce],{left:pe.pos_x,top:pe.pos_y,originX:"left",originY:"top",angle:pe.rotation,perPixelTargetFind:!0,data:{id:pe.id,type:"seat",seatNumber:pe.seat_number,displayNumber:pe.display_number,zoneName:pe.zone_name,zoneColor:pe.zone_color,globalNumber:pe.global_number}});t.current.add(Ne)},se=()=>{var pe;if(r){if(I(),((pe=r.data)==null?void 0:pe.type)==="structure"){r.set("data",{...r.data,bgColor:d,strokeColor:p,textColor:g,fontSize:y,isDirty:!0});const xe=r.getObjects().find(Ne=>Ne.type==="rect");xe&&xe.set({fill:d,stroke:p});const ce=r.getObjects().find(Ne=>Ne.type==="i-text");ce&&ce.set({fill:g,fontSize:y})}else{r.set("data",{...r.data,seatNumber:i,displayNumber:l,zoneName:a,zoneColor:f,isDirty:!0});const xe=r.getObjects().find(Ne=>Ne.type==="rect");xe&&xe.set("fill",f);const ce=r.getObjects().find(Ne=>Ne.type==="i-text");ce&&ce.set("text",l)}t.current.renderAll()}},V=()=>{I();const xe=`${t.current.getObjects().filter(Re=>{var De;return((De=Re.data)==null?void 0:De.type)!=="structure"}).length+1}`,ce=new zt.fabric.Rect({fill:f,width:72,height:72,rx:6,ry:6,stroke:"rgba(255,255,255,0.1)",strokeWidth:2}),Ne=new zt.fabric.IText(xe,{fontSize:18,originX:"center",originY:"center",left:36,top:36,fill:"#ffffff",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"900",selectable:!1}),Ie=new zt.fabric.Group([ce,Ne],{left:150,top:150,originX:"left",originY:"top",perPixelTargetFind:!0,data:{id:crypto.randomUUID(),type:"seat",seatNumber:xe,zoneName:a,zoneColor:f,isDirty:!0}});t.current.add(Ie),t.current.setActiveObject(Ie)},le=async()=>{const pe=t.current;if(!pe)return;const xe=pe.getActiveObject();if(xe){I();const ce=xe.type==="activeSelection"?xe.getObjects():[xe],Ne=[];ce.forEach(Ie=>{var De;const Re=(De=Ie.data)==null?void 0:De.id;Re&&Re.length>20&&Ne.push(Re)}),U(Ie=>[...Ie,...Ne]),pe.discardActiveObject(),ce.forEach(Ie=>pe.remove(Ie)),pe.requestRenderAll(),n(null)}},ae=()=>{I();const pe=t.current.getObjects(),xe=["A","B","C"];let ce=1;xe.forEach(Ne=>{pe.filter(Re=>{var De,Me;return((De=Re.data)==null?void 0:De.zoneName)===Ne&&((Me=Re.data)==null?void 0:Me.type)!=="structure"}).sort((Re,De)=>Math.abs(Re.top-De.top)<20?Re.left-De.left:Re.top-De.top).forEach((Re,De)=>{const Me=De+1,Ge=`${Ne}-${Me.toString().padStart(2,"0")}`;Re.set("data",{...Re.data,seatNumber:Me.toString(),displayNumber:Ge,globalNumber:ce++});const Ae=Re.getObjects().find(Pe=>Pe.type==="i-text");Ae&&Ae.set("text",Ge)})}),t.current.renderAll()},W=()=>{const pe=t.current.getActiveObject();pe&&(I(),pe.rotate(((pe.angle||0)+90)%360),t.current.renderAll())},he=async()=>{var pe;if(t.current){j(!0);try{const xe=t.current,ce=xe.getObjects();if(ce.length===0){alert("  ."),j(!1);return}const Ne=xe.viewportTransform;xe.setViewportTransform([1,0,0,1,0,0]);let Ie=1/0,Re=1/0,De=-1/0,Me=-1/0;ce.forEach(kt=>{if(!kt.visible||kt.opacity===0||(!kt.fill||kt.fill==="transparent")&&(!kt.stroke||kt.stroke==="transparent")&&!kt.text)return;let Kn=kt.getBoundingRect();Ie=Math.min(Ie,Kn.left),Re=Math.min(Re,Kn.top),De=Math.max(De,Kn.left+Kn.width),Me=Math.max(Me,Kn.top+Kn.height)});const Ge=20,Ae=Ie-Ge,Pe=Re-Ge,Ue=De-Ie+Ge*2,Ye=Me-Re+Ge*2,nt=xe.toDataURL({format:"png",left:Ae,top:Pe,width:Ue,height:Ye,multiplier:3});xe.setViewportTransform(Ne);const{paper:Qe,orientation:ht}=J,it=Qe==="b4"?257:210,dt=Qe==="b4"?364:297,Mt=ht==="landscape"?dt:it,bt=ht==="landscape"?it:dt,Et=20,ir=10,Qt=10,St=document.createElement("iframe");St.style.position="fixed",St.style.right="0",St.style.bottom="0",St.style.width="0",St.style.height="0",St.style.border="0",document.body.appendChild(St);const cr=((pe=_.find(kt=>kt.id===E))==null?void 0:pe.name)||"",Zs=new Date().toISOString().split("T")[0],Kr=St.contentWindow.document;Kr.open(),Kr.write(`
          <html>
            <head>
              <title>  - ${cr}</title>
              <style>
                @page {
                  size: ${Qe} ${ht};
                  margin: 0;
                }
                html, body {
                  margin: 0;
                  padding: 0;
                  width: 100%;
                  height: 100vh;
                  background: white;
                  -webkit-print-color-adjust: exact;
                  overflow: hidden !important;
                }
                .print-container {
                  width: 100%;
                  height: 100vh;
                  padding: ${Et}mm ${ir}mm ${Qt}mm ${ir}mm;
                  box-sizing: border-box;
                  display: flex;
                  flex-direction: column;
                  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                  overflow: hidden !important;
                  background: white;
                }
                .header {
                  flex-shrink: 0;
                  display: flex;
                  justify-content: space-between;
                  align-items: flex-end;
                  border-bottom: 2px solid #1C1C1E;
                  padding-bottom: 3mm; /* Reduced padding */
                  margin-bottom: 2mm; /* Reduced margin */
                }
                .header h1 {
                  margin: 0;
                  font-size: 16pt; /* Slightly smaller to save space */
                  font-weight: 900;
                  letter-spacing: -1px;
                  color: #1C1C1E;
                }
                .header .info {
                  text-align: right;
                }
                .header .info .zone {
                  font-size: 10pt;
                  font-weight: 800;
                  color: #5856D6;
                  margin: 0;
                }
                .header .info .date {
                  font-size: 8pt;
                  color: #8E8E93;
                  margin: 0;
                }
                /* Content area strictly confined to remaining space */
                .content {
                  flex: 1;
                  display: flex;
                  justify-content: center; /* Center */
                  align-items: center;
                  min-height: 0;
                  padding: 0; /* Remove arbitrary padding to maximize scale */
                  margin: 0;
                  overflow: hidden;
                }
                /* Image autoscaling using object-fit */
                .content img {
                  width: 100%;
                  height: 100%;
                  object-fit: contain;
                  object-position: center; /* Center image */
                  display: block;
                }
                .footer {
                  flex-shrink: 0;
                  margin-top: 1mm; /* Reduced margin */
                  text-align: center;
                  border-top: 1px solid #F2F2F7;
                  padding-top: 2mm;
                }
                .footer p {
                  margin: 0;
                  font-size: 7pt;
                  color: #AEAEB2;
                  font-weight: bold;
                  letter-spacing: 1px;
                }
              </style>
            </head>
            <body>
              <div class="print-container">
                <div class="header">
                  <h1> </h1>
                  <div class="info">
                    <p class="zone">${cr}</p>
                    <p class="date">${Zs} </p>
                  </div>
                </div>
                <div class="content">
                  <img src="${nt}" />
                </div>
                <div class="footer">
                  <p>POGOK STUDY CAFE MANAGEMENT SYSTEM</p>
                </div>
              </div>
            </body>
          </html>
        `),Kr.close();const Gi=()=>{const kt=St.contentWindow;kt.focus(),setTimeout(()=>{kt.print(),setTimeout(()=>{document.body.removeChild(St),j(!1)},1e3)},800)},Li=Kr.querySelector("img");Li.complete?Gi():Li.onload=Gi}catch(xe){console.error("Print generation failed:",xe),alert("    ."),j(!1)}}},fe=async()=>{j(!0);try{if(H.length>0){const{error:Ne}=await Xe.from("seats").delete().in("id",H);if(Ne)throw console.error("Error deleting items:",Ne),Ne}const pe=t.current.getObjects(),xe=[],ce=[];if(pe.forEach(Ne=>{var Ae,Pe,Ue,Ye,nt,Qe,ht,it,dt,Mt,bt,Et,ir;const Ie=Math.round(Ne.getScaledWidth()),Re=Math.round(Ne.getScaledHeight()),De=((Ae=Ne.data)==null?void 0:Ae.type)==="structure",Me=((Pe=Ne.data)==null?void 0:Pe.seatNumber)||(De?`STR_${Ne.data.id.slice(-8)}`:"0"),Ge={zone_id:E,pos_x:Math.round(Ne.left),pos_y:Math.round(Ne.top),rotation:Math.round(Ne.angle||0),type:((Ue=Ne.data)==null?void 0:Ue.type)||"seat",width:Ie,height:Re,label:((Ye=Ne.data)==null?void 0:Ye.label)||null,bg_color:((nt=Ne.data)==null?void 0:nt.bgColor)||null,stroke_color:((Qe=Ne.data)==null?void 0:Qe.strokeColor)||null,text_color:((ht=Ne.data)==null?void 0:ht.textColor)||null,font_size:((it=Ne.data)==null?void 0:it.fontSize)||null,seat_number:Me,display_number:((dt=Ne.data)==null?void 0:dt.displayNumber)||null,zone_name:((Mt=Ne.data)==null?void 0:Mt.zoneName)||null,zone_color:((bt=Ne.data)==null?void 0:bt.zoneColor)||null,global_number:((Et=Ne.data)==null?void 0:Et.globalNumber)||null};(ir=Ne.data)!=null&&ir.id&&Ne.data.id.length>20?(Ge.id=Ne.data.id,xe.push(Ge)):ce.push(Ge)}),xe.length>0){const{error:Ne}=await Xe.from("seats").upsert(xe);if(Ne)throw Ne}if(ce.length>0){const{error:Ne}=await Xe.from("seats").insert(ce);if(Ne)throw Ne}alert("."),U([]),t.current.getObjects().forEach(Ne=>{Ne.data&&delete Ne.data.isDirty}),window.location.reload()}catch(pe){console.error("Error saving layout:",pe),alert(" : "+(pe.message||pe.details||JSON.stringify(pe)))}finally{j(!1)}},Te=()=>{I();const pe=t.current.getObjects(),xe=30,ce=pe.filter(De=>{var Me;return(Me=De.data)==null?void 0:Me.isDirty}),Ne=pe.filter(De=>{var Me;return!((Me=De.data)!=null&&Me.isDirty)}),Ie=Ne.map(De=>Math.round(De.left)),Re=Ne.map(De=>Math.round(De.top));ce.forEach(De=>{let Me=De.left,Ge=De.top,Ae=Me,Pe=1/0;Ie.forEach(nt=>{const Qe=Math.abs(Me-nt);Qe<xe&&Qe<Pe&&(Pe=Qe,Ae=nt)}),Pe<xe&&De.set("left",Ae);let Ue=Ge,Ye=1/0;Re.forEach(nt=>{const Qe=Math.abs(Ge-nt);Qe<xe&&Qe<Ye&&(Ye=Qe,Ue=nt)}),Ye<xe&&De.set("top",Ue),De.setCoords()}),t.current.renderAll()};return v.jsxs("div",{className:"flex flex-col w-full h-full mx-auto leading-normal overflow-hidden relative bg-[#F2F2F7]",children:[A&&v.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-50 flex items-center justify-center pointer-events-none",children:v.jsx("div",{className:"w-8 h-8 border-3 border-ios-indigo border-t-transparent rounded-full animate-spin"})}),v.jsxs("div",{className:"bg-white/80 backdrop-blur-md border-b border-black/5 p-4 flex items-center justify-between shadow-sm z-30",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:"flex gap-1",children:_.map(pe=>v.jsx("button",{onClick:()=>T(pe.id),className:`px-5 py-2 rounded-apple-md text-[11px] font-black transition-all border ${E===pe.id?"bg-[#1C1C1E] text-white border-[#1C1C1E] shadow-sm":"bg-white text-ios-gray border-gray-100 hover:text-[#1C1C1E] hover:border-gray-200"}`,children:pe.name},pe.id))}),v.jsx("div",{className:"h-6 w-[1px] bg-gray-200 mx-2"}),v.jsxs("div",{className:"flex items-center gap-1.5",children:[v.jsxs("button",{onClick:V,className:"flex items-center gap-2 bg-ios-indigo text-white px-4 py-2 rounded-apple-md text-[11px] font-black hover:bg-ios-indigo/90 transition-all ios-tap shadow-sm shadow-ios-indigo/20",children:[v.jsx(ud,{className:"w-3.5 h-3.5"})," "]}),v.jsxs("button",{onClick:()=>F(pe=>pe==="structure"?null:"structure"),className:`flex items-center gap-2 px-4 py-2 rounded-apple-md text-[11px] font-black transition-all border ios-tap ${B==="structure"?"bg-[#1C1C1E] text-white border-[#1C1C1E]":"bg-white text-ios-gray border-gray-100 hover:bg-gray-50"}`,children:[v.jsx(I8,{className:"w-3.5 h-3.5"})," "]})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("button",{onClick:ae,className:"p-2.5 rounded-apple-md bg-white border border-gray-100 text-ios-amber hover:bg-ios-amber/5 transition-all ios-tap group",title:"  ",children:v.jsx(F8,{className:"w-4 h-4 group-hover:scale-110 transition-transform"})}),v.jsx("button",{onClick:Te,className:"p-2.5 rounded-apple-md bg-white border border-gray-100 text-ios-emerald hover:bg-ios-emerald/5 transition-all ios-tap group",title:" ",children:v.jsx(O8,{className:"w-4 h-4 group-hover:scale-110 transition-transform"})}),v.jsx("div",{className:"h-6 w-[1px] bg-gray-200 mx-2"}),v.jsxs("button",{onClick:fe,disabled:A,className:"flex items-center gap-2 bg-[#1C1C1E] text-white px-5 py-2.5 rounded-apple-md text-[12px] font-black hover:bg-black transition-all ios-tap disabled:opacity-50 shadow-lg shadow-black/5",children:[v.jsx(fd,{className:`w-4 h-4 ${A?"animate-spin":""}`})," "]}),v.jsxs("button",{onClick:he,disabled:A,className:"flex items-center gap-2 bg-white text-[#1C1C1E] px-5 py-2.5 rounded-apple-md text-[12px] font-black border border-gray-200 hover:bg-gray-50 transition-all ios-tap disabled:opacity-50 shadow-sm ml-2",children:[v.jsx(Fl,{className:`w-4 h-4 ${A?"animate-pulse":""}`})," "]})]})]}),v.jsxs("div",{className:"flex-1 w-full relative overflow-hidden bg-white",children:[B==="structure"&&v.jsx("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 z-20 bg-[#1C1C1E]/80 backdrop-blur-lg px-6 py-2.5 rounded-full border border-white/10 shadow-xl pointer-events-none animate-spring-up",children:v.jsx("span",{className:"text-white text-[11px] font-black tracking-tight",children:"   "})}),v.jsx("div",{className:"w-full h-full flex flex-col",children:v.jsx("div",{ref:e,className:"flex-1 h-full relative overflow-hidden cursor-grab active:cursor-grabbing touch-none select-none scrollbar-hide"})}),v.jsx("div",{className:`absolute top-6 right-6 w-72 transition-all duration-500 ease-apple-out z-40 ${r?"opacity-100 translate-y-0 pointer-events-auto":"opacity-0 translate-y-4 pointer-events-none"}`,children:v.jsxs("div",{className:"glass-material rounded-apple-xl border border-white/40 shadow-2xl p-6 space-y-6",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("h3",{className:"text-[11px] font-black uppercase tracking-[0.2em] text-ios-indigo",children:" "}),v.jsxs("div",{className:"flex gap-1.5",children:[v.jsx("button",{onClick:W,className:"p-2 rounded-apple-md bg-white/50 hover:bg-white text-ios-indigo transition-all shadow-sm border border-white/40",title:"90 ",children:v.jsx(oO,{className:"w-3.5 h-3.5"})}),v.jsx("button",{onClick:le,className:"p-2 rounded-apple-md bg-ios-rose/5 hover:bg-ios-rose text-ios-rose hover:text-white transition-all shadow-sm border border-ios-rose/10",title:"",children:v.jsx(jl,{className:"w-3.5 h-3.5"})})]})]}),((be=r==null?void 0:r.data)==null?void 0:be.type)!=="structure"?v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:"Display No"}),v.jsx("input",{type:"text",value:l,onChange:pe=>o(pe.target.value),className:"w-full bg-white/80 border border-white/60 rounded-[8px] p-2.5 text-xs font-black text-[#1C1C1E] focus:ring-1 focus:ring-ios-indigo",placeholder:": A-01"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:"Zone"}),v.jsxs("select",{value:a,onChange:pe=>c(pe.target.value),className:"w-full bg-white/80 border border-white/60 rounded-[8px] p-2.5 text-xs font-black text-[#1C1C1E] focus:ring-1 focus:ring-ios-indigo appearance-none",children:[v.jsx("option",{value:"A",children:"Zone A"}),v.jsx("option",{value:"B",children:"Zone B"}),v.jsx("option",{value:"C",children:"Zone C"})]})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1 flex items-center gap-1.5",children:[v.jsx(q8,{className:"w-2.5 h-2.5"})," Zone Color"]}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{type:"color",value:f,onChange:pe=>h(pe.target.value),className:"w-10 h-10 bg-transparent border-0 rounded-[8px] cursor-pointer overflow-hidden p-0 shadow-sm"}),v.jsx("input",{type:"text",value:f.toUpperCase(),onChange:pe=>h(pe.target.value),className:"flex-1 bg-white/80 border border-white/60 rounded-[8px] p-2.5 text-[10px] font-black text-[#1C1C1E]"})]})]}),v.jsxs("div",{className:"pt-2",children:[v.jsx("button",{onClick:se,className:"w-full bg-ios-indigo text-white py-3 rounded-apple-md font-black text-[11px] shadow-lg shadow-ios-indigo/20 ios-tap",children:" "}),v.jsx("button",{onClick:()=>n(null),className:"w-full mt-2 text-ios-gray py-2 font-bold text-[10px] hover:text-[#1C1C1E] transition-colors",children:" "})]})]}):v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1 flex items-center gap-1.5",children:""}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{type:"color",value:d,onChange:pe=>u(pe.target.value),className:"w-10 h-10 bg-transparent border-0 rounded-[8px] cursor-pointer"}),v.jsx("input",{type:"text",value:d.toUpperCase(),onChange:pe=>u(pe.target.value),className:"flex-1 bg-white/80 border border-white/60 rounded-[8px] p-2.5 text-[10px] font-black"})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:""}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{type:"color",value:p,onChange:pe=>m(pe.target.value),className:"w-10 h-10 bg-transparent border-0 rounded-[8px] cursor-pointer"}),v.jsx("input",{type:"text",value:p.toUpperCase(),onChange:pe=>m(pe.target.value),className:"flex-1 bg-white/80 border border-white/60 rounded-[8px] p-2.5 text-[10px] font-black"})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:""}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{type:"color",value:g,onChange:pe=>x(pe.target.value),className:"w-10 h-10 bg-transparent border-0 rounded-[8px] cursor-pointer"}),v.jsx("input",{type:"text",value:g.toUpperCase(),onChange:pe=>x(pe.target.value),className:"flex-1 bg-white/80 border border-white/60 rounded-[8px] p-2.5 text-[10px] font-black"})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest px-1",children:["  (",y,"px)"]}),v.jsx("input",{type:"range",min:"6",max:"48",value:y,onChange:pe=>w(parseInt(pe.target.value)),className:"w-full"})]}),v.jsxs("div",{className:"pt-2",children:[v.jsx("button",{onClick:se,className:"w-full bg-ios-indigo text-white py-3 rounded-apple-md font-black text-[11px] shadow-lg",children:" "}),v.jsx("button",{onClick:()=>n(null),className:"w-full mt-2 text-ios-gray py-2 font-bold text-[10px]",children:""})]})]})]})})]})]})},uj="modulepreload",fj=function(e){return"/"+e},lb={},Am=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));i=Promise.allSettled(r.map(a=>{if(a=fj(a),a in lb)return;lb[a]=!0;const c=a.endsWith(".css"),f=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${f}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":uj,c||(h.as="script"),h.crossOrigin="",h.href=a,o&&h.setAttribute("nonce",o),document.head.appendChild(h),c)return new Promise((d,u)=>{h.addEventListener("load",d),h.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${a}`)))})}))}function s(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return i.then(l=>{for(const o of l||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})};function Er(e){"@babel/helpers - typeof";return Er=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Er(e)}var Sa=Uint8Array,bs=Uint16Array,V2=Int32Array,q2=new Sa([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),G2=new Sa([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),cb=new Sa([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),x3=function(e,t){for(var r=new bs(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new V2(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return{b:r,r:i}},v3=x3(q2,2),hj=v3.b,vv=v3.r;hj[28]=258,vv[258]=28;var dj=x3(G2,0),ub=dj.r,yv=new bs(32768);for(var zr=0;zr<32768;++zr){var nl=(zr&43690)>>1|(zr&21845)<<1;nl=(nl&52428)>>2|(nl&13107)<<2,nl=(nl&61680)>>4|(nl&3855)<<4,yv[zr]=((nl&65280)>>8|(nl&255)<<8)>>1}var Ih=function(e,t,r){for(var n=e.length,i=0,s=new bs(t);i<n;++i)e[i]&&++s[e[i]-1];var l=new bs(t);for(i=1;i<t;++i)l[i]=l[i-1]+s[i-1]<<1;var o;if(r){o=new bs(1<<t);var a=15-t;for(i=0;i<n;++i)if(e[i])for(var c=i<<4|e[i],f=t-e[i],h=l[e[i]-1]++<<f,d=h|(1<<f)-1;h<=d;++h)o[yv[h]>>a]=c}else for(o=new bs(n),i=0;i<n;++i)e[i]&&(o[i]=yv[l[e[i]-1]++]>>15-e[i]);return o},Dc=new Sa(288);for(var zr=0;zr<144;++zr)Dc[zr]=8;for(var zr=144;zr<256;++zr)Dc[zr]=9;for(var zr=256;zr<280;++zr)Dc[zr]=7;for(var zr=280;zr<288;++zr)Dc[zr]=8;var mg=new Sa(32);for(var zr=0;zr<32;++zr)mg[zr]=5;var pj=Ih(Dc,9,0),gj=Ih(mg,5,0),y3=function(e){return(e+7)/8|0},mj=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Sa(e.subarray(t,r))},go=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},fh=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},Om=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,s=r.slice();if(!i)return{t:_3,l:0};if(i==1){var l=new Sa(r[0].s+1);return l[r[0].s]=1,{t:l,l:1}}r.sort(function(C,E){return C.f-E.f}),r.push({s:-1,f:25001});var o=r[0],a=r[1],c=0,f=1,h=2;for(r[0]={s:-1,f:o.f+a.f,l:o,r:a};f!=i-1;)o=r[r[c].f<r[h].f?c++:h++],a=r[c!=f&&r[c].f<r[h].f?c++:h++],r[f++]={s:-1,f:o.f+a.f,l:o,r:a};for(var d=s[0].s,n=1;n<i;++n)s[n].s>d&&(d=s[n].s);var u=new bs(d+1),p=wv(r[f-1],u,0);if(p>t){var n=0,m=0,g=p-t,x=1<<g;for(s.sort(function(E,T){return u[T.s]-u[E.s]||E.f-T.f});n<i;++n){var y=s[n].s;if(u[y]>t)m+=x-(1<<p-u[y]),u[y]=t;else break}for(m>>=g;m>0;){var w=s[n].s;u[w]<t?m-=1<<t-u[w]++-1:++n}for(;n>=0&&m;--n){var _=s[n].s;u[_]==t&&(--u[_],++m)}p=t}return{t:new Sa(u),l:p}},wv=function(e,t,r){return e.s==-1?Math.max(wv(e.l,t,r+1),wv(e.r,t,r+1)):t[e.s]=r},fb=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new bs(++t),n=0,i=e[0],s=1,l=function(a){r[n++]=a},o=1;o<=t;++o)if(e[o]==i&&o!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)l(32754);s>2&&(l(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(l(i),--s;s>6;s-=6)l(8304);s>2&&(l(s-3<<5|8208),s=0)}for(;s--;)l(i);s=1,i=e[o]}return{c:r.subarray(0,n),n:t}},hh=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},w3=function(e,t,r){var n=r.length,i=y3(t+2);e[i]=n&255,e[i+1]=n>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var s=0;s<n;++s)e[i+s+4]=r[s];return(i+4+n)*8},hb=function(e,t,r,n,i,s,l,o,a,c,f){go(t,f++,r),++i[256];for(var h=Om(i,15),d=h.t,u=h.l,p=Om(s,15),m=p.t,g=p.l,x=fb(d),y=x.c,w=x.n,_=fb(m),C=_.c,E=_.n,T=new bs(19),A=0;A<y.length;++A)++T[y[A]&31];for(var A=0;A<C.length;++A)++T[C[A]&31];for(var j=Om(T,7),B=j.t,F=j.l,L=19;L>4&&!B[cb[L-1]];--L);var G=c+5<<3,X=hh(i,Dc)+hh(s,mg)+l,re=hh(i,d)+hh(s,m)+l+14+3*L+hh(T,B)+2*T[16]+3*T[17]+7*T[18];if(a>=0&&G<=X&&G<=re)return w3(t,f,e.subarray(a,a+c));var Q,ne,J,P;if(go(t,f,1+(re<X)),f+=2,re<X){Q=Ih(d,u,0),ne=d,J=Ih(m,g,0),P=m;var H=Ih(B,F,0);go(t,f,w-257),go(t,f+5,E-1),go(t,f+10,L-4),f+=14;for(var A=0;A<L;++A)go(t,f+3*A,B[cb[A]]);f+=3*L;for(var U=[y,C],S=0;S<2;++S)for(var I=U[S],A=0;A<I.length;++A){var O=I[A]&31;go(t,f,H[O]),f+=B[O],O>15&&(go(t,f,I[A]>>5&127),f+=I[A]>>12)}}else Q=pj,ne=Dc,J=gj,P=mg;for(var A=0;A<o;++A){var N=n[A];if(N>255){var O=N>>18&31;fh(t,f,Q[O+257]),f+=ne[O+257],O>7&&(go(t,f,N>>23&31),f+=q2[O]);var R=N&31;fh(t,f,J[R]),f+=P[R],R>3&&(fh(t,f,N>>5&8191),f+=G2[R])}else fh(t,f,Q[N]),f+=ne[N]}return fh(t,f,Q[256]),f+ne[256]},xj=new V2([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),_3=new Sa(0),vj=function(e,t,r,n,i,s){var l=s.z||e.length,o=new Sa(n+l+5*(1+Math.ceil(l/7e3))+i),a=o.subarray(n,o.length-i),c=s.l,f=(s.r||0)&7;if(t){f&&(a[0]=s.r>>3);for(var h=xj[t-1],d=h>>13,u=h&8191,p=(1<<r)-1,m=s.p||new bs(32768),g=s.h||new bs(p+1),x=Math.ceil(r/3),y=2*x,w=function(ae){return(e[ae]^e[ae+1]<<x^e[ae+2]<<y)&p},_=new V2(25e3),C=new bs(288),E=new bs(32),T=0,A=0,j=s.i||0,B=0,F=s.w||0,L=0;j+2<l;++j){var G=w(j),X=j&32767,re=g[G];if(m[X]=re,g[G]=X,F<=j){var Q=l-j;if((T>7e3||B>24576)&&(Q>423||!c)){f=hb(e,a,0,_,C,E,A,B,L,j-L,f),B=T=A=0,L=j;for(var ne=0;ne<286;++ne)C[ne]=0;for(var ne=0;ne<30;++ne)E[ne]=0}var J=2,P=0,H=u,U=X-re&32767;if(Q>2&&G==w(j-U))for(var S=Math.min(d,Q)-1,I=Math.min(32767,j),O=Math.min(258,Q);U<=I&&--H&&X!=re;){if(e[j+J]==e[j+J-U]){for(var N=0;N<O&&e[j+N]==e[j+N-U];++N);if(N>J){if(J=N,P=U,N>S)break;for(var R=Math.min(U,N-2),z=0,ne=0;ne<R;++ne){var K=j-U+ne&32767,Y=m[K],Z=K-Y&32767;Z>z&&(z=Z,re=K)}}}X=re,re=m[X],U+=X-re&32767}if(P){_[B++]=268435456|vv[J]<<18|ub[P];var se=vv[J]&31,V=ub[P]&31;A+=q2[se]+G2[V],++C[257+se],++E[V],F=j+J,++T}else _[B++]=e[j],++C[e[j]]}}for(j=Math.max(j,F);j<l;++j)_[B++]=e[j],++C[e[j]];f=hb(e,a,c,_,C,E,A,B,L,j-L,f),c||(s.r=f&7|a[f/8|0]<<3,f-=7,s.h=g,s.p=m,s.i=j,s.w=F)}else{for(var j=s.w||0;j<l+c;j+=65535){var le=j+65535;le>=l&&(a[f/8|0]=c,le=l),f=w3(a,f+1,e.subarray(j,le))}s.i=l}return mj(o,0,n+y3(f)+i)},b3=function(){var e=1,t=0;return{p:function(r){for(var n=e,i=t,s=r.length|0,l=0;l!=s;){for(var o=Math.min(l+2655,s);l<o;++l)i+=n+=r[l];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}e=n,t=i},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},yj=function(e,t,r,n,i){if(!i&&(i={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),l=new Sa(s.length+e.length);l.set(s),l.set(e,s.length),e=l,i.w=s.length}return vj(e,t.level==null?6:t.level,t.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,i)},S3=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},wj=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=b3();i.p(t.dictionary),S3(e,2,i.d())}};function _v(e,t){t||(t={});var r=b3();r.p(e);var n=yj(e,t,t.dictionary?6:2,4);return wj(n,t),S3(n,n.length-4,r.d()),n}var _j=typeof TextDecoder<"u"&&new TextDecoder,bj=0;try{_j.decode(_3,{stream:!0}),bj=1}catch{}function Sj(e){if(Array.isArray(e))return e}function kj(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,s,l,o=[],a=!0,c=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(a=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);a=!0);}catch(f){c=!0,i=f}finally{try{if(!a&&r.return!=null&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw i}}return o}}function db(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Cj(e,t){if(e){if(typeof e=="string")return db(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?db(e,t):void 0}}function Ej(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pb(e,t){return Sj(e)||kj(e,t)||Cj(e,t)||Ej()}function gb(e,t="utf8"){return new TextDecoder(t).decode(e)}const Tj=new TextEncoder;function Nj(e){return Tj.encode(e)}const Aj=1024*8,Oj=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),Pm={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class X2{constructor(t=Aj,r={}){ft(this,"buffer");ft(this,"byteLength");ft(this,"byteOffset");ft(this,"length");ft(this,"offset");ft(this,"lastWrittenByte");ft(this,"littleEndian");ft(this,"_data");ft(this,"_mark");ft(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const i=r.offset?r.offset>>>0:0,s=t.byteLength-i;let l=i;(ArrayBuffer.isView(t)||t instanceof X2)&&(t.byteLength!==t.buffer.byteLength&&(l=t.byteOffset+i),t=t.buffer),n?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=t,this.length=s,this.byteLength=s,this.byteOffset=l,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,l,s),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,i=new Uint8Array(n);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=Pm[r].BYTES_PER_ELEMENT*t,i=this.byteOffset+this.offset,s=this.buffer.slice(i,i+n);if(this.littleEndian===Oj&&r!=="uint8"&&r!=="int8"){const o=new Uint8Array(this.buffer.slice(i,i+n));o.reverse();const a=new Pm[r](o.buffer);return this.offset+=n,a.reverse(),a}const l=new Pm[r](s);return this.offset+=n,l}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return gb(this.readBytes(t))}decodeText(t=1,r="utf8"){return gb(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(Nj(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Ef(e){let t=e.length;for(;--t>=0;)e[t]=0}const Pj=3,Fj=258,k3=29,jj=256,Dj=jj+1+k3,C3=30,Lj=512,Ij=new Array((Dj+2)*2);Ef(Ij);const Rj=new Array(C3*2);Ef(Rj);const Mj=new Array(Lj);Ef(Mj);const Bj=new Array(Fj-Pj+1);Ef(Bj);const Uj=new Array(k3);Ef(Uj);const Wj=new Array(C3);Ef(Wj);const zj=(e,t,r,n)=>{let i=e&65535|0,s=e>>>16&65535|0,l=0;for(;r!==0;){l=r>2e3?2e3:r,r-=l;do i=i+t[n++]|0,s=s+i|0;while(--l);i%=65521,s%=65521}return i|s<<16|0};var bv=zj;const Hj=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},$j=new Uint32Array(Hj()),Vj=(e,t,r,n)=>{const i=$j,s=n+r;e^=-1;for(let l=n;l<s;l++)e=e>>>8^i[(e^t[l])&255];return e^-1};var Da=Vj,Sv={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},E3={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const qj=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Gj=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)qj(r,n)&&(e[n]=r[n])}}return e},Xj=e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,i=0,s=e.length;n<s;n++){let l=e[n];r.set(l,i),i+=l.length}return r},T3={assign:Gj,flattenChunks:Xj};let N3=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{N3=!1}const yd=new Uint8Array(256);for(let e=0;e<256;e++)yd[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;yd[254]=yd[254]=1;var Yj=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,i,s,l=e.length,o=0;for(i=0;i<l;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<l&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(o),s=0,i=0;s<o;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<l&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|r&63):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|r&63):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|r&63);return t};const Kj=(e,t)=>{if(t<65534&&e.subarray&&N3)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var Jj=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,i;const s=new Array(r*2);for(i=0,n=0;n<r;){let l=e[n++];if(l<128){s[i++]=l;continue}let o=yd[l];if(o>4){s[i++]=65533,n+=o-1;continue}for(l&=o===2?31:o===3?15:7;o>1&&n<r;)l=l<<6|e[n++]&63,o--;if(o>1){s[i++]=65533;continue}l<65536?s[i++]=l:(l-=65536,s[i++]=55296|l>>10&1023,s[i++]=56320|l&1023)}return Kj(s,i)},Qj=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+yd[e[r]]>t?r:t},kv={string2buf:Yj,buf2string:Jj,utf8border:Qj};function Zj(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var eD=Zj;const Q0=16209,tD=16191;var rD=function(t,r){let n,i,s,l,o,a,c,f,h,d,u,p,m,g,x,y,w,_,C,E,T,A,j,B;const F=t.state;n=t.next_in,j=t.input,i=n+(t.avail_in-5),s=t.next_out,B=t.output,l=s-(r-t.avail_out),o=s+(t.avail_out-257),a=F.dmax,c=F.wsize,f=F.whave,h=F.wnext,d=F.window,u=F.hold,p=F.bits,m=F.lencode,g=F.distcode,x=(1<<F.lenbits)-1,y=(1<<F.distbits)-1;e:do{p<15&&(u+=j[n++]<<p,p+=8,u+=j[n++]<<p,p+=8),w=m[u&x];t:for(;;){if(_=w>>>24,u>>>=_,p-=_,_=w>>>16&255,_===0)B[s++]=w&65535;else if(_&16){C=w&65535,_&=15,_&&(p<_&&(u+=j[n++]<<p,p+=8),C+=u&(1<<_)-1,u>>>=_,p-=_),p<15&&(u+=j[n++]<<p,p+=8,u+=j[n++]<<p,p+=8),w=g[u&y];r:for(;;){if(_=w>>>24,u>>>=_,p-=_,_=w>>>16&255,_&16){if(E=w&65535,_&=15,p<_&&(u+=j[n++]<<p,p+=8,p<_&&(u+=j[n++]<<p,p+=8)),E+=u&(1<<_)-1,E>a){t.msg="invalid distance too far back",F.mode=Q0;break e}if(u>>>=_,p-=_,_=s-l,E>_){if(_=E-_,_>f&&F.sane){t.msg="invalid distance too far back",F.mode=Q0;break e}if(T=0,A=d,h===0){if(T+=c-_,_<C){C-=_;do B[s++]=d[T++];while(--_);T=s-E,A=B}}else if(h<_){if(T+=c+h-_,_-=h,_<C){C-=_;do B[s++]=d[T++];while(--_);if(T=0,h<C){_=h,C-=_;do B[s++]=d[T++];while(--_);T=s-E,A=B}}}else if(T+=h-_,_<C){C-=_;do B[s++]=d[T++];while(--_);T=s-E,A=B}for(;C>2;)B[s++]=A[T++],B[s++]=A[T++],B[s++]=A[T++],C-=3;C&&(B[s++]=A[T++],C>1&&(B[s++]=A[T++]))}else{T=s-E;do B[s++]=B[T++],B[s++]=B[T++],B[s++]=B[T++],C-=3;while(C>2);C&&(B[s++]=B[T++],C>1&&(B[s++]=B[T++]))}}else if(_&64){t.msg="invalid distance code",F.mode=Q0;break e}else{w=g[(w&65535)+(u&(1<<_)-1)];continue r}break}}else if(_&64)if(_&32){F.mode=tD;break e}else{t.msg="invalid literal/length code",F.mode=Q0;break e}else{w=m[(w&65535)+(u&(1<<_)-1)];continue t}break}}while(n<i&&s<o);C=p>>3,n-=C,p-=C<<3,u&=(1<<p)-1,t.next_in=n,t.next_out=s,t.avail_in=n<i?5+(i-n):5-(n-i),t.avail_out=s<o?257+(o-s):257-(s-o),F.hold=u,F.bits=p};const yu=15,mb=852,xb=592,vb=0,Fm=1,yb=2,nD=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),iD=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),sD=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),aD=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),oD=(e,t,r,n,i,s,l,o)=>{const a=o.bits;let c=0,f=0,h=0,d=0,u=0,p=0,m=0,g=0,x=0,y=0,w,_,C,E,T,A=null,j;const B=new Uint16Array(yu+1),F=new Uint16Array(yu+1);let L=null,G,X,re;for(c=0;c<=yu;c++)B[c]=0;for(f=0;f<n;f++)B[t[r+f]]++;for(u=a,d=yu;d>=1&&B[d]===0;d--);if(u>d&&(u=d),d===0)return i[s++]=1<<24|64<<16|0,i[s++]=1<<24|64<<16|0,o.bits=1,0;for(h=1;h<d&&B[h]===0;h++);for(u<h&&(u=h),g=1,c=1;c<=yu;c++)if(g<<=1,g-=B[c],g<0)return-1;if(g>0&&(e===vb||d!==1))return-1;for(F[1]=0,c=1;c<yu;c++)F[c+1]=F[c]+B[c];for(f=0;f<n;f++)t[r+f]!==0&&(l[F[t[r+f]]++]=f);if(e===vb?(A=L=l,j=20):e===Fm?(A=nD,L=iD,j=257):(A=sD,L=aD,j=0),y=0,f=0,c=h,T=s,p=u,m=0,C=-1,x=1<<u,E=x-1,e===Fm&&x>mb||e===yb&&x>xb)return 1;for(;;){G=c-m,l[f]+1<j?(X=0,re=l[f]):l[f]>=j?(X=L[l[f]-j],re=A[l[f]-j]):(X=96,re=0),w=1<<c-m,_=1<<p,h=_;do _-=w,i[T+(y>>m)+_]=G<<24|X<<16|re|0;while(_!==0);for(w=1<<c-1;y&w;)w>>=1;if(w!==0?(y&=w-1,y+=w):y=0,f++,--B[c]===0){if(c===d)break;c=t[r+l[f]]}if(c>u&&(y&E)!==C){for(m===0&&(m=u),T+=h,p=c-m,g=1<<p;p+m<d&&(g-=B[p+m],!(g<=0));)p++,g<<=1;if(x+=1<<p,e===Fm&&x>mb||e===yb&&x>xb)return 1;C=y&E,i[C]=u<<24|p<<16|T-s|0}}return y!==0&&(i[T+y]=c-m<<24|64<<16|0),o.bits=u,0};var Rh=oD;const lD=0,A3=1,O3=2,{Z_FINISH:wb,Z_BLOCK:cD,Z_TREES:Z0,Z_OK:Lc,Z_STREAM_END:uD,Z_NEED_DICT:fD,Z_STREAM_ERROR:Ks,Z_DATA_ERROR:P3,Z_MEM_ERROR:F3,Z_BUF_ERROR:hD,Z_DEFLATED:_b}=E3,r1=16180,bb=16181,Sb=16182,kb=16183,Cb=16184,Eb=16185,Tb=16186,Nb=16187,Ab=16188,Ob=16189,xg=16190,mo=16191,jm=16192,Pb=16193,Dm=16194,Fb=16195,jb=16196,Db=16197,Lb=16198,ep=16199,tp=16200,Ib=16201,Rb=16202,Mb=16203,Bb=16204,Ub=16205,Lm=16206,Wb=16207,zb=16208,Gr=16209,j3=16210,D3=16211,dD=852,pD=592,gD=15,mD=gD,Hb=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function xD(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const qc=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<r1||t.mode>D3?1:0},L3=e=>{if(qc(e))return Ks;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=r1,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(dD),t.distcode=t.distdyn=new Int32Array(pD),t.sane=1,t.back=-1,Lc},I3=e=>{if(qc(e))return Ks;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,L3(e)},R3=(e,t)=>{let r;if(qc(e))return Ks;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Ks:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,I3(e))},M3=(e,t)=>{if(!e)return Ks;const r=new xD;e.state=r,r.strm=e,r.window=null,r.mode=r1;const n=R3(e,t);return n!==Lc&&(e.state=null),n},vD=e=>M3(e,mD);let $b=!0,Im,Rm;const yD=e=>{if($b){Im=new Int32Array(512),Rm=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Rh(A3,e.lens,0,288,Im,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Rh(O3,e.lens,0,32,Rm,0,e.work,{bits:5}),$b=!1}e.lencode=Im,e.lenbits=9,e.distcode=Rm,e.distbits=5},B3=(e,t,r,n)=>{let i;const s=e.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(t.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>n&&(i=n),s.window.set(t.subarray(r-n,r-n+i),s.wnext),n-=i,n?(s.window.set(t.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},wD=(e,t)=>{let r,n,i,s,l,o,a,c,f,h,d,u,p,m,g=0,x,y,w,_,C,E,T,A;const j=new Uint8Array(4);let B,F;const L=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(qc(e)||!e.output||!e.input&&e.avail_in!==0)return Ks;r=e.state,r.mode===mo&&(r.mode=jm),l=e.next_out,i=e.output,a=e.avail_out,s=e.next_in,n=e.input,o=e.avail_in,c=r.hold,f=r.bits,h=o,d=a,A=Lc;e:for(;;)switch(r.mode){case r1:if(r.wrap===0){r.mode=jm;break}for(;f<16;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if(r.wrap&2&&c===35615){r.wbits===0&&(r.wbits=15),r.check=0,j[0]=c&255,j[1]=c>>>8&255,r.check=Da(r.check,j,2,0),c=0,f=0,r.mode=bb;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((c&255)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=Gr;break}if((c&15)!==_b){e.msg="unknown compression method",r.mode=Gr;break}if(c>>>=4,f-=4,T=(c&15)+8,r.wbits===0&&(r.wbits=T),T>15||T>r.wbits){e.msg="invalid window size",r.mode=Gr;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=c&512?Ob:mo,c=0,f=0;break;case bb:for(;f<16;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if(r.flags=c,(r.flags&255)!==_b){e.msg="unknown compression method",r.mode=Gr;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Gr;break}r.head&&(r.head.text=c>>8&1),r.flags&512&&r.wrap&4&&(j[0]=c&255,j[1]=c>>>8&255,r.check=Da(r.check,j,2,0)),c=0,f=0,r.mode=Sb;case Sb:for(;f<32;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}r.head&&(r.head.time=c),r.flags&512&&r.wrap&4&&(j[0]=c&255,j[1]=c>>>8&255,j[2]=c>>>16&255,j[3]=c>>>24&255,r.check=Da(r.check,j,4,0)),c=0,f=0,r.mode=kb;case kb:for(;f<16;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}r.head&&(r.head.xflags=c&255,r.head.os=c>>8),r.flags&512&&r.wrap&4&&(j[0]=c&255,j[1]=c>>>8&255,r.check=Da(r.check,j,2,0)),c=0,f=0,r.mode=Cb;case Cb:if(r.flags&1024){for(;f<16;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}r.length=c,r.head&&(r.head.extra_len=c),r.flags&512&&r.wrap&4&&(j[0]=c&255,j[1]=c>>>8&255,r.check=Da(r.check,j,2,0)),c=0,f=0}else r.head&&(r.head.extra=null);r.mode=Eb;case Eb:if(r.flags&1024&&(u=r.length,u>o&&(u=o),u&&(r.head&&(T=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(s,s+u),T)),r.flags&512&&r.wrap&4&&(r.check=Da(r.check,n,u,s)),o-=u,s+=u,r.length-=u),r.length))break e;r.length=0,r.mode=Tb;case Tb:if(r.flags&2048){if(o===0)break e;u=0;do T=n[s+u++],r.head&&T&&r.length<65536&&(r.head.name+=String.fromCharCode(T));while(T&&u<o);if(r.flags&512&&r.wrap&4&&(r.check=Da(r.check,n,u,s)),o-=u,s+=u,T)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=Nb;case Nb:if(r.flags&4096){if(o===0)break e;u=0;do T=n[s+u++],r.head&&T&&r.length<65536&&(r.head.comment+=String.fromCharCode(T));while(T&&u<o);if(r.flags&512&&r.wrap&4&&(r.check=Da(r.check,n,u,s)),o-=u,s+=u,T)break e}else r.head&&(r.head.comment=null);r.mode=Ab;case Ab:if(r.flags&512){for(;f<16;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if(r.wrap&4&&c!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Gr;break}c=0,f=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=mo;break;case Ob:for(;f<32;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}e.adler=r.check=Hb(c),c=0,f=0,r.mode=xg;case xg:if(r.havedict===0)return e.next_out=l,e.avail_out=a,e.next_in=s,e.avail_in=o,r.hold=c,r.bits=f,fD;e.adler=r.check=1,r.mode=mo;case mo:if(t===cD||t===Z0)break e;case jm:if(r.last){c>>>=f&7,f-=f&7,r.mode=Lm;break}for(;f<3;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}switch(r.last=c&1,c>>>=1,f-=1,c&3){case 0:r.mode=Pb;break;case 1:if(yD(r),r.mode=ep,t===Z0){c>>>=2,f-=2;break e}break;case 2:r.mode=jb;break;case 3:e.msg="invalid block type",r.mode=Gr}c>>>=2,f-=2;break;case Pb:for(c>>>=f&7,f-=f&7;f<32;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if((c&65535)!==(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Gr;break}if(r.length=c&65535,c=0,f=0,r.mode=Dm,t===Z0)break e;case Dm:r.mode=Fb;case Fb:if(u=r.length,u){if(u>o&&(u=o),u>a&&(u=a),u===0)break e;i.set(n.subarray(s,s+u),l),o-=u,s+=u,a-=u,l+=u,r.length-=u;break}r.mode=mo;break;case jb:for(;f<14;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if(r.nlen=(c&31)+257,c>>>=5,f-=5,r.ndist=(c&31)+1,c>>>=5,f-=5,r.ncode=(c&15)+4,c>>>=4,f-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Gr;break}r.have=0,r.mode=Db;case Db:for(;r.have<r.ncode;){for(;f<3;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}r.lens[L[r.have++]]=c&7,c>>>=3,f-=3}for(;r.have<19;)r.lens[L[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,B={bits:r.lenbits},A=Rh(lD,r.lens,0,19,r.lencode,0,r.work,B),r.lenbits=B.bits,A){e.msg="invalid code lengths set",r.mode=Gr;break}r.have=0,r.mode=Lb;case Lb:for(;r.have<r.nlen+r.ndist;){for(;g=r.lencode[c&(1<<r.lenbits)-1],x=g>>>24,y=g>>>16&255,w=g&65535,!(x<=f);){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if(w<16)c>>>=x,f-=x,r.lens[r.have++]=w;else{if(w===16){for(F=x+2;f<F;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if(c>>>=x,f-=x,r.have===0){e.msg="invalid bit length repeat",r.mode=Gr;break}T=r.lens[r.have-1],u=3+(c&3),c>>>=2,f-=2}else if(w===17){for(F=x+3;f<F;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}c>>>=x,f-=x,T=0,u=3+(c&7),c>>>=3,f-=3}else{for(F=x+7;f<F;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}c>>>=x,f-=x,T=0,u=11+(c&127),c>>>=7,f-=7}if(r.have+u>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Gr;break}for(;u--;)r.lens[r.have++]=T}}if(r.mode===Gr)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Gr;break}if(r.lenbits=9,B={bits:r.lenbits},A=Rh(A3,r.lens,0,r.nlen,r.lencode,0,r.work,B),r.lenbits=B.bits,A){e.msg="invalid literal/lengths set",r.mode=Gr;break}if(r.distbits=6,r.distcode=r.distdyn,B={bits:r.distbits},A=Rh(O3,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,B),r.distbits=B.bits,A){e.msg="invalid distances set",r.mode=Gr;break}if(r.mode=ep,t===Z0)break e;case ep:r.mode=tp;case tp:if(o>=6&&a>=258){e.next_out=l,e.avail_out=a,e.next_in=s,e.avail_in=o,r.hold=c,r.bits=f,rD(e,d),l=e.next_out,i=e.output,a=e.avail_out,s=e.next_in,n=e.input,o=e.avail_in,c=r.hold,f=r.bits,r.mode===mo&&(r.back=-1);break}for(r.back=0;g=r.lencode[c&(1<<r.lenbits)-1],x=g>>>24,y=g>>>16&255,w=g&65535,!(x<=f);){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if(y&&!(y&240)){for(_=x,C=y,E=w;g=r.lencode[E+((c&(1<<_+C)-1)>>_)],x=g>>>24,y=g>>>16&255,w=g&65535,!(_+x<=f);){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}c>>>=_,f-=_,r.back+=_}if(c>>>=x,f-=x,r.back+=x,r.length=w,y===0){r.mode=Ub;break}if(y&32){r.back=-1,r.mode=mo;break}if(y&64){e.msg="invalid literal/length code",r.mode=Gr;break}r.extra=y&15,r.mode=Ib;case Ib:if(r.extra){for(F=r.extra;f<F;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,f-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=Rb;case Rb:for(;g=r.distcode[c&(1<<r.distbits)-1],x=g>>>24,y=g>>>16&255,w=g&65535,!(x<=f);){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if(!(y&240)){for(_=x,C=y,E=w;g=r.distcode[E+((c&(1<<_+C)-1)>>_)],x=g>>>24,y=g>>>16&255,w=g&65535,!(_+x<=f);){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}c>>>=_,f-=_,r.back+=_}if(c>>>=x,f-=x,r.back+=x,y&64){e.msg="invalid distance code",r.mode=Gr;break}r.offset=w,r.extra=y&15,r.mode=Mb;case Mb:if(r.extra){for(F=r.extra;f<F;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,f-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Gr;break}r.mode=Bb;case Bb:if(a===0)break e;if(u=d-a,r.offset>u){if(u=r.offset-u,u>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Gr;break}u>r.wnext?(u-=r.wnext,p=r.wsize-u):p=r.wnext-u,u>r.length&&(u=r.length),m=r.window}else m=i,p=l-r.offset,u=r.length;u>a&&(u=a),a-=u,r.length-=u;do i[l++]=m[p++];while(--u);r.length===0&&(r.mode=tp);break;case Ub:if(a===0)break e;i[l++]=r.length,a--,r.mode=tp;break;case Lm:if(r.wrap){for(;f<32;){if(o===0)break e;o--,c|=n[s++]<<f,f+=8}if(d-=a,e.total_out+=d,r.total+=d,r.wrap&4&&d&&(e.adler=r.check=r.flags?Da(r.check,i,d,l-d):bv(r.check,i,d,l-d)),d=a,r.wrap&4&&(r.flags?c:Hb(c))!==r.check){e.msg="incorrect data check",r.mode=Gr;break}c=0,f=0}r.mode=Wb;case Wb:if(r.wrap&&r.flags){for(;f<32;){if(o===0)break e;o--,c+=n[s++]<<f,f+=8}if(r.wrap&4&&c!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Gr;break}c=0,f=0}r.mode=zb;case zb:A=uD;break e;case Gr:A=P3;break e;case j3:return F3;case D3:default:return Ks}return e.next_out=l,e.avail_out=a,e.next_in=s,e.avail_in=o,r.hold=c,r.bits=f,(r.wsize||d!==e.avail_out&&r.mode<Gr&&(r.mode<Lm||t!==wb))&&B3(e,e.output,e.next_out,d-e.avail_out),h-=e.avail_in,d-=e.avail_out,e.total_in+=h,e.total_out+=d,r.total+=d,r.wrap&4&&d&&(e.adler=r.check=r.flags?Da(r.check,i,d,e.next_out-d):bv(r.check,i,d,e.next_out-d)),e.data_type=r.bits+(r.last?64:0)+(r.mode===mo?128:0)+(r.mode===ep||r.mode===Dm?256:0),(h===0&&d===0||t===wb)&&A===Lc&&(A=hD),A},_D=e=>{if(qc(e))return Ks;let t=e.state;return t.window&&(t.window=null),e.state=null,Lc},bD=(e,t)=>{if(qc(e))return Ks;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,Lc):Ks},SD=(e,t)=>{const r=t.length;let n,i,s;return qc(e)||(n=e.state,n.wrap!==0&&n.mode!==xg)?Ks:n.mode===xg&&(i=1,i=bv(i,t,r,0),i!==n.check)?P3:(s=B3(e,t,r,r),s?(n.mode=j3,F3):(n.havedict=1,Lc))};var kD=I3,CD=R3,ED=L3,TD=vD,ND=M3,AD=wD,OD=_D,PD=bD,FD=SD,jD="pako inflate (from Nodeca project)",wo={inflateReset:kD,inflateReset2:CD,inflateResetKeep:ED,inflateInit:TD,inflateInit2:ND,inflate:AD,inflateEnd:OD,inflateGetHeader:PD,inflateSetDictionary:FD,inflateInfo:jD};function DD(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var LD=DD;const U3=Object.prototype.toString,{Z_NO_FLUSH:ID,Z_FINISH:RD,Z_OK:wd,Z_STREAM_END:Mm,Z_NEED_DICT:Bm,Z_STREAM_ERROR:MD,Z_DATA_ERROR:Vb,Z_MEM_ERROR:BD}=E3;function Hd(e){this.options=T3.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new eD,this.strm.avail_out=0;let r=wo.inflateInit2(this.strm,t.windowBits);if(r!==wd)throw new Error(Sv[r]);if(this.header=new LD,wo.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=kv.string2buf(t.dictionary):U3.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=wo.inflateSetDictionary(this.strm,t.dictionary),r!==wd)))throw new Error(Sv[r])}Hd.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let s,l,o;if(this.ended)return!1;for(t===~~t?l=t:l=t===!0?RD:ID,U3.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),s=wo.inflate(r,l),s===Bm&&i&&(s=wo.inflateSetDictionary(r,i),s===wd?s=wo.inflate(r,l):s===Vb&&(s=Bm));r.avail_in>0&&s===Mm&&r.state.wrap>0&&e[r.next_in]!==0;)wo.inflateReset(r),s=wo.inflate(r,l);switch(s){case MD:case Vb:case Bm:case BD:return this.onEnd(s),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(r.avail_out===0||s===Mm))if(this.options.to==="string"){let a=kv.utf8border(r.output,r.next_out),c=r.next_out-a,f=kv.buf2string(r.output,a);r.next_out=c,r.avail_out=n-c,c&&r.output.set(r.output.subarray(a,a+c),0),this.onData(f)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===wd&&o===0)){if(s===Mm)return s=wo.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Hd.prototype.onData=function(e){this.chunks.push(e)};Hd.prototype.onEnd=function(e){e===wd&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=T3.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function UD(e,t){const r=new Hd(t);if(r.push(e),r.err)throw r.msg||Sv[r.err];return r.result}var WD=Hd,zD=UD,HD={Inflate:WD,inflate:zD};const{Inflate:$D,inflate:VD}=HD;var qb=$D,qD=VD;const W3=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;W3[e]=t}const Gb=4294967295;function GD(e,t,r){let n=e;for(let i=0;i<r;i++)n=W3[(n^t[i])&255]^n>>>8;return n}function XD(e,t){return(GD(Gb,e,t)^Gb)>>>0}function Xb(e,t,r){const n=e.readUint32(),i=XD(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(i!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${i}`)}function z3(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function H3(e,t,r,n){let i=0;for(;i<n;i++)t[i]=e[i];for(;i<r;i++)t[i]=e[i]+t[i-n]&255}function $3(e,t,r,n){let i=0;if(r.length===0)for(;i<n;i++)t[i]=e[i];else for(;i<n;i++)t[i]=e[i]+r[i]&255}function V3(e,t,r,n,i){let s=0;if(r.length===0){for(;s<i;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+(t[s-i]>>1)&255}else{for(;s<i;s++)t[s]=e[s]+(r[s]>>1)&255;for(;s<n;s++)t[s]=e[s]+(t[s-i]+r[s]>>1)&255}}function q3(e,t,r,n,i){let s=0;if(r.length===0){for(;s<i;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+t[s-i]&255}else{for(;s<i;s++)t[s]=e[s]+r[s]&255;for(;s<n;s++)t[s]=e[s]+YD(t[s-i],r[s],r[s-i])&255}}function YD(e,t,r){const n=e+t-r,i=Math.abs(n-e),s=Math.abs(n-t),l=Math.abs(n-r);return i<=s&&i<=l?e:s<=l?t:r}function KD(e,t,r,n,i,s){switch(e){case 0:z3(t,r,i);break;case 1:H3(t,r,i,s);break;case 2:$3(t,r,n,i);break;case 3:V3(t,r,n,i,s);break;case 4:q3(t,r,n,i,s);break;default:throw new Error(`Unsupported filter: ${e}`)}}const JD=new Uint16Array([255]),QD=new Uint8Array(JD.buffer),ZD=QD[0]===255;function eL(e){const{data:t,width:r,height:n,channels:i,depth:s}=e,l=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(s/8)*i,a=new Uint8Array(n*r*o);let c=0;for(let f=0;f<7;f++){const h=l[f],d=Math.ceil((r-h.x)/h.xStep),u=Math.ceil((n-h.y)/h.yStep);if(d<=0||u<=0)continue;const p=d*o,m=new Uint8Array(p);for(let g=0;g<u;g++){const x=t[c++],y=t.subarray(c,c+p);c+=p;const w=new Uint8Array(p);KD(x,y,w,m,p,o),m.set(w);for(let _=0;_<d;_++){const C=h.x+_*h.xStep,E=h.y+g*h.yStep;if(!(C>=r||E>=n))for(let T=0;T<o;T++)a[(E*r+C)*o+T]=w[_*o+T]}}}if(s===16){const f=new Uint16Array(a.buffer);if(ZD)for(let h=0;h<f.length;h++)f[h]=tL(f[h]);return f}else return a}function tL(e){return(e&255)<<8|e>>8&255}const rL=new Uint16Array([255]),nL=new Uint8Array(rL.buffer),iL=nL[0]===255,sL=new Uint8Array(0);function Yb(e){const{data:t,width:r,height:n,channels:i,depth:s}=e,l=Math.ceil(s/8)*i,o=Math.ceil(s/8*i*r),a=new Uint8Array(n*o);let c=sL,f=0,h,d;for(let u=0;u<n;u++){switch(h=t.subarray(f+1,f+1+o),d=a.subarray(u*o,(u+1)*o),t[f]){case 0:z3(h,d,o);break;case 1:H3(h,d,o,l);break;case 2:$3(h,d,c,o);break;case 3:V3(h,d,c,o,l);break;case 4:q3(h,d,c,o,l);break;default:throw new Error(`Unsupported filter: ${t[f]}`)}c=d,f+=o+1}if(s===16){const u=new Uint16Array(a.buffer);if(iL)for(let p=0;p<u.length;p++)u[p]=aL(u[p]);return u}else return a}function aL(e){return(e&255)<<8|e>>8&255}const Fp=Uint8Array.of(137,80,78,71,13,10,26,10);function Kb(e){if(!oL(e.readBytes(Fp.length)))throw new Error("wrong PNG signature")}function oL(e){if(e.length<Fp.length)return!1;for(let t=0;t<Fp.length;t++)if(e[t]!==Fp[t])return!1;return!0}const lL="tEXt",cL=0,G3=new TextDecoder("latin1");function uL(e){if(hL(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const fL=/^[\u0000-\u00FF]*$/;function hL(e){if(!fL.test(e))throw new Error("invalid latin1 text")}function dL(e,t,r){const n=X3(t);e[n]=pL(t,r-n.length-1)}function X3(e){for(e.mark();e.readByte()!==cL;);const t=e.offset;e.reset();const r=G3.decode(e.readBytes(t-e.offset-1));return e.skip(1),uL(r),r}function pL(e,t){return G3.decode(e.readBytes(t))}const ps={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Um={UNKNOWN:-1,DEFLATE:0},Jb={UNKNOWN:-1,ADAPTIVE:0},Wm={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},rp={NONE:0,BACKGROUND:1,PREVIOUS:2},zm={SOURCE:0,OVER:1};class gL extends X2{constructor(r,n={}){super(r);ft(this,"_checkCrc");ft(this,"_inflator");ft(this,"_png");ft(this,"_apng");ft(this,"_end");ft(this,"_hasPalette");ft(this,"_palette");ft(this,"_hasTransparency");ft(this,"_transparency");ft(this,"_compressionMethod");ft(this,"_filterMethod");ft(this,"_interlaceMethod");ft(this,"_colorType");ft(this,"_isAnimated");ft(this,"_numberOfFrames");ft(this,"_numberOfPlays");ft(this,"_frames");ft(this,"_writingDataChunks");const{checkCrc:i=!1}=n;this._checkCrc=i,this._inflator=new qb,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Um.UNKNOWN,this._filterMethod=Jb.UNKNOWN,this._interlaceMethod=Wm.UNKNOWN,this._colorType=ps.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Kb(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(Kb(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const i=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case lL:dL(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?Xb(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const i=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=i+r;break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?Xb(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=mL(this.readUint8());const n=this.readUint8();this._colorType=n;let i;switch(n){case ps.GREYSCALE:i=1;break;case ps.TRUECOLOUR:i=3;break;case ps.INDEXED_COLOUR:i=1;break;case ps.GREYSCALE_ALPHA:i=2;break;case ps.TRUECOLOUR_ALPHA:i=4;break;case ps.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==Um.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const i=[];this._palette=i;for(let s=0;s<n;s++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,i=this.offset+this.byteOffset;if(i+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case ps.GREYSCALE:case ps.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case ps.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const i=this.readByte();this._palette[n].push(i)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case ps.UNKNOWN:case ps.GREYSCALE_ALPHA:case ps.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=X3(this),i=this.readUint8();if(i!==Um.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const s=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:qD(s)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),i=this.readByte();this._png.resolution={x:r,y:n,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(r);if(i){if(i.data=Yb({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)n.data=i.data;else{const s=this._apng.frames.at(r-1);this.disposeFrame(i,s,n),this.addFrameDataToCanvas(n,i)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,i){switch(r.disposeOp){case rp.NONE:break;case rp.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let l=0;l<this._png.width;l++){const o=(s*r.width+l)*this._png.channels;for(let a=0;a<this._png.channels;a++)i.data[o+a]=0}break;case rp.PREVIOUS:i.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const i=1<<this._png.depth,s=(l,o)=>{const a=((l+n.yOffset)*this._png.width+n.xOffset+o)*this._png.channels,c=(l*n.width+o)*this._png.channels;return{index:a,frameIndex:c}};switch(n.blendOp){case zm.SOURCE:for(let l=0;l<n.height;l++)for(let o=0;o<n.width;o++){const{index:a,frameIndex:c}=s(l,o);for(let f=0;f<this._png.channels;f++)r.data[a+f]=n.data[c+f]}break;case zm.OVER:for(let l=0;l<n.height;l++)for(let o=0;o<n.width;o++){const{index:a,frameIndex:c}=s(l,o);for(let f=0;f<this._png.channels;f++){const h=n.data[c+this._png.channels-1]/i,d=f%(this._png.channels-1)===0?1:n.data[c+f],u=Math.floor(h*d+(1-h)*r.data[a+f]);r.data[a+f]+=u}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==Jb.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Wm.NO_INTERLACE)this._png.data=Yb({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Wm.ADAM7)this._png.data=eL({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:rp.NONE,blendOp:zm.SOURCE,data:r}),this._inflator=new qb,this._writingDataChunks=!1}}function mL(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var Qb;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(Qb||(Qb={}));function xL(e,t){return new gL(e,t).decode()}var qt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Hm(){qt.console&&typeof qt.console.log=="function"&&qt.console.log.apply(qt.console,arguments)}var jr={log:Hm,warn:function(e){qt.console&&(typeof qt.console.warn=="function"?qt.console.warn.apply(qt.console,arguments):Hm.call(null,arguments))},error:function(e){qt.console&&(typeof qt.console.error=="function"?qt.console.error.apply(qt.console,arguments):Hm(e))}};function $m(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){uc(n.response,t,r)},n.onerror=function(){jr.error("could not download file")},n.send()}function Zb(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function np(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var uc=qt.saveAs||((typeof window>"u"?"undefined":Er(window))!=="object"||window!==qt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=qt.URL||qt.webkitURL,i=document.createElement("a");t=t||e.name||"download",i.download=t,i.rel="noopener",typeof e=="string"?(i.href=e,i.origin!==location.origin?Zb(i.href)?$m(e,t,r):np(i,i.target="_blank"):np(i)):(i.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){np(i)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(Zb(e))$m(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){np(n)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:Er(s)!=="object"&&(jr.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return $m(e,t,r);var i=e.type==="application/octet-stream",s=/constructor/i.test(qt.HTMLElement)||qt.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||i&&s)&&(typeof FileReader>"u"?"undefined":Er(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var f=o.result;f=l?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=f:location=f,n=null},o.readAsDataURL(e)}else{var a=qt.URL||qt.webkitURL,c=a.createObjectURL(e);n?n.location=c:location.href=c,n=null,setTimeout(function(){a.revokeObjectURL(c)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Y3(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,s=r[n].process,l=i.exec(e);l&&(t=s(l),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),a=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),a.length==1&&(a="0"+a),c.length==1&&(c="0"+c),"#"+o+a+c}}var jp=qt.atob.bind(qt),e5=qt.btoa.bind(qt);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Vm(e,t){var r=e[0],n=e[1],i=e[2],s=e[3];r=_i(r,n,i,s,t[0],7,-680876936),s=_i(s,r,n,i,t[1],12,-389564586),i=_i(i,s,r,n,t[2],17,606105819),n=_i(n,i,s,r,t[3],22,-1044525330),r=_i(r,n,i,s,t[4],7,-176418897),s=_i(s,r,n,i,t[5],12,1200080426),i=_i(i,s,r,n,t[6],17,-1473231341),n=_i(n,i,s,r,t[7],22,-45705983),r=_i(r,n,i,s,t[8],7,1770035416),s=_i(s,r,n,i,t[9],12,-1958414417),i=_i(i,s,r,n,t[10],17,-42063),n=_i(n,i,s,r,t[11],22,-1990404162),r=_i(r,n,i,s,t[12],7,1804603682),s=_i(s,r,n,i,t[13],12,-40341101),i=_i(i,s,r,n,t[14],17,-1502002290),r=bi(r,n=_i(n,i,s,r,t[15],22,1236535329),i,s,t[1],5,-165796510),s=bi(s,r,n,i,t[6],9,-1069501632),i=bi(i,s,r,n,t[11],14,643717713),n=bi(n,i,s,r,t[0],20,-373897302),r=bi(r,n,i,s,t[5],5,-701558691),s=bi(s,r,n,i,t[10],9,38016083),i=bi(i,s,r,n,t[15],14,-660478335),n=bi(n,i,s,r,t[4],20,-405537848),r=bi(r,n,i,s,t[9],5,568446438),s=bi(s,r,n,i,t[14],9,-1019803690),i=bi(i,s,r,n,t[3],14,-187363961),n=bi(n,i,s,r,t[8],20,1163531501),r=bi(r,n,i,s,t[13],5,-1444681467),s=bi(s,r,n,i,t[2],9,-51403784),i=bi(i,s,r,n,t[7],14,1735328473),r=Si(r,n=bi(n,i,s,r,t[12],20,-1926607734),i,s,t[5],4,-378558),s=Si(s,r,n,i,t[8],11,-2022574463),i=Si(i,s,r,n,t[11],16,1839030562),n=Si(n,i,s,r,t[14],23,-35309556),r=Si(r,n,i,s,t[1],4,-1530992060),s=Si(s,r,n,i,t[4],11,1272893353),i=Si(i,s,r,n,t[7],16,-155497632),n=Si(n,i,s,r,t[10],23,-1094730640),r=Si(r,n,i,s,t[13],4,681279174),s=Si(s,r,n,i,t[0],11,-358537222),i=Si(i,s,r,n,t[3],16,-722521979),n=Si(n,i,s,r,t[6],23,76029189),r=Si(r,n,i,s,t[9],4,-640364487),s=Si(s,r,n,i,t[12],11,-421815835),i=Si(i,s,r,n,t[15],16,530742520),r=ki(r,n=Si(n,i,s,r,t[2],23,-995338651),i,s,t[0],6,-198630844),s=ki(s,r,n,i,t[7],10,1126891415),i=ki(i,s,r,n,t[14],15,-1416354905),n=ki(n,i,s,r,t[5],21,-57434055),r=ki(r,n,i,s,t[12],6,1700485571),s=ki(s,r,n,i,t[3],10,-1894986606),i=ki(i,s,r,n,t[10],15,-1051523),n=ki(n,i,s,r,t[1],21,-2054922799),r=ki(r,n,i,s,t[8],6,1873313359),s=ki(s,r,n,i,t[15],10,-30611744),i=ki(i,s,r,n,t[6],15,-1560198380),n=ki(n,i,s,r,t[13],21,1309151649),r=ki(r,n,i,s,t[4],6,-145523070),s=ki(s,r,n,i,t[11],10,-1120210379),i=ki(i,s,r,n,t[2],15,718787259),n=ki(n,i,s,r,t[9],21,-343485551),e[0]=gl(r,e[0]),e[1]=gl(n,e[1]),e[2]=gl(i,e[2]),e[3]=gl(s,e[3])}function n1(e,t,r,n,i,s){return t=gl(gl(t,e),gl(n,s)),gl(t<<i|t>>>32-i,r)}function _i(e,t,r,n,i,s,l){return n1(t&r|~t&n,e,t,i,s,l)}function bi(e,t,r,n,i,s,l){return n1(t&n|r&~n,e,t,i,s,l)}function Si(e,t,r,n,i,s,l){return n1(t^r^n,e,t,i,s,l)}function ki(e,t,r,n,i,s,l){return n1(r^(t|~n),e,t,i,s,l)}function K3(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Vm(n,vL(e.substring(t-64,t)));e=e.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(Vm(n,i),t=0;t<16;t++)i[t]=0;return i[14]=8*r,Vm(n,i),n}function vL(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var t5="0123456789abcdef".split("");function yL(e){for(var t="",r=0;r<4;r++)t+=t5[e>>8*r+4&15]+t5[e>>8*r&15];return t}function wL(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Cv(e){return K3(e).map(wL).join("")}var _L=function(e){for(var t=0;t<e.length;t++)e[t]=yL(e[t]);return e.join("")}(K3("hello"))!="5d41402abc4b2a76b9719d911017c592";function gl(e,t){if(_L){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Ev(e,t){var r,n,i,s;if(e!==r){for(var l=(i=e,s=1+(256/e.length|0),new Array(s+1).join(i)),o=[],a=0;a<256;a++)o[a]=a;var c=0;for(a=0;a<256;a++){var f=o[a];c=(c+f+l.charCodeAt(a))%256,o[a]=o[c],o[c]=f}r=e,n=o}else o=n;var h=t.length,d=0,u=0,p="";for(a=0;a<h;a++)u=(u+(f=o[d=(d+1)%256]))%256,o[d]=o[u],o[u]=f,l=o[(o[d]+o[u])%256],p+=String.fromCharCode(t.charCodeAt(a)^l);return p}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var r5={print:4,modify:8,copy:16,"annot-forms":32};function Au(e,t,r,n){this.v=1,this.r=2;var i=192;e.forEach(function(o){if(r5.perm!==void 0)throw new Error("Invalid permission: "+o);i+=r5[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(t+this.padding).substr(0,32),l=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,l),this.P=-(1+(255^i)),this.encryptionKey=Cv(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Ev(this.encryptionKey,this.padding)}function Ou(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var i=e.charCodeAt(n);t+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):e[n]}return t}function n5(e){if(Er(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var s=Math.random().toString(35);return t[r][s]=[n,!!i],s},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var s in t[r]){var l=t[r][s];try{l[0].apply(e,n)}catch(o){qt.console&&jr.error("jsPDF PubSub Error",o.message,o)}l[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function vg(e){if(!(this instanceof vg))return new vg(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function J3(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function pc(e,t,r,n,i){if(!(this instanceof pc))return new pc(e,t,r,n,i);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,J3.call(this,n,i)}function Vu(e,t,r,n,i){if(!(this instanceof Vu))return new Vu(e,t,r,n,i);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,J3.call(this,n,i)}function Lt(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],s=arguments[3],l=[],o=1,a=16,c="S",f=null;Er(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,i=e.format||i,s=e.compress||e.compressPdf||s,(f=e.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(a=e.floatPrecision),c=e.defaultPathOperation||"S"),l=e.filters||(s===!0?["FlateEncode"]:l),n=n||"mm",r=(""+(r||"P")).toLowerCase();var h=e.putOnlyUsedFonts||!1,d={},u={internal:{},__private__:{}};u.__private__.PubSub=n5;var p="1.3",m=u.__private__.getPdfVersion=function(){return p};u.__private__.setPdfVersion=function(D){p=D};var g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};u.__private__.getPageFormats=function(){return g};var x=u.__private__.getPageFormat=function(D){return g[D]};i=i||"a4";var y="compat",w="advanced",_=y;function C(){this.saveGraphicsState(),W(new kt(Pe,0,0,-Pe,0,Yl()*Pe).toString()+" cm"),this.setFontSize(this.getFontSize()/Pe),c="n",_=w}function E(){this.restoreGraphicsState(),c="S",_=y}var T=u.__private__.combineFontStyleAndFontWeight=function(D,ee){if(D=="bold"&&ee=="normal"||D=="bold"&&ee==400||D=="normal"&&ee=="italic"||D=="bold"&&ee=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ee&&(D=ee==400||ee==="normal"?D==="italic"?"italic":"normal":ee!=700&&ee!=="bold"||D!=="normal"?(ee==700?"bold":ee)+""+D:"bold"),D};u.advancedAPI=function(D){var ee=_===y;return ee&&C.call(this),typeof D!="function"||(D(this),ee&&E.call(this)),this},u.compatAPI=function(D){var ee=_===w;return ee&&E.call(this),typeof D!="function"||(D(this),ee&&C.call(this)),this},u.isAdvancedAPI=function(){return _===w};var A,j=function(D){if(_!==w)throw new Error(D+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},B=u.roundToPrecision=u.__private__.roundToPrecision=function(D,ee){var Ce=t||ee;if(isNaN(D)||isNaN(Ce))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return D.toFixed(Ce).replace(/0+$/,"")};A=u.hpf=u.__private__.hpf=typeof a=="number"?function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.hpf");return B(D,a)}:a==="smart"?function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.hpf");return B(D,D>-1&&D<1?16:5)}:function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.hpf");return B(D,16)};var F=u.f2=u.__private__.f2=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.f2");return B(D,2)},L=u.__private__.f3=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.f3");return B(D,3)},G=u.scale=u.__private__.scale=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.scale");return _===y?D*Pe:_===w?D:void 0},X=function(D){return G(function(ee){return _===y?Yl()-ee:_===w?ee:void 0}(D))};u.__private__.setPrecision=u.setPrecision=function(D){typeof parseInt(D,10)=="number"&&(t=parseInt(D,10))};var re,Q="00000000000000000000000000000000",ne=u.__private__.getFileId=function(){return Q},J=u.__private__.setFileId=function(D){return Q=D!==void 0&&/^[a-fA-F0-9]{32}$/.test(D)?D.toUpperCase():Q.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(Bn=new Au(f.userPermissions,f.userPassword,f.ownerPassword,Q)),Q};u.setFileId=function(D){return J(D),this},u.getFileId=function(){return ne()};var P=u.__private__.convertDateToPDFDate=function(D){var ee=D.getTimezoneOffset(),Ce=ee<0?"+":"-",Oe=Math.floor(Math.abs(ee/60)),Le=Math.abs(ee%60),tt=[Ce,O(Oe),"'",O(Le),"'"].join("");return["D:",D.getFullYear(),O(D.getMonth()+1),O(D.getDate()),O(D.getHours()),O(D.getMinutes()),O(D.getSeconds()),tt].join("")},H=u.__private__.convertPDFDateToDate=function(D){var ee=parseInt(D.substr(2,4),10),Ce=parseInt(D.substr(6,2),10)-1,Oe=parseInt(D.substr(8,2),10),Le=parseInt(D.substr(10,2),10),tt=parseInt(D.substr(12,2),10),at=parseInt(D.substr(14,2),10);return new Date(ee,Ce,Oe,Le,tt,at,0)},U=u.__private__.setCreationDate=function(D){var ee;if(D===void 0&&(D=new Date),D instanceof Date)ee=P(D);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(D))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ee=D}return re=ee},S=u.__private__.getCreationDate=function(D){var ee=re;return D==="jsDate"&&(ee=H(re)),ee};u.setCreationDate=function(D){return U(D),this},u.getCreationDate=function(D){return S(D)};var I,O=u.__private__.padd2=function(D){return("0"+parseInt(D)).slice(-2)},N=u.__private__.padd2Hex=function(D){return("00"+(D=D.toString())).substr(D.length)},R=0,z=[],K=[],Y=0,Z=[],se=[],V=!1,le=K;u.__private__.setCustomOutputDestination=function(D){V=!0,le=D};var ae=function(D){V||(le=D)};u.__private__.resetCustomOutputDestination=function(){V=!1,le=K};var W=u.__private__.out=function(D){return D=D.toString(),Y+=D.length+1,le.push(D),le},he=u.__private__.write=function(D){return W(arguments.length===1?D.toString():Array.prototype.join.call(arguments," "))},fe=u.__private__.getArrayBuffer=function(D){for(var ee=D.length,Ce=new ArrayBuffer(ee),Oe=new Uint8Array(Ce);ee--;)Oe[ee]=D.charCodeAt(ee);return Ce},Te=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];u.__private__.getStandardFonts=function(){return Te};var be=e.fontSize||16;u.__private__.setFontSize=u.setFontSize=function(D){return be=_===w?D/Pe:D,this};var pe,xe=u.__private__.getFontSize=u.getFontSize=function(){return _===y?be:be*Pe},ce=e.R2L||!1;u.__private__.setR2L=u.setR2L=function(D){return ce=D,this},u.__private__.getR2L=u.getR2L=function(){return ce};var Ne,Ie=u.__private__.setZoomMode=function(D){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(D))pe=D;else if(isNaN(D)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(D)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+D+'" is not recognized.');pe=D}else pe=parseInt(D,10)};u.__private__.getZoomMode=function(){return pe};var Re,De=u.__private__.setPageMode=function(D){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(D)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+D+'" is not recognized.');Ne=D};u.__private__.getPageMode=function(){return Ne};var Me=u.__private__.setLayoutMode=function(D){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(D)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+D+'" is not recognized.');Re=D};u.__private__.getLayoutMode=function(){return Re},u.__private__.setDisplayMode=u.setDisplayMode=function(D,ee,Ce){return Ie(D),Me(ee),De(Ce),this};var Ge={title:"",subject:"",author:"",keywords:"",creator:""};u.__private__.getDocumentProperty=function(D){if(Object.keys(Ge).indexOf(D)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ge[D]},u.__private__.getDocumentProperties=function(){return Ge},u.__private__.setDocumentProperties=u.setProperties=u.setDocumentProperties=function(D){for(var ee in Ge)Ge.hasOwnProperty(ee)&&D[ee]&&(Ge[ee]=D[ee]);return this},u.__private__.setDocumentProperty=function(D,ee){if(Object.keys(Ge).indexOf(D)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ge[D]=ee};var Ae,Pe,Ue,Ye,nt,Qe={},ht={},it=[],dt={},Mt={},bt={},Et={},ir=null,Qt=0,St=[],cr=new n5(u),Zs=e.hotfixes||[],Kr={},Gi={},Li=[],kt=function D(ee,Ce,Oe,Le,tt,at){if(!(this instanceof D))return new D(ee,Ce,Oe,Le,tt,at);isNaN(ee)&&(ee=1),isNaN(Ce)&&(Ce=0),isNaN(Oe)&&(Oe=0),isNaN(Le)&&(Le=1),isNaN(tt)&&(tt=0),isNaN(at)&&(at=0),this._matrix=[ee,Ce,Oe,Le,tt,at]};Object.defineProperty(kt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(D){this._matrix[0]=D}}),Object.defineProperty(kt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(D){this._matrix[1]=D}}),Object.defineProperty(kt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(D){this._matrix[2]=D}}),Object.defineProperty(kt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(D){this._matrix[3]=D}}),Object.defineProperty(kt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(D){this._matrix[4]=D}}),Object.defineProperty(kt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(D){this._matrix[5]=D}}),Object.defineProperty(kt.prototype,"a",{get:function(){return this._matrix[0]},set:function(D){this._matrix[0]=D}}),Object.defineProperty(kt.prototype,"b",{get:function(){return this._matrix[1]},set:function(D){this._matrix[1]=D}}),Object.defineProperty(kt.prototype,"c",{get:function(){return this._matrix[2]},set:function(D){this._matrix[2]=D}}),Object.defineProperty(kt.prototype,"d",{get:function(){return this._matrix[3]},set:function(D){this._matrix[3]=D}}),Object.defineProperty(kt.prototype,"e",{get:function(){return this._matrix[4]},set:function(D){this._matrix[4]=D}}),Object.defineProperty(kt.prototype,"f",{get:function(){return this._matrix[5]},set:function(D){this._matrix[5]=D}}),Object.defineProperty(kt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(kt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(kt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(kt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),kt.prototype.join=function(D){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(A).join(D)},kt.prototype.multiply=function(D){var ee=D.sx*this.sx+D.shy*this.shx,Ce=D.sx*this.shy+D.shy*this.sy,Oe=D.shx*this.sx+D.sy*this.shx,Le=D.shx*this.shy+D.sy*this.sy,tt=D.tx*this.sx+D.ty*this.shx+this.tx,at=D.tx*this.shy+D.ty*this.sy+this.ty;return new kt(ee,Ce,Oe,Le,tt,at)},kt.prototype.decompose=function(){var D=this.sx,ee=this.shy,Ce=this.shx,Oe=this.sy,Le=this.tx,tt=this.ty,at=Math.sqrt(D*D+ee*ee),At=(D/=at)*Ce+(ee/=at)*Oe;Ce-=D*At,Oe-=ee*At;var Ft=Math.sqrt(Ce*Ce+Oe*Oe);return At/=Ft,D*(Oe/=Ft)<ee*(Ce/=Ft)&&(D=-D,ee=-ee,At=-At,at=-at),{scale:new kt(at,0,0,Ft,0,0),translate:new kt(1,0,0,1,Le,tt),rotate:new kt(D,ee,-ee,D,0,0),skew:new kt(1,0,At,1,0,0)}},kt.prototype.toString=function(D){return this.join(" ")},kt.prototype.inversed=function(){var D=this.sx,ee=this.shy,Ce=this.shx,Oe=this.sy,Le=this.tx,tt=this.ty,at=1/(D*Oe-ee*Ce),At=Oe*at,Ft=-ee*at,Gt=-Ce*at,Zt=D*at;return new kt(At,Ft,Gt,Zt,-At*Le-Gt*tt,-Ft*Le-Zt*tt)},kt.prototype.applyToPoint=function(D){var ee=D.x*this.sx+D.y*this.shx+this.tx,Ce=D.x*this.shy+D.y*this.sy+this.ty;return new no(ee,Ce)},kt.prototype.applyToRectangle=function(D){var ee=this.applyToPoint(D),Ce=this.applyToPoint(new no(D.x+D.w,D.y+D.h));return new If(ee.x,ee.y,Ce.x-ee.x,Ce.y-ee.y)},kt.prototype.clone=function(){var D=this.sx,ee=this.shy,Ce=this.shx,Oe=this.sy,Le=this.tx,tt=this.ty;return new kt(D,ee,Ce,Oe,Le,tt)},u.Matrix=kt;var Kn=u.matrixMult=function(D,ee){return ee.multiply(D)},ea=new kt(1,0,0,1,0,0);u.unitMatrix=u.identityMatrix=ea;var xi=function(D,ee){if(!Mt[D]){var Ce=(ee instanceof pc?"Sh":"P")+(Object.keys(dt).length+1).toString(10);ee.id=Ce,Mt[D]=Ce,dt[Ce]=ee,cr.publish("addPattern",ee)}};u.ShadingPattern=pc,u.TilingPattern=Vu,u.addShadingPattern=function(D,ee){return j("addShadingPattern()"),xi(D,ee),this},u.beginTilingPattern=function(D){j("beginTilingPattern()"),Rf(D.boundingBox[0],D.boundingBox[1],D.boundingBox[2]-D.boundingBox[0],D.boundingBox[3]-D.boundingBox[1],D.matrix)},u.endTilingPattern=function(D,ee){j("endTilingPattern()"),ee.stream=se[I].join(`
`),xi(D,ee),cr.publish("endTilingPattern",ee),Li.pop().restore()};var Xi,qr=u.__private__.newObject=function(){var D=Nn();return ie(D,!0),D},Nn=u.__private__.newObjectDeferred=function(){return R++,z[R]=function(){return Y},R},ie=function(D,ee){return ee=typeof ee=="boolean"&&ee,z[D]=Y,ee&&W(D+" 0 obj"),D},Se=u.__private__.newAdditionalObject=function(){var D={objId:Nn(),content:""};return Z.push(D),D},ge=Nn(),ve=Nn(),ke=u.__private__.decodeColorString=function(D){var ee=D.split(" ");if(ee.length!==2||ee[1]!=="g"&&ee[1]!=="G")ee.length!==5||ee[4]!=="k"&&ee[4]!=="K"||(ee=[(1-ee[0])*(1-ee[3]),(1-ee[1])*(1-ee[3]),(1-ee[2])*(1-ee[3]),"r"]);else{var Ce=parseFloat(ee[0]);ee=[Ce,Ce,Ce,"r"]}for(var Oe="#",Le=0;Le<3;Le++)Oe+=("0"+Math.floor(255*parseFloat(ee[Le])).toString(16)).slice(-2);return Oe},Ee=u.__private__.encodeColorString=function(D){var ee;typeof D=="string"&&(D={ch1:D});var Ce=D.ch1,Oe=D.ch2,Le=D.ch3,tt=D.ch4,at=D.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ce=="string"&&Ce.charAt(0)!=="#"){var At=new Y3(Ce);if(At.ok)Ce=At.toHex();else if(!/^\d*\.?\d*$/.test(Ce))throw new Error('Invalid color "'+Ce+'" passed to jsPDF.encodeColorString.')}if(typeof Ce=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ce)&&(Ce="#"+Ce[1]+Ce[1]+Ce[2]+Ce[2]+Ce[3]+Ce[3]),typeof Ce=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ce)){var Ft=parseInt(Ce.substr(1),16);Ce=Ft>>16&255,Oe=Ft>>8&255,Le=255&Ft}if(Oe===void 0||tt===void 0&&Ce===Oe&&Oe===Le)ee=typeof Ce=="string"?Ce+" "+at[0]:D.precision===2?F(Ce/255)+" "+at[0]:L(Ce/255)+" "+at[0];else if(tt===void 0||Er(tt)==="object"){if(tt&&!isNaN(tt.a)&&tt.a===0)return["1.","1.","1.",at[1]].join(" ");ee=typeof Ce=="string"?[Ce,Oe,Le,at[1]].join(" "):D.precision===2?[F(Ce/255),F(Oe/255),F(Le/255),at[1]].join(" "):[L(Ce/255),L(Oe/255),L(Le/255),at[1]].join(" ")}else ee=typeof Ce=="string"?[Ce,Oe,Le,tt,at[2]].join(" "):D.precision===2?[F(Ce),F(Oe),F(Le),F(tt),at[2]].join(" "):[L(Ce),L(Oe),L(Le),L(tt),at[2]].join(" ");return ee},We=u.__private__.getFilters=function(){return l},Ke=u.__private__.putStream=function(D){var ee=(D=D||{}).data||"",Ce=D.filters||We(),Oe=D.alreadyAppliedFilters||[],Le=D.addLength1||!1,tt=ee.length,at=D.objectId,At=function(Un){return Un};if(f!==null&&at===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(At=Bn.encryptor(at,0));var Ft={};Ce===!0&&(Ce=["FlateEncode"]);var Gt=D.additionalKeyValues||[],Zt=(Ft=Lt.API.processDataByFilters!==void 0?Lt.API.processDataByFilters(ee,Ce):{data:ee,reverseChain:[]}).reverseChain+(Array.isArray(Oe)?Oe.join(" "):Oe.toString());if(Ft.data.length!==0&&(Gt.push({key:"Length",value:Ft.data.length}),Le===!0&&Gt.push({key:"Length1",value:tt})),Zt.length!=0)if(Zt.split("/").length-1==1)Gt.push({key:"Filter",value:Zt});else{Gt.push({key:"Filter",value:"["+Zt+"]"});for(var hr=0;hr<Gt.length;hr+=1)if(Gt[hr].key==="DecodeParms"){for(var Jr=[],Pn=0;Pn<Ft.reverseChain.split("/").length-1;Pn+=1)Jr.push("null");Jr.push(Gt[hr].value),Gt[hr].value="["+Jr.join(" ")+"]"}}W("<<");for(var Dr=0;Dr<Gt.length;Dr++)W("/"+Gt[Dr].key+" "+Gt[Dr].value);W(">>"),Ft.data.length!==0&&(W("stream"),W(At(Ft.data)),W("endstream"))},ze=u.__private__.putPage=function(D){var ee=D.number,Ce=D.data,Oe=D.objId,Le=D.contentsObjId;ie(Oe,!0),W("<</Type /Page"),W("/Parent "+D.rootDictionaryObjId+" 0 R"),W("/Resources "+D.resourceDictionaryObjId+" 0 R"),W("/MediaBox ["+parseFloat(A(D.mediaBox.bottomLeftX))+" "+parseFloat(A(D.mediaBox.bottomLeftY))+" "+A(D.mediaBox.topRightX)+" "+A(D.mediaBox.topRightY)+"]"),D.cropBox!==null&&W("/CropBox ["+A(D.cropBox.bottomLeftX)+" "+A(D.cropBox.bottomLeftY)+" "+A(D.cropBox.topRightX)+" "+A(D.cropBox.topRightY)+"]"),D.bleedBox!==null&&W("/BleedBox ["+A(D.bleedBox.bottomLeftX)+" "+A(D.bleedBox.bottomLeftY)+" "+A(D.bleedBox.topRightX)+" "+A(D.bleedBox.topRightY)+"]"),D.trimBox!==null&&W("/TrimBox ["+A(D.trimBox.bottomLeftX)+" "+A(D.trimBox.bottomLeftY)+" "+A(D.trimBox.topRightX)+" "+A(D.trimBox.topRightY)+"]"),D.artBox!==null&&W("/ArtBox ["+A(D.artBox.bottomLeftX)+" "+A(D.artBox.bottomLeftY)+" "+A(D.artBox.topRightX)+" "+A(D.artBox.topRightY)+"]"),typeof D.userUnit=="number"&&D.userUnit!==1&&W("/UserUnit "+D.userUnit),cr.publish("putPage",{objId:Oe,pageContext:St[ee],pageNumber:ee,page:Ce}),W("/Contents "+Le+" 0 R"),W(">>"),W("endobj");var tt=Ce.join(`
`);return _===w&&(tt+=`
Q`),ie(Le,!0),Ke({data:tt,filters:We(),objectId:Le}),W("endobj"),Oe},He=u.__private__.putPages=function(){var D,ee,Ce=[];for(D=1;D<=Qt;D++)St[D].objId=Nn(),St[D].contentsObjId=Nn();for(D=1;D<=Qt;D++)Ce.push(ze({number:D,data:se[D],objId:St[D].objId,contentsObjId:St[D].contentsObjId,mediaBox:St[D].mediaBox,cropBox:St[D].cropBox,bleedBox:St[D].bleedBox,trimBox:St[D].trimBox,artBox:St[D].artBox,userUnit:St[D].userUnit,rootDictionaryObjId:ge,resourceDictionaryObjId:ve}));ie(ge,!0),W("<</Type /Pages");var Oe="/Kids [";for(ee=0;ee<Qt;ee++)Oe+=Ce[ee]+" 0 R ";W(Oe+"]"),W("/Count "+Qt),W(">>"),W("endobj"),cr.publish("postPutPages")},qe=function(D){cr.publish("putFont",{font:D,out:W,newObject:qr,putStream:Ke}),D.isAlreadyPutted!==!0&&(D.objectNumber=qr(),W("<<"),W("/Type /Font"),W("/BaseFont /"+Ou(D.postScriptName)),W("/Subtype /Type1"),typeof D.encoding=="string"&&W("/Encoding /"+D.encoding),W("/FirstChar 32"),W("/LastChar 255"),W(">>"),W("endobj"))},lt=function(D){D.objectNumber=qr();var ee=[];ee.push({key:"Type",value:"/XObject"}),ee.push({key:"Subtype",value:"/Form"}),ee.push({key:"BBox",value:"["+[A(D.x),A(D.y),A(D.x+D.width),A(D.y+D.height)].join(" ")+"]"}),ee.push({key:"Matrix",value:"["+D.matrix.toString()+"]"});var Ce=D.pages[1].join(`
`);Ke({data:Ce,additionalKeyValues:ee,objectId:D.objectNumber}),W("endobj")},mt=function(D,ee){ee||(ee=21);var Ce=qr(),Oe=function(at,At){var Ft,Gt=[],Zt=1/(At-1);for(Ft=0;Ft<1;Ft+=Zt)Gt.push(Ft);if(Gt.push(1),at[0].offset!=0){var hr={offset:0,color:at[0].color};at.unshift(hr)}if(at[at.length-1].offset!=1){var Jr={offset:1,color:at[at.length-1].color};at.push(Jr)}for(var Pn="",Dr=0,Un=0;Un<Gt.length;Un++){for(Ft=Gt[Un];Ft>at[Dr+1].offset;)Dr++;var Fn=at[Dr].offset,ii=(Ft-Fn)/(at[Dr+1].offset-Fn),ao=at[Dr].color,na=at[Dr+1].color;Pn+=N(Math.round((1-ii)*ao[0]+ii*na[0]).toString(16))+N(Math.round((1-ii)*ao[1]+ii*na[1]).toString(16))+N(Math.round((1-ii)*ao[2]+ii*na[2]).toString(16))}return Pn.trim()}(D.colors,ee),Le=[];Le.push({key:"FunctionType",value:"0"}),Le.push({key:"Domain",value:"[0.0 1.0]"}),Le.push({key:"Size",value:"["+ee+"]"}),Le.push({key:"BitsPerSample",value:"8"}),Le.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Le.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ke({data:Oe,additionalKeyValues:Le,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ce}),W("endobj"),D.objectNumber=qr(),W("<< /ShadingType "+D.type),W("/ColorSpace /DeviceRGB");var tt="/Coords ["+A(parseFloat(D.coords[0]))+" "+A(parseFloat(D.coords[1]))+" ";D.type===2?tt+=A(parseFloat(D.coords[2]))+" "+A(parseFloat(D.coords[3])):tt+=A(parseFloat(D.coords[2]))+" "+A(parseFloat(D.coords[3]))+" "+A(parseFloat(D.coords[4]))+" "+A(parseFloat(D.coords[5])),W(tt+="]"),D.matrix&&W("/Matrix ["+D.matrix.toString()+"]"),W("/Function "+Ce+" 0 R"),W("/Extend [true true]"),W(">>"),W("endobj")},_t=function(D,ee){var Ce=Nn(),Oe=qr();ee.push({resourcesOid:Ce,objectOid:Oe}),D.objectNumber=Oe;var Le=[];Le.push({key:"Type",value:"/Pattern"}),Le.push({key:"PatternType",value:"1"}),Le.push({key:"PaintType",value:"1"}),Le.push({key:"TilingType",value:"1"}),Le.push({key:"BBox",value:"["+D.boundingBox.map(A).join(" ")+"]"}),Le.push({key:"XStep",value:A(D.xStep)}),Le.push({key:"YStep",value:A(D.yStep)}),Le.push({key:"Resources",value:Ce+" 0 R"}),D.matrix&&Le.push({key:"Matrix",value:"["+D.matrix.toString()+"]"}),Ke({data:D.stream,additionalKeyValues:Le,objectId:D.objectNumber}),W("endobj")},gt=function(D){for(var ee in D.objectNumber=qr(),W("<<"),D)switch(ee){case"opacity":W("/ca "+F(D[ee]));break;case"stroke-opacity":W("/CA "+F(D[ee]))}W(">>"),W("endobj")},wt=function(D){ie(D.resourcesOid,!0),W("<<"),W("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var ee in W("/Font <<"),Qe)Qe.hasOwnProperty(ee)&&(h===!1||h===!0&&d.hasOwnProperty(ee))&&W("/"+ee+" "+Qe[ee].objectNumber+" 0 R");W(">>")}(),function(){if(Object.keys(dt).length>0){for(var ee in W("/Shading <<"),dt)dt.hasOwnProperty(ee)&&dt[ee]instanceof pc&&dt[ee].objectNumber>=0&&W("/"+ee+" "+dt[ee].objectNumber+" 0 R");cr.publish("putShadingPatternDict"),W(">>")}}(),function(ee){if(Object.keys(dt).length>0){for(var Ce in W("/Pattern <<"),dt)dt.hasOwnProperty(Ce)&&dt[Ce]instanceof u.TilingPattern&&dt[Ce].objectNumber>=0&&dt[Ce].objectNumber<ee&&W("/"+Ce+" "+dt[Ce].objectNumber+" 0 R");cr.publish("putTilingPatternDict"),W(">>")}}(D.objectOid),function(){if(Object.keys(bt).length>0){var ee;for(ee in W("/ExtGState <<"),bt)bt.hasOwnProperty(ee)&&bt[ee].objectNumber>=0&&W("/"+ee+" "+bt[ee].objectNumber+" 0 R");cr.publish("putGStateDict"),W(">>")}}(),function(){for(var ee in W("/XObject <<"),Kr)Kr.hasOwnProperty(ee)&&Kr[ee].objectNumber>=0&&W("/"+ee+" "+Kr[ee].objectNumber+" 0 R");cr.publish("putXobjectDict"),W(">>")}(),W(">>"),W("endobj")},$t=function(D){ht[D.fontName]=ht[D.fontName]||{},ht[D.fontName][D.fontStyle]=D.id},Ar=function(D,ee,Ce,Oe,Le){var tt={id:"F"+(Object.keys(Qe).length+1).toString(10),postScriptName:D,fontName:ee,fontStyle:Ce,encoding:Oe,isStandardFont:Le||!1,metadata:{}};return cr.publish("addFont",{font:tt,instance:this}),Qe[tt.id]=tt,$t(tt),tt.id},lr=u.__private__.pdfEscape=u.pdfEscape=function(D,ee){return function(Ce,Oe){var Le,tt,at,At,Ft,Gt,Zt,hr,Jr;if(at=(Oe=Oe||{}).sourceEncoding||"Unicode",Ft=Oe.outputEncoding,(Oe.autoencode||Ft)&&Qe[Ae].metadata&&Qe[Ae].metadata[at]&&Qe[Ae].metadata[at].encoding&&(At=Qe[Ae].metadata[at].encoding,!Ft&&Qe[Ae].encoding&&(Ft=Qe[Ae].encoding),!Ft&&At.codePages&&(Ft=At.codePages[0]),typeof Ft=="string"&&(Ft=At[Ft]),Ft)){for(Zt=!1,Gt=[],Le=0,tt=Ce.length;Le<tt;Le++)(hr=Ft[Ce.charCodeAt(Le)])?Gt.push(String.fromCharCode(hr)):Gt.push(Ce[Le]),Gt[Le].charCodeAt(0)>>8&&(Zt=!0);Ce=Gt.join("")}for(Le=Ce.length;Zt===void 0&&Le!==0;)Ce.charCodeAt(Le-1)>>8&&(Zt=!0),Le--;if(!Zt)return Ce;for(Gt=Oe.noBOM?[]:[254,255],Le=0,tt=Ce.length;Le<tt;Le++){if((Jr=(hr=Ce.charCodeAt(Le))>>8)>>8)throw new Error("Character at position "+Le+" of string '"+Ce+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Gt.push(Jr),Gt.push(hr-(Jr<<8))}return String.fromCharCode.apply(void 0,Gt)}(D,ee).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},sn=u.__private__.beginPage=function(D){se[++Qt]=[],St[Qt]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(D[0]),topRightY:Number(D[1])}},Ta(Qt),ae(se[I])},Ea=function(D,ee){var Ce,Oe,Le;switch(r=ee||r,typeof D=="string"&&(Ce=x(D.toLowerCase()),Array.isArray(Ce)&&(Oe=Ce[0],Le=Ce[1])),Array.isArray(D)&&(Oe=D[0]*Pe,Le=D[1]*Pe),isNaN(Oe)&&(Oe=i[0],Le=i[1]),(Oe>14400||Le>14400)&&(jr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Oe=Math.min(14400,Oe),Le=Math.min(14400,Le)),i=[Oe,Le],r.substr(0,1)){case"l":Le>Oe&&(i=[Le,Oe]);break;case"p":Oe>Le&&(i=[Le,Oe])}sn(i),Xt(Ff),W(su),Df!==0&&W(Df+" J"),Lf!==0&&W(Lf+" j"),cr.publish("addPage",{pageNumber:Qt})},ta=function(D){D>0&&D<=Qt&&(se.splice(D,1),St.splice(D,1),Qt--,I>Qt&&(I=Qt),this.setPage(I))},Ta=function(D){D>0&&D<=Qt&&(I=D)},Os=u.__private__.getNumberOfPages=u.getNumberOfPages=function(){return se.length-1},Uo=function(D,ee,Ce){var Oe,Le=void 0;return Ce=Ce||{},D=D!==void 0?D:Qe[Ae].fontName,ee=ee!==void 0?ee:Qe[Ae].fontStyle,Oe=D.toLowerCase(),ht[Oe]!==void 0&&ht[Oe][ee]!==void 0?Le=ht[Oe][ee]:ht[D]!==void 0&&ht[D][ee]!==void 0?Le=ht[D][ee]:Ce.disableWarning===!1&&jr.warn("Unable to look up font label for font '"+D+"', '"+ee+"'. Refer to getFontList() for available fonts."),Le||Ce.noFallback||(Le=ht.times[ee])==null&&(Le=ht.times.normal),Le},An=u.__private__.putInfo=function(){var D=qr(),ee=function(Oe){return Oe};for(var Ce in f!==null&&(ee=Bn.encryptor(D,0)),W("<<"),W("/Producer ("+lr(ee("jsPDF "+Lt.version))+")"),Ge)Ge.hasOwnProperty(Ce)&&Ge[Ce]&&W("/"+Ce.substr(0,1).toUpperCase()+Ce.substr(1)+" ("+lr(ee(Ge[Ce]))+")");W("/CreationDate ("+lr(ee(re))+")"),W(">>"),W("endobj")},ru=u.__private__.putCatalog=function(D){var ee=(D=D||{}).rootDictionaryObjId||ge;switch(qr(),W("<<"),W("/Type /Catalog"),W("/Pages "+ee+" 0 R"),pe||(pe="fullwidth"),pe){case"fullwidth":W("/OpenAction [3 0 R /FitH null]");break;case"fullheight":W("/OpenAction [3 0 R /FitV null]");break;case"fullpage":W("/OpenAction [3 0 R /Fit]");break;case"original":W("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ce=""+pe;Ce.substr(Ce.length-1)==="%"&&(pe=parseInt(pe)/100),typeof pe=="number"&&W("/OpenAction [3 0 R /XYZ null null "+F(pe)+"]")}switch(Re||(Re="continuous"),Re){case"continuous":W("/PageLayout /OneColumn");break;case"single":W("/PageLayout /SinglePage");break;case"two":case"twoleft":W("/PageLayout /TwoColumnLeft");break;case"tworight":W("/PageLayout /TwoColumnRight")}Ne&&W("/PageMode /"+Ne),cr.publish("putCatalog"),W(">>"),W("endobj")},m1=u.__private__.putTrailer=function(){W("trailer"),W("<<"),W("/Size "+(R+1)),W("/Root "+R+" 0 R"),W("/Info "+(R-1)+" 0 R"),f!==null&&W("/Encrypt "+Bn.oid+" 0 R"),W("/ID [ <"+Q+"> <"+Q+"> ]"),W(">>")},On=u.__private__.putHeader=function(){W("%PDF-"+p),W("%")},Zd=u.__private__.putXRef=function(){var D="0000000000";W("xref"),W("0 "+(R+1)),W("0000000000 65535 f ");for(var ee=1;ee<=R;ee++)typeof z[ee]=="function"?W((D+z[ee]()).slice(-10)+" 00000 n "):z[ee]!==void 0?W((D+z[ee]).slice(-10)+" 00000 n "):W("0000000000 00000 n ")},Na=u.__private__.buildDocument=function(){var D;R=0,Y=0,K=[],z=[],Z=[],ge=Nn(),ve=Nn(),ae(K),cr.publish("buildDocument"),On(),He(),function(){cr.publish("putAdditionalObjects");for(var Ce=0;Ce<Z.length;Ce++){var Oe=Z[Ce];ie(Oe.objId,!0),W(Oe.content),W("endobj")}cr.publish("postPutAdditionalObjects")}(),D=[],function(){for(var Ce in Qe)Qe.hasOwnProperty(Ce)&&(h===!1||h===!0&&d.hasOwnProperty(Ce))&&qe(Qe[Ce])}(),function(){var Ce;for(Ce in bt)bt.hasOwnProperty(Ce)&&gt(bt[Ce])}(),function(){for(var Ce in Kr)Kr.hasOwnProperty(Ce)&&lt(Kr[Ce])}(),function(Ce){var Oe;for(Oe in dt)dt.hasOwnProperty(Oe)&&(dt[Oe]instanceof pc?mt(dt[Oe]):dt[Oe]instanceof Vu&&_t(dt[Oe],Ce))}(D),cr.publish("putResources"),D.forEach(wt),wt({resourcesOid:ve,objectOid:Number.MAX_SAFE_INTEGER}),cr.publish("postPutResources"),f!==null&&(Bn.oid=qr(),W("<<"),W("/Filter /Standard"),W("/V "+Bn.v),W("/R "+Bn.r),W("/U <"+Bn.toHexString(Bn.U)+">"),W("/O <"+Bn.toHexString(Bn.O)+">"),W("/P "+Bn.P),W(">>"),W("endobj")),An(),ru();var ee=Y;return Zd(),m1(),W("startxref"),W(""+ee),W("%%EOF"),ae(se[I]),K.join(`
`)},nu=u.__private__.getBlob=function(D){return new Blob([fe(D)],{type:"application/pdf"})},e0=u.output=u.__private__.output=(Xi=function(D,ee){switch(typeof(ee=ee||{})=="string"?ee={filename:ee}:ee.filename=ee.filename||"generated.pdf",D){case void 0:return Na();case"save":u.save(ee.filename);break;case"arraybuffer":return fe(Na());case"blob":return nu(Na());case"bloburi":case"bloburl":if(qt.URL!==void 0&&typeof qt.URL.createObjectURL=="function")return qt.URL&&qt.URL.createObjectURL(nu(Na()))||void 0;jr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ce="",Oe=Na();try{Ce=e5(Oe)}catch{Ce=e5(unescape(encodeURIComponent(Oe)))}return"data:application/pdf;filename="+ee.filename+";base64,"+Ce;case"pdfobjectnewwindow":if(Object.prototype.toString.call(qt)==="[object Window]"){var Le="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",tt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ee.pdfObjectUrl&&(Le=ee.pdfObjectUrl,tt="");var at='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Le+'"'+tt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ee)+");<\/script></body></html>",At=qt.open();return At!==null&&At.document.write(at),At}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(qt)==="[object Window]"){var Ft='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ee.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ee.filename+'" width="500px" height="400px" /></body></html>',Gt=qt.open();if(Gt!==null){Gt.document.write(Ft);var Zt=this;Gt.document.documentElement.querySelector("#pdfViewer").onload=function(){Gt.document.title=ee.filename,Gt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Zt.output("bloburl"))}}return Gt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(qt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var hr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ee)+'"></iframe></body></html>',Jr=qt.open();if(Jr!==null&&(Jr.document.write(hr),Jr.document.title=ee.filename),Jr||typeof safari>"u")return Jr;break;case"datauri":case"dataurl":return qt.document.location.href=this.output("datauristring",ee);default:return null}},Xi.foo=function(){try{return Xi.apply(this,arguments)}catch(Ce){var D=Ce.stack||"";~D.indexOf(" at ")&&(D=D.split(" at ")[1]);var ee="Error in function "+D.split(`
`)[0].split("<")[0]+": "+Ce.message;if(!qt.console)throw new Error(ee);qt.console.error(ee,Ce),qt.alert&&alert(ee)}},Xi.foo.bar=Xi,Xi.foo),Ps=function(D){return Array.isArray(Zs)===!0&&Zs.indexOf(D)>-1};switch(n){case"pt":Pe=1;break;case"mm":Pe=72/25.4;break;case"cm":Pe=72/2.54;break;case"in":Pe=72;break;case"px":Pe=Ps("px_scaling")==1?.75:96/72;break;case"pc":case"em":Pe=12;break;case"ex":Pe=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Pe=n}var Bn=null;U(),J();var Za=u.__private__.getPageInfo=u.getPageInfo=function(D){if(isNaN(D)||D%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:St[D].objId,pageNumber:D,pageContext:St[D]}},t0=u.__private__.getPageInfoByObjId=function(D){if(isNaN(D)||D%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ee in St)if(St[ee].objId===D)break;return Za(ee)},x1=u.__private__.getCurrentPageInfo=u.getCurrentPageInfo=function(){return{objId:St[I].objId,pageNumber:I,pageContext:St[I]}};u.addPage=function(){return Ea.apply(this,arguments),this},u.setPage=function(){return Ta.apply(this,arguments),ae.call(this,se[I]),this},u.insertPage=function(D){return this.addPage(),this.movePage(I,D),this},u.movePage=function(D,ee){var Ce,Oe;if(D>ee){Ce=se[D],Oe=St[D];for(var Le=D;Le>ee;Le--)se[Le]=se[Le-1],St[Le]=St[Le-1];se[ee]=Ce,St[ee]=Oe,this.setPage(ee)}else if(D<ee){Ce=se[D],Oe=St[D];for(var tt=D;tt<ee;tt++)se[tt]=se[tt+1],St[tt]=St[tt+1];se[ee]=Ce,St[ee]=Oe,this.setPage(ee)}return this},u.deletePage=function(){return ta.apply(this,arguments),this},u.__private__.text=u.text=function(D,ee,Ce,Oe,Le){var tt,at,At,Ft,Gt,Zt,hr,Jr,Pn,Dr=(Oe=Oe||{}).scope||this;if(typeof D=="number"&&typeof ee=="number"&&(typeof Ce=="string"||Array.isArray(Ce))){var Un=Ce;Ce=ee,ee=D,D=Un}if(arguments[3]instanceof kt==0?(At=arguments[4],Ft=arguments[5],Er(hr=arguments[3])==="object"&&hr!==null||(typeof At=="string"&&(Ft=At,At=null),typeof hr=="string"&&(Ft=hr,hr=null),typeof hr=="number"&&(At=hr,hr=null),Oe={flags:hr,angle:At,align:Ft})):(j("The transform parameter of text() with a Matrix value"),Pn=Le),isNaN(ee)||isNaN(Ce)||D==null)throw new Error("Invalid arguments passed to jsPDF.text");if(D.length===0)return Dr;var Fn,ii="",ao=typeof Oe.lineHeightFactor=="number"?Oe.lineHeightFactor:ql,na=Dr.internal.scaleFactor;function oo(yr){return yr=yr.split("	").join(Array(Oe.TabLen||9).join(" ")),lr(yr,hr)}function Bf(yr){for(var Pr,mn=yr.concat(),Wn=[],uo=mn.length;uo--;)typeof(Pr=mn.shift())=="string"?Wn.push(Pr):Array.isArray(yr)&&(Pr.length===1||Pr[1]===void 0&&Pr[2]===void 0)?Wn.push(Pr[0]):Wn.push([Pr[0],Pr[1],Pr[2]]);return Wn}function ou(yr,Pr){var mn;if(typeof yr=="string")mn=Pr(yr)[0];else if(Array.isArray(yr)){for(var Wn,uo,Yf=yr.concat(),uu=[],h0=Yf.length;h0--;)typeof(Wn=Yf.shift())=="string"?uu.push(Pr(Wn)[0]):Array.isArray(Wn)&&typeof Wn[0]=="string"&&(uo=Pr(Wn[0],Wn[1],Wn[2]),uu.push([uo[0],uo[1],uo[2]]));mn=uu}return mn}var Wo=!1,Kl=!0;if(typeof D=="string")Wo=!0;else if(Array.isArray(D)){var Jl=D.concat();at=[];for(var zo,si=Jl.length;si--;)(typeof(zo=Jl.shift())!="string"||Array.isArray(zo)&&typeof zo[0]!="string")&&(Kl=!1);Wo=Kl}if(Wo===!1)throw new Error('Type of text must be string or Array. "'+D+'" is not recognized.');typeof D=="string"&&(D=D.match(/[\r?\n]/)?D.split(/\r\n|\r|\n/g):[D]);var Ql=be/Dr.internal.scaleFactor,Zl=Ql*(ao-1);switch(Oe.baseline){case"bottom":Ce-=Zl;break;case"top":Ce+=Ql-Zl;break;case"hanging":Ce+=Ql-2*Zl;break;case"middle":Ce+=Ql/2-Zl}if((Zt=Oe.maxWidth||0)>0&&(typeof D=="string"?D=Dr.splitTextToSize(D,Zt):Object.prototype.toString.call(D)==="[object Array]"&&(D=D.reduce(function(yr,Pr){return yr.concat(Dr.splitTextToSize(Pr,Zt))},[]))),tt={text:D,x:ee,y:Ce,options:Oe,mutex:{pdfEscape:lr,activeFontKey:Ae,fonts:Qe,activeFontSize:be}},cr.publish("preProcessText",tt),D=tt.text,At=(Oe=tt.options).angle,Pn instanceof kt==0&&At&&typeof At=="number"){At*=Math.PI/180,Oe.rotationDirection===0&&(At=-At),_===w&&(At=-At);var Uf=Math.cos(At),Wf=Math.sin(At);Pn=new kt(Uf,Wf,-Wf,Uf,0,0)}else At&&At instanceof kt&&(Pn=At);_!==w||Pn||(Pn=ea),(Gt=Oe.charSpace||ro)!==void 0&&(ii+=A(G(Gt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Jr=Oe.horizontalScale)!==void 0&&(ii+=A(100*Jr)+` Tz
`),Oe.lang;var Ii=-1,lo=Oe.renderingMode!==void 0?Oe.renderingMode:Oe.stroke,lu=Dr.internal.getCurrentPageInfo().pageContext;switch(lo){case 0:case!1:case"fill":Ii=0;break;case 1:case!0:case"stroke":Ii=1;break;case 2:case"fillThenStroke":Ii=2;break;case 3:case"invisible":Ii=3;break;case 4:case"fillAndAddForClipping":Ii=4;break;case 5:case"strokeAndAddPathForClipping":Ii=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ii=6;break;case 7:case"addToPathForClipping":Ii=7}var u0=lu.usedRenderingMode!==void 0?lu.usedRenderingMode:-1;Ii!==-1?ii+=Ii+` Tr
`:u0!==-1&&(ii+=`0 Tr
`),Ii!==-1&&(lu.usedRenderingMode=Ii),Ft=Oe.align||"left";var Fs,ec=be*ao,zf=Dr.internal.pageSize.getWidth(),Hf=Qe[Ae];Gt=Oe.charSpace||ro,Zt=Oe.maxWidth||0,hr=Object.assign({autoencode:!0,noBOM:!0},Oe.flags);var Ho=[],tc=function(yr){return Dr.getStringUnitWidth(yr,{font:Hf,charSpace:Gt,fontSize:be,doKerning:!1})*be/na};if(Object.prototype.toString.call(D)==="[object Array]"){var as;at=Bf(D),Ft!=="left"&&(Fs=at.map(tc));var os,$o=0;if(Ft==="right"){ee-=Fs[0],D=[],si=at.length;for(var co=0;co<si;co++)co===0?(os=eo(ee),as=to(Ce)):(os=G($o-Fs[co]),as=-ec),D.push([at[co],os,as]),$o=Fs[co]}else if(Ft==="center"){ee-=Fs[0]/2,D=[],si=at.length;for(var Vo=0;Vo<si;Vo++)Vo===0?(os=eo(ee),as=to(Ce)):(os=G(($o-Fs[Vo])/2),as=-ec),D.push([at[Vo],os,as]),$o=Fs[Vo]}else if(Ft==="left"){D=[],si=at.length;for(var $f=0;$f<si;$f++)D.push(at[$f])}else if(Ft==="justify"&&Hf.encoding==="Identity-H"){D=[],si=at.length,Zt=Zt!==0?Zt:zf;for(var cu=0,gn=0;gn<si;gn++)if(as=gn===0?to(Ce):-ec,os=gn===0?eo(ee):cu,gn<si-1){var f0=G((Zt-Fs[gn])/(at[gn].split(" ").length-1)),Oa=at[gn].split(" ");D.push([Oa[0]+" ",os,as]),cu=0;for(var Pa=1;Pa<Oa.length;Pa++){var Vf=(tc(Oa[Pa-1]+" "+Oa[Pa])-tc(Oa[Pa]))*na+f0;Pa==Oa.length-1?D.push([Oa[Pa],Vf,0]):D.push([Oa[Pa]+" ",Vf,0]),cu-=Vf}}else D.push([at[gn],os,as]);D.push(["",cu,0])}else{if(Ft!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(D=[],si=at.length,Zt=Zt!==0?Zt:zf,gn=0;gn<si;gn++){as=gn===0?to(Ce):-ec,os=gn===0?eo(ee):0;var qf=at[gn].split(" ").length-1,Gf=qf>0?(Zt-Fs[gn])/qf:0;gn<si-1?Ho.push(A(G(Gf))):Ho.push(0),D.push([at[gn],os,as])}}}(typeof Oe.R2L=="boolean"?Oe.R2L:ce)===!0&&(D=ou(D,function(yr,Pr,mn){return[yr.split("").reverse().join(""),Pr,mn]})),tt={text:D,x:ee,y:Ce,options:Oe,mutex:{pdfEscape:lr,activeFontKey:Ae,fonts:Qe,activeFontSize:be}},cr.publish("postProcessText",tt),D=tt.text,Fn=tt.mutex.isHex||!1;var Xf=Qe[Ae].encoding;Xf!=="WinAnsiEncoding"&&Xf!=="StandardEncoding"||(D=ou(D,function(yr,Pr,mn){return[oo(yr),Pr,mn]})),at=Bf(D),D=[];for(var qo,Go,Xo,rc=Array.isArray(at[0])?1:0,Yo="",nc=function(yr,Pr,mn){var Wn="";return mn instanceof kt?(mn=typeof Oe.angle=="number"?Kn(mn,new kt(1,0,0,1,yr,Pr)):Kn(new kt(1,0,0,1,yr,Pr),mn),_===w&&(mn=Kn(new kt(1,0,0,-1,0,0),mn)),Wn=mn.join(" ")+` Tm
`):Wn=A(yr)+" "+A(Pr)+` Td
`,Wn},js=0;js<at.length;js++){switch(Yo="",rc){case 1:Xo=(Fn?"<":"(")+at[js][0]+(Fn?">":")"),qo=parseFloat(at[js][1]),Go=parseFloat(at[js][2]);break;case 0:Xo=(Fn?"<":"(")+at[js]+(Fn?">":")"),qo=eo(ee),Go=to(Ce)}Ho!==void 0&&Ho[js]!==void 0&&(Yo=Ho[js]+` Tw
`),js===0?D.push(Yo+nc(qo,Go,Pn)+Xo):rc===0?D.push(Yo+Xo):rc===1&&D.push(Yo+nc(qo,Go,Pn)+Xo)}D=rc===0?D.join(` Tj
T* `):D.join(` Tj
`),D+=` Tj
`;var Fa=`BT
/`;return Fa+=Ae+" "+be+` Tf
`,Fa+=A(be*ao)+` TL
`,Fa+=Gl+`
`,Fa+=ii,Fa+=D,W(Fa+="ET"),d[Ae]=!0,Dr};var v1=u.__private__.clip=u.clip=function(D){return W(D==="evenodd"?"W*":"W"),this};u.clipEvenOdd=function(){return v1("evenodd")},u.__private__.discardPath=u.discardPath=function(){return W("n"),this};var Aa=u.__private__.isValidStyle=function(D){var ee=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(D)!==-1&&(ee=!0),ee};u.__private__.setDefaultPathOperation=u.setDefaultPathOperation=function(D){return Aa(D)&&(c=D),this};var r0=u.__private__.getStyle=u.getStyle=function(D){var ee=c;switch(D){case"D":case"S":ee="S";break;case"F":ee="f";break;case"FD":case"DF":ee="B";break;case"f":case"f*":case"B":case"B*":ee=D}return ee},n0=u.close=function(){return W("h"),this};u.stroke=function(){return W("S"),this},u.fill=function(D){return iu("f",D),this},u.fillEvenOdd=function(D){return iu("f*",D),this},u.fillStroke=function(D){return iu("B",D),this},u.fillStrokeEvenOdd=function(D){return iu("B*",D),this};var iu=function(D,ee){Er(ee)==="object"?w1(ee,D):W(D)},Vl=function(D){D===null||_===w&&D===void 0||(D=r0(D),W(D))};function y1(D,ee,Ce,Oe,Le){var tt=new Vu(ee||this.boundingBox,Ce||this.xStep,Oe||this.yStep,this.gState,Le||this.matrix);tt.stream=this.stream;var at=D+"$$"+this.cloneIndex+++"$$";return xi(at,tt),tt}var w1=function(D,ee){var Ce=Mt[D.key],Oe=dt[Ce];if(Oe instanceof pc)W("q"),W(_1(ee)),Oe.gState&&u.setGState(Oe.gState),W(D.matrix.toString()+" cm"),W("/"+Ce+" sh"),W("Q");else if(Oe instanceof Vu){var Le=new kt(1,0,0,-1,0,Yl());D.matrix&&(Le=Le.multiply(D.matrix||ea),Ce=y1.call(Oe,D.key,D.boundingBox,D.xStep,D.yStep,Le).id),W("q"),W("/Pattern cs"),W("/"+Ce+" scn"),Oe.gState&&u.setGState(Oe.gState),W(ee),W("Q")}},_1=function(D){switch(D){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Pf=u.moveTo=function(D,ee){return W(A(G(D))+" "+A(X(ee))+" m"),this},i0=u.lineTo=function(D,ee){return W(A(G(D))+" "+A(X(ee))+" l"),this},ra=u.curveTo=function(D,ee,Ce,Oe,Le,tt){return W([A(G(D)),A(X(ee)),A(G(Ce)),A(X(Oe)),A(G(Le)),A(X(tt)),"c"].join(" ")),this};u.__private__.line=u.line=function(D,ee,Ce,Oe,Le){if(isNaN(D)||isNaN(ee)||isNaN(Ce)||isNaN(Oe)||!Aa(Le))throw new Error("Invalid arguments passed to jsPDF.line");return _===y?this.lines([[Ce-D,Oe-ee]],D,ee,[1,1],Le||"S"):this.lines([[Ce-D,Oe-ee]],D,ee,[1,1]).stroke()},u.__private__.lines=u.lines=function(D,ee,Ce,Oe,Le,tt){var at,At,Ft,Gt,Zt,hr,Jr,Pn,Dr,Un,Fn,ii;if(typeof D=="number"&&(ii=Ce,Ce=ee,ee=D,D=ii),Oe=Oe||[1,1],tt=tt||!1,isNaN(ee)||isNaN(Ce)||!Array.isArray(D)||!Array.isArray(Oe)||!Aa(Le)||typeof tt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Pf(ee,Ce),at=Oe[0],At=Oe[1],Gt=D.length,Un=ee,Fn=Ce,Ft=0;Ft<Gt;Ft++)(Zt=D[Ft]).length===2?(Un=Zt[0]*at+Un,Fn=Zt[1]*At+Fn,i0(Un,Fn)):(hr=Zt[0]*at+Un,Jr=Zt[1]*At+Fn,Pn=Zt[2]*at+Un,Dr=Zt[3]*At+Fn,Un=Zt[4]*at+Un,Fn=Zt[5]*At+Fn,ra(hr,Jr,Pn,Dr,Un,Fn));return tt&&n0(),Vl(Le),this},u.path=function(D){for(var ee=0;ee<D.length;ee++){var Ce=D[ee],Oe=Ce.c;switch(Ce.op){case"m":Pf(Oe[0],Oe[1]);break;case"l":i0(Oe[0],Oe[1]);break;case"c":ra.apply(this,Oe);break;case"h":n0()}}return this},u.__private__.rect=u.rect=function(D,ee,Ce,Oe,Le){if(isNaN(D)||isNaN(ee)||isNaN(Ce)||isNaN(Oe)||!Aa(Le))throw new Error("Invalid arguments passed to jsPDF.rect");return _===y&&(Oe=-Oe),W([A(G(D)),A(X(ee)),A(G(Ce)),A(G(Oe)),"re"].join(" ")),Vl(Le),this},u.__private__.triangle=u.triangle=function(D,ee,Ce,Oe,Le,tt,at){if(isNaN(D)||isNaN(ee)||isNaN(Ce)||isNaN(Oe)||isNaN(Le)||isNaN(tt)||!Aa(at))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ce-D,Oe-ee],[Le-Ce,tt-Oe],[D-Le,ee-tt]],D,ee,[1,1],at,!0),this},u.__private__.roundedRect=u.roundedRect=function(D,ee,Ce,Oe,Le,tt,at){if(isNaN(D)||isNaN(ee)||isNaN(Ce)||isNaN(Oe)||isNaN(Le)||isNaN(tt)||!Aa(at))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var At=4/3*(Math.SQRT2-1);return Le=Math.min(Le,.5*Ce),tt=Math.min(tt,.5*Oe),this.lines([[Ce-2*Le,0],[Le*At,0,Le,tt-tt*At,Le,tt],[0,Oe-2*tt],[0,tt*At,-Le*At,tt,-Le,tt],[2*Le-Ce,0],[-Le*At,0,-Le,-tt*At,-Le,-tt],[0,2*tt-Oe],[0,-tt*At,Le*At,-tt,Le,-tt]],D+Le,ee,[1,1],at,!0),this},u.__private__.ellipse=u.ellipse=function(D,ee,Ce,Oe,Le){if(isNaN(D)||isNaN(ee)||isNaN(Ce)||isNaN(Oe)||!Aa(Le))throw new Error("Invalid arguments passed to jsPDF.ellipse");var tt=4/3*(Math.SQRT2-1)*Ce,at=4/3*(Math.SQRT2-1)*Oe;return Pf(D+Ce,ee),ra(D+Ce,ee-at,D+tt,ee-Oe,D,ee-Oe),ra(D-tt,ee-Oe,D-Ce,ee-at,D-Ce,ee),ra(D-Ce,ee+at,D-tt,ee+Oe,D,ee+Oe),ra(D+tt,ee+Oe,D+Ce,ee+at,D+Ce,ee),Vl(Le),this},u.__private__.circle=u.circle=function(D,ee,Ce,Oe){if(isNaN(D)||isNaN(ee)||isNaN(Ce)||!Aa(Oe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(D,ee,Ce,Ce,Oe)},u.setFont=function(D,ee,Ce){return Ce&&(ee=T(ee,Ce)),Ae=Uo(D,ee,{disableWarning:!1}),this};var b1=u.__private__.getFont=u.getFont=function(){return Qe[Uo.apply(u,arguments)]};u.__private__.getFontList=u.getFontList=function(){var D,ee,Ce={};for(D in ht)if(ht.hasOwnProperty(D))for(ee in Ce[D]=[],ht[D])ht[D].hasOwnProperty(ee)&&Ce[D].push(ee);return Ce},u.addFont=function(D,ee,Ce,Oe,Le){var tt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&tt.indexOf(arguments[3])!==-1?Le=arguments[3]:arguments[3]&&tt.indexOf(arguments[3])==-1&&(Ce=T(Ce,Oe)),Ar.call(this,D,ee,Ce,Le=Le||"Identity-H")};var ql,Ff=e.lineWidth||.200025,S1=u.__private__.getLineWidth=u.getLineWidth=function(){return Ff},Xt=u.__private__.setLineWidth=u.setLineWidth=function(D){return Ff=D,W(A(G(D))+" w"),this};u.__private__.setLineDash=Lt.API.setLineDash=Lt.API.setLineDashPattern=function(D,ee){if(D=D||[],ee=ee||0,isNaN(ee)||!Array.isArray(D))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return D=D.map(function(Ce){return A(G(Ce))}).join(" "),ee=A(G(ee)),W("["+D+"] "+ee+" d"),this};var k1=u.__private__.getLineHeight=u.getLineHeight=function(){return be*ql};u.__private__.getLineHeight=u.getLineHeight=function(){return be*ql};var C1=u.__private__.setLineHeightFactor=u.setLineHeightFactor=function(D){return typeof(D=D||1.15)=="number"&&(ql=D),this},E1=u.__private__.getLineHeightFactor=u.getLineHeightFactor=function(){return ql};C1(e.lineHeight);var eo=u.__private__.getHorizontalCoordinate=function(D){return G(D)},to=u.__private__.getVerticalCoordinate=function(D){return _===w?D:St[I].mediaBox.topRightY-St[I].mediaBox.bottomLeftY-G(D)},T1=u.__private__.getHorizontalCoordinateString=u.getHorizontalCoordinateString=function(D){return A(eo(D))},N1=u.__private__.getVerticalCoordinateString=u.getVerticalCoordinateString=function(D){return A(to(D))},su=e.strokeColor||"0 G";u.__private__.getStrokeColor=u.getDrawColor=function(){return ke(su)},u.__private__.setStrokeColor=u.setDrawColor=function(D,ee,Ce,Oe){return su=Ee({ch1:D,ch2:ee,ch3:Ce,ch4:Oe,pdfColorType:"draw",precision:2}),W(su),this};var jf=e.fillColor||"0 g";u.__private__.getFillColor=u.getFillColor=function(){return ke(jf)},u.__private__.setFillColor=u.setFillColor=function(D,ee,Ce,Oe){return jf=Ee({ch1:D,ch2:ee,ch3:Ce,ch4:Oe,pdfColorType:"fill",precision:2}),W(jf),this};var Gl=e.textColor||"0 g",A1=u.__private__.getTextColor=u.getTextColor=function(){return ke(Gl)};u.__private__.setTextColor=u.setTextColor=function(D,ee,Ce,Oe){return Gl=Ee({ch1:D,ch2:ee,ch3:Ce,ch4:Oe,pdfColorType:"text",precision:3}),this};var ro=e.charSpace,O1=u.__private__.getCharSpace=u.getCharSpace=function(){return parseFloat(ro||0)};u.__private__.setCharSpace=u.setCharSpace=function(D){if(isNaN(D))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ro=D,this};var Df=0;u.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},u.__private__.setLineCap=u.setLineCap=function(D){var ee=u.CapJoinStyles[D];if(ee===void 0)throw new Error("Line cap style of '"+D+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Df=ee,W(ee+" J"),this};var Lf=0;u.__private__.setLineJoin=u.setLineJoin=function(D){var ee=u.CapJoinStyles[D];if(ee===void 0)throw new Error("Line join style of '"+D+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Lf=ee,W(ee+" j"),this},u.__private__.setLineMiterLimit=u.__private__.setMiterLimit=u.setLineMiterLimit=u.setMiterLimit=function(D){if(D=D||0,isNaN(D))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return W(A(G(D))+" M"),this},u.GState=vg,u.setGState=function(D){(D=typeof D=="string"?bt[Et[D]]:s0(null,D)).equals(ir)||(W("/"+D.id+" gs"),ir=D)};var s0=function(D,ee){if(!D||!Et[D]){var Ce=!1;for(var Oe in bt)if(bt.hasOwnProperty(Oe)&&bt[Oe].equals(ee)){Ce=!0;break}if(Ce)ee=bt[Oe];else{var Le="GS"+(Object.keys(bt).length+1).toString(10);bt[Le]=ee,ee.id=Le}return D&&(Et[D]=ee.id),cr.publish("addGState",ee),ee}};u.addGState=function(D,ee){return s0(D,ee),this},u.saveGraphicsState=function(){return W("q"),it.push({key:Ae,size:be,color:Gl}),this},u.restoreGraphicsState=function(){W("Q");var D=it.pop();return Ae=D.key,be=D.size,Gl=D.color,ir=null,this},u.setCurrentTransformationMatrix=function(D){return W(D.toString()+" cm"),this},u.comment=function(D){return W("#"+D),this};var no=function(D,ee){var Ce=D||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ce},set:function(tt){isNaN(tt)||(Ce=parseFloat(tt))}});var Oe=ee||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Oe},set:function(tt){isNaN(tt)||(Oe=parseFloat(tt))}});var Le="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Le},set:function(tt){Le=tt.toString()}}),this},If=function(D,ee,Ce,Oe){no.call(this,D,ee),this.type="rect";var Le=Ce||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Le},set:function(at){isNaN(at)||(Le=parseFloat(at))}});var tt=Oe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return tt},set:function(at){isNaN(at)||(tt=parseFloat(at))}}),this},au=function(){this.page=Qt,this.currentPage=I,this.pages=se.slice(0),this.pagesContext=St.slice(0),this.x=Ue,this.y=Ye,this.matrix=nt,this.width=Mf(I),this.height=o0(I),this.outputDestination=le,this.id="",this.objectNumber=-1};au.prototype.restore=function(){Qt=this.page,I=this.currentPage,St=this.pagesContext,se=this.pages,Ue=this.x,Ye=this.y,nt=this.matrix,a0(I,this.width),io(I,this.height),le=this.outputDestination};var Rf=function(D,ee,Ce,Oe,Le){Li.push(new au),Qt=I=0,se=[],Ue=D,Ye=ee,nt=Le,sn([Ce,Oe])};for(var Xl in u.beginFormObject=function(D,ee,Ce,Oe,Le){return Rf(D,ee,Ce,Oe,Le),this},u.endFormObject=function(D){return function(ee){if(Gi[ee])Li.pop().restore();else{var Ce=new au,Oe="Xo"+(Object.keys(Kr).length+1).toString(10);Ce.id=Oe,Gi[ee]=Oe,Kr[Oe]=Ce,cr.publish("addFormObject",Ce),Li.pop().restore()}}(D),this},u.doFormObject=function(D,ee){var Ce=Kr[Gi[D]];return W("q"),W(ee.toString()+" cm"),W("/"+Ce.id+" Do"),W("Q"),this},u.getFormObject=function(D){var ee=Kr[Gi[D]];return{x:ee.x,y:ee.y,width:ee.width,height:ee.height,matrix:ee.matrix}},u.save=function(D,ee){return D=D||"generated.pdf",(ee=ee||{}).returnPromise=ee.returnPromise||!1,ee.returnPromise===!1?(uc(nu(Na()),D),typeof uc.unload=="function"&&qt.setTimeout&&setTimeout(uc.unload,911),this):new Promise(function(Ce,Oe){try{var Le=uc(nu(Na()),D);typeof uc.unload=="function"&&qt.setTimeout&&setTimeout(uc.unload,911),Ce(Le)}catch(tt){Oe(tt.message)}})},Lt.API)Lt.API.hasOwnProperty(Xl)&&(Xl==="events"&&Lt.API.events.length?function(D,ee){var Ce,Oe,Le;for(Le=ee.length-1;Le!==-1;Le--)Ce=ee[Le][0],Oe=ee[Le][1],D.subscribe.apply(D,[Ce].concat(typeof Oe=="function"?[Oe]:Oe))}(cr,Lt.API.events):u[Xl]=Lt.API[Xl]);function Mf(D){return St[D].mediaBox.topRightX-St[D].mediaBox.bottomLeftX}function a0(D,ee){St[D].mediaBox.topRightX=ee+St[D].mediaBox.bottomLeftX}function o0(D){return St[D].mediaBox.topRightY-St[D].mediaBox.bottomLeftY}function io(D,ee){St[D].mediaBox.topRightY=ee+St[D].mediaBox.bottomLeftY}var so=u.getPageWidth=function(D){return Mf(D=D||I)/Pe},l0=u.setPageWidth=function(D,ee){a0(D,ee*Pe)},Yl=u.getPageHeight=function(D){return o0(D=D||I)/Pe},c0=u.setPageHeight=function(D,ee){io(D,ee*Pe)};return u.internal={pdfEscape:lr,getStyle:r0,getFont:b1,getFontSize:xe,getCharSpace:O1,getTextColor:A1,getLineHeight:k1,getLineHeightFactor:E1,getLineWidth:S1,write:he,getHorizontalCoordinate:eo,getVerticalCoordinate:to,getCoordinateString:T1,getVerticalCoordinateString:N1,collections:{},newObject:qr,newAdditionalObject:Se,newObjectDeferred:Nn,newObjectDeferredBegin:ie,getFilters:We,putStream:Ke,events:cr,scaleFactor:Pe,pageSize:{getWidth:function(){return so(I)},setWidth:function(D){l0(I,D)},getHeight:function(){return Yl(I)},setHeight:function(D){c0(I,D)}},encryptionOptions:f,encryption:Bn,getEncryptor:function(D){return f!==null?Bn.encryptor(D,0):function(ee){return ee}},output:e0,getNumberOfPages:Os,get pages(){return se},out:W,f2:F,f3:L,getPageInfo:Za,getPageInfoByObjId:t0,getCurrentPageInfo:x1,getPDFVersion:m,Point:no,Rectangle:If,Matrix:kt,hasHotfix:Ps},Object.defineProperty(u.internal.pageSize,"width",{get:function(){return so(I)},set:function(D){l0(I,D)},enumerable:!0,configurable:!0}),Object.defineProperty(u.internal.pageSize,"height",{get:function(){return Yl(I)},set:function(D){c0(I,D)},enumerable:!0,configurable:!0}),(function(D){for(var ee=0,Ce=Te.length;ee<Ce;ee++){var Oe=Ar.call(this,D[ee][0],D[ee][1],D[ee][2],Te[ee][3],!0);h===!1&&(d[Oe]=!0);var Le=D[ee][0].split("-");$t({id:Oe,fontName:Le[0],fontStyle:Le[1]||""})}cr.publish("addFonts",{fonts:Qe,dictionary:ht})}).call(u,Te),Ae="F1",Ea(i,r),cr.publish("initialized"),u}Au.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Au.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Au.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Au.prototype.processOwnerPassword=function(e,t){return Ev(Cv(t).substr(0,5),e)},Au.prototype.encryptor=function(e,t){var r=Cv(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return Ev(r,n)}},vg.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Er(e)!==Er(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Lt.API={events:[]},Lt.version="4.0.0";var ln=Lt.API,Y2=1,Gc=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},wu=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Kt=function(e){return e.toFixed(2)},il=function(e){return e.toFixed(5)};ln.__acroform__={};var ss=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},i5=function(e){return e*Y2},Ia=function(e){var t=new Z3,r=Nt.internal.getHeight(e)||0,n=Nt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Kt(n)),Number(Kt(r))],t},bL=ln.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},SL=ln.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},kL=ln.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},_n=ln.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return kL(e,t-1)},bn=ln.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return bL(e,t-1)},Sn=ln.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return SL(e,t-1)},CL=ln.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,i=e[0],s=e[1],l=e[2],o=e[3],a={};return a.lowerLeft_X=r(i)||0,a.lowerLeft_Y=n(s+o)||0,a.upperRight_X=r(i+l)||0,a.upperRight_Y=n(s)||0,[Number(Kt(a.lowerLeft_X)),Number(Kt(a.lowerLeft_Y)),Number(Kt(a.upperRight_X)),Number(Kt(a.upperRight_Y))]},EL=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=Tv(e,r),i=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+i+" "+Kt(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=Ia(e);return s.scope=e.scope,s.stream=t.join(`
`),s}},Tv=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},i=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");i=e.multiline?i.map(function(F){return F.split(`
`)}):i.map(function(F){return[F]});var s=r,l=Nt.internal.getHeight(e)||0;l=l<0?-l:l;var o=Nt.internal.getWidth(e)||0;o=o<0?-o:o;var a=function(F,L,G){if(F+1<i.length){var X=L+" "+i[F+1][0];return ip(X,e,G).width<=o-4}return!1};s++;e:for(;s>0;){t="",s--;var c,f,h=ip("3",e,s).height,d=e.multiline?l-s:(l-h)/2,u=d+=2,p=0,m=0,g=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+ip(t,e,s=12).width+", FieldWidth:"+o+`
`;break}for(var x="",y=0,w=0;w<i.length;w++)if(i.hasOwnProperty(w)){var _=!1;if(i[w].length!==1&&g!==i[w].length-1){if((h+2)*(y+2)+2>l)continue e;x+=i[w][g],_=!0,m=w,w--}else{x=(x+=i[w][g]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var C=parseInt(w),E=a(C,x,s),T=w>=i.length-1;if(E&&!T){x+=" ",g=0;continue}if(E||T){if(T)m=C;else if(e.multiline&&(h+2)*(y+2)+2>l)continue e}else{if(!e.multiline||(h+2)*(y+2)+2>l)continue e;m=C}}for(var A="",j=p;j<=m;j++){var B=i[j];if(e.multiline){if(j===m){A+=B[g]+" ",g=(g+1)%B.length;continue}if(j===p){A+=B[B.length-1]+" ";continue}}A+=B[0]+" "}switch(A=A.substr(A.length-1)==" "?A.substr(0,A.length-1):A,f=ip(A,e,s).width,e.textAlign){case"right":c=o-f-2;break;case"center":c=(o-f)/2;break;default:c=2}t+=Kt(c)+" "+Kt(u)+` Td
`,t+="("+Gc(A)+`) Tj
`,t+=-Kt(c)+` 0 Td
`,u=-(s+2),f=0,p=_?m:m+1,y++,x=""}break}return n.text=t,n.fontSize=s,n},ip=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},TL={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},NL=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},AL=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(ka.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(TL)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Y2=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new eC,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var s=n[i];s.objId=void 0,s.hasAnnotation&&NL(s,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,i){var s=!n;for(var l in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(l)){var o=n[l],a=[],c=o.Rect;if(o.Rect&&(o.Rect=CL(o.Rect,i)),i.internal.newObjectDeferredBegin(o.objId,!0),o.DA=Nt.createDefaultAppearanceStream(o),Er(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(a=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var f=EL(o);a.push({key:"AP",value:"<</N "+f+">>"}),i.internal.acroformPlugin.xForms.push(f)}if(o.appearanceStreamContent){var h="";for(var d in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(d)){var u=o.appearanceStreamContent[d];if(h+="/"+d+" ",h+="<<",Object.keys(u).length>=1||Array.isArray(u)){for(var l in u)if(u.hasOwnProperty(l)){var p=u[l];typeof p=="function"&&(p=p.call(i,o)),h+="/"+l+" "+p+" ",i.internal.acroformPlugin.xForms.indexOf(p)>=0||i.internal.acroformPlugin.xForms.push(p)}}else typeof(p=u)=="function"&&(p=p.call(i,o)),h+="/"+l+" "+p,i.internal.acroformPlugin.xForms.indexOf(p)>=0||i.internal.acroformPlugin.xForms.push(p);h+=">>"}a.push({key:"AP",value:`<<
`+h+">>"})}i.internal.putStream({additionalKeyValues:a,objectId:o.objId}),i.internal.out("endobj")}s&&function(m,g){for(var x in m)if(m.hasOwnProperty(x)){var y=x,w=m[x];g.internal.newObjectDeferredBegin(w.objId,!0),Er(w)==="object"&&typeof w.putStream=="function"&&w.putStream(),delete m[y]}}(i.internal.acroformPlugin.xForms,i)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},Q3=ln.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(l){return l};if(Array.isArray(e)){for(var i="[",s=0;s<e.length;s++)switch(s!==0&&(i+=" "),Er(e[s])){case"boolean":case"number":case"object":i+=e[s].toString();break;case"string":e[s].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),i+="("+Gc(n(e[s].toString()))+")"):i+=e[s].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},qm=function(e,t,r){var n=function(i){return i};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+Gc(n(e))+")"},Va=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Va.prototype.toString=function(){return this.objId+" 0 R"},Va.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Va.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],i=this[n];i&&(Array.isArray(i)?e.push({key:n,value:Q3(i,this.objId,this.scope)}):i instanceof Va?(i.scope=this.scope,e.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&e.push({key:n,value:i}))}return e};var Z3=function(){Va.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};ss(Z3,Va);var eC=function(){Va.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Gc(r(e))+")"}},set:function(r){e=r}})};ss(eC,Va);var ka=function e(){Va.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');t=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!_n(t,3)},set:function(x){x?this.F=bn(t,3):this.F=Sn(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');r=x}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(x){n=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(x){n[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(x){n[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(x){n[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(x){n[3]=x}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof yg)return;s="FieldObject"+e.FieldNum++}var x=function(y){return y};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+Gc(x(s))+")"},set:function(x){s=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(x){s=x}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(x){l=x}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(x){o=x}});var a=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return a},set:function(x){a=x}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/Y2:c},set:function(x){c=x}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(x){f=x}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof yg||this instanceof Sc))return qm(h,this.objId,this.scope)},set:function(x){x=x.toString(),h=x}});var d=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof ei==0?qm(d,this.objId,this.scope):d},set:function(x){x=x.toString(),d=this instanceof ei==0?x.substr(0,1)==="("?wu(x.substr(1,x.length-2)):wu(x):x}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ei==1?wu(d.substr(1,d.length-1)):d},set:function(x){x=x.toString(),d=this instanceof ei==1?"/"+x:x}});var u=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(u)return u},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(u)return this instanceof ei==0?qm(u,this.objId,this.scope):u},set:function(x){x=x.toString(),u=this instanceof ei==0?x.substr(0,1)==="("?wu(x.substr(1,x.length-2)):wu(x):x}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ei==1?wu(u.substr(1,u.length-1)):u},set:function(x){x=x.toString(),u=this instanceof ei==1?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var p,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(x){x=!!x,m=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(p)return p},set:function(x){p=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,1)},set:function(x){x?this.Ff=bn(this.Ff,1):this.Ff=Sn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,2)},set:function(x){x?this.Ff=bn(this.Ff,2):this.Ff=Sn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,3)},set:function(x){x?this.Ff=bn(this.Ff,3):this.Ff=Sn(this.Ff,3)}});var g=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(g!==null)return g},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');g=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(g){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:g=2;break;case"center":case 1:g=1;break;default:g=0}}})};ss(ka,Va);var ef=function(){ka.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Q3(t,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(s,l,o){o||(o=1);for(var a,c=[];a=l.exec(s);)c.push(a[o]);return c}(n,/\((.*?)\)/g)),t=i}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,18)},set:function(r){r?this.Ff=bn(this.Ff,18):this.Ff=Sn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=bn(this.Ff,19):this.Ff=Sn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,20)},set:function(r){r?(this.Ff=bn(this.Ff,20),t.sort()):this.Ff=Sn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,22)},set:function(r){r?this.Ff=bn(this.Ff,22):this.Ff=Sn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,23)},set:function(r){r?this.Ff=bn(this.Ff,23):this.Ff=Sn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,27)},set:function(r){r?this.Ff=bn(this.Ff,27):this.Ff=Sn(this.Ff,27)}}),this.hasAppearanceStream=!1};ss(ef,ka);var tf=function(){ef.call(this),this.fontName="helvetica",this.combo=!1};ss(tf,ef);var rf=function(){tf.call(this),this.combo=!0};ss(rf,tf);var Dp=function(){rf.call(this),this.edit=!0};ss(Dp,rf);var ei=function(){ka.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,15)},set:function(r){r?this.Ff=bn(this.Ff,15):this.Ff=Sn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,16)},set:function(r){r?this.Ff=bn(this.Ff,16):this.Ff=Sn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,17)},set:function(r){r?this.Ff=bn(this.Ff,17):this.Ff=Sn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,26)},set:function(r){r?this.Ff=bn(this.Ff,26):this.Ff=Sn(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,i=[];for(n in i.push("<<"),t)i.push("/"+n+" ("+Gc(r(t[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){Er(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};ss(ei,ka);var Lp=function(){ei.call(this),this.pushButton=!0};ss(Lp,ei);var nf=function(){ei.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};ss(nf,ei);var yg=function(){var e,t;ka.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(i){t=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(o){return o};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,l=[];for(s in l.push("<<"),n)l.push("/"+s+" ("+Gc(i(n[s]))+")");return l.push(">>"),l.join(`
`)},set:function(i){Er(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Nt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ss(yg,ka),nf.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},nf.prototype.createOption=function(e){var t=new yg;return t.Parent=this,t.optionName=e,this.Kids.push(t),OL.call(this.scope,t),t};var Ip=function(){ei.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Nt.CheckBox.createAppearanceStream()};ss(Ip,ei);var Sc=function(){ka.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,13)},set:function(t){t?this.Ff=bn(this.Ff,13):this.Ff=Sn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,21)},set:function(t){t?this.Ff=bn(this.Ff,21):this.Ff=Sn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,23)},set:function(t){t?this.Ff=bn(this.Ff,23):this.Ff=Sn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,24)},set:function(t){t?this.Ff=bn(this.Ff,24):this.Ff=Sn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,25)},set:function(t){t?this.Ff=bn(this.Ff,25):this.Ff=Sn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,26)},set:function(t){t?this.Ff=bn(this.Ff,26):this.Ff=Sn(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ss(Sc,ka);var Rp=function(){Sc.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!_n(this.Ff,14)},set:function(e){e?this.Ff=bn(this.Ff,14):this.Ff=Sn(this.Ff,14)}}),this.password=!0};ss(Rp,Sc);var Nt={CheckBox:{createAppearanceStream:function(){return{N:{On:Nt.CheckBox.YesNormal},D:{On:Nt.CheckBox.YesPushDown,Off:Nt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Ia(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),s=Tv(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Kt(Nt.internal.getWidth(e))+" "+Kt(Nt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Kt(s.fontSize)+" Tf "+i),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Ia(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),i=[],s=Nt.internal.getHeight(e),l=Nt.internal.getWidth(e),o=Tv(e,e.caption);return i.push("1 g"),i.push("0 0 "+Kt(l)+" "+Kt(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Kt(l-1)+" "+Kt(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+Kt(o.fontSize)+" Tf "+n),i.push(o.text),i.push("ET"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(e){var t=Ia(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Kt(Nt.internal.getWidth(e))+" "+Kt(Nt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Nt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Nt.RadioButton.Circle.YesNormal,t.D[e]=Nt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Ia(e);t.scope=e.scope;var r=[],n=Nt.internal.getWidth(e)<=Nt.internal.getHeight(e)?Nt.internal.getWidth(e)/4:Nt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Nt.internal.Bezier_C,s=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+il(Nt.internal.getWidth(e)/2)+" "+il(Nt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Ia(e);t.scope=e.scope;var r=[],n=Nt.internal.getWidth(e)<=Nt.internal.getHeight(e)?Nt.internal.getWidth(e)/4:Nt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*Nt.internal.Bezier_C).toFixed(5)),l=Number((n*Nt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+il(Nt.internal.getWidth(e)/2)+" "+il(Nt.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),r.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),r.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),r.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+il(Nt.internal.getWidth(e)/2)+" "+il(Nt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+l+" "+l+" "+n+" 0 "+n+" c"),r.push("-"+l+" "+n+" -"+n+" "+l+" -"+n+" 0 c"),r.push("-"+n+" -"+l+" -"+l+" -"+n+" 0 -"+n+" c"),r.push(l+" -"+n+" "+n+" -"+l+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Ia(e);t.scope=e.scope;var r=[],n=Nt.internal.getWidth(e)<=Nt.internal.getHeight(e)?Nt.internal.getWidth(e)/4:Nt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*Nt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+il(Nt.internal.getWidth(e)/2)+" "+il(Nt.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),r.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),r.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),r.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Nt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Nt.RadioButton.Cross.YesNormal,t.D[e]=Nt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Ia(e);t.scope=e.scope;var r=[],n=Nt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Kt(Nt.internal.getWidth(e)-2)+" "+Kt(Nt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Kt(n.x1.x)+" "+Kt(n.x1.y)+" m"),r.push(Kt(n.x2.x)+" "+Kt(n.x2.y)+" l"),r.push(Kt(n.x4.x)+" "+Kt(n.x4.y)+" m"),r.push(Kt(n.x3.x)+" "+Kt(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Ia(e);t.scope=e.scope;var r=Nt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Kt(Nt.internal.getWidth(e))+" "+Kt(Nt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Kt(Nt.internal.getWidth(e)-2)+" "+Kt(Nt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Kt(r.x1.x)+" "+Kt(r.x1.y)+" m"),n.push(Kt(r.x2.x)+" "+Kt(r.x2.y)+" l"),n.push(Kt(r.x4.x)+" "+Kt(r.x4.y)+" m"),n.push(Kt(r.x3.x)+" "+Kt(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Ia(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Kt(Nt.internal.getWidth(e))+" "+Kt(Nt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};Nt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Nt.internal.getWidth(e),r=Nt.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},Nt.internal.getWidth=function(e){var t=0;return Er(e)==="object"&&(t=i5(e.Rect[2])),t},Nt.internal.getHeight=function(e){var t=0;return Er(e)==="object"&&(t=i5(e.Rect[3])),t};var OL=ln.addField=function(e){if(AL(this,e),!(e instanceof ka))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};ln.AcroFormChoiceField=ef,ln.AcroFormListBox=tf,ln.AcroFormComboBox=rf,ln.AcroFormEditBox=Dp,ln.AcroFormButton=ei,ln.AcroFormPushButton=Lp,ln.AcroFormRadioButton=nf,ln.AcroFormCheckBox=Ip,ln.AcroFormTextField=Sc,ln.AcroFormPasswordField=Rp,ln.AcroFormAppearance=Nt,ln.AcroForm={ChoiceField:ef,ListBox:tf,ComboBox:rf,EditBox:Dp,Button:ei,PushButton:Lp,RadioButton:nf,CheckBox:Ip,TextField:Sc,PasswordField:Rp,Appearance:Nt},Lt.AcroForm={ChoiceField:ef,ListBox:tf,ComboBox:rf,EditBox:Dp,Button:ei,PushButton:Lp,RadioButton:nf,CheckBox:Ip,TextField:Sc,PasswordField:Rp,Appearance:Nt};Lt.AcroForm;function tC(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=e.__addimage__.getImageFileTypeByImageData=function(F,L){var G,X,re,Q,ne,J=r;if((L=L||r)==="RGBA"||F.data!==void 0&&F.data instanceof Uint8ClampedArray&&"height"in F&&"width"in F)return"RGBA";if(E(F))for(ne in n)for(re=n[ne],G=0;G<re.length;G+=1){for(Q=!0,X=0;X<re[G].length;X+=1)if(re[G][X]!==void 0&&re[G][X]!==F[X]){Q=!1;break}if(Q===!0){J=ne;break}}else for(ne in n)for(re=n[ne],G=0;G<re.length;G+=1){for(Q=!0,X=0;X<re[G].length;X+=1)if(re[G][X]!==void 0&&re[G][X]!==F.charCodeAt(X)){Q=!1;break}if(Q===!0){J=ne;break}}return J===r&&L!==r&&(J=L),J},s=function F(L){for(var G=this.internal.write,X=this.internal.putStream,re=(0,this.internal.getFilters)();re.indexOf("FlateEncode")!==-1;)re.splice(re.indexOf("FlateEncode"),1);L.objectId=this.internal.newObject();var Q=[];if(Q.push({key:"Type",value:"/XObject"}),Q.push({key:"Subtype",value:"/Image"}),Q.push({key:"Width",value:L.width}),Q.push({key:"Height",value:L.height}),L.colorSpace===x.INDEXED?Q.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(L.palette.length/3-1)+" "+("sMask"in L&&L.sMask!==void 0?L.objectId+2:L.objectId+1)+" 0 R]"}):(Q.push({key:"ColorSpace",value:"/"+L.colorSpace}),L.colorSpace===x.DEVICE_CMYK&&Q.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Q.push({key:"BitsPerComponent",value:L.bitsPerComponent}),"decodeParameters"in L&&L.decodeParameters!==void 0&&Q.push({key:"DecodeParms",value:"<<"+L.decodeParameters+">>"}),"transparency"in L&&Array.isArray(L.transparency)&&L.transparency.length>0){for(var ne="",J=0,P=L.transparency.length;J<P;J++)ne+=L.transparency[J]+" "+L.transparency[J]+" ";Q.push({key:"Mask",value:"["+ne+"]"})}L.sMask!==void 0&&Q.push({key:"SMask",value:L.objectId+1+" 0 R"});var H=L.filter!==void 0?["/"+L.filter]:void 0;if(X({data:L.data,additionalKeyValues:Q,alreadyAppliedFilters:H,objectId:L.objectId}),G("endobj"),"sMask"in L&&L.sMask!==void 0){var U,S=(U=L.sMaskBitsPerComponent)!==null&&U!==void 0?U:L.bitsPerComponent,I={width:L.width,height:L.height,colorSpace:"DeviceGray",bitsPerComponent:S,data:L.sMask};"filter"in L&&(I.decodeParameters="/Predictor ".concat(L.predictor," /Colors 1 /BitsPerComponent ").concat(S," /Columns ").concat(L.width),I.filter=L.filter),F.call(this,I)}if(L.colorSpace===x.INDEXED){var O=this.internal.newObject();X({data:A(new Uint8Array(L.palette)),objectId:O}),G("endobj")}},l=function(){var F=this.internal.collections[t+"images"];for(var L in F)s.call(this,F[L])},o=function(){var F,L=this.internal.collections[t+"images"],G=this.internal.write;for(var X in L)G("/I"+(F=L[X]).index,F.objectId,"0","R")},a=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",l),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var F=this.internal.collections[t+"images"];return a.call(this),F},f=function(){return Object.keys(this.internal.collections[t+"images"]).length},h=function(F){return typeof e["process"+F.toUpperCase()]=="function"},d=function(F){return Er(F)==="object"&&F.nodeType===1},u=function(F,L){if(F.nodeName==="IMG"&&F.hasAttribute("src")){var G=""+F.getAttribute("src");if(G.indexOf("data:image/")===0)return jp(unescape(G).split("base64,").pop());var X=e.loadFile(G,!0);if(X!==void 0)return X}if(F.nodeName==="CANVAS"){if(F.width===0||F.height===0)throw new Error("Given canvas must have data. Canvas width: "+F.width+", height: "+F.height);var re;switch(L){case"PNG":re="image/png";break;case"WEBP":re="image/webp";break;default:re="image/jpeg"}return jp(F.toDataURL(re,1).split("base64,").pop())}},p=function(F){var L=this.internal.collections[t+"images"];if(L){for(var G in L)if(F===L[G].alias)return L[G]}},m=function(F,L,G){return F||L||(F=-96,L=-96),F<0&&(F=-1*G.width*72/F/this.internal.scaleFactor),L<0&&(L=-1*G.height*72/L/this.internal.scaleFactor),F===0&&(F=L*G.width/G.height),L===0&&(L=F*G.height/G.width),[F,L]},g=function(F,L,G,X,re,Q){var ne=m.call(this,G,X,re),J=this.internal.getCoordinateString,P=this.internal.getVerticalCoordinateString,H=c.call(this);if(G=ne[0],X=ne[1],H[re.index]=re,Q){Q*=Math.PI/180;var U=Math.cos(Q),S=Math.sin(Q),I=function(N){return N.toFixed(4)},O=[I(U),I(S),I(-1*S),I(U),0,0,"cm"]}this.internal.write("q"),Q?(this.internal.write([1,"0","0",1,J(F),P(L+X),"cm"].join(" ")),this.internal.write(O.join(" ")),this.internal.write([J(G),"0","0",J(X),"0","0","cm"].join(" "))):this.internal.write([J(G),"0","0",J(X),J(F),P(L+X),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+re.index+" Do"),this.internal.write("Q")},x=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(F){var L,G,X=0;if(typeof F=="string")for(G=F.length,L=0;L<G;L++)X=(X<<5)-X+F.charCodeAt(L),X|=0;else if(E(F))for(G=F.byteLength/2,L=0;L<G;L++)X=(X<<5)-X+F[L],X|=0;return X},_=e.__addimage__.validateStringAsBase64=function(F){(F=F||"").toString().trim();var L=!0;return F.length===0&&(L=!1),F.length%4!=0&&(L=!1),/^[A-Za-z0-9+/]+$/.test(F.substr(0,F.length-2))===!1&&(L=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(F.substr(-2))===!1&&(L=!1),L},C=e.__addimage__.extractImageFromDataUrl=function(F){if(F==null||!(F=F.trim()).startsWith("data:"))return null;var L=F.indexOf(",");return L<0?null:F.substring(0,L).trim().endsWith("base64")?F.substring(L+1):null};e.__addimage__.isArrayBuffer=function(F){return F instanceof ArrayBuffer};var E=e.__addimage__.isArrayBufferView=function(F){return F instanceof Int8Array||F instanceof Uint8Array||F instanceof Uint8ClampedArray||F instanceof Int16Array||F instanceof Uint16Array||F instanceof Int32Array||F instanceof Uint32Array||F instanceof Float32Array||F instanceof Float64Array},T=e.__addimage__.binaryStringToUint8Array=function(F){for(var L=F.length,G=new Uint8Array(L),X=0;X<L;X++)G[X]=F.charCodeAt(X);return G},A=e.__addimage__.arrayBufferToBinaryString=function(F){for(var L="",G=E(F)?F:new Uint8Array(F),X=0;X<G.length;X+=8192)L+=String.fromCharCode.apply(null,G.subarray(X,X+8192));return L};e.addImage=function(){var F,L,G,X,re,Q,ne,J,P;if(typeof arguments[1]=="number"?(L=r,G=arguments[1],X=arguments[2],re=arguments[3],Q=arguments[4],ne=arguments[5],J=arguments[6],P=arguments[7]):(L=arguments[1],G=arguments[2],X=arguments[3],re=arguments[4],Q=arguments[5],ne=arguments[6],J=arguments[7],P=arguments[8]),Er(F=arguments[0])==="object"&&!d(F)&&"imageData"in F){var H=F;F=H.imageData,L=H.format||L||r,G=H.x||G||0,X=H.y||X||0,re=H.w||H.width||re,Q=H.h||H.height||Q,ne=H.alias||ne,J=H.compression||J,P=H.rotation||H.angle||P}var U=this.internal.getFilters();if(J===void 0&&U.indexOf("FlateEncode")!==-1&&(J="SLOW"),isNaN(G)||isNaN(X))throw new Error("Invalid coordinates passed to jsPDF.addImage");a.call(this);var S=j.call(this,F,L,ne,J);return g.call(this,G,X,re,Q,S,P),this};var j=function(F,L,G,X){var re,Q,ne;if(typeof F=="string"&&i(F)===r){F=unescape(F);var J=B(F,!1);(J!==""||(J=e.loadFile(F,!0))!==void 0)&&(F=J)}if(d(F)&&(F=u(F,L)),L=i(F,L),!h(L))throw new Error("addImage does not support files of type '"+L+"', please ensure that a plugin for '"+L+"' support is added.");if(((ne=G)==null||ne.length===0)&&(G=function(P){return typeof P=="string"||E(P)?w(P):E(P.data)?w(P.data):null}(F)),(re=p.call(this,G))||(F instanceof Uint8Array||L==="RGBA"||(Q=F,F=T(F)),re=this["process"+L.toUpperCase()](F,f.call(this),G,function(P){return P&&typeof P=="string"&&(P=P.toUpperCase()),P in e.image_compression?P:y.NONE}(X),Q)),!re)throw new Error("An unknown error occurred whilst processing the image.");return re},B=e.__addimage__.convertBase64ToBinaryString=function(F,L){L=typeof L!="boolean"||L;var G,X="";if(typeof F=="string"){var re;G=(re=C(F))!==null&&re!==void 0?re:F;try{X=jp(G)}catch(Q){if(L)throw _(G)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Q.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return X};e.getImageProperties=function(F){var L,G,X="";if(d(F)&&(F=u(F)),typeof F=="string"&&i(F)===r&&((X=B(F,!1))===""&&(X=e.loadFile(F)||""),F=X),G=i(F),!h(G))throw new Error("addImage does not support files of type '"+G+"', please ensure that a plugin for '"+G+"' support is added.");if(F instanceof Uint8Array||(F=T(F)),!(L=this["process"+G.toUpperCase()](F)))throw new Error("An unknown error occurred whilst processing the image");return L.fileType=G,L}})(Lt.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Lt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,i,s,l=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,a=this.internal.getPageInfoByObjId(r.objId),c=r.pageContext.annotations,f=!1,h=0;h<c.length&&!f;h++)switch((n=c[h]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var d=0;d<c.length;d++){n=c[d];var u=this.internal.pdfEscape,p=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var m=this.internal.newAdditionalObject(),g=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(m.objId),y=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+l(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+l(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+u(x(n.contents))+")",s+=" /Popup "+g.objId+" 0 R",s+=" /P "+a.objId+" 0 R",s+=" /T ("+u(x(y))+") >>",m.content=s;var w=m.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+l(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+l(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(s+=" /Open true"),s+=" >>",g.content=s,this.internal.write(m.objId,"0 R",g.objId,"0 R");break;case"freetext":i="/Rect ["+l(n.bounds.x)+" "+o(n.bounds.y)+" "+l(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var _=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+u(p(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+_+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var C=this.annotations._nameMap[n.options.name];n.options.pageNumber=C.page,n.options.top=C.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+u(p(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;default:var E=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+E+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,i,s,l){var o=this.internal.getCurrentPageInfo(),a=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:a(r),y:c(n),w:a(r+i),h:c(n+s)},options:l,type:"link"})},e.textWithLink=function(r,n,i,s){var l,o,a=this.getTextWidth(r),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){o=s.maxWidth;var f=this.splitTextToSize(r,o).length;l=Math.ceil(c*f)}else o=a,l=c;return this.text(r,n,i,s),i+=.2*c,s.align==="center"&&(n-=a/2),s.align==="right"&&(n-=a),this.link(n,i-c,o,l,s),a},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Lt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(m){return t[m.charCodeAt(0)]!==void 0},l=e.__arabicParser__.isArabicLetter=function(m){return typeof m=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(m)},o=e.__arabicParser__.isArabicEndLetter=function(m){return l(m)&&s(m)&&t[m.charCodeAt(0)].length<=2},a=e.__arabicParser__.isArabicAlfLetter=function(m){return l(m)&&i.indexOf(m.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(m){return l(m)&&s(m)&&t[m.charCodeAt(0)].length>=1};var c=e.__arabicParser__.arabicLetterHasFinalForm=function(m){return l(m)&&s(m)&&t[m.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(m){return l(m)&&s(m)&&t[m.charCodeAt(0)].length>=3};var f=e.__arabicParser__.arabicLetterHasMedialForm=function(m){return l(m)&&s(m)&&t[m.charCodeAt(0)].length==4},h=e.__arabicParser__.resolveLigatures=function(m){var g=0,x=r,y="",w=0;for(g=0;g<m.length;g+=1)x[m.charCodeAt(g)]!==void 0?(w++,typeof(x=x[m.charCodeAt(g)])=="number"&&(y+=String.fromCharCode(x),x=r,w=0),g===m.length-1&&(x=r,y+=m.charAt(g-(w-1)),g-=w-1,w=0)):(x=r,y+=m.charAt(g-w),g-=w,w=0);return y};e.__arabicParser__.isArabicDiacritic=function(m){return m!==void 0&&n[m.charCodeAt(0)]!==void 0};var d=e.__arabicParser__.getCorrectForm=function(m,g,x){return l(m)?s(m)===!1?-1:!c(m)||!l(g)&&!l(x)||!l(x)&&o(g)||o(m)&&!l(g)||o(m)&&a(g)||o(m)&&o(g)?0:f(m)&&l(g)&&!o(g)&&l(x)&&c(x)?3:o(m)||!l(x)?1:2:-1},u=function(m){var g=0,x=0,y=0,w="",_="",C="",E=(m=m||"").split("\\s+"),T=[];for(g=0;g<E.length;g+=1){for(T.push(""),x=0;x<E[g].length;x+=1)w=E[g][x],_=E[g][x-1],C=E[g][x+1],l(w)?(y=d(w,_,C),T[g]+=y!==-1?String.fromCharCode(t[w.charCodeAt(0)][y]):w):T[g]+=w;T[g]=h(T[g])}return T.join(" ")},p=e.__arabicParser__.processArabic=e.processArabic=function(){var m,g=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(g)){var y=0;for(x=[],y=0;y<g.length;y+=1)Array.isArray(g[y])?x.push([u(g[y][0]),g[y][1],g[y][2]]):x.push([u(g[y])]);m=x}else m=u(g);return typeof arguments[0]=="string"?m:(arguments[0].text=m,arguments[0])};e.events.push(["preProcessText",p])}(Lt.API),Lt.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(o){s=o}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(o){l=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Lt.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var a=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return a},set:function(m){a=m}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(m){c=m}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(m){f=m}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(m){h=m}});var d=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return d},set:function(m){d=m}});var u=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return u},set:function(m){u=m}});var p=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return p},set:function(m){p=m}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(a){return n.call(this),this.internal.__cell__.headerFunction=typeof a=="function"?a:void 0,this},e.getTextDimensions=function(a,c){n.call(this);var f=(c=c||{}).fontSize||this.getFontSize(),h=c.font||this.getFont(),d=c.scaleFactor||this.internal.scaleFactor,u=0,p=0,m=0,g=this;if(!Array.isArray(a)&&typeof a!="string"){if(typeof a!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");a=String(a)}var x=c.maxWidth;x>0?typeof a=="string"?a=this.splitTextToSize(a,x):Object.prototype.toString.call(a)==="[object Array]"&&(a=a.reduce(function(w,_){return w.concat(g.splitTextToSize(_,x))},[])):a=Array.isArray(a)?a:[a];for(var y=0;y<a.length;y++)u<(m=this.getStringUnitWidth(a[y],{font:h})*f)&&(u=m);return u!==0&&(p=a.length),{w:u/=d,h:Math.max((p*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/d,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var a=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(a.left,a.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=e.cell=function(){var a;a=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var c=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,h=this.internal.__cell__.margins||t,d=this.internal.__cell__.tableHeaderRow,u=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===a.lineNumber?(a.x=(c.x||0)+(c.width||0),a.y=c.y||0):c.y+c.height+a.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),a.y=h.top,u&&d&&(this.printHeaderRow(a.lineNumber,!0),a.y+=d[0].height)):a.y=c.y+c.height||a.y),a.text[0]!==void 0&&(this.rect(a.x,a.y,a.width,a.height,r===!0?"FD":void 0),a.align==="right"?this.text(a.text,a.x+a.width-f,a.y+f,{align:"right",baseline:"top"}):a.align==="center"?this.text(a.text,a.x+a.width/2,a.y+f,{align:"center",baseline:"top",maxWidth:a.width-f-f}):this.text(a.text,a.x+f,a.y+f,{align:"left",baseline:"top",maxWidth:a.width-f-f})),this.internal.__cell__.lastCell=a,this};e.table=function(a,c,f,h,d){if(n.call(this),!f)throw new Error("No data for PDF table.");var u,p,m,g,x=[],y=[],w=[],_={},C={},E=[],T=[],A=(d=d||{}).autoSize||!1,j=d.printHeaders!==!1,B=d.css&&d.css["font-size"]!==void 0?16*d.css["font-size"]:d.fontSize||12,F=d.margins||Object.assign({width:this.getPageWidth()},t),L=typeof d.padding=="number"?d.padding:3,G=d.headerBackgroundColor||"#c8c8c8",X=d.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=j,this.internal.__cell__.margins=F,this.internal.__cell__.table_font_size=B,this.internal.__cell__.padding=L,this.internal.__cell__.headerBackgroundColor=G,this.internal.__cell__.headerTextColor=X,this.setFontSize(B),h==null)y=x=Object.keys(f[0]),w=x.map(function(){return"left"});else if(Array.isArray(h)&&Er(h[0])==="object")for(x=h.map(function(H){return H.name}),y=h.map(function(H){return H.prompt||H.name||""}),w=h.map(function(H){return H.align||"left"}),u=0;u<h.length;u+=1)C[h[u].name]=.7499990551181103*h[u].width;else Array.isArray(h)&&typeof h[0]=="string"&&(y=x=h,w=x.map(function(){return"left"}));if(A||Array.isArray(h)&&typeof h[0]=="string")for(u=0;u<x.length;u+=1){for(_[g=x[u]]=f.map(function(H){return H[g]}),this.setFont(void 0,"bold"),E.push(this.getTextDimensions(y[u],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),p=_[g],this.setFont(void 0,"normal"),m=0;m<p.length;m+=1)E.push(this.getTextDimensions(p[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);C[g]=Math.max.apply(null,E)+L+L,E=[]}if(j){var re={};for(u=0;u<x.length;u+=1)re[x[u]]={},re[x[u]].text=y[u],re[x[u]].align=w[u];var Q=o.call(this,re,C);T=x.map(function(H){return new s(a,c,C[H],Q,re[H].text,void 0,re[H].align)}),this.setTableHeaderRow(T),this.printHeaderRow(1,!1)}var ne=h.reduce(function(H,U){return H[U.name]=U.align,H},{});for(u=0;u<f.length;u+=1){"rowStart"in d&&d.rowStart instanceof Function&&d.rowStart({row:u,data:f[u]},this);var J=o.call(this,f[u],C);for(m=0;m<x.length;m+=1){var P=f[u][x[m]];"cellStart"in d&&d.cellStart instanceof Function&&d.cellStart({row:u,col:m,data:P},this),l.call(this,new s(a,c,C[x[m]],J,P,u+2,ne[x[m]]))}}return this.internal.__cell__.table_x=a,this.internal.__cell__.table_y=c,this};var o=function(a,c){var f=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,d=this.internal.scaleFactor;return Object.keys(a).map(function(u){var p=a[u];return this.splitTextToSize(p.hasOwnProperty("text")?p.text:p,c[u]-f-f)},this).map(function(u){return this.getLineHeightFactor()*u.length*h/d+f+f},this).reduce(function(u,p){return Math.max(u,p)},0)};e.setTableHeaderRow=function(a){n.call(this),this.internal.__cell__.tableHeaderRow=a},e.printHeaderRow=function(a,c){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var d=[],u=0;u<this.internal.__cell__.tableHeaderRow.length;u+=1){f=this.internal.__cell__.tableHeaderRow[u].clone(),c&&(f.y=this.internal.__cell__.margins.top||0,d.push(f)),f.lineNumber=a;var p=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,f),this.setTextColor(p)}d.length>0&&this.setTableHeaderRow(d),this.setFont(void 0,"normal"),r=!1}}(Lt.API);var rC={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},nC=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Nv=tC(nC),iC=[100,200,300,400,500,600,700,800,900],PL=tC(iC);function Gm(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return rC[s=s||"normal"]?s:"normal"}(e.style),n=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(e.weight),i=function(s){return typeof Nv[s=s||"normal"]=="number"?s:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:i,src:e.src||[],ref:e.ref||{name:t,style:[i,r,n].join(" ")}}}function s5(e,t,r,n){var i;for(i=r;i>=0&&i<t.length;i+=n)if(e[t[i]])return e[t[i]];for(i=r;i>=0&&i<t.length;i-=n)if(e[t[i]])return e[t[i]]}var FL={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},a5={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function o5(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function l5(e){return e.trimLeft()}function jL(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function DL(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var sp,c5,u5,_u,ap,f5,h5,d5,Xm=["times"];function p5(e,t,r,n,i){var s=4,l=m5;switch(i){case Lt.API.image_compression.FAST:s=1,l=g5;break;case Lt.API.image_compression.MEDIUM:s=6,l=x5;break;case Lt.API.image_compression.SLOW:s=9,l=v5}e=function(a,c,f,h){for(var d,u=a.length/c,p=new Uint8Array(a.length+u),m=[LL,g5,m5,x5,v5],g=0;g<u;g+=1){var x=g*c,y=a.subarray(x,x+c);if(h)p.set(h(y,f,d),x+g);else{for(var w=m.length,_=[],C=0;C<w;C+=1)_[C]=m[C](y,f,d);var E=RL(_.concat());p.set(_[E],x+g)}d=y}return p}(e,t,Math.ceil(r*n/8),l);var o=_v(e,{level:s});return Lt.API.__addimage__.arrayBufferToBinaryString(o)}function LL(e){var t=Array.apply([],e);return t.unshift(0),t}function g5(e,t){var r=e.length,n=[];n[0]=1;for(var i=0;i<r;i+=1){var s=e[i-t]||0;n[i+1]=e[i]-s+256&255}return n}function m5(e,t,r){var n=e.length,i=[];i[0]=2;for(var s=0;s<n;s+=1){var l=r&&r[s]||0;i[s+1]=e[s]-l+256&255}return i}function x5(e,t,r){var n=e.length,i=[];i[0]=3;for(var s=0;s<n;s+=1){var l=e[s-t]||0,o=r&&r[s]||0;i[s+1]=e[s]+256-(l+o>>>1)&255}return i}function v5(e,t,r){var n=e.length,i=[];i[0]=4;for(var s=0;s<n;s+=1){var l=IL(e[s-t]||0,r&&r[s]||0,r&&r[s-t]||0);i[s+1]=e[s]-l+256&255}return i}function IL(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),i=Math.abs(e-r),s=Math.abs(e+t-r-r);return n<=i&&n<=s?e:i<=s?t:r}function RL(e){var t=e.map(function(r){return r.reduce(function(n,i){return n+Math.abs(i)},0)});return t.indexOf(Math.min.apply(null,t))}function Ym(e,t,r){var n=t*r,i=Math.floor(n/8),s=16-(n-8*i+r),l=(1<<r)-1;return sC(e,i)>>s&l}function y5(e,t,r,n){var i=r*n,s=Math.floor(i/8),l=16-(i-8*s+n),o=(1<<n)-1,a=(t&o)<<l;(function(c,f,h){if(f+1<c.byteLength)c.setUint16(f,h,!1);else{var d=h>>8&255;c.setUint8(f,d)}})(e,s,sC(e,s)&~(o<<l)&65535|a)}function sC(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function ML(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,i=e[t++],s=i>>7,l=1<<1+(7&i);e[t++],e[t++];var o=null,a=null;s&&(o=t,a=l,t+=3*l);var c=!0,f=[],h=0,d=null,u=0,p=null;for(this.width=r,this.height=n;c&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,p=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var m=e[t++];h=e[t++]|e[t++]<<8,d=e[t++],1&m||(d=null),u=m>>2&7,t++;break;case 254:for(;;){if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var g=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,_=e[t++],C=_>>6&1,E=1<<1+(7&_),T=o,A=a,j=!1;_>>7&&(j=!0,T=t,A=E,t+=3*E);var B=t;for(t++;;){var F;if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}f.push({x:g,y:x,width:y,height:w,has_local_palette:j,palette_offset:T,palette_size:A,data_offset:B,data_length:t-B,transparent_index:d,interlaced:!!C,delay:h,disposal:u});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return p},this.frameInfo=function(L){if(L<0||L>=f.length)throw new Error("Frame index out of range.");return f[L]},this.decodeAndBlitFrameBGRA=function(L,G){var X=this.frameInfo(L),re=X.width*X.height,Q=new Uint8Array(re);w5(e,X.data_offset,Q,re);var ne=X.palette_offset,J=X.transparent_index;J===null&&(J=256);var P=X.width,H=r-P,U=P,S=4*(X.y*r+X.x),I=4*((X.y+X.height)*r+X.x),O=S,N=4*H;X.interlaced===!0&&(N+=4*r*7);for(var R=8,z=0,K=Q.length;z<K;++z){var Y=Q[z];if(U===0&&(U=P,(O+=N)>=I&&(N=4*H+4*r*(R-1),O=S+(P+H)*(R<<1),R>>=1)),Y===J)O+=4;else{var Z=e[ne+3*Y],se=e[ne+3*Y+1],V=e[ne+3*Y+2];G[O++]=V,G[O++]=se,G[O++]=Z,G[O++]=255}--U}},this.decodeAndBlitFrameRGBA=function(L,G){var X=this.frameInfo(L),re=X.width*X.height,Q=new Uint8Array(re);w5(e,X.data_offset,Q,re);var ne=X.palette_offset,J=X.transparent_index;J===null&&(J=256);var P=X.width,H=r-P,U=P,S=4*(X.y*r+X.x),I=4*((X.y+X.height)*r+X.x),O=S,N=4*H;X.interlaced===!0&&(N+=4*r*7);for(var R=8,z=0,K=Q.length;z<K;++z){var Y=Q[z];if(U===0&&(U=P,(O+=N)>=I&&(N=4*H+4*r*(R-1),O=S+(P+H)*(R<<1),R>>=1)),Y===J)O+=4;else{var Z=e[ne+3*Y],se=e[ne+3*Y+1],V=e[ne+3*Y+2];G[O++]=Z,G[O++]=se,G[O++]=V,G[O++]=255}--U}}}function w5(e,t,r,n){for(var i=e[t++],s=1<<i,l=s+1,o=l+1,a=i+1,c=(1<<a)-1,f=0,h=0,d=0,u=e[t++],p=new Int32Array(4096),m=null;;){for(;f<16&&u!==0;)h|=e[t++]<<f,f+=8,u===1?u=e[t++]:--u;if(f<a)break;var g=h&c;if(h>>=a,f-=a,g!==s){if(g===l)break;for(var x=g<o?g:m,y=0,w=x;w>s;)w=p[w]>>8,++y;var _=w;if(d+y+(x!==g?1:0)>n)return void jr.log("Warning, gif stream longer than expected.");r[d++]=_;var C=d+=y;for(x!==g&&(r[d++]=_),w=x;y--;)w=p[w],r[--C]=255&w,w>>=8;m!==null&&o<4096&&(p[o++]=m<<8|_,o>=c+1&&a<12&&(++a,c=c<<1|1)),m=g}else o=l+1,c=(1<<(a=i+1))-1,m=null}return d!==n&&jr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Km(e){var t,r,n,i,s,l=Math.floor,o=new Array(64),a=new Array(64),c=new Array(64),f=new Array(64),h=new Array(65535),d=new Array(65535),u=new Array(64),p=new Array(64),m=[],g=0,x=7,y=new Array(64),w=new Array(64),_=new Array(64),C=new Array(256),E=new Array(2048),T=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],A=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],j=[0,1,2,3,4,5,6,7,8,9,10,11],B=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],F=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],L=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],G=[0,1,2,3,4,5,6,7,8,9,10,11],X=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],re=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Q(S,I){for(var O=0,N=0,R=new Array,z=1;z<=16;z++){for(var K=1;K<=S[z];K++)R[I[N]]=[],R[I[N]][0]=O,R[I[N]][1]=z,N++,O++;O*=2}return R}function ne(S){for(var I=S[0],O=S[1]-1;O>=0;)I&1<<O&&(g|=1<<x),O--,--x<0&&(g==255?(J(255),J(0)):J(g),x=7,g=0)}function J(S){m.push(S)}function P(S){J(S>>8&255),J(255&S)}function H(S,I,O,N,R){for(var z,K=R[0],Y=R[240],Z=function(be,pe){var xe,ce,Ne,Ie,Re,De,Me,Ge,Ae,Pe,Ue=0;for(Ae=0;Ae<8;++Ae){xe=be[Ue],ce=be[Ue+1],Ne=be[Ue+2],Ie=be[Ue+3],Re=be[Ue+4],De=be[Ue+5],Me=be[Ue+6];var Ye=xe+(Ge=be[Ue+7]),nt=xe-Ge,Qe=ce+Me,ht=ce-Me,it=Ne+De,dt=Ne-De,Mt=Ie+Re,bt=Ie-Re,Et=Ye+Mt,ir=Ye-Mt,Qt=Qe+it,St=Qe-it;be[Ue]=Et+Qt,be[Ue+4]=Et-Qt;var cr=.707106781*(St+ir);be[Ue+2]=ir+cr,be[Ue+6]=ir-cr;var Zs=.382683433*((Et=bt+dt)-(St=ht+nt)),Kr=.5411961*Et+Zs,Gi=1.306562965*St+Zs,Li=.707106781*(Qt=dt+ht),kt=nt+Li,Kn=nt-Li;be[Ue+5]=Kn+Kr,be[Ue+3]=Kn-Kr,be[Ue+1]=kt+Gi,be[Ue+7]=kt-Gi,Ue+=8}for(Ue=0,Ae=0;Ae<8;++Ae){xe=be[Ue],ce=be[Ue+8],Ne=be[Ue+16],Ie=be[Ue+24],Re=be[Ue+32],De=be[Ue+40],Me=be[Ue+48];var ea=xe+(Ge=be[Ue+56]),xi=xe-Ge,Xi=ce+Me,qr=ce-Me,Nn=Ne+De,ie=Ne-De,Se=Ie+Re,ge=Ie-Re,ve=ea+Se,ke=ea-Se,Ee=Xi+Nn,We=Xi-Nn;be[Ue]=ve+Ee,be[Ue+32]=ve-Ee;var Ke=.707106781*(We+ke);be[Ue+16]=ke+Ke,be[Ue+48]=ke-Ke;var ze=.382683433*((ve=ge+ie)-(We=qr+xi)),He=.5411961*ve+ze,qe=1.306562965*We+ze,lt=.707106781*(Ee=ie+qr),mt=xi+lt,_t=xi-lt;be[Ue+40]=_t+He,be[Ue+24]=_t-He,be[Ue+8]=mt+qe,be[Ue+56]=mt-qe,Ue++}for(Ae=0;Ae<64;++Ae)Pe=be[Ae]*pe[Ae],u[Ae]=Pe>0?Pe+.5|0:Pe-.5|0;return u}(S,I),se=0;se<64;++se)p[T[se]]=Z[se];var V=p[0]-O;O=p[0],V==0?ne(N[0]):(ne(N[d[z=32767+V]]),ne(h[z]));for(var le=63;le>0&&p[le]==0;)le--;if(le==0)return ne(K),O;for(var ae,W=1;W<=le;){for(var he=W;p[W]==0&&W<=le;)++W;var fe=W-he;if(fe>=16){ae=fe>>4;for(var Te=1;Te<=ae;++Te)ne(Y);fe&=15}z=32767+p[W],ne(R[(fe<<4)+d[z]]),ne(h[z]),W++}return le!=63&&ne(K),O}function U(S){S=Math.min(Math.max(S,1),100),s!=S&&(function(I){for(var O=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],N=0;N<64;N++){var R=l((O[N]*I+50)/100);R=Math.min(Math.max(R,1),255),o[T[N]]=R}for(var z=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],K=0;K<64;K++){var Y=l((z[K]*I+50)/100);Y=Math.min(Math.max(Y,1),255),a[T[K]]=Y}for(var Z=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],se=0,V=0;V<8;V++)for(var le=0;le<8;le++)c[se]=1/(o[T[se]]*Z[V]*Z[le]*8),f[se]=1/(a[T[se]]*Z[V]*Z[le]*8),se++}(S<50?Math.floor(5e3/S):Math.floor(200-2*S)),s=S)}this.encode=function(S,I){I&&U(I),m=new Array,g=0,x=7,P(65496),P(65504),P(16),J(74),J(70),J(73),J(70),J(0),J(1),J(1),J(0),P(1),P(1),J(0),J(0),function(){P(65499),P(132),J(0);for(var ce=0;ce<64;ce++)J(o[ce]);J(1);for(var Ne=0;Ne<64;Ne++)J(a[Ne])}(),function(ce,Ne){P(65472),P(17),J(8),P(Ne),P(ce),J(3),J(1),J(17),J(0),J(2),J(17),J(1),J(3),J(17),J(1)}(S.width,S.height),function(){P(65476),P(418),J(0);for(var ce=0;ce<16;ce++)J(A[ce+1]);for(var Ne=0;Ne<=11;Ne++)J(j[Ne]);J(16);for(var Ie=0;Ie<16;Ie++)J(B[Ie+1]);for(var Re=0;Re<=161;Re++)J(F[Re]);J(1);for(var De=0;De<16;De++)J(L[De+1]);for(var Me=0;Me<=11;Me++)J(G[Me]);J(17);for(var Ge=0;Ge<16;Ge++)J(X[Ge+1]);for(var Ae=0;Ae<=161;Ae++)J(re[Ae])}(),P(65498),P(12),J(3),J(1),J(0),J(2),J(17),J(3),J(17),J(0),J(63),J(0);var O=0,N=0,R=0;g=0,x=7,this.encode.displayName="_encode_";for(var z,K,Y,Z,se,V,le,ae,W,he=S.data,fe=S.width,Te=S.height,be=4*fe,pe=0;pe<Te;){for(z=0;z<be;){for(se=be*pe+z,le=-1,ae=0,W=0;W<64;W++)V=se+(ae=W>>3)*be+(le=4*(7&W)),pe+ae>=Te&&(V-=be*(pe+1+ae-Te)),z+le>=be&&(V-=z+le-be+4),K=he[V++],Y=he[V++],Z=he[V++],y[W]=(E[K]+E[Y+256|0]+E[Z+512|0]>>16)-128,w[W]=(E[K+768|0]+E[Y+1024|0]+E[Z+1280|0]>>16)-128,_[W]=(E[K+1280|0]+E[Y+1536|0]+E[Z+1792|0]>>16)-128;O=H(y,c,O,t,n),N=H(w,f,N,r,i),R=H(_,f,R,r,i),z+=32}pe+=8}if(x>=0){var xe=[];xe[1]=x+1,xe[0]=(1<<x+1)-1,ne(xe)}return P(65497),new Uint8Array(m)},e=e||50,function(){for(var S=String.fromCharCode,I=0;I<256;I++)C[I]=S(I)}(),t=Q(A,j),r=Q(L,G),n=Q(B,F),i=Q(X,re),function(){for(var S=1,I=2,O=1;O<=15;O++){for(var N=S;N<I;N++)d[32767+N]=O,h[32767+N]=[],h[32767+N][1]=O,h[32767+N][0]=N;for(var R=-(I-1);R<=-S;R++)d[32767+R]=O,h[32767+R]=[],h[32767+R][1]=O,h[32767+R][0]=I-1+R;S<<=1,I<<=1}}(),function(){for(var S=0;S<256;S++)E[S]=19595*S,E[S+256|0]=38470*S,E[S+512|0]=7471*S+32768,E[S+768|0]=-11059*S,E[S+1024|0]=-21709*S,E[S+1280|0]=32768*S+8421375,E[S+1536|0]=-27439*S,E[S+1792|0]=-5329*S}(),U(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function la(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function _5(e){function t(j){if(!j)throw Error("assert :P")}function r(j,B,F){for(var L=0;4>L;L++)if(j[B+L]!=F.charCodeAt(L))return!0;return!1}function n(j,B,F,L,G){for(var X=0;X<G;X++)j[B+X]=F[L+X]}function i(j,B,F,L){for(var G=0;G<L;G++)j[B+G]=F}function s(j){return new Int32Array(j)}function l(j,B){for(var F=[],L=0;L<j;L++)F.push(new B);return F}function o(j,B){var F=[];return function L(G,X,re){for(var Q=re[X],ne=0;ne<Q&&(G.push(re.length>X+1?[]:new B),!(re.length<X+1));ne++)L(G[ne],X+1,re)}(F,0,j),F}var a=function(){var j=this;function B(b,k){for(var M=1<<k-1>>>0;b&M;)M>>>=1;return M?(b&M-1)+M:b}function F(b,k,M,q,te){t(!(q%M));do b[k+(q-=M)]=te;while(0<q)}function L(b,k,M,q,te){if(t(2328>=te),512>=te)var oe=s(512);else if((oe=s(te))==null)return 0;return function(ue,de,me,we,Fe,Ve){var _e,je,Be=de,Ze=1<<me,$e=s(16),et=s(16);for(t(Fe!=0),t(we!=null),t(ue!=null),t(0<me),je=0;je<Fe;++je){if(15<we[je])return 0;++$e[we[je]]}if($e[0]==Fe)return 0;for(et[1]=0,_e=1;15>_e;++_e){if($e[_e]>1<<_e)return 0;et[_e+1]=et[_e]+$e[_e]}for(je=0;je<Fe;++je)_e=we[je],0<we[je]&&(Ve[et[_e]++]=je);if(et[15]==1)return(we=new G).g=0,we.value=Ve[0],F(ue,Be,1,Ze,we),Ze;var rt,ut=-1,ot=Ze-1,Dt=0,Tt=1,tr=1,Ot=1<<me;for(je=0,_e=1,Fe=2;_e<=me;++_e,Fe<<=1){if(Tt+=tr<<=1,0>(tr-=$e[_e]))return 0;for(;0<$e[_e];--$e[_e])(we=new G).g=_e,we.value=Ve[je++],F(ue,Be+Dt,Fe,Ot,we),Dt=B(Dt,_e)}for(_e=me+1,Fe=2;15>=_e;++_e,Fe<<=1){if(Tt+=tr<<=1,0>(tr-=$e[_e]))return 0;for(;0<$e[_e];--$e[_e]){if(we=new G,(Dt&ot)!=ut){for(Be+=Ot,rt=1<<(ut=_e)-me;15>ut&&!(0>=(rt-=$e[ut]));)++ut,rt<<=1;Ze+=Ot=1<<(rt=ut-me),ue[de+(ut=Dt&ot)].g=rt+me,ue[de+ut].value=Be-de-ut}we.g=_e-me,we.value=Ve[je++],F(ue,Be+(Dt>>me),Fe,Ot,we),Dt=B(Dt,_e)}}return Tt!=2*et[15]-1?0:Ze}(b,k,M,q,te,oe)}function G(){this.value=this.g=0}function X(){this.value=this.g=0}function re(){this.G=l(5,G),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(tc,X)}function Q(b,k,M,q){t(b!=null),t(k!=null),t(2147483648>q),b.Ca=254,b.I=0,b.b=-8,b.Ka=0,b.oa=k,b.pa=M,b.Jd=k,b.Yc=M+q,b.Zc=4<=q?M+q-4+1:M,K(b)}function ne(b,k){for(var M=0;0<k--;)M|=Z(b,128)<<k;return M}function J(b,k){var M=ne(b,k);return Y(b)?-M:M}function P(b,k,M,q){var te,oe=0;for(t(b!=null),t(k!=null),t(4294967288>q),b.Sb=q,b.Ra=0,b.u=0,b.h=0,4<q&&(q=4),te=0;te<q;++te)oe+=k[M+te]<<8*te;b.Ra=oe,b.bb=q,b.oa=k,b.pa=M}function H(b){for(;8<=b.u&&b.bb<b.Sb;)b.Ra>>>=8,b.Ra+=b.oa[b.pa+b.bb]<<$o-8>>>0,++b.bb,b.u-=8;N(b)&&(b.h=1,b.u=0)}function U(b,k){if(t(0<=k),!b.h&&k<=os){var M=O(b)&as[k];return b.u+=k,H(b),M}return b.h=1,b.u=0}function S(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function I(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function O(b){return b.Ra>>>(b.u&$o-1)>>>0}function N(b){return t(b.bb<=b.Sb),b.h||b.bb==b.Sb&&b.u>$o}function R(b,k){b.u=k,b.h=N(b)}function z(b){b.u>=co&&(t(b.u>=co),H(b))}function K(b){t(b!=null&&b.oa!=null),b.pa<b.Zc?(b.I=(b.oa[b.pa++]|b.I<<8)>>>0,b.b+=8):(t(b!=null&&b.oa!=null),b.pa<b.Yc?(b.b+=8,b.I=b.oa[b.pa++]|b.I<<8):b.Ka?b.b=0:(b.I<<=8,b.b+=8,b.Ka=1))}function Y(b){return ne(b,1)}function Z(b,k){var M=b.Ca;0>b.b&&K(b);var q=b.b,te=M*k>>>8,oe=(b.I>>>q>te)+0;for(oe?(M-=te,b.I-=te+1<<q>>>0):M=te+1,q=M,te=0;256<=q;)te+=8,q>>=8;return q=7^te+Vo[q],b.b-=q,b.Ca=(M<<q)-1,oe}function se(b,k,M){b[k+0]=M>>24&255,b[k+1]=M>>16&255,b[k+2]=M>>8&255,b[k+3]=255&M}function V(b,k){return b[k+0]|b[k+1]<<8}function le(b,k){return V(b,k)|b[k+2]<<16}function ae(b,k){return V(b,k)|V(b,k+2)<<16}function W(b,k){var M=1<<k;return t(b!=null),t(0<k),b.X=s(M),b.X==null?0:(b.Mb=32-k,b.Xa=k,1)}function he(b,k){t(b!=null),t(k!=null),t(b.Xa==k.Xa),n(k.X,0,b.X,0,1<<k.Xa)}function fe(){this.X=[],this.Xa=this.Mb=0}function Te(b,k,M,q){t(M!=null),t(q!=null);var te=M[0],oe=q[0];return te==0&&(te=(b*oe+k/2)/k),oe==0&&(oe=(k*te+b/2)/b),0>=te||0>=oe?0:(M[0]=te,q[0]=oe,1)}function be(b,k){return b+(1<<k)-1>>>k}function pe(b,k){return((4278255360&b)+(4278255360&k)>>>0&4278255360)+((16711935&b)+(16711935&k)>>>0&16711935)>>>0}function xe(b,k){j[k]=function(M,q,te,oe,ue,de,me){var we;for(we=0;we<ue;++we){var Fe=j[b](de[me+we-1],te,oe+we);de[me+we]=pe(M[q+we],Fe)}}}function ce(){this.ud=this.hd=this.jd=0}function Ne(b,k){return((4278124286&(b^k))>>>1)+(b&k)>>>0}function Ie(b){return 0<=b&&256>b?b:0>b?0:255<b?255:void 0}function Re(b,k){return Ie(b+(b-k+.5>>1))}function De(b,k,M){return Math.abs(k-M)-Math.abs(b-M)}function Me(b,k,M,q,te,oe,ue){for(q=oe[ue-1],M=0;M<te;++M)oe[ue+M]=q=pe(b[k+M],q)}function Ge(b,k,M,q,te){var oe;for(oe=0;oe<M;++oe){var ue=b[k+oe],de=ue>>8&255,me=16711935&(me=(me=16711935&ue)+((de<<16)+de));q[te+oe]=(4278255360&ue)+me>>>0}}function Ae(b,k){k.jd=255&b,k.hd=b>>8&255,k.ud=b>>16&255}function Pe(b,k,M,q,te,oe){var ue;for(ue=0;ue<q;++ue){var de=k[M+ue],me=de>>>8,we=de,Fe=255&(Fe=(Fe=de>>>16)+((b.jd<<24>>24)*(me<<24>>24)>>>5));we=255&(we=(we+=(b.hd<<24>>24)*(me<<24>>24)>>>5)+((b.ud<<24>>24)*(Fe<<24>>24)>>>5)),te[oe+ue]=(4278255360&de)+(Fe<<16)+we}}function Ue(b,k,M,q,te){j[k]=function(oe,ue,de,me,we,Fe,Ve,_e,je){for(me=Ve;me<_e;++me)for(Ve=0;Ve<je;++Ve)we[Fe++]=te(de[q(oe[ue++])])},j[b]=function(oe,ue,de,me,we,Fe,Ve){var _e=8>>oe.b,je=oe.Ea,Be=oe.K[0],Ze=oe.w;if(8>_e)for(oe=(1<<oe.b)-1,Ze=(1<<_e)-1;ue<de;++ue){var $e,et=0;for($e=0;$e<je;++$e)$e&oe||(et=q(me[we++])),Fe[Ve++]=te(Be[et&Ze]),et>>=_e}else j["VP8LMapColor"+M](me,we,Be,Ze,Fe,Ve,ue,de,je)}}function Ye(b,k,M,q,te){for(M=k+M;k<M;){var oe=b[k++];q[te++]=oe>>16&255,q[te++]=oe>>8&255,q[te++]=255&oe}}function nt(b,k,M,q,te){for(M=k+M;k<M;){var oe=b[k++];q[te++]=oe>>16&255,q[te++]=oe>>8&255,q[te++]=255&oe,q[te++]=oe>>24&255}}function Qe(b,k,M,q,te){for(M=k+M;k<M;){var oe=(ue=b[k++])>>16&240|ue>>12&15,ue=240&ue|ue>>28&15;q[te++]=oe,q[te++]=ue}}function ht(b,k,M,q,te){for(M=k+M;k<M;){var oe=(ue=b[k++])>>16&248|ue>>13&7,ue=ue>>5&224|ue>>3&31;q[te++]=oe,q[te++]=ue}}function it(b,k,M,q,te){for(M=k+M;k<M;){var oe=b[k++];q[te++]=255&oe,q[te++]=oe>>8&255,q[te++]=oe>>16&255}}function dt(b,k,M,q,te,oe){if(oe==0)for(M=k+M;k<M;)se(q,((oe=b[k++])[0]>>24|oe[1]>>8&65280|oe[2]<<8&16711680|oe[3]<<24)>>>0),te+=32;else n(q,te,b,k,M)}function Mt(b,k){j[k][0]=j[b+"0"],j[k][1]=j[b+"1"],j[k][2]=j[b+"2"],j[k][3]=j[b+"3"],j[k][4]=j[b+"4"],j[k][5]=j[b+"5"],j[k][6]=j[b+"6"],j[k][7]=j[b+"7"],j[k][8]=j[b+"8"],j[k][9]=j[b+"9"],j[k][10]=j[b+"10"],j[k][11]=j[b+"11"],j[k][12]=j[b+"12"],j[k][13]=j[b+"13"],j[k][14]=j[b+"0"],j[k][15]=j[b+"0"]}function bt(b){return b==j1||b==D1||b==v0||b==L1}function Et(){this.eb=[],this.size=this.A=this.fb=0}function ir(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Qt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Et,this.f.kb=new ir,this.sd=null}function St(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function cr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Zs(b){return alert("todo:WebPSamplerProcessPlane"),b.T}function Kr(b,k){var M=b.T,q=k.ba.f.RGBA,te=q.eb,oe=q.fb+b.ka*q.A,ue=Ls[k.ba.S],de=b.y,me=b.O,we=b.f,Fe=b.N,Ve=b.ea,_e=b.W,je=k.cc,Be=k.dc,Ze=k.Mc,$e=k.Nc,et=b.ka,rt=b.ka+b.T,ut=b.U,ot=ut+1>>1;for(et==0?ue(de,me,null,null,we,Fe,Ve,_e,we,Fe,Ve,_e,te,oe,null,null,ut):(ue(k.ec,k.fc,de,me,je,Be,Ze,$e,we,Fe,Ve,_e,te,oe-q.A,te,oe,ut),++M);et+2<rt;et+=2)je=we,Be=Fe,Ze=Ve,$e=_e,Fe+=b.Rc,_e+=b.Rc,oe+=2*q.A,ue(de,(me+=2*b.fa)-b.fa,de,me,je,Be,Ze,$e,we,Fe,Ve,_e,te,oe-q.A,te,oe,ut);return me+=b.fa,b.j+rt<b.o?(n(k.ec,k.fc,de,me,ut),n(k.cc,k.dc,we,Fe,ot),n(k.Mc,k.Nc,Ve,_e,ot),M--):1&rt||ue(de,me,null,null,we,Fe,Ve,_e,we,Fe,Ve,_e,te,oe+q.A,null,null,ut),M}function Gi(b,k,M){var q=b.F,te=[b.J];if(q!=null){var oe=b.U,ue=k.ba.S,de=ue==x0||ue==v0;k=k.ba.f.RGBA;var me=[0],we=b.ka;me[0]=b.T,b.Kb&&(we==0?--me[0]:(--we,te[0]-=b.width),b.j+b.ka+b.T==b.o&&(me[0]=b.o-b.j-we));var Fe=k.eb;we=k.fb+we*k.A,b=Yy(q,te[0],b.width,oe,me,Fe,we+(de?0:3),k.A),t(M==me),b&&bt(ue)&&Kf(Fe,we,de,oe,me,k.A)}return 0}function Li(b){var k=b.ma,M=k.ba.S,q=11>M,te=M==g0||M==m0||M==x0||M==F1||M==12||bt(M);if(k.memory=null,k.Ib=null,k.Jb=null,k.Nd=null,!zf(k.Oa,b,te?11:12))return 0;if(te&&bt(M)&&Bf(),b.da)alert("todo:use_scaling");else{if(q){if(k.Ib=Zs,b.Kb){if(M=b.U+1>>1,k.memory=s(b.U+2*M),k.memory==null)return 0;k.ec=k.memory,k.fc=0,k.cc=k.ec,k.dc=k.fc+b.U,k.Mc=k.cc,k.Nc=k.dc+M,k.Ib=Kr,Bf()}}else alert("todo:EmitYUV");te&&(k.Jb=Gi,q&&na())}if(q&&!fw){for(b=0;256>b;++b)tN[b]=89858*(b-128)+w0>>y0,iN[b]=-22014*(b-128)+w0,nN[b]=-45773*(b-128),rN[b]=113618*(b-128)+w0>>y0;for(b=Qf;b<M1;++b)k=76283*(b-16)+w0>>y0,sN[b-Qf]=An(k,255),aN[b-Qf]=An(k+8>>4,15);fw=1}return 1}function kt(b){var k=b.ma,M=b.U,q=b.T;return t(!(1&b.ka)),0>=M||0>=q?0:(M=k.Ib(b,k),k.Jb!=null&&k.Jb(b,k,M),k.Dc+=M,1)}function Kn(b){b.ma.memory=null}function ea(b,k,M,q){return U(b,8)!=47?0:(k[0]=U(b,14)+1,M[0]=U(b,14)+1,q[0]=U(b,1),U(b,3)!=0?0:!b.h)}function xi(b,k){if(4>b)return b+1;var M=b-2>>1;return(2+(1&b)<<M)+U(k,M)+1}function Xi(b,k){return 120<k?k-120:1<=(M=((M=WT[k-1])>>4)*b+(8-(15&M)))?M:1;var M}function qr(b,k,M){var q=O(M),te=b[k+=255&q].g-8;return 0<te&&(R(M,M.u+8),q=O(M),k+=b[k].value,k+=q&(1<<te)-1),R(M,M.u+b[k].g),b[k].value}function Nn(b,k,M){return M.g+=b.g,M.value+=b.value<<k>>>0,t(8>=M.g),b.g}function ie(b,k,M){var q=b.xc;return t((k=q==0?0:b.vc[b.md*(M>>q)+(k>>q)])<b.Wb),b.Ya[k]}function Se(b,k,M,q){var te=b.ab,oe=b.c*k,ue=b.C;k=ue+k;var de=M,me=q;for(q=b.Ta,M=b.Ua;0<te--;){var we=b.gc[te],Fe=ue,Ve=k,_e=de,je=me,Be=(me=q,de=M,we.Ea);switch(t(Fe<Ve),t(Ve<=we.nc),we.hc){case 2:gn(_e,je,(Ve-Fe)*Be,me,de);break;case 0:var Ze=Fe,$e=Ve,et=me,rt=de,ut=(Ot=we).Ea;Ze==0&&($f(_e,je,null,null,1,et,rt),Me(_e,je+1,0,0,ut-1,et,rt+1),je+=ut,rt+=ut,++Ze);for(var ot=1<<Ot.b,Dt=ot-1,Tt=be(ut,Ot.b),tr=Ot.K,Ot=Ot.w+(Ze>>Ot.b)*Tt;Ze<$e;){var ur=tr,zn=Ot,rr=1;for(cu(_e,je,et,rt-ut,1,et,rt);rr<ut;){var Pt=(rr&~Dt)+ot;Pt>ut&&(Pt=ut),(0,qf[ur[zn++]>>8&15])(_e,je+ +rr,et,rt+rr-ut,Pt-rr,et,rt+rr),rr=Pt}je+=ut,rt+=ut,++Ze&Dt||(Ot+=Tt)}Ve!=we.nc&&n(me,de-Be,me,de+(Ve-Fe-1)*Be,Be);break;case 1:for(Be=_e,$e=je,ut=(_e=we.Ea)-(rt=_e&~(et=(je=1<<we.b)-1)),Ze=be(_e,we.b),ot=we.K,we=we.w+(Fe>>we.b)*Ze;Fe<Ve;){for(Dt=ot,Tt=we,tr=new ce,Ot=$e+rt,ur=$e+_e;$e<Ot;)Ae(Dt[Tt++],tr),Gf(tr,Be,$e,je,me,de),$e+=je,de+=je;$e<ur&&(Ae(Dt[Tt++],tr),Gf(tr,Be,$e,ut,me,de),$e+=ut,de+=ut),++Fe&et||(we+=Ze)}break;case 3:if(_e==me&&je==de&&0<we.b){for($e=me,_e=Be=de+(Ve-Fe)*Be-(rt=(Ve-Fe)*be(we.Ea,we.b)),je=me,et=de,Ze=[],rt=(ut=rt)-1;0<=rt;--rt)Ze[rt]=je[et+rt];for(rt=ut-1;0<=rt;--rt)$e[_e+rt]=Ze[rt];f0(we,Fe,Ve,me,Be,me,de)}else f0(we,Fe,Ve,_e,je,me,de)}de=q,me=M}me!=M&&n(q,M,de,me,oe)}function ge(b,k){var M=b.V,q=b.Ba+b.c*b.C,te=k-b.C;if(t(k<=b.l.o),t(16>=te),0<te){var oe=b.l,ue=b.Ta,de=b.Ua,me=oe.width;if(Se(b,te,M,q),te=de=[de],t((M=b.C)<(q=k)),t(oe.v<oe.va),q>oe.o&&(q=oe.o),M<oe.j){var we=oe.j-M;M=oe.j,te[0]+=we*me}if(M>=q?M=0:(te[0]+=4*oe.v,oe.ka=M-oe.j,oe.U=oe.va-oe.v,oe.T=q-M,M=1),M){if(de=de[0],11>(M=b.ca).S){var Fe=M.f.RGBA,Ve=(q=M.S,te=oe.U,oe=oe.T,we=Fe.eb,Fe.A),_e=oe;for(Fe=Fe.fb+b.Ma*Fe.A;0<_e--;){var je=ue,Be=de,Ze=te,$e=we,et=Fe;switch(q){case p0:Xf(je,Be,Ze,$e,et);break;case g0:qo(je,Be,Ze,$e,et);break;case j1:qo(je,Be,Ze,$e,et),Kf($e,et,0,Ze,1,0);break;case rw:rc(je,Be,Ze,$e,et);break;case m0:dt(je,Be,Ze,$e,et,1);break;case D1:dt(je,Be,Ze,$e,et,1),Kf($e,et,0,Ze,1,0);break;case x0:dt(je,Be,Ze,$e,et,0);break;case v0:dt(je,Be,Ze,$e,et,0),Kf($e,et,1,Ze,1,0);break;case F1:Go(je,Be,Ze,$e,et);break;case L1:Go(je,Be,Ze,$e,et),Xy($e,et,Ze,1,0);break;case nw:Xo(je,Be,Ze,$e,et);break;default:t(0)}de+=me,Fe+=Ve}b.Ma+=oe}else alert("todo:EmitRescaledRowsYUVA");t(b.Ma<=M.height)}}b.C=k,t(b.C<=b.i)}function ve(b){var k;if(0<b.ua)return 0;for(k=0;k<b.Wb;++k){var M=b.Ya[k].G,q=b.Ya[k].H;if(0<M[1][q[1]+0].g||0<M[2][q[2]+0].g||0<M[3][q[3]+0].g)return 0}return 1}function ke(b,k,M,q,te,oe){if(b.Z!=0){var ue=b.qd,de=b.rd;for(t(Jo[b.Z]!=null);k<M;++k)Jo[b.Z](ue,de,q,te,q,te,oe),ue=q,de=te,te+=oe;b.qd=ue,b.rd=de}}function Ee(b,k){var M=b.l.ma,q=M.Z==0||M.Z==1?b.l.j:b.C;if(q=b.C<q?q:b.C,t(k<=b.l.o),k>q){var te=b.l.width,oe=M.ca,ue=M.tb+te*q,de=b.V,me=b.Ba+b.c*q,we=b.gc;t(b.ab==1),t(we[0].hc==3),Pa(we[0],q,k,de,me,oe,ue),ke(M,q,k,oe,ue,te)}b.C=b.Ma=k}function We(b,k,M,q,te,oe,ue){var de=b.$/q,me=b.$%q,we=b.m,Fe=b.s,Ve=M+b.$,_e=Ve;te=M+q*te;var je=M+q*oe,Be=280+Fe.ua,Ze=b.Pb?de:16777216,$e=0<Fe.ua?Fe.Wa:null,et=Fe.wc,rt=Ve<je?ie(Fe,me,de):null;t(b.C<oe),t(je<=te);var ut=!1;e:for(;;){for(;ut||Ve<je;){var ot=0;if(de>=Ze){var Dt=Ve-M;t((Ze=b).Pb),Ze.wd=Ze.m,Ze.xd=Dt,0<Ze.s.ua&&he(Ze.s.Wa,Ze.s.vb),Ze=de+HT}if(me&et||(rt=ie(Fe,me,de)),t(rt!=null),rt.Qb&&(k[Ve]=rt.qb,ut=!0),!ut)if(z(we),rt.jc){ot=we,Dt=k;var Tt=Ve,tr=rt.pd[O(ot)&tc-1];t(rt.jc),256>tr.g?(R(ot,ot.u+tr.g),Dt[Tt]=tr.value,ot=0):(R(ot,ot.u+tr.g-256),t(256<=tr.value),ot=tr.value),ot==0&&(ut=!0)}else ot=qr(rt.G[0],rt.H[0],we);if(we.h)break;if(ut||256>ot){if(!ut)if(rt.nd)k[Ve]=(rt.qb|ot<<8)>>>0;else{if(z(we),ut=qr(rt.G[1],rt.H[1],we),z(we),Dt=qr(rt.G[2],rt.H[2],we),Tt=qr(rt.G[3],rt.H[3],we),we.h)break;k[Ve]=(Tt<<24|ut<<16|ot<<8|Dt)>>>0}if(ut=!1,++Ve,++me>=q&&(me=0,++de,ue!=null&&de<=oe&&!(de%16)&&ue(b,de),$e!=null))for(;_e<Ve;)ot=k[_e++],$e.X[(506832829*ot&4294967295)>>>$e.Mb]=ot}else if(280>ot){if(ot=xi(ot-256,we),Dt=qr(rt.G[4],rt.H[4],we),z(we),Dt=Xi(q,Dt=xi(Dt,we)),we.h)break;if(Ve-M<Dt||te-Ve<ot)break e;for(Tt=0;Tt<ot;++Tt)k[Ve+Tt]=k[Ve+Tt-Dt];for(Ve+=ot,me+=ot;me>=q;)me-=q,++de,ue!=null&&de<=oe&&!(de%16)&&ue(b,de);if(t(Ve<=te),me&et&&(rt=ie(Fe,me,de)),$e!=null)for(;_e<Ve;)ot=k[_e++],$e.X[(506832829*ot&4294967295)>>>$e.Mb]=ot}else{if(!(ot<Be))break e;for(ut=ot-280,t($e!=null);_e<Ve;)ot=k[_e++],$e.X[(506832829*ot&4294967295)>>>$e.Mb]=ot;ot=Ve,t(!(ut>>>(Dt=$e).Xa)),k[ot]=Dt.X[ut],ut=!0}ut||t(we.h==N(we))}if(b.Pb&&we.h&&Ve<te)t(b.m.h),b.a=5,b.m=b.wd,b.$=b.xd,0<b.s.ua&&he(b.s.vb,b.s.Wa);else{if(we.h)break e;ue!=null&&ue(b,de>oe?oe:de),b.a=0,b.$=Ve-M}return 1}return b.a=3,0}function Ke(b){t(b!=null),b.vc=null,b.yc=null,b.Ya=null;var k=b.Wa;k!=null&&(k.X=null),b.vb=null,t(b!=null)}function ze(){var b=new Gt;return b==null?null:(b.a=0,b.xb=aw,Mt("Predictor","VP8LPredictors"),Mt("Predictor","VP8LPredictors_C"),Mt("PredictorAdd","VP8LPredictorsAdd"),Mt("PredictorAdd","VP8LPredictorsAdd_C"),gn=Ge,Gf=Pe,Xf=Ye,qo=nt,Go=Qe,Xo=ht,rc=it,j.VP8LMapColor32b=Oa,j.VP8LMapColor8b=Vf,b)}function He(b,k,M,q,te){var oe=1,ue=[b],de=[k],me=q.m,we=q.s,Fe=null,Ve=0;e:for(;;){if(M)for(;oe&&U(me,1);){var _e=ue,je=de,Be=q,Ze=1,$e=Be.m,et=Be.gc[Be.ab],rt=U($e,2);if(Be.Oc&1<<rt)oe=0;else{switch(Be.Oc|=1<<rt,et.hc=rt,et.Ea=_e[0],et.nc=je[0],et.K=[null],++Be.ab,t(4>=Be.ab),rt){case 0:case 1:et.b=U($e,3)+2,Ze=He(be(et.Ea,et.b),be(et.nc,et.b),0,Be,et.K),et.K=et.K[0];break;case 3:var ut,ot=U($e,8)+1,Dt=16<ot?0:4<ot?1:2<ot?2:3;if(_e[0]=be(et.Ea,Dt),et.b=Dt,ut=Ze=He(ot,1,0,Be,et.K)){var Tt,tr=ot,Ot=et,ur=1<<(8>>Ot.b),zn=s(ur);if(zn==null)ut=0;else{var rr=Ot.K[0],Pt=Ot.w;for(zn[0]=Ot.K[0][0],Tt=1;Tt<1*tr;++Tt)zn[Tt]=pe(rr[Pt+Tt],zn[Tt-1]);for(;Tt<4*ur;++Tt)zn[Tt]=0;Ot.K[0]=null,Ot.K[0]=zn,ut=1}}Ze=ut;break;case 2:break;default:t(0)}oe=Ze}}if(ue=ue[0],de=de[0],oe&&U(me,1)&&!(oe=1<=(Ve=U(me,4))&&11>=Ve)){q.a=3;break e}var yt;if(yt=oe)t:{var xn,Jt,fr,Mr=q,ai=ue,Ri=de,an=Ve,vi=M,Mi=Mr.m,Hn=Mr.s,dr=[null],wr=1,on=0,_r=zT[an];r:for(;;){if(vi&&U(Mi,1)){var oi=U(Mi,3)+2,sa=be(ai,oi),vn=be(Ri,oi),Yi=sa*vn;if(!He(sa,vn,0,Mr,dr))break r;for(dr=dr[0],Hn.xc=oi,xn=0;xn<Yi;++xn){var Fr=dr[xn]>>8&65535;dr[xn]=Fr,Fr>=wr&&(wr=Fr+1)}}if(Mi.h)break r;for(Jt=0;5>Jt;++Jt){var $n=iw[Jt];!Jt&&0<an&&($n+=1<<an),on<$n&&(on=$n)}var cs=l(wr*_r,G),Bi=wr,us=l(Bi,re);if(us==null)var fs=null;else t(65536>=Bi),fs=us;var Ki=s(on);if(fs==null||Ki==null||cs==null){Mr.a=1;break r}var hs=cs;for(xn=fr=0;xn<wr;++xn){var Lr=fs[xn],ds=Lr.G,aa=Lr.H,ic=0,ho=1,li=0;for(Jt=0;5>Jt;++Jt){$n=iw[Jt],ds[Jt]=hs,aa[Jt]=fr,!Jt&&0<an&&($n+=1<<an);i:{var b0,B1=$n,S0=Mr,Zf=Ki,cN=hs,uN=fr,U1=0,Qo=S0.m,fN=U(Qo,1);if(i(Zf,0,0,B1),fN){var hN=U(Qo,1)+1,dN=U(Qo,1),pw=U(Qo,dN==0?1:8);Zf[pw]=1,hN==2&&(Zf[pw=U(Qo,8)]=1);var k0=1}else{var gw=s(19),mw=U(Qo,4)+4;if(19<mw){S0.a=3;var C0=0;break i}for(b0=0;b0<mw;++b0)gw[UT[b0]]=U(Qo,3);var W1=void 0,eh=void 0,xw=S0,pN=gw,E0=B1,vw=Zf,z1=0,Zo=xw.m,yw=8,ww=l(128,G);n:for(;L(ww,0,7,pN,19);){if(U(Zo,1)){var gN=2+2*U(Zo,3);if((W1=2+U(Zo,gN))>E0)break n}else W1=E0;for(eh=0;eh<E0&&W1--;){z(Zo);var _w=ww[0+(127&O(Zo))];R(Zo,Zo.u+_w.g);var fu=_w.value;if(16>fu)vw[eh++]=fu,fu!=0&&(yw=fu);else{var mN=fu==16,bw=fu-16,xN=MT[bw],Sw=U(Zo,RT[bw])+xN;if(eh+Sw>E0)break n;for(var vN=mN?yw:0;0<Sw--;)vw[eh++]=vN}}z1=1;break n}z1||(xw.a=3),k0=z1}(k0=k0&&!Qo.h)&&(U1=L(cN,uN,8,Zf,B1)),k0&&U1!=0?C0=U1:(S0.a=3,C0=0)}if(C0==0)break r;if(ho&&BT[Jt]==1&&(ho=hs[fr].g==0),ic+=hs[fr].g,fr+=C0,3>=Jt){var th,H1=Ki[0];for(th=1;th<$n;++th)Ki[th]>H1&&(H1=Ki[th]);li+=H1}}if(Lr.nd=ho,Lr.Qb=0,ho&&(Lr.qb=(ds[3][aa[3]+0].value<<24|ds[1][aa[1]+0].value<<16|ds[2][aa[2]+0].value)>>>0,ic==0&&256>ds[0][aa[0]+0].value&&(Lr.Qb=1,Lr.qb+=ds[0][aa[0]+0].value<<8)),Lr.jc=!Lr.Qb&&6>li,Lr.jc){var T0,po=Lr;for(T0=0;T0<tc;++T0){var el=T0,tl=po.pd[el],N0=po.G[0][po.H[0]+el];256<=N0.value?(tl.g=N0.g+256,tl.value=N0.value):(tl.g=0,tl.value=0,el>>=Nn(N0,8,tl),el>>=Nn(po.G[1][po.H[1]+el],16,tl),el>>=Nn(po.G[2][po.H[2]+el],0,tl),Nn(po.G[3][po.H[3]+el],24,tl))}}}Hn.vc=dr,Hn.Wb=wr,Hn.Ya=fs,Hn.yc=cs,yt=1;break t}yt=0}if(!(oe=yt)){q.a=3;break e}if(0<Ve){if(we.ua=1<<Ve,!W(we.Wa,Ve)){q.a=1,oe=0;break e}}else we.ua=0;var $1=q,kw=ue,yN=de,V1=$1.s,q1=V1.xc;if($1.c=kw,$1.i=yN,V1.md=be(kw,q1),V1.wc=q1==0?-1:(1<<q1)-1,M){q.xb=KT;break e}if((Fe=s(ue*de))==null){q.a=1,oe=0;break e}oe=(oe=We(q,Fe,0,ue,de,de,null))&&!me.h;break e}return oe?(te!=null?te[0]=Fe:(t(Fe==null),t(M)),q.$=0,M||Ke(we)):Ke(we),oe}function qe(b,k){var M=b.c*b.i,q=M+k+16*k;return t(b.c<=k),b.V=s(q),b.V==null?(b.Ta=null,b.Ua=0,b.a=1,0):(b.Ta=b.V,b.Ua=b.Ba+M+k,1)}function lt(b,k){var M=b.C,q=k-M,te=b.V,oe=b.Ba+b.c*M;for(t(k<=b.l.o);0<q;){var ue=16<q?16:q,de=b.l.ma,me=b.l.width,we=me*ue,Fe=de.ca,Ve=de.tb+me*M,_e=b.Ta,je=b.Ua;Se(b,ue,te,oe),Ky(_e,je,Fe,Ve,we),ke(de,M,M+ue,Fe,Ve,me),q-=ue,te+=ue*b.c,M+=ue}t(M==k),b.C=b.Ma=k}function mt(){this.ub=this.yd=this.td=this.Rb=0}function _t(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function gt(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function wt(){this.Yb=function(){var b=[];return function k(M,q,te){for(var oe=te[q],ue=0;ue<oe&&(M.push(te.length>q+1?[]:0),!(te.length<q+1));ue++)k(M[ue],q+1,te)}(b,0,[3,11]),b}()}function $t(){this.jb=s(3),this.Wc=o([4,8],wt),this.Xc=o([4,17],wt)}function Ar(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function lr(){this.ld=this.La=this.dd=this.tc=0}function sn(){this.Na=this.la=0}function Ea(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ta(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ta(){this.uc=this.M=this.Nb=0,this.wa=Array(new lr),this.Y=0,this.ya=Array(new ta),this.aa=0,this.l=new ru}function Os(){this.y=s(16),this.f=s(8),this.ea=s(8)}function Uo(){this.cb=this.a=0,this.sc="",this.m=new S,this.Od=new mt,this.Kc=new _t,this.ed=new Ar,this.Qa=new gt,this.Ic=this.$c=this.Aa=0,this.D=new Ta,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,S),this.ia=0,this.pb=l(4,Ea),this.Pa=new $t,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Os),this.Hd=0,this.rb=Array(new sn),this.sb=0,this.wa=Array(new lr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ta),this.L=this.aa=0,this.gd=o([4,2],lr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function An(b,k){return 0>b?0:b>k?k:b}function ru(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function m1(){var b=new Uo;return b!=null&&(b.a=0,b.sc="OK",b.cb=0,b.Xb=0,Jf||(Jf=nu)),b}function On(b,k,M){return b.a==0&&(b.a=k,b.sc=M,b.cb=0),0}function Zd(b,k,M){return 3<=M&&b[k+0]==157&&b[k+1]==1&&b[k+2]==42}function Na(b,k){if(b==null)return 0;if(b.a=0,b.sc="OK",k==null)return On(b,2,"null VP8Io passed to VP8GetHeaders()");var M=k.data,q=k.w,te=k.ha;if(4>te)return On(b,7,"Truncated header.");var oe=M[q+0]|M[q+1]<<8|M[q+2]<<16,ue=b.Od;if(ue.Rb=!(1&oe),ue.td=oe>>1&7,ue.yd=oe>>4&1,ue.ub=oe>>5,3<ue.td)return On(b,3,"Incorrect keyframe parameters.");if(!ue.yd)return On(b,4,"Frame not displayable.");q+=3,te-=3;var de=b.Kc;if(ue.Rb){if(7>te)return On(b,7,"cannot parse picture header");if(!Zd(M,q,te))return On(b,3,"Bad code word");de.c=16383&(M[q+4]<<8|M[q+3]),de.Td=M[q+4]>>6,de.i=16383&(M[q+6]<<8|M[q+5]),de.Ud=M[q+6]>>6,q+=7,te-=7,b.za=de.c+15>>4,b.Ub=de.i+15>>4,k.width=de.c,k.height=de.i,k.Da=0,k.j=0,k.v=0,k.va=k.width,k.o=k.height,k.da=0,k.ib=k.width,k.hb=k.height,k.U=k.width,k.T=k.height,i((oe=b.Pa).jb,0,255,oe.jb.length),t((oe=b.Qa)!=null),oe.Cb=0,oe.Bb=0,oe.Fb=1,i(oe.Zb,0,0,oe.Zb.length),i(oe.Lb,0,0,oe.Lb)}if(ue.ub>te)return On(b,7,"bad partition length");Q(oe=b.m,M,q,ue.ub),q+=ue.ub,te-=ue.ub,ue.Rb&&(de.Ld=Y(oe),de.Kd=Y(oe)),de=b.Qa;var me,we=b.Pa;if(t(oe!=null),t(de!=null),de.Cb=Y(oe),de.Cb){if(de.Bb=Y(oe),Y(oe)){for(de.Fb=Y(oe),me=0;4>me;++me)de.Zb[me]=Y(oe)?J(oe,7):0;for(me=0;4>me;++me)de.Lb[me]=Y(oe)?J(oe,6):0}if(de.Bb)for(me=0;3>me;++me)we.jb[me]=Y(oe)?ne(oe,8):255}else de.Bb=0;if(oe.Ka)return On(b,3,"cannot parse segment header");if((de=b.ed).zd=Y(oe),de.Tb=ne(oe,6),de.wb=ne(oe,3),de.Pc=Y(oe),de.Pc&&Y(oe)){for(we=0;4>we;++we)Y(oe)&&(de.vd[we]=J(oe,6));for(we=0;4>we;++we)Y(oe)&&(de.od[we]=J(oe,6))}if(b.L=de.Tb==0?0:de.zd?1:2,oe.Ka)return On(b,3,"cannot parse filter header");var Fe=te;if(te=me=q,q=me+Fe,de=Fe,b.Xb=(1<<ne(b.m,2))-1,Fe<3*(we=b.Xb))M=7;else{for(me+=3*we,de-=3*we,Fe=0;Fe<we;++Fe){var Ve=M[te+0]|M[te+1]<<8|M[te+2]<<16;Ve>de&&(Ve=de),Q(b.Jc[+Fe],M,me,Ve),me+=Ve,de-=Ve,te+=3}Q(b.Jc[+we],M,me,de),M=me<q?0:5}if(M!=0)return On(b,M,"cannot parse partitions");for(M=ne(me=b.m,7),te=Y(me)?J(me,4):0,q=Y(me)?J(me,4):0,de=Y(me)?J(me,4):0,we=Y(me)?J(me,4):0,me=Y(me)?J(me,4):0,Fe=b.Qa,Ve=0;4>Ve;++Ve){if(Fe.Cb){var _e=Fe.Zb[Ve];Fe.Fb||(_e+=M)}else{if(0<Ve){b.pb[Ve]=b.pb[0];continue}_e=M}var je=b.pb[Ve];je.Sc[0]=I1[An(_e+te,127)],je.Sc[1]=R1[An(_e+0,127)],je.Eb[0]=2*I1[An(_e+q,127)],je.Eb[1]=101581*R1[An(_e+de,127)]>>16,8>je.Eb[1]&&(je.Eb[1]=8),je.Qc[0]=I1[An(_e+we,117)],je.Qc[1]=R1[An(_e+me,127)],je.lc=_e+me}if(!ue.Rb)return On(b,4,"Not a key frame.");for(Y(oe),ue=b.Pa,M=0;4>M;++M){for(te=0;8>te;++te)for(q=0;3>q;++q)for(de=0;11>de;++de)we=Z(oe,XT[M][te][q][de])?ne(oe,8):qT[M][te][q][de],ue.Wc[M][te].Yb[q][de]=we;for(te=0;17>te;++te)ue.Xc[M][te]=ue.Wc[M][YT[te]]}return b.kc=Y(oe),b.kc&&(b.Bd=ne(oe,8)),b.cb=1}function nu(b,k,M,q,te,oe,ue){var de=k[te].Yb[M];for(M=0;16>te;++te){if(!Z(b,de[M+0]))return te;for(;!Z(b,de[M+1]);)if(de=k[++te].Yb[0],M=0,te==16)return 16;var me=k[te+1].Yb;if(Z(b,de[M+2])){var we=b,Fe=0;if(Z(we,(_e=de)[(Ve=M)+3]))if(Z(we,_e[Ve+6])){for(de=0,Ve=2*(Fe=Z(we,_e[Ve+8]))+(_e=Z(we,_e[Ve+9+Fe])),Fe=0,_e=$T[Ve];_e[de];++de)Fe+=Fe+Z(we,_e[de]);Fe+=3+(8<<Ve)}else Z(we,_e[Ve+7])?(Fe=7+2*Z(we,165),Fe+=Z(we,145)):Fe=5+Z(we,159);else Fe=Z(we,_e[Ve+4])?3+Z(we,_e[Ve+5]):2;de=me[2]}else Fe=1,de=me[1];me=ue+VT[te],0>(we=b).b&&K(we);var Ve,_e=we.b,je=(Ve=we.Ca>>1)-(we.I>>_e)>>31;--we.b,we.Ca+=je,we.Ca|=1,we.I-=(Ve+1&je)<<_e,oe[me]=((Fe^je)-je)*q[(0<te)+0]}return 16}function e0(b){var k=b.rb[b.sb-1];k.la=0,k.Na=0,i(b.zc,0,0,b.zc.length),b.ja=0}function Ps(b,k,M,q,te){te=b[k+M+32*q]+(te>>3),b[k+M+32*q]=-256&te?0>te?0:255:te}function Bn(b,k,M,q,te,oe){Ps(b,k,0,M,q+te),Ps(b,k,1,M,q+oe),Ps(b,k,2,M,q-oe),Ps(b,k,3,M,q-te)}function Za(b){return(20091*b>>16)+b}function t0(b,k,M,q){var te,oe=0,ue=s(16);for(te=0;4>te;++te){var de=b[k+0]+b[k+8],me=b[k+0]-b[k+8],we=(35468*b[k+4]>>16)-Za(b[k+12]),Fe=Za(b[k+4])+(35468*b[k+12]>>16);ue[oe+0]=de+Fe,ue[oe+1]=me+we,ue[oe+2]=me-we,ue[oe+3]=de-Fe,oe+=4,k++}for(te=oe=0;4>te;++te)de=(b=ue[oe+0]+4)+ue[oe+8],me=b-ue[oe+8],we=(35468*ue[oe+4]>>16)-Za(ue[oe+12]),Ps(M,q,0,0,de+(Fe=Za(ue[oe+4])+(35468*ue[oe+12]>>16))),Ps(M,q,1,0,me+we),Ps(M,q,2,0,me-we),Ps(M,q,3,0,de-Fe),oe++,q+=32}function x1(b,k,M,q){var te=b[k+0]+4,oe=35468*b[k+4]>>16,ue=Za(b[k+4]),de=35468*b[k+1]>>16;Bn(M,q,0,te+ue,b=Za(b[k+1]),de),Bn(M,q,1,te+oe,b,de),Bn(M,q,2,te-oe,b,de),Bn(M,q,3,te-ue,b,de)}function v1(b,k,M,q,te){t0(b,k,M,q),te&&t0(b,k+16,M,q+4)}function Aa(b,k,M,q){nc(b,k+0,M,q,1),nc(b,k+32,M,q+128,1)}function r0(b,k,M,q){var te;for(b=b[k+0]+4,te=0;4>te;++te)for(k=0;4>k;++k)Ps(M,q,k,te,b)}function n0(b,k,M,q){b[k+0]&&yr(b,k+0,M,q),b[k+16]&&yr(b,k+16,M,q+4),b[k+32]&&yr(b,k+32,M,q+128),b[k+48]&&yr(b,k+48,M,q+128+4)}function iu(b,k,M,q){var te,oe=s(16);for(te=0;4>te;++te){var ue=b[k+0+te]+b[k+12+te],de=b[k+4+te]+b[k+8+te],me=b[k+4+te]-b[k+8+te],we=b[k+0+te]-b[k+12+te];oe[0+te]=ue+de,oe[8+te]=ue-de,oe[4+te]=we+me,oe[12+te]=we-me}for(te=0;4>te;++te)ue=(b=oe[0+4*te]+3)+oe[3+4*te],de=oe[1+4*te]+oe[2+4*te],me=oe[1+4*te]-oe[2+4*te],we=b-oe[3+4*te],M[q+0]=ue+de>>3,M[q+16]=we+me>>3,M[q+32]=ue-de>>3,M[q+48]=we-me>>3,q+=64}function Vl(b,k,M){var q,te=k-32,oe=ls,ue=255-b[te-1];for(q=0;q<M;++q){var de,me=oe,we=ue+b[k-1];for(de=0;de<M;++de)b[k+de]=me[we+b[te+de]];k+=32}}function y1(b,k){Vl(b,k,4)}function w1(b,k){Vl(b,k,8)}function _1(b,k){Vl(b,k,16)}function Pf(b,k){var M;for(M=0;16>M;++M)n(b,k+32*M,b,k-32,16)}function i0(b,k){var M;for(M=16;0<M;--M)i(b,k,b[k-1],16),k+=32}function ra(b,k,M){var q;for(q=0;16>q;++q)i(k,M+32*q,b,16)}function b1(b,k){var M,q=16;for(M=0;16>M;++M)q+=b[k-1+32*M]+b[k+M-32];ra(q>>5,b,k)}function ql(b,k){var M,q=8;for(M=0;16>M;++M)q+=b[k-1+32*M];ra(q>>4,b,k)}function Ff(b,k){var M,q=8;for(M=0;16>M;++M)q+=b[k+M-32];ra(q>>4,b,k)}function S1(b,k){ra(128,b,k)}function Xt(b,k,M){return b+2*k+M+2>>2}function k1(b,k){var M,q=k-32;for(q=new Uint8Array([Xt(b[q-1],b[q+0],b[q+1]),Xt(b[q+0],b[q+1],b[q+2]),Xt(b[q+1],b[q+2],b[q+3]),Xt(b[q+2],b[q+3],b[q+4])]),M=0;4>M;++M)n(b,k+32*M,q,0,q.length)}function C1(b,k){var M=b[k-1],q=b[k-1+32],te=b[k-1+64],oe=b[k-1+96];se(b,k+0,16843009*Xt(b[k-1-32],M,q)),se(b,k+32,16843009*Xt(M,q,te)),se(b,k+64,16843009*Xt(q,te,oe)),se(b,k+96,16843009*Xt(te,oe,oe))}function E1(b,k){var M,q=4;for(M=0;4>M;++M)q+=b[k+M-32]+b[k-1+32*M];for(q>>=3,M=0;4>M;++M)i(b,k+32*M,q,4)}function eo(b,k){var M=b[k-1+0],q=b[k-1+32],te=b[k-1+64],oe=b[k-1-32],ue=b[k+0-32],de=b[k+1-32],me=b[k+2-32],we=b[k+3-32];b[k+0+96]=Xt(q,te,b[k-1+96]),b[k+1+96]=b[k+0+64]=Xt(M,q,te),b[k+2+96]=b[k+1+64]=b[k+0+32]=Xt(oe,M,q),b[k+3+96]=b[k+2+64]=b[k+1+32]=b[k+0+0]=Xt(ue,oe,M),b[k+3+64]=b[k+2+32]=b[k+1+0]=Xt(de,ue,oe),b[k+3+32]=b[k+2+0]=Xt(me,de,ue),b[k+3+0]=Xt(we,me,de)}function to(b,k){var M=b[k+1-32],q=b[k+2-32],te=b[k+3-32],oe=b[k+4-32],ue=b[k+5-32],de=b[k+6-32],me=b[k+7-32];b[k+0+0]=Xt(b[k+0-32],M,q),b[k+1+0]=b[k+0+32]=Xt(M,q,te),b[k+2+0]=b[k+1+32]=b[k+0+64]=Xt(q,te,oe),b[k+3+0]=b[k+2+32]=b[k+1+64]=b[k+0+96]=Xt(te,oe,ue),b[k+3+32]=b[k+2+64]=b[k+1+96]=Xt(oe,ue,de),b[k+3+64]=b[k+2+96]=Xt(ue,de,me),b[k+3+96]=Xt(de,me,me)}function T1(b,k){var M=b[k-1+0],q=b[k-1+32],te=b[k-1+64],oe=b[k-1-32],ue=b[k+0-32],de=b[k+1-32],me=b[k+2-32],we=b[k+3-32];b[k+0+0]=b[k+1+64]=oe+ue+1>>1,b[k+1+0]=b[k+2+64]=ue+de+1>>1,b[k+2+0]=b[k+3+64]=de+me+1>>1,b[k+3+0]=me+we+1>>1,b[k+0+96]=Xt(te,q,M),b[k+0+64]=Xt(q,M,oe),b[k+0+32]=b[k+1+96]=Xt(M,oe,ue),b[k+1+32]=b[k+2+96]=Xt(oe,ue,de),b[k+2+32]=b[k+3+96]=Xt(ue,de,me),b[k+3+32]=Xt(de,me,we)}function N1(b,k){var M=b[k+0-32],q=b[k+1-32],te=b[k+2-32],oe=b[k+3-32],ue=b[k+4-32],de=b[k+5-32],me=b[k+6-32],we=b[k+7-32];b[k+0+0]=M+q+1>>1,b[k+1+0]=b[k+0+64]=q+te+1>>1,b[k+2+0]=b[k+1+64]=te+oe+1>>1,b[k+3+0]=b[k+2+64]=oe+ue+1>>1,b[k+0+32]=Xt(M,q,te),b[k+1+32]=b[k+0+96]=Xt(q,te,oe),b[k+2+32]=b[k+1+96]=Xt(te,oe,ue),b[k+3+32]=b[k+2+96]=Xt(oe,ue,de),b[k+3+64]=Xt(ue,de,me),b[k+3+96]=Xt(de,me,we)}function su(b,k){var M=b[k-1+0],q=b[k-1+32],te=b[k-1+64],oe=b[k-1+96];b[k+0+0]=M+q+1>>1,b[k+2+0]=b[k+0+32]=q+te+1>>1,b[k+2+32]=b[k+0+64]=te+oe+1>>1,b[k+1+0]=Xt(M,q,te),b[k+3+0]=b[k+1+32]=Xt(q,te,oe),b[k+3+32]=b[k+1+64]=Xt(te,oe,oe),b[k+3+64]=b[k+2+64]=b[k+0+96]=b[k+1+96]=b[k+2+96]=b[k+3+96]=oe}function jf(b,k){var M=b[k-1+0],q=b[k-1+32],te=b[k-1+64],oe=b[k-1+96],ue=b[k-1-32],de=b[k+0-32],me=b[k+1-32],we=b[k+2-32];b[k+0+0]=b[k+2+32]=M+ue+1>>1,b[k+0+32]=b[k+2+64]=q+M+1>>1,b[k+0+64]=b[k+2+96]=te+q+1>>1,b[k+0+96]=oe+te+1>>1,b[k+3+0]=Xt(de,me,we),b[k+2+0]=Xt(ue,de,me),b[k+1+0]=b[k+3+32]=Xt(M,ue,de),b[k+1+32]=b[k+3+64]=Xt(q,M,ue),b[k+1+64]=b[k+3+96]=Xt(te,q,M),b[k+1+96]=Xt(oe,te,q)}function Gl(b,k){var M;for(M=0;8>M;++M)n(b,k+32*M,b,k-32,8)}function A1(b,k){var M;for(M=0;8>M;++M)i(b,k,b[k-1],8),k+=32}function ro(b,k,M){var q;for(q=0;8>q;++q)i(k,M+32*q,b,8)}function O1(b,k){var M,q=8;for(M=0;8>M;++M)q+=b[k+M-32]+b[k-1+32*M];ro(q>>4,b,k)}function Df(b,k){var M,q=4;for(M=0;8>M;++M)q+=b[k+M-32];ro(q>>3,b,k)}function Lf(b,k){var M,q=4;for(M=0;8>M;++M)q+=b[k-1+32*M];ro(q>>3,b,k)}function s0(b,k){ro(128,b,k)}function no(b,k,M){var q=b[k-M],te=b[k+0],oe=3*(te-q)+P1[1020+b[k-2*M]-b[k+M]],ue=d0[112+(oe+4>>3)];b[k-M]=ls[255+q+d0[112+(oe+3>>3)]],b[k+0]=ls[255+te-ue]}function If(b,k,M,q){var te=b[k+0],oe=b[k+M];return Ds[255+b[k-2*M]-b[k-M]]>q||Ds[255+oe-te]>q}function au(b,k,M,q){return 4*Ds[255+b[k-M]-b[k+0]]+Ds[255+b[k-2*M]-b[k+M]]<=q}function Rf(b,k,M,q,te){var oe=b[k-3*M],ue=b[k-2*M],de=b[k-M],me=b[k+0],we=b[k+M],Fe=b[k+2*M],Ve=b[k+3*M];return 4*Ds[255+de-me]+Ds[255+ue-we]>q?0:Ds[255+b[k-4*M]-oe]<=te&&Ds[255+oe-ue]<=te&&Ds[255+ue-de]<=te&&Ds[255+Ve-Fe]<=te&&Ds[255+Fe-we]<=te&&Ds[255+we-me]<=te}function Xl(b,k,M,q){var te=2*q+1;for(q=0;16>q;++q)au(b,k+q,M,te)&&no(b,k+q,M)}function Mf(b,k,M,q){var te=2*q+1;for(q=0;16>q;++q)au(b,k+q*M,1,te)&&no(b,k+q*M,1)}function a0(b,k,M,q){var te;for(te=3;0<te;--te)Xl(b,k+=4*M,M,q)}function o0(b,k,M,q){var te;for(te=3;0<te;--te)Mf(b,k+=4,M,q)}function io(b,k,M,q,te,oe,ue,de){for(oe=2*oe+1;0<te--;){if(Rf(b,k,M,oe,ue))if(If(b,k,M,de))no(b,k,M);else{var me=b,we=k,Fe=M,Ve=me[we-2*Fe],_e=me[we-Fe],je=me[we+0],Be=me[we+Fe],Ze=me[we+2*Fe],$e=27*(rt=P1[1020+3*(je-_e)+P1[1020+Ve-Be]])+63>>7,et=18*rt+63>>7,rt=9*rt+63>>7;me[we-3*Fe]=ls[255+me[we-3*Fe]+rt],me[we-2*Fe]=ls[255+Ve+et],me[we-Fe]=ls[255+_e+$e],me[we+0]=ls[255+je-$e],me[we+Fe]=ls[255+Be-et],me[we+2*Fe]=ls[255+Ze-rt]}k+=q}}function so(b,k,M,q,te,oe,ue,de){for(oe=2*oe+1;0<te--;){if(Rf(b,k,M,oe,ue))if(If(b,k,M,de))no(b,k,M);else{var me=b,we=k,Fe=M,Ve=me[we-Fe],_e=me[we+0],je=me[we+Fe],Be=d0[112+(4+(Ze=3*(_e-Ve))>>3)],Ze=d0[112+(Ze+3>>3)],$e=Be+1>>1;me[we-2*Fe]=ls[255+me[we-2*Fe]+$e],me[we-Fe]=ls[255+Ve+Ze],me[we+0]=ls[255+_e-Be],me[we+Fe]=ls[255+je-$e]}k+=q}}function l0(b,k,M,q,te,oe){io(b,k,M,1,16,q,te,oe)}function Yl(b,k,M,q,te,oe){io(b,k,1,M,16,q,te,oe)}function c0(b,k,M,q,te,oe){var ue;for(ue=3;0<ue;--ue)so(b,k+=4*M,M,1,16,q,te,oe)}function D(b,k,M,q,te,oe){var ue;for(ue=3;0<ue;--ue)so(b,k+=4,1,M,16,q,te,oe)}function ee(b,k,M,q,te,oe,ue,de){io(b,k,te,1,8,oe,ue,de),io(M,q,te,1,8,oe,ue,de)}function Ce(b,k,M,q,te,oe,ue,de){io(b,k,1,te,8,oe,ue,de),io(M,q,1,te,8,oe,ue,de)}function Oe(b,k,M,q,te,oe,ue,de){so(b,k+4*te,te,1,8,oe,ue,de),so(M,q+4*te,te,1,8,oe,ue,de)}function Le(b,k,M,q,te,oe,ue,de){so(b,k+4,1,te,8,oe,ue,de),so(M,q+4,1,te,8,oe,ue,de)}function tt(){this.ba=new Qt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new cr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function at(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function At(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ft(){this.ua=0,this.Wa=new fe,this.vb=new fe,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new re,this.yc=new G}function Gt(){this.xb=this.a=0,this.l=new ru,this.ca=new Qt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new I,this.Pb=0,this.wd=new I,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ft,this.ab=0,this.gc=l(4,At),this.Oc=0}function Zt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ru,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function hr(b,k,M,q,te,oe,ue){for(b=b==null?0:b[k+0],k=0;k<ue;++k)te[oe+k]=b+M[q+k]&255,b=te[oe+k]}function Jr(b,k,M,q,te,oe,ue){var de;if(b==null)hr(null,null,M,q,te,oe,ue);else for(de=0;de<ue;++de)te[oe+de]=b[k+de]+M[q+de]&255}function Pn(b,k,M,q,te,oe,ue){if(b==null)hr(null,null,M,q,te,oe,ue);else{var de,me=b[k+0],we=me,Fe=me;for(de=0;de<ue;++de)we=Fe+(me=b[k+de])-we,Fe=M[q+de]+(-256&we?0>we?0:255:we)&255,we=me,te[oe+de]=Fe}}function Dr(b,k,M,q){var te=k.width,oe=k.o;if(t(b!=null&&k!=null),0>M||0>=q||M+q>oe)return null;if(!b.Cc){if(b.ga==null){var ue;if(b.ga=new Zt,(ue=b.ga==null)||(ue=k.width*k.o,t(b.Gb.length==0),b.Gb=s(ue),b.Uc=0,b.Gb==null?ue=0:(b.mb=b.Gb,b.nb=b.Uc,b.rc=null,ue=1),ue=!ue),!ue){ue=b.ga;var de=b.Fa,me=b.P,we=b.qc,Fe=b.mb,Ve=b.nb,_e=me+1,je=we-1,Be=ue.l;if(t(de!=null&&Fe!=null&&k!=null),Jo[0]=null,Jo[1]=hr,Jo[2]=Jr,Jo[3]=Pn,ue.ca=Fe,ue.tb=Ve,ue.c=k.width,ue.i=k.height,t(0<ue.c&&0<ue.i),1>=we)k=0;else if(ue.$a=3&de[me+0],ue.Z=de[me+0]>>2&3,ue.Lc=de[me+0]>>4&3,me=de[me+0]>>6&3,0>ue.$a||1<ue.$a||4<=ue.Z||1<ue.Lc||me)k=0;else if(Be.put=kt,Be.ac=Li,Be.bc=Kn,Be.ma=ue,Be.width=k.width,Be.height=k.height,Be.Da=k.Da,Be.v=k.v,Be.va=k.va,Be.j=k.j,Be.o=k.o,ue.$a)e:{t(ue.$a==1),k=ze();t:for(;;){if(k==null){k=0;break e}if(t(ue!=null),ue.mc=k,k.c=ue.c,k.i=ue.i,k.l=ue.l,k.l.ma=ue,k.l.width=ue.c,k.l.height=ue.i,k.a=0,P(k.m,de,_e,je),!He(ue.c,ue.i,1,k,null)||(k.ab==1&&k.gc[0].hc==3&&ve(k.s)?(ue.ic=1,de=k.c*k.i,k.Ta=null,k.Ua=0,k.V=s(de),k.Ba=0,k.V==null?(k.a=1,k=0):k=1):(ue.ic=0,k=qe(k,ue.c)),!k))break t;k=1;break e}ue.mc=null,k=0}else k=je>=ue.c*ue.i;ue=!k}if(ue)return null;b.ga.Lc!=1?b.Ga=0:q=oe-M}t(b.ga!=null),t(M+q<=oe);e:{if(k=(de=b.ga).c,oe=de.l.o,de.$a==0){if(_e=b.rc,je=b.Vc,Be=b.Fa,me=b.P+1+M*k,we=b.mb,Fe=b.nb+M*k,t(me<=b.P+b.qc),de.Z!=0)for(t(Jo[de.Z]!=null),ue=0;ue<q;++ue)Jo[de.Z](_e,je,Be,me,we,Fe,k),_e=we,je=Fe,Fe+=k,me+=k;else for(ue=0;ue<q;++ue)n(we,Fe,Be,me,k),_e=we,je=Fe,Fe+=k,me+=k;b.rc=_e,b.Vc=je}else{if(t(de.mc!=null),k=M+q,t((ue=de.mc)!=null),t(k<=ue.i),ue.C>=k)k=1;else if(de.ic||na(),de.ic){de=ue.V,_e=ue.Ba,je=ue.c;var Ze=ue.i,$e=(Be=1,me=ue.$/je,we=ue.$%je,Fe=ue.m,Ve=ue.s,ue.$),et=je*Ze,rt=je*k,ut=Ve.wc,ot=$e<rt?ie(Ve,we,me):null;t($e<=et),t(k<=Ze),t(ve(Ve));t:for(;;){for(;!Fe.h&&$e<rt;){if(we&ut||(ot=ie(Ve,we,me)),t(ot!=null),z(Fe),256>(Ze=qr(ot.G[0],ot.H[0],Fe)))de[_e+$e]=Ze,++$e,++we>=je&&(we=0,++me<=k&&!(me%16)&&Ee(ue,me));else{if(!(280>Ze)){Be=0;break t}Ze=xi(Ze-256,Fe);var Dt,Tt=qr(ot.G[4],ot.H[4],Fe);if(z(Fe),!($e>=(Tt=Xi(je,Tt=xi(Tt,Fe)))&&et-$e>=Ze)){Be=0;break t}for(Dt=0;Dt<Ze;++Dt)de[_e+$e+Dt]=de[_e+$e+Dt-Tt];for($e+=Ze,we+=Ze;we>=je;)we-=je,++me<=k&&!(me%16)&&Ee(ue,me);$e<rt&&we&ut&&(ot=ie(Ve,we,me))}t(Fe.h==N(Fe))}Ee(ue,me>k?k:me);break t}!Be||Fe.h&&$e<et?(Be=0,ue.a=Fe.h?5:3):ue.$=$e,k=Be}else k=We(ue,ue.V,ue.Ba,ue.c,ue.i,k,lt);if(!k){q=0;break e}}M+q>=oe&&(b.Cc=1),q=1}if(!q)return null;if(b.Cc&&((q=b.ga)!=null&&(q.mc=null),b.ga=null,0<b.Ga))return alert("todo:WebPDequantizeLevels"),null}return b.nb+M*te}function Un(b,k,M,q,te,oe){for(;0<te--;){var ue,de=b,me=k+(M?1:0),we=b,Fe=k+(M?0:3);for(ue=0;ue<q;++ue){var Ve=we[Fe+4*ue];Ve!=255&&(Ve*=32897,de[me+4*ue+0]=de[me+4*ue+0]*Ve>>23,de[me+4*ue+1]=de[me+4*ue+1]*Ve>>23,de[me+4*ue+2]=de[me+4*ue+2]*Ve>>23)}k+=oe}}function Fn(b,k,M,q,te){for(;0<q--;){var oe;for(oe=0;oe<M;++oe){var ue=b[k+2*oe+0],de=15&(we=b[k+2*oe+1]),me=4369*de,we=(240&we|we>>4)*me>>16;b[k+2*oe+0]=(240&ue|ue>>4)*me>>16&240|(15&ue|ue<<4)*me>>16>>4&15,b[k+2*oe+1]=240&we|de}k+=te}}function ii(b,k,M,q,te,oe,ue,de){var me,we,Fe=255;for(we=0;we<te;++we){for(me=0;me<q;++me){var Ve=b[k+me];oe[ue+4*me]=Ve,Fe&=Ve}k+=M,ue+=de}return Fe!=255}function ao(b,k,M,q,te){var oe;for(oe=0;oe<te;++oe)M[q+oe]=b[k+oe]>>8}function na(){Kf=Un,Xy=Fn,Yy=ii,Ky=ao}function oo(b,k,M){j[b]=function(q,te,oe,ue,de,me,we,Fe,Ve,_e,je,Be,Ze,$e,et,rt,ut){var ot,Dt=ut-1>>1,Tt=de[me+0]|we[Fe+0]<<16,tr=Ve[_e+0]|je[Be+0]<<16;t(q!=null);var Ot=3*Tt+tr+131074>>2;for(k(q[te+0],255&Ot,Ot>>16,Ze,$e),oe!=null&&(Ot=3*tr+Tt+131074>>2,k(oe[ue+0],255&Ot,Ot>>16,et,rt)),ot=1;ot<=Dt;++ot){var ur=de[me+ot]|we[Fe+ot]<<16,zn=Ve[_e+ot]|je[Be+ot]<<16,rr=Tt+ur+tr+zn+524296,Pt=rr+2*(ur+tr)>>3;Ot=Pt+Tt>>1,Tt=(rr=rr+2*(Tt+zn)>>3)+ur>>1,k(q[te+2*ot-1],255&Ot,Ot>>16,Ze,$e+(2*ot-1)*M),k(q[te+2*ot-0],255&Tt,Tt>>16,Ze,$e+(2*ot-0)*M),oe!=null&&(Ot=rr+tr>>1,Tt=Pt+zn>>1,k(oe[ue+2*ot-1],255&Ot,Ot>>16,et,rt+(2*ot-1)*M),k(oe[ue+2*ot+0],255&Tt,Tt>>16,et,rt+(2*ot+0)*M)),Tt=ur,tr=zn}1&ut||(Ot=3*Tt+tr+131074>>2,k(q[te+ut-1],255&Ot,Ot>>16,Ze,$e+(ut-1)*M),oe!=null&&(Ot=3*tr+Tt+131074>>2,k(oe[ue+ut-1],255&Ot,Ot>>16,et,rt+(ut-1)*M)))}}function Bf(){Ls[p0]=JT,Ls[g0]=ow,Ls[rw]=QT,Ls[m0]=lw,Ls[x0]=cw,Ls[F1]=uw,Ls[nw]=ZT,Ls[j1]=ow,Ls[D1]=lw,Ls[v0]=cw,Ls[L1]=uw}function ou(b){return b&-16384?0>b?0:255:b>>eN}function Wo(b,k){return ou((19077*b>>8)+(26149*k>>8)-14234)}function Kl(b,k,M){return ou((19077*b>>8)-(6419*k>>8)-(13320*M>>8)+8708)}function Jl(b,k){return ou((19077*b>>8)+(33050*k>>8)-17685)}function zo(b,k,M,q,te){q[te+0]=Wo(b,M),q[te+1]=Kl(b,k,M),q[te+2]=Jl(b,k)}function si(b,k,M,q,te){q[te+0]=Jl(b,k),q[te+1]=Kl(b,k,M),q[te+2]=Wo(b,M)}function Ql(b,k,M,q,te){var oe=Kl(b,k,M);k=oe<<3&224|Jl(b,k)>>3,q[te+0]=248&Wo(b,M)|oe>>5,q[te+1]=k}function Zl(b,k,M,q,te){var oe=240&Jl(b,k)|15;q[te+0]=240&Wo(b,M)|Kl(b,k,M)>>4,q[te+1]=oe}function Uf(b,k,M,q,te){q[te+0]=255,zo(b,k,M,q,te+1)}function Wf(b,k,M,q,te){si(b,k,M,q,te),q[te+3]=255}function Ii(b,k,M,q,te){zo(b,k,M,q,te),q[te+3]=255}function lo(b,k,M){j[b]=function(q,te,oe,ue,de,me,we,Fe,Ve){for(var _e=Fe+(-2&Ve)*M;Fe!=_e;)k(q[te+0],oe[ue+0],de[me+0],we,Fe),k(q[te+1],oe[ue+0],de[me+0],we,Fe+M),te+=2,++ue,++me,Fe+=2*M;1&Ve&&k(q[te+0],oe[ue+0],de[me+0],we,Fe)}}function lu(b,k,M){return M==0?b==0?k==0?6:5:k==0?4:0:M}function u0(b,k,M,q,te){switch(b>>>30){case 3:nc(k,M,q,te,0);break;case 2:js(k,M,q,te);break;case 1:yr(k,M,q,te)}}function Fs(b,k){var M,q,te=k.M,oe=k.Nb,ue=b.oc,de=b.pc+40,me=b.oc,we=b.pc+584,Fe=b.oc,Ve=b.pc+600;for(M=0;16>M;++M)ue[de+32*M-1]=129;for(M=0;8>M;++M)me[we+32*M-1]=129,Fe[Ve+32*M-1]=129;for(0<te?ue[de-1-32]=me[we-1-32]=Fe[Ve-1-32]=129:(i(ue,de-32-1,127,21),i(me,we-32-1,127,9),i(Fe,Ve-32-1,127,9)),q=0;q<b.za;++q){var _e=k.ya[k.aa+q];if(0<q){for(M=-1;16>M;++M)n(ue,de+32*M-4,ue,de+32*M+12,4);for(M=-1;8>M;++M)n(me,we+32*M-4,me,we+32*M+4,4),n(Fe,Ve+32*M-4,Fe,Ve+32*M+4,4)}var je=b.Gd,Be=b.Hd+q,Ze=_e.ad,$e=_e.Hc;if(0<te&&(n(ue,de-32,je[Be].y,0,16),n(me,we-32,je[Be].f,0,8),n(Fe,Ve-32,je[Be].ea,0,8)),_e.Za){var et=ue,rt=de-32+16;for(0<te&&(q>=b.za-1?i(et,rt,je[Be].y[15],4):n(et,rt,je[Be+1].y,0,4)),M=0;4>M;M++)et[rt+128+M]=et[rt+256+M]=et[rt+384+M]=et[rt+0+M];for(M=0;16>M;++M,$e<<=2)et=ue,rt=de+hw[M],ia[_e.Ob[M]](et,rt),u0($e,Ze,16*+M,et,rt)}else if(et=lu(q,te,_e.Ob[0]),Ko[et](ue,de),$e!=0)for(M=0;16>M;++M,$e<<=2)u0($e,Ze,16*+M,ue,de+hw[M]);for(M=_e.Gc,et=lu(q,te,_e.Dd),fo[et](me,we),fo[et](Fe,Ve),$e=Ze,et=me,rt=we,255&(_e=0|M)&&(170&_e?Fa($e,256,et,rt):Pr($e,256,et,rt)),_e=Fe,$e=Ve,255&(M>>=8)&&(170&M?Fa(Ze,320,_e,$e):Pr(Ze,320,_e,$e)),te<b.Ub-1&&(n(je[Be].y,0,ue,de+480,16),n(je[Be].f,0,me,we+224,8),n(je[Be].ea,0,Fe,Ve+224,8)),M=8*oe*b.B,je=b.sa,Be=b.ta+16*q+16*oe*b.R,Ze=b.qa,_e=b.ra+8*q+M,$e=b.Ha,et=b.Ia+8*q+M,M=0;16>M;++M)n(je,Be+M*b.R,ue,de+32*M,16);for(M=0;8>M;++M)n(Ze,_e+M*b.B,me,we+32*M,8),n($e,et+M*b.B,Fe,Ve+32*M,8)}}function ec(b,k,M,q,te,oe,ue,de,me){var we=[0],Fe=[0],Ve=0,_e=me!=null?me.kd:0,je=me??new at;if(b==null||12>M)return 7;je.data=b,je.w=k,je.ha=M,k=[k],M=[M],je.gb=[je.gb];e:{var Be=k,Ze=M,$e=je.gb;if(t(b!=null),t(Ze!=null),t($e!=null),$e[0]=0,12<=Ze[0]&&!r(b,Be[0],"RIFF")){if(r(b,Be[0]+8,"WEBP")){$e=3;break e}var et=ae(b,Be[0]+4);if(12>et||4294967286<et){$e=3;break e}if(_e&&et>Ze[0]-8){$e=7;break e}$e[0]=et,Be[0]+=12,Ze[0]-=12}$e=0}if($e!=0)return $e;for(et=0<je.gb[0],M=M[0];;){e:{var rt=b;Ze=k,$e=M;var ut=we,ot=Fe,Dt=Be=[0];if((Ot=Ve=[Ve])[0]=0,8>$e[0])$e=7;else{if(!r(rt,Ze[0],"VP8X")){if(ae(rt,Ze[0]+4)!=10){$e=3;break e}if(18>$e[0]){$e=7;break e}var Tt=ae(rt,Ze[0]+8),tr=1+le(rt,Ze[0]+12);if(2147483648<=tr*(rt=1+le(rt,Ze[0]+15))){$e=3;break e}Dt!=null&&(Dt[0]=Tt),ut!=null&&(ut[0]=tr),ot!=null&&(ot[0]=rt),Ze[0]+=18,$e[0]-=18,Ot[0]=1}$e=0}}if(Ve=Ve[0],Be=Be[0],$e!=0)return $e;if(Ze=!!(2&Be),!et&&Ve)return 3;if(oe!=null&&(oe[0]=!!(16&Be)),ue!=null&&(ue[0]=Ze),de!=null&&(de[0]=0),ue=we[0],Be=Fe[0],Ve&&Ze&&me==null){$e=0;break}if(4>M){$e=7;break}if(et&&Ve||!et&&!Ve&&!r(b,k[0],"ALPH")){M=[M],je.na=[je.na],je.P=[je.P],je.Sa=[je.Sa];e:{Tt=b,$e=k,et=M;var Ot=je.gb;ut=je.na,ot=je.P,Dt=je.Sa,tr=22,t(Tt!=null),t(et!=null),rt=$e[0];var ur=et[0];for(t(ut!=null),t(Dt!=null),ut[0]=null,ot[0]=null,Dt[0]=0;;){if($e[0]=rt,et[0]=ur,8>ur){$e=7;break e}var zn=ae(Tt,rt+4);if(4294967286<zn){$e=3;break e}var rr=8+zn+1&-2;if(tr+=rr,0<Ot&&tr>Ot){$e=3;break e}if(!r(Tt,rt,"VP8 ")||!r(Tt,rt,"VP8L")){$e=0;break e}if(ur[0]<rr){$e=7;break e}r(Tt,rt,"ALPH")||(ut[0]=Tt,ot[0]=rt+8,Dt[0]=zn),rt+=rr,ur-=rr}}if(M=M[0],je.na=je.na[0],je.P=je.P[0],je.Sa=je.Sa[0],$e!=0)break}M=[M],je.Ja=[je.Ja],je.xa=[je.xa];e:if(Ot=b,$e=k,et=M,ut=je.gb[0],ot=je.Ja,Dt=je.xa,Tt=$e[0],rt=!r(Ot,Tt,"VP8 "),tr=!r(Ot,Tt,"VP8L"),t(Ot!=null),t(et!=null),t(ot!=null),t(Dt!=null),8>et[0])$e=7;else{if(rt||tr){if(Ot=ae(Ot,Tt+4),12<=ut&&Ot>ut-12){$e=3;break e}if(_e&&Ot>et[0]-8){$e=7;break e}ot[0]=Ot,$e[0]+=8,et[0]-=8,Dt[0]=tr}else Dt[0]=5<=et[0]&&Ot[Tt+0]==47&&!(Ot[Tt+4]>>5),ot[0]=et[0];$e=0}if(M=M[0],je.Ja=je.Ja[0],je.xa=je.xa[0],k=k[0],$e!=0)break;if(4294967286<je.Ja)return 3;if(de==null||Ze||(de[0]=je.xa?2:1),ue=[ue],Be=[Be],je.xa){if(5>M){$e=7;break}de=ue,_e=Be,Ze=oe,b==null||5>M?b=0:5<=M&&b[k+0]==47&&!(b[k+4]>>5)?(et=[0],Ot=[0],ut=[0],P(ot=new I,b,k,M),ea(ot,et,Ot,ut)?(de!=null&&(de[0]=et[0]),_e!=null&&(_e[0]=Ot[0]),Ze!=null&&(Ze[0]=ut[0]),b=1):b=0):b=0}else{if(10>M){$e=7;break}de=Be,b==null||10>M||!Zd(b,k+3,M-3)?b=0:(_e=b[k+0]|b[k+1]<<8|b[k+2]<<16,Ze=16383&(b[k+7]<<8|b[k+6]),b=16383&(b[k+9]<<8|b[k+8]),1&_e||3<(_e>>1&7)||!(_e>>4&1)||_e>>5>=je.Ja||!Ze||!b?b=0:(ue&&(ue[0]=Ze),de&&(de[0]=b),b=1))}if(!b||(ue=ue[0],Be=Be[0],Ve&&(we[0]!=ue||Fe[0]!=Be)))return 3;me!=null&&(me[0]=je,me.offset=k-me.w,t(4294967286>k-me.w),t(me.offset==me.ha-M));break}return $e==0||$e==7&&Ve&&me==null?(oe!=null&&(oe[0]|=je.na!=null&&0<je.na.length),q!=null&&(q[0]=ue),te!=null&&(te[0]=Be),0):$e}function zf(b,k,M){var q=k.width,te=k.height,oe=0,ue=0,de=q,me=te;if(k.Da=b!=null&&0<b.Da,k.Da&&(de=b.cd,me=b.bd,oe=b.v,ue=b.j,11>M||(oe&=-2,ue&=-2),0>oe||0>ue||0>=de||0>=me||oe+de>q||ue+me>te))return 0;if(k.v=oe,k.j=ue,k.va=oe+de,k.o=ue+me,k.U=de,k.T=me,k.da=b!=null&&0<b.da,k.da){if(!Te(de,me,M=[b.ib],oe=[b.hb]))return 0;k.ib=M[0],k.hb=oe[0]}return k.ob=b!=null&&b.ob,k.Kb=b==null||!b.Sd,k.da&&(k.ob=k.ib<3*q/4&&k.hb<3*te/4,k.Kb=0),1}function Hf(b){if(b==null)return 2;if(11>b.S){var k=b.f.RGBA;k.fb+=(b.height-1)*k.A,k.A=-k.A}else k=b.f.kb,b=b.height,k.O+=(b-1)*k.fa,k.fa=-k.fa,k.N+=(b-1>>1)*k.Ab,k.Ab=-k.Ab,k.W+=(b-1>>1)*k.Db,k.Db=-k.Db,k.F!=null&&(k.J+=(b-1)*k.lb,k.lb=-k.lb);return 0}function Ho(b,k,M,q){if(q==null||0>=b||0>=k)return 2;if(M!=null){if(M.Da){var te=M.cd,oe=M.bd,ue=-2&M.v,de=-2&M.j;if(0>ue||0>de||0>=te||0>=oe||ue+te>b||de+oe>k)return 2;b=te,k=oe}if(M.da){if(!Te(b,k,te=[M.ib],oe=[M.hb]))return 2;b=te[0],k=oe[0]}}q.width=b,q.height=k;e:{var me=q.width,we=q.height;if(b=q.S,0>=me||0>=we||!(b>=p0&&13>b))b=2;else{if(0>=q.Rd&&q.sd==null){ue=oe=te=k=0;var Fe=(de=me*dw[b])*we;if(11>b||(oe=(we+1)/2*(k=(me+1)/2),b==12&&(ue=(te=me)*we)),(we=s(Fe+2*oe+ue))==null){b=1;break e}q.sd=we,11>b?((me=q.f.RGBA).eb=we,me.fb=0,me.A=de,me.size=Fe):((me=q.f.kb).y=we,me.O=0,me.fa=de,me.Fd=Fe,me.f=we,me.N=0+Fe,me.Ab=k,me.Cd=oe,me.ea=we,me.W=0+Fe+oe,me.Db=k,me.Ed=oe,b==12&&(me.F=we,me.J=0+Fe+2*oe),me.Tc=ue,me.lb=te)}if(k=1,te=q.S,oe=q.width,ue=q.height,te>=p0&&13>te)if(11>te)b=q.f.RGBA,k&=(de=Math.abs(b.A))*(ue-1)+oe<=b.size,k&=de>=oe*dw[te],k&=b.eb!=null;else{b=q.f.kb,de=(oe+1)/2,Fe=(ue+1)/2,me=Math.abs(b.fa),we=Math.abs(b.Ab);var Ve=Math.abs(b.Db),_e=Math.abs(b.lb),je=_e*(ue-1)+oe;k&=me*(ue-1)+oe<=b.Fd,k&=we*(Fe-1)+de<=b.Cd,k=(k&=Ve*(Fe-1)+de<=b.Ed)&me>=oe&we>=de&Ve>=de,k&=b.y!=null,k&=b.f!=null,k&=b.ea!=null,te==12&&(k&=_e>=oe,k&=je<=b.Tc,k&=b.F!=null)}else k=0;b=k?0:2}}return b!=0||M!=null&&M.fd&&(b=Hf(q)),b}var tc=64,as=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],os=24,$o=32,co=8,Vo=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];xe("Predictor0","PredictorAdd0"),j.Predictor0=function(){return 4278190080},j.Predictor1=function(b){return b},j.Predictor2=function(b,k,M){return k[M+0]},j.Predictor3=function(b,k,M){return k[M+1]},j.Predictor4=function(b,k,M){return k[M-1]},j.Predictor5=function(b,k,M){return Ne(Ne(b,k[M+1]),k[M+0])},j.Predictor6=function(b,k,M){return Ne(b,k[M-1])},j.Predictor7=function(b,k,M){return Ne(b,k[M+0])},j.Predictor8=function(b,k,M){return Ne(k[M-1],k[M+0])},j.Predictor9=function(b,k,M){return Ne(k[M+0],k[M+1])},j.Predictor10=function(b,k,M){return Ne(Ne(b,k[M-1]),Ne(k[M+0],k[M+1]))},j.Predictor11=function(b,k,M){var q=k[M+0];return 0>=De(q>>24&255,b>>24&255,(k=k[M-1])>>24&255)+De(q>>16&255,b>>16&255,k>>16&255)+De(q>>8&255,b>>8&255,k>>8&255)+De(255&q,255&b,255&k)?q:b},j.Predictor12=function(b,k,M){var q=k[M+0];return(Ie((b>>24&255)+(q>>24&255)-((k=k[M-1])>>24&255))<<24|Ie((b>>16&255)+(q>>16&255)-(k>>16&255))<<16|Ie((b>>8&255)+(q>>8&255)-(k>>8&255))<<8|Ie((255&b)+(255&q)-(255&k)))>>>0},j.Predictor13=function(b,k,M){var q=k[M-1];return(Re((b=Ne(b,k[M+0]))>>24&255,q>>24&255)<<24|Re(b>>16&255,q>>16&255)<<16|Re(b>>8&255,q>>8&255)<<8|Re(255&b,255&q))>>>0};var $f=j.PredictorAdd0;j.PredictorAdd1=Me,xe("Predictor2","PredictorAdd2"),xe("Predictor3","PredictorAdd3"),xe("Predictor4","PredictorAdd4"),xe("Predictor5","PredictorAdd5"),xe("Predictor6","PredictorAdd6"),xe("Predictor7","PredictorAdd7"),xe("Predictor8","PredictorAdd8"),xe("Predictor9","PredictorAdd9"),xe("Predictor10","PredictorAdd10"),xe("Predictor11","PredictorAdd11"),xe("Predictor12","PredictorAdd12"),xe("Predictor13","PredictorAdd13");var cu=j.PredictorAdd2;Ue("ColorIndexInverseTransform","MapARGB","32b",function(b){return b>>8&255},function(b){return b}),Ue("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(b){return b},function(b){return b>>8&255});var gn,f0=j.ColorIndexInverseTransform,Oa=j.MapARGB,Pa=j.VP8LColorIndexInverseTransformAlpha,Vf=j.MapAlpha,qf=j.VP8LPredictorsAdd=[];qf.length=16,(j.VP8LPredictors=[]).length=16,(j.VP8LPredictorsAdd_C=[]).length=16,(j.VP8LPredictors_C=[]).length=16;var Gf,Xf,qo,Go,Xo,rc,Yo,nc,js,Fa,yr,Pr,mn,Wn,uo,Yf,uu,h0,zy,Hy,$y,Vy,qy,Gy,Kf,Xy,Yy,Ky,Jy=s(511),Qy=s(2041),Zy=s(225),ew=s(767),tw=0,P1=Qy,d0=Zy,ls=ew,Ds=Jy,p0=0,g0=1,rw=2,m0=3,x0=4,F1=5,nw=6,j1=7,D1=8,v0=9,L1=10,RT=[2,3,7],MT=[3,3,11],iw=[280,256,256,256,40],BT=[0,1,1,1,0],UT=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],WT=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],zT=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],HT=8,I1=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],R1=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Jf=null,$T=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],VT=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],sw=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],qT=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],GT=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],XT=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],YT=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ko=[],ia=[],fo=[],KT=1,aw=2,Jo=[],Ls=[];oo("UpsampleRgbLinePair",zo,3),oo("UpsampleBgrLinePair",si,3),oo("UpsampleRgbaLinePair",Ii,4),oo("UpsampleBgraLinePair",Wf,4),oo("UpsampleArgbLinePair",Uf,4),oo("UpsampleRgba4444LinePair",Zl,2),oo("UpsampleRgb565LinePair",Ql,2);var JT=j.UpsampleRgbLinePair,QT=j.UpsampleBgrLinePair,ow=j.UpsampleRgbaLinePair,lw=j.UpsampleBgraLinePair,cw=j.UpsampleArgbLinePair,uw=j.UpsampleRgba4444LinePair,ZT=j.UpsampleRgb565LinePair,y0=16,w0=1<<y0-1,Qf=-227,M1=482,eN=6,fw=0,tN=s(256),rN=s(256),nN=s(256),iN=s(256),sN=s(M1-Qf),aN=s(M1-Qf);lo("YuvToRgbRow",zo,3),lo("YuvToBgrRow",si,3),lo("YuvToRgbaRow",Ii,4),lo("YuvToBgraRow",Wf,4),lo("YuvToArgbRow",Uf,4),lo("YuvToRgba4444Row",Zl,2),lo("YuvToRgb565Row",Ql,2);var hw=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],_0=[0,2,8],oN=[8,7,6,4,4,2,2,2,1,1,1,1],lN=1;this.WebPDecodeRGBA=function(b,k,M,q,te){var oe=g0,ue=new tt,de=new Qt;ue.ba=de,de.S=oe,de.width=[de.width],de.height=[de.height];var me=de.width,we=de.height,Fe=new St;if(Fe==null||b==null)var Ve=2;else t(Fe!=null),Ve=ec(b,k,M,Fe.width,Fe.height,Fe.Pd,Fe.Qd,Fe.format,null);if(Ve!=0?me=0:(me!=null&&(me[0]=Fe.width[0]),we!=null&&(we[0]=Fe.height[0]),me=1),me){de.width=de.width[0],de.height=de.height[0],q!=null&&(q[0]=de.width),te!=null&&(te[0]=de.height);e:{if(q=new ru,(te=new at).data=b,te.w=k,te.ha=M,te.kd=1,k=[0],t(te!=null),((b=ec(te.data,te.w,te.ha,null,null,null,k,null,te))==0||b==7)&&k[0]&&(b=4),(k=b)==0){if(t(ue!=null),q.data=te.data,q.w=te.w+te.offset,q.ha=te.ha-te.offset,q.put=kt,q.ac=Li,q.bc=Kn,q.ma=ue,te.xa){if((b=ze())==null){ue=1;break e}if(function(_e,je){var Be=[0],Ze=[0],$e=[0];t:for(;;){if(_e==null)return 0;if(je==null)return _e.a=2,0;if(_e.l=je,_e.a=0,P(_e.m,je.data,je.w,je.ha),!ea(_e.m,Be,Ze,$e)){_e.a=3;break t}if(_e.xb=aw,je.width=Be[0],je.height=Ze[0],!He(Be[0],Ze[0],1,_e,null))break t;return 1}return t(_e.a!=0),0}(b,q)){if(q=(k=Ho(q.width,q.height,ue.Oa,ue.ba))==0){t:{q=b;r:for(;;){if(q==null){q=0;break t}if(t(q.s.yc!=null),t(q.s.Ya!=null),t(0<q.s.Wb),t((M=q.l)!=null),t((te=M.ma)!=null),q.xb!=0){if(q.ca=te.ba,q.tb=te.tb,t(q.ca!=null),!zf(te.Oa,M,m0)){q.a=2;break r}if(!qe(q,M.width)||M.da)break r;if((M.da||bt(q.ca.S))&&na(),11>q.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),q.ca.f.kb.F!=null&&na()),q.Pb&&0<q.s.ua&&q.s.vb.X==null&&!W(q.s.vb,q.s.Wa.Xa)){q.a=1;break r}q.xb=0}if(!We(q,q.V,q.Ba,q.c,q.i,M.o,ge))break r;te.Dc=q.Ma,q=1;break t}t(q.a!=0),q=0}q=!q}q&&(k=b.a)}else k=b.a}else{if((b=new m1)==null){ue=1;break e}if(b.Fa=te.na,b.P=te.P,b.qc=te.Sa,Na(b,q)){if((k=Ho(q.width,q.height,ue.Oa,ue.ba))==0){if(b.Aa=0,M=ue.Oa,t((te=b)!=null),M!=null){if(0<(me=0>(me=M.Md)?0:100<me?255:255*me/100)){for(we=Fe=0;4>we;++we)12>(Ve=te.pb[we]).lc&&(Ve.ia=me*oN[0>Ve.lc?0:Ve.lc]>>3),Fe|=Ve.ia;Fe&&(alert("todo:VP8InitRandom"),te.ia=1)}te.Ga=M.Id,100<te.Ga?te.Ga=100:0>te.Ga&&(te.Ga=0)}(function(_e,je){if(_e==null)return 0;if(je==null)return On(_e,2,"NULL VP8Io parameter in VP8Decode().");if(!_e.cb&&!Na(_e,je))return 0;if(t(_e.cb),je.ac==null||je.ac(je)){je.ob&&(_e.L=0);var Be=_0[_e.L];if(_e.L==2?(_e.yb=0,_e.zb=0):(_e.yb=je.v-Be>>4,_e.zb=je.j-Be>>4,0>_e.yb&&(_e.yb=0),0>_e.zb&&(_e.zb=0)),_e.Va=je.o+15+Be>>4,_e.Hb=je.va+15+Be>>4,_e.Hb>_e.za&&(_e.Hb=_e.za),_e.Va>_e.Ub&&(_e.Va=_e.Ub),0<_e.L){var Ze=_e.ed;for(Be=0;4>Be;++Be){var $e;if(_e.Qa.Cb){var et=_e.Qa.Lb[Be];_e.Qa.Fb||(et+=Ze.Tb)}else et=Ze.Tb;for($e=0;1>=$e;++$e){var rt=_e.gd[Be][$e],ut=et;if(Ze.Pc&&(ut+=Ze.vd[0],$e&&(ut+=Ze.od[0])),0<(ut=0>ut?0:63<ut?63:ut)){var ot=ut;0<Ze.wb&&(ot=4<Ze.wb?ot>>2:ot>>1)>9-Ze.wb&&(ot=9-Ze.wb),1>ot&&(ot=1),rt.dd=ot,rt.tc=2*ut+ot,rt.ld=40<=ut?2:15<=ut?1:0}else rt.tc=0;rt.La=$e}}}Be=0}else On(_e,6,"Frame setup failed"),Be=_e.a;if(Be=Be==0){if(Be){_e.$c=0,0<_e.Aa||(_e.Ic=lN);t:{Be=_e.Ic,Ze=4*(ot=_e.za);var Dt=32*ot,Tt=ot+1,tr=0<_e.L?ot*(0<_e.Aa?2:1):0,Ot=(_e.Aa==2?2:1)*ot;if((rt=Ze+832+($e=3*(16*Be+_0[_e.L])/2*Dt)+(et=_e.Fa!=null&&0<_e.Fa.length?_e.Kc.c*_e.Kc.i:0))!=rt)Be=0;else{if(rt>_e.Vb){if(_e.Vb=0,_e.Ec=s(rt),_e.Fc=0,_e.Ec==null){Be=On(_e,1,"no memory during frame initialization.");break t}_e.Vb=rt}rt=_e.Ec,ut=_e.Fc,_e.Ac=rt,_e.Bc=ut,ut+=Ze,_e.Gd=l(Dt,Os),_e.Hd=0,_e.rb=l(Tt+1,sn),_e.sb=1,_e.wa=tr?l(tr,lr):null,_e.Y=0,_e.D.Nb=0,_e.D.wa=_e.wa,_e.D.Y=_e.Y,0<_e.Aa&&(_e.D.Y+=ot),t(!0),_e.oc=rt,_e.pc=ut,ut+=832,_e.ya=l(Ot,ta),_e.aa=0,_e.D.ya=_e.ya,_e.D.aa=_e.aa,_e.Aa==2&&(_e.D.aa+=ot),_e.R=16*ot,_e.B=8*ot,ot=(Dt=_0[_e.L])*_e.R,Dt=Dt/2*_e.B,_e.sa=rt,_e.ta=ut+ot,_e.qa=_e.sa,_e.ra=_e.ta+16*Be*_e.R+Dt,_e.Ha=_e.qa,_e.Ia=_e.ra+8*Be*_e.B+Dt,_e.$c=0,ut+=$e,_e.mb=et?rt:null,_e.nb=et?ut:null,t(ut+et<=_e.Fc+_e.Vb),e0(_e),i(_e.Ac,_e.Bc,0,Ze),Be=1}}if(Be){if(je.ka=0,je.y=_e.sa,je.O=_e.ta,je.f=_e.qa,je.N=_e.ra,je.ea=_e.Ha,je.Vd=_e.Ia,je.fa=_e.R,je.Rc=_e.B,je.F=null,je.J=0,!tw){for(Be=-255;255>=Be;++Be)Jy[255+Be]=0>Be?-Be:Be;for(Be=-1020;1020>=Be;++Be)Qy[1020+Be]=-128>Be?-128:127<Be?127:Be;for(Be=-112;112>=Be;++Be)Zy[112+Be]=-16>Be?-16:15<Be?15:Be;for(Be=-255;510>=Be;++Be)ew[255+Be]=0>Be?0:255<Be?255:Be;tw=1}Yo=iu,nc=v1,Fa=Aa,yr=r0,Pr=n0,js=x1,mn=l0,Wn=Yl,uo=ee,Yf=Ce,uu=c0,h0=D,zy=Oe,Hy=Le,$y=Xl,Vy=Mf,qy=a0,Gy=o0,ia[0]=E1,ia[1]=y1,ia[2]=k1,ia[3]=C1,ia[4]=eo,ia[5]=T1,ia[6]=to,ia[7]=N1,ia[8]=jf,ia[9]=su,Ko[0]=b1,Ko[1]=_1,Ko[2]=Pf,Ko[3]=i0,Ko[4]=ql,Ko[5]=Ff,Ko[6]=S1,fo[0]=O1,fo[1]=w1,fo[2]=Gl,fo[3]=A1,fo[4]=Lf,fo[5]=Df,fo[6]=s0,Be=1}else Be=0}Be&&(Be=function(ur,zn){for(ur.M=0;ur.M<ur.Va;++ur.M){var rr,Pt=ur.Jc[ur.M&ur.Xb],yt=ur.m,xn=ur;for(rr=0;rr<xn.za;++rr){var Jt=yt,fr=xn,Mr=fr.Ac,ai=fr.Bc+4*rr,Ri=fr.zc,an=fr.ya[fr.aa+rr];if(fr.Qa.Bb?an.$b=Z(Jt,fr.Pa.jb[0])?2+Z(Jt,fr.Pa.jb[2]):Z(Jt,fr.Pa.jb[1]):an.$b=0,fr.kc&&(an.Ad=Z(Jt,fr.Bd)),an.Za=!Z(Jt,145)+0,an.Za){var vi=an.Ob,Mi=0;for(fr=0;4>fr;++fr){var Hn,dr=Ri[0+fr];for(Hn=0;4>Hn;++Hn){dr=GT[Mr[ai+Hn]][dr];for(var wr=sw[Z(Jt,dr[0])];0<wr;)wr=sw[2*wr+Z(Jt,dr[wr])];dr=-wr,Mr[ai+Hn]=dr}n(vi,Mi,Mr,ai,4),Mi+=4,Ri[0+fr]=dr}}else dr=Z(Jt,156)?Z(Jt,128)?1:3:Z(Jt,163)?2:0,an.Ob[0]=dr,i(Mr,ai,dr,4),i(Ri,0,dr,4);an.Dd=Z(Jt,142)?Z(Jt,114)?Z(Jt,183)?1:3:2:0}if(xn.m.Ka)return On(ur,7,"Premature end-of-partition0 encountered.");for(;ur.ja<ur.za;++ur.ja){if(xn=Pt,Jt=(yt=ur).rb[yt.sb-1],Mr=yt.rb[yt.sb+yt.ja],rr=yt.ya[yt.aa+yt.ja],ai=yt.kc?rr.Ad:0)Jt.la=Mr.la=0,rr.Za||(Jt.Na=Mr.Na=0),rr.Hc=0,rr.Gc=0,rr.ia=0;else{var on,_r;if(Jt=Mr,Mr=xn,ai=yt.Pa.Xc,Ri=yt.ya[yt.aa+yt.ja],an=yt.pb[Ri.$b],fr=Ri.ad,vi=0,Mi=yt.rb[yt.sb-1],dr=Hn=0,i(fr,vi,0,384),Ri.Za)var oi=0,sa=ai[3];else{wr=s(16);var vn=Jt.Na+Mi.Na;if(vn=Jf(Mr,ai[1],vn,an.Eb,0,wr,0),Jt.Na=Mi.Na=(0<vn)+0,1<vn)Yo(wr,0,fr,vi);else{var Yi=wr[0]+3>>3;for(wr=0;256>wr;wr+=16)fr[vi+wr]=Yi}oi=1,sa=ai[0]}var Fr=15&Jt.la,$n=15&Mi.la;for(wr=0;4>wr;++wr){var cs=1&$n;for(Yi=_r=0;4>Yi;++Yi)Fr=Fr>>1|(cs=(vn=Jf(Mr,sa,vn=cs+(1&Fr),an.Sc,oi,fr,vi))>oi)<<7,_r=_r<<2|(3<vn?3:1<vn?2:fr[vi+0]!=0),vi+=16;Fr>>=4,$n=$n>>1|cs<<7,Hn=(Hn<<8|_r)>>>0}for(sa=Fr,oi=$n>>4,on=0;4>on;on+=2){for(_r=0,Fr=Jt.la>>4+on,$n=Mi.la>>4+on,wr=0;2>wr;++wr){for(cs=1&$n,Yi=0;2>Yi;++Yi)vn=cs+(1&Fr),Fr=Fr>>1|(cs=0<(vn=Jf(Mr,ai[2],vn,an.Qc,0,fr,vi)))<<3,_r=_r<<2|(3<vn?3:1<vn?2:fr[vi+0]!=0),vi+=16;Fr>>=2,$n=$n>>1|cs<<5}dr|=_r<<4*on,sa|=Fr<<4<<on,oi|=(240&$n)<<on}Jt.la=sa,Mi.la=oi,Ri.Hc=Hn,Ri.Gc=dr,Ri.ia=43690&dr?0:an.ia,ai=!(Hn|dr)}if(0<yt.L&&(yt.wa[yt.Y+yt.ja]=yt.gd[rr.$b][rr.Za],yt.wa[yt.Y+yt.ja].La|=!ai),xn.Ka)return On(ur,7,"Premature end-of-file encountered.")}if(e0(ur),yt=zn,xn=1,rr=(Pt=ur).D,Jt=0<Pt.L&&Pt.M>=Pt.zb&&Pt.M<=Pt.Va,Pt.Aa==0)t:{if(rr.M=Pt.M,rr.uc=Jt,Fs(Pt,rr),xn=1,rr=(_r=Pt.D).Nb,Jt=(dr=_0[Pt.L])*Pt.R,Mr=dr/2*Pt.B,wr=16*rr*Pt.R,Yi=8*rr*Pt.B,ai=Pt.sa,Ri=Pt.ta-Jt+wr,an=Pt.qa,fr=Pt.ra-Mr+Yi,vi=Pt.Ha,Mi=Pt.Ia-Mr+Yi,$n=(Fr=_r.M)==0,Hn=Fr>=Pt.Va-1,Pt.Aa==2&&Fs(Pt,_r),_r.uc)for(cs=(vn=Pt).D.M,t(vn.D.uc),_r=vn.yb;_r<vn.Hb;++_r){oi=_r,sa=cs;var Bi=(us=(li=vn).D).Nb;on=li.R;var us=us.wa[us.Y+oi],fs=li.sa,Ki=li.ta+16*Bi*on+16*oi,hs=us.dd,Lr=us.tc;if(Lr!=0)if(t(3<=Lr),li.L==1)0<oi&&Vy(fs,Ki,on,Lr+4),us.La&&Gy(fs,Ki,on,Lr),0<sa&&$y(fs,Ki,on,Lr+4),us.La&&qy(fs,Ki,on,Lr);else{var ds=li.B,aa=li.qa,ic=li.ra+8*Bi*ds+8*oi,ho=li.Ha,li=li.Ia+8*Bi*ds+8*oi;Bi=us.ld,0<oi&&(Wn(fs,Ki,on,Lr+4,hs,Bi),Yf(aa,ic,ho,li,ds,Lr+4,hs,Bi)),us.La&&(h0(fs,Ki,on,Lr,hs,Bi),Hy(aa,ic,ho,li,ds,Lr,hs,Bi)),0<sa&&(mn(fs,Ki,on,Lr+4,hs,Bi),uo(aa,ic,ho,li,ds,Lr+4,hs,Bi)),us.La&&(uu(fs,Ki,on,Lr,hs,Bi),zy(aa,ic,ho,li,ds,Lr,hs,Bi))}}if(Pt.ia&&alert("todo:DitherRow"),yt.put!=null){if(_r=16*Fr,Fr=16*(Fr+1),$n?(yt.y=Pt.sa,yt.O=Pt.ta+wr,yt.f=Pt.qa,yt.N=Pt.ra+Yi,yt.ea=Pt.Ha,yt.W=Pt.Ia+Yi):(_r-=dr,yt.y=ai,yt.O=Ri,yt.f=an,yt.N=fr,yt.ea=vi,yt.W=Mi),Hn||(Fr-=dr),Fr>yt.o&&(Fr=yt.o),yt.F=null,yt.J=null,Pt.Fa!=null&&0<Pt.Fa.length&&_r<Fr&&(yt.J=Dr(Pt,yt,_r,Fr-_r),yt.F=Pt.mb,yt.F==null&&yt.F.length==0)){xn=On(Pt,3,"Could not decode alpha data.");break t}_r<yt.j&&(dr=yt.j-_r,_r=yt.j,t(!(1&dr)),yt.O+=Pt.R*dr,yt.N+=Pt.B*(dr>>1),yt.W+=Pt.B*(dr>>1),yt.F!=null&&(yt.J+=yt.width*dr)),_r<Fr&&(yt.O+=yt.v,yt.N+=yt.v>>1,yt.W+=yt.v>>1,yt.F!=null&&(yt.J+=yt.v),yt.ka=_r-yt.j,yt.U=yt.va-yt.v,yt.T=Fr-_r,xn=yt.put(yt))}rr+1!=Pt.Ic||Hn||(n(Pt.sa,Pt.ta-Jt,ai,Ri+16*Pt.R,Jt),n(Pt.qa,Pt.ra-Mr,an,fr+8*Pt.B,Mr),n(Pt.Ha,Pt.Ia-Mr,vi,Mi+8*Pt.B,Mr))}if(!xn)return On(ur,6,"Output aborted.")}return 1}(_e,je)),je.bc!=null&&je.bc(je),Be&=1}return Be?(_e.cb=0,Be):0})(b,q)||(k=b.a)}}else k=b.a}k==0&&ue.Oa!=null&&ue.Oa.fd&&(k=Hf(ue.ba))}ue=k}oe=ue!=0?null:11>oe?de.f.RGBA.eb:de.f.kb.y}else oe=null;return oe};var dw=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(j,B){for(var F="",L=0;L<4;L++)F+=String.fromCharCode(j[B++]);return F}function f(j,B){return j[B+0]|j[B+1]<<8}function h(j,B){return(j[B+0]|j[B+1]<<8|j[B+2]<<16)>>>0}function d(j,B){return(j[B+0]|j[B+1]<<8|j[B+2]<<16|j[B+3]<<24)>>>0}new a;var u=[0],p=[0],m=[],g=new a,x=e,y=function(j,B){var F={},L=0,G=!1,X=0,re=0;if(F.frames=[],!function(S,I){for(var O=0;O<4;O++)if(S[I+O]!="RIFF".charCodeAt(O))return!0;return!1}(j,B)){for(d(j,B+=4),B+=8;B<j.length;){var Q=c(j,B),ne=d(j,B+=4);B+=4;var J=ne+(1&ne);switch(Q){case"VP8 ":case"VP8L":F.frames[L]===void 0&&(F.frames[L]={}),(U=F.frames[L]).src_off=G?re:B-8,U.src_size=X+ne+8,L++,G&&(G=!1,X=0,re=0);break;case"VP8X":(U=F.header={}).feature_flags=j[B];var P=B+4;U.canvas_width=1+h(j,P),P+=3,U.canvas_height=1+h(j,P),P+=3;break;case"ALPH":G=!0,X=J+8,re=B-8;break;case"ANIM":(U=F.header).bgcolor=d(j,B),P=B+4,U.loop_count=f(j,P),P+=2;break;case"ANMF":var H,U;(U=F.frames[L]={}).offset_x=2*h(j,B),B+=3,U.offset_y=2*h(j,B),B+=3,U.width=1+h(j,B),B+=3,U.height=1+h(j,B),B+=3,U.duration=h(j,B),B+=3,H=j[B++],U.dispose=1&H,U.blend=H>>1&1}Q!="ANMF"&&(B+=J)}return F}}(x,0);y.response=x,y.rgbaoutput=!0,y.dataurl=!1;var w=y.header?y.header:null,_=y.frames?y.frames:null;if(w){w.loop_counter=w.loop_count,u=[w.canvas_height],p=[w.canvas_width];for(var C=0;C<_.length&&_[C].blend!=0;C++);}var E=_[0],T=g.WebPDecodeRGBA(x,E.src_off,E.src_size,p,u);E.rgba=T,E.imgwidth=p[0],E.imgheight=u[0];for(var A=0;A<p[0]*u[0]*4;A++)m[A]=T[A];return this.width=p,this.height=u,this.data=m,this}(function(e){var t,r,n,i,s,l,o,a,c,f=function(S){return S=S||{},this.isStrokeTransparent=S.isStrokeTransparent||!1,this.strokeOpacity=S.strokeOpacity||1,this.strokeStyle=S.strokeStyle||"#000000",this.fillStyle=S.fillStyle||"#000000",this.isFillTransparent=S.isFillTransparent||!1,this.fillOpacity=S.fillOpacity||1,this.font=S.font||"10px sans-serif",this.textBaseline=S.textBaseline||"alphabetic",this.textAlign=S.textAlign||"left",this.lineWidth=S.lineWidth||1,this.lineJoin=S.lineJoin||"miter",this.lineCap=S.lineCap||"butt",this.path=S.path||[],this.transform=S.transform!==void 0?S.transform.clone():new a,this.globalCompositeOperation=S.globalCompositeOperation||"normal",this.globalAlpha=S.globalAlpha||1,this.clip_path=S.clip_path||[],this.currentPoint=S.currentPoint||new l,this.miterLimit=S.miterLimit||10,this.lastPoint=S.lastPoint||new l,this.lineDashOffset=S.lineDashOffset||0,this.lineDash=S.lineDash||[],this.margin=S.margin||[0,0,0,0],this.prevPageLastElemOffset=S.prevPageLastElemOffset||0,this.ignoreClearRect=typeof S.ignoreClearRect!="boolean"||S.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new h(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,l=this.internal.Point,o=this.internal.Rectangle,a=this.internal.Matrix,c=new f}]);var h=function(S){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var I=S;Object.defineProperty(this,"pdf",{get:function(){return I}});var O=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return O},set:function(W){O=!!W}});var N=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return N},set:function(W){N=!!W}});var R=0;Object.defineProperty(this,"posX",{get:function(){return R},set:function(W){isNaN(W)||(R=W)}});var z=0;Object.defineProperty(this,"posY",{get:function(){return z},set:function(W){isNaN(W)||(z=W)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(W){var he;typeof W=="number"?he=[W,W,W,W]:((he=new Array(4))[0]=W[0],he[1]=W.length>=2?W[1]:he[0],he[2]=W.length>=3?W[2]:he[0],he[3]=W.length>=4?W[3]:he[1]),c.margin=he}});var K=!1;Object.defineProperty(this,"autoPaging",{get:function(){return K},set:function(W){K=W}});var Y=0;Object.defineProperty(this,"lastBreak",{get:function(){return Y},set:function(W){Y=W}});var Z=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Z},set:function(W){Z=W}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(W){W instanceof f&&(c=W)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(W){c.path=W}});var se=[];Object.defineProperty(this,"ctxStack",{get:function(){return se},set:function(W){se=W}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(W){var he;he=d(W),this.ctx.fillStyle=he.style,this.ctx.isFillTransparent=he.a===0,this.ctx.fillOpacity=he.a,this.pdf.setFillColor(he.r,he.g,he.b,{a:he.a}),this.pdf.setTextColor(he.r,he.g,he.b,{a:he.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(W){var he=d(W);this.ctx.strokeStyle=he.style,this.ctx.isStrokeTransparent=he.a===0,this.ctx.strokeOpacity=he.a,he.a===0?this.pdf.setDrawColor(255,255,255):(he.a,this.pdf.setDrawColor(he.r,he.g,he.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(W){["butt","round","square"].indexOf(W)!==-1&&(this.ctx.lineCap=W,this.pdf.setLineCap(W))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(W){isNaN(W)||(this.ctx.lineWidth=W,this.pdf.setLineWidth(W))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(W){["bevel","round","miter"].indexOf(W)!==-1&&(this.ctx.lineJoin=W,this.pdf.setLineJoin(W))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(W){isNaN(W)||(this.ctx.miterLimit=W,this.pdf.setMiterLimit(W))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(W){this.ctx.textBaseline=W}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(W){["right","end","center","left","start"].indexOf(W)!==-1&&(this.ctx.textAlign=W)}});var V=null,le=null,ae=null;Object.defineProperty(this,"fontFaces",{get:function(){return ae},set:function(W){V=null,le=null,ae=W}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(W){var he;if(this.ctx.font=W,(he=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(W))!==null){var fe=he[1];he[2];var Te=he[3],be=he[4];he[5];var pe=he[6],xe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(be)[2];be=Math.floor(xe==="px"?parseFloat(be)*this.pdf.internal.scaleFactor:xe==="em"?parseFloat(be)*this.pdf.getFontSize():parseFloat(be)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(be);var ce=function(Ue){var Ye,nt,Qe=[],ht=Ue.trim();if(ht==="")return Xm;if(ht in a5)return[a5[ht]];for(;ht!=="";){switch(nt=null,Ye=(ht=l5(ht)).charAt(0)){case'"':case"'":nt=jL(ht.substring(1),Ye);break;default:nt=DL(ht)}if(nt===null||(Qe.push(nt[0]),(ht=l5(nt[1]))!==""&&ht.charAt(0)!==","))return Xm;ht=ht.replace(/^,/,"")}return Qe}(pe);if(this.fontFaces){var Ne=function(Ue,Ye){var nt=Ue.getFontList(),Qe=JSON.stringify(nt);if(V===null||le!==Qe){var ht=function(it){var dt=[];return Object.keys(it).forEach(function(Mt){it[Mt].forEach(function(bt){var Et=null;switch(bt){case"bold":Et={family:Mt,weight:"bold"};break;case"italic":Et={family:Mt,style:"italic"};break;case"bolditalic":Et={family:Mt,weight:"bold",style:"italic"};break;case"":case"normal":Et={family:Mt}}Et!==null&&(Et.ref={name:Mt,style:bt},dt.push(Et))})}),dt}(nt);V=function(it){for(var dt={},Mt=0;Mt<it.length;++Mt){var bt=Gm(it[Mt]),Et=bt.family,ir=bt.stretch,Qt=bt.style,St=bt.weight;dt[Et]=dt[Et]||{},dt[Et][ir]=dt[Et][ir]||{},dt[Et][ir][Qt]=dt[Et][ir][Qt]||{},dt[Et][ir][Qt][St]=bt}return dt}(ht.concat(Ye)),le=Qe}return V}(this.pdf,this.fontFaces),Ie=ce.map(function(Ue){return{family:Ue,stretch:"normal",weight:Te,style:fe}}),Re=function(Ue,Ye,nt){for(var Qe=(nt=nt||{}).defaultFontFamily||"times",ht=Object.assign({},FL,nt.genericFontFamilies||{}),it=null,dt=null,Mt=0;Mt<Ye.length;++Mt)if(ht[(it=Gm(Ye[Mt])).family]&&(it.family=ht[it.family]),Ue.hasOwnProperty(it.family)){dt=Ue[it.family];break}if(!(dt=dt||Ue[Qe]))throw new Error("Could not find a font-family for the rule '"+o5(it)+"' and default family '"+Qe+"'.");if(dt=function(bt,Et){if(Et[bt])return Et[bt];var ir=Nv[bt],Qt=ir<=Nv.normal?-1:1,St=s5(Et,nC,ir,Qt);if(!St)throw new Error("Could not find a matching font-stretch value for "+bt);return St}(it.stretch,dt),dt=function(bt,Et){if(Et[bt])return Et[bt];for(var ir=rC[bt],Qt=0;Qt<ir.length;++Qt)if(Et[ir[Qt]])return Et[ir[Qt]];throw new Error("Could not find a matching font-style for "+bt)}(it.style,dt),!(dt=function(bt,Et){if(Et[bt])return Et[bt];if(bt===400&&Et[500])return Et[500];if(bt===500&&Et[400])return Et[400];var ir=PL[bt],Qt=s5(Et,iC,ir,bt<400?-1:1);if(!Qt)throw new Error("Could not find a matching font-weight for value "+bt);return Qt}(it.weight,dt)))throw new Error("Failed to resolve a font for the rule '"+o5(it)+"'.");return dt}(Ne,Ie);this.pdf.setFont(Re.ref.name,Re.ref.style)}else{var De="";(Te==="bold"||parseInt(Te,10)>=700||fe==="bold")&&(De="bold"),fe==="italic"&&(De+="italic"),De.length===0&&(De="normal");for(var Me="",Ge={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ae=0;Ae<ce.length;Ae++){if(this.pdf.internal.getFont(ce[Ae],De,{noFallback:!0,disableWarning:!0})!==void 0){Me=ce[Ae];break}if(De==="bolditalic"&&this.pdf.internal.getFont(ce[Ae],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Me=ce[Ae],De="bold";else if(this.pdf.internal.getFont(ce[Ae],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Me=ce[Ae],De="normal";break}}if(Me===""){for(var Pe=0;Pe<ce.length;Pe++)if(Ge[ce[Pe]]){Me=Ge[ce[Pe]];break}}Me=Me===""?"Times":Me,this.pdf.setFont(Me,De)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(W){this.ctx.globalCompositeOperation=W}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(W){this.ctx.globalAlpha=W}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(W){this.ctx.lineDashOffset=W,U.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(W){this.ctx.lineDash=W,U.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(W){this.ctx.ignoreClearRect=!!W}})};h.prototype.setLineDash=function(S){this.lineDash=S},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){_.call(this,"fill",!1)},h.prototype.stroke=function(){_.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(S,I){if(isNaN(S)||isNaN(I))throw jr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var O=this.ctx.transform.applyToPoint(new l(S,I));this.path.push({type:"mt",x:O.x,y:O.y}),this.ctx.lastPoint=new l(S,I)},h.prototype.closePath=function(){var S=new l(0,0),I=0;for(I=this.path.length-1;I!==-1;I--)if(this.path[I].type==="begin"&&Er(this.path[I+1])==="object"&&typeof this.path[I+1].x=="number"){S=new l(this.path[I+1].x,this.path[I+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(S.x,S.y)},h.prototype.lineTo=function(S,I){if(isNaN(S)||isNaN(I))throw jr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var O=this.ctx.transform.applyToPoint(new l(S,I));this.path.push({type:"lt",x:O.x,y:O.y}),this.ctx.lastPoint=new l(O.x,O.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),_.call(this,null,!0)},h.prototype.quadraticCurveTo=function(S,I,O,N){if(isNaN(O)||isNaN(N)||isNaN(S)||isNaN(I))throw jr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var R=this.ctx.transform.applyToPoint(new l(O,N)),z=this.ctx.transform.applyToPoint(new l(S,I));this.path.push({type:"qct",x1:z.x,y1:z.y,x:R.x,y:R.y}),this.ctx.lastPoint=new l(R.x,R.y)},h.prototype.bezierCurveTo=function(S,I,O,N,R,z){if(isNaN(R)||isNaN(z)||isNaN(S)||isNaN(I)||isNaN(O)||isNaN(N))throw jr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var K=this.ctx.transform.applyToPoint(new l(R,z)),Y=this.ctx.transform.applyToPoint(new l(S,I)),Z=this.ctx.transform.applyToPoint(new l(O,N));this.path.push({type:"bct",x1:Y.x,y1:Y.y,x2:Z.x,y2:Z.y,x:K.x,y:K.y}),this.ctx.lastPoint=new l(K.x,K.y)},h.prototype.arc=function(S,I,O,N,R,z){if(isNaN(S)||isNaN(I)||isNaN(O)||isNaN(N)||isNaN(R))throw jr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(z=!!z,!this.ctx.transform.isIdentity){var K=this.ctx.transform.applyToPoint(new l(S,I));S=K.x,I=K.y;var Y=this.ctx.transform.applyToPoint(new l(0,O)),Z=this.ctx.transform.applyToPoint(new l(0,0));O=Math.sqrt(Math.pow(Y.x-Z.x,2)+Math.pow(Y.y-Z.y,2))}Math.abs(R-N)>=2*Math.PI&&(N=0,R=2*Math.PI),this.path.push({type:"arc",x:S,y:I,radius:O,startAngle:N,endAngle:R,counterclockwise:z})},h.prototype.arcTo=function(S,I,O,N,R){throw new Error("arcTo not implemented.")},h.prototype.rect=function(S,I,O,N){if(isNaN(S)||isNaN(I)||isNaN(O)||isNaN(N))throw jr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(S,I),this.lineTo(S+O,I),this.lineTo(S+O,I+N),this.lineTo(S,I+N),this.lineTo(S,I),this.lineTo(S+O,I),this.lineTo(S,I)},h.prototype.fillRect=function(S,I,O,N){if(isNaN(S)||isNaN(I)||isNaN(O)||isNaN(N))throw jr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!u.call(this)){var R={};this.lineCap!=="butt"&&(R.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(R.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(S,I,O,N),this.fill(),R.hasOwnProperty("lineCap")&&(this.lineCap=R.lineCap),R.hasOwnProperty("lineJoin")&&(this.lineJoin=R.lineJoin)}},h.prototype.strokeRect=function(S,I,O,N){if(isNaN(S)||isNaN(I)||isNaN(O)||isNaN(N))throw jr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");p.call(this)||(this.beginPath(),this.rect(S,I,O,N),this.stroke())},h.prototype.clearRect=function(S,I,O,N){if(isNaN(S)||isNaN(I)||isNaN(O)||isNaN(N))throw jr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(S,I,O,N))},h.prototype.save=function(S){S=typeof S!="boolean"||S;for(var I=this.pdf.internal.getCurrentPageInfo().pageNumber,O=0;O<this.pdf.internal.getNumberOfPages();O++)this.pdf.setPage(O+1),this.pdf.internal.out("q");if(this.pdf.setPage(I),S){this.ctx.fontSize=this.pdf.internal.getFontSize();var N=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=N}},h.prototype.restore=function(S){S=typeof S!="boolean"||S;for(var I=this.pdf.internal.getCurrentPageInfo().pageNumber,O=0;O<this.pdf.internal.getNumberOfPages();O++)this.pdf.setPage(O+1),this.pdf.internal.out("Q");this.pdf.setPage(I),S&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var d=function(S){var I,O,N,R;if(S.isCanvasGradient===!0&&(S=S.getColor()),!S)return{r:0,g:0,b:0,a:0,style:S};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(S))I=0,O=0,N=0,R=0;else{var z=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(S);if(z!==null)I=parseInt(z[1]),O=parseInt(z[2]),N=parseInt(z[3]),R=1;else if((z=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(S))!==null)I=parseInt(z[1]),O=parseInt(z[2]),N=parseInt(z[3]),R=parseFloat(z[4]);else{if(R=1,typeof S=="string"&&S.charAt(0)!=="#"){var K=new Y3(S);S=K.ok?K.toHex():"#000000"}S.length===4?(I=S.substring(1,2),I+=I,O=S.substring(2,3),O+=O,N=S.substring(3,4),N+=N):(I=S.substring(1,3),O=S.substring(3,5),N=S.substring(5,7)),I=parseInt(I,16),O=parseInt(O,16),N=parseInt(N,16)}}return{r:I,g:O,b:N,a:R,style:S}},u=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},p=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(S,I,O,N){if(isNaN(I)||isNaN(O)||typeof S!="string")throw jr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(N=isNaN(N)?void 0:N,!u.call(this)){var R=J(this.ctx.transform.rotation),z=this.ctx.transform.scaleX;L.call(this,{text:S,x:I,y:O,scale:z,angle:R,align:this.textAlign,maxWidth:N})}},h.prototype.strokeText=function(S,I,O,N){if(isNaN(I)||isNaN(O)||typeof S!="string")throw jr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!p.call(this)){N=isNaN(N)?void 0:N;var R=J(this.ctx.transform.rotation),z=this.ctx.transform.scaleX;L.call(this,{text:S,x:I,y:O,scale:z,renderingMode:"stroke",angle:R,align:this.textAlign,maxWidth:N})}},h.prototype.measureText=function(S){if(typeof S!="string")throw jr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var I=this.pdf,O=this.pdf.internal.scaleFactor,N=I.internal.getFontSize(),R=I.getStringUnitWidth(S)*N/I.internal.scaleFactor;return new function(z){var K=(z=z||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return K}}),this}({width:R*=Math.round(96*O/72*1e4)/1e4})},h.prototype.scale=function(S,I){if(isNaN(S)||isNaN(I))throw jr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var O=new a(S,0,0,I,0,0);this.ctx.transform=this.ctx.transform.multiply(O)},h.prototype.rotate=function(S){if(isNaN(S))throw jr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var I=new a(Math.cos(S),Math.sin(S),-Math.sin(S),Math.cos(S),0,0);this.ctx.transform=this.ctx.transform.multiply(I)},h.prototype.translate=function(S,I){if(isNaN(S)||isNaN(I))throw jr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var O=new a(1,0,0,1,S,I);this.ctx.transform=this.ctx.transform.multiply(O)},h.prototype.transform=function(S,I,O,N,R,z){if(isNaN(S)||isNaN(I)||isNaN(O)||isNaN(N)||isNaN(R)||isNaN(z))throw jr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var K=new a(S,I,O,N,R,z);this.ctx.transform=this.ctx.transform.multiply(K)},h.prototype.setTransform=function(S,I,O,N,R,z){S=isNaN(S)?1:S,I=isNaN(I)?0:I,O=isNaN(O)?0:O,N=isNaN(N)?1:N,R=isNaN(R)?0:R,z=isNaN(z)?0:z,this.ctx.transform=new a(S,I,O,N,R,z)};var m=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(S,I,O,N,R,z,K,Y,Z){var se=this.pdf.getImageProperties(S),V=1,le=1,ae=1,W=1;N!==void 0&&Y!==void 0&&(ae=Y/N,W=Z/R,V=se.width/N*Y/N,le=se.height/R*Z/R),z===void 0&&(z=I,K=O,I=0,O=0),N!==void 0&&Y===void 0&&(Y=N,Z=R),N===void 0&&Y===void 0&&(Y=se.width,Z=se.height);var he=this.ctx.transform.decompose(),fe=J(he.rotate.shx),Te=new a,be=(Te=(Te=(Te=Te.multiply(he.translate)).multiply(he.skew)).multiply(he.scale)).applyToRectangle(new o(z-I*ae,K-O*W,N*V,R*le));if(this.autoPaging){for(var pe,xe=g.call(this,be),ce=[],Ne=0;Ne<xe.length;Ne+=1)ce.indexOf(xe[Ne])===-1&&ce.push(xe[Ne]);w(ce);for(var Ie=ce[0],Re=ce[ce.length-1],De=Ie;De<Re+1;De++){this.pdf.setPage(De);var Me=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ge=De===1?this.posY+this.margin[0]:this.margin[0],Ae=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Pe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ue=De===1?0:Ae+(De-2)*Pe;if(this.ctx.clip_path.length!==0){var Ye=this.path;pe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(pe,this.posX+this.margin[3],-Ue+Ge+this.ctx.prevPageLastElemOffset),C.call(this,"fill",!0),this.path=Ye}var nt=JSON.parse(JSON.stringify(be));nt=y([nt],this.posX+this.margin[3],-Ue+Ge+this.ctx.prevPageLastElemOffset)[0];var Qe=(De>Ie||De<Re)&&m.call(this);Qe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Me,Pe,null).clip().discardPath()),this.pdf.addImage(S,"JPEG",nt.x,nt.y,nt.w,nt.h,null,null,fe),Qe&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(S,"JPEG",be.x,be.y,be.w,be.h,null,null,fe)};var g=function(S,I,O){var N=[];I=I||this.pdf.internal.pageSize.width,O=O||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var R=this.posY+this.ctx.prevPageLastElemOffset;switch(S.type){default:case"mt":case"lt":N.push(Math.floor((S.y+R)/O)+1);break;case"arc":N.push(Math.floor((S.y+R-S.radius)/O)+1),N.push(Math.floor((S.y+R+S.radius)/O)+1);break;case"qct":var z=P(this.ctx.lastPoint.x,this.ctx.lastPoint.y,S.x1,S.y1,S.x,S.y);N.push(Math.floor((z.y+R)/O)+1),N.push(Math.floor((z.y+z.h+R)/O)+1);break;case"bct":var K=H(this.ctx.lastPoint.x,this.ctx.lastPoint.y,S.x1,S.y1,S.x2,S.y2,S.x,S.y);N.push(Math.floor((K.y+R)/O)+1),N.push(Math.floor((K.y+K.h+R)/O)+1);break;case"rect":N.push(Math.floor((S.y+R)/O)+1),N.push(Math.floor((S.y+S.h+R)/O)+1)}for(var Y=0;Y<N.length;Y+=1)for(;this.pdf.internal.getNumberOfPages()<N[Y];)x.call(this);return N},x=function(){var S=this.fillStyle,I=this.strokeStyle,O=this.font,N=this.lineCap,R=this.lineWidth,z=this.lineJoin;this.pdf.addPage(),this.fillStyle=S,this.strokeStyle=I,this.font=O,this.lineCap=N,this.lineWidth=R,this.lineJoin=z},y=function(S,I,O){for(var N=0;N<S.length;N++)switch(S[N].type){case"bct":S[N].x2+=I,S[N].y2+=O;case"qct":S[N].x1+=I,S[N].y1+=O;default:S[N].x+=I,S[N].y+=O}return S},w=function(S){return S.sort(function(I,O){return I-O})},_=function(S,I){var O=this.fillStyle,N=this.strokeStyle,R=this.lineCap,z=this.lineWidth,K=Math.abs(z*this.ctx.transform.scaleX),Y=this.lineJoin;if(this.autoPaging){for(var Z,se,V=JSON.parse(JSON.stringify(this.path)),le=JSON.parse(JSON.stringify(this.path)),ae=[],W=0;W<le.length;W++)if(le[W].x!==void 0)for(var he=g.call(this,le[W]),fe=0;fe<he.length;fe+=1)ae.indexOf(he[fe])===-1&&ae.push(he[fe]);for(var Te=0;Te<ae.length;Te++)for(;this.pdf.internal.getNumberOfPages()<ae[Te];)x.call(this);w(ae);for(var be=ae[0],pe=ae[ae.length-1],xe=be;xe<pe+1;xe++){this.pdf.setPage(xe),this.fillStyle=O,this.strokeStyle=N,this.lineCap=R,this.lineWidth=K,this.lineJoin=Y;var ce=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ne=xe===1?this.posY+this.margin[0]:this.margin[0],Ie=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Re=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],De=xe===1?0:Ie+(xe-2)*Re;if(this.ctx.clip_path.length!==0){var Me=this.path;Z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(Z,this.posX+this.margin[3],-De+Ne+this.ctx.prevPageLastElemOffset),C.call(this,S,!0),this.path=Me}if(se=JSON.parse(JSON.stringify(V)),this.path=y(se,this.posX+this.margin[3],-De+Ne+this.ctx.prevPageLastElemOffset),I===!1||xe===0){var Ge=(xe>be||xe<pe)&&m.call(this);Ge&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ce,Re,null).clip().discardPath()),C.call(this,S,I),Ge&&this.pdf.restoreGraphicsState()}this.lineWidth=z}this.path=V}else this.lineWidth=K,C.call(this,S,I),this.lineWidth=z},C=function(S,I){if((S!=="stroke"||I||!p.call(this))&&(S==="stroke"||I||!u.call(this))){for(var O,N,R=[],z=this.path,K=0;K<z.length;K++){var Y=z[K];switch(Y.type){case"begin":R.push({begin:!0});break;case"close":R.push({close:!0});break;case"mt":R.push({start:Y,deltas:[],abs:[]});break;case"lt":var Z=R.length;if(z[K-1]&&!isNaN(z[K-1].x)&&(O=[Y.x-z[K-1].x,Y.y-z[K-1].y],Z>0)){for(;Z>=0;Z--)if(R[Z-1].close!==!0&&R[Z-1].begin!==!0){R[Z-1].deltas.push(O),R[Z-1].abs.push(Y);break}}break;case"bct":O=[Y.x1-z[K-1].x,Y.y1-z[K-1].y,Y.x2-z[K-1].x,Y.y2-z[K-1].y,Y.x-z[K-1].x,Y.y-z[K-1].y],R[R.length-1].deltas.push(O);break;case"qct":var se=z[K-1].x+2/3*(Y.x1-z[K-1].x),V=z[K-1].y+2/3*(Y.y1-z[K-1].y),le=Y.x+2/3*(Y.x1-Y.x),ae=Y.y+2/3*(Y.y1-Y.y),W=Y.x,he=Y.y;O=[se-z[K-1].x,V-z[K-1].y,le-z[K-1].x,ae-z[K-1].y,W-z[K-1].x,he-z[K-1].y],R[R.length-1].deltas.push(O);break;case"arc":R.push({deltas:[],abs:[],arc:!0}),Array.isArray(R[R.length-1].abs)&&R[R.length-1].abs.push(Y)}}N=I?null:S==="stroke"?"stroke":"fill";for(var fe=!1,Te=0;Te<R.length;Te++)if(R[Te].arc)for(var be=R[Te].abs,pe=0;pe<be.length;pe++){var xe=be[pe];xe.type==="arc"?A.call(this,xe.x,xe.y,xe.radius,xe.startAngle,xe.endAngle,xe.counterclockwise,void 0,I,!fe):G.call(this,xe.x,xe.y),fe=!0}else if(R[Te].close===!0)this.pdf.internal.out("h"),fe=!1;else if(R[Te].begin!==!0){var ce=R[Te].start.x,Ne=R[Te].start.y;X.call(this,R[Te].deltas,ce,Ne),fe=!0}N&&j.call(this,N),I&&B.call(this)}},E=function(S){var I=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,O=I*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return S-O;case"top":return S+I-O;case"hanging":return S+I-2*O;case"middle":return S+I/2-O;default:return S}},T=function(S){return S+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var S=function(){};return S.colorStops=[],S.addColorStop=function(I,O){this.colorStops.push([I,O])},S.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},S.isCanvasGradient=!0,S},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var A=function(S,I,O,N,R,z,K,Y,Z){for(var se=Q.call(this,O,N,R,z),V=0;V<se.length;V++){var le=se[V];V===0&&(Z?F.call(this,le.x1+S,le.y1+I):G.call(this,le.x1+S,le.y1+I)),re.call(this,S,I,le.x2,le.y2,le.x3,le.y3,le.x4,le.y4)}Y?B.call(this):j.call(this,K)},j=function(S){switch(S){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},B=function(){this.pdf.clip(),this.pdf.discardPath()},F=function(S,I){this.pdf.internal.out(r(S)+" "+n(I)+" m")},L=function(S){var I;switch(S.align){case"right":case"end":I="right";break;case"center":I="center";break;default:I="left"}var O,N,R,z=this.pdf.getTextDimensions(S.text),K=E.call(this,S.y),Y=T.call(this,K)-z.h,Z=this.ctx.transform.applyToPoint(new l(S.x,K));if(this.autoPaging){var se=this.ctx.transform.decompose(),V=new a;V=(V=(V=V.multiply(se.translate)).multiply(se.skew)).multiply(se.scale);for(var le=this.ctx.transform.applyToRectangle(new o(S.x,K,z.w,z.h)),ae=V.applyToRectangle(new o(S.x,Y,z.w,z.h)),W=g.call(this,ae),he=[],fe=0;fe<W.length;fe+=1)he.indexOf(W[fe])===-1&&he.push(W[fe]);w(he);for(var Te=he[0],be=he[he.length-1],pe=Te;pe<be+1;pe++){this.pdf.setPage(pe);var xe=pe===1?this.posY+this.margin[0]:this.margin[0],ce=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ne=this.pdf.internal.pageSize.height-this.margin[2],Ie=Ne-this.margin[0],Re=this.pdf.internal.pageSize.width-this.margin[1],De=Re-this.margin[3],Me=pe===1?0:ce+(pe-2)*Ie;if(this.ctx.clip_path.length!==0){var Ge=this.path;O=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(O,this.posX+this.margin[3],-1*Me+xe),C.call(this,"fill",!0),this.path=Ge}var Ae=y([JSON.parse(JSON.stringify(ae))],this.posX+this.margin[3],-Me+xe+this.ctx.prevPageLastElemOffset)[0];S.scale>=.01&&(N=this.pdf.internal.getFontSize(),this.pdf.setFontSize(N*S.scale),R=this.lineWidth,this.lineWidth=R*S.scale);var Pe=this.autoPaging!=="text";if(Pe||Ae.y+Ae.h<=Ne){if(Pe||Ae.y>=xe&&Ae.x<=Re){var Ue=Pe?S.text:this.pdf.splitTextToSize(S.text,S.maxWidth||Re-Ae.x)[0],Ye=y([JSON.parse(JSON.stringify(le))],this.posX+this.margin[3],-Me+xe+this.ctx.prevPageLastElemOffset)[0],nt=Pe&&(pe>Te||pe<be)&&m.call(this);nt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],De,Ie,null).clip().discardPath()),this.pdf.text(Ue,Ye.x,Ye.y,{angle:S.angle,align:I,renderingMode:S.renderingMode}),nt&&this.pdf.restoreGraphicsState()}}else Ae.y<Ne&&(this.ctx.prevPageLastElemOffset+=Ne-Ae.y);S.scale>=.01&&(this.pdf.setFontSize(N),this.lineWidth=R)}}else S.scale>=.01&&(N=this.pdf.internal.getFontSize(),this.pdf.setFontSize(N*S.scale),R=this.lineWidth,this.lineWidth=R*S.scale),this.pdf.text(S.text,Z.x+this.posX,Z.y+this.posY,{angle:S.angle,align:I,renderingMode:S.renderingMode,maxWidth:S.maxWidth}),S.scale>=.01&&(this.pdf.setFontSize(N),this.lineWidth=R)},G=function(S,I,O,N){O=O||0,N=N||0,this.pdf.internal.out(r(S+O)+" "+n(I+N)+" l")},X=function(S,I,O){return this.pdf.lines(S,I,O,null,null)},re=function(S,I,O,N,R,z,K,Y){this.pdf.internal.out([t(i(O+S)),t(s(N+I)),t(i(R+S)),t(s(z+I)),t(i(K+S)),t(s(Y+I)),"c"].join(" "))},Q=function(S,I,O,N){for(var R=2*Math.PI,z=Math.PI/2;I>O;)I-=R;var K=Math.abs(O-I);K<R&&N&&(K=R-K);for(var Y=[],Z=N?-1:1,se=I;K>1e-5;){var V=se+Z*Math.min(K,z);Y.push(ne.call(this,S,se,V)),K-=Math.abs(V-se),se=V}return Y},ne=function(S,I,O){var N=(O-I)/2,R=S*Math.cos(N),z=S*Math.sin(N),K=R,Y=-z,Z=K*K+Y*Y,se=Z+K*R+Y*z,V=4/3*(Math.sqrt(2*Z*se)-se)/(K*z-Y*R),le=K-V*Y,ae=Y+V*K,W=le,he=-ae,fe=N+I,Te=Math.cos(fe),be=Math.sin(fe);return{x1:S*Math.cos(I),y1:S*Math.sin(I),x2:le*Te-ae*be,y2:le*be+ae*Te,x3:W*Te-he*be,y3:W*be+he*Te,x4:S*Math.cos(O),y4:S*Math.sin(O)}},J=function(S){return 180*S/Math.PI},P=function(S,I,O,N,R,z){var K=S+.5*(O-S),Y=I+.5*(N-I),Z=R+.5*(O-R),se=z+.5*(N-z),V=Math.min(S,R,K,Z),le=Math.max(S,R,K,Z),ae=Math.min(I,z,Y,se),W=Math.max(I,z,Y,se);return new o(V,ae,le-V,W-ae)},H=function(S,I,O,N,R,z,K,Y){var Z,se,V,le,ae,W,he,fe,Te,be,pe,xe,ce,Ne,Ie=O-S,Re=N-I,De=R-O,Me=z-N,Ge=K-R,Ae=Y-z;for(se=0;se<41;se++)Te=(he=(V=S+(Z=se/40)*Ie)+Z*((ae=O+Z*De)-V))+Z*(ae+Z*(R+Z*Ge-ae)-he),be=(fe=(le=I+Z*Re)+Z*((W=N+Z*Me)-le))+Z*(W+Z*(z+Z*Ae-W)-fe),se==0?(pe=Te,xe=be,ce=Te,Ne=be):(pe=Math.min(pe,Te),xe=Math.min(xe,be),ce=Math.max(ce,Te),Ne=Math.max(Ne,be));return new o(Math.round(pe),Math.round(xe),Math.round(ce-pe),Math.round(Ne-xe))},U=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var S,I,O=(S=this.ctx.lineDash,I=this.ctx.lineDashOffset,JSON.stringify({lineDash:S,lineDashOffset:I}));this.prevLineDash!==O&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=O)}}})(Lt.API),function(e){var t=function(l){var o,a,c,f,h,d,u,p,m,g;for(a=[],c=0,f=(l+=o="\0\0\0\0".slice(l.length%4||4)).length;f>c;c+=4)(h=(l.charCodeAt(c)<<24)+(l.charCodeAt(c+1)<<16)+(l.charCodeAt(c+2)<<8)+l.charCodeAt(c+3))!==0?(d=(h=((h=((h=((h=(h-(g=h%85))/85)-(m=h%85))/85)-(p=h%85))/85)-(u=h%85))/85)%85,a.push(d+33,u+33,p+33,m+33,g+33)):a.push(122);return function(x,y){for(var w=y;w>0;w--)x.pop()}(a,o.length),String.fromCharCode.apply(String,a)+"~>"},r=function(l){var o,a,c,f,h,d=String,u="length",p=255,m="charCodeAt",g="slice",x="replace";for(l[g](-2),l=l[g](0,-2)[x](/\s/g,"")[x]("z","!!!!!"),c=[],f=0,h=(l+=o="uuuuu"[g](l[u]%5||5))[u];h>f;f+=5)a=52200625*(l[m](f)-33)+614125*(l[m](f+1)-33)+7225*(l[m](f+2)-33)+85*(l[m](f+3)-33)+(l[m](f+4)-33),c.push(p&a>>24,p&a>>16,p&a>>8,p&a);return function(y,w){for(var _=w;_>0;_--)y.pop()}(c,o[u]),d.fromCharCode.apply(d,c)},n=function(l){return l.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(l){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((l=l.replace(/\s/g,"")).indexOf(">")!==-1&&(l=l.substr(0,l.indexOf(">"))),l.length%2&&(l+="0"),o.test(l)===!1)return"";for(var a="",c=0;c<l.length;c+=2)a+=String.fromCharCode("0x"+(l[c]+l[c+1]));return a},s=function(l){for(var o=new Uint8Array(l.length),a=l.length;a--;)o[a]=l.charCodeAt(a);return(o=_v(o)).reduce(function(c,f){return c+String.fromCharCode(f)},"")};e.processDataByFilters=function(l,o){var a=0,c=l||"",f=[];for(typeof(o=o||[])=="string"&&(o=[o]),a=0;a<o.length;a+=1)switch(o[a]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=t(c),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=i(c),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=n(c),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=s(c),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[a]+'" is not implemented')}return{data:c,reverseChain:f.reverse().join(" ")}}}(Lt.API),function(e){e.loadFile=function(t,r,n){return function(i,s,l){s=s!==!1,l=typeof l=="function"?l:function(){};var o=void 0;try{o=function(a,c,f){var h=new XMLHttpRequest,d=0,u=function(p){var m=p.length,g=[],x=String.fromCharCode;for(d=0;d<m;d+=1)g.push(x(255&p.charCodeAt(d)));return g.join("")};if(h.open("GET",a,!c),h.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(h.onload=function(){h.status===200?f(u(this.responseText)):f(void 0)}),h.send(null),c&&h.status===200)return u(h.responseText)}(i,s,l)}catch{}return o}(t,r,n)},e.allowFsRead=void 0,e.loadImageFile=e.loadFile}(Lt.API),function(e){function t(){return(qt.html2canvas?Promise.resolve(qt.html2canvas):Am(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(qt.DOMPurify?Promise.resolve(qt.DOMPurify):Am(()=>import("./purify.es-B9ZVCkUG.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var a=Er(o);return a==="undefined"?"undefined":a==="string"||o instanceof String?"string":a==="number"||o instanceof Number?"number":a==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":a==="object"?"object":"unknown"},i=function(o,a){var c=document.createElement(o);for(var f in a.className&&(c.className=a.className),a.innerHTML&&a.dompurify&&(c.innerHTML=a.dompurify.sanitize(a.innerHTML)),a.style)c.style[f]=a.style[f];return c},s=function o(a,c){for(var f=a.nodeType===3?document.createTextNode(a.nodeValue):a.cloneNode(!1),h=a.firstChild;h;h=h.nextSibling)c!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||f.appendChild(o(h,c));return a.nodeType===1&&(a.nodeName==="CANVAS"?(f.width=a.width,f.height=a.height,f.getContext("2d").drawImage(a,0,0)):a.nodeName!=="TEXTAREA"&&a.nodeName!=="SELECT"||(f.value=a.value),f.addEventListener("load",function(){f.scrollTop=a.scrollTop,f.scrollLeft=a.scrollLeft},!0)),f},l=function o(a){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),f=o.convert(Promise.resolve(),c);return(f=f.setProgress(1,o,1,[o])).set(a)};(l.prototype=Object.create(Promise.prototype)).constructor=l,l.convert=function(o,a){return o.__proto__=a||l.prototype,o},l.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},l.prototype.from=function(o,a){return this.then(function(){switch(a=a||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o),a){case"string":return this.then(r).then(function(c){return this.set({src:i("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},l.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},l.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},a=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);a.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(a),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},l.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(a){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,a(this.prop.container,c)}).then(function(a){(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},l.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(a){var c=this.opt.jsPDF,f=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,d=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete d.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=f,f)for(var u=0;u<f.length;++u){var p=f[u],m=p.src.find(function(g){return g.format==="truetype"});m&&c.addFont(m.url,p.ref.name,p.ref.style)}return d.windowHeight=d.windowHeight||0,d.windowHeight=d.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):d.windowHeight,c.context2d.save(!0),a(this.prop.container,d)}).then(function(a){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},l.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},l.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},l.prototype.output=function(o,a,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,a):this.outputPdf(o,a)},l.prototype.outputPdf=function(o,a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,a)})},l.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},l.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},l.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},l.prototype.set=function(o){if(n(o)!=="object")return this;var a=Object.keys(o||{}).map(function(c){if(c in l.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(a)})},l.prototype.get=function(o,a){return this.then(function(){var c=o in l.template.prop?this.prop[o]:this.opt[o];return a?a(c):c})},l.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},l.prototype.setPageSize=function(o){function a(c,f){return Math.floor(c*f/72*96)}return this.then(function(){(o=o||Lt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:a(o.inner.width,o.k),height:a(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},l.prototype.setProgress=function(o,a,c,f){return o!=null&&(this.progress.val=o),a!=null&&(this.progress.state=a),c!=null&&(this.progress.n=c),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},l.prototype.updateProgress=function(o,a,c,f){return this.setProgress(o?this.progress.val+o:null,a||null,c?this.progress.n+c:null,f?this.progress.stack.concat(f):null)},l.prototype.then=function(o,a){var c=this;return this.thenCore(o,a,function(f,h){return c.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(d){return c.updateProgress(null,f),d}).then(f,h).then(function(d){return c.updateProgress(1),d})})},l.prototype.thenCore=function(o,a,c){c=c||Promise.prototype.then;var f=this;o&&(o=o.bind(f)),a&&(a=a.bind(f));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:l.convert(Object.assign({},f),Promise.prototype),d=c.call(h,o,a);return l.convert(d,f.__proto__)},l.prototype.thenExternal=function(o,a){return Promise.prototype.then.call(this,o,a)},l.prototype.thenList=function(o){var a=this;return o.forEach(function(c){a=a.thenCore(c)}),a},l.prototype.catch=function(o){o&&(o=o.bind(this));var a=Promise.prototype.catch.call(this,o);return l.convert(a,this)},l.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},l.prototype.error=function(o){return this.then(function(){throw new Error(o)})},l.prototype.using=l.prototype.set,l.prototype.saveAs=l.prototype.save,l.prototype.export=l.prototype.output,l.prototype.run=l.prototype.then,Lt.getPageSize=function(o,a,c){if(Er(o)==="object"){var f=o;o=f.orientation,a=f.unit||a,c=f.format||c}a=a||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var h,d=(""+c).toLowerCase(),u={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(a){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+a}var p,m=0,g=0;if(u.hasOwnProperty(d))m=u[d][1]/h,g=u[d][0]/h;else try{m=c[1],g=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",g>m&&(p=g,g=m,m=p);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",m>g&&(p=g,g=m,m=p)}return{width:g,height:m,unit:a,k:h,orientation:o}},e.html=function(o,a){(a=a||{}).callback=a.callback||function(){},a.html2canvas=a.html2canvas||{},a.html2canvas.canvas=a.html2canvas.canvas||this.canvas,a.jsPDF=a.jsPDF||this,a.fontFaces=a.fontFaces?a.fontFaces.map(Gm):null;var c=new l(a);return a.worker?c:c.from(o).doCallback()}}(Lt.API),Lt.API.addJS=function(e){return u5=e,this.internal.events.subscribe("postPutResources",function(){sp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(sp+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),c5=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+u5+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){sp!==void 0&&c5!==void 0&&this.internal.out("/Names <</JavaScript "+sp+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),s=0;s<i.length;s++){var l=i[s],o=n.exec(l);if(o!=null){var a=o[1];r.internal.newObjectDeferredBegin(a,!1)}r.internal.write(l)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,f=[];for(s=0;s<c;s++){var h=r.internal.newObject();f.push(h);var d=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+d.objId+" 0 R /XYZ null null null]>> endobj")}var u=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<f.length;s++)r.internal.write("(page_"+(s+1)+")"+f[s]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+u+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,s){var l={title:i,options:s,children:[]};return n==null&&(n=this.root),n.children.push(l),l},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var l=n.children[s];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var o=this.count=this.count_r({count:0},l);if(o>0&&this.line("/Count "+o),l.options&&l.options.pageNumber){var a=r.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+a.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var c=0;c<n.children.length;c++)this.renderItems(n.children[c])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var s=0;s<i.children.length;s++)n.count++,this.count_r(n,i.children[s]);return n.count}}])}(Lt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,i,s,l,o){var a,c=this.decode.DCT_DECODE,f=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=l||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,a=function(h){for(var d,u=256*h.charCodeAt(4)+h.charCodeAt(5),p=h.length,m={width:0,height:0,numcomponents:1},g=4;g<p;g+=2){if(g+=u,t.indexOf(h.charCodeAt(g+1))!==-1){d=256*h.charCodeAt(g+5)+h.charCodeAt(g+6),m={width:256*h.charCodeAt(g+7)+h.charCodeAt(g+8),height:d,numcomponents:h.charCodeAt(g+9)};break}u=256*h.charCodeAt(g+2)+h.charCodeAt(g+3)}return m}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),a.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}f={data:r,width:a.width,height:a.height,colorSpace:o,bitsPerComponent:8,filter:c,index:n,alias:i}}return f}}(Lt.API),Lt.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var i,s=xL(e,{checkCrc:!0}),l=s.width,o=s.height,a=s.channels,c=s.palette,f=s.depth;i=c&&a===1?function(A){for(var j=A.width,B=A.height,F=A.data,L=A.palette,G=A.depth,X=!1,re=[],Q=[],ne=void 0,J=!1,P=0,H=0;H<L.length;H++){var U=pb(L[H],4),S=U[0],I=U[1],O=U[2],N=U[3];re.push(S,I,O),N!=null&&(N===0?(P++,Q.length<1&&Q.push(H)):N<255&&(J=!0))}if(J||P>1){X=!0,Q=void 0;var R=j*B;ne=new Uint8Array(R);for(var z=new DataView(F.buffer),K=0;K<R;K++){var Y=Ym(z,K,G),Z=pb(L[Y],4)[3];ne[K]=Z}}else P===0&&(Q=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:X?8:void 0,colorBytes:F,alphaBytes:ne,needSMask:X,palette:re,mask:Q}}(s):a===2||a===4?function(A){for(var j=A.data,B=A.width,F=A.height,L=A.channels,G=A.depth,X=L===2?"DeviceGray":"DeviceRGB",re=L-1,Q=B*F,ne=re,J=Q*ne,P=1*Q,H=Math.ceil(J*G/8),U=Math.ceil(P*G/8),S=new Uint8Array(H),I=new Uint8Array(U),O=new DataView(j.buffer),N=new DataView(S.buffer),R=new DataView(I.buffer),z=!1,K=0;K<Q;K++){for(var Y=K*L,Z=0;Z<ne;Z++)y5(N,Ym(O,Y+Z,G),K*ne+Z,G);var se=Ym(O,Y+ne,G);se<(1<<G)-1&&(z=!0),y5(R,se,1*K,G)}return{colorSpace:X,colorsPerPixel:re,sMaskBitsPerComponent:z?G:void 0,colorBytes:S,alphaBytes:I,needSMask:z}}(s):function(A){var j=A.data,B=A.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:B,colorsPerPixel:B==="DeviceGray"?1:3,colorBytes:j instanceof Uint16Array?function(F){for(var L=F.length,G=new Uint8Array(2*L),X=new DataView(G.buffer,G.byteOffset,G.byteLength),re=0;re<L;re++)X.setUint16(2*re,F[re],!1);return G}(j):j,needSMask:!1}}(s);var h,d,u,p=i,m=p.colorSpace,g=p.colorsPerPixel,x=p.sMaskBitsPerComponent,y=p.colorBytes,w=p.alphaBytes,_=p.needSMask,C=p.palette,E=p.mask,T=null;return n!==Lt.API.image_compression.NONE&&typeof _v=="function"?(T=function(A){var j;switch(A){case Lt.API.image_compression.FAST:j=11;break;case Lt.API.image_compression.MEDIUM:j=13;break;case Lt.API.image_compression.SLOW:j=14;break;default:j=12}return j}(n),h=this.decode.FLATE_DECODE,d="/Predictor ".concat(T," /Colors ").concat(g," /BitsPerComponent ").concat(f," /Columns ").concat(l),e=p5(y,Math.ceil(l*g*f/8),g,f,n),_&&(u=p5(w,Math.ceil(l*x/8),1,x,n))):(h=void 0,d=void 0,e=y,_&&(u=w)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(u&&this.__addimage__.isArrayBuffer(u)||this.__addimage__.isArrayBufferView(u))&&(u=this.__addimage__.arrayBufferToBinaryString(u)),{alias:r,data:e,index:t,filter:h,decodeParameters:d,transparency:E,palette:C,sMask:u,predictor:T,width:l,height:o,bitsPerComponent:f,sMaskBitsPerComponent:x,colorSpace:m}}},function(e){e.processGIF89A=function(t,r,n,i){var s=new ML(t),l=s.width,o=s.height,a=[];s.decodeAndBlitFrameRGBA(0,a);var c={data:a,width:l,height:o},f=new Km(100).encode(c,100);return e.processJPEG.call(this,f,r,n,i)},e.processGIF87A=e.processGIF89A}(Lt.API),la.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},la.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){jr.log("bit decode error:"+r)}},la.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<t;i++)for(var s=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var a=this.palette[s>>7-o&1];this.data[l+4*o]=a.blue,this.data[l+4*o+1]=a.green,this.data[l+4*o+2]=a.red,this.data[l+4*o+3]=255}r!==0&&(this.pos+=4-r)}},la.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<e;i++){var s=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+2*i*4,o=s>>4,a=15&s,c=this.palette[o];if(this.data[l]=c.blue,this.data[l+1]=c.green,this.data[l+2]=c.red,this.data[l+3]=255,2*i+1>=this.width)break;c=this.palette[a],this.data[l+4]=c.blue,this.data[l+4+1]=c.green,this.data[l+4+2]=c.red,this.data[l+4+3]=255}t!==0&&(this.pos+=4-t)}},la.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(i<this.palette.length){var l=this.palette[i];this.data[s]=l.red,this.data[s+1]=l.green,this.data[s+2]=l.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},la.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(s&t)/t*255|0,o=(s>>5&t)/t*255|0,a=(s>>10&t)/t*255|0,c=s>>15?255:0,f=n*this.width*4+4*i;this.data[f]=a,this.data[f+1]=o,this.data[f+2]=l,this.data[f+3]=c}this.pos+=e}},la.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(l&t)/t*255|0,a=(l>>5&r)/r*255|0,c=(l>>11)/t*255|0,f=i*this.width*4+4*s;this.data[f]=c,this.data[f+1]=a,this.data[f+2]=o,this.data[f+3]=255}this.pos+=e}},la.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=s,this.data[l+1]=i,this.data[l+2]=n,this.data[l+3]=255}this.pos+=this.width%4}},la.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=l}},la.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,i){var s=new la(t,!1),l=s.width,o=s.height,a={data:s.getData(),width:l,height:o},c=new Km(100).encode(a,100);return e.processJPEG.call(this,c,r,n,i)}}(Lt.API),_5.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,i){var s=new _5(t),l=s.width,o=s.height,a={data:s.getData(),width:l,height:o},c=new Km(100).encode(a,100);return e.processJPEG.call(this,c,r,n,i)}}(Lt.API),Lt.API.processRGBA=function(e,t,r){for(var n=e.data,i=n.length,s=new Uint8Array(i/4*3),l=new Uint8Array(i/4),o=0,a=0,c=0;c<i;c+=4){var f=n[c],h=n[c+1],d=n[c+2],u=n[c+3];s[o++]=f,s[o++]=h,s[o++]=d,l[a++]=u}var p=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:p,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Lt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},_u=Lt.API,ap=_u.getCharWidthsArray=function(e,t){var r,n,i=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),l=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:i.metadata.Unicode.widths,a=o.fof?o.fof:1,c=t.kerning?t.kerning:i.metadata.Unicode.kerning,f=c.fof?c.fof:1,h=t.doKerning!==!1,d=0,u=e.length,p=0,m=o[0]||a,g=[];for(r=0;r<u;r++)n=e.charCodeAt(r),typeof i.metadata.widthOfString=="function"?g.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+l*(1e3/s)||0)/1e3):(d=h&&Er(c[n])==="object"&&!isNaN(parseInt(c[n][p],10))?c[n][p]/f:0,g.push((o[n]||m)/a+d)),p=n;return g},f5=_u.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return _u.processArabic&&(e=_u.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,i)/r:ap.apply(this,arguments).reduce(function(s,l){return s+l},0)},h5=function(e,t,r,n){for(var i=[],s=0,l=e.length,o=0;s!==l&&o+t[s]<r;)o+=t[s],s++;i.push(e.slice(0,s));var a=s;for(o=0;s!==l;)o+t[s]>n&&(i.push(e.slice(a,s)),o=0,a=s),o+=t[s],s++;return a!==s&&i.push(e.slice(a,s)),i},d5=function(e,t,r){r||(r={});var n,i,s,l,o,a,c,f=[],h=[f],d=r.textIndent||0,u=0,p=0,m=e.split(" "),g=ap.apply(this,[" ",r])[0];if(a=r.lineIndent===-1?m[0].length+2:r.lineIndent||0){var x=Array(a).join(" "),y=[];m.map(function(_){(_=_.split(/\s*\n/)).length>1?y=y.concat(_.map(function(C,E){return(E&&C.length?`
`:"")+C})):y.push(_[0])}),m=y,a=f5.apply(this,[x,r])}for(s=0,l=m.length;s<l;s++){var w=0;if(n=m[s],a&&n[0]==`
`&&(n=n.substr(1),w=1),d+u+(p=(i=ap.apply(this,[n,r])).reduce(function(_,C){return _+C},0))>t||w){if(p>t){for(o=h5.apply(this,[n,i,t-(d+u),t]),f.push(o.shift()),f=[o.pop()];o.length;)h.push([o.shift()]);p=i.slice(n.length-(f[0]?f[0].length:0)).reduce(function(_,C){return _+C},0)}else f=[n];h.push(f),d=p+a,u=g}else f.push(n),d+=u+p,u=g}return c=a?function(_,C){return(C?x:"")+_.join(" ")}:function(_){return _.join(" ")},h.map(c)},_u.splitTextToSize=function(e,t,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var h=this.internal.getFont(f.fontName,f.fontStyle),d="Unicode";return h.metadata[d]?{widths:h.metadata[d].widths||{0:1},kerning:h.metadata[d].kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var l=1*this.internal.scaleFactor*t/i;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=r.lineIndent;var o,a,c=[];for(o=0,a=n.length;o<a;o++)c=c.concat(d5.apply(this,[n[o],l,s]));return c},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},i={},s=0;s<16;s++)n[r[s]]=t[s],i[t[s]]=r[s];var l=function(d){return"0x"+parseInt(d,10).toString(16)},o=e.__fontmetrics__.compress=function(d){var u,p,m,g,x=["{"];for(var y in d){if(u=d[y],isNaN(parseInt(y,10))?p="'"+y+"'":(y=parseInt(y,10),p=(p=l(y).slice(2)).slice(0,-1)+i[p.slice(-1)]),typeof u=="number")u<0?(m=l(u).slice(3),g="-"):(m=l(u).slice(2),g=""),m=g+m.slice(0,-1)+i[m.slice(-1)];else{if(Er(u)!=="object")throw new Error("Don't know what to do with value type "+Er(u)+".");m=o(u)}x.push(p+m)}return x.push("}"),x.join("")},a=e.__fontmetrics__.uncompress=function(d){if(typeof d!="string")throw new Error("Invalid argument passed to uncompress.");for(var u,p,m,g,x={},y=1,w=x,_=[],C="",E="",T=d.length-1,A=1;A<T;A+=1)(g=d[A])=="'"?u?(m=u.join(""),u=void 0):u=[]:u?u.push(g):g=="{"?(_.push([w,m]),w={},m=void 0):g=="}"?((p=_.pop())[0][p[1]]=w,m=void 0,w=p[0]):g=="-"?y=-1:m===void 0?n.hasOwnProperty(g)?(C+=n[g],m=parseInt(C,16)*y,y=1,C=""):C+=g:n.hasOwnProperty(g)?(E+=n[g],w[m]=parseInt(E,16)*y,y=1,m=void 0,E=""):E+=g;return x},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:a("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},h={Unicode:{"Courier-Oblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":a("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":a("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:a("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:a("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":a("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":a("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(d){var u=d.font,p=h.Unicode[u.postScriptName];p&&(u.metadata.Unicode={},u.metadata.Unicode.widths=p.widths,u.metadata.Unicode.kerning=p.kerning);var m=f.Unicode[u.postScriptName];m&&(u.metadata.Unicode.encoding=m,u.encoding=m.codePages[0])}])}(Lt.API),function(e){var t=function(r){for(var n=r.length,i=new Uint8Array(n),s=0;s<n;s++)i[s]=r.charCodeAt(s);return i};e.API.events.push(["addFont",function(r){var n=void 0,i=r.font,s=r.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(l,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(jp(o)),l.metadata=e.API.TTFFont.open(o),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(i,n)}}])}(Lt),Lt.API.addSvgAsImage=function(e,t,r,n,i,s,l,o){if(isNaN(t)||isNaN(r))throw jr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(i))throw jr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var a=document.createElement("canvas");a.width=n,a.height=i;var c=a.getContext("2d");c.fillStyle="#fff",c.fillRect(0,0,a.width,a.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return(qt.canvg?Promise.resolve(qt.canvg):Am(()=>import("./index.es-T_mrmvOp.js"),[])).catch(function(d){return Promise.reject(new Error("Could not load canvg: "+d))}).then(function(d){return d.default?d.default:d}).then(function(d){return d.fromString(c,e,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(d){return d.render(f)}).then(function(){h.addImage(a.toDataURL("image/jpeg",1),t,r,n,i,l,o)})},Lt.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(t,r);return this},Lt.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,i,s,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(l),a=[],c=0,f=0,h=0;function d(p,m){var g,x=!1;for(g=0;g<p.length;g+=1)p[g]===m&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var u=o.length;for(h=0;h<u;h+=1)r[o[h]].value=r[o[h]].defaultValue,r[o[h]].explicitSet=!1}if(Er(e)==="object"){for(i in e)if(s=e[i],d(o,i)&&s!==void 0){if(r[i].type==="boolean"&&typeof s=="boolean")r[i].value=s;else if(r[i].type==="name"&&d(r[i].valueSet,s))r[i].value=s;else if(r[i].type==="integer"&&Number.isInteger(s))r[i].value=s;else if(r[i].type==="array"){for(c=0;c<s.length;c+=1)if(n=!0,s[c].length===1&&typeof s[c][0]=="number")a.push(String(s[c]-1));else if(s[c].length>1){for(f=0;f<s[c].length;f+=1)typeof s[c][f]!="number"&&(n=!1);n===!0&&a.push([s[c][0]-1,s[c][1]-1].join(" "))}r[i].value="["+a.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var p,m=[];for(p in r)r[p].explicitSet===!0&&(r[p].type==="name"?m.push("/"+p+" /"+r[p].value):m.push("/"+p+" "+r[p].value));m.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+m.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),a=unescape(encodeURIComponent("</x:xmpmeta>")),c=s.length+l.length+o.length+i.length+a.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(i+s+l+o+a),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Lt.API),function(e){var t=e.API,r=t.pdfEscape16=function(s,l){for(var o,a=l.metadata.Unicode.widths,c=["","0","00","000","0000"],f=[""],h=0,d=s.length;h<d;++h){if(o=l.metadata.characterToGlyph(s.charCodeAt(h)),l.metadata.glyIdsUsed.push(o),l.metadata.toUnicode[o]=s.charCodeAt(h),a.indexOf(o)==-1&&(a.push(o),a.push([parseInt(l.metadata.widthOfGlyph(o),10)])),o=="0")return f.join("");o=o.toString(16),f.push(c[4-o.length],o)}return f.join("")},n=function(s){var l,o,a,c,f,h,d;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,a=[],h=0,d=(o=Object.keys(s).sort(function(u,p){return u-p})).length;h<d;h++)l=o[h],a.length>=100&&(f+=`
`+a.length+` beginbfchar
`+a.join(`
`)+`
endbfchar`,a=[]),s[l]!==void 0&&s[l]!==null&&typeof s[l].toString=="function"&&(c=("0000"+s[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),a.push("<"+l+"><"+c+">"));return a.length&&(f+=`
`+a.length+` beginbfchar
`+a.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(l){var o=l.font,a=l.out,c=l.newObject,f=l.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var h=o.metadata.Unicode.widths,d=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),u="",p=0;p<d.length;p++)u+=String.fromCharCode(d[p]);var m=c();f({data:u,addLength1:!0,objectId:m}),a("endobj");var g=c();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:g}),a("endobj");var x=c();a("<<"),a("/Type /FontDescriptor"),a("/FontName /"+Ou(o.fontName)),a("/FontFile2 "+m+" 0 R"),a("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),a("/Flags "+o.metadata.flags),a("/StemV "+o.metadata.stemV),a("/ItalicAngle "+o.metadata.italicAngle),a("/Ascent "+o.metadata.ascender),a("/Descent "+o.metadata.decender),a("/CapHeight "+o.metadata.capHeight),a(">>"),a("endobj");var y=c();a("<<"),a("/Type /Font"),a("/BaseFont /"+Ou(o.fontName)),a("/FontDescriptor "+x+" 0 R"),a("/W "+e.API.PDFObject.convert(h)),a("/CIDToGIDMap /Identity"),a("/DW 1000"),a("/Subtype /CIDFontType2"),a("/CIDSystemInfo"),a("<<"),a("/Supplement 0"),a("/Registry (Adobe)"),a("/Ordering ("+o.encoding+")"),a(">>"),a(">>"),a("endobj"),o.objectNumber=c(),a("<<"),a("/Type /Font"),a("/Subtype /Type0"),a("/ToUnicode "+g+" 0 R"),a("/BaseFont /"+Ou(o.fontName)),a("/Encoding /"+o.encoding),a("/DescendantFonts ["+y+" 0 R]"),a(">>"),a("endobj"),o.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(l){var o=l.font,a=l.out,c=l.newObject,f=l.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var h=o.metadata.rawData,d="",u=0;u<h.length;u++)d+=String.fromCharCode(h[u]);var p=c();f({data:d,addLength1:!0,objectId:p}),a("endobj");var m=c();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:m}),a("endobj");var g=c();a("<<"),a("/Descent "+o.metadata.decender),a("/CapHeight "+o.metadata.capHeight),a("/StemV "+o.metadata.stemV),a("/Type /FontDescriptor"),a("/FontFile2 "+p+" 0 R"),a("/Flags 96"),a("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),a("/FontName /"+Ou(o.fontName)),a("/ItalicAngle "+o.metadata.italicAngle),a("/Ascent "+o.metadata.ascender),a(">>"),a("endobj"),o.objectNumber=c();for(var x=0;x<o.metadata.hmtx.widths.length;x++)o.metadata.hmtx.widths[x]=parseInt(o.metadata.hmtx.widths[x]*(1e3/o.metadata.head.unitsPerEm));a("<</Subtype/TrueType/Type/Font/ToUnicode "+m+" 0 R/BaseFont/"+Ou(o.fontName)+"/FontDescriptor "+g+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),a("endobj"),o.isAlreadyPutted=!0}})(s)}]);var i=function(s){var l,o=s.text||"",a=s.x,c=s.y,f=s.options||{},h=s.mutex||{},d=h.pdfEscape,u=h.activeFontKey,p=h.fonts,m=u,g="",x=0,y="",w=p[m].encoding;if(p[m].encoding!=="Identity-H")return{text:o,x:a,y:c,options:f,mutex:h};for(y=o,m=u,Array.isArray(o)&&(y=o[0]),x=0;x<y.length;x+=1)p[m].metadata.hasOwnProperty("cmap")&&(l=p[m].metadata.cmap.unicode.codeMap[y[x].charCodeAt(0)]),l||y[x].charCodeAt(0)<256&&p[m].metadata.hasOwnProperty("Unicode")?g+=y[x]:g+="";var _="";return parseInt(m.slice(1))<14||w==="WinAnsiEncoding"?_=d(g,m).split("").map(function(C){return C.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(_=r(g,p[m])),h.isHex=!0,{text:_,x:a,y:c,options:f,mutex:h}};t.events.push(["postProcessText",function(s){var l=s.text||"",o=[],a={text:l,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(l)){var c=0;for(c=0;c<l.length;c+=1)Array.isArray(l[c])&&l[c].length===3?o.push([i(Object.assign({},a,{text:l[c][0]})).text,l[c][1],l[c][2]]):o.push(i(Object.assign({},a,{text:l[c]})).text);s.text=o}else s.text=i(Object.assign({},a,{text:l})).text}])}(Lt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Lt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var i,s,l,o,a,c,f,h=t,d=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],u=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],p={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},m={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},g=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),y=!1,w=0;this.__bidiEngine__={};var _=function(F){var L=F.charCodeAt(),G=L>>8,X=m[G];return X!==void 0?h[256*X+(255&L)]:G===252||G===253?"AL":x.test(G)?"L":G===8?"R":"N"},C=function(F){for(var L,G=0;G<F.length;G++){if((L=_(F.charAt(G)))==="L")return!1;if(L==="R")return!0}return!1},E=function(F,L,G,X){var re,Q,ne,J,P=L[X];switch(P){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":y=!1;break;case"N":case"AN":break;case"EN":y&&(P="AN");break;case"AL":y=!0,P="R";break;case"WS":case"BN":P="N";break;case"CS":X<1||X+1>=L.length||(re=G[X-1])!=="EN"&&re!=="AN"||(Q=L[X+1])!=="EN"&&Q!=="AN"?P="N":y&&(Q="AN"),P=Q===re?Q:"N";break;case"ES":P=(re=X>0?G[X-1]:"B")==="EN"&&X+1<L.length&&L[X+1]==="EN"?"EN":"N";break;case"ET":if(X>0&&G[X-1]==="EN"){P="EN";break}if(y){P="N";break}for(ne=X+1,J=L.length;ne<J&&L[ne]==="ET";)ne++;P=ne<J&&L[ne]==="EN"?"EN":"N";break;case"NSM":if(l&&!o){for(J=L.length,ne=X+1;ne<J&&L[ne]==="NSM";)ne++;if(ne<J){var H=F[X],U=H>=1425&&H<=2303||H===64286;if(re=L[ne],U&&(re==="R"||re==="AL")){P="R";break}}}P=X<1||(re=L[X-1])==="B"?"N":G[X-1];break;case"B":y=!1,i=!0,P=w;break;case"S":s=!0,P="N"}return P},T=function(F,L,G){var X=F.split("");return G&&A(X,G,{hiLevel:w}),X.reverse(),L&&L.reverse(),X.join("")},A=function(F,L,G){var X,re,Q,ne,J,P=-1,H=F.length,U=0,S=[],I=w?u:d,O=[];for(y=!1,i=!1,s=!1,re=0;re<H;re++)O[re]=_(F[re]);for(Q=0;Q<H;Q++){if(J=U,S[Q]=E(F,O,S,Q),X=240&(U=I[J][p[S[Q]]]),U&=15,L[Q]=ne=I[U][5],X>0)if(X===16){for(re=P;re<Q;re++)L[re]=1;P=-1}else P=-1;if(I[U][6])P===-1&&(P=Q);else if(P>-1){for(re=P;re<Q;re++)L[re]=ne;P=-1}O[Q]==="B"&&(L[Q]=0),G.hiLevel|=ne}s&&function(N,R,z){for(var K=0;K<z;K++)if(N[K]==="S"){R[K]=w;for(var Y=K-1;Y>=0&&N[Y]==="WS";Y--)R[Y]=w}}(O,L,H)},j=function(F,L,G,X,re){if(!(re.hiLevel<F)){if(F===1&&w===1&&!i)return L.reverse(),void(G&&G.reverse());for(var Q,ne,J,P,H=L.length,U=0;U<H;){if(X[U]>=F){for(J=U+1;J<H&&X[J]>=F;)J++;for(P=U,ne=J-1;P<ne;P++,ne--)Q=L[P],L[P]=L[ne],L[ne]=Q,G&&(Q=G[P],G[P]=G[ne],G[ne]=Q);U=J}U++}}},B=function(F,L,G){var X=F.split(""),re={hiLevel:w};return G||(G=[]),A(X,G,re),function(Q,ne,J){if(J.hiLevel!==0&&f)for(var P,H=0;H<Q.length;H++)ne[H]===1&&(P=g.indexOf(Q[H]))>=0&&(Q[H]=g[P+1])}(X,G,re),j(2,X,L,G,re),j(1,X,L,G,re),X.join("")};return this.__bidiEngine__.doBidiReorder=function(F,L,G){if(function(re,Q){if(Q)for(var ne=0;ne<re.length;ne++)Q[ne]=ne;o===void 0&&(o=C(re)),c===void 0&&(c=C(re))}(F,L),l||!a||c)if(l&&a&&o^c)w=o?1:0,F=T(F,L,G);else if(!l&&a&&c)w=o?1:0,F=B(F,L,G),F=T(F,L);else if(!l||o||a||c){if(l&&!a&&o^c)F=T(F,L),o?(w=0,F=B(F,L,G)):(w=1,F=B(F,L,G),F=T(F,L));else if(l&&o&&!a&&c)w=1,F=B(F,L,G),F=T(F,L);else if(!l&&!a&&o^c){var X=f;o?(w=1,F=B(F,L,G),w=0,f=!1,F=B(F,L,G),f=X):(w=0,F=B(F,L,G),F=T(F,L),w=1,f=!1,F=B(F,L,G),f=X,F=T(F,L))}}else w=0,F=B(F,L,G);else w=o?1:0,F=B(F,L,G);return F},this.__bidiEngine__.setOptions=function(F){F&&(l=F.isInputVisual,a=F.isOutputVisual,o=F.isInputRtl,c=F.isOutputRtl,f=F.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var l=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var o=0;for(l=[],o=0;o<i.length;o+=1)Object.prototype.toString.call(i[o])==="[object Array]"?l.push([r.doBidiReorder(i[o][0]),i[o][1],i[o][2]]):l.push([r.doBidiReorder(i[o])]);n.text=l}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(Lt),Lt.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Dl(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new ZL(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new BL(this.contents),this.head=new WL(this),this.name=new qL(this),this.cmap=new aC(this),this.toUnicode={},this.hhea=new zL(this),this.maxp=new GL(this),this.hmtx=new XL(this),this.post=new $L(this),this.os2=new HL(this),this.loca=new QL(this),this.glyf=new YL(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,o,a,c;for(c=[],l=0,o=(a=this.bbox).length;l<o;l++)t=a[l],c.push(Math.round(t*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(r=i>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var i,s,l,o;for(l=0,s=0,o=(t=""+t).length;0<=o?s<o:s>o;s=0<=o?++s:--s)i=t.charCodeAt(s),l+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return l*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var Ca,Dl=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,i;for(i=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(t.charCodeAt(r)));return i},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,i,s,l,o,a;return t=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),s=this.readByte(),l=this.readByte(),o=this.readByte(),a=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^s)+65536*(255^l)+256*(255^o)+(255^a)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*i+16777216*s+65536*l+256*o+a},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,i,s;for(s=[],n=0,i=t.length;n<i;n++)r=t[n],s.push(this.writeByte(r));return s},e}(),BL=function(){var e;function t(r){var n,i,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,i,s,l,o,a,c,f,h,d,u,p,m;for(m in u=Object.keys(r).length,a=Math.log(2),h=16*Math.floor(Math.log(u)/a),l=Math.floor(h/a),f=16*u-h,(i=new Dl).writeInt(this.scalarType),i.writeShort(u),i.writeShort(h),i.writeShort(l),i.writeShort(f),s=16*u,c=i.pos+s,o=null,p=[],r)for(d=r[m],i.writeString(m),i.writeInt(e(d)),i.writeInt(c),i.writeInt(d.length),p=p.concat(d),m==="head"&&(o=c),c+=d.length;c%4;)p.push(0),c++;return i.write(p),n=2981146554-e(i.data),i.pos=o+8,i.writeUInt32(n),i.data},e=function(r){var n,i,s,l;for(r=oC.call(r);r.length%4;)r.push(0);for(s=new Dl(r),i=0,n=0,l=r.length;n<l;n=n+=4)i+=s.readUInt32();return 4294967295&i},t}(),UL={}.hasOwnProperty,Ka=function(e,t){for(var r in t)UL.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};Ca=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var WL=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ka(e,Ca),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new Dl).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),b5=function(){function e(t,r){var n,i,s,l,o,a,c,f,h,d,u,p,m,g,x,y,w;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),h=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(a=0;a<256;++a)this.codeMap[a]=t.readByte();break;case 4:for(u=t.readUInt16(),d=u/2,t.pos+=6,s=function(){var _,C;for(C=[],a=_=0;0<=d?_<d:_>d;a=0<=d?++_:--_)C.push(t.readUInt16());return C}(),t.pos+=2,m=function(){var _,C;for(C=[],a=_=0;0<=d?_<d:_>d;a=0<=d?++_:--_)C.push(t.readUInt16());return C}(),c=function(){var _,C;for(C=[],a=_=0;0<=d?_<d:_>d;a=0<=d?++_:--_)C.push(t.readUInt16());return C}(),f=function(){var _,C;for(C=[],a=_=0;0<=d?_<d:_>d;a=0<=d?++_:--_)C.push(t.readUInt16());return C}(),i=(this.length-t.pos+this.offset)/2,o=function(){var _,C;for(C=[],a=_=0;0<=i?_<i:_>i;a=0<=i?++_:--_)C.push(t.readUInt16());return C}(),a=x=0,w=s.length;x<w;a=++x)for(g=s[a],n=y=p=m[a];p<=g?y<=g:y>=g;n=p<=g?++y:--y)f[a]===0?l=n+c[a]:(l=o[f[a]/2+(n-p)-(d-a)]||0)!==0&&(l+=c[a]),this.codeMap[n]=65535&l}t.pos=h}return e.encode=function(t,r){var n,i,s,l,o,a,c,f,h,d,u,p,m,g,x,y,w,_,C,E,T,A,j,B,F,L,G,X,re,Q,ne,J,P,H,U,S,I,O,N,R,z,K,Y,Z,se,V;switch(X=new Dl,l=Object.keys(t).sort(function(le,ae){return le-ae}),r){case"macroman":for(m=0,g=function(){var le=[];for(p=0;p<256;++p)le.push(0);return le}(),y={0:0},s={},re=0,P=l.length;re<P;re++)y[Y=t[i=l[re]]]==null&&(y[Y]=++m),s[i]={old:t[i],new:y[t[i]]},g[i]=y[t[i]];return X.writeUInt16(1),X.writeUInt16(0),X.writeUInt32(12),X.writeUInt16(0),X.writeUInt16(262),X.writeUInt16(0),X.write(g),{charMap:s,subtable:X.data,maxGlyphID:m+1};case"unicode":for(L=[],h=[],w=0,y={},n={},x=c=null,Q=0,H=l.length;Q<H;Q++)y[C=t[i=l[Q]]]==null&&(y[C]=++w),n[i]={old:C,new:y[C]},o=y[C]-i,x!=null&&o===c||(x&&h.push(x),L.push(i),c=o),x=i;for(x&&h.push(x),h.push(65535),L.push(65535),B=2*(j=L.length),A=2*Math.pow(Math.log(j)/Math.LN2,2),d=Math.log(A/2)/Math.LN2,T=2*j-A,a=[],E=[],u=[],p=ne=0,U=L.length;ne<U;p=++ne){if(F=L[p],f=h[p],F===65535){a.push(0),E.push(0);break}if(F-(G=n[F].new)>=32768)for(a.push(0),E.push(2*(u.length+j-p)),i=J=F;F<=f?J<=f:J>=f;i=F<=f?++J:--J)u.push(n[i].new);else a.push(G-F),E.push(0)}for(X.writeUInt16(3),X.writeUInt16(1),X.writeUInt32(12),X.writeUInt16(4),X.writeUInt16(16+8*j+2*u.length),X.writeUInt16(0),X.writeUInt16(B),X.writeUInt16(A),X.writeUInt16(d),X.writeUInt16(T),z=0,S=h.length;z<S;z++)i=h[z],X.writeUInt16(i);for(X.writeUInt16(0),K=0,I=L.length;K<I;K++)i=L[K],X.writeUInt16(i);for(Z=0,O=a.length;Z<O;Z++)o=a[Z],X.writeUInt16(o);for(se=0,N=E.length;se<N;se++)_=E[se],X.writeUInt16(_);for(V=0,R=u.length;V<R;V++)m=u[V],X.writeUInt16(m);return{charMap:n,subtable:X.data,maxGlyphID:w+1}}},e}(),aC=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ka(e,Ca),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,i;for(t.pos=this.offset,this.version=t.readUInt16(),i=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)r=new b5(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,i;return r==null&&(r="macroman"),n=b5.encode(t,r),(i=new Dl).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},e}(),zL=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ka(e,Ca),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),HL=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ka(e,Ca),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),$L=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ka(e,Ca),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,i;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(n=t.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],i=[];t.pos<this.offset+this.length;)r=t.readByte(),i.push(this.names.push(t.readString(r)));return i;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var l,o,a;for(a=[],s=l=0,o=this.file.maxp.numGlyphs;0<=o?l<o:l>o;s=0<=o?++l:--l)a.push(t.readUInt32());return a}).call(this)}},e}(),VL=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},qL=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ka(e,Ca),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,i,s,l,o,a,c,f,h,d;for(t.pos=this.offset,t.readShort(),r=t.readShort(),o=t.readShort(),n=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+o+t.readShort()});for(a={},s=f=0,h=n.length;f<h;s=++f)i=n[s],t.pos=i.offset,c=t.readString(i.length),l=new VL(c,i),a[d=i.nameID]==null&&(a[d]=[]),a[i.nameID].push(l);this.strings=a,this.copyright=a[0],this.fontFamily=a[1],this.fontSubfamily=a[2],this.uniqueSubfamily=a[3],this.fontName=a[4],this.version=a[5];try{this.postscriptName=a[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=a[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=a[7],this.manufacturer=a[8],this.designer=a[9],this.description=a[10],this.vendorUrl=a[11],this.designerUrl=a[12],this.license=a[13],this.licenseUrl=a[14],this.preferredFamily=a[15],this.preferredSubfamily=a[17],this.compatibleFull=a[18],this.sampleText=a[19]},e}(),GL=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ka(e,Ca),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),XL=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ka(e,Ca),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,i,s,l,o,a;for(t.pos=this.offset,this.metrics=[],r=0,o=this.file.hhea.numberOfMetrics;0<=o?r<o:r>o;r=0<=o?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var c,f;for(f=[],r=c=0;0<=i?c<i:c>i;r=0<=i?++c:--c)f.push(t.readInt16());return f}(),this.widths=(function(){var c,f,h,d;for(d=[],c=0,f=(h=this.metrics).length;c<f;c++)s=h[c],d.push(s.advance);return d}).call(this),n=this.widths[this.widths.length-1],a=[],r=l=0;0<=i?l<i:l>i;r=0<=i?++l:--l)a.push(this.widths.push(n));return a},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),oC=[].slice,YL=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ka(e,Ca),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,i,s,l,o,a,c,f,h;return t in this.cache?this.cache[t]:(s=this.file.loca,r=this.file.contents,n=s.indexOf(t),(i=s.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,l=(o=new Dl(r.read(i))).readShort(),c=o.readShort(),h=o.readShort(),a=o.readShort(),f=o.readShort(),this.cache[t]=l===-1?new JL(o,c,h,a,f):new KL(o,l,c,h,a,f),this.cache[t]))},e.prototype.encode=function(t,r,n){var i,s,l,o,a;for(l=[],s=[],o=0,a=r.length;o<a;o++)i=t[r[o]],s.push(l.length),i&&(l=l.concat(i.encode(n)));return s.push(l.length),{table:l,offsets:s}},e}(),KL=function(){function e(t,r,n,i,s,l){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=s,this.yMax=l,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),JL=function(){function e(t,r,n,i,s){var l,o;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;o=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&o;)l.pos+=1&o?4:2,128&o?l.pos+=8:64&o?l.pos+=4:8&o&&(l.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Dl(oC.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),QL=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ka(e,Ca),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var i,s;for(s=[],n=0,i=this.length;n<i;n+=2)s.push(2*t.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],n=0,i=this.length;n<i;n+=4)s.push(t.readUInt32());return s}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),i=0,s=0,l=0;l<n.length;++l)if(n[l]=i,s<r.length&&r[s]==l){++s,n[l]=i;var o=this.offsets[l],a=this.offsets[l+1]-o;a>0&&(i+=a)}for(var c=new Array(4*n.length),f=0;f<n.length;++f)c[4*f+3]=255&n[f],c[4*f+2]=(65280&n[f])>>8,c[4*f+1]=(16711680&n[f])>>16,c[4*f]=(4278190080&n[f])>>24;return c},e}(),ZL=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,i,s;for(r in i=this.font.cmap.tables[0].codeMap,t={},s=this.subset)n=s[r],t[r]=i[n];return t},e.prototype.glyphsFor=function(t){var r,n,i,s,l,o,a;for(i={},l=0,o=t.length;l<o;l++)i[s=t[l]]=this.font.glyf.glyphFor(s);for(s in r=[],i)(n=i[s])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(s in a=this.glyphsFor(r))n=a[s],i[s]=n;return i},e.prototype.encode=function(t,r){var n,i,s,l,o,a,c,f,h,d,u,p,m,g,x;for(i in n=aC.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(t),u={0:0},x=n.charMap)u[(a=x[i]).old]=a.new;for(p in d=n.maxGlyphID,l)p in u||(u[p]=d++);return f=function(y){var w,_;for(w in _={},y)_[y[w]]=w;return _}(u),h=Object.keys(f).sort(function(y,w){return y-w}),m=function(){var y,w,_;for(_=[],y=0,w=h.length;y<w;y++)o=h[y],_.push(f[o]);return _}(),s=this.font.glyf.encode(l,m,u),c=this.font.loca.encode(s.offsets,m),g={cmap:this.font.cmap.raw(),glyf:s.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(g["OS/2"]=this.font.os2.raw()),this.font.directory.encode(g)},e}();Lt.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,i,s,l;if(Array.isArray(r))return"["+function(){var o,a,c;for(c=[],o=0,a=r.length;o<a;o++)n=r[o],c.push(t.convert(n));return c}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in s=["<<"],r)l=r[i],s.push("/"+i+" "+t.convert(l));return s.push(">>"),s.join(`
`)}return""+r},t}();/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var wg={};wg.version="0.18.5";var lC=1252,eI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],K2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},J2=function(e){eI.indexOf(e)!=-1&&(lC=K2[0]=e)};function tI(){J2(1252)}var ga=function(e){J2(e)};function Q2(){ga(1200),tI()}function S5(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function rI(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function cC(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var _h=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?rI(e.slice(2)):t==254&&r==255?cC(e.slice(2)):t==65279?e.slice(1):e},op=function(t){return String.fromCharCode(t)},k5=function(t){return String.fromCharCode(t)},_d,ml="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function bd(e){for(var t="",r=0,n=0,i=0,s=0,l=0,o=0,a=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),l=(r&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,a=i&63,isNaN(n)?o=a=64:isNaN(i)&&(a=64),t+=ml.charAt(s)+ml.charAt(l)+ml.charAt(o)+ml.charAt(a);return t}function Ts(e){var t="",r=0,n=0,i=0,s=0,l=0,o=0,a=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=ml.indexOf(e.charAt(c++)),l=ml.indexOf(e.charAt(c++)),r=s<<2|l>>4,t+=String.fromCharCode(r),o=ml.indexOf(e.charAt(c++)),n=(l&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),a=ml.indexOf(e.charAt(c++)),i=(o&3)<<6|a,a!==64&&(t+=String.fromCharCode(i));return t}var sr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ro=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ll(e){return sr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function C5(e){return sr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ys=function(t){return sr?Ro(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function i1(e){if(typeof ArrayBuffer>"u")return ys(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function zl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function nI(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Z2(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Z2(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ti=sr?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ro(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function iI(e){for(var t=[],r=0,n=e.length+250,i=Ll(e.length+255),s=0;s<e.length;++s){var l=e.charCodeAt(s);if(l<128)i[r++]=l;else if(l<2048)i[r++]=192|l>>6&31,i[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|l>>8&7,i[r++]=128|l>>2&63,i[r++]=128|o>>6&15|(l&3)<<4,i[r++]=128|o&63}else i[r++]=224|l>>12&15,i[r++]=128|l>>6&63,i[r++]=128|l&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Ll(65535),n=65530)}return t.push(i.slice(0,r)),ti(t)}var $i=/\u0000/g,bh=/[\u0001-\u0006]/g;function sf(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ma(e,t){var r=""+e;return r.length>=t?r:fn("0",t-r.length)+r}function ey(e,t){var r=""+e;return r.length>=t?r:fn(" ",t-r.length)+r}function _g(e,t){var r=""+e;return r.length>=t?r:r+fn(" ",t-r.length)}function sI(e,t){var r=""+Math.round(e);return r.length>=t?r:fn("0",t-r.length)+r}function aI(e,t){var r=""+e;return r.length>=t?r:fn("0",t-r.length)+r}var E5=Math.pow(2,32);function bu(e,t){if(e>E5||e<-E5)return sI(e,t);var r=Math.round(e);return aI(r,t)}function bg(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var T5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Jm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function oI(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ut={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},N5={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},lI={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Sg(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,l=1,o=0,a=1,c=0,f=0,h=Math.floor(i);c<t&&(h=Math.floor(i),o=h*l+s,f=h*c+a,!(i-h<5e-8));)i=1/(i-h),s=l,l=o,a=c,c=f;if(f>t&&(c>t?(f=a,o=s):(f=c,o=l)),!r)return[0,n*o,f];var d=Math.floor(n*o/f);return[d,n*o-d*f,f]}function wc(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,l=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)l=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var a=new Date(1900,0,1);a.setDate(a.getDate()+n-1),l=[a.getFullYear(),a.getMonth()+1,a.getDate()],s=a.getDay(),n<60&&(s=(s+6)%7),r&&(s=pI(a,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var uC=new Date(1899,11,31,0,0,0),cI=uC.getTime(),uI=new Date(1900,2,1,0,0,0);function fC(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=uI&&(r+=24*60*60*1e3),(r-(cI+(e.getTimezoneOffset()-uC.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function ty(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function fI(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function hI(e){var t=e<0?12:11,r=ty(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function dI(e){var t=ty(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Sd(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=hI(e):t===10?r=e.toFixed(10).substr(0,12):r=dI(e),ty(fI(r.toUpperCase()))}function Ic(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Sd(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Js(14,fC(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function pI(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function gI(e,t,r,n){var i="",s=0,l=0,o=r.y,a,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:a=o%100,c=2;break;default:a=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:a=r.m,c=t.length;break;case 3:return Jm[r.m-1][1];case 5:return Jm[r.m-1][0];default:return Jm[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=r.d,c=t.length;break;case 3:return T5[r.q][0];default:return T5[r.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ma(r.S,t.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,s=Math.round(l*(r.S+r.u)),s>=60*l&&(s=0),t==="s"?s===0?"0":""+s/l:(i=ma(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":a=r.D*24+r.H;break;case"[m]":case"[mm]":a=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":a=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:a=o,c=1;break}var f=c>0?ma(a,c):"";return f}function xl(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var hC=/%/g;function mI(e,t,r){var n=t.replace(hC,""),i=t.length-n.length;return Co(e,n,r*Math.pow(10,2*i))+fn("%",i)}function xI(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Co(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function dC(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+dC(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,a,c,f){return a+c+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var pC=/# (\?+)( ?)\/( ?)(\d+)/;function vI(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),l=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(l===0?fn(" ",e[1].length+1+e[4].length):ey(l,e[1].length)+e[2]+"/"+e[3]+ma(o,e[4].length))}function yI(e,t,r){return r+(t===0?"":""+t)+fn(" ",e[1].length+2+e[4].length)}var gC=/^#*0*\.([0#]+)/,mC=/\).*[0#]/,xC=/\(###\) ###\\?-####/;function Wi(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function A5(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function O5(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function wI(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function _I(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Rs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(mC)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Rs("n",n,r):"("+Rs("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return xI(e,t,r);if(t.indexOf("%")!==-1)return mI(e,t,r);if(t.indexOf("E")!==-1)return dC(t,r);if(t.charCodeAt(0)===36)return"$"+Rs(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,l,o,a=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+bu(a,t.length);if(t.match(/^[#?]+$/))return i=bu(r,0),i==="0"&&(i=""),i.length>t.length?i:Wi(t.substr(0,t.length-i.length))+i;if(s=t.match(pC))return vI(s,a,c);if(t.match(/^#+0+$/))return c+bu(a,t.length-t.indexOf("0"));if(s=t.match(gC))return i=A5(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Wi(s[1])).replace(/\.$/,"."+Wi(s[1])).replace(/\.(\d*)$/,function(p,m){return"."+m+fn("0",Wi(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+A5(a,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+xl(bu(a,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Rs(e,t,-r):xl(""+(Math.floor(r)+wI(r,s[1].length)))+"."+ma(O5(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Rs(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=sf(Rs(e,t.replace(/[\\-]/g,""),r)),l=0,sf(sf(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<i.length?i.charAt(l++):p==="0"?"0":""}));if(t.match(xC))return i=Rs(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),o=Sg(a,Math.pow(10,l)-1,!1),i=""+c,f=Co("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=_g(o[2],l),f.length<s[4].length&&(f=Wi(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),o=Sg(a,Math.pow(10,l)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ey(o[1],l)+s[2]+"/"+s[3]+_g(o[2],l):fn(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=bu(r,0),t.length<=i.length?i:Wi(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=i.indexOf(".");var h=t.indexOf(".")-l,d=t.length-i.length-h;return Wi(t.substr(0,h)+i+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return l=O5(r,s[1].length),r<0?"-"+Rs(e,t,-r):xl(_I(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?ma(0,3-p.length):"")+p})+"."+ma(l,s[1].length);switch(t){case"###,##0.00":return Rs(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var u=xl(bu(a,0));return u!=="0"?c+u:"";case"###,###.00":return Rs(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Rs(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function bI(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Co(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function SI(e,t,r){var n=t.replace(hC,""),i=t.length-n.length;return Co(e,n,r*Math.pow(10,2*i))+fn("%",i)}function vC(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+vC(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,a,c,f){return a+c+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ra(e,t,r){if(e.charCodeAt(0)===40&&!t.match(mC)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ra("n",n,r):"("+Ra("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return bI(e,t,r);if(t.indexOf("%")!==-1)return SI(e,t,r);if(t.indexOf("E")!==-1)return vC(t,r);if(t.charCodeAt(0)===36)return"$"+Ra(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,l,o,a=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+ma(a,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Wi(t.substr(0,t.length-i.length))+i;if(s=t.match(pC))return yI(s,a,c);if(t.match(/^#+0+$/))return c+ma(a,t.length-t.indexOf("0"));if(s=t.match(gC))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Wi(s[1])).replace(/\.$/,"."+Wi(s[1])),i=i.replace(/\.(\d*)$/,function(p,m){return"."+m+fn("0",Wi(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+a).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+xl(""+a);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ra(e,t,-r):xl(""+r)+"."+fn("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Ra(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=sf(Ra(e,t.replace(/[\\-]/g,""),r)),l=0,sf(sf(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<i.length?i.charAt(l++):p==="0"?"0":""}));if(t.match(xC))return i=Ra(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),o=Sg(a,Math.pow(10,l)-1,!1),i=""+c,f=Co("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=_g(o[2],l),f.length<s[4].length&&(f=Wi(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),o=Sg(a,Math.pow(10,l)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ey(o[1],l)+s[2]+"/"+s[3]+_g(o[2],l):fn(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Wi(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=i.indexOf(".");var h=t.indexOf(".")-l,d=t.length-i.length-h;return Wi(t.substr(0,h)+i+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ra(e,t,-r):xl(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?ma(0,3-p.length):"")+p})+"."+ma(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var u=xl(""+a);return u!=="0"?c+u:"";default:if(t.match(/\.[0#?]*$/))return Ra(e,t.slice(0,t.lastIndexOf(".")),r)+Wi(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Co(e,t,r){return(r|0)===r?Ra(e,t,r):Rs(e,t,r)}function kI(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var yC=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Tf(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":bg(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(yC))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function CI(e,t,r,n){for(var i=[],s="",l=0,o="",a="t",c,f,h,d="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!bg(e,l))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(h=e.charCodeAt(++l))!==34&&l<e.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++l;break;case"\\":var u=e.charAt(++l),p=u==="("||u===")"?u:"t";i[i.length]={t:p,v:u},++l;break;case"_":i[i.length]={t:"t",v:" "},l+=2;break;case"@":i[i.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(c==null&&(c=wc(t,r,e.charAt(l+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(l,2)},a=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=wc(t,r),c==null))return"";for(s=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)s+=o;o==="m"&&a.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:s},a=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=wc(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",d="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",l+=5,d="h"):e.substr(l,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",l+=5,d="h"):(m.t="t",++l),c==null&&m.t==="T")return"";i[i.length]=m,a=o;break;case"[":for(s=o;e.charAt(l++)!=="]"&&l<e.length;)s+=e.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(yC)){if(c==null&&(c=wc(t,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},a=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Tf(e)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++l<e.length&&(o=e.charAt(l))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++l)===o;)s+=o;i[i.length]={t:o,v:s},a=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)s+=e.charAt(l);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++l;break;case"$":i[i.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++l;break}var g=0,x=0,y;for(l=i.length-1,a="t";l>=0;--l)switch(i[l].t){case"h":case"H":i[l].t=d,a="h",g<1&&(g=1);break;case"s":(y=i[l].v.match(/\.0+$/))&&(x=Math.max(x,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":a=i[l].t;break;case"m":a==="s"&&(i[l].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&i[l].v.match(/[Hh]/)&&(g=1),g<2&&i[l].v.match(/[Mm]/)&&(g=2),g<3&&i[l].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var w="",_;for(l=0;l<i.length;++l)switch(i[l].t){case"t":case"T":case" ":case"D":break;case"X":i[l].v="",i[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[l].v=gI(i[l].t.charCodeAt(0),i[l].v,c,x),i[l].t="t";break;case"n":case"?":for(_=l+1;i[_]!=null&&((o=i[_].t)==="?"||o==="D"||(o===" "||o==="t")&&i[_+1]!=null&&(i[_+1].t==="?"||i[_+1].t==="t"&&i[_+1].v==="/")||i[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[_].v==="/"||i[_].v===" "&&i[_+1]!=null&&i[_+1].t=="?"));)i[l].v+=i[_].v,i[_]={v:"",t:";"},++_;w+=i[l].v,l=_-1;break;case"G":i[l].t="t",i[l].v=Ic(t,r);break}var C="",E,T;if(w.length>0){w.charCodeAt(0)==40?(E=t<0&&w.charCodeAt(0)===45?-t:t,T=Co("n",w,E)):(E=t<0&&n>1?-t:t,T=Co("n",w,E),E<0&&i[0]&&i[0].t=="t"&&(T=T.substr(1),i[0].v="-"+i[0].v)),_=T.length-1;var A=i.length;for(l=0;l<i.length;++l)if(i[l]!=null&&i[l].t!="t"&&i[l].v.indexOf(".")>-1){A=l;break}var j=i.length;if(A===i.length&&T.indexOf("E")===-1){for(l=i.length-1;l>=0;--l)i[l]==null||"n?".indexOf(i[l].t)===-1||(_>=i[l].v.length-1?(_-=i[l].v.length,i[l].v=T.substr(_+1,i[l].v.length)):_<0?i[l].v="":(i[l].v=T.substr(0,_+1),_=-1),i[l].t="t",j=l);_>=0&&j<i.length&&(i[j].v=T.substr(0,_+1)+i[j].v)}else if(A!==i.length&&T.indexOf("E")===-1){for(_=T.indexOf(".")-1,l=A;l>=0;--l)if(!(i[l]==null||"n?".indexOf(i[l].t)===-1)){for(f=i[l].v.indexOf(".")>-1&&l===A?i[l].v.indexOf(".")-1:i[l].v.length-1,C=i[l].v.substr(f+1);f>=0;--f)_>=0&&(i[l].v.charAt(f)==="0"||i[l].v.charAt(f)==="#")&&(C=T.charAt(_--)+C);i[l].v=C,i[l].t="t",j=l}for(_>=0&&j<i.length&&(i[j].v=T.substr(0,_+1)+i[j].v),_=T.indexOf(".")+1,l=A;l<i.length;++l)if(!(i[l]==null||"n?(".indexOf(i[l].t)===-1&&l!==A)){for(f=i[l].v.indexOf(".")>-1&&l===A?i[l].v.indexOf(".")+1:0,C=i[l].v.substr(0,f);f<i[l].v.length;++f)_<T.length&&(C+=T.charAt(_++));i[l].v=C,i[l].t="t",j=l}}}for(l=0;l<i.length;++l)i[l]!=null&&"n?".indexOf(i[l].t)>-1&&(E=n>1&&t<0&&l>0&&i[l-1].v==="-"?-t:t,i[l].v=Co(i[l].t,i[l].v,E),i[l].t="t");var B="";for(l=0;l!==i.length;++l)i[l]!=null&&(B+=i[l].v);return B}var P5=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function F5(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function EI(e,t){var r=kI(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(P5),o=r[1].match(P5);return F5(t,l)?[n,r[0]]:F5(t,o)?[n,r[1]]:[n,r[l!=null&&o!=null?2:1]]}return[n,s]}function Js(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ut)[e],n==null&&(n=r.table&&r.table[N5[e]]||Ut[N5[e]]),n==null&&(n=lI[e]||"General");break}if(bg(n,0))return Ic(t,r);t instanceof Date&&(t=fC(t,r.date1904));var i=EI(n,t);if(bg(i[1]))return Ic(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return CI(i[1],t,r,i[0])}function Eo(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ut[r]==null){t<0&&(t=r);continue}if(Ut[r]==e){t=r;break}}t<0&&(t=391)}return Ut[t]=e,t}function s1(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Eo(e[t],t)}function Nf(){Ut=oI()}var TI={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},wC=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function NI(e){var t=typeof e=="number"?Ut[e]:e;return t=t.replace(wC,"(\\d+)"),new RegExp("^"+t+"$")}function AI(e,t,r){var n=-1,i=-1,s=-1,l=-1,o=-1,a=-1;(t.match(wC)||[]).forEach(function(h,d){var u=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=u;break;case"d":s=u;break;case"h":l=u;break;case"s":a=u;break;case"m":l>=0?o=u:i=u;break}}),a>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2);return l==-1&&o==-1&&a==-1?c:n==-1&&i==-1&&s==-1?f:c+"T"+f}var OI=function(){var e={};e.version="1.2.0";function t(){for(var T=0,A=new Array(256),j=0;j!=256;++j)T=j,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,A[j]=T;return typeof Int32Array<"u"?new Int32Array(A):A}var r=t();function n(T){var A=0,j=0,B=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)F[B]=T[B];for(B=0;B!=256;++B)for(j=T[B],A=256+B;A<4096;A+=256)j=F[A]=j>>>8^T[j&255];var L=[];for(B=1;B!=16;++B)L[B-1]=typeof Int32Array<"u"?F.subarray(B*256,B*256+256):F.slice(B*256,B*256+256);return L}var i=n(r),s=i[0],l=i[1],o=i[2],a=i[3],c=i[4],f=i[5],h=i[6],d=i[7],u=i[8],p=i[9],m=i[10],g=i[11],x=i[12],y=i[13],w=i[14];function _(T,A){for(var j=A^-1,B=0,F=T.length;B<F;)j=j>>>8^r[(j^T.charCodeAt(B++))&255];return~j}function C(T,A){for(var j=A^-1,B=T.length-15,F=0;F<B;)j=w[T[F++]^j&255]^y[T[F++]^j>>8&255]^x[T[F++]^j>>16&255]^g[T[F++]^j>>>24]^m[T[F++]]^p[T[F++]]^u[T[F++]]^d[T[F++]]^h[T[F++]]^f[T[F++]]^c[T[F++]]^a[T[F++]]^o[T[F++]]^l[T[F++]]^s[T[F++]]^r[T[F++]];for(B+=15;F<B;)j=j>>>8^r[(j^T[F++])&255];return~j}function E(T,A){for(var j=A^-1,B=0,F=T.length,L=0,G=0;B<F;)L=T.charCodeAt(B++),L<128?j=j>>>8^r[(j^L)&255]:L<2048?(j=j>>>8^r[(j^(192|L>>6&31))&255],j=j>>>8^r[(j^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,G=T.charCodeAt(B++)&1023,j=j>>>8^r[(j^(240|L>>8&7))&255],j=j>>>8^r[(j^(128|L>>2&63))&255],j=j>>>8^r[(j^(128|G>>6&15|(L&3)<<4))&255],j=j>>>8^r[(j^(128|G&63))&255]):(j=j>>>8^r[(j^(224|L>>12&15))&255],j=j>>>8^r[(j^(128|L>>6&63))&255],j=j>>>8^r[(j^(128|L&63))&255]);return~j}return e.table=r,e.bstr=_,e.buf=C,e.str=E,e}(),Rt=function(){var t={};t.version="1.2.1";function r(ie,Se){for(var ge=ie.split("/"),ve=Se.split("/"),ke=0,Ee=0,We=Math.min(ge.length,ve.length);ke<We;++ke){if(Ee=ge[ke].length-ve[ke].length)return Ee;if(ge[ke]!=ve[ke])return ge[ke]<ve[ke]?-1:1}return ge.length-ve.length}function n(ie){if(ie.charAt(ie.length-1)=="/")return ie.slice(0,-1).indexOf("/")===-1?ie:n(ie.slice(0,-1));var Se=ie.lastIndexOf("/");return Se===-1?ie:ie.slice(0,Se+1)}function i(ie){if(ie.charAt(ie.length-1)=="/")return i(ie.slice(0,-1));var Se=ie.lastIndexOf("/");return Se===-1?ie:ie.slice(Se+1)}function s(ie,Se){typeof Se=="string"&&(Se=new Date(Se));var ge=Se.getHours();ge=ge<<6|Se.getMinutes(),ge=ge<<5|Se.getSeconds()>>>1,ie.write_shift(2,ge);var ve=Se.getFullYear()-1980;ve=ve<<4|Se.getMonth()+1,ve=ve<<5|Se.getDate(),ie.write_shift(2,ve)}function l(ie){var Se=ie.read_shift(2)&65535,ge=ie.read_shift(2)&65535,ve=new Date,ke=ge&31;ge>>>=5;var Ee=ge&15;ge>>>=4,ve.setMilliseconds(0),ve.setFullYear(ge+1980),ve.setMonth(Ee-1),ve.setDate(ke);var We=Se&31;Se>>>=5;var Ke=Se&63;return Se>>>=6,ve.setHours(Se),ve.setMinutes(Ke),ve.setSeconds(We<<1),ve}function o(ie){di(ie,0);for(var Se={},ge=0;ie.l<=ie.length-4;){var ve=ie.read_shift(2),ke=ie.read_shift(2),Ee=ie.l+ke,We={};switch(ve){case 21589:ge=ie.read_shift(1),ge&1&&(We.mtime=ie.read_shift(4)),ke>5&&(ge&2&&(We.atime=ie.read_shift(4)),ge&4&&(We.ctime=ie.read_shift(4))),We.mtime&&(We.mt=new Date(We.mtime*1e3));break}ie.l=Ee,Se[ve]=We}return Se}var a;function c(){return a||(a={})}function f(ie,Se){if(ie[0]==80&&ie[1]==75)return Et(ie,Se);if((ie[0]|32)==109&&(ie[1]|32)==105)return kt(ie,Se);if(ie.length<512)throw new Error("CFB file size "+ie.length+" < 512");var ge=3,ve=512,ke=0,Ee=0,We=0,Ke=0,ze=0,He=[],qe=ie.slice(0,512);di(qe,0);var lt=h(qe);switch(ge=lt[0],ge){case 3:ve=512;break;case 4:ve=4096;break;case 0:if(lt[1]==0)return Et(ie,Se);default:throw new Error("Major Version: Expected 3 or 4 saw "+ge)}ve!==512&&(qe=ie.slice(0,ve),di(qe,28));var mt=ie.slice(0,ve);d(qe,ge);var _t=qe.read_shift(4,"i");if(ge===3&&_t!==0)throw new Error("# Directory Sectors: Expected 0 saw "+_t);qe.l+=4,We=qe.read_shift(4,"i"),qe.l+=4,qe.chk("00100000","Mini Stream Cutoff Size: "),Ke=qe.read_shift(4,"i"),ke=qe.read_shift(4,"i"),ze=qe.read_shift(4,"i"),Ee=qe.read_shift(4,"i");for(var gt=-1,wt=0;wt<109&&(gt=qe.read_shift(4,"i"),!(gt<0));++wt)He[wt]=gt;var $t=u(ie,ve);g(ze,Ee,$t,ve,He);var Ar=y($t,We,He,ve);Ar[We].name="!Directory",ke>0&&Ke!==G&&(Ar[Ke].name="!MiniFAT"),Ar[He[0]].name="!FAT",Ar.fat_addrs=He,Ar.ssz=ve;var lr={},sn=[],Ea=[],ta=[];w(We,Ar,$t,sn,ke,lr,Ea,Ke),p(Ea,ta,sn),sn.shift();var Ta={FileIndex:Ea,FullPaths:ta};return Se&&Se.raw&&(Ta.raw={header:mt,sectors:$t}),Ta}function h(ie){if(ie[ie.l]==80&&ie[ie.l+1]==75)return[0,0];ie.chk(X,"Header Signature: "),ie.l+=16;var Se=ie.read_shift(2,"u");return[ie.read_shift(2,"u"),Se]}function d(ie,Se){var ge=9;switch(ie.l+=2,ge=ie.read_shift(2)){case 9:if(Se!=3)throw new Error("Sector Shift: Expected 9 saw "+ge);break;case 12:if(Se!=4)throw new Error("Sector Shift: Expected 12 saw "+ge);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ge)}ie.chk("0600","Mini Sector Shift: "),ie.chk("000000000000","Reserved: ")}function u(ie,Se){for(var ge=Math.ceil(ie.length/Se)-1,ve=[],ke=1;ke<ge;++ke)ve[ke-1]=ie.slice(ke*Se,(ke+1)*Se);return ve[ge-1]=ie.slice(ge*Se),ve}function p(ie,Se,ge){for(var ve=0,ke=0,Ee=0,We=0,Ke=0,ze=ge.length,He=[],qe=[];ve<ze;++ve)He[ve]=qe[ve]=ve,Se[ve]=ge[ve];for(;Ke<qe.length;++Ke)ve=qe[Ke],ke=ie[ve].L,Ee=ie[ve].R,We=ie[ve].C,He[ve]===ve&&(ke!==-1&&He[ke]!==ke&&(He[ve]=He[ke]),Ee!==-1&&He[Ee]!==Ee&&(He[ve]=He[Ee])),We!==-1&&(He[We]=ve),ke!==-1&&ve!=He[ve]&&(He[ke]=He[ve],qe.lastIndexOf(ke)<Ke&&qe.push(ke)),Ee!==-1&&ve!=He[ve]&&(He[Ee]=He[ve],qe.lastIndexOf(Ee)<Ke&&qe.push(Ee));for(ve=1;ve<ze;++ve)He[ve]===ve&&(Ee!==-1&&He[Ee]!==Ee?He[ve]=He[Ee]:ke!==-1&&He[ke]!==ke&&(He[ve]=He[ke]));for(ve=1;ve<ze;++ve)if(ie[ve].type!==0){if(Ke=ve,Ke!=He[Ke])do Ke=He[Ke],Se[ve]=Se[Ke]+"/"+Se[ve];while(Ke!==0&&He[Ke]!==-1&&Ke!=He[Ke]);He[ve]=-1}for(Se[0]+="/",ve=1;ve<ze;++ve)ie[ve].type!==2&&(Se[ve]+="/")}function m(ie,Se,ge){for(var ve=ie.start,ke=ie.size,Ee=[],We=ve;ge&&ke>0&&We>=0;)Ee.push(Se.slice(We*L,We*L+L)),ke-=L,We=gc(ge,We*4);return Ee.length===0?Je(0):ti(Ee).slice(0,ie.size)}function g(ie,Se,ge,ve,ke){var Ee=G;if(ie===G){if(Se!==0)throw new Error("DIFAT chain shorter than expected")}else if(ie!==-1){var We=ge[ie],Ke=(ve>>>2)-1;if(!We)return;for(var ze=0;ze<Ke&&(Ee=gc(We,ze*4))!==G;++ze)ke.push(Ee);g(gc(We,ve-4),Se-1,ge,ve,ke)}}function x(ie,Se,ge,ve,ke){var Ee=[],We=[];ke||(ke=[]);var Ke=ve-1,ze=0,He=0;for(ze=Se;ze>=0;){ke[ze]=!0,Ee[Ee.length]=ze,We.push(ie[ze]);var qe=ge[Math.floor(ze*4/ve)];if(He=ze*4&Ke,ve<4+He)throw new Error("FAT boundary crossed: "+ze+" 4 "+ve);if(!ie[qe])break;ze=gc(ie[qe],He)}return{nodes:Ee,data:$5([We])}}function y(ie,Se,ge,ve){var ke=ie.length,Ee=[],We=[],Ke=[],ze=[],He=ve-1,qe=0,lt=0,mt=0,_t=0;for(qe=0;qe<ke;++qe)if(Ke=[],mt=qe+Se,mt>=ke&&(mt-=ke),!We[mt]){ze=[];var gt=[];for(lt=mt;lt>=0;){gt[lt]=!0,We[lt]=!0,Ke[Ke.length]=lt,ze.push(ie[lt]);var wt=ge[Math.floor(lt*4/ve)];if(_t=lt*4&He,ve<4+_t)throw new Error("FAT boundary crossed: "+lt+" 4 "+ve);if(!ie[wt]||(lt=gc(ie[wt],_t),gt[lt]))break}Ee[mt]={nodes:Ke,data:$5([ze])}}return Ee}function w(ie,Se,ge,ve,ke,Ee,We,Ke){for(var ze=0,He=ve.length?2:0,qe=Se[ie].data,lt=0,mt=0,_t;lt<qe.length;lt+=128){var gt=qe.slice(lt,lt+128);di(gt,64),mt=gt.read_shift(2),_t=ly(gt,0,mt-He),ve.push(_t);var wt={name:_t,type:gt.read_shift(1),color:gt.read_shift(1),L:gt.read_shift(4,"i"),R:gt.read_shift(4,"i"),C:gt.read_shift(4,"i"),clsid:gt.read_shift(16),state:gt.read_shift(4,"i"),start:0,size:0},$t=gt.read_shift(2)+gt.read_shift(2)+gt.read_shift(2)+gt.read_shift(2);$t!==0&&(wt.ct=_(gt,gt.l-8));var Ar=gt.read_shift(2)+gt.read_shift(2)+gt.read_shift(2)+gt.read_shift(2);Ar!==0&&(wt.mt=_(gt,gt.l-8)),wt.start=gt.read_shift(4,"i"),wt.size=gt.read_shift(4,"i"),wt.size<0&&wt.start<0&&(wt.size=wt.type=0,wt.start=G,wt.name=""),wt.type===5?(ze=wt.start,ke>0&&ze!==G&&(Se[ze].name="!StreamData")):wt.size>=4096?(wt.storage="fat",Se[wt.start]===void 0&&(Se[wt.start]=x(ge,wt.start,Se.fat_addrs,Se.ssz)),Se[wt.start].name=wt.name,wt.content=Se[wt.start].data.slice(0,wt.size)):(wt.storage="minifat",wt.size<0?wt.size=0:ze!==G&&wt.start!==G&&Se[ze]&&(wt.content=m(wt,Se[ze].data,(Se[Ke]||{}).data))),wt.content&&di(wt.content,0),Ee[_t]=wt,We.push(wt)}}function _(ie,Se){return new Date((vs(ie,Se+4)/1e7*Math.pow(2,32)+vs(ie,Se)/1e7-11644473600)*1e3)}function C(ie,Se){return c(),f(a.readFileSync(ie),Se)}function E(ie,Se){var ge=Se&&Se.type;switch(ge||sr&&Buffer.isBuffer(ie)&&(ge="buffer"),ge||"base64"){case"file":return C(ie,Se);case"base64":return f(ys(Ts(ie)),Se);case"binary":return f(ys(ie),Se)}return f(ie,Se)}function T(ie,Se){var ge=Se||{},ve=ge.root||"Root Entry";if(ie.FullPaths||(ie.FullPaths=[]),ie.FileIndex||(ie.FileIndex=[]),ie.FullPaths.length!==ie.FileIndex.length)throw new Error("inconsistent CFB structure");ie.FullPaths.length===0&&(ie.FullPaths[0]=ve+"/",ie.FileIndex[0]={name:ve,type:5}),ge.CLSID&&(ie.FileIndex[0].clsid=ge.CLSID),A(ie)}function A(ie){var Se="Sh33tJ5";if(!Rt.find(ie,"/"+Se)){var ge=Je(4);ge[0]=55,ge[1]=ge[3]=50,ge[2]=54,ie.FileIndex.push({name:Se,type:2,content:ge,size:4,L:69,R:69,C:69}),ie.FullPaths.push(ie.FullPaths[0]+Se),j(ie)}}function j(ie,Se){T(ie);for(var ge=!1,ve=!1,ke=ie.FullPaths.length-1;ke>=0;--ke){var Ee=ie.FileIndex[ke];switch(Ee.type){case 0:ve?ge=!0:(ie.FileIndex.pop(),ie.FullPaths.pop());break;case 1:case 2:case 5:ve=!0,isNaN(Ee.R*Ee.L*Ee.C)&&(ge=!0),Ee.R>-1&&Ee.L>-1&&Ee.R==Ee.L&&(ge=!0);break;default:ge=!0;break}}if(!(!ge&&!Se)){var We=new Date(1987,1,19),Ke=0,ze=Object.create?Object.create(null):{},He=[];for(ke=0;ke<ie.FullPaths.length;++ke)ze[ie.FullPaths[ke]]=!0,ie.FileIndex[ke].type!==0&&He.push([ie.FullPaths[ke],ie.FileIndex[ke]]);for(ke=0;ke<He.length;++ke){var qe=n(He[ke][0]);ve=ze[qe],ve||(He.push([qe,{name:i(qe).replace("/",""),type:1,clsid:Q,ct:We,mt:We,content:null}]),ze[qe]=!0)}for(He.sort(function(_t,gt){return r(_t[0],gt[0])}),ie.FullPaths=[],ie.FileIndex=[],ke=0;ke<He.length;++ke)ie.FullPaths[ke]=He[ke][0],ie.FileIndex[ke]=He[ke][1];for(ke=0;ke<He.length;++ke){var lt=ie.FileIndex[ke],mt=ie.FullPaths[ke];if(lt.name=i(mt).replace("/",""),lt.L=lt.R=lt.C=-(lt.color=1),lt.size=lt.content?lt.content.length:0,lt.start=0,lt.clsid=lt.clsid||Q,ke===0)lt.C=He.length>1?1:-1,lt.size=0,lt.type=5;else if(mt.slice(-1)=="/"){for(Ke=ke+1;Ke<He.length&&n(ie.FullPaths[Ke])!=mt;++Ke);for(lt.C=Ke>=He.length?-1:Ke,Ke=ke+1;Ke<He.length&&n(ie.FullPaths[Ke])!=n(mt);++Ke);lt.R=Ke>=He.length?-1:Ke,lt.type=1}else n(ie.FullPaths[ke+1]||"")==n(mt)&&(lt.R=ke+1),lt.type=2}}}function B(ie,Se){var ge=Se||{};if(ge.fileType=="mad")return Kn(ie,ge);switch(j(ie),ge.fileType){case"zip":return Qt(ie,ge)}var ve=function(_t){for(var gt=0,wt=0,$t=0;$t<_t.FileIndex.length;++$t){var Ar=_t.FileIndex[$t];if(Ar.content){var lr=Ar.content.length;lr>0&&(lr<4096?gt+=lr+63>>6:wt+=lr+511>>9)}}for(var sn=_t.FullPaths.length+3>>2,Ea=gt+7>>3,ta=gt+127>>7,Ta=Ea+wt+sn+ta,Os=Ta+127>>7,Uo=Os<=109?0:Math.ceil((Os-109)/127);Ta+Os+Uo+127>>7>Os;)Uo=++Os<=109?0:Math.ceil((Os-109)/127);var An=[1,Uo,Os,ta,sn,wt,gt,0];return _t.FileIndex[0].size=gt<<6,An[7]=(_t.FileIndex[0].start=An[0]+An[1]+An[2]+An[3]+An[4]+An[5])+(An[6]+7>>3),An}(ie),ke=Je(ve[7]<<9),Ee=0,We=0;{for(Ee=0;Ee<8;++Ee)ke.write_shift(1,re[Ee]);for(Ee=0;Ee<8;++Ee)ke.write_shift(2,0);for(ke.write_shift(2,62),ke.write_shift(2,3),ke.write_shift(2,65534),ke.write_shift(2,9),ke.write_shift(2,6),Ee=0;Ee<3;++Ee)ke.write_shift(2,0);for(ke.write_shift(4,0),ke.write_shift(4,ve[2]),ke.write_shift(4,ve[0]+ve[1]+ve[2]+ve[3]-1),ke.write_shift(4,0),ke.write_shift(4,4096),ke.write_shift(4,ve[3]?ve[0]+ve[1]+ve[2]-1:G),ke.write_shift(4,ve[3]),ke.write_shift(-4,ve[1]?ve[0]-1:G),ke.write_shift(4,ve[1]),Ee=0;Ee<109;++Ee)ke.write_shift(-4,Ee<ve[2]?ve[1]+Ee:-1)}if(ve[1])for(We=0;We<ve[1];++We){for(;Ee<236+We*127;++Ee)ke.write_shift(-4,Ee<ve[2]?ve[1]+Ee:-1);ke.write_shift(-4,We===ve[1]-1?G:We+1)}var Ke=function(_t){for(We+=_t;Ee<We-1;++Ee)ke.write_shift(-4,Ee+1);_t&&(++Ee,ke.write_shift(-4,G))};for(We=Ee=0,We+=ve[1];Ee<We;++Ee)ke.write_shift(-4,ne.DIFSECT);for(We+=ve[2];Ee<We;++Ee)ke.write_shift(-4,ne.FATSECT);Ke(ve[3]),Ke(ve[4]);for(var ze=0,He=0,qe=ie.FileIndex[0];ze<ie.FileIndex.length;++ze)qe=ie.FileIndex[ze],qe.content&&(He=qe.content.length,!(He<4096)&&(qe.start=We,Ke(He+511>>9)));for(Ke(ve[6]+7>>3);ke.l&511;)ke.write_shift(-4,ne.ENDOFCHAIN);for(We=Ee=0,ze=0;ze<ie.FileIndex.length;++ze)qe=ie.FileIndex[ze],qe.content&&(He=qe.content.length,!(!He||He>=4096)&&(qe.start=We,Ke(He+63>>6)));for(;ke.l&511;)ke.write_shift(-4,ne.ENDOFCHAIN);for(Ee=0;Ee<ve[4]<<2;++Ee){var lt=ie.FullPaths[Ee];if(!lt||lt.length===0){for(ze=0;ze<17;++ze)ke.write_shift(4,0);for(ze=0;ze<3;++ze)ke.write_shift(4,-1);for(ze=0;ze<12;++ze)ke.write_shift(4,0);continue}qe=ie.FileIndex[Ee],Ee===0&&(qe.start=qe.size?qe.start-1:G);var mt=Ee===0&&ge.root||qe.name;if(He=2*(mt.length+1),ke.write_shift(64,mt,"utf16le"),ke.write_shift(2,He),ke.write_shift(1,qe.type),ke.write_shift(1,qe.color),ke.write_shift(-4,qe.L),ke.write_shift(-4,qe.R),ke.write_shift(-4,qe.C),qe.clsid)ke.write_shift(16,qe.clsid,"hex");else for(ze=0;ze<4;++ze)ke.write_shift(4,0);ke.write_shift(4,qe.state||0),ke.write_shift(4,0),ke.write_shift(4,0),ke.write_shift(4,0),ke.write_shift(4,0),ke.write_shift(4,qe.start),ke.write_shift(4,qe.size),ke.write_shift(4,0)}for(Ee=1;Ee<ie.FileIndex.length;++Ee)if(qe=ie.FileIndex[Ee],qe.size>=4096)if(ke.l=qe.start+1<<9,sr&&Buffer.isBuffer(qe.content))qe.content.copy(ke,ke.l,0,qe.size),ke.l+=qe.size+511&-512;else{for(ze=0;ze<qe.size;++ze)ke.write_shift(1,qe.content[ze]);for(;ze&511;++ze)ke.write_shift(1,0)}for(Ee=1;Ee<ie.FileIndex.length;++Ee)if(qe=ie.FileIndex[Ee],qe.size>0&&qe.size<4096)if(sr&&Buffer.isBuffer(qe.content))qe.content.copy(ke,ke.l,0,qe.size),ke.l+=qe.size+63&-64;else{for(ze=0;ze<qe.size;++ze)ke.write_shift(1,qe.content[ze]);for(;ze&63;++ze)ke.write_shift(1,0)}if(sr)ke.l=ke.length;else for(;ke.l<ke.length;)ke.write_shift(1,0);return ke}function F(ie,Se){var ge=ie.FullPaths.map(function(ze){return ze.toUpperCase()}),ve=ge.map(function(ze){var He=ze.split("/");return He[He.length-(ze.slice(-1)=="/"?2:1)]}),ke=!1;Se.charCodeAt(0)===47?(ke=!0,Se=ge[0].slice(0,-1)+Se):ke=Se.indexOf("/")!==-1;var Ee=Se.toUpperCase(),We=ke===!0?ge.indexOf(Ee):ve.indexOf(Ee);if(We!==-1)return ie.FileIndex[We];var Ke=!Ee.match(bh);for(Ee=Ee.replace($i,""),Ke&&(Ee=Ee.replace(bh,"!")),We=0;We<ge.length;++We)if((Ke?ge[We].replace(bh,"!"):ge[We]).replace($i,"")==Ee||(Ke?ve[We].replace(bh,"!"):ve[We]).replace($i,"")==Ee)return ie.FileIndex[We];return null}var L=64,G=-2,X="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],Q="00000000000000000000000000000000",ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:G,FREESECT:-1,HEADER_SIGNATURE:X,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function J(ie,Se,ge){c();var ve=B(ie,ge);a.writeFileSync(Se,ve)}function P(ie){for(var Se=new Array(ie.length),ge=0;ge<ie.length;++ge)Se[ge]=String.fromCharCode(ie[ge]);return Se.join("")}function H(ie,Se){var ge=B(ie,Se);switch(Se&&Se.type||"buffer"){case"file":return c(),a.writeFileSync(Se.filename,ge),ge;case"binary":return typeof ge=="string"?ge:P(ge);case"base64":return bd(typeof ge=="string"?ge:P(ge));case"buffer":if(sr)return Buffer.isBuffer(ge)?ge:Ro(ge);case"array":return typeof ge=="string"?ys(ge):ge}return ge}var U;function S(ie){try{var Se=ie.InflateRaw,ge=new Se;if(ge._processChunk(new Uint8Array([3,0]),ge._finishFlushFlag),ge.bytesRead)U=ie;else throw new Error("zlib does not expose bytesRead")}catch(ve){console.error("cannot use native zlib: "+(ve.message||ve))}}function I(ie,Se){if(!U)return Mt(ie,Se);var ge=U.InflateRaw,ve=new ge,ke=ve._processChunk(ie.slice(ie.l),ve._finishFlushFlag);return ie.l+=ve.bytesRead,ke}function O(ie){return U?U.deflateRawSync(ie):Pe(ie)}var N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function K(ie){var Se=(ie<<1|ie<<11)&139536|(ie<<5|ie<<15)&558144;return(Se>>16|Se>>8|Se)&255}for(var Y=typeof Uint8Array<"u",Z=Y?new Uint8Array(256):[],se=0;se<256;++se)Z[se]=K(se);function V(ie,Se){var ge=Z[ie&255];return Se<=8?ge>>>8-Se:(ge=ge<<8|Z[ie>>8&255],Se<=16?ge>>>16-Se:(ge=ge<<8|Z[ie>>16&255],ge>>>24-Se))}function le(ie,Se){var ge=Se&7,ve=Se>>>3;return(ie[ve]|(ge<=6?0:ie[ve+1]<<8))>>>ge&3}function ae(ie,Se){var ge=Se&7,ve=Se>>>3;return(ie[ve]|(ge<=5?0:ie[ve+1]<<8))>>>ge&7}function W(ie,Se){var ge=Se&7,ve=Se>>>3;return(ie[ve]|(ge<=4?0:ie[ve+1]<<8))>>>ge&15}function he(ie,Se){var ge=Se&7,ve=Se>>>3;return(ie[ve]|(ge<=3?0:ie[ve+1]<<8))>>>ge&31}function fe(ie,Se){var ge=Se&7,ve=Se>>>3;return(ie[ve]|(ge<=1?0:ie[ve+1]<<8))>>>ge&127}function Te(ie,Se,ge){var ve=Se&7,ke=Se>>>3,Ee=(1<<ge)-1,We=ie[ke]>>>ve;return ge<8-ve||(We|=ie[ke+1]<<8-ve,ge<16-ve)||(We|=ie[ke+2]<<16-ve,ge<24-ve)||(We|=ie[ke+3]<<24-ve),We&Ee}function be(ie,Se,ge){var ve=Se&7,ke=Se>>>3;return ve<=5?ie[ke]|=(ge&7)<<ve:(ie[ke]|=ge<<ve&255,ie[ke+1]=(ge&7)>>8-ve),Se+3}function pe(ie,Se,ge){var ve=Se&7,ke=Se>>>3;return ge=(ge&1)<<ve,ie[ke]|=ge,Se+1}function xe(ie,Se,ge){var ve=Se&7,ke=Se>>>3;return ge<<=ve,ie[ke]|=ge&255,ge>>>=8,ie[ke+1]=ge,Se+8}function ce(ie,Se,ge){var ve=Se&7,ke=Se>>>3;return ge<<=ve,ie[ke]|=ge&255,ge>>>=8,ie[ke+1]=ge&255,ie[ke+2]=ge>>>8,Se+16}function Ne(ie,Se){var ge=ie.length,ve=2*ge>Se?2*ge:Se+5,ke=0;if(ge>=Se)return ie;if(sr){var Ee=C5(ve);if(ie.copy)ie.copy(Ee);else for(;ke<ie.length;++ke)Ee[ke]=ie[ke];return Ee}else if(Y){var We=new Uint8Array(ve);if(We.set)We.set(ie);else for(;ke<ge;++ke)We[ke]=ie[ke];return We}return ie.length=ve,ie}function Ie(ie){for(var Se=new Array(ie),ge=0;ge<ie;++ge)Se[ge]=0;return Se}function Re(ie,Se,ge){var ve=1,ke=0,Ee=0,We=0,Ke=0,ze=ie.length,He=Y?new Uint16Array(32):Ie(32);for(Ee=0;Ee<32;++Ee)He[Ee]=0;for(Ee=ze;Ee<ge;++Ee)ie[Ee]=0;ze=ie.length;var qe=Y?new Uint16Array(ze):Ie(ze);for(Ee=0;Ee<ze;++Ee)He[ke=ie[Ee]]++,ve<ke&&(ve=ke),qe[Ee]=0;for(He[0]=0,Ee=1;Ee<=ve;++Ee)He[Ee+16]=Ke=Ke+He[Ee-1]<<1;for(Ee=0;Ee<ze;++Ee)Ke=ie[Ee],Ke!=0&&(qe[Ee]=He[Ke+16]++);var lt=0;for(Ee=0;Ee<ze;++Ee)if(lt=ie[Ee],lt!=0)for(Ke=V(qe[Ee],ve)>>ve-lt,We=(1<<ve+4-lt)-1;We>=0;--We)Se[Ke|We<<lt]=lt&15|Ee<<4;return ve}var De=Y?new Uint16Array(512):Ie(512),Me=Y?new Uint16Array(32):Ie(32);if(!Y){for(var Ge=0;Ge<512;++Ge)De[Ge]=0;for(Ge=0;Ge<32;++Ge)Me[Ge]=0}(function(){for(var ie=[],Se=0;Se<32;Se++)ie.push(5);Re(ie,Me,32);var ge=[];for(Se=0;Se<=143;Se++)ge.push(8);for(;Se<=255;Se++)ge.push(9);for(;Se<=279;Se++)ge.push(7);for(;Se<=287;Se++)ge.push(8);Re(ge,De,288)})();var Ae=function(){for(var Se=Y?new Uint8Array(32768):[],ge=0,ve=0;ge<z.length-1;++ge)for(;ve<z[ge+1];++ve)Se[ve]=ge;for(;ve<32768;++ve)Se[ve]=29;var ke=Y?new Uint8Array(259):[];for(ge=0,ve=0;ge<R.length-1;++ge)for(;ve<R[ge+1];++ve)ke[ve]=ge;function Ee(Ke,ze){for(var He=0;He<Ke.length;){var qe=Math.min(65535,Ke.length-He),lt=He+qe==Ke.length;for(ze.write_shift(1,+lt),ze.write_shift(2,qe),ze.write_shift(2,~qe&65535);qe-- >0;)ze[ze.l++]=Ke[He++]}return ze.l}function We(Ke,ze){for(var He=0,qe=0,lt=Y?new Uint16Array(32768):[];qe<Ke.length;){var mt=Math.min(65535,Ke.length-qe);if(mt<10){for(He=be(ze,He,+(qe+mt==Ke.length)),He&7&&(He+=8-(He&7)),ze.l=He/8|0,ze.write_shift(2,mt),ze.write_shift(2,~mt&65535);mt-- >0;)ze[ze.l++]=Ke[qe++];He=ze.l*8;continue}He=be(ze,He,+(qe+mt==Ke.length)+2);for(var _t=0;mt-- >0;){var gt=Ke[qe];_t=(_t<<5^gt)&32767;var wt=-1,$t=0;if((wt=lt[_t])&&(wt|=qe&-32768,wt>qe&&(wt-=32768),wt<qe))for(;Ke[wt+$t]==Ke[qe+$t]&&$t<250;)++$t;if($t>2){gt=ke[$t],gt<=22?He=xe(ze,He,Z[gt+1]>>1)-1:(xe(ze,He,3),He+=5,xe(ze,He,Z[gt-23]>>5),He+=3);var Ar=gt<8?0:gt-4>>2;Ar>0&&(ce(ze,He,$t-R[gt]),He+=Ar),gt=Se[qe-wt],He=xe(ze,He,Z[gt]>>3),He-=3;var lr=gt<4?0:gt-2>>1;lr>0&&(ce(ze,He,qe-wt-z[gt]),He+=lr);for(var sn=0;sn<$t;++sn)lt[_t]=qe&32767,_t=(_t<<5^Ke[qe])&32767,++qe;mt-=$t-1}else gt<=143?gt=gt+48:He=pe(ze,He,1),He=xe(ze,He,Z[gt]),lt[_t]=qe&32767,++qe}He=xe(ze,He,0)-1}return ze.l=(He+7)/8|0,ze.l}return function(ze,He){return ze.length<8?Ee(ze,He):We(ze,He)}}();function Pe(ie){var Se=Je(50+Math.floor(ie.length*1.1)),ge=Ae(ie,Se);return Se.slice(0,ge)}var Ue=Y?new Uint16Array(32768):Ie(32768),Ye=Y?new Uint16Array(32768):Ie(32768),nt=Y?new Uint16Array(128):Ie(128),Qe=1,ht=1;function it(ie,Se){var ge=he(ie,Se)+257;Se+=5;var ve=he(ie,Se)+1;Se+=5;var ke=W(ie,Se)+4;Se+=4;for(var Ee=0,We=Y?new Uint8Array(19):Ie(19),Ke=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ze=1,He=Y?new Uint8Array(8):Ie(8),qe=Y?new Uint8Array(8):Ie(8),lt=We.length,mt=0;mt<ke;++mt)We[N[mt]]=Ee=ae(ie,Se),ze<Ee&&(ze=Ee),He[Ee]++,Se+=3;var _t=0;for(He[0]=0,mt=1;mt<=ze;++mt)qe[mt]=_t=_t+He[mt-1]<<1;for(mt=0;mt<lt;++mt)(_t=We[mt])!=0&&(Ke[mt]=qe[_t]++);var gt=0;for(mt=0;mt<lt;++mt)if(gt=We[mt],gt!=0){_t=Z[Ke[mt]]>>8-gt;for(var wt=(1<<7-gt)-1;wt>=0;--wt)nt[_t|wt<<gt]=gt&7|mt<<3}var $t=[];for(ze=1;$t.length<ge+ve;)switch(_t=nt[fe(ie,Se)],Se+=_t&7,_t>>>=3){case 16:for(Ee=3+le(ie,Se),Se+=2,_t=$t[$t.length-1];Ee-- >0;)$t.push(_t);break;case 17:for(Ee=3+ae(ie,Se),Se+=3;Ee-- >0;)$t.push(0);break;case 18:for(Ee=11+fe(ie,Se),Se+=7;Ee-- >0;)$t.push(0);break;default:$t.push(_t),ze<_t&&(ze=_t);break}var Ar=$t.slice(0,ge),lr=$t.slice(ge);for(mt=ge;mt<286;++mt)Ar[mt]=0;for(mt=ve;mt<30;++mt)lr[mt]=0;return Qe=Re(Ar,Ue,286),ht=Re(lr,Ye,30),Se}function dt(ie,Se){if(ie[0]==3&&!(ie[1]&3))return[Ll(Se),2];for(var ge=0,ve=0,ke=C5(Se||1<<18),Ee=0,We=ke.length>>>0,Ke=0,ze=0;!(ve&1);){if(ve=ae(ie,ge),ge+=3,ve>>>1)ve>>1==1?(Ke=9,ze=5):(ge=it(ie,ge),Ke=Qe,ze=ht);else{ge&7&&(ge+=8-(ge&7));var He=ie[ge>>>3]|ie[(ge>>>3)+1]<<8;if(ge+=32,He>0)for(!Se&&We<Ee+He&&(ke=Ne(ke,Ee+He),We=ke.length);He-- >0;)ke[Ee++]=ie[ge>>>3],ge+=8;continue}for(;;){!Se&&We<Ee+32767&&(ke=Ne(ke,Ee+32767),We=ke.length);var qe=Te(ie,ge,Ke),lt=ve>>>1==1?De[qe]:Ue[qe];if(ge+=lt&15,lt>>>=4,!(lt>>>8&255))ke[Ee++]=lt;else{if(lt==256)break;lt-=257;var mt=lt<8?0:lt-4>>2;mt>5&&(mt=0);var _t=Ee+R[lt];mt>0&&(_t+=Te(ie,ge,mt),ge+=mt),qe=Te(ie,ge,ze),lt=ve>>>1==1?Me[qe]:Ye[qe],ge+=lt&15,lt>>>=4;var gt=lt<4?0:lt-2>>1,wt=z[lt];for(gt>0&&(wt+=Te(ie,ge,gt),ge+=gt),!Se&&We<_t&&(ke=Ne(ke,_t+100),We=ke.length);Ee<_t;)ke[Ee]=ke[Ee-wt],++Ee}}}return Se?[ke,ge+7>>>3]:[ke.slice(0,Ee),ge+7>>>3]}function Mt(ie,Se){var ge=ie.slice(ie.l||0),ve=dt(ge,Se);return ie.l+=ve[1],ve[0]}function bt(ie,Se){if(ie)typeof console<"u"&&console.error(Se);else throw new Error(Se)}function Et(ie,Se){var ge=ie;di(ge,0);var ve=[],ke=[],Ee={FileIndex:ve,FullPaths:ke};T(Ee,{root:Se.root});for(var We=ge.length-4;(ge[We]!=80||ge[We+1]!=75||ge[We+2]!=5||ge[We+3]!=6)&&We>=0;)--We;ge.l=We+4,ge.l+=4;var Ke=ge.read_shift(2);ge.l+=6;var ze=ge.read_shift(4);for(ge.l=ze,We=0;We<Ke;++We){ge.l+=20;var He=ge.read_shift(4),qe=ge.read_shift(4),lt=ge.read_shift(2),mt=ge.read_shift(2),_t=ge.read_shift(2);ge.l+=8;var gt=ge.read_shift(4),wt=o(ge.slice(ge.l+lt,ge.l+lt+mt));ge.l+=lt+mt+_t;var $t=ge.l;ge.l=gt+4,ir(ge,He,qe,Ee,wt),ge.l=$t}return Ee}function ir(ie,Se,ge,ve,ke){ie.l+=2;var Ee=ie.read_shift(2),We=ie.read_shift(2),Ke=l(ie);if(Ee&8257)throw new Error("Unsupported ZIP encryption");for(var ze=ie.read_shift(4),He=ie.read_shift(4),qe=ie.read_shift(4),lt=ie.read_shift(2),mt=ie.read_shift(2),_t="",gt=0;gt<lt;++gt)_t+=String.fromCharCode(ie[ie.l++]);if(mt){var wt=o(ie.slice(ie.l,ie.l+mt));(wt[21589]||{}).mt&&(Ke=wt[21589].mt),((ke||{})[21589]||{}).mt&&(Ke=ke[21589].mt)}ie.l+=mt;var $t=ie.slice(ie.l,ie.l+He);switch(We){case 8:$t=I(ie,qe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+We)}var Ar=!1;Ee&8&&(ze=ie.read_shift(4),ze==134695760&&(ze=ie.read_shift(4),Ar=!0),He=ie.read_shift(4),qe=ie.read_shift(4)),He!=Se&&bt(Ar,"Bad compressed size: "+Se+" != "+He),qe!=ge&&bt(Ar,"Bad uncompressed size: "+ge+" != "+qe),xi(ve,_t,$t,{unsafe:!0,mt:Ke})}function Qt(ie,Se){var ge=Se||{},ve=[],ke=[],Ee=Je(1),We=ge.compression?8:0,Ke=0,ze=0,He=0,qe=0,lt=0,mt=ie.FullPaths[0],_t=mt,gt=ie.FileIndex[0],wt=[],$t=0;for(ze=1;ze<ie.FullPaths.length;++ze)if(_t=ie.FullPaths[ze].slice(mt.length),gt=ie.FileIndex[ze],!(!gt.size||!gt.content||_t=="Sh33tJ5")){var Ar=qe,lr=Je(_t.length);for(He=0;He<_t.length;++He)lr.write_shift(1,_t.charCodeAt(He)&127);lr=lr.slice(0,lr.l),wt[lt]=OI.buf(gt.content,0);var sn=gt.content;We==8&&(sn=O(sn)),Ee=Je(30),Ee.write_shift(4,67324752),Ee.write_shift(2,20),Ee.write_shift(2,Ke),Ee.write_shift(2,We),gt.mt?s(Ee,gt.mt):Ee.write_shift(4,0),Ee.write_shift(-4,wt[lt]),Ee.write_shift(4,sn.length),Ee.write_shift(4,gt.content.length),Ee.write_shift(2,lr.length),Ee.write_shift(2,0),qe+=Ee.length,ve.push(Ee),qe+=lr.length,ve.push(lr),qe+=sn.length,ve.push(sn),Ee=Je(46),Ee.write_shift(4,33639248),Ee.write_shift(2,0),Ee.write_shift(2,20),Ee.write_shift(2,Ke),Ee.write_shift(2,We),Ee.write_shift(4,0),Ee.write_shift(-4,wt[lt]),Ee.write_shift(4,sn.length),Ee.write_shift(4,gt.content.length),Ee.write_shift(2,lr.length),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(4,0),Ee.write_shift(4,Ar),$t+=Ee.l,ke.push(Ee),$t+=lr.length,ke.push(lr),++lt}return Ee=Je(22),Ee.write_shift(4,101010256),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(2,lt),Ee.write_shift(2,lt),Ee.write_shift(4,$t),Ee.write_shift(4,qe),Ee.write_shift(2,0),ti([ti(ve),ti(ke),Ee])}var St={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function cr(ie,Se){if(ie.ctype)return ie.ctype;var ge=ie.name||"",ve=ge.match(/\.([^\.]+)$/);return ve&&St[ve[1]]||Se&&(ve=(ge=Se).match(/[\.\\]([^\.\\])+$/),ve&&St[ve[1]])?St[ve[1]]:"application/octet-stream"}function Zs(ie){for(var Se=bd(ie),ge=[],ve=0;ve<Se.length;ve+=76)ge.push(Se.slice(ve,ve+76));return ge.join(`\r
`)+`\r
`}function Kr(ie){var Se=ie.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(He){var qe=He.charCodeAt(0).toString(16).toUpperCase();return"="+(qe.length==1?"0"+qe:qe)});Se=Se.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Se.charAt(0)==`
`&&(Se="=0D"+Se.slice(1)),Se=Se.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ge=[],ve=Se.split(`\r
`),ke=0;ke<ve.length;++ke){var Ee=ve[ke];if(Ee.length==0){ge.push("");continue}for(var We=0;We<Ee.length;){var Ke=76,ze=Ee.slice(We,We+Ke);ze.charAt(Ke-1)=="="?Ke--:ze.charAt(Ke-2)=="="?Ke-=2:ze.charAt(Ke-3)=="="&&(Ke-=3),ze=Ee.slice(We,We+Ke),We+=Ke,We<Ee.length&&(ze+="="),ge.push(ze)}}return ge.join(`\r
`)}function Gi(ie){for(var Se=[],ge=0;ge<ie.length;++ge){for(var ve=ie[ge];ge<=ie.length&&ve.charAt(ve.length-1)=="=";)ve=ve.slice(0,ve.length-1)+ie[++ge];Se.push(ve)}for(var ke=0;ke<Se.length;++ke)Se[ke]=Se[ke].replace(/[=][0-9A-Fa-f]{2}/g,function(Ee){return String.fromCharCode(parseInt(Ee.slice(1),16))});return ys(Se.join(`\r
`))}function Li(ie,Se,ge){for(var ve="",ke="",Ee="",We,Ke=0;Ke<10;++Ke){var ze=Se[Ke];if(!ze||ze.match(/^\s*$/))break;var He=ze.match(/^(.*?):\s*([^\s].*)$/);if(He)switch(He[1].toLowerCase()){case"content-location":ve=He[2].trim();break;case"content-type":Ee=He[2].trim();break;case"content-transfer-encoding":ke=He[2].trim();break}}switch(++Ke,ke.toLowerCase()){case"base64":We=ys(Ts(Se.slice(Ke).join("")));break;case"quoted-printable":We=Gi(Se.slice(Ke));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ke)}var qe=xi(ie,ve.slice(ge.length),We,{unsafe:!0});Ee&&(qe.ctype=Ee)}function kt(ie,Se){if(P(ie.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ge=Se&&Se.root||"",ve=(sr&&Buffer.isBuffer(ie)?ie.toString("binary"):P(ie)).split(`\r
`),ke=0,Ee="";for(ke=0;ke<ve.length;++ke)if(Ee=ve[ke],!!/^Content-Location:/i.test(Ee)&&(Ee=Ee.slice(Ee.indexOf("file")),ge||(ge=Ee.slice(0,Ee.lastIndexOf("/")+1)),Ee.slice(0,ge.length)!=ge))for(;ge.length>0&&(ge=ge.slice(0,ge.length-1),ge=ge.slice(0,ge.lastIndexOf("/")+1),Ee.slice(0,ge.length)!=ge););var We=(ve[1]||"").match(/boundary="(.*?)"/);if(!We)throw new Error("MAD cannot find boundary");var Ke="--"+(We[1]||""),ze=[],He=[],qe={FileIndex:ze,FullPaths:He};T(qe);var lt,mt=0;for(ke=0;ke<ve.length;++ke){var _t=ve[ke];_t!==Ke&&_t!==Ke+"--"||(mt++&&Li(qe,ve.slice(lt,ke),ge),lt=ke)}return qe}function Kn(ie,Se){var ge=Se||{},ve=ge.boundary||"SheetJS";ve="------="+ve;for(var ke=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ve.slice(2)+'"',"","",""],Ee=ie.FullPaths[0],We=Ee,Ke=ie.FileIndex[0],ze=1;ze<ie.FullPaths.length;++ze)if(We=ie.FullPaths[ze].slice(Ee.length),Ke=ie.FileIndex[ze],!(!Ke.size||!Ke.content||We=="Sh33tJ5")){We=We.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function($t){return"_x"+$t.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function($t){return"_u"+$t.charCodeAt(0).toString(16)+"_"});for(var He=Ke.content,qe=sr&&Buffer.isBuffer(He)?He.toString("binary"):P(He),lt=0,mt=Math.min(1024,qe.length),_t=0,gt=0;gt<=mt;++gt)(_t=qe.charCodeAt(gt))>=32&&_t<128&&++lt;var wt=lt>=mt*4/5;ke.push(ve),ke.push("Content-Location: "+(ge.root||"file:///C:/SheetJS/")+We),ke.push("Content-Transfer-Encoding: "+(wt?"quoted-printable":"base64")),ke.push("Content-Type: "+cr(Ke,We)),ke.push(""),ke.push(wt?Kr(qe):Zs(qe))}return ke.push(ve+`--\r
`),ke.join(`\r
`)}function ea(ie){var Se={};return T(Se,ie),Se}function xi(ie,Se,ge,ve){var ke=ve&&ve.unsafe;ke||T(ie);var Ee=!ke&&Rt.find(ie,Se);if(!Ee){var We=ie.FullPaths[0];Se.slice(0,We.length)==We?We=Se:(We.slice(-1)!="/"&&(We+="/"),We=(We+Se).replace("//","/")),Ee={name:i(Se),type:2},ie.FileIndex.push(Ee),ie.FullPaths.push(We),ke||Rt.utils.cfb_gc(ie)}return Ee.content=ge,Ee.size=ge?ge.length:0,ve&&(ve.CLSID&&(Ee.clsid=ve.CLSID),ve.mt&&(Ee.mt=ve.mt),ve.ct&&(Ee.ct=ve.ct)),Ee}function Xi(ie,Se){T(ie);var ge=Rt.find(ie,Se);if(ge){for(var ve=0;ve<ie.FileIndex.length;++ve)if(ie.FileIndex[ve]==ge)return ie.FileIndex.splice(ve,1),ie.FullPaths.splice(ve,1),!0}return!1}function qr(ie,Se,ge){T(ie);var ve=Rt.find(ie,Se);if(ve){for(var ke=0;ke<ie.FileIndex.length;++ke)if(ie.FileIndex[ke]==ve)return ie.FileIndex[ke].name=i(ge),ie.FullPaths[ke]=ge,!0}return!1}function Nn(ie){j(ie,!0)}return t.find=F,t.read=E,t.parse=f,t.write=H,t.writeFile=J,t.utils={cfb_new:ea,cfb_add:xi,cfb_del:Xi,cfb_mov:qr,cfb_gc:Nn,ReadShift:Mh,CheckField:zC,prep_blob:di,bconcat:ti,use_zlib:S,_deflateRaw:Pe,_inflateRaw:Mt,consts:ne},t}();function PI(e){return typeof e=="string"?i1(e):Array.isArray(e)?nI(e):e}function $d(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=i1(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?qa(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([PI(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=zl(t)),o.write(t),o.close(),t}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("cannot save file "+e)}function FI(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function dn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function j5(e,t){for(var r=[],n=dn(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function a1(e){for(var t=[],r=dn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function o1(e){for(var t=[],r=dn(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function jI(e){for(var t=[],r=dn(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var kg=new Date(1899,11,30,0,0,0);function Yn(e,t){var r=e.getTime(),n=kg.getTime()+(e.getTimezoneOffset()-kg.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var _C=new Date,DI=kg.getTime()+(_C.getTimezoneOffset()-kg.getTimezoneOffset())*6e4,D5=_C.getTimezoneOffset();function l1(e){var t=new Date;return t.setTime(e*24*60*60*1e3+DI),t.getTimezoneOffset()!==D5&&t.setTime(t.getTime()+(t.getTimezoneOffset()-D5)*6e4),t}function LI(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var L5=new Date("2017-02-19T19:06:09.000Z"),bC=isNaN(L5.getFullYear())?new Date("2/19/17"):L5,II=bC.getFullYear()==2017;function $r(e,t){var r=new Date(e);if(II)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(bC.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Rc(e,t){if(sr&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return qa(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return qa(cC(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return qa(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return qa(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Vr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Vr(e[r]));return t}function fn(e,t){for(var r="";r.length<t;)r+=e;return r}function wa(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var RI=["january","february","march","april","may","june","july","august","september","october","november","december"];function xf(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&RI.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var MI=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),l=[s[0]],o=1;o<s.length;++o)l.push(i),l.push(s[o]);return l}}();function SC(e){return e?e.content&&e.type?Rc(e.content,!0):e.data?_h(e.data):e.asNodeBuffer&&sr?_h(e.asNodeBuffer().toString("binary")):e.asBinary?_h(e.asBinary()):e._data&&e._data.getContent?_h(Rc(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function kC(e){if(!e)return null;if(e.data)return S5(e.data);if(e.asNodeBuffer&&sr)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?S5(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function BI(e){return e&&e.name.slice(-4)===".bin"?kC(e):SC(e)}function Us(e,t){for(var r=e.FullPaths||dn(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var l=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||i==l)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function ry(e,t){var r=Us(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Dn(e,t,r){if(!r)return BI(ry(e,t));if(!t)return null;try{return Dn(e,t)}catch{return null}}function ws(e,t,r){if(!r)return SC(ry(e,t));if(!t)return null;try{return ws(e,t)}catch{return null}}function UI(e,t,r){return kC(ry(e,t))}function I5(e){for(var t=e.FullPaths||dn(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function nr(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return sr?n=Ro(r):n=iI(r),Rt.utils.cfb_add(e,t,n)}Rt.utils.cfb_add(e,t,r)}else e.file(t,r)}function ny(){return Rt.utils.cfb_new()}function CC(e,t){switch(t.type){case"base64":return Rt.read(e,{type:"base64"});case"binary":return Rt.read(e,{type:"binary"});case"buffer":case"array":return Rt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Sh(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Tn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,WI=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,R5=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,zI=/<[^>]*>/g,Di=Tn.match(R5)?R5:zI,HI=/<\w*:/,$I=/<(\/?)\w+:/;function Vt(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var l=e.match(WI),o=0,a="",c=0,f="",h="",d=1;if(l)for(c=0;c!=l.length;++c){for(h=l[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(f=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(d=(i=h.charCodeAt(s+1))==34||i==39?1:0,a=h.slice(s+1+d,h.length-d),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=a,n[f.toLowerCase()]=a;else{var u=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[u]&&f.slice(o-3,o)=="ext")continue;n[u]=a,n[u.toLowerCase()]=a}}return n}function Ja(e){return e.replace($I,"<$1")}var EC={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},iy=a1(EC),gr=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(o,a){return EC[o]||String.fromCharCode(parseInt(a,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,a){return String.fromCharCode(parseInt(a,16))});var l=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,l)+r(i.slice(l+3))}}(),sy=/[&<>'"]/g,VI=/[\u0000-\u0008\u000b-\u001f]/g;function Tr(e){var t=e+"";return t.replace(sy,function(r){return iy[r]}).replace(VI,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function M5(e){return Tr(e).replace(/ /g,"_x0020_")}var TC=/[\u0000-\u001f]/g;function ay(e){var t=e+"";return t.replace(sy,function(r){return iy[r]}).replace(/\n/g,"<br/>").replace(TC,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function qI(e){var t=e+"";return t.replace(sy,function(r){return iy[r]}).replace(TC,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var B5=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function GI(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ur(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Qm(e){for(var t="",r=0,n=0,i=0,s=0,l=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=i&63,t+=String.fromCharCode(l);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}l=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function U5(e){var t=Ll(2*e.length),r,n,i=1,s=0,l=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[s++]=l&255,t[s++]=l>>>8,l=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function W5(e){return Ro(e,"binary").toString("utf8")}var lp="foo bar baz",Or=sr&&(W5(lp)==Qm(lp)&&W5||U5(lp)==Qm(lp)&&U5)||Qm,qa=sr?function(e){return Ro(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},kd=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),NC=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),XI=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),YI=/<\/?(?:vt:)?variant>/g,KI=/<(?:vt:)([^>]*)>([\s\S]*)</;function z5(e,t){var r=Vt(e),n=e.match(XI(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var l=s.replace(YI,"").match(KI);l&&i.push({v:Or(l[2]),t:l[1]})}),i}var AC=/(^\s|\s$|\n)/;function pi(e,t){return"<"+e+(t.match(AC)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Cd(e){return dn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function xt(e,t,r){return"<"+e+(r!=null?Cd(r):"")+(t!=null?(t.match(AC)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Av(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function JI(e,t){switch(typeof e){case"string":var r=xt("vt:lpwstr",Tr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return xt((e|0)==e?"vt:i4":"vt:r8",Tr(String(e)));case"boolean":return xt("vt:bool",e?"true":"false")}if(e instanceof Date)return xt("vt:filetime",Av(e));throw new Error("Unable to serialize "+e)}function oy(e){if(sr&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Or(zl(Z2(e)));throw new Error("Bad input format: expected Buffer or string")}var Ed=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Gn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Xc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],xs={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function QI(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function ZI(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,l=n?-t:t;isFinite(l)?l==0?i=s=0:(i=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var H5=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},$5=sr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ro(t)})):H5(e)}:H5,V5=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(So(e,i)));return n.join("").replace($i,"")},ly=sr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace($i,""):V5(e,t,r)}:V5,q5=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},OC=sr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):q5(e,t,r)}:q5,G5=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Pu(e,i)));return n.join("")},Vd=sr?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):G5(t,r,n)}:G5,PC=function(e,t){var r=vs(e,t);return r>0?Vd(e,t+4,t+4+r-1):""},FC=PC,jC=function(e,t){var r=vs(e,t);return r>0?Vd(e,t+4,t+4+r-1):""},DC=jC,LC=function(e,t){var r=2*vs(e,t);return r>0?Vd(e,t+4,t+4+r-1):""},IC=LC,RC=function(t,r){var n=vs(t,r);return n>0?ly(t,r+4,r+4+n):""},MC=RC,BC=function(e,t){var r=vs(e,t);return r>0?Vd(e,t+4,t+4+r):""},UC=BC,WC=function(e,t){return QI(e,t)},Cg=WC,cy=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};sr&&(FC=function(t,r){if(!Buffer.isBuffer(t))return PC(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},DC=function(t,r){if(!Buffer.isBuffer(t))return jC(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},IC=function(t,r){if(!Buffer.isBuffer(t))return LC(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},MC=function(t,r){if(!Buffer.isBuffer(t))return RC(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},UC=function(t,r){if(!Buffer.isBuffer(t))return BC(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Cg=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):WC(t,r)},cy=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Pu=function(e,t){return e[t]},So=function(e,t){return e[t+1]*256+e[t]},e7=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},vs=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},gc=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},t7=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Mh(e,t){var r="",n,i,s=[],l,o,a,c;switch(t){case"dbcs":if(c=this.l,sr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(a=0;a<e;++a)r+=String.fromCharCode(So(this,c)),c+=2;e*=2;break;case"utf8":r=Vd(this,this.l,this.l+e);break;case"utf16le":e*=2,r=ly(this,this.l,this.l+e);break;case"wstr":return Mh.call(this,e,"dbcs");case"lpstr-ansi":r=FC(this,this.l),e=4+vs(this,this.l);break;case"lpstr-cp":r=DC(this,this.l),e=4+vs(this,this.l);break;case"lpwstr":r=IC(this,this.l),e=4+2*vs(this,this.l);break;case"lpp4":e=4+vs(this,this.l),r=MC(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+vs(this,this.l),r=UC(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=Pu(this,this.l+e++))!==0;)s.push(op(l));r=s.join("");break;case"_wstr":for(e=0,r="";(l=So(this,this.l+e))!==0;)s.push(op(l)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,a=0;a<e;++a){if(this.lens&&this.lens.indexOf(c)!==-1)return l=Pu(this,c),this.l=c+1,o=Mh.call(this,e-a,l?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(op(So(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,a=0;a!=e;++a){if(this.lens&&this.lens.indexOf(c)!==-1)return l=Pu(this,c),this.l=c+1,o=Mh.call(this,e-a,l?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(op(Pu(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=Pu(this,this.l),this.l++,n;case 2:return n=(t==="i"?e7:So)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?gc:t7)(this,this.l),this.l+=4,n):(i=vs(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Cg(this,this.l):i=Cg([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=OC(this,this.l,e);break}}return this.l+=e,r}var r7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},n7=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},i7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function s7(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)i7(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var l=t.charCodeAt(i);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,r7(this,t,this.l);break;case 8:if(n=8,r==="f"){ZI(this,t,this.l);break}case 16:break;case-4:n=4,n7(this,t,this.l);break}return this.l+=n,this}function zC(e,t){var r=OC(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function di(e,t){e.l=t,e.read_shift=Mh,e.chk=zC,e.write_shift=s7}function ji(e,t){e.l+=t}function Je(e){var t=Ll(e);return di(t,0),t}function Mo(e,t,r){if(e){var n,i,s;di(e,e.l||0);for(var l=e.length,o=0,a=0;e.l<l;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=Fd[o]||Fd[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;a=e.l+s;var f=c.f&&c.f(e,s,r);if(e.l=a,t(f,c,o))return}}}function ns(){var e=[],t=sr?256:2048,r=function(c){var f=Je(c);return di(f,0),f},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},l=function(){return i(),ti(e)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:l,_bufs:e}}function st(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=Fd[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var l=e.next(s);i<=127?l.write_shift(1,i):(l.write_shift(1,(i&127)+128),l.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&cy(r)&&e.push(r)}}function Bh(e,t,r){var n=Vr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function X5(e,t,r){var n=Vr(e);return n.s=Bh(n.s,t.s,r),n.e=Bh(n.e,t.s,r),n}function Uh(e,t){if(e.cRel&&e.c<0)for(e=Vr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Vr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ht(e);return!e.cRel&&e.cRel!=null&&(r=l7(r)),!e.rRel&&e.rRel!=null&&(r=a7(r)),r}function Zm(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+en(e.s.c)+":"+(e.e.cRel?"":"$")+en(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+En(e.s.r)+":"+(e.e.rRel?"":"$")+En(e.e.r):Uh(e.s,t.biff)+":"+Uh(e.e,t.biff)}function uy(e){return parseInt(o7(e),10)-1}function En(e){return""+(e+1)}function a7(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function o7(e){return e.replace(/\$(\d+)$/,"$1")}function fy(e){for(var t=c7(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function en(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function l7(e){return e.replace(/^([A-Z])/,"$$$1")}function c7(e){return e.replace(/^\$([A-Z])/,"$1")}function u7(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function tn(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Ht(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function is(e){var t=e.indexOf(":");return t==-1?{s:tn(e),e:tn(e)}:{s:tn(e.slice(0,t)),e:tn(e.slice(t+1))}}function er(e,t){return typeof t>"u"||typeof t=="number"?er(e.s,e.e):(typeof e!="string"&&(e=Ht(e)),typeof t!="string"&&(t=Ht(t)),e==t?e:e+":"+t)}function mr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function Y5(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Js(e.z,r?Yn(t):t)}catch{}try{return e.w=Js((e.XF||{}).numFmtId||(r?14:0),r?Yn(t):t)}catch{return""+t}}function Do(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Bo[e.v]||e.v:t==null?Y5(e,e.v):Y5(e,t))}function Hl(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function HC(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),l=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var a=typeof n.origin=="string"?tn(n.origin):n.origin;l=a.r,o=a.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=mr(s["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),l==-1&&(c.e.r=l=f.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[h].length;++d)if(!(typeof t[h][d]>"u")){var u={v:t[h][d]},p=l+h,m=o+d;if(c.s.r>p&&(c.s.r=p),c.s.c>m&&(c.s.c=m),c.e.r<p&&(c.e.r=p),c.e.c<m&&(c.e.c=m),t[h][d]&&typeof t[h][d]=="object"&&!Array.isArray(t[h][d])&&!(t[h][d]instanceof Date))u=t[h][d];else if(Array.isArray(u.v)&&(u.f=t[h][d][1],u.v=u.v[0]),u.v===null)if(u.f)u.t="n";else if(n.nullError)u.t="e",u.v=0;else if(n.sheetStubs)u.t="z";else continue;else typeof u.v=="number"?u.t="n":typeof u.v=="boolean"?u.t="b":u.v instanceof Date?(u.z=n.dateNF||Ut[14],n.cellDates?(u.t="d",u.w=Js(u.z,Yn(u.v))):(u.t="n",u.v=Yn(u.v),u.w=Js(u.z,u.v))):u.t="s";if(i)s[p]||(s[p]=[]),s[p][m]&&s[p][m].z&&(u.z=s[p][m].z),s[p][m]=u;else{var g=Ht({c:m,r:p});s[g]&&s[g].z&&(u.z=s[g].z),s[g]=u}}}return c.s.c<1e7&&(s["!ref"]=er(c)),s}function Af(e,t){return HC(null,e,t)}function f7(e){return e.read_shift(4,"i")}function _a(e,t){return t||(t=Je(4)),t.write_shift(4,e),t}function Pi(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function ri(e,t){var r=!1;return t==null&&(r=!0,t=Je(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function h7(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function d7(e,t){return t||(t=Je(4)),t.write_shift(2,0),t.write_shift(2,0),t}function hy(e,t){var r=e.l,n=e.read_shift(1),i=Pi(e),s=[],l={t:i,h:i};if(n&1){for(var o=e.read_shift(4),a=0;a!=o;++a)s.push(h7(e));l.r=s}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function p7(e,t){var r=!1;return t==null&&(r=!0,t=Je(15+4*e.t.length)),t.write_shift(1,0),ri(e.t,t),r?t.slice(0,t.l):t}var g7=hy;function m7(e,t){var r=!1;return t==null&&(r=!0,t=Je(23+4*e.t.length)),t.write_shift(1,1),ri(e.t,t),t.write_shift(4,1),d7({},t),r?t.slice(0,t.l):t}function Qs(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Yc(e,t){return t==null&&(t=Je(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Kc(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Jc(e,t){return t==null&&(t=Je(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var x7=Pi,$C=ri;function dy(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Eg(e,t){var r=!1;return t==null&&(r=!0,t=Je(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var v7=Pi,Ov=dy,py=Eg;function gy(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?Cg([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):gc(t,0)>>2;return r?i/100:i}function VC(e,t){t==null&&(t=Je(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function qC(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function y7(e,t){return t||(t=Je(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Qc=qC,Of=y7;function Oi(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Mc(e,t){return(t||Je(8)).write_shift(8,e,"f")}function w7(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),a=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=kc[i];c&&(t.rgb=Nd(c));break;case 2:t.rgb=Nd([l,o,a]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Tg(e,t){if(t||(t=Je(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function _7(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function b7(e,t){t||(t=Je(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function GC(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function S7(e){return GC(e,1)}function k7(e){return GC(e,2)}var my=2,Ji=3,cp=11,K5=12,Ng=19,up=64,C7=65,E7=71,T7=4108,N7=4126,Jn=80,XC=81,A7=[Jn,XC],Pv={1:{n:"CodePage",t:my},2:{n:"Category",t:Jn},3:{n:"PresentationFormat",t:Jn},4:{n:"ByteCount",t:Ji},5:{n:"LineCount",t:Ji},6:{n:"ParagraphCount",t:Ji},7:{n:"SlideCount",t:Ji},8:{n:"NoteCount",t:Ji},9:{n:"HiddenCount",t:Ji},10:{n:"MultimediaClipCount",t:Ji},11:{n:"ScaleCrop",t:cp},12:{n:"HeadingPairs",t:T7},13:{n:"TitlesOfParts",t:N7},14:{n:"Manager",t:Jn},15:{n:"Company",t:Jn},16:{n:"LinksUpToDate",t:cp},17:{n:"CharacterCount",t:Ji},19:{n:"SharedDoc",t:cp},22:{n:"HyperlinksChanged",t:cp},23:{n:"AppVersion",t:Ji,p:"version"},24:{n:"DigSig",t:C7},26:{n:"ContentType",t:Jn},27:{n:"ContentStatus",t:Jn},28:{n:"Language",t:Jn},29:{n:"Version",t:Jn},255:{},2147483648:{n:"Locale",t:Ng},2147483651:{n:"Behavior",t:Ng},1919054434:{}},Fv={1:{n:"CodePage",t:my},2:{n:"Title",t:Jn},3:{n:"Subject",t:Jn},4:{n:"Author",t:Jn},5:{n:"Keywords",t:Jn},6:{n:"Comments",t:Jn},7:{n:"Template",t:Jn},8:{n:"LastAuthor",t:Jn},9:{n:"RevNumber",t:Jn},10:{n:"EditTime",t:up},11:{n:"LastPrinted",t:up},12:{n:"CreatedDate",t:up},13:{n:"ModifiedDate",t:up},14:{n:"PageCount",t:Ji},15:{n:"WordCount",t:Ji},16:{n:"CharCount",t:Ji},17:{n:"Thumbnail",t:E7},18:{n:"Application",t:Jn},19:{n:"DocSecurity",t:Ji},255:{},2147483648:{n:"Locale",t:Ng},2147483651:{n:"Behavior",t:Ng},1919054434:{}},J5={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},O7=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function P7(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var F7=P7([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),kc=Vr(F7),Bo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},YC={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},jv={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},fp={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function xy(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function j7(e){var t=xy();if(!e||!e.match)return t;var r={};if((e.match(Di)||[]).forEach(function(n){var i=Vt(n);switch(i[0].replace(HI,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[jv[i.ContentType]]!==void 0&&t[jv[i.ContentType]].push(i.PartName);break}}),t.xmlns!==Gn.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function KC(e,t){var r=jI(jv),n=[],i;n[n.length]=Tn,n[n.length]=xt("Types",null,{xmlns:Gn.CT,"xmlns:xsd":Gn.xsd,"xmlns:xsi":Gn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(a){return xt("Default",null,{Extension:a[0],ContentType:a[1]})}));var s=function(a){e[a]&&e[a].length>0&&(i=e[a][0],n[n.length]=xt("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:fp[a][t.bookType]||fp[a].xlsx}))},l=function(a){(e[a]||[]).forEach(function(c){n[n.length]=xt("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:fp[a][t.bookType]||fp[a].xlsx})})},o=function(a){(e[a]||[]).forEach(function(c){n[n.length]=xt("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[a][0]})})};return s("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var ar={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Td(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Wh(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Di)||[]).forEach(function(i){var s=Vt(i);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Sh(s.Target,t);r[o]=l,n[s.Id]=l}}),r["!id"]=n,r}function af(e){var t=[Tn,xt("Relationships",null,{xmlns:Gn.RELS})];return dn(e["!id"]).forEach(function(r){t[t.length]=xt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function kr(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[ar.HLINK,ar.XPATH,ar.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var D7="application/vnd.oasis.opendocument.spreadsheet";function L7(e,t){for(var r=oy(e),n,i;n=Ed.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Vt(n[0],!1),i.path=="/"&&i.type!==D7)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function I7(e){var t=[Tn];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Q5(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function R7(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function M7(e){var t=[Tn];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Q5(e[r][0],e[r][1])),t.push(R7("",e[r][0]));return t.push(Q5("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function JC(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+wg.version+"</meta:generator></office:meta></office:document-meta>"}var Gs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],B7=function(){for(var e=new Array(Gs.length),t=0;t<Gs.length;++t){var r=Gs[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function QC(e){var t={};e=Or(e);for(var r=0;r<Gs.length;++r){var n=Gs[r],i=e.match(B7[r]);i!=null&&i.length>0&&(t[n[1]]=gr(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=$r(t[n[1]]))}return t}function ex(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Tr(t),n[n.length]=r?xt(e,t,r):pi(e,t))}function ZC(e,t){var r=t||{},n=[Tn,xt("cp:coreProperties",null,{"xmlns:cp":Gn.CORE_PROPS,"xmlns:dc":Gn.dc,"xmlns:dcterms":Gn.dcterms,"xmlns:dcmitype":Gn.dcmitype,"xmlns:xsi":Gn.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&ex("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Av(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&ex("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Av(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Gs.length;++s){var l=Gs[s],o=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&ex(l[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Cc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],eE=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function tE(e,t,r,n){var i=[];if(typeof e=="string")i=z5(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(f){return{v:f}}));var l=typeof t=="string"?z5(t,n).map(function(f){return f.v}):t,o=0,a=0;if(l.length>0)for(var c=0;c!==i.length;c+=2){switch(a=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=a,r.SheetNames=l.slice(o,o+a);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=a,r.DefinedNames=l.slice(o,o+a);break;case"Charts":case"Diagramme":r.Chartsheets=a,r.ChartNames=l.slice(o,o+a);break}o+=a}}function U7(e,t,r){var n={};return t||(t={}),e=Or(e),Cc.forEach(function(i){var s=(e.match(kd(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=gr(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var l=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));l&&l.length>0&&(n[i[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&tE(n.HeadingPairs,n.TitlesOfParts,t,r),t}function rE(e){var t=[],r=xt;return e||(e={}),e.Application="SheetJS",t[t.length]=Tn,t[t.length]=xt("Properties",null,{xmlns:Gn.EXT_PROPS,"xmlns:vt":Gn.vt}),Cc.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Tr(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Tr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var W7=/<[^>]+>[^<]*/g;function z7(e,t){var r={},n="",i=e.match(W7);if(i)for(var s=0;s!=i.length;++s){var l=i[s],o=Vt(l);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=gr(o.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var a=l.split(">"),c=a[0].slice(4),f=a[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=gr(f);break;case"bool":r[n]=Ur(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=$r(f);break;case"cy":case"error":r[n]=gr(f);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,c,a)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function nE(e){var t=[Tn,xt("Properties",null,{xmlns:Gn.CUST_PROPS,"xmlns:vt":Gn.vt})];if(!e)return t.join("");var r=1;return dn(e).forEach(function(i){++r,t[t.length]=xt("property",JI(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Tr(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Dv={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},tx;function H7(e,t,r){tx||(tx=a1(Dv)),t=tx[t]||t,e[t]=r}function $7(e,t){var r=[];return dn(Dv).map(function(n){for(var i=0;i<Gs.length;++i)if(Gs[i][1]==n)return Gs[i];for(i=0;i<Cc.length;++i)if(Cc[i][1]==n)return Cc[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(pi(Dv[n[1]]||n[1],i))}}),xt("DocumentProperties",r.join(""),{xmlns:xs.o})}function V7(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&dn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var l=0;l<Gs.length;++l)if(s==Gs[l][1])return;for(l=0;l<Cc.length;++l)if(s==Cc[l][1])return;for(l=0;l<r.length;++l)if(s==r[l])return;var o=e[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o=String(o),i.push(xt(M5(s),o,{"dt:dt":a}))}}),t&&dn(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var l=t[s],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),i.push(xt(M5(s),l,{"dt:dt":o}))}}),"<"+n+' xmlns="'+xs.o+'">'+i.join("")+"</"+n+">"}function vy(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function q7(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var l=Je(8);return l.write_shift(4,n),l.write_shift(4,i),l}function iE(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function sE(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function aE(e,t,r){return t===31?sE(e):iE(e,t,r)}function Lv(e,t,r){return aE(e,t,r===!1?0:4)}function G7(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return aE(e,t,0)}function X7(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace($i,""),e.l-i&2&&(e.l+=2)}return r}function Y7(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace($i,"");return r}function K7(e){var t=e.l,r=Ag(e,XC);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Ag(e,Ji);return[r,n]}function J7(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(K7(e));return r}function Z5(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),l=e.read_shift(4);n[s]=e.read_shift(l,t===1200?"utf16le":"utf8").replace($i,"").replace(bh,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function oE(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function Q7(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Ag(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==K5&&n!==t&&A7.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===K5?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return iE(e,n,4).replace($i,"");case 31:return sE(e);case 64:return vy(e);case 65:return oE(e);case 71:return Q7(e);case 80:return Lv(e,n,!s.raw).replace($i,"");case 81:return G7(e,n).replace($i,"");case 4108:return J7(e);case 4126:case 4127:return n==4127?X7(e):Y7(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function eS(e,t){var r=Je(4),n=Je(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Je(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=q7(t);break;case 31:case 80:for(n=Je(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return ti([r,n])}function tS(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],l=0,o=0,a=-1,c={};for(l=0;l!=i;++l){var f=e.read_shift(4),h=e.read_shift(4);s[l]=[f,h+r]}s.sort(function(y,w){return y[1]-w[1]});var d={};for(l=0;l!=i;++l){if(e.l!==s[l][1]){var u=!0;if(l>0&&t)switch(t[s[l-1][0]].t){case 2:e.l+2===s[l][1]&&(e.l+=2,u=!1);break;case 80:e.l<=s[l][1]&&(e.l=s[l][1],u=!1);break;case 4108:e.l<=s[l][1]&&(e.l=s[l][1],u=!1);break}if((!t||l==0)&&e.l<=s[l][1]&&(u=!1,e.l=s[l][1]),u)throw new Error("Read Error: Expected address "+s[l][1]+" at "+e.l+" :"+l)}if(t){var p=t[s[l][0]];if(d[p.n]=Ag(e,p.t,{raw:!0}),p.p==="version"&&(d[p.n]=String(d[p.n]>>16)+"."+("0000"+String(d[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(d[p.n]){case 0:d[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ga(o=d[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[p.n])}}else if(s[l][0]===1){if(o=d.CodePage=Ag(e,my),ga(o),a!==-1){var m=e.l;e.l=s[a][1],c=Z5(e,o),e.l=m}}else if(s[l][0]===0){if(o===0){a=l,e.l=s[l+1][1];continue}c=Z5(e,o)}else{var g=c[s[l][0]],x;switch(e[e.l]){case 65:e.l+=4,x=oE(e);break;case 30:e.l+=4,x=Lv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,x=Lv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,x=e.read_shift(4,"i");break;case 19:e.l+=4,x=e.read_shift(4);break;case 5:e.l+=4,x=e.read_shift(8,"f");break;case 11:e.l+=4,x=yn(e,4);break;case 64:e.l+=4,x=$r(vy(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[g]=x}}return e.l=r+n,d}var lE=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Z7(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function rS(e,t,r){var n=Je(8),i=[],s=[],l=8,o=0,a=Je(8),c=Je(8);if(a.write_shift(4,2),a.write_shift(4,1200),c.write_shift(4,1),s.push(a),i.push(c),l+=8+a.length,!t){c=Je(8),c.write_shift(4,0),i.unshift(c);var f=[Je(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(a=Je(8+2*(h.length+1)+(h.length%2?0:2)),a.write_shift(4,o+2),a.write_shift(4,h.length+1),a.write_shift(0,h,"dbcs");a.l!=a.length;)a.write_shift(1,0);f.push(a)}a=ti(f),s.unshift(a),l+=8+a.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(lE.indexOf(e[o][0])>-1||eE.indexOf(e[o][0])>-1)&&e[o][1]!=null){var d=e[o][1],u=0;if(t){u=+t[e[o][0]];var p=r[u];if(p.p=="version"&&typeof d=="string"){var m=d.split(".");d=(+m[0]<<16)+(+m[1]||0)}a=eS(p.t,d)}else{var g=Z7(d);g==-1&&(g=31,d=String(d)),a=eS(g,d)}s.push(a),c=Je(8),c.write_shift(4,t?u:2+o),i.push(c),l+=8+a.length}var x=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,x),x+=s[o].length;return n.write_shift(4,l),n.write_shift(4,s.length),ti([n].concat(i).concat(s))}function nS(e,t,r){var n=e.content;if(!n)return{};di(n,0);var i,s,l,o,a=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),f=n.read_shift(16);if(f!==Rt.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(l=n.read_shift(16),a=n.read_shift(4));var h=tS(n,t),d={SystemIdentifier:c};for(var u in h)d[u]=h[u];if(d.FMTID=s,i===1)return d;if(a-n.l==2&&(n.l+=2),n.l!==a)throw new Error("Length mismatch 2: "+n.l+" !== "+a);var p;try{p=tS(n,null)}catch{}for(u in p)d[u]=p[u];return d.FMTID=[s,l],d}function iS(e,t,r,n,i,s){var l=Je(i?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Rt.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,i?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,i?68:48);var a=rS(e,r,n);if(o.push(a),i){var c=rS(i,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+a.length),o.push(c)}return ti(o)}function sl(e,t){return e.read_shift(t),null}function eR(e,t){t||(t=Je(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function tR(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function yn(e,t){return e.read_shift(t)===1}function zi(e,t){return t||(t=Je(2)),t.write_shift(2,+!!e),t}function Ln(e){return e.read_shift(2,"u")}function Ws(e,t){return t||(t=Je(2)),t.write_shift(2,e),t}function cE(e,t){return tR(e,t,Ln)}function rR(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function uE(e,t,r){return r||(r=Je(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function qd(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var l=n?e.read_shift(n,i):"";return l}function nR(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),l=0,o,a={};i&&(l=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,c);return i&&(e.l+=4*l),n&&(e.l+=o),a.t=f,i||(a.raw="<t>"+a.t+"</t>",a.r=a.t),a}function iR(e){var t=e.t||"",r=Je(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Je(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return ti(i)}function Bc(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Gd(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Bc(e,n,r)}function Zc(e,t,r){if(r.biff>5)return Gd(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function fE(e,t,r){return r||(r=Je(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function sR(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function aR(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace($i,"");return n&&(e.l+=24),i}function oR(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(s>>1,"utf16le").replace($i,"");return r+l}function lR(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return aR(e);case"0303000000000000c000000000000046":return oR(e);default:throw new Error("Unsupported Moniker "+r)}}function hp(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace($i,""):"";return r}function sS(e,t){t||(t=Je(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function cR(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,l,o,a,c="",f,h;i&16&&(s=hp(e,r-e.l)),i&128&&(l=hp(e,r-e.l)),(i&257)===257&&(o=hp(e,r-e.l)),(i&257)===1&&(a=lR(e,r-e.l)),i&8&&(c=hp(e,r-e.l)),i&32&&(f=e.read_shift(16)),i&64&&(h=vy(e)),e.l=r;var d=l||o||a||"";d&&c&&(d+="#"+c),d||(d="#"+c),i&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var u={Target:d};return f&&(u.guid=f),h&&(u.time=h),s&&(u.Tooltip=s),u}function uR(e){var t=Je(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(s==28)n=n.slice(1),sS(n,t);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&sS(i>-1?n.slice(i+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var a=0;n.slice(a*3,a*3+3)=="../"||n.slice(a*3,a*3+3)=="..\\";)++a;for(t.write_shift(2,a),t.write_shift(4,n.length-3*a+1),r=0;r<n.length-3*a;++r)t.write_shift(1,n.charCodeAt(r+3*a)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function hE(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function dE(e,t){var r=hE(e);return r[3]=0,r}function Qa(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Uc(e,t,r,n){return n||(n=Je(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function fR(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function hR(e,t,r){return t===0?"":Zc(e,t,r)}function dR(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[i,s,l]}function pE(e){var t=e.read_shift(2),r=gy(e);return[t,r]}function pR(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=qd(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function c1(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function gE(e,t){return t||(t=Je(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function mE(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var gR=mE;function xE(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function mR(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function xR(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ci(e){e.l+=2,e.l+=e.read_shift(2)}var vR={0:Ci,4:Ci,5:Ci,6:Ci,7:xR,8:Ci,9:Ci,10:Ci,11:Ci,12:Ci,13:mR,14:Ci,15:Ci,16:Ci,17:Ci,18:Ci,19:Ci,20:Ci,21:xE};function yR(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(vR[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function dp(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function yy(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Je(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function wR(e,t){return t===0||e.read_shift(2),1200}function _R(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=Zc(e,0,r);return e.read_shift(t+n-e.l),i}function bR(e,t){var r=!t||t.biff==8,n=Je(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function SR(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function kR(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=qd(e,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:i,dt:s,name:l}}function CR(e,t){var r=!t||t.biff>=8?2:1,n=Je(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function ER(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],l=0;l!=i&&e.l<r;++l)s.push(nR(e));return s.Count=n,s.Unique=i,s}function TR(e,t){var r=Je(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=iR(e[i]);var s=ti([r].concat(n));return s.parts=[r.length].concat(n.map(function(l){return l.length})),s}function NR(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function AR(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function OR(e){var t=fR(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function PR(e){return e.read_shift(2),e.read_shift(4)}function aS(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function FR(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),a=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:l,FirstTab:o,Selected:a,TabRatio:c}}function jR(){var e=Je(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function DR(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function LR(e){var t=Je(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function IR(){}function RR(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=qd(e,0,r),n}function MR(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=Je(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function BR(e){var t=Qa(e);return t.isst=e.read_shift(4),t}function UR(e,t,r,n){var i=Je(10);return Uc(e,t,n,i),i.write_shift(4,r),i}function WR(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=Qa(e);r.biff==2&&e.l++;var s=Gd(e,n-e.l,r);return i.val=s,i}function zR(e,t,r,n,i){var s=!i||i.biff==8,l=Je(8+ +s+(1+s)*r.length);return Uc(e,t,n,l),l.write_shift(2,r.length),s&&l.write_shift(1,1),l.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),l}function HR(e,t,r){var n=e.read_shift(2),i=Zc(e,0,r);return[n,i]}function $R(e,t,r,n){var i=r&&r.biff==5;n||(n=Je(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var VR=Zc;function oS(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),l=e.read_shift(i),o=e.read_shift(2),a=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:l,c:a}}}function qR(e,t){var r=t.biff==8||!t.biff?4:2,n=Je(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function GR(e){var t=e.read_shift(2),r=e.read_shift(2),n=pE(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function XR(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(pE(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(s.length!=l-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:l,rkrec:s}}function YR(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(s.length!=l-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:l,ixfe:s}}function KR(e,t,r,n){var i={},s=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(4),a=e.read_shift(2);return i.patternType=O7[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=l&15,i.dgRight=l>>4&15,i.dgTop=l>>8&15,i.dgBottom=l>>12&15,i.icvLeft=l>>16&127,i.icvRight=l>>23&127,i.grbitDiag=l>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=a&127,i.icvBack=a>>7&127,i.fsxButton=a>>14&1),i}function JR(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=KR(e,t,n.fStyle,r),n}function lS(e,t,r,n){var i=r&&r.biff==5;n||(n=Je(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function QR(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function ZR(e){var t=Je(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function cS(e,t,r){var n=Qa(e);(r.biff==2||t==9)&&++e.l;var i=rR(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function eM(e,t,r,n,i,s){var l=Je(8);return Uc(e,t,n,l),uE(r,s,l),l}function tM(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Qa(e),i=Oi(e);return n.val=i,n}function rM(e,t,r,n){var i=Je(14);return Uc(e,t,n,i),Mc(r,i),i}var uS=hR;function nM(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=Bc(e,s),o=[];n>e.l;)o.push(Gd(e));return[s,i,l,o]}function fS(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=pR(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var iM=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function hS(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),a=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),a=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=Bc(e,l,r);i&32&&(c=iM[c.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var h=n==e.l||o===0||!(f>0)?[]:yW(e,f,r,o);return{chKey:s,Name:c,itab:a,rgce:h}}function vE(e,t,r){if(r.biff<8)return sM(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(dR(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function sM(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=qd(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function aM(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=Bc(e,n,r),l=Bc(e,i,r);return[s,l]}function oM(e,t,r){var n=mE(e);e.l++;var i=e.read_shift(1);return t-=8,[wW(e,t,r),i,n]}function dS(e,t,r){var n=gR(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,xW(e,t,r)]}function lM(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function cM(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=Zc(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},o,l,s]}}function uM(e,t,r){return cM(e,t,r)}function fM(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(c1(e));return r}function hM(e){var t=Je(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)gE(e[r],t);return t}function dM(e,t,r){if(r&&r.biff<8)return gM(e,t,r);var n=xE(e),i=yR(e,t-22,n[1]);return{cmo:n,ft:i}}var pM={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function gM(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((pM[n]||ji)(e,t,r)),{cmo:[i,n,s],ft:l}}function mM(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:l=sR(e,6,r);var o=e.read_shift(2);e.read_shift(2),Ln(e,2);var a=e.read_shift(2);e.l+=a;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var f=e[e.l],h=Bc(e,e.lens[c+1]-e.lens[c]-1);if(i+=h,i.length>=(f?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function xM(e,t){var r=c1(e);e.l+=16;var n=cR(e,t-24);return[r,n]}function vM(e){var t=Je(24),r=tn(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return ti([t,uR(e[1])])}function yM(e,t){e.read_shift(2);var r=c1(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace($i,""),[r,n]}function wM(e){var t=e[1].Tooltip,r=Je(10+2*(t.length+1));r.write_shift(2,2048);var n=tn(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function _M(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=J5[r]||r,r=e.read_shift(2),t[1]=J5[r]||r,t}function bM(e){return e||(e=Je(4)),e.write_shift(2,1),e.write_shift(2,1),e}function SM(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(dE(e));return r}function kM(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(dE(e));return r}function CM(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function yE(e,t,r){if(!r.cellStyles)return ji(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(n),a=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:s,w:l,ixfe:o,flags:a};return(r.biff>=5||!r.biff)&&(c.level=a>>8&7),c}function EM(e,t){var r=Je(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function TM(e,t){var r={};return t<32||(e.l+=16,r.header=Oi(e),r.footer=Oi(e),e.l+=2),r}function NM(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}function AM(e){for(var t=Je(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var OM=Qa,PM=cE,FM=Gd;function jM(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function DM(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Qa(e);++e.l;var i=Zc(e,t-7,r);return n.t="str",n.val=i,n}function LM(e){var t=Qa(e);++e.l;var r=Oi(e);return t.t="n",t.val=r,t}function IM(e,t,r){var n=Je(15);return Jd(n,e,t),n.write_shift(8,r,"f"),n}function RM(e){var t=Qa(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function MM(e,t,r){var n=Je(9);return Jd(n,e,t),n.write_shift(2,r),n}function BM(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function UM(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function WM(e,t,r){var n=e.l+t,i=Qa(e),s=e.read_shift(2),l=Bc(e,s,r);return e.l=n,i.t="str",i.val=l,i}var zM=[2,3,48,49,131,139,140,245],Iv=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=a1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,a){var c=[],f=Ll(1);switch(a.type){case"base64":f=ys(Ts(o));break;case"binary":f=ys(o);break;case"buffer":case"array":f=o;break}di(f,0);var h=f.read_shift(1),d=!!(h&136),u=!1,p=!1;switch(h){case 2:break;case 3:break;case 48:u=!0,d=!0;break;case 49:u=!0,d=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,g=521;h==2&&(m=f.read_shift(2)),f.l+=3,h!=2&&(m=f.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(g=f.read_shift(2));var x=f.read_shift(2),y=a.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(y=e[f[f.l]]),f.l+=1,f.l+=2),p&&(f.l+=36);for(var w=[],_={},C=Math.min(f.length,h==2?521:g-10-(u?264:0)),E=p?32:11;f.l<C&&f[f.l]!=13;)switch(_={},_.name=_d.utils.decode(y,f.slice(f.l,f.l+E)).replace(/[\u0000\r\n].*$/g,""),f.l+=E,_.type=String.fromCharCode(f.read_shift(1)),h!=2&&!p&&(_.offset=f.read_shift(4)),_.len=f.read_shift(1),h==2&&(_.offset=f.read_shift(2)),_.dec=f.read_shift(1),_.name.length&&w.push(_),h!=2&&(f.l+=p?13:14),_.type){case"B":(!u||_.len!=8)&&a.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":a.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(f[f.l]!==13&&(f.l=g-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=g;var T=0,A=0;for(c[0]=[],A=0;A!=w.length;++A)c[0][A]=w[A].name;for(;m-- >0;){if(f[f.l]===42){f.l+=x;continue}for(++f.l,c[++T]=[],A=0,A=0;A!=w.length;++A){var j=f.slice(f.l,f.l+w[A].len);f.l+=w[A].len,di(j,0);var B=_d.utils.decode(y,j);switch(w[A].type){case"C":B.trim().length&&(c[T][A]=B.replace(/\s+$/,""));break;case"D":B.length===8?c[T][A]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):c[T][A]=B;break;case"F":c[T][A]=parseFloat(B.trim());break;case"+":case"I":c[T][A]=p?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":c[T][A]=!0;break;case"N":case"F":c[T][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[T][A]="##MEMO##"+(p?parseInt(B.trim(),10):j.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(c[T][A]=+B||0);break;case"@":c[T][A]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":c[T][A]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":c[T][A]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[T][A]=-j.read_shift(-8,"f");break;case"B":if(u&&w[A].len==8){c[T][A]=j.read_shift(8,"f");break}case"G":case"P":j.l+=w[A].len;break;case"0":if(w[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[A].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return a&&a.sheetRows&&(c=c.slice(0,a.sheetRows)),a.DBF=w,c}function n(o,a){var c=a||{};c.dateNF||(c.dateNF="yyyymmdd");var f=Af(r(o,c),c);return f["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,f}function i(o,a){try{return Hl(n(o,a),a)}catch(c){if(a&&a.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,a){var c=a||{};if(+c.codepage>=0&&ga(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=ns(),h=Fg(o,{header:1,raw:!0,cellDates:!0}),d=h[0],u=h.slice(1),p=o["!cols"]||[],m=0,g=0,x=0,y=1;for(m=0;m<d.length;++m){if(((p[m]||{}).DBF||{}).name){d[m]=p[m].DBF.name,++x;continue}if(d[m]!=null){if(++x,typeof d[m]=="number"&&(d[m]=d[m].toString(10)),typeof d[m]!="string")throw new Error("DBF Invalid column name "+d[m]+" |"+typeof d[m]+"|");if(d.indexOf(d[m])!==m){for(g=0;g<1024;++g)if(d.indexOf(d[m]+"_"+g)==-1){d[m]+="_"+g;break}}}}var w=mr(o["!ref"]),_=[],C=[],E=[];for(m=0;m<=w.e.c-w.s.c;++m){var T="",A="",j=0,B=[];for(g=0;g<u.length;++g)u[g][m]!=null&&B.push(u[g][m]);if(B.length==0||d[m]==null){_[m]="?";continue}for(g=0;g<B.length;++g){switch(typeof B[g]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=B[g]instanceof Date?"D":"C";break;default:A="C"}j=Math.max(j,String(B[g]).length),T=T&&T!=A?"C":A}j>250&&(j=250),A=((p[m]||{}).DBF||{}).type,A=="C"&&p[m].DBF.len>j&&(j=p[m].DBF.len),T=="B"&&A=="N"&&(T="N",E[m]=p[m].DBF.dec,j=p[m].DBF.len),C[m]=T=="C"||A=="N"?j:s[T]||0,y+=C[m],_[m]=T}var F=f.next(32);for(F.write_shift(4,318902576),F.write_shift(4,u.length),F.write_shift(2,296+32*x),F.write_shift(2,y),m=0;m<4;++m)F.write_shift(4,0);for(F.write_shift(4,0|(+t[lC]||3)<<8),m=0,g=0;m<d.length;++m)if(d[m]!=null){var L=f.next(32),G=(d[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,G,"sbcs"),L.write_shift(1,_[m]=="?"?"C":_[m],"sbcs"),L.write_shift(4,g),L.write_shift(1,C[m]||s[_[m]]||0),L.write_shift(1,E[m]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),g+=C[m]||s[_[m]]||0}var X=f.next(264);for(X.write_shift(4,13),m=0;m<65;++m)X.write_shift(4,0);for(m=0;m<u.length;++m){var re=f.next(y);for(re.write_shift(1,0),g=0;g<d.length;++g)if(d[g]!=null)switch(_[g]){case"L":re.write_shift(1,u[m][g]==null?63:u[m][g]?84:70);break;case"B":re.write_shift(8,u[m][g]||0,"f");break;case"N":var Q="0";for(typeof u[m][g]=="number"&&(Q=u[m][g].toFixed(E[g]||0)),x=0;x<C[g]-Q.length;++x)re.write_shift(1,32);re.write_shift(1,Q,"sbcs");break;case"D":u[m][g]?(re.write_shift(4,("0000"+u[m][g].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(u[m][g].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+u[m][g].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var ne=String(u[m][g]!=null?u[m][g]:"").slice(0,C[g]);for(re.write_shift(1,ne,"sbcs"),x=0;x<C[g]-ne.length;++x)re.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:l}}(),wE=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+dn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,u){var p=e[u];return typeof p=="number"?k5(p):p},n=function(d,u,p){var m=u.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return m==59?d:k5(m)};e["|"]=254;function i(d,u){switch(u.type){case"base64":return s(Ts(d),u);case"binary":return s(d,u);case"buffer":return s(sr&&Buffer.isBuffer(d)?d.toString("binary"):zl(d),u);case"array":return s(Rc(d),u)}throw new Error("Unrecognized type "+u.type)}function s(d,u){var p=d.split(/[\n\r]+/),m=-1,g=-1,x=0,y=0,w=[],_=[],C=null,E={},T=[],A=[],j=[],B=0,F;for(+u.codepage>=0&&ga(+u.codepage);x!==p.length;++x){B=0;var L=p[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),G=L.replace(/;;/g,"\0").split(";").map(function(N){return N.replace(/\u0000/g,";")}),X=G[0],re;if(L.length>0)switch(X){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":G[1].charAt(0)=="P"&&_.push(L.slice(3).replace(/;;/g,";"));break;case"C":var Q=!1,ne=!1,J=!1,P=!1,H=-1,U=-1;for(y=1;y<G.length;++y)switch(G[y].charAt(0)){case"A":break;case"X":g=parseInt(G[y].slice(1))-1,ne=!0;break;case"Y":for(m=parseInt(G[y].slice(1))-1,ne||(g=0),F=w.length;F<=m;++F)w[F]=[];break;case"K":re=G[y].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(wa(re))?isNaN(xf(re).getDate())||(re=$r(re)):(re=wa(re),C!==null&&Tf(C)&&(re=l1(re))),Q=!0;break;case"E":P=!0;var S=of(G[y].slice(1),{r:m,c:g});w[m][g]=[w[m][g],S];break;case"S":J=!0,w[m][g]=[w[m][g],"S5S"];break;case"G":break;case"R":H=parseInt(G[y].slice(1))-1;break;case"C":U=parseInt(G[y].slice(1))-1;break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+L)}if(Q&&(w[m][g]&&w[m][g].length==2?w[m][g][0]=re:w[m][g]=re,C=null),J){if(P)throw new Error("SYLK shared formula cannot have own formula");var I=H>-1&&w[H][U];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");w[m][g][1]=ME(I[1],{r:m-H,c:g-U})}break;case"F":var O=0;for(y=1;y<G.length;++y)switch(G[y].charAt(0)){case"X":g=parseInt(G[y].slice(1))-1,++O;break;case"Y":for(m=parseInt(G[y].slice(1))-1,F=w.length;F<=m;++F)w[F]=[];break;case"M":B=parseInt(G[y].slice(1))/20;break;case"F":break;case"G":break;case"P":C=_[parseInt(G[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=G[y].slice(1).split(" "),F=parseInt(j[0],10);F<=parseInt(j[1],10);++F)B=parseInt(j[2],10),A[F-1]=B===0?{hidden:!0}:{wch:B},Il(A[F-1]);break;case"C":g=parseInt(G[y].slice(1))-1,A[g]||(A[g]={});break;case"R":m=parseInt(G[y].slice(1))-1,T[m]||(T[m]={}),B>0?(T[m].hpt=B,T[m].hpx=yf(B)):B===0&&(T[m].hidden=!0);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+L)}O<1&&(C=null);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+L)}}return T.length>0&&(E["!rows"]=T),A.length>0&&(E["!cols"]=A),u&&u.sheetRows&&(w=w.slice(0,u.sheetRows)),[w,E]}function l(d,u){var p=i(d,u),m=p[0],g=p[1],x=Af(m,u);return dn(g).forEach(function(y){x[y]=g[y]}),x}function o(d,u){return Hl(l(d,u),u)}function a(d,u,p,m){var g="C;Y"+(p+1)+";X"+(m+1)+";K";switch(d.t){case"n":g+=d.v||0,d.f&&!d.F&&(g+=";E"+Cy(d.f,{r:p,c:m}));break;case"b":g+=d.v?"TRUE":"FALSE";break;case"e":g+=d.w||d.v;break;case"d":g+='"'+(d.w||d.v)+'"';break;case"s":g+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(d,u){u.forEach(function(p,m){var g="F;W"+(m+1)+" "+(m+1)+" ";p.hidden?g+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Ad(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Od(p.wpx)),typeof p.wch=="number"&&(g+=Math.round(p.wch))),g.charAt(g.length-1)!=" "&&d.push(g)})}function f(d,u){u.forEach(function(p,m){var g="F;";p.hidden?g+="M0;":p.hpt?g+="M"+20*p.hpt+";":p.hpx&&(g+="M"+20*Pd(p.hpx)+";"),g.length>2&&d.push(g+"R"+(m+1))})}function h(d,u){var p=["ID;PWXL;N;E"],m=[],g=mr(d["!ref"]),x,y=Array.isArray(d),w=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),d["!cols"]&&c(p,d["!cols"]),d["!rows"]&&f(p,d["!rows"]),p.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var _=g.s.r;_<=g.e.r;++_)for(var C=g.s.c;C<=g.e.c;++C){var E=Ht({r:_,c:C});x=y?(d[_]||[])[C]:d[E],!(!x||x.v==null&&(!x.f||x.F))&&m.push(a(x,d,_,C))}return p.join(w)+w+m.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:l,from_sheet:h}}(),_E=function(){function e(s,l){switch(l.type){case"base64":return t(Ts(s),l);case"binary":return t(s,l);case"buffer":return t(sr&&Buffer.isBuffer(s)?s.toString("binary"):zl(s),l);case"array":return t(Rc(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){for(var o=s.split(`
`),a=-1,c=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++a]=[],c=0;continue}if(!(a<0)){var d=o[f].trim().split(","),u=d[0],p=d[1];++f;for(var m=o[f]||"";(m.match(/["]/g)||[]).length&1&&f<o.length-1;)m+=`
`+o[++f];switch(m=m.trim(),+u){case-1:if(m==="BOT"){h[++a]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[a][c]=!0:m==="FALSE"?h[a][c]=!1:isNaN(wa(p))?isNaN(xf(p).getDate())?h[a][c]=p:h[a][c]=$r(p):h[a][c]=wa(p),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[a][c++]=m!==""?m:null;break}if(m==="EOD")break}}return l&&l.sheetRows&&(h=h.slice(0,l.sheetRows)),h}function r(s,l){return Af(e(s,l),l)}function n(s,l){return Hl(r(s,l),l)}var i=function(){var s=function(a,c,f,h,d){a.push(c),a.push(f+","+h),a.push('"'+d.replace(/"/g,'""')+'"')},l=function(a,c,f,h){a.push(c+","+f),a.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(a){var c=[],f=mr(a["!ref"]),h,d=Array.isArray(a);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,f.e.r-f.s.r+1,""),s(c,"TUPLES",0,f.e.c-f.s.c+1,""),s(c,"DATA",0,0,"");for(var u=f.s.r;u<=f.e.r;++u){l(c,-1,0,"BOT");for(var p=f.s.c;p<=f.e.c;++p){var m=Ht({r:u,c:p});if(h=d?(a[u]||[])[p]:a[m],!h){l(c,1,0,"");continue}switch(h.t){case"n":var g=h.w;!g&&h.v!=null&&(g=h.v),g==null?h.f&&!h.F?l(c,1,0,"="+h.f):l(c,1,0,""):l(c,0,g,"V");break;case"b":l(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":l(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Js(h.z||Ut[14],Yn($r(h.v)))),l(c,0,h.w,"V");break;default:l(c,1,0,"")}}}l(c,-1,0,"EOD");var x=`\r
`,y=c.join(x);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),bE=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var u=h.split(`
`),p=-1,m=-1,g=0,x=[];g!==u.length;++g){var y=u[g].trim().split(":");if(y[0]==="cell"){var w=tn(y[1]);if(x.length<=w.r)for(p=x.length;p<=w.r;++p)x[p]||(x[p]=[]);switch(p=w.r,m=w.c,y[2]){case"t":x[p][m]=e(y[3]);break;case"v":x[p][m]=+y[3];break;case"vtf":var _=y[y.length-1];case"vtc":switch(y[3]){case"nl":x[p][m]=!!+y[4];break;default:x[p][m]=+y[4];break}y[2]=="vtf"&&(x[p][m]=[x[p][m],_])}}}return d&&d.sheetRows&&(x=x.slice(0,d.sheetRows)),x}function n(h,d){return Af(r(h,d),d)}function i(h,d){return Hl(n(h,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),a="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],u=[],p,m="",g=is(h["!ref"]),x=Array.isArray(h),y=g.s.r;y<=g.e.r;++y)for(var w=g.s.c;w<=g.e.c;++w)if(m=Ht({r:y,c:w}),p=x?(h[y]||[])[w]:h[m],!(!p||p.v==null||p.t==="z")){switch(u=["cell",m,"t"],p.t){case"s":case"str":u.push(t(p.v));break;case"n":p.f?(u[2]="vtf",u[3]="n",u[4]=p.v,u[5]=t(p.f)):(u[2]="v",u[3]=p.v);break;case"b":u[2]="vt"+(p.f?"f":"c"),u[3]="nl",u[4]=p.v?"1":"0",u[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var _=Yn($r(p.v));u[2]="vtc",u[3]="nd",u[4]=""+_,u[5]=p.w||Js(p.z||Ut[14],_);break;case"e":continue}d.push(u.join(":"))}return d.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(h){return[s,l,o,l,c(h),a].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),vf=function(){function e(f,h,d,u,p){p.raw?h[d][u]=f:f===""||(f==="TRUE"?h[d][u]=!0:f==="FALSE"?h[d][u]=!1:isNaN(wa(f))?isNaN(xf(f).getDate())?h[d][u]=f:h[d][u]=$r(f):h[d][u]=wa(f))}function t(f,h){var d=h||{},u=[];if(!f||f.length===0)return u;for(var p=f.split(/[\r\n]/),m=p.length-1;m>=0&&p[m].length===0;)--m;for(var g=10,x=0,y=0;y<=m;++y)x=p[y].indexOf(" "),x==-1?x=p[y].length:x++,g=Math.max(g,x);for(y=0;y<=m;++y){u[y]=[];var w=0;for(e(p[y].slice(0,g).trim(),u,y,w,d),w=1;w<=(p[y].length-g)/10+1;++w)e(p[y].slice(g+(w-1)*10,g+w*10).trim(),u,y,w,d)}return d.sheetRows&&(u=u.slice(0,d.sheetRows)),u}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var h={},d=!1,u=0,p=0;u<f.length;++u)(p=f.charCodeAt(u))==34?d=!d:!d&&p in r&&(h[p]=(h[p]||0)+1);p=[];for(u in h)Object.prototype.hasOwnProperty.call(h,u)&&p.push([h[u],u]);if(!p.length){h=n;for(u in h)Object.prototype.hasOwnProperty.call(h,u)&&p.push([h[u],u])}return p.sort(function(m,g){return m[0]-g[0]||n[m[1]]-n[g[1]]}),r[p.pop()[1]]||44}function s(f,h){var d=h||{},u="",p=d.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(u=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(u=f.charAt(4),f=f.slice(6)):u=i(f.slice(0,1024)):d&&d.FS?u=d.FS:u=i(f.slice(0,1024));var g=0,x=0,y=0,w=0,_=0,C=u.charCodeAt(0),E=!1,T=0,A=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var j=d.dateNF!=null?NI(d.dateNF):null;function B(){var F=f.slice(w,_),L={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)L.t="z";else if(d.raw)L.t="s",L.v=F;else if(F.trim().length===0)L.t="s",L.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(L.t="s",L.v=F.slice(2,-1).replace(/""/g,'"')):nU(F)?(L.t="n",L.f=F.slice(1)):(L.t="s",L.v=F);else if(F=="TRUE")L.t="b",L.v=!0;else if(F=="FALSE")L.t="b",L.v=!1;else if(!isNaN(y=wa(F)))L.t="n",d.cellText!==!1&&(L.w=F),L.v=y;else if(!isNaN(xf(F).getDate())||j&&F.match(j)){L.z=d.dateNF||Ut[14];var G=0;j&&F.match(j)&&(F=AI(F,d.dateNF,F.match(j)||[]),G=1),d.cellDates?(L.t="d",L.v=$r(F,G)):(L.t="n",L.v=Yn($r(F,G))),d.cellText!==!1&&(L.w=Js(L.z,L.v instanceof Date?Yn(L.v):L.v)),d.cellNF||delete L.z}else L.t="s",L.v=F;if(L.t=="z"||(d.dense?(p[g]||(p[g]=[]),p[g][x]=L):p[Ht({c:x,r:g})]=L),w=_+1,A=f.charCodeAt(w),m.e.c<x&&(m.e.c=x),m.e.r<g&&(m.e.r=g),T==C)++x;else if(x=0,++g,d.sheetRows&&d.sheetRows<=g)return!0}e:for(;_<f.length;++_)switch(T=f.charCodeAt(_)){case 34:A===34&&(E=!E);break;case C:case 10:case 13:if(!E&&B())break e;break}return _-w>0&&B(),p["!ref"]=er(m),p}function l(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,h):Af(t(f,h),h)}function o(f,h){var d="",u=h.type=="string"?[0,0,0,0]:jy(f,h);switch(h.type){case"base64":d=Ts(f);break;case"binary":d=f;break;case"buffer":h.codepage==65001?d=f.toString("utf8"):h.codepage&&typeof _d<"u"||(d=sr&&Buffer.isBuffer(f)?f.toString("binary"):zl(f));break;case"array":d=Rc(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+h.type)}return u[0]==239&&u[1]==187&&u[2]==191?d=Or(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=Or(d):h.type=="binary"&&typeof _d<"u",d.slice(0,19)=="socialcalc:version:"?bE.to_sheet(h.type=="string"?d:Or(d),h):l(d,h)}function a(f,h){return Hl(o(f,h),h)}function c(f){for(var h=[],d=mr(f["!ref"]),u,p=Array.isArray(f),m=d.s.r;m<=d.e.r;++m){for(var g=[],x=d.s.c;x<=d.e.c;++x){var y=Ht({r:m,c:x});if(u=p?(f[m]||[])[x]:f[y],!u||u.v==null){g.push("          ");continue}for(var w=(u.w||(Do(u),u.w)||"").slice(0,10);w.length<10;)w+=" ";g.push(w+(x===0?" ":""))}h.push(g.join(""))}return h.join(`
`)}return{to_workbook:a,to_sheet:o,from_sheet:c}}();function HM(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=wE.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return vf.to_workbook(e,t)}}var Ec=function(){function e(S,I,O){if(S){di(S,S.l||0);for(var N=O.Enum||H;S.l<S.length;){var R=S.read_shift(2),z=N[R]||N[65535],K=S.read_shift(2),Y=S.l+K,Z=z.f&&z.f(S,K,O);if(S.l=Y,I(Z,z,R))return}}}function t(S,I){switch(I.type){case"base64":return r(ys(Ts(S)),I);case"binary":return r(ys(S),I);case"buffer":case"array":return r(S,I)}throw"Unsupported type "+I.type}function r(S,I){if(!S)return S;var O=I||{},N=O.dense?[]:{},R="Sheet1",z="",K=0,Y={},Z=[],se=[],V={s:{r:0,c:0},e:{r:0,c:0}},le=O.sheetRows||0;if(S[2]==0&&(S[3]==8||S[3]==9)&&S.length>=16&&S[14]==5&&S[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(S[2]==2)O.Enum=H,e(S,function(fe,Te,be){switch(be){case 0:O.vers=fe,fe>=4096&&(O.qpro=!0);break;case 6:V=fe;break;case 204:fe&&(z=fe);break;case 222:z=fe;break;case 15:case 51:O.qpro||(fe[1].v=fe[1].v.slice(1));case 13:case 14:case 16:be==14&&(fe[2]&112)==112&&(fe[2]&15)>1&&(fe[2]&15)<15&&(fe[1].z=O.dateNF||Ut[14],O.cellDates&&(fe[1].t="d",fe[1].v=l1(fe[1].v))),O.qpro&&fe[3]>K&&(N["!ref"]=er(V),Y[R]=N,Z.push(R),N=O.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},K=fe[3],R=z||"Sheet"+(K+1),z="");var pe=O.dense?(N[fe[0].r]||[])[fe[0].c]:N[Ht(fe[0])];if(pe){pe.t=fe[1].t,pe.v=fe[1].v,fe[1].z!=null&&(pe.z=fe[1].z),fe[1].f!=null&&(pe.f=fe[1].f);break}O.dense?(N[fe[0].r]||(N[fe[0].r]=[]),N[fe[0].r][fe[0].c]=fe[1]):N[Ht(fe[0])]=fe[1];break}},O);else if(S[2]==26||S[2]==14)O.Enum=U,S[2]==14&&(O.qpro=!0,S.l=0),e(S,function(fe,Te,be){switch(be){case 204:R=fe;break;case 22:fe[1].v=fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(fe[3]>K&&(N["!ref"]=er(V),Y[R]=N,Z.push(R),N=O.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},K=fe[3],R="Sheet"+(K+1)),le>0&&fe[0].r>=le)break;O.dense?(N[fe[0].r]||(N[fe[0].r]=[]),N[fe[0].r][fe[0].c]=fe[1]):N[Ht(fe[0])]=fe[1],V.e.c<fe[0].c&&(V.e.c=fe[0].c),V.e.r<fe[0].r&&(V.e.r=fe[0].r);break;case 27:fe[14e3]&&(se[fe[14e3][0]]=fe[14e3][1]);break;case 1537:se[fe[0]]=fe[1],fe[0]==K&&(R=fe[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+S[2]);if(N["!ref"]=er(V),Y[z||R]=N,Z.push(z||R),!se.length)return{SheetNames:Z,Sheets:Y};for(var ae={},W=[],he=0;he<se.length;++he)Y[Z[he]]?(W.push(se[he]||Z[he]),ae[se[he]]=Y[se[he]]||Y[Z[he]]):(W.push(se[he]),ae[se[he]]={"!ref":"A1"});return{SheetNames:W,Sheets:ae}}function n(S,I){var O=I||{};if(+O.codepage>=0&&ga(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var N=ns(),R=mr(S["!ref"]),z=Array.isArray(S),K=[];vt(N,0,s(1030)),vt(N,6,a(R));for(var Y=Math.min(R.e.r,8191),Z=R.s.r;Z<=Y;++Z)for(var se=En(Z),V=R.s.c;V<=R.e.c;++V){Z===R.s.r&&(K[V]=en(V));var le=K[V]+se,ae=z?(S[Z]||[])[V]:S[le];if(!(!ae||ae.t=="z"))if(ae.t=="n")(ae.v|0)==ae.v&&ae.v>=-32768&&ae.v<=32767?vt(N,13,u(Z,V,ae.v)):vt(N,14,m(Z,V,ae.v));else{var W=Do(ae);vt(N,15,h(Z,V,W.slice(0,239)))}}return vt(N,1),N.end()}function i(S,I){var O=I||{};if(+O.codepage>=0&&ga(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var N=ns();vt(N,0,l(S));for(var R=0,z=0;R<S.SheetNames.length;++R)(S.Sheets[S.SheetNames[R]]||{})["!ref"]&&vt(N,27,P(S.SheetNames[R],z++));var K=0;for(R=0;R<S.SheetNames.length;++R){var Y=S.Sheets[S.SheetNames[R]];if(!(!Y||!Y["!ref"])){for(var Z=mr(Y["!ref"]),se=Array.isArray(Y),V=[],le=Math.min(Z.e.r,8191),ae=Z.s.r;ae<=le;++ae)for(var W=En(ae),he=Z.s.c;he<=Z.e.c;++he){ae===Z.s.r&&(V[he]=en(he));var fe=V[he]+W,Te=se?(Y[ae]||[])[he]:Y[fe];if(!(!Te||Te.t=="z"))if(Te.t=="n")vt(N,23,B(ae,he,K,Te.v));else{var be=Do(Te);vt(N,22,T(ae,he,K,be.slice(0,239)))}}++K}}return vt(N,1),N.end()}function s(S){var I=Je(2);return I.write_shift(2,S),I}function l(S){var I=Je(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var O=0,N=0,R=0,z=0;z<S.SheetNames.length;++z){var K=S.SheetNames[z],Y=S.Sheets[K];if(!(!Y||!Y["!ref"])){++R;var Z=is(Y["!ref"]);O<Z.e.r&&(O=Z.e.r),N<Z.e.c&&(N=Z.e.c)}}return O>8191&&(O=8191),I.write_shift(2,O),I.write_shift(1,R),I.write_shift(1,N),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function o(S,I,O){var N={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&O.qpro?(N.s.c=S.read_shift(1),S.l++,N.s.r=S.read_shift(2),N.e.c=S.read_shift(1),S.l++,N.e.r=S.read_shift(2),N):(N.s.c=S.read_shift(2),N.s.r=S.read_shift(2),I==12&&O.qpro&&(S.l+=2),N.e.c=S.read_shift(2),N.e.r=S.read_shift(2),I==12&&O.qpro&&(S.l+=2),N.s.c==65535&&(N.s.c=N.e.c=N.s.r=N.e.r=0),N)}function a(S){var I=Je(8);return I.write_shift(2,S.s.c),I.write_shift(2,S.s.r),I.write_shift(2,S.e.c),I.write_shift(2,S.e.r),I}function c(S,I,O){var N=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(N[0].c=S.read_shift(1),N[3]=S.read_shift(1),N[0].r=S.read_shift(2),S.l+=2):(N[2]=S.read_shift(1),N[0].c=S.read_shift(2),N[0].r=S.read_shift(2)),N}function f(S,I,O){var N=S.l+I,R=c(S,I,O);if(R[1].t="s",O.vers==20768){S.l++;var z=S.read_shift(1);return R[1].v=S.read_shift(z,"utf8"),R}return O.qpro&&S.l++,R[1].v=S.read_shift(N-S.l,"cstr"),R}function h(S,I,O){var N=Je(7+O.length);N.write_shift(1,255),N.write_shift(2,I),N.write_shift(2,S),N.write_shift(1,39);for(var R=0;R<N.length;++R){var z=O.charCodeAt(R);N.write_shift(1,z>=128?95:z)}return N.write_shift(1,0),N}function d(S,I,O){var N=c(S,I,O);return N[1].v=S.read_shift(2,"i"),N}function u(S,I,O){var N=Je(7);return N.write_shift(1,255),N.write_shift(2,I),N.write_shift(2,S),N.write_shift(2,O,"i"),N}function p(S,I,O){var N=c(S,I,O);return N[1].v=S.read_shift(8,"f"),N}function m(S,I,O){var N=Je(13);return N.write_shift(1,255),N.write_shift(2,I),N.write_shift(2,S),N.write_shift(8,O,"f"),N}function g(S,I,O){var N=S.l+I,R=c(S,I,O);if(R[1].v=S.read_shift(8,"f"),O.qpro)S.l=N;else{var z=S.read_shift(2);_(S.slice(S.l,S.l+z),R),S.l+=z}return R}function x(S,I,O){var N=I&32768;return I&=-32769,I=(N?S:0)+(I>=8192?I-16384:I),(N?"":"$")+(O?en(I):En(I))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(S,I){di(S,0);for(var O=[],N=0,R="",z="",K="",Y="";S.l<S.length;){var Z=S[S.l++];switch(Z){case 0:O.push(S.read_shift(8,"f"));break;case 1:z=x(I[0].c,S.read_shift(2),!0),R=x(I[0].r,S.read_shift(2),!1),O.push(z+R);break;case 2:{var se=x(I[0].c,S.read_shift(2),!0),V=x(I[0].r,S.read_shift(2),!1);z=x(I[0].c,S.read_shift(2),!0),R=x(I[0].r,S.read_shift(2),!1),O.push(se+V+":"+z+R)}break;case 3:if(S.l<S.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(S.read_shift(2));break;case 6:{for(var le="";Z=S[S.l++];)le+=String.fromCharCode(Z);O.push('"'+le.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:Y=O.pop(),K=O.pop(),O.push(["AND","OR"][Z-20]+"("+K+","+Y+")");break;default:if(Z<32&&w[Z])Y=O.pop(),K=O.pop(),O.push(K+w[Z]+Y);else if(y[Z]){if(N=y[Z][1],N==69&&(N=S[S.l++]),N>O.length){console.error("WK1 bad formula parse 0x"+Z.toString(16)+":|"+O.join("|")+"|");return}var ae=O.slice(-N);O.length-=N,O.push(y[Z][0]+"("+ae.join(",")+")")}else return Z<=7?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=24?console.error("WK1 unsupported op "+Z.toString(16)):Z<=30?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=115?console.error("WK1 unsupported function opcode "+Z.toString(16)):console.error("WK1 unrecognized opcode "+Z.toString(16))}}O.length==1?I[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function C(S){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=S.read_shift(2),I[3]=S[S.l++],I[0].c=S[S.l++],I}function E(S,I){var O=C(S);return O[1].t="s",O[1].v=S.read_shift(I-4,"cstr"),O}function T(S,I,O,N){var R=Je(6+N.length);R.write_shift(2,S),R.write_shift(1,O),R.write_shift(1,I),R.write_shift(1,39);for(var z=0;z<N.length;++z){var K=N.charCodeAt(z);R.write_shift(1,K>=128?95:K)}return R.write_shift(1,0),R}function A(S,I){var O=C(S);O[1].v=S.read_shift(2);var N=O[1].v>>1;if(O[1].v&1)switch(N&7){case 0:N=(N>>3)*5e3;break;case 1:N=(N>>3)*500;break;case 2:N=(N>>3)/20;break;case 3:N=(N>>3)/200;break;case 4:N=(N>>3)/2e3;break;case 5:N=(N>>3)/2e4;break;case 6:N=(N>>3)/16;break;case 7:N=(N>>3)/64;break}return O[1].v=N,O}function j(S,I){var O=C(S),N=S.read_shift(4),R=S.read_shift(4),z=S.read_shift(2);if(z==65535)return N===0&&R===3221225472?(O[1].t="e",O[1].v=15):N===0&&R===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var K=z&32768;return z=(z&32767)-16446,O[1].v=(1-K*2)*(R*Math.pow(2,z+32)+N*Math.pow(2,z)),O}function B(S,I,O,N){var R=Je(14);if(R.write_shift(2,S),R.write_shift(1,O),R.write_shift(1,I),N==0)return R.write_shift(4,0),R.write_shift(4,0),R.write_shift(2,65535),R;var z=0,K=0,Y=0,Z=0;return N<0&&(z=1,N=-N),K=Math.log2(N)|0,N/=Math.pow(2,K-31),Z=N>>>0,Z&2147483648||(N/=2,++K,Z=N>>>0),N-=Z,Z|=2147483648,Z>>>=0,N*=Math.pow(2,32),Y=N>>>0,R.write_shift(4,Y),R.write_shift(4,Z),K+=16383+(z?32768:0),R.write_shift(2,K),R}function F(S,I){var O=j(S);return S.l+=I-14,O}function L(S,I){var O=C(S),N=S.read_shift(4);return O[1].v=N>>6,O}function G(S,I){var O=C(S),N=S.read_shift(8,"f");return O[1].v=N,O}function X(S,I){var O=G(S);return S.l+=I-10,O}function re(S,I){return S[S.l+I-1]==0?S.read_shift(I,"cstr"):""}function Q(S,I){var O=S[S.l++];O>I-1&&(O=I-1);for(var N="";N.length<O;)N+=String.fromCharCode(S[S.l++]);return N}function ne(S,I,O){if(!(!O.qpro||I<21)){var N=S.read_shift(1);S.l+=17,S.l+=1,S.l+=2;var R=S.read_shift(I-21,"cstr");return[N,R]}}function J(S,I){for(var O={},N=S.l+I;S.l<N;){var R=S.read_shift(2);if(R==14e3){for(O[R]=[0,""],O[R][0]=S.read_shift(2);S[S.l];)O[R][1]+=String.fromCharCode(S[S.l]),S.l++;S.l++}}return O}function P(S,I){var O=Je(5+S.length);O.write_shift(2,14e3),O.write_shift(2,I);for(var N=0;N<S.length;++N){var R=S.charCodeAt(N);O[O.l++]=R>127?95:R}return O[O.l++]=0,O}var H={0:{n:"BOF",f:Ln},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:p},15:{n:"LABEL",f},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:Q},65535:{n:""}},U={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:J},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:G},40:{n:"FORMULA28",f:X},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function $M(e){var t={},r=e.match(Di),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Vt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=K2[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var VM=function(){var e=kd("t"),t=kd("rPr");function r(s){var l=s.match(e);if(!l)return{t:"s",v:""};var o={t:"s",v:gr(l[1])},a=s.match(t);return a&&(o.s=$M(a[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),qM=function(){var t=/(\r\n|\n)/g;function r(i,s,l){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),l.push("</b>")),i.i&&(s.push("<i>"),l.push("</i>")),i.strike&&(s.push("<s>"),l.push("</s>"));var a=i.valign||"";return a=="superscript"||a=="super"?a="sup":a=="subscript"&&(a="sub"),a!=""&&(s.push("<"+a+">"),l.push("</"+a+">")),l.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),GM=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,XM=/<(?:\w+:)?r>/,YM=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function wy(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=gr(Or(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Or(e),r&&(n.h=ay(n.t))):e.match(XM)&&(n.r=Or(e),n.t=gr(Or((e.replace(YM,"").match(GM)||[]).join("").replace(Di,""))),r&&(n.h=qM(VM(n.r)))),n):{t:""}}var KM=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,JM=/<(?:\w+:)?(?:si|sstItem)>/g,QM=/<\/(?:\w+:)?(?:si|sstItem)>/;function ZM(e,t){var r=[],n="";if(!e)return r;var i=e.match(KM);if(i){n=i[2].replace(JM,"").split(QM);for(var s=0;s!=n.length;++s){var l=wy(n[s].trim(),t);l!=null&&(r[r.length]=l)}i=Vt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var e9=/^\s|\s$|[\t\n\r]/;function SE(e,t){if(!t.bookSST)return"";var r=[Tn];r[r.length]=xt("sst",null,{xmlns:Xc[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(e9)&&(s+=' xml:space="preserve"'),s+=">"+Tr(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function t9(e){return[e.read_shift(4),e.read_shift(4)]}function r9(e,t){var r=[],n=!1;return Mo(e,function(s,l,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function n9(e,t){return t||(t=Je(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var i9=p7;function s9(e){var t=ns();st(t,159,n9(e));for(var r=0;r<e.length;++r)st(t,19,i9(e[r]));return st(t,160),t.end()}function kE(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function To(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function a9(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=To(e,4),t.U=To(e,4),t.W=To(e,4),t}function o9(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function l9(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(o9(e));return t}function c9(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function u9(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=To(e,4),t.U=To(e,4),t.W=To(e,4),t}function f9(e){var t=u9(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function CE(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function EE(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function h9(e){var t=To(e);switch(t.Minor){case 2:return[t.Minor,d9(e)];case 3:return[t.Minor,p9()];case 4:return[t.Minor,g9(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function d9(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=CE(e,r),i=EE(e,e.length-e.l);return{t:"Std",h:n,v:i}}function p9(){throw new Error("File is password-protected: ECMA-376 Extensible")}function g9(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Di,function(s){var l=Vt(s);switch(Ja(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=l[o]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function m9(e,t){var r={},n=r.EncryptionVersionInfo=To(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=CE(e,i),t-=i,r.EncryptionVerifier=EE(e,t),r}function x9(e){var t={},r=t.EncryptionVersionInfo=To(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function _y(e){var t=0,r,n=kE(e),i=n.length+1,s,l,o,a,c;for(r=Ll(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)l=r[s],o=t&16384?1:0,a=t<<1&32767,c=o|a,t=c^l;return t^52811}var TE=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},i=function(l,o){return n(l^o)},s=function(l){for(var o=t[l.length-1],a=104,c=l.length-1;c>=0;--c)for(var f=l[c],h=0;h!=7;++h)f&64&&(o^=r[a]),f*=2,--a;return o};return function(l){for(var o=kE(l),a=s(o),c=o.length,f=Ll(16),h=0;h!=16;++h)f[h]=0;var d,u,p;for((c&1)===1&&(d=a>>8,f[c]=i(e[0],d),--c,d=a&255,u=o[o.length-1],f[c]=i(u,d));c>0;)--c,d=a>>8,f[c]=i(o[c],d),--c,d=a&255,f[c]=i(o[c],d);for(c=15,p=15-o.length;p>0;)d=a>>8,f[c]=i(e[p],d),--c,--p,d=a&255,f[c]=i(o[c],d),--c,--p;return f}}(),v9=function(e,t,r,n,i){i||(i=t),n||(n=TE(e));var s,l;for(s=0;s!=t.length;++s)l=t[s],l^=n[r],l=(l>>5|l<<3)&255,i[s]=l,++r;return[i,r,n]},y9=function(e){var t=0,r=TE(e);return function(n){var i=v9("",n,t,r);return t=i[1],i[0]}};function w9(e,t,r,n){var i={key:Ln(e),verificationBytes:Ln(e)};return r.password&&(i.verifier=_y(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=y9(r.password)),i}function _9(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=x9(e):n.Data=m9(e,t),n}function b9(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?_9(e,t-2,n):w9(e,r.biff>=8?t:t-2,r,n),n}var NE=function(){function e(i,s){switch(s.type){case"base64":return t(Ts(i),s);case"binary":return t(i,s);case"buffer":return t(sr&&Buffer.isBuffer(i)?i.toString("binary"):zl(i),s);case"array":return t(Rc(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var l=s||{},o=l.dense?[]:{},a=i.match(/\\trowd.*?\\row\b/g);if(!a.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:a.length-1}};return a.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,u=0,p,m=-1;p=d.exec(f);){switch(p[0]){case"\\cell":var g=f.slice(u,d.lastIndex-p[0].length);if(g[0]==" "&&(g=g.slice(1)),++m,g.length){var x={v:g,t:"s"};Array.isArray(o)?o[h][m]=x:o[Ht({r:h,c:m})]=x}break}u=d.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=er(c),o}function r(i,s){return Hl(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],l=mr(i["!ref"]),o,a=Array.isArray(i),c=l.s.r;c<=l.e.r;++c){s.push("\\trowd\\trautofit1");for(var f=l.s.c;f<=l.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=l.s.c;f<=l.e.c;++f){var h=Ht({r:c,c:f});o=a?(i[c]||[])[f]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Do(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function S9(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Nd(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function k9(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),l=i-s;if(l===0)return[0,0,t];var o=0,a=0,c=i+s;switch(a=l/(c>1?2-c:c),i){case t:o=((r-n)/l+6)%6;break;case r:o=(n-t)/l+2;break;case n:o=(t-r)/l+4;break}return[o/6,a,c/2]}function C9(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,l=[s,s,s],o=6*t,a;if(r!==0)switch(o|0){case 0:case 6:a=i*o,l[0]+=i,l[1]+=a;break;case 1:a=i*(2-o),l[0]+=a,l[1]+=i;break;case 2:a=i*(o-2),l[1]+=i,l[2]+=a;break;case 3:a=i*(4-o),l[1]+=a,l[2]+=i;break;case 4:a=i*(o-4),l[2]+=i,l[0]+=a;break;case 5:a=i*(6-o),l[2]+=a,l[0]+=i;break}for(var c=0;c!=3;++c)l[c]=Math.round(l[c]*255);return l}function Og(e,t){if(t===0)return e;var r=k9(S9(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Nd(C9(r))}var AE=6,E9=15,T9=1,Ai=AE;function Ad(e){return Math.floor((e+Math.round(128/Ai)/256)*Ai)}function Od(e){return Math.floor((e-5)/Ai*100+.5)/100}function Pg(e){return Math.round((e*Ai+5)/Ai*256)/256}function rx(e){return Pg(Od(Ad(e)))}function by(e){var t=Math.abs(e-rx(e)),r=Ai;if(t>.005)for(Ai=T9;Ai<E9;++Ai)Math.abs(e-rx(e))<=t&&(t=Math.abs(e-rx(e)),r=Ai);Ai=r}function Il(e){e.width?(e.wpx=Ad(e.width),e.wch=Od(e.wpx),e.MDW=Ai):e.wpx?(e.wch=Od(e.wpx),e.width=Pg(e.wch),e.MDW=Ai):typeof e.wch=="number"&&(e.width=Pg(e.wch),e.wpx=Ad(e.width),e.MDW=Ai),e.customWidth&&delete e.customWidth}var N9=96,OE=N9;function Pd(e){return e*96/OE}function yf(e){return e*OE/96}var A9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function O9(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(Di)||[]).forEach(function(l){var o=Vt(l);switch(Ja(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Ur(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Ur(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function P9(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(Di)||[]).forEach(function(l){var o=Vt(l);switch(Ja(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function F9(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(Di)||[]).forEach(function(l){var o=Vt(l);switch(Ja(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=Or(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Ur(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Ur(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Ur(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Ur(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Ur(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Ur(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Ur(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=K2[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Ur(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var a=kc[i.color.index];i.color.index==81&&(a=kc[1]),a||(a=kc[1]),i.color.rgb=a[0].toString(16)+a[1].toString(16)+a[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Og(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function j9(e,t,r){t.NumberFmt=[];for(var n=dn(Ut),i=0;i<n.length;++i)t.NumberFmt[n[i]]=Ut[n[i]];var s=e[0].match(Di);if(s)for(i=0;i<s.length;++i){var l=Vt(s[i]);switch(Ja(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=gr(Or(l.formatCode)),a=parseInt(l.numFmtId,10);if(t.NumberFmt[a]=o,a>0){if(a>392){for(a=392;a>60&&t.NumberFmt[a]!=null;--a);t.NumberFmt[a]=o}Eo(o,a)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function D9(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=xt("numFmt",null,{numFmtId:n,formatCode:Tr(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=xt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var pp=["numFmtId","fillId","fontId","borderId","xfId"],gp=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function L9(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Di)||[]).forEach(function(s){var l=Vt(s),o=0;switch(Ja(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],o=0;o<pp.length;++o)n[pp[o]]&&(n[pp[o]]=parseInt(n[pp[o]],10));for(o=0;o<gp.length;++o)n[gp[o]]&&(n[gp[o]]=Ur(n[gp[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var a={};l.vertical&&(a.vertical=l.vertical),l.horizontal&&(a.horizontal=l.horizontal),l.textRotation!=null&&(a.textRotation=l.textRotation),l.indent&&(a.indent=l.indent),l.wrapText&&(a.wrapText=Ur(l.wrapText)),n.alignment=a;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function I9(e){var t=[];return t[t.length]=xt("cellXfs",null),e.forEach(function(r){t[t.length]=xt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=xt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var R9=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,a,c){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(t))&&j9(h,f,c),(h=o.match(i))&&F9(h,f,a,c),(h=o.match(n))&&P9(h,f,a,c),(h=o.match(s))&&O9(h,f,a,c),(h=o.match(r))&&L9(h,f,c),f}}();function PE(e,t){var r=[Tn,xt("styleSheet",null,{xmlns:Xc[0],"xmlns:vt":Gn.vt})],n;return e.SSF&&(n=D9(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=I9(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function M9(e,t){var r=e.read_shift(2),n=Pi(e);return[r,n]}function B9(e,t,r){r||(r=Je(6+4*t.length)),r.write_shift(2,e),ri(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function U9(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=_7(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var o=e.read_shift(1);o>0&&(n.family=o);var a=e.read_shift(1);switch(a>0&&(n.charset=a),e.l++,n.color=w7(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Pi(e),n}function W9(e,t){t||(t=Je(25+4*32)),t.write_shift(2,e.sz*20),b7(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Tg(e.color,t);var n=0;return n=2,t.write_shift(1,n),ri(e.name,t),t.length>t.l?t.slice(0,t.l):t}var z9=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],nx,H9=ji;function pS(e,t){t||(t=Je(4*3+8*7+16*1)),nx||(nx=a1(z9));var r=nx[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Tg({auto:1},t),Tg({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function $9(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function FE(e,t,r){r||(r=Je(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function dh(e,t){return t||(t=Je(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var V9=ji;function q9(e,t){return t||(t=Je(51)),t.write_shift(1,0),dh(null,t),dh(null,t),dh(null,t),dh(null,t),dh(null,t),t.length>t.l?t.slice(0,t.l):t}function G9(e,t){return t||(t=Je(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Eg(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function X9(e,t,r){var n=Je(2052);return n.write_shift(4,e),Eg(t,n),Eg(r,n),n.length>n.l?n.slice(0,n.l):n}function Y9(e,t,r){var n={};n.NumberFmt=[];for(var i in Ut)n.NumberFmt[i]=Ut[i];n.CellXf=[],n.Fonts=[];var s=[],l=!1;return Mo(e,function(a,c,f){switch(f){case 44:n.NumberFmt[a[0]]=a[1],Eo(a[1],a[0]);break;case 43:n.Fonts.push(a),a.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=Og(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(a);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(f),l=!0;break;case 38:s.pop(),l=!1;break;default:if(c.T>0)s.push(f);else if(c.T<0)s.pop();else if(!l||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function K9(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(st(e,615,_a(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&st(e,44,B9(i,t[i]))}),st(e,616))}}function J9(e){var t=1;st(e,611,_a(t)),st(e,43,W9({sz:12,color:{theme:1},name:"Calibri",family:2})),st(e,612)}function Q9(e){var t=2;st(e,603,_a(t)),st(e,45,pS({patternType:"none"})),st(e,45,pS({patternType:"gray125"})),st(e,604)}function Z9(e){var t=1;st(e,613,_a(t)),st(e,46,q9()),st(e,614)}function eB(e){var t=1;st(e,626,_a(t)),st(e,47,FE({numFmtId:0},65535)),st(e,627)}function tB(e,t){st(e,617,_a(t.length)),t.forEach(function(r){st(e,47,FE(r,0))}),st(e,618)}function rB(e){var t=1;st(e,619,_a(t)),st(e,48,G9({xfId:0,name:"Normal"})),st(e,620)}function nB(e){var t=0;st(e,505,_a(t)),st(e,506)}function iB(e){var t=0;st(e,508,X9(t,"TableStyleMedium9","PivotStyleMedium4")),st(e,509)}function sB(e,t){var r=ns();return st(r,278),K9(r,e.SSF),J9(r),Q9(r),Z9(r),eB(r),tB(r,t.cellXfs),rB(r),nB(r),iB(r),st(r,279),r.end()}var aB=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function oB(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Di)||[]).forEach(function(i){var s=Vt(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[aB.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function lB(){}function cB(){}var uB=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fB=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,hB=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function dB(e,t,r){t.themeElements={};var n;[["clrScheme",uB,oB],["fontScheme",fB,lB],["fmtScheme",hB,cB]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var pB=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function jE(e,t){(!e||e.length===0)&&(e=Sy());var r,n={};if(!(r=e.match(pB)))throw new Error("themeElements not found in theme");return dB(r[0],n,t),n.raw=e,n}function Sy(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Tn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function gB(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var l;try{l=CC(s,{type:"array"})}catch{return}var o=ws(l,"theme/theme/theme1.xml",!0);if(o)return jE(o,r)}}function mB(e){return e.read_shift(4)}function xB(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=vB(e,4);break;case 2:t.xclrValue=hE(e);break;case 3:t.xclrValue=mB(e);break;case 4:e.l+=4;break}return e.l+=8,t}function vB(e,t){return ji(e,t)}function yB(e,t){return ji(e,t)}function wB(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=xB(e);break;case 6:n[1]=yB(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function _B(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(wB(e,r-e.l));return{ixfe:n,ext:s}}function bB(e,t){t.forEach(function(r){switch(r[0]){}})}function SB(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Pi(e)}}function kB(e){var t=Je(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),ri(e.name,t),t.slice(0,t.l)}function CB(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function EB(e){var t=Je(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function TB(e,t){var r=Je(8+2*t.length);return r.write_shift(4,e),ri(t,r),r.slice(0,r.l)}function NB(e){return e.l+=4,e.read_shift(4)!=0}function AB(e,t){var r=Je(8);return r.write_shift(4,e),r.write_shift(4,1),r}function OB(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],l=!1,o=2;return Mo(e,function(a,c,f){switch(f){case 335:n.Types.push({name:a.name});break;case 51:a.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=a?1:0;break;case 338:o=2;break;case 35:s.push(f),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!c.T){if(!l||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function PB(){var e=ns();return st(e,332),st(e,334,_a(1)),st(e,335,kB({name:"XLDAPR",version:12e4,flags:3496657072})),st(e,336),st(e,339,TB(1,"XLDAPR")),st(e,52),st(e,35,_a(514)),st(e,4096,_a(0)),st(e,4097,Ws(1)),st(e,36),st(e,53),st(e,340),st(e,337,AB(1)),st(e,51,EB([[1,0]])),st(e,338),st(e,333),e.end()}function FB(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,l;return e.replace(Di,function(o){var a=Vt(o);switch(Ja(a[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:a.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==a.name&&(l=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[a.t-1].name,index:+a.v}):s==0&&n.Value.push({type:n.Types[a.t-1].name,index:+a.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+a.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+a[0]+" in metadata")}return o}),n}function DE(){var e=[Tn];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function jB(e){var t=[];if(!e)return t;var r=1;return(e.match(Di)||[]).forEach(function(n){var i=Vt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function DB(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ht(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function LB(e,t,r){var n=[];return Mo(e,function(s,l,o){switch(o){case 63:n.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function IB(e,t,r,n){if(!e)return e;var i=n||{},s=!1;Mo(e,function(o,a,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!a.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function RB(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var qu=1024;function LE(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[xt("xml",null,{"xmlns:v":xs.v,"xmlns:o":xs.o,"xmlns:x":xs.x,"xmlns:mv":xs.mv}).replace(/\/>/,">"),xt("o:shapelayout",xt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),xt("v:shapetype",[xt("v:stroke",null,{joinstyle:"miter"}),xt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];qu<e*1e3;)qu+=1e3;return t.forEach(function(s){var l=tn(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var a=o.type=="gradient"?xt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=xt("v:fill",a,o),f={on:"t",obscured:"t"};++qu,i=i.concat(["<v:shape"+Cd({id:"_x0000_s"+qu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,xt("v:shadow",null,f),xt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",pi("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),pi("x:AutoFill","False"),pi("x:Row",String(l.r)),pi("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function gS(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(l){var o=tn(l.ref);if(i?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[l.ref],!s){s={t:"z"},i?e[o.r][o.c]=s:e[l.ref]=s;var a=mr(e["!ref"]||"BDWGO1000001:A1");a.s.r>o.r&&(a.s.r=o.r),a.e.r<o.r&&(a.e.r=o.r),a.s.c>o.c&&(a.s.c=o.c),a.e.c<o.c&&(a.e.c=o.c);var c=er(a);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var f={a:l.author,t:l.t,r:l.r,T:r};l.h&&(f.h=l.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(f.a==n[h].id){f.a=n[h].name||f.a;break}}s.c.push(f)})}function MB(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?comment[^>]*>/);if(o){var a=Vt(o[0]),c={author:a.authorId&&r[a.authorId]||"sheetjsghost",ref:a.ref,guid:a.guid},f=tn(a.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var h=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&wy(h[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function IE(e){var t=[Tn,xt("comments",null,{xmlns:Xc[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=Tr(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(a){a.a&&(i=r.indexOf(Tr(a.a))),s.push(a.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(pi("t",Tr(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)l+=`Reply:
    `+s[o]+`
`;t.push(pi("t",Tr(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function BB(e,t){var r=[],n=!1,i={},s=0;return e.replace(Di,function(o,a){var c=Vt(o);switch(Ja(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=a+o.length;break;case"</text>":i.t=e.slice(s,a).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function UB(e,t,r){var n=[Tn,xt("ThreadedComments",null,{xmlns:Gn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var a={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=a.id:a.parentId=s,l.ID=a.id,l.a&&(a.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),n.push(xt("threadedComment",pi("text",l.t||""),a))})}),n.push("</ThreadedComments>"),n.join("")}function WB(e,t){var r=[],n=!1;return e.replace(Di,function(s){var l=Vt(s);switch(Ja(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),r}function zB(e){var t=[Tn,xt("personList",null,{xmlns:Gn.TCMNT,"xmlns:x":Xc[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(xt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function HB(e){var t={};t.iauthor=e.read_shift(4);var r=Qc(e);return t.rfx=r.s,t.ref=Ht(r.s),e.l+=16,t}function $B(e,t){return t==null&&(t=Je(36)),t.write_shift(4,e[1].iauthor),Of(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var VB=Pi;function qB(e){return ri(e.slice(0,54))}function GB(e,t){var r=[],n=[],i={},s=!1;return Mo(e,function(o,a,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!a.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function XB(e){var t=ns(),r=[];return st(t,628),st(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),st(t,632,qB(i.a)))})}),st(t,631),st(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:tn(n[0]),e:tn(n[0])};st(t,635,$B([s,i])),i.t&&i.t.length>0&&st(t,637,m7(i)),st(t,636),delete i.iauthor})}),st(t,634),st(t,629),t.end()}var YB="application/vnd.ms-office.vbaProject";function KB(e){var t=Rt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Rt.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Rt.write(t)}function JB(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Rt.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var RE=["xlsb","xlsm","xlam","biff8","xla"];function QB(){return{"!type":"dialog"}}function ZB(){return{"!type":"dialog"}}function eU(){return{"!type":"macro"}}function tU(){return{"!type":"macro"}}var of=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,l){var o=!1,a=!1;s.length==0?a=!0:s.charAt(0)=="["&&(a=!0,s=s.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,f=l.length>0?parseInt(l,10)|0:0;return o?f+=t.c:--f,a?c+=t.r:--c,i+(o?"":"$")+en(f)+(a?"":"$")+En(c)}return function(i,s){return t=s,i.replace(e,r)}}(),ky=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Cy=function(){return function(t,r){return t.replace(ky,function(n,i,s,l,o,a){var c=fy(l)-(s?0:r.c),f=uy(a)-(o?0:r.r),h=f==0?"":o?f+1:"["+f+"]",d=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+d})}}();function ME(e,t){return e.replace(ky,function(r,n,i,s,l,o){return n+(i=="$"?i+s:en(fy(s)+t.c))+(l=="$"?l+o:En(uy(o)+t.r))})}function rU(e,t,r){var n=is(t),i=n.s,s=tn(r),l={r:s.r-i.r,c:s.c-i.c};return ME(e,l)}function nU(e){return e.length!=1}function mS(e){return e.replace(/_xlfn\./g,"")}function jn(e){e.l+=1}function Rl(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function BE(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return UE(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),l=Rl(e),o=Rl(e);return{s:{r:i,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function UE(e){var t=Rl(e),r=Rl(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function iU(e,t,r){if(r.biff<8)return UE(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=Rl(e),l=Rl(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function WE(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return sU(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Rl(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function sU(e){var t=Rl(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function aU(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function oU(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return lU(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),l=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:l,rRel:o}}function lU(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function cU(e,t,r){var n=(e[e.l++]&96)>>5,i=BE(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function uU(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var l=BE(e,s,r);return[n,i,l]}function fU(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function hU(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function dU(e,t,r){var n=(e[e.l++]&96)>>5,i=iU(e,t-1,r);return[n,i]}function pU(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function xS(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function gU(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function mU(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function xU(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function vU(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function yU(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function zE(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function wU(e){return e.read_shift(2),zE(e)}function _U(e){return e.read_shift(2),zE(e)}function bU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=WE(e,0,r);return[n,i]}function SU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=oU(e,0,r);return[n,i]}function kU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=WE(e,0,r);return[n,i,s]}function CU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[NW[i],VE[i],n]}function EU(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:TU(e);return[i,(s[0]===0?VE:TW)[s[1]]]}function TU(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function NU(e,t,r){e.l+=r&&r.biff==2?3:4}function AU(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function OU(e){return e.l++,Bo[e.read_shift(1)]}function PU(e){return e.l++,e.read_shift(2)}function FU(e){return e.l++,e.read_shift(1)!==0}function jU(e){return e.l++,Oi(e)}function DU(e,t,r){return e.l++,qd(e,t-1,r)}function LU(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=yn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Bo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Oi(e);break;case 2:r[1]=Zc(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function IU(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Qc:c1)(e));return i}function RU(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,l=[];s!=n&&(l[s]=[]);++s)for(var o=0;o!=i;++o)l[s][o]=LU(e,r.biff);return l}function MU(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function BU(e,t,r){if(r.biff==5)return UU(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function UU(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function WU(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function zU(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function HU(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function $U(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var VU=ji,qU=ji,GU=ji;function Xd(e,t,r){return e.l+=2,[aU(e)]}function Ey(e){return e.l+=6,[]}var XU=Xd,YU=Ey,KU=Ey,JU=Xd;function HE(e){return e.l+=2,[Ln(e),e.read_shift(2)&1]}var QU=Xd,ZU=HE,eW=Ey,tW=Xd,rW=Xd,nW=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function iW(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),l=nW[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:n,c:i,C:s}}function sW(e){return e.l+=2,[e.read_shift(4)]}function aW(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function oW(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function lW(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function cW(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function uW(e){return e.l+=4,[0,0]}var vS={1:{n:"PtgExp",f:AU},2:{n:"PtgTbl",f:GU},3:{n:"PtgAdd",f:jn},4:{n:"PtgSub",f:jn},5:{n:"PtgMul",f:jn},6:{n:"PtgDiv",f:jn},7:{n:"PtgPower",f:jn},8:{n:"PtgConcat",f:jn},9:{n:"PtgLt",f:jn},10:{n:"PtgLe",f:jn},11:{n:"PtgEq",f:jn},12:{n:"PtgGe",f:jn},13:{n:"PtgGt",f:jn},14:{n:"PtgNe",f:jn},15:{n:"PtgIsect",f:jn},16:{n:"PtgUnion",f:jn},17:{n:"PtgRange",f:jn},18:{n:"PtgUplus",f:jn},19:{n:"PtgUminus",f:jn},20:{n:"PtgPercent",f:jn},21:{n:"PtgParen",f:jn},22:{n:"PtgMissArg",f:jn},23:{n:"PtgStr",f:DU},26:{n:"PtgSheet",f:aW},27:{n:"PtgEndSheet",f:oW},28:{n:"PtgErr",f:OU},29:{n:"PtgBool",f:FU},30:{n:"PtgInt",f:PU},31:{n:"PtgNum",f:jU},32:{n:"PtgArray",f:pU},33:{n:"PtgFunc",f:CU},34:{n:"PtgFuncVar",f:EU},35:{n:"PtgName",f:MU},36:{n:"PtgRef",f:bU},37:{n:"PtgArea",f:cU},38:{n:"PtgMemArea",f:WU},39:{n:"PtgMemErr",f:VU},40:{n:"PtgMemNoMem",f:qU},41:{n:"PtgMemFunc",f:zU},42:{n:"PtgRefErr",f:HU},43:{n:"PtgAreaErr",f:fU},44:{n:"PtgRefN",f:SU},45:{n:"PtgAreaN",f:dU},46:{n:"PtgMemAreaN",f:lW},47:{n:"PtgMemNoMemN",f:cW},57:{n:"PtgNameX",f:BU},58:{n:"PtgRef3d",f:kU},59:{n:"PtgArea3d",f:uU},60:{n:"PtgRefErr3d",f:$U},61:{n:"PtgAreaErr3d",f:hU},255:{}},fW={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},hW={1:{n:"PtgElfLel",f:HE},2:{n:"PtgElfRw",f:tW},3:{n:"PtgElfCol",f:XU},6:{n:"PtgElfRwV",f:rW},7:{n:"PtgElfColV",f:JU},10:{n:"PtgElfRadical",f:QU},11:{n:"PtgElfRadicalS",f:eW},13:{n:"PtgElfColS",f:YU},15:{n:"PtgElfColSV",f:KU},16:{n:"PtgElfRadicalLel",f:ZU},25:{n:"PtgList",f:iW},29:{n:"PtgSxName",f:sW},255:{}},dW={0:{n:"PtgAttrNoop",f:uW},1:{n:"PtgAttrSemi",f:yU},2:{n:"PtgAttrIf",f:xU},4:{n:"PtgAttrChoose",f:gU},8:{n:"PtgAttrGoto",f:mU},16:{n:"PtgAttrSum",f:NU},32:{n:"PtgAttrBaxcel",f:xS},33:{n:"PtgAttrBaxcel",f:xS},64:{n:"PtgAttrSpace",f:wU},65:{n:"PtgAttrSpaceSemi",f:_U},128:{n:"PtgAttrIfError",f:vU},255:{}};function Yd(e,t,r,n){if(n.biff<8)return ji(e,t);for(var i=e.l+t,s=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=RU(e,0,n),s.push(r[l][1]);break;case"PtgMemArea":r[l][2]=IU(e,r[l][1],n),s.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=e.read_shift(4),s.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=i-e.l,t!==0&&s.push(ji(e,t)),s}function Kd(e,t,r){for(var n=e.l+t,i,s,l=[];n!=e.l;)t=n-e.l,s=e[e.l],i=vS[s]||vS[fW[s]],(s===24||s===25)&&(i=(s===24?hW:dW)[e[e.l+1]]),!i||!i.f?ji(e,t):l.push([i.n,i.f(e,t,r)]);return l}function pW(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var l=n[s];if(l)switch(l[0]){case 2:i.push('"'+l[1].replace(/"/g,'""')+'"');break;default:i.push(l[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var gW={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function mW(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function $E(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function yS(e,t,r){var n=$E(e,t,r);return n=="#REF"?n:mW(n,r)}function Ti(e,t,r,n,i){var s=i&&i.biff||8,l={s:{c:0,r:0}},o=[],a,c,f,h=0,d=0,u,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",x=0,y=e[0].length;x<y;++x){var w=e[0][x];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(a=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=fn(" ",e[0][m][1][1]);break;case 1:g=fn("\r",e[0][m][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+g,m=-1}o.push(c+gW[w[0]]+a);break;case"PtgIsect":a=o.pop(),c=o.pop(),o.push(c+" "+a);break;case"PtgUnion":a=o.pop(),c=o.pop(),o.push(c+","+a);break;case"PtgRange":a=o.pop(),c=o.pop(),o.push(c+":"+a);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Bh(w[1][1],l,i),o.push(Uh(f,s));break;case"PtgRefN":f=r?Bh(w[1][1],r,i):w[1][1],o.push(Uh(f,s));break;case"PtgRef3d":h=w[1][1],f=Bh(w[1][2],l,i),p=yS(n,h,i),o.push(p+"!"+Uh(f,s));break;case"PtgFunc":case"PtgFuncVar":var _=w[1][0],C=w[1][1];_||(_=0),_&=127;var E=_==0?[]:o.slice(-_);o.length-=_,C==="User"&&(C=E.shift()),o.push(C+"("+E.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":u=X5(w[1][1],r?{s:r}:l,i),o.push(Zm(u,i));break;case"PtgArea":u=X5(w[1][1],l,i),o.push(Zm(u,i));break;case"PtgArea3d":h=w[1][1],u=w[1][2],p=yS(n,h,i),o.push(p+"!"+Zm(u,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=w[1][2];var T=(n.names||[])[d-1]||(n[0]||[])[d],A=T?T.Name:"SH33TJSNAME"+String(d);A&&A.slice(0,6)=="_xlfn."&&!i.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var j=w[1][1];d=w[1][2];var B;if(i.biff<=5)j<0&&(j=-j),n[j]&&(B=n[j][d]);else{var F="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][d]&&n[j][d].itab>0&&(F=n.SheetNames[n[j][d].itab-1]+"!"):F=n.SheetNames[d-1]+"!"),n[j]&&n[j][d])F+=n[j][d].Name;else if(n[0]&&n[0][d])F+=n[0][d].Name;else{var L=($E(n,j,i)||"").split(";;");L[d-1]?F=L[d-1]:F+="SH33TJSERRX"}o.push(F);break}B||(B={Name:"SH33TJSERRY"}),o.push(B.Name);break;case"PtgParen":var G="(",X=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:G=fn(" ",e[0][m][1][1])+G;break;case 3:G=fn("\r",e[0][m][1][1])+G;break;case 4:X=fn(" ",e[0][m][1][1])+X;break;case 5:X=fn("\r",e[0][m][1][1])+X;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(G+o.pop()+X);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:w[1][1],r:w[1][0]};var re={c:r.c,r:r.r};if(n.sharedf[Ht(f)]){var Q=n.sharedf[Ht(f)];o.push(Ti(Q,l,re,n,i))}else{var ne=!1;for(a=0;a!=n.arrayf.length;++a)if(c=n.arrayf[a],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(Ti(c[1],l,re,n,i)),ne=!0;break}ne||o.push(w[1])}break;case"PtgArray":o.push("{"+pW(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var J=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&J.indexOf(e[0][x][0])==-1){w=e[0][m];var P=!0;switch(w[1][0]){case 4:P=!1;case 0:g=fn(" ",w[1][1]);break;case 5:P=!1;case 1:g=fn("\r",w[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((P?g:"")+o.pop()+(P?"":g)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function xW(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,l=e.read_shift(i);if(l==65535)return[[],ji(e,t-2)];var o=Kd(e,l,r);return t!==l+i&&(s=Yd(e,t-l-i,o,r)),e.l=n,[o,s]}function vW(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,l=e.read_shift(i);if(l==65535)return[[],ji(e,t-2)];var o=Kd(e,l,r);return t!==l+i&&(s=Yd(e,t-l-i,o,r)),e.l=n,[o,s]}function yW(e,t,r,n){var i=e.l+t,s=Kd(e,n,r),l;return i!==e.l&&(l=Yd(e,i-e.l,s,r)),[s,l]}function wW(e,t,r){var n=e.l+t,i,s=e.read_shift(2),l=Kd(e,s,r);return s==65535?[[],ji(e,t-2)]:(t!==s+2&&(i=Yd(e,n-s-2,l,r)),[l,i])}function _W(e){var t;if(So(e,e.l+6)!==65535)return[Oi(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function bW(e){if(e==null){var t=Je(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Mc(e);return Mc(0)}function ix(e,t,r){var n=e.l+t,i=Qa(e);r.biff==2&&++e.l;var s=_W(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=vW(e,n-e.l,r);return{cell:i,val:s[0],formula:o,shared:l>>3&1,tt:s[1]}}function SW(e,t,r,n,i){var s=Uc(t,r,i),l=bW(e.v),o=Je(6),a=33;o.write_shift(2,a),o.write_shift(4,0);for(var c=Je(e.bf.length),f=0;f<e.bf.length;++f)c[f]=e.bf[f];var h=ti([s,l,o,c]);return h}function u1(e,t,r){var n=e.read_shift(4),i=Kd(e,n,r),s=e.read_shift(4),l=s>0?Yd(e,s,i,r):null;return[i,l]}var kW=u1,f1=u1,CW=u1,EW=u1,TW={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},VE={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},NW={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function wS(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function AW(e){var t="of:="+e.replace(ky,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function sx(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function OW(e){return e.replace(/\./,"!")}var zh={},lf={},Hh=typeof Map<"u";function Ty(e,t,r){var n=0,i=e.length;if(r){if(Hh?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Hh?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(Hh?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function h1(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Ai=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Od(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Pg(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Tc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function $l(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Eo(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function qE(e,t,r,n,i,s){try{n.cellNF&&(e.z=Ut[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=$r(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Ut[t]==null&&Eo(TI[t]||"General",t),e.t==="e")e.w=e.w||Bo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Sd(e.v);else if(e.t==="d"){var l=Yn(e.v);(l|0)===l?e.w=l.toString(10):e.w=Sd(l)}else{if(e.v===void 0)return"";e.w=Ic(e.v,lf)}else e.t==="d"?e.w=Js(t,Yn(e.v),lf):e.w=Js(t,e.v,lf)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Og(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Og(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function PW(e,t,r){if(e&&e["!ref"]){var n=mr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function FW(e,t){var r=mr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=er(r))}var jW=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,DW=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,LW=/<(?:\w:)?hyperlink [^>]*>/mg,IW=/"(\w*:\w*)"/,RW=/<(?:\w:)?col\b[^>]*[\/]?>/g,MW=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,BW=/<(?:\w:)?pageMargins[^>]*\/>/g,GE=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,UW=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,WW=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function zW(e,t,r,n,i,s,l){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},a={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",h=e.match(DW);h?(c=e.slice(0,h.index),f=e.slice(h.index+h[0].length)):c=f=e;var d=c.match(GE);d?Ny(d[0],o,i,r):(d=c.match(UW))&&$W(d[0],d[1]||"",o,i,r);var u=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(u>0){var p=c.slice(u,u+50).match(IW);p&&FW(o,p[1])}var m=c.match(WW);m&&m[1]&&nz(m[1],i);var g=[];if(t.cellStyles){var x=c.match(RW);x&&QW(g,x)}h&&az(h[1],o,t,a,s,l);var y=f.match(MW);y&&(o["!autofilter"]=ez(y[0]));var w=[],_=f.match(jW);if(_)for(u=0;u!=_.length;++u)w[u]=mr(_[u].slice(_[u].indexOf('"')+1));var C=f.match(LW);C&&YW(o,C,n);var E=f.match(BW);if(E&&(o["!margins"]=KW(Vt(E[0]))),!o["!ref"]&&a.e.c>=a.s.c&&a.e.r>=a.s.r&&(o["!ref"]=er(a)),t.sheetRows>0&&o["!ref"]){var T=mr(o["!ref"]);t.sheetRows<=+T.e.r&&(T.e.r=t.sheetRows-1,T.e.r>a.e.r&&(T.e.r=a.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>a.e.c&&(T.e.c=a.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),o["!fullref"]=o["!ref"],o["!ref"]=er(T))}return g.length>0&&(o["!cols"]=g),w.length>0&&(o["!merges"]=w),o}function HW(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+er(e[r])+'"/>';return t+"</mergeCells>"}function Ny(e,t,r,n){var i=Vt(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=gr(Or(i.codeName)))}function $W(e,t,r,n,i){Ny(e.slice(0,e.indexOf(">")),r,n,i)}function VW(e,t,r,n,i){var s=!1,l={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var a=t.SheetNames[r];try{t.Workbook&&(a=t.Workbook.Sheets[r].CodeName||a)}catch{}s=!0,l.codeName=qa(Tr(a))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+xt("outlinePr",null,c)}!s&&!o||(i[i.length]=xt("sheetPr",o,l))}var qW=["objects","scenarios","selectLockedCells","selectUnlockedCells"],GW=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function XW(e){var t={sheet:1};return qW.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),GW.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=_y(e.password).toString(16).toUpperCase()),xt("sheetProtection",null,t)}function YW(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=Vt(Or(t[i]),!0);if(!s.ref)return;var l=((r||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+gr(s.location))):(s.Target="#"+gr(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=mr(s.ref),a=o.s.r;a<=o.e.r;++a)for(var c=o.s.c;c<=o.e.c;++c){var f=Ht({c,r:a});n?(e[a]||(e[a]=[]),e[a][c]||(e[a][c]={t:"z",v:void 0}),e[a][c].l=s):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=s)}}}function KW(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function JW(e){return Tc(e),xt("pageMargins",null,e)}function QW(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Vt(t[n],!0);i.hidden&&(i.hidden=Ur(i.hidden));var s=parseInt(i.min,10)-1,l=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,by(i.width)),Il(i);s<=l;)e[s++]=Vr(i)}}function ZW(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=xt("col",null,h1(i,n)));return r[r.length]="</cols>",r.join("")}function ez(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function tz(e,t,r,n){var i=typeof e.ref=="string"?e.ref:er(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=is(i);l.s.r==l.e.r&&(l.e.r=is(t["!ref"]).e.r,i=er(l));for(var o=0;o<s.length;++o){var a=s[o];if(a.Name=="_xlnm._FilterDatabase"&&a.Sheet==n){a.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),xt("autoFilter",null,{ref:i})}var rz=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function nz(e,t){t.Views||(t.Views=[{}]),(e.match(rz)||[]).forEach(function(r,n){var i=Vt(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),Ur(i.rightToLeft)&&(t.Views[n].RTL=!0)})}function iz(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),xt("sheetViews",xt("sheetView",null,i),{})}function sz(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Bo[e.v];break;case"d":n&&n.cellDates?i=$r(e.v,-1).toISOString():(e=Vr(e),e.t="n",i=""+(e.v=Yn($r(e.v)))),typeof e.z>"u"&&(e.z=Ut[14]);break;default:i=e.v;break}var o=pi("v",Tr(i)),a={r:t},c=$l(n.cellXfs,e,n);switch(c!==0&&(a.s=c),e.t){case"n":break;case"d":a.t="d";break;case"b":a.t="b";break;case"e":a.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=pi("v",""+Ty(n.Strings,e.v,n.revStrings)),a.t="s";break}a.t="str";break}if(e.t!=s&&(e.t=s,e.v=l),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=xt("f",Tr(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(a.cm=1),xt("c",o,a)}var az=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=kd("v"),l=kd("f");return function(a,c,f,h,d,u){for(var p=0,m="",g=[],x=[],y=0,w=0,_=0,C="",E,T,A=0,j=0,B,F,L=0,G=0,X=Array.isArray(u.CellXf),re,Q=[],ne=[],J=Array.isArray(c),P=[],H={},U=!1,S=!!f.sheetStubs,I=a.split(t),O=0,N=I.length;O!=N;++O){m=I[O].trim();var R=m.length;if(R!==0){var z=0;e:for(p=0;p<R;++p)switch(m[p]){case">":if(m[p-1]!="/"){++p;break e}if(f&&f.cellStyles){if(T=Vt(m.slice(z,p),!0),A=T.r!=null?parseInt(T.r,10):A+1,j=-1,f.sheetRows&&f.sheetRows<A)continue;H={},U=!1,T.ht&&(U=!0,H.hpt=parseFloat(T.ht),H.hpx=yf(H.hpt)),T.hidden=="1"&&(U=!0,H.hidden=!0),T.outlineLevel!=null&&(U=!0,H.level=+T.outlineLevel),U&&(P[A-1]=H)}break;case"<":z=p;break}if(z>=p)break;if(T=Vt(m.slice(z,p),!0),A=T.r!=null?parseInt(T.r,10):A+1,j=-1,!(f.sheetRows&&f.sheetRows<A)){h.s.r>A-1&&(h.s.r=A-1),h.e.r<A-1&&(h.e.r=A-1),f&&f.cellStyles&&(H={},U=!1,T.ht&&(U=!0,H.hpt=parseFloat(T.ht),H.hpx=yf(H.hpt)),T.hidden=="1"&&(U=!0,H.hidden=!0),T.outlineLevel!=null&&(U=!0,H.level=+T.outlineLevel),U&&(P[A-1]=H)),g=m.slice(p).split(e);for(var K=0;K!=g.length&&g[K].trim().charAt(0)=="<";++K);for(g=g.slice(K),p=0;p!=g.length;++p)if(m=g[p].trim(),m.length!==0){if(x=m.match(r),y=p,w=0,_=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,x!=null&&x.length===2){for(y=0,C=x[1],w=0;w!=C.length&&!((_=C.charCodeAt(w)-64)<1||_>26);++w)y=26*y+_;--y,j=y}else++j;for(w=0;w!=m.length&&m.charCodeAt(w)!==62;++w);if(++w,T=Vt(m.slice(0,w),!0),T.r||(T.r=Ht({r:A-1,c:j})),C=m.slice(w),E={t:""},(x=C.match(s))!=null&&x[1]!==""&&(E.v=gr(x[1])),f.cellFormula){if((x=C.match(l))!=null&&x[1]!==""){if(E.f=gr(Or(x[1])).replace(/\r\n/g,`
`),f.xlfn||(E.f=mS(E.f)),x[0].indexOf('t="array"')>-1)E.F=(C.match(i)||[])[1],E.F.indexOf(":")>-1&&Q.push([mr(E.F),E.F]);else if(x[0].indexOf('t="shared"')>-1){F=Vt(x[0]);var Y=gr(Or(x[1]));f.xlfn||(Y=mS(Y)),ne[parseInt(F.si,10)]=[F,Y,T.r]}}else(x=C.match(/<f[^>]*\/>/))&&(F=Vt(x[0]),ne[F.si]&&(E.f=rU(ne[F.si][1],ne[F.si][2],T.r)));var Z=tn(T.r);for(w=0;w<Q.length;++w)Z.r>=Q[w][0].s.r&&Z.r<=Q[w][0].e.r&&Z.c>=Q[w][0].s.c&&Z.c<=Q[w][0].e.c&&(E.F=Q[w][1])}if(T.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(S)E.t="z";else continue;else E.t=T.t||"n";switch(h.s.c>j&&(h.s.c=j),h.e.c<j&&(h.e.c=j),E.t){case"n":if(E.v==""||E.v==null){if(!S)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!S)continue;E.t="z"}else B=zh[parseInt(E.v,10)],E.v=B.t,E.r=B.r,f.cellHTML&&(E.h=B.h);break;case"str":E.t="s",E.v=E.v!=null?Or(E.v):"",f.cellHTML&&(E.h=ay(E.v));break;case"inlineStr":x=C.match(n),E.t="s",x!=null&&(B=wy(x[1]))?(E.v=B.t,f.cellHTML&&(E.h=B.h)):E.v="";break;case"b":E.v=Ur(E.v);break;case"d":f.cellDates?E.v=$r(E.v,1):(E.v=Yn($r(E.v,1)),E.t="n");break;case"e":(!f||f.cellText!==!1)&&(E.w=E.v),E.v=YC[E.v];break}if(L=G=0,re=null,X&&T.s!==void 0&&(re=u.CellXf[T.s],re!=null&&(re.numFmtId!=null&&(L=re.numFmtId),f.cellStyles&&re.fillId!=null&&(G=re.fillId))),qE(E,L,G,f,d,u),f.cellDates&&X&&E.t=="n"&&Tf(Ut[L])&&(E.t="d",E.v=l1(E.v)),T.cm&&f.xlmeta){var se=(f.xlmeta.Cell||[])[+T.cm-1];se&&se.type=="XLDAPR"&&(E.D=!0)}if(J){var V=tn(T.r);c[V.r]||(c[V.r]=[]),c[V.r][V.c]=E}else c[T.r]=E}}}}P.length>0&&(c["!rows"]=P)}}();function oz(e,t,r,n){var i=[],s=[],l=mr(e["!ref"]),o="",a,c="",f=[],h=0,d=0,u=e["!rows"],p=Array.isArray(e),m={r:c},g,x=-1;for(d=l.s.c;d<=l.e.c;++d)f[d]=en(d);for(h=l.s.r;h<=l.e.r;++h){for(s=[],c=En(h),d=l.s.c;d<=l.e.c;++d){a=f[d]+c;var y=p?(e[h]||[])[d]:e[a];y!==void 0&&(o=sz(y,a,e,t))!=null&&s.push(o)}(s.length>0||u&&u[h])&&(m={r:c},u&&u[h]&&(g=u[h],g.hidden&&(m.hidden=1),x=-1,g.hpx?x=Pd(g.hpx):g.hpt&&(x=g.hpt),x>-1&&(m.ht=x,m.customHeight=1),g.level&&(m.outlineLevel=g.level)),i[i.length]=xt("row",s.join(""),m))}if(u)for(;h<u.length;++h)u&&u[h]&&(m={r:h+1},g=u[h],g.hidden&&(m.hidden=1),x=-1,g.hpx?x=Pd(g.hpx):g.hpt&&(x=g.hpt),x>-1&&(m.ht=x,m.customHeight=1),g.level&&(m.outlineLevel=g.level),i[i.length]=xt("row","",m));return i.join("")}function XE(e,t,r,n){var i=[Tn,xt("worksheet",null,{xmlns:Xc[0],"xmlns:r":Gn.r})],s=r.SheetNames[e],l=0,o="",a=r.Sheets[s];a==null&&(a={});var c=a["!ref"]||"A1",f=mr(c);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),c=er(f)}n||(n={}),a["!comments"]=[];var h=[];VW(a,r,e,t,i),i[i.length]=xt("dimension",null,{ref:c}),i[i.length]=iz(a,t,e,r),t.sheetFormat&&(i[i.length]=xt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),a["!cols"]!=null&&a["!cols"].length>0&&(i[i.length]=ZW(a,a["!cols"])),i[l=i.length]="<sheetData/>",a["!links"]=[],a["!ref"]!=null&&(o=oz(a,t),o.length>0&&(i[i.length]=o)),i.length>l+1&&(i[i.length]="</sheetData>",i[l]=i[l].replace("/>",">")),a["!protect"]&&(i[i.length]=XW(a["!protect"])),a["!autofilter"]!=null&&(i[i.length]=tz(a["!autofilter"],a,r,e)),a["!merges"]!=null&&a["!merges"].length>0&&(i[i.length]=HW(a["!merges"]));var d=-1,u,p=-1;return a["!links"].length>0&&(i[i.length]="<hyperlinks>",a["!links"].forEach(function(m){m[1].Target&&(u={ref:m[0]},m[1].Target.charAt(0)!="#"&&(p=kr(n,-1,Tr(m[1].Target).replace(/#.*$/,""),ar.HLINK),u["r:id"]="rId"+p),(d=m[1].Target.indexOf("#"))>-1&&(u.location=Tr(m[1].Target.slice(d+1))),m[1].Tooltip&&(u.tooltip=Tr(m[1].Tooltip)),i[i.length]=xt("hyperlink",null,u))}),i[i.length]="</hyperlinks>"),delete a["!links"],a["!margins"]!=null&&(i[i.length]=JW(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=pi("ignoredErrors",xt("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(p=kr(n,-1,"../drawings/drawing"+(e+1)+".xml",ar.DRAW),i[i.length]=xt("drawing",null,{"r:id":"rId"+p}),a["!drawing"]=h),a["!comments"].length>0&&(p=kr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ar.VML),i[i.length]=xt("legacyDrawing",null,{"r:id":"rId"+p}),a["!legacy"]=p),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function lz(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function cz(e,t,r){var n=Je(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=Pd(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var l=0;i.level&&(l|=i.level),i.hidden&&(l|=16),(i.hpx||i.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var o=0,a=n.l;n.l+=4;for(var c={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var h=-1,d=-1,u=f<<10;u<f+1<<10;++u){c.c=u;var p=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Ht(c)];p&&(h<0&&(h=u),d=u)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,d))}var m=n.l;return n.l=a,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function uz(e,t,r,n){var i=cz(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&st(e,0,i)}var fz=Qc,hz=Of;function dz(){}function pz(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=x7(e),r}function gz(e,t,r){r==null&&(r=Je(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Tg({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),$C(e,r),r.slice(0,r.l)}function mz(e){var t=Qs(e);return[t]}function xz(e,t,r){return r==null&&(r=Je(8)),Yc(t,r)}function vz(e){var t=Kc(e);return[t]}function yz(e,t,r){return r==null&&(r=Je(4)),Jc(t,r)}function wz(e){var t=Qs(e),r=e.read_shift(1);return[t,r,"b"]}function _z(e,t,r){return r==null&&(r=Je(9)),Yc(t,r),r.write_shift(1,e.v?1:0),r}function bz(e){var t=Kc(e),r=e.read_shift(1);return[t,r,"b"]}function Sz(e,t,r){return r==null&&(r=Je(5)),Jc(t,r),r.write_shift(1,e.v?1:0),r}function kz(e){var t=Qs(e),r=e.read_shift(1);return[t,r,"e"]}function Cz(e,t,r){return r==null&&(r=Je(9)),Yc(t,r),r.write_shift(1,e.v),r}function Ez(e){var t=Kc(e),r=e.read_shift(1);return[t,r,"e"]}function Tz(e,t,r){return r==null&&(r=Je(8)),Jc(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Nz(e){var t=Qs(e),r=e.read_shift(4);return[t,r,"s"]}function Az(e,t,r){return r==null&&(r=Je(12)),Yc(t,r),r.write_shift(4,t.v),r}function Oz(e){var t=Kc(e),r=e.read_shift(4);return[t,r,"s"]}function Pz(e,t,r){return r==null&&(r=Je(8)),Jc(t,r),r.write_shift(4,t.v),r}function Fz(e){var t=Qs(e),r=Oi(e);return[t,r,"n"]}function jz(e,t,r){return r==null&&(r=Je(16)),Yc(t,r),Mc(e.v,r),r}function YE(e){var t=Kc(e),r=Oi(e);return[t,r,"n"]}function Dz(e,t,r){return r==null&&(r=Je(12)),Jc(t,r),Mc(e.v,r),r}function Lz(e){var t=Qs(e),r=gy(e);return[t,r,"n"]}function Iz(e,t,r){return r==null&&(r=Je(12)),Yc(t,r),VC(e.v,r),r}function Rz(e){var t=Kc(e),r=gy(e);return[t,r,"n"]}function Mz(e,t,r){return r==null&&(r=Je(8)),Jc(t,r),VC(e.v,r),r}function Bz(e){var t=Qs(e),r=hy(e);return[t,r,"is"]}function Uz(e){var t=Qs(e),r=Pi(e);return[t,r,"str"]}function Wz(e,t,r){return r==null&&(r=Je(12+4*e.v.length)),Yc(t,r),ri(e.v,r),r.length>r.l?r.slice(0,r.l):r}function zz(e){var t=Kc(e),r=Pi(e);return[t,r,"str"]}function Hz(e,t,r){return r==null&&(r=Je(8+4*e.v.length)),Jc(t,r),ri(e.v,r),r.length>r.l?r.slice(0,r.l):r}function $z(e,t,r){var n=e.l+t,i=Qs(e);i.r=r["!row"];var s=e.read_shift(1),l=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=f1(e,n-e.l,r);l[3]=Ti(o,null,i,r.supbooks,r)}else e.l=n;return l}function Vz(e,t,r){var n=e.l+t,i=Qs(e);i.r=r["!row"];var s=e.read_shift(1),l=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=f1(e,n-e.l,r);l[3]=Ti(o,null,i,r.supbooks,r)}else e.l=n;return l}function qz(e,t,r){var n=e.l+t,i=Qs(e);i.r=r["!row"];var s=Oi(e),l=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=f1(e,n-e.l,r);l[3]=Ti(o,null,i,r.supbooks,r)}else e.l=n;return l}function Gz(e,t,r){var n=e.l+t,i=Qs(e);i.r=r["!row"];var s=Pi(e),l=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=f1(e,n-e.l,r);l[3]=Ti(o,null,i,r.supbooks,r)}else e.l=n;return l}var Xz=Qc,Yz=Of;function Kz(e,t){return t==null&&(t=Je(4)),t.write_shift(4,e),t}function Jz(e,t){var r=e.l+t,n=Qc(e),i=dy(e),s=Pi(e),l=Pi(e),o=Pi(e);e.l=r;var a={rfx:n,relId:i,loc:s,display:o};return l&&(a.Tooltip=l),a}function Qz(e,t){var r=Je(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Of({s:tn(e[0]),e:tn(e[0])},r),py("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return ri(i||"",r),ri(e[1].Tooltip||"",r),ri("",r),r.slice(0,r.l)}function Zz(){}function eH(e,t,r){var n=e.l+t,i=qC(e),s=e.read_shift(1),l=[i];if(l[2]=s,r.cellFormula){var o=kW(e,n-e.l,r);l[1]=o}else e.l=n;return l}function tH(e,t,r){var n=e.l+t,i=Qc(e),s=[i];if(r.cellFormula){var l=EW(e,n-e.l,r);s[1]=l,e.l=n}else e.l=n;return s}function rH(e,t,r){r==null&&(r=Je(18));var n=h1(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var KE=["left","right","top","bottom","header","footer"];function nH(e){var t={};return KE.forEach(function(r){t[r]=Oi(e)}),t}function iH(e,t){return t==null&&(t=Je(6*8)),Tc(e),KE.forEach(function(r){Mc(e[r],t)}),t}function sH(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function aH(e,t,r){r==null&&(r=Je(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function oH(e){var t=Je(24);return t.write_shift(4,4),t.write_shift(4,1),Of(e,t),t}function lH(e,t){return t==null&&(t=Je(16*4+2)),t.write_shift(2,e.password?_y(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function cH(){}function uH(){}function fH(e,t,r,n,i,s,l){if(!e)return e;var o=t||{};n||(n={"!id":{}});var a=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,u,p,m,g,x,y,w,_,C,E=[];o.biff=12,o["!row"]=0;var T=0,A=!1,j=[],B={},F=o.supbooks||i.supbooks||[[]];if(F.sharedf=B,F.arrayf=j,F.SheetNames=i.SheetNames||i.Sheets.map(function(J){return J.name}),!o.supbooks&&(o.supbooks=F,i.Names))for(var L=0;L<i.Names.length;++L)F[0][L+1]=i.Names[L];var G=[],X=[],re=!1;Fd[16]={n:"BrtShortReal",f:YE};var Q;if(Mo(e,function(P,H,U){if(!d)switch(U){case 148:c=P;break;case 0:u=P,o.sheetRows&&o.sheetRows<=u.r&&(d=!0),_=En(g=u.r),o["!row"]=u.r,(P.hidden||P.hpt||P.level!=null)&&(P.hpt&&(P.hpx=yf(P.hpt)),X[P.r]=P);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:P[2]},P[2]){case"n":p.v=P[1];break;case"s":w=zh[P[1]],p.v=w.t,p.r=w.r;break;case"b":p.v=!!P[1];break;case"e":p.v=P[1],o.cellText!==!1&&(p.w=Bo[p.v]);break;case"str":p.t="s",p.v=P[1];break;case"is":p.t="s",p.v=P[1].t;break}if((m=l.CellXf[P[0].iStyleRef])&&qE(p,m.numFmtId,null,o,s,l),x=P[0].c==-1?x+1:P[0].c,o.dense?(a[g]||(a[g]=[]),a[g][x]=p):a[en(x)+_]=p,o.cellFormula){for(A=!1,T=0;T<j.length;++T){var S=j[T];u.r>=S[0].s.r&&u.r<=S[0].e.r&&x>=S[0].s.c&&x<=S[0].e.c&&(p.F=er(S[0]),A=!0)}!A&&P.length>3&&(p.f=P[3])}if(f.s.r>u.r&&(f.s.r=u.r),f.s.c>x&&(f.s.c=x),f.e.r<u.r&&(f.e.r=u.r),f.e.c<x&&(f.e.c=x),o.cellDates&&m&&p.t=="n"&&Tf(Ut[m.numFmtId])){var I=wc(p.v);I&&(p.t="d",p.v=new Date(I.y,I.m-1,I.d,I.H,I.M,I.S,I.u))}Q&&(Q.type=="XLDAPR"&&(p.D=!0),Q=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;p={t:"z",v:void 0},x=P[0].c==-1?x+1:P[0].c,o.dense?(a[g]||(a[g]=[]),a[g][x]=p):a[en(x)+_]=p,f.s.r>u.r&&(f.s.r=u.r),f.s.c>x&&(f.s.c=x),f.e.r<u.r&&(f.e.r=u.r),f.e.c<x&&(f.e.c=x),Q&&(Q.type=="XLDAPR"&&(p.D=!0),Q=void 0);break;case 176:E.push(P);break;case 49:Q=((o.xlmeta||{}).Cell||[])[P-1];break;case 494:var O=n["!id"][P.relId];for(O?(P.Target=O.Target,P.loc&&(P.Target+="#"+P.loc),P.Rel=O):P.relId==""&&(P.Target="#"+P.loc),g=P.rfx.s.r;g<=P.rfx.e.r;++g)for(x=P.rfx.s.c;x<=P.rfx.e.c;++x)o.dense?(a[g]||(a[g]=[]),a[g][x]||(a[g][x]={t:"z",v:void 0}),a[g][x].l=P):(y=Ht({c:x,r:g}),a[y]||(a[y]={t:"z",v:void 0}),a[y].l=P);break;case 426:if(!o.cellFormula)break;j.push(P),C=o.dense?a[g][x]:a[en(x)+_],C.f=Ti(P[1],f,{r:u.r,c:x},F,o),C.F=er(P[0]);break;case 427:if(!o.cellFormula)break;B[Ht(P[0].s)]=P[1],C=o.dense?a[g][x]:a[en(x)+_],C.f=Ti(P[1],f,{r:u.r,c:x},F,o);break;case 60:if(!o.cellStyles)break;for(;P.e>=P.s;)G[P.e--]={width:P.w/256,hidden:!!(P.flags&1),level:P.level},re||(re=!0,by(P.w/256)),Il(G[P.e+1]);break;case 161:a["!autofilter"]={ref:er(P)};break;case 476:a["!margins"]=P;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),P.name&&(i.Sheets[r].CodeName=P.name),(P.above||P.left)&&(a["!outline"]={above:P.above,left:P.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),P.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!H.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+U.toString(16))}}},o),delete o.supbooks,delete o["!row"],!a["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(a["!ref"]=er(c||f)),o.sheetRows&&a["!ref"]){var ne=mr(a["!ref"]);o.sheetRows<=+ne.e.r&&(ne.e.r=o.sheetRows-1,ne.e.r>f.e.r&&(ne.e.r=f.e.r),ne.e.r<ne.s.r&&(ne.s.r=ne.e.r),ne.e.c>f.e.c&&(ne.e.c=f.e.c),ne.e.c<ne.s.c&&(ne.s.c=ne.e.c),a["!fullref"]=a["!ref"],a["!ref"]=er(ne))}return E.length>0&&(a["!merges"]=E),G.length>0&&(a["!cols"]=G),X.length>0&&(a["!rows"]=X),a}function hH(e,t,r,n,i,s,l){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Vr(t),t.z=t.z||Ut[14],t.v=Yn($r(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var a={r,c:n};switch(a.s=$l(i.cellXfs,t,i),t.l&&s["!links"].push([Ht(a),t.l]),t.c&&s["!comments"].push([Ht(a),t.c]),t.t){case"s":case"str":return i.bookSST?(o=Ty(i.Strings,t.v,i.revStrings),a.t="s",a.v=o,l?st(e,18,Pz(t,a)):st(e,7,Az(t,a))):(a.t="str",l?st(e,17,Hz(t,a)):st(e,6,Wz(t,a))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?st(e,13,Mz(t,a)):st(e,2,Iz(t,a)):l?st(e,16,Dz(t,a)):st(e,5,jz(t,a)),!0;case"b":return a.t="b",l?st(e,15,Sz(t,a)):st(e,4,_z(t,a)),!0;case"e":return a.t="e",l?st(e,14,Tz(t,a)):st(e,3,Cz(t,a)),!0}return l?st(e,12,yz(t,a)):st(e,1,xz(t,a)),!0}function dH(e,t,r,n){var i=mr(t["!ref"]||"A1"),s,l="",o=[];st(e,145);var a=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var f=i.s.r;f<=c;++f){l=En(f),uz(e,t,i,f);var h=!1;if(f<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){f===i.s.r&&(o[d]=en(d)),s=o[d]+l;var u=a?(t[f]||[])[d]:t[s];if(!u){h=!1;continue}h=hH(e,u,f,d,n,t,h)}}st(e,146)}function pH(e,t){!t||!t["!merges"]||(st(e,177,Kz(t["!merges"].length)),t["!merges"].forEach(function(r){st(e,176,Yz(r))}),st(e,178))}function gH(e,t){!t||!t["!cols"]||(st(e,390),t["!cols"].forEach(function(r,n){r&&st(e,60,rH(n,r))}),st(e,391))}function mH(e,t){!t||!t["!ref"]||(st(e,648),st(e,649,oH(mr(t["!ref"]))),st(e,650))}function xH(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=kr(r,-1,n[1].Target.replace(/#.*$/,""),ar.HLINK);st(e,494,Qz(n,i))}}),delete t["!links"]}function vH(e,t,r,n){if(t["!comments"].length>0){var i=kr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ar.VML);st(e,551,py("rId"+i)),t["!legacy"]=i}}function yH(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:er(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=is(s);o.s.r==o.e.r&&(o.e.r=is(t["!ref"]).e.r,s=er(o));for(var a=0;a<l.length;++a){var c=l[a];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}a==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),st(e,161,Of(mr(s))),st(e,162)}}function wH(e,t,r){st(e,133),st(e,137,aH(t,r)),st(e,138),st(e,134)}function _H(e,t){t["!protect"]&&st(e,535,lH(t["!protect"]))}function bH(e,t,r,n){var i=ns(),s=r.SheetNames[e],l=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var a=mr(l["!ref"]||"A1");if(a.e.c>16383||a.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");a.e.c=Math.min(a.e.c,16383),a.e.r=Math.min(a.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],st(i,129),(r.vbaraw||l["!outline"])&&st(i,147,gz(o,l["!outline"])),st(i,148,hz(a)),wH(i,l,r.Workbook),gH(i,l),dH(i,l,e,t),_H(i,l),yH(i,l,r,e),pH(i,l),xH(i,l,n),l["!margins"]&&st(i,476,iH(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&mH(i,l),vH(i,l,e,n),st(i,130),i.end()}function SH(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var i=gr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function kH(e,t,r,n,i,s){var l=s||{"!type":"chart"};if(!e)return s;var o=0,a=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=SH(h);f.s.r=f.s.c=0,f.e.c=o,c=en(o),d[0].forEach(function(u,p){l[c+En(p)]={t:"n",v:u,z:d[1]},a=p}),f.e.r<a&&(f.e.r=a),++o}),o>0&&(l["!ref"]=er(f)),l}function CH(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,o=e.match(GE);return o&&Ny(o[0],s,i,r),(l=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function EH(e,t){e.l+=10;var r=Pi(e);return{name:r}}function TH(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Mo(e,function(a,c,f){switch(f){case 550:s["!rel"]=a;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),a.name&&(i.Sheets[r].CodeName=a.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var Ay=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],NH=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],AH=[],OH=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function _S(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Ur(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function bS(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Ur(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function JE(e){bS(e.WBProps,Ay),bS(e.CalcPr,OH),_S(e.WBView,NH),_S(e.Sheets,AH),lf.date1904=Ur(e.WBProps.date1904)}function PH(e){return!e.Workbook||!e.Workbook.WBProps?"false":Ur(e.Workbook.WBProps.date1904)?"true":"false"}var FH="][*?/\\".split("");function QE(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return FH.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function jH(e,t,r){e.forEach(function(n,i){QE(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=t&&t[i]&&t[i].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function DH(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];jH(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)PW(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var LH=/<\w+:workbook/;function IH(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},l=0;if(e.replace(Di,function(a,c){var f=Vt(a);switch(Ja(f[0])){case"<?xml":break;case"<workbook":a.match(LH)&&(i="xmlns"+a.match(/<(\w+):/)[1]),r.xmlns=f[i];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Ay.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Ur(f[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:r.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(r.WBProps.CodeName=Or(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=gr(Or(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Or(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),Ur(f.hidden||"0")&&(s.Hidden=!0),l=c+a.length;break;case"</definedName>":s.Ref=gr(Or(e.slice(l,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return a}),Xc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return JE(r),r}function ZE(e){var t=[Tn];t[t.length]=xt("workbook",null,{xmlns:Xc[0],"xmlns:r":Gn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Ay.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=xt("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var l={name:Tr(e.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=xt("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var a={name:o.Name};o.Comment&&(a.comment=o.Comment),o.Sheet!=null&&(a.localSheetId=""+o.Sheet),o.Hidden&&(a.hidden="1"),o.Ref&&(t[t.length]=xt("definedName",Tr(o.Ref),a))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function RH(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Ov(e),r.name=Pi(e),r}function MH(e,t){return t||(t=Je(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),py(e.strRelID,t),ri(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function BH(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Pi(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function UH(e,t){t||(t=Je(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),$C(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function WH(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function zH(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=v7(e),l=CW(e,0,r),o=dy(e);e.l=n;var a={Name:s,Ptg:l};return i<268435455&&(a.Sheet=i),o&&(a.Comment=o),a}function HH(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],Fd[16]={n:"BrtFRTArchID$",f:WH},Mo(e,function(a,c,f){switch(f){case 156:l.SheetNames.push(a.name),r.Sheets.push(a);break;case 153:r.WBProps=a;break;case 39:a.Sheet!=null&&(t.SID=a.Sheet),a.Ref=Ti(a.Ptg,null,null,l,t),delete t.SID,delete a.Ptg,s.push(a);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([f,a]):l[0]=[f,a],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(a),l.XTI=l.XTI.concat(a);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(f),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),JE(r),r.Names=s,r.supbooks=l,r}function $H(e,t){st(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};st(e,156,MH(i))}st(e,144)}function VH(e,t){t||(t=Je(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return ri("SheetJS",t),ri(wg.version,t),ri(wg.version,t),ri("7262",t),t.length>t.l?t.slice(0,t.l):t}function qH(e,t){t||(t=Je(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function GH(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(st(e,135),st(e,158,qH(i)),st(e,136))}}function XH(e,t){var r=ns();return st(r,131),st(r,128,VH()),st(r,153,UH(e.Workbook&&e.Workbook.WBProps||null)),GH(r,e),$H(r,e),st(r,132),r.end()}function YH(e,t,r){return t.slice(-4)===".bin"?HH(e,r):IH(e,r)}function KH(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?fH(e,n,r,i,s,l,o):zW(e,n,r,i,s,l,o)}function JH(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?TH(e,n,r,i,s):CH(e,n,r,i,s)}function QH(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?eU():tU()}function ZH(e,t,r,n,i,s,l,o){return t.slice(-4)===".bin"?QB():ZB()}function e$(e,t,r,n){return t.slice(-4)===".bin"?Y9(e,r,n):R9(e,r,n)}function t$(e,t,r){return jE(e,r)}function r$(e,t,r){return t.slice(-4)===".bin"?r9(e,r):ZM(e,r)}function n$(e,t,r){return t.slice(-4)===".bin"?GB(e,r):MB(e,r)}function i$(e,t,r){return t.slice(-4)===".bin"?LB(e):jB(e)}function s$(e,t,r,n){return r.slice(-4)===".bin"?IB(e,t,r,n):void 0}function a$(e,t,r){return t.slice(-4)===".bin"?OB(e,t,r):FB(e,t,r)}function o$(e,t,r){return(t.slice(-4)===".bin"?XH:ZE)(e)}function l$(e,t,r,n,i){return(t.slice(-4)===".bin"?bH:XE)(e,r,n,i)}function c$(e,t,r){return(t.slice(-4)===".bin"?sB:PE)(e,r)}function u$(e,t,r){return(t.slice(-4)===".bin"?s9:SE)(e,r)}function f$(e,t,r){return(t.slice(-4)===".bin"?XB:IE)(e)}function h$(e){return(e.slice(-4)===".bin"?PB:DE)()}var eT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,tT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ca(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(eT),s,l,o,a;if(i)for(a=0;a!=i.length;++a)s=i[a].match(tT),(l=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(l+1),n[o]=s[2].slice(1,s[2].length-1));return n}function d$(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(eT),i,s,l,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(tT),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(s+1),r[l]=i[2].slice(1,i[2].length-1));return r}var $h;function p$(e,t){var r=$h[e]||gr(e);return r==="General"?Ic(t):Js(r,t)}function g$(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Ur(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=$r(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[gr(t)]=i}function m$(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Bo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Sd(e.v):e.w=Ic(e.v):e.w=p$(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=$h[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Tf(n)){var i=wc(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function x$(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=A9[n.Pattern]||n.Pattern)}e[t.ID]=t}function v$(e,t,r,n,i,s,l,o,a,c){var f="General",h=n.StyleID,d={};c=c||{};var u=[],p=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&l&&(h=l.StyleID);s[h]!==void 0&&(s[h].nf&&(f=s[h].nf),s[h].Interior&&u.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ur(e);break;case"String":n.t="s",n.r=B5(gr(e)),n.v=e.indexOf("<")>-1?gr(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=($r(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=gr(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=YC[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=B5(t||e));break}if(m$(n,f,c),c.cellFormula!==!1)if(n.Formula){var m=gr(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=of(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=of("RC:RC",i):n.ArrayRange&&(n.F=of(n.ArrayRange,i),a.push([mr(n.F),n.F]))}else for(p=0;p<a.length;++p)i.r>=a[p][0].s.r&&i.r<=a[p][0].e.r&&i.c>=a[p][0].s.c&&i.c<=a[p][0].e.c&&(n.F=a[p][1]);c.cellStyles&&(u.forEach(function(g){!d.patternType&&g.patternType&&(d.patternType=g.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function y$(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ax(e,t){var r=t||{};Nf();var n=_h(oy(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Or(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var l=Vr(r);return l.type="string",vf.to_workbook(n,l)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Te){i.indexOf("<"+Te)>=0&&(s=!0)}),s)return iV(n,r);$h={"General Number":"General","General Date":Ut[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ut[15],"Short Date":Ut[14],"Long Time":Ut[19],"Medium Time":Ut[18],"Short Time":Ut[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ut[2],Standard:Ut[4],Percent:Ut[10],Scientific:Ut[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,a=[],c,f={},h=[],d=r.dense?[]:{},u="",p={},m={},g=ca('<Data ss:Type="String">'),x=0,y=0,w=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}},C={},E={},T="",A=0,j=[],B={},F={},L=0,G=[],X=[],re={},Q=[],ne,J=!1,P=[],H=[],U={},S=0,I=0,O={Sheets:[],WBProps:{date1904:!1}},N={};Ed.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var R="";o=Ed.exec(n);)switch(o[3]=(R=o[3]).toLowerCase()){case"data":if(R=="data"){if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&a.push([o[3],!0]);break}if(a[a.length-1][1])break;o[1]==="/"?v$(n.slice(x,o.index),T,g,a[a.length-1][0]=="comment"?re:p,{c:y,r:w},C,Q[y],m,P,r):(T="",g=ca(o[0]),x=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(X.length>0&&(p.c=X),(!r.sheetRows||r.sheetRows>w)&&p.v!==void 0&&(r.dense?(d[w]||(d[w]=[]),d[w][y]=p):d[en(y)+En(w)]=p),p.HRef&&(p.l={Target:gr(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(S=y+(parseInt(p.MergeAcross,10)|0),I=w+(parseInt(p.MergeDown,10)|0),j.push({s:{c:y,r:w},e:{c:S,r:I}})),!r.sheetStubs)p.MergeAcross?y=S+1:++y;else if(p.MergeAcross||p.MergeDown){for(var z=y;z<=S;++z)for(var K=w;K<=I;++K)(z>y||K>w)&&(r.dense?(d[K]||(d[K]=[]),d[K][z]={t:"z"}):d[en(z)+En(K)]={t:"z"});y=S+1}else++y;else p=d$(o[0]),p.Index&&(y=+p.Index-1),y<_.s.c&&(_.s.c=y),y>_.e.c&&(_.e.c=y),o[0].slice(-2)==="/>"&&++y,X=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<_.s.r&&(_.s.r=w),w>_.e.r&&(_.e.r=w),o[0].slice(-2)==="/>"&&(m=ca(o[0]),m.Index&&(w=+m.Index-1)),y=0,++w):(m=ca(o[0]),m.Index&&(w=+m.Index-1),U={},(m.AutoFitHeight=="0"||m.Height)&&(U.hpx=parseInt(m.Height,10),U.hpt=Pd(U.hpx),H[w]=U),m.Hidden=="1"&&(U.hidden=!0,H[w]=U));break;case"worksheet":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(u),_.s.r<=_.e.r&&_.s.c<=_.e.c&&(d["!ref"]=er(_),r.sheetRows&&r.sheetRows<=_.e.r&&(d["!fullref"]=d["!ref"],_.e.r=r.sheetRows-1,d["!ref"]=er(_))),j.length&&(d["!merges"]=j),Q.length>0&&(d["!cols"]=Q),H.length>0&&(d["!rows"]=H),f[u]=d}else _={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=y=0,a.push([o[3],!1]),c=ca(o[0]),u=gr(c.Name),d=r.dense?[]:{},j=[],P=[],H=[],N={name:u,Hidden:0},O.Sheets.push(N);break;case"table":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;a.push([o[3],!1]),Q=[],J=!1}break;case"style":o[1]==="/"?x$(C,E,r):E=ca(o[0]);break;case"numberformat":E.nf=gr(ca(o[0]).Format||"General"),$h[E.nf]&&(E.nf=$h[E.nf]);for(var Y=0;Y!=392&&Ut[Y]!=E.nf;++Y);if(Y==392){for(Y=57;Y!=392;++Y)if(Ut[Y]==null){Eo(E.nf,Y);break}}break;case"column":if(a[a.length-1][0]!=="table")break;if(ne=ca(o[0]),ne.Hidden&&(ne.hidden=!0,delete ne.Hidden),ne.Width&&(ne.wpx=parseInt(ne.Width,10)),!J&&ne.wpx>10){J=!0,Ai=AE;for(var Z=0;Z<Q.length;++Z)Q[Z]&&Il(Q[Z])}J&&Il(ne),Q[ne.Index-1||Q.length]=ne;for(var se=0;se<+ne.Span;++se)Q[Q.length]=Vr(ne);break;case"namedrange":if(o[1]==="/")break;O.Names||(O.Names=[]);var V=Vt(o[0]),le={Name:V.Name,Ref:of(V.RefersTo.slice(1),{r:0,c:0})};O.Sheets.length>0&&(le.Sheet=O.Sheets.length-1),O.Names.push(le);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?T+=n.slice(A,o.index):A=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=ca(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?H7(B,R,n.slice(L,o.index)):L=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else a.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));y$(re),X.push(re)}else a.push([o[3],!1]),c=ca(o[0]),re={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var ae=ca(o[0]);d["!autofilter"]={ref:of(ae.Range).replace(/\$/g,"")},a.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&a.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=a.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&a.push([o[3],!0]);break;case"null":break;default:if(a.length==0&&o[3]=="document"||a.length==0&&o[3]=="uof")return TS(n,r);var W=!0;switch(a[a.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:W=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:W=!1}break;case"excelworkbook":switch(o[3]){case"date1904":O.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:W=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:W=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(L,o.index)){case"SheetHidden":N.Hidden=1;break;case"SheetVeryHidden":N.Hidden=2;break}else L=o.index+o[0].length;break;case"header":d["!margins"]||Tc(d["!margins"]={},"xlml"),isNaN(+Vt(o[0]).Margin)||(d["!margins"].header=+Vt(o[0]).Margin);break;case"footer":d["!margins"]||Tc(d["!margins"]={},"xlml"),isNaN(+Vt(o[0]).Margin)||(d["!margins"].footer=+Vt(o[0]).Margin);break;case"pagemargins":var he=Vt(o[0]);d["!margins"]||Tc(d["!margins"]={},"xlml"),isNaN(+he.Top)||(d["!margins"].top=+he.Top),isNaN(+he.Left)||(d["!margins"].left=+he.Left),isNaN(+he.Right)||(d["!margins"].right=+he.Right),isNaN(+he.Bottom)||(d["!margins"].bottom=+he.Bottom);break;case"displayrighttoleft":O.Views||(O.Views=[]),O.Views[0]||(O.Views[0]={}),O.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:W=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:W=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:W=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:W=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:W=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:W=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:W=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:W=!1}break;case"smarttags":break;default:W=!1;break}if(W||o[3].match(/!\[CDATA/))break;if(!a[a.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+a.join("|");if(a[a.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?g$(F,R,G,n.slice(L,o.index)):(G=o,L=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+a.join("|")}var fe={};return!r.bookSheets&&!r.bookProps&&(fe.Sheets=f),fe.SheetNames=h,fe.Workbook=O,fe.SSF=Vr(Ut),fe.Props=B,fe.Custprops=F,fe}function Rv(e,t){switch(Py(t=t||{}),t.type||"base64"){case"base64":return ax(Ts(e),t);case"binary":case"buffer":case"file":return ax(e,t);case"array":return ax(zl(e),t)}}function w$(e,t){var r=[];return e.Props&&r.push($7(e.Props,t)),e.Custprops&&r.push(V7(e.Props,e.Custprops)),r.join("")}function _$(){return""}function b$(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(xt("NumberFormat",null,{"ss:Format":Tr(Ut[n.numFmtId])}));var l={"ss:ID":"s"+(21+i)};r.push(xt("Style",s.join(""),l))}),xt("Styles",r.join(""))}function rT(e){return xt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Cy(e.Ref,{r:0,c:0})})}function S$(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(rT(i)))}return xt("Names",r.join(""))}function k$(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],l=0;l<i.length;++l){var o=i[l];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(rT(o)))}return s.join("")}function C$(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(xt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(xt("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(xt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(xt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(pi("ProtectContents","True")),e["!protect"].objects&&i.push(pi("ProtectObjects","True")),e["!protect"].scenarios&&i.push(pi("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(pi("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(pi("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&i.push("<"+l[1]+"/>")})),i.length==0?"":xt("WorksheetOptions",i.join(""),{xmlns:xs.x})}function E$(e){return e.map(function(t){var r=GI(t.t||""),n=xt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return xt("Comment",n,{"ss:Author":t.a})}).join("")}function T$(e,t,r,n,i,s,l){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Tr(Cy(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var a=tn(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(a.r==l.r?"":"["+(a.r-l.r)+"]")+"C"+(a.c==l.c?"":"["+(a.c-l.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Tr(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Tr(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],f=0;f!=c.length;++f)c[f].s.c!=l.c||c[f].s.r!=l.r||(c[f].e.c>c[f].s.c&&(o["ss:MergeAcross"]=c[f].e.c-c[f].s.c),c[f].e.r>c[f].s.r&&(o["ss:MergeDown"]=c[f].e.r-c[f].s.r));var h="",d="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",d=String(e.v);break;case"b":h="Boolean",d=e.v?"1":"0";break;case"e":h="Error",d=Bo[e.v];break;case"d":h="DateTime",d=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ut[14]);break;case"s":h="String",d=qI(e.v||"");break}var u=$l(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+u),o["ss:Index"]=l.c+1;var p=e.v!=null?d:"",m=e.t=="z"?"":'<Data ss:Type="'+h+'">'+p+"</Data>";return(e.c||[]).length>0&&(m+=E$(e.c)),xt("Cell",m,o)}function N$(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=yf(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function A$(e,t,r,n){if(!e["!ref"])return"";var i=mr(e["!ref"]),s=e["!merges"]||[],l=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,x){Il(g);var y=!!g.width,w=h1(x,g),_={"ss:Index":x+1};y&&(_["ss:Width"]=Ad(w.width)),g.hidden&&(_["ss:Hidden"]="1"),o.push(xt("Column",null,_))});for(var a=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var f=[N$(c,(e["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var d=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>h)&&!(s[l].s.r>c)&&!(s[l].e.c<h)&&!(s[l].e.r<c)){(s[l].s.c!=h||s[l].s.r!=c)&&(d=!0);break}if(!d){var u={r:c,c:h},p=Ht(u),m=a?(e[c]||[])[h]:e[p];f.push(T$(m,p,e,t,r,n,u))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function O$(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],l=s?k$(s,t,e,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=s?A$(s,t,e,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(C$(s,t,e,r)),n.join("")}function P$(e,t){t||(t={}),e.SSF||(e.SSF=Vr(Ut)),e.SSF&&(Nf(),s1(e.SSF),t.revssf=o1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],$l(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(w$(e,t)),r.push(_$()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(xt("Worksheet",O$(n,t,e),{"ss:Name":Tr(e.SheetNames[n])}));return r[2]=b$(e,t),r[3]=S$(e),Tn+xt("Workbook",r.join(""),{xmlns:xs.ss,"xmlns:o":xs.o,"xmlns:x":xs.x,"xmlns:ss":xs.ss,"xmlns:dt":xs.dt,"xmlns:html":xs.html})}function F$(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=S7(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=k7(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var j$=[60,1084,2066,2165,2175];function D$(e,t,r,n,i){var s=n,l=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}l.push(o),r.l+=s;for(var a=So(r,r.l),c=Mv[a],f=0;c!=null&&j$.indexOf(a)>-1;)s=So(r,r.l+2),f=r.l+4,a==2066?f+=4:(a==2165||a==2175)&&(f+=12),o=r.slice(f,r.l+4+s),l.push(o),r.l+=4+s,c=Mv[a=So(r,r.l)];var h=ti(l);di(h,0);var d=0;h.lens=[];for(var u=0;u<l.length;++u)h.lens.push(d),d+=l[u].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,i)}function La(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ut[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Bo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Sd(e.v):e.w=Ic(e.v):e.w=Js(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&Tf(Ut[n]||String(n))){var i=wc(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function mp(e,t,r){return{v:e,ixfe:t,t:r}}function L$(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},l={},o=null,a=[],c="",f={},h,d="",u,p,m,g,x={},y=[],w,_,C=[],E=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},j=function(Pe){return Pe<8?kc[Pe]:Pe<64&&E[Pe-8]||kc[Pe]},B=function(Pe,Ue,Ye){var nt=Ue.XF.data;if(!(!nt||!nt.patternType||!Ye||!Ye.cellStyles)){Ue.s={},Ue.s.patternType=nt.patternType;var Qe;(Qe=Nd(j(nt.icvFore)))&&(Ue.s.fgColor={rgb:Qe}),(Qe=Nd(j(nt.icvBack)))&&(Ue.s.bgColor={rgb:Qe})}},F=function(Pe,Ue,Ye){if(!(U>1)&&!(Ye.sheetRows&&Pe.r>=Ye.sheetRows)){if(Ye.cellStyles&&Ue.XF&&Ue.XF.data&&B(Pe,Ue,Ye),delete Ue.ixfe,delete Ue.XF,h=Pe,d=Ht(Pe),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Pe.r<l.s.r&&(l.s.r=Pe.r),Pe.c<l.s.c&&(l.s.c=Pe.c),Pe.r+1>l.e.r&&(l.e.r=Pe.r+1),Pe.c+1>l.e.c&&(l.e.c=Pe.c+1),Ye.cellFormula&&Ue.f){for(var nt=0;nt<y.length;++nt)if(!(y[nt][0].s.c>Pe.c||y[nt][0].s.r>Pe.r)&&!(y[nt][0].e.c<Pe.c||y[nt][0].e.r<Pe.r)){Ue.F=er(y[nt][0]),(y[nt][0].s.c!=Pe.c||y[nt][0].s.r!=Pe.r)&&delete Ue.f,Ue.f&&(Ue.f=""+Ti(y[nt][1],l,Pe,P,L));break}}Ye.dense?(i[Pe.r]||(i[Pe.r]=[]),i[Pe.r][Pe.c]=Ue):i[d]=Ue}},L={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(L.password=t.password);var G,X=[],re=[],Q=[],ne=[],J=!1,P=[];P.SheetNames=L.snames,P.sharedf=L.sharedf,P.arrayf=L.arrayf,P.names=[],P.XTI=[];var H=0,U=0,S=0,I=[],O=[],N;L.codepage=1200,ga(1200);for(var R=!1;e.l<e.length-1;){var z=e.l,K=e.read_shift(2);if(K===0&&H===10)break;var Y=e.l===e.length?0:e.read_shift(2),Z=Mv[K];if(Z&&Z.f){if(t.bookSheets&&H===133&&K!==133)break;if(H=K,Z.r===2||Z.r==12){var se=e.read_shift(2);if(Y-=2,!L.enc&&se!==K&&((se&255)<<8|se>>8)!==K)throw new Error("rt mismatch: "+se+"!="+K);Z.r==12&&(e.l+=10,Y-=10)}var V={};if(K===10?V=Z.f(e,Y,L):V=D$(K,Z,e,Y,L),U==0&&[9,521,1033,2057].indexOf(H)===-1)continue;switch(K){case 34:r.opts.Date1904=T.WBProps.date1904=V;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(L.enc||(e.l=0),L.enc=V,!t.password)throw new Error("File is password-protected");if(V.valid==null)throw new Error("Encryption scheme unsupported");if(!V.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=V;break;case 66:var le=Number(V);switch(le){case 21010:le=1200;break;case 32768:le=1e4;break;case 32769:le=1252;break}ga(L.codepage=le),R=!0;break;case 317:L.rrtabid=V;break;case 25:L.winlocked=V;break;case 439:r.opts.RefreshAll=V;break;case 12:r.opts.CalcCount=V;break;case 16:r.opts.CalcDelta=V;break;case 17:r.opts.CalcIter=V;break;case 13:r.opts.CalcMode=V;break;case 14:r.opts.CalcPrecision=V;break;case 95:r.opts.CalcSaveRecalc=V;break;case 15:L.CalcRefMode=V;break;case 2211:r.opts.FullCalc=V;break;case 129:V.fDialog&&(i["!type"]="dialog"),V.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),V.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:C.push(V);break;case 430:P.push([V]),P[P.length-1].XTI=[];break;case 35:case 547:P[P.length-1].push(V);break;case 24:case 536:N={Name:V.Name,Ref:Ti(V.rgce,l,null,P,L)},V.itab>0&&(N.Sheet=V.itab-1),P.names.push(N),P[0]||(P[0]=[],P[0].XTI=[]),P[P.length-1].push(V),V.Name=="_xlnm._FilterDatabase"&&V.itab>0&&V.rgce&&V.rgce[0]&&V.rgce[0][0]&&V.rgce[0][0][0]=="PtgArea3d"&&(O[V.itab-1]={ref:er(V.rgce[0][0][1][2])});break;case 22:L.ExternCount=V;break;case 23:P.length==0&&(P[0]=[],P[0].XTI=[]),P[P.length-1].XTI=P[P.length-1].XTI.concat(V),P.XTI=P.XTI.concat(V);break;case 2196:if(L.biff<8)break;N!=null&&(N.Comment=V[1]);break;case 18:i["!protect"]=V;break;case 19:V!==0&&L.WTF&&console.error("Password verifier: "+V);break;case 133:s[V.pos]=V,L.snames.push(V.name);break;case 10:{if(--U)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,i["!ref"]=er(l),t.sheetRows&&t.sheetRows<=l.e.r){var ae=l.e.r;l.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=er(l),l.e.r=ae}l.e.r++,l.e.c++}X.length>0&&(i["!merges"]=X),re.length>0&&(i["!objects"]=re),Q.length>0&&(i["!cols"]=Q),ne.length>0&&(i["!rows"]=ne),T.Sheets.push(A)}c===""?f=i:n[c]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[K]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[V.BIFFVer]||8),L.biffguess=V.BIFFVer==0,V.BIFFVer==0&&V.dt==4096&&(L.biff=5,R=!0,ga(L.codepage=28591)),L.biff==8&&V.BIFFVer==0&&V.dt==16&&(L.biff=2),U++)break;if(i=t.dense?[]:{},L.biff<8&&!R&&(R=!0,ga(L.codepage=t.codepage||1252)),L.biff<5||V.BIFFVer==0&&V.dt==4096){c===""&&(c="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var W={pos:e.l-Y,name:c};s[W.pos]=W,L.snames.push(c)}else c=(s[z]||{name:""}).name;V.dt==32&&(i["!type"]="chart"),V.dt==64&&(i["!type"]="macro"),X=[],re=[],L.arrayf=y=[],Q=[],ne=[],J=!1,A={Hidden:(s[z]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[V.r]||[])[V.c]:i[Ht({c:V.c,r:V.r})])&&++V.c,w={ixfe:V.ixfe,XF:C[V.ixfe]||{},v:V.val,t:"n"},S>0&&(w.z=I[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F({c:V.c,r:V.r},w,t);break;case 5:case 517:w={ixfe:V.ixfe,XF:C[V.ixfe],v:V.val,t:V.t},S>0&&(w.z=I[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F({c:V.c,r:V.r},w,t);break;case 638:w={ixfe:V.ixfe,XF:C[V.ixfe],v:V.rknum,t:"n"},S>0&&(w.z=I[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F({c:V.c,r:V.r},w,t);break;case 189:for(var he=V.c;he<=V.C;++he){var fe=V.rkrec[he-V.c][0];w={ixfe:fe,XF:C[fe],v:V.rkrec[he-V.c][1],t:"n"},S>0&&(w.z=I[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F({c:he,r:V.r},w,t)}break;case 6:case 518:case 1030:{if(V.val=="String"){o=V;break}if(w=mp(V.val,V.cell.ixfe,V.tt),w.XF=C[w.ixfe],t.cellFormula){var Te=V.formula;if(Te&&Te[0]&&Te[0][0]&&Te[0][0][0]=="PtgExp"){var be=Te[0][0][1][0],pe=Te[0][0][1][1],xe=Ht({r:be,c:pe});x[xe]?w.f=""+Ti(V.formula,l,V.cell,P,L):w.F=((t.dense?(i[be]||[])[pe]:i[xe])||{}).F}else w.f=""+Ti(V.formula,l,V.cell,P,L)}S>0&&(w.z=I[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F(V.cell,w,t),o=V}break;case 7:case 519:if(o)o.val=V,w=mp(V,o.cell.ixfe,"s"),w.XF=C[w.ixfe],t.cellFormula&&(w.f=""+Ti(o.formula,l,o.cell,P,L)),S>0&&(w.z=I[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F(o.cell,w,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(V);var ce=Ht(V[0].s);if(u=t.dense?(i[V[0].s.r]||[])[V[0].s.c]:i[ce],t.cellFormula&&u){if(!o||!ce||!u)break;u.f=""+Ti(V[1],l,V[0],P,L),u.F=er(V[0])}}break;case 1212:{if(!t.cellFormula)break;if(d){if(!o)break;x[Ht(o.cell)]=V[0],u=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[Ht(o.cell)],(u||{}).f=""+Ti(V[0],l,h,P,L)}}break;case 253:w=mp(a[V.isst].t,V.ixfe,"s"),a[V.isst].h&&(w.h=a[V.isst].h),w.XF=C[w.ixfe],S>0&&(w.z=I[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F({c:V.c,r:V.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:V.ixfe,XF:C[V.ixfe],t:"z"},S>0&&(w.z=I[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F({c:V.c,r:V.r},w,t));break;case 190:if(t.sheetStubs)for(var Ne=V.c;Ne<=V.C;++Ne){var Ie=V.ixfe[Ne-V.c];w={ixfe:Ie,XF:C[Ie],t:"z"},S>0&&(w.z=I[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F({c:Ne,r:V.r},w,t)}break;case 214:case 516:case 4:w=mp(V.val,V.ixfe,"s"),w.XF=C[w.ixfe],S>0&&(w.z=I[w.ixfe>>8&63]),La(w,t,r.opts.Date1904),F({c:V.c,r:V.r},w,t);break;case 0:case 512:U===1&&(l=V);break;case 252:a=V;break;case 1054:if(L.biff==4){I[S++]=V[1];for(var Re=0;Re<S+163&&Ut[Re]!=V[1];++Re);Re>=163&&Eo(V[1],S+163)}else Eo(V[1],V[0]);break;case 30:{I[S++]=V;for(var De=0;De<S+163&&Ut[De]!=V;++De);De>=163&&Eo(V,S+163)}break;case 229:X=X.concat(V);break;case 93:re[V.cmo[0]]=L.lastobj=V;break;case 438:L.lastobj.TxO=V;break;case 127:L.lastobj.ImData=V;break;case 440:for(g=V[0].s.r;g<=V[0].e.r;++g)for(m=V[0].s.c;m<=V[0].e.c;++m)u=t.dense?(i[g]||[])[m]:i[Ht({c:m,r:g})],u&&(u.l=V[1]);break;case 2048:for(g=V[0].s.r;g<=V[0].e.r;++g)for(m=V[0].s.c;m<=V[0].e.c;++m)u=t.dense?(i[g]||[])[m]:i[Ht({c:m,r:g})],u&&u.l&&(u.l.Tooltip=V[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;u=t.dense?(i[V[0].r]||[])[V[0].c]:i[Ht(V[0])];var Me=re[V[2]];u||(t.dense?(i[V[0].r]||(i[V[0].r]=[]),u=i[V[0].r][V[0].c]={t:"z"}):u=i[Ht(V[0])]={t:"z"},l.e.r=Math.max(l.e.r,V[0].r),l.s.r=Math.min(l.s.r,V[0].r),l.e.c=Math.max(l.e.c,V[0].c),l.s.c=Math.min(l.s.c,V[0].c)),u.c||(u.c=[]),p={a:V[1],t:Me.TxO.t},u.c.push(p)}break;case 2173:bB(C[V.ixfe],V.ext);break;case 125:{if(!L.cellStyles)break;for(;V.e>=V.s;)Q[V.e--]={width:V.w/256,level:V.level||0,hidden:!!(V.flags&1)},J||(J=!0,by(V.w/256)),Il(Q[V.e+1])}break;case 520:{var Ge={};V.level!=null&&(ne[V.r]=Ge,Ge.level=V.level),V.hidden&&(ne[V.r]=Ge,Ge.hidden=!0),V.hpt&&(ne[V.r]=Ge,Ge.hpt=V.hpt,Ge.hpx=yf(V.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Tc(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[K]]=V;break;case 161:i["!margins"]||Tc(i["!margins"]={}),i["!margins"].header=V.header,i["!margins"].footer=V.footer;break;case 574:V.RTL&&(T.Views[0].RTL=!0);break;case 146:E=V;break;case 2198:G=V;break;case 140:_=V;break;case 442:c?A.CodeName=V||A.name:T.WBProps.CodeName=V||"ThisWorkbook";break}}else Z||console.error("Missing Info for XLS Record 0x"+K.toString(16)),e.l+=Y}return r.SheetNames=dn(s).sort(function(Ae,Pe){return Number(Ae)-Number(Pe)}).map(function(Ae){return s[Ae].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&O.forEach(function(Ae,Pe){r.Sheets[r.SheetNames[Pe]]["!autofilter"]=Ae}),r.Strings=a,r.SSF=Vr(Ut),L.enc&&(r.Encryption=L.enc),G&&(r.Themes=G),r.Metadata={},_!==void 0&&(r.Metadata.Country=_),P.names.length>0&&(T.Names=P.names),r.Workbook=T,r}var Vh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function I$(e,t,r){var n=Rt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=nS(n,Pv,Vh.DSI);for(var s in i)t[s]=i[s]}catch(c){if(r.WTF)throw c}var l=Rt.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var o=nS(l,Fv,Vh.SI);for(var a in o)t[a]==null&&(t[a]=o[a])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(tE(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function R$(e,t){var r=[],n=[],i=[],s=0,l,o=j5(Pv,"n"),a=j5(Fv,"n");if(e.Props)for(l=dn(e.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(o,l[s])?r:Object.prototype.hasOwnProperty.call(a,l[s])?n:i).push([l[s],e.Props[l[s]]]);if(e.Custprops)for(l=dn(e.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(o,l[s])?r:Object.prototype.hasOwnProperty.call(a,l[s])?n:i).push([l[s],e.Custprops[l[s]]]);var c=[];for(s=0;s<i.length;++s)lE.indexOf(i[s][0])>-1||eE.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&Rt.utils.cfb_add(t,"/SummaryInformation",iS(n,Vh.SI,a,Fv)),(r.length||c.length)&&Rt.utils.cfb_add(t,"/DocumentSummaryInformation",iS(r,Vh.DSI,o,Pv,c.length?c:null,Vh.UDI))}function nT(e,t){t||(t={}),Py(t),Q2(),t.codepage&&J2(t.codepage);var r,n;if(e.FullPaths){if(Rt.find(e,"/encryption"))throw new Error("File is password-protected");r=Rt.find(e,"!CompObj"),n=Rt.find(e,"/Workbook")||Rt.find(e,"/Book")}else{switch(t.type){case"base64":e=ys(Ts(e));break;case"binary":e=ys(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}di(e,0),n={content:e}}var i,s;if(r&&F$(r),t.bookProps&&!t.bookSheets)i={};else{var l=sr?"buffer":"array";if(n&&n.content)i=L$(n.content,t);else if((s=Rt.find(e,"PerfectOffice_MAIN"))&&s.content)i=Ec.to_workbook(s.content,(t.type=l,t));else if((s=Rt.find(e,"NativeContent_MAIN"))&&s.content)i=Ec.to_workbook(s.content,(t.type=l,t));else throw(s=Rt.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Rt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=KB(e))}var o={};return e.FullPaths&&I$(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}function M$(e,t){var r=t||{},n=Rt.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Rt.utils.cfb_add(n,i,iT(e,r)),r.biff==8&&(e.Props||e.Custprops)&&R$(e,n),r.biff==8&&e.vbaraw&&JB(n,Rt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Fd={0:{f:lz},1:{f:mz},2:{f:Lz},3:{f:kz},4:{f:wz},5:{f:Fz},6:{f:Uz},7:{f:Nz},8:{f:Gz},9:{f:qz},10:{f:$z},11:{f:Vz},12:{f:vz},13:{f:Rz},14:{f:Ez},15:{f:bz},16:{f:YE},17:{f:zz},18:{f:Oz},19:{f:hy},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:zH},40:{},42:{},43:{f:U9},44:{f:M9},45:{f:H9},46:{f:V9},47:{f:$9},48:{},49:{f:f7},50:{},51:{f:CB},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:yE},62:{f:Bz},63:{f:DB},64:{f:cH},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ji,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:sH},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:pz},148:{f:fz,p:16},151:{f:Zz},152:{},153:{f:BH},154:{},155:{},156:{f:RH},157:{},158:{},159:{T:1,f:t9},160:{T:-1},161:{T:1,f:Qc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Xz},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:SB},336:{T:-1},337:{f:NB,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ov},357:{},358:{},359:{},360:{T:1},361:{},362:{f:vE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:eH},427:{f:tH},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:nH},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:dz},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Jz},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ov},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:VB},633:{T:1},634:{T:-1},635:{T:1,f:HB},636:{T:-1},637:{f:g7},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:EH},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:uH},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Mv={6:{f:ix},10:{f:sl},12:{f:Ln},13:{f:Ln},14:{f:yn},15:{f:yn},16:{f:Oi},17:{f:yn},18:{f:yn},19:{f:Ln},20:{f:uS},21:{f:uS},23:{f:vE},24:{f:hS},25:{f:yn},26:{},27:{},28:{f:uM},29:{},34:{f:yn},35:{f:fS},38:{f:Oi},39:{f:Oi},40:{f:Oi},41:{f:Oi},42:{f:yn},43:{f:yn},47:{f:b9},49:{f:RR},51:{f:Ln},60:{},61:{f:FR},64:{f:yn},65:{f:IR},66:{f:Ln},77:{},80:{},81:{},82:{},85:{f:Ln},89:{},90:{},91:{},92:{f:_R},93:{f:dM},94:{},95:{f:yn},96:{},97:{},99:{f:yn},125:{f:yE},128:{f:QR},129:{f:SR},130:{f:Ln},131:{f:yn},132:{f:yn},133:{f:kR},134:{},140:{f:_M},141:{f:Ln},144:{},146:{f:kM},151:{},152:{},153:{},154:{},155:{},156:{f:Ln},157:{},158:{},160:{f:PM},161:{f:TM},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:XR},190:{f:YR},193:{f:sl},197:{},198:{},199:{},200:{},201:{},202:{f:yn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ln},220:{},221:{f:yn},222:{},224:{f:JR},225:{f:wR},226:{f:sl},227:{},229:{f:fM},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:ER},253:{f:BR},255:{f:NR},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:cE},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:yn},353:{f:sl},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:nM},431:{f:yn},432:{},433:{},434:{},437:{},438:{f:mM},439:{f:yn},440:{f:xM},441:{},442:{f:Gd},443:{},444:{f:Ln},445:{},446:{},448:{f:sl},449:{f:PR,r:2},450:{f:sl},512:{f:oS},513:{f:OM},515:{f:tM},516:{f:WR},517:{f:cS},519:{f:FM},520:{f:AR},523:{},545:{f:dS},549:{f:aS},566:{},574:{f:DR},638:{f:GR},659:{},1048:{},1054:{f:HR},1084:{},1212:{f:oM},2048:{f:yM},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:dp},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:sl},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:CM,r:12},2173:{f:_B,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:yn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:aM,r:12},2197:{},2198:{f:gB,r:12},2199:{},2200:{},2201:{},2202:{f:lM,r:12},2203:{f:sl},2204:{},2205:{},2206:{},2207:{},2211:{f:OR},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ln},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:NM},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:SM},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:oS},1:{},2:{f:RM},3:{f:LM},4:{f:DM},5:{f:cS},7:{f:BM},8:{},9:{f:dp},11:{},22:{f:Ln},30:{f:VR},31:{},32:{},33:{f:dS},36:{},37:{f:aS},50:{f:UM},62:{},52:{},67:{},68:{f:Ln},69:{},86:{},126:{},127:{f:jM},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:WM},223:{},234:{},354:{},421:{},518:{f:ix},521:{f:dp},536:{f:hS},547:{f:fS},561:{},579:{},1030:{f:ix},1033:{f:dp},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function vt(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,l=e.next(4);l.write_shift(2,i),l.write_shift(2,s),s>0&&cy(r)&&e.push(r)}}function B$(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return vt(e,t,r,i);var s=t;if(!isNaN(s)){for(var l=r.parts||[],o=0,a=0,c=0;c+(l[o]||8224)<=8224;)c+=l[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,s),f.write_shift(2,c),e.push(r.slice(a,a+c)),a+=c;a<i;){for(f=e.next(4),f.write_shift(2,60),c=0;c+(l[o]||8224)<=8224;)c+=l[o]||8224,o++;f.write_shift(2,c),e.push(r.slice(a,a+c)),a+=c}}}function Jd(e,t,r){return e||(e=Je(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function U$(e,t,r,n){var i=Je(9);return Jd(i,e,t),uE(r,n||"b",i),i}function W$(e,t,r){var n=Je(8+2*r.length);return Jd(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function z$(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Yn($r(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?vt(e,2,MM(r,n,i)):vt(e,3,IM(r,n,i));return;case"b":case"e":vt(e,5,U$(r,n,t.v,t.t));return;case"s":case"str":vt(e,4,W$(r,n,(t.v||"").slice(0,255)));return}vt(e,1,Jd(null,r,n))}function H$(e,t,r,n){var i=Array.isArray(t),s=mr(t["!ref"]||"A1"),l,o="",a=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=er(s)}for(var c=s.s.r;c<=s.e.r;++c){o=En(c);for(var f=s.s.c;f<=s.e.c;++f){c===s.s.r&&(a[f]=en(f)),l=a[f]+o;var h=i?(t[c]||[])[f]:t[l];h&&z$(e,h,c,f)}}}function $$(e,t){for(var r=t||{},n=ns(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return vt(n,r.biff==4?1033:r.biff==3?521:9,yy(e,16,r)),H$(n,e.Sheets[e.SheetNames[i]],i,r),vt(n,10),n.end()}function V$(e,t,r){vt(e,49,MR({sz:12,name:"Arial"},r))}function q$(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&vt(e,1054,$R(i,t[i],r))})}function G$(e,t){var r=Je(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),vt(e,2151,r),r=Je(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),gE(mr(t["!ref"]||"A1"),r),r.write_shift(4,4),vt(e,2152,r)}function X$(e,t){for(var r=0;r<16;++r)vt(e,224,lS({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){vt(e,224,lS(n,0,t))})}function Y$(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];vt(e,440,vM(n)),n[1].Tooltip&&vt(e,2048,wM(n))}delete t["!links"]}function K$(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&vt(e,125,EM(h1(i,n),i))})}}function J$(e,t,r,n,i){var s=16+$l(i.cellXfs,t,i);if(t.v==null&&!t.bf){vt(e,513,Uc(r,n,s));return}if(t.bf)vt(e,6,SW(t,r,n,i,s));else switch(t.t){case"d":case"n":var l=t.t=="d"?Yn($r(t.v)):t.v;vt(e,515,rM(r,n,l,s));break;case"b":case"e":vt(e,517,eM(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var o=Ty(i.Strings,t.v,i.revStrings);vt(e,253,UR(r,n,o,s))}else vt(e,516,zR(r,n,(t.v||"").slice(0,255),s,i));break;default:vt(e,513,Uc(r,n,s))}}function Q$(e,t,r){var n=ns(),i=r.SheetNames[e],s=r.Sheets[i]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[e]||{},a=Array.isArray(s),c=t.biff==8,f,h="",d=[],u=mr(s["!ref"]||"A1"),p=c?65536:16384;if(u.e.c>255||u.e.r>=p){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");u.e.c=Math.min(u.e.c,255),u.e.r=Math.min(u.e.c,p-1)}vt(n,2057,yy(r,16,t)),vt(n,13,Ws(1)),vt(n,12,Ws(100)),vt(n,15,zi(!0)),vt(n,17,zi(!1)),vt(n,16,Mc(.001)),vt(n,95,zi(!0)),vt(n,42,zi(!1)),vt(n,43,zi(!1)),vt(n,130,Ws(1)),vt(n,128,ZR()),vt(n,131,zi(!1)),vt(n,132,zi(!1)),c&&K$(n,s["!cols"]),vt(n,512,qR(u,t)),c&&(s["!links"]=[]);for(var m=u.s.r;m<=u.e.r;++m){h=En(m);for(var g=u.s.c;g<=u.e.c;++g){m===u.s.r&&(d[g]=en(g)),f=d[g]+h;var x=a?(s[m]||[])[g]:s[f];x&&(J$(n,x,m,g,t),c&&x.l&&s["!links"].push([f,x.l]))}}var y=o.CodeName||o.name||i;return c&&vt(n,574,LR((l.Views||[])[0])),c&&(s["!merges"]||[]).length&&vt(n,229,hM(s["!merges"])),c&&Y$(n,s),vt(n,442,fE(y)),c&&G$(n,s),vt(n,10),n.end()}function Z$(e,t,r){var n=ns(),i=(e||{}).Workbook||{},s=i.Sheets||[],l=i.WBProps||{},o=r.biff==8,a=r.biff==5;if(vt(n,2057,yy(e,5,r)),r.bookType=="xla"&&vt(n,135),vt(n,225,o?Ws(1200):null),vt(n,193,eR(2)),a&&vt(n,191),a&&vt(n,192),vt(n,226),vt(n,92,bR("SheetJS",r)),vt(n,66,Ws(o?1200:1252)),o&&vt(n,353,Ws(0)),o&&vt(n,448),vt(n,317,AM(e.SheetNames.length)),o&&e.vbaraw&&vt(n,211),o&&e.vbaraw){var c=l.CodeName||"ThisWorkbook";vt(n,442,fE(c))}vt(n,156,Ws(17)),vt(n,25,zi(!1)),vt(n,18,zi(!1)),vt(n,19,Ws(0)),o&&vt(n,431,zi(!1)),o&&vt(n,444,Ws(0)),vt(n,61,jR()),vt(n,64,zi(!1)),vt(n,141,Ws(0)),vt(n,34,zi(PH(e)=="true")),vt(n,14,zi(!0)),o&&vt(n,439,zi(!1)),vt(n,218,Ws(0)),V$(n,e,r),q$(n,e.SSF,r),X$(n,r),o&&vt(n,352,zi(!1));var f=n.end(),h=ns();o&&vt(h,140,bM()),o&&r.Strings&&B$(h,252,TR(r.Strings)),vt(h,10);var d=h.end(),u=ns(),p=0,m=0;for(m=0;m<e.SheetNames.length;++m)p+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var g=f.length+p+d.length;for(m=0;m<e.SheetNames.length;++m){var x=s[m]||{};vt(u,133,CR({pos:g,hs:x.Hidden||0,dt:0,name:e.SheetNames[m]},r)),g+=t[m].length}var y=u.end();if(p!=y.length)throw new Error("BS8 "+p+" != "+y.length);var w=[];return f.length&&w.push(f),y.length&&w.push(y),d.length&&w.push(d),ti(w)}function eV(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Vr(Ut)),e&&e.SSF&&(Nf(),s1(e.SSF),r.revssf=o1(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Fy(r),r.cellXfs=[],$l(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=Q$(i,r,e);return n.unshift(Z$(e,n,r)),ti(n)}function iT(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=is(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return eV(e,t);case 4:case 3:case 2:return $$(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function SS(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),l=i.index,o=s&&s.index||e.length,a=MI(e.slice(l,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,h=0,d=0,u={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(l=0;l<a.length;++l){var m=a[l].trim(),g=m.slice(0,3).toLowerCase();if(g=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}f=0;continue}if(!(g!="<td"&&g!="<th")){var x=m.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var y=x[o].trim();if(y.match(/<t[dh]/i)){for(var w=y,_=0;w.charAt(0)=="<"&&(_=w.indexOf(">"))>-1;)w=w.slice(_+1);for(var C=0;C<p.length;++C){var E=p[C];E.s.c==f&&E.s.r<c&&c<=E.e.r&&(f=E.e.c+1,C=-1)}var T=Vt(y.slice(0,y.indexOf(">")));d=T.colspan?+T.colspan:1,((h=+T.rowspan)>1||d>1)&&p.push({s:{r:c,c:f},e:{r:c+(h||1)-1,c:f+d-1}});var A=T.t||T["data-t"]||"";if(!w.length){f+=d;continue}if(w=NC(w),u.s.r>c&&(u.s.r=c),u.e.r<c&&(u.e.r=c),u.s.c>f&&(u.s.c=f),u.e.c<f&&(u.e.c=f),!w.length){f+=d;continue}var j={t:"s",v:w};r.raw||!w.trim().length||A=="s"||(w==="TRUE"?j={t:"b",v:!0}:w==="FALSE"?j={t:"b",v:!1}:isNaN(wa(w))?isNaN(xf(w).getDate())||(j={t:"d",v:$r(w)},r.cellDates||(j={t:"n",v:Yn(j.v)}),j.z=r.dateNF||Ut[14]):j={t:"n",v:wa(w)}),r.dense?(n[c]||(n[c]=[]),n[c][f]=j):n[Ht({r:c,c:f})]=j,f+=d}}}}return n["!ref"]=er(u),p.length&&(n["!merges"]=p),n}function tV(e,t,r,n){for(var i=e["!merges"]||[],s=[],l=t.s.c;l<=t.e.c;++l){for(var o=0,a=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>l)&&!(i[c].e.r<r||i[c].e.c<l)){if(i[c].s.r<r||i[c].s.c<l){o=-1;break}o=i[c].e.r-i[c].s.r+1,a=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var f=Ht({r,c:l}),h=n.dense?(e[r]||[])[l]:e[f],d=h&&h.v!=null&&(h.h||ay(h.w||(Do(h),h.w)||""))||"",u={};o>1&&(u.rowspan=o),a>1&&(u.colspan=a),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(u["data-t"]=h&&h.t||"z",h.v!=null&&(u["data-v"]=h.v),h.z!=null&&(u["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),u.id=(n.id||"sjs")+"-"+f,s.push(xt("td",d,u))}}var p="<tr>";return p+s.join("")+"</tr>"}var rV='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',nV="</body></html>";function iV(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Hl(SS(r[0],t),t);var n=Ly();return r.forEach(function(i,s){Iy(n,SS(i,t),"Sheet"+(s+1))}),n}function sV(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function sT(e,t){var r=t||{},n=r.header!=null?r.header:rV,i=r.footer!=null?r.footer:nV,s=[n],l=is(e["!ref"]);r.dense=Array.isArray(e),s.push(sV(e,l,r));for(var o=l.s.r;o<=l.e.r;++o)s.push(tV(e,l,o,r));return s.push("</table>"+i),s.join("")}function aT(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?tn(n.origin):n.origin;i=l.r,s=l.c}var o=t.getElementsByTagName("tr"),a=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var f=is(e["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),i==-1&&(c.e.r=i=f.e.r+1)}var h=[],d=0,u=e["!rows"]||(e["!rows"]=[]),p=0,m=0,g=0,x=0,y=0,w=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&m<a;++p){var _=o[p];if(kS(_)){if(n.display)continue;u[m]={hidden:!0}}var C=_.children;for(g=x=0;g<C.length;++g){var E=C[g];if(!(n.display&&kS(E))){var T=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):NC(E.innerHTML),A=E.getAttribute("data-z")||E.getAttribute("z");for(d=0;d<h.length;++d){var j=h[d];j.s.c==x+s&&j.s.r<m+i&&m+i<=j.e.r&&(x=j.e.c+1-s,d=-1)}w=+E.getAttribute("colspan")||1,((y=+E.getAttribute("rowspan")||1)>1||w>1)&&h.push({s:{r:m+i,c:x+s},e:{r:m+i+(y||1)-1,c:x+s+(w||1)-1}});var B={t:"s",v:T},F=E.getAttribute("data-t")||E.getAttribute("t")||"";T!=null&&(T.length==0?B.t=F||"z":n.raw||T.trim().length==0||F=="s"||(T==="TRUE"?B={t:"b",v:!0}:T==="FALSE"?B={t:"b",v:!1}:isNaN(wa(T))?isNaN(xf(T).getDate())||(B={t:"d",v:$r(T)},n.cellDates||(B={t:"n",v:Yn(B.v)}),B.z=n.dateNF||Ut[14]):B={t:"n",v:wa(T)})),B.z===void 0&&A!=null&&(B.z=A);var L="",G=E.getElementsByTagName("A");if(G&&G.length)for(var X=0;X<G.length&&!(G[X].hasAttribute("href")&&(L=G[X].getAttribute("href"),L.charAt(0)!="#"));++X);L&&L.charAt(0)!="#"&&(B.l={Target:L}),n.dense?(e[m+i]||(e[m+i]=[]),e[m+i][x+s]=B):e[Ht({c:x+s,r:m+i})]=B,c.e.c<x+s&&(c.e.c=x+s),x+=w}}++m}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,m-1+i),e["!ref"]=er(c),m>=a&&(e["!fullref"]=er((c.e.r=o.length-p+m-1+i,c))),e}function oT(e,t){var r=t||{},n=r.dense?[]:{};return aT(n,e,t)}function aV(e,t){return Hl(oT(e,t),t)}function kS(e){var t="",r=oV(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function oV(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function lV(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=gr(t.replace(/<[^>]*>/g,""));return[r]}var CS={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function lT(e,t){var r=t||{},n=oy(e),i=[],s,l,o={name:""},a="",c=0,f,h,d={},u=[],p=r.dense?[]:{},m,g,x={value:""},y="",w=0,_=[],C=-1,E=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,j={},B=[],F={},L=0,G=0,X=[],re=1,Q=1,ne=[],J={Names:[]},P={},H=["",""],U=[],S={},I="",O=0,N=!1,R=!1,z=0;for(Ed.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Ed.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?p["!ref"]=er(T):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(p["!fullref"]=p["!ref"],T.e.r=r.sheetRows-1,p["!ref"]=er(T)),B.length&&(p["!merges"]=B),X.length&&(p["!rows"]=X),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),u.push(f.name),d[f.name]=p,R=!1):m[0].charAt(m[0].length-2)!=="/"&&(f=Vt(m[0],!1),C=E=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,p=r.dense?[]:{},B=[],X=[],R=!0);break;case"table-row-group":m[1]==="/"?--A:++A;break;case"table-row":case"":if(m[1]==="/"){C+=re,re=1;break}if(h=Vt(m[0],!1),h.?C=h.-1:C==-1&&(C=0),re=+h["number-rows-repeated"]||1,re<10)for(z=0;z<re;++z)A>0&&(X[C+z]={level:A});E=-1;break;case"covered-table-cell":m[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(p[C]||(p[C]=[]),p[C][E]={t:"z"}):p[Ht({r:C,c:E})]={t:"z"}),y="",_=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++E,x=Vt(m[0],!1),Q=parseInt(x["number-columns-repeated"]||"1",10),g={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(g.f=wS(gr(x.formula))),(x.||x["value-type"])=="string"&&(g.t="s",g.v=gr(x["string-value"]||""),r.dense?(p[C]||(p[C]=[]),p[C][E]=g):p[Ht({r:C,c:E})]=g),E+=Q-1;else if(m[1]!=="/"){++E,y="",w=0,_=[],Q=1;var K=re?C+re-1:C;if(E>T.e.c&&(T.e.c=E),E<T.s.c&&(T.s.c=E),C<T.s.r&&(T.s.r=C),K>T.e.r&&(T.e.r=K),x=Vt(m[0],!1),U=[],S={},g={t:x.||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=gr(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(L=parseInt(x["number-matrix-rows-spanned"],10)||0,G=parseInt(x["number-matrix-columns-spanned"],10)||0,F={s:{r:C,c:E},e:{r:C+L-1,c:E+G-1}},g.F=er(F),ne.push([F,g.F])),x.formula)g.f=wS(x.formula);else for(z=0;z<ne.length;++z)C>=ne[z][0].s.r&&C<=ne[z][0].e.r&&E>=ne[z][0].s.c&&E<=ne[z][0].e.c&&(g.F=ne[z][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(L=parseInt(x["number-rows-spanned"],10)||0,G=parseInt(x["number-columns-spanned"],10)||0,F={s:{r:C,c:E},e:{r:C+L-1,c:E+G-1}},B.push(F)),x["number-columns-repeated"]&&(Q=parseInt(x["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=Ur(x["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(x.value);break;case"percentage":g.t="n",g.v=parseFloat(x.value);break;case"currency":g.t="n",g.v=parseFloat(x.value);break;case"date":g.t="d",g.v=$r(x["date-value"]),r.cellDates||(g.t="n",g.v=Yn(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=LI(x["time-value"])/86400,r.cellDates&&(g.t="d",g.v=l1(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(x.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",x["string-value"]!=null&&(y=gr(x["string-value"]),_=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(N=!1,g.t==="s"&&(g.v=y||"",_.length&&(g.R=_),N=w==0),P.Target&&(g.l=P),U.length>0&&(g.c=U,U=[]),y&&r.cellText!==!1&&(g.w=y),N&&(g.t="z",delete g.v),(!N||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=C))for(var Y=0;Y<re;++Y){if(Q=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(p[C+Y]||(p[C+Y]=[]),p[C+Y][E]=Y==0?g:Vr(g);--Q>0;)p[C+Y][E+Q]=Vr(g);else for(p[Ht({r:C+Y,c:E})]=g;--Q>0;)p[Ht({r:C+Y,c:E+Q})]=Vr(g);T.e.c<=E&&(T.e.c=E)}Q=parseInt(x["number-columns-repeated"]||"1",10),E+=Q-1,Q=0,g={},y="",_=[]}P={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s;S.t=y,_.length&&(S.R=_),S.a=I,U.push(S)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);I="",O=0,y="",w=0,_=[];break;case"creator":m[1]==="/"?I=n.slice(O,m.index):O=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);y="",w=0,_=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(j[o.name]=a,(s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(a="",o=Vt(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":l=Vt(m[0],!1),a+=CS[m[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":l=Vt(m[0],!1),a+=CS[m[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":a+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":l=Vt(m[0],!1),H=sx(l["cell-range-address"]);var Z={Name:l.name,Ref:H[0]+"!"+H[1]};R&&(Z.Sheet=u.length),J.Names.push(Z);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!x||!x["string-value"])){var se=lV(n.slice(w,m.index));y=(y.length>0?y+`
`:"")+se[0]}else Vt(m[0],!1),w=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{H=sx(Vt(m[0])["target-range-address"]),d[H[0]]["!autofilter"]={ref:H[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(P=Vt(m[0],!1),!P.href)break;P.Target=gr(P.href),delete P.href,P.Target.charAt(0)=="#"&&P.Target.indexOf(".")>-1?(H=sx(P.Target.slice(1)),P.Target="#"+H[0]+"!"+H[1]):P.Target.match(/^\.\.[\\\/]/)&&(P.Target=P.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var V={Sheets:d,SheetNames:u,Workbook:J};return r.bookSheets&&delete V.Sheets,V}function ES(e,t){t=t||{},Us(e,"META-INF/manifest.xml")&&L7(Dn(e,"META-INF/manifest.xml"),t);var r=ws(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=lT(Or(r),t);return Us(e,"meta.xml")&&(n.Props=QC(Dn(e,"meta.xml"))),n}function TS(e,t){return lT(e,t)}var cV=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Cd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Tn+t}}(),NS=function(){var e=function(s){return Tr(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,l,o){var a=[];a.push('      <table:table table:name="'+Tr(l.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,f=0,h=is(s["!ref"]||"A1"),d=s["!merges"]||[],u=0,p=Array.isArray(s);if(s["!cols"])for(f=0;f<=h.e.c;++f)a.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var m="",g=s["!rows"]||[];for(c=0;c<h.s.r;++c)m=g[c]?' table:style-name="ro'+g[c].ods+'"':"",a.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=h.e.r;++c){for(m=g[c]?' table:style-name="ro'+g[c].ods+'"':"",a.push("        <table:table-row"+m+`>
`),f=0;f<h.s.c;++f)a.push(t);for(;f<=h.e.c;++f){var x=!1,y={},w="";for(u=0;u!=d.length;++u)if(!(d[u].s.c>f)&&!(d[u].s.r>c)&&!(d[u].e.c<f)&&!(d[u].e.r<c)){(d[u].s.c!=f||d[u].s.r!=c)&&(x=!0),y["table:number-columns-spanned"]=d[u].e.c-d[u].s.c+1,y["table:number-rows-spanned"]=d[u].e.r-d[u].s.r+1;break}if(x){a.push(r);continue}var _=Ht({r:c,c:f}),C=p?(s[c]||[])[f]:s[_];if(C&&C.f&&(y["table:formula"]=Tr(AW(C.f)),C.F&&C.F.slice(0,_.length)==_)){var E=is(C.F);y["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,y["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!C){a.push(t);continue}switch(C.t){case"b":w=C.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=C.v?"true":"false";break;case"n":w=C.w||String(C.v||0),y["office:value-type"]="float",y["office:value"]=C.v||0;break;case"s":case"str":w=C.v==null?"":C.v,y["office:value-type"]="string";break;case"d":w=C.w||$r(C.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=$r(C.v).toISOString(),y["table:style-name"]="ce1";break;default:a.push(t);continue}var T=e(w);if(C.l&&C.l.Target){var A=C.l.Target;A=A.charAt(0)=="#"?"#"+OW(A.slice(1)):A,A.charAt(0)!="#"&&!A.match(/^\w+:/)&&(A="../"+A),T=xt("text:a",T,{"xlink:href":A.replace(/&/g,"&amp;")})}a.push("          "+xt("table:table-cell",xt("text:p",T,{}),y)+`
`)}a.push(`        </table:table-row>
`)}return a.push(`      </table:table>
`),a.join("")},i=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(c){return l.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var f=0;f<c["!cols"].length;++f)if(c["!cols"][f]){var h=c["!cols"][f];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Il(h),h.ods=o;var d=c["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++o}}});var a=0;l.SheetNames.map(function(c){return l.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var f=0;f<c["!rows"].length;++f)if(c["!rows"][f]){c["!rows"][f].ods=a;var h=c["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+a+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++a}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,o){var a=[Tn],c=Cd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Cd({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(a.push("<office:document"+c+f+`>
`),a.push(JC().replace(/office:document-meta/g,"office:meta"))):a.push("<office:document-content"+c+`>
`),i(a,l),a.push(`  <office:body>
`),a.push(`    <office:spreadsheet>
`);for(var h=0;h!=l.SheetNames.length;++h)a.push(n(l.Sheets[l.SheetNames[h]],l,h));return a.push(`    </office:spreadsheet>
`),a.push(`  </office:body>
`),o.bookType=="fods"?a.push("</office:document>"):a.push("</office:document-content>"),a.join("")}}();function cT(e,t){if(t.bookType=="fods")return NS(e,t);var r=ny(),n="",i=[],s=[];return n="mimetype",nr(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",nr(r,n,NS(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",nr(r,n,cV(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",nr(r,n,Tn+JC()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",nr(r,n,M7(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",nr(r,n,I7(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Wc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Bv(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Or(zl(e))}function uV(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ys(qa(e))}function fV(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Ml(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function AS(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function hV(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function dV(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function jd(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function br(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function hn(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function xr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=jd(e,r),s=i&7;i=Math.floor(i/8);var l=0,o;if(i==0)break;switch(s){case 0:{for(var a=r[0];e[r[0]++]>=128;);o=e.slice(a,r[0])}break;case 5:l=4,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=jd(e,r),o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function fi(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(br(n*8+i.type)),i.type==2&&t.push(br(i.data.length)),t.push(i.data))})}),Ml(t)}function Oy(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Ms(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=jd(e,n),s=xr(e.slice(n[0],n[0]+i));n[0]+=i;var l={id:hn(s[1][0].data),messages:[]};s[2].forEach(function(o){var a=xr(o.data),c=hn(a[3][0].data);l.messages.push({meta:a,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(l.merge=hn(s[3][0].data)>>>0>0),r.push(l)}return r}function Su(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:br(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:br(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(l){i.push(l.data),l.meta[3]=[{type:0,data:br(l.data.length)}],n[2].push({data:fi(l.meta),type:2})});var s=fi(n);t.push(br(s.length)),t.push(s),i.forEach(function(l){return t.push(l)})}),Ml(t)}function pV(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=jd(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=t[r[0]],o>1&&(l|=t[r[0]+1]<<8),o>2&&(l|=t[r[0]+2]<<16),o>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}i.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var a=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,a=(t[r[0]++]&224)<<3,a|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(a=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(a=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Ml(i)],a==0)throw new Error("Invalid offset 0");if(a>i[0].length)throw new Error("Invalid offset beyond length");if(c>=a)for(i.push(i[0].slice(-a)),c-=a;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-a,-a+c))}}var f=Ml(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Bs(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(pV(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ml(t)}function ku(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=br(n),l=s.length;t.push(s),n<=60?(l++,t.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),l+=n,i[0]=0,i[1]=l&255,i[2]=l>>8&255,i[3]=l>>16&255,r+=n}return Ml(t)}function gV(e,t,r,n){var i=Wc(e),s=i.getUint32(4,!0),l=(n>1?12:8)+AS(s&(n>1?3470:398))*4,o=-1,a=-1,c=NaN,f=new Date(2001,0,1);s&512&&(o=i.getUint32(l,!0),l+=4),l+=AS(s&(n>1?12288:4096))*4,s&16&&(a=i.getUint32(l,!0),l+=4),s&32&&(c=i.getFloat64(l,!0),l+=8),s&64&&(f.setTime(f.getTime()+i.getFloat64(l,!0)*1e3),l+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[a]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(a>-1)h={t:"s",v:t[a]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function mV(e,t,r){var n=Wc(e),i=n.getUint32(8,!0),s=12,l=-1,o=-1,a=NaN,c=NaN,f=new Date(2001,0,1);i&1&&(a=hV(e,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(l=n.getUint32(s,!0),s+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:a};break;case 3:h={t:"s",v:t[o]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(l>-1)h={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:a};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return h}function ox(e,t){var r=new Uint8Array(32),n=Wc(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,dV(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function lx(e,t){var r=new Uint8Array(32),n=Wc(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function xV(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return gV(e,t,r,e[0]);case 5:return mV(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ei(e){var t=xr(e);return jd(t[1][0].data)}function OS(e,t){var r=xr(t.data),n=hn(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(l){var o=xr(l.data),a=hn(o[1][0].data)>>>0;switch(n){case 1:s[a]=Bv(o[3][0].data);break;case 8:{var c=e[Ei(o[9][0].data)][0],f=xr(c.data),h=e[Ei(f[1][0].data)][0],d=hn(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var u=xr(h.data);s[a]=u[3].map(function(p){return Bv(p.data)}).join("")}break}}),s}function vV(e,t){var r,n,i,s,l,o,a,c,f,h,d,u,p,m,g=xr(e),x=hn(g[1][0].data)>>>0,y=hn(g[2][0].data)>>>0,w=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&hn(g[8][0].data)>0||!1,_,C;if((s=(i=g[7])==null?void 0:i[0])!=null&&s.data&&t!=0)_=(o=(l=g[7])==null?void 0:l[0])==null?void 0:o.data,C=(c=(a=g[6])==null?void 0:a[0])==null?void 0:c.data;else if((h=(f=g[4])==null?void 0:f[0])!=null&&h.data&&t!=1)_=(u=(d=g[4])==null?void 0:d[0])==null?void 0:u.data,C=(m=(p=g[3])==null?void 0:p[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var E=w?4:1,T=Wc(_),A=[],j=0;j<_.length/2;++j){var B=T.getUint16(j*2,!0);B<65535&&A.push([j,B])}if(A.length!=y)throw"Expected ".concat(y," cells, found ").concat(A.length);var F=[];for(j=0;j<A.length-1;++j)F[A[j][0]]=C.subarray(A[j][1]*E,A[j+1][1]*E);return A.length>=1&&(F[A[A.length-1][0]]=C.subarray(A[A.length-1][1]*E)),{R:x,cells:F}}function yV(e,t){var r,n=xr(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?hn(n[7][0].data)>>>0>0?1:0:-1,s=Oy(n[5],function(l){return vV(l,i)});return{nrows:hn(n[4][0].data)>>>0,data:s.reduce(function(l,o){return l[o.R]||(l[o.R]=[]),o.cells.forEach(function(a,c){if(l[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));l[o.R][c]=a}),l},[])}}function wV(e,t,r){var n,i=xr(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(hn(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(hn(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=er(s);var l=xr(i[4][0].data),o=OS(e,e[Ei(l[4][0].data)][0]),a=(n=l[17])!=null&&n[0]?OS(e,e[Ei(l[17][0].data)][0]):[],c=xr(l[3][0].data),f=0;c[1].forEach(function(h){var d=xr(h.data),u=e[Ei(d[2][0].data)][0],p=hn(u.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var m=yV(e,u);m.data.forEach(function(g,x){g.forEach(function(y,w){var _=Ht({r:f+x,c:w}),C=xV(y,o,a);C&&(r[_]=C)})}),f+=m.nrows})}function _V(e,t){var r=xr(t.data),n={"!ref":"A1"},i=e[Ei(r[2][0].data)],s=hn(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return wV(e,i[0],n),n}function bV(e,t){var r,n=xr(t.data),i={name:(r=n[1])!=null&&r[0]?Bv(n[1][0].data):"",sheets:[]},s=Oy(n[2],Ei);return s.forEach(function(l){e[l].forEach(function(o){var a=hn(o.meta[1][0].data);a==6e3&&i.sheets.push(_V(e,o))})}),i}function SV(e,t){var r=Ly(),n=xr(t.data),i=Oy(n[1],Ei);if(i.forEach(function(s){e[s].forEach(function(l){var o=hn(l.meta[1][0].data);if(o==2){var a=bV(e,l);a.sheets.forEach(function(c,f){Iy(r,c,f==0?a.name:a.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function cx(e){var t,r,n,i,s={},l=[];if(e.FullPaths.forEach(function(a){if(a.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(a){if(a.name.match(/\.iwa$/)){var c;try{c=Bs(a.content)}catch(h){return console.log("?? "+a.content.length+" "+(h.message||h))}var f;try{f=Ms(c)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){s[h.id]=h.messages,l.push(h.id)})}}),!l.length)throw new Error("File has no messages");var o=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&hn(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||l.forEach(function(a){s[a].forEach(function(c){var f=hn(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return SV(s,o)}function kV(e,t,r){var n,i,s,l;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(s=e[8])==null?void 0:s[0])==null?void 0:l.data)&&hn(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var a=0,c=Wc(e[7][0].data),f=0,h=[],d=Wc(e[4][0].data),u=0,p=[],m=0;m<t.length;++m){if(t[m]==null){c.setUint16(m*2,65535,!0),d.setUint16(m*2,65535);continue}c.setUint16(m*2,f,!0),d.setUint16(m*2,u,!0);var g,x;switch(typeof t[m]){case"string":g=ox({t:"s",v:t[m]},r),x=lx({t:"s",v:t[m]},r);break;case"number":g=ox({t:"n",v:t[m]},r),x=lx({t:"n",v:t[m]},r);break;case"boolean":g=ox({t:"b",v:t[m]},r),x=lx({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}h.push(g),f+=g.length,p.push(x),u+=x.length,++a}for(e[2][0].data=br(a);m<e[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),d.setUint16(m*2,65535,!0);return e[6][0].data=Ml(h),e[3][0].data=Ml(p),a}function CV(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=is(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(er(n)));var s=Fg(r,{range:n,header:1}),l=["~Sh33tJ5~"];s.forEach(function(I){return I.forEach(function(O){typeof O=="string"&&l.push(O)})});var o={},a=[],c=Rt.read(t.numbers,{type:"base64"});c.FileIndex.map(function(I,O){return[I,c.FullPaths[O]]}).forEach(function(I){var O=I[0],N=I[1];if(O.type==2&&O.name.match(/\.iwa/)){var R=O.content,z=Bs(R),K=Ms(z);K.forEach(function(Y){a.push(Y.id),o[Y.id]={deps:[],location:N,type:hn(Y.messages[0].meta[1][0].data)}})}}),a.sort(function(I,O){return I-O});var f=a.filter(function(I){return I>1}).map(function(I){return[I,br(I)]});c.FileIndex.map(function(I,O){return[I,c.FullPaths[O]]}).forEach(function(I){var O=I[0];if(I[1],!!O.name.match(/\.iwa/)){var N=Ms(Bs(O.content));N.forEach(function(R){R.messages.forEach(function(z){f.forEach(function(K){R.messages.some(function(Y){return hn(Y.meta[1][0].data)!=11006&&fV(Y.data,K[1])})&&o[K[0]].deps.push(R.id)})})})}});for(var h=Rt.find(c,o[1].location),d=Ms(Bs(h.content)),u,p=0;p<d.length;++p){var m=d[p];m.id==1&&(u=m)}var g=Ei(xr(u.messages[0].data)[1][0].data);for(h=Rt.find(c,o[g].location),d=Ms(Bs(h.content)),p=0;p<d.length;++p)m=d[p],m.id==g&&(u=m);for(g=Ei(xr(u.messages[0].data)[2][0].data),h=Rt.find(c,o[g].location),d=Ms(Bs(h.content)),p=0;p<d.length;++p)m=d[p],m.id==g&&(u=m);for(g=Ei(xr(u.messages[0].data)[2][0].data),h=Rt.find(c,o[g].location),d=Ms(Bs(h.content)),p=0;p<d.length;++p)m=d[p],m.id==g&&(u=m);var x=xr(u.messages[0].data);{x[6][0].data=br(n.e.r+1),x[7][0].data=br(n.e.c+1);var y=Ei(x[46][0].data),w=Rt.find(c,o[y].location),_=Ms(Bs(w.content));{for(var C=0;C<_.length&&_[C].id!=y;++C);if(_[C].id!=y)throw"Bad ColumnRowUIDMapArchive";var E=xr(_[C].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var T=0;T<=n.e.c;++T){var A=[];A[1]=A[2]=[{type:0,data:br(T+420690)}],E[1].push({type:2,data:fi(A)}),E[2].push({type:0,data:br(T)}),E[3].push({type:0,data:br(T)})}E[4]=[],E[5]=[],E[6]=[];for(var j=0;j<=n.e.r;++j)A=[],A[1]=A[2]=[{type:0,data:br(j+726270)}],E[4].push({type:2,data:fi(A)}),E[5].push({type:0,data:br(j)}),E[6].push({type:0,data:br(j)});_[C].messages[0].data=fi(E)}w.content=ku(Su(_)),w.size=w.content.length,delete x[46];var B=xr(x[4][0].data);{B[7][0].data=br(n.e.r+1);var F=xr(B[1][0].data),L=Ei(F[2][0].data);w=Rt.find(c,o[L].location),_=Ms(Bs(w.content));{if(_[0].id!=L)throw"Bad HeaderStorageBucket";var G=xr(_[0].messages[0].data);for(j=0;j<s.length;++j){var X=xr(G[2][0].data);X[1][0].data=br(j),X[4][0].data=br(s[j].length),G[2][j]={type:G[2][0].type,data:fi(X)}}_[0].messages[0].data=fi(G)}w.content=ku(Su(_)),w.size=w.content.length;var re=Ei(B[2][0].data);w=Rt.find(c,o[re].location),_=Ms(Bs(w.content));{if(_[0].id!=re)throw"Bad HeaderStorageBucket";for(G=xr(_[0].messages[0].data),T=0;T<=n.e.c;++T)X=xr(G[2][0].data),X[1][0].data=br(T),X[4][0].data=br(n.e.r+1),G[2][T]={type:G[2][0].type,data:fi(X)};_[0].messages[0].data=fi(G)}w.content=ku(Su(_)),w.size=w.content.length;var Q=Ei(B[4][0].data);(function(){for(var I=Rt.find(c,o[Q].location),O=Ms(Bs(I.content)),N,R=0;R<O.length;++R){var z=O[R];z.id==Q&&(N=z)}var K=xr(N.messages[0].data);{K[3]=[];var Y=[];l.forEach(function(V,le){Y[1]=[{type:0,data:br(le)}],Y[2]=[{type:0,data:br(1)}],Y[3]=[{type:2,data:uV(V)}],K[3].push({type:2,data:fi(Y)})})}N.messages[0].data=fi(K);var Z=Su(O),se=ku(Z);I.content=se,I.size=I.content.length})();var ne=xr(B[3][0].data);{var J=ne[1][0];delete ne[2];var P=xr(J.data);{var H=Ei(P[2][0].data);(function(){for(var I=Rt.find(c,o[H].location),O=Ms(Bs(I.content)),N,R=0;R<O.length;++R){var z=O[R];z.id==H&&(N=z)}var K=xr(N.messages[0].data);{delete K[6],delete ne[7];var Y=new Uint8Array(K[5][0].data);K[5]=[];for(var Z=0,se=0;se<=n.e.r;++se){var V=xr(Y);Z+=kV(V,s[se],l),V[1][0].data=br(se),K[5].push({data:fi(V),type:2})}K[1]=[{type:0,data:br(n.e.c+1)}],K[2]=[{type:0,data:br(n.e.r+1)}],K[3]=[{type:0,data:br(Z)}],K[4]=[{type:0,data:br(n.e.r+1)}]}N.messages[0].data=fi(K);var le=Su(O),ae=ku(le);I.content=ae,I.size=I.content.length})()}J.data=fi(P)}B[3][0].data=fi(ne)}x[4][0].data=fi(B)}u.messages[0].data=fi(x);var U=Su(d),S=ku(U);return h.content=S,h.size=h.content.length,c}function uT(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Py(e){uT([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Fy(e){uT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function EV(e){return ar.WS.indexOf(e)>-1?"sheet":e==ar.CS?"chart":e==ar.DS?"dialog":e==ar.MS?"macro":e&&e.length?e:"sheet"}function TV(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,EV(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function NV(e,t,r,n,i,s,l,o,a,c,f,h){try{s[n]=Wh(ws(e,r,!0),t);var d=Dn(e,t),u;switch(o){case"sheet":u=KH(d,t,i,a,s[n],c,f,h);break;case"chart":if(u=JH(d,t,i,a,s[n],c,f,h),!u||!u["!drawel"])break;var p=Sh(u["!drawel"].Target,t),m=Td(p),g=RB(ws(e,p,!0),Wh(ws(e,m,!0),p)),x=Sh(g,p),y=Td(x);u=kH(ws(e,x,!0),x,a,Wh(ws(e,y,!0),x),c,u);break;case"macro":u=QH(d,t,i,a,s[n],c,f,h);break;case"dialog":u=ZH(d,t,i,a,s[n],c,f,h);break;default:throw new Error("Unrecognized sheet type "+o)}l[n]=u;var w=[];s&&s[n]&&dn(s[n]).forEach(function(_){var C="";if(s[n][_].Type==ar.CMNT){C=Sh(s[n][_].Target,t);var E=n$(Dn(e,C,!0),C,a);if(!E||!E.length)return;gS(u,E,!1)}s[n][_].Type==ar.TCMNT&&(C=Sh(s[n][_].Target,t),w=w.concat(BB(Dn(e,C,!0),a)))}),w&&w.length&&gS(u,w,!0,a.people||[])}catch(_){if(a.WTF)throw _}}function Is(e){return e.charAt(0)=="/"?e.slice(1):e}function AV(e,t){if(Nf(),t=t||{},Py(t),Us(e,"META-INF/manifest.xml")||Us(e,"objectdata.xml"))return ES(e,t);if(Us(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof cx<"u"){if(e.FileIndex)return cx(e);var r=Rt.utils.cfb_new();return I5(e).forEach(function(X){nr(r,X,UI(e,X))}),cx(r)}throw new Error("Unsupported NUMBERS file")}if(!Us(e,"[Content_Types].xml"))throw Us(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Us(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=I5(e),i=j7(ws(e,"[Content_Types].xml")),s=!1,l,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Dn(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Dn(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var a={},c={};if(!t.bookSheets&&!t.bookProps){if(zh=[],i.sst)try{zh=r$(Dn(e,Is(i.sst)),i.sst,t)}catch(X){if(t.WTF)throw X}t.cellStyles&&i.themes.length&&(a=t$(ws(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=e$(Dn(e,Is(i.style)),i.style,a,t))}i.links.map(function(X){try{var re=Wh(ws(e,Td(Is(X))),X);return s$(Dn(e,Is(X)),re,X,t)}catch{}});var f=YH(Dn(e,Is(i.workbooks[0])),i.workbooks[0],t),h={},d="";i.coreprops.length&&(d=Dn(e,Is(i.coreprops[0]),!0),d&&(h=QC(d)),i.extprops.length!==0&&(d=Dn(e,Is(i.extprops[0]),!0),d&&U7(d,h,t)));var u={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(d=ws(e,Is(i.custprops[0]),!0),d&&(u=z7(d,t)));var p={};if((t.bookSheets||t.bookProps)&&(f.Sheets?l=f.Sheets.map(function(re){return re.name}):h.Worksheets&&h.SheetNames.length>0&&(l=h.SheetNames),t.bookProps&&(p.Props=h,p.Custprops=u),t.bookSheets&&typeof l<"u"&&(p.SheetNames=l),t.bookSheets?p.SheetNames:t.bookProps))return p;l={};var m={};t.bookDeps&&i.calcchain&&(m=i$(Dn(e,Is(i.calcchain)),i.calcchain));var g=0,x={},y,w;{var _=f.Sheets;h.Worksheets=_.length,h.SheetNames=[];for(var C=0;C!=_.length;++C)h.SheetNames[C]=_[C].name}var E=s?"bin":"xml",T=i.workbooks[0].lastIndexOf("/"),A=(i.workbooks[0].slice(0,T+1)+"_rels/"+i.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");Us(e,A)||(A="xl/_rels/workbook."+E+".rels");var j=Wh(ws(e,A,!0),A.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=a$(Dn(e,Is(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=WB(Dn(e,Is(i.people[0])),t)),j&&(j=TV(j,f.Sheets));var B=Dn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=h.Worksheets;++g){var F="sheet";if(j&&j[g]?(y="xl/"+j[g][1].replace(/[\/]?xl\//,""),Us(e,y)||(y=j[g][1]),Us(e,y)||(y=A.replace(/_rels\/.*$/,"")+j[g][1]),F=j[g][2]):(y="xl/worksheets/sheet"+(g+1-B)+"."+E,y=y.replace(/sheet0\./,"sheet.")),w=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(h.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var L=!1,G=0;G!=t.sheets.length;++G)typeof t.sheets[G]=="number"&&t.sheets[G]==g&&(L=1),typeof t.sheets[G]=="string"&&t.sheets[G].toLowerCase()==h.SheetNames[g].toLowerCase()&&(L=1);if(!L)continue e}}NV(e,y,w,h.SheetNames[g],g,x,l,F,t,f,a,c)}return p={Directory:i,Workbook:f,Props:h,Custprops:u,Deps:m,Sheets:l,SheetNames:h.SheetNames,Strings:zh,Styles:c,Themes:a,SSF:Vr(Ut)},t&&t.bookFiles&&(e.files?(p.keys=n,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(X,re){X=X.replace(/^Root Entry[\/]/,""),p.keys.push(X),p.files[X]=e.FileIndex[re]}))),t&&t.bookVBA&&(i.vba.length>0?p.vbaraw=Dn(e,Is(i.vba[0]),!0):i.defaults&&i.defaults.bin===YB&&(p.vbaraw=Dn(e,"xl/vbaProject.bin",!0))),p}function OV(e,t){var r=t||{},n="Workbook",i=Rt.find(e,n);try{if(n="/!DataSpaces/Version",i=Rt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(a9(i.content),n="/!DataSpaces/DataSpaceMap",i=Rt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=l9(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Rt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=c9(i.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Rt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);f9(i.content)}catch{}if(n="/EncryptionInfo",i=Rt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=h9(i.content);if(n="/EncryptedPackage",i=Rt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function PV(e,t){return t.bookType=="ods"?cT(e,t):t.bookType=="numbers"?CV(e,t):t.bookType=="xlsb"?FV(e,t):jV(e,t)}function FV(e,t){qu=1024,e&&!e.SSF&&(e.SSF=Vr(Ut)),e&&e.SSF&&(Nf(),s1(e.SSF),t.revssf=o1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Hh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=RE.indexOf(t.bookType)>-1,i=xy();Fy(t=t||{});var s=ny(),l="",o=0;if(t.cellXfs=[],$l(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",nr(s,l,ZC(e.Props,t)),i.coreprops.push(l),kr(t.rels,2,l,ar.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var a=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&a.push(e.SheetNames[c]);e.Props.SheetNames=a}for(e.Props.Worksheets=e.Props.SheetNames.length,nr(s,l,rE(e.Props)),i.extprops.push(l),kr(t.rels,3,l,ar.EXT_PROPS),e.Custprops!==e.Props&&dn(e.Custprops||{}).length>0&&(l="docProps/custom.xml",nr(s,l,nE(e.Custprops)),i.custprops.push(l),kr(t.rels,4,l,ar.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,nr(s,l,l$(o-1,l,t,e,f)),i.sheets.push(l),kr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,ar.WS[0])}if(h){var u=h["!comments"],p=!1,m="";u&&u.length>0&&(m="xl/comments"+o+"."+r,nr(s,m,f$(u,m)),i.comments.push(m),kr(f,-1,"../comments"+o+"."+r,ar.CMNT),p=!0),h["!legacy"]&&p&&nr(s,"xl/drawings/vmlDrawing"+o+".vml",LE(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&nr(s,Td(l),af(f))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,nr(s,l,u$(t.Strings,l,t)),i.strs.push(l),kr(t.wbrels,-1,"sharedStrings."+r,ar.SST)),l="xl/workbook."+r,nr(s,l,o$(e,l)),i.workbooks.push(l),kr(t.rels,1,l,ar.WB),l="xl/theme/theme1.xml",nr(s,l,Sy(e.Themes,t)),i.themes.push(l),kr(t.wbrels,-1,"theme/theme1.xml",ar.THEME),l="xl/styles."+r,nr(s,l,c$(e,l,t)),i.styles.push(l),kr(t.wbrels,-1,"styles."+r,ar.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",nr(s,l,e.vbaraw),i.vba.push(l),kr(t.wbrels,-1,"vbaProject.bin",ar.VBA)),l="xl/metadata."+r,nr(s,l,h$(l)),i.metadata.push(l),kr(t.wbrels,-1,"metadata."+r,ar.XLMETA),nr(s,"[Content_Types].xml",KC(i,t)),nr(s,"_rels/.rels",af(t.rels)),nr(s,"xl/_rels/workbook."+r+".rels",af(t.wbrels)),delete t.revssf,delete t.ssf,s}function jV(e,t){qu=1024,e&&!e.SSF&&(e.SSF=Vr(Ut)),e&&e.SSF&&(Nf(),s1(e.SSF),t.revssf=o1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Hh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=RE.indexOf(t.bookType)>-1,i=xy();Fy(t=t||{});var s=ny(),l="",o=0;if(t.cellXfs=[],$l(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",nr(s,l,ZC(e.Props,t)),i.coreprops.push(l),kr(t.rels,2,l,ar.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var a=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&a.push(e.SheetNames[c]);e.Props.SheetNames=a}e.Props.Worksheets=e.Props.SheetNames.length,nr(s,l,rE(e.Props)),i.extprops.push(l),kr(t.rels,3,l,ar.EXT_PROPS),e.Custprops!==e.Props&&dn(e.Custprops||{}).length>0&&(l="docProps/custom.xml",nr(s,l,nE(e.Custprops)),i.custprops.push(l),kr(t.rels,4,l,ar.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],u=(d||{})["!type"]||"sheet";switch(u){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,nr(s,l,XE(o-1,t,e,h)),i.sheets.push(l),kr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,ar.WS[0])}if(d){var p=d["!comments"],m=!1,g="";if(p&&p.length>0){var x=!1;p.forEach(function(y){y[1].forEach(function(w){w.T==!0&&(x=!0)})}),x&&(g="xl/threadedComments/threadedComment"+o+"."+r,nr(s,g,UB(p,f,t)),i.threadedcomments.push(g),kr(h,-1,"../threadedComments/threadedComment"+o+"."+r,ar.TCMNT)),g="xl/comments"+o+"."+r,nr(s,g,IE(p)),i.comments.push(g),kr(h,-1,"../comments"+o+"."+r,ar.CMNT),m=!0}d["!legacy"]&&m&&nr(s,"xl/drawings/vmlDrawing"+o+".vml",LE(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&nr(s,Td(l),af(h))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,nr(s,l,SE(t.Strings,t)),i.strs.push(l),kr(t.wbrels,-1,"sharedStrings."+r,ar.SST)),l="xl/workbook."+r,nr(s,l,ZE(e)),i.workbooks.push(l),kr(t.rels,1,l,ar.WB),l="xl/theme/theme1.xml",nr(s,l,Sy(e.Themes,t)),i.themes.push(l),kr(t.wbrels,-1,"theme/theme1.xml",ar.THEME),l="xl/styles."+r,nr(s,l,PE(e,t)),i.styles.push(l),kr(t.wbrels,-1,"styles."+r,ar.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",nr(s,l,e.vbaraw),i.vba.push(l),kr(t.wbrels,-1,"vbaProject.bin",ar.VBA)),l="xl/metadata."+r,nr(s,l,DE()),i.metadata.push(l),kr(t.wbrels,-1,"metadata."+r,ar.XLMETA),f.length>1&&(l="xl/persons/person.xml",nr(s,l,zB(f)),i.people.push(l),kr(t.wbrels,-1,"persons/person.xml",ar.PEOPLE)),nr(s,"[Content_Types].xml",KC(i,t)),nr(s,"_rels/.rels",af(t.rels)),nr(s,"xl/_rels/workbook."+r+".rels",af(t.wbrels)),delete t.revssf,delete t.ssf,s}function jy(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ts(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function DV(e,t){return Rt.find(e,"EncryptedPackage")?OV(e,t):nT(e,t)}function LV(e,t){var r,n=e,i=t||{};return i.type||(i.type=sr&&Buffer.isBuffer(e)?"buffer":"base64"),r=CC(n,i),AV(r,i)}function fT(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Rv(e.slice(r),t);default:break e}return vf.to_workbook(e,t)}function IV(e,t){var r="",n=jy(e,t);switch(t.type){case"base64":r=Ts(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Rc(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Or(r)),t.type="binary",fT(r,t)}function RV(e,t){var r=e;return t.type=="base64"&&(r=Ts(r)),r=_d.utils.decode(1200,r.slice(2),"str"),t.type="binary",fT(r,t)}function MV(e){return e.match(/[^\x00-\x7F]/)?qa(e):e}function ux(e,t,r,n){return n?(r.type="string",vf.to_workbook(e,r)):vf.to_workbook(t,r)}function Uv(e,t){Q2();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Uv(new Uint8Array(e),(r=Vr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),lf={},r.dateNF&&(lf.dateNF=r.dateNF),r.type||(r.type=sr&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=sr?"buffer":"binary",n=FI(e),typeof Uint8Array<"u"&&!sr&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=MV(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),o=new Uint8Array(l);if(o.foo="bar",!o.foo)return r=Vr(r),r.type="array",Uv(Z2(n),r)}switch((i=jy(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return DV(Rt.read(n,r),r);break;case 9:if(i[1]<=8)return nT(n,r);break;case 60:return Rv(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return HM(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return _E.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?LV(n,r):ux(e,n,r,s);case 239:return i[3]===60?Rv(n,r):ux(e,n,r,s);case 255:if(i[1]===254)return RV(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Ec.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Ec.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Iv.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return NE.to_workbook(n,r);break;case 10:case 13:case 32:return IV(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return zM.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Iv.to_workbook(n,r):ux(e,n,r,s)}function hT(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return $d(t.file,Rt.write(e,{type:sr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Rt.write(e,t)}function BV(e,t){var r=Vr(t||{}),n=PV(e,r);return UV(n,r)}function UV(e,t){var r={},n=sr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Rt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(i1(i))}return t.password&&typeof encrypt_agile<"u"?hT(encrypt_agile(i,t.password),t):t.type==="file"?$d(t.file,i):t.type=="string"?Or(i):i}function WV(e,t){var r=t||{},n=M$(e,r);return hT(n,r)}function Ma(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return bd(qa(n));case"binary":return qa(n);case"string":return e;case"file":return $d(t.file,n,"utf8");case"buffer":return sr?Ro(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ma(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function zV(e,t){switch(t.type){case"base64":return bd(e);case"binary":return e;case"string":return e;case"file":return $d(t.file,e,"binary");case"buffer":return sr?Ro(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function xp(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?bd(r):t.type=="string"?Or(r):r;case"file":return $d(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function dT(e,t){Q2(),DH(e);var r=Vr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=dT(e,r);return r.type="array",i1(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ma(P$(e,r),r);case"slk":case"sylk":return Ma(wE.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return Ma(sT(e.Sheets[e.SheetNames[i]],r),r);case"txt":return zV(pT(e.Sheets[e.SheetNames[i]],r),r);case"csv":return Ma(Dy(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return Ma(_E.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return xp(Iv.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return Ma(vf.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return Ma(NE.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return Ma(bE.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return Ma(cT(e,r),r);case"wk1":return xp(Ec.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return xp(Ec.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),xp(iT(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),WV(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return BV(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function HV(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function $V(e,t,r){var n={};return n.type="file",n.file=t,HV(n),dT(e,n)}function VV(e,t,r,n,i,s,l,o){var a=En(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!l||e[r])for(var u=t.s.c;u<=t.e.c;++u){var p=l?e[r][u]:e[n[u]+a];if(p===void 0||p.t===void 0){if(c===void 0)continue;s[u]!=null&&(d[s[u]]=c);continue}var m=p.v;switch(p.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(s[u]!=null){if(m==null)if(p.t=="e"&&m===null)d[s[u]]=null;else if(c!==void 0)d[s[u]]=c;else if(f&&m===null)d[s[u]]=null;else continue;else d[s[u]]=f&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?m:Do(p,m,o);m!=null&&(h=!1)}}return{row:d,isempty:h}}function Fg(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],l=0,o="",a={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},f=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":a=mr(f);break;case"number":a=mr(e["!ref"]),a.s.r=f;break;default:a=f}n>0&&(i=0);var h=En(a.s.r),d=[],u=[],p=0,m=0,g=Array.isArray(e),x=a.s.r,y=0,w={};g&&!e[x]&&(e[x]=[]);var _=c.skipHidden&&e["!cols"]||[],C=c.skipHidden&&e["!rows"]||[];for(y=a.s.c;y<=a.e.c;++y)if(!(_[y]||{}).hidden)switch(d[y]=en(y),r=g?e[x][y]:e[d[y]+h],n){case 1:s[y]=y-a.s.c;break;case 2:s[y]=d[y];break;case 3:s[y]=c.header[y-a.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=Do(r,null,c),m=w[l]||0,!m)w[l]=1;else{do o=l+"_"+m++;while(w[o]);w[l]=m,w[o]=1}s[y]=o}for(x=a.s.r+i;x<=a.e.r;++x)if(!(C[x]||{}).hidden){var E=VV(e,a,x,d,n,s,g,c);(E.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(u[p++]=E.row)}return u.length=p,u}var PS=/"/g;function qV(e,t,r,n,i,s,l,o){for(var a=!0,c=[],f="",h=En(r),d=t.s.c;d<=t.e.c;++d)if(n[d]){var u=o.dense?(e[r]||[])[d]:e[n[d]+h];if(u==null)f="";else if(u.v!=null){a=!1,f=""+(o.rawNumbers&&u.t=="n"?u.v:Do(u,null,o));for(var p=0,m=0;p!==f.length;++p)if((m=f.charCodeAt(p))===i||m===s||m===34||o.forceQuotes){f='"'+f.replace(PS,'""')+'"';break}f=="ID"&&(f='"ID"')}else u.f!=null&&!u.F?(a=!1,f="="+u.f,f.indexOf(",")>=0&&(f='"'+f.replace(PS,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&a?null:c.join(l)}function Dy(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=mr(e["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,a=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),f="",h=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],u=n.skipHidden&&e["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(d[p]||{}).hidden||(h[p]=en(p));for(var m=0,g=i.s.r;g<=i.e.r;++g)(u[g]||{}).hidden||(f=qV(e,i,g,h,l,a,s,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((m++?o:"")+f)));return delete n.dense,r.join("")}function pT(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Dy(e,t);return r}function GV(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=mr(e["!ref"]),s="",l=[],o,a=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)l[o]=en(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=En(f),o=i.s.c;o<=i.e.c;++o)if(t=l[o]+s,r=c?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}a[a.length]=t+"="+n}return a}function gT(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},l=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var a=typeof n.origin=="string"?tn(n.origin):n.origin;l=a.r,o=a.c}var c,f={s:{c:0,r:0},e:{c:o,r:l+t.length-1+i}};if(s["!ref"]){var h=mr(s["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),l==-1&&(l=h.e.r+1,f.e.r=l+t.length-1+i)}else l==-1&&(l=0,f.e.r=t.length-1+i);var d=n.header||[],u=0;t.forEach(function(m,g){dn(m).forEach(function(x){(u=d.indexOf(x))==-1&&(d[u=d.length]=x);var y=m[x],w="z",_="",C=Ht({c:o+u,r:l+g+i});c=Dd(s,C),y&&typeof y=="object"&&!(y instanceof Date)?s[C]=y:(typeof y=="number"?w="n":typeof y=="boolean"?w="b":typeof y=="string"?w="s":y instanceof Date?(w="d",n.cellDates||(w="n",y=Yn(y)),_=n.dateNF||Ut[14]):y===null&&n.nullError&&(w="e",y=0),c?(c.t=w,c.v=y,delete c.w,delete c.R,_&&(c.z=_)):s[C]=c={t:w,v:y},_&&(c.z=_))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var p=En(l);if(i)for(u=0;u<d.length;++u)s[en(u+o)+p]={t:"s",v:d[u]};return s["!ref"]=er(f),s}function XV(e,t){return gT(null,e,t)}function Dd(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=tn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Dd(e,Ht(t)):Dd(e,Ht({r:t,c:r||0}))}function YV(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Ly(){return{SheetNames:[],Sheets:{}}}function Iy(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var l=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=l+i)!=-1;++i);}if(QE(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function KV(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=YV(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function JV(e,t){return e.z=t,e}function mT(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function QV(e,t,r){return mT(e,"#"+t,r)}function ZV(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function eq(e,t,r,n){for(var i=typeof t!="string"?t:mr(t),s=typeof t=="string"?t:er(t),l=i.s.r;l<=i.e.r;++l)for(var o=i.s.c;o<=i.e.c;++o){var a=Dd(e,l,o);a.t="n",a.F=s,delete a.v,l==i.s.r&&o==i.s.c&&(a.f=r,n&&(a.D=!0))}return e}var vp={encode_col:en,encode_row:En,encode_cell:Ht,encode_range:er,decode_col:fy,decode_row:uy,split_cell:u7,decode_cell:tn,decode_range:is,format_cell:Do,sheet_add_aoa:HC,sheet_add_json:gT,sheet_add_dom:aT,aoa_to_sheet:Af,json_to_sheet:XV,table_to_sheet:oT,table_to_book:aV,sheet_to_csv:Dy,sheet_to_txt:pT,sheet_to_json:Fg,sheet_to_html:sT,sheet_to_formulae:GV,sheet_to_row_object_array:Fg,sheet_get_cell:Dd,book_new:Ly,book_append_sheet:Iy,book_set_sheet_visibility:KV,cell_set_number_format:JV,cell_set_hyperlink:mT,cell_set_internal_link:QV,cell_add_comment:ZV,sheet_set_array_formula:eq,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const xT=({isMobileView:e=!1,externalZoneId:t=null,externalDate:r=null,externalSessionId:n=null})=>{const i=ye.useRef(null),s=ye.useRef(null),[l,o]=ye.useState([]),[a,c]=ye.useState(null),[f,h]=ye.useState(new Date().toISOString().split("T")[0]),[d,u]=ye.useState(null),[p,m]=ye.useState([]),[g,x]=ye.useState(!1),[y,w]=ye.useState({present:0,absent:0,total:0}),[_,C]=ye.useState(!1),[E,T]=ye.useState(!1),[A,j]=ye.useState({paper:"a4",orientation:"portrait"}),B=P=>{var V,le;const H=P||s.current;if(!H)return;const U=H.getObjects();if(U.length===0)return;let S=1/0,I=1/0,O=-1/0,N=-1/0;U.forEach(ae=>{const W=ae.getBoundingRect(!0);S=Math.min(S,W.left),I=Math.min(I,W.top),O=Math.max(O,W.left+W.width),N=Math.max(N,W.top+W.height)});const R=O-S,z=N-I,K=((V=i.current)==null?void 0:V.clientWidth)||H.getWidth(),Y=((le=i.current)==null?void 0:le.clientHeight)||H.getHeight(),Z=K/2-(S+R/2);let se;e?se=30-I:se=Y/2-(I+z/2),H.setViewportTransform([1,0,0,1,Z,se]),H.requestRenderAll()};ye.useEffect(()=>{F()},[]),ye.useEffect(()=>{t&&c(t)},[t]),ye.useEffect(()=>{r&&h(r)},[r]),ye.useEffect(()=>{n&&u(n)},[n]);const F=async()=>{x(!0);const{data:P}=await Xe.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});P&&P.length>0&&(o(P),c(P[0].id))};ye.useEffect(()=>{a&&L(a)},[a]);const L=async P=>{const{data:H}=await Xe.from("sessions").select("*").eq("zone_id",P).order("start_time",{ascending:!0});if(H){m(H);const U=new Date().toISOString().split("T")[0];if(f===U){const S=new Date,I=S.getHours().toString().padStart(2,"0")+":"+S.getMinutes().toString().padStart(2,"0")+":00",O=H.find(N=>I>=N.start_time&&I<=N.end_time);O?u(O.id):H.length>0&&u(H[0].id)}else H.length>0&&u(H[0].id)}};ye.useEffect(()=>{const P=new Date().toISOString().split("T")[0];if(f===P&&p.length>0){const H=new Date,U=H.getHours().toString().padStart(2,"0")+":"+H.getMinutes().toString().padStart(2,"0")+":00",S=p.find(I=>U>=I.start_time&&U<=I.end_time);S&&u(S.id)}},[f]),ye.useEffect(()=>{if(!i.current||!a||!d)return;let P=!0;s.current&&s.current.dispose(),i.current.innerHTML="";const H=document.createElement("canvas");i.current.appendChild(H);const U=new zt.fabric.Canvas(H,{width:i.current.clientWidth,height:i.current.clientHeight,backgroundColor:"transparent",selection:!1,allowTouchScrolling:!0});s.current=U;const S=new ResizeObserver(()=>{if(!i.current||!s.current)return;const N=i.current.clientWidth,R=i.current.clientHeight;s.current.setDimensions({width:N,height:R}),B(s.current)});S.observe(i.current),(async()=>{await G(p),setTimeout(()=>{P&&B(s.current)},100)})(),U.on("mouse:down",N=>{var Z,se,V,le,ae;const R=N.e,z=N.target;if((Z=N.subTargets)==null?void 0:Z.find(W=>W.name==="actionButton"||W.name==="actionLabel")){ne(z);return}const Y=z&&z.data&&!z.data.booking;(!z||Y)&&(U.isDragging=!0,U.selection=!1,U.lastPosX=R.clientX||((V=(se=R.touches)==null?void 0:se[0])==null?void 0:V.clientX),U.lastPosY=R.clientY||((ae=(le=R.touches)==null?void 0:le[0])==null?void 0:ae.clientY))}),U.on("mouse:move",N=>{var R,z,K,Y;if(U.isDragging){const Z=N.e,se=Z.clientX||((z=(R=Z.touches)==null?void 0:R[0])==null?void 0:z.clientX),V=Z.clientY||((Y=(K=Z.touches)==null?void 0:K[0])==null?void 0:Y.clientY),le=U.viewportTransform;le[4]+=se-U.lastPosX,le[5]+=V-U.lastPosY,U.requestRenderAll(),U.lastPosX=se,U.lastPosY=V}}),U.on("mouse:wheel",N=>{const R=N.e.deltaY,z=U.viewportTransform;z[5]-=R,U.requestRenderAll(),N.e.preventDefault(),N.e.stopPropagation()}),U.on("mouse:up",()=>{U.isDragging&&(U.setViewportTransform(U.viewportTransform),U.isDragging=!1)});const O=Xe.channel("attendance_changes").on("postgres_changes",{event:"*",schema:"public",table:"attendance"},()=>{G(p)}).subscribe(N=>{C(N==="SUBSCRIBED")});return()=>{P=!1,S.disconnect(),Xe.removeChannel(O),U.dispose(),s.current=null}},[d,a,f,n,t,r,p]);const G=async P=>{if(!s.current||!a||!d)return;x(!0);const{data:H}=await Xe.from("seats").select("*").eq("zone_id",a).order("global_number",{ascending:!0}),U=f,S=Q().split("T")[0],I=U===S,{data:O}=await Xe.from("bookings").select(`
          *,
          profiles:user_id(full_name, username),
          profiles_student:student_id(full_name, username),
          attendance(id, status, timestamp_in, timestamp_out)
        `).eq("date",U);if(O&&O.length>0){const W=new Date(new Date().getTime()+324e5).toISOString().split("T")[1].substring(0,8),he=[];if(O.forEach(fe=>{const Te=P.find(pe=>pe.id===fe.session_id);if(!Te)return;const be=Array.isArray(fe.attendance)?fe.attendance[0]:fe.attendance;if(be&&(be.status==="present"||be.status==="late")&&!be.timestamp_out){const pe=Te.end_time.length===5?Te.end_time+":00":Te.end_time;(U<S||I&&pe<W)&&he.push({id:be.id,timestamp_out:`${U}T${pe}+09:00`,updated_at:new Date().toISOString()})}}),he.length>0){const{error:fe}=await Xe.from("attendance").upsert(he);fe||he.forEach(Te=>{const be=O.find(pe=>{var ce,Ne;return(Array.isArray(pe.attendance)?(ce=pe.attendance[0])==null?void 0:ce.id:(Ne=pe.attendance)==null?void 0:Ne.id)===Te.id});be&&(Array.isArray(be.attendance)?be.attendance[0].timestamp_out=Te.timestamp_out:be.attendance.timestamp_out=Te.timestamp_out)})}}s.current&&s.current.clear();const N=H||[];if(N.length===0){x(!1);return}const R=N.map(ae=>ae.pos_x).filter(ae=>typeof ae=="number"&&!isNaN(ae)),z=N.map(ae=>ae.pos_y).filter(ae=>typeof ae=="number"&&!isNaN(ae));if(R.length===0||z.length===0){x(!1);return}Math.min(...R),Math.max(...N.map(ae=>ae.pos_x+(ae.width||72)).filter(ae=>!isNaN(ae))),Math.min(...z),Math.max(...N.map(ae=>ae.pos_y+(ae.height||72)).filter(ae=>!isNaN(ae)));const K=0,Y=0;if(s.current&&i.current){const ae=i.current.clientWidth,W=i.current.clientHeight;s.current.setDimensions({width:ae,height:W})}let Z=P==null?void 0:P.find(ae=>ae.id===d);if(!Z&&I){const ae=new Date,W=ae.getHours().toString().padStart(2,"0")+":"+ae.getMinutes().toString().padStart(2,"0")+":00";Z=P==null?void 0:P.find(he=>W>=he.start_time&&W<=he.end_time)}let se=0;const le=((O==null?void 0:O.filter(ae=>ae.session_id===d))||[]).length;H.forEach(ae=>{if(ae.type==="structure"){X({...ae,pos_x:ae.pos_x+K,pos_y:ae.pos_y+Y},null,null,[],null,P,!1);return}const W=(O==null?void 0:O.filter(pe=>pe.seat_id===ae.id))||[],he=W.find(pe=>pe.session_id===d),fe=Array.isArray(he==null?void 0:he.attendance)?he.attendance[0]:(he==null?void 0:he.attendance)||null;let Te=(fe==null?void 0:fe.status)||"absent";if(I&&he&&!fe&&d&&P){const pe=P.find(xe=>xe.id===d);if(pe){const xe=new Date,ce=xe.getHours().toString().padStart(2,"0")+":"+xe.getMinutes().toString().padStart(2,"0")+":00";pe.end_time<ce&&(Te="absent")}}const be=W.length>0;he&&Te==="present"&&se++,X({...ae,pos_x:ae.pos_x+K,pos_y:ae.pos_y+Y},he,Te,W,Z,P,be)}),w({present:se,absent:le-se,total:le,rate:le>0?Math.round(se/le*100):0}),x(!1)},X=(P,H,U,S,I,O,N,R)=>{if(P.type==="structure"){const fe=new zt.fabric.Rect({fill:P.bg_color||"#E5E5EA",width:P.width||72,height:P.height||72,stroke:P.stroke_color||"#D1D1D6",strokeWidth:1}),Te=new zt.fabric.IText(P.label||"",{fontSize:P.font_size||10,originX:"center",originY:"center",left:(P.width||72)/2,top:(P.height||72)/2,fill:P.text_color||"#AEAEB2",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),be=new zt.fabric.Group([fe,Te],{left:P.pos_x,top:P.pos_y,angle:P.rotation,selectable:!1,evented:!1,data:{...P}});s.current.add(be);return}const z=!!H,K=N,Y=P.zone_color||"#5E5CE6",Z=new zt.fabric.Rect({fill:"#FFFFFF",width:71,height:71,rx:12,ry:12,stroke:"#C7C7CC",strokeWidth:1.5,left:.5,top:.5,originX:"left",originY:"top",selectable:!1}),se="M 0 12 Q 0 0 12 0 L 60 0 Q 72 0 72 12 L 72 18 L 0 18 z",V=new zt.fabric.Path(se,{fill:Y,strokeWidth:0,left:0,top:0,originX:"left",originY:"top",selectable:!1});let le=[Z,V];if(z){const fe=Array.isArray(H==null?void 0:H.attendance)?H.attendance[0]:(H==null?void 0:H.attendance)||null,be=(U==="present"||U==="late")&&!(fe!=null&&fe.timestamp_out)?"#00FF00":"#FF3B30",pe=new zt.fabric.Circle({radius:3,fill:be,left:58,top:9,originX:"center",originY:"center",selectable:!1,stroke:"rgba(255,255,255,0.8)",strokeWidth:1.5});le.push(pe)}const ae=new zt.fabric.IText(P.display_number||P.seat_number,{fontSize:10,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"900",fill:"#ffffff",left:36,top:9,originX:"center",originY:"center",selectable:!1});if(le.push(ae),z){const fe=H==null?void 0:H.profiles_student,Te=fe?`${fe.username?fe.username+" ":""}${fe.full_name}`:"  ",be=new zt.fabric.IText(Te,{fontSize:10,textAlign:"center",originX:"center",originY:"center",left:36,top:34,fill:"#1C1C1E",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1});le.push(be);const pe=Array.isArray(H==null?void 0:H.attendance)?H.attendance[0]:(H==null?void 0:H.attendance)||null,xe=!!(pe!=null&&pe.timestamp_out),ce=(U==="present"||U==="late")&&!xe;let Ne="",Ie="",Re="#8E8E93",De="#F2F2F7",Me=Y,Ge="#FFFFFF",Ae=!1;ce?(Ne="",Ie="",Re="#FFFFFF",De=Y,Me="#FFFFFF",Ge=Y,Ae=!0):xe&&(Ne="",Ie="",Re="#1C1C1E",De="#F2F2F7",Me=Y,Ge="#FFFFFF");const Pe="M 0 50 L 36 50 L 36 72 L 6 72 Q 0 72 0 66 Z",Ue=new zt.fabric.Path(Pe,{fill:De,selectable:!1}),Ye=new zt.fabric.IText(Ne,{fontSize:8,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",fill:Re,originX:"center",originY:"center",left:18,top:61,selectable:!1}),nt="M 36 50 L 72 50 L 72 66 Q 72 72 66 72 L 36 72 Z",Qe=new zt.fabric.Path(nt,{fill:Me,stroke:Ae?Y:null,strokeWidth:Ae?1:0,selectable:!1,hoverCursor:"pointer",name:"actionButton"}),ht=new zt.fabric.IText(Ie,{fontSize:8,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",fill:Ge,originX:"center",originY:"center",left:54,top:61,selectable:!1,name:"actionLabel"});le.push(Ue,Ye,Qe,ht)}else{const fe=new zt.fabric.IText("",{fontSize:12,fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",fill:"#E5E5EA",left:36,top:34,originX:"center",originY:"center",selectable:!1}),Te="M 0 50 L 72 50 L 72 60 Q 72 72 60 72 L 12 72 Q 0 72 0 60 Z",be=new zt.fabric.Path(Te,{fill:"#F2F2F7",opacity:.3,selectable:!1}),pe=new zt.fabric.IText("-",{fontSize:10,fill:"#AEAEB2",left:36,top:61,originX:"center",originY:"center",selectable:!1});le.push(fe,be,pe)}let W=1;z||(W=K?.4:.15);const he=new zt.fabric.Group(le,{left:P.pos_x,top:P.pos_y,opacity:W,angle:P.rotation,data:{...P,booking:H,status:U},selectable:!1,hoverCursor:z?"pointer":"default",subTargetCheck:!0});s.current.add(he)},re=P=>{const H=new Date(f);H.setDate(H.getDate()+P),h(H.toISOString().split("T")[0])},Q=()=>{const P=new Date,H=9*60*60*1e3;return new Date(P.getTime()+H).toISOString().replace("Z","+09:00")},ne=async P=>{const{booking:H,status:U}=P.data;if(!H)return;const S=p.find(R=>R.id===H.session_id);if(!S)return;const I=Array.isArray(H.attendance)?H.attendance[0]:H.attendance||null,O=!!(I!=null&&I.timestamp_out);if((U==="present"||U==="late")&&!O){const{error:R}=await Xe.from("attendance").update({timestamp_out:Q(),updated_at:new Date().toISOString()}).eq("id",I.id);R&&console.error("Error during check-out:",R),R||await G(p)}else if(O){const{error:R}=await Xe.from("attendance").update({status:"absent",timestamp_in:null,timestamp_out:null,updated_at:new Date().toISOString()}).eq("id",I.id);R&&console.error("Error during reset to absent:",R),R||await G(p)}else{const R=(S==null?void 0:S.start_time)||"00:00:00",z={booking_id:H.id,status:"present",timestamp_in:`${f}T${R}${R.length===5?":00":""}+09:00`,timestamp_out:null,updated_at:new Date().toISOString()};I!=null&&I.id&&(z.id=I.id);const{error:K}=await Xe.from("attendance").upsert(z,{onConflict:"booking_id"});K?console.error("Error during attendance upsert:",K):await G(p)}},J=async()=>{var P;if(s.current){x(!0),T(!1);try{const H=s.current,U=H.getObjects();if(U.length===0){alert("  ."),x(!1);return}const S=H.viewportTransform;H.setViewportTransform([1,0,0,1,0,0]);let I=1/0,O=1/0,N=-1/0,R=-1/0;U.forEach(Ae=>{if(!Ae.visible||Ae.opacity===0||(!Ae.fill||Ae.fill==="transparent")&&(!Ae.stroke||Ae.stroke==="transparent")&&!Ae.text)return;let Pe=Ae.getBoundingRect();I=Math.min(I,Pe.left),O=Math.min(O,Pe.top),N=Math.max(N,Pe.left+Pe.width),R=Math.max(R,Pe.top+Pe.height)});const z=20,K=I-z,Y=O-z,Z=N-I+z*2,se=R-O+z*2,V=H.toDataURL({format:"png",left:K,top:Y,width:Z,height:se,multiplier:3});H.setViewportTransform(S);const{paper:le,orientation:ae}=A,W=le==="b4"?257:210,he=le==="b4"?364:297,fe=ae==="landscape"?he:W,Te=ae==="landscape"?W:he,be=20,pe=10,xe=10,ce=fe-pe*2,Ne=Te-be-xe,Ie=document.createElement("iframe");Ie.style.position="fixed",Ie.style.right="0",Ie.style.bottom="0",Ie.style.width="0",Ie.style.height="0",Ie.style.border="0",document.body.appendChild(Ie);const Re=((P=l.find(Ae=>Ae.id===a))==null?void 0:P.name)||"",De=Ie.contentWindow.document;De.open(),De.write(`
        <html>
          <head>
            <title>  - ${Re}</title>
            <style>
              @page {
                size: ${le} ${ae};
                margin: 0;
              }
              html, body {
                margin: 0;
                padding: 0;
                width: 100%;
                height: 100vh;
                background: white;
                -webkit-print-color-adjust: exact;
                overflow: hidden !important;
              }
              .print-container {
                width: 100%;
                height: 100vh;
                padding: ${be}mm ${pe}mm ${xe}mm ${pe}mm;
                box-sizing: border-box;
                display: flex;
                flex-direction: column;
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                overflow: hidden !important;
                background: white;
              }
              .header {
                flex-shrink: 0;
                display: flex;
                justify-content: space-between;
                align-items: flex-end;
                border-bottom: 2px solid #1C1C1E;
                padding-bottom: 3mm; /* Reduced padding */
                margin-bottom: 2mm; /* Reduced margin */
              }
              .header h1 {
                margin: 0;
                font-size: 16pt; /* Slightly smaller to save space */
                font-weight: 900;
                letter-spacing: -1px;
                color: #1C1C1E;
              }
              .header .info {
                text-align: right;
              }
              .header .info .zone {
                font-size: 10pt;
                font-weight: 800;
                color: #5856D6;
                margin: 0;
              }
              .header .info .date {
                font-size: 8pt;
                color: #8E8E93;
                margin: 0;
              }
              /* Content area strictly confined to remaining space */
              .content {
                flex: 1;
                display: flex;
                justify-content: center; /* Center */
                align-items: center;
                min-height: 0;
                padding: 0; /* Remove arbitrary padding to maximize scale */
                margin: 0;
                overflow: hidden;
              }
              /* Image autoscaling using object-fit */
              .content img {
                width: 100%;
                height: 100%;
                object-fit: contain;
                object-position: center; /* Center image */
                display: block;
              }
              .footer {
                flex-shrink: 0;
                margin-top: 1mm; /* Reduced margin */
                text-align: center;
                border-top: 1px solid #F2F2F7;
                padding-top: 2mm;
              }
              .footer p {
                margin: 0;
                font-size: 7pt;
                color: #AEAEB2;
                font-weight: bold;
                letter-spacing: 1px;
              }
            </style>
          </head>
          <body>
            <div class="print-container">
              <div class="header">
                <h1> </h1>
                <div class="info">
                  <p class="zone">${Re}</p>
                  <p class="date">${f} </p>
                </div>
              </div>
              <div class="content">
                <img src="${V}" />
              </div>
              <div class="footer">
                <p>POGOK STUDY CAFE MANAGEMENT SYSTEM</p>
              </div>
            </div>
          </body>
        </html>
      `),De.close();const Me=()=>{const Ae=Ie.contentWindow;Ae.focus(),setTimeout(()=>{Ae.print(),setTimeout(()=>{document.body.removeChild(Ie),x(!1)},1e3)},800)},Ge=De.querySelector("img");Ge.complete?Me():Ge.onload=Me}catch(H){console.error("Print generation failed:",H),alert("    ."),x(!1)}}};return v.jsxs("div",{className:`flex flex-col gap-4 w-full ${e?"min-h-fit":"h-full"} pt-[10px]`,children:[!e&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between px-2",children:[v.jsxs("div",{className:"flex items-center gap-4 ml-[10px] mt-[10px]",children:[v.jsx("div",{className:"flex bg-gray-100 rounded-apple-md h-10 box-border overflow-hidden border border-gray-100",children:l.map(P=>v.jsx("button",{onClick:()=>c(P.id),className:`h-10 px-6 text-[12px] font-black transition-all ios-tap flex items-center justify-center ${a===P.id?"bg-[#1C1C1E] text-white shadow-md":"text-ios-gray hover:text-[#1C1C1E] hover:bg-gray-200/40"}`,children:P.name},P.id))}),v.jsxs("div",{className:"flex items-center bg-gray-200/20 p-1 rounded-apple-md border border-white/40 backdrop-blur-xl h-10",children:[v.jsx("button",{onClick:()=>re(-1),className:"h-8 px-3 rounded-apple-md hover:bg-white text-ios-gray hover:text-[#1C1C1E] transition-all text-[12px] font-black",children:"<"}),v.jsxs("span",{className:"px-4 text-[13px] font-black min-w-[110px] text-center text-[#1C1C1E]",children:[f.substring(5)," (",["","","","","","",""][new Date(f).getDay()],")"]}),v.jsx("button",{onClick:()=>re(1),className:"h-8 px-3 rounded-apple-md hover:bg-white text-ios-gray hover:text-[#1C1C1E] transition-all text-[12px] font-black",children:">"})]}),(()=>{const P=l.find(U=>U.id===a),H=(P==null?void 0:P.color)||"#5E5CE6";return v.jsx("div",{className:"flex bg-gray-100 rounded-apple-md h-10 box-border overflow-hidden border border-gray-100",children:p.map(U=>v.jsx("button",{onClick:()=>u(U.id),className:`h-10 px-6 text-[11.5px] font-black transition-all duration-300 ios-tap flex items-center justify-center ${d===U.id?"text-white shadow-sm":"text-ios-gray hover:text-[#1C1C1E] hover:bg-gray-200/40"}`,style:d===U.id?{backgroundColor:H}:{},children:U.name.toUpperCase()},U.id))})})()]}),v.jsxs("div",{className:"flex items-center gap-2 mr-[10px] mt-[10px] relative",children:[E&&v.jsx("div",{className:"absolute top-12 right-0 bg-white shadow-deep border border-gray-100 p-4 rounded-apple-md z-50 min-w-[200px] animate-spring-up",children:v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-2 border-b border-gray-50 pb-2",children:[v.jsx(dO,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("span",{className:"text-xs font-black text-[#1C1C1E]",children:" "})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest block",children:" "}),v.jsx("div",{className:"flex gap-2",children:["a4","b4"].map(P=>v.jsx("button",{onClick:()=>j(H=>({...H,paper:P})),className:`flex-1 py-1.5 rounded-apple-sm text-[10px] font-bold uppercase transition-all ${A.paper===P?"bg-ios-indigo text-white":"bg-gray-100 text-ios-gray"}`,children:P},P))})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest block",children:" "}),v.jsx("div",{className:"flex gap-2",children:[{id:"portrait",label:""},{id:"landscape",label:""}].map(P=>v.jsx("button",{onClick:()=>j(H=>({...H,orientation:P.id})),className:`flex-1 py-1.5 rounded-apple-sm text-[10px] font-bold transition-all ${A.orientation===P.id?"bg-ios-indigo text-white":"bg-gray-100 text-ios-gray"}`,children:P.label},P.id))})]}),v.jsxs("button",{onClick:J,className:"w-full h-10 bg-[#1C1C1E] text-white rounded-apple-md text-xs font-black flex items-center justify-center gap-2 hover:bg-gray-800 transition-all active:scale-95",children:[v.jsx(Fl,{className:"w-3.5 h-3.5"})," "]})]})}),v.jsxs("button",{onClick:()=>T(!E),className:`h-10 px-4 rounded-apple-md shadow-sm border flex items-center justify-center gap-2 transition-all ios-tap ${E?"bg-[#1C1C1E] border-[#1C1C1E] text-white":"bg-white border-gray-100 text-[#1C1C1E]"}`,title:"  (PDF)",children:[v.jsx(Fl,{className:"w-4 h-4"}),v.jsx("span",{className:"text-[11px] font-black",children:" "})]}),v.jsx("div",{className:"bg-white h-10 px-4 rounded-apple-md shadow-sm border border-gray-100 flex items-center justify-center",title:_?"    .":"   ...",children:v.jsx("div",{className:`w-2.5 h-2.5 rounded-full shrink-0 border border-white shadow-sm transition-all duration-500 ${_?"bg-emerald-500 animate-pulse shadow-emerald-500/50":"bg-rose-500 opacity-80"}`})})]})]}),v.jsxs("div",{className:"flex items-center gap-2 px-2 ml-[10px] mt-2",children:[v.jsxs("div",{className:"flex items-center gap-1.5 bg-white shadow-sm border border-gray-100 px-4 py-2 rounded-apple-md",children:[v.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 shadow-sm shadow-emerald-500/30"}),v.jsxs("span",{className:"text-[10px] font-black text-[#1C1C1E]",children:[" ",v.jsx("span",{className:"text-emerald-500",children:y.present})]})]}),v.jsxs("div",{className:"flex items-center gap-1.5 bg-white shadow-sm border border-gray-100 px-4 py-2 rounded-apple-md",children:[v.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-rose-500 shadow-sm shadow-rose-500/30"}),v.jsxs("span",{className:"text-[10px] font-black text-[#1C1C1E]",children:[" ",v.jsx("span",{className:"text-rose-500",children:y.absent})]})]}),v.jsxs("div",{className:"flex items-center gap-1.5 bg-white shadow-sm border border-gray-100 px-4 py-2 rounded-apple-md",children:[v.jsx(Wd,{className:"w-3.5 h-3.5 text-ios-gray opacity-60"}),v.jsxs("span",{className:"text-[10px] font-black text-ios-gray",children:[" ",y.total]})]}),v.jsx("div",{className:"flex items-center gap-1.5 bg-white shadow-sm border border-gray-100 px-4 py-2 rounded-apple-md",children:v.jsxs("span",{className:"text-[10px] font-black text-ios-indigo",children:[" ",y.rate,"%"]})})]})]}),v.jsxs("div",{className:`${e?"w-full":"flex-1 flex flex-col w-full"} overflow-hidden relative`,children:[g&&v.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-30 flex items-center justify-center pointer-events-none",children:v.jsx("div",{className:"w-8 h-8 border-3 border-ios-indigo border-t-transparent rounded-full animate-spin"})}),v.jsx("div",{className:`${e?"w-full":"flex-1 w-full"} bg-white rounded-t-[6px] rounded-b-none border-0 overflow-hidden p-2.5 pb-0`,children:v.jsx("div",{ref:i,className:`relative overflow-hidden cursor-grab active:cursor-grabbing select-none scrollbar-hide ${e?"w-full min-h-[600px] h-auto touch-action-none":"flex-1 h-full"}`,style:e?{touchAction:"none"}:{}})})]})]})};function Yt(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Wr(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function Ss(e,t){const r=Yt(e);return isNaN(t)?Wr(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Qd(e,t){const r=Yt(e);if(isNaN(t))return Wr(e,NaN);if(!t)return r;const n=r.getDate(),i=Wr(e,r.getTime());i.setMonth(r.getMonth()+t+1,0);const s=i.getDate();return n>=s?i:(r.setFullYear(i.getFullYear(),i.getMonth(),n),r)}function tq(e,t){const r=+Yt(e);return Wr(e,r+t)}const vT=6048e5,rq=864e5,d1=6e4,Ry=36e5,nq=1e3;let iq={};function eu(){return iq}function Mn(e,t){var o,a,c,f;const r=eu(),n=(t==null?void 0:t.weekStartsOn)??((a=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:a.weekStartsOn)??r.weekStartsOn??((f=(c=r.locale)==null?void 0:c.options)==null?void 0:f.weekStartsOn)??0,i=Yt(e),s=i.getDay(),l=(s<n?7:0)+s-n;return i.setDate(i.getDate()-l),i.setHours(0,0,0,0),i}function wf(e){return Mn(e,{weekStartsOn:1})}function yT(e){const t=Yt(e),r=t.getFullYear(),n=Wr(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const i=wf(n),s=Wr(e,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);const l=wf(s);return t.getTime()>=i.getTime()?r+1:t.getTime()>=l.getTime()?r:r-1}function Ga(e){const t=Yt(e);return t.setHours(0,0,0,0),t}function jg(e){const t=Yt(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function sq(e,t){const r=Ga(e),n=Ga(t),i=+r-jg(r),s=+n-jg(n);return Math.round((i-s)/rq)}function aq(e){const t=yT(e),r=Wr(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),wf(r)}function kh(e,t){return tq(e,t*d1)}function p1(e,t){const r=t*7;return Ss(e,r)}function oq(e){return Wr(e,Date.now())}function Nl(e,t){const r=Ga(e),n=Ga(t);return+r==+n}function lq(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Mp(e){if(!lq(e)&&typeof e!="number")return!1;const t=Yt(e);return!isNaN(Number(t))}function Ld(e){const t=Yt(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function tu(e,t){const r=Yt(e.start),n=Yt(e.end);let i=+r>+n;const s=i?+r:+n,l=i?n:r;l.setHours(0,0,0,0);let o=1;const a=[];for(;+l<=s;)a.push(Yt(l)),l.setDate(l.getDate()+o),l.setHours(0,0,0,0);return i?a.reverse():a}function cq(e,t){const r=Yt(e.start),n=Yt(e.end);let i=+r>+n;const s=i?+r:+n,l=i?n:r;l.setHours(0,0,0,0),l.setDate(1);let o=1;const a=[];for(;+l<=s;)a.push(Yt(l)),l.setMonth(l.getMonth()+o);return i?a.reverse():a}function uq(e){const t=Yt(e),r=t.getMonth(),n=r-r%3;return t.setMonth(n,1),t.setHours(0,0,0,0),t}function fq(e,t){const r=Yt(e.start),n=Yt(e.end);let i=+r>+n;const s=Mn(i?n:r,t),l=Mn(i?r:n,t);s.setHours(15),l.setHours(15);const o=+l.getTime();let a=s,c=(t==null?void 0:t.step)??1;if(!c)return[];c<0&&(c=-c,i=!i);const f=[];for(;+a<=o;)a.setHours(0),f.push(Yt(a)),a=p1(a,c),a.setHours(15);return i?f.reverse():f}function _f(e){const t=Yt(e);return t.setDate(1),t.setHours(0,0,0,0),t}function hq(e){const t=Yt(e),r=Wr(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function No(e,t){var o,a,c,f;const r=eu(),n=(t==null?void 0:t.weekStartsOn)??((a=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:a.weekStartsOn)??r.weekStartsOn??((f=(c=r.locale)==null?void 0:c.options)==null?void 0:f.weekStartsOn)??0,i=Yt(e),s=i.getDay(),l=(s<n?-7:0)+6-(s-n);return i.setDate(i.getDate()+l),i.setHours(23,59,59,999),i}function dq(e){const t=Yt(e),r=t.getMonth(),n=r-r%3+3;return t.setMonth(n,0),t.setHours(23,59,59,999),t}const pq={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},gq=(e,t,r)=>{let n;const i=pq[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function cf(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const mq={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},xq={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},vq={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},yq={date:cf({formats:mq,defaultWidth:"full"}),time:cf({formats:xq,defaultWidth:"full"}),dateTime:cf({formats:vq,defaultWidth:"full"})},wq={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},_q=(e,t,r,n)=>wq[e];function Wa(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let i;if(n==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):l;i=e.formattingValues[o]||e.formattingValues[l]}else{const l=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;i=e.values[o]||e.values[l]}const s=e.argumentCallback?e.argumentCallback(t):t;return i[s]}}const bq={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Sq={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},kq={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Cq={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Eq={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Tq={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Nq=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Aq={ordinalNumber:Nq,era:Wa({values:bq,defaultWidth:"wide"}),quarter:Wa({values:Sq,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Wa({values:kq,defaultWidth:"wide"}),day:Wa({values:Cq,defaultWidth:"wide"}),dayPeriod:Wa({values:Eq,defaultWidth:"wide",formattingValues:Tq,defaultFormattingWidth:"wide"})};function za(e){return(t,r={})=>{const n=r.width,i=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(i);if(!s)return null;const l=s[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],a=Array.isArray(o)?Pq(o,h=>h.test(l)):Oq(o,h=>h.test(l));let c;c=e.valueCallback?e.valueCallback(a):a,c=r.valueCallback?r.valueCallback(c):c;const f=t.slice(l.length);return{value:c,rest:f}}}function Oq(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function Pq(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function wT(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const i=n[0],s=t.match(e.parsePattern);if(!s)return null;let l=e.valueCallback?e.valueCallback(s[0]):s[0];l=r.valueCallback?r.valueCallback(l):l;const o=t.slice(i.length);return{value:l,rest:o}}}const Fq=/^(\d+)(th|st|nd|rd)?/i,jq=/\d+/i,Dq={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Lq={any:[/^b/i,/^(a|c)/i]},Iq={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Rq={any:[/1/i,/2/i,/3/i,/4/i]},Mq={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Bq={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Uq={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Wq={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},zq={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Hq={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},$q={ordinalNumber:wT({matchPattern:Fq,parsePattern:jq,valueCallback:e=>parseInt(e,10)}),era:za({matchPatterns:Dq,defaultMatchWidth:"wide",parsePatterns:Lq,defaultParseWidth:"any"}),quarter:za({matchPatterns:Iq,defaultMatchWidth:"wide",parsePatterns:Rq,defaultParseWidth:"any",valueCallback:e=>e+1}),month:za({matchPatterns:Mq,defaultMatchWidth:"wide",parsePatterns:Bq,defaultParseWidth:"any"}),day:za({matchPatterns:Uq,defaultMatchWidth:"wide",parsePatterns:Wq,defaultParseWidth:"any"}),dayPeriod:za({matchPatterns:zq,defaultMatchWidth:"any",parsePatterns:Hq,defaultParseWidth:"any"})},_T={code:"en-US",formatDistance:gq,formatLong:yq,formatRelative:_q,localize:Aq,match:$q,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Vq(e){const t=Yt(e);return sq(t,hq(t))+1}function bT(e){const t=Yt(e),r=+wf(t)-+aq(t);return Math.round(r/vT)+1}function My(e,t){var f,h,d,u;const r=Yt(e),n=r.getFullYear(),i=eu(),s=(t==null?void 0:t.firstWeekContainsDate)??((h=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??i.firstWeekContainsDate??((u=(d=i.locale)==null?void 0:d.options)==null?void 0:u.firstWeekContainsDate)??1,l=Wr(e,0);l.setFullYear(n+1,0,s),l.setHours(0,0,0,0);const o=Mn(l,t),a=Wr(e,0);a.setFullYear(n,0,s),a.setHours(0,0,0,0);const c=Mn(a,t);return r.getTime()>=o.getTime()?n+1:r.getTime()>=c.getTime()?n:n-1}function qq(e,t){var o,a,c,f;const r=eu(),n=(t==null?void 0:t.firstWeekContainsDate)??((a=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:a.firstWeekContainsDate)??r.firstWeekContainsDate??((f=(c=r.locale)==null?void 0:c.options)==null?void 0:f.firstWeekContainsDate)??1,i=My(e,t),s=Wr(e,0);return s.setFullYear(i,0,n),s.setHours(0,0,0,0),Mn(s,t)}function ST(e,t){const r=Yt(e),n=+Mn(r,t)-+qq(r,t);return Math.round(n/vT)+1}function Sr(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const al={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Sr(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Sr(r+1,2)},d(e,t){return Sr(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Sr(e.getHours()%12||12,t.length)},H(e,t){return Sr(e.getHours(),t.length)},m(e,t){return Sr(e.getMinutes(),t.length)},s(e,t){return Sr(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),i=Math.trunc(n*Math.pow(10,r-3));return Sr(i,t.length)}},Cu={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},FS={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),i=n>0?n:1-n;return r.ordinalNumber(i,{unit:"year"})}return al.y(e,t)},Y:function(e,t,r,n){const i=My(e,n),s=i>0?i:1-i;if(t==="YY"){const l=s%100;return Sr(l,2)}return t==="Yo"?r.ordinalNumber(s,{unit:"year"}):Sr(s,t.length)},R:function(e,t){const r=yT(e);return Sr(r,t.length)},u:function(e,t){const r=e.getFullYear();return Sr(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Sr(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Sr(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return al.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Sr(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const i=ST(e,n);return t==="wo"?r.ordinalNumber(i,{unit:"week"}):Sr(i,t.length)},I:function(e,t,r){const n=bT(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Sr(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):al.d(e,t)},D:function(e,t,r){const n=Vq(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Sr(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return Sr(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});case"eeee":default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return Sr(s,t.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});case"cccc":default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),i=n===0?7:n;switch(t){case"i":return String(i);case"ii":return Sr(i,t.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let i;switch(n===12?i=Cu.noon:n===0?i=Cu.midnight:i=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let i;switch(n>=17?i=Cu.evening:n>=12?i=Cu.afternoon:n>=4?i=Cu.morning:i=Cu.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return al.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):al.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Sr(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Sr(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):al.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):al.s(e,t)},S:function(e,t){return al.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return DS(n);case"XXXX":case"XX":return fc(n);case"XXXXX":case"XXX":default:return fc(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return DS(n);case"xxxx":case"xx":return fc(n);case"xxxxx":case"xxx":default:return fc(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+jS(n,":");case"OOOO":default:return"GMT"+fc(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+jS(n,":");case"zzzz":default:return"GMT"+fc(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return Sr(n,t.length)},T:function(e,t,r){const n=e.getTime();return Sr(n,t.length)}};function jS(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=Math.trunc(n/60),s=n%60;return s===0?r+String(i):r+String(i)+t+Sr(s,2)}function DS(e,t){return e%60===0?(e>0?"-":"+")+Sr(Math.abs(e)/60,2):fc(e,t)}function fc(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=Sr(Math.trunc(n/60),2),s=Sr(n%60,2);return r+i+t+s}const LS=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},kT=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},Gq=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return LS(e,t);let s;switch(n){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",LS(n,t)).replace("{{time}}",kT(i,t))},Wv={p:kT,P:Gq},Xq=/^D+$/,Yq=/^Y+$/,Kq=["D","DD","YY","YYYY"];function CT(e){return Xq.test(e)}function ET(e){return Yq.test(e)}function zv(e,t,r){const n=Jq(e,t,r);if(console.warn(n),Kq.includes(e))throw new RangeError(n)}function Jq(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Qq=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Zq=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,eG=/^'([^]*?)'?$/,tG=/''/g,rG=/[a-zA-Z]/;function ct(e,t,r){var f,h,d,u,p,m,g,x;const n=eu(),i=(r==null?void 0:r.locale)??n.locale??_T,s=(r==null?void 0:r.firstWeekContainsDate)??((h=(f=r==null?void 0:r.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(d=n.locale)==null?void 0:d.options)==null?void 0:u.firstWeekContainsDate)??1,l=(r==null?void 0:r.weekStartsOn)??((m=(p=r==null?void 0:r.locale)==null?void 0:p.options)==null?void 0:m.weekStartsOn)??n.weekStartsOn??((x=(g=n.locale)==null?void 0:g.options)==null?void 0:x.weekStartsOn)??0,o=Yt(e);if(!Mp(o))throw new RangeError("Invalid time value");let a=t.match(Zq).map(y=>{const w=y[0];if(w==="p"||w==="P"){const _=Wv[w];return _(y,i.formatLong)}return y}).join("").match(Qq).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const w=y[0];if(w==="'")return{isToken:!1,value:nG(y)};if(FS[w])return{isToken:!0,value:y};if(w.match(rG))throw new RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");return{isToken:!1,value:y}});i.localize.preprocessor&&(a=i.localize.preprocessor(o,a));const c={firstWeekContainsDate:s,weekStartsOn:l,locale:i};return a.map(y=>{if(!y.isToken)return y.value;const w=y.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&ET(w)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&CT(w))&&zv(w,t,String(e));const _=FS[w[0]];return _(o,w,i.localize,c)}).join("")}function nG(e){const t=e.match(eG);return t?t[1].replace(tG,"'"):e}function iG(){return Object.assign({},eu())}function sG(e){let r=Yt(e).getDay();return r===0&&(r=7),r}function Hv(e,t){const r=Yt(e),n=Yt(t);return r.getTime()>n.getTime()}function qh(e,t){const r=Yt(e),n=Yt(t);return+r<+n}function aG(e,t){const r=t instanceof Date?Wr(t,0):new t(0);return r.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),r.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),r}const oG=10;class TT{constructor(){ft(this,"subPriority",0)}validate(t,r){return!0}}class lG extends TT{constructor(t,r,n,i,s){super(),this.value=t,this.validateValue=r,this.setValue=n,this.priority=i,s&&(this.subPriority=s)}validate(t,r){return this.validateValue(t,this.value,r)}set(t,r,n){return this.setValue(t,r,this.value,n)}}class cG extends TT{constructor(){super(...arguments);ft(this,"priority",oG);ft(this,"subPriority",-1)}set(r,n){return n.timestampIsSet?r:Wr(r,aG(r,Date))}}class vr{run(t,r,n,i){const s=this.parse(t,r,n,i);return s?{setter:new lG(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(t,r,n){return!0}}class uG extends vr{constructor(){super(...arguments);ft(this,"priority",140);ft(this,"incompatibleTokens",["R","u","t","T"])}parse(r,n,i){switch(n){case"G":case"GG":case"GGG":return i.era(r,{width:"abbreviated"})||i.era(r,{width:"narrow"});case"GGGGG":return i.era(r,{width:"narrow"});case"GGGG":default:return i.era(r,{width:"wide"})||i.era(r,{width:"abbreviated"})||i.era(r,{width:"narrow"})}}set(r,n,i){return n.era=i,r.setFullYear(i,0,1),r.setHours(0,0,0,0),r}}const kn={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Ha={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Cn(e,t){return e&&{value:t(e.value),rest:e.rest}}function Zr(e,t){const r=t.match(e);return r?{value:parseInt(r[0],10),rest:t.slice(r[0].length)}:null}function $a(e,t){const r=t.match(e);if(!r)return null;if(r[0]==="Z")return{value:0,rest:t.slice(1)};const n=r[1]==="+"?1:-1,i=r[2]?parseInt(r[2],10):0,s=r[3]?parseInt(r[3],10):0,l=r[5]?parseInt(r[5],10):0;return{value:n*(i*Ry+s*d1+l*nq),rest:t.slice(r[0].length)}}function NT(e){return Zr(kn.anyDigitsSigned,e)}function pn(e,t){switch(e){case 1:return Zr(kn.singleDigit,t);case 2:return Zr(kn.twoDigits,t);case 3:return Zr(kn.threeDigits,t);case 4:return Zr(kn.fourDigits,t);default:return Zr(new RegExp("^\\d{1,"+e+"}"),t)}}function Dg(e,t){switch(e){case 1:return Zr(kn.singleDigitSigned,t);case 2:return Zr(kn.twoDigitsSigned,t);case 3:return Zr(kn.threeDigitsSigned,t);case 4:return Zr(kn.fourDigitsSigned,t);default:return Zr(new RegExp("^-?\\d{1,"+e+"}"),t)}}function By(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function AT(e,t){const r=t>0,n=r?t:1-t;let i;if(n<=50)i=e||100;else{const s=n+50,l=Math.trunc(s/100)*100,o=e>=s%100;i=e+l-(o?100:0)}return r?i:1-i}function OT(e){return e%400===0||e%4===0&&e%100!==0}class fG extends vr{constructor(){super(...arguments);ft(this,"priority",130);ft(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(r,n,i){const s=l=>({year:l,isTwoDigitYear:n==="yy"});switch(n){case"y":return Cn(pn(4,r),s);case"yo":return Cn(i.ordinalNumber(r,{unit:"year"}),s);default:return Cn(pn(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,i){const s=r.getFullYear();if(i.isTwoDigitYear){const o=AT(i.year,s);return r.setFullYear(o,0,1),r.setHours(0,0,0,0),r}const l=!("era"in n)||n.era===1?i.year:1-i.year;return r.setFullYear(l,0,1),r.setHours(0,0,0,0),r}}class hG extends vr{constructor(){super(...arguments);ft(this,"priority",130);ft(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(r,n,i){const s=l=>({year:l,isTwoDigitYear:n==="YY"});switch(n){case"Y":return Cn(pn(4,r),s);case"Yo":return Cn(i.ordinalNumber(r,{unit:"year"}),s);default:return Cn(pn(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,i,s){const l=My(r,s);if(i.isTwoDigitYear){const a=AT(i.year,l);return r.setFullYear(a,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),Mn(r,s)}const o=!("era"in n)||n.era===1?i.year:1-i.year;return r.setFullYear(o,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),Mn(r,s)}}class dG extends vr{constructor(){super(...arguments);ft(this,"priority",130);ft(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(r,n){return Dg(n==="R"?4:n.length,r)}set(r,n,i){const s=Wr(r,0);return s.setFullYear(i,0,4),s.setHours(0,0,0,0),wf(s)}}class pG extends vr{constructor(){super(...arguments);ft(this,"priority",130);ft(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(r,n){return Dg(n==="u"?4:n.length,r)}set(r,n,i){return r.setFullYear(i,0,1),r.setHours(0,0,0,0),r}}class gG extends vr{constructor(){super(...arguments);ft(this,"priority",120);ft(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,i){switch(n){case"Q":case"QQ":return pn(n.length,r);case"Qo":return i.ordinalNumber(r,{unit:"quarter"});case"QQQ":return i.quarter(r,{width:"abbreviated",context:"formatting"})||i.quarter(r,{width:"narrow",context:"formatting"});case"QQQQQ":return i.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return i.quarter(r,{width:"wide",context:"formatting"})||i.quarter(r,{width:"abbreviated",context:"formatting"})||i.quarter(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=1&&n<=4}set(r,n,i){return r.setMonth((i-1)*3,1),r.setHours(0,0,0,0),r}}class mG extends vr{constructor(){super(...arguments);ft(this,"priority",120);ft(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,i){switch(n){case"q":case"qq":return pn(n.length,r);case"qo":return i.ordinalNumber(r,{unit:"quarter"});case"qqq":return i.quarter(r,{width:"abbreviated",context:"standalone"})||i.quarter(r,{width:"narrow",context:"standalone"});case"qqqqq":return i.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return i.quarter(r,{width:"wide",context:"standalone"})||i.quarter(r,{width:"abbreviated",context:"standalone"})||i.quarter(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=1&&n<=4}set(r,n,i){return r.setMonth((i-1)*3,1),r.setHours(0,0,0,0),r}}class xG extends vr{constructor(){super(...arguments);ft(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);ft(this,"priority",110)}parse(r,n,i){const s=l=>l-1;switch(n){case"M":return Cn(Zr(kn.month,r),s);case"MM":return Cn(pn(2,r),s);case"Mo":return Cn(i.ordinalNumber(r,{unit:"month"}),s);case"MMM":return i.month(r,{width:"abbreviated",context:"formatting"})||i.month(r,{width:"narrow",context:"formatting"});case"MMMMM":return i.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(r,{width:"wide",context:"formatting"})||i.month(r,{width:"abbreviated",context:"formatting"})||i.month(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=11}set(r,n,i){return r.setMonth(i,1),r.setHours(0,0,0,0),r}}class vG extends vr{constructor(){super(...arguments);ft(this,"priority",110);ft(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(r,n,i){const s=l=>l-1;switch(n){case"L":return Cn(Zr(kn.month,r),s);case"LL":return Cn(pn(2,r),s);case"Lo":return Cn(i.ordinalNumber(r,{unit:"month"}),s);case"LLL":return i.month(r,{width:"abbreviated",context:"standalone"})||i.month(r,{width:"narrow",context:"standalone"});case"LLLLL":return i.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(r,{width:"wide",context:"standalone"})||i.month(r,{width:"abbreviated",context:"standalone"})||i.month(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=11}set(r,n,i){return r.setMonth(i,1),r.setHours(0,0,0,0),r}}function yG(e,t,r){const n=Yt(e),i=ST(n,r)-t;return n.setDate(n.getDate()-i*7),n}class wG extends vr{constructor(){super(...arguments);ft(this,"priority",100);ft(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(r,n,i){switch(n){case"w":return Zr(kn.week,r);case"wo":return i.ordinalNumber(r,{unit:"week"});default:return pn(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,i,s){return Mn(yG(r,i,s),s)}}function _G(e,t){const r=Yt(e),n=bT(r)-t;return r.setDate(r.getDate()-n*7),r}class bG extends vr{constructor(){super(...arguments);ft(this,"priority",100);ft(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(r,n,i){switch(n){case"I":return Zr(kn.week,r);case"Io":return i.ordinalNumber(r,{unit:"week"});default:return pn(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,i){return wf(_G(r,i))}}const SG=[31,28,31,30,31,30,31,31,30,31,30,31],kG=[31,29,31,30,31,30,31,31,30,31,30,31];class CG extends vr{constructor(){super(...arguments);ft(this,"priority",90);ft(this,"subPriority",1);ft(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(r,n,i){switch(n){case"d":return Zr(kn.date,r);case"do":return i.ordinalNumber(r,{unit:"date"});default:return pn(n.length,r)}}validate(r,n){const i=r.getFullYear(),s=OT(i),l=r.getMonth();return s?n>=1&&n<=kG[l]:n>=1&&n<=SG[l]}set(r,n,i){return r.setDate(i),r.setHours(0,0,0,0),r}}class EG extends vr{constructor(){super(...arguments);ft(this,"priority",90);ft(this,"subpriority",1);ft(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(r,n,i){switch(n){case"D":case"DD":return Zr(kn.dayOfYear,r);case"Do":return i.ordinalNumber(r,{unit:"date"});default:return pn(n.length,r)}}validate(r,n){const i=r.getFullYear();return OT(i)?n>=1&&n<=366:n>=1&&n<=365}set(r,n,i){return r.setMonth(0,i),r.setHours(0,0,0,0),r}}function Uy(e,t,r){var h,d,u,p;const n=eu(),i=(r==null?void 0:r.weekStartsOn)??((d=(h=r==null?void 0:r.locale)==null?void 0:h.options)==null?void 0:d.weekStartsOn)??n.weekStartsOn??((p=(u=n.locale)==null?void 0:u.options)==null?void 0:p.weekStartsOn)??0,s=Yt(e),l=s.getDay(),a=(t%7+7)%7,c=7-i,f=t<0||t>6?t-(l+c)%7:(a+c)%7-(l+c)%7;return Ss(s,f)}class TG extends vr{constructor(){super(...arguments);ft(this,"priority",90);ft(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(r,n,i){switch(n){case"E":case"EE":case"EEE":return i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"});case"EEEEE":return i.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"});case"EEEE":default:return i.day(r,{width:"wide",context:"formatting"})||i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,i,s){return r=Uy(r,i,s),r.setHours(0,0,0,0),r}}class NG extends vr{constructor(){super(...arguments);ft(this,"priority",90);ft(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(r,n,i,s){const l=o=>{const a=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+a};switch(n){case"e":case"ee":return Cn(pn(n.length,r),l);case"eo":return Cn(i.ordinalNumber(r,{unit:"day"}),l);case"eee":return i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"});case"eeeee":return i.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"});case"eeee":default:return i.day(r,{width:"wide",context:"formatting"})||i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,i,s){return r=Uy(r,i,s),r.setHours(0,0,0,0),r}}class AG extends vr{constructor(){super(...arguments);ft(this,"priority",90);ft(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(r,n,i,s){const l=o=>{const a=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+a};switch(n){case"c":case"cc":return Cn(pn(n.length,r),l);case"co":return Cn(i.ordinalNumber(r,{unit:"day"}),l);case"ccc":return i.day(r,{width:"abbreviated",context:"standalone"})||i.day(r,{width:"short",context:"standalone"})||i.day(r,{width:"narrow",context:"standalone"});case"ccccc":return i.day(r,{width:"narrow",context:"standalone"});case"cccccc":return i.day(r,{width:"short",context:"standalone"})||i.day(r,{width:"narrow",context:"standalone"});case"cccc":default:return i.day(r,{width:"wide",context:"standalone"})||i.day(r,{width:"abbreviated",context:"standalone"})||i.day(r,{width:"short",context:"standalone"})||i.day(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=6}set(r,n,i,s){return r=Uy(r,i,s),r.setHours(0,0,0,0),r}}function OG(e,t){const r=Yt(e),n=sG(r),i=t-n;return Ss(r,i)}class PG extends vr{constructor(){super(...arguments);ft(this,"priority",90);ft(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(r,n,i){const s=l=>l===0?7:l;switch(n){case"i":case"ii":return pn(n.length,r);case"io":return i.ordinalNumber(r,{unit:"day"});case"iii":return Cn(i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"}),s);case"iiiii":return Cn(i.day(r,{width:"narrow",context:"formatting"}),s);case"iiiiii":return Cn(i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"}),s);case"iiii":default:return Cn(i.day(r,{width:"wide",context:"formatting"})||i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"}),s)}}validate(r,n){return n>=1&&n<=7}set(r,n,i){return r=OG(r,i),r.setHours(0,0,0,0),r}}class FG extends vr{constructor(){super(...arguments);ft(this,"priority",80);ft(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(r,n,i){switch(n){case"a":case"aa":case"aaa":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaaa":return i.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return i.dayPeriod(r,{width:"wide",context:"formatting"})||i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,i){return r.setHours(By(i),0,0,0),r}}class jG extends vr{constructor(){super(...arguments);ft(this,"priority",80);ft(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(r,n,i){switch(n){case"b":case"bb":case"bbb":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbbb":return i.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return i.dayPeriod(r,{width:"wide",context:"formatting"})||i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,i){return r.setHours(By(i),0,0,0),r}}class DG extends vr{constructor(){super(...arguments);ft(this,"priority",80);ft(this,"incompatibleTokens",["a","b","t","T"])}parse(r,n,i){switch(n){case"B":case"BB":case"BBB":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBBB":return i.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return i.dayPeriod(r,{width:"wide",context:"formatting"})||i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,i){return r.setHours(By(i),0,0,0),r}}class LG extends vr{constructor(){super(...arguments);ft(this,"priority",70);ft(this,"incompatibleTokens",["H","K","k","t","T"])}parse(r,n,i){switch(n){case"h":return Zr(kn.hour12h,r);case"ho":return i.ordinalNumber(r,{unit:"hour"});default:return pn(n.length,r)}}validate(r,n){return n>=1&&n<=12}set(r,n,i){const s=r.getHours()>=12;return s&&i<12?r.setHours(i+12,0,0,0):!s&&i===12?r.setHours(0,0,0,0):r.setHours(i,0,0,0),r}}class IG extends vr{constructor(){super(...arguments);ft(this,"priority",70);ft(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(r,n,i){switch(n){case"H":return Zr(kn.hour23h,r);case"Ho":return i.ordinalNumber(r,{unit:"hour"});default:return pn(n.length,r)}}validate(r,n){return n>=0&&n<=23}set(r,n,i){return r.setHours(i,0,0,0),r}}class RG extends vr{constructor(){super(...arguments);ft(this,"priority",70);ft(this,"incompatibleTokens",["h","H","k","t","T"])}parse(r,n,i){switch(n){case"K":return Zr(kn.hour11h,r);case"Ko":return i.ordinalNumber(r,{unit:"hour"});default:return pn(n.length,r)}}validate(r,n){return n>=0&&n<=11}set(r,n,i){return r.getHours()>=12&&i<12?r.setHours(i+12,0,0,0):r.setHours(i,0,0,0),r}}class MG extends vr{constructor(){super(...arguments);ft(this,"priority",70);ft(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(r,n,i){switch(n){case"k":return Zr(kn.hour24h,r);case"ko":return i.ordinalNumber(r,{unit:"hour"});default:return pn(n.length,r)}}validate(r,n){return n>=1&&n<=24}set(r,n,i){const s=i<=24?i%24:i;return r.setHours(s,0,0,0),r}}class BG extends vr{constructor(){super(...arguments);ft(this,"priority",60);ft(this,"incompatibleTokens",["t","T"])}parse(r,n,i){switch(n){case"m":return Zr(kn.minute,r);case"mo":return i.ordinalNumber(r,{unit:"minute"});default:return pn(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,i){return r.setMinutes(i,0,0),r}}class UG extends vr{constructor(){super(...arguments);ft(this,"priority",50);ft(this,"incompatibleTokens",["t","T"])}parse(r,n,i){switch(n){case"s":return Zr(kn.second,r);case"so":return i.ordinalNumber(r,{unit:"second"});default:return pn(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,i){return r.setSeconds(i,0),r}}class WG extends vr{constructor(){super(...arguments);ft(this,"priority",30);ft(this,"incompatibleTokens",["t","T"])}parse(r,n){const i=s=>Math.trunc(s*Math.pow(10,-n.length+3));return Cn(pn(n.length,r),i)}set(r,n,i){return r.setMilliseconds(i),r}}class zG extends vr{constructor(){super(...arguments);ft(this,"priority",10);ft(this,"incompatibleTokens",["t","T","x"])}parse(r,n){switch(n){case"X":return $a(Ha.basicOptionalMinutes,r);case"XX":return $a(Ha.basic,r);case"XXXX":return $a(Ha.basicOptionalSeconds,r);case"XXXXX":return $a(Ha.extendedOptionalSeconds,r);case"XXX":default:return $a(Ha.extended,r)}}set(r,n,i){return n.timestampIsSet?r:Wr(r,r.getTime()-jg(r)-i)}}class HG extends vr{constructor(){super(...arguments);ft(this,"priority",10);ft(this,"incompatibleTokens",["t","T","X"])}parse(r,n){switch(n){case"x":return $a(Ha.basicOptionalMinutes,r);case"xx":return $a(Ha.basic,r);case"xxxx":return $a(Ha.basicOptionalSeconds,r);case"xxxxx":return $a(Ha.extendedOptionalSeconds,r);case"xxx":default:return $a(Ha.extended,r)}}set(r,n,i){return n.timestampIsSet?r:Wr(r,r.getTime()-jg(r)-i)}}class $G extends vr{constructor(){super(...arguments);ft(this,"priority",40);ft(this,"incompatibleTokens","*")}parse(r){return NT(r)}set(r,n,i){return[Wr(r,i*1e3),{timestampIsSet:!0}]}}class VG extends vr{constructor(){super(...arguments);ft(this,"priority",20);ft(this,"incompatibleTokens","*")}parse(r){return NT(r)}set(r,n,i){return[Wr(r,i),{timestampIsSet:!0}]}}const qG={G:new uG,y:new fG,Y:new hG,R:new dG,u:new pG,Q:new gG,q:new mG,M:new xG,L:new vG,w:new wG,I:new bG,d:new CG,D:new EG,E:new TG,e:new NG,c:new AG,i:new PG,a:new FG,b:new jG,B:new DG,h:new LG,H:new IG,K:new RG,k:new MG,m:new BG,s:new UG,S:new WG,X:new zG,x:new HG,t:new $G,T:new VG},GG=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,XG=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,YG=/^'([^]*?)'?$/,KG=/''/g,JG=/\S/,QG=/[a-zA-Z]/;function ph(e,t,r,n){var m,g,x,y;const i=iG(),s=i.locale??_T,l=i.firstWeekContainsDate??((g=(m=i.locale)==null?void 0:m.options)==null?void 0:g.firstWeekContainsDate)??1,o=i.weekStartsOn??((y=(x=i.locale)==null?void 0:x.options)==null?void 0:y.weekStartsOn)??0,a={firstWeekContainsDate:l,weekStartsOn:o,locale:s},c=[new cG],f=t.match(XG).map(w=>{const _=w[0];if(_ in Wv){const C=Wv[_];return C(w,s.formatLong)}return w}).join("").match(GG),h=[];for(let w of f){ET(w)&&zv(w,t,e),CT(w)&&zv(w,t,e);const _=w[0],C=qG[_];if(C){const{incompatibleTokens:E}=C;if(Array.isArray(E)){const A=h.find(j=>E.includes(j.token)||j.token===_);if(A)throw new RangeError(`The format string mustn't contain \`${A.fullToken}\` and \`${w}\` at the same time`)}else if(C.incompatibleTokens==="*"&&h.length>0)throw new RangeError(`The format string mustn't contain \`${w}\` and any other token at the same time`);h.push({token:_,fullToken:w});const T=C.run(e,w,s.match,a);if(!T)return Wr(r,NaN);c.push(T.setter),e=T.rest}else{if(_.match(QG))throw new RangeError("Format string contains an unescaped latin alphabet character `"+_+"`");if(w==="''"?w="'":_==="'"&&(w=ZG(w)),e.indexOf(w)===0)e=e.slice(w.length);else return Wr(r,NaN)}}if(e.length>0&&JG.test(e))return Wr(r,NaN);const d=c.map(w=>w.priority).sort((w,_)=>_-w).filter((w,_,C)=>C.indexOf(w)===_).map(w=>c.filter(_=>_.priority===w).sort((_,C)=>C.subPriority-_.subPriority)).map(w=>w[0]);let u=Yt(r);if(isNaN(u.getTime()))return Wr(r,NaN);const p={};for(const w of d){if(!w.validate(u,a))return Wr(r,NaN);const _=w.set(u,p,a);Array.isArray(_)?(u=_[0],Object.assign(p,_[1])):u=_}return Wr(r,u)}function ZG(e){return e.match(YG)[1].replace(KG,"'")}function eX(e){return+Yt(e)<Date.now()}function $v(e,t){const r=Yt(e),n=Yt(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function Wy(e){return Nl(e,oq(e))}function zc(e,t){const r=+Yt(e),[n,i]=[+Yt(t.start),+Yt(t.end)].sort((s,l)=>s-l);return r>=n&&r<=i}function Vv(e,t){return Ss(e,-t)}function Cr(e,t){const n=iX(e);let i;if(n.date){const a=sX(n.date,2);i=aX(a.restDateString,a.year)}if(!i||isNaN(i.getTime()))return new Date(NaN);const s=i.getTime();let l=0,o;if(n.time&&(l=oX(n.time),isNaN(l)))return new Date(NaN);if(n.timezone){if(o=lX(n.timezone),isNaN(o))return new Date(NaN)}else{const a=new Date(s+l),c=new Date(0);return c.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),c.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),c}return new Date(s+l+o)}const yp={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},tX=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,rX=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,nX=/^([+-])(\d{2})(?::?(\d{2}))?$/;function iX(e){const t={},r=e.split(yp.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],yp.timeZoneDelimiter.test(t.date)&&(t.date=e.split(yp.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const i=yp.timezone.exec(n);i?(t.time=n.replace(i[1],""),t.timezone=i[1]):t.time=n}return t}function sX(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const i=n[1]?parseInt(n[1]):null,s=n[2]?parseInt(n[2]):null;return{year:s===null?i:s*100,restDateString:e.slice((n[1]||n[2]).length)}}function aX(e,t){if(t===null)return new Date(NaN);const r=e.match(tX);if(!r)return new Date(NaN);const n=!!r[4],i=gh(r[1]),s=gh(r[2])-1,l=gh(r[3]),o=gh(r[4]),a=gh(r[5])-1;if(n)return dX(t,o,a)?cX(t,o,a):new Date(NaN);{const c=new Date(0);return!fX(t,s,l)||!hX(t,i)?new Date(NaN):(c.setUTCFullYear(t,s,Math.max(i,l)),c)}}function gh(e){return e?parseInt(e):1}function oX(e){const t=e.match(rX);if(!t)return NaN;const r=fx(t[1]),n=fx(t[2]),i=fx(t[3]);return pX(r,n,i)?r*Ry+n*d1+i*1e3:NaN}function fx(e){return e&&parseFloat(e.replace(",","."))||0}function lX(e){if(e==="Z")return 0;const t=e.match(nX);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;return gX(n,i)?r*(n*Ry+i*d1):NaN}function cX(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const i=n.getUTCDay()||7,s=(t-1)*7+r+1-i;return n.setUTCDate(n.getUTCDate()+s),n}const uX=[31,null,31,30,31,30,31,31,30,31,30,31];function PT(e){return e%400===0||e%4===0&&e%100!==0}function fX(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(uX[t]||(PT(e)?29:28))}function hX(e,t){return t>=1&&t<=(PT(e)?366:365)}function dX(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function pX(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function gX(e,t){return t>=0&&t<=59}function mX(e,t){const r=Yt(e);return r.setDate(t),r}function g1(e,t){return Qd(e,-1)}function IS(e,t){return kh(e,-5)}function FT(e,t){return p1(e,-1)}const xX={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},vX=(e,t,r)=>{let n;const i=xX[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?n+" ":n+" ":n},yX={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},wX={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},_X={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},bX={date:cf({formats:yX,defaultWidth:"full"}),time:cf({formats:wX,defaultWidth:"full"}),dateTime:cf({formats:_X,defaultWidth:"full"})},SX={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},kX=(e,t,r,n)=>SX[e],CX={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},EX={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},TX={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},NX={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},AX={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},OX={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},PX=(e,t)=>{const r=Number(e);switch(String(t==null?void 0:t.unit)){case"minute":case"second":return String(r);case"date":return r+"";default:return r+""}},FX={ordinalNumber:PX,era:Wa({values:CX,defaultWidth:"wide"}),quarter:Wa({values:EX,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Wa({values:TX,defaultWidth:"wide"}),day:Wa({values:NX,defaultWidth:"wide"}),dayPeriod:Wa({values:AX,defaultWidth:"wide",formattingValues:OX,defaultFormattingWidth:"wide"})},jX=/^(\d+)(|)?/i,DX=/\d+/i,LX={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},IX={any:[/^(bc|)/i,/^(ad|)/i]},RX={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},MX={any:[/1/i,/2/i,/3/i,/4/i]},BX={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},UX={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},WX={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},zX={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},HX={any:/^(am|pm|||||||)/i},$X={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},VX={ordinalNumber:wT({matchPattern:jX,parsePattern:DX,valueCallback:e=>parseInt(e,10)}),era:za({matchPatterns:LX,defaultMatchWidth:"wide",parsePatterns:IX,defaultParseWidth:"any"}),quarter:za({matchPatterns:RX,defaultMatchWidth:"wide",parsePatterns:MX,defaultParseWidth:"any",valueCallback:e=>e+1}),month:za({matchPatterns:BX,defaultMatchWidth:"wide",parsePatterns:UX,defaultParseWidth:"any"}),day:za({matchPatterns:WX,defaultMatchWidth:"wide",parsePatterns:zX,defaultParseWidth:"any"}),dayPeriod:za({matchPatterns:HX,defaultMatchWidth:"any",parsePatterns:$X,defaultParseWidth:"any"})},Qn={code:"ko",formatDistance:vX,formatLong:bX,formatRelative:kX,localize:FX,match:VX,options:{weekStartsOn:0,firstWeekContainsDate:1}},qX=({onSave:e,onCancel:t})=>{const r=ye.useRef(null),[n,i]=ye.useState(!1),[s,l]=ye.useState(!1);ye.useEffect(()=>{const u=r.current;if(!u)return;const p=u.getContext("2d"),m=window.devicePixelRatio||1,g=u.getBoundingClientRect();u.width=g.width*m,u.height=g.height*m,p.scale(m,m),p.strokeStyle="black",p.lineWidth=10,p.lineCap="round"},[]);const o=u=>{const m=r.current.getBoundingClientRect(),g=u.touches?u.touches[0].clientX:u.clientX,x=u.touches?u.touches[0].clientY:u.clientY;return{x:g-m.left,y:x-m.top}},a=u=>{i(!0);const{x:p,y:m}=o(u),g=r.current.getContext("2d");g.strokeStyle="black",g.lineWidth=10,g.lineCap="round",g.beginPath(),g.moveTo(p,m)},c=u=>{if(!n)return;const{x:p,y:m}=o(u),g=r.current.getContext("2d");g.lineTo(p,m),g.stroke(),l(!0)},f=()=>{i(!1)},h=()=>{const u=r.current;u.getContext("2d").clearRect(0,0,u.width,u.height),l(!1)},d=()=>{if(!s){alert("  .");return}r.current.toBlob(p=>{e(p)},"image/png")};return v.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-fade-in",onClick:t,children:v.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden animate-spring-up",onClick:u=>u.stopPropagation(),children:[v.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[v.jsxs("h4",{className:"text-sm font-black text-[#1C1C1E] flex items-center gap-2",children:[v.jsx(W2,{className:"w-4 h-4 text-ios-indigo"}),"  "]}),v.jsx("button",{onClick:t,className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:v.jsx(Tl,{className:"w-5 h-5"})})]}),v.jsxs("div",{className:"p-6 bg-white flex flex-col items-center gap-4",children:[v.jsx("p",{className:"text-xs text-ios-gray mb-2",children:"    ."}),v.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-xl bg-gray-50 touch-none overflow-hidden relative w-full h-[200px]",children:v.jsx("canvas",{ref:r,style:{width:"100%",height:"100%"},onMouseDown:a,onMouseMove:c,onMouseUp:f,onMouseLeave:f,onTouchStart:a,onTouchMove:c,onTouchEnd:f})})]}),v.jsxs("div",{className:"p-4 border-t border-gray-100 flex gap-3 bg-gray-50",children:[v.jsx("button",{onClick:h,className:"flex-1 py-3 bg-white border border-gray-200 text-[#1C1C1E] rounded-xl text-xs font-bold hover:bg-gray-50 transition-all",children:""}),v.jsxs("button",{onClick:d,className:"flex-[2] py-3 bg-[#1C1C1E] text-white rounded-xl text-xs font-bold hover:bg-gray-800 shadow-lg transition-all flex items-center justify-center gap-2",children:[v.jsx(qs,{className:"w-4 h-4"}),"  "]})]})]})})},GX=()=>{const[e,t]=ye.useState(new Date),[r,n]=ye.useState([]),[i,s]=ye.useState([]),[l,o]=ye.useState(null),[a,c]=ye.useState(!1),[f,h]=ye.useState(null),[d,u]=ye.useState([]),[p,m]=ye.useState([]),[g,x]=ye.useState([]),[y,w]=ye.useState({name:"",level:""}),C=e.getMonth()+1<3?e.getFullYear()-1:e.getFullYear(),[E,T]=ye.useState(null),[A,j]=ye.useState(null),[B,F]=ye.useState(null),[L,G]=ye.useState(!1),[X,re]=ye.useState(null),[Q,ne]=ye.useState(""),[J,P]=ye.useState(!1);ye.useEffect(()=>{I(),U(),H()},[]),ye.useEffect(()=>{l&&S()},[C,l]),ye.useEffect(()=>{l&&O()},[e,l]);const H=async()=>{const{data:W}=await Xe.from("configs").select("value").eq("key","school_info").single();W!=null&&W.value&&w(W.value)},U=async()=>{const{data:W}=await Xe.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});W&&W.length>0&&(s(W),o(W[0].id))},S=async()=>{const[W,he,fe]=await Promise.all([Xe.from("operation_quarters").select("*").eq("academic_year",C).order("quarter",{ascending:!0}),Xe.from("operation_exceptions").select("*"),Xe.from("sessions").select("*").eq("zone_id",l).order("start_time",{ascending:!0})]);W.data&&u(W.data),he.data&&x(he.data);const{data:Te}=await Xe.from("session_operating_days").select("session_id, day_of_week").in("session_id",(fe.data||[]).map(be=>be.id)).eq("is_active",!0);m(Te||[])},I=async()=>{const{data:{user:W}}=await Xe.auth.getUser();if(W){const{data:he}=await Xe.from("profiles").select("*").eq("id",W.id).single();h({...W,profile:he})}},O=async()=>{if(!l)return;c(!0);const W=_f(e).toISOString(),he=Ld(e).toISOString(),{data:fe,error:Te}=await Xe.from("supervision_assignments").select("*").eq("zone_id",l).gte("date",W).lte("date",he).order("created_at",{ascending:!0});fe&&n(fe),c(!1)},N=async()=>{if(!Q.trim()||!E||!l)return;const W=ct(E.date,"yyyy-MM-dd"),{error:he}=await Xe.from("supervision_assignments").insert([{date:W,supervisor_name:Q.trim(),teacher_id:null,zone_id:l}]);he?alert("  : "+he.message):(ne(""),T(null),O())},R=async()=>{if(!Q.trim()||!A)return;const{error:W}=await Xe.from("supervision_assignments").update({supervisor_name:Q.trim()}).eq("id",A.id);W?alert(" : "+W.message):(ne(""),j(null),O())},z=W=>{if(!W)return null;const he=W.split("/signatures/");return he.length>1?he[1]:null},K=async(W,he)=>{if(he.stopPropagation(),!confirm(" ?   ."))return;const fe=r.find(be=>be.id===W);if(fe!=null&&fe.signature_url){const be=z(fe.signature_url);be&&await Xe.storage.from("signatures").remove([be])}const{error:Te}=await Xe.from("supervision_assignments").delete().eq("id",W);Te||O()},Y=async W=>{if(!B)return;const he=r.find(ce=>ce.id===B.assignmentId);if(he!=null&&he.signature_url){const ce=z(he.signature_url);ce&&await Xe.storage.from("signatures").remove([ce])}const fe=`sig_${B.assignmentId}_${Date.now()}.png`,{data:Te,error:be}=await Xe.storage.from("signatures").upload(fe,W,{contentType:"image/png",upsert:!0});if(be){alert("  : "+be.message);return}const{data:{publicUrl:pe}}=Xe.storage.from("signatures").getPublicUrl(fe),{error:xe}=await Xe.from("supervision_assignments").update({signature_url:pe}).eq("id",B.assignmentId);xe?alert("  : "+xe.message):(F(null),O())},Z=()=>{G(!0)},se=async W=>{if(!l)return;c(!0);const{data:he,error:fe}=await Xe.from("supervision_assignments").select("*").eq("zone_id",l).gte("date",W.start_date).lte("date",W.end_date).order("date",{ascending:!0});if(fe){alert("  : "+fe.message),c(!1);return}re({quarter:W,assignments:he||[],operatingRules:p,exceptions:g}),G(!1),c(!1),setTimeout(()=>{window.print()},500)},V=()=>v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsxs("div",{className:"flex items-center gap-6",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("h3",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:ct(e,"yyyy M")}),v.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-xl border border-gray-200",children:[v.jsx("button",{onClick:()=>t(g1(e)),className:"p-1.5 hover:bg-white rounded-lg text-ios-gray hover:text-[#1C1C1E] transition-all ios-tap shadow-sm hover:shadow",children:v.jsx(jo,{className:"w-4 h-4"})}),v.jsx("button",{onClick:()=>t(Qd(e,1)),className:"p-1.5 hover:bg-white rounded-lg text-ios-gray hover:text-[#1C1C1E] transition-all ios-tap shadow-sm hover:shadow",children:v.jsx(Cs,{className:"w-4 h-4"})})]})]}),v.jsx("div",{className:"flex bg-gray-100 p-1 rounded-xl border border-gray-200",children:i.map(W=>v.jsx("button",{onClick:()=>o(W.id),className:`px-4 py-1.5 rounded-lg text-xs font-black transition-all ios-tap ${l===W.id?"bg-[#1C1C1E] text-white shadow-md":"text-ios-gray hover:text-[#1C1C1E]"}`,children:W.name},W.id))})]}),v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group select-none",children:[v.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${J?"bg-[#1C1C1E] border-[#1C1C1E]":"bg-white border-gray-300 group-hover:border-gray-400"}`,children:J&&v.jsx(qs,{className:"w-3 h-3 text-white"})}),v.jsx("input",{type:"checkbox",checked:J,onChange:W=>P(W.target.checked),className:"hidden"}),v.jsx("span",{className:"text-xs font-bold text-ios-gray group-hover:text-[#1C1C1E] transition-colors",children:" "})]}),v.jsxs("button",{onClick:Z,className:"flex items-center gap-2 bg-[#1C1C1E] text-white px-4 py-2 rounded-lg font-bold text-xs transition-all shadow-lg hover:bg-gray-800 hover:shadow-xl ios-tap",children:[v.jsx(Fl,{className:"w-3.5 h-3.5"}),"  "]})]})]}),le=()=>{const W=["","","","","","",""],he=J?W:W.filter((fe,Te)=>Te!==0&&Te!==6);return v.jsx("div",{className:`grid ${J?"grid-cols-7":"grid-cols-5"} mb-2 border-b border-gray-100`,children:he.map((fe,Te)=>v.jsx("div",{className:`py-3 text-[10px] font-black uppercase text-center tracking-widest ${J&&Te===0?"text-ios-rose":J&&Te===6?"text-ios-indigo":"text-ios-gray"}`,children:fe},Te))})},ae=()=>{const W=_f(e),he=Ld(W),fe=Mn(W),Te=No(he),be=tu({start:fe,end:Te});return v.jsx("div",{className:`grid ${J?"grid-cols-7":"grid-cols-5"} gap-px bg-gray-100 border border-gray-100 rounded-[12px] overflow-hidden shadow-sm`,children:be.filter(pe=>J||pe.getDay()!==0&&pe.getDay()!==6).map((pe,xe)=>{var ht;const ce=Wy(pe),Ne=$v(pe,W),Ie=pe.getDay(),Re=ct(pe,"yyyy-MM-dd"),De=r.filter(it=>it.date===Re),Me=g.find(it=>it.exception_date===Re),Ge=d.find(it=>it.start_date&&it.end_date&&zc(pe,{start:Cr(it.start_date),end:Cr(it.end_date)})),Ae=p.filter(it=>it.day_of_week===Ie),Pe=Ge&&!Me&&Ae.length>0,Ue=Ae.length<=2,Ye=Pe?Ue?1:2:0,nt=((ht=f==null?void 0:f.profile)==null?void 0:ht.role)==="admin",Qe=nt||ce;return v.jsxs("div",{className:`h-[200px] p-2 flex flex-col gap-2 transition-colors border-b border-r border-gray-100 ${Ne?Pe?"bg-white":"bg-gray-50":"bg-gray-50/50 opacity-40"}`,children:[v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsx("span",{className:`text-[12px] font-black ${ce?"w-6 h-6 text-ios-indigo border-2 border-ios-indigo rounded-full flex items-center justify-center -mt-1 -ml-1 bg-white":Ie===0?"text-ios-rose":Ie===6?"text-ios-indigo":"text-[#1C1C1E]"}`,children:ct(pe,"d")}),nt&&Pe&&De.length<Ye&&v.jsx("button",{onClick:()=>T({date:pe}),className:"w-5 h-5 flex items-center justify-center rounded-full bg-[#1C1C1E] text-white hover:bg-gray-800 transition-all ios-tap shadow-sm",title:" ",children:v.jsx(ud,{className:"w-3 h-3"})})]}),v.jsx("div",{className:"flex-1 flex flex-col gap-1.5 overflow-y-auto scrollbar-hide",children:De.map(it=>{var dt;return v.jsxs("div",{className:"relative group bg-gray-50 rounded-[8px] p-2 border border-dashed border-gray-200 hover:border-ios-indigo/30 transition-all",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("span",{className:"text-[11px] font-bold text-[#1C1C1E]",children:it.supervisor_name}),nt&&v.jsxs("div",{className:"opacity-0 group-hover:opacity-100 flex items-center transition-opacity",children:[v.jsx("button",{onClick:Mt=>{Mt.stopPropagation(),ne(it.supervisor_name),j({id:it.id,name:it.supervisor_name,date:pe})},className:"p-1 text-gray-400 hover:text-ios-indigo transition-colors",title:" ",children:v.jsx(K8,{className:"w-3 h-3"})}),v.jsx("button",{onClick:Mt=>K(it.id,Mt),className:"p-1 text-gray-400 hover:text-ios-rose transition-colors",title:"",children:v.jsx(jl,{className:"w-3 h-3"})})]})]}),it.signature_url?v.jsxs("div",{className:"relative h-8 flex items-center",children:[v.jsx("img",{src:it.signature_url,alt:"",className:"h-full object-contain opacity-80"}),nt&&v.jsx("button",{onClick:()=>F({assignmentId:it.id}),className:"absolute inset-0 bg-black/5 opacity-0 hover:opacity-100 flex items-center justify-center text-[9px] text-[#1C1C1E] font-black rounded backdrop-blur-[1px]",children:""})]}):v.jsx("div",{className:"h-8 flex items-center justify-center",children:nt||((dt=f==null?void 0:f.profile)==null?void 0:dt.full_name)===it.supervisor_name&&Qe?v.jsxs("button",{onClick:()=>F({assignmentId:it.id}),className:"w-full h-full border border-dashed border-ios-indigo/30 rounded flex items-center justify-center gap-1 text-[9px] text-ios-indigo font-bold hover:bg-ios-indigo/5 transition-colors",children:[v.jsx(W2,{className:"w-3 h-3"})," "]}):!ce&&eX(pe)?v.jsx("span",{className:"text-[9px] text-red-500 font-bold",children:""}):v.jsx("span",{className:"text-[9px] text-gray-300 font-medium",children:" "})})]},it.id)})})]},xe)})})};return v.jsxs("div",{className:"h-full flex flex-col p-6 animate-spring-up overflow-hidden relative print:hidden",children:[v.jsxs("div",{className:"flex-none",children:[V(),le()]}),v.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide -mr-2 pr-2",children:ae()}),E&&v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm p-4 animate-fade-in",onClick:()=>T(null),children:v.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-xs overflow-hidden animate-spring-up",onClick:W=>W.stopPropagation(),children:[v.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[v.jsxs("h4",{className:"text-sm font-black text-[#1C1C1E]",children:[ct(E.date,"M d"),"  "]}),v.jsx("button",{onClick:()=>T(null),className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:v.jsx(Tl,{className:"w-4 h-4"})})]}),v.jsxs("div",{className:"p-4 space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-[10px] font-bold text-ios-gray uppercase tracking-wider mb-2",children:"  "}),v.jsx("input",{type:"text",value:Q,onChange:W=>ne(W.target.value),placeholder:" ",className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 text-sm font-bold text-[#1C1C1E] focus:outline-none focus:ring-2 focus:ring-ios-indigo/50 transition-all",onKeyDown:W=>W.key==="Enter"&&N(),autoFocus:!0})]}),v.jsx("button",{onClick:N,className:"w-full py-3 bg-[#1C1C1E] text-white rounded-xl text-xs font-bold hover:bg-gray-800 shadow-lg transition-all",children:""})]})]})}),A&&v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm p-4 animate-fade-in",onClick:()=>j(null),children:v.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-xs overflow-hidden animate-spring-up",onClick:W=>W.stopPropagation(),children:[v.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[v.jsx("h4",{className:"text-sm font-black text-[#1C1C1E]",children:"  "}),v.jsx("button",{onClick:()=>j(null),className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:v.jsx(Tl,{className:"w-4 h-4"})})]}),v.jsxs("div",{className:"p-4 space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-[10px] font-bold text-ios-gray uppercase tracking-wider mb-2",children:" "}),v.jsx("input",{type:"text",value:Q,onChange:W=>ne(W.target.value),placeholder:" ",className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 text-sm font-bold text-[#1C1C1E] focus:outline-none focus:ring-2 focus:ring-ios-indigo/50 transition-all",onKeyDown:W=>W.key==="Enter"&&R(),autoFocus:!0})]}),v.jsx("button",{onClick:R,className:"w-full py-3 bg-[#1C1C1E] text-white rounded-xl text-xs font-bold hover:bg-gray-800 shadow-lg transition-all",children:" "})]})]})}),B&&v.jsx(qX,{onSave:Y,onCancel:()=>F(null)}),L&&v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm p-4 animate-fade-in",onClick:()=>G(!1),children:v.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm overflow-hidden animate-spring-up",onClick:W=>W.stopPropagation(),children:[v.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[v.jsxs("h4",{className:"text-sm font-black text-[#1C1C1E] flex items-center gap-2",children:[v.jsx(Fl,{className:"w-4 h-4 text-ios-indigo"}),"  "]}),v.jsx("button",{onClick:()=>G(!1),className:"p-1 rounded-full hover:bg-gray-200 text-ios-gray",children:v.jsx(Tl,{className:"w-5 h-5"})})]}),v.jsxs("div",{className:"p-4 max-h-[60vh] overflow-y-auto",children:[v.jsx("p",{className:"text-xs text-ios-gray mb-4",children:" /  ."}),v.jsxs("div",{className:"grid gap-2",children:[d.map(W=>v.jsx("button",{onClick:()=>se(W),className:"w-full p-3 rounded-xl border border-gray-100 hover:border-ios-indigo/50 hover:bg-ios-indigo/5 transition-all text-left group",children:v.jsxs("span",{className:"text-sm font-bold text-[#1C1C1E] group-hover:text-ios-indigo",children:[W.quarter_name?`${W.quarter_name}: `:"",W.start_date," ~ ",W.end_date]})},W.id)),d.length===0&&v.jsx("div",{className:"text-center py-6 text-gray-300 text-xs",children:"   ."})]})]})]})}),X&&ug.createPortal(v.jsxs("div",{id:"print-root",className:"bg-white text-black hidden print:block",children:[v.jsx("style",{children:`
                            @media print {
                                @page { size: A4 portrait; margin: 0; }
                                body { 
                                    margin: 0 !important;
                                    padding: 0 !important;
                                    background-color: white !important;
                                    font-family: 'Malgun Gothic', 'Dotum', 'Apple SD Gothic Neo', sans-serif !important;
                                    -webkit-print-color-adjust: exact !important;
                                    print-color-adjust: exact !important;
                                    color: #000000 !important;
                                }
                                body > #root {
                                    display: none !important;
                                }
                                body > #print-root {
                                    display: block !important;
                                    width: 210mm !important;
                                    min-height: 297mm !important;
                                    padding: 10mm !important;
                                    box-sizing: border-box !important;
                                    background-color: white !important;
                                    font-family: 'Malgun Gothic', 'Dotum', 'Apple SD Gothic Neo', sans-serif !important;
                                }
                                /* Force solid borders */
                                * {
                                    border-color: #000000 !important;
                                    border-style: solid !important;
                                }
                                /* Ensure text is strictly black */
                                .print-text-black {
                                    color: #000000 !important;
                                }
                            }
                            #print-root {
                                display: none;
                            }
                        `}),v.jsxs("div",{className:"flex flex-col w-full h-full bg-white relative",children:[v.jsxs("div",{className:"flex-none mb-2 text-center",children:[v.jsx("h1",{className:"text-[20pt] font-black tracking-widest mb-1 underline decoration-2 underline-offset-4 text-black",children:"  "}),v.jsxs("div",{className:"flex justify-between items-end border-b-2 border-black pb-1 mb-1 relative",children:[v.jsxs("span",{className:"text-[9pt] font-bold text-black absolute left-0 bottom-1",children:[X.quarter.quarter_name," (",X.quarter.start_date," ~ ",X.quarter.end_date,")"]}),v.jsx("span",{className:"w-full text-center text-[8pt] text-transparent",children:"."}),v.jsxs("span",{className:"text-[8pt] text-black absolute right-0 bottom-1",children:[": ",ct(new Date,"yyyy. MM. dd.")]})]})]}),v.jsx("div",{className:"flex-1 flex gap-2 items-start justify-center w-full",children:(()=>{try{const W=Cr(X.quarter.start_date),he=Cr(X.quarter.end_date);return!Mp(W)||!Mp(he)?v.jsx("div",{className:"w-full text-center p-10 text-red-500 font-bold",children:"   ."}):cq({start:W,end:he}).map((fe,Te)=>{const be=Array.from({length:31},(pe,xe)=>{const ce=xe+1;try{const Ne=mX(fe,ce);return!Mp(Ne)||!$v(Ne,fe)?null:Ne}catch{return null}});return v.jsx("div",{className:"flex-1 h-full flex flex-col min-w-0",children:v.jsxs("table",{className:"w-full border-collapse table-fixed border border-black",children:[v.jsxs("colgroup",{children:[v.jsx("col",{style:{width:"12%"}}),v.jsx("col",{style:{width:"22%"}}),v.jsx("col",{style:{width:"22%"}}),v.jsx("col",{style:{width:"22%"}}),v.jsx("col",{style:{width:"22%"}})]}),v.jsxs("thead",{children:[v.jsx("tr",{className:"bg-[#E5E7EB]",children:v.jsx("th",{colSpan:5,className:"border border-black text-center font-bold py-1 text-[10pt] text-black",children:ct(fe,"M")})}),v.jsxs("tr",{className:"bg-[#F3F4F6] text-[7pt] text-black font-bold h-[8mm]",children:[v.jsx("th",{rowSpan:2,className:"border border-black text-center align-middle",children:""}),v.jsx("th",{colSpan:2,className:"border border-black text-center align-middle h-[4mm]",children:" 1"}),v.jsx("th",{colSpan:2,className:"border border-black text-center align-middle h-[4mm]",children:" 2"})]}),v.jsxs("tr",{className:"bg-[#F3F4F6] text-[7pt] text-black font-bold h-[4mm]",children:[v.jsx("th",{className:"border border-black text-center align-middle",children:""}),v.jsx("th",{className:"border border-black text-center align-middle",children:""}),v.jsx("th",{className:"border border-black text-center align-middle",children:""}),v.jsx("th",{className:"border border-black text-center align-middle",children:""})]})]}),v.jsx("tbody",{children:be.map((pe,xe)=>{if(!pe)return v.jsxs("tr",{className:"h-[7mm] bg-gray-100/30",children:[v.jsx("td",{className:"border border-black"}),v.jsx("td",{className:"border border-black"}),v.jsx("td",{className:"border border-black"}),v.jsx("td",{className:"border border-black"}),v.jsx("td",{className:"border border-black"})]},xe);const ce=ct(pe,"yyyy-MM-dd"),Ne=ct(pe,"E",{locale:Qn}),Ie=X.assignments.filter(Pe=>Pe.date===ce),Re=Ie[0],De=Ie[1],Me=X.exceptions.find(Pe=>Pe.exception_date===ce),Ae=zc(pe,{start:Cr(X.quarter.start_date),end:Cr(X.quarter.end_date)})&&!Me&&X.operatingRules.some(Pe=>Pe.day_of_week===pe.getDay());return v.jsxs("tr",{className:"h-[7mm] text-[7pt] text-black",children:[v.jsxs("td",{className:`border border-black text-center font-bold tracking-tighter align-middle p-0 ${Ne===""?"text-blue-700":Ne===""?"text-red-600":"text-black"}`,children:[ct(pe,"d"),"(",Ne,")"]}),v.jsx("td",{className:"border border-black text-center break-all align-middle p-0.5",children:Ae?(Re==null?void 0:Re.supervisor_name)||"":"-"}),v.jsx("td",{className:"border border-black text-center align-middle p-0.5",children:Ae&&(Re==null?void 0:Re.signature_url)&&v.jsx("img",{src:Re.signature_url,className:"max-h-[18px] w-auto mx-auto object-contain",alt:""})}),v.jsx("td",{className:"border border-black text-center break-all align-middle p-0.5",children:Ae&&(De==null?void 0:De.supervisor_name)||""}),v.jsx("td",{className:"border border-black text-center align-middle p-0.5",children:Ae&&(De==null?void 0:De.signature_url)&&v.jsx("img",{src:De.signature_url,className:"max-h-[18px] w-auto mx-auto object-contain",alt:""})})]},xe)})})]})},Te)})}catch{return v.jsx("div",{className:"w-full text-center text-red-500",children:"  "})}})()}),v.jsxs("div",{className:"mt-2 text-center text-[9pt] font-bold flex-none text-black",children:["      .  ",y.name?`${y.name}${y.level||""}`:"GOE",""]})]})]}),document.body)]})},XX=({onSave:e,onCancel:t,teacherName:r})=>{const n=ye.useRef(null),[i,s]=ye.useState(!1),[l,o]=ye.useState(!1);ye.useEffect(()=>{const u=n.current;if(!u)return;const p=u.getContext("2d"),m=window.devicePixelRatio||1,g=u.getBoundingClientRect();u.width=g.width*m,u.height=g.height*m,p.scale(m,m),p.strokeStyle="#1C1C1E",p.lineWidth=10,p.lineCap="round",p.lineJoin="round"},[]);const a=u=>{const m=n.current.getBoundingClientRect(),g=u.touches?u.touches[0].clientX:u.clientX,x=u.touches?u.touches[0].clientY:u.clientY;return{x:g-m.left,y:x-m.top}},c=u=>{s(!0);const{x:p,y:m}=a(u),g=n.current.getContext("2d");g.beginPath(),g.moveTo(p,m)},f=u=>{if(!i)return;const{x:p,y:m}=a(u),g=n.current.getContext("2d");g.lineTo(p,m),g.stroke(),o(!0)},h=()=>s(!1),d=()=>{if(!l)return alert("  .");n.current.toBlob(p=>e(p),"image/png")};return v.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-md flex flex-col justify-end",children:v.jsxs("div",{className:"bg-white/90 backdrop-blur-2xl rounded-t-[32px] p-6 mobile-slide-up h-[70vh] border-t border-white/20",children:[v.jsxs("div",{className:"flex justify-between items-center mb-8",children:[v.jsxs("div",{children:[v.jsxs("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:[r,""]}),v.jsx("p",{className:"text-ios-gray text-sm font-bold opacity-70",children:"     ."})]}),v.jsx("button",{onClick:t,className:"p-2.5 bg-gray-100/50 rounded-apple-md ios-tap",children:v.jsx(Tl,{className:"w-5 h-5 text-ios-gray"})})]}),v.jsx("div",{className:"mobile-signature-pad mb-8",children:v.jsx("canvas",{ref:n,style:{width:"100%",height:"100%"},onMouseDown:c,onMouseMove:f,onMouseUp:h,onMouseLeave:h,onTouchStart:c,onTouchMove:f,onTouchEnd:h})}),v.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[v.jsx("button",{onClick:()=>{n.current.getContext("2d").clearRect(0,0,n.current.width,n.current.height),o(!1)},className:"py-4 bg-gray-100/80 text-[#1C1C1E] rounded-apple-md font-black ios-tap",children:" "}),v.jsx("button",{onClick:d,className:"py-4 bg-[#007AFF] text-white rounded-apple-md font-black ios-tap shadow-lg shadow-blue-500/20",children:" "})]})]})})},YX=({onLogout:e,currentUser:t})=>{const r=ye.useRef(null),[n,i]=ye.useState("menu"),[s,l]=ye.useState(!0),[o,a]=ye.useState([]),[c,f]=ye.useState(null),[h,d]=ye.useState(!1),[u,p]=ye.useState([]),m={A:ye.useRef(null),B:ye.useRef(null),C:ye.useRef(null)},[g,x]=ye.useState([]),[y,w]=ye.useState(null),[_,C]=ye.useState([]),[E,T]=ye.useState(null),[A,j]=ye.useState(ct(new Date,"yyyy-MM-dd")),B=ct(new Date,"yyyy-MM-dd");ye.useEffect(()=>{F()},[]),ye.useEffect(()=>{X()},[A]),ye.useEffect(()=>{E&&re()},[E]),ye.useEffect(()=>{y&&(n==="attendance"||n==="seatmap")&&Q()},[y,n,A,E]);const F=async()=>{l(!0);const{data:z}=await Xe.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});let K=ct(new Date,"yyyy-MM-dd");if(z&&z.length>0){C(z);const Z=z[0].id;T(Z);const[se,V,le]=await Promise.all([Xe.from("operation_quarters").select("*"),Xe.from("operation_exceptions").select("*").eq("zone_id",Z),Xe.from("sessions").select("id").eq("zone_id",Z)]);if(le.data&&le.data.length>0){const{data:ae}=await Xe.from("session_operating_days").select("session_id, day_of_week").in("session_id",le.data.map(W=>W.id)).eq("is_active",!0);K=L(new Date,se.data||[],V.data||[],ae||[]),j(K)}}const{data:Y}=await Xe.from("supervision_assignments").select("*").eq("date",K);Y&&a(Y),l(!1)},L=(z,K,Y,Z)=>{let se=Ga(z);for(let V=0;V<30;V++){const le=ct(se,"yyyy-MM-dd");if(G(se,K,Y,Z))return le;se=Ss(se,1)}return ct(z,"yyyy-MM-dd")},G=(z,K,Y,Z)=>{const se=ct(z,"yyyy-MM-dd");if(K.length>0&&!K.some(ae=>ae.start_date&&ae.end_date&&zc(z,{start:Cr(ae.start_date),end:Cr(ae.end_date)}))||Y.some(le=>le.exception_date===se))return!1;if(Z.length>0){const le=z.getDay();if(!Z.some(W=>W.day_of_week===le))return!1}return!0},X=async()=>{const{data:z,error:K}=await Xe.from("supervision_assignments").select("*").eq("date",A);z&&a(z),l(!1)},re=async()=>{var K;if(!E)return;const{data:z}=await Xe.from("sessions").select("*").eq("zone_id",E).order("start_time",{ascending:!0});if(z&&z.length>0){x(z);const Y=ct(new Date,"HH:mm:ss");let Z=null;for(let se=0;se<z.length;se++){const V=z[se],le=se>0?z[se-1]:null;if(le){if(Y>le.end_time&&Y<=V.end_time){Z=V;break}}else if(Y>="07:00:00"&&Y<=V.end_time){Z=V;break}}w(Z?Z.id:(K=z[0])==null?void 0:K.id)}},Q=async()=>{l(!0);const{data:z,error:K}=await Xe.from("seats").select("*, zone_color").order("seat_number",{ascending:!0});if(K){console.error("Error fetching seats:",K),l(!1);return}const{data:Y,error:Z}=await Xe.from("bookings").select(`
                id, seat_id, session_id,
                profiles (full_name, username, grade),
                profiles_student (full_name, username, grade),
                attendance (id, status, timestamp_in, timestamp_out)
            `).eq("date",A);if(z){const se=z.map(V=>{var fe;const le=(Y||[]).find(Te=>Te.seat_id===V.id&&Te.session_id===y),ae=(Y||[]).some(Te=>Te.seat_id===V.id),W=(fe=le==null?void 0:le.attendance)==null?void 0:fe[0],he=(le==null?void 0:le.profiles_student)||(le==null?void 0:le.profiles);return{seat_id:V.id,place_id:V.zone_id,zone_id:V.zone_id,seat_number:V.seat_number,display_number:V.display_number,zone_name:V.zone_name,zone_color:V.zone_color,booking_id:le==null?void 0:le.id,full_name:he==null?void 0:he.full_name,username:he==null?void 0:he.username,grade:he==null?void 0:he.grade,attendance_id:W==null?void 0:W.id,status:(W==null?void 0:W.status)||"absent",timestamp_in:W==null?void 0:W.timestamp_in,timestamp_out:W==null?void 0:W.timestamp_out,is_active:!!le,is_booked_today:ae}});se.sort((V,le)=>(V.seat_number||"").localeCompare(le.seat_number||"",void 0,{numeric:!0,sensitivity:"base"})),p(se)}l(!1)},ne=async z=>{const K=`sig_duty_${c.id}_${Date.now()}.png`,{error:Y}=await Xe.storage.from("signatures").upload(K,z,{contentType:"image/png"});if(Y)return alert("  ");const{data:{publicUrl:Z}}=Xe.storage.from("signatures").getPublicUrl(K),{error:se}=await Xe.from("supervision_assignments").update({signature_url:Z}).eq("id",c.id);se||(d(!1),X())},J=()=>{const z=new Date,K=9*60*60*1e3;return new Date(z.getTime()+K).toISOString().replace("Z","+09:00")},P=async z=>{if(z.status!=="absent")return;const Y={id:z.attendance_id,booking_id:z.booking_id,status:"present",updated_at:new Date().toISOString()};if(!z.timestamp_in){const V=g.find(le=>le.id===y);V?(Y.timestamp_in=`${B}T${V.start_time}+09:00`,Y.status="present"):Y.timestamp_in=J()}const{data:Z,error:se}=await Xe.from("attendance").upsert(Y,{onConflict:"booking_id"}).select().single();!se&&Z?p(V=>V.map(le=>le.booking_id===z.booking_id?{...le,status:Z.status,attendance_id:Z.id,timestamp_in:Z.timestamp_in}:le)):Q()},H=async z=>{if(z.attendance_id)try{const{error:K}=await Xe.from("attendance").delete().eq("id",z.attendance_id);if(K)throw K;Q()}catch(K){console.error("Error resetting attendance:",K)}},U=()=>{e&&e()},S=z=>{const K=new Date(A);K.setDate(K.getDate()+z),j(ct(K,"yyyy-MM-dd"))};ye.useEffect(()=>{},[n]);const I=()=>{const z=_.find(se=>se.id===E),K=(z==null?void 0:z.name)||"";ct(new Date,"yyyy M d"),["","","","","","",""][new Date().getDay()],z!=null&&z.code,z!=null&&z.name;const Y=u.filter(se=>se.status==="present").length,Z=u.filter(se=>se.is_active&&(se.status==="absent"||!se.status)).length;return v.jsxs("header",{className:"flex-none glass-header px-6 pt-10 pb-4 flex flex-col gap-5 z-50",children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsxs("div",{className:"flex flex-col",children:[v.jsx("h1",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:" "}),v.jsx("p",{className:"text-[10px] font-black text-ios-indigo tracking-[0.2em] uppercase opacity-70",children:"Study Cafe Manager"})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[n==="attendance"&&v.jsx("button",{onClick:()=>i("seatmap"),className:"px-3 py-2.5 bg-ios-indigo/10 text-ios-indigo rounded-apple-md ios-tap border border-ios-indigo/10 text-[12px] font-black whitespace-nowrap",children:" "}),n!=="menu"?v.jsx("button",{onClick:()=>i(n==="seatmap"?"attendance":"menu"),className:"px-4 py-2.5 bg-gray-200/20 text-ios-gray rounded-apple-md ios-tap border border-white/40 text-[13px] font-black",children:n==="seatmap"?"":""}):v.jsx("button",{onClick:U,className:"p-2.5 bg-ios-rose/10 text-ios-rose rounded-apple-md ios-tap border border-ios-rose/10",children:v.jsx(Jg,{className:"w-5 h-5"})})]})]}),(n==="attendance"||n==="seatmap"||n==="supervision")&&v.jsxs("div",{className:"flex flex-col gap-5 animate-in fade-in slide-in-from-top-4 duration-300",children:[v.jsxs("div",{className:"flex gap-2 items-stretch",children:[v.jsx("div",{className:"flex-1 bg-[#1C1C1E] p-1 rounded-apple-md border border-white/10 flex items-center justify-center min-h-[38px] shadow-sm",children:v.jsx("span",{className:"text-[12px] font-black text-white px-2",children:K})}),v.jsxs("div",{className:"flex-[2] flex items-center justify-between bg-gray-200/20 px-2 rounded-apple-md border border-white/40 backdrop-blur-xl min-h-[38px]",children:[v.jsx("button",{onClick:()=>S(-1),className:"w-8 h-8 flex items-center justify-center text-ios-gray ios-tap",children:v.jsx(jo,{className:"w-4 h-4"})}),v.jsxs("span",{className:"text-[13px] font-black text-[#1C1C1E]",children:[A," (",["","","","","","",""][new Date(A).getDay()],")"]}),v.jsx("button",{onClick:()=>S(1),className:"w-8 h-8 flex items-center justify-center text-ios-gray ios-tap",children:v.jsx(Cs,{className:"w-4 h-4"})})]})]}),(n==="attendance"||n==="seatmap")&&v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"flex bg-gray-200/20 p-1 rounded-apple-md border border-white/40 overflow-x-auto scrollbar-hide",children:g.map(se=>v.jsx("button",{onClick:()=>w(se.id),className:`flex-1 px-3 py-2.5 rounded-apple-md text-xs font-black whitespace-nowrap transition-all ios-tap ${y===se.id?"bg-ios-indigo text-white shadow-lg shadow-ios-indigo/20":"bg-white/50 text-ios-gray border border-gray-100"}`,children:se.name},se.id))}),v.jsxs("div",{className:"flex gap-3 h-20",children:[v.jsxs("div",{className:"flex-1 bg-white shadow-sm border border-gray-100 rounded-apple p-3 flex flex-col justify-center items-center font-black",children:[v.jsx("span",{className:"text-[10px] text-ios-blue uppercase tracking-wider mb-1",children:" "}),v.jsxs("span",{className:"text-2xl text-[#1C1C1E]",children:[Y,""]})]}),v.jsxs("div",{className:"flex-1 bg-white shadow-sm border border-gray-100 rounded-apple p-3 flex flex-col justify-center items-center font-black",children:[v.jsx("span",{className:"text-[10px] text-ios-rose uppercase tracking-wider mb-1",children:"/"}),v.jsxs("span",{className:"text-2xl text-[#1C1C1E]",children:[Z,""]})]})]})]})]})]})},O=()=>v.jsxs("div",{className:"mobile-menu-container",children:[v.jsxs("div",{className:"mobile-menu-grid",children:[v.jsxs("button",{onClick:()=>i("supervision"),className:"mobile-menu-btn",children:[v.jsx("div",{className:"mobile-menu-btn-icon bg-blue-50",children:v.jsx(W2,{className:"w-8 h-8 text-[#007AFF]"})}),v.jsx("span",{className:"mobile-menu-btn-text",children:" "})]}),v.jsxs("button",{onClick:()=>i("attendance"),className:"mobile-menu-btn",children:[v.jsx("div",{className:"mobile-menu-btn-icon bg-rose-50",children:v.jsx(qs,{className:"w-8 h-8 text-[#FF3B30]"})}),v.jsx("span",{className:"mobile-menu-btn-text",children:" "})]})]}),B&&v.jsx("div",{className:"text-center",children:v.jsxs("p",{className:"text-sm font-bold text-gray-400",children:[" ",ct(new Date,"yyyy M d")," ."]})})]}),N=()=>{const z=new Date,K=ct(z,"HH:mm:ss"),Y=g.length>0?g.reduce((he,fe)=>fe.end_time>he?fe.end_time:he,"00:00:00"):"23:59:59",Z=ct(z,"yyyy-MM-dd"),se=A<Z,V=A===Z,le=A>Z,ae=(t==null?void 0:t.role)!=="admin"&&(se||V&&K>Y),W=(t==null?void 0:t.role)!=="admin"&&le;return v.jsx("main",{className:"flex-1 flex flex-col h-full overflow-hidden",style:{padding:"0 1rem 1rem 1rem"},children:v.jsxs("div",{className:"flex-1 flex flex-col gap-4 h-full overflow-y-auto pb-6 pt-2",children:[o.map((he,fe)=>v.jsx("div",{className:"flex-1 min-h-[300px] bg-white rounded-[32px] p-6 border border-gray-100 shadow-sm flex flex-col items-center justify-center",children:v.jsxs("div",{className:"flex flex-col items-center gap-4 w-full",children:[v.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center shadow-inner",children:v.jsx(hd,{className:"w-8 h-8 text-[#8E8E93]"})}),v.jsxs("div",{className:"text-center",children:[v.jsxs("h3",{className:"text-lg font-black text-[#1C1C1E]",children:[he.supervisor_name," "]}),he.signature_url?v.jsxs("p",{className:"mt-1.5 text-xs font-bold text-emerald-500 flex items-center justify-center gap-1.5",children:[v.jsx(qs,{className:"w-4 h-4"}),"   "]}):v.jsx("p",{className:"mt-1.5 text-xs font-bold text-[#FF9500]",children:"   "})]}),!he.signature_url&&(W?v.jsx("div",{className:"w-full py-5 bg-gray-50 text-gray-400 rounded-2xl text-center border border-gray-100",children:v.jsx("p",{className:"text-sm font-bold",children:"  ."})}):ae?v.jsx("div",{className:"w-full py-5 bg-gray-50 text-gray-400 rounded-2xl text-center border border-gray-100",children:v.jsx("p",{className:"text-sm font-bold",children:"     ."})}):v.jsx("button",{onClick:()=>{f(he),d(!0)},className:"w-full py-5 bg-[#007AFF] text-white rounded-2xl text-base font-black mobile-tap-feedback shadow-lg shadow-blue-100",children:""})),he.signature_url&&v.jsx("div",{className:"w-full bg-gray-50 rounded-2xl p-4 flex items-center justify-center border border-dashed border-gray-200 min-h-[100px]",children:v.jsx("img",{src:he.signature_url,alt:"Signature",className:"max-h-16 opacity-60 object-contain"})})]})},he.id)),o.length===1&&v.jsx("div",{className:"flex-1 min-h-0 p-6 border border-transparent opacity-0 pointer-events-none"}),o.length===0&&v.jsx("div",{className:"flex-1 bg-white rounded-[32px] border border-dashed border-gray-200 text-gray-400 text-center flex items-center justify-center p-6",children:v.jsx("p",{className:"text-base font-bold",children:"    ."})})]})})},R=()=>v.jsxs("main",{className:"mobile-attendance-list",children:[v.jsx("div",{className:"mobile-zone-grid",children:["A","B","C"].map(z=>{var se;const K=`${z} zone`,Y=u.filter(V=>V.zone_name===K||V.zone_name===z||V.seat_number&&V.seat_number.startsWith(z)),Z=z==="A"?"#34C759":z==="B"?"#FF9500":"#FF3B30";return v.jsxs("div",{className:"zone-column",ref:m[z],children:[v.jsxs("div",{className:"zone-title-bar",style:{backgroundColor:((se=Y[0])==null?void 0:se.zone_color)||Z},children:[z," ZONE"]}),v.jsx("div",{className:"zone-divider"}),v.jsx("div",{className:"zone-seats-list",children:Y.map(V=>{const le=V.is_active?"tier-active":V.is_booked_today?"tier-reserved":"tier-empty",ae=V.zone_color||Z,W=V.status==="present"?"green":"red";return v.jsxs("div",{className:`mobile-grid-card ${le}`,children:[v.jsxs("div",{className:"grid-card-header",style:{backgroundColor:ae},children:[V.display_number||V.seat_number.replace(`${z}-`,""),V.is_active&&v.jsx("div",{className:`status-dot ${W}`})]}),v.jsx("div",{className:"grid-card-body",children:V.full_name?v.jsxs(v.Fragment,{children:[v.jsx("span",{className:"grid-card-student",children:V.full_name}),v.jsx("span",{className:"grid-card-id",children:V.username||" "})]}):v.jsx("span",{className:"grid-card-info text-gray-300",children:""})}),v.jsx("div",{className:"grid-card-footer",children:V.full_name?V.status==="absent"?v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"grid-status-btn status-absent-btn",children:""}),v.jsx("button",{className:"grid-action-btn",onClick:()=>P(V),style:{backgroundColor:ae},children:""})]}):v.jsxs(v.Fragment,{children:[v.jsx("div",{className:`grid-status-btn ${V.status==="present"?"status-present-active":V.status==="late"?"status-late-active":"status-early-active"}`,style:{backgroundColor:V.status==="present"?ae:void 0},children:(()=>{const he=g.find(Te=>Te.id===y),fe=ct(new Date,"HH:mm:ss");return V.status==="present"?he&&fe>he.end_time?"":"":V.status==="late"?"":""})()}),v.jsx("button",{className:"grid-action-btn subtle",onClick:()=>H(V),children:""})]}):v.jsx("div",{className:"grid-status-btn status-absent-btn opacity-20",children:"-"})})]},V.seat_id)})})]},z)})}),u.length===0&&!s&&v.jsxs("div",{className:"text-center py-12",children:[v.jsx(Pl,{className:"w-8 h-8 text-gray-200 mx-auto mb-2"}),v.jsx("p",{className:"text-xs text-gray-300 font-bold",children:"   ."})]})]});return v.jsxs("div",{className:"mobile-dashboard-container h-[100dvh] overflow-hidden flex flex-col",children:[I(),s&&v.jsx("div",{className:"flex-1 flex items-center justify-center",children:v.jsx("p",{className:"text-sm font-bold text-gray-400",children:" ..."})}),!s&&n==="menu"&&O(),!s&&n==="supervision"&&N(),!s&&n==="attendance"&&R(),!s&&n==="seatmap"&&v.jsx("div",{ref:r,className:"mobile-seatmap-container flex-1 scrollbar-hide bg-[#F2F2F7] relative overflow-auto",children:v.jsx("div",{className:"mobile-seatmap-content bg-white shadow-xl",children:v.jsx(xT,{isMobileView:!0,externalZoneId:E,externalDate:A,externalSessionId:y})})}),h&&v.jsx(XX,{teacherName:c==null?void 0:c.supervisor_name,onSave:ne,onCancel:()=>d(!1)})]})},jT=({onSelectSeat:e,selectedProxyUser:t,viewDate:r,onDateChange:n,selectedZoneId:i,onZoneChange:s,minimal:l=!1})=>{const o=ye.useRef(null),a=ye.useRef(null),[c,f]=ye.useState(null),[h,d]=ye.useState([]),[u,p]=ye.useState(!1),[m,g]=ye.useState(null),[x,y]=ye.useState([]),[w,_]=ye.useState({quarters:[],exceptions:[],operatingRules:[]});ye.useEffect(()=>{C()},[]);const C=async()=>{const{data:{user:F}}=await Xe.auth.getUser();if(F){const{data:G}=await Xe.from("profiles").select("*").eq("id",F.id).single();g(G)}const{data:L}=await Xe.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});L&&L.length>0&&(d(L),i||s(L[0].id))};ye.useEffect(()=>{if(!i)return;let F=!0;return f(null),e&&e(null),a.current&&a.current.clear(),(async()=>{const[G,X,re]=await Promise.all([Xe.from("operation_quarters").select("*"),Xe.from("operation_exceptions").select("*").eq("zone_id",i),Xe.from("sessions").select("*").eq("zone_id",i).order("start_time",{ascending:!0})]);if(F){const{data:P}=await Xe.from("session_operating_days").select("session_id, day_of_week").in("session_id",(re.data||[]).map(S=>S.id)).eq("is_active",!0),H={quarters:G.data||[],exceptions:X.data||[],operatingRules:P||[]};_(H);const U=(S,I,O,N)=>{const R=Cr(S);if(!I.some(Y=>Y.start_date&&Y.end_date&&zc(R,{start:Cr(Y.start_date),end:Cr(Y.end_date)}))||O.find(Y=>Y.exception_date===S))return!1;const K=R.getDay();return N.some(Y=>Y.day_of_week===K)};if(!U(r,H.quarters,H.exceptions,H.operatingRules)){let S=Ss(Cr(r),1),I=!1,O=0;for(;!I&&O<60;){const N=ct(S,"yyyy-MM-dd");U(N,H.quarters,H.exceptions,H.operatingRules)?(n(N),I=!0):(S=Ss(S,1),O++)}}}const Q=re.data||[];if(!F||(y(Q),!o.current))return;a.current&&a.current.dispose(),o.current.innerHTML="";const ne=document.createElement("canvas");o.current.appendChild(ne);const J=new zt.fabric.Canvas(ne,{backgroundColor:"transparent",selection:!1,hoverCursor:"pointer",moveCursor:"grab"});a.current=J,await j(J,Q),F&&(J.on("mouse:down",P=>{var H,U,S,I;J.calcOffset(),J.isDragging=!0,J.selection=!1,J.lastPosX=P.e.clientX||((U=(H=P.e.touches)==null?void 0:H[0])==null?void 0:U.clientX),J.lastPosY=P.e.clientY||((I=(S=P.e.touches)==null?void 0:S[0])==null?void 0:I.clientY)}),J.on("mouse:dblclick",P=>{if(P.target&&P.target.data){const H=P.target.data;f(H),e&&e(H),J.getObjects().forEach(S=>{if(S.type==="group"){const I=S.getObjects().find(O=>O.name==="selectionBorder");I&&I.set({strokeWidth:0}),S.set("dirty",!0)}});const U=P.target.getObjects().find(S=>S.name==="selectionBorder");U&&U.set({strokeWidth:2}),P.target.set({dirty:!0,objectCaching:!1}),J.renderAll()}else f(null),e&&e(null)}),J.on("mouse:move",P=>{var H,U,S,I;if(J.calcOffset(),J.isDragging){const O=P.e,N=O.clientX||((U=(H=O.touches)==null?void 0:H[0])==null?void 0:U.clientX),R=O.clientY||((I=(S=O.touches)==null?void 0:S[0])==null?void 0:I.clientY),z=J.viewportTransform;z[4]+=N-J.lastPosX,z[5]+=R-J.lastPosY,J.requestRenderAll(),J.lastPosX=N,J.lastPosY=R}}),J.on("mouse:wheel",P=>{var O;const H=P.e.deltaY,U=J.viewportTransform;U[5]-=H;const S=J.getHeight(),I=((O=o.current)==null?void 0:O.clientHeight)||0;U[5]>0&&(U[5]=0),I>0&&U[5]<-(S-I)&&(U[5]=-(S-I)),J.requestRenderAll(),P.e.preventDefault(),P.e.stopPropagation()}),J.on("mouse:up",()=>{J.setViewportTransform(J.viewportTransform),J.isDragging=!1,J.selection=!1}))})(),()=>{F=!1,a.current&&(a.current.dispose(),a.current=null)}},[i,m,r]),ye.useEffect(()=>{let F;const L=()=>{F&&cancelAnimationFrame(F),F=requestAnimationFrame(()=>{a.current&&a.current.calcOffset()})};return window.addEventListener("resize",L),window.addEventListener("scroll",L,!0),()=>{window.removeEventListener("resize",L),window.removeEventListener("scroll",L,!0),F&&cancelAnimationFrame(F)}},[]);const E=F=>{const L=Cr(F);if(!w.quarters.some(ne=>ne.start_date&&ne.end_date&&zc(L,{start:Cr(ne.start_date),end:Cr(ne.end_date)}))||w.exceptions.find(ne=>ne.exception_date===F))return!1;const re=L.getDay();return!!w.operatingRules.some(ne=>ne.day_of_week===re)},T=()=>{let F=Ss(Cr(r),1),L=!1,G=0;const X=180;for(;!L&&G<X;){const re=ct(F,"yyyy-MM-dd");E(re)?(n(re),L=!0):(F=Ss(F,1),G++)}},A=()=>{let F=Vv(Cr(r),1),L=!1,G=0;const X=180;for(;!L&&G<X;){const re=ct(F,"yyyy-MM-dd");E(re)?(n(re),L=!0):(F=Vv(F,1),G++)}},j=async(F,L,G)=>{var Q,ne;p(!0);const{data:X}=await Xe.from("seats").select("*").eq("zone_id",i).order("global_number",{ascending:!0});let re=[];if(L&&L.length>0){const J=L.map(H=>H.id),{data:P}=await Xe.from("bookings").select("*, profiles(username, full_name), profiles_student(username, full_name)").eq("date",r).in("session_id",J);P&&(re=P)}if(X&&X.length>0){if(!F||F.isDisposed||!F.getContext())return;F.clear();const J=Math.min(...X.map(le=>le.pos_x)),H=Math.max(...X.map(le=>le.pos_x+(le.width||72)))-J,U=((Q=o.current)==null?void 0:Q.clientWidth)||H,S=Math.max(H,U),I=Math.round((S-H)/2-J),O=Math.min(...X.map(le=>le.pos_y)),R=Math.max(...X.map(le=>le.pos_y+(le.height||72)))-O,z=Math.round(-O),K=((ne=o.current)==null?void 0:ne.clientHeight)||0,Y=Math.max(R,K);if(F.isDisposed||!F.getContext())return;F.setDimensions({width:S,height:Y});const Z=new Date,se=Z.getHours().toString().padStart(2,"0")+":"+Z.getMinutes().toString().padStart(2,"0")+":00",V=L==null?void 0:L.find(le=>se>=le.start_time&&se<=le.end_time);if(X.forEach(le=>{const ae=(re==null?void 0:re.filter(W=>W.seat_id===le.id))||[];B(F,{...le,pos_x:le.pos_x+I,pos_y:le.pos_y+z},ae,V,L)}),H>U){const le=F.viewportTransform;le[4]=(U-H)/2,F.setViewportTransform(le),F.requestRenderAll()}}p(!1)},B=(F,L,G,X,re)=>{if(L.type==="structure"){const V=new zt.fabric.Rect({fill:L.bg_color||"#E5E5EA",width:L.width||72,height:L.height||72,stroke:L.stroke_color||"#D1D1D6",strokeWidth:1}),le=new zt.fabric.IText(L.label||"",{fontSize:L.font_size||10,originX:"center",originY:"center",left:(L.width||72)/2,top:(L.height||72)/2,fill:L.text_color||"#AEAEB2",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter',fontWeight:"bold",selectable:!1}),ae=new zt.fabric.Group([V,le],{left:L.pos_x,top:L.pos_y,originX:"left",originY:"top",angle:L.rotation,selectable:!1,evented:!1,data:{...L}});F.add(ae);return}const ne=!!G.find(V=>V.session_id===(X==null?void 0:X.id)),J=G.length>0,P=V=>m?!!(["admin","teacher"].includes(m.role)||V.user_id===m.id):!1,H=L.zone_color||"#5E5CE6",U=new zt.fabric.Rect({fill:H,opacity:ne?.8:J?.12:.03,width:72,height:72,rx:12,ry:12,strokeWidth:0,left:0,top:0,originX:"left",originY:"top",selectable:!1}),S="M 0 12 Q 0 0 12 0 L 60 0 Q 72 0 72 12 L 72 18 L 0 18 z",I=new zt.fabric.Path(S,{fill:H,opacity:ne?1:J?.45:.18,strokeWidth:0,left:0,top:0,originX:"left",originY:"top",selectable:!1}),O=new zt.fabric.IText(L.display_number||L.seat_number,{fontSize:11,left:6,top:4,originX:"left",originY:"top",fill:ne?"#ffffff":H,fontFamily:"Inter, -apple-system",fontWeight:"900",selectable:!1}),N={Morning:"",Dinner:"","1st Period":"1 ","2nd Period":"2 ",period1:"1 ",period2:"2 "},R=V=>{if(N[V])return N[V];const le=V.match(/(\d+)/);return le?`${le[1]} `:V.substring(0,2)},z=[...re||[]].sort((V,le)=>V.id-le.id),K=z.length>4;let Y=[];if(K){const V=Math.ceil(z.length/2),le=z.slice(0,V),ae=z.slice(V),W=Te=>Te.map(be=>{const pe=G.find(ce=>ce.session_id===be.id),xe=R(be.name);if(!pe)return`${xe}:`;if(P(pe)){const ce=pe.profiles_student||pe.profiles;return`${xe}:${(ce==null?void 0:ce.full_name.substring(0,4))||""}`}else return`${xe}:()`}).join(`
`),he=new zt.fabric.Text(W(le),{fontSize:5.5,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:ne?"#ffffff":"#000000",left:4,top:20,lineHeight:1.35,selectable:!1}),fe=new zt.fabric.Text(W(ae),{fontSize:5.5,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:ne?"#ffffff":"#000000",left:38,top:20,lineHeight:1.35,selectable:!1});Y=[he,fe]}else z.forEach((V,le)=>{const ae=G.find(xe=>xe.session_id===V.id),W=R(V.name),he=21+le*13,fe=new zt.fabric.Text(W,{fontSize:8,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:ne?"#ffffff":"#000000",left:4,top:he+.5,originX:"left",originY:"top",selectable:!1});Y.push(fe);const Te=new zt.fabric.Line([17,he,17,he+10],{stroke:ne?"rgba(255,255,255,0.3)":"rgba(0,0,0,0.1)",strokeWidth:.5,originX:"left",originY:"top",selectable:!1});Y.push(Te);let be="";if(ae)if(P(ae)){const xe=ae.profiles_student||ae.profiles,ce=(xe==null?void 0:xe.username)||"",Ne=(xe==null?void 0:xe.full_name)||"";be=ce?`${ce} ${Ne}`:Ne}else be="()";const pe=new zt.fabric.Text(be,{fontSize:8,fontFamily:"NanumSquareRound, Inter, sans-serif",fontWeight:"normal",fill:ne?"#ffffff":"#000000",left:23,top:he,originX:"left",originY:"top",selectable:!1});if(Y.push(pe),le<z.length-1){const xe=new zt.fabric.Line([4,he+11.5,68,he+11.5],{stroke:ne?"rgba(255,255,255,0.2)":"rgba(0,0,0,0.08)",strokeWidth:.5,originX:"left",originY:"top",selectable:!1});Y.push(xe)}});const Z=new zt.fabric.Rect({width:76,height:76,rx:14,ry:14,fill:"transparent",stroke:H,strokeWidth:0,left:-2,top:-2,originX:"left",originY:"top",selectable:!1,name:"selectionBorder",strokeUniform:!0}),se=new zt.fabric.Group([U,I,O,...Y,Z],{left:L.pos_x,top:L.pos_y,originX:"left",originY:"top",angle:L.rotation,data:{...L,seatBookings:G,activeSession:X},selectable:!1,hoverCursor:"pointer"});F.add(se)};return v.jsxs("div",{className:"flex flex-col gap-4 w-full h-full relative overflow-hidden",children:[!l&&v.jsxs("div",{className:"flex items-center gap-4 px-1",children:[v.jsx("div",{className:"flex gap-[10px] m-[10px] mb-0 border-none shrink-0 p-1 rounded-apple-md backdrop-blur-xl",children:h.map(F=>v.jsx("button",{onClick:()=>s(F.id),className:`px-6 py-2 rounded-apple-md text-xs font-black transition-all ios-tap border-none ${i===F.id?"bg-[#1C1C1E] text-white shadow-sm":"text-gray-400 hover:text-[#1C1C1E] hover:bg-gray-100"}`,children:F.name},F.id))}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(t3,{className:"w-4 h-4 text-ios-indigo"}),v.jsxs("span",{className:"text-xs font-black text-ios-indigo",children:["    ",v.jsx("span",{className:"text-ios-rose",children:" "})," ."]})]}),v.jsxs("div",{className:"flex bg-gray-200/20 p-1 rounded-apple-md border border-white/40 backdrop-blur-xl items-center gap-1 ml-auto",children:[v.jsx("button",{onClick:A,className:"p-1.5 hover:bg-white rounded-apple-md transition-all text-ios-gray hover:text-[#1C1C1E] ios-tap",children:v.jsx(jo,{className:"w-4 h-4"})}),v.jsxs("div",{className:"relative group px-3 flex items-center gap-2 cursor-pointer",children:[v.jsx(Vc,{className:"w-3.5 h-3.5 text-ios-indigo"}),v.jsx("span",{className:"text-[13px] font-black text-[#1C1C1E] whitespace-nowrap",children:ct(Cr(r),"MM.dd (EEE)",{locale:Qn})}),v.jsx("input",{type:"date",value:r,onChange:F=>n(F.target.value),className:"absolute inset-0 opacity-0 cursor-pointer"})]}),v.jsx("button",{onClick:T,className:"p-1.5 hover:bg-white rounded-apple-md transition-all text-ios-gray hover:text-[#1C1C1E] ios-tap",children:v.jsx(Cs,{className:"w-4 h-4"})})]})]}),u&&v.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-30 flex items-center justify-center",children:v.jsx("div",{className:"w-8 h-8 border-3 border-ios-indigo border-t-transparent rounded-full animate-spin"})}),v.jsx("div",{ref:o,className:"flex-1 h-full relative overflow-hidden cursor-grab active:cursor-grabbing touch-none select-none scrollbar-hide"})]})},DT=({isOpen:e,onClose:t,zoneId:r,onSelect:n,selectedDate:i})=>{const[s,l]=ye.useState(!0);if(ye.useEffect(()=>{e&&l(!0)},[e]),!e)return null;const o=ct(i||new Date,"yyyy-MM-dd");return v.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:[v.jsxs("div",{className:"bg-white w-full h-[80vh] rounded-3xl overflow-hidden flex flex-col shadow-2xl relative",children:[v.jsx("button",{onClick:t,className:"absolute top-4 right-4 z-50 p-2 bg-white/90 backdrop-blur rounded-full shadow-lg text-black hover:bg-gray-100 transition-all border border-gray-100",children:v.jsx(Tl,{className:"w-6 h-6"})}),v.jsx("div",{className:"flex-1 bg-gray-50 relative overflow-hidden",children:v.jsx(jT,{viewDate:o,selectedZoneId:r,onDateChange:()=>{},onZoneChange:()=>{},isReadOnly:!0,minimal:!0,onSelectSeat:n})})]}),s&&v.jsx("div",{className:"absolute inset-0 z-[10000] flex items-center justify-center p-6 animate-fade-in",onClick:()=>l(!1),children:v.jsxs("div",{className:"bg-white/95 backdrop-blur-md rounded-2xl p-6 shadow-2xl max-w-xs w-full text-center border border-gray-100 transform transition-all scale-100 relative overflow-hidden",onClick:a=>a.stopPropagation(),children:[v.jsx("div",{className:"mb-4 flex justify-center",children:v.jsx("div",{className:"w-12 h-12 rounded-full bg-ios-indigo/10 flex items-center justify-center",children:v.jsx("span",{className:"text-2xl",children:""})})}),v.jsx("h3",{className:"text-lg font-black text-gray-900 mb-2",children:"  "}),v.jsxs("p",{className:"text-gray-600 text-[15px] font-medium leading-relaxed break-keep mb-6",children:["  ",v.jsx("br",{}),v.jsx("span",{className:"text-[#FF3B30] font-black text-lg",children:" (  )"}),v.jsx("br",{})," ."]}),v.jsx("button",{onClick:()=>l(!1),className:"w-full py-3.5 bg-[#1C1C1E] text-white rounded-xl font-bold text-sm hover:bg-gray-800 active:scale-95 transition-all shadow-lg shadow-gray-200",children:""})]})})]})},KX=({onCancel:e,onSuccess:t,currentUser:r})=>{const[n,i]=ye.useState(0),[s,l]=ye.useState(!1),[o,a]=ye.useState([]),[c,f]=ye.useState([]),[h,d]=ye.useState([]),[u,p]=ye.useState({}),[m,g]=ye.useState(null),[x,y]=ye.useState([]),[w,_]=ye.useState(null),[C,E]=ye.useState(""),[T,A]=ye.useState("A"),[j,B]=ye.useState(""),[F,L]=ye.useState(null),[G,X]=ye.useState({}),re=pe=>{if(!pe)return"";const xe=pe.seat_number.toString(),ce=pe.zone_name||"";return ce&&xe.startsWith(`${ce}-`)?xe.replace(`${ce}-`,""):ce&&xe.startsWith(ce)?xe.replace(ce,""):xe},[Q,ne]=ye.useState([]),[J,P]=ye.useState([]),[H,U]=ye.useState([]),[S,I]=ye.useState(!1);ye.useEffect(()=>{(async()=>{l(!0);try{const{data:xe}=await Xe.from("operation_quarters").select("*").order("start_date");a(xe||[]);const{data:ce}=await Xe.from("zones").select("*").order("created_at");d(ce||[]);let Ne=null;ce&&ce.length>0&&(Ne=ce[0].id,_(Ne))}catch(xe){console.error("Error fetching wizard configs:",xe)}finally{l(!1)}})()},[]),ye.useEffect(()=>{if(!w)return;(async()=>{l(!0);try{const[xe,ce,Ne]=await Promise.all([Xe.from("sessions").select("*").eq("zone_id",w).order("start_time"),Xe.from("operation_exceptions").select("*").eq("zone_id",w),Xe.from("seats").select("*").eq("zone_id",w).order("global_number")]);f(xe.data||[]),P(ce.data||[]),U(Ne.data||[]);const{data:Ie}=await Xe.from("session_operating_days").select("session_id, day_of_week").in("session_id",(xe.data||[]).map(De=>De.id)).eq("is_active",!0);ne(Ie||[]);const Re=Ne.data||[];if(Re.length>0){const De=Re[0].zone_name||"";A(De)}y([]),E("")}catch(xe){console.error("Error fetching zone data:",xe)}finally{l(!1)}})()},[w]),ye.useEffect(()=>{if(!r)return;(async()=>{try{const{data:xe}=await Xe.from("bookings").select(`
                    *,
                    sessions (id, name, start_time, end_time),
                    seats (id, seat_number, zone_name, zone_id, zones(name)),
                    attendance (
                        status
                    )
                `).or(`student_id.eq.${r.id},user_id.eq.${r.id}`);if(xe){const ce={},Ne={},Ie=ct(new Date,"yyyy-MM-dd");xe.forEach(Re=>{const De=Re.date;Ne[De]||(Ne[De]=[]),Ne[De].push(Re);const Me=Re.attendance&&Re.attendance[0];let Ge="reserved";De<Ie?Me?Me.status==="present"?Ge="present":Me.status==="late"?Ge="late":Ge="absent":Ge="absent":De===Ie&&Me&&(Me.status==="present"?Ge="present":Me.status==="late"&&(Ge="late")),(!ce[De]||Ge==="present"&&ce[De]!=="present"||Ge==="late"&&ce[De]==="absent")&&(ce[De]=Ge)}),p(ce),X(Ne)}}catch(xe){console.error("Error fetching user activities:",xe)}})()},[r]);const O=pe=>{const xe=Ga(new Date),ce=Ga(pe),Ne=Ss(xe,2);if(qh(ce,Ne))return!1;const Ie=o.find(Ue=>{const Ye=Cr(Ue.start_date),nt=Cr(Ue.end_date);return(Nl(ce,Ye)||Hv(ce,Ye))&&(Nl(ce,nt)||qh(ce,nt))});if(!Ie)return!1;const Re=Cr(Ie.start_date),De=Vv(Re,7);if(qh(xe,De))return!1;const Me=ct(ce,"yyyy-MM-dd"),Ge=J.find(Ue=>Ue.exception_date===Me);if(Ge&&Ge.is_closed)return!1;const Ae=ce.getDay();return!!Q.some(Ue=>Ue.day_of_week===Ae)},[N,R]=ye.useState(new Date),z=()=>R(pe=>g1(pe)),K=()=>R(pe=>Qd(pe,1)),Y=()=>{const pe=Ga(new Date(N.getFullYear(),N.getMonth(),1)),xe=new Date(N.getFullYear(),N.getMonth()+1,0),Ne=Ga(pe).getDay(),Ie=Array(Ne).fill(null),Re=[];for(let Me=1;Me<=xe.getDate();Me++)Re.push(new Date(N.getFullYear(),N.getMonth(),Me));const De=[...Ie,...Re];return v.jsxs("div",{className:"space-y-4 animate-fade-in",children:[v.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:" "}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"  ."}),v.jsxs("div",{className:"flex items-center justify-between bg-white rounded-2xl p-2 shadow-sm border border-gray-100 mb-4",children:[v.jsx("button",{onClick:z,className:"p-2 hover:bg-gray-100 rounded-full text-ios-gray hover:text-black transition-colors",children:v.jsx(jo,{className:"w-5 h-5"})}),v.jsx("span",{className:"text-base font-black text-[#1C1C1E]",children:ct(N,"yyyy M")}),v.jsx("button",{onClick:K,className:"p-2 hover:bg-gray-100 rounded-full text-ios-gray hover:text-black transition-colors",children:v.jsx(Cs,{className:"w-5 h-5"})})]}),v.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["","","","","","",""].map(Me=>v.jsx("div",{className:"text-center text-xs font-bold text-gray-400 py-2",children:Me},Me)),De.map((Me,Ge)=>{if(!Me)return v.jsx("div",{},`empty-${Ge}`);const Ae=O(Me),Pe=m&&Nl(Me,m),Ue=ct(Me,"yyyy-MM-dd"),Ye=u[Ue];return v.jsx("button",{disabled:!Ae&&!Ye,onClick:()=>{Ye?L(Me):Ae&&g(Me)},className:`
                                aspect-square rounded-xl flex flex-col items-center justify-center text-sm font-bold transition-all relative
                                ${Pe?"bg-[#1C1C1E] text-white shadow-xl scale-105 z-10":Ye==="present"?"bg-ios-emerald text-white border-none":Ye==="late"?"bg-ios-amber text-white border-none":Ye==="absent"?"bg-ios-rose text-white border-none":Ye==="reserved"?"bg-ios-indigo text-white border-none":Ae?"bg-white text-[#1C1C1E] border border-gray-100 hover:border-gray-300":"bg-transparent text-gray-400 cursor-not-allowed"}
                            `,children:v.jsx("span",{className:!Ae&&!Ye?"opacity-50":"",children:ct(Me,"d")})},Ge)})]}),v.jsx("div",{className:"mt-6 pt-4 border-t border-gray-100",children:v.jsxs("div",{className:"flex flex-col gap-3",children:[v.jsx("span",{className:"text-[11px] font-black text-ios-gray uppercase tracking-[0.2em]",children:" "}),v.jsx("div",{className:"flex flex-wrap gap-4",children:[{label:"",color:"bg-ios-emerald"},{label:"",color:"bg-ios-amber"},{label:"",color:"bg-ios-rose"},{label:"",color:"bg-ios-indigo"}].map(Me=>v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:`w-2 h-2 rounded-full ${Me.color}`}),v.jsx("span",{className:"text-[10px] font-bold text-gray-400",children:Me.label})]},Me.label))})]})})]})},Z=()=>{if(!F)return null;const pe=ct(F,"yyyy-MM-dd"),xe=G[pe]||[],ce=O(F);xe.sort((Re,De)=>{var Me,Ge;return(((Me=Re.sessions)==null?void 0:Me.start_time)||"").localeCompare(((Ge=De.sessions)==null?void 0:Ge.start_time)||"")});const Ne=async()=>{if(confirm("   ?")){l(!0);try{const Re=xe.map(Ge=>Ge.id),{error:De}=await Xe.from("bookings").delete().in("id",Re);if(De)throw De;alert(" ."),L(null);const{data:Me}=await Xe.from("bookings").select(`
                    *,
                    sessions (id, name, start_time, end_time),
                    seats (id, seat_number, zone_name, zone_id, zones(name)),
                    attendance (status)
                `).or(`student_id.eq.${r.id},user_id.eq.${r.id}`);if(Me){const Ge={},Ae={},Pe=ct(new Date,"yyyy-MM-dd");Me.forEach(Ue=>{const Ye=Ue.date;Ae[Ye]||(Ae[Ye]=[]),Ae[Ye].push(Ue);const nt=Ue.attendance&&Ue.attendance[0];let Qe="reserved";Ye<Pe?nt?Qe=nt.status==="present"?"present":nt.status==="late"?"late":"absent":Qe="absent":Ye===Pe&&nt&&(Qe=nt.status==="present"?"present":nt.status==="late"?"late":"reserved"),(!Ge[Ye]||Qe==="present"&&Ge[Ye]!=="present"||Qe==="late"&&Ge[Ye]==="absent")&&(Ge[Ye]=Qe)}),p(Ge),X(Ae)}}catch(Re){console.error("Delete failed:",Re),alert("    .")}finally{l(!1)}}},Ie=async()=>{if(confirm(" ?   ,   .")){l(!0);try{const Re=xe.map(Me=>Me.id),{error:De}=await Xe.from("bookings").delete().in("id",Re);if(De)throw De;g(F),y([]),_(null),E(""),B(""),L(null),i(1)}catch(Re){console.error("Modify failed:",Re),alert("     .")}finally{l(!1)}}};return v.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",children:v.jsx("div",{className:"bg-white w-full max-w-sm rounded-3xl overflow-hidden shadow-2xl relative",children:v.jsxs("div",{className:"p-6",children:[v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsxs("h3",{className:"text-xl font-black text-[#1C1C1E]",children:[ct(F,"M d"),"  "]}),v.jsx("button",{onClick:()=>L(null),className:"p-2 -mr-2 text-gray-400 hover:text-black",children:v.jsx(Tl,{className:"w-5 h-5"})})]}),v.jsx("div",{className:"space-y-4 mb-8 max-h-[50vh] overflow-y-auto scrollbar-hide",children:xe.length>0?xe.map((Re,De)=>{var Me,Ge,Ae,Pe,Ue,Ye;return v.jsxs("div",{className:"p-4 bg-gray-50 rounded-2xl flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("p",{className:"text-sm font-black text-[#1C1C1E] mb-1",children:(Me=Re.sessions)==null?void 0:Me.name}),v.jsxs("p",{className:"text-xs text-ios-gray font-bold",children:[(Ge=Re.sessions)==null?void 0:Ge.start_time.slice(0,5)," ~ ",(Ae=Re.sessions)==null?void 0:Ae.end_time.slice(0,5)]})]}),v.jsxs("div",{className:"text-right",children:[v.jsx("p",{className:"text-xs font-bold text-[#1C1C1E]",children:(Ue=(Pe=Re.seats)==null?void 0:Pe.zones)==null?void 0:Ue.name}),v.jsxs("p",{className:"text-xs text-ios-indigo font-bold",children:[(Ye=Re.seats)==null?void 0:Ye.seat_number,""]})]})]},De)}):v.jsx("p",{className:"text-center text-gray-400 text-sm",children:"  ."})}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{onClick:Ne,disabled:!ce||s,className:`flex-1 py-3 rounded-xl font-bold text-sm border-2 border-red-100 text-red-500 bg-red-50 hover:bg-red-100 transition-colors
                                  ${!ce||s?"opacity-50 cursor-not-allowed":""}
                              `,children:" "}),v.jsx("button",{onClick:Ie,disabled:!ce||s,className:`flex-1 py-3 rounded-xl font-bold text-sm bg-ios-indigo text-white hover:bg-ios-indigo/90 transition-colors shadow-lg shadow-ios-indigo/30
                                  ${!ce||s?"opacity-50 cursor-not-allowed shadow-none":""}
                              `,children:""})]}),!ce&&v.jsx("p",{className:"text-[10px] text-center text-gray-400 font-medium mt-3",children:"*   2      / ."})]})})})},se=()=>{const pe=xe=>{x.includes(xe)?y(x.filter(ce=>ce!==xe)):y([...x,xe])};return v.jsxs("div",{className:"space-y-4 animate-fade-in",children:[v.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:" "}),v.jsxs("p",{className:"text-sm font-bold text-ios-gray",children:["   .",v.jsx("br",{}),"(  )"]}),v.jsx("div",{className:"space-y-3 mt-4",children:c.filter(xe=>{if(!m)return!1;const ce=m.getDay();return Q.some(Ne=>Ne.session_id===xe.id&&Ne.day_of_week===ce)}).map(xe=>{const ce=x.includes(xe.id);return v.jsxs("button",{onClick:()=>pe(xe.id),className:`w-full p-4 rounded-2xl border-2 transition-all flex items-center justify-between group text-left ios-tap
                                ${ce?"border-ios-indigo bg-ios-indigo/5":"border-white bg-white shadow-sm"}
                            `,children:[v.jsxs("div",{children:[v.jsx("h4",{className:`text-base font-black ${ce?"text-ios-indigo":"text-[#1C1C1E]"}`,children:xe.name}),v.jsxs("p",{className:"text-xs font-bold text-ios-gray mt-1",children:[xe.start_time.slice(0,5)," ~ ",xe.end_time.slice(0,5)]})]}),v.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors
                                ${ce?"border-ios-indigo bg-ios-indigo text-white":"border-gray-200 bg-gray-50"}
                            `,children:ce&&v.jsx(El,{className:"w-4 h-4"})})]},xe.id)})})]})},V=()=>v.jsxs("div",{className:"space-y-4 animate-fade-in",children:[v.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:"  "}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:" (Zone) ."}),v.jsx("div",{className:"space-y-3 mt-4",children:h.map(pe=>{const xe=w===pe.id;return v.jsxs("button",{onClick:()=>_(pe.id),className:`w-full p-5 rounded-2xl border-2 transition-all flex items-center justify-between text-left ios-tap
                                ${xe?"border-ios-indigo bg-ios-indigo/5":"border-white bg-white shadow-sm"}
                            `,children:[v.jsx("span",{className:`text-lg font-black ${xe?"text-ios-indigo":"text-[#1C1C1E]"}`,children:pe.name}),xe&&v.jsx("div",{className:"text-xs font-bold text-ios-indigo bg-ios-indigo/10 px-2 py-1 rounded",children:""})]},pe.id)})})]}),le=()=>{var Re,De;const xe=(()=>{if(!H||H.length===0)return[];const Me=new Set;return H.forEach(Ge=>{Me.add(Ge.zone_name||"")}),Array.from(Me).sort()})(),ce=Me=>{if(xe.length===0)return;let Ge=xe.indexOf(T);Ge===-1&&(Ge=0);let Ae;Me==="up"?Ae=(Ge+1)%xe.length:Ae=(Ge-1+xe.length)%xe.length;const Pe=xe[Ae];A(Pe);const Ue=H.find(Ye=>(Ye.zone_name||"")===Pe);E(Ue?re(Ue):"")},Ne=Me=>{if(!H||H.length===0)return;const Ge=T||xe[0],Ae=H.filter(Qe=>(Qe.zone_name||"")===Ge);if(Ae.length===0)return;const Pe=[...Ae].sort((Qe,ht)=>{const it=parseInt(Qe.seat_number.toString().replace(/\D/g,""))||0,dt=parseInt(ht.seat_number.toString().replace(/\D/g,""))||0;return it-dt}),Ue=Pe.find(Qe=>re(Qe)===C.toString());let Ye=0;if(Ue){const Qe=Pe.indexOf(Ue);Me==="up"?Ye=(Qe+1)%Pe.length:Ye=(Qe-1+Pe.length)%Pe.length}else Ye=0;const nt=Pe[Ye];E(re(nt))},Ie=T||(xe.length>0?xe[0]:"-");return v.jsxs("div",{className:"space-y-4 animate-fade-in",children:[v.jsxs("h3",{className:"text-xl font-black text-[#1C1C1E]",children:[(Re=h.find(Me=>Me.id===w))==null?void 0:Re.name,"  "]}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"(Section)    ."}),v.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-gray-100 mt-4",children:[v.jsxs("div",{className:"flex gap-4",children:[v.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2",children:[v.jsx("label",{className:"text-xs font-black text-ios-gray uppercase tracking-widest",children:" (Section)"}),v.jsx("button",{onClick:()=>ce("up"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:v.jsx(R_,{className:"w-6 h-6"})}),v.jsx("div",{className:"h-16 flex items-center justify-center",children:v.jsx("span",{className:"text-5xl font-black text-[#1C1C1E] text-center leading-tight",children:Ie})}),v.jsx("button",{onClick:()=>ce("down"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:v.jsx(I_,{className:"w-6 h-6"})})]}),v.jsx("div",{className:"w-px bg-gray-100 my-4"}),v.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2",children:[v.jsx("label",{className:"text-xs font-black text-ios-gray uppercase tracking-widest",children:" (No.)"}),v.jsx("button",{onClick:()=>Ne("up"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:v.jsx(R_,{className:"w-6 h-6"})}),v.jsx("div",{className:"h-16 flex items-center justify-center w-full",children:v.jsx("input",{type:"text",value:C,onChange:Me=>E(Me.target.value),placeholder:"-",className:"w-full text-5xl font-black text-center border-none focus:ring-0 outline-none bg-transparent text-[#1C1C1E] p-0"})}),v.jsx("button",{onClick:()=>Ne("down"),className:"p-2 text-gray-400 hover:text-ios-indigo transition-colors",children:v.jsx(I_,{className:"w-6 h-6"})})]})]}),v.jsx("div",{className:"border-t border-gray-100 pt-6 mt-2",children:v.jsxs("button",{onClick:()=>I(!0),className:"w-full py-4 rounded-xl bg-gray-50 hover:bg-gray-100 text-[#1C1C1E] font-bold text-sm flex items-center justify-center gap-2 transition-all border border-gray-200",children:[v.jsx(jc,{className:"w-4 h-4"}),"  "]})})]}),C&&v.jsxs("div",{className:"flex items-center gap-2 justify-center text-ios-indigo text-xs font-bold animate-fade-in",children:[v.jsx(El,{className:"w-3 h-3"}),(De=h.find(Me=>Me.id===w))==null?void 0:De.name," ",Ie!==""?`${Ie}`:""," - ",C,""]})]})},ae=()=>v.jsxs("div",{className:"space-y-4 animate-fade-in",children:[v.jsx("h3",{className:"text-xl font-black text-[#1C1C1E]",children:" "}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"       ."}),v.jsx("textarea",{value:j,onChange:pe=>B(pe.target.value),placeholder:":   2 ,   50  ",className:"w-full h-48 bg-white border border-gray-200 rounded-2xl p-5 text-base font-medium resize-none focus:ring-2 focus:ring-ios-indigo/20 outline-none transition-all shadow-sm"})]}),W=()=>{var Ne;const pe=m?ct(m,"M d (EEE)",{locale:Qn}):"",xe=(Ne=h.find(Ie=>Ie.id===w))==null?void 0:Ne.name,ce=c.filter(Ie=>x.includes(Ie.id)).map(Ie=>Ie.name).join(", ");return v.jsxs("div",{className:"space-y-6 animate-fade-in",children:[v.jsx("h3",{className:"text-xl font-black text-[#1C1C1E] text-center",children:"  "}),v.jsx("div",{className:"bg-white rounded-3xl shadow-[0_4px_20px_rgba(0,0,0,0.03)] border border-gray-100 overflow-hidden",children:v.jsxs("div",{className:"p-6 space-y-6",children:[v.jsxs("div",{className:"flex items-start gap-4",children:[v.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-indigo/10 flex items-center justify-center shrink-0",children:v.jsx(Vc,{className:"w-5 h-5 text-ios-indigo"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-xs font-bold text-ios-gray",children:""}),v.jsx("p",{className:"text-lg font-black text-[#1C1C1E]",children:pe})]})]}),v.jsxs("div",{className:"flex items-start gap-4",children:[v.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-rose/10 flex items-center justify-center shrink-0",children:v.jsx(Pl,{className:"w-5 h-5 text-ios-rose"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-xs font-bold text-ios-gray",children:""}),v.jsx("p",{className:"text-lg font-black text-[#1C1C1E]",children:ce})]})]}),v.jsxs("div",{className:"flex items-start gap-4",children:[v.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-emerald/10 flex items-center justify-center shrink-0",children:v.jsx(jc,{className:"w-5 h-5 text-ios-emerald"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-xs font-bold text-ios-gray",children:""}),v.jsx("p",{className:"text-lg font-black text-[#1C1C1E]",children:xe}),v.jsxs("p",{className:"text-base font-bold text-ios-indigo mt-0.5",children:[C," "]})]})]}),v.jsxs("div",{className:"flex items-start gap-4 border-t border-gray-50 pt-4",children:[v.jsx("div",{className:"w-10 h-10 rounded-full bg-ios-amber/10 flex items-center justify-center shrink-0",children:v.jsx(U2,{className:"w-5 h-5 text-ios-amber"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-xs font-bold text-ios-gray",children:" "}),v.jsx("p",{className:"text-sm font-medium text-[#1C1C1E] leading-relaxed line-clamp-3",children:j||" "})]})]})]})}),v.jsx("div",{className:"text-center",children:v.jsx("p",{className:"text-xs text-red-400 font-bold mb-2",children:"*      ."})})]})},he=()=>{switch(n){case 0:return!!m;case 1:return!!w;case 2:return!!C;case 3:return x.length>0;case 4:return!!j.trim();default:return!0}},fe=()=>{n<5&&he()&&i(pe=>pe+1)},Te=()=>{n>0?i(pe=>pe-1):e()},be=async()=>{var pe;if(!s){l(!0);try{const xe=ct(m,"yyyy-MM-dd");let ce=null;if(H&&H.length>0){const Me=H.find(Ge=>{const Ae=Ge.zone_name||"",Pe=re(Ge);return Ae===T&&Pe===C.toString()});Me&&(ce=Me.id)}if(!ce){alert("    .   ."),l(!1);return}const Ne=x.map(Me=>{const Ge=r.role==="student";return{user_id:Ge?null:r.id,student_id:Ge?r.id:null,seat_id:ce,date:xe,session_id:Me,booking_type:"regular"}}),{error:Ie}=await Xe.from("bookings").insert(Ne);if(Ie)throw console.error("Booking failed:",Ie),Ie.code==="23505"||Ie.code==="23503"||(pe=Ie.message)!=null&&pe.includes("duplicate")?new Error("       .    ."):Ie;const Re=x.map(Me=>{const Ge=r.role==="student";return{user_id:Ge?null:r.id,student_id:Ge?r.id:null,date:xe,session_id:Me,content:j}}),{error:De}=await Xe.from("study_plans").insert(Re);De&&console.error("Study plan insert failed:",De),alert("  !"),t()}catch(xe){console.error("Final Booking Error:",xe);const ce=xe.message||"    .";alert(`  .    .

: `+ce)}finally{l(!1)}}};return v.jsxs("div",{className:"flex flex-col h-full bg-[#F2F2F7]",children:[v.jsxs("div",{className:"flex-none px-6 py-4 flex items-center justify-between bg-white/80 backdrop-blur border-b border-gray-200",children:[v.jsx("button",{onClick:Te,className:"p-2 -ml-2 rounded-full hover:bg-gray-100 text-ios-gray hover:text-[#1C1C1E] transition-colors",children:v.jsx(jo,{className:"w-6 h-6"})}),v.jsxs("span",{className:"text-base font-black text-[#1C1C1E]",children:[" (",n+1,"/6)"]}),v.jsx("div",{className:"w-10"})," "]}),v.jsx("div",{className:"flex-1 overflow-y-auto p-6 pb-32",children:v.jsxs("div",{className:"max-w-md mx-auto",children:[n===0&&Y(),n===1&&V(),n===2&&le(),n===3&&se(),n===4&&ae(),n===5&&W()]})}),v.jsx("div",{className:"flex-none p-6 bg-white border-t border-gray-100 pb-[max(1.5rem,env(safe-area-inset-bottom))]",children:v.jsx("button",{onClick:n===5?be:fe,disabled:!he()||s,className:`w-full py-4 rounded-2xl font-black text-base flex items-center justify-center gap-2 transition-all shadow-lg ios-tap
                    ${he()&&!s?"bg-[#1C1C1E] text-white hover:bg-gray-800":"bg-gray-200 text-gray-400 cursor-not-allowed shadow-none"}
                `,children:s?v.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):n===5?v.jsxs(v.Fragment,{children:[v.jsx(El,{className:"w-5 h-5"}),"  "]}):v.jsxs(v.Fragment,{children:["  ",v.jsx(Cs,{className:"w-5 h-5"})]})})}),v.jsx(DT,{isOpen:S,zoneId:w,selectedDate:m,onClose:()=>I(!1),onSelect:pe=>{if(pe){const xe=pe.zone_name||"";A(xe);const ce=re(pe);E(ce),I(!1)}}}),Z()]})},LT=({user:e})=>{const[t,r]=ye.useState("idle"),[n,i]=ye.useState(""),[s,l]=ye.useState(null),[o,a]=ye.useState(!0),[c,f]=ye.useState(new Date),h=()=>{const g=new Date,x=9*60*60*1e3;return new Date(g.getTime()+x).toISOString().replace("Z","+09:00")},d=ye.useCallback(g=>{const x=new Date,y=ct(x,"yyyy-MM-dd");return g.find(w=>{const _=ph(`${y} ${w.start_time}`,"yyyy-MM-dd HH:mm:ss",new Date),C=IS(_),E=kh(_,30);return Hv(x,C)&&qh(x,E)})},[]);ye.useEffect(()=>{const g=async()=>{a(!0);const{data:y}=await Xe.from("sessions").select("*");if(y){const w=d(y);l(w)}a(!1)};g();const x=setInterval(()=>{f(new Date),g()},3e4);return()=>clearInterval(x)},[d]);const u=async()=>{if(s){if(r("locating"),i("  ..."),!navigator.geolocation){r("error"),i("     .");return}navigator.geolocation.getCurrentPosition(async g=>{const{latitude:x,longitude:y,accuracy:w}=g.coords,{data:_}=await Xe.from("configs").select("value").eq("key","gps_settings").single(),C=(_==null?void 0:_.value)||{},E=C.points||[{lat:C.lat||37.5665,lng:C.lng||126.978,name:" "}],T=C.radius||100;let A=!1,j=1/0;const B=6371e3;if(E.forEach(F=>{const L=x*Math.PI/180,G=F.lat*Math.PI/180,X=(F.lat-x)*Math.PI/180,re=(F.lng-y)*Math.PI/180,Q=Math.sin(X/2)*Math.sin(X/2)+Math.cos(L)*Math.cos(G)*Math.sin(re/2)*Math.sin(re/2),ne=2*Math.atan2(Math.sqrt(Q),Math.sqrt(1-Q)),J=B*ne;J<j&&(j=J),J<=T&&(A=!0)}),A){r("verified");try{const F=ct(new Date,"yyyy-MM-dd"),{data:L,error:G}=await Xe.from("bookings").select("id").eq("user_id",e.id).eq("date",F).eq("session_id",s.id).maybeSingle();if(G||!L){i(` '${s.name}'   .`),r("error");return}const X=ph(`${F} ${s.start_time}`,"yyyy-MM-dd HH:mm:ss",new Date),re=kh(X,10),ne=Hv(new Date,re)?"late":"present",J=h(),{error:P}=await Xe.from("attendance").upsert({booking_id:L.id,status:ne,timestamp_in:J,updated_at:new Date().toISOString()},{onConflict:"booking_id"});if(P)throw P;i(`'${s.name}'   ! (${ne==="late"?"":""})`),setTimeout(()=>r("done"),1500)}catch(F){console.error(F),i("    ."),r("error")}}else r("error"),w>1e3?i("  .  GPS ."):i(`  . (${Math.round(j)}m )`)},g=>{r("error"),i("    .")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}},p=ct(new Date,"yyyy-MM-dd"),m=s?{start:ct(IS(ph(`${p} ${s.start_time}`,"yyyy-MM-dd HH:mm:ss",new Date)),"HH:mm"),end:ct(kh(ph(`${p} ${s.start_time}`,"yyyy-MM-dd HH:mm:ss",new Date),30),"HH:mm"),lateLimit:ct(kh(ph(`${p} ${s.start_time}`,"yyyy-MM-dd HH:mm:ss",new Date),10),"HH:mm")}:null;return v.jsxs("div",{className:"bg-white p-8 max-w-[360px] w-full text-center space-y-6 relative overflow-hidden rounded-[32px] shadow-2xl border border-gray-50 animate-spring-up",children:[v.jsx("div",{className:"absolute top-0 left-0 w-32 h-32 bg-ios-indigo/5 blur-3xl -z-10"}),v.jsx("div",{className:`w-16 h-16 rounded-[1.2rem] mx-auto flex items-center justify-center transition-all duration-700 shadow-sm border ${t==="verified"||t==="done"?"bg-ios-emerald/10 text-ios-emerald border-ios-emerald/20":t==="error"?"bg-ios-rose/10 text-ios-rose border-ios-rose/20":t==="locating"?"bg-ios-indigo/10 text-ios-indigo animate-pulse border-ios-indigo/20":"bg-white text-gray-200 border-gray-100"}`,children:t==="done"?v.jsx(El,{className:"w-8 h-8"}):t==="error"?v.jsx(ya,{className:"w-8 h-8"}):t==="locating"?v.jsx(jc,{className:"w-8 h-8"}):v.jsx(z2,{className:"w-8 h-8"})}),v.jsx("div",{className:"space-y-4",children:s?v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-ios-indigo/5 text-ios-indigo rounded-full text-[11px] font-black border border-ios-indigo/10",children:[v.jsx(Pl,{className:"w-3.5 h-3.5"})," '",s.name,"'   "]}),v.jsx("h3",{className:"text-[26px] font-black tracking-tight text-[#1C1C1E] leading-tight",children:t==="done"?" ":t==="locating"?"  ":"  "}),v.jsxs("div",{className:"bg-white rounded-2xl p-4 space-y-1.5 border border-gray-100 shadow-sm",children:[v.jsxs("p",{className:"text-[13px] font-bold text-ios-gray",children:["  : ",m.start," ~ ",m.end]}),v.jsxs("p",{className:"text-[11px] font-black text-ios-rose/80",children:[" ",m.lateLimit,"     ."]})]})]}):v.jsxs(v.Fragment,{children:[v.jsx("h3",{className:"text-2xl font-black tracking-tight text-[#1C1C1E]",children:"   "}),v.jsx("p",{className:"text-sm font-bold text-ios-gray leading-relaxed px-4",children:o?"   ...":"     .  5  30  ."})]})}),v.jsxs("div",{className:"space-y-4 pt-2",children:[n&&v.jsx("p",{className:`text-[12px] font-black p-3.5 rounded-apple-md ${t==="error"?"bg-ios-rose/5 text-ios-rose border border-ios-rose/10":"bg-ios-emerald/5 text-ios-emerald border border-ios-emerald/10"}`,children:n}),t!=="done"&&v.jsx("button",{onClick:u,disabled:t==="locating"||!s,className:`w-full py-[24px] rounded-3xl font-black text-[18px] transition-all shadow-xl ios-tap border ${t==="locating"||!s?"bg-white text-gray-300 border-gray-100 shadow-none":t==="error"?"bg-[#1C1C1E] text-white border-transparent":"bg-ios-blue text-white border-transparent shadow-blue-500/20"}`,children:t==="locating"?"  ...":s?`${s.name}  `:" "})]})]})},IT=({user:e})=>{const[t,r]=ye.useState([]),[n,i]=ye.useState(!1),[s,l]=ye.useState({cumulativeDays:0,cumulativeTime:0,attendanceRate:0,lateCount:0}),[o,a]=ye.useState([]),[c,f]=ye.useState(!1),[h,d]=ye.useState([]);ye.useEffect(()=>{if(!e)return;(async()=>{const g="2025-03-01",y=ct(new Date,"yyyy-MM-dd"),{data:w}=await Xe.from("bookings").select(`
                *,
                sessions (
                    start_time,
                    end_time
                ),
                attendance (
                    status,
                    timestamp_in
                )
            `).or(`user_id.eq.${e.id},student_id.eq.${e.id}`).gte("date",g);if(w){d(w);let _=0,C=0,E=0,T=0;const A=new Set;w.forEach(j=>{if(j.date>y)return;_++;const F=j.attendance&&j.attendance[0];if(F&&(F.status==="present"||F.status==="late")&&(C++,A.add(j.date),F.status==="late"&&E++,j.sessions)){const L=new Date(`${j.date}T${j.sessions.start_time}`),X=(new Date(`${j.date}T${j.sessions.end_time}`)-L)/(1e3*60);let re=0;if(F.timestamp_in){const Q=new Date(F.timestamp_in),ne=new Date(`${j.date}T${j.sessions.start_time}+09:00`);Q>ne&&(re=(Q-ne)/(1e3*60))}T+=Math.max(0,X-Math.max(0,re))}}),l({cumulativeDays:A.size,cumulativeTime:Math.round(T),attendanceRate:_>0?Math.round(C/_*100):0,lateCount:E})}a([])})()},[e]);const u=tu({start:_f(new Date),end:Ld(new Date)}),p=m=>{const g=Math.floor(m/60),x=m%60;return`${g} ${x}`};return v.jsxs("div",{className:"flex flex-col gap-4 md:gap-6",children:[v.jsx("div",{className:"animate-spring-up",children:v.jsxs("div",{className:"bg-white rounded-[32px] p-10 border border-gray-100 shadow-sm",children:[v.jsx("div",{className:"flex items-center justify-between mb-10",children:v.jsxs("h3",{className:"text-xl font-black flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 rounded-ios bg-ios-indigo/20 flex items-center justify-center",children:v.jsx(Vc,{className:"w-5 h-5 text-ios-indigo"})}),"  "]})}),v.jsx("div",{className:"grid grid-cols-7 gap-3 text-center mb-6",children:["","","","","","",""].map((m,g)=>v.jsx("span",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest",children:m},g))}),v.jsx("div",{className:"grid grid-cols-7 gap-3",children:u.map((m,g)=>{const x=ct(m,"yyyy-MM-dd"),y=h.find(C=>C.date===x);let w=null;if(y){const C=ct(new Date,"yyyy-MM-dd");if(x>C)w="booking";else{const E=y.attendance&&y.attendance[0];E?w=E.status:w="absent"}}const _=Wy(m);return v.jsxs("div",{className:`aspect-square rounded-ios flex items-center justify-center text-[12px] font-black transition-all duration-500 ios-tap relative group ${_?"bg-[#1C1C1E] text-white shadow-xl scale-[1.15] z-10":w==="present"?"bg-ios-emerald/10 text-ios-emerald":w==="late"?"bg-ios-amber/10 text-ios-amber":w==="absent"?"bg-ios-rose/10 text-ios-rose":w==="booking"?"bg-ios-indigo/10 text-ios-indigo":"bg-gray-50 text-gray-300 hover:bg-gray-100 hover:text-gray-500"}`,children:[ct(m,"d"),w&&!_&&w!=="booking"&&v.jsx("div",{className:`absolute bottom-1 w-1 h-1 rounded-full ${w==="present"?"bg-ios-emerald":w==="late"?"bg-ios-amber":"bg-ios-rose"}`}),w==="booking"&&!_&&v.jsx("div",{className:"absolute bottom-1 w-1 h-1 rounded-full bg-ios-indigo"})]},g)})}),v.jsx("div",{className:"mt-10 pt-8 border-t border-gray-100",children:v.jsxs("div",{className:"flex flex-col gap-4",children:[v.jsx("span",{className:"text-[11px] font-black text-ios-gray uppercase tracking-[0.2em]",children:" "}),v.jsx("div",{className:"flex flex-wrap gap-4",children:[{label:"",color:"bg-ios-emerald"},{label:"",color:"bg-ios-amber"},{label:"",color:"bg-ios-rose"},{label:"",color:"bg-gray-100"},{label:"",color:"bg-ios-indigo"}].map(m=>v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:`w-2 h-2 rounded-full ${m.color}`}),v.jsx("span",{className:"text-[10px] font-bold text-gray-400",children:m.label})]},m.label))})]})})]})}),v.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4 md:gap-6 overflow-visible",children:[v.jsx("div",{className:"xl:col-span-2 flex flex-col gap-4 md:gap-6 animate-spring-up",style:{animationDelay:"100ms"},children:v.jsxs("div",{className:"grid grid-cols-2 gap-4 md:gap-6",children:[v.jsxs("div",{className:"col-span-2 bg-white rounded-[32px] p-8 flex flex-col items-center text-center gap-2 group transition-all duration-500 ios-tap border border-gray-100 shadow-sm relative overflow-hidden",children:[v.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-ios-amber/10 blur-3xl -z-10"}),v.jsx("div",{className:"w-16 h-16 rounded-ios bg-ios-amber/10 text-ios-amber flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform mb-2",children:v.jsx(ym,{className:"w-8 h-8"})}),v.jsx("p",{className:"text-[11px] uppercase font-black text-ios-gray tracking-widest",children:"   "}),v.jsxs("div",{className:"flex flex-col items-center",children:[v.jsxs("p",{className:"text-4xl font-black text-[#1C1C1E]",children:[s.cumulativeDays,""]}),v.jsx("p",{className:"text-sm font-bold text-gray-400 mt-1",children:p(s.cumulativeTime)})]})]}),v.jsxs("div",{className:"bg-white rounded-[32px] p-8 flex flex-col items-center text-center gap-4 group transition-all duration-500 ios-tap border border-gray-100 shadow-sm",children:[v.jsx("div",{className:"w-12 h-12 rounded-ios bg-ios-emerald/10 text-ios-emerald flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform",children:v.jsx(El,{className:"w-6 h-6"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-[10px] uppercase font-black text-ios-gray tracking-widest mb-1",children:""}),v.jsxs("p",{className:"text-2xl font-black text-[#1C1C1E]",children:[s.attendanceRate,"%"]})]})]}),v.jsxs("div",{className:"bg-white rounded-[32px] p-8 flex flex-col items-center text-center gap-4 group transition-all duration-500 ios-tap border border-gray-100 shadow-sm",children:[v.jsx("div",{className:"w-12 h-12 rounded-ios bg-ios-rose/10 text-ios-rose flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform",children:v.jsx(wO,{className:"w-6 h-6"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-[10px] uppercase font-black text-ios-gray tracking-widest mb-1",children:" "}),v.jsxs("p",{className:"text-2xl font-black text-[#1C1C1E]",children:[s.lateCount,""]})]})]})]})}),v.jsx("div",{className:"animate-spring-up",style:{animationDelay:"200ms"},children:v.jsxs("div",{className:"bg-gradient-to-br from-ios-indigo via-[#7D7AFF] to-[#9B99FF] rounded-[32px] p-10 text-white shadow-2xl shadow-ios-indigo/30 relative overflow-hidden group ios-tap",children:[v.jsxs("div",{className:"relative z-10",children:[v.jsx("div",{className:"w-14 h-14 rounded-2xl bg-white/20 backdrop-blur-md flex items-center justify-center mb-6 shadow-inner-white",children:v.jsx(ym,{className:"w-8 h-8 text-white"})}),v.jsx("h4",{className:"text-2xl font-black tracking-tight mb-2",children:" "}),v.jsxs("p",{className:"text-[15px] text-white/80 font-medium mb-8 leading-relaxed",children:[" 5%  .",v.jsx("br",{}),"   ."]}),v.jsx("button",{onClick:()=>f(!0),className:"w-full py-4 bg-black hover:bg-gray-900 rounded-2xl text-xs font-black uppercase tracking-widest transition-all backdrop-blur-sm border border-white/10",children:" "})]}),v.jsx("div",{className:"absolute -right-16 -top-16 w-64 h-64 bg-white/10 rounded-full blur-3xl group-hover:scale-150 transition-transform duration-[2000ms]"}),v.jsx("div",{className:"absolute left-[-10%] bottom-[-10%] w-40 h-40 bg-white/5 rounded-full blur-2xl group-hover:translate-x-10 transition-transform duration-[2000ms]"})]})})]}),c&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 animate-in fade-in duration-200",children:[v.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>f(!1)}),v.jsxs("div",{className:"bg-white rounded-ios p-8 w-full max-w-md relative z-10 shadow-2xl animate-spring-up",children:[v.jsxs("div",{className:"flex items-center justify-between mb-8",children:[v.jsxs("h3",{className:"text-xl font-black flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 rounded-ios bg-ios-amber/20 flex items-center justify-center",children:v.jsx(ym,{className:"w-5 h-5 text-ios-amber"})})," "]}),v.jsx("div",{className:"bg-gray-100 rounded-full px-3 py-1",children:v.jsx("span",{className:"text-[10px] font-bold text-gray-500",children:"TOP 10"})})]}),v.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2",children:o.length>0?o.map((m,g)=>v.jsxs("div",{className:"flex items-center justify-between p-4 rounded-ios bg-gray-50 border border-gray-100/50",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:`w-8 h-8 flex items-center justify-center font-black rounded-full shadow-sm ${g===0?"bg-yellow-400 text-white":g===1?"bg-gray-400 text-white":g===2?"bg-orange-400 text-white":"bg-white text-gray-400 border border-gray-200"}`,children:m.rank}),v.jsx("div",{className:"flex flex-col",children:v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"text-sm font-black text-[#1C1C1E]",children:m.name}),v.jsx("span",{className:"text-[10px] font-bold text-gray-500 bg-white px-1.5 py-0.5 rounded border border-gray-200",children:m.info})]})})]}),v.jsx("p",{className:"text-xs font-bold text-ios-indigo bg-ios-indigo/5 px-2 py-1 rounded-lg",children:p(m.score)})]},g)):v.jsx("div",{className:"text-center py-12 text-gray-400 font-medium text-sm bg-gray-50 rounded-ios",children:"  ,   ."})}),v.jsx("button",{onClick:()=>f(!1),className:"w-full mt-6 py-4 bg-[#1C1C1E] text-white rounded-ios font-black text-sm hover:scale-[1.02] active:scale-[0.98] transition-all shadow-lg",children:""})]})]})]})},JX=({onLogout:e,currentUser:t})=>{const[r,n]=ye.useState("home"),[i,s]=ye.useState(null),[l,o]=ye.useState(""),[a,c]=ye.useState(""),[f,h]=ye.useState({}),[d,u]=ye.useState(new Date);ye.useEffect(()=>{const y=async()=>{const{data:E}=await Xe.from("sessions").select("*");if(E){const T=new Date,A=T.getHours().toString().padStart(2,"0")+":"+T.getMinutes().toString().padStart(2,"0")+":00",j=E.find(B=>A>=B.start_time&&A<=B.end_time);s(j)}},w=async()=>{var T;const{data:E}=await Xe.from("configs").select("value").eq("key","school_info").single();(T=E==null?void 0:E.value)!=null&&T.name_en&&o(E.value.name_en)},_=async()=>{if(!t)return;const E=ct(new Date,"yyyy-MM-dd"),T=Mn(d,{weekStartsOn:1}),A=No(d,{weekStartsOn:1}),{data:j}=await Xe.from("study_plans").select("content").eq("user_id",t.id).eq("date",E);if(j&&j.length>0){const F=j.map(L=>L.content).filter(Boolean).join(`
`);c(F)}else c("");const{data:B}=await Xe.from("bookings").select(`
                *,
                sessions (
                    id,
                    start_time,
                    end_time
                ),
                attendance (
                    id,
                    booking_id,
                    status,
                    timestamp_in,
                    timestamp_out
                )
            `).or(`student_id.eq.${t.id},user_id.eq.${t.id}`).gte("date",ct(T,"yyyy-MM-dd")).lte("date",ct(A,"yyyy-MM-dd"));if(B){const F={};B.forEach(L=>{const G=L.date;F[G]||(F[G]={bookings:[],attendance:[]}),F[G].bookings.push(L),L.attendance&&L.attendance.length>0&&F[G].attendance.push(...L.attendance)}),h(F)}};y(),w(),_();const C=setInterval(()=>{y(),_()},6e4);return()=>clearInterval(C)},[t,d]);const p=()=>u(y=>FT(y)),m=()=>u(y=>p1(y,1)),g=(y,w)=>{var re,Q;if(!w||!w.bookings.length)return null;const _=new Date,C=ct(_,"yyyy-MM-dd"),{bookings:E,attendance:T}=w;if(y>C)return{label:"",color:"text-ios-indigo bg-ios-indigo/10"};if(y<C)return T.length?T.some(J=>J.status==="late")?{label:"",color:"text-ios-amber bg-ios-amber/10"}:{label:"",color:"text-ios-emerald bg-ios-emerald/10"}:{label:"",color:"text-ios-rose bg-ios-rose/10"};const A=ct(_,"HH:mm:ss"),j=[...E].sort((ne,J)=>{var P,H;return(((P=ne.sessions)==null?void 0:P.start_time)||"").localeCompare(((H=J.sessions)==null?void 0:H.start_time)||"")});if(!j.length)return null;const B=(re=j[0].sessions)==null?void 0:re.start_time,F=(Q=j[j.length-1].sessions)==null?void 0:Q.end_time,L=E.some(ne=>{var J;return(((J=ne.sessions)==null?void 0:J.start_time)||"")>="17:00:00"}),G=A>="09:00:00"&&A<="17:00:00",X=j.find(ne=>{const J=ne.sessions;return J&&A>=J.start_time&&A<=J.end_time});return X?T.find(J=>J.booking_id===X.id)?{label:"",color:"text-white bg-ios-emerald"}:{label:"",color:"text-ios-rose bg-ios-rose/10"}:G&&L?{label:"",color:"text-gray-400 bg-gray-100"}:F&&A>F?{label:"",color:"text-gray-500 bg-gray-100"}:B&&A<B?{label:"",color:"text-ios-indigo bg-ios-indigo/10"}:{label:"",color:"text-ios-amber bg-ios-amber/10"}},x=()=>{switch(r){case"home":return v.jsxs("div",{className:"flex-1 flex flex-col gap-4 p-4 animate-fade-in relative overflow-y-auto scrollbar-hide",children:[v.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-ios-indigo/5 blur-3xl -z-10"}),v.jsx("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-ios-blue/5 blur-3xl -z-10"}),v.jsxs("div",{className:"flex-[2] glass-card p-7 relative overflow-hidden flex flex-col",children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-ios-amber/10 flex items-center justify-center",children:v.jsx(U2,{className:"w-4 h-4 text-ios-amber"})}),v.jsx("h2",{className:"text-lg font-black text-[#1C1C1E] tracking-tight",children:" "})]}),v.jsxs("span",{className:"text-[10px] font-bold text-ios-gray bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100 max-sm:hidden",children:[ct(new Date,"M d")," "]})]}),v.jsx("div",{className:"flex-1 flex items-center justify-center text-center",children:a?v.jsx("p",{className:"text-[15px] text-[#1C1C1E] font-bold leading-relaxed whitespace-pre-line line-clamp-3",children:a}):v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-sm text-gray-400 font-bold leading-relaxed mb-1",children:"    ."}),v.jsx("span",{className:"text-xs font-medium text-gray-300",children:"   ."})]})}),v.jsxs("div",{className:"bg-gray-200/20 rounded-apple-md p-4 border border-white/40 mt-auto relative backdrop-blur-xl",children:[v.jsx("button",{onClick:p,className:"absolute left-1 top-1/2 -translate-y-1/2 w-8 h-8 flex items-center justify-center text-ios-gray hover:text-[#1C1C1E] transition-colors ios-tap",children:v.jsx(jo,{className:"w-5 h-5"})}),v.jsx("button",{onClick:m,className:"absolute right-1 top-1/2 -translate-y-1/2 w-8 h-8 flex items-center justify-center text-ios-gray hover:text-[#1C1C1E] transition-colors ios-tap",children:v.jsx(Cs,{className:"w-5 h-5"})}),v.jsx("div",{className:"flex justify-between items-center px-6",children:tu({start:Mn(d,{weekStartsOn:1}),end:No(d,{weekStartsOn:1})}).map((y,w)=>{const _=ct(y,"yyyy-MM-dd"),C=f[_],E=g(_,C),T=Nl(y,new Date);let A=T?"bg-[#1C1C1E] text-white shadow-lg ring-4 ring-white z-10":"bg-white/50 border border-white/40 text-gray-300";return(E==null?void 0:E.label)===""||(E==null?void 0:E.label)===""||(E==null?void 0:E.label)===""?A="bg-ios-emerald text-white shadow-sm border-none":(E==null?void 0:E.label)===""?A="bg-ios-amber text-white shadow-sm border-none":(E==null?void 0:E.label)===""||(E==null?void 0:E.label)===""?A="bg-ios-rose text-white shadow-sm border-none":(E==null?void 0:E.label)===""&&(A="bg-ios-indigo text-white shadow-sm border-none"),v.jsxs("div",{className:"flex flex-col items-center gap-2",children:[v.jsx("span",{className:`text-[9px] font-black ${T?"text-[#1C1C1E]":"text-gray-300"}`,children:["","","","","","",""][w]}),v.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-[10px] font-black transition-all ${A}`,children:ct(y,"d")}),v.jsx("div",{className:"h-4 flex items-center justify-center",children:E?v.jsx("span",{className:`text-[8px] font-bold px-1.5 py-0.5 rounded-full whitespace-nowrap ${E.color}`,children:E.label}):v.jsx("div",{className:"w-1 h-1 rounded-full bg-transparent"})})]},w)})})]})]}),v.jsxs("button",{onClick:()=>n("map"),className:"flex-1 bg-white rounded-apple border border-gray-100 shadow-sm p-4 flex items-center justify-center gap-6 group transition-all active:scale-[0.98] relative overflow-hidden ios-tap",children:[v.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-ios-indigo/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),v.jsx("div",{className:"w-14 h-14 rounded-full bg-ios-indigo/10 flex items-center justify-center group-hover:scale-110 transition-transform duration-500",children:v.jsx(sv,{className:"w-7 h-7 text-ios-indigo"})}),v.jsxs("div",{className:"text-left space-y-1 relative z-10 flex-1",children:[v.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:""}),v.jsx("p",{className:"text-xs font-bold text-ios-gray",children:"  "})]}),v.jsx(Cs,{className:"w-5 h-5 text-gray-300"})]}),v.jsxs("button",{onClick:()=>n("attendance"),className:"flex-1 bg-white rounded-apple border border-gray-100 shadow-sm p-4 flex items-center justify-center gap-6 group transition-all active:scale-[0.98] relative overflow-hidden ios-tap",children:[v.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-ios-emerald/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),v.jsx("div",{className:"w-14 h-14 rounded-full bg-ios-emerald/10 flex items-center justify-center group-hover:scale-110 transition-transform duration-500",children:v.jsx(jc,{className:"w-7 h-7 text-ios-emerald"})}),v.jsxs("div",{className:"text-left space-y-1 relative z-10 flex-1",children:[v.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:""}),v.jsx("p",{className:"text-xs font-bold text-ios-gray",children:"GPS  "})]}),v.jsx(Cs,{className:"w-5 h-5 text-gray-300"})]})]});case"map":return v.jsx("div",{className:"flex-1 bg-white relative overflow-hidden flex flex-col",children:v.jsx(KX,{onCancel:()=>n("home"),onSuccess:()=>n("profile"),currentUser:t})});case"attendance":return v.jsx("div",{className:"flex-1 bg-white flex flex-col items-center justify-center overflow-y-auto scrollbar-hide px-6",children:v.jsx("div",{className:"w-full max-w-lg py-8 flex flex-col items-center justify-center",children:v.jsx(LT,{user:t})})});case"profile":return v.jsx("div",{className:"flex-1 bg-[#F2F2F7] overflow-y-auto scrollbar-hide p-6",children:v.jsx(IT,{user:t})});default:return null}};return v.jsxs("div",{className:"mobile-container flex flex-col bg-[#F2F2F7] h-screen overflow-hidden font-sans pb-[safe-area-inset-bottom]",children:[v.jsxs("header",{className:"flex-none glass-header px-6 pt-10 pb-4 flex items-center justify-between shadow-sm z-50",children:[v.jsxs("div",{className:"flex flex-col",children:[v.jsx("h1",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:l.split(" ")[0]}),v.jsx("p",{className:"text-[10px] font-black text-ios-indigo tracking-[0.2em] uppercase opacity-70",children:"Study Cafe Manager"})]}),v.jsx("div",{className:"flex items-center gap-4",children:v.jsx("button",{onClick:e,className:"p-3 bg-gray-200/20 text-ios-gray hover:text-ios-rose hover:bg-ios-rose/10 rounded-apple-md transition-all ios-tap border border-white/40 backdrop-blur-xl",children:v.jsx(Jg,{className:"w-5 h-5"})})})]}),v.jsx("main",{className:"flex-1 flex flex-col overflow-hidden relative",children:x()}),r!=="map"&&v.jsx("nav",{className:"flex-none glass-material pb-[calc(1rem+env(safe-area-inset-bottom))] pt-3 px-6 flex justify-between items-center z-50 shadow-[0_-4px_40px_rgba(0,0,0,0.03)] border-t border-white/40",children:[{id:"home",icon:e3,label:""},{id:"map",icon:sv,label:""},{id:"attendance",icon:jc,label:""},{id:"profile",icon:hd,label:"MY"}].map(y=>v.jsxs("button",{onClick:()=>n(y.id),className:`flex flex-col items-center justify-center p-2 rounded-apple-md transition-all duration-300 w-16 group ios-tap ${r===y.id?"text-[#1C1C1E]":"text-gray-300 hover:text-gray-500"}`,children:[v.jsx("div",{className:"relative transition-transform duration-300",children:v.jsx(y.icon,{className:`w-7 h-7 stroke-[2.5px] ${r===y.id?"fill-ios-indigo/10":"fill-transparent"}`})}),v.jsx("span",{className:"text-[9px] font-black mt-1",children:y.label})]},y.id))})]})},QX=({selectedSeat:e,onComplete:t,targetUser:r,loggedInUser:n,initialDate:i,onDateChange:s,currentZoneId:l,onOpenSeatModal:o})=>{var Z;const[a,c]=ye.useState(1),[f,h]=ye.useState(i||ct(Ss(new Date,2),"yyyy-MM-dd")),[d,u]=ye.useState(ct(Ss(new Date,2),"yyyy-MM-dd")),[p,m]=ye.useState([]),[g,x]=ye.useState([]),[y,w]=ye.useState([]),[_,C]=ye.useState(null),[E,T]=ye.useState(null),[A,j]=ye.useState({quarters:[],exceptions:[],operatingRules:[]}),[B,F]=ye.useState([]),[L,G]=ye.useState([]),[X,re]=ye.useState(!1),[Q,ne]=ye.useState("");ye.useEffect(()=>{i&&h(i)},[i]),ye.useEffect(()=>{Xe.from("zones").select("id, name").then(({data:se})=>x(se||[]))},[]);const J={Morning:" ",Dinner:" ","1st Period":"1","2nd Period":"2"},P=se=>J[se]||se;ye.useEffect(()=>{(async()=>{const{data:{user:V}}=await Xe.auth.getUser();if(V){const{data:ae}=await Xe.from("profiles").select("*").eq("id",V.id).single();C(r||ae),T(ae)}const le=(e==null?void 0:e.zone_id)||l;if(le){re(!0);const[ae,W,he,fe]=await Promise.all([Xe.from("sessions").select("*").eq("zone_id",le).order("start_time",{ascending:!0}),Xe.from("operation_quarters").select("*"),Xe.from("operation_exceptions").select("*").eq("zone_id",le),Xe.from("configs").select("*").eq("key",`zone_op_config_${le}`).maybeSingle()]);ae.data&&m(ae.data);const{data:Te}=await Xe.from("session_operating_days").select("session_id, day_of_week").in("session_id",(ae.data||[]).map(be=>be.id)).eq("is_active",!0);j({quarters:W.data||[],exceptions:he.data||[],operatingRules:Te||[]}),re(!1)}else{const{data:ae}=await Xe.from("operation_quarters").select("*");j(W=>({...W,quarters:ae||[]}))}})()},[e,l,r]),ye.useEffect(()=>{C(r||E)},[r,E]),ye.useEffect(()=>{_&&f&&e&&(H(),U()),w([])},[_,f,e,l]);const H=async()=>{const{data:se}=await Xe.from("bookings").select("*").eq("user_id",_.id).eq("date",f);F(se||[])},U=async()=>{if(!e)return;const{data:se}=await Xe.from("bookings").select("*, profiles(username, full_name), profiles_student(username, full_name)").eq("seat_id",e.id).eq("date",f);G(se||[])},S=se=>{const V=Cr(se),le=n||E,ae=le&&["admin","teacher"].includes(le.role),W=Ga(Ss(new Date,ae?0:2));if(qh(V,W))return{ok:!1,msg:`   ${ae?"0":"2"}  .`};if(A.quarters.length>0&&!A.quarters.some(Te=>Te.start_date&&Te.end_date&&zc(V,{start:Cr(Te.start_date),end:Cr(Te.end_date)})))return{ok:!1,msg:"    ."};const he=A.exceptions.find(fe=>fe.exception_date===se);if(he)return{ok:!1,msg:`: ${he.reason}`};if(A.operatingRules.length>0){const fe=V.getDay();if(!A.operatingRules.some(be=>be.day_of_week===fe))return{ok:!1,msg:"   ."}}return{ok:!0}},I=()=>{if(a===1){const se=n||E;if(se&&["admin","teacher"].includes(se.role)&&!r){ne("/     .     .");return}const V=S(f);if(!V.ok){ne(V.msg);return}if(B.length>0&&e&&B[0].seat_id!==e.id){ne(`  ${B[0].seat_number}  .`);return}}ne(""),c(se=>se+1)},O=se=>{w(V=>V.find(ae=>ae.id===se.id)?V.filter(ae=>ae.id!==se.id):[...V,se].sort((ae,W)=>ae.id-W.id))};async function N(se,V){if(se.stopPropagation(),!!window.confirm("   ?"))try{re(!0);const{error:le}=await Xe.from("bookings").delete().eq("seat_id",e.id).eq("date",f).eq("session_id",V);if(le)throw le;G(ae=>ae.filter(W=>W.session_id!==V)),F(ae=>ae.filter(W=>W.session_id!==V)),alert(" .")}catch(le){console.error("Cancel Error:",le),ne(`    : ${le.message}`)}finally{re(!1)}}async function R(){if(y.length===0||X)return;const se=n||E;if(se&&["admin","teacher"].includes(se.role)&&!r){ne("/     ."),c(1);return}const V=()=>{const le=new Date,ae=9*60*60*1e3;return new Date(le.getTime()+ae).toISOString().replace("Z","+09:00")};re(!0);try{const{data:le}=await Xe.from("bookings").select("session_id, user_id, seat_id").eq("date",f).in("session_id",y.map(he=>he.id));if(le&&le.length>0){const he=le.some(Te=>Te.seat_id===e.id),fe=le.some(Te=>Te.user_id===_.id);if(he||fe){ne(he?"   .":"      ."),c(2),re(!1),H(),U();return}}const ae=y.map(he=>({user_id:n.id,student_id:r?r.id:n.id,seat_id:e.id,session_id:he.id,date:f,created_at:V(),status:"confirmed"})),{error:W}=await Xe.from("bookings").insert(ae);W?(ne(` : ${W.message}`),c(2)):(alert(" ."),t(),window.location.reload())}catch{ne("   ")}finally{re(!1)}}const[z,K]=ye.useState(new Date),Y=()=>{const se=_f(z),V=Ld(se),le=Mn(se),ae=No(V),W=tu({start:le,end:ae});return v.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-4 shadow-sm",children:[v.jsxs("div",{className:"flex items-center justify-between mb-4 px-1",children:[v.jsx("h4",{className:"text-sm font-black text-[#1C1C1E]",children:ct(z,"yyyy M",{locale:Qn})}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>K(g1(z)),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",children:v.jsx(jo,{className:"w-4 h-4 text-ios-gray"})}),v.jsx("button",{onClick:()=>K(Qd(z,1)),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",children:v.jsx(Cs,{className:"w-4 h-4 text-ios-gray"})})]})]}),v.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[["","","","","","",""].map(he=>v.jsx("div",{className:"text-center text-[10px] font-bold text-ios-gray/50 py-1",children:he},he)),W.map((he,fe)=>{const Te=ct(he,"yyyy-MM-dd"),be=S(Te),pe=f===Te,xe=Nl(_f(he),se),ce=Wy(he);return v.jsx("button",{disabled:!be.ok,onClick:()=>{h(Te),s&&s(Te)},className:`
                  h-9 w-full rounded-lg flex flex-col items-center justify-center transition-all relative
                  ${pe?"bg-[#1C1C1E] text-white shadow-md z-10":""}
                  ${!pe&&xe&&be.ok?"hover:bg-gray-100 text-[#1C1C1E] font-black":""}
                  ${!pe&&be.ok&&!xe?"text-ios-gray/40 font-black":""}
                  ${be.ok?"":"opacity-20 cursor-not-allowed text-ios-gray grayscale"}
                  ${!pe&&ce?"border border-ios-indigo text-ios-indigo font-black":""}
                `,children:v.jsx("span",{className:"text-xs",children:ct(he,"d")})},fe)})]}),v.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-50 flex items-center gap-4 px-1",children:[v.jsxs("div",{className:"flex items-center gap-1.5",children:[v.jsx("div",{className:"w-2 h-2 rounded-full bg-[#1C1C1E]"}),v.jsx("span",{className:"text-[10px] font-bold text-[#1C1C1E]",children:""})]}),v.jsxs("div",{className:"flex items-center gap-1.5",children:[v.jsx("div",{className:"w-2 h-2 rounded-full bg-ios-indigo/20"}),v.jsx("span",{className:"text-[10px] font-bold text-ios-indigo/70",children:""})]})]})]})};return v.jsxs("div",{className:"bg-white border border-gray-100 border-b-0 rounded-t-[6px] rounded-b-none pt-[10px] px-6 pb-6 lg:px-8 lg:pb-8 space-y-5 animate-spring-up relative min-h-full",children:[v.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-ios-indigo/5 blur-2xl -z-10"}),v.jsxs("div",{className:"bg-gray-50/50 rounded-[6px] mt-[10px] pt-4 px-4 pb-4 flex items-center gap-4 border border-gray-100",children:[v.jsx("div",{className:"w-12 h-12 rounded-[6px] bg-white text-[#000000] flex items-center justify-center font-black text-sm border border-gray-200 shadow-sm",children:e?e.display_number||e.seat_number:"?"}),v.jsxs("div",{children:[v.jsx("p",{className:"text-[9px] font-black text-[#000000] uppercase tracking-[0.2em] mb-0.5 opacity-50",children:e?"  ":"   "}),v.jsx("p",{className:"text-base font-black text-[#1C1C1E]",children:e?`Zone ${((Z=g.find(se=>se.id===e.zone_id))==null?void 0:Z.name)||""}`:"  "})]})]}),v.jsx("div",{className:"flex items-center gap-2",children:[1,2,3].map(se=>v.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-all duration-700 ${a>=se?"bg-[#1C1C1E]":"bg-gray-100"}`},se))}),a===1&&v.jsxs("div",{className:"space-y-6",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center",children:v.jsx(Vc,{className:"w-5 h-5 text-ios-indigo"})}),v.jsx("h3",{className:"text-xl font-black tracking-tight text-[#1C1C1E]",children:"  "})]}),v.jsxs("div",{className:"space-y-4",children:[Y(),!S(f).ok&&v.jsxs("div",{className:"p-4 bg-ios-rose/5 border border-ios-rose/10 rounded-xl flex items-center gap-2 animate-shake",children:[v.jsx(ya,{className:"w-4 h-4 text-ios-rose"}),v.jsx("p",{className:"text-[11px] font-black text-ios-rose italic",children:S(f).msg})]})]}),Q&&v.jsxs("div",{className:"p-4 bg-ios-rose/5 border border-ios-rose/10 rounded-[6px] flex items-center gap-2 animate-shake",children:[v.jsx(ya,{className:"w-4 h-4 text-ios-rose"}),v.jsx("p",{className:"text-[11px] font-black text-ios-rose",children:Q})]}),v.jsxs("div",{className:"mt-1 pt-0 border-t-0 flex gap-3",children:[v.jsx("button",{onClick:t,className:"flex-1 py-3.5 rounded-xl text-sm font-black text-ios-gray bg-gray-50 hover:bg-gray-100 transition-all ios-tap",children:""}),v.jsx("button",{disabled:!S(f).ok||!e,onClick:I,className:`flex-[1.5] py-3.5 rounded-xl text-sm font-black text-white transition-all shadow-lg ios-tap ${S(f).ok&&e?"bg-[#1C1C1E] shadow-black/10 hover:bg-gray-800":"bg-gray-200 cursor-not-allowed shadow-none"}`,children:" "})]})]}),a===2&&v.jsxs("div",{className:"space-y-6",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center",children:v.jsx(Pl,{className:"w-5 h-5 text-ios-indigo"})}),v.jsx("h3",{className:"text-xl font-black tracking-tight text-[#1C1C1E]",children:"  "})]}),v.jsx("p",{className:"text-[11px] font-black text-ios-gray px-1",children:"      . (  )"}),v.jsx("div",{className:"grid grid-cols-1 gap-3",children:p.map(se=>{const V=Cr(f).getDay(),le=A.operatingRules.some(fe=>fe.session_id===se.id&&fe.day_of_week===V),ae=B.some(fe=>fe.session_id===se.id),W=L.some(fe=>fe.session_id===se.id),he=y.some(fe=>fe.id===se.id);return le?v.jsxs("button",{disabled:ae||W,onClick:()=>O(se),className:`p-4 rounded-[6px] border transition-all duration-300 flex items-center justify-between group ios-tap text-left ${he?"border-[#1C1C1E] bg-[#1C1C1E]/5 shadow-sm":ae||W?["admin","teacher"].includes(_==null?void 0:_.role)?"border-red-100 bg-red-50/30":"opacity-30 bg-gray-100 cursor-not-allowed":"border-gray-100 bg-gray-50/50 hover:bg-gray-100/80"}`,children:[v.jsxs("div",{className:"flex-1 flex flex-col items-start",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("p",{className:"font-black text-base text-[#1C1C1E]",children:P(se.name)}),ae&&v.jsx("span",{className:"text-[9px] font-black text-ios-gray bg-gray-200 px-1.5 py-0.5 rounded-full uppercase",children:" "}),["admin","teacher"].includes(E==null?void 0:E.role)&&(()=>{const fe=L.find(be=>be.session_id===se.id);if(!fe)return null;const Te=fe.profiles_student||fe.profiles;return Te?v.jsxs("div",{className:"flex flex-col items-start gap-1",children:[v.jsx("span",{className:"text-[9px] font-black text-ios-rose bg-ios-rose/10 px-1.5 py-0.5 rounded-full uppercase",children:" "}),v.jsxs("span",{className:"text-[9px] font-bold text-ios-rose/70",children:[Te.username," ",Te.full_name]})]}):null})()]}),v.jsxs("p",{className:"text-[10px] font-black text-ios-gray/70 uppercase tracking-tight mt-0.5",children:[se.start_time.slice(0,5)," ~ ",se.end_time.slice(0,5)]})]}),he?v.jsx("div",{className:"w-5 h-5 rounded-full bg-[#1C1C1E] flex items-center justify-center shadow-sm",children:v.jsx(qs,{className:"w-3 h-3 text-white stroke-[3px]"})}):(ae||W)&&["admin","teacher"].includes(_.role)?v.jsx("button",{onClick:fe=>N(fe,se.id),className:"w-8 h-8 rounded-full bg-red-50 hover:bg-red-100 flex items-center justify-center transition-all group/btn border border-red-200",title:" ",children:v.jsx(jl,{className:"w-4 h-4 text-red-500 group-hover/btn:scale-110 transition-transform"})}):v.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-gray-300 bg-white"})]},se.id):null})}),Q&&v.jsxs("div",{className:"p-4 bg-ios-rose/5 border border-ios-rose/10 rounded-[6px] flex items-center gap-2 animate-shake",children:[v.jsx(ya,{className:"w-4 h-4 text-ios-rose"}),v.jsx("p",{className:"text-[11px] font-black text-ios-rose",children:Q})]}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>t(),className:"flex-1 bg-gray-100 text-[#1C1C1E] py-4 rounded-[6px] font-black text-xs transition-all hover:bg-gray-200 ios-tap",children:""}),v.jsx("button",{onClick:()=>c(1),className:"flex-1 py-4 bg-gray-100 text-ios-gray rounded-[6px] font-black text-xs ios-tap",children:""}),v.jsxs("button",{disabled:y.length===0,onClick:I,className:"flex-[2] bg-[#1C1C1E] text-white py-4 rounded-[6px] font-black text-xs transition-all shadow-md disabled:opacity-20 ios-tap flex flex-col items-center justify-center leading-tight",children:[v.jsxs("span",{children:[y.length," "]}),v.jsx("span",{className:"opacity-60 text-[10px] mt-0.5",children:""})]})]})]}),a===3&&v.jsxs("div",{className:"space-y-8",children:[v.jsxs("div",{className:"text-center space-y-3",children:[v.jsx("div",{className:"w-12 h-12 rounded-[6px] bg-emerald-50 text-ios-emerald flex items-center justify-center mx-auto border border-emerald-100",children:v.jsx(qs,{className:"w-6 h-6"})}),v.jsxs("div",{className:"space-y-1.5",children:[v.jsx("h3",{className:"text-2xl font-black tracking-tight text-[#1C1C1E]",children:" "}),v.jsx("p",{className:"text-xs text-ios-gray font-medium",children:"    ."})]})]}),v.jsx("div",{className:"space-y-1.5",children:[{label:" ",value:ct(Cr(f),"yyyy M d (EEEE)",{locale:Qn}),color:"text-[#1C1C1E]"},{label:" ",value:y.map(se=>P(se.name)).join(", "),color:"text-[#1C1C1E]"},{label:" ",value:e.zone_name,color:"text-[#1C1C1E]"},{label:" ",value:`${e.seat_number}`,color:"text-[#1C1C1E]"}].map((se,V)=>v.jsxs("div",{className:"flex justify-between items-center p-4 rounded-[6px] bg-gray-50 border border-gray-100",children:[v.jsx("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest leading-none",children:se.label}),v.jsx("span",{className:`text-sm font-black text-right max-w-[200px] ${se.color}`,children:se.value})]},V))}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>t(),className:"flex-1 bg-gray-100 text-[#1C1C1E] py-5 rounded-[6px] font-black text-base transition-all hover:bg-gray-200 ios-tap",children:""}),v.jsxs("button",{disabled:X,onClick:R,className:"flex-[2] bg-[#1C1C1E] text-white py-5 rounded-[6px] font-black text-base transition-all shadow-lg shadow-black/20 flex items-center justify-center gap-3 ios-tap overflow-hidden relative group disabled:opacity-50",children:[X?" ...":" "," ",v.jsx(Cs,{className:"w-5 h-5"})]})]})]})]})},RS=({applicant:e,schoolInfo:t})=>v.jsxs("div",{className:"pledge-doc",children:[v.jsxs("div",{children:[v.jsx("div",{className:"pledge-header",children:v.jsx("h1",{className:"pledge-title",children:"  "})}),v.jsxs("p",{className:"intro-text",children:["         ,",v.jsx("br",{}),"          ."]}),v.jsxs("div",{className:"content-flex",children:[v.jsxs("div",{className:"pledge-section",children:[v.jsx("div",{className:"section-title",children:"[    ]"}),v.jsxs("div",{className:"pledge-content",children:[v.jsx("p",{children:"1.     ,       ."}),v.jsx("p",{children:"2.        ."}),v.jsx("p",{children:"3.       , ,      ."}),v.jsx("p",{children:"4.      ,         ."}),v.jsx("p",{children:"5.       ,       ."})]})]}),v.jsxs("div",{className:"pledge-section",children:[v.jsx("div",{className:"section-title",children:"[    ]"}),v.jsxs("div",{className:"pledge-content",children:[v.jsx("p",{children:"1.    ,        ."}),v.jsx("p",{children:"2.         ."}),v.jsx("p",{children:"3.          ."})]})]}),v.jsxs("div",{className:"pledge-section",children:[v.jsx("div",{className:"section-title",children:"[   ]"}),v.jsxs("div",{className:"pledge-content",children:[v.jsx("p",{children:"1.             ."}),v.jsx("p",{children:"2.          ."})]})]}),v.jsxs("div",{className:"pledge-section",children:[v.jsx("div",{className:"section-title",children:"[   ]"}),v.jsxs("div",{className:"pledge-content",children:[v.jsx("p",{children:"1.        ."}),v.jsx("p",{children:"2.         ,    ."}),v.jsx("p",{children:"3.   ,  ."})]})]}),v.jsxs("div",{className:"pledge-section",children:[v.jsx("div",{className:"section-title",children:"[    ]"}),v.jsxs("div",{className:"pledge-content",children:[v.jsx("p",{children:"1.             ."}),v.jsx("p",{children:"2.          ."})]})]}),v.jsxs("div",{className:"pledge-section",children:[v.jsx("div",{className:"section-title",children:"[  ]"}),v.jsxs("div",{className:"pledge-content",children:[v.jsx("p",{children:"1.            ."}),v.jsx("p",{children:"2.        ,        ."})]})]})]})]}),v.jsxs("div",{children:[v.jsxs("div",{className:"info-grid",children:[v.jsxs("div",{className:"info-item",children:[v.jsx("span",{className:"info-label",children:" :"}),v.jsx("span",{children:e.student_id})]}),v.jsxs("div",{className:"info-item",children:[v.jsx("span",{className:"info-label",children:" :"}),v.jsx("span",{children:e.name})]}),v.jsxs("div",{className:"info-item",children:[v.jsx("span",{className:"info-label",children:":"}),v.jsx("span",{children:e.phone_number||"-"})]})]}),v.jsxs("div",{className:"signature-block",children:[v.jsxs("div",{className:"sig-container",children:[v.jsx("div",{className:"sig-pad",children:e.student_signature?v.jsx("img",{src:e.student_signature,alt:" ",className:"sig-image",crossOrigin:"anonymous"}):v.jsx("span",{className:"text-gray-300 text-[10px]",children:" "})}),v.jsx("div",{className:"sig-label",children:"  ()"})]}),v.jsxs("div",{className:"sig-container",children:[v.jsx("div",{className:"sig-pad",children:e.parent_signature?v.jsx("img",{src:e.parent_signature,alt:" ",className:"sig-image",crossOrigin:"anonymous"}):v.jsx("span",{className:"text-gray-300 text-[10px]",children:" "})}),v.jsx("div",{className:"sig-label",children:" ()"})]})]}),v.jsx("div",{className:"footer-date",children:e.pledged_at?new Date(e.pledged_at).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"}):"-"}),v.jsxs("div",{className:"footer-school",children:[t.name?`${t.name}${t.level||""}`:"GOE"," "]})]})]}),ZX=()=>{const[e,t]=ye.useState([]),[r,n]=ye.useState(!1),[i,s]=ye.useState(""),[l,o]=ye.useState("all"),[a,c]=ye.useState(""),[f,h]=ye.useState(null),[d,u]=ye.useState("id-asc"),[p,m]=ye.useState(!1),[g,x]=ye.useState(!1),[y,w]=ye.useState(null),[_,C]=ye.useState([]),[E,T]=ye.useState(!1),[A,j]=ye.useState(["1"]),[B,F]=ye.useState({name:"",level:""});ye.useEffect(()=>{G(),L()},[]);const L=async()=>{const{data:U}=await Xe.from("configs").select("value").eq("key","school_info").single();U!=null&&U.value&&F(U.value)},G=async()=>{n(!0);const{data:U,error:S}=await Xe.from("applicant_pool").select("*").order("name",{ascending:!0});S?console.error("Error fetching applicants:",S):t(U||[]),n(!1)},X=()=>{const U=vp.json_to_sheet([{:"",:""}]);U["!cols"]=[{wch:15},{wch:15}];const S=vp.book_new();vp.book_append_sheet(S,U,""),$V(S,"__.xlsx")},re=async U=>{const S=U.target.files[0];if(!S)return;n(!0);const I=new FileReader;I.onload=async O=>{const N=O.target.result,R=Uv(N,{type:"binary"}),z=R.SheetNames[0],K=R.Sheets[z],Z=vp.sheet_to_json(K).map(V=>({name:V.,student_id:String(V.).padStart(5,"0"),role:V.===""?"parent":V.===""?"teacher":V.===""?"admin":"student",status:"applied"})).filter(V=>V.name&&V.student_id),{error:se}=await Xe.from("applicant_pool").upsert(Z,{onConflict:"name,student_id"});se?alert("  : "+se.message):(alert(`${Z.length}   .`),G()),n(!1)},I.readAsBinaryString(S)},Q=U=>{if(!U)return null;const S=U.split("/");return S[S.length-1]},ne=async(U,S,I="",O=U.role)=>{n(!0);try{if(S==="applied"){const N=[];if(U.student_signature){const z=Q(U.student_signature);z&&N.push(Xe.storage.from("student-signatures").remove([z]))}if(U.parent_signature){const z=Q(U.parent_signature);z&&N.push(Xe.storage.from("parent-signatures").remove([z]))}N.length>0&&await Promise.all(N);const{error:R}=await Xe.from("applicant_pool").update({status:"applied",rejection_reason:null,phone_number:null,pledge_accepted:!1,privacy_accepted:!1,student_signature:null,parent_signature:null,pledged_at:null}).eq("id",U.id);if(R)throw R}else{const N={status:S,rejection_reason:I,role:O};S==="approved"&&(N.rejection_reason=null);const{error:R}=await Xe.from("applicant_pool").update(N).eq("id",U.id);if(R)throw R}G(),h(null),c("")}catch(N){alert(" : "+(N.message||"   "))}finally{n(!1)}},J=async U=>{w(U),m(!0),setTimeout(()=>{window.print(),m(!1),w(null)},1200)},P=async()=>{if(A.length===0){alert("     .");return}n(!0);try{let U=Xe.from("applicant_pool").select("*").eq("status","approved").eq("role","student").order("student_id",{ascending:!0});const S=A.map(N=>`student_id.like.${N}%`).join(",");U=U.or(S);const{data:I,error:O}=await U;if(O)throw O;if(!I||I.length===0){alert(`${A.join(", ")}   .`);return}C(I),x(!0),T(!1),setTimeout(()=>{window.print(),x(!1),C([])},1500)}catch(U){console.error("Error fetching bulk print data:",U),alert("     .")}finally{n(!1)}},H=e.filter(U=>{const S=U.name.includes(i)||U.student_id.includes(i),I=l==="all"||U.status===l,O=d==="grade-1"?U.student_id.startsWith("1"):d==="grade-2"?U.student_id.startsWith("2"):d==="grade-3"?U.student_id.startsWith("3"):!0;return S&&I&&O}).sort((U,S)=>d==="name-asc"?U.name.localeCompare(S.name):d==="name-desc"?S.name.localeCompare(U.name):d==="id-asc"||d.startsWith("grade")?U.student_id.localeCompare(S.student_id):d==="id-desc"?S.student_id.localeCompare(U.student_id):0);return v.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 flex flex-col h-full overflow-hidden shadow-sm animate-spring-up",children:[v.jsxs("div",{className:"p-6 border-b border-gray-50 flex flex-col md:flex-row md:items-center justify-between gap-4 shrink-0",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 rounded-[6px] bg-ios-indigo/10 flex items-center justify-center",children:v.jsx(Wd,{className:"w-5 h-5 text-ios-indigo"})}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-[14px] font-black text-[#1C1C1E]",children:"    "}),v.jsx("p",{className:"text-[10px] text-ios-gray font-black uppercase tracking-widest mt-0.5",children:"Applicant Pool Management"})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("button",{onClick:()=>T(!0),className:"flex items-center gap-2 bg-white hover:bg-gray-50 text-[#1C1C1E] px-4 py-2.5 rounded-[6px] text-xs font-black transition-all border border-gray-200 ios-tap",children:[v.jsx(Fl,{className:"w-4 h-4 text-ios-indigo"}),"  "]}),v.jsxs("button",{onClick:X,className:"flex items-center gap-2 bg-white hover:bg-gray-50 text-[#1C1C1E] px-4 py-2.5 rounded-[6px] text-xs font-black transition-all border border-gray-200 ios-tap",children:[v.jsx(k8,{className:"w-4 h-4 text-ios-indigo"})," "]}),v.jsxs("label",{className:"flex items-center gap-2 bg-[#1C1C1E] hover:bg-[#2C2C2E] text-white px-4 py-2.5 rounded-[6px] text-xs font-black transition-all border border-transparent cursor-pointer ios-tap shadow-sm",children:[v.jsx(bO,{className:"w-4 h-4 text-white"})," ",v.jsx("input",{type:"file",className:"hidden",accept:".xlsx,.xls",onChange:re})]})]})]}),v.jsxs("div",{className:"px-6 py-4 bg-gray-50/50 border-b border-gray-50 flex flex-col md:flex-row gap-4 shrink-0",children:[v.jsxs("div",{className:"flex-1 relative",children:[v.jsx(ov,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{type:"text",placeholder:"   ...",value:i,onChange:U=>s(U.target.value),className:"flex-1 bg-white border border-gray-200 rounded-[6px] pl-10 pr-4 py-2 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all"}),v.jsxs("select",{value:d,onChange:U=>u(U.target.value),className:"bg-white border border-gray-200 rounded-[6px] px-3 py-2 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all outline-none cursor-pointer min-w-[140px]",children:[v.jsx("option",{value:"id-asc",children:" ()"}),v.jsx("option",{value:"id-desc",children:" ()"}),v.jsx("option",{value:"name-asc",children:" ()"}),v.jsx("option",{value:"name-desc",children:" ()"}),v.jsx("option",{value:"grade-1",children:"1 ()"}),v.jsx("option",{value:"grade-2",children:"2 ()"}),v.jsx("option",{value:"grade-3",children:"3 ()"})]})]})]}),v.jsx("div",{className:"flex gap-2",children:["all","applied","pending","approved","rejected"].map(U=>v.jsx("button",{onClick:()=>o(U),className:`px-4 py-2 rounded-[6px] text-[10px] font-black uppercase tracking-widest transition-all ${l===U?"bg-[#1C1C1E] text-white shadow-md":"bg-white text-ios-gray border border-gray-200 hover:border-ios-indigo"}`,children:U==="all"?"":U==="applied"?"":U==="pending"?"":U==="approved"?"":""},U))})]}),v.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-hide",children:[v.jsxs("table",{className:"w-full text-left border-collapse",children:[v.jsx("thead",{className:"sticky top-0 bg-gray-50/90 backdrop-blur-sm z-10",children:v.jsxs("tr",{children:[v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100 text-center",children:""}),v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100 text-center",children:""}),v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100 text-center",children:""}),v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100 text-center",children:""}),v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100 text-center",children:""}),v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100 text-center",children:""}),v.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-ios-gray uppercase tracking-widest border-b border-gray-100 text-center",children:""})]})}),v.jsx("tbody",{children:H.map(U=>v.jsxs("tr",{className:"hover:bg-gray-50 transition-colors group",children:[v.jsx("td",{className:"px-6 py-4 align-middle text-xs font-mono font-black text-ios-indigo text-center",children:U.student_id}),v.jsx("td",{className:"px-6 py-4 align-middle text-xs font-bold text-[#1C1C1E] text-center",children:U.name}),v.jsx("td",{className:"px-6 py-4 align-middle text-center",children:v.jsx("span",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest",children:"Student"})}),v.jsx("td",{className:"px-6 py-4 align-middle text-center",children:v.jsx("div",{className:"flex items-center justify-center gap-1.5 text-xs font-medium text-ios-gray",children:U.phone_number?v.jsxs(v.Fragment,{children:[v.jsx(av,{className:"w-3 h-3 text-ios-emerald"}),U.phone_number]}):"-"})}),v.jsx("td",{className:"px-6 py-4 align-middle text-center",children:U.pledge_accepted?v.jsxs("div",{className:"flex items-center justify-center gap-2 group/download",children:[v.jsxs("div",{className:"flex flex-col gap-0.5",children:[v.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-black text-ios-indigo",children:[v.jsx(y8,{className:"w-3 h-3"})," "]}),v.jsx("span",{className:"text-[9px] text-ios-gray opacity-50 font-mono",children:new Date(U.pledged_at).toLocaleDateString()})]}),v.jsx("button",{onClick:()=>J(U),className:"p-1.5 rounded-full bg-ios-indigo/5 text-ios-indigo hover:bg-ios-indigo hover:text-white transition-all shadow-sm",title:" ",children:v.jsx(Z4,{className:"w-3 h-3"})})]}):v.jsx("span",{className:"text-[10px] font-black text-ios-gray opacity-30",children:""})}),v.jsx("td",{className:"px-6 py-4 align-middle text-center",children:v.jsx("span",{className:`px-3 py-1.5 rounded-full text-[10px] font-black uppercase tracking-wider ${U.status==="approved"?"bg-[#ECFDF5] text-[#065F46]":U.status==="pending"?"bg-[#FFFBEB] text-[#92400E]":U.status==="rejected"?"bg-[#FFF1F2] text-[#9F1239]":"bg-gray-100 text-ios-gray"}`,title:U.status==="rejected"?` : ${U.rejection_reason||" "}`:"",children:U.status==="approved"?"":U.status==="pending"?" ":U.status==="rejected"?"":" "})}),v.jsx("td",{className:"px-6 py-4 align-middle text-center",children:v.jsxs("div",{className:"flex items-center justify-center gap-2",children:[v.jsx("button",{onClick:()=>ne(U,"approved"),className:"p-2 rounded-[6px] bg-ios-emerald/10 text-ios-emerald hover:bg-ios-emerald hover:text-white transition-all ios-tap shadow-sm",title:"",children:v.jsx(qs,{className:"w-4 h-4"})}),v.jsx("button",{onClick:()=>h(U),className:"p-2 rounded-[6px] bg-ios-rose/10 text-ios-rose hover:bg-ios-rose hover:text-white transition-all ios-tap shadow-sm",title:"",children:v.jsx(Tl,{className:"w-4 h-4"})}),v.jsx("button",{onClick:()=>{confirm(`${U.name}   ? (    )`)&&ne(U,"applied")},className:"p-2 rounded-[6px] bg-gray-100 text-ios-gray hover:bg-[#1C1C1E] hover:text-white transition-all ios-tap shadow-sm",title:" ",children:v.jsx(sO,{className:"w-4 h-4"})})]})})]},U.id))})]}),H.length===0&&v.jsxs("div",{className:"py-20 flex flex-col items-center justify-center text-ios-gray space-y-3",children:[v.jsx(ya,{className:"w-10 h-10 opacity-20"}),v.jsx("p",{className:"text-xs font-black",children:"  ."})]})]}),E&&v.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-50 flex items-center justify-center p-6",children:v.jsx("div",{className:"bg-white rounded-ios w-full max-w-sm shadow-2xl animate-spring-up overflow-hidden",children:v.jsxs("div",{className:"p-6 space-y-6",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("h4",{className:"text-[14px] font-black text-[#1C1C1E]",children:"  "}),v.jsx("p",{className:"text-[10px] text-ios-gray font-black uppercase tracking-widest",children:"Select Grade for Bulk Printing"})]}),v.jsx("div",{className:"grid grid-cols-3 gap-3",children:["1","2","3"].map(U=>v.jsxs("button",{onClick:()=>{j(S=>S.includes(U)?S.filter(I=>I!==U):[...S,U].sort())},className:`py-4 rounded-xl text-sm font-black transition-all ios-tap ${A.includes(U)?"bg-ios-indigo text-white shadow-lg shadow-ios-indigo/20":"bg-gray-50 text-ios-gray hover:bg-gray-100"}`,children:[U,""]},U))}),v.jsxs("div",{className:"bg-ios-amber/5 border border-ios-amber/10 rounded-xl p-4 space-y-2",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(ya,{className:"w-3.5 h-3.5 text-ios-amber"}),v.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:"  "})]}),v.jsxs("p",{className:"text-[10px] text-ios-gray font-bold leading-relaxed",children:["  ",v.jsx("span",{className:"text-ios-indigo",children:""}),"   . ",v.jsx("br",{}),"      ."]})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-2",children:[v.jsx("button",{onClick:()=>T(!1),className:"w-full py-4 bg-gray-100 text-ios-gray rounded-xl text-xs font-black ios-tap",children:""}),v.jsx("button",{onClick:P,className:"w-full py-4 bg-ios-indigo text-white rounded-xl text-xs font-black shadow-lg shadow-ios-indigo/20 ios-tap",children:" "})]})]})})}),f&&v.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-50 flex items-center justify-center p-6",children:v.jsx("div",{className:"bg-white rounded-ios w-full max-w-sm shadow-2xl animate-spring-up overflow-hidden",children:v.jsxs("div",{className:"p-6 space-y-4",children:[v.jsxs("h4",{className:"text-[14px] font-black text-[#1C1C1E]",children:[f.name,"   "]}),v.jsx("textarea",{value:a,onChange:U=>c(U.target.value),placeholder:"  ... (:   )",className:"w-full h-32 bg-gray-50 border border-gray-200 rounded-[6px] p-3 text-xs font-bold focus:ring-1 focus:ring-ios-rose transition-all resize-none"}),v.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[v.jsx("button",{onClick:()=>h(null),className:"w-full py-3 bg-gray-100 text-ios-gray rounded-[6px] text-xs font-black ios-tap",children:""}),v.jsx("button",{onClick:()=>ne(f,"rejected",a),className:"w-full py-3 bg-[#1C1C1E] text-white rounded-[6px] text-xs font-black shadow-lg shadow-black/20 ios-tap",children:" "})]})]})})}),v.jsx("div",{className:"px-6 py-3 bg-gray-50/50 border-t border-gray-50 flex items-center justify-between shrink-0",children:v.jsxs("div",{className:"flex gap-6",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-ios-indigo"}),v.jsxs("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:[": ",e.length,""]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-ios-amber"}),v.jsxs("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:[": ",e.filter(U=>U.status==="pending").length,""]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-ios-emerald"}),v.jsxs("span",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest",children:[": ",e.filter(U=>U.status==="approved").length,""]})]})]})}),g&&_.length>0&&ug.createPortal(v.jsxs("div",{id:"print-root-bulk",className:"bg-white text-black hidden print:block",children:[v.jsx("style",{children:`
                        @media print {
                            @page { 
                                size: A4 portrait; 
                                margin: 0; 
                            }
                            body { 
                                margin: 0 !important; 
                                padding: 0 !important; 
                                background: white !important;
                                -webkit-print-color-adjust: exact !important;
                                print-color-adjust: exact !important;
                            }
                            /* Hide app UI during printing */
                            body > #root { 
                                display: none !important; 
                            }
                            #print-root-bulk { display: block !important; }
                            .print-page {
                                width: 210mm !important;
                                min-height: 297mm !important;
                                margin: 0 auto !important;
                                padding: 0 !important;
                                box-sizing: border-box !important;
                                background: white !important;
                                page-break-after: always !important;
                                position: relative !important;
                                display: flex !important;
                                justify-content: center !important;
                                overflow: hidden !important;
                            }
                            .print-page:last-child { page-break-after: auto !important; }
                            .pledge-doc {
                                width: 180mm !important;
                                height: 260mm !important;
                                margin-top: 20mm !important;
                                margin-bottom: 10mm !important;
                                display: flex !important;
                                flex-direction: column !important;
                                justify-content: space-between !important;
                                font-family: 'Pretendard', 'Malgun Gothic', sans-serif !important;
                                color: #000 !important;
                            }
                            .pledge-header {
                                text-align: center !important;
                                margin-bottom: 25px !important;
                                border-bottom: 2px solid #000 !important;
                                padding-bottom: 10px !important;
                            }
                            .pledge-title {
                                font-size: 28pt !important;
                                font-weight: 900 !important;
                                letter-spacing: 10px !important;
                                margin: 0 !important;
                            }
                            .intro-text {
                                text-align: center !important;
                                font-weight: 700 !important;
                                margin-bottom: 25px !important;
                                line-height: 1.8 !important;
                                font-size: 11pt !important;
                                color: #000 !important;
                            }
                            .content-flex {
                                display: flex !important;
                                flex-wrap: wrap !important;
                                justify-content: space-between !important;
                                gap: 20px 0 !important;
                                width: 100% !important;
                            }
                            .pledge-section {
                                width: 48% !important;
                            }
                            .section-title {
                                font-size: 10pt !important;
                                font-weight: 900 !important;
                                margin-bottom: 6px !important;
                                color: #000 !important;
                                border-bottom: 1px solid #ddd !important;
                                display: inline-block !important;
                            }
                            .pledge-content {
                                font-size: 9pt !important;
                                text-align: justify !important;
                                color: #1a1a1a !important;
                                line-height: 1.5 !important;
                            }
                            .pledge-content p {
                                margin-bottom: 2px !important;
                            }
                            .info-grid {
                                display: flex !important;
                                justify-content: space-between !important;
                                margin: 30px 0 15px 0 !important;
                                border: 1.5px solid #000 !important;
                                padding: 12px 25px !important;
                                width: 100% !important;
                                box-sizing: border-box !important;
                            }
                            .info-item {
                                font-size: 11pt !important;
                                color: #000 !important;
                            }
                            .info-label {
                                font-weight: 900 !important;
                                margin-right: 8px !important;
                            }
                            .signature-block {
                                display: flex !important;
                                justify-content: space-around !important;
                                margin-top: 15px !important;
                                text-align: center !important;
                                width: 100% !important;
                            }
                            .sig-container {
                                display: flex !important;
                                flex-direction: column !important;
                                align-items: center !important;
                            }
                            .sig-pad {
                                width: 200px !important;
                                height: 80px !important;
                                border-bottom: 1.5px solid #000 !important;
                                margin-bottom: 8px !important;
                                display: flex !important;
                                align-items: center !important;
                                justify-content: center !important;
                            }
                            .sig-image {
                                max-width: 100% !important;
                                max-height: 100% !important;
                                object-fit: contain !important;
                            }
                            .sig-label {
                                font-size: 11pt !important;
                                font-weight: 800 !important;
                                color: #000 !important;
                            }
                            .footer-date {
                                text-align: center !important;
                                margin-top: 20px !important;
                                font-size: 14pt !important;
                                font-weight: 700 !important;
                                color: #000 !important;
                            }
                            .footer-school {
                                text-align: center !important;
                                margin-bottom: 0 !important;
                                font-size: 20pt !important;
                                font-weight: 900 !important;
                                color: #000 !important;
                            }
                        }
                    `}),_.map(U=>v.jsx("div",{className:"print-page",children:v.jsx(RS,{applicant:U,schoolInfo:B})},U.id))]}),document.body),p&&y&&ug.createPortal(v.jsxs("div",{id:"print-root",className:"bg-white text-black hidden print:block",children:[v.jsx("style",{children:`
                        @media print {
                            @page { 
                                size: A4 portrait; 
                                margin: 0; 
                            }
                            
                            body {
                                margin: 0 !important;
                                padding: 0 !important;
                                background: white !important;
                                -webkit-print-color-adjust: exact !important;
                                print-color-adjust: exact !important;
                            }

                            /* Hide everything except print-root */
                            body > #root {
                                display: none !important;
                            }

                            #print-root {
                                display: flex !important;
                                justify-content: center !important;
                                width: 210mm !important;
                                min-height: 297mm !important;
                                margin: 0 auto !important;
                                padding: 0 !important;
                                box-sizing: border-box !important;
                                background: white !important;
                                position: relative !important;
                                overflow: hidden !important;
                            }

                            .pledge-doc {
                                width: 180mm !important;
                                height: 260mm !important;
                                margin-top: 20mm !important;
                                margin-bottom: 10mm !important;
                                box-sizing: border-box !important;
                                color: #000 !important;
                                display: flex !important;
                                flex-direction: column !important;
                                justify-content: space-between !important;
                                font-family: 'Pretendard', 'Malgun Gothic', sans-serif !important;
                            }

                            .pledge-header {
                                text-align: center !important;
                                margin-bottom: 25px !important;
                                border-bottom: 2px solid #000 !important;
                                padding-bottom: 10px !important;
                            }

                            .pledge-title {
                                font-size: 28pt !important;
                                font-weight: 900 !important;
                                letter-spacing: 10px !important;
                                margin: 0 !important;
                            }

                            .intro-text {
                                text-align: center !important;
                                font-weight: 700 !important;
                                margin-bottom: 25px !important;
                                line-height: 1.8 !important;
                                font-size: 11pt !important;
                            }

                            .content-flex {
                                display: flex !important;
                                flex-wrap: wrap !important;
                                justify-content: space-between !important;
                                gap: 20px 0 !important;
                                width: 100% !important;
                            }

                            .pledge-section {
                                width: 48% !important;
                            }

                            .section-title {
                                font-size: 10pt !important;
                                font-weight: 900 !important;
                                margin-bottom: 6px !important;
                                color: #000 !important;
                                border-bottom: 1px solid #ddd !important;
                                display: inline-block !important;
                            }

                            .pledge-content {
                                font-size: 9pt !important;
                                text-align: justify !important;
                                color: #1a1a1a !important;
                                line-height: 1.5 !important;
                            }

                            .pledge-content p {
                                margin-bottom: 2px !important;
                            }

                            .info-grid {
                                display: flex !important;
                                justify-content: space-between !important;
                                margin: 30px 0 15px 0 !important;
                                border: 1.5px solid #000 !important;
                                padding: 12px 25px !important;
                                width: 100% !important;
                                box-sizing: border-box !important;
                            }

                            .info-item {
                                font-size: 11pt !important;
                            }

                            .info-label {
                                font-weight: 900 !important;
                                margin-right: 8px !important;
                            }

                            .signature-block {
                                display: flex !important;
                                justify-content: space-around !important;
                                margin-top: 15px !important;
                                text-align: center !important;
                                width: 100% !important;
                            }

                            .sig-container {
                                display: flex !important;
                                flex-direction: column !important;
                                align-items: center !important;
                            }

                            .sig-pad {
                                width: 200px !important;
                                height: 80px !important;
                                border-bottom: 1.5px solid #000 !important;
                                margin-bottom: 8px !important;
                                display: flex !important;
                                align-items: center !important;
                                justify-content: center !important;
                            }

                            .sig-image {
                                max-width: 100% !important;
                                max-height: 100% !important;
                                object-fit: contain !important;
                            }

                            .sig-label {
                                font-size: 11pt !important;
                                font-weight: 800 !important;
                            }

                            .footer-date {
                                text-align: center !important;
                                margin-top: 20px !important;
                                font-size: 14pt !important;
                                font-weight: 700 !important;
                            }

                            .footer-school {
                                text-align: center !important;
                                margin-bottom: 0 !important;
                                font-size: 20pt !important;
                                font-weight: 900 !important;
                            }
                        }
                        #print-root { display: none; }
                    `}),v.jsx("div",{id:"print-root",children:v.jsx(RS,{applicant:y,schoolInfo:B})})]}),document.body)]})},MS=ye.forwardRef(({penColor:e="#1C1C1E"},t)=>{const r=ye.useRef(null),[n,i]=ye.useState(!1),[s,l]=ye.useState(null);ye.useEffect(()=>{const f=r.current;if(!f)return;const h=f.getContext("2d"),d=window.devicePixelRatio||1,u=f.getBoundingClientRect();f.width=u.width*d,f.height=u.height*d,h.scale(d,d),h.strokeStyle=e,h.lineWidth=10,h.lineCap="round"},[e]),ye.useImperativeHandle(t,()=>({clear:()=>{const f=r.current;f.getContext("2d").clearRect(0,0,f.width,f.height)},getCanvas:()=>r.current,isEmpty:()=>{const f=r.current,h=f.getContext("2d");return!new Uint32Array(h.getImageData(0,0,f.width,f.height).data.buffer).some(u=>u!==0)}}));const o=f=>{const d=r.current.getBoundingClientRect(),u=f.touches?f.touches[0].clientX:f.clientX,p=f.touches?f.touches[0].clientY:f.clientY;return{x:u-d.left,y:p-d.top}},a=f=>{i(!0);const{x:h,y:d}=o(f),u=r.current.getContext("2d");u.strokeStyle=e,u.lineWidth=10,u.lineCap="round",u.beginPath(),u.moveTo(h,d)},c=f=>{const h=o(f);if(f.touches||l(h),!n)return;const d=r.current.getContext("2d");d.lineTo(h.x,h.y),d.stroke()};return v.jsxs("div",{className:"w-full h-full relative cursor-none group",onMouseEnter:()=>!n&&l(null),onMouseLeave:()=>l(null),children:[v.jsx("canvas",{ref:r,onMouseDown:a,onMouseMove:c,onMouseUp:()=>i(!1),onTouchStart:a,onTouchMove:c,onTouchEnd:()=>i(!1),className:"w-full h-full touch-none"}),s&&v.jsx("div",{className:"absolute pointer-events-none rounded-full border border-white/50 shadow-sm",style:{left:s.x,top:s.y,width:"10px",height:"10px",backgroundColor:e,transform:"translate(-50%, -50%)"}})]})}),eY=({onLoginSuccess:e})=>{const[t,r]=ye.useState("student"),[n,i]=ye.useState("login"),[s,l]=ye.useState({name:"",studentId:"",phone:"",password:"",pledgeAccepted:!1,privacyAccepted:!1}),[o,a]=ye.useState(!1),[c,f]=ye.useState(""),[h,d]=ye.useState(""),[u,p]=ye.useState(null),m=Bp.useRef(null),g=Bp.useRef(null),[x,y]=ye.useState(()=>localStorage.getItem("schoolName")||"GOE");ye.useEffect(()=>{(async()=>{const{data:L}=await Xe.from("configs").select("value").eq("key","school_info").single();L!=null&&L.value&&(y(L.value.name_en||"GOE"),localStorage.setItem("schoolInfo",JSON.stringify(L.value)))})()},[]);const w=()=>f(""),_=F=>F.replace(/[^0-9]/g,"").replace(/^(\d{0,3})(\d{0,4})(\d{0,4})$/g,"$1-$2-$3").replace(/(-{1,2})$/g,""),C=F=>{r(F),i("login"),l({...s,name:"",studentId:"",phone:"",password:""}),w()},E=async F=>{F.preventDefault(),a(!0),f(""),t==="teacher"?await T():await A(),a(!1)},T=async()=>{const F=`${s.name}@goe.edu`,{data:L,error:G}=await Xe.auth.signInWithPassword({email:F,password:s.password});if(G){f("    .");return}const{data:X}=await Xe.from("profiles").select("*").eq("id",L.user.id).single();X?e({...X,full_name:X.full_name||s.name}):f("    .")},A=async()=>{const F=(s.name||"").normalize("NFC").trim(),L=(s.studentId||"").trim(),{data:G,error:X}=await Xe.from("applicant_pool").select("*").eq("name",F).eq("student_id",L).maybeSingle();if(X){f("    .     .");return}if(!G){f("   /  .");return}if(p(G),t==="parent"&&(!G.phone_number||!G.pledge_accepted)){f("     .");return}G.status==="applied"?(l(re=>({...re,phone:"",pledgeAccepted:!1,privacyAccepted:!1})),i("pledge")):G.status==="pending"?i("pending"):G.status==="rejected"?(d(G.rejection_reason||"  ,   ."),i("rejected")):G.status==="approved"&&i("challenge")},j=async F=>{var L,G;if(F.preventDefault(),!s.pledgeAccepted||!s.privacyAccepted){f("    .");return}if(s.phone.length<10){f("   .");return}if((L=m.current)!=null&&L.isEmpty()||(G=g.current)!=null&&G.isEmpty()){f("     .");return}a(!0),f("");try{const X=async(J,P)=>{const H=J.getCanvas();return new Promise((U,S)=>{H.toBlob(async I=>{if(!I){S(new Error("    ."));return}const O=`${u.student_id}_${Date.now()}.png`,{data:N,error:R}=await Xe.storage.from(P).upload(O,I,{contentType:"image/png",upsert:!0});if(R)S(R);else{const{data:{publicUrl:z}}=Xe.storage.from(P).getPublicUrl(O);U(z)}},"image/png")})},re=await X(m.current,"student-signatures"),Q=await X(g.current,"parent-signatures"),{error:ne}=await Xe.from("applicant_pool").update({phone_number:s.phone,pledge_accepted:!0,privacy_accepted:!0,student_signature:re,parent_signature:Q,pledged_at:new Date().toISOString(),status:"pending"}).eq("id",u.id);if(ne)throw ne;i("pending")}catch(X){f("    : "+(X.message||"   "))}finally{a(!1)}},B=async F=>{F.preventDefault(),s.phone===u.phone_number?e({...u,full_name:u.name,role:t}):f("     .")};return v.jsx("div",{className:"min-h-screen bg-[#F2F2F7] flex items-center justify-center p-6 font-sans",children:v.jsxs("div",{className:"w-full max-w-md bg-white rounded-[2rem] shadow-2xl shadow-ios-indigo/10 overflow-hidden animate-spring-up border border-gray-100",children:[v.jsxs("div",{className:"bg-white p-10 text-[#1C1C1E] relative overflow-hidden border-b border-gray-100",children:[v.jsxs("div",{className:"relative z-10 space-y-2",children:[v.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gray-50 flex items-center justify-center mb-6 border border-gray-100 shadow-sm overflow-hidden",children:v.jsx(fg,{className:"w-7 h-7 text-ios-indigo"})}),v.jsx("h1",{className:"text-3xl font-black tracking-tighter leading-none",children:x}),v.jsx("p",{className:"text-[10px] font-black tracking-[0.3em] uppercase text-ios-indigo",children:"Study Cafe System"})]}),v.jsx("div",{className:"absolute -right-10 -top-10 w-40 h-40 bg-ios-indigo/5 rounded-full blur-3xl"})]}),v.jsxs("div",{className:"p-8 space-y-8",children:[n==="login"&&v.jsx("div",{className:"flex bg-gray-50 p-1.5 rounded-2xl gap-1",children:[{id:"student",label:"",icon:N8},{id:"parent",label:"",icon:Wd},{id:"teacher",label:"",icon:a8}].map(F=>v.jsxs("button",{onClick:()=>C(F.id),className:`flex-1 flex items-center justify-center gap-2 py-3 rounded-xl text-xs font-black transition-all ${t===F.id?"bg-white text-ios-indigo shadow-md":"text-ios-gray hover:text-[#1C1C1E]"}`,children:[v.jsx(F.icon,{className:`w-3.5 h-3.5 ${t===F.id?"text-ios-indigo":"text-ios-gray"}`}),F.label]},F.id))}),n==="login"&&v.jsxs("form",{onSubmit:E,className:"space-y-6",children:[v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"relative group",children:[v.jsx(hd,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),v.jsx("input",{required:!0,type:"text",placeholder:t==="teacher"?" (ID)":" (ID)",value:s.name,onChange:F=>l({...s,name:F.target.value}),autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false",className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none caret-ios-indigo"})]}),v.jsxs("div",{className:"relative group",children:[v.jsx(B8,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),v.jsx("input",{required:!0,type:t==="teacher"?"password":"text",placeholder:t==="teacher"?" (PW)":" 5 (PW)",maxLength:t==="teacher"?void 0:5,value:t==="teacher"?s.password:s.studentId,onChange:F=>l(t==="teacher"?{...s,password:F.target.value}:{...s,studentId:F.target.value}),autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false",className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none caret-ios-indigo"})]})]}),c&&v.jsxs("div",{className:"flex items-center gap-2 text-ios-rose bg-ios-rose/5 p-4 rounded-xl animate-shake",children:[v.jsx(ya,{className:"w-4 h-4 shrink-0"}),v.jsx("p",{className:"text-[11px] font-black",children:c})]}),v.jsx("button",{type:"submit",disabled:o,className:"w-full py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-sm flex items-center justify-center gap-2 hover:scale-[1.02] active:scale-[0.98] transition-all shadow-xl shadow-gray-200/50 ios-tap disabled:opacity-50",children:o?v.jsx(wm,{className:"w-4 h-4 animate-spin"}):v.jsxs(v.Fragment,{children:[" ",v.jsx(t8,{className:"w-4 h-4"})]})})]}),n==="pledge"&&v.jsxs("form",{onSubmit:j,className:"space-y-6 animate-spring-up",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight text-center",children:"  "}),v.jsx("p",{className:"text-[11px] text-ios-gray text-center font-bold",children:"         ,           ."})]}),v.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 max-h-48 overflow-y-auto space-y-4 text-[11px] font-bold text-ios-gray leading-relaxed border border-gray-100",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[    ]"}),v.jsx("p",{children:"1.     ,       ."}),v.jsx("p",{children:"2.        ."}),v.jsx("p",{children:"3.       , ,      ."}),v.jsx("p",{children:"4.      ,         ."}),v.jsx("p",{children:"5.       ,       ."})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[    ]"}),v.jsx("p",{children:"1.    ,        ."}),v.jsx("p",{children:"2.         ."}),v.jsx("p",{children:"3.          ."})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[   ]"}),v.jsx("p",{children:"1.             ."}),v.jsx("p",{children:"2.          ."})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[   ]"}),v.jsx("p",{children:"1.        ."}),v.jsx("p",{children:"2.         ,    ."}),v.jsx("p",{children:"3.   ,  ."})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[    ]"}),v.jsx("p",{children:"1.             ."}),v.jsx("p",{children:"2.          ."})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[#1C1C1E] font-black",children:"[  ]"}),v.jsx("p",{children:"1.            ."}),v.jsx("p",{children:"2.        ,        ."})]})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"relative group",children:[v.jsx(av,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),v.jsx("input",{required:!0,type:"tel",autoComplete:"off",placeholder:"   ( )",value:s.phone,onChange:F=>l({...s,phone:_(F.target.value)}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none caret-ios-indigo"})]}),v.jsxs("label",{className:"flex items-start gap-3 p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100 transition-all border border-transparent hover:border-gray-200",children:[v.jsx("input",{type:"checkbox",checked:s.pledgeAccepted,onChange:F=>l({...s,pledgeAccepted:F.target.checked}),className:"mt-0.5"}),v.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:"      . ()"})]}),v.jsxs("label",{className:"flex items-start gap-3 p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100 transition-all border border-transparent hover:border-gray-200",children:[v.jsx("input",{type:"checkbox",checked:s.privacyAccepted,onChange:F=>l({...s,privacyAccepted:F.target.checked}),className:"mt-0.5"}),v.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:"    . ()"})]}),v.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-100",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:" "}),v.jsxs("button",{type:"button",onClick:()=>{var F;return(F=m.current)==null?void 0:F.clear()},className:"text-[10px] text-ios-gray font-bold flex items-center gap-1 hover:text-ios-rose transition-colors",children:[v.jsx(M_,{className:"w-3 h-3"})," "]})]}),v.jsx("div",{className:"bg-gray-50 rounded-2xl border border-gray-100 overflow-hidden h-32 relative",children:v.jsx(MS,{ref:m,penColor:"#1C1C1E"})})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:" "}),v.jsxs("button",{type:"button",onClick:()=>{var F;return(F=g.current)==null?void 0:F.clear()},className:"text-[10px] text-ios-gray font-bold flex items-center gap-1 hover:text-ios-rose transition-colors",children:[v.jsx(M_,{className:"w-3 h-3"})," "]})]}),v.jsx("div",{className:"bg-gray-50 rounded-2xl border border-gray-100 overflow-hidden h-32 relative",children:v.jsx(MS,{ref:g,penColor:"#1C1C1E"})}),v.jsx("p",{className:"text-[10px] text-ios-rose font-black text-center pt-1 animate-pulse",children:".     ."})]})]})]}),c&&v.jsx("div",{className:"text-ios-rose text-[11px] font-black text-center",children:c}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{type:"button",onClick:()=>i("login"),className:"flex-1 py-4 bg-gray-100 text-ios-gray rounded-2xl font-black text-sm ios-tap",children:""}),v.jsx("button",{type:"submit",disabled:o,className:"flex-[2] py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-sm shadow-xl shadow-gray-200/50 ios-tap",children:o?v.jsx(wm,{className:"w-4 h-4 animate-spin mx-auto"}):"   "})]})]}),n==="pending"&&v.jsxs("div",{className:"text-center space-y-6 py-4 animate-spring-up",children:[v.jsx("div",{className:"w-20 h-20 rounded-[2rem] bg-ios-amber/10 flex items-center justify-center mx-auto mb-2 border border-ios-amber/20 shadow-inner",children:v.jsx(wm,{className:"w-10 h-10 text-ios-amber animate-spin"})}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:"  "}),v.jsx("p",{className:"text-xs text-ios-gray font-medium leading-relaxed px-4",children:"   .      ."})]}),v.jsx("button",{onClick:()=>i("login"),className:"text-xs font-black text-ios-indigo uppercase tracking-widest",children:""})]}),n==="rejected"&&v.jsxs("div",{className:"text-center space-y-6 py-4 animate-spring-up",children:[v.jsx("div",{className:"w-20 h-20 rounded-[2rem] bg-ios-rose/10 flex items-center justify-center mx-auto mb-2 border border-ios-rose/20 shadow-inner",children:v.jsx(ya,{className:"w-10 h-10 text-ios-rose"})}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:" "}),v.jsxs("div",{className:"bg-ios-rose/5 p-4 rounded-xl mt-4 max-w-[280px] mx-auto text-left",children:[v.jsx("p",{className:"text-[9px] font-black text-ios-rose/70 uppercase mb-1 tracking-widest",children:""}),v.jsx("p",{className:"text-[11px] font-bold text-ios-rose leading-relaxed",children:h})]})]}),v.jsx("button",{onClick:()=>i("login"),className:"w-full py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-xs shadow-xl shadow-gray-200/50 ios-tap uppercase tracking-widest",children:" "})]}),n==="challenge"&&v.jsxs("form",{onSubmit:B,className:"space-y-6 animate-spring-up",children:[v.jsxs("div",{className:"text-center space-y-4",children:[v.jsx("div",{className:"w-20 h-20 rounded-[2rem] bg-ios-emerald/10 flex items-center justify-center mx-auto border border-ios-emerald/20 shadow-inner",children:v.jsx(z2,{className:"w-10 h-10 text-ios-emerald"})}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("h2",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:t==="parent"?" ":" "}),v.jsx("p",{className:"text-[11px] text-ios-gray font-bold",children:t==="parent"?"   .":"   ."})]})]}),v.jsxs("div",{className:"relative group",children:[v.jsx(av,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-ios-gray group-focus-within:text-ios-indigo transition-colors"}),v.jsx("input",{required:!0,type:"tel",placeholder:t==="parent"?"  ":"  ",value:s.phone,onChange:F=>l({...s,phone:_(F.target.value)}),className:"w-full bg-gray-50 border border-transparent focus:border-ios-indigo focus:bg-white rounded-2xl pl-12 pr-6 py-4 text-sm font-bold transition-all outline-none caret-ios-indigo"})]}),c&&v.jsx("div",{className:"text-ios-rose text-[11px] font-black text-center animate-shake",children:c}),v.jsx("button",{type:"submit",className:"w-full py-4 bg-white text-[#1C1C1E] border border-gray-100 rounded-2xl font-black text-sm shadow-xl shadow-gray-200/50 ios-tap",children:t==="parent"?"  ":"  "})]})]})]})})},tY=({onLogout:e,currentUser:t})=>{const[r,n]=ye.useState("home"),[i,s]=ye.useState(""),[l,o]=ye.useState({bookings:[],attendance:[],currentSession:null,nextSession:null}),[a,c]=ye.useState({}),[f,h]=ye.useState(new Date),[d,u]=ye.useState({present:0,late:0,absent:0,history:[]}),[p,m]=ye.useState(!0),g=()=>h(T=>FT(T)),x=()=>h(T=>p1(T,1)),y=(T,A)=>{var H,U;if(!A||!A.bookings.length)return null;const j=new Date,B=ct(j,"yyyy-MM-dd"),{bookings:F,attendance:L}=A;if(T>B)return{label:"",color:"text-ios-indigo bg-ios-indigo/10"};if(T<B)return L.length?L.some(I=>I.status==="late")?{label:"",color:"text-ios-amber bg-ios-amber/10"}:{label:"",color:"text-ios-emerald bg-ios-emerald/10"}:{label:"",color:"text-ios-rose bg-ios-rose/10"};const G=ct(j,"HH:mm:ss"),X=[...F].sort((S,I)=>{var O,N;return(((O=S.sessions)==null?void 0:O.start_time)||"").localeCompare(((N=I.sessions)==null?void 0:N.start_time)||"")});if(!X.length)return null;const re=(H=X[0].sessions)==null?void 0:H.start_time,Q=(U=X[X.length-1].sessions)==null?void 0:U.end_time,ne=F.some(S=>{var I;return(((I=S.sessions)==null?void 0:I.start_time)||"")>="17:00:00"}),J=G>="09:00:00"&&G<="17:00:00",P=X.find(S=>{const I=S.sessions;return I&&G>=I.start_time&&G<=I.end_time});return P?L.find(I=>I.booking_id===P.id)?{label:"",color:"text-white bg-ios-emerald"}:{label:"",color:"text-ios-rose bg-ios-rose/10"}:J&&ne?{label:"",color:"text-gray-400 bg-gray-100"}:Q&&G>Q?{label:"",color:"text-gray-500 bg-gray-100"}:re&&G<re?{label:"",color:"text-ios-indigo bg-ios-indigo/10"}:{label:"",color:"text-ios-amber bg-ios-amber/10"}},w=()=>{const{bookings:T,attendance:A,currentSession:j}=l;if(T.length===0)return{label:"  ",color:"bg-gray-100 text-gray-400",sub:"   ."};const B=T.find(L=>L.session_id===(j==null?void 0:j.id)),F=A.length>0;if(B)return A.find(G=>G.booking_id===B.id)?{label:" ",color:"bg-ios-emerald text-white",sub:`${B.sessions.name}  `}:{label:"",color:"bg-ios-rose text-white",sub:"    ."};if(F){const L=[...A].sort((G,X)=>(X.timestamp_in||"").localeCompare(G.timestamp_in||""))[0];return L.timestamp_out?{label:" ",color:"bg-gray-800 text-white",sub:`${ct(new Date(L.timestamp_out),"HH:mm")}  `}:{label:" ",color:"bg-ios-amber text-white",sub:"    ."}}return{label:" ",color:"bg-ios-indigo text-white",sub:"   ."}},_=()=>{var j,B;const{bookings:T}=l;if(T.length===0)return"-";const A=[...T].sort((F,L)=>{var G,X;return(((G=F.sessions)==null?void 0:G.end_time)||"").localeCompare(((X=L.sessions)==null?void 0:X.end_time)||"")}).pop();return((B=(j=A==null?void 0:A.sessions)==null?void 0:j.end_time)==null?void 0:B.substring(0,5))||"-"};ye.useEffect(()=>{const T=async()=>{if(!t)return;const B=ct(new Date,"yyyy-MM-dd"),{data:F}=await Xe.from("bookings").select("*, sessions (*), attendance (*)").or(`student_id.eq.${t.id},user_id.eq.${t.id}`).eq("date",B).order("session_id",{ascending:!0}),L=Mn(f,{weekStartsOn:1}),G=No(f,{weekStartsOn:1}),{data:X}=await Xe.from("bookings").select(`
          *,
          sessions (id, start_time, end_time),
          attendance (id, booking_id, status, timestamp_in, timestamp_out)
        `).or(`student_id.eq.${t.id},user_id.eq.${t.id}`).gte("date",ct(L,"yyyy-MM-dd")).lte("date",ct(G,"yyyy-MM-dd"));if(X){const Q={};X.forEach(ne=>{const J=ne.date;Q[J]||(Q[J]={bookings:[],attendance:[]}),Q[J].bookings.push(ne),ne.attendance&&ne.attendance.length>0&&Q[J].attendance.push(...ne.attendance)}),c(Q)}const{data:re}=await Xe.from("sessions").select("*").order("start_time");if(re){const ne=ct(new Date,"HH:mm:ss"),J=re.find(H=>ne>=H.start_time&&ne<=H.end_time),P=re.find(H=>H.start_time>ne);o({bookings:F||[],attendance:(F==null?void 0:F.flatMap(H=>H.attendance))||[],currentSession:J,nextSession:P})}if(r==="stats"||p){const Q=ct(uq(new Date),"yyyy-MM-dd"),ne=ct(dq(new Date),"yyyy-MM-dd"),[J,P]=await Promise.all([Xe.from("bookings").select("id, date, session_id, attendance (status, timestamp_in)").or(`student_id.eq.${t.id},user_id.eq.${t.id}`).gte("date",Q).lte("date",ne).order("date",{ascending:!1}),Xe.from("study_plans").select("date, session_id, content").or(`student_id.eq.${t.id},user_id.eq.${t.id}`).gte("date",Q).lte("date",ne)]),H=J.data,U=P.data;if(H){const S={present:0,late:0,absent:0},I=[];H.forEach(O=>{var R;const N=(R=O.attendance)==null?void 0:R[0];if(N){N.status==="present"?S.present++:N.status==="late"?S.late++:N.status==="absent"&&S.absent++;const z=U==null?void 0:U.find(K=>K.date===O.date&&K.session_id===O.session_id);I.push({date:O.date,status:N.status,time:N.timestamp_in?ct(new Date(N.timestamp_in),"HH:mm"):"-",content:(z==null?void 0:z.content)||null})}}),u({...S,history:I.sort((O,N)=>N.date.localeCompare(O.date)).slice(0,15)})}}m(!1)},A=async()=>{var F;const{data:B}=await Xe.from("configs").select("value").eq("key","school_info").single();(F=B==null?void 0:B.value)!=null&&F.name_en&&s(B.value.name_en)};T(),A();const j=setInterval(T,6e4);return()=>clearInterval(j)},[t,f,r,p]);const C=()=>{var B,F;const T=w(),A=_(),j=(B=l.attendance.find(L=>L.timestamp_out))==null?void 0:B.timestamp_out;return v.jsxs("div",{className:"h-full p-4 flex flex-col gap-2 animate-fade-in relative scrollbar-hide",children:[v.jsxs("div",{className:"flex-[2] glass-card pt-8 pb-5 px-5 flex flex-col items-center text-center relative overflow-hidden",children:[v.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-ios-indigo/10 blur-3xl -z-10"}),v.jsx("div",{className:`px-6 py-2 rounded-full text-[13px] font-black uppercase tracking-widest ${T.color} shadow-lg shadow-current/10`,children:T.label}),v.jsx("div",{className:"flex-1 flex flex-col items-center justify-center space-y-3",children:v.jsx("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:t==null?void 0:t.full_name})}),v.jsxs("div",{className:"w-full grid grid-cols-3 gap-2 pt-4 border-t border-gray-50",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("p",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest",children:" "}),v.jsx("p",{className:"text-[11px] font-black text-[#1C1C1E]",children:((F=l.bookings[0])==null?void 0:F.seat_number)||"-"})]}),v.jsxs("div",{className:"space-y-1 border-l border-gray-50",children:[v.jsx("p",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest",children:" "}),v.jsx("p",{className:"text-[11px] font-black text-[#1C1C1E] underline decoration-ios-indigo/30 underline-offset-4",children:A})]}),v.jsxs("div",{className:"space-y-1 border-l border-gray-50",children:[v.jsx("p",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest",children:" "}),v.jsx("p",{className:"text-[11px] font-black text-ios-indigo",children:j?ct(new Date(j),"HH:mm"):"--:--"})]})]})]}),v.jsxs("div",{className:"flex-1 glass-card p-5 flex flex-col justify-center space-y-2",children:[v.jsxs("div",{className:"flex items-center justify-between mb-1",children:[v.jsx("h3",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest",children:"  "}),v.jsxs("div",{className:"flex items-center gap-1",children:[v.jsx("div",{className:"w-1 h-1 rounded-full bg-ios-emerald shadow-[0_0_8px_rgba(52,199,89,0.5)]"}),v.jsx("span",{className:"text-[11px] font-black text-ios-emerald uppercase",children:"Live"})]})]}),v.jsx("div",{className:"space-y-2 overflow-y-auto max-h-[120px] pr-1 scrollbar-hide",children:l.bookings.length>0?l.bookings.map((L,G)=>{var Q,ne,J,P;const X=(Q=L.attendance)==null?void 0:Q[0],re=X?X.status==="present"?{label:"",color:"text-ios-emerald bg-ios-emerald/10"}:X.status==="late"?{label:"",color:"text-ios-amber bg-ios-amber/10"}:{label:"",color:"text-ios-rose bg-ios-rose/10"}:{label:"",color:"text-gray-400 bg-gray-50"};return v.jsxs("div",{className:`flex items-center justify-between py-2 ${G!==l.bookings.length-1?"border-b border-gray-50":""}`,children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${(X==null?void 0:X.status)==="present"?"bg-ios-emerald":(X==null?void 0:X.status)==="late"?"bg-ios-amber":"bg-gray-200"}`}),v.jsxs("div",{children:[v.jsx("p",{className:"text-[11px] font-black text-[#1C1C1E] leading-none mb-1",children:(ne=L.sessions)==null?void 0:ne.name}),v.jsxs("p",{className:"text-[11px] font-bold text-ios-gray leading-none",children:[(J=L.sessions)==null?void 0:J.start_time.substring(0,5)," - ",(P=L.sessions)==null?void 0:P.end_time.substring(0,5)]})]})]}),v.jsx("span",{className:`text-[11px] font-black px-2 py-0.5 rounded-full ${re.color}`,children:re.label})]},L.id)}):v.jsx("div",{className:"flex flex-col items-center justify-center py-4 bg-gray-50 rounded-2xl",children:v.jsx("p",{className:"text-[11px] font-black text-ios-gray",children:"   ."})})})]}),v.jsxs("div",{className:"flex-1 glass-card p-5 flex flex-col justify-center items-center",children:[v.jsxs("div",{className:"w-full flex items-center justify-between mb-3 px-1",children:[v.jsx("h3",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest",children:"   "}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("span",{className:"text-[11px] font-black text-[#1C1C1E]",children:[ct(Mn(f,{weekStartsOn:1}),"yyyy.MM.dd",{locale:Qn})," - ",ct(No(f,{weekStartsOn:1}),"yyyy.MM.dd",{locale:Qn})]}),v.jsx("button",{onClick:g,className:"p-1 hover:text-black text-gray-400 ios-tap",children:v.jsx(jo,{className:"w-3 h-3"})}),v.jsx("button",{onClick:x,className:"p-1 hover:text-black text-gray-400 ios-tap",children:v.jsx(Cs,{className:"w-3 h-3"})})]})]}),v.jsx("div",{className:"flex justify-between items-center w-full",children:tu({start:Mn(f,{weekStartsOn:1}),end:No(f,{weekStartsOn:1})}).map((L,G)=>{const X=ct(L,"yyyy-MM-dd"),re=a[X],Q=y(X,re),ne=Nl(L,new Date);let J=ne?"bg-[#1C1C1E] text-white shadow-md":"bg-white border border-gray-100 text-gray-300";return(Q==null?void 0:Q.label)===""||(Q==null?void 0:Q.label)===""||(Q==null?void 0:Q.label)===""?J="bg-ios-emerald text-white shadow-sm border-none":(Q==null?void 0:Q.label)===""?J="bg-ios-amber text-white shadow-sm border-none":(Q==null?void 0:Q.label)===""||(Q==null?void 0:Q.label)===""?J="bg-ios-rose text-white shadow-sm border-none":(Q==null?void 0:Q.label)===""&&(J="bg-ios-indigo text-white shadow-sm border-none"),v.jsxs("div",{className:"flex flex-col items-center gap-1.5",children:[v.jsx("span",{className:`text-[11px] font-black ${ne?"text-[#1C1C1E]":"text-gray-300"}`,children:["","","","","","",""][G]}),v.jsx("div",{className:`w-7 h-7 rounded-full flex items-center justify-center text-[11px] font-black transition-all ${J}`,children:ct(L,"d")}),v.jsx("div",{className:"h-3 flex items-center justify-center",children:Q?v.jsx("span",{className:`text-[11px] font-bold px-1 py-0.5 rounded-full whitespace-nowrap ${Q.color}`,children:Q.label}):v.jsx("div",{className:"w-1 h-1 rounded-full bg-transparent"})})]},G)})})]})]})},E=()=>v.jsxs("div",{className:"p-5 space-y-6 animate-fade-in scrollbar-hide",children:[v.jsxs("div",{className:"glass-card p-8 relative overflow-hidden",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-6 text-ios-indigo",children:[v.jsx(L_,{className:"w-4 h-4"}),v.jsx("h3",{className:"text-xs font-black uppercase tracking-widest",children:"   "})]}),v.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[v.jsxs("div",{className:"flex flex-col items-center p-4 bg-ios-emerald/5 rounded-apple",children:[v.jsx("span",{className:"text-[10px] font-black text-ios-emerald uppercase opacity-60 mb-1",children:""}),v.jsx("span",{className:"text-2xl font-black text-ios-emerald",children:d.present})]}),v.jsxs("div",{className:"flex flex-col items-center p-4 bg-ios-amber/5 rounded-apple",children:[v.jsx("span",{className:"text-[10px] font-black text-ios-amber uppercase opacity-60 mb-1",children:""}),v.jsx("span",{className:"text-2xl font-black text-ios-amber",children:d.late})]}),v.jsxs("div",{className:"flex flex-col items-center p-4 bg-ios-rose/5 rounded-apple",children:[v.jsx("span",{className:"text-[10px] font-black text-ios-rose uppercase opacity-60 mb-1",children:""}),v.jsx("span",{className:"text-2xl font-black text-ios-rose",children:d.absent})]})]})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-center justify-between px-2",children:[v.jsx("h3",{className:"text-xs font-black text-[#1C1C1E] uppercase tracking-widest",children:"  "}),v.jsx("span",{className:"text-[10px] font-bold text-ios-gray",children:" 15"})]}),v.jsx("div",{className:"space-y-3",children:d.history.length>0?d.history.map((T,A)=>v.jsxs("div",{className:"bg-white p-4 rounded-apple border border-gray-100 shadow-sm space-y-3 transition-all active:scale-[0.98]",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:`w-2 h-2 rounded-full ${T.status==="present"?"bg-ios-emerald":T.status==="late"?"bg-ios-amber":"bg-ios-rose"}`}),v.jsxs("div",{className:"space-y-0.5",children:[v.jsx("p",{className:"text-xs font-black text-[#1C1C1E]",children:ct(new Date(T.date),"M d (EEE)",{locale:Qn})}),v.jsx("p",{className:"text-[10px] font-bold text-ios-gray uppercase tracking-widest leading-none",children:T.status==="present"?" ":T.status==="late"?"":""})]})]}),v.jsxs("div",{className:"text-right",children:[v.jsx("p",{className:"text-xs font-black text-ios-gray",children:T.time!=="-"?T.time:"--:--"}),v.jsx("p",{className:"text-[9px] font-bold text-ios-gray/40 uppercase tracking-tighter leading-none",children:"Entry Time"})]})]}),T.content&&v.jsxs("div",{className:"pt-3 border-t border-gray-50 flex gap-3",children:[v.jsx("div",{className:"p-2 bg-ios-indigo/5 rounded-apple flex-shrink-0",children:v.jsx(U2,{className:"w-3.5 h-3.5 text-ios-indigo"})}),v.jsx("div",{className:"flex-1",children:v.jsxs("p",{className:"text-[11px] font-bold text-gray-700 leading-relaxed italic",children:['"',T.content,'"']})})]})]},A)):v.jsxs("div",{className:"py-20 text-center space-y-2",children:[v.jsx(Vc,{className:"w-10 h-10 text-gray-200 mx-auto"}),v.jsx("p",{className:"text-xs font-black text-ios-gray",children:"  ."})]})})]})]});return v.jsxs("div",{className:"mobile-container flex flex-col bg-[#F2F2F7] h-screen overflow-hidden font-sans pb-[safe-area-inset-bottom]",children:[v.jsxs("header",{className:"flex-none glass-header px-6 pt-10 pb-4 flex items-center justify-between shadow-sm",children:[v.jsxs("div",{className:"flex flex-col",children:[v.jsx("h1",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:i.split(" ")[0]}),v.jsx("p",{className:"text-[10px] font-black text-ios-indigo tracking-[0.2em] uppercase opacity-70",children:"PARENT VIEW"})]}),v.jsx("button",{onClick:e,className:"p-3 bg-gray-200/20 text-ios-gray hover:text-ios-rose hover:bg-ios-rose/10 rounded-apple-md transition-all ios-tap border border-white/40 backdrop-blur-xl",children:v.jsx(Jg,{className:"w-5 h-5"})})]}),v.jsx("main",{className:"flex-1 overflow-hidden relative",children:p?v.jsxs("div",{className:"h-full flex flex-col items-center justify-center space-y-4 animate-pulse",children:[v.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-[2rem]"}),v.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded-full"})]}):v.jsx("div",{className:"h-full overflow-y-auto scrollbar-hide",children:r==="home"?C():E()})}),v.jsx("nav",{className:"flex-none glass-material pb-[calc(1rem+env(safe-area-inset-bottom))] pt-3 px-16 flex justify-around items-center z-50 shadow-[0_-4px_40px_rgba(0,0,0,0.03)] border-t border-white/40",children:[{id:"home",icon:e3,label:""},{id:"stats",icon:L_,label:""}].map(T=>v.jsxs("button",{onClick:()=>n(T.id),className:`flex flex-col items-center justify-center p-2 rounded-apple-md transition-all duration-300 w-20 group ios-tap ${r===T.id?"text-[#1C1C1E]":"text-gray-300 hover:text-gray-500"}`,children:[v.jsx(T.icon,{className:`w-7 h-7 stroke-[2.5px] ${r===T.id?"fill-ios-indigo/10":"fill-transparent"}`}),v.jsx("span",{className:"text-[9px] font-black mt-1",children:T.label})]},T.id))})]})},rY=()=>{const[e,t]=ye.useState(new Date),[r,n]=ye.useState([]),[i,s]=ye.useState(null),[l,o]=ye.useState([]),[a,c]=ye.useState([]),[f,h]=ye.useState([]),[d,u]=ye.useState([]),[p,m]=ye.useState(!0),[g,x]=ye.useState(!1),[y,w]=ye.useState(!1),[_,C]=ye.useState(!1),[E,T]=ye.useState({date:ct(new Date,"yyyy-MM-dd"),reason:"",is_closed:!0}),[A,j]=ye.useState(new Date().getFullYear()),[B,F]=ye.useState(new Date().getFullYear());ye.useEffect(()=>{L()},[]);const L=async()=>{const{data:R}=await Xe.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});R&&R.length>0&&(n(R),s(R[0].id))};ye.useEffect(()=>{i&&G(A,i)},[A,i]);const G=async(R,z)=>{m(!0);const[K,Y,Z]=await Promise.all([Xe.from("operation_quarters").select("*").eq("academic_year",R).order("quarter",{ascending:!0}),Xe.from("operation_exceptions").select("*").eq("zone_id",z).order("exception_date",{ascending:!0}),Xe.from("sessions").select("*").eq("zone_id",z).order("start_time",{ascending:!0})]),se=Z.data||[];u(se);const V=K.data||[],ae=[1,2,3,4].map(be=>V.find(xe=>xe.quarter===be)||{quarter:be,start_date:null,end_date:null,academic_year:R}),W=V.filter(be=>be.quarter>4);o([...ae,...W].sort((be,pe)=>be.quarter-pe.quarter));const{data:he}=await Xe.from("session_operating_days").select("session_id, day_of_week").in("session_id",se.map(be=>be.id)).eq("is_active",!0),fe=he||[],Te=[0,1,2,3,4,5,6].map(be=>{const pe=fe.filter(xe=>xe.day_of_week===be).map(xe=>xe.session_id);return{day_of_week:be,active_session_ids:pe}});c(Te),Y.data&&h(Y.data),m(!1)},X=()=>{j(B)},re=(R,z,K)=>{const Y=l.map(Z=>Z.quarter===R?{...Z,[z]:K}:Z);o(Y)},Q=async()=>{x(!0);const R=l.filter(K=>K.start_date||K.end_date).map(({id:K,quarter:Y,start_date:Z,end_date:se,quarter_name:V})=>({quarter:Y,start_date:Z||null,end_date:se||null,quarter_name:V||`${Y}`,academic_year:A})),{error:z}=await Xe.from("operation_quarters").upsert(R,{onConflict:"academic_year, quarter"});z?alert("     : "+z.message):(alert("   ."),G(A)),x(!1)},ne=async R=>{const z=l.find(K=>K.quarter===R);if(z){if(z.start_date&&z.end_date){const{count:K,error:Y}=await Xe.from("bookings").select("*",{count:"exact",head:!0}).gte("date",z.start_date).lte("date",z.end_date);if(Y)console.error("Error checking bookings:",Y);else if(K>0){if(!window.confirm(` (${z.start_date} ~ ${z.end_date})  ${K}  .    ?
(    ,    .)`))return}else if(!window.confirm(`${R}   ?`))return}else if(!window.confirm(`${R}  ?`))return;try{const{error:K}=await Xe.from("operation_quarters").delete().eq("academic_year",A).eq("quarter",R);if(K)throw K;R<=4?o(Y=>Y.map(Z=>Z.quarter===R?{...Z,start_date:null,end_date:null,quarter_name:null}:Z)):o(Y=>Y.filter(Z=>Z.quarter!==R)),alert(`${R}   .`)}catch(K){console.error("Error deleting quarter:",K),alert("   .")}}},J=()=>{const R=l.length>0?Math.max(...l.map(z=>z.quarter)):0;o([...l,{quarter:R+1,start_date:null,end_date:null,academic_year:A}])},P=(R,z)=>{c(K=>K.map(Y=>{if(Y.day_of_week!==R)return Y;const Z=Y.active_session_ids.includes(z)?Y.active_session_ids.filter(se=>se!==z):[...Y.active_session_ids,z];return{...Y,active_session_ids:Z}}))},H=async()=>{w(!0);try{const R=[];a.forEach(K=>{d.forEach(Y=>{R.push({session_id:Y.id,day_of_week:K.day_of_week,is_active:K.active_session_ids.includes(Y.id)})})});const{error:z}=await Xe.from("session_operating_days").upsert(R,{onConflict:"session_id, day_of_week"});if(z)throw z;alert("    ."),G(A,i)}catch(R){alert("      : "+R.message)}finally{w(!1)}},U=async R=>{if(R.preventDefault(),!i)return;const{error:z}=await Xe.from("operation_exceptions").insert([{exception_date:E.date,reason:E.reason,is_closed:!0,zone_id:i}]);z||(T({...E,reason:""}),G(A,i))},S=async R=>{await Xe.from("operation_exceptions").delete().eq("id",R),G(A)},I=()=>v.jsx("div",{className:"flex flex-col gap-6 mb-4 px-2",children:v.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:v.jsxs("div",{className:"flex items-center gap-8 flex-wrap",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("button",{onClick:()=>t(g1(e)),className:"p-1.5 hover:bg-gray-100 rounded-lg transition-colors ios-tap",children:v.jsx(jo,{className:"w-5 h-5 text-ios-gray"})}),v.jsxs("div",{className:"text-center",children:[v.jsx("h3",{className:"text-xl font-black text-[#1C1C1E] tracking-tight",children:ct(e,"yyyy MMMM",{locale:Qn})}),v.jsx("p",{className:"text-[10px] font-black text-ios-indigo uppercase tracking-widest mt-0.5",children:"Operating Calendar"})]}),v.jsx("button",{onClick:()=>t(Qd(e,1)),className:"p-1.5 hover:bg-gray-100 rounded-lg transition-colors ios-tap",children:v.jsx(Cs,{className:"w-5 h-5 text-ios-gray"})})]}),v.jsx("div",{className:"flex gap-1.5 flex-wrap",children:r.map(R=>v.jsx("button",{onClick:()=>s(R.id),className:`px-5 py-2 rounded-apple-md text-[11px] font-black transition-all border ios-tap ${i===R.id?"bg-[#1C1C1E] text-white border-[#1C1C1E] shadow-sm":"bg-white text-ios-gray border-gray-100 hover:text-[#1C1C1E] hover:border-gray-200"}`,children:R.name},R.id))})]})})}),O=()=>{const R=["","","","","","",""],z=_?R:R.slice(1,6);return v.jsx("div",{className:`grid ${_?"grid-cols-7":"grid-cols-5"} mb-2 border-b border-gray-100 sticky top-0 z-10 bg-white`,children:z.map((K,Y)=>{const Z=_?Y:Y+1;return v.jsx("div",{className:`py-3 text-[10px] font-black uppercase text-center tracking-widest ${Z===0?"text-ios-rose":Z===6?"text-ios-indigo":"text-ios-gray"}`,children:K},Z)})})},N=()=>{const R=_f(e),z=Ld(R),K=Mn(R,{weekStartsOn:_?0:1}),Y=No(z,{weekStartsOn:_?0:1});let Z=tu({start:K,end:Y});return _||(Z=Z.filter(se=>se.getDay()!==0&&se.getDay()!==6)),v.jsx("div",{className:`grid ${_?"grid-cols-7":"grid-cols-5"} gap-px bg-gray-100 border border-gray-100 rounded-[12px] overflow-hidden shadow-sm`,children:Z.map((se,V)=>{var xe;const le=Nl(se,new Date),ae=$v(se,R),W=se.getDay(),he=ct(se,"yyyy-MM-dd"),fe=f.find(ce=>ce.exception_date===he),Te=l.find(ce=>ce.start_date&&ce.end_date&&zc(se,{start:Cr(ce.start_date),end:Cr(ce.end_date)})),be=a.find(ce=>ce.day_of_week===W),pe=Te&&!fe&&((xe=be==null?void 0:be.active_session_ids)==null?void 0:xe.length)>0;return v.jsxs("div",{className:`min-h-[100px] p-2 flex flex-col gap-1 transition-colors border-b border-r border-gray-100 ${ae?fe?"bg-red-50/30":pe?"bg-[#f0f9ff]":"bg-white":"opacity-30 bg-gray-50"}`,children:[v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsx("span",{className:`text-[11px] font-black ${le?"w-6 h-6 text-ios-indigo border-2 border-ios-indigo rounded-full flex items-center justify-center -mt-1 -ml-1 bg-white":W===0?"text-ios-rose":W===6?"text-ios-indigo":"text-[#1C1C1E]"}`,children:ct(se,"d")}),Te&&v.jsxs("span",{className:"text-[8px] font-black bg-white/50 text-ios-indigo px-1.5 py-0.5 rounded-full uppercase tracking-tighter border border-ios-indigo/10",children:["Q",Te.quarter]})]}),fe?v.jsxs("div",{className:"mt-1 flex flex-col gap-1",children:[v.jsx("span",{className:"text-[10px] font-black text-red-600 uppercase tracking-widest",children:"CLOSED"}),v.jsx("span",{className:"text-[9px] font-bold text-ios-gray leading-tight",children:fe.reason})]}):pe?v.jsx("div",{className:"mt-1 flex flex-col gap-0.5",children:d.map(ce=>{var Ie;const Ne=(Ie=be==null?void 0:be.active_session_ids)==null?void 0:Ie.includes(ce.id);return v.jsxs("div",{className:"flex justify-between items-center bg-white/40 rounded-[2px] px-1 py-0.5",children:[v.jsx("span",{className:"text-[8px] font-bold text-ios-gray truncate max-w-[40px]",children:ce.name}),v.jsx("span",{className:`text-[8px] font-black uppercase tracking-wider ${Ne?"text-ios-indigo":"text-red-400 opacity-30"}`,children:Ne?"ON":"OFF"})]},ce.id)})}):null]},V)})})};return p?v.jsx("div",{className:"h-full flex items-center justify-center",children:v.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-ios-indigo"})}):v.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 h-full overflow-hidden p-1",children:[v.jsxs("div",{className:"flex-1 min-h-0 bg-white rounded-[6px] border border-gray-100 flex flex-col p-6 shadow-sm overflow-hidden",children:[I(),v.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 pr-1",children:[O(),N(),v.jsx("div",{className:"mt-3 flex justify-start pb-2",children:v.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[v.jsxs("div",{className:"relative",children:[v.jsx("input",{type:"checkbox",className:"sr-only peer",checked:_,onChange:R=>C(R.target.checked)}),v.jsx("div",{className:"w-10 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-ios-indigo"})]}),v.jsx("span",{className:"text-[11px] font-black text-ios-gray uppercase tracking-widest peer-checked:text-[#1C1C1E] transition-colors",children:"/ "})]})})]})]}),v.jsxs("div",{className:"lg:w-96 shrink-0 flex flex-col gap-6 overflow-y-auto pb-6 pr-2",children:[v.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 p-6 shadow-sm",children:[v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(Pl,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h4",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"  "})]}),v.jsx("div",{className:"flex gap-2",children:v.jsxs("button",{onClick:Q,disabled:g,className:"bg-[#1C1C1E] text-white px-5 py-2.5 rounded-[8px] text-[11px] font-black uppercase tracking-widest flex items-center gap-2 hover:bg-gray-800 shadow-md transition-all active:scale-95",children:[v.jsx(fd,{className:"w-3.5 h-3.5"})," "]})})]}),v.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-[8px] border border-gray-100",children:[v.jsx("label",{className:"block text-[10px] font-black text-ios-gray uppercase tracking-widest mb-2",children:" "}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("select",{value:B,onChange:R=>F(Number(R.target.value)),className:"flex-1 bg-white border border-gray-200 rounded-[6px] px-3 py-2 text-xs font-bold text-[#1C1C1E] focus:outline-none focus:ring-1 focus:ring-ios-indigo",children:[A-2,A-1,A,A+1,A+2].sort().map(R=>v.jsxs("option",{value:R,children:[R,""]},R))}),v.jsx("button",{onClick:X,className:"bg-[#1C1C1E] text-white px-3 py-2 rounded-[6px] text-[10px] font-black uppercase whitespace-nowrap hover:bg-gray-800 transition-colors",children:""})]})]}),v.jsxs("div",{className:"space-y-6",children:[l.map(R=>v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("p",{className:"text-[11px] font-black text-ios-indigo",children:[R.quarter,""]}),(R.start_date||R.end_date||R.quarter>4)&&v.jsx("button",{onClick:()=>ne(R.quarter),className:"p-1 text-ios-gray hover:text-ios-rose transition-colors",title:" ",children:v.jsx(jl,{className:"w-3 h-3"})})]}),v.jsxs("span",{className:"text-[8px] font-bold text-ios-gray bg-gray-50 px-2 py-0.5 rounded-full uppercase tracking-widest",children:["Year ",A," - Q",R.quarter]})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[v.jsx("input",{type:"date",value:R.start_date||"",onChange:z=>re(R.quarter,"start_date",z.target.value),className:"bg-gray-50 border-none rounded-[6px] px-3 py-2 text-[11px] font-bold focus:ring-1 focus:ring-ios-indigo transition-all"}),v.jsx("input",{type:"date",value:R.end_date||"",onChange:z=>re(R.quarter,"end_date",z.target.value),className:"bg-gray-50 border-none rounded-[6px] px-3 py-2 text-[11px] font-bold focus:ring-1 focus:ring-ios-indigo transition-all"})]})]},R.quarter)),v.jsxs("button",{onClick:J,className:"w-full py-3 bg-gray-50 text-ios-gray border border-dashed border-gray-200 rounded-[6px] text-[10px] font-black uppercase tracking-wider flex items-center justify-center gap-1.5 hover:bg-gray-100 hover:text-[#1C1C1E] hover:border-gray-300 transition-all active:scale-95",children:[v.jsx(ud,{className:"w-3.5 h-3.5"}),"  "]})]})]}),v.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 p-6 shadow-sm",children:[v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(Pl,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h4",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"   "})]}),v.jsxs("button",{onClick:H,disabled:y,className:"bg-[#1C1C1E] text-white px-5 py-2.5 rounded-[8px] text-[11px] font-black uppercase tracking-widest flex items-center gap-2 hover:bg-gray-800 shadow-md transition-all active:scale-95",children:[v.jsx(fd,{className:"w-3.5 h-3.5"})," "]})]}),v.jsxs("div",{className:"space-y-1 overflow-x-auto min-w-0",children:[v.jsxs("div",{className:"grid gap-2 pb-2 border-b border-gray-100 mb-2",style:{gridTemplateColumns:`40px repeat(${d.length}, minmax(40px, 1fr))`},children:[v.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest",children:""}),d.map(R=>v.jsx("div",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest text-center truncate px-1",title:R.name,children:R.name},R.id))]}),[1,2,3,4,5,6,0].map(R=>{const z=a.find(K=>K.day_of_week===R)||{active_session_ids:[]};return v.jsxs("div",{className:"grid gap-2 items-center py-2 hover:bg-gray-50 rounded-[4px] transition-colors",style:{gridTemplateColumns:`40px repeat(${d.length}, minmax(40px, 1fr))`},children:[v.jsx("span",{className:`text-[10px] font-black ${R===0?"text-ios-rose":R===6?"text-ios-indigo":"text-[#1C1C1E]"}`,children:["","","","","","",""][R]}),d.map(K=>{var Y;return v.jsx("div",{className:"flex justify-center",children:v.jsx("input",{type:"checkbox",checked:(Y=z.active_session_ids)==null?void 0:Y.includes(K.id),onChange:()=>P(R,K.id),className:"w-4 h-4 rounded-full border-gray-200 text-ios-indigo focus:ring-ios-indigo/20 transition-all cursor-pointer"})},K.id)})]},R)})]})]}),v.jsxs("div",{className:"bg-white rounded-[6px] border border-gray-100 p-6 shadow-sm flex-1",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[v.jsx(ya,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h4",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"()  "})]}),v.jsxs("form",{onSubmit:U,className:"space-y-4 mb-8",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("p",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest px-1",children:" "}),v.jsx("input",{type:"date",value:E.date,onChange:R=>T({...E,date:R.target.value}),className:"w-full bg-gray-50 border-none rounded-[6px] px-3 py-3 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all outline-none"})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("p",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest px-1",children:" "}),v.jsx("input",{type:"text",placeholder:": ,   ",value:E.reason,onChange:R=>T({...E,reason:R.target.value}),className:"w-full bg-gray-50 border-none rounded-[6px] px-3 py-3 text-xs font-bold focus:ring-1 focus:ring-ios-indigo transition-all outline-none"})]}),v.jsxs("button",{type:"submit",disabled:!E.reason,className:"w-full py-3 bg-[#1C1C1E] text-white rounded-[6px] font-black text-[11px] uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-gray-800 transition-all disabled:opacity-30 disabled:hover:bg-[#1C1C1E]",children:[v.jsx(ud,{className:"w-3 h-3"})," "]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-[8px] font-black text-ios-gray uppercase tracking-widest px-1 border-b border-gray-50 pb-2 mb-4",children:"  "}),v.jsxs("div",{className:"space-y-3 max-h-60 overflow-y-auto pr-2 scrollbar-hide",children:[f.length===0&&v.jsx("p",{className:"text-[10px] text-ios-gray italic text-center py-4",children:"  ."}),f.map(R=>v.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-[6px] hover:bg-ios-rose/5 transition-all group border border-transparent hover:border-ios-rose/10",children:[v.jsxs("div",{className:"flex-1",children:[v.jsx("p",{className:"text-[11px] font-black text-[#1C1C1E]",children:R.exception_date}),v.jsx("p",{className:"text-[9px] font-bold text-ios-gray truncate",children:R.reason})]}),v.jsx("button",{onClick:()=>S(R.id),className:"p-1.5 text-ios-gray hover:text-ios-rose transition-colors opacity-0 group-hover:opacity-100",children:v.jsx(jl,{className:"w-3.5 h-3.5"})})]},R.id))]})]})]})]})]})},nY=()=>{var w,_;const[e,t]=ye.useState(!0),[r,n]=ye.useState(!1),[i,s]=ye.useState(null),[l,o]=ye.useState(!1),[a,c]=ye.useState(""),[f,h]=ye.useState(""),[d,u]=ye.useState(""),[p,m]=ye.useState({points:[{lat:37.5665,lng:126.978,name:" "}],radius:100}),g=C=>{m(C)};ye.useEffect(()=>{x()},[]);const x=async()=>{t(!0);try{const{data:C,error:E}=await Xe.from("configs").select("*").eq("key","school_info").single();if(E&&E.code!=="PGRST116")throw E;C&&(c(C.value.name||""),h(C.value.name_en||""),u(C.value.level||""));const{data:T,error:A}=await Xe.from("configs").select("*").eq("key","gps_settings").single();if(A&&A.code!=="PGRST116")throw A;T!=null&&T.value&&(T.value.points?m(T.value):T.value.lat&&m({points:[{lat:T.value.lat,lng:T.value.lng,name:" "}],radius:T.value.radius||100}))}catch(C){console.error("Error fetching initial data:",C),s("    .")}finally{t(!1)}},y=async()=>{n(!0),s(null),o(!1);try{await Xe.from("configs").upsert({key:"school_info",value:{name:a,name_en:f,level:d}});const{error:C}=await Xe.from("configs").upsert({key:"gps_settings",value:p});if(C)throw C;o(!0),setTimeout(()=>o(!1),2e3)}catch(C){console.error("Save error:",C),s("   : "+C.message)}finally{n(!1)}};return e?v.jsxs("div",{className:"h-full flex flex-col items-center justify-center bg-white rounded-t-[6px]",children:[v.jsx("div",{className:"w-10 h-10 border-4 border-ios-indigo/20 border-t-ios-indigo rounded-full animate-spin mb-4"}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"   ..."})]}):v.jsxs("div",{className:"bg-white rounded-t-[6px] h-full flex flex-col overflow-hidden animate-spring-up",children:[v.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide p-8 pb-32",children:v.jsxs("div",{className:"max-w-4xl mx-auto space-y-12",children:[v.jsxs("div",{className:"flex items-center justify-between bg-gray-50/50 p-6 rounded-2xl border border-gray-100",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:"w-12 h-12 rounded-xl bg-[#1C1C1E] flex items-center justify-center shadow-lg",children:v.jsx(hg,{className:"w-6 h-6 text-white"})}),v.jsxs("div",{children:[v.jsx("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:" "}),v.jsx("p",{className:"text-sm text-ios-gray font-bold",children:"        ."})]})]}),i&&v.jsxs("div",{className:"flex items-center gap-2 bg-ios-rose/10 px-4 py-2 rounded-lg border border-ios-rose/20 text-ios-rose font-bold text-xs animate-shake",children:[v.jsx(ya,{className:"w-4 h-4"})," ",i]})]}),v.jsxs("section",{className:"space-y-6",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[v.jsx(uO,{className:"w-5 h-5 text-ios-indigo"}),v.jsx("h3",{className:"text-lg font-black text-[#1C1C1E]",children:"  "})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 auto-rows-min",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest ml-1",children:" "}),v.jsx("input",{type:"text",value:a,onChange:C=>c(C.target.value),className:"w-full bg-gray-50 border border-gray-100 focus:bg-white focus:border-ios-indigo/20 rounded-xl px-5 py-4 text-base font-bold text-[#1C1C1E] transition-all outline-none"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest ml-1",children:"  ()"}),v.jsx("input",{type:"text",value:f,onChange:C=>h(C.target.value),className:"w-full bg-gray-50 border border-gray-100 focus:bg-white focus:border-ios-indigo/20 rounded-xl px-5 py-4 text-base font-bold text-[#1C1C1E] transition-all outline-none",placeholder:"APP    ."})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest ml-1",children:""}),v.jsxs("div",{className:"relative",children:[v.jsxs("select",{value:d,onChange:C=>u(C.target.value),className:"w-full bg-gray-50 border border-gray-100 focus:bg-white focus:border-ios-indigo/20 rounded-xl px-5 py-4 text-base font-bold text-[#1C1C1E] transition-all outline-none appearance-none cursor-pointer",children:[v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""}),v.jsx("option",{value:"",children:""})]}),v.jsx("div",{className:"absolute right-5 top-1/2 -translate-y-1/2 pointer-events-none text-ios-gray",children:v.jsx(hg,{className:"w-4 h-4 opacity-30"})})]})]})]})]}),v.jsx("hr",{className:"border-gray-100"}),v.jsxs("section",{className:"space-y-6 animate-fade-in",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[v.jsx($8,{className:"w-5 h-5 text-ios-rose"}),v.jsx("h3",{className:"text-lg font-black text-[#1C1C1E]",children:"   "})]}),v.jsxs("div",{className:"bg-gray-50/50 p-6 rounded-2xl border border-gray-100 space-y-8",children:[v.jsxs("div",{className:"flex items-start gap-3 p-4 bg-ios-amber/5 border border-ios-amber/10 rounded-xl",children:[v.jsx(t3,{className:"w-4 h-4 text-ios-amber mt-0.5"}),v.jsxs("p",{className:"text-xs text-ios-amber font-bold leading-relaxed",children:["     GPS     .",v.jsx("br",{}),"     (Zone)  ."]})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsx("div",{className:"flex items-center justify-between",children:v.jsx("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest flex items-center gap-1.5 ml-1",children:"  "})}),v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(tO,{className:"w-5 h-5 text-ios-indigo"}),v.jsx("div",{className:"flex-1",children:v.jsx("input",{type:"number",value:p.radius||100,onChange:C=>g({...p,radius:parseInt(C.target.value)}),className:"w-full bg-white border border-gray-100 rounded-xl px-4 py-3 text-sm font-bold text-[#1C1C1E] outline-none focus:ring-1 focus:ring-ios-indigo transition-all",placeholder:"  (m)"})}),v.jsx("span",{className:"text-xs font-bold text-ios-gray",children:"(m)"})]})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("label",{className:"text-[10px] font-black text-ios-gray uppercase tracking-widest flex items-center gap-1.5 ml-1",children:["   (",((w=p.points)==null?void 0:w.length)||0,")"]}),(!p.points||p.points.length<10)&&v.jsx("button",{onClick:()=>{const C=[...p.points||[]];C.push({lat:37.5665,lng:126.978,name:` ${C.length+1}`}),g({...p,points:C})},className:"text-[10px] font-bold text-ios-indigo hover:bg-ios-indigo/10 px-2 py-1 rounded transition-colors",children:"+  "})]}),v.jsx("div",{className:"space-y-3",children:(_=p.points)==null?void 0:_.map((C,E)=>v.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm relative group",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[v.jsx(jc,{className:"w-4 h-4 text-ios-rose"}),v.jsx("input",{type:"text",value:C.name||` ${E+1}`,onChange:T=>{const A=[...p.points];A[E].name=T.target.value,g({...p,points:A})},className:"text-sm font-black text-[#1C1C1E] border-none p-0 focus:ring-0 w-32 bg-transparent",placeholder:" "}),p.points.length>1&&v.jsx("button",{onClick:()=>{const T=p.points.filter((A,j)=>j!==E);g({...p,points:T})},className:"ml-auto p-1.5 text-gray-300 hover:text-ios-rose hover:bg-red-50 rounded-lg transition-colors",children:v.jsx(jl,{className:"w-3.5 h-3.5"})})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[v.jsxs("div",{children:[v.jsx("label",{className:"text-[9px] text-gray-400 font-bold mb-1 block",children:" (Latitude)"}),v.jsx("input",{type:"number",step:"0.000001",value:C.lat,onChange:T=>{const A=[...p.points];A[E].lat=parseFloat(T.target.value),g({...p,points:A})},className:"w-full bg-gray-50/50 border border-gray-100 rounded-lg px-3 py-2 text-xs font-bold font-mono text-[#1C1C1E] focus:bg-white focus:border-ios-indigo transition-all"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"text-[9px] text-gray-400 font-bold mb-1 block",children:" (Longitude)"}),v.jsx("input",{type:"number",step:"0.000001",value:C.lng,onChange:T=>{const A=[...p.points];A[E].lng=parseFloat(T.target.value),g({...p,points:A})},className:"w-full bg-gray-50/50 border border-gray-100 rounded-lg px-3 py-2 text-xs font-bold font-mono text-[#1C1C1E] focus:bg-white focus:border-ios-indigo transition-all"})]})]})]},E))})]})]})]})]})}),v.jsx("div",{className:"flex-none p-6 border-t border-gray-100 bg-white/80 backdrop-blur-xl z-20",children:v.jsxs("div",{className:"max-w-4xl mx-auto flex items-center gap-4",children:[v.jsx("button",{onClick:y,disabled:r,className:`flex-1 py-5 rounded-2xl font-black text-base flex items-center justify-center gap-3 transition-all ios-tap shadow-lg ${l?"bg-[#1C1C1E] text-white":"bg-[#1C1C1E] text-white hover:bg-gray-800"}`,children:r?v.jsx("div",{className:"w-5 h-5 border-2 border-white/20 border-t-white rounded-full animate-spin"}):l?v.jsxs(v.Fragment,{children:[v.jsx(El,{className:"w-5 h-5"}),"    "]}):v.jsxs(v.Fragment,{children:[v.jsx(fd,{className:"w-5 h-5"}),"    "]})}),l&&v.jsxs("div",{className:"bg-ios-emerald/10 text-ios-emerald px-6 py-5 rounded-2xl font-black text-sm animate-fade-in flex items-center gap-2",children:[v.jsx(qs,{className:"w-4 h-4"})," !"]})]})})]})},iY=()=>{const[e,t]=ye.useState(!0),[r,n]=ye.useState([]),[i,s]=ye.useState(null),[l,o]=ye.useState([]),[a,c]=ye.useState([]),[f,h]=ye.useState([]),[d,u]=ye.useState([]),[p,m]=ye.useState([1,2,3]),[g,x]=ye.useState(!1),[y,w]=ye.useState([]);ye.useEffect(()=>{_()},[]);const _=async()=>{t(!0);const{data:B}=await Xe.from("operation_quarters").select("*").order("academic_year",{ascending:!0}).order("quarter",{ascending:!0});if(B&&B.length>0){n(B);const L=ct(new Date,"yyyy-MM-dd");let G=B.find(X=>L>=X.start_date&&L<=X.end_date);if(!G){const X=new Date;G=B.reduce((re,Q)=>{const ne=Math.abs(new Date(re.start_date)-X);return Math.abs(new Date(Q.start_date)-X)<ne?Q:re})}G&&C(G)}const{data:F}=await Xe.from("zones").select("id").limit(1);if(F&&F.length>0){const{data:L}=await Xe.from("sessions").select("*").eq("zone_id",F[0].id).order("start_time",{ascending:!0});L&&(h(L),u(L.map(G=>G.id)))}t(!1)},C=B=>{s(B);const F=new Date(B.start_date),L=new Date(B.end_date),X=fq({start:F,end:L},{weekStartsOn:1}).map((re,Q)=>{let ne=No(re,{weekStartsOn:1});const J=re<F?F:re,P=ne>L?L:ne;return{id:Q+1,start:J,end:P,label:`${Q+1} (${ct(J,"MM/dd(eee)",{locale:Qn})} - ${ct(P,"MM/dd(eee)",{locale:Qn})})`}});o(X),c(X.map(re=>re.id))},E=B=>{c(F=>F.includes(B)?F.filter(L=>L!==B):[...F,B])},T=B=>{m(F=>F.includes(B)?F.filter(L=>L!==B):[...F,B])},A=B=>{u(F=>F.includes(B)?F.filter(L=>L!==B):[...F,B])},j=async()=>{if(a.length===0||p.length===0||d.length===0){alert(" , ,    .");return}x(!0);try{const{data:B}=await Xe.from("profiles").eq("role","student").select("*").order("grade",{ascending:!0}).order("class_number",{ascending:!0}).order("student_number",{ascending:!0});if(!B||B.length===0){alert("   ."),x(!1);return}const F=[];for(const L of a){const G=l.find(H=>H.id===L),X=ct(G.start,"yyyy-MM-dd"),re=ct(G.end,"yyyy-MM-dd"),{data:Q}=await Xe.from("bookings").select(`
                        *,
                        attendance(*)
                    `).gte("date",X).lte("date",re).in("session_id",d),ne=tu({start:G.start,end:G.end}),J=new Set((Q||[]).map(H=>H.date)),P=ne.filter(H=>{const U=[0,6].includes(H.getDay()),S=ct(H,"yyyy-MM-dd");return!U||J.has(S)});for(const H of p.sort()){const U=B.filter(O=>O.grade===H);if(U.length===0)continue;const S=U.map(O=>O.id),I=(Q||[]).filter(O=>S.includes(O.user_id));F.push({weekInfo:G,grade:H,students:U,bookings:I,businessDays:P,sessions:f.filter(O=>d.includes(O.id))})}}w(F),setTimeout(()=>{window.print(),x(!1)},1e3)}catch(B){console.error("Print error:",B),alert("     ."),x(!1)}};return e?v.jsxs("div",{className:"h-full flex flex-col items-center justify-center gap-4 bg-white/50 backdrop-blur-sm",children:[v.jsx("div",{className:"w-10 h-10 border-4 border-ios-indigo border-t-transparent rounded-full animate-spin"}),v.jsx("p",{className:"text-[13px] font-black text-ios-gray animate-pulse",children:"   ..."})]}):v.jsxs("div",{className:"h-full flex flex-col bg-[#F2F2F7]",children:[v.jsx("div",{className:"flex-1 overflow-y-auto p-8 pt-6 hide-on-print",children:v.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:"w-12 h-12 rounded-2xl bg-[#1C1C1E] flex items-center justify-center shadow-lg shadow-black/10",children:v.jsx(Fl,{className:"w-6 h-6 text-white"})}),v.jsxs("div",{children:[v.jsx("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:"  "}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"     PDF  ."})]})]}),v.jsx("button",{onClick:j,disabled:g,className:"bg-ios-indigo text-white px-8 py-4 rounded-2xl font-black text-[15px] shadow-lg shadow-ios-indigo/20 hover:scale-[1.02] active:scale-95 transition-all flex items-center gap-3 disabled:opacity-50",children:g?v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"  "]}):v.jsxs(v.Fragment,{children:[v.jsx(Z4,{className:"w-5 h-5"}),"PDF   "]})})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[v.jsxs("div",{className:"bg-white rounded-[24px] p-6 shadow-sm border border-gray-100 flex flex-col",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[v.jsx(Vc,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h3",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:" "})]}),v.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto pr-2 custom-scrollbar",children:r.map(B=>v.jsxs("button",{onClick:()=>C(B),className:`w-full text-left p-4 rounded-xl border-2 transition-all flex items-center justify-between group ${(i==null?void 0:i.id)===B.id?"bg-ios-indigo/5 border-ios-indigo text-ios-indigo":"bg-white border-gray-50 text-ios-gray hover:border-gray-200"}`,children:[v.jsxs("div",{children:[v.jsxs("p",{className:"text-[13px] font-black",children:[B.quarter_name," (",B.academic_year,")"]}),v.jsxs("p",{className:"text-[11px] opacity-70 mt-0.5",children:[ct(new Date(B.start_date),"yyyy-MM-dd(eee)",{locale:Qn})," ~ ",ct(new Date(B.end_date),"yyyy-MM-dd(eee)",{locale:Qn})]})]}),(i==null?void 0:i.id)===B.id&&v.jsx(El,{className:"w-5 h-5"})]},B.id))})]}),v.jsxs("div",{className:"space-y-6",children:[v.jsxs("div",{className:"bg-white rounded-[24px] p-6 shadow-sm border border-gray-100",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[v.jsx(Wd,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h3",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:" "})]}),v.jsx("div",{className:"flex gap-3",children:[1,2,3].map(B=>v.jsxs("button",{onClick:()=>T(B),className:`flex-1 py-3 px-4 rounded-xl font-black text-[13px] transition-all border-2 flex items-center justify-between gap-2 ${p.includes(B)?"bg-ios-indigo text-white border-ios-indigo shadow-md shadow-ios-indigo/20":"bg-white text-ios-gray border-gray-100"}`,children:[v.jsxs("span",{className:"flex-1 text-center",children:[B,""]}),p.includes(B)&&v.jsx(qs,{className:"w-4 h-4",strokeWidth:3})]},B))})]}),v.jsxs("div",{className:"bg-white rounded-[24px] p-6 shadow-sm border border-gray-100",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[v.jsx(Pl,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h3",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:" "})]}),v.jsx("div",{className:"grid grid-cols-2 gap-3",children:f.map(B=>v.jsxs("button",{onClick:()=>A(B.id),className:`py-3 px-4 rounded-xl font-black text-[12px] transition-all border-2 flex items-center justify-between ${d.includes(B.id)?"bg-ios-indigo/5 border-ios-indigo text-ios-indigo":"bg-white text-ios-gray border-gray-100"}`,children:[v.jsx("span",{children:B.name}),d.includes(B.id)&&v.jsx(qs,{className:"w-4 h-4"})]},B.id))})]})]})]}),v.jsxs("div",{className:"bg-white rounded-[24px] p-6 shadow-sm border border-gray-100",children:[v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(E8,{className:"w-4 h-4 text-ios-indigo"}),v.jsx("h3",{className:"text-sm font-black text-[#1C1C1E] uppercase tracking-wider",children:"   (A4 1/)"})]}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>c(l.map(B=>B.id)),className:"text-[11px] font-black text-ios-indigo hover:underline",children:" "}),v.jsx("span",{className:"text-gray-200",children:"|"}),v.jsx("button",{onClick:()=>c([]),className:"text-[11px] font-black text-ios-rose hover:underline",children:""})]})]}),v.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-3",children:l.map(B=>v.jsxs("button",{onClick:()=>E(B.id),className:`relative p-4 rounded-2xl border-2 transition-all group ${a.includes(B.id)?"bg-ios-indigo/5 border-ios-indigo":"bg-white border-gray-100 hover:border-gray-200"}`,children:[v.jsxs("p",{className:`text-[13px] font-black ${a.includes(B.id)?"text-ios-indigo":"text-[#1C1C1E]"}`,children:[B.id,""]}),v.jsxs("p",{className:"text-[10px] text-ios-gray font-bold mt-1",children:[ct(B.start,"MM/dd(eee)",{locale:Qn})," - ",ct(B.end,"MM/dd(eee)",{locale:Qn})]}),a.includes(B.id)&&v.jsx("div",{className:"absolute top-2 right-2 flex items-center justify-center w-5 h-5 rounded-full bg-ios-indigo text-white shadow-sm scale-110",children:v.jsx(qs,{className:"w-3 h-3",strokeWidth:4})})]},B.id))})]})]})}),v.jsxs("div",{className:`print-area ${g?"block opacity-0 pointer-events-none":"hidden"} fixed inset-0 z-[-1]`,children:[v.jsx("style",{children:`
                    @media print {
                        @page { 
                            size: A4 portrait; 
                            margin: 20mm 10mm 10mm 10mm; 
                        }
                        
                        /* Reset EVERYTHING to non-scrolling block layout */
                        html, body, #root, #root > div, main, main > div, 
                        .flex-1.flex, .admin-content-view, 
                        div[class*="rounded-2xl"], div[class*="bg-white"],
                        .flex-1.bg-\\[\\#F2F2F7\\] { 
                            height: auto !important;
                            overflow: visible !important;
                            display: block !important;
                            position: static !important;
                            margin: 0 !important;
                            padding: 0 !important;
                            border: none !important;
                            box-shadow: none !important;
                            flex: none !important;
                            width: 100% !important;
                        }

                        /* Hide app UI */
                        header, aside, .sidebar, .header, .nav-tabs, .selection-ui, .hide-on-print { 
                            display: none !important;
                        }

                        /* Force the printable content back to visible and opacity-1 */
                        .print-area { 
                            display: block !important; 
                            visibility: visible !important;
                            opacity: 1 !important;
                            position: static !important;
                            z-index: auto !important;
                        }

                        .print-area * {
                            visibility: visible !important;
                        }

                        /* Use standard flow for reliable pagination */
                        .print-area {
                            display: block !important;
                            position: static !important;
                            width: 100% !important;
                            margin: 0 !important;
                            padding: 0 !important;
                        }

                        .page-break { 
                            display: block !important;
                            page-break-after: always !important;
                            break-after: page !important;
                            width: 100% !important;
                            margin: 0 !important;
                            padding: 0 !important;
                            position: relative !important;
                        }

                        /* Ensure no top margin on the first page beyond the @page margin */
                        .page-break:first-child {
                            margin-top: 0 !important;
                        }

                        .header-row { 
                            display: flex; 
                            justify-content: space-between; 
                            align-items: flex-end; 
                            margin: 0 0 10px 0 !important; 
                            padding: 0 0 5px 0 !important;
                            border-bottom: 2px solid #000 !important; 
                        }
                        
                        .school-title { 
                            font-size: 20px !important; 
                            font-weight: 900 !important;
                            margin: 0 !important;
                            padding: 0 !important;
                            line-height: 1 !important;
                        }

                        .doc-title {
                            font-size: 10px !important;
                            margin: 0 !important;
                            padding: 0 !important;
                        }

                        .attendance-table { 
                            width: 100% !important; 
                            border-collapse: collapse !important; 
                            margin: 10px 0 0 0 !important;
                            font-size: 10px !important; 
                            table-layout: fixed !important;
                        }

                        .attendance-table th, .attendance-table td { 
                            border: 1px solid #000 !important; 
                            padding: 4px !important; 
                            text-align: center !important; 
                        }

                        .attendance-table th { 
                            background-color: #eee !important; 
                            -webkit-print-color-adjust: exact !important;
                        }
                    }
                `}),v.jsx("div",{className:"print-root",children:y.map((B,F)=>v.jsxs("div",{className:"page-break",children:[v.jsxs("div",{className:"header-row",children:[v.jsxs("h1",{className:"school-title",children:["   (",i==null?void 0:i.quarter_name,", ",B.weekInfo.id,")"]}),v.jsxs("div",{className:"doc-title",children:[ct(B.weekInfo.start,"yyyy-MM-dd(eee)",{locale:Qn})," ~ ",ct(B.weekInfo.end,"yyyy-MM-dd(eee)",{locale:Qn})]})]}),v.jsx("div",{className:"flex justify-between items-center mb-2 px-1 text-[10px] font-bold",children:v.jsxs("div",{className:"flex gap-4",children:[v.jsxs("span",{children:[": ",i==null?void 0:i.academic_year]}),v.jsxs("span",{children:[": ",B.grade,""]})]})}),v.jsxs("table",{className:"attendance-table",children:[v.jsxs("thead",{children:[v.jsxs("tr",{children:[v.jsx("th",{style:{width:"40px"},children:"No"}),v.jsx("th",{style:{width:"100px"},children:"//"}),v.jsx("th",{style:{width:"100px"},children:""}),B.businessDays.map(L=>v.jsxs("th",{colSpan:B.sessions.length,children:[ct(L,"MM/dd")," (",ct(L,"E",{locale:Qn})[0],")"]},L.toString()))]}),v.jsxs("tr",{children:[v.jsx("th",{colSpan:3,children:""}),B.businessDays.map(L=>B.sessions.map(G=>v.jsx("th",{style:{fontSize:"8px",padding:"2px 0"},children:G.name},`${L}-${G.id}`)))]})]}),v.jsx("tbody",{children:B.students.map((L,G)=>v.jsxs("tr",{children:[v.jsx("td",{children:G+1}),v.jsxs("td",{children:[L.grade,String(L.class_number).padStart(2,"0"),String(L.student_number).padStart(2,"0")]}),v.jsx("td",{style:{fontWeight:"bold"},children:L.full_name}),B.businessDays.map(X=>{const re=ct(X,"yyyy-MM-dd");return B.sessions.map(Q=>{var H,U;const ne=B.bookings.find(S=>S.user_id===L.id&&S.date===re&&S.session_id===Q.id),J=(U=(H=ne==null?void 0:ne.attendance)==null?void 0:H[0])==null?void 0:U.status,P=J==="present"?"O":J==="late"?"":J==="early"?"":ne?"":"-";return v.jsx("td",{style:{fontSize:"9px",color:J==="absent"?"#ff3b30":"inherit"},children:P},`${L.id}-${re}-${Q.id}`)})})]},L.id))})]})]},F))})]})]})},sY=()=>{var T;const[e,t]=ye.useState(!0),[r,n]=ye.useState(!1),[i,s]=ye.useState(null),[l,o]=ye.useState(!1),[a,c]=ye.useState([]),[f,h]=ye.useState(null),[d,u]=ye.useState([]);ye.useEffect(()=>{p()},[]),ye.useEffect(()=>{f&&m(f)},[f]);const p=async()=>{t(!0);try{const{data:A,error:j}=await Xe.from("zones").select("*").eq("is_active",!0).order("created_at",{ascending:!0});if(j)throw j;c(A||[]),A&&A.length>0&&h(A[0].id)}catch(A){console.error("Error fetching zones:",A),s("     .")}finally{t(!1)}},m=async A=>{try{const{data:j,error:B}=await Xe.from("sessions").select("*").eq("zone_id",A).order("start_time",{ascending:!0});if(B)throw B;u(j||[])}catch(j){console.error("Error fetching sessions:",j),s("     .")}},g=async()=>{const A=prompt("     (: 2):");if(A){n(!0);try{const{data:j,error:B}=await Xe.from("zones").insert([{name:A,settings:{points:[{lat:37.5665,lng:126.978,name:" "}],radius:100}}]).select().single();if(B)throw B;c([...a,j]),h(j.id)}catch(j){alert("  : "+j.message)}finally{n(!1)}}},x=async(A,j)=>{const B=prompt("   :",j);if(!(!B||B===j)){n(!0);try{const{error:F}=await Xe.from("zones").update({name:B}).eq("id",A);if(F)throw F;c(a.map(L=>L.id===A?{...L,name:B}:L))}catch(F){alert("  : "+F.message)}finally{n(!1)}}},y=async A=>{if(confirm("   ?       !")){n(!0);try{const{error:j}=await Xe.from("zones").delete().eq("id",A);if(j)throw j;const B=a.filter(F=>F.id!==A);c(B),B.length>0?h(B[0].id):h(null)}catch(j){alert("  : "+j.message)}finally{n(!1)}}},w=async()=>{if(!f)return;const A=prompt("   (: 3):");if(A)try{const{data:j,error:B}=await Xe.from("sessions").insert([{zone_id:f,name:A,start_time:"09:00:00",end_time:"12:00:00"}]).select().single();if(B)throw B;u([...d,j])}catch{alert("  ")}},_=async A=>{if(!confirm(" ?"))return;const{error:j}=await Xe.from("sessions").delete().eq("id",A);j?alert(" "):u(d.filter(B=>B.id!==A))},C=(A,j,B)=>{u(d.map(F=>F.id===A?{...F,[j]:B}:F))},E=async()=>{if(f){n(!0),o(!1);try{if(d.length>0){const{error:A}=await Xe.from("sessions").upsert(d.map(j=>({id:j.id,zone_id:f,name:j.name,start_time:j.start_time,end_time:j.end_time})));if(A)throw A}o(!0),setTimeout(()=>o(!1),2e3)}catch(A){console.error("Save error:",A),s("   : "+A.message),setTimeout(()=>s(null),3e3)}finally{n(!1)}}};return e?v.jsxs("div",{className:"h-full flex flex-col items-center justify-center bg-white rounded-t-[6px]",children:[v.jsx("div",{className:"w-10 h-10 border-4 border-ios-indigo/20 border-t-ios-indigo rounded-full animate-spin mb-4"}),v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"   ..."})]}):v.jsxs("div",{className:"bg-white rounded-t-[6px] h-full flex flex-col overflow-hidden animate-spring-up",children:[v.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide p-8 pb-32",children:v.jsxs("div",{className:"max-w-4xl mx-auto space-y-12",children:[v.jsxs("div",{className:"flex items-center justify-between bg-gray-50/50 p-6 rounded-2xl border border-gray-100",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:"w-12 h-12 rounded-xl bg-[#1C1C1E] flex items-center justify-center shadow-lg",children:v.jsx(Q4,{className:"w-6 h-6 text-white"})}),v.jsxs("div",{children:[v.jsx("h2",{className:"text-2xl font-black text-[#1C1C1E] tracking-tight",children:"  "}),v.jsx("p",{className:"text-sm text-ios-gray font-bold",children:"  (Zone)    ."})]})]}),i&&v.jsxs("div",{className:"flex items-center gap-2 bg-ios-rose/10 px-4 py-2 rounded-lg border border-ios-rose/20 text-ios-rose font-bold text-xs animate-shake",children:[v.jsx(ya,{className:"w-4 h-4"})," ",i]})]}),v.jsxs("section",{className:"space-y-6",children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(fg,{className:"w-5 h-5 text-ios-amber"}),v.jsx("h3",{className:"text-lg font-black text-[#1C1C1E]",children:" (Zone) "})]}),v.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-4 py-2 bg-[#1C1C1E] text-white rounded-lg text-xs font-bold shadow-lg hover:shadow-xl transition-all ios-tap",children:[v.jsx(ud,{className:"w-4 h-4"}),"  "]})]}),v.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(A=>v.jsx("div",{onClick:()=>h(A.id),className:`relative p-5 rounded-2xl border-2 transition-all cursor-pointer group ${f===A.id?"bg-ios-indigo/5 border-ios-indigo shadow-md":"bg-white border-gray-100 hover:border-gray-200"}`,children:v.jsxs("div",{className:"flex flex-col gap-1",children:[v.jsxs("div",{className:"flex items-start justify-between",children:[v.jsxs("span",{className:`text-[10px] font-black uppercase tracking-widest ${f===A.id?"text-ios-indigo":"text-ios-gray"}`,children:["ZONE #",A.id]}),v.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[v.jsx("button",{onClick:j=>{j.stopPropagation(),x(A.id,A.name)},className:"p-1.5 hover:bg-white rounded-md text-ios-gray hover:text-[#1C1C1E] shadow-sm",children:v.jsx(xO,{className:"w-3 h-3"})}),v.jsx("button",{onClick:j=>{j.stopPropagation(),y(A.id)},className:"p-1.5 hover:bg-white rounded-md text-ios-gray hover:text-ios-rose shadow-sm",children:v.jsx(jl,{className:"w-3 h-3"})})]})]}),v.jsx("h4",{className:"text-lg font-black text-[#1C1C1E]",children:A.name}),v.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[v.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${f===A.id?"bg-ios-indigo animate-pulse":"bg-gray-300"}`}),v.jsx("span",{className:"text-[11px] font-bold text-ios-gray",children:f===A.id?" ":" "})]})]})},A.id))})]}),f&&v.jsxs(v.Fragment,{children:[v.jsx("hr",{className:"border-gray-100"}),v.jsxs("section",{className:"space-y-6 animate-fade-in",children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Pl,{className:"w-5 h-5 text-ios-emerald"}),v.jsxs("h3",{className:"text-lg font-black text-[#1C1C1E]",children:["[",(T=a.find(A=>A.id===f))==null?void 0:T.name,"]   "]})]}),v.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-4 py-2 bg-[#1C1C1E] text-white rounded-lg text-xs font-bold shadow-lg hover:shadow-xl transition-all ios-tap",children:[v.jsx(x8,{className:"w-4 h-4"}),"  "]})]}),v.jsx("div",{className:"grid grid-cols-1 gap-3",children:d.length===0?v.jsx("div",{className:"p-12 text-center bg-gray-50 border border-dashed border-gray-200 rounded-2xl",children:v.jsx("p",{className:"text-sm font-bold text-ios-gray",children:"  . ' ' ."})}):d.map((A,j)=>v.jsxs("div",{className:"group flex items-center justify-between bg-white border border-gray-100 p-5 rounded-2xl hover:shadow-md transition-all",children:[v.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-50 flex items-center justify-center text-[11px] font-black text-ios-gray border border-gray-100",children:j+1}),v.jsxs("div",{className:"w-40",children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest mb-1 block",children:" "}),v.jsx("input",{type:"text",value:A.name||"",onChange:B=>C(A.id,"name",B.target.value),className:"text-sm font-black text-[#1C1C1E] bg-transparent border-none p-0 focus:ring-0 w-full"})]}),v.jsxs("div",{className:"flex items-center gap-8",children:[v.jsxs("div",{children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest mb-1 block",children:""}),v.jsx("input",{type:"time",value:A.start_time||"",onChange:B=>C(A.id,"start_time",B.target.value),className:"text-sm font-black text-[#1C1C1E] border-none p-0 bg-transparent focus:ring-0 w-32 pr-2"})]}),v.jsx(Cs,{className:"w-4 h-4 text-gray-200 mt-4"}),v.jsxs("div",{children:[v.jsx("label",{className:"text-[9px] font-black text-ios-gray uppercase tracking-widest mb-1 block",children:""}),v.jsx("input",{type:"time",value:A.end_time||"",onChange:B=>C(A.id,"end_time",B.target.value),className:"text-sm font-black text-[#1C1C1E] border-none p-0 bg-transparent focus:ring-0 w-32 pr-2"})]})]})]}),v.jsx("button",{onClick:()=>_(A.id),className:"p-2.5 text-ios-gray hover:text-ios-rose hover:bg-ios-rose/5 rounded-xl transition-all opacity-0 group-hover:opacity-100",children:v.jsx(jl,{className:"w-4 h-4"})})]},A.id))})]})]})]})}),v.jsx("div",{className:"flex-none p-6 border-t border-gray-100 bg-white/80 backdrop-blur-xl z-20",children:v.jsxs("div",{className:"max-w-4xl mx-auto flex items-center gap-4",children:[v.jsx("button",{onClick:E,disabled:r,className:`flex-1 py-5 rounded-2xl font-black text-base flex items-center justify-center gap-3 transition-all ios-tap shadow-lg ${l?"bg-ios-emerald text-white":"bg-[#1C1C1E] text-white hover:bg-gray-800"}`,children:r?v.jsx("div",{className:"w-5 h-5 border-2 border-white/20 border-t-white rounded-full animate-spin"}):l?v.jsxs(v.Fragment,{children:[v.jsx(El,{className:"w-5 h-5"}),"    "]}):v.jsxs(v.Fragment,{children:[v.jsx(fd,{className:"w-5 h-5"}),"    "]})}),l&&v.jsxs("div",{className:"bg-ios-emerald/10 text-ios-emerald px-6 py-5 rounded-2xl font-black text-sm animate-fade-in flex items-center gap-2",children:[v.jsx(qs,{className:"w-4 h-4"}),"  ."]})]})})]})};function aY(){const[e,t]=ye.useState(()=>{const Q=localStorage.getItem("activeTab");if(Q)return Q;const ne=localStorage.getItem("currentUser");if(ne)try{const J=JSON.parse(ne);if(["admin","teacher"].includes(J.role))return"admin"}catch(J){console.error("Failed to parse saved user",J)}return"map"}),[r,n]=ye.useState(()=>localStorage.getItem("adminSubTab")||"attendance"),[i,s]=ye.useState(null),[l,o]=ye.useState(()=>{const Q=localStorage.getItem("currentUser");return Q?JSON.parse(Q):null}),[a,c]=ye.useState(ct(new Date,"yyyy-MM-dd")),[f,h]=ye.useState(null),[d,u]=ye.useState(()=>{const Q=localStorage.getItem("schoolInfo");return Q?JSON.parse(Q):{name:"POGOK",name_en:"POGOK",level:""}}),[p,m]=ye.useState(""),[g,x]=ye.useState([]),[y,w]=ye.useState(null),[_,C]=ye.useState(!1),[E,T]=ye.useState(()=>window.innerWidth<768&&window.innerHeight>window.innerWidth),[A,j]=ye.useState(!1);ye.useEffect(()=>{const Q=()=>{T(window.innerWidth<768&&window.innerHeight>window.innerWidth)};return window.addEventListener("resize",Q),()=>window.removeEventListener("resize",Q)},[]);const B=async Q=>{const ne=Q.trim();if(!ne)return;C(!0);let J=[];try{const{data:P,error:H}=await Xe.from("profiles_student").select("*").or(`full_name.ilike.%${ne}%,username.ilike.%${ne}%`).limit(50);H?console.error("[Search Error]",H):P&&(J=P.map(U=>({id:U.id,full_name:U.full_name,username:U.username,grade:U.grade||0,class_number:U.class_number||0,student_number:U.student_number||0,role:"student"}))),x(J)}catch(P){console.error("Search Error:",P),x([])}finally{C(!1)}};ye.useEffect(()=>{(async()=>{const{data:ne}=await Xe.from("configs").select("value").eq("key","school_info").single();ne!=null&&ne.value&&(u(ne.value),localStorage.setItem("schoolInfo",JSON.stringify(ne.value)))})()},[]),ye.useEffect(()=>{l?localStorage.setItem("currentUser",JSON.stringify(l)):localStorage.removeItem("currentUser")},[l]),ye.useEffect(()=>{localStorage.setItem("activeTab",e)},[e]),ye.useEffect(()=>{localStorage.setItem("adminSubTab",r)},[r]);const F=Q=>{h(Q),s(null)},L=()=>{o(null),localStorage.removeItem("currentUser"),localStorage.removeItem("activeTab"),localStorage.removeItem("adminSubTab"),t("map")};if(!l)return v.jsx(eY,{onLoginSuccess:Q=>{o(Q),["admin","teacher"].includes(Q.role)&&t("admin")}});const G=[{id:"admin",icon:hg,label:"/ ",roles:["admin","teacher"]},{id:"map",icon:fg,label:"",roles:["admin","student","parent","teacher"]},{id:"attendance",icon:jc,label:" ",roles:["student"]},{id:"profile",icon:hd,label:"  ",roles:["student","parent"]}].filter(Q=>!Q.roles||Q.roles.includes(l.role)),X=[{group:" ",items:[{id:"attendance",label:"  ",icon:ov,roles:["admin","teacher"]},{id:"attendance_print",label:" ",icon:Fl,roles:["admin","teacher"]},{id:"safety",label:" /",icon:z2,roles:["admin","teacher"]}]},{group:"   ",items:[{id:"zones",label:"  ",icon:Q4,roles:["admin"]},{id:"layout",label:"  ",icon:sv,roles:["admin"]},{id:"students",label:"  ",icon:Wd,roles:["admin"]},{id:"schedule",label:"  ",icon:Vc,roles:["admin"]}]},{group:" ",items:[{id:"settings",label:" ",icon:hg,roles:["admin"]}]}].map(Q=>({...Q,items:Q.items.filter(ne=>ne.roles.includes(l.role))})).filter(Q=>Q.items.length>0);return["admin","teacher"].includes(l.role),l.role==="teacher"||l.role==="admin"&&E?v.jsx(YX,{onLogout:L,currentUser:l}):l.role==="student"?v.jsx(JX,{onLogout:L,currentUser:l}):l.role==="parent"?v.jsx(tY,{onLogout:L,currentUser:l}):v.jsxs("div",{className:"flex flex-col h-screen bg-[#F2F2F7] text-[#1C1C1E] overflow-hidden font-sans selection:bg-ios-indigo/10",children:[v.jsxs("header",{className:"glass-header px-4 py-2.5 lg:px-8 flex items-center justify-between shadow-sm",children:[v.jsxs("div",{className:"flex items-center gap-6",children:[v.jsxs("div",{className:"flex items-center gap-3 group cursor-default",children:[v.jsx("div",{className:"w-9 h-9 rounded-apple-md bg-[#1C1C1E] flex items-center justify-center shadow-lg shadow-black/5 group-hover:scale-105 transition-transform",children:v.jsx(fg,{className:"w-5 h-5 text-white"})}),v.jsxs("div",{children:[v.jsx("h1",{className:"text-lg font-black tracking-tighter leading-none text-[#1C1C1E]",children:d.name_en||"GOE"}),v.jsx("p",{className:"text-[9px] font-black text-ios-indigo tracking-widest uppercase opacity-60 mt-1",children:"Study Cafe"})]})]}),v.jsx("nav",{className:"flex items-center gap-1 bg-gray-200/20 backdrop-blur-2xl p-1 rounded-apple-md border border-white/40 ml-4",children:G.map(Q=>v.jsxs("button",{onClick:()=>t(Q.id),className:`flex items-center gap-2 px-5 py-2 rounded-apple-md transition-all duration-300 ios-tap group relative ${e===Q.id?"bg-white shadow-sm text-[#1C1C1E]":"text-[#1C1C1E]/50 hover:text-[#1C1C1E] hover:bg-white/40"}`,children:[v.jsx(Q.icon,{className:`w-4 h-4 transition-all duration-300 ${e===Q.id?"text-ios-indigo":"group-hover:scale-110"}`}),v.jsx("span",{className:"font-black text-[13px]",children:Q.label})]},Q.id))}),e==="map"&&["admin","teacher"].includes(l.role)&&v.jsxs("div",{className:"relative ml-4 z-50",children:[y?v.jsxs("div",{className:"flex items-center gap-3 bg-white px-3 py-1.5 rounded-[12px] border-2 border-ios-indigo/20 shadow-sm animate-fade-in-scale",children:[v.jsxs("div",{className:"flex items-center gap-2 pr-2 border-r border-gray-100",children:[v.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-100 text-gray-700 flex items-center justify-center text-[10px] font-black shadow-sm border border-gray-200",children:y.full_name[0]}),v.jsxs("div",{className:"flex flex-col gap-0.5",children:[v.jsx("span",{className:"text-[12px] font-black text-[#1C1C1E]",children:y.full_name}),v.jsxs("span",{className:"text-[9px] text-gray-500 font-medium",children:["   (",y.username,")"]})]})]}),v.jsxs("button",{onClick:()=>{m(""),x([]),w(null)},className:"flex items-center gap-1.5 bg-gray-50 hover:bg-ios-rose/10 text-gray-500 hover:text-ios-rose px-2 py-1.5 rounded-[8px] transition-all group",children:[v.jsx(nO,{className:"w-3 h-3 group-hover:rotate-180 transition-transform duration-500"}),v.jsx("span",{className:"text-[10px] font-bold",children:"  "})]})]}):v.jsxs("div",{className:"group flex items-center gap-2 bg-gray-50/80 px-3 py-1.5 rounded-[10px] border border-gray-100 backdrop-blur-md transition-all focus-within:bg-white focus-within:shadow-md focus-within:w-72 w-56 focus-within:border-ios-indigo/50",children:[v.jsx(ov,{className:"w-3.5 h-3.5 text-gray-400 group-focus-within:text-ios-indigo transition-colors"}),v.jsx("input",{type:"text",value:p,onChange:Q=>{m(Q.target.value),Q.target.value.length>=1?B(Q.target.value):x([])},placeholder:"  (  )",className:"bg-transparent border-none outline-none text-[12px] font-bold placeholder:text-gray-400 w-full text-gray-700"})]}),g.length>0&&!y&&v.jsx("div",{className:"absolute top-full left-0 mt-2 w-72 bg-white/90 backdrop-blur-xl rounded-[12px] shadow-xl border border-gray-100 overflow-hidden animate-spring-up p-1 z-50",children:g.map(Q=>v.jsxs("button",{onClick:()=>{w(Q),m(""),x([])},className:"w-full text-left px-3 py-2.5 hover:bg-ios-indigo/5 rounded-[8px] transition-colors flex items-center justify-between group border-b border-gray-50 last:border-0",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-8 h-8 rounded-[8px] bg-gray-100 group-hover:bg-white group-hover:shadow-sm flex items-center justify-center text-[10px] font-bold text-gray-500 group-hover:text-ios-indigo transition-all",children:Q.full_name[0]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-[13px] font-bold text-[#1C1C1E] group-hover:text-ios-indigo transition-colors",children:Q.full_name}),v.jsx("div",{className:"text-[10px] text-gray-400 font-mono flex items-center gap-1",children:Q.grade>0&&v.jsxs("span",{children:[Q.grade," ",Q.class_number," ",Q.student_number,""]})})]})]}),v.jsx("div",{className:"text-[10px] bg-gray-50 text-gray-400 px-2 py-1 rounded-[6px] group-hover:bg-ios-indigo group-hover:text-white transition-colors font-bold",children:""})]},Q.id))})]})]}),v.jsxs("div",{className:"flex items-center gap-7",children:[v.jsxs("div",{className:"flex items-center gap-3 bg-gray-200/20 p-1 px-4 py-2 rounded-apple-md border border-white/40 backdrop-blur-lg",children:[v.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-white/50 border border-white flex items-center justify-center shadow-sm",children:v.jsx(hd,{className:"w-4 h-4 text-ios-indigo"})}),v.jsxs("div",{className:"text-left",children:[v.jsx("p",{className:"text-[13px] font-black leading-none text-[#1C1C1E] uppercase",children:l==null?void 0:l.full_name}),v.jsx("p",{className:"text-[9px] font-black text-ios-indigo tracking-widest mt-1 uppercase opacity-60 italic",children:l==null?void 0:l.role})]})]}),v.jsxs("button",{onClick:L,className:"flex items-center gap-2 p-2 px-5 rounded-apple-md text-ios-gray hover:text-ios-rose hover:bg-ios-rose/5 transition-all ios-tap border border-transparent hover:border-ios-rose/10 group",children:[v.jsx(Jg,{className:"w-4 h-4 group-hover:-translate-x-0.5 transition-transform"}),v.jsx("span",{className:"font-bold text-[13px]",children:""})]})]})]}),v.jsx("main",{className:"flex-1 h-full flex overflow-hidden relative",children:e==="admin"?v.jsxs("div",{className:"flex-1 flex overflow-hidden w-full",children:[v.jsxs("aside",{className:"w-64 glass-material flex flex-col p-6 shrink-0 z-30 shadow-[4px_0_40px_rgba(0,0,0,0.02)] translate-x-0",children:[v.jsx("div",{className:"flex-1 space-y-9",children:X.map((Q,ne)=>v.jsxs("div",{className:"space-y-4",children:[v.jsx("h5",{className:"text-[10px] font-black text-ios-gray/60 uppercase tracking-[0.25em] px-3",children:Q.group}),v.jsx("div",{className:"space-y-1.5",children:Q.items.map(J=>v.jsxs("button",{onClick:()=>n(J.id),className:`w-full flex items-center gap-3.5 px-3 py-3 rounded-apple-md text-[13.5px] font-bold transition-all ios-tap group ${r===J.id?"bg-white shadow-sm text-[#1C1C1E]":"text-ios-gray hover:text-[#1C1C1E] hover:bg-white/40"}`,children:[v.jsx(J.icon,{className:`w-4 h-4 ${r===J.id?"text-ios-indigo":"text-ios-gray/50 group-hover:text-ios-indigo transition-colors"}`}),J.label]},J.id))})]},ne))}),v.jsx("div",{className:"pt-6 border-t border-gray-50",children:v.jsx("p",{className:"text-[8px] font-bold text-gray-300 tracking-tighter uppercase italic",children:"Copyright murmurgene 2026. All rights reserved."})})]}),v.jsx("div",{className:"flex-1 bg-[#F2F2F7] p-6 overflow-hidden",children:v.jsx("div",{className:"h-full w-full rounded-2xl overflow-hidden shadow-sm border border-black/5 bg-white",children:r==="zones"?v.jsx(sY,{}):r==="layout"?v.jsx(cj,{}):r==="attendance"?v.jsx(xT,{}):r==="attendance_print"?v.jsx(iY,{}):r==="students"?v.jsx(ZX,{}):r==="schedule"?v.jsx(rY,{}):r==="settings"?v.jsx(nY,{}):v.jsx(GX,{})})})]}):v.jsx("div",{className:"flex-1 h-full flex flex-col overflow-hidden p-6",children:e==="attendance"?v.jsx("div",{className:"h-full flex flex-col items-center justify-center",children:v.jsx(LT,{})}):e==="profile"?v.jsx("div",{className:"h-full overflow-y-auto scrollbar-hide",children:v.jsx(IT,{})}):v.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden pt-2",children:[v.jsxs("section",{className:"flex-1 flex flex-col xl:flex-row gap-6 leading-normal overflow-hidden h-full",children:[v.jsx("div",{className:"flex-1 flex flex-col overflow-hidden h-full",children:v.jsx("div",{className:"flex-1 w-full glass-card overflow-hidden p-2 shadow-sm h-full",children:v.jsx(jT,{onSelectSeat:s,selectedProxyUser:y,viewDate:a,onDateChange:c,selectedZoneId:f,onZoneChange:F})})}),v.jsx("div",{className:"xl:w-[340px] h-full overflow-y-auto scrollbar-hide glass-card shadow-sm",children:v.jsx(QX,{selectedSeat:i,onComplete:()=>s(null),targetUser:y,loggedInUser:l,initialDate:a,onDateChange:c,currentZoneId:f,onOpenSeatModal:()=>j(!0)})})]}),v.jsx(DT,{isOpen:A,onClose:()=>j(!1),zoneId:f,onSelect:Q=>{s(Q),j(!1)},selectedDate:Cr(a)})]})})})]})}class oY extends Bp.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){this.setState({error:t,errorInfo:r}),console.error("Uncaught error:",t,r)}render(){return this.state.hasError?v.jsxs("div",{className:"p-8 bg-white h-screen w-full flex flex-col items-center justify-center text-[#1C1C1E]",children:[v.jsx("h1",{className:"text-2xl font-black mb-4 text-ios-rose",children:"Application Crash"}),v.jsxs("pre",{className:"bg-gray-100 p-4 rounded text-xs overflow-auto max-w-full",children:[this.state.error&&this.state.error.toString(),v.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]}),v.jsx("button",{onClick:()=>window.location.reload(),className:"mt-6 px-6 py-3 bg-[#1C1C1E] text-white rounded-[6px] font-black",children:"Reload Application"})]}):this.props.children}}hx.createRoot(document.getElementById("root")).render(v.jsx(Bp.StrictMode,{children:v.jsx(oY,{children:v.jsx(aY,{})})}));export{Er as _,cY as c,bN as g};
